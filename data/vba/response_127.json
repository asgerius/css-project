[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497486642, "post_id": 44556387, "comment_id": 76103789, "body": "What&#39;s the problem ?"}, {"owner": {"reputation": 35, "user_id": 7989086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa327f580b4393f937d18b85b0f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Bamboo LikeFox", "link": "https://stackoverflow.com/users/7989086/bamboo-likefox"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497487157, "post_id": 44556387, "comment_id": 76103899, "body": "If I select the ID, it will show the corresponding Name which is correct. If I click the button, a time punch will display in Column D. I want to move that entire row to sheeet2(as indicated that that employee is already logout)."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 35, "user_id": 7989086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa327f580b4393f937d18b85b0f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Bamboo LikeFox", "link": "https://stackoverflow.com/users/7989086/bamboo-likefox"}, "edited": false, "score": 0, "creation_date": 1497766017, "post_id": 44557054, "comment_id": 76210861, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/146981/discussion-between-yowe3k-and-bamboo-likefox\">continue this discussion in chat</a>."}, {"owner": {"reputation": 35, "user_id": 7989086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa327f580b4393f937d18b85b0f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Bamboo LikeFox", "link": "https://stackoverflow.com/users/7989086/bamboo-likefox"}, "edited": false, "score": 0, "creation_date": 1521457506, "post_id": 44557054, "comment_id": 85722855, "body": "Hi @YowE3k How are you doing today Sir.  I would like to revive this project.  I got a small problem though."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1497766962, "last_edit_date": 1497766962, "creation_date": 1497489565, "answer_id": 44557054, "question_id": 44556387, "link": "https://stackoverflow.com/questions/44556387/how-to-select-and-cut-an-entire-row-from-sheet1-and-paste-it-in-sheet2/44557054#44557054", "title": "How to select and cut an entire row from sheet1 and paste it in sheet2", "body": "<p>You need to remove your loop, and just use the row you found using the <code>Find</code>:</p>\n\n<pre><code>Dim CM As Boolean\n\nPrivate Sub cmdMove_Click()\n\n    Dim myLog As Worksheet\n    Dim myLogSheet As Range\n    Dim myLogSheetRow As Long\n    Dim i As Long\n    i = 1\n    'Probably you want:\n    i = Sheet2.Cells(Sheet2.Rows.Count, \"A\").End(xlUp).Row + 1\n\n    Set myLog = Sheets(\"Sheet1\")\n    Set myLogSheet = myLog.Range(\"B:B\").Find(txtID.Value, , , xlWhole)\n\n    If Not myLogSheet Is Nothing Then\n        myLogSheetRow = myLogSheet.Row ' So we can delete the row later\n        myLogSheet.Offset(0, 2) = Format(Now, \"hh:mm:ss\")\n        myLogSheet.EntireRow.Cut Sheet2.Cells(i, \"A\")\n        myLog.Rows(myLogSheetRow).Delete\n    Else\n        txtName.Value = \"NO RECORD\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note that Excel exhibits very odd behaviour when deleting the row after the <code>Cut</code>.  Using a statement of <code>myLogSheet.EntireRow.Delete</code> after the <code>Cut</code> causes Excel to delete the row <strong>in Sheet1</strong> based on the new location of the cell <strong>in Sheet2</strong>.  This is why a variable needs to be created to refer to the row prior to the <code>Cut</code>, so that it can be used in the <code>Delete</code> after the <code>Cut</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 7989086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa327f580b4393f937d18b85b0f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Bamboo LikeFox", "link": "https://stackoverflow.com/users/7989086/bamboo-likefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "accepted_answer_id": 44557054, "answer_count": 1, "score": 0, "last_activity_date": 1528881480, "creation_date": 1497484145, "last_edit_date": 1592644375, "question_id": 44556387, "link": "https://stackoverflow.com/questions/44556387/how-to-select-and-cut-an-entire-row-from-sheet1-and-paste-it-in-sheet2", "title": "How to select and cut an entire row from sheet1 and paste it in sheet2", "body": "<p>Simple table in sheet1 with data in cells(A2:C4), column D is empty. I want to select the entire row, cut and paste it in sheet2 when a time is added in colum D.\nWhen I clicked on the logout button, It will add a time punch in column D.\nI want that entire row to be selected and then cut and paste in sheet2.\nI want also to arrange the remaining entry to move up so that there's no spaces between.</p>\n<h3>Screenshot</h3>\n<p><img src=\"https://i.stack.imgur.com/5M9wX.png\" alt=\"Screenshot\" /></p>\n<pre><code>Dim CM As Boolean\n\nPrivate Sub cmdMove_Click()\n\nDim myLog As Worksheet\nDim myLogSheet As Range\nDim i As Long: i = 1\n\nSet myLog = Sheets(&quot;Sheet1&quot;)\nSet myLogSheet = myLog.Range(&quot;B:B&quot;).Find(txtID.Value, , , xlWhole)\n\n'Dim LastRow As Long\n'LastRow = Sheets(&quot;Sheet2&quot;).Range(&quot;A65536&quot;).End(xlUp).Row + 1\nIf Not myLogSheet Is Nothing Then\nmyLogSheet.Offset(0, 2) = Format(Now, &quot;hh:mm:ss&quot;)\n\nWith ActiveSheet\nFor n = nLastRow To nFirstRow Step -1\n        If .Cells(n, &quot;D&quot;) = &quot;&quot; Then\n            .Cells(n, &quot;D&quot;).EntireRow.Cut Sheet2.Cells(i, &quot;A&quot;)\n            .Cells(n, &quot;D&quot;).EntireRow.Delete '~~&gt; if you want to delete\n            i = i + 1\n        End If\n    Next\nEnd With\n    \n\nElse\ntxtName.Value = &quot;NO RECORD&quot;\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497478647, "post_id": 44555573, "comment_id": 76101656, "body": "++ I was trying to find that KB article but couldn&#39;t. Great Job :)"}], "tags": [], "owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "is_accepted": true, "score": 4, "last_activity_date": 1497478554, "creation_date": 1497478554, "answer_id": 44555573, "question_id": 44555178, "link": "https://stackoverflow.com/questions/44555178/run-time-error-424-object-required-error/44555573#44555573", "title": "Run-Time error 424 - Object required error", "body": "<p>According to MSDN, you have to make sure the .HasTitle is set to true first.  Add this line to the one before it fails.</p>\n\n<pre><code>ActiveChart.Axes(xlValue, xlPrimary).HasTitle = True\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff820924.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff820924.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 3, "last_activity_date": 1497505524, "last_edit_date": 1497505524, "creation_date": 1497478569, "answer_id": 44555575, "question_id": 44555178, "link": "https://stackoverflow.com/questions/44555178/run-time-error-424-object-required-error/44555575#44555575", "title": "Run-Time error 424 - Object required error", "body": "<p>You are getting that error because you are trying to write to the Title and, since it is not able to find it, it is giving you an <code>Object required error (424)</code>. \nTry this</p>\n\n<pre><code>ActiveChart.Axes(xlValue, xlPrimary).HasTitle = True\nActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Text = \"Total Sales\"\n</code></pre>\n\n<p>Also please avoid the use of <code>ActiveChart/Select</code> etc. Work with Objects.</p>\n\n<p>Interesting Read on <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros\n</a></p>\n"}], "owner": {"reputation": 45, "user_id": 8088537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d3c1df6f8688858bafd580316fdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Anthrochange", "link": "https://stackoverflow.com/users/8088537/anthrochange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "accepted_answer_id": 44555573, "answer_count": 2, "score": 1, "last_activity_date": 1497505524, "creation_date": 1497476430, "last_edit_date": 1497478801, "question_id": 44555178, "link": "https://stackoverflow.com/questions/44555178/run-time-error-424-object-required-error", "title": "Run-Time error 424 - Object required error", "body": "<p>I used a record macro on excel 2013 to select data and make a bar graph. My exact actions were I selected A1, ctrl+shift+arrow down, ctrl+shift+arrow right, insert 2d bar graph, pressed the green + sign that says chart elements, selected Axis Titles, named the axis titles and the chart title, and stopped recording the macro. I get a 424 error Object required when the code gets to the point where I label the y(value) axis. I've tried renaming this 1st and 2nd and get the same error regardless. Here is the actual code:</p>\n\n<pre><code>Sub BarGraph()\n'\n' BarGraph Macro\n'\n\n'\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\nActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$1:$D$5\")\nActiveChart.SetElement (msoElementPrimaryCategoryAxisTitleAdjacentToAxis)\nActiveChart.SetElement (msoElementPrimaryValueAxisTitleAdjacentToAxis)\nActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Text = \"Total Sales\"        'This is the line that the failure starts at\nSelection.Format.TextFrame2.TextRange.Characters.Text = \"Total Sales\"\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 11).ParagraphFormat\n    .TextDirection = msoTextDirectionLeftToRight\n    .Alignment = msoAlignCenter\nEnd With\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 11).Font\n    .BaselineOffset = 0\n    .Bold = msoFalse\n    .NameComplexScript = \"+mn-cs\"\n    .NameFarEast = \"+mn-ea\"\n    .Fill.Visible = msoTrue\n    .Fill.ForeColor.RGB = RGB(89, 89, 89)\n    .Fill.Transparency = 0\n    .Fill.Solid\n    .Size = 10\n    .Italic = msoFalse\n    .Kerning = 12\n    .Name = \"+mn-lt\"\n    .UnderlineStyle = msoNoUnderline\n    .Strike = msoNoStrike\nEnd With\nActiveChart.Axes(xlCategory).AxisTitle.Select\nActiveChart.Axes(xlCategory, xlPrimary).AxisTitle.Text = \"Region\"\nSelection.Format.TextFrame2.TextRange.Characters.Text = \"Region\"\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 6).ParagraphFormat\n    .TextDirection = msoTextDirectionLeftToRight\n    .Alignment = msoAlignCenter\nEnd With\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 6).Font\n    .BaselineOffset = 0\n    .Bold = msoFalse\n    .NameComplexScript = \"+mn-cs\"\n    .NameFarEast = \"+mn-ea\"\n    .Fill.Visible = msoTrue\n    .Fill.ForeColor.RGB = RGB(89, 89, 89)\n    .Fill.Transparency = 0\n    .Fill.Solid\n    .Size = 10\n    .Italic = msoFalse\n    .Kerning = 12\n    .Name = \"+mn-lt\"\n    .UnderlineStyle = msoNoUnderline\n    .Strike = msoNoStrike\nEnd With\nActiveChart.ChartArea.Select\nActiveChart.ChartTitle.Select\nActiveChart.ChartTitle.Text = \"Total Sales\"\nSelection.Format.TextFrame2.TextRange.Characters.Text = \"Total Sales\"\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 11).ParagraphFormat\n    .TextDirection = msoTextDirectionLeftToRight\n    .Alignment = msoAlignCenter\nEnd With\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 11).Font\n    .BaselineOffset = 0\n    .Bold = msoFalse\n    .NameComplexScript = \"+mn-cs\"\n    .NameFarEast = \"+mn-ea\"\n    .Fill.Visible = msoTrue\n    .Fill.ForeColor.RGB = RGB(89, 89, 89)\n    .Fill.Transparency = 0\n    .Fill.Solid\n    .Size = 14\n    .Italic = msoFalse\n    .Kerning = 12\n    .Name = \"+mn-lt\"\n    .UnderlineStyle = msoNoUnderline\n    .Spacing = 0\n    .Strike = msoNoStrike\nEnd With\nRange(\"K7\").Select\nEnd Sub\n</code></pre>\n\n<p>I also tried adding the title individually from the design tab by selecting add chart element, axis title, primary vertical and got the same problem.\nI'm really not sure what the problem could be so some help would be much appreciated, thank you.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1497511751, "post_id": 44555102, "comment_id": 76111585, "body": "To avoid typo&#39;s start your code with <code>Option Explicit</code>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1497514079, "post_id": 44555102, "comment_id": 76113079, "body": "Can you <code>Debug.Print Worksheets(&quot;Date&quot;).Range(&quot;B10&quot;).Value</code>, and give the result? It might be an error related to the type of that value"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1497541016, "creation_date": 1497541016, "answer_id": 44571621, "question_id": 44555102, "link": "https://stackoverflow.com/questions/44555102/trying-to-run-make-table-query-in-access-from-excel/44571621#44571621", "title": "Trying to Run Make Table Query in Access, from Excel", "body": "<p>I ended up inputting the dates into two parameters that come from the 2 Action Queries that I'm running.  Although I couldn't figure out how to pass in the parameters from cells on a Worksheet, he script below works fine.</p>\n\n<pre><code>Sub Update_All()\n\nMsgBox (\"It may take several minutes for all Queries to finish.  Please wait for the 'Done' message to confirm that the task is complete.\")\n\n    Dim strDatabasePath As String\n    Dim oApp As Access.Application\n    Dim PathOfworkbook As String\n\n    PathOfworkbook = ThisWorkbook.Path\n\n    strDatabasePath = PathOfworkbook &amp; \"\\TRANSACTIONS.accdb\"\n\n    Set oApp = CreateObject(\"Access.Application\")\n    oApp.Visible = False\n\n    oApp.OpenCurrentDatabase strDatabasePath\n\n    With oApp\n        Application.DisplayAlerts = False\n        '.OpenCurrentDatabase strDatabasePath\n\n        ' Run first Action Query\n        .DoCmd.OpenQuery \"KEY\"\n\n        ' Run second Action Query\n        .DoCmd.OpenQuery \"TRBYMONTH\"\n\n        .Quit\n    End With\n\n    Set appAccess = Nothing\n\n    MsgBox (\"Done!  All Access Queries have been updated!!\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594639760, "creation_date": 1497476047, "last_edit_date": 1594639760, "question_id": 44555102, "link": "https://stackoverflow.com/questions/44555102/trying-to-run-make-table-query-in-access-from-excel", "title": "Trying to Run Make Table Query in Access, from Excel", "body": "<p>I'm testing the script below.</p>\n\n<pre><code>Sub Update_All()\n\nDim MyDatabase As DAO.Database\nDim MyQueryDef As DAO.QueryDef\nDim MyRecordset As DAO.Recordset\nDim i As Integer\n\n'Step 2: Identify the database and query\n\nPathOfWorkbook = ThisWorkbook.Path\nFullPathOfAccess = PathOfWorkbook &amp; \"\\TRANSACTIONINFO.accdb\"\nSet MyDatabase = DBEngine.OpenDatabase(FullPathOfAccess)\nSet MyQueryDef = MyDatabase.QueryDefs(\"TRANSBYMONTH\")\n\nWith MyQueryDef\n.Parameters(\"[StartDate]\") = Worksheets(\"Date\").Range(\"B9\").Value\n.Parameters(\"[EndDate]\") = Worksheets(\"Date\").Range(\"B10\").Value\nEnd With\n\n'Step 4: Open the query\nSet MyRecordset = MyQueryDef.OpenRecordset\n\n'MyQueryDef.Execute\nMyQueryDef.Close\n\naa.DoCmd.SetWarnings WarningsOn:=True\n\nSet MyDatabase = Nothing\nSet MyQueryDef = Nothing\n\n' Shut down reference to Access; clean up\naa.Quit\n\n' Refresh all links to Access\nActiveWorkbook.RefreshAll\n\nEnd Sub\n</code></pre>\n\n<p>I am getting an error on this line:</p>\n\n<pre><code>Set MyRecordset = MyQueryDef.OpenRecordset\n</code></pre>\n\n<p>The error reads: Run-time Error '3219' Invalid Operation.</p>\n\n<p>I think one of my references to an object is not being set correctly, but I really don't know what the problem is.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/rBpjR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rBpjR.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/YohNQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YohNQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm just trying to grab a StartDate and EndDate from 2 cells in Excel and pass both to a Make Table Query in Access.  How can I do that?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12143, "user_id": 1021725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b935010f9ac8bee2a8df5b1c6ee6cb?s=128&d=identicon&r=PG", "display_name": "David Brossard", "link": "https://stackoverflow.com/users/1021725/david-brossard"}, "edited": false, "score": 1, "creation_date": 1497475171, "post_id": 44554866, "comment_id": 76100173, "body": "You need to show us some code. What have you tried? Also, do not ask 2 questions in 1 question"}, {"owner": {"reputation": 1, "user_id": 8162860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c26e9d21de5ab5d1410439b95da8c8?s=128&d=identicon&r=PG&f=1", "display_name": "MikeV", "link": "https://stackoverflow.com/users/8162860/mikev"}, "edited": false, "score": 0, "creation_date": 1497475737, "post_id": 44554866, "comment_id": 76100419, "body": "It was not a duplicate...I edited the question to include my attempted code upon the request of @ David Brossard"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497476799, "post_id": 44554866, "comment_id": 76100900, "body": "<a href=\"http://www.siddharthrout.com/2011/07/14/find-and-findnext-in-excel-vba/\" rel=\"nofollow noreferrer\">THIS</a> will get you started"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497476830, "post_id": 44554866, "comment_id": 76100915, "body": "Yes @SiddharthRout , I closed it as the first duplicate I could find that was remotely close to a replacement operation. As there was no code beyond a vague software spec. I had little to go on."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497476840, "post_id": 44554866, "comment_id": 76100922, "body": "And pleaseeeeeeeee do not hardocode row values... <code>&quot;B65536&quot;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1497476902, "post_id": 44554866, "comment_id": 76100957, "body": "@MikeV - That actually <b>was</b> a duplicate of your original question. If you do not provide specifics then expect to get answers that may not be specific to your own individual situation."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497476925, "post_id": 44554866, "comment_id": 76100968, "body": "No worries @jeeped. Just wanted to be sure as was surprised to see my name. Anyways, I tired raising the bug and it got closed :D"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1497476723, "creation_date": 1497476723, "answer_id": 44555234, "question_id": 44554866, "link": "https://stackoverflow.com/questions/44554866/find-and-replace-text/44555234#44555234", "title": "Find and replace text", "body": "<p>This is just a Find/FindNext operation using offset and replace to accomplish your attribute suffix adjustment.</p>\n\n<pre><code>Sub Correct_Attribute_Suffix()\n    Dim fnd As Range, addr As String\n\n    With ActiveSheet.Range(\"B3\", ActiveSheet.Range(\"B65536\").End(xlUp))\n        Set fnd = .Find(What:=\"BATH\", After:=.Cells(.Cells.Count), LookIn:=xlFormulas, _\n                      LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                      MatchCase:=False, SearchFormat:=False)\n        If Not fnd Is Nothing Then\n            addr = fnd.Address\n            Do\n                fnd.Offset(0, 1) = Replace(fnd.Offset(0, 1).Value2, \"KCab\", \"BCab3\", 1, 1, vbTextCompare)\n                Set fnd = .FindNext(After:=fnd)\n            Loop While addr &lt;&gt; fnd.Address\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8162860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c26e9d21de5ab5d1410439b95da8c8?s=128&d=identicon&r=PG&f=1", "display_name": "MikeV", "link": "https://stackoverflow.com/users/8162860/mikev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497477875, "creation_date": 1497475040, "last_edit_date": 1531161705, "question_id": 44554866, "link": "https://stackoverflow.com/questions/44554866/find-and-replace-text", "title": "Find and replace text", "body": "<p>I'm new to VBA in Excel and have a fairly simple issue. I need to search for specific text string <code>Bath</code> in Column <code>B</code>.  If it exists, then I need to replace specific text string <code>KCab</code> in Column <code>C</code> of the same row with <code>BCab3</code>.  I need to run or loop this until it checks all the cells in Column <code>B</code>.</p>\n\n<p>Here is what I have so far, which is not working:</p>\n\n<pre><code>Sub Correct_Attribute_Suffix()\n\n    Dim c As Range\n    Dim SrchRng\n\n    Set SrchRng = ActiveSheet.Range(\"B3\", ActiveSheet.Range(\"B65536\").End(xlUp))\n    Do\n        Set c = SrchRng.Find(\"BATH\", LookIn:=xlValues)\n        If Not c Is Nothing Then Currentcell.Offset(, 1).Value = Replace(\"KCab\", \"K\", \"B\")\n\n    Loop While Not c Is Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1497475031, "post_id": 44554693, "comment_id": 76100106, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/10718179#10718179\">THIS</a> will get you started. I believe if you avoid using select and fully qualify the objects then you will not face the issues :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497475360, "post_id": 44554693, "comment_id": 76100261, "body": "What I mean is, see how you used <code>reportsheet</code> in <code>reportsheet.Range(&quot;D6&quot;).Value</code> but forgot to do the same in <code>If Cells(i, 4) = customername Then</code> and other places? :)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1497475366, "post_id": 44554693, "comment_id": 76100262, "body": "Put a message box to get the value of finalrow after the row <code>finalrow = Cells(Rows.Count, 1).End(xlUp).Row</code>, what shows up?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497475663, "post_id": 44554693, "comment_id": 76100384, "body": "@SiddharthRout - <code>If Cells(i, 4) = customername Then</code> is inherently referencing the <code>datasheet</code> worksheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1497475740, "post_id": 44554693, "comment_id": 76100420, "body": "Are you sure you want to <code>xlPasteFormulasAndNumberFormats</code>? Typically a report does not rely upon formulas for its numbers; especially so when data is copied from another worksheet."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497476311, "post_id": 44554693, "comment_id": 76100669, "body": "@jeeped. True that. I am advising the user to fully qualify the cells to negate any possibility of the code not finding a match. BTW I just posted a bug in meta. You may want to see it <a href=\"https://meta.stackexchange.com/questions/297189/incorrect-information-portrayed-for-closed-quesitons\">Here</a>"}], "owner": {"reputation": 11, "user_id": 8162643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669d0a81388b54c74e2f3d049bb46323?s=128&d=identicon&r=PG&f=1", "display_name": "NewtoVBA", "link": "https://stackoverflow.com/users/8162643/newtovba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497477591, "creation_date": 1497474204, "last_edit_date": 1531161705, "question_id": 44554693, "link": "https://stackoverflow.com/questions/44554693/macro-runs-but-no-data-is-pasted", "title": "Macro runs but no data is pasted", "body": "<p>First off, I am extremely new to excel vba.  I have some code that works well in one workbook but doesn't work in the workbook I need it in.  When using <kbd>F8</kbd>, it skips over the portion of the code beginning with <code>If Cells(i, 4) = customername Then</code> through <code>End If</code>.  </p>\n\n<p>I have searched for several days trying to find an answer online.  When I run the macro, the screen flashes but the data disappears.  Here is the code I am trying to use, any help will be greatly appreciated.  </p>\n\n<pre><code>Sub CustomerReport()\n    Dim datasheet As Worksheet\n    Dim reportsheet As Worksheet\n    Dim customername As String\n    Dim finalrow As Integer\n    Dim i As Integer\n\n    Set datasheet = Sheet3\n    Set reportsheet = Sheet8\n    customername = reportsheet.Range(\"D6\").Value\n\n    reportsheet.Range(\"C8:M500\").ClearContents\n\n    datasheet.Select\n    finalrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 8 To finalrow\n        If Cells(i, 4) = customername Then\n            Range(Cells(i, 3), Cells(i, 13)).Copy\n            reportsheet.Select\n            Range(\"C200\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n            datasheet.Select\n            End If\n    Next i\n    reportsheet.Select\n\n    Range(\"D6\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1497473743, "post_id": 44554468, "comment_id": 76099475, "body": "Did Outlook prompt for access while you run the code?  Chances are Outlook is preventing &quot;programmatic access&quot; thus giving you the error.  <a href=\"https://social.technet.microsoft.com/Forums/ie/en-US/64c14bd3-0e7f-4ba9-b2bd-26cf62ce5883/how-to-stop-outlook-security-message-a-program-is-trying-to-access-email-addresses-allow-access?forum=outlook\" rel=\"nofollow noreferrer\">Here</a> is an article on enabling access that you can try out."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1497474149, "post_id": 44554468, "comment_id": 76099675, "body": "Did you look at <a href=\"https://stackoverflow.com/a/18406935/4717755\">this answer</a>? It seems to show it a bit differently."}, {"owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1497533703, "post_id": 44554468, "comment_id": 76126548, "body": "@Alex it seems like you&#39;re onto something there. My administrator seems to have grayed out options to mess with the programmatic access (see edit &amp; image in question above)"}, {"owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1497534055, "post_id": 44554468, "comment_id": 76126809, "body": "@PeterT I tried the code in your link (see edit to question) but the same error is happening on the 2nd line. I am able to retrieve the Global Address List, but I get an error immediately when I put put in the &quot;.AddressEntries&quot; stuff as well"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1497535179, "post_id": 44554468, "comment_id": 76127643, "body": "@takanuva15 there&#39;s a chance your antivirus treating the access as potential threat - it&#39;s a coded automation for accessing your data afterall.  Check with your admin and see if one of the options shown in your trust center, preferably the very first one"}, {"owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 1, "creation_date": 1497541826, "post_id": 44554468, "comment_id": 76132527, "body": "@Alex Ok cool. If you post your comment as an answer, I will upvote it and mark it with a green check"}], "answers": [{"comments": [{"owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "edited": false, "score": 0, "creation_date": 1497543801, "post_id": 44571963, "comment_id": 76133622, "body": "Yup, it looks like my administrator is not allowing Programmatic Access to the data in Outlook. I&#39;ll have to figure out how to get access or else do my task in some other way."}], "tags": [], "owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "is_accepted": true, "score": 2, "last_activity_date": 1497542091, "creation_date": 1497542091, "answer_id": 44571963, "question_id": 44554468, "link": "https://stackoverflow.com/questions/44554468/cannot-access-addressentries-object-from-addresslist-object-outlook-vba/44571963#44571963", "title": "Cannot access AddressEntries Object from AddressList Object (Outlook VBA)", "body": "<p>It seems like your antivirus treating the access as potential threat - it's a coded automation for accessing your data afterall.   </p>\n\n<p>Check with your admin and see if you can enable one of the options shown in your trust center (Open Outlook 2010, go to \"File/Options/Trust Center\" menu item, and then click on the \"Trust Center Settings\" button at the right side of the dialog box), preferably the very first one.    </p>\n\n<p><a href=\"https://social.technet.microsoft.com/Forums/ie/en-US/64c14bd3-0e7f-4ba9-b2bd-26cf62ce5883/how-to-stop-outlook-security-message-a-program-is-trying-to-access-email-addresses-allow-access?forum=outlook\" rel=\"nofollow noreferrer\">Here</a> is an article on enabling access that you can try out.</p>\n"}], "owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 0, "accepted_answer_id": 44571963, "answer_count": 1, "score": 0, "last_activity_date": 1497542091, "creation_date": 1497473239, "last_edit_date": 1497533752, "question_id": 44554468, "link": "https://stackoverflow.com/questions/44554468/cannot-access-addressentries-object-from-addresslist-object-outlook-vba", "title": "Cannot access AddressEntries Object from AddressList Object (Outlook VBA)", "body": "<p>I am trying to access the AddressEntries property of an AddressList inside a VBA script within Excel. The list is a Global Address List containing contacts stored on an Exchange Server. </p>\n\n<p>When I try to run the following code though, it gives me an error:</p>\n\n<blockquote>\n  <p>Run-time error '287': Application-defined or object-defined error</p>\n</blockquote>\n\n<p>Here is the barebones code I'm trying to execute. The debugger stops on the line where I try to access the AddressEntries.</p>\n\n<pre><code>Public Sub Test()\n    Dim appOL As Object\n    Dim mapiNamespace As Object\n    Dim GAL As AddressList, allGAL As AddressEntries\n\n    Set appOL = GetObject(, \"Outlook.Application\")\n    Set mapiNamespace = appOL.GetNamespace(\"mapi\")\n    Set GAL = mapiNamespace.AddressLists(\"Global Address List\")\n    Set allGAL = GAL.AddressEntries 'Debugger stops here\n    MsgBox allGAL.Count  \nEnd Sub\n</code></pre>\n\n<p>Would some setting on the server be able to prevent my access to the entries of the list? Is there some other way to get the entries? My end goal is to get the entries from the list that correspond to a list of email addresses I have in an excel file and check whether each entry has a work phone # listed in its Phone Number property.</p>\n\n<p>Edit:\n<a href=\"https://i.stack.imgur.com/phWih.png\" rel=\"nofollow noreferrer\">Image of Outlook graying out my options</a></p>\n\n<p>Set app</p>\n\n<p>Edit2: This still gives me the same error on the second line</p>\n\n<pre><code>Set appOL = CreateObject(\"Outlook.Application\")\nSet oGAL = appOL.GetNamespace(\"MAPI\").AddressLists(\"Global Address List\").AddressEntries\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1497473602, "post_id": 44554376, "comment_id": 76099416, "body": "Sounds like some combination of screenupdating and your sheet being protected. Instead of using <code>.Protect</code> and <code>.Unprotect</code> just protect the sheet in <code>Workbook_Open</code> and use the <code>UserInterfaceOnly:= True</code> option instead."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497478132, "post_id": 44554376, "comment_id": 76101485, "body": "I know you are resetting it to <code>True</code> in button code but still try this for me... In the <code>UserForm_QueryClose</code> event of the userform, put this <code>Application.ScreenUpdating = True</code> Now try it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8127890"}, "edited": false, "score": 0, "creation_date": 1497482632, "post_id": 44554376, "comment_id": 76102833, "body": "what is the modal property set to for your form?"}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "edited": false, "score": 0, "creation_date": 1497535272, "post_id": 44554376, "comment_id": 76127730, "body": "@braX Modal is set to False, Tried True but still same result"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497472873, "creation_date": 1497472873, "question_id": 44554376, "link": "https://stackoverflow.com/questions/44554376/userform-stops-other-sheets-from-scrolling", "title": "Userform stops other sheets from scrolling", "body": "<p>I have a few userforms. One is a popup that shows instructions and another is for entering quantities. Problem is when I click one and close it (each closes with <code>Unload Me</code>) then when I switch sheets with a <code>sht.Activate</code> macro button that sheet won't scroll. Looks like the sheet is frozen. I can fix the problem by loading the userform and closing it again on the current sheet to \"Unfreeze\" the sheet.</p>\n\n<p>Any idea why this is happening?</p>\n\n<blockquote>\n  <p>UserForm</p>\n</blockquote>\n\n<pre><code>Private Sub UserForm_Click()\nUnload Me\nEnd Sub\n</code></pre>\n\n<p>Below is how I call it from a button.</p>\n\n<pre><code>Sub Instructions()\nWith UserFormInstructions\n    .StartUpPosition = 0\n    .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n    .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)\n    .Show\nEnd With\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Sheet Button</p>\n</blockquote>\n\n<pre><code>Sub goto630()\nApplication.ScreenUpdating = False\n\nDim sht2 As Worksheet\nSet sht2 = ThisWorkbook.Worksheets(\"Foundation Plates\")\nDim sht3 As Worksheet\nSet sht3 = ThisWorkbook.Worksheets(\"630 BOM\")\n\nsht3.Activate\nsht3.Unprotect\n\nsht2.Visible = True\nsht3.Visible = True\n\nOn Error GoTo 0\n\n    ActiveWindow.Zoom = 90\n    ActiveWindow.DisplayHeadings = True\n    ActiveWindow.DisplayHorizontalScrollBar = True\n    ActiveWindow.DisplayVerticalScrollBar = True\n    Application.DisplayFormulaBar = True\n    sht3.DisplayPageBreaks = False\n\nsht2.Protect\nsht3.Protect _\n        DrawingObjects:=False, _\n        Contents:=True, _\n        Scenarios:=False, _\n        UserInterFaceOnly:=False, _\n        AllowFormattingCells:=True\nCall NoSelect\n\nSet sht3 = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n\nSub NoSelect()\nApplication.ScreenUpdating = False\n\n    Range(\"D1\").Select\n    ActiveWindow.SmallScroll ToLeft:=4\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "loops", "slide", "powerpoint"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497472700, "post_id": 44554153, "comment_id": 76098886, "body": "You need to have a minimum of 1 Slide Master. You can&#39;t delete all slidemaster. If you try to delete the last one, it will throw an error. it is like trying to delete all sheets in a workbook. Regarding clearing the SM, can you explain what exactly are you trying to achieve?"}, {"owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497472983, "post_id": 44554153, "comment_id": 76099047, "body": "I have slide masters that include images and text boxes in the heading and I want to clear them of the information currently in them"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1497474359, "creation_date": 1497474359, "answer_id": 44554728, "question_id": 44554153, "link": "https://stackoverflow.com/questions/44554153/how-to-clear-slide-master-of-all-information-in-powerpoint-using-vba/44554728#44554728", "title": "How to clear Slide Master of all information in PowerPoint using VBA?", "body": "<p>Further to my comments, if you want to delete the slide master then use this</p>\n\n<pre><code>Sub DeleteSlideMaster()\n    Dim i As Long\n\n    With ActivePresentation\n        On Error Resume Next\n        For i = .Designs.Count To 1 Step -1\n            .Designs(i).SlideMaster.Delete\n        Next i\n        On Error GoTo 0\n    End With\nEnd Sub\n</code></pre>\n\n<p>To delete Shapes of a slidemaster, use this</p>\n\n<pre><code>Sub DeleteSlideMasterShapes()\n    Dim i As Long\n    Dim shp As Shape\n\n    With ActivePresentation\n        For i = .Designs.Count To 1 Step -1\n            For Each shp In .Designs(i).SlideMaster.Shapes\n                shp.Delete\n            Next\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>If I have not understood your query then please feel free to ask</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497543692, "post_id": 44572334, "comment_id": 76133567, "body": "Hey Steve, thank you for the approach. I would like to test it but I am very new to VBA, 2 days, and wouldn&#39;t know how to interface into Sub loopFiles()"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497544039, "post_id": 44572334, "comment_id": 76133743, "body": "You&#39;ve already done it ... just replace your DeleteSlideMasterShapes sub with mine."}, {"owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497544448, "post_id": 44572334, "comment_id": 76133977, "body": "I get the following error with what I have together, Compile error: User-defined type not defined at Sub loopFiles()"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497544886, "post_id": 44572334, "comment_id": 76134213, "body": "On the &quot;Dim fso As New FileSystemObject&quot; line?  If so, use Tools | References to add a reference to &quot;Microsoft Scripting Runtime&quot;"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1497543344, "creation_date": 1497543344, "answer_id": 44572334, "question_id": 44554153, "link": "https://stackoverflow.com/questions/44554153/how-to-clear-slide-master-of-all-information-in-powerpoint-using-vba/44572334#44572334", "title": "How to clear Slide Master of all information in PowerPoint using VBA?", "body": "<p>Another approach, in case you want to delete all the shapes from all Slide Masters AND the master's layouts:</p>\n\n<pre><code>Sub DeleteSlideMasterShapes()\n'   Including shapes on layouts\n\n    Dim oDes As Design\n    Dim oLay As CustomLayout\n\n    With ActivePresentation\n\n        ' For each slide master:\n        For Each oDes In .Designs\n\n            ' Delete the shapes on the master\n            oDes.SlideMaster.Shapes.Range.Delete\n\n            ' Then delete the shapes from each layout under\n            ' the slide master:\n            For Each oLay In oDes.SlideMaster.CustomLayouts\n                oLay.Shapes.Range.Delete\n            Next\n\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 0, "accepted_answer_id": 44554728, "answer_count": 2, "score": 1, "last_activity_date": 1497616089, "creation_date": 1497472034, "last_edit_date": 1497616089, "question_id": 44554153, "link": "https://stackoverflow.com/questions/44554153/how-to-clear-slide-master-of-all-information-in-powerpoint-using-vba", "title": "How to clear Slide Master of all information in PowerPoint using VBA?", "body": "<p>I would like to open every PowerPoint (*.pptx) in current folder and clear the Slide Master of all images and text boxes and then save.</p>\n\n<p>(It says my post is mostly code so I need to add more detail, so here is a quote by George Washington, \"Associate with men of good quality if you esteem your own reputation; for it is better to be alone than in bad company\")</p>\n\n<p>New code</p>\n\n<pre><code>Sub DeleteSlideMasterShapes()\n    Dim i As Long\n    Dim shp As Shape\n\n    With ActivePresentation\n        For i = .Designs.Count To 1 Step -1\n            For Each shp In .Designs(i).SlideMaster.Shapes\n                shp.Delete\n            Next\n        Next i\n    End With\nEnd Sub\n\nSub loopFiles()\n\nDim fso As New FileSystemObject\nDim fil As File\nDim fold As Folder\nDim yourfolder As String\n\nSet fold = fso.GetFolder(Application.ActivePresentation.Path)\n\nFor Each fil In fold.Files\n\n    If InStr(1, fil.Name, \".pptx\") &gt; 0 Then\n        Application.Presentations.Open fil.Path\n\n        Call DeleteSlideMasterShapes\n\n        ActivePresentation.Save\n        ActivePresentation.Close\n\n    End If\n\nNext fil\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 4, "creation_date": 1497472428, "post_id": 44554148, "comment_id": 76098745, "body": "Change it to <code>z = &quot;&quot;&quot;&gt;0&quot;&quot;&quot;</code> and it should work. The formula is expecting your condition to be a string and you have to escape the double-quote."}, {"owner": {"reputation": 11, "user_id": 8162691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55cc8bbaf263b7564ffa1fca2816e26a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/8162691/kyle"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1497472749, "post_id": 44554148, "comment_id": 76098915, "body": "@PeterT That worked, thank you very much!"}], "owner": {"reputation": 11, "user_id": 8162691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55cc8bbaf263b7564ffa1fca2816e26a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/8162691/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497472213, "creation_date": 1497472003, "last_edit_date": 1497472213, "question_id": 44554148, "link": "https://stackoverflow.com/questions/44554148/averageif-and-formular1c1-not-combining-correctly", "title": "AVERAGEIF and formulaR1C1 not combining correctly", "body": "<p>I'm very new to VBA, so this may be a basic question.  I've already checked through various posts here, and it seems that what I'm attempting to code should work, but doesn't. </p>\n\n<pre><code>Dim z as String                                                            \nz = \"&gt;0\"                                                     \nActiveCell.FormulaR1C1 = \"=AVERAGEIF(R[-11]C[-3]:R[-1]C[-3],\" &amp; z &amp; \")\"\n</code></pre>\n\n<p>I'm trying to concatenate this, as when I write: </p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=AVERAGEIF(R[-11]C[-3]:R[-1]C[-3],\"&gt;0\")\"\n</code></pre>\n\n<p>it says that it \"expected the end of statement\".  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1497471763, "post_id": 44553928, "comment_id": 76098430, "body": "I never understand why people do not think it is important to add <b>what line the error occurs on</b> in their narrative."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1497471932, "post_id": 44553928, "comment_id": 76098515, "body": "How can you start colouring individual characters at position 36 if the value of the cell is <code>&quot;T - 10&quot;</code>?"}, {"owner": {"reputation": 15, "user_id": 8122239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5943d0dd9baced719e41efbf9f66d783?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Gundersen", "link": "https://stackoverflow.com/users/8122239/cole-gundersen"}, "edited": false, "score": 0, "creation_date": 1497902337, "post_id": 44553928, "comment_id": 76263767, "body": "Thanks for your response.  Before posting, I removed things that I thought the company I work for would not want me to display.  In doing so, I did not catch that I reduced the number of characters to make that formula non-functioning."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8122239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5943d0dd9baced719e41efbf9f66d783?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Gundersen", "link": "https://stackoverflow.com/users/8122239/cole-gundersen"}, "edited": false, "score": 0, "creation_date": 1497912705, "post_id": 44554294, "comment_id": 76268167, "body": "This does work, though when an edit is made to any cell in column D, the macro is activated and, as a result, there is no &#39;Undo&#39; option available.  Additionally, it slows down making quick changes to any cell in column D."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1497472582, "creation_date": 1497472582, "answer_id": 44554294, "question_id": 44553928, "link": "https://stackoverflow.com/questions/44553928/vba-unknown-reason-for-error/44554294#44554294", "title": "VBA - Unknown Reason for Error", "body": "<p>This line will raise an error when Target does not contain E44:</p>\n\n<pre><code> If Application.Intersect(Tx, Range(Target.Address)).Value = \"x\" Then\n</code></pre>\n\n<p><code>Intersect</code> will return <code>Nothing</code>, and <code>Nothing</code> has no <code>Value</code> property</p>\n\n<p>A working version might be:</p>\n\n<pre><code> If Not Application.Intersect(Tx, Range(Target.Address)) Is Nothing And _\n                                                    Tx.Value = \"x\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8122239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5943d0dd9baced719e41efbf9f66d783?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Gundersen", "link": "https://stackoverflow.com/users/8122239/cole-gundersen"}, "edited": false, "score": 0, "creation_date": 1497912736, "post_id": 44554339, "comment_id": 76268178, "body": "Yes, this is correct.  I will better present my questions in the future."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1497473816, "last_edit_date": 1497473816, "creation_date": 1497472785, "answer_id": 44554339, "question_id": 44553928, "link": "https://stackoverflow.com/questions/44553928/vba-unknown-reason-for-error/44554339#44554339", "title": "VBA - Unknown Reason for Error", "body": "<p>The problem seems to be in this line.</p>\n\n<pre><code>If Application.Intersect(Tx, Range(Target.Address)).Value = \"x\" Then\n'better and more succinct as,\nIf Application.Intersect(Tx, Target).Value = \"x\" Then\n</code></pre>\n\n<p>You do not know if Target intersects <code>Range(\"E44\")</code> but you are trying to get the value from the intersection without determining if there is actually anything to get the value from.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Range(\"E44\"), Target) Is Nothing Then\n        On Error GoTo E_H\n        Application.EnableEvents = False\n\n        If LCase(Range(\"E44\").Value) = \"x\" Then\n            With Range(\"C45\")\n                .Value = \"T - 10\"\n                .Characters(Start:=36, Length:=5).Font.Color = -16776961\n            End With\n            Range(\"I45\") = \"T - 10 - LOS\"\n            Range(\"B48\").Formula = \"=B47+1\"\n            Rows(\"47\").EntireRow.Hidden = False\n            Worksheets(\"DropDowns\").Range(\"M6\").Value = 65\n        Else\n            Range(\"C45\") = \"I45\"\n            Range(\"I45\") = \"25Ac - LOS\"\n            Range(\"B48\").Formula = \"=B46+1\"\n            Rows(\"47\").EntireRow.Hidden = True\n            Worksheets(\"DropDowns\").Range(\"M6\").Value = 64\n        End If\n    End If\n\nE_H:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>I'm not sure I got your logic flow correct but this is my best guess. If E44 changes and it is now an <code>x</code>, unhide row 47, adjust a formula, etc. If E44 changes and it is not an <code>x</code> then hide row 47, adjust a formula, etc.</p>\n"}], "owner": {"reputation": 15, "user_id": 8122239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5943d0dd9baced719e41efbf9f66d783?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Gundersen", "link": "https://stackoverflow.com/users/8122239/cole-gundersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 44554339, "answer_count": 2, "score": 1, "last_activity_date": 1497473816, "creation_date": 1497471180, "last_edit_date": 1497472456, "question_id": 44553928, "link": "https://stackoverflow.com/questions/44553928/vba-unknown-reason-for-error", "title": "VBA - Unknown Reason for Error", "body": "<p>I am getting an 'Object variable or With block variance not set' error for a reason I cannot figure out.  With the Error Handler in place, the VBA code appears to work as intended.  I would like to resolve the error, rather than skipping over it.\nCan anyone point out where/why this error is occurring?  Or any other suggestions for this code?  Any help is appreciated!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Tx As Range\nDim Rw As Variant\n\nOn Error GoTo E_H 'If this error handler is not in effect, and an edit is\n                  '    made in column D, the error occurs.\n\nSet Tx = Range(\"E44\")\nSet Rw = Rows(\"47\")\n\nIf Application.Intersect(Tx, Range(Target.Address)).Value = \"x\" Then\n    Application.EnableEvents = False\n        With Range(\"C45\")\n            .Value = \"T - 10\"\n        End With\n        With Range(\"C45\").Characters(Start:=36, Length:=5).Font\n            .Color = -16776961\n        End With\n        With Range(\"I45\")\n            .Value = \"T - 10 - LOS\"\n        End With\n    Rw.Hidden = False\n        With Range(\"B48\")\n            .Formula = \"=B47+1\"\n        End With\n    Sheets(\"DropDowns\").Range(\"M6\").Value = \"65\"\n    Application.EnableEvents = True\n\nElse\n\n    Application.EnableEvents = False\n        With Range(\"C45\")\n        .Value = \"25Ac\"\n        End With\n            With Range(\"I45\")\n            .Value = \"25Ac - LOS\"\n        End With\n    Rw.Hidden = True\n        With Range(\"B48\")\n            .Formula = \"=B46+1\"\n        End With\n    Sheets(\"DropDowns\").Range(\"M6\").Value = \"64\"        \n    Application.EnableEvents = True\nEnd If\n\nE_H: \n    Application.EnableEvents = True\n    Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "vba"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 7001927, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10211095859817467/picture?type=large", "display_name": "Josh Dautel", "link": "https://stackoverflow.com/users/7001927/josh-dautel"}, "edited": false, "score": 0, "creation_date": 1497475611, "post_id": 44554727, "comment_id": 76100360, "body": "Sorry, the error is as follows:TypeError: open() got an unexpected keyword argument &#39;filename&#39;"}, {"owner": {"reputation": 123, "user_id": 7001927, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10211095859817467/picture?type=large", "display_name": "Josh Dautel", "link": "https://stackoverflow.com/users/7001927/josh-dautel"}, "edited": false, "score": 0, "creation_date": 1497475663, "post_id": 44554727, "comment_id": 76100385, "body": "Are you saying to have the code read like this?: xl.Workbooks.open(filename=r&quot;C:\\Users\\my\\full\\path\\Apartment&zwnj;&#8203;s.xlsx&quot;, ReadOnly=1)"}], "tags": [], "owner": {"reputation": 13367, "user_id": 2084384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h5lY8.jpg?s=128&g=1", "display_name": "BoarGules", "link": "https://stackoverflow.com/users/2084384/boargules"}, "is_accepted": false, "score": 0, "last_activity_date": 1497474340, "creation_date": 1497474340, "answer_id": 44554727, "question_id": 44553731, "link": "https://stackoverflow.com/questions/44553731/executing-visual-basic-macro-from-personal-macro-workbook-in-python/44554727#44554727", "title": "Executing Visual Basic Macro (from personal macro workbook) in Python", "body": "<p>It would help if you said what error you are getting, and I know that this path</p>\n\n<pre><code>\"C:\\Users\\my\\full\\path\\Apartments.xlsx\"\n</code></pre>\n\n<p>is not really what is in your code. But <code>\\</code> inside a string has a special meaning in Python (for example <code>\\n</code> is a newline and <code>\\f</code> is a formfeed). Whether your <code>\\</code> is interpreted as you intend depends on the character that comes after it. When you use Windows paths in Python it's generally less error-prone to use a raw string.</p>\n\n<pre><code>r\"C:\\Users\\my\\full\\path\\Apartments.xlsx\"\n</code></pre>\n\n<p>When you get that line to work, if the next line gives trouble, then post that as a separate question.</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 7001927, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10211095859817467/picture?type=large", "display_name": "Josh Dautel", "link": "https://stackoverflow.com/users/7001927/josh-dautel"}, "is_accepted": false, "score": 0, "last_activity_date": 1497542473, "creation_date": 1497542473, "answer_id": 44572087, "question_id": 44553731, "link": "https://stackoverflow.com/questions/44553731/executing-visual-basic-macro-from-personal-macro-workbook-in-python/44572087#44572087", "title": "Executing Visual Basic Macro (from personal macro workbook) in Python", "body": "<p>I got the first part of the code to work simply running the code as follows:</p>\n\n<pre><code>xl.workbooks.open(\"C:\\Users\\my\\full\\path\\Apartments.xlsx\")\n</code></pre>\n\n<p>Posted a separate question to get the macro to work correctly.</p>\n"}], "owner": {"reputation": 123, "user_id": 7001927, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10211095859817467/picture?type=large", "display_name": "Josh Dautel", "link": "https://stackoverflow.com/users/7001927/josh-dautel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1497542473, "creation_date": 1497470474, "question_id": 44553731, "link": "https://stackoverflow.com/questions/44553731/executing-visual-basic-macro-from-personal-macro-workbook-in-python", "title": "Executing Visual Basic Macro (from personal macro workbook) in Python", "body": "<p>I'm trying to execute a visual basic script that is located in my personal macro workbook on an excel file that I'm creating. Here's what I have so far:</p>\n\n<pre><code>import os\nimport win32com.client\ndf2.to_excel(\"Apartments.xlsx\")\nxl=win32com.client.Dispatch(\"Excel.Application\")\nxl.Workbooks.open(filename=\"C:\\Users\\my\\full\\path\\Apartments.xlsx\", ReadOnly=1)\nxl.Application.Run(\"Apartments.xlsx!create_chart.create_chart_proc\")\n</code></pre>\n\n<p>It's throwing an error when opening the excel file on line 5, I have a feeling line 6 won't work either because it comes from my personal macro book. Anyone have ideas on how to get it to function?</p>\n\n<p>PS. my module name is \"create_chart\" and my macro name is \"create_chart_proc\"</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497470716, "post_id": 44553651, "comment_id": 76097913, "body": "What are the data in that subform? How did it get in there and how is it bound to the parent form?"}, {"owner": {"reputation": 166, "user_id": 11348379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e157387f24dcebef764066025520d0?s=128&d=identicon&r=PG&f=1", "display_name": "SomeNerdAtWork", "link": "https://stackoverflow.com/users/11348379/somenerdatwork"}, "edited": false, "score": 0, "creation_date": 1565036383, "post_id": 44553651, "comment_id": 101217423, "body": "I am maintaining a legacy vba system right now and the previous dev used subforms like this and it was a pain in the butt to work with. I replaced them with listboxes and not only does it look neater, it is far easier to just do a clear and rebuild whenever an update needs to occur. Just my thoughts on another approach you can use."}], "answers": [{"comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 1, "creation_date": 1497470671, "post_id": 44553763, "comment_id": 76097892, "body": "I&#39;d suggest not using <code>DoCmd.RunSql</code> becauseit pops up a dialog asking if you really want to delete those records. And to get around that you need to disable warning and that is a whole can of worms. Much easier to instead use <code>CurrentDb.Execute</code> to do the same thing."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497470933, "post_id": 44553763, "comment_id": 76098028, "body": "Im confused how something as standard as DoCmd.SetWarnings false and then setting it to true is a can of worms, but hey whatever. same end results :)"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497471390, "post_id": 44553763, "comment_id": 76098259, "body": "While common it&#39;s not good practice.The fact that MS let&#39;s you shoot yourself in the foot with it is annoying enough. If you forget to unset it, if there is an error and you don&#39;t get the change to set it back. Either of these scenarios leave your DB doing really weird things down the road. It is particularly easy to avoid do you may as well not even put yourself in that situation."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497474620, "post_id": 44553763, "comment_id": 76099913, "body": "While we&#39;ll agree to disagree, however, UI testing, Error Handling and UI Flow are a thing. Specifically Error Handling."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497475338, "post_id": 44553763, "comment_id": 76100244, "body": "In addition to needing 3 lines as opposed to 1 to do the same thing here&#39;s an example of what can go (very confusingly) wrong. <a href=\"https://stackoverflow.com/questions/15761959/access-2007-inists-on-saving-queries\" title=\"access 2007 inists on saving queries\">stackoverflow.com/questions/15761959/&hellip;</a>"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497475753, "post_id": 44553763, "comment_id": 76100427, "body": "Sounds like a rookie mistake if you ask me. immediate window + ? DoCmd.SetWarnings True is a thing...."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497476263, "post_id": 44553763, "comment_id": 76100651, "body": "If you start littering your code with these and you have multiple people working on it these things happen. Easiest solution is to just not put yourself in that situation ever. Plus <code>CurrentDb.Execute</code> can execute saved queries which <code>RunSql</code> cannot do. I don&#39;t see why you would want to write more lines of code that are more fragile and less flexible?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497477636, "post_id": 44553763, "comment_id": 76101297, "body": "IDK do you think saving simple queries as queries makes more sense? Or is it actually easier to write inline SQL like this? Youre now going to start arguing best practices with style preference, which seems like you&#39;ve confused the two. Working in an environment with multiple access developers, this has yet to be an issue"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1497479083, "post_id": 44553763, "comment_id": 76101797, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/146707/discussion-between-brad-and-doug-coats\">continue this discussion in chat</a>."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 1, "creation_date": 1497479219, "post_id": 44553763, "comment_id": 76101834, "body": "@Brad It might not be tonight but i would be glad to let you tell me at another point your approach :)"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 0, "last_activity_date": 1497470562, "creation_date": 1497470562, "answer_id": 44553763, "question_id": 44553651, "link": "https://stackoverflow.com/questions/44553651/access-2010-how-to-i-clear-subform-after-a-new-record-is-add-vba/44553763#44553763", "title": "Access 2010 how to I clear SubForm after a new record is add (VBA", "body": "<p>Just delete the contents of the table the subform is bound to :) </p>\n\n<p>Part of your \"Send\" button can have this line of code</p>\n\n<pre><code>\"DoCmd.RunSql \"DELETE * FROM mytbl\"\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7090271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NTQ9D.png?s=128&g=1", "display_name": "Jacob C.", "link": "https://stackoverflow.com/users/7090271/jacob-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 44553763, "answer_count": 1, "score": 0, "last_activity_date": 1497477105, "creation_date": 1497470177, "last_edit_date": 1497477105, "question_id": 44553651, "link": "https://stackoverflow.com/questions/44553651/access-2010-how-to-i-clear-subform-after-a-new-record-is-add-vba", "title": "Access 2010 how to I clear SubForm after a new record is add (VBA", "body": "<p>I was just wondering if there is any way to clear subform after I click the button Send in VBA (Access 2010). I am able to clear the textbox and the cbox by using SetProperty<br>\n<a href=\"https://i.stack.imgur.com/3Zhvb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Zhvb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1497473366, "post_id": 44553378, "comment_id": 76099289, "body": "Application surely exists. If you post another question provide the code to demonstrate the results. <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 23, "user_id": 8162524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df5db0095bfed57d5daacd58d24a662f?s=128&d=identicon&r=PG&f=1", "display_name": "LtlBear", "link": "https://stackoverflow.com/users/8162524/ltlbear"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1497584926, "post_id": 44553378, "comment_id": 76149330, "body": "Sorry the CommandBars object does not exist in the Application object."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8162524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df5db0095bfed57d5daacd58d24a662f?s=128&d=identicon&r=PG&f=1", "display_name": "LtlBear", "link": "https://stackoverflow.com/users/8162524/ltlbear"}, "edited": false, "score": 0, "creation_date": 1497585006, "post_id": 44554474, "comment_id": 76149351, "body": "This code will not compile in Outlook 2016.  CommandBars is not an available object in either Active Explorer or Inspector.  In the object browser I see it as part of the Office object, but don&#39;t know how to get access to it."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 23, "user_id": 8162524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df5db0095bfed57d5daacd58d24a662f?s=128&d=identicon&r=PG&f=1", "display_name": "LtlBear", "link": "https://stackoverflow.com/users/8162524/ltlbear"}, "edited": false, "score": 0, "creation_date": 1497615347, "post_id": 44554474, "comment_id": 76165631, "body": "It is possible there was a change in 2016. This code works in 2013."}, {"owner": {"reputation": 23, "user_id": 8162524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df5db0095bfed57d5daacd58d24a662f?s=128&d=identicon&r=PG&f=1", "display_name": "LtlBear", "link": "https://stackoverflow.com/users/8162524/ltlbear"}, "edited": false, "score": 0, "creation_date": 1497637180, "post_id": 44554474, "comment_id": 76179300, "body": "I am guessing there was a change, but cannot find anything that will work.  I tried all kinds of options looking through the object browser, but no luck so far.  Cannot even get an idea to compile."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1497473261, "creation_date": 1497473261, "answer_id": 44554474, "question_id": 44553378, "link": "https://stackoverflow.com/questions/44553378/outlook-2016-vba-run-clean-up-folder-via-code/44554474#44554474", "title": "Outlook 2016 VBA - Run Clean Up Folder via code", "body": "<p>Not the Application. Use Inspector or Explorer as required.</p>\n\n<pre><code>Sub ExecuteMso_CleanUP()\n\n    Dim objExpl As Explorer\n\n    Set objExpl = ActiveExplorer\n    objExpl.CommandBars.ExecuteMso (\"ThreadCompressFolderRecursive\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8162524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df5db0095bfed57d5daacd58d24a662f?s=128&d=identicon&r=PG&f=1", "display_name": "LtlBear", "link": "https://stackoverflow.com/users/8162524/ltlbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593327504, "creation_date": 1497469218, "last_edit_date": 1593327504, "question_id": 44553378, "link": "https://stackoverflow.com/questions/44553378/outlook-2016-vba-run-clean-up-folder-via-code", "title": "Outlook 2016 VBA - Run Clean Up Folder via code", "body": "<p>I am trying to put code into Outlook VBA where I can loop through all my offline folders and run the \"Clean Up Folder &amp; Subfolders\" menu command on each folder.  I have tried several items and cannot get anything to work.  There is very little online and no working code.  All suggestions point to             Application.CommandBars.ExecuteMso (\"ThreadCompressFolderRecursive\"), but that object does not exist.  Any Ideas?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 8162415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CuogE.jpg?s=128&g=1", "display_name": "Jack Henderson", "link": "https://stackoverflow.com/users/8162415/jack-henderson"}, "edited": false, "score": 0, "creation_date": 1497532223, "post_id": 44553818, "comment_id": 76125340, "body": "Hey Siddharth, thanks for the response. So I went ahead and ran your code, and the following line came up with a &#39;Run-time Error 462&quot;.       oWordDoc.Bookmarks(BookMarksToDelete(i)).Delete"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 93, "user_id": 8162415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CuogE.jpg?s=128&g=1", "display_name": "Jack Henderson", "link": "https://stackoverflow.com/users/8162415/jack-henderson"}, "edited": false, "score": 0, "creation_date": 1497532594, "post_id": 44553818, "comment_id": 76125672, "body": "My Code is tested and tried :) BTW I am on my way to the gym. Will have to look at this when i come back. Double check if bookmarks exists and they do not have any extra spaces..."}, {"owner": {"reputation": 93, "user_id": 8162415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CuogE.jpg?s=128&g=1", "display_name": "Jack Henderson", "link": "https://stackoverflow.com/users/8162415/jack-henderson"}, "edited": false, "score": 0, "creation_date": 1497536201, "post_id": 44553818, "comment_id": 76128462, "body": "I got it figured out thank you once again. Also, how would I later that line to not just delete the bookmark, but also delete the text at it and the paragraph underneath it? (i.e. I have a header and a paragraph)."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1497471727, "last_edit_date": 1497471727, "creation_date": 1497470794, "answer_id": 44553818, "question_id": 44553042, "link": "https://stackoverflow.com/questions/44553042/finding-matches-between-an-excel-spreadsheet-and-vba-array/44553818#44553818", "title": "Finding Matches between an Excel Spreadsheet and VBA Array", "body": "<p><strong>Logic</strong></p>\n\n<ol>\n<li>Use <code>.Find</code> to check if the keywords are present in the range or not.</li>\n<li>Store the relevant keywords in a comma delimited string which will later be converted into an array</li>\n<li>Open word doc</li>\n<li>Loop through the array and delete the bookmarks</li>\n</ol>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim myArray As Variant, BookMarksToDelete As Variant\n    Dim oWordApp As Object, oWordDoc As Object\n    Dim sTemp As String, FlName As String\n    Dim aCell As Range, myRange As Range\n    Dim i As Long\n\n    '~~&gt; Change this to the relevant sheet\n    Set myRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C7:AP7\")\n\n    myArray = Array(\"cat\", \"dog\", \"bird\")\n\n    '~~&gt; Change this to the relevant word document\n    FlName = \"C:\\Users\\Siddharth\\Desktop\\DeleteMeLater.docx\"\n\n    For i = LBound(myArray) To UBound(myArray)\n        '~~&gt; Check if the word exists in the range or not\n        Set aCell = myRange.Find(What:=myArray(i), LookIn:=xlValues, _\n                    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n        '~~&gt; If it doesn't then store it in a comma delimited string\n        If aCell Is Nothing Then\n            sTemp = sTemp &amp; \",\" &amp; myArray(i)\n        Else\n            Set aCell = Nothing\n        End If\n    Next i\n\n    sTemp = Mid(sTemp, 2)\n\n    If Not Len(Trim(sTemp)) = 0 Then\n        '~~&gt; Convert comma delimited string to array\n        BookMarksToDelete = Split(sTemp, \",\")\n\n        '~~&gt; Open word document\n        Set oWordApp = CreateObject(\"Word.Application\")\n        oWordApp.Visible = True\n        Set oWordDoc = oWordApp.Documents.Open(FlName)\n\n        '~~&gt; Delete the bookmarks\n        For i = LBound(BookMarksToDelete) To UBound(BookMarksToDelete)\n            oWordDoc.Bookmarks(BookMarksToDelete(i)).Delete\n        Next i\n    End If\n\n    MsgBox \"Done\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "is_accepted": false, "score": 0, "last_activity_date": 1497470881, "creation_date": 1497470881, "answer_id": 44553844, "question_id": 44553042, "link": "https://stackoverflow.com/questions/44553042/finding-matches-between-an-excel-spreadsheet-and-vba-array/44553844#44553844", "title": "Finding Matches between an Excel Spreadsheet and VBA Array", "body": "<p>Does your code work? It's a little unclear what you're asking, unless that's just for feedback. All I personally have to say is the way you declare variables.</p>\n\n<p>So if you know what the variable will hold, it's best to declare it as such. For example,</p>\n\n<pre><code>Dim myRange as Range\n\nDim myArray(2) as String\nmyArray = {\"cat\", \"dog\", \"bird\"}\n\nDim reqName as String\n</code></pre>\n\n<p>I'm no expert either, just trying to help! Feel free to ask any questions, but I can't guarantee I have an answer.</p>\n"}], "owner": {"reputation": 93, "user_id": 8162415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CuogE.jpg?s=128&g=1", "display_name": "Jack Henderson", "link": "https://stackoverflow.com/users/8162415/jack-henderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 44553818, "answer_count": 2, "score": 1, "last_activity_date": 1497471727, "creation_date": 1497468043, "last_edit_date": 1497471029, "question_id": 44553042, "link": "https://stackoverflow.com/questions/44553042/finding-matches-between-an-excel-spreadsheet-and-vba-array", "title": "Finding Matches between an Excel Spreadsheet and VBA Array", "body": "<p>I'm new to Excel VBA and was looking for some help in fixing my code. So basically to provide colour on what I have, I have an excel database, and a word document. In the word document I have bookmarked section headers (reffered to as \"cat\", \"dog\", and \"bird\") and in a row on the excel database I have \"dog\" and \"bird\". </p>\n\n<p>What I am trying to do is write a code that compares the elements of the array (which are strings) to the cell values within a range declared in an excel database. For the values that exist in the array but not in the declared excel range, I want to delete those values (i.e. the bookmark) from the word document.</p>\n\n<p>If anyone could provide me with feedback, ideas, or example codes it would be greatly appreciated.</p>\n\n<p>Thanks.</p>\n\n<pre><code>Sub ArrayToDatabase()\n\nDim myRange As Variant\nSet myRange = Range(\"C7:AP7\")\n\nDim myArray As Variant\nmyArray = Array(\"cat\", \"dog\", \"bird\")\n\nDim i As Integer\nDim reqName As Object\nFor i = LBound(myArray) To UBound(myArray)\n    Set reqName = myArray(i).Value\n    If myRange.Validation(reqName) = False Then\n        wdApp.ActiveDocument.Bookmarks(reqName).Range._\n        Paragraphs(1).Range.Delete\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1497468559, "post_id": 44552807, "comment_id": 76096768, "body": "What code have you tried so far?"}, {"owner": {"reputation": 3, "user_id": 4734074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fc874102623b642e879b0ca31ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "AlexGeo", "link": "https://stackoverflow.com/users/4734074/alexgeo"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1497469258, "post_id": 44552807, "comment_id": 76097120, "body": "That&#39;s only one part of my project, the first part is to add an access table to a worksheet and then use that table to populate the other worksheet as you can see with the image 2 and 3. I&#39;m still in searching mode."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1497896366, "post_id": 44552807, "comment_id": 76260636, "body": "You should not put the input and output data as images; better to include them as text in your question."}, {"owner": {"reputation": 3, "user_id": 4734074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fc874102623b642e879b0ca31ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "AlexGeo", "link": "https://stackoverflow.com/users/4734074/alexgeo"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1497899447, "post_id": 44552807, "comment_id": 76262291, "body": "Thanks for the tip @ZevSpitz"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4734074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fc874102623b642e879b0ca31ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "AlexGeo", "link": "https://stackoverflow.com/users/4734074/alexgeo"}, "edited": false, "score": 0, "creation_date": 1497529010, "post_id": 44556150, "comment_id": 76123067, "body": "Thank a lot Zev Spitz! This is a very good begginning indeed. Now, if I want to name my worksheet according to my title attribut?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 3, "user_id": 4734074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fc874102623b642e879b0ca31ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "AlexGeo", "link": "https://stackoverflow.com/users/4734074/alexgeo"}, "edited": false, "score": 0, "creation_date": 1497531157, "post_id": 44556150, "comment_id": 76124574, "body": "@AlexGeo There&#39;s a line of code that sets the worksheet name. Modify that line to use the title from the array."}, {"owner": {"reputation": 3, "user_id": 4734074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fc874102623b642e879b0ca31ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "AlexGeo", "link": "https://stackoverflow.com/users/4734074/alexgeo"}, "edited": false, "score": 0, "creation_date": 1497893603, "post_id": 44556150, "comment_id": 76259137, "body": "Instead of creating worksheet, would it be possible to create workbook ?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 3, "user_id": 4734074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fc874102623b642e879b0ca31ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "AlexGeo", "link": "https://stackoverflow.com/users/4734074/alexgeo"}, "edited": false, "score": 0, "creation_date": 1497896195, "post_id": 44556150, "comment_id": 76260522, "body": "@AlexGeo If <code>Worksheets.Add</code> creates a new worksheet, what do you think would create a new workbook?"}, {"owner": {"reputation": 3, "user_id": 4734074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fc874102623b642e879b0ca31ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "AlexGeo", "link": "https://stackoverflow.com/users/4734074/alexgeo"}, "edited": false, "score": 0, "creation_date": 1497897452, "post_id": 44556150, "comment_id": 76261207, "body": "@Zed Spitz - this worked pretty well!  Sub Splitbook() Dim xPath As String xPath = Application.ActiveWorkbook.Path Application.ScreenUpdating = False Application.DisplayAlerts = False For Each xWs In ThisWorkbook.Sheets     xWs.Copy     Application.ActiveWorkbook.SaveAs Filename:=xPath &amp; &quot;\\&quot; &amp; xWs.Name &amp; &quot;.xls&quot;     Application.ActiveWorkbook.Close False Next Application.DisplayAlerts = True Application.ScreenUpdating = True End Sub"}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": true, "score": 0, "last_activity_date": 1497531116, "last_edit_date": 1497531116, "creation_date": 1497482464, "answer_id": 44556150, "question_id": 44552807, "link": "https://stackoverflow.com/questions/44552807/how-to-loop-in-a-table-to-generate-sheet-from-each-row-values-in-vba/44556150#44556150", "title": "How to loop in a table to generate sheet from each row values in VBA", "body": "<p>This should work as a beginning:</p>\n\n<pre><code>Function LastWorksheet() As Worksheet\n    Set LastWorksheet = Worksheets(Worksheets.Count)\nEnd Function\n\nSub Main()\n    Dim data() As Variant\n    data = Worksheets(\"Sheet1\").UsedRange.Value\n\n    Dim wks As Worksheet\n    Dim row As Integer, col As Integer\n    For row = 1 To UBound(data)\n        Set wks = Worksheets.Add(After:=LastWorksheet)\n        wks.Name = \"Output \" &amp; row\n        wks.Cells(1, 1) = \"What is the title?\"\n        wks.Cells(2, 1) = data(row, 1)\n        wks.Cells(4, 1) = \"What is the description?\"\n        wks.Cells(5, 1) = data(row, 2)\n        wks.Cells(7, 1) = \"What is the color?\"\n        wks.Cells(8, 1) = data(row, 3)\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4734074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fc874102623b642e879b0ca31ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "AlexGeo", "link": "https://stackoverflow.com/users/4734074/alexgeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "closed_date": 1497495806, "accepted_answer_id": 44556150, "answer_count": 1, "score": -1, "last_activity_date": 1497893861, "creation_date": 1497467266, "last_edit_date": 1497893861, "question_id": 44552807, "link": "https://stackoverflow.com/questions/44552807/how-to-loop-in-a-table-to-generate-sheet-from-each-row-values-in-vba", "closed_reason": "Needs details or clarity", "title": "How to loop in a table to generate sheet from each row values in VBA", "body": "<p>I'm new to the world of VBA, but I know we can do that.\nFrom a table containing X (variable) Row and AN (40) Columns (image 1), I want to populate cells in other worksheet (image 2 and 3) according to cells in a single line. </p>\n\n<p>How can I loop throught my table (img1), create worksheet according to the number of line in my table and take cells from that table to populate the new worksheet I have just created?</p>\n\n<p>I really need to do that with a macro since i'll have 350 lines in my real table.</p>\n\n<p>**Zev Spitz replied correctly to my question</p>\n\n<p>I illustrated my project with these images:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dui6V.jpg\" rel=\"nofollow noreferrer\">my project in image</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1497468634, "post_id": 44553053, "comment_id": 76096809, "body": "Your next step is likely to use the <code>Range.Sort</code> <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow noreferrer\">MSDN link</a> which will identify the highest, next highest, and so on."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1497468738, "post_id": 44553053, "comment_id": 76096864, "body": "@PeterT that would be the best way if the data can be sorted, I have seen where the bosses do not like the data messed with in any way."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1497468864, "post_id": 44553053, "comment_id": 76096911, "body": "Very true, and in that case I&#39;d copy the data to a temporary/unused range (or worksheet) and sort the copy to find the ordered data. Or at least that&#39;s one approach. The OP needs to specify any additional constraints he may have and we&#39;ll lend a hand as needed :)"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1497532500, "post_id": 44553053, "comment_id": 76125593, "body": "@ScottCraner All, I updated my question with images so it makes more sense. The first image is the data I start out with, the second is the goal, only I want the name in col B not the value. The values are not being sorted, they are being entered as seeds (think of it is a head-to-head contest)"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1497540649, "post_id": 44553053, "comment_id": 76131765, "body": "@ScottCraner It works up to the nngr2.Range(&quot;B4&quot;).value = arr(1,1) line.  I then get a 438 run time error, &quot;object doesn&#39;t support this property or method&quot;. nngr2 is a workbook declared earlier in the script.  It is not active when the code you provided runs, so I tried adding nngr2.Activate just above this part, but that does not help."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1497541067, "post_id": 44553053, "comment_id": 76132051, "body": "I did a debug.print for each variable, and the correct name shows up.  So the only issue is the very last part"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1497542021, "post_id": 44553053, "comment_id": 76132629, "body": "Then you need to add the sheet: <code>nngr2.Worksheets(&quot;Sheet1&quot;).Range(&quot;B4&quot;).value = arr(1,1)</code>"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1497542127, "post_id": 44553053, "comment_id": 76132702, "body": "Ah yes I was just about to respond, dumbing it down worked too: <code>Range(&quot;B4&quot;) = arr(1, 1)</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1497470755, "last_edit_date": 1497470755, "creation_date": 1497468075, "answer_id": 44553053, "question_id": 44552790, "link": "https://stackoverflow.com/questions/44552790/excel-vba-find-values-in-a-range-and-store-adjacent-cell-in-variable/44553053#44553053", "title": "Excel VBA - Find values in a range and store adjacent cell in variable", "body": "<p>Here is a starting point, this loads a 2 dimensional array with the values and pastes those values in E4 of the active sheet:</p>\n\n<pre><code>Sub Macro1()\n\nDim rng As Range\nDim arr(1 To 4, 1 To 2)\n\nSet rng = [C4:C16]\n\nFor i = 1 To 4\n    arr(i, 2) = Application.WorksheetFunction.Large(rng, i)\n    arr(i, 1) = rng.Cells(Application.WorksheetFunction.Match(arr(i, 2), rng, 0)).Offset(, -1).Value\nNext i\n\nnngr2.Range(\"B4\").value = arr(1,1)\nnngr2.Range(\"B11\").value = arr(2,1)\nnngr2.Range(\"B9\").value = arr(3,1)\nnngr2.Range(\"B6\").value = arr(4,1)\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/BNOt0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BNOt0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1036, "favorite_count": 0, "accepted_answer_id": 44553053, "answer_count": 1, "score": 0, "last_activity_date": 1497470755, "creation_date": 1497467198, "last_edit_date": 1497469549, "question_id": 44552790, "link": "https://stackoverflow.com/questions/44552790/excel-vba-find-values-in-a-range-and-store-adjacent-cell-in-variable", "title": "Excel VBA - Find values in a range and store adjacent cell in variable", "body": "<p>I have code that is now able to take a range of values and find the highest, next highest, and so on values and paste them as variables to a different workbook.</p>\n\n<p>What I am now trying to do is find the string (in this case, name) adjacent to a specific value, and paste that string in the other workbook.</p>\n\n<p>I know what I need to use to do that, but I am not getting it right.</p>\n\n<p>The section between the comment lines is where the issue is, as everything else works on its own.</p>\n\n<pre><code>Dim sipRng As Range: Set sipRng = [G1]\nDim rng As Range: Set rng = [C4:C16]\nDim firstVal As Double, secondVal As Double, thirdVal As Double, fourthVal As Double, cel As Range\nDim var As Variant, iSheet As Integer, iRow As Long, iRowL As Long\n\nFor Each cel In sipRng\n    If InStr(cel.Value, \"Inbound AHT\") &gt; 0 Or InStr(cel.Value, \"Valid Quality Count\") &gt; 0 Or InStr(cel.Value, \"Valid Quality %\") &gt; 0 Then\n        firstVal = Application.Small(rng, 1)\n        secondVal = Application.Small(rng, 2)\n        thirdVal = Application.Small(rng, 3)\n        fourthVal = Application.Small(rng, 4)\n    ElseIf InStr(cel.Value, \"Outbound Calls Made\") &gt; 0 Or InStr(cel.Value, \"FCR %\") &gt; 0 Or InStr(cel.Value, \"FLR %\") &gt; 0 Or InStr(cel.Value, \"Corrected CSAT Average\") &gt; 0 Then\n        firstVal = Application.Large(rng, 1)\n        secondVal = Application.Large(rng, 2)\n        thirdVal = Application.Large(rng, 3)\n        fourthVal = Application.Large(rng, 4)\n    End If\nNext cel\n\n'''''''''''''''''\niRowL = Cells(Rows.Count, 2).End(xlUp).Row\nFor iRow = 1 To iRowL\n    If Not IsEmpty(Cells(iRow, 1)) Then\n        For iSheet = ActiveSheet.Index + 1 To Worksheets.Count\n            var = Application.Match(Cells(iRow, 2).Value, Worksheets(iSheet).Columns(2), 0)\n        Debug.Print var\n        Next iSheet\n    End If\nNext iRow\n''''''''''''''\n\nnngr2.Activate\nRange(\"B4\") = firstVal\nRange(\"B11\") = secondVal\nRange(\"B9\") = thirdVal\nRange(\"B6\") = fourthVal\n</code></pre>\n\n<p>This is what I start with</p>\n\n<p><a href=\"https://i.stack.imgur.com/SJ4XG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SJ4XG.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is the goal, only instead of the values, I want the name (in this case, letter)</p>\n\n<p><a href=\"https://i.stack.imgur.com/5fYeX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5fYeX.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "compiler-errors", "compilation"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1497467940, "post_id": 44552786, "comment_id": 76096426, "body": "In Module 2, <code>Sub Format()</code> overwrites the built-in function used in Module 1 (<code>monthfolder = Format(fDate, &quot;mm. mmmm YYYY&quot;)</code>). Rename <code>Sub Format()</code> to <code>Sub Format1()</code> and update the code where needed"}, {"owner": {"reputation": 13, "user_id": 8162385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e179cf970e1923357a3f08b85859ff5e?s=128&d=identicon&r=PG&f=1", "display_name": "dougiek", "link": "https://stackoverflow.com/users/8162385/dougiek"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1497468172, "post_id": 44552786, "comment_id": 76096548, "body": "Wow - glad I spent like 4 hours trying to research what the heck was wrong. Thank you kindly! I guess the lesson here is not to name sub&#39;s with function name."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1497468784, "creation_date": 1497468784, "answer_id": 44553250, "question_id": 44552786, "link": "https://stackoverflow.com/questions/44552786/adding-additional-vba-module-creates-compile-error-when-running-previously-worki/44553250#44553250", "title": "Adding additional VBA module creates Compile Error when running previously working module", "body": "<p>In Module 2, <code>Sub Format()</code> overwrites the built-in function used in Module 1 </p>\n\n<pre><code>(monthfolder = Format(fDate, \"mm. mmmm YYYY\"))\n</code></pre>\n\n<p>Rename <code>Sub Format()</code> to <code>Sub Format1()</code> and update the code where needed</p>\n\n<p>A simple way to determine a conflict is to click inside the function name and pressing F1 to activate the help module - it should come back with \"Keyword Not Found\"</p>\n"}], "owner": {"reputation": 13, "user_id": 8162385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e179cf970e1923357a3f08b85859ff5e?s=128&d=identicon&r=PG&f=1", "display_name": "dougiek", "link": "https://stackoverflow.com/users/8162385/dougiek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 44553250, "answer_count": 1, "score": 0, "last_activity_date": 1497468784, "creation_date": 1497467179, "question_id": 44552786, "link": "https://stackoverflow.com/questions/44552786/adding-additional-vba-module-creates-compile-error-when-running-previously-worki", "title": "Adding additional VBA module creates Compile Error when running previously working module", "body": "<p>Trying to incorporate two modules into an excel sheet and am running into an issue that I haven't been able to diagnose. Independently the modules work but when both are in the file it gives me a \"Compile Error: Wrong number of arguments or invalid property assignment\" with the Sub line highlighted in debug. I don't know enough to diagnose further and was hoping I could get some guidance here. </p>\n\n<p>Module 1 - creates new file and email</p>\n\n<pre><code>    Dim fPO As String\n    Dim fDate As Date\n    Dim fPath As String\n    Dim POFile As String\n    Dim Template As String\n    Dim yearfolder As String\n    Dim monthfolder As String\n    Dim newfolderpath As String\n    Dim FileName As String\n\nSub CreatePOFile()\n'\n' Creates new file for each PO\n'\n\n'\n\n\n    fPO = Range(\"C4\").Value\n    fDate = Date - 3 'adjust to change date used in file name\n    fPath = \"\\\\Kforce.com\\Group\\TAMPA\\CORP\\Strategic Accounts\\Strategic Accounts Operations\\CLIENT REPORTS\\HP\\HP Weekly PO Reporting\" 'adjust where file is saved\n    Template = ActiveWorkbook.Name\n    monthfolder = Format(fDate, \"mm. mmmm YYYY\")\n    yearfolder = Format(fDate, \"YYYY\")\n    newfolderpath = fPath &amp; \"\\\" &amp; yearfolder &amp; \"\\\" &amp; monthfolder\n    FileName = fPO &amp; \" Weekly Report as of \" &amp; Format(fDate, \"yyyymmdd\")\n\n'\n'\n'\n\n    'Format pivot table header\n    Rows(\"7:7\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n    End With\n\n    'Create new workbook and save individual PO file. Creates new folders if nonexistant\n    Workbooks.Add\n\n    If Len(Dir(fPath &amp; \"\\\" &amp; yearfolder, vbDirectory)) = 0 Then\n        MkDir fPath &amp; \"\\\" &amp; yearfolder\n    End If\n    If Len(Dir(fPath &amp; \"\\\" &amp; yearfolder &amp; \"\\\" &amp; monthfolder, vbDirectory)) = 0 Then\n        MkDir fPath &amp; \"\\\" &amp; yearfolder &amp; \"\\\" &amp; monthfolder\n    End If\n\n    ActiveWorkbook.SaveAs FileName:=newfolderpath &amp; \"\\\" &amp; FileName, FileFormat:=51\n    Application.DisplayAlerts = True\n\n    POFile = ActiveWorkbook.Name\n\n    'Copy Pivot information to new file\n    Windows(Template).Activate\n    Range(\"B7\").Select\n    ActiveCell.CurrentRegion.Select\n    Selection.SpecialCells(xlCellTypeVisible).Select\n    Selection.Copy\n    Range(\"A1\").Select\n\n    Windows(POFile).Activate\n    Range(\"B7\").Select\n    ActiveSheet.Paste\n\n    ActiveSheet.Name = fPO\n\n    'Formatting PO File and adding information fields\n    Range(\"B2\").Select\n    ActiveCell.FormulaR1C1 = \"Weekly PO Report\"\n    With Selection.Font\n    .Name = \"Calibri Light\"\n        .Size = 18\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ThemeColor = xlThemeColorLight2\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontMajor\n    End With\n\n    Range(\"B4\").Value = \"PO Number:\"\n    Range(\"B5\").Value = \"Date Range:\"\n\n    Range(\"B4:B5\").Select\n    With Selection\n        .Interior.Pattern = xlSolid\n        .Interior.PatternColorIndex = xlAutomatic\n        .Interior.ThemeColor = xlThemeColorAccent2\n        .Interior.TintAndShade = 0\n        .Interior.PatternTintAndShade = 0\n        .Font.ThemeColor = xlThemeColorDark1\n        .Font.TintAndShade = 0\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n\n    Range(\"C4\").Value = fPO\n    Range(\"C5\").FormulaR1C1 = \"=TEXT(MIN(C[-1]),\"\"m/d/yyyy\"\")&amp;\"\" - \"\"&amp;TEXT(MAX(C[-1]),\"\"m/d/yyyy\"\")\"\n    Range(\"C4:C5\").Select\n    With Selection\n        .Interior.Pattern = xlSolid\n        .Interior.PatternColorIndex = xlAutomatic\n        .Interior.ThemeColor = xlThemeColorDark1\n        .Interior.TintAndShade = -0.149998474074526\n        .Interior.PatternTintAndShade = 0\n        .HorizontalAlignment = xlCenter\n    End With\n\n    Cells.Select\n    Cells.EntireColumn.AutoFit\n    Columns(\"B:B\").Select\n    Selection.ColumnWidth = 15\n    ActiveWindow.DisplayGridlines = False\n    Range(\"A1\").Select\n\n\n    'asks if email should be created\n    Dim answer As Integer\n\n    answer = MsgBox(\"Would you like to create email?\", vbYesNo + vbQuestion, \"Email Option\")\n\n    If answer = vbYes Then EmailFile\n    Else\n    End If\n\nEnd Sub\n\nSub EmailFile()\n\n    'Creates email with file attached\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim MailBody As String\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    MailBody = \"&lt;p style='font-family:calibri;font-size:11pt'&gt;\" &amp; \"Hello,&lt;br&gt;&lt;br&gt;\" &amp; _\n                \"Attached you will find the weekly report for \" &amp; fPO &amp; \".\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n                \"If you have any questions or discrepancies, please let me know!&lt;br&gt;&lt;br&gt;Regards,\" &amp; \"&lt;/p&gt;\"\n\n    On Error Resume Next\n    With OutMail\n        .Display\n        .to = \"\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = FileName\n        .HTMLbody = MailBody &amp; .HTMLbody\n        .Attachments.Add ActiveWorkbook.FullName\n\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Module 2 - formats raw data tab for ease of use</p>\n\n<pre><code>Sub Format()\n'\n' Removes previous raw data and deletes the blank rows so the table doesn't need to be resized upon copy paste of new data\n'\n\n    On Error Resume Next\n    Rows(\"4:\" &amp; Rows.Count).ClearContents\n    Range(\"raw[Last Name]\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n    Range(\"A3:Z3\").ClearContents\n    Range(\"A3\").Activate\n\n\nEnd Sub\n\nSub Refresh()\n\nIf Range(\"A3\") = \"\" Then\n\nMsgBox (\"Please paste new data before clicking Refresh.\")\n\nElse\n    ActiveWorkbook.RefreshAll\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1497475046, "post_id": 44552766, "comment_id": 76100113, "body": "Can you post a few rows of input data in <i>DATA</i> worksheet? And not as screenshot. That way, we can grab the data with your code to run on our end (i.e., <a href=\"https://stackoverflow.com/help/mcve\">reproducible example</a>)."}, {"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1497536582, "post_id": 44552766, "comment_id": 76128820, "body": "@Parfait Most definitely! I added the Data in a new &quot;Requested Data:&quot; section as well as all the other codes so you can have a working version :) Thanks a lot for looking into this! There is also a FileBrowser and Startform to trigger the script, would you need these also?"}, {"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1497562618, "post_id": 44552766, "comment_id": 76143554, "body": "@Parfait I settled to share the file itself instead as there are too functions and subs that needs each other to get this to work without. Let me know if this is an issue but I don&#39;t think I can find another way to efficiently share the project."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1497629043, "post_id": 44552766, "comment_id": 76174924, "body": "How did you get an Excel file like that? It seems to have derived from an XML source."}, {"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1497639915, "post_id": 44552766, "comment_id": 76180747, "body": "It is from a website named CodeProject. I&#39;ll need to modify it heavily to fit my need but I need to be able to crack that problem first, else I can&#39;t go on with what I have to do."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1497657127, "post_id": 44552766, "comment_id": 76186936, "body": "So it is an XML source? Consider XSLT then that transforms XML from one form to another. Excel VBA can run XSLT. Post the source XML."}], "owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1497562549, "creation_date": 1497467107, "last_edit_date": 1497562549, "question_id": 44552766, "link": "https://stackoverflow.com/questions/44552766/excel-vba-allowing-for-repeating-group-nodes-in-xml", "title": "Excel VBA - Allowing for repeating group nodes in XML?", "body": "<hr>\n\n<h2><strong>Introduction:</strong></h2>\n\n<hr>\n\n<p>Hello everyone,</p>\n\n<p>I looked into every VBA XML topic on StackOverflow to no avail. Apologies as this request is quite a chunk but I attempted to ease the flow as much as possible.</p>\n\n<p>I need to have an Excel to XML converter with dynamically generated template/layout to import into a website. Meaning that I cannot use the integrated Excel to XML as I would have to provide a template and I need the script to be able to generate depending on a user's intent.</p>\n\n<p>For that, I am using a modified version of the Excel to XML script from Raymond Pang over CodeProject (2004).</p>\n\n<p>The script uses \"/\" delimiters to define the depth and path of the nodes.</p>\n\n<hr>\n\n<h2><strong>The Problem:</strong></h2>\n\n<hr>\n\n<p>The issue I have at the moment is that I cannot have it to generate repeating groups (that is multiple child nodes group of the same name). Specifically, the way the website works is that I need to have multiple Sections/Section groups.</p>\n\n<hr>\n\n<h2><strong>Example:</strong></h2>\n\n<hr>\n\n<p>Here's an example Row with Repeating Group Nodes to generate in XML :\n<a href=\"https://i.stack.imgur.com/VtTs6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VtTs6.png\" alt=\"Example Row to Generate in XML with Repeating Group Nodes\"></a></p>\n\n<p>The script currently generates it like that:\n<a href=\"https://i.stack.imgur.com/o6eV9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o6eV9.png\" alt=\"Wrong as it is only one group named Section\"></a></p>\n\n<p>While I need it to generate like that:\n<a href=\"https://i.stack.imgur.com/ABmB8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ABmB8.png\" alt=\"Right as I have two Section groups\"></a></p>\n\n<p><strong>If what I mean is unclear kindly let me know and I'll try to elaborate.</strong></p>\n\n<hr>\n\n<h2><strong>The Script:</strong></h2>\n\n<hr>\n\n<p>Now here's the script used to generate the XML aboves from the \"<em>/suite/sections/section/sections/section/sections/section/name</em>\" header.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function GenerateXMLDOM(rngData As Range, rootNodeName As String)\n\nWith Worksheets(\"DATA\")\nConst NODE_DELIMITER As String = \"/\"   ' the default node delimiter\nDim intColCount As Integer\nDim intRowCount As Integer\nDim intColCounter As Integer\nDim intRowCounter As Integer\nDim Location As String\n\nLocation = \"A1:C1\"\n\nDim rngCell As Range\nDim rngCell2 As Range\n\n' Create the XML DOM object\nSet ObjXMLDoc = CreateObject(\"Microsoft.XMLDOM\")\nObjXMLDoc.async = False\n\n\n' NODE_PROCESSING_INSTRUCTION(7) --- reference http://www.devguru.com/Technologies/xmldom/quickref/obj_node.html\nSet Heading = ObjXMLDoc.createNode(7, \"xml\", \"\")\nObjXMLDoc.appendchild (Heading)\n\n' Set the root node\nSet top_node = ObjXMLDoc.createNode(1, rootNodeName, \"\")\nObjXMLDoc.appendchild (top_node)\n\n\n\nDim Nodes() As String       'Array storing the current splited node names\nDim NodeStack() As String   'Array storing the last node names\n\nDim new_nodes()\nReDim NodeStack(0)\nReDim new_nodes(0)\n\n\n With rngData  ' The selected region on the DATA Excel Sheet passed in\n\n    '   Discover dimensions of the data it will be dealing with...\n    intColCount = .Columns.Count\n    intRowCount = .Rows.Count\n\n    Dim strColNames() As String     ' The Array of column names\n    ReDim strColNames(intColCount)\n\n\n\n    ' First Row is the Field/Tag names\n    ' Extract all the field names into array \"strColNames\"\n    If intRowCount &gt;= 1 Then\n        '   Loop accross columns... and put names in array\n        For intColCounter = 1 To intColCount\n\n            '   Mark the cell under current scrutiny by setting\n            '   an object variable...\n            Set rngCell = .Cells(1, intColCounter)\n\n            '  not support merged cells .. so quit\n            If Not rngCell.MergeArea.Address = _\n                                        rngCell.Address Then\n                  MsgBox (\"!! Cell Merged ... Invalid format\")\n                  Exit Function\n            End If\n\n            strColNames(intColCounter) = rngCell.Text\n\n        Next\n    End If\n\n    '   Loop down the table's rows\n    For intRowCounter = 2 To intRowCount\n\n        ReDim new_nodes(0)\n        ReDim NodeStack(0)\n        '   Loop accross columns...\n        For intColCounter = 1 To intColCount\n\n            '   Mark the cell under current scrutiny by setting\n            '   an object variable...\n            Set rngCell = .Cells(intRowCounter, intColCounter)\n\n\n            '   Is the cell merged?..\n            If Not rngCell.MergeArea.Address = _\n                                        rngCell.Address Then\n\n                  MsgBox (\"!! Cell Merged ... Invalid format\")\n                  Exit Function\n\n\n            End If\n\n            ' divide the field name by the delimiter to get appropriate node names\n            Nodes = Split(strColNames(intColCounter), NODE_DELIMITER)\n\n            If UBound(Nodes) = 0 Then\n              ReDim Nodes(1)\n              Nodes(1) = strColNames(intColCounter)\n            End If\n\n             ' don't count it when no content\n             If Trim(rngCell.Text) &lt;&gt; \"\" Then\n\n                Dim i As Integer\n                MatchAll = True\n                For i = 1 To UBound(Nodes)\n\n                    If i &lt;= UBound(NodeStack) Then\n\n                        If Trim(Nodes(i)) &lt;&gt; Trim(NodeStack(i)) Then\n                            'not match\n                            MatchAll = False\n                            Exit For\n\n                        End If\n                    Else\n                      MatchAll = False\n                      Exit For\n                    End If\n\n\n                  Next\n\n                  ' match all means in same level as previous, so it needs to output for the last node\n                  If MatchAll Then\n                      i = i - 0\n                  End If\n\n\n                  If UBound(new_nodes) &lt; UBound(Nodes) Then\n                         ' enlong the array\n                         ReDim Preserve new_nodes(UBound(Nodes))\n\n\n                  End If\n\n                  For t = i To UBound(Nodes)\n                      ' create uncommon nodes with the previous one\n                      Set new_nodes(t) = ObjXMLDoc.createNode(1, Nodes(t), \"\")\n\n                  Next\n\n\n                  For t = i - 1 To UBound(Nodes) - 1\n\n                      If t &gt;= 1 Then\n                          ' connect the nodes based on the hierarchy\n                          new_nodes(t).appendchild (new_nodes(t + 1))\n                      End If\n\n                  Next\n                  Set Textcont = ObjXMLDoc.createTextNode(Trim(rngCell.Text))\n                  new_nodes(UBound(Nodes)).appendchild (Textcont)\n\n                  If i = 1 Then\n                      top_node.appendchild (new_nodes(1))\n                  End If\n\n\n                  NodeStack = Nodes\n\n\n\n              End If\n\n        Next ' finished a column\n    Next\nEnd With\n\n\n'   Return the XMLDOM\n Set GenerateXMLDOM = ObjXMLDoc\n\nEnd With\nEnd Function\n</code></pre>\n\n<hr>\n\n<h2><strong>Troubleshooting:</strong></h2>\n\n<hr>\n\n<p>I believe the issue resides within the fact that I add the child notes and instantly go back to the root .</p>\n\n<p><em>Node (t)</em> is always <em>\"/Suite/\"</em>\n<a href=\"https://i.stack.imgur.com/D1ChK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D1ChK.png\" alt=\"enter image description here\"></a></p>\n\n<p>I believe a solution would be to give a way to the script to remember the parent node  and consider that any  after that are groups within themselves.</p>\n\n<p>Other than the fact I failed to code this in, I also can't have ALL instances of Sections/Section to create groups as I may have something like <em>Sections/Section/Sections/Section/Sections/Section/Sections/Section/Name</em> depending on the depth of layer the data needs to be.\nPerhaps by having something check the name of the directory and if the header ends in \"/Section\" it creates a group and if there is something else after \"/Section\" it continues down the path? Any other way to do this?</p>\n\n<p>A tremendous amount of thanks for any help, hints and attempt at fixing this.</p>\n\n<hr>\n\n<h2><strong>Requested Data:</strong></h2>\n\n<hr>\n\n<p><strong>Edit: There are too many modules and a Startform intertwined together to get this to work efficiently piece by piece.\nI have thus uploaded the file in question on my Google Drive, it will be much easier for you to check it out.</strong> </p>\n\n<p>Apologies if this isn't allowed, I did look around and didn't find anything against it. But I realized there is no way I can efficiently share the project otherwise unless I do a major hack into it to simplify it and it might void results.</p>\n\n<p><a href=\"https://drive.google.com/open?id=0B4nBtjoQSKsSSVRhVEp6dklDYlU\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=0B4nBtjoQSKsSSVRhVEp6dklDYlU</a></p>\n\n<p>This is an example of header another script will generate from user-inputted Data. This is usually in the very first row of the DATA sheet, the cells below each of these lines contain the information (name, description etc.) you can input anything in these. I haven't found a way to paste these successfully, apologies for that.</p>\n\n<p>These are two sets of the same path as demonstrated in the screenshots above, I need the second set to be separated from the first at the previous /sections/ node. </p>\n\n<pre><code>/suite/sections/section/sections/section/name   /suite/sections/section/sections/section/description    /suite/sections/section/sections/section/sections/section/name  /suite/sections/section/sections/section/name   /suite/sections/section/sections/section/description    /suite/sections/section/sections/section/sections/section/name\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos", "excel-2011"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1497466707, "post_id": 44552599, "comment_id": 76095840, "body": "are any lines highlighted when you get the error?"}, {"owner": {"reputation": 1, "user_id": 8162275, "user_type": "registered", "profile_image": "https://graph.facebook.com/1604905776206703/picture?type=large", "display_name": "Jascha Ell", "link": "https://stackoverflow.com/users/8162275/jascha-ell"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1497466810, "post_id": 44552599, "comment_id": 76095894, "body": "yes, the first line &#39;Sub Schaltfl&#228;che1_Klicken()&#39;"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1497467741, "post_id": 44552599, "comment_id": 76096325, "body": "how are you kicking the code off?  is it an ActiveX button click event?"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1497467873, "post_id": 44552599, "comment_id": 76096390, "body": "this may be worth a read.  Seems that if you&#39;re using an ActiveX button, it won&#39;t work on a Mac (<a href=\"https://www.mrexcel.com/forum/excel-questions/546289-office-mac-2011-excel-command-buttons.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497468092, "post_id": 44552599, "comment_id": 76096503, "body": "Just tested it on Mac. it was giving me the error which you got but now it is not. Can you delete your code and re paste it and try again. I did just that and it worked"}, {"owner": {"reputation": 1, "user_id": 8162275, "user_type": "registered", "profile_image": "https://graph.facebook.com/1604905776206703/picture?type=large", "display_name": "Jascha Ell", "link": "https://stackoverflow.com/users/8162275/jascha-ell"}, "edited": false, "score": 0, "creation_date": 1497468153, "post_id": 44552599, "comment_id": 76096536, "body": "In the Windows version it is a command button in a user form, for Mac (after my first few attempts) I moved the code directly to a button on the worksheet (inserted through developer tab). Neither options worked so far."}, {"owner": {"reputation": 1, "user_id": 8162275, "user_type": "registered", "profile_image": "https://graph.facebook.com/1604905776206703/picture?type=large", "display_name": "Jascha Ell", "link": "https://stackoverflow.com/users/8162275/jascha-ell"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497468394, "post_id": 44552599, "comment_id": 76096669, "body": "@SiddharthRout I have no idea what happened but it works now as well."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497468757, "post_id": 44552599, "comment_id": 76096870, "body": "I have realised why you were getting the error... Posting an answer"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1497469452, "last_edit_date": 1497469452, "creation_date": 1497467401, "answer_id": 44552852, "question_id": 44552599, "link": "https://stackoverflow.com/questions/44552599/compile-error-expected-function-or-variable/44552852#44552852", "title": "Compile error: Expected Function or variable", "body": "<p>The error handling in VBA Excel 2011 is not as great as it's Window's counterpart.</p>\n\n<p>You were getting that error because you were using <code>With/End With</code> with <code>ActiveCell.Offset(0, 1).Select</code></p>\n\n<p>The best way to reproduce that error is paste this code in a module</p>\n\n<pre><code>Sub Schaltfl\u00e4che1_Klicken()\n    With ActiveCell.Offset(0, 1).Select\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kNLPi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kNLPi.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Note</strong>: You and I didn't get that error later because you modified your post which we both tested :)</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Interesting Read</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8162275, "user_type": "registered", "profile_image": "https://graph.facebook.com/1604905776206703/picture?type=large", "display_name": "Jascha Ell", "link": "https://stackoverflow.com/users/8162275/jascha-ell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1026, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593563647, "creation_date": 1497466599, "last_edit_date": 1593563647, "question_id": 44552599, "link": "https://stackoverflow.com/questions/44552599/compile-error-expected-function-or-variable", "title": "Compile error: Expected Function or variable", "body": "<p>I have this macro (written in Excel 2016/Windows) that acts a very simple reservation tool, checking if an asset is currently booked or free. Depending on this, it either writes when the booked period will end or when the next booked period will start in another worksheet:</p>\n\n<pre><code>Sub Schaltfl\u00e4che1_Klicken()\n\nWorksheets(\"Tabelle10\").Activate                                        \nWith Columns(4)                                                         \n.Find(what:=\"*\", after:=.Cells(1, 1), LookIn:=xlValues).Activate    \nEnd With\n\nActiveCell.Offset(0, -3).Select                                    \n\nIf Selection.Value = \"TODAY AM\" Then\nSheets(\"HTML Output\").Range(\"B3\").Value = \"Desk booked from this afternoon. Next availability\"\n\nActiveCell.Offset(0, 3).Select\nDo Until IsEmpty(ActiveCell)            \nActiveCell.Offset(1, 0).Select\nLoop  \n\nActiveCell.Select\n\nActiveCell.Offset(0, -2).Select\n\nSelection.Copy\n\nSheets(\"HTML Output\").Range(\"C3\").PasteSpecial xlPasteValues\n\nActiveCell.Offset(0, 1).Select\n\nSelection.Copy\n\nSheets(\"HTML Output\").Range(\"D3\").PasteSpecial xlPasteValues\n\nElseIf Selection.Value = \"TODAY PM\" Then\nSheets(\"HTML Output\").Range(\"B3\").Value = \"Desk booked from this afternoon. Next availability\"\n\nActiveCell.Offset(0, 3).Select\n\nDo Until IsEmpty(ActiveCell)            \nActiveCell.Offset(1, 0).Select\nLoop\n\nActiveCell.Select\n\nActiveCell.Offset(0, -2).Select\n\nSelection.Copy\n\nSheets(\"HTML Output\").Range(\"C3\").PasteSpecial xlPasteValues\n\nActiveCell.Offset(0, 1).Select\n\nSelection.Copy\n\nSheets(\"HTML Output\").Range(\"D3\").PasteSpecial xlPasteValues\n\nElseIf Selection.Value = \"TOMORROW AM\" Or Selection.Value = \"TOMORROW PM\" Or  Selection.Value = \"FUTURE\" Then\n\nSheets(\"HTML Output\").Range(\"B3\").Value = \"Desk free until (including)\"\n\nActiveCell.Offset(-1, 1).Select\n\nSelection.Copy\n\nSheets(\"HTML Output\").Range(\"C3\").PasteSpecial xlPasteValues\n\nActiveCell.Offset(0, 1).Select\n\nSelection.Copy\n\nSheets(\"HTML Output\").Range(\"D3\").PasteSpecial xlPasteValues\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This works perfectly fine in Office 2016 (Windows 10) but results in a Compile error: Expected Function or variable when I try to run it in Office 2011 for Mac or Office 2015 for Mac.</p>\n\n<p>Can anyone point me in the right directions as for the reason(s) for this or tell me how to change the code to make it work?</p>\n\n<p>Thanks in advance!\nJascha</p>\n"}, {"tags": ["excel", "vba", "vbscript"], "answers": [{"comments": [{"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1497466745, "post_id": 44552624, "comment_id": 76095862, "body": "Changing that syntax gives me an error on line 7 - Expected End Of statement."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1497467057, "post_id": 44552624, "comment_id": 76096001, "body": "<code>Set oVBC = oBook.VBProject.VBComponents oVBC.Import(&quot;C:\\Test\\Test.bas&quot;)</code> Try bringing <code>oVBC.Import(&quot;C:\\Test\\Test.bas&quot;)</code> down a line."}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1497467385, "post_id": 44552624, "comment_id": 76096162, "body": "Yes, that got it!  It produces the file as needed but I get an Unknown Runtime Error as well?"}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1497467744, "post_id": 44552624, "comment_id": 76096327, "body": "-- would prefer to avoid just a random on error resume next if possible"}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1497468481, "post_id": 44552624, "comment_id": 76096728, "body": "It does not show me the line.  It seems the script is run to completion as the file is generated just as I need.  I don&#39;t understand the error, haha"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1497469607, "post_id": 44552624, "comment_id": 76097310, "body": "Hmm it&#39;s hard to tell... Could you open the macro in developer and step through line by line to find where it&#39;s hitting the runtime error?"}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1497474380, "post_id": 44552624, "comment_id": 76099786, "body": "How would I open in developer?  I write using Notepad++ and save with .vbs extension"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1497467157, "last_edit_date": 1497467157, "creation_date": 1497466656, "answer_id": 44552624, "question_id": 44552512, "link": "https://stackoverflow.com/questions/44552512/vbscript-to-run-excel-macro/44552624#44552624", "title": "VBScript To Run Excel Macro", "body": "<p><code>Wscript.QuitEnd If</code> Needs to be fixed to </p>\n\n<p><code>Wscript.Quit\nEnd If</code></p>\n\n<p><code>Set oVBC = oBook.VBProject.VBComponents oVBC.Import(\"C:\\Test\\Test.bas\")</code> to</p>\n\n<p><code>Set oVBC = oBook.VBProject.VBComponents \n oVBC.Import(\"C:\\Test\\Test.bas\")</code></p>\n"}], "owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 44552624, "answer_count": 1, "score": 0, "last_activity_date": 1497477457, "creation_date": 1497466218, "last_edit_date": 1497477457, "question_id": 44552512, "link": "https://stackoverflow.com/questions/44552512/vbscript-to-run-excel-macro", "title": "VBScript To Run Excel Macro", "body": "<p>I am attempting to run this script</p>\n\n<pre><code>if WScript.Arguments.Count &lt; 1 Then   \nWScript.Echo \"Drop file on to me to process.\"   \nWscript.QuitEnd If\nSet oExcel = CreateObject(\"Excel.Application\")\nSet oBook = oExcel.Workbooks.Open(Wscript.Arguments.Item(0))\nSet oVBC = oBook.VBProject.VBComponents oVBC.Import(\"C:\\Test\\Test.bas\") \noBook.Application.Run \"Test\" \nWScript.Echo \"Done\"\n</code></pre>\n\n<p>The name of the macro inside of the Test.bas file is Test() and the file is located at C:\\Test\\Test.bas - now anytime I try to drag a .xlsx file on top of the .vbscript I get an error that reads</p>\n\n<blockquote>\n  <p>Syntax error<br>800A03EA<br>Microsoft VBScript Compilation error</p>\n</blockquote>\n\n<p>What needs to be altered in this script to remedy that issue?</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user844705"}, "edited": false, "score": 0, "creation_date": 1497531185, "post_id": 44552262, "comment_id": 76124598, "body": "Which line of code is throwing that error?"}, {"owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 0, "creation_date": 1497547607, "post_id": 44552262, "comment_id": 76135685, "body": "@ojf I&#39;ve located the issue! <code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _ sheet.UsedRange, Version:=xlPivotTableVersion14). _ CreatePivotTable TableDestination:=&quot;Table!R3C1&quot;, TableName:=&quot;Pvt&quot; _ , DefaultVersion:=xlPivotTableVersion14</code> Theres something wrong with that"}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 8427166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501f0909d9f883e0a9c6446550906c9d?s=128&d=identicon&r=PG&f=1", "display_name": "SayaliT", "link": "https://stackoverflow.com/users/8427166/sayalit"}, "is_accepted": true, "score": 1, "last_activity_date": 1502263286, "creation_date": 1502263286, "answer_id": 45584074, "question_id": 44552262, "link": "https://stackoverflow.com/questions/44552262/excel-vba-how-to-fix-pivot-table-error-when-attempting-to-use-usedrange/45584074#45584074", "title": "EXCEL VBA: How to fix Pivot Table error when attempting to use UsedRange?", "body": "<p>Do you already have  a \"Pvt\" in your Worksheet?\nIt can cause this error, in that case you can try changing the sheet and table names to something else</p>\n"}], "owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 45584074, "answer_count": 1, "score": 0, "last_activity_date": 1505080597, "creation_date": 1497465421, "last_edit_date": 1505080597, "question_id": 44552262, "link": "https://stackoverflow.com/questions/44552262/excel-vba-how-to-fix-pivot-table-error-when-attempting-to-use-usedrange", "title": "EXCEL VBA: How to fix Pivot Table error when attempting to use UsedRange?", "body": "<p>I am trying to create a simple pivot table with Gas on the column, Dash No. for the row, and my Qty for the input. \nI've been researching this question and cannot find a solution. When I try to run my code I keep getting </p>\n\n<blockquote>\n  <p>Error 1004: Application-defined or object-defined error.</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub CreatePivotTable()\n\nDim sheet As Worksheet\nSet sheet = Worksheets(\"mac3\")\n\nSheets.Add.Name = \"Table\"\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\nsheet.UsedRange, Version:=xlPivotTableVersion14). _\nCreatePivotTable TableDestination:=\"Table!R3C1\", TableName:=\"Pvt\" _\n, DefaultVersion:=xlPivotTableVersion14\n\n    Sheets(\"Table\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"Pvt\").PivotFields(\"Gas\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"Pvt\").PivotFields(\"Dash\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"Pvt\").AddDataField ActiveSheet.PivotTables( _\n        \"Pvt\").PivotFields(\"Qty\"), \"Sum of Qty\", xlSum\n    Range(\"B4\").Select\n    Selection.Group Start:=True, End:=True, Periods:=Array(False, False, False, _\n        False, True, False, False)\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1497466065, "post_id": 44552222, "comment_id": 76095423, "body": "Most likely your select part doesn&#39;t return any records. Create a select query without the where clause, then add criteria one by one until no records are returned to find out."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2204315"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1497466860, "post_id": 44552222, "comment_id": 76095917, "body": "Thanks. Acting on your suggestion, the select query only works if &#39;ClientFK&#39; is included. I&#39;ll keep thinking/working. Thanks."}], "owner": {"user_type": "does_not_exist", "display_name": "user2204315"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497477084, "creation_date": 1497465296, "last_edit_date": 1497477084, "question_id": 44552222, "link": "https://stackoverflow.com/questions/44552222/insert-into-query-does-not-work", "title": "INSERT INTO query does not work", "body": "<p>I have two insert queries. The first one is:</p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO tblInvoices ( InvDate, ClientFK, DiscFK, ReceiptFK ) \" &amp; _\n              \"SELECT tblInvoices.InvDate, tblInvoices.ClientFK, tblInvoices.DiscFK, tblInvoices.ReceiptFK \" &amp; _\n              \"From tblInvoices \" &amp; _\n              \"WHERE (((tblInvoices.InvDate)=Date()) AND ((tblInvoices.ClientFK)=[Forms]![frmDisclosure]![ClientFK]) \" &amp; _\n              \"AND ((tblInvoices.DiscFK)=[Forms]![frmDisclosure]![DiscPK]) AND \" &amp; _\n              \"((tblInvoices.ReceiptFK)=[Forms]![frmDisclosure]![ReceiptFK])) \"\n</code></pre>\n\n<p>This does not work, despite reworking it to make it simple (inserting basic data such as numbers instead of the links to \u2018frmDisclosure\u2019. Nothing happens \u2013 no data is shown in datasheet view. Instead I have created a form in which a procedure does the work successfully. Having run the procedure the following insert query runs successfully.</p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO tblInvoiceDetails ( DiscFK, InvoiceFK ) \" &amp; _\n             \"SELECT tblInvoices.DiscFK, tblInvoices.InvoicePK \" &amp; _\n             \"From tblInvoices \" &amp; _\n             \"WHERE (((tblInvoices.InvoicePK)=[Forms]![frmInvoiceAdd]![InvoicePK])) \"\n</code></pre>\n\n<p>For \u2018tidiness\u2019 I\u2019d like to get the first query to run.</p>\n"}, {"tags": ["html", "css", "vba"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1497464594, "post_id": 44551841, "comment_id": 76094642, "body": "I actually edited my code sample using the &quot;:target&quot; css class. I want to target a specific name and modify it&#39;s html contents. The modifying only happens on clicked link event. I included a sample link path in my question."}, {"owner": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1497464944, "post_id": 44551841, "comment_id": 76094824, "body": "Yes, I have a CSS file linked to a HTML file. When a link is clicked that includes an anchor tag at end &quot;#link&quot; I want that linked section of html to be modified. The CSS code will modify HTML content of specific section targeted"}, {"owner": {"reputation": 10258, "user_id": 4739018, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/UCKhz.jpg?s=128&g=1", "display_name": "Dalin Huang", "link": "https://stackoverflow.com/users/4739018/dalin-huang"}, "reply_to_user": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1497465053, "post_id": 44551841, "comment_id": 76094886, "body": "@StevenKligman CSS is just for styling, it does not replace content from HTML etc. For dynamic content you need to use JS"}, {"owner": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1497465254, "post_id": 44551841, "comment_id": 76094986, "body": "Oh, ok that makes a lot more sense now. Thanks"}, {"owner": {"reputation": 10258, "user_id": 4739018, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/UCKhz.jpg?s=128&g=1", "display_name": "Dalin Huang", "link": "https://stackoverflow.com/users/4739018/dalin-huang"}, "reply_to_user": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1497466076, "post_id": 44551841, "comment_id": 76095433, "body": "@StevenKligman ok check the updated code, using js to update all link with attribute name = test"}, {"owner": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1497466436, "post_id": 44551841, "comment_id": 76095692, "body": "Ok, thanks for the JS code but how come CSS allows for the use of &quot;:target&quot; pseudo class for targeted elements in HTML after a link is clicked?"}, {"owner": {"reputation": 10258, "user_id": 4739018, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/UCKhz.jpg?s=128&g=1", "display_name": "Dalin Huang", "link": "https://stackoverflow.com/users/4739018/dalin-huang"}, "reply_to_user": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1497466659, "post_id": 44551841, "comment_id": 76095817, "body": "@StevenKligman example here: <a href=\"https://www.w3schools.com/css/css_pseudo_elements.asp\" rel=\"nofollow noreferrer\">w3schools.com/css/css_pseudo_elements.asp</a>"}, {"owner": {"reputation": 10258, "user_id": 4739018, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/UCKhz.jpg?s=128&g=1", "display_name": "Dalin Huang", "link": "https://stackoverflow.com/users/4739018/dalin-huang"}, "reply_to_user": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1497466813, "post_id": 44551841, "comment_id": 76095896, "body": "CSS is about how the content looks in different situation, target is one of them. <code>REF: (#news:target) Selects the current active #news element (clicked on a URL containing that anchor name)</code>"}, {"owner": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1497466910, "post_id": 44551841, "comment_id": 76095937, "body": "Yes, I&#39;ve been reading about pseudo-classes in CSS but my original question was that it wasn&#39;t working with &quot;name&quot; attributes for elements."}], "tags": [], "owner": {"reputation": 10258, "user_id": 4739018, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/UCKhz.jpg?s=128&g=1", "display_name": "Dalin Huang", "link": "https://stackoverflow.com/users/4739018/dalin-huang"}, "is_accepted": false, "score": 2, "last_activity_date": 1497466053, "last_edit_date": 1592644375, "creation_date": 1497463921, "answer_id": 44551841, "question_id": 44551727, "link": "https://stackoverflow.com/questions/44551727/how-to-use-target-css-psuedo-class-on-html-name-attribute/44551841#44551841", "title": "How to use &#39;target&#39; css psuedo-class on html &#39;name&#39; attribute", "body": "<p>1st CSS is just for styling (how the content looks, layout etc...), use js you can easily update the content (check the example)</p>\n<blockquote>\n<h3>CSS describes how HTML elements are to be displayed on screen, paper, or in other media.</h3>\n<p><a href=\"https://i.stack.imgur.com/Hr1Vf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Hr1Vf.png\" alt=\"enter image description here\" /></a></p>\n</blockquote>\n<p>2nd</p>\n<p>If you just want to check if the <code>&lt;a&gt;</code> element has a <code>name</code> attribute, then use <code>a[name]</code> (2nd link in my example)</p>\n<p>If you need partial match do <code>a[name*=test]</code>, any name contains <code>test</code> will be selected. (3rd link in my example)</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var alltest = document.getElementsByName('test');\n\nalltest.forEach(function(test) {\n  test.setAttribute('href', '#newlink');\n  test.innerHTML = 'updated link';\n});</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>a[name] {\n  color: green;\n}\n\na[name*=test] {\n  color: red;\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a href=\"google.com\"&gt;google.com&lt;/a&gt;&lt;br&gt;\n&lt;a name=\"alsowork\" href=\"google.com\"&gt;google.com&lt;/a&gt;&lt;br&gt;\n&lt;a name=\"test\" href=\"google.com\"&gt;google.com&lt;/a&gt;\n&lt;a name=\"test\" href=\"google.com\"&gt;google.com&lt;/a&gt;\n&lt;a name=\"test\" href=\"google.com\"&gt;google.com&lt;/a&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497466053, "creation_date": 1497463483, "last_edit_date": 1497464495, "question_id": 44551727, "link": "https://stackoverflow.com/questions/44551727/how-to-use-target-css-psuedo-class-on-html-name-attribute", "title": "How to use &#39;target&#39; css psuedo-class on html &#39;name&#39; attribute", "body": "<p>I'm trying to use the \":target\" CSS class to highlight a section of html based on a link clicked that includes an anchor fragment(ex: C:\\Desktop\\Test.html#link). The regions that are being modified in my document have \"name\" identity attributes. The target pseudo class worked with \"id\" attributes for me but am having trouble with \"name\". Thanks.</p>\n\n<p>PS: The reason I'm using \"name\" is because I'm writing VBA scripts about HTML documents that were directly converted from MS Word. (Word uses \"name\" for bookmark conversions to links)</p>\n\n<p>Sample Code I have tried:</p>\n\n<pre><code>a:target {\n          color: red;\n}\n\na[name = test]:target {\n           color: red;\n}\n</code></pre>\n"}, {"tags": ["excel", "vba", "worksheet-function"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1497463457, "post_id": 44551470, "comment_id": 76094048, "body": "Another way would be to sort the range and then pick up your values :)"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1497463999, "post_id": 44551525, "comment_id": 76094331, "body": "@Scott Cramer I&#39;ll add one more caveat...what I really want to do is store the string in the cell to the left (IE in column B) of the (1st, 2nd, 3rd, 4th) value in a variable.  So offset (0, -1).  How do I get the offset in there correctly?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1497464433, "post_id": 44551525, "comment_id": 76094547, "body": "@sbagnato Then use Match to find the value in the list and use <code>rng(i).offset(0,-1)</code> where i is the long returned by the <code>Application.WorksheetFunction.Match</code>.  Try with those hints, if you cannot make it work then ask a new question."}, {"owner": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "edited": false, "score": 0, "creation_date": 1559853001, "post_id": 44551525, "comment_id": 99559614, "body": "I have a question regarding this topic. I would also like to get the Range reference of the highest values. Can you give me an advice how this can be done?  Thanks."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "edited": false, "score": 0, "creation_date": 1559858156, "post_id": 44551525, "comment_id": 99561177, "body": "please create your own post with your own question and needed information.  @MrZH6  Asking a new question on a question that is nearly 2 years old is not the correct method to get an answer to a question."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 8, "last_activity_date": 1497462753, "creation_date": 1497462753, "answer_id": 44551525, "question_id": 44551470, "link": "https://stackoverflow.com/questions/44551470/finding-highest-and-subsequent-values-in-a-range/44551525#44551525", "title": "Finding highest and subsequent values in a range", "body": "<p>Use Application.WorksheetFunction.Large():</p>\n\n<pre><code>Sub Macro1()\n\nDim rng As Range, cell As Range\nDim firstVal As Double, secondVal As Double, thirdVal As Double, fourthVal As Double\n\nSet rng = [C4:C16]\n\n\nfirstVal = Application.WorksheetFunction.Large(rng,1)\nsecondVal = Application.WorksheetFunction.Large(rng,2)        \nthirdVal = Application.WorksheetFunction.Large(rng,3)\nfourthVal = Application.WorksheetFunction.Large(rng,4)\n\nMsgBox \"First Highest Value is \" &amp; firstVal\nMsgBox \"Second Highest Value is \" &amp; secondVal\nMsgBox \"Third Highest Value is \" &amp; thirdVal\nMsgBox \"Fourth Highest Value is \" &amp; fourthVal\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1497464156, "last_edit_date": 1497464156, "creation_date": 1497463283, "answer_id": 44551668, "question_id": 44551470, "link": "https://stackoverflow.com/questions/44551470/finding-highest-and-subsequent-values-in-a-range/44551668#44551668", "title": "Finding highest and subsequent values in a range", "body": "<p>You have a better method suggested by <a href=\"https://stackoverflow.com/users/4851590/scott-craner\">Scott Craner</a> above. However, to answer your question, you are only returning a limited number of values because you are overwriting the values without shifting the original values to a lower rank.</p>\n\n<pre><code>Dim myVALs As Variant\nmyVALs = Array(0, 0, 0, 0, 0)\n\nFor Each cell In rng\n    Select Case True\n        Case cell.Value2 &gt; myVALs(0)\n            myVALs(4) = myVALs(3)\n            myVALs(3) = myVALs(2)\n            myVALs(2) = myVALs(1)\n            myVALs(1) = myVALs(0)\n            myVALs(0) = cell.Value2\n        Case cell.Value2 &gt; myVALs(1)\n            myVALs(4) = myVALs(3)\n            myVALs(3) = myVALs(2)\n            myVALs(2) = myVALs(1)\n            myVALs(1) = cell.Value2\n        Case cell.Value2 &gt; myVALs(2)\n            myVALs(4) = myVALs(3)\n            myVALs(3) = myVALs(2)\n            myVALs(2) = cell.Value2\n        Case cell.Value2 &gt; myVALs(3)\n            myVALs(4) = myVALs(3)\n            myVALs(3) = cell.Value2\n        Case cell.Value2 &gt; myVALs(4)\n            myVALs(4) = cell.Value2\n        Case Else\n            'do nothing\n    End Select\nNext cell\n\nDebug.Print \"first: \" &amp; myVALs(0)\nDebug.Print \"second: \" &amp; myVALs(1)\nDebug.Print \"third: \" &amp; myVALs(2)\nDebug.Print \"fourth: \" &amp; myVALs(3)\nDebug.Print \"fifth: \" &amp; myVALs(4)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15072077, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gjuz6QfjNIHPLudrfUKaIIORgDj4Ep1gvkQy4G8Tg=k-s128", "display_name": "Arun Kumar K", "link": "https://stackoverflow.com/users/15072077/arun-kumar-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1611513177, "creation_date": 1611513177, "answer_id": 65874442, "question_id": 44551470, "link": "https://stackoverflow.com/questions/44551470/finding-highest-and-subsequent-values-in-a-range/65874442#65874442", "title": "Finding highest and subsequent values in a range", "body": "<p>Excel wroksheetfuntion will be a better option for the task.This will allow the user to select the range and also will keep them posted on any range with invalid data. Another Double data type can be declared for Top4 value and msgbox for the same can also be updated. This will avoid any kind of error in the macro.</p>\n<pre><code>Sub top_three()\n\nDim Area As Range\nDim Tone As Double, Ttwo As Double, Tthree As Double\n\nOn Error GoTo Skip\n\nSet Area = Excel.Application.InputBox(&quot;Select the Range&quot;, &quot;Data Visulaization&quot;, \nType:=8)\n\nIf Excel.Application.WorksheetFunction.Count(Area) &gt;= 3 Then\n\nTone = Excel.WorksheetFunction.Large(Area, 1)\nTtwo = Excel.WorksheetFunction.Large(Area, 2)\nTthree = Excel.WorksheetFunction.Large(Area, 3)\n\nVBA.Interaction.MsgBox &quot;Top 1: &quot; &amp; Tone &amp; VBA.Constants.vbNewLine &amp; _\n&quot;Top 2: &quot; &amp; Ttwo &amp; VBA.Constants.vbNewLine &amp; &quot;Top 3:&quot; &amp; Tthree, Title:= _\n&quot;Top 3 values&quot;\n\nElse\n\nVBA.Interaction.MsgBox &quot;No Enough Data type to perform the task&quot;, vbInformation\n\nEnd If\n\nSkip:\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6222, "favorite_count": 0, "accepted_answer_id": 44551525, "answer_count": 3, "score": 3, "last_activity_date": 1611513177, "creation_date": 1497462556, "last_edit_date": 1559852962, "question_id": 44551470, "link": "https://stackoverflow.com/questions/44551470/finding-highest-and-subsequent-values-in-a-range", "title": "Finding highest and subsequent values in a range", "body": "<p>I have the below code which is supposed to find the 1st, 2nd, 3rd, and 4th highest values in a range.</p>\n\n<p>It is currently very basic, and I have it providing the values in a MsgBox so I can confirm it is working.</p>\n\n<p>However, it only finds the highest and second highest values.  The third and fourth values are returned back as 0.  What am I missing?</p>\n\n<pre><code>Sub Macro1()\n\nDim rng As Range, cell As Range\nDim firstVal As Double, secondVal As Double, thirdVal As Double, fourthVal As Double\n\nSet rng = [C4:C16]\n\nFor Each cell In rng\n    If cell.Value &gt; firstVal Then firstVal = cell.Value\n    If cell.Value &gt; secondVal And cell.Value &lt; firstVal Then secondVal = \n    cell.Value\n    If cell.Value &gt; thirdVal And cell.Value &lt; secondVal Then thirdVal = \n    cell.Value\n    If cell.Value &gt; fourthVal And cell.Value &lt; thirdVal Then fourthVal = \n    cell.Value\nNext cell\n\nMsgBox \"First Highest Value is \" &amp; firstVal\nMsgBox \"Second Highest Value is \" &amp; secondVal\nMsgBox \"Third Highest Value is \" &amp; thirdVal\nMsgBox \"Fourth Highest Value is \" &amp; fourthVal\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "audio", "powerpoint"], "comments": [{"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1497463305, "post_id": 44551370, "comment_id": 76093961, "body": "Is this displaying errors?  To help us help you, describe what the code is not doing and on what line it should be doing it (or it gets an error on this line)."}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "reply_to_user": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 1, "creation_date": 1497464611, "post_id": 44551370, "comment_id": 76094652, "body": "Hey Jimmy, I receive a &quot;Compile Error: Invalid Qualifier&quot; when I try to run the macro. When I go back to VB, the &quot;Sub AddMedia()&quot; code is highlighted in yellow."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1497466560, "post_id": 44551370, "comment_id": 76095756, "body": "I would add this info to your question above.  If you hit F8, will it let you step through that AddMedia till it hits the line in question.  I think I know where it is and will suggest as answer"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1497477408, "post_id": 44551370, "comment_id": 76101200, "body": "Your code has an <code>End With</code> with no corresponding <code>With</code>. And you have a <code>For</code> with no corresponding <code>Next</code>.  (Maybe the two issues are related?)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 1, "creation_date": 1497468819, "post_id": 44552620, "comment_id": 76096896, "body": "Hey Jimmy, I see what you mean by using F8. It steps through and highlights the &quot;A&quot; in the bit of code &quot;&amp; A.ToString &amp;&quot;      CurrentAudioFileName = audioFileName &amp; A.ToString &amp; &quot;.mp3&quot;"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497471076, "post_id": 44552620, "comment_id": 76098088, "body": "I&#39;ve edited my answer - I was not even thinking as I work in VB.NET also, but VBA does not use .ToString (actually VBA uses duck typing, so you could just have A there and it&#39;d parse it into that string, but CSTR() is needed sometimes)"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 1, "creation_date": 1497474371, "post_id": 44552620, "comment_id": 76099780, "body": "That got me a bit closer! Now I have a Compile error :&quot;End With Without With&quot;. When I remove &quot;With&quot; in the code section     A = A + 1     End With  I get another Compile Error for the next line stating &quot;For without Next&quot; in the code section     End Sub  This is probably something extremely basic!"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497474672, "post_id": 44552620, "comment_id": 76099940, "body": "I&#39;ve updated the original code to reflect what I currently have."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497533165, "post_id": 44552620, "comment_id": 76126141, "body": "<code>End With</code> should be a <code>Next</code> statement to reitterate the loop.  With block would have been good for <code>sld</code>.  <code>with sld</code> then your <code>.addMediaObject</code> that did not know what it went to, would be assigned to sld.  Will update my answer."}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 1, "creation_date": 1497538831, "post_id": 44552620, "comment_id": 76130432, "body": "Thanks Jimmy! I have updated the original post and the most recent Run-time error up top."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497539444, "post_id": 44552620, "comment_id": 76130887, "body": "OH that&#39;s because it&#39;s a collection of another object within the slide, called <code>Shapes</code> and I missed that."}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497542218, "post_id": 44552620, "comment_id": 76132759, "body": "Another run-time error... I&#39;ve updated the OP to reflect what I&#39;m getting now :/"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497542791, "post_id": 44552620, "comment_id": 76133093, "body": "Have you verified the path to the file matches what it&#39;s being told to add?  This error may be related to the file, or the path to it."}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 1, "creation_date": 1497547570, "post_id": 44552620, "comment_id": 76135661, "body": "Everything looks to be correct, I think the problem is trying to force the numbering of the files in the string to match the content path. The path to the file looks like this &quot;C:\\Users\\user\\audio\\Lesson 1 - Slide 01.mp3&quot;. So maybe I need to fix the formatting to start with 00 as opposed to 0? I&#39;m not sure."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497550628, "post_id": 44552620, "comment_id": 76137356, "body": "That&#39;s a matter of adding zeroes into your string to iterate over those files.  I&#39;ve appended that into my answer.  As far as the original issue though, I think we&#39;ve got that resolved."}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497552180, "post_id": 44552620, "comment_id": 76138227, "body": "I agree with that statement! I&#39;m running into the same issue after applying your updated code."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497625748, "post_id": 44552620, "comment_id": 76172819, "body": "In these situations, I will put a watch on the variable (CurrentAudioFileName) and compare that to what it&#39;s supposed to have.  Why are they not matching is the question?"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497644832, "post_id": 44552620, "comment_id": 76183240, "body": "Ahh, just did that and I got a value of &quot;C:\\Users\\user\\audio\\Lesson 1 - Slide 0.mp3&quot;"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497645459, "post_id": 44552620, "comment_id": 76183562, "body": "I made a mistake, A has to be a string to measure the length like that.  By default the len is static, which will be 4 bytes.  We must do a .ToString, and see my edit"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497645700, "post_id": 44552620, "comment_id": 76183667, "body": "CStr sorta does the same thing, but .ToString will give you more verbose exceptions"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497882947, "post_id": 44552620, "comment_id": 76252281, "body": "Did this help you out?  You&#39;re well on your way to VB developer now :D"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 1, "creation_date": 1497894124, "post_id": 44552620, "comment_id": 76259417, "body": "Hey Jimmy, sorry for the delayed response!! I applied the new code and now I get a &quot;Compile Error: Invalid Qualifier&quot;. When I try to step through the code It highlights the &quot;A&quot; in the &quot;If Len(A.ToString)&quot;  At this point, do you think I can add VB developer to my resume?? :D"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497905037, "post_id": 44552620, "comment_id": 76265182, "body": "Ohhh I lost my context, .toString is VB.NET.  We need CSTR() in VBA!  See my latest edit, then try again.  We&#39;re learning, invalid qualifier means just that &quot;Hey you can&#39;t do it with this thing&quot;"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1497908386, "post_id": 44552620, "comment_id": 76266734, "body": "HAHA good to see you still have some humor left with this one! I hope you have some more... now I get another Compile Error: Next without For. It&#39;s highlighting the &quot;Next&quot; after A = A + 1"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1498152916, "post_id": 44552620, "comment_id": 76394840, "body": "Hey Jimmy, wanted to reach out and see if you had a chance to take a look at this? Hope all is well!"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1498237127, "post_id": 44552620, "comment_id": 76435511, "body": "We&#39;re missing another of those pesky If enders!"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1498242381, "post_id": 44552620, "comment_id": 76438141, "body": "And what would that pesky ender be called?!?! :D"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1498248681, "post_id": 44552620, "comment_id": 76441290, "body": "I feel I&#39;ve spoiled you here, are you seeing it in my edit? lol"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 1, "creation_date": 1498576436, "post_id": 44552620, "comment_id": 76548547, "body": "Hey Jimmy, I agree! You have spoiled me, and I owe you a bunch of beer and BBQ if you&#39;re ever in the Austin area! I looked closer at the code and figured out the fix, which appears to have worked in the debugger!! When I run the macro in the .pptm file, nothing is imported. I put a watch on AddMediaObject2 and it returns a value of &lt;Expression not defined in context&gt;. Is this expected behavior?"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1498582430, "post_id": 44552620, "comment_id": 76552474, "body": "Haha heck yeah, going to take you up on this someday sir!  That message just means that when you&#39;re looking at it, <code>sld.Shapes.AddMediaObject2(CurrentAudioFileName, msoFalse, msoTrue, 350, 10)</code> is not within the context for it to see it.  Do you have the watch over the whole statement though - or just part of it?  Also, Macro security is often something that holds me up - you can try turning macro security to low and then see if imports.  When it doesn&#39;t, is it giving you any errors?"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1498586065, "post_id": 44552620, "comment_id": 76554428, "body": "Please do!!  I have a watch over part of it. As I&#39;m such a noob, idk how to add a watch to the whole statement :/. I turned the macro security to low and still nothing. It&#39;s not throwing any errors or doing anything unusual. Just an fyi I&#39;m on Powerpoint 2016 MSO (10.0.7726.1042) - 64 bit. Not sure if that will help or not"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1498680021, "post_id": 44552620, "comment_id": 76603546, "body": "No problem.  You can select anything you want to watch, highlight the pieces you want to see what they&#39;re getting, then right click and add watch from that menu.  But you say the code works fine in debug mode, but when running it, nothing?"}, {"owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "edited": false, "score": 0, "creation_date": 1498750214, "post_id": 44552620, "comment_id": 76639108, "body": "Yeah, it runs through the code and when I put watches on the variable it returns the correct name. I&#39;m just not sure why it&#39;s not importing. Would it be possible to send you the ppt file?"}], "tags": [], "owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1498250095, "last_edit_date": 1498250095, "creation_date": 1497466645, "answer_id": 44552620, "question_id": 44551370, "link": "https://stackoverflow.com/questions/44551370/programmatically-add-audio-files-to-multiple-slides-in-ppt/44552620#44552620", "title": "Programmatically add audio files to multiple slides in ppt", "body": "<p>I believe .AddMediaObject2 needs the slide to be referenced.\nAlso, the .ToString method is not available in VBA, use CSTR instead.</p>\n\n<p>Try changing, </p>\n\n<pre><code>CurrentAudioFileName = audioFileName &amp; A.ToString &amp; \".mp3\"\n' This audio is embedded, not linked.\nSet shp = .AddMediaObject2(CurrentAudioFileName, msoFalse, msoTrue, 350,10)\n</code></pre>\n\n<p>To,</p>\n\n<pre><code>If len(CSTR(A)) &lt;= 2 then 'zero pad that position\n   CurrentAudioFileName = audioFileName &amp; String(2 - Len(CSTR(A)), \"0\") &amp; a &amp;  \".mp3\"\nelse\n    CurrentAudioFileName = audioFileName &amp; CSTR(A) &amp; \".mp3\"\nend if\n' This audio is embedded, not linked.\nSet shp = sld.Shapes.AddMediaObject2(CurrentAudioFileName, msoFalse, msoTrue, 350,10)\n</code></pre>\n\n<p>As the method is called on the Shapes collection, which is within the current slide(<em>sld here</em>) we are referencing!</p>\n\n<p>Also, we need to close a for loop, not a With block in the code.\nInstead of <code>End With</code>, we could say <code>Next</code> (or <code>Next sld</code> so you can see how that line works)</p>\n\n<p>Ultimately, that subroutine also needed some fixes to the End statements</p>\n\n<pre><code>Sub AddMedia()\n    Dim A As Integer\n    A = 0\n\n    For Each sld In ActivePresentation.Slides\n        Dim shp As Shape\n        Dim CurrentAudioFileName As String\n        If Len(A) &lt;= 2 Then 'zero pad that position\n                CurrentAudioFileName = audioFileName &amp; String(2 - Len(A), \"0\") &amp; A &amp; \".mp3\"\n        Else\n            If Len(CStr(A)) &lt;= 2 Then 'zero pad that position\n                CurrentAudioFileName = audioFileName &amp; String(2 - Len(CStr(A)), \"0\") &amp; A &amp; \".mp3\"\n            Else\n                CurrentAudioFileName = audioFileName &amp; CStr(A) &amp; \".mp3\"\n            End If\n            ' This audio is embedded, not linked.\n            shp = sld.Shapes.AddMediaObject2(CurrentAudioFileName, msoFalse, msoTrue, 350, 10)\n            DisplayMediaInfo shp\n        End If\n        A = A + 1\n\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4744124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98c5cf27e652ebec697c720e307ad7a?s=128&d=identicon&r=PG&f=1", "display_name": "Streicham16", "link": "https://stackoverflow.com/users/4744124/streicham16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498250095, "creation_date": 1497462194, "last_edit_date": 1497979037, "question_id": 44551370, "link": "https://stackoverflow.com/questions/44551370/programmatically-add-audio-files-to-multiple-slides-in-ppt", "title": "Programmatically add audio files to multiple slides in ppt", "body": "<p>So I have multiple slide decks with about 100 slides that all need audio added to them. I want to programmatically import the audio into the slide deck and heres as far as I could get... make note I am NOT a VB developer, so any help is greatly appreciated. TIA!</p>\n\n<pre><code>Const audioFileName As String = \"C:\\Users\\user\\audio\\Lesson 1 - Slide \"\nSub AddMedia()\nDim A As Integer\nA = 0\n\nFor Each sld In ActivePresentation.Slides\n    Dim shp As Shape\n    Dim CurrentAudioFileName As String\n    If Len(A) &lt;= 2 Then 'zero pad that position\nCurrentAudioFileName = audioFileName &amp; String(2 - Len(A), \"0\") &amp; A &amp; \".mp3\"\nElse\nIf Len(CStr(A)) &lt;= 2 Then 'zero pad that position\nCurrentAudioFileName = audioFileName &amp; String(2 - Len(CStr(A)), \"0\") &amp; A &amp; \".mp3\"\nElse\nCurrentAudioFileName = audioFileName &amp; CStr(A) &amp; \".mp3\"\nEnd If\n' This audio is embedded, not linked.\nSet shp = sld.Shapes.AddMediaObject2(CurrentAudioFileName, msoFalse, msoTrue, 350, 10)\n    DisplayMediaInfo shp\n    A = A + 1\nNext\nEnd Sub\nPrivate Sub DisplayMediaInfo(shp As Shape)\nIf shp.Type = msoMedia Then\n    Debug.Print \"Embedded: \" &amp; shp.MediaFormat.IsEmbedded\n    Debug.Print \"Linked: \" &amp; shp.MediaFormat.IsLinked\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Now when I f8 through the code and come to this piece</p>\n\n<pre><code>Set shp = sld.Shapes.AddMediaObject2(CurrentAudioFileName, msoFalse, msoTrue, 350, 10)\nDisplayMediaInfo shp\nA = A + 1\nNext\n</code></pre>\n\n<p>I get a compile error: Next without a For and the Next is identified by VisualBasic.</p>\n"}, {"tags": ["excel", "vba", "merge"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8161859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3e2391c664291ff3341fd52866cd00?s=128&d=identicon&r=PG&f=1", "display_name": "Juan C", "link": "https://stackoverflow.com/users/8161859/juan-c"}, "edited": false, "score": 0, "creation_date": 1497535317, "post_id": 44551352, "comment_id": 76127761, "body": "Many thanks for your help Scott , works perfect!! Very useful for my learning"}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1554907345, "post_id": 44551352, "comment_id": 97924235, "body": "Hi Juan, this is great and what I was looking for.  It seems to apply itself to my entire sheet as I presume it&#39;s working as intended.  Is it possible to apply it to just a highlighted range instead?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1554907706, "post_id": 44551352, "comment_id": 97924435, "body": "@Alan that is a new question.  Please compose a new question,  You can link back to this answer, please also show what you have done to try to modify the code."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1497462475, "last_edit_date": 1497462475, "creation_date": 1497462109, "answer_id": 44551352, "question_id": 44551086, "link": "https://stackoverflow.com/questions/44551086/how-to-merge-similar-cells-in-excel-with-vba/44551352#44551352", "title": "How to merge similar cells in excel with VBA", "body": "<pre><code>Sub Main()\n\n    Dim i As Long\n    Dim j As Long\n    Dim rws As Long\n    Dim clms As Long\n    Dim strt As Range\n    Dim endr As Range\n\n    With ActiveSheet\n        rws = .Cells(.Rows.Count, 1).End(xlUp).Row 'Find last row\n        clms = .Cells(1, Columns.Count).End(xlToLeft).Column 'Find last column\n\n        For i = 1 To rws 'iterate rows\n            Set strt = .Cells(i, 1) 'set start of range\n            For j = 2 To clms + 1 'iterate columns plus one\n                If strt.Value &lt;&gt; .Cells(i, j).Value Then 'check for change\n                    Set endr = .Cells(i, j - 1) ' if change set end of range\n                    Application.DisplayAlerts = False\n                    .Range(strt, endr).Merge 'merge start to end\n                    Application.DisplayAlerts = True\n                    Set strt = .Cells(i, j) 'set new start range on new cell\n                End If\n            Next j\n        Next i\n        With .Range(.Cells(1, 1), .Cells(rws, clms)).Borders 'put border on entire range\n            .LineStyle = xlContinuous\n            .Weight = xlThin\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8161859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3e2391c664291ff3341fd52866cd00?s=128&d=identicon&r=PG&f=1", "display_name": "Juan C", "link": "https://stackoverflow.com/users/8161859/juan-c"}, "edited": false, "score": 0, "creation_date": 1497535449, "post_id": 44552934, "comment_id": 76127861, "body": "Many thanks for your help too Sktneert!! Very efficient code. Thanks a lot!"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1497467686, "creation_date": 1497467686, "answer_id": 44552934, "question_id": 44551086, "link": "https://stackoverflow.com/questions/44551086/how-to-merge-similar-cells-in-excel-with-vba/44552934#44552934", "title": "How to merge similar cells in excel with VBA", "body": "<p>Or you may try something like this...</p>\n\n<pre><code>Sub MergeSimilarCells()\nDim lr As Long, lc As Long, i As Long, j As Long\nlr = Cells(Rows.Count, 1).End(xlUp).Row\nApplication.DisplayAlerts = False\nFor i = 1 To lr\n    lc = Cells(i, Columns.Count).End(xlToLeft).Column\n    For j = 1 To lc\n        If Cells(i, j).MergeArea.Cells(1).Value = Cells(i, j + 1).MergeArea.Cells(1).Value Then 'Or Cells(i, j) = Cells(i, j - 1) Then\n            Range(Cells(i, j).MergeArea, Cells(i, j + 1)).Merge\n        End If\n    Next j\nNext i\nRange(\"A1\").CurrentRegion.Borders.Color = vbBlack\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8161859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3e2391c664291ff3341fd52866cd00?s=128&d=identicon&r=PG&f=1", "display_name": "Juan C", "link": "https://stackoverflow.com/users/8161859/juan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1917, "favorite_count": 1, "accepted_answer_id": 44552934, "answer_count": 2, "score": 0, "last_activity_date": 1497467686, "creation_date": 1497461089, "last_edit_date": 1497461178, "question_id": 44551086, "link": "https://stackoverflow.com/questions/44551086/how-to-merge-similar-cells-in-excel-with-vba", "title": "How to merge similar cells in excel with VBA", "body": "<p>I am new in VBA but I am trying my best to combine cells with a macro.<br>\nThe exact thing I need is quite complicated: combine cells in a row if they have the same string (and a plus is to put a border in the merged cell)</p>\n\n<p>See graphic example here: </p>\n\n<p><a href=\"https://i.stack.imgur.com/AIXbh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AIXbh.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/296dj.png\" rel=\"nofollow noreferrer\">example how to merge cells</a></p>\n\n<p>I have tried with this code but it doesn't work well, specially when merging one cell with a previous one that has been merged already.</p>\n\n<p>Could you give me some help? </p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Sub Main()\n\n    Dim i As Long\n    Dim j As Long\n\n    For i = 1 To 5\n        For j = 1 To 15\n            If StrComp(Cells(i, j), Cells(i, j + 1), vbTextCompare) = 0 Then\n                Range(Cells(i, j), Cells(i, j + 1)).Merge\n                SendKeys \"~\"\n            End If\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497461698, "post_id": 44550752, "comment_id": 76093016, "body": "Odd that <code>.row</code> is not <code>.Row</code> - do you have a global variable with the name &quot;row&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1497462983, "creation_date": 1497462983, "answer_id": 44551589, "question_id": 44550752, "link": "https://stackoverflow.com/questions/44550752/i-have-a-bug-in-my-userform-code-that-inserts-a-saved-picture-into-excel-to-the/44551589#44551589", "title": "I have a bug in my UserForm code that inserts a saved picture into excel to the next cell down", "body": "<p>Tracking picure positions is tricky so I'd take a different approach:</p>\n\n<pre><code>Public Sub CommandButton4_Click()\n    'Use Const for fixed values...\n    Const PIC_FLAG As String = \"PIC\"\n    Const IMG_PATH As String = \"C:\\_Stuff\\test\\test.png\"\n    Const MAX_ROW As Long = 50\n    Const W As Long = 30\n    Const H As Long = 11\n\n    Dim ws As Worksheet, c As Range\n    Set ws = ThisWorkbook.Sheets(\"Mobile POS Log Sheet\")\n\n    Set c = ws.Range(\"C3\")\n    'find first empty cell\n    Do While c.Value = PIC_FLAG And c.Row &lt; MAX_ROW \n        Set c = c.Offset(1, 0)\n    Loop\n\n    If c.Value = PIC_FLAG Then\n        MsgBox \"No rows left!\"\n        Exit Sub\n    End If\n\n    With ws.Pictures.Insert(IMG_PATH)\n         With .ShapeRange\n             'if you lock the aspect ration then\n             '  adjusting both W and H might give\n             '  odd results...\n             .LockAspectRatio = msoTrue\n             .Width = W\n             .Height = H\n         End With\n         .Left = c.Left\n         .Top = c.Top\n         .Placement = 1\n     End With\n     c.Value = PIC_FLAG     '&lt;&lt; flag has pic\n     c.Font.Color = vbWhite '&lt;&lt; hide the flag\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8122377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffd1ffda951f169460960ff4400f3203?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelCodak", "link": "https://stackoverflow.com/users/8122377/raphaelcodak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 44551589, "answer_count": 1, "score": 0, "last_activity_date": 1497462983, "creation_date": 1497459820, "last_edit_date": 1497461589, "question_id": 44550752, "link": "https://stackoverflow.com/questions/44550752/i-have-a-bug-in-my-userform-code-that-inserts-a-saved-picture-into-excel-to-the", "title": "I have a bug in my UserForm code that inserts a saved picture into excel to the next cell down", "body": "<p>I asked this question a few weeks ago and it got \"sort of\" solved but there are still bugs. Here is what I need to happen:</p>\n\n<p>I have a Excel Sheet and have created a UserForm that has a InkPicture Box and is set to allow a person to open the user form and draw their signature. There is a CommandButton assigned to take the signature and save it from the clipboard onto the PC. I Have another CommandButton assigned to retrieve said saved picture from the PC path and bring it back to a specific sheet in my workbook and insert it at a specific cell. </p>\n\n<p>My need is the following: I need the Code I'm using to update what cell it will insert the image at every time I click on the button. (In other words. I need the code to go from C3 to C50 on one digit increase every time I push the button and after it reaches revert back to C3)</p>\n\n<p>The Bug I'm still having basically does three cells of perfect insert and then it gets stuck and inserts the rest of the pictures in the same cell. Here is the code I'm using: </p>\n\n<pre><code>Private Sub CommandButton4_Click()\n\nDim ws As Worksheet\nDim ImgPath As String\nDim W As Double, H As Double\nDim L As Long, T As Long\nDim myArr() As Variant, myArrCounter As Long\nDim newRowNumb As Long\n\nSet ws = ThisWorkbook.Sheets(\"Mobile POS Log Sheet\")\n\n'////////////////////////////////////////   This section will find the row of the bottom most shape in Column C\nReDim myArr(1 To 1)\nmyArrCounter = 0\n\nFor Each wshape In ws.Shapes\nmyArrCounter = myArrCounter + 1\nIf myArrCounter = 1 And wshape.TopLeftCell.Column = 3 Then\n    myArr(myArrCounter) = wshape.TopLeftCell.row\nElse:\n    If wshape.TopLeftCell.Column = 3 And wshape.TopLeftCell.row &gt; myArr(UBound(myArr)) Then\n        ReDim Preserve myArr(1 To myArrCounter)\n        myArr(myArrCounter) = wshape.TopLeftCell.row\n    End If\nEnd If\nNext wshape\nnewRowNumb = myArr(UBound(myArr)) + 1 ' this adds two rows to place the new picure.  \n\n\n\n'~~&gt; This is my current pic file path\nImgPath = \"C:\\Users\\raphaelo\\Downloads\\test.gif\"\n\n\nWith ws\n    W = 30                  '&lt;~~ Width\n    H = 11                  '&lt;~~ Height\n    L = .Range(\"c\" &amp; newRowNumb).Left   '&lt;~~ This is what should be changing each time I run the command\n    T = .Range(\"c\" &amp; newRowNumb).Top    '&lt;~~ This is what should be changing each time I run the command\n     '&lt;~~ Both the L and T Range entries should change to the next cell (C3 to C4 to C5 and so on) One digit up every time I run the Command Code\n     '&lt;~~ Unless it's the Placement entry below?\n    With .Pictures.Insert(ImgPath)\n        With .ShapeRange\n            .LockAspectRatio = msoTrue\n            .Width = W\n            .Height = H\n        End With\n        .Left = L\n        .Top = T\n        .Placement = 1 '&lt;~~ Not sure if this is the one that should change one digit up each time I run the Command instead?\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "winapi", "vba"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1497460480, "post_id": 44550554, "comment_id": 76092280, "body": "Which call is showing the popup, and does it have a parameter to force the operation without showing a UI?"}, {"owner": {"reputation": 77, "user_id": 2901516, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/29c2194fed9112b184cf9076e7652ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/2901516/tyrone"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1497461962, "post_id": 44550554, "comment_id": 76093172, "body": "appAccess.DoCmd.RunCommand acCmdConvertMacrosToVisualBasic causes the popup to appear.  My research indicates that there is no parameter to control the popup."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1497463138, "post_id": 44550554, "comment_id": 76093859, "body": "Does this solve your issue: <a href=\"https://support.office.com/en-us/article/Turn-action-query-confirmation-messages-on-or-off-e58e4bba-9d54-4b9d-b962-9eca048e5335\" rel=\"nofollow noreferrer\">Turn action query confirmation messages on or off</a>? (Apparently only applies to Access 2007/2010.)"}, {"owner": {"reputation": 77, "user_id": 2901516, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/29c2194fed9112b184cf9076e7652ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/2901516/tyrone"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1497463586, "post_id": 44550554, "comment_id": 76094118, "body": "No.  That setting pertains to action queries such as append, delete, and update queries."}], "owner": {"reputation": 77, "user_id": 2901516, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/29c2194fed9112b184cf9076e7652ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/2901516/tyrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594639765, "creation_date": 1497459176, "last_edit_date": 1594639765, "question_id": 44550554, "link": "https://stackoverflow.com/questions/44550554/code-interruption-converting-macros-to-vba", "title": "Code Interruption Converting Macros to VBA", "body": "<p>I am trying to figure out how to get VBA code to continue after being interrupted by a popup inquiring if I want to convert.  I think I can figure out how to handle the first and subsequent popups that appear via the Windows API.  However, I can't figure out how to put focus on my code when the popup appears so I can't run the line \"MsgBox FindWindow(vbNullString, \"Convert macro: \" &amp; m.Name).\"  Is there away for the code to continue running?  I know that I will have to add a loop to check for the popup with the title \"Convert macro: \" &amp; m.Name.  Below is the code I have so far.</p>\n\n<pre><code>Sub ConvertMacrosToVBA()\nDim strDB As String\nDim appAccess As Access.Application\nDim m As Object\n\nstrDB = \"C:\\Users\\Me\\Desktop\\testme.accdb\"\n\nSet appAccess = New Access.Application\nappAccess.OpenCurrentDatabase strDB\n\n\nFor Each m In appAccess.CurrentProject.AllMacros\n    appAccess.DoCmd.SelectObject acMacro, m.Name, True\n    appAccess.DoCmd.RunCommand acCmdConvertMacrosToVisualBasic\n    MsgBox FindWindow(vbNullString, \"Convert macro: \" &amp; m.Name)\nNext\nSet appAccess = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop", "range"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1497459001, "post_id": 44550311, "comment_id": 76091465, "body": "So you want to delete blank cells (shifting up) and completely disregard their relationship to adjoining non-blank cells?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497461977, "post_id": 44550311, "comment_id": 76093187, "body": "Zahbi, if you feel that your question is not a duplicate then feel free to leave a message here explaining why it is not and I or someone else will re-open the question"}], "answers": [{"tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 1, "last_activity_date": 1497459420, "creation_date": 1497459420, "answer_id": 44550628, "question_id": 44550311, "link": "https://stackoverflow.com/questions/44550311/vba-deleting-specific-ranges-when-empty-and-shift-up/44550628#44550628", "title": "VBA Deleting specific ranges when empty and shift up", "body": "<p>You should go backwards in your loop and look at the code below to see how to use k variable accordingly. If you loop forwards, when you delete a row, you should decrease this number from your loop variable and it is a lot of work, plus confusing. </p>\n\n<p>Try this:</p>\n\n<pre><code>Sub delete_empty_cells2()\n    Dim k As Long\n    Dim r As Range\n    For k = 260 To 4 Step -1\n        Set r = Range(\"AA\" &amp; k &amp; \":AF\" &amp; k)\n        If Application.WorksheetFunction.CountA(r) = 0 Then\n            Rows(k).EntireRow.Delete\n        End If\n    Next k\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 1, "last_activity_date": 1497459768, "creation_date": 1497459768, "answer_id": 44550733, "question_id": 44550311, "link": "https://stackoverflow.com/questions/44550311/vba-deleting-specific-ranges-when-empty-and-shift-up/44550733#44550733", "title": "VBA Deleting specific ranges when empty and shift up", "body": "<p>Here's one way to do it. You don't actually have to delete anything until right at the end -- it's much quicker.</p>\n\n<pre><code>Sub delete_empty_cells2()\n    Dim rng As Range, fullRow As Range, populatedRange As Range, emptyRange As Range\n\n    Set rng = Sheet1.Range(\"AA4:AF260\")\n\n    For Each fullRow In rng.Rows\n        Set populatedRange = fullRow.Find(\"*\")\n        If populatedRange Is Nothing Then\n            If emptyRange Is Nothing Then\n                Set emptyRange = fullRow\n            Else\n                Set emptyRange = Union(emptyRange, fullRow)\n            End If\n        End If\n    Next fullRow\n\n    If Not emptyRange Is Nothing Then emptyRange.Delete\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8161741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/861ca253445292c64101946b762d44c3?s=128&d=identicon&r=PG&f=1", "display_name": "Zahbi91", "link": "https://stackoverflow.com/users/8161741/zahbi91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1443, "favorite_count": 0, "closed_date": 1497461749, "answer_count": 2, "score": -1, "last_activity_date": 1497459992, "creation_date": 1497458376, "last_edit_date": 1497459992, "question_id": 44550311, "link": "https://stackoverflow.com/questions/44550311/vba-deleting-specific-ranges-when-empty-and-shift-up", "closed_reason": "Duplicate", "title": "VBA Deleting specific ranges when empty and shift up", "body": "<p>I checked the search function, but could not find any answer to my issue.</p>\n\n<p>What I want is VBA to check a specific range for 200+ rows whether these are entirely empty and if so, to delete these and shift up cells.</p>\n\n<pre><code>Sub delete_empty_cells2() \n    Dim k As Integer \n    Dim r As Range\n    For k = 4 To 260 \n        Set r = Range(\"AAk:AFk\") \n        If r.Value = \"\" Then\n            r.Select \n            Selection.SpecialCells(xlCellTypeBlanks).Select\n            Selection.Delete Shift:=xlUp \n        End If \n    Next k\nEnd Sub\n</code></pre>\n\n<p>Now obviously, the code is wrong. I'm not really used to VBA yet and don't know all commands / objects. Is there a way to tell VBA that the range is variable (it should check all ranges, e.g. starting by checking AA4:AF4).</p>\n\n<p>Thanks in advance!</p>\n\n<p>Zahbi</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1497458538, "post_id": 44550230, "comment_id": 76091203, "body": "<code>IsNumeric</code> judges a blank cell to be numeric. Is that your problem?"}, {"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1497466317, "post_id": 44550230, "comment_id": 76095600, "body": "@SJR, no, IsNumeric work fine. I just want to show that all mentioned worksheet function doesn&#39;t work. Eg. 3 cells all blank but CountA() return 3. CountIf(&quot; &quot;) return 0, IsText() return True. So I proceed using IsNumeric()..."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497500032, "post_id": 44550603, "comment_id": 76106606, "body": "How to avoid the Boolean from giving Application defined/Object define error? I try this but not works;      With wb  x = 3 - Application.WorksheetFunction.CountBlank(Worksheets(&quot;Sheet1&quot;&zwnj;&#8203;).Range(.Cells(i, 2), .Cells(i, 4)))     MsgBox x     End With"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497540004, "post_id": 44550603, "comment_id": 76131290, "body": "If you&#39;re in a &quot;With WB&quot; clause then you need to 1) place . in front of &quot;Worksheets&quot; to append that worksheet to the WB and 2) remove the . from the cells and place .address after (otherwise compiler thinks you are trying &quot;workbook.cells(i,2)&quot; ... SO try:    x = 3 - Application.WorksheetFunction.CountBlank(.Worksheets(&quot;Sheet1&zwnj;&#8203;&quot;\u200c\u200b).Range(Cells(i, 2).address, .Cells(i, 4).address))"}, {"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497541787, "post_id": 44550603, "comment_id": 76132496, "body": "Error 438, Object doesn&#39;t support this property"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497544542, "post_id": 44550603, "comment_id": 76134023, "body": "I left a . in by mistake: x = 3 - Application.WorksheetFunction.CountBlank(.Worksheets(&quot;Sheet1&zwnj;&#8203;\u200c\u200b&quot;\u200c\u200b).Range(Cells(i&zwnj;&#8203;, 2).address, .Cells(i, 4).address))"}, {"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497583336, "post_id": 44550603, "comment_id": 76149002, "body": "Ya, remove a . infront of Cells()  , then its works   x = 3 - Application.WorksheetFunction.CountBlank(.Worksheets(&quot;Sheet1&zwnj;&#8203;\u200c\u200b\u200c\u200b&quot;\u200c\u200b).Range(Cells&zwnj;&#8203;(i\u200c\u200b, 2).address, Cells(i, 4).address))"}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1497459361, "creation_date": 1497459361, "answer_id": 44550603, "question_id": 44550230, "link": "https://stackoverflow.com/questions/44550230/vba-to-return-1-if-range-contain-any-value-not-working/44550603#44550603", "title": "VBA To Return 1 if Range contain any value - not working", "body": "<p>You can use 'CountBlank' - if the column range is always 3 cells then you can declare a boolean and subtract the blank count from 3, giving you a 0 (false) if all cells are blank or anything above 0 (true) if at least one cell is occupied:</p>\n\n<pre><code>Dim x As Boolean\n    x = 3 - Application.WorksheetFunction.CountBlank(Worksheets(\"Sheet1\").Range(Cells(i, 2), Cells(i, 4)))\n    MsgBox x\n</code></pre>\n\n<p>If it's specific to numerical values (e.g. ignoring text) then just add to your IsNumeric line:</p>\n\n<pre><code>If IsNumeric(ncell) And Not ncell = \"\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497466641, "post_id": 44551065, "comment_id": 76095807, "body": "I close the new opened wb before I run second time, It happen. Also, I create new module &amp; try on new module, first run is Ok (result is wrong but at least give result), second time code stopped by error. It start happen when I work on different PC. Not sure if that&#39;s the reason."}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "reply_to_user": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497469719, "post_id": 44551065, "comment_id": 76097369, "body": "@SitiSal Please look at the code I added and let me know if it works"}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "reply_to_user": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497503512, "post_id": 44551065, "comment_id": 76107620, "body": "I don&#39;t mean to sound desperate even though I kind of am...would you mind marking my answer as correct or even just giving me an upvote? I&#39;d greatly appreciate it :)"}, {"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497506326, "post_id": 44551065, "comment_id": 76108699, "body": "I appreciate yr answer and already vote early on. I&#39;m sorry my reputation is under 15, it doesn&#39;t change the score."}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "reply_to_user": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497531359, "post_id": 44551065, "comment_id": 76124719, "body": "Oh I see, that&#39;s okay. Thank you!"}], "tags": [], "owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "is_accepted": true, "score": 0, "last_activity_date": 1497469693, "last_edit_date": 1497469693, "creation_date": 1497460994, "answer_id": 44551065, "question_id": 44550230, "link": "https://stackoverflow.com/questions/44550230/vba-to-return-1-if-range-contain-any-value-not-working/44551065#44551065", "title": "VBA To Return 1 if Range contain any value - not working", "body": "<blockquote>\n  <p>I think this belongs in a comment but I'm not allowed to...</p>\n  \n  <p>You mentioned that your problem is when you try running it a <strong><em>second\n  time</em></strong>, which means that the error could be from vba trying to open\n  your file when it is already open. Everything else seems to work</p>\n  \n  <p>Ignore all this, it was my original \"answer\" but I don't know how to format a strikethough and I don't want to delete it all.</p>\n</blockquote>\n\n<p>Try this code</p>\n\n<pre><code>Sub Try()\n    Dim wb As Workbook\n    Dim path As String\n    Dim i As Integer, j As Integer\n    Dim NCell As Range\n\n    path = \"E:\\SouthNorth\\1979.xls\"\n\n    Set wb = Workbooks.Open(Filename:=path)\n    wb.Activate\n    i = 24\n    Sheets(\"Sheet2\").Range(\"B\" &amp; i).Value = 0\n\n    For j = 2 To 4\n        Set NCell = Sheets(\"Sheet1\").Cells(i, j)\n        If IsNumeric(NCell.Value) Then\n            Sheets(\"Sheet2\").Range(\"B\" &amp; i).Value = 1\n            Exit For\n        End If\n    Next j\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "edited": false, "score": 0, "creation_date": 1497504139, "post_id": 44551147, "comment_id": 76107843, "body": "I try SpecialCells but result is different. SpecialCells(xlCellTypeConstants, xlNumbers) all rows return 1 and  using SpecialCells(xlCellBlanks) all rows return 0. But Thank you, Abs(CBool..) works fine."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1497461310, "creation_date": 1497461310, "answer_id": 44551147, "question_id": 44550230, "link": "https://stackoverflow.com/questions/44550230/vba-to-return-1-if-range-contain-any-value-not-working/44551147#44551147", "title": "VBA To Return 1 if Range contain any value - not working", "body": "<p>To start off with, it is a really bad practice to leave the Cells defining a Range object without a parent worksheet. See <a href=\"https://stackoverflow.com/questions/36368220/is-the-in-range-necessary-when-defined-by-cells\">Is the . in .Range necessary when defined by .Cells?</a> for more information.</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(Cells(24, 2), Cells(24, 4))\n</code></pre>\n\n<p>You seem to specifically want a count for numbers. Bringing in the worksheet's COUNT function will do this.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    With .Range(.Cells(24, 2), .Cells(24, 4))\n        Worksheets(\"Sheet2\").Range(\"B\" &amp; i) = Abs(CBool(Application.Count(.Cells)))\n    End With\nEnd With\n</code></pre>\n\n<p>You can also stay strictly within VBA with SpecialCells using xlCellTypeConstants with xlNumbers.</p>\n\n<pre><code>Dim rng As Range\n\nWith Worksheets(\"Sheet1\")\n    On Error Resume Next\n    Set rng = .Range(.Cells(24, 2), .Cells(24, 4)).SpecialCells(xlCellTypeConstants, xlNumbers)\n    On Error GoTo 0\n    If Not rng Is Nothing Then\n        Worksheets(\"Sheet2\").Range(\"B\" &amp; i) = 1\n    Else\n        Worksheets(\"Sheet2\").Range(\"B\" &amp; i) = 0\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 44551065, "answer_count": 3, "score": 1, "last_activity_date": 1497469693, "creation_date": 1497458123, "last_edit_date": 1531164843, "question_id": 44550230, "link": "https://stackoverflow.com/questions/44550230/vba-to-return-1-if-range-contain-any-value-not-working", "title": "VBA To Return 1 if Range contain any value - not working", "body": "<p>Here I got problem return 1010 logical test. It should checking each cell in range, and exit loop if cell contain number. Return 1 if any cell in range contain value, return 0 if all cell is blank. I tried worksheet function CountIf, CountA, Not IsEmpty, IsText but result is different seems like the blank cell contain invisible string. IsNumeric works on single cell but when range included its not working. I also note the first time I got it run, it produce result, second run causing error. Please help, my range need to be in variable term. </p>\n\n<pre><code>Sub Try()\nDim path As String, myfile As String, file As String\nDim wb As Workbook\nDim i As Integer\nDim NCell As Range\nDim IsNumber As Boolean\n\npath = \"E:\\SouthNorth\\\"\nmyfile = path &amp; \"1979.xls\"\nfile = Dir(myfile)\n\nSet wb = Workbooks.Open(Filename:=path &amp; file)\nwb.Activate 'necessary?\ni = 24\n'here object defined error\nFor Each NCell In Worksheets(\"Sheet1\").Range(Cells(i, 2), Cells(i, 4)) \n   If IsNumeric(NCell) Then\n        IsNumber = True\n        If IsNumber = True Then Exit For\n    End If\nNext NCell\nSelect Case IsNumber\nCase True\nwb.Worksheets(\"Sheet2\").Range(\"B\" &amp; i) = 1\nCase False\nwb.Worksheets(\"Sheet2\").Range(\"B\" &amp; i) = 0\nEnd Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook", "excel-2007"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1497459457, "post_id": 44550186, "comment_id": 76091750, "body": "Have a look at  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868990.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff868990.aspx</a> Also - SaveSetting and GetSetting might help you. If you use the registry to store your settings, it&#39;ll survive."}, {"owner": {"reputation": 706, "user_id": 4555355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-OGUMKSQ-NeQ/AAAAAAAAAAI/AAAAAAAAAEA/nA0tQLfpUPQ/photo.jpg?sz=128", "display_name": "Fata1Err0r", "link": "https://stackoverflow.com/users/4555355/fata1err0r"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1497460099, "post_id": 44550186, "comment_id": 76092087, "body": "Good ideas! Those articles are for 2010+, but I&#39;ll look in that direction and check out your other suggestions. I&#39;m on lunch so I can&#39;t test, but I&#39;ll follow up and let you know how it goes. Thanks again, Sam."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1497461728, "post_id": 44550186, "comment_id": 76093032, "body": "That should work as is even in older versions."}], "answers": [{"comments": [{"owner": {"reputation": 706, "user_id": 4555355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-OGUMKSQ-NeQ/AAAAAAAAAAI/AAAAAAAAAEA/nA0tQLfpUPQ/photo.jpg?sz=128", "display_name": "Fata1Err0r", "link": "https://stackoverflow.com/users/4555355/fata1err0r"}, "edited": false, "score": 0, "creation_date": 1497888931, "post_id": 44556008, "comment_id": 76256422, "body": "Thanks for the assistance. I went with this idea, and made it work out for my situation."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1497524810, "last_edit_date": 1497524810, "creation_date": 1497481275, "answer_id": 44556008, "question_id": 44550186, "link": "https://stackoverflow.com/questions/44550186/excel-2007-vba-use-string-variable-value-in-object-variable/44556008#44556008", "title": "Excel 2007 VBA use string variable value in object variable", "body": "<p>Seems too convoluted a solution. Nobody could share their VBA.</p>\n\n<p>In the example provided</p>\n\n<pre><code>outNamespace.Folders(\"Mailbox - Some Guy\").Folders(\"Reports\").Folders(\"ImportantData\"\n</code></pre>\n\n<p>you could instead use this directly in the VBA </p>\n\n<pre><code>Set mailboxFolder = outNamespace.GetDefaultFolder(olFolderInbox).Parent\n</code></pre>\n\n<p>You now have the \"Mailbox - Some Guy\" folder in a generic way not needing to specify \"Some Guy\".</p>\n\n<pre><code>Set myFolder = mailboxFolder.Folders(\"Reports\").Folders(\"ImportantData\")\n</code></pre>\n"}], "owner": {"reputation": 706, "user_id": 4555355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-OGUMKSQ-NeQ/AAAAAAAAAAI/AAAAAAAAAEA/nA0tQLfpUPQ/photo.jpg?sz=128", "display_name": "Fata1Err0r", "link": "https://stackoverflow.com/users/4555355/fata1err0r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 1, "accepted_answer_id": 44556008, "answer_count": 1, "score": 0, "last_activity_date": 1497524810, "creation_date": 1497457967, "question_id": 44550186, "link": "https://stackoverflow.com/questions/44550186/excel-2007-vba-use-string-variable-value-in-object-variable", "title": "Excel 2007 VBA use string variable value in object variable", "body": "<p>Good afternoon guys!</p>\n\n<p>I looked around, but I'm not finding anything that addresses my particular issue, so I'll do my best to explain.</p>\n\n<p><strong>Specs:</strong></p>\n\n<p>Excel 2007, VBA, Outlook 2007</p>\n\n<p>Okay, so I've been reworking some scripts that I created to automate our reports in Excel / Avaya CMS. For the past few years I've been the sole person doing our reports, so it wasn't ever necessary to set things up on anyone else's computers. However, things are changing and I'm in the process of updating the scripts / training others to use them. At the moment, when I put my scripts on their computer, I have to go into the VBA code and manually set every reference to their own relative folder paths / outlook folder paths. Painless enough, except when I do any type of changes to the scripts and have to go through the whole process again on each computer. </p>\n\n<p><strong>So this was my solution:</strong> Create a config worksheet on the automated reporting workbook, on that config worksheet store the file paths, and in the code simply use variables to reference the config worksheet. This should make it as easy as setting the variables once from the config on a new computer without having to touch any of the lines of code. </p>\n\n<p><strong>Problem:</strong> At midnight there is data that is emailed to us from another office. We use Outlook at this office, so I've simply been having it go to the folder specified in the scripts, download the attachments, and then use the downloaded data for the reports. Since everyone sets up their own outlook folders, the paths inside of outlook are different for each user. Since VBA is accessing a worksheet to grab the config information from a cell, it's returning the path for Outlook folders as a string value. However, the outlook folder variable is of Object type, and so it doesn't allow me to use the string variable as it's value, even though the string itself is the actual value the object needs (just not as a string). So is it possible to convert the string value to a value that can be used in the Object variable? </p>\n\n<p><strong>Worksheet Config Cell Value (B5)- The String Value</strong></p>\n\n<pre><code>outNamespace.Folders(\"Mailbox - Some Guy\").Folders(\"Reports\").Folders(\"ImportantData\")\n</code></pre>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>'Config tab\n\nDim serverConfig As Worksheet\nSet serverConfig = Sheets(\"CONFIG\")\n\nDim dirOutlookData As String    \ndirOutlookData = serverConfig.Range(\"B5\").Value\n\nDim outFolder As Object\nSet outFolder = dirOutlookData \n</code></pre>\n\n<p>Any ideas? Since the string that's returning for dirOutlookData is the value needed for the object variable value, how can I convert the value from the string variable so it can be used in such a way?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 485, "user_id": 7169895, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zJNlL.png?s=128&g=1", "display_name": "David Frick", "link": "https://stackoverflow.com/users/7169895/david-frick"}, "edited": false, "score": 0, "creation_date": 1497457803, "post_id": 44550115, "comment_id": 76090794, "body": "I see the Vba code taking the Max Date and comparing it to the Max Date - 1."}], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 7169895, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zJNlL.png?s=128&g=1", "display_name": "David Frick", "link": "https://stackoverflow.com/users/7169895/david-frick"}, "edited": false, "score": 0, "creation_date": 1497458950, "post_id": 44550274, "comment_id": 76091421, "body": "would there be any way in this join to do the balance addition?"}, {"owner": {"reputation": 485, "user_id": 7169895, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zJNlL.png?s=128&g=1", "display_name": "David Frick", "link": "https://stackoverflow.com/users/7169895/david-frick"}, "edited": false, "score": 0, "creation_date": 1497465470, "post_id": 44550274, "comment_id": 76095101, "body": "nvm that&#39;s basic SQL to add. Sorry"}], "tags": [], "owner": {"reputation": 3333, "user_id": 3138531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a9a9881a8fedbbd3048ebdfced5ef3a?s=128&d=identicon&r=PG", "display_name": "serakfalcon", "link": "https://stackoverflow.com/users/3138531/serakfalcon"}, "is_accepted": true, "score": 1, "last_activity_date": 1497458260, "creation_date": 1497458260, "answer_id": 44550274, "question_id": 44550115, "link": "https://stackoverflow.com/questions/44550115/access-comparing-two-records-from-today-and-yesterday/44550274#44550274", "title": "Access Comparing Two Records from Today and Yesterday", "body": "<p><code>JOIN</code> the table to itself.</p>\n\n<p>Something like</p>\n\n<pre><code>SELECT a.Balance as oldBalance, b.Balance as newBalance, a.Eff_Date as OldDate, b.Eff_Date as NewDate\nFROM Past_Wires as a\nINNER JOIN Past_Wires as b ON a.Portfolio = b.Portfolio AND a.Eff_Date&lt;b.Eff_Date\n</code></pre>\n\n<p>You could also use <code>DateDiff('d',a.Eff_Date,b.Eff_Date) = 1</code> in the <code>WHERE</code> clause to only compare subsequent days with each other.</p>\n"}], "owner": {"reputation": 485, "user_id": 7169895, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zJNlL.png?s=128&g=1", "display_name": "David Frick", "link": "https://stackoverflow.com/users/7169895/david-frick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 44550274, "answer_count": 1, "score": 0, "last_activity_date": 1497458260, "creation_date": 1497457744, "question_id": 44550115, "link": "https://stackoverflow.com/questions/44550115/access-comparing-two-records-from-today-and-yesterday", "title": "Access Comparing Two Records from Today and Yesterday", "body": "<p>I have a table called Past_Wires that looks like this (partly)</p>\n\n<pre><code>Eff_Date | Portfolio | Balance\n6/13/2017  0JR         10000\n6/13/2017  S25         10000\n6/14/2017  0JR         0\n6/14/2017  S25         20000\n</code></pre>\n\n<p>I want to run a query that compares the balances of each portfolio to the previous date's balance (hopefully yesterday's date) and return the difference. I am pretty sure this needs to be done in VBA (which I can do) and cannot be done in a query itself, but wanted to see if anyone had ideas.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 3, "creation_date": 1497457461, "post_id": 44549924, "comment_id": 76090600, "body": "Please <a href=\"https://stackoverflow.com/questions/29995598/vba-combobox-additem-and-getting-a-runtime-error-70\">search</a> before post."}, {"owner": {"reputation": 17278, "user_id": 6730571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/63g7E.jpg?s=128&g=1", "display_name": "Hugues M.", "link": "https://stackoverflow.com/users/6730571/hugues-m"}, "edited": false, "score": 0, "creation_date": 1497476657, "post_id": 44549924, "comment_id": 76100835, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29995598/vba-combobox-additem-and-getting-a-runtime-error-70\">VBA combobox additem and getting a runtime error 70</a>"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1497486805, "post_id": 44549924, "comment_id": 76103826, "body": "you can amso populate a combobox directly from the array : &#180;me.combobox1.list = myarray1&#180;"}, {"owner": {"reputation": 1, "user_id": 8161599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17b0477a0afd88a1060aea8c170ec819?s=128&d=identicon&r=PG&f=1", "display_name": "masen", "link": "https://stackoverflow.com/users/8161599/masen"}, "edited": false, "score": 0, "creation_date": 1497629680, "post_id": 44549924, "comment_id": 76175268, "body": "Thank you all! I apologize for asking a duplicate question, I&#39;m new I made a research but I didn&#39;t find the similar questions."}], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 4442591, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/e0f8c5cf496a925f914a214c5cfb518f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/4442591/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1532011150, "creation_date": 1532011150, "answer_id": 51425477, "question_id": 44549924, "link": "https://stackoverflow.com/questions/44549924/vba-excel-2007-combobox-permission-denied/51425477#51425477", "title": "VBA excel 2007, ComboBox &quot;Permission Denied&quot;", "body": "<p>had the same problem before as described in <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/140017-combobox-additem-permission-denied-error-no-70\" rel=\"nofollow noreferrer\">Combobox additem permission denied error no.70\n</a>. \nMake sure that the property <code>ListFillRange</code> is empty. </p>\n"}], "owner": {"reputation": 1, "user_id": 8161599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17b0477a0afd88a1060aea8c170ec819?s=128&d=identicon&r=PG&f=1", "display_name": "masen", "link": "https://stackoverflow.com/users/8161599/masen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2012, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532011150, "creation_date": 1497457073, "question_id": 44549924, "link": "https://stackoverflow.com/questions/44549924/vba-excel-2007-combobox-permission-denied", "title": "VBA excel 2007, ComboBox &quot;Permission Denied&quot;", "body": "<p>I'm a beginner with VBA, I'm developing a macro on excel 2007 and I'm having some problems with the ComboBox. Anywhere I try to add items i always get the error 70 \"Permission Denied\". What is my mistake? \nBelow you can find my simple code</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim pic As IPictureDisp\n\nSet pic = UserForm1.Image1.Picture\n\n'stdole.SavePicture pic, \"ciao\"\nCall SavePicture(pic, \"ciao.jpg\")\nEnd Sub\n\nPrivate Sub CommandButton3_Click()\n   Dim MyChart As Chart\n   Dim ChartData As Range\n   Dim ChartName As String\n   ChartName = \"ANCONA\"\n   Set ChartData = ActiveSheet.Range(\"A1:A9\")\n   Application.ScreenUpdating = True\n  'UserForm1.Image4.Picture = LoadPicture(\"C:\\Users\\rfori\\Desktop\\PROGETTO \n   MARTINA\\parto_trig.jpg\")\n\n\n'\n  Set MyChart = ActiveSheet.Shapes.AddChart(xlXYScatterLines).Chart\n  With MyChart.SeriesCollection.NewSeries\n\n        .Name = ChartName\n        .Values = ChartData\n        .XValues = ActiveSheet.Range(\"B1:B9\")\n   End With\n\n   Dim imageName As String\n   imageName = \"prova.jpg\"\n   MyChart.Export Filename:=imageName, FilterName:=\"jpg\"\n\n   Application.ScreenUpdating = True\n   UserForm1.Image1.Picture = LoadPicture(\"prova.jpg\")\n  'MyChart.SeriesCollection(1).Name = ChartName\n  'MyChart.SetSourceData Source:=ChartData\nEnd Sub\n\n\n\nPrivate Sub UserForm_Activate()\n  ComboBox1.AddItem \"ciao\"\nEnd Sub\nPrivate Sub UserForm_Initialize()\n   ComboBox1.AddItem \"ciao\"\n With Me\n  .StartUpPosition = 1\n  .Width = MultiPage1.Width\n  .Height = MultiPage1.Height\n  .Left = Application.Left - (Application.Width * 0.85) \\ 2\n  .Top = Application.Top - (Application.Height * 0.85) \\ 2\n End With\n\n  myarray1 = Array(\"Ancona\", \"Milano\", \"Palermo\")\n\n  For x = 0 To 2\n\n  'ComboBox1.AddItem myarray1(x)\n  Next x\nEnd Sub\n\nSub window_sizer()\n With ActiveWindow\n  .WindowState = xlNormal`enter code here`\n  .Height = 75\n  .Width = 125\n  .ScrollColumn = 1\n  .ScrollRow = 1\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "edited": false, "score": 0, "creation_date": 1497457041, "post_id": 44549854, "comment_id": 76090373, "body": "Try ... Sheets(&quot;MAIN SHEET&quot;) ... instead"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1497457051, "post_id": 44549854, "comment_id": 76090379, "body": "Is the worksheet that contains the button in a different workbook to your &quot;MAIN SHEET&quot;?  (That&#39;s the only reason I can think of that the posted code would give the error you are getting.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1497461878, "post_id": 44549854, "comment_id": 76093120, "body": "See <a href=\"https://stackoverflow.com/questions/36368220/is-the-in-range-necessary-when-defined-by-cells\">Is the . in .Range necessary when defined by .Cells?</a> for related information"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1497462009, "post_id": 44549854, "comment_id": 76093209, "body": "More at <a href=\"https://stackoverflow.com/questions/39792949/sheet-range-select-combined-not-working/39793091#39793091\">Sheet / Range Select (combined) not working</a>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1497461789, "post_id": 44549915, "comment_id": 76093071, "body": "Maybe even <code>.Range(&quot;A2:F500, J2:O500, R2:Y500&quot;).ClearContents</code> ...?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1497462286, "post_id": 44549915, "comment_id": 76093382, "body": "@Jeeped  that w kid be even better ;) I&#39;m not in front of my PC now, I&#39;ll update it later."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1497462403, "last_edit_date": 1497462403, "creation_date": 1497457051, "answer_id": 44549915, "question_id": 44549854, "link": "https://stackoverflow.com/questions/44549854/select-active-sheet-doesnt-seem-to-work/44549915#44549915", "title": "Select Active Sheet doesnt seem to work", "body": "<p>Instead of <code>Select</code> the \"MAIN SHEET\", it's better if you use fully qualified objects.</p>\n\n<p>I think you meant your code to look something like the code below:</p>\n\n<pre><code>Sub sbClearMainSpreadsheet()\n\n    ' have the input confirmation box before clearing the contents (not after)\n    If MsgBox(\"Are you sure you want to clear the Main Spreadsheet?\", vbYesNo) = vbNo Then Exit Sub\n\n    With Worksheets(\"MAIN SHEET\")\n        .Range(\"A2:F500, J2:O500, R2:Y500\").ClearContents\n        .Range(\"A2:Y500\").Interior.Color = xlNone\n    End With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "is_accepted": false, "score": 0, "last_activity_date": 1497466061, "creation_date": 1497466061, "answer_id": 44552467, "question_id": 44549854, "link": "https://stackoverflow.com/questions/44549854/select-active-sheet-doesnt-seem-to-work/44552467#44552467", "title": "Select Active Sheet doesnt seem to work", "body": "<p>You should use the \"Activate\" method instead of the \"Select\" method.</p>\n\n<p>Worksheets(\"MAIN SHEET\").Activate</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff838003.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff838003.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8161652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/236933f903766c0c075937b6bea9e44c?s=128&d=identicon&r=PG&f=1", "display_name": "rams", "link": "https://stackoverflow.com/users/8161652/rams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1497466061, "creation_date": 1497456855, "last_edit_date": 1531164843, "question_id": 44549854, "link": "https://stackoverflow.com/questions/44549854/select-active-sheet-doesnt-seem-to-work", "title": "Select Active Sheet doesnt seem to work", "body": "<p>So I am trying to write a few macros where I adjust various different bits on a worksheet such as clearing contents and reordering. When the sheet in question \"MAIN SHEET\" is selected (open on the screen) the macros work fine. When I try to run them from a macro button on another sheet they obviously automatically interact with the active sheet in question. </p>\n\n<p>I have tried using the various different commands for making a sheet active / selecting a range but each time it comes up with Run-time Error 9</p>\n\n<p>Any help on what silly mistake I am making is would be much appreciated!</p>\n\n<p>The current incarnation of one of the codes is below</p>\n\n<pre><code>    Sub sbClearMainSpreadsheet()\nWorksheets(\"MAIN SHEET\").Range(\"A1:X999\").Select\n\nRange(\"A2:F500\").ClearContents\nRange(\"J2:O500\").ClearContents\nRange(\"R2:Y500\").ClearContents\nRange(\"A2:Y500\").Interior.Color = xlNone\n\nIf MsgBox(\"Are you sure you want to clear the Main Spreadsheet?\", vbYesNo) = vbNo Then Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>thanks</p>\n\n<p>A</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1497456344, "post_id": 44549532, "comment_id": 76090004, "body": "<code>ActiveSheet</code> possibly isn&#39;t what you think it is.  Maybe try to <code>Activate</code> the worksheet you want before you run the <code>Calculate</code> method, or at least debug it with something like <code>MsgBox ActiveSheet.Name</code> so you are sure exactly which sheet is currently active.  It&#39;s because of this potential confusion many people recommend never using <code>ActiveSheet</code> but always specifying the sheet directly."}, {"owner": {"reputation": 144, "user_id": 5426777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0941bf1a242261d9799047abde56f398?s=128&d=identicon&r=PG&f=1", "display_name": "LePatay", "link": "https://stackoverflow.com/users/5426777/lepatay"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1497509463, "post_id": 44549532, "comment_id": 76110239, "body": "ActiveSheet is correct, I already checked. Actually, everything goes normally (debug.print, msgbox...), except the .Calculate or .CalculateFull methods don&#39;t fire correctly."}], "answers": [{"tags": [], "owner": {"reputation": 144, "user_id": 5426777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0941bf1a242261d9799047abde56f398?s=128&d=identicon&r=PG&f=1", "display_name": "LePatay", "link": "https://stackoverflow.com/users/5426777/lepatay"}, "is_accepted": true, "score": 0, "last_activity_date": 1497885084, "last_edit_date": 1497885084, "creation_date": 1497511949, "answer_id": 44561371, "question_id": 44549532, "link": "https://stackoverflow.com/questions/44549532/excel-2003-workbook-activate-bug-for-activesheet-calculate/44561371#44561371", "title": "Excel 2003 - Workbook_Activate bug for ActiveSheet.Calculate", "body": "<p>I found a simple solution to avoid the bug.</p>\n\n<pre><code>Private Sub Workbook_Deactivate()\n    Application.Calculation = xlCalculationManual\nEnd Sub\n\nPrivate Sub Workbook_Activate()\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>[Edit]<br>\n... But it was not acceptable, because the calculation was set to \"Manual\" by default on any other opened workbook.</p>\n\n<p>The best solution is here: <a href=\"https://stackoverflow.com/questions/44633326/excel-2003-display-bug-with-conditional-formatting/44634116#44634116\">Excel 2003 - Display bug with conditional formatting</a></p>\n"}], "owner": {"reputation": 144, "user_id": 5426777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0941bf1a242261d9799047abde56f398?s=128&d=identicon&r=PG&f=1", "display_name": "LePatay", "link": "https://stackoverflow.com/users/5426777/lepatay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 44561371, "answer_count": 1, "score": 0, "last_activity_date": 1497885084, "creation_date": 1497455886, "last_edit_date": 1531164843, "question_id": 44549532, "link": "https://stackoverflow.com/questions/44549532/excel-2003-workbook-activate-bug-for-activesheet-calculate", "title": "Excel 2003 - Workbook_Activate bug for ActiveSheet.Calculate", "body": "<p><em>Context:</em><br>\nExcel 2003, Windows 7 Professional SP1 </p>\n\n<ol>\n<li>Working on workbook A, which contains custom functions.</li>\n<li>Workbook B is opened or edited</li>\n<li><p>Back to workbook A, which <code>Workbook_Activate</code> sub is the following:</p>\n\n<pre><code>Private Sub Workbook_Activate\n    ActiveSheet.Calculate\nEnd Sub\n</code></pre></li>\n<li><p>This procedure should force the calculation of custom functions of workbook A, which cells display <code>#VALUE</code> during the edition of workbook B.</p></li>\n</ol>\n\n<p><em>Below are the bugs I get on my computer, I hope you can help me with them!</em></p>\n\n<ul>\n<li>When the workbook (not the whole Excel window) IS NOT in state <code>ActiveWindow.WindowState = xlNormal</code> (i.e. it is full screen or minimized)  </li>\n</ul>\n\n<p><strong>OR:</strong></p>\n\n<ul>\n<li>When the workbook IS in state <code>ActiveWindow.WindowState = xlNormal</code> and the workbook has a width > 725 pixels (!)</li>\n</ul>\n\n<p><strong>THEN:</strong></p>\n\n<ul>\n<li>The function <code>Workbook_Activate</code> is fired all the way (good thing).</li>\n<li>The function <code>ActiveSheet.Calculate</code> is not fired (or without effect).</li>\n<li>Breakpoints don't stop the code.</li>\n<li>You can't run any code that edits cells, or run <code>Application.CalculateFull</code>, without getting a display bug such as entire ranges where the text or border vanish until the ranges have been selected.</li>\n</ul>\n\n<p><strong>PROBLEM SOLVING:</strong></p>\n\n<p>In procedure <code>Workbook_Activate</code>, if we add <code>ActiveWindow.WindowState = xlNormal</code> before <code>ActiveSheet.Calculate</code>:</p>\n\n<p>When the workbook IS NOT in state <code>ActiveWindow.WindowState = xlNormal</code> and the Excel window IS maximized</p>\n\n<ul>\n<li>ONLY in this case, the bugs remain. It's the only case where function ActiveSheet.Calculate is not fired. <code>ActiveWindow</code>methods don't fire either.</li>\n</ul>\n\n<p><em>Obs.:</em> <code>Application.EnableEvents = False</code> doesn't change anything. (It's probably not even triggered.)</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["string", "vba", "loops", "while-loop", "ms-word"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1497456451, "post_id": 44549527, "comment_id": 76090075, "body": "For starters, <code>InStr</code> only allows one text value to be checked at any time - your setup will fail with syntax errors because you are providing 4 strings.  Same with <code>Selection.Find</code> - search for a single text string at a time.  Or cook up an interesting regular expression."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1497456594, "post_id": 44549527, "comment_id": 76090147, "body": "Also, you can&#39;t do these <code>.Find</code> commands unless you already opened the document."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1497456702, "post_id": 44549527, "comment_id": 76090198, "body": "If you&#39;re using Word, you will find that <code>Application.Workbook.Open</code> won&#39;t work - that&#39;s an Excel VBA command (and it&#39;s wrong even in Excel, it would be <code>Workbooks</code> not <code>workbook</code>, you&#39;d need <code>Application.Documents.Open</code>.  Same with <code>ActiveWorkbook.Close</code> - Workbook is an Excel object, not Word.  <code>ActiveDocument.Close</code> would be the correct command"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1497456819, "post_id": 44549527, "comment_id": 76090260, "body": "You have a <code>Sub</code> inside your <code>Sub</code> - these should be separate entities that call each other where necessary"}, {"owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1497462385, "post_id": 44549527, "comment_id": 76093451, "body": "Dave, would you be willing to provide an answer? I could edit the pieces you shared but it would ultimately leave me in the same place I was."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497543261, "post_id": 44563853, "comment_id": 76133325, "body": "I get the following Run-time error: This method or property is not available because the object refers to a protected area of the document. --&gt; while debugging, error starts at .Execute. --&gt; I am not familiar with this error nor how to solve it. If the document is protected in any way, it wouldn&#39;t be password protected"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497556491, "post_id": 44563853, "comment_id": 76140612, "body": "Sorry, without knowing more about the document I can&#39;t help further. I checked and this code definitely works on normal .docx files. If the files you are working with contain protected ranges or content maybe that&#39;s what&#39;s causing the problem? Without the document to hand I can&#39;t say. Have you tried googling the error message?"}, {"owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497564409, "post_id": 44563853, "comment_id": 76144298, "body": "So I troubleshooted and found all the files causing errors, they are forms that only allow certain portions to be edited. I would still like to search them for a string and delete if exists. The strings can be found within the doc using ctrl+f but not edited. Any ideas? The code works great for all other files though!"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1497518863, "creation_date": 1497518863, "answer_id": 44563853, "question_id": 44549527, "link": "https://stackoverflow.com/questions/44549527/how-to-delete-a-ms-word-document-if-it-contains-various-phrases-with-vba/44563853#44563853", "title": "How to delete a ms-word document if it contains various phrases with VBA?", "body": "<p>Here's how I would do it.  You might want to test this by commenting out the <code>oFile.Delete</code> and replace it with a <code>MsgBox oFile.Name</code> so it doesn't just delete files.  Once you're happy that it's definitely finding the files you require, use the delete command.</p>\n\n<pre><code>Option Explicit\n\n\nSub loopFiles()\n    Dim oFso: Set oFso = CreateObject(\"Scripting.FileSystemObject\") ' create FileSystemObject\n    Dim oFolder: Set oFolder = oFso.GetFolder(oFso.GetParentFolderName(ThisDocument.Path))    ' Set folder to the Parent of the folder containing this file\n    Dim oFile, oDocument, textVal, bFound\n    Dim TextValues: TextValues = Array(\"Aircraft Survey\", \"Cc:\", \"UTAS\", \"Inserted in the word document is a pdf file\") ' create array of terms to check\n\n    For Each oFile In oFolder.Files\n        If Right(oFile.Name, 5) = \".docx\" Then  ' if file is a *.docx\n            Set oDocument = Documents.Open(oFile.Path)  ' Open it\n            bFound = False                              ' Initialise\n            For Each textVal In TextValues  ' check for each text value\n                With oDocument.Content.Find\n                    .Text = textVal\n                    .Forward = True\n                    .Execute\n                    If .Found = True Then       ' if found then set bFound\n                        bFound = True\n                        Exit For                ' and exit the loop, no need to keep looking\n                    End If\n                End With\n            Next\n            oDocument.Close wdDoNotSaveChanges  ' close file and don't save any changes\n            If bFound = True Then               ' If the text was found in the file\n                oFile.Delete                    ' delete the file\n            End If\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 44563853, "answer_count": 1, "score": 0, "last_activity_date": 1497518863, "creation_date": 1497455872, "question_id": 44549527, "link": "https://stackoverflow.com/questions/44549527/how-to-delete-a-ms-word-document-if-it-contains-various-phrases-with-vba", "title": "How to delete a ms-word document if it contains various phrases with VBA?", "body": "<p>I am very new to VBA and I am aware this contains errors. </p>\n\n<p>In MS-Word developer, I would like to go up one directory, search all *.docx files for multiple strings, if any of the strings exist within the *docx file, I would like to delete the file. </p>\n\n<pre><code>Sub loopFiles()\n\nDim fso As New FileSystemObject\nDim fil As File\nDim fold As Folder\nDim yourfolder As String\nDim UpOneDir As String\n\nSet fold = fso.GetFolder(Application.ActiveWorkbook.Path)\n\nFor Each fil In fold.Files\n\nUpOneDir = Left(fil.Path, Len(fil.Path) - Len(fil.Name) - 1 - Len(Split(Left(fil.Path, Len(fil.Path) - Len(fil.Name) - 1), \"\\\")(UBound(Split(Left(fil.Path, Len(fil.Path) - Len(fil.Name) - 1), \"\\\")))))\n\nSub FindIt()\n        Selection.HomeKey Unit:=wdStory\n        With Selection.Find\n            .ClearFormatting\n            .Text = \"Aircraft Survey\",\"Cc:\",\"UTAS\",\"Inserted in the word document is a pdf file\"\n            .Forward = True\n            .Wrap = wdFindStop\n            .Format = False\n            .MatchCase = False\n            .MatchWholeWord = False\n            .MatchAllWordForms = False\n            .MatchSoundsLike = False\n            .MatchWildcards = True\n            Do While .Execute\n\n            If InStr(1, fil.Text, \"Aircraft Survey\",\"Cc:\",\"UTAS\",\"Inserted in the word document is a pdf file\") &gt; 0 Then\n                Application.Workbook.Open fil.Path\n                ActiveWorkbook.Close\n\n            fil.Delete True\n        End If\n    Loop\nEnd With\nEnd Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1497456965, "post_id": 44549479, "comment_id": 76090329, "body": "With <code>SearchDirection:=xlNext</code> I think it would be better to start off with <code>Set aCell = rng.Cells(1, rng.columns.count)</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1497458250, "post_id": 44549479, "comment_id": 76091055, "body": "@Jeeped - Ahh, good point. That would have the cell start at the <i>end</i> of the range, and then go forward, right? Would you therefore no longer need the <code>COUNTIF()</code> part?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1497458759, "post_id": 44549479, "comment_id": 76091309, "body": "Actually, I&#39;m unclear on the exit point for that For .. Next loop. The OP&#39;s narrative doesn&#39;t make sense to me without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1497456194, "last_edit_date": 1497456194, "creation_date": 1497455752, "answer_id": 44549479, "question_id": 44549329, "link": "https://stackoverflow.com/questions/44549329/repeat-vba-find-across-subsequent-columns-in-excel/44549479#44549479", "title": "Repeat VBA Find across subsequent columns in Excel", "body": "<p>You should add the option for <code>After</code> to <code>Set aCell</code>:</p>\n\n<p>First, right before the <code>With</code> statement, add <code>Set aCell = rng.Cells(1, 1)</code>. Then switch the <code>Set aCell</code> to:</p>\n\n<pre><code>Set aCell = Worksheets(\"RawData\").Range(\"A1:ZZ1\").Find(What:=Verb1, _\n    LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False, SearchFormat:=False, after:=aCell)\n</code></pre>\n\n<p>Also, there may be a more elegant way, but since you're looping through the cells in the range <em>regardless</em> if you've found all instances of the string, you could add a quick <code>COUNTIF()</code> to see how many times you should be copying the info:</p>\n\n<pre><code>Sub Paste2()\n\nDim ws1     As Worksheet, ws2     As Worksheet\nDim aCell   As Range, rng As Range, cel As Range\nDim NextCol As Long, numOccur As Long\n\nSet ws1 = ThisWorkbook.Sheets(\"RawData\")\nSet ws2 = ThisWorkbook.Sheets(\"Verbatim\")\nSet rng = ThisWorkbook.Sheets(\"RawData\").Range(\"A1:ZZ1\")\nNextCol = 0\n\nnumOccur = Application.WorksheetFunction.CountIf(rng, Verb1)\n\nSet aCell = rng.Cells(1, 1)\nWith ws1\n    'Copy and Paste Verbatim\n    For Each cel In rng\n        NextCol = NextCol + 1\n        Set aCell = .Range(\"A1:ZZ1\").Find(What:=Verb1, LookIn:=xlValues, LookAt:=xlPart, _\n            MatchCase:=False, SearchFormat:=False, SearchDirection:=xlNext, After:=aCell)\n        Debug.Print Verb1 &amp; \" found in cell \" &amp; aCell.Address\n        aCell.EntireColumn.Copy ws2.Cells(1, NextCol)\n        If NextCol = numOccur Then Exit For\n    Next cel\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6134095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eca42d55f8df1338d247ad94aa237036?s=128&d=identicon&r=PG&f=1", "display_name": "mantika", "link": "https://stackoverflow.com/users/6134095/mantika"}, "edited": false, "score": 0, "creation_date": 1497514816, "post_id": 44550003, "comment_id": 76113555, "body": "Thank you, this worked beautifully, and the cleaning up of my code is much appreciated too."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 23, "user_id": 6134095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eca42d55f8df1338d247ad94aa237036?s=128&d=identicon&r=PG&f=1", "display_name": "mantika", "link": "https://stackoverflow.com/users/6134095/mantika"}, "edited": false, "score": 0, "creation_date": 1497523747, "post_id": 44550003, "comment_id": 76119635, "body": "@mantika I would be appreciative if you could mark my response as the answer, by clicking on the checkmark below the ratings indicator"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1497457660, "last_edit_date": 1497457660, "creation_date": 1497457298, "answer_id": 44550003, "question_id": 44549329, "link": "https://stackoverflow.com/questions/44549329/repeat-vba-find-across-subsequent-columns-in-excel/44550003#44550003", "title": "Repeat VBA Find across subsequent columns in Excel", "body": "<p>Here is another way using <code>.FindNext</code>, and cleaning up some of your code.</p>\n\n<pre><code>Option Explicit\n\nPublic Verb1 As String\n\nSub Paste2()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim aCell As Range\nDim Rng As Range\nDim NextCol As Long\nDim sFirstAddress As String\n\nSet ws1 = ThisWorkbook.Sheets(\"RawData\")\nSet ws2 = ThisWorkbook.Sheets(\"Verbatim\")\nSet Rng = ThisWorkbook.Sheets(\"RawData\").Range(\"A1:ZZ1\")\nNextCol = 0\n\n'No need to \"Activate\"\n'Worksheets(\"RawData\").Activate\n\nWith Rng\n'Copy and Paste Verbatim\n    Set aCell = .Find(what:=Verb1, after:=Rng.End(xlToRight), LookIn:=xlValues, _\n            lookat:=xlPart, searchorder:=xlByColumns, searchdirection:=xlNext, _\n            MatchCase:=False)\n    If Not aCell Is Nothing Then\n        sFirstAddress = aCell.Address\n        NextCol = NextCol + 1\n        aCell.EntireColumn.Copy ws2.Cells(1, NextCol)\n\n        Do\n            Set aCell = .FindNext(aCell)\n            If Not aCell.Address = sFirstAddress Then\n                NextCol = NextCol + 1\n                aCell.EntireColumn.Copy ws2.Cells(1, NextCol)\n            End If\n        Loop Until sFirstAddress = aCell.Address\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6134095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eca42d55f8df1338d247ad94aa237036?s=128&d=identicon&r=PG&f=1", "display_name": "mantika", "link": "https://stackoverflow.com/users/6134095/mantika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 44550003, "answer_count": 2, "score": 0, "last_activity_date": 1497457660, "creation_date": 1497455299, "question_id": 44549329, "link": "https://stackoverflow.com/questions/44549329/repeat-vba-find-across-subsequent-columns-in-excel", "title": "Repeat VBA Find across subsequent columns in Excel", "body": "<p>As you'll probably be able to tell from the code, I'm pretty new to VBA, so apologies if this turns out to be a stupid question. </p>\n\n<p>I need a block of code that looks at one worksheet (RawData) for a text string specified in the Global variable Verb1, and pastes it into the first empty column of a different worksheet (Verbatim). </p>\n\n<p>My difficulty is that the string stored in Verb1 could appear 1, 2, or 3 times in RawData, so I need the Find function to check multiple columns, even after it's found the first occurrence of the string. </p>\n\n<p>What my code is actually doing, however, is copying the column that holds the first occurrence of the string, and pasting it a number of times equal to the number of columns in my search range... in this case, 688 times. </p>\n\n<p>I've checked that the code works without the For... Next statement (i.e. it finds the first occurrence of the string, and pastes it into the first blank column of the Verbatim worksheet), but I can't see what the error is in this statement. </p>\n\n<pre><code>Public Verb1 As String\n\nSub Paste2()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim aCell As Range\nDim NextCol As Long\n\nSet ws1 = ThisWorkbook.Sheets(\"RawData\")\nSet ws2 = ThisWorkbook.Sheets(\"Verbatim\")\nSet Rng = ThisWorkbook.Sheets(\"RawData\").Range(\"A1:ZZ1\")\nNextCol = 0\n\nWorksheets(\"RawData\").Activate\nWith ws1\n'Copy and Paste Verbatim\nFor Each Cell in Rng\n    NextCol = NextCol + 1\n    Set aCell = Worksheets(\"RawData\").Range(\"A1:ZZ1\").Find(What:=Verb1, \n    LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False, SearchFormat:=False)\n    aCell.EntireColumn.Copy ws2.Cells(1, NextCol)\nNext Cell\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Can anyone point me in the right direction? </p>\n\n<p>Many thanks in advance for your help.   </p>\n"}, {"tags": ["html", "css", "vba", "excel"], "comments": [{"owner": {"reputation": 1776, "user_id": 2045087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a37b1b81e3df81ae4222481373a3e8?s=128&d=identicon&r=PG&f=1", "display_name": "tech2017", "link": "https://stackoverflow.com/users/2045087/tech2017"}, "edited": false, "score": 0, "creation_date": 1497455217, "post_id": 44549262, "comment_id": 76089240, "body": "i do not think it is possible with inline styles."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1497455486, "post_id": 44549262, "comment_id": 76089418, "body": "related: <a href=\"https://stackoverflow.com/questions/22484020/what-do-before-and-after-mean\">What do ::before and ::after mean?</a>"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1497459931, "post_id": 44549262, "comment_id": 76092009, "body": "If you get the HTML in a text response instead of xmldom you could string manipulate to extract everything after &#39;class=&quot;outer&quot;&gt;&#39; and before &#39;&#39;  I had to make a string manipulating function at work to handle poorly written HTML code that won&#39;t load in to an xmldom object and it works great for even large html files."}, {"owner": {"reputation": 131, "user_id": 2853164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5c1f200fafcf529c426b065b154612?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Baliki", "link": "https://stackoverflow.com/users/2853164/daniel-baliki"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1497460612, "post_id": 44549262, "comment_id": 76092367, "body": "@jamheadart Do you have the string manipulating function on hand?"}, {"owner": {"reputation": 131, "user_id": 2853164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5c1f200fafcf529c426b065b154612?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Baliki", "link": "https://stackoverflow.com/users/2853164/daniel-baliki"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1497468524, "post_id": 44549262, "comment_id": 76096747, "body": "@jamheadart I ended up finding a solution (see my answer). Thank you for your suggestion."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 2853164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5c1f200fafcf529c426b065b154612?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Baliki", "link": "https://stackoverflow.com/users/2853164/daniel-baliki"}, "is_accepted": true, "score": 1, "last_activity_date": 1497471320, "last_edit_date": 1497471320, "creation_date": 1497468222, "answer_id": 44553097, "question_id": 44549262, "link": "https://stackoverflow.com/questions/44549262/excel-vba-scrape-css-elements-found-in-html-document/44553097#44553097", "title": "Excel VBA scrape CSS elements found in HTML document", "body": "<p>I figured it out. I ended up using a different method than trying to find ::before and ::after. </p>\n\n<p>Notes:\nI observed how the HTML document changed as the search went on and noticed that the parent of the HTML snippet I included above changed when the application entered or exited a loading state. </p>\n\n<pre><code>&lt;div id=\"snippetParent\" class=\"overlay\" style=\"width: 100%; height: 100%; top: 0px; left: 0px; position: absolute; display: block;\"&gt;\n\n    &lt;div id=\"abc\" class=\"outer\"&gt;\n        &lt;div class=\"inner\"&gt;&lt;/div&gt;\n    &lt;/div&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>The \"Style\" attribute's \"display\" property changed to \"display: block\" while loading, and changed to \"display: none\" when it was not loading. </p>\n\n<p>There was also a popup that appeared if the application was taking too long to load (popup ID is \"popup\" for the purpose of this question). This popup makes the style mentioned above go from block to none. I had to include in the while loop below a condition for when the popup appears.</p>\n\n<p>The \"good\" boolean is false until any indicators of loading disappear. Then it becomes true and consequently exits the while loop. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>Do While good = False\n    For Each tx In Split(Document.getElementById(\"snippetParent\").Style.cssText, \"; \")\n        If tx = \"display: block\" Then\n            good = False\n            UpdateBrowser BB:=Browser, waitSeconds:=\"02\"\n        ElseIf tx = \"display: none\" Then\n            txtDocument = \"\"\n            On Error Resume Next\n            txtDocument = Document.getElementById(\"popup\").innerHTML\n\n            If txtDocument = \"&lt;b&gt;Retrieving Data...&lt;/b&gt;\" Then\n                Beep\n                UpdateBrowser BB:=Browser, waitSeconds:=\"02\"\n            Else\n                good = True\n            End If\n        Else\n            'Not display\n        End If\n    Next tx\nLoop\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 2853164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5c1f200fafcf529c426b065b154612?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Baliki", "link": "https://stackoverflow.com/users/2853164/daniel-baliki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2571, "favorite_count": 0, "accepted_answer_id": 44553097, "answer_count": 1, "score": 1, "last_activity_date": 1497471320, "creation_date": 1497455092, "question_id": 44549262, "link": "https://stackoverflow.com/questions/44549262/excel-vba-scrape-css-elements-found-in-html-document", "title": "Excel VBA scrape CSS elements found in HTML document", "body": "<p>Here is the part of the HTML document that I'm trying to scrape from:</p>\n\n<pre><code>&lt;div id=\"abc\" class=\"outer\"&gt;   \n    ::before\n    &lt;div class=\"inner\"&gt;&lt;/div&gt;\n    ::after\n&lt;/div&gt;\n</code></pre>\n\n<p>I tried to get the innerHTML of this snippet using</p>\n\n<pre><code>Set Elements = Document.getElementsByClassName(\"outer\")\nMsgBox Elements(0).innerHTML\n</code></pre>\n\n<p>The only thing that pops up in the message box is (without quotes):</p>\n\n<pre><code>\"&lt;div class=\"inner\"&gt;&lt;/div&gt;\"\n</code></pre>\n\n<p>innerHTML seems to ignore the ::before and ::after CSS pseudo-elements. Is there any way to grab these or determine if they are even there?</p>\n\n<p>The reason I'm asking is that when the application I'm trying to automate is in a loading state, the ::before and ::after elements are there. Once it is out of a loading state, these elements disappear.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 3, "creation_date": 1497454835, "post_id": 44549118, "comment_id": 76088984, "body": "The <i>easiest</i> way is probably to start recording a macro then manually use the <i>Data =&gt; From Text</i> tool to do an import, stop recording and monkey about with the generated code.  (This will not involve the use of a textbox)"}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 8161411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce3249d6b867258af6992c7db4c7cef?s=128&d=identicon&r=PG&f=1", "display_name": "donCalculator", "link": "https://stackoverflow.com/users/8161411/doncalculator"}, "is_accepted": false, "score": 0, "last_activity_date": 1497458039, "last_edit_date": 1497458039, "creation_date": 1497456124, "answer_id": 44549621, "question_id": 44549118, "link": "https://stackoverflow.com/questions/44549118/excel-vba-macro-to-parse-multi-line-tabbed-textbox/44549621#44549621", "title": "excel VBA macro to parse multi-line tabbed textbox", "body": "<p>You need to split the value of the textbox twice, first create rows, and then further split that into cells.</p>\n\n<pre><code>Dim rows As Variant\nDim columns As Variant\nDim i As Integer\nDim j As Integer\n\ni = 1\nrows = Split(TextBox1.Value, vbNewLine)\n\nFor Each r In rows\n\nj = 1\ncolumns = Split(r, vbTab)\n\nFor Each c In columns\n\nSheets(\"Sheet1\").Cells(i, j).Value = c\n\nj = j + 1\n\nNext c\ni = i + 1\nNext r\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8161441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/529f4a196033518b8928414862f5e34a?s=128&d=identicon&r=PG&f=1", "display_name": "Yossi A", "link": "https://stackoverflow.com/users/8161441/yossi-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 881, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497458039, "creation_date": 1497454616, "last_edit_date": 1497455420, "question_id": 44549118, "link": "https://stackoverflow.com/questions/44549118/excel-vba-macro-to-parse-multi-line-tabbed-textbox", "title": "excel VBA macro to parse multi-line tabbed textbox", "body": "<p>I'm fairly new making macros for excel and I think I'm being a bit too ambitious in my latest project. I basically want to parse the output of a piece of lab equipment to help me file cells in a file that I will use to process my experimental data.</p>\n\n<p>I wanted to paste the raw output from the device in a text box, and then have a macro split the data across multiple cells.\nIn the raw data, text is separated horizontally by tabs and vertically by line breaks.</p>\n\n<p>E.g.</p>\n\n<p>data1 [tab] data2 [tab] data3 [Line break]\ndata4 [tab] data5 [tab] data6 [LB]</p>\n\n<p>and so on, which would then be parsed into 3 cells horizontally across 2 cells vertically.</p>\n\n<p>Any ideas how to do this easily?</p>\n\n<p>cheers\nYossi.</p>\n"}, {"tags": ["c++", "vba", "excel", "dll"], "comments": [{"owner": {"reputation": 51, "user_id": 8121082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ko24j.jpg?s=128&g=1", "display_name": "Alex Wardlow", "link": "https://stackoverflow.com/users/8121082/alex-wardlow"}, "edited": false, "score": 0, "creation_date": 1497456498, "post_id": 44549023, "comment_id": 76090091, "body": "<a href=\"http://www.cpearson.com/excel/sizestring.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/sizestring.htm</a>"}, {"owner": {"reputation": 51, "user_id": 8121082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ko24j.jpg?s=128&g=1", "display_name": "Alex Wardlow", "link": "https://stackoverflow.com/users/8121082/alex-wardlow"}, "edited": false, "score": 0, "creation_date": 1497456558, "post_id": 44549023, "comment_id": 76090120, "body": "this link is where I found the *length notation for defining strings. I would like to be able to specify the length of each string in the array, this is why I did this, but you may be correct in that I have done this incorrectly with the array. I do know it works for a single string."}, {"owner": {"reputation": 51, "user_id": 8121082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ko24j.jpg?s=128&g=1", "display_name": "Alex Wardlow", "link": "https://stackoverflow.com/users/8121082/alex-wardlow"}, "edited": false, "score": 0, "creation_date": 1497456852, "post_id": 44549023, "comment_id": 76090271, "body": "I am unsure of how I would use the stringName = String(0,#) with an array or if that is what I should use."}, {"owner": {"reputation": 51, "user_id": 8121082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ko24j.jpg?s=128&g=1", "display_name": "Alex Wardlow", "link": "https://stackoverflow.com/users/8121082/alex-wardlow"}, "edited": false, "score": 0, "creation_date": 1497457545, "post_id": 44549023, "comment_id": 76090648, "body": "Also if I simply remove the *stringLength the Len(stringArray(0)) is 0, when watched in excel"}], "owner": {"reputation": 51, "user_id": 8121082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ko24j.jpg?s=128&g=1", "display_name": "Alex Wardlow", "link": "https://stackoverflow.com/users/8121082/alex-wardlow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1506255183, "creation_date": 1497454337, "last_edit_date": 1506255183, "question_id": 44549023, "link": "https://stackoverflow.com/questions/44549023/sending-an-array-of-strings-from-vba-to-a-c-dll-then-iterating-through-those", "title": "Sending an array of strings from VBA to a C++ DLL, then iterating through those strings", "body": "<p>I am making a C++ DLL to allow for serial communication in Excel. It is working for the most part, but I am hung up on string arrays in VBA. This specific function of my DLL should take in an (array of char*, integer representing their length, a pointer to the beginning of a double array where I will stored parsed data for each string, and an integer representing how many doubles are in each line (numRows))</p>\n\n<p>Here is the DLL code.</p>\n\n<pre><code>//first read a lines from the serial port and then parse it into dataArray, does this until there is no data in buffer or array is full\n//returns how many rows that it read\nDLL_EXPORT int WINAPI parseAllLinesFromSerialPort(char* lineBuff, int bufferLength, double* dataArray, int numRows) {\n    int currentRow = 0;\n    bufferAvailable = true; //it is first assumed that there is available data to be read, this is checked down the line, if false the functions return\n    while((bufferAvailable) &amp;&amp; (currentRow &lt; numRows)) {\n         parseLine((lineBuff + (currentRow*bufferLength)), bufferLength, (dataArray + (currentRow*numColumns)));\n         if (bufferAvailable) {\n               currentRow++;\n         }\n    }\n    return currentRow;\n}\n</code></pre>\n\n<p>So the double array part works just fine if I just pass the first string, however, if I try to send the next string each time, it simply crashes when I first call the DLL function (I believe this is where it crashes). Am I not iterating through the string array right, is it not the size I think it is, or in the following VBA have I initialized the array wrong or passed it into the DLL wrong?</p>\n\n<p>This is the VBA code.\nSee specifically the collectAllDataAvailable() function, as this is the one that calls that DLL function.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\n'reads all avialable lines from serial\nPublic Declare Function parseAllLinesFromSerialPort _\nLib \"C:\\Users\\alexw\\Desktop\\Parsing\\bin\\Debug\\ArduinoTesterDll.dll\" _\n(line As String, ByVal length As Integer, dataArray As Double, ByVal numRows As Long) As Long\n\n\n'Global Variables\nPublic currentDataRow As Long 'keeps track of the currentRow that data is being read into\nPublic Const numRows As Long = 100 'number of rows grabed at a time by collectAllDataAvailable\nPublic Const stringLength As Integer = numRows * 8\n\n'selects then clears the dataCollection\nPublic Sub clearDataCollectionAndBuffers()\n    'clears the whole right side under row 5 to column AZ\n    Main.Range(\"K6:AZ1048575\").Select\n    Selection.ClearContents\n    'Clears the Serial Window\n    Main.dataBox.Text = \"\"\n    'sets the next data read row to begin at 6\n    currentDataRow = 6\n    'clears the serial buffers\n    Call clearSerialPort 'See Module 1\nEnd Sub\n\n'collects all rows available, up to 46000, currently 1000 lines, set above as a global numRows\nPublic Sub collectAllDataAvailable()\n    Dim J As Integer ' increment variables for a for loop\n    Dim I As Integer\n\n    Dim startingCol As Integer 'for K this would be 11\n    startingCol = 11\n\n    Dim numCol As Long 'how many data point (3 for #,#,#)\n    Dim numRowsRead As Long 'how many rows are read (were available)\n    numCol = getNumColumns 'see module 2 for function getNumColumns\n\n    Dim arrayLength As Long\n    arrayLength = (numCol * numRows) 'grabs global numRows lines at a time if available, this is a maximum\n\n    Dim dataArray() As Double\n    ReDim dataArray(0 To (arrayLength - 1)) As Double\n\n    Dim lineArray() As String * stringLength 'global, needs to be big enough hold each row od data\n    ReDim lineArray(0 To (numRows - 1)) As String * stringLength\n\n    numRowsRead = parseAllLinesFromSerialPort(lineArray(0), Len(lineArray(0)), dataArray(0), numRows)\n\n    For J = 0 To (numRowsRead - 1)\n        Main.dataBox.Text = Main.dataBox.Text &amp; lineArray(J)\n        For I = 0 To (numCol - 1)\n            Main.Cells((J + currentDataRow), (I + startingCol)).Value = dataArray(I + (J * numCol))\n        Next I\n    Next J\n\n    currentDataRow = currentDataRow + numRowsRead\n    'only stoped in Main sheets code for stopDataButton\n    If Main.dataCollectionActive Then Application.OnTime Now + TimeValue(\"00:00:01\"), \"collectAllDataAvailable\"\nEnd Sub\n\nPublic Sub writeCommand()\n    Dim bytesWritten As Integer\n    bytesWritten = writeToSerialPort(Main.Range(\"Command\").Value, Len(Main.Range(\"Command\").Value))\nEnd Sub\n</code></pre>\n\n<p>When I pass just a string, and do not worry about an array and iterating through it. Then the VBA and excel works fine (other than the fact that I loose other strings I want to keep as they are written over each other each time I call parseLine in the DLL with the one string that I have). I want to be able to save each string that I am parsing into the Double array so that when I return from the DLL I have all the strings that I parsed so that I can display them. However when I tried to implement this array of strings, Excel now simply crashes upon the attempt to call the parseAllLinesFromSerialPort function. Any idea what I am doing wrong here? Also I will take any other suggestions to clean up my current code as I am doing this project for a job.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1497454345, "post_id": 44548949, "comment_id": 76088687, "body": "Does <code>=SUMIF(B:B, &quot;EUR&quot;, M:N)</code> do it for you? What about <code>=SUMIF(B:B, &quot;EUR&quot;, M:M)+SUMIF(B:B, &quot;EUR&quot;, N:N)</code> ?"}, {"owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "edited": false, "score": 0, "creation_date": 1497454603, "post_id": 44548949, "comment_id": 76088863, "body": "Cant believe I didn&#39;t write here earlier haha the second one worked.  Would you know maybe what was the reason for the first one not to calculate it correctly?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1497454720, "post_id": 44548949, "comment_id": 76088926, "body": "<code>M:M:N:N</code> is not a valid cell range for anything and <code>M:N</code> (two columns) cannot be used in sumif without additional consideration."}], "owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497454956, "creation_date": 1497454166, "last_edit_date": 1497454956, "question_id": 44548949, "link": "https://stackoverflow.com/questions/44548949/sumif-conditional-based-sum", "title": "SUMIF Conditional based sum", "body": "<p>I'll explain whats going on with the left table first:</p>\n\n<p><img src=\"https://i.stack.imgur.com/MSJJ2.png\" alt=\"11\"></p>\n\n<p>Qty1 Normal Calculates a sum from another column, Qt2 Normal calculates a product. </p>\n\n<p>The table to the right is supposed to calculate based on an entry in column B, the result in both columns M and N (even when negative). \nSo basically, no matter where on Column B there will be an entry for \"EUR\" its suppose to sum Qty1 Normal and Qty2 Normal</p>\n\n<p>I've been spending the last 2.5 hours trying to figure out, trying SUMPRODUCT, IF(SUM( and many other arguments I could try coming up and googling. </p>\n\n<p>The function looks as such:</p>\n\n<pre><code>=SUMIF(B:B,\"EUR\",(M:M:N:N))\n</code></pre>\n\n<p>the result should be (826000) and unfortunately I couldn't figure out what is wrong with the function I wrote. </p>\n\n<p>If there is a solution within VBA that will be great, however I believe we can solve this within the simple function regions. </p>\n\n<p>Thank you!! </p>\n"}, {"tags": ["vba", "excel", "shading"], "comments": [{"owner": {"reputation": 2825, "user_id": 3723803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Fujn1.jpg?s=128&g=1", "display_name": "Tim Hutchison", "link": "https://stackoverflow.com/users/3723803/tim-hutchison"}, "edited": false, "score": 1, "creation_date": 1497454796, "post_id": 44548868, "comment_id": 76088969, "body": "Can you translate the error message to English?  I see you can speak English pretty well since the rest of the post is in English.  See <a href=\"https://meta.stackexchange.com/questions/13676/do-posts-have-to-be-in-english-on-stack-exchange\" title=\"do posts have to be in english on stack exchange\">meta.stackexchange.com/questions/13676/&hellip;</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1497455220, "post_id": 44548868, "comment_id": 76089243, "body": "When it crashes, look at your &quot;actReg&quot; range and verify that the value in that cell is the name of one of your shapes."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2825, "user_id": 3723803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Fujn1.jpg?s=128&g=1", "display_name": "Tim Hutchison", "link": "https://stackoverflow.com/users/3723803/tim-hutchison"}, "edited": false, "score": 0, "creation_date": 1497455378, "post_id": 44548868, "comment_id": 76089343, "body": "@TimHutchison - Sorry - it looks like my edit collided with your edit.  I think I made all the changes you were trying to make anyway."}, {"owner": {"reputation": 11, "user_id": 8161324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f19741ee65e71e87c49b9eb1c992c5?s=128&d=identicon&r=PG&f=1", "display_name": "Megou", "link": "https://stackoverflow.com/users/8161324/megou"}, "reply_to_user": {"reputation": 2825, "user_id": 3723803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Fujn1.jpg?s=128&g=1", "display_name": "Tim Hutchison", "link": "https://stackoverflow.com/users/3723803/tim-hutchison"}, "edited": false, "score": 0, "creation_date": 1497599887, "post_id": 44548868, "comment_id": 76155485, "body": "Thanks for your help!  I realised yesterday that this error indeed came from the discrepancy between my &quot;actReg&quot; range and the name of the shape so I corrected it. Unfortunately it does not work yet, I have a new message error for the next line of code : &quot;Execution error &#39;1004&#39; : the &#39;Range&#39; method of the &#39;_Global&#39; object has failed&quot; (or something like that because I translated the french error message as you asked @TimHutchison) Hoping you have the answer for that too, thanks anyway for your help !!"}], "owner": {"reputation": 11, "user_id": 8161324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f19741ee65e71e87c49b9eb1c992c5?s=128&d=identicon&r=PG&f=1", "display_name": "Megou", "link": "https://stackoverflow.com/users/8161324/megou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1497454916, "creation_date": 1497453959, "last_edit_date": 1497454916, "question_id": 44548868, "link": "https://stackoverflow.com/questions/44548868/macro-for-interactive-map-in-excel-shading-process", "title": "Macro for interactive map in excel - shading process", "body": "<p>I've made a map (by looking through some guides) of the world for Excel that color-codes countries based on values entered in cells.\nI don't understand why an error message pops up for this code, stating that the name used doesn't quite exist. </p>\n\n<p>Here's the code : </p>\n\n<pre><code>Sub Shading()\n\n    For i = 3 To 79\n    Range(\"actReg\").Value = Range(\"ShadingMacro!A\" &amp; i).Value\n    ActiveSheet.Shapes(Range(\"actReg\").Value).Select\n    Selection.ShapeRange.Fill.ForeColor.RGB = Range(Range(\"actRegCode\").Value).Interior.Color\n\n    Next i\n\n    Range(\"A21\").Select[enter image description here][1]\n\nEnd Sub\n</code></pre>\n\n<p>And here's the error message (sorry it is in French) : </p>\n\n<blockquote>\n  <p>Erreur d'ex\u00e9cution '-2147024809 (80070057)':<br>\n  L'\u00e9l\u00e9ment portant ce nom est introuvable</p>\n</blockquote>\n\n<p>Then the \"d\u00e9bogage\" tool brings me to the 3rd line :</p>\n\n<pre><code>ActiveSheet.Shapes(Range(\"actReg\").Value).Select\n</code></pre>\n\n<p>But I don't quite understand where the problem is. </p>\n"}, {"tags": ["excel", "date", "insert", "range", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1497454732, "post_id": 44548762, "comment_id": 76088929, "body": "Paste what you have written so far into the question.  Then narrow your question down to show which bit you are <b>currently</b> stuck on (not your entire task if you are stuck on &quot;how do I get the date from the Original page&quot;)."}, {"owner": {"reputation": 1, "user_id": 8146184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532ad0900a74f3f9e84b1e3ee77f533f?s=128&d=identicon&r=PG&f=1", "display_name": "Lauren", "link": "https://stackoverflow.com/users/8146184/lauren"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1497457932, "post_id": 44548762, "comment_id": 76090874, "body": "Thanks YowE3K I have done as you asked."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1497473637, "post_id": 44548762, "comment_id": 76099432, "body": "I just noticed a statement in your question that I didn&#39;t notice this morning. (Hey - it was about 2am - I wasn&#39;t paying much attention!)  You say &quot;And it must be a macro, not a VBA&quot;.  Usually people call VBA code a &quot;macro&quot; - what do you see as the difference between the two?  (You pasted VBA code into the question, so I&#39;m very confused.)"}, {"owner": {"reputation": 1, "user_id": 8146184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532ad0900a74f3f9e84b1e3ee77f533f?s=128&d=identicon&r=PG&f=1", "display_name": "Lauren", "link": "https://stackoverflow.com/users/8146184/lauren"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1497484474, "post_id": 44548762, "comment_id": 76103323, "body": "My apologies, I was under the impression a VBA was automatic (for example I have a &quot;VBA&quot; set up to alphabetize all my tabs without my needing to trigger it, and a macro had to be run manually. Sorry for the confusion."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8146184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532ad0900a74f3f9e84b1e3ee77f533f?s=128&d=identicon&r=PG&f=1", "display_name": "Lauren", "link": "https://stackoverflow.com/users/8146184/lauren"}, "edited": false, "score": 0, "creation_date": 1497455679, "post_id": 44549051, "comment_id": 76089546, "body": "Hi, thanks I did try recording one - but I have no idea how to automate the &quot;looking up dates and inserting row based on cell value of E&quot; thing. If it was just copy-paste into a fixed cell on a certain page, I could do that no problem. But it&#39;s the date search that has me stuck. And making it go row by row individually searching, because what might be row 8-9-10 on the Original page might end up being 17-25-34 on the Transfer once you put in the dates right."}], "tags": [], "owner": {"reputation": 178, "user_id": 8161411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce3249d6b867258af6992c7db4c7cef?s=128&d=identicon&r=PG&f=1", "display_name": "donCalculator", "link": "https://stackoverflow.com/users/8161411/doncalculator"}, "is_accepted": false, "score": 1, "last_activity_date": 1497454429, "creation_date": 1497454429, "answer_id": 44549051, "question_id": 44548762, "link": "https://stackoverflow.com/questions/44548762/copy-range-between-sheets-searching-for-the-date-in-col-e-of-originalsheet-and/44549051#44549051", "title": "Copy range between sheets, searching for the date in Col-E of OriginalSheet and inserting it between date range of Column A", "body": "<p>All macros are basicly pieces of code written in VBA.</p>\n\n<p>I'd suggest you try out the macro recording feature. Just record the main idea, select X range then copy it to an other sheet.</p>\n\n<p>Once you done that, you can tweak the code to fit your needs.</p>\n"}], "owner": {"reputation": 1, "user_id": 8146184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532ad0900a74f3f9e84b1e3ee77f533f?s=128&d=identicon&r=PG&f=1", "display_name": "Lauren", "link": "https://stackoverflow.com/users/8146184/lauren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497505695, "creation_date": 1497453669, "last_edit_date": 1531161705, "question_id": 44548762, "link": "https://stackoverflow.com/questions/44548762/copy-range-between-sheets-searching-for-the-date-in-col-e-of-originalsheet-and", "title": "Copy range between sheets, searching for the date in Col-E of OriginalSheet and inserting it between date range of Column A", "body": "<p>I'm a bit of a Newbie but hopefully you'll be able to help me impress my new boss ;). </p>\n\n<p>My work has a program which outputs a bunch of data into a spreadsheet (can't change this, I only get the info at this point), and from that spreadsheet I've been told to manually copy-paste the range (section one is A8 to H8, section two is A9 to H9, so on), into another spreadsheet based on date (same workbook), inserting a new row to paste. </p>\n\n<p>Workbook is called \"Invoices\".</p>\n\n<p>Spreadsheet 1 -Original- columns are as follows: Blank, Blank, Blank, Reference, DATE, Memo, Agent, Paid.</p>\n\n<p>Spreadsheet 2 -Transfer-, (sorted by date): Mon Date, Sun Date, Amount Due, Reference, DATE, Memo, Agent, Paid.</p>\n\n<p>So currently I manually:\n1. Check the date on the Original page (column E)\n2. Go to the Transfer page\n3. Look for the date range in which it falls (column A), dates start at A20 if that helps.\n4. Insert a new row in that date range\n5. Go back to the original page\n6. Cut the range A-H\n7. Paste it into the newly created row of sheet 2 in cells A-H\n8. Recolour the new E cell to be blue.</p>\n\n<p>As you can see, Columns D-H on both pages are the same. If we're able to copy the value of E into A (dates), that'd be amazing but I can live without it.</p>\n\n<p>I have been trying to make a macro to do this, but I just can't get it to work. In a nutshell I want it to look up the date at Original Row E, look it up in Transfer Row A, insert a row BELOW (dates get later as you go down) and then paste that A:H range. </p>\n\n<p>If anyone could help me out I'd greatly appreciate it, and if they can tell me how to loop the macro so it does Row8 (where the data first appears, then goes back and does Row 9, I'd be over the moon. And if it's at all possible, I need it to get the tab name (the sheet name) from cell Z1 on the original page, which I've set up to output automatically. And it must be a macro, not a VBA.</p>\n\n<p>Thanks so much!</p>\n\n<p>Here is my recorded method, as suggested:</p>\n\n<pre><code>Sub Macro3()\n\n     'In the sheet I need to TRANSFER to &lt;- This part is fine\n        Sheets(\"Transfer\").Select\n\n     'Manually pick random row &lt;- this needs to be done automatically based on comparing value of \"Original\" E to \"Transfer\" A.\n         Rows(\"28:28\").Select\n         Selection.Insert Shift:=xlUp, CopyOrigin:=xlFormatFromLeftOrAbove\n\n     ' Need to delete otherwise the pre-existing formulas wont flow &lt;- Fine\n          Selection.ClearContents\n\n     ' Back to Original sheet &lt;- Fine\n           Sheets(\"Original\").Select\n\n     ' Select range I need to transfer &lt;- Fine\n              Range(\"A8:H8\").Select\n              Selection.Copy\n\n      'Back to TRANSFER sheet &lt;- Fine\n              Sheets(\"Transfer\").Select\n\n      'Select the A column of the row I created above. &lt;- Need automated to find the empty row\n                Range(\"A28\").Select\n\n       'Paste just the values. &lt;- Find\n               Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n\n<p>And then I would need it to loop back and do the same thing to row 9 and onward, until it reaches the end of the list (which varies in length - might be 5, might be 100.</p>\n\n<p>Here is what happens with the macro, YowE3K (have blacked out private info)</p>\n\n<p><a href=\"https://i.stack.imgur.com/sp6KP.png\" rel=\"nofollow noreferrer\">The \"Original\" and \"Transfer sheets\". Transfer is empty and Original has the data I want to copy</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/7NOAf.png\" rel=\"nofollow noreferrer\">What DID happen after running the macro and what I WANTED to happen. The cells all inserted themselves in a block, instead of each row inserting itself into a new row between the appropriate date ranges</a></p>\n\n<p>And the following is something a co-worker uses to pull info from \"Water Invoice\" (which would be my original), into \"Trust\". His only has to do one value in a set cell though, mine has to do one then loop back and do the next row.</p>\n\n<pre><code> Sub WaterInvoice3ToTrust()\n Dim water As Workbook\n     Set water = Workbooks(\"Water Invoice.xlsm\")\n     'Original File\n Dim trust As Workbook\n     Set trust = Workbooks(\"Trust.xlsm\")\n     'Transfer File\n Dim transfer As String\n Dim found As Range\n Dim search As Date\n Dim Discovered As Integer\n Dim onefrom As String\n\n     On Error Resume Next\n\n ' Open Transfer file if not open already\n     If Err &lt;&gt; 0 Then\n         On Error GoTo 0\n         Workbooks.Open (\"RETRACTED FOR PRIVACY\")\n     End If\n\n Discovered = 0\n\n 'Original File\n  Workbooks(\"Water Invoice\").Worksheets(\"00 Template\").Activate\n transfer = water.Sheets(\"00 Template\").Range(\"Z1\")  '&lt;--Z1 is the same as my Z1, shows the tab name\n search = water.Sheets(\"00 Template\").Range(\"AB8\")  ' &lt;--This is his date, would be my E8\n\n 'Where to search\n While Discovered = 0\n    Set found = trust.Sheets(transfer).Range(\"A:A\").Find(DateValue(search), LookIn:=xlFormulas, LookAt:=xlWhole)\n        If Not found Is Nothing Then\n             Discovered = 1\n        End If\n            search = search - 1\n         Wend\n\n\n 'What to put in each cell &lt;- I can edit this part myself, no worries\n     trust.Sheets(transfer).Rows(found.Row).EntireRow.Insert\n    trust.Sheets(transfer).Cells(found.Row - 1, \"A\") = water.Sheets(\"00 Template\").Range(\"AB8\")\n     trust.Sheets(transfer).Cells(found.Row - 1, \"B\") = \"-\"\n     trust.Sheets(transfer).Cells(found.Row - 1, \"C\") = water.Sheets(\"00 Template\").Range(\"Z6\")\n     trust.Sheets(transfer).Cells(found.Row - 1, \"D\") = water.Sheets(\"00 Template\").Range(\"AB8\")\n     trust.Sheets(transfer).Cells(found.Row - 1, \"E\") = \"Water Usage\"\n     trust.Sheets(transfer).Cells(found.Row - 1, \"F\") = \"RETRACTED\"\n     trust.Sheets(transfer).Cells(found.Row - 1, \"G\") = \"$0.00\"\n\n'Cell formatting\n  'No idea what this does, assume formatting?\n        onefrom = \"G\" &amp; found.Row - 2\n            trust.Activate\n                trust.Sheets(sheeet).Activate\n                    trust.Sheets(sheeet).Range(onefrom).Select\n                        Selection.AutoFill Destination:=Selection.Resize(3, 1), Type:=xlFillDefault\n\n        'No idea what this does, assume formatting?\n        onefrom = \"M\" &amp; found.Row - 2\n            trust.Activate\n                trust.Sheets(sheeet).Activate\n                    trust.Sheets(sheeet).Range(onefrom).Select\n                        Selection.AutoFill Destination:=Selection.Resize(3, 1), Type:=xlFillDefault\n\n        'No idea what this does, assume formatting?            \n        onefrom = \"N\" &amp; found.Row - 2\n            trust.Activate\n                trust.Sheets(sheeet).Activate\n                    trust.Sheets(sheeet).Range(onefrom).Select\n                        Selection.AutoFill Destination:=Selection.Resize(3, 1), Type:=xlFillDefault\n\n        'This seems to make his E cell blue\n        onefrom = \"E\" &amp; found.Row - 1\n            trust.Sheets(sheeet).Range(onefrom).Select\n                With Selection.Interior\n                    .Pattern = xlSolid\n                    .PatternColorIndex = xlAutomatic\n                    .Color = 15773696\n                    .TintAndShade = 0\n                    .PatternTintAndShade = 0\n                End With\n\n 'Go Back to Original workbook\n water.Activate\n\n ' Message Boxes &lt;- I can edit this myself\n     On Error Resume Next\n         If Err Then\n             MsgBox \"Water was NOT entered into Trust.\", vbExclamation\n                 Else\n                     MsgBox \"Water was entered into Trust.\", vbInformation\n         End If\n         On Error GoTo 0\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "edited": false, "score": 0, "creation_date": 1497453670, "post_id": 44548482, "comment_id": 76088192, "body": "Thanks for the assistance!  Upon replacing the old code with the above example, I got a &#39;subscript is out of range error&#39; the first time I tried it, Then, the second try completed the code with out error, however the worksheets did not get formatted.  I can make ms access sing, but, I had always butted heads with excel, so, I really appreciate your input..."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "edited": false, "score": 0, "creation_date": 1497453888, "post_id": 44548482, "comment_id": 76088365, "body": "Oh... you wanted it to loop thru all the spreadsheets then? that code just acts on the currently active sheet."}, {"owner": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "edited": false, "score": 0, "creation_date": 1497455332, "post_id": 44548482, "comment_id": 76089316, "body": "WOW!!! This kicks!!! The second code snippet did it!!  Is there a way to freeze the first row also?  Then that would be that!! To awesome Thanks brax!"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "edited": false, "score": 0, "creation_date": 1497456705, "post_id": 44548482, "comment_id": 76090200, "body": "Updated for you."}, {"owner": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "edited": false, "score": 0, "creation_date": 1497457773, "post_id": 44548482, "comment_id": 76090774, "body": "What am I doing wrong.  I get an error of subscript is out of range.. It fails on &#39;for each wkstrmain in worksheets&#39; &#39;output the TrMaint report&#39;"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "edited": false, "score": 0, "creation_date": 1497457904, "post_id": 44548482, "comment_id": 76090860, "body": "not sure based on that information. Why did you change &quot;sh&quot; to &quot;wkstrmain&quot;? if you change it in one place you have to change it in the other places it is used too."}, {"owner": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "edited": false, "score": 0, "creation_date": 1497460124, "post_id": 44548482, "comment_id": 76092100, "body": "I took the second set of code and moved it to it&#39;s own private sub and then ran it after the export process.  The code locks all the cells that contain data, so, if there were 100 rows of data in a worksheet, all 100 rows would be frozen and only display the empty cells below the cells with data in them.  I sooo do not understand excel..."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "edited": false, "score": 0, "creation_date": 1497460525, "post_id": 44548482, "comment_id": 76092312, "body": "Yeah I made a mistake in the 2nd code that I corrected in the 3rd code. Please use the 3rd code."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1497456423, "last_edit_date": 1497456423, "creation_date": 1497452823, "answer_id": 44548482, "question_id": 44548312, "link": "https://stackoverflow.com/questions/44548312/formatting-an-excel-worksheet-after-an-ms-access-export-vba/44548482#44548482", "title": "Formatting an Excel Worksheet after an ms access export (VBA)", "body": "<pre><code>Public Sub FormatHeader()\n  ActiveWindow.FreezePanes = True\n  With ActiveSheet\n    .Range(\"A2:G2\").Interior.Color = vbYellow\n    .Range(\"A2:G2\").Font.Bold = True\n    .Range(\"A2:G2\").AutoFilter\n    .Columns.AutoFit\n  End With\nEnd Sub\n</code></pre>\n\n<p>Change A2:G2 to whatever range you want.</p>\n\n<p>for all sheets:</p>\n\n<pre><code>Public Sub FormatAllHeaders()\n  Dim sh As Worksheet\n  For Each sh In Worksheets\n    ActiveWindow.FreezePanes = True\n    With sh.Range(\"A1:G1\")\n      .Interior.Color = vbYellow\n      .Font.Bold = True\n      .AutoFilter\n      .Columns.AutoFit\n    End With\n  Next\nEnd Sub\n</code></pre>\n\n<p>Adding Freeze Top Row</p>\n\n<pre><code>Public Sub FormatAllHeaders()\n  Dim sh As Worksheet\n  For Each sh In Worksheets\n    sh.Activate\n    With ActiveWindow\n        .SplitColumn = 0\n        .SplitRow = 1\n    End With\n    ActiveWindow.FreezePanes = True\n    With sh.Range(\"A1:G1\")\n      .Interior.Color = vbYellow\n      .Font.Bold = True\n      .AutoFilter\n      .Columns.AutoFit\n    End With\n  Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "edited": false, "score": 0, "creation_date": 1497538124, "post_id": 44552450, "comment_id": 76129957, "body": "That&#39;s IT.!.  Wow, syntactically speaking, it&#39;s hard to believe it&#39;s still VBA...  Excel had always given me issues.  Thanks to all, to BraX and Thanks Partait.!.!!!"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1497466013, "creation_date": 1497466013, "answer_id": 44552450, "question_id": 44548312, "link": "https://stackoverflow.com/questions/44548312/formatting-an-excel-worksheet-after-an-ms-access-export-vba/44552450#44552450", "title": "Formatting an Excel Worksheet after an ms access export (VBA)", "body": "<p>Fundamentally, you are not qualifying your Excel objects being foreign inside MS Access. Below lines need to be qualified by the Excel objects you initialize.</p>\n\n<p>Current:</p>\n\n<pre><code>Range(\"A1:Q1\").AutoFilter\nRows(\"1:1\").Select\nActiveWindow.FreezePanes = True\n</code></pre>\n\n<p>Correct:</p>\n\n<pre><code>wks.Range(\"A1:Q1\").AutoFilter            ' EXCEL WORKSHEET METHOD\nwks.Rows(\"1:1\").Select                   ' EXCEL WORKSHEET METHOD\nxls.ActiveWindow.FreezePanes = True      ' EXCEL APPLICATION METHOD\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<p>Consider the adjusted VBA module complete with error handling</p>\n\n<pre><code>Public Sub ExportExcel()\nOn Error GoTo ErrHandle\n\n    '... incorporate above code ...'\n    Const outputFileName = pathtoreport &amp; \"\\\" &amp; Me.txtNameTheReport\n\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, _\n          \"GeneralReportWithComments_Pmcs\", outputFileName, True\n\n    'INITIALIZE EXCEL OBJECTS\n    Dim xls     As Excel.Application\n    Dim wkb     As Excel.Workbook\n    Dim wks     As Excel.Worksheet\n\n    Set xls = New Excel.Application\n    Set wkb = xls.Workbooks.Open(outputFileName)\n    Set wks = wkb.Worksheets(\"GeneralReportWithComments_Pmcs\")\n\n    ' FILTER/SORT TOP ROW\n    wks.Range(\"A1:Q1\").AutoFilter\n\n    ' FILL FIRST ROW\n    With wks.Rows(\"1:1\").Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n\n    'FREEZE TOP ROW\n    wks.Rows(\"1:1\").Activate\n    With xls.ActiveWindow\n        .SplitColumn = 0\n        .SplitRow = 1\n    End With\n    xls.ActiveWindow.FreezePanes = True\n\n    'RENAME WORKSHEET \n    '  (WARNING: SPECIAL CHARS LIKE / \\ * [ ] : ? NOT ALLOWED IN SHEET NAMES)\n    wks.Name = Me.txtStartDateTrim &amp; \" to \" &amp; Me.txtEndDateTrim &amp; \"_PMCS\"\n\n    MsgBox \"Successfully exported and formatted workbook!\", vbInformation, \"OUTPUT\"\n\nExitHandle:\n    wkb.Close True\n    Set wks = Nothing: Set wkb = Nothing\n    xls.Quit\n    Set xls = Nothing\n    Exit Sub\n\nErrHandle:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description, vbCritical, \"RUNTIME ERROR\"\n    Resume ExitHandle\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8161007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba138ddf2c7561dda4dd5cc2d8d648b7?s=128&d=identicon&r=PG&f=1", "display_name": "UserName935", "link": "https://stackoverflow.com/users/8161007/username935"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3434, "favorite_count": 1, "accepted_answer_id": 44552450, "answer_count": 2, "score": 1, "last_activity_date": 1497466013, "creation_date": 1497452344, "last_edit_date": 1592644375, "question_id": 44548312, "link": "https://stackoverflow.com/questions/44548312/formatting-an-excel-worksheet-after-an-ms-access-export-vba", "title": "Formatting an Excel Worksheet after an ms access export (VBA)", "body": "<p>I am trying to export multiple queries from an MS Access (2013) query into  a multiple worksheet workbook in Excel (2013).  The export process is no problem.  This issue is formatting the worksheet(s) after the export. for each worksheet (5), I need to:</p>\n<ol>\n<li>Freeze top row</li>\n<li>fill in the top row with yellow background</li>\n<li>apply a 'filter&amp;sort'...</li>\n</ol>\n<p>Each report export has it's own 'section' so, I'll paste just one section.\nWhen the formatting portion of the code starts, I usually get errors such as run-time errors:</p>\n<blockquote>\n<p>'9':Subscript out of range</p>\n<p>'1004' Method 'range' of object '_Global' failed.</p>\n</blockquote>\n<p>These errors are really never consistent.  Code is below:</p>\n<pre><code>Private Sub cmdGeneralReportWithComments_Click()\n\nMe.ReportProcessLb.Visible = True\nMe.UpdateTablesLb.Visible = False\n\n'Dim general variables to check that all fields are populated to make the         reports\nDim startdatevar As Date\nDim enddatevar As Date\nDim pathtotemplatevar As String\nDim savereporttovar As String\nDim reportnamevar As String\nDim alltogethernow As String\n\nstartdatevar = Me.txtStartDate\nenddatevar = Me.txtEndDate\npathtotemplatevar = Nz(Me.txtBrowse, &quot;&quot;)\nsavereporttovar = Me.txtToReport\nreportnamevar = Me.txtNameTheReport\n'alltogethernow = startdatevar + enddatevar + pathtotemplatevar +         savereporttovar + reportnamevar\n'MsgBox alltogethernow\n\nIf startdatevar Like &quot;&quot; Or enddatevar Like &quot;&quot; Or pathtotemplatevar Like &quot;&quot;     Or savereporttovar Like &quot;&quot; Or reportnamevar Like &quot;&quot; Then\n\n    MsgBox &quot;The dates, report path's and a report path must be entered, please try again :)&quot;\n\nElse\n\n'*************************************************\n'Start Report PMCS\n'*************************************************\n\n'dim date values\nDim TheStartDate As Date\nDim TheEndDate As Date\n\n'copy the template file and move it and rename it\nDim pathtotemplate As String\nDim pathtoreport As String\n\npathtotemplate = Me.txtBrowse\npathtoreport = Me.txtToReport\n\n'output the Pmcs report\nDim outputFileName As String\n\n'outputFileName = &quot;C:\\Users\\travisanor1\\Desktop\\UTV\\Reports\\June2017  \\SaveTest\\GeneralReport_Template.xlsx&quot;\noutputFileName = pathtoreport &amp; &quot;\\&quot; &amp; Me.txtNameTheReport\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12,   &quot;GeneralReportWithComments_Pmcs&quot;, outputFileName, True\n\n'Rename and format the worksheet\nDim xls     As Excel.Application\nDim wkb     As Excel.Workbook\nDim wks     As Excel.Worksheet\n\nSet xls = New Excel.Application\nSet wkb = xls.Workbooks.Open(pathtoreport &amp; &quot;\\&quot; &amp; Me.txtNameTheReport)\n\n'format\n'filter sort on first row\nRange(&quot;A1:Q1&quot;).AutoFilter\n\n'Fill in first row\nRows(&quot;1:1&quot;).Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .Color = 65535\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\n\n'freeze top row\nRows(&quot;1:1&quot;).Select\nWith ActiveWindow\n    .SplitColumn = 0\n    .SplitRow = 1\nEnd With\nActiveWindow.FreezePanes = True\n\n' Set the name of the worksheet\nSet wks = wkb.Worksheets(&quot;GeneralReportWithComments_Pmcs&quot;)\nwks.Name = Me.txtStartDateTrim &amp; &quot; to &quot; &amp; Me.txtEndDateTrim &amp; &quot;_PMCS&quot;\n\nwkb.Close True\nSet wks = Nothing\nSet wkb = Nothing\nxls.Quit\nSet xls = Nothing\n'*************************************************\n'End PMCS report\n'*************************************************\n</code></pre>\n<p>Thanks in advance for any assistance.  I have been banging my head on this for 3 days now and I am at wits end.\nThanks!!</p>\n"}, {"tags": ["vba", "excel", "loops", "vlookup"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497452592, "post_id": 44548192, "comment_id": 76087357, "body": "<a href=\"http://www.siddharthrout.com/2011/07/14/find-and-findnext-in-excel-vba/\" rel=\"nofollow noreferrer\">This</a> will get you started"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1497453744, "creation_date": 1497453744, "answer_id": 44548793, "question_id": 44548192, "link": "https://stackoverflow.com/questions/44548192/running-through-a-column-in-excel-and-removing-certain-text-based-on-a-vlookup/44548793#44548793", "title": "Running through a column in excel and removing certain text based on a vlookup", "body": "<p>Here is a simple solution that uses an array instead of a range. Just plug in the country names to the array as needed:</p>\n\n<pre><code>Sub deletingcountries()\nDim sht As Worksheet\nDim i As Long\nDim lastrow As Integer\n\nSet sht = ActiveWorkbook.Worksheets(\"Sheet1\")\nlastrow = sht.Cells(sht.Rows.Count, \"D\").End(xlUp).Row\n\nDim countries As Variant, country As Variant\ncountries = Array(\"Country1\", \"Country2\", \"Country3\", \"Country4\", \"Country5\") 'add however many countries necessary\n\nFor i = 1 To lastrow\n    For Each country In countries\n        If InStr(ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"D\" &amp; i).Value, country) Then\n            ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"D\" &amp; i).Value = \"deletME\"\n        End If\n    Next country\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 4520233, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/988f0eac5a059d33d3cc0255ed612306?s=128&d=identicon&r=PG&f=1", "display_name": "mrhappysmile", "link": "https://stackoverflow.com/users/4520233/mrhappysmile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "closed_date": 1497495339, "accepted_answer_id": 44548793, "answer_count": 1, "score": -2, "last_activity_date": 1497453744, "creation_date": 1497452044, "question_id": 44548192, "link": "https://stackoverflow.com/questions/44548192/running-through-a-column-in-excel-and-removing-certain-text-based-on-a-vlookup", "closed_reason": "Needs more focus", "title": "Running through a column in excel and removing certain text based on a vlookup", "body": "<p>I apologize in advance if this is trivial but I am struggling to remember the syntax for visual basic as it has been so long.</p>\n\n<p>I have text in cells in column D that needs removing (Country names). I have a separate sheet that contains all the Country names and so I thought I could run through the column cell by cell and check whether there were any cells whose text matched that of the country table I have on a separate sheet. (I.e. a vlookup which changed the text if it matched to something like 'deletME')</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "image", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497453629, "post_id": 44548135, "comment_id": 76088167, "body": "No there is no inbuilt way to Recolor. You have only dew Object Members for  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839432.aspx\" rel=\"nofollow noreferrer\">PictureFormat</a> The closest recoloring (sort of) that you can do is use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822545.aspx\" rel=\"nofollow noreferrer\">PictureFormat.ColorType Property</a>"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497455055, "post_id": 44548135, "comment_id": 76089126, "body": "@SiddharthRout Any idea what msoPictureMixed does for the <code>ColorType</code>? I get an error when I try it"}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1497457437, "creation_date": 1497457437, "answer_id": 44550037, "question_id": 44548135, "link": "https://stackoverflow.com/questions/44548135/image-recolour-in-excel/44550037#44550037", "title": "Image recolour in Excel", "body": "<p>If you can't find a pure object model based solution, you can try to modify the document xml. It is not the easiest of solutions, but it is far easier than pixel manipulation.<br>\nDo like this:  </p>\n\n<ol>\n<li>Save your workbook without modification</li>\n<li>Do the color change</li>\n<li>Save the file again, with a different file name</li>\n<li>Unzip the two *.xlsx files you created</li>\n<li>Analyze the differences. You'll most likely find it in the <em>drawings</em> folder</li>\n<li>Recreate the changes in the xml of the second file in the first one and zip it back together. If that works, you now have a theoretical way to the solution.  </li>\n</ol>\n\n<p>If you get this to work, you can automate these steps. </p>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 692, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497457437, "creation_date": 1497451875, "question_id": 44548135, "link": "https://stackoverflow.com/questions/44548135/image-recolour-in-excel", "title": "Image recolour in Excel", "body": "<p>I have a greyscale image with some transparent sections too. I would like to recolour this within excel (based on the value that a user types in a cell or something)</p>\n\n<p>Manually, all I need to do is select the picture then in the ribbon \ud83e\udc52 <code>format</code> \ud83e\udc52 <code>colour</code> \ud83e\udc52 <code>more variations</code> \ud83e\udc52 <code>more colours</code> and select appropriately. I've tried the macro recorder on these steps but get nothing useful.</p>\n\n<p>Searching the web has led me to believe that the <code>Shape.PictureFormat.Recolor</code> method, which I'm guessing is what I want, is <a href=\"https://msdn.microsoft.com/en-us/library/office/ff939364(v=office.15).aspx?ranMID=24542&amp;ranEAID=TnL5HPStwNw&amp;ranSiteID=TnL5HPStwNw-2nZrOjc2y5HMSV.Iu1U1zg&amp;tduid=(0b457039b759bf6a123ada2a3e075770)(256380)(2459594)(TnL5HPStwNw-2nZrOjc2y5HMSV.Iu1U1zg)()\" rel=\"nofollow noreferrer\">only availible in Publisher</a>. I'd rather not interface with thatfor portability reasons (in case publisher isn't installed), and I'd also like this to run as speedily as possible.</p>\n\n<p>I've even considered converting the image to an array of bytes, performing the required pixel manipulations then converting back to an image, but I think that'll be slow. I also don't have a clue how.</p>\n\n<p>Is there a method in VBA to recolour an image in this way, leaving alpha as it is? Perhaps with the use of an ActiveX image control? Here's an example image in case it's not clear<a href=\"https://i.stack.imgur.com/tDeGE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tDeGE.png\" alt=\"recolour eg\"></a>\nWhite \ud83e\udc52 Green</p>\n\n<p>Black \ud83e\udc52 Black</p>\n\n<p>Alpha \ud83e\udc52 Alpha</p>\n"}, {"tags": ["vba", "excel", "copy"], "comments": [{"owner": {"reputation": 243, "user_id": 6456800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7d9c1c5f3fb0426747663d2c944482?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6456800/unknown"}, "edited": false, "score": 0, "creation_date": 1497451476, "post_id": 44547826, "comment_id": 76086562, "body": "Sheets(&quot;worksheet2&quot;).UsedRange.Copy Destination:=Sheets(&quot;worksheet1&quot;).Range(&quot;A1&quot;).End(xlUp).Offs&zwnj;&#8203;et(1, 0)"}, {"owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "reply_to_user": {"reputation": 243, "user_id": 6456800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7d9c1c5f3fb0426747663d2c944482?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6456800/unknown"}, "edited": false, "score": 0, "creation_date": 1497451669, "post_id": 44547826, "comment_id": 76086708, "body": "@RamAnuragi same error :("}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1497451970, "post_id": 44547826, "comment_id": 76086932, "body": "That error could mean that it cannot locate a worksheet with that name. Keep in mind both worksheets must be in the same workbook for these codes to work."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497451994, "post_id": 44547826, "comment_id": 76086950, "body": "<code>1</code> Do you have more than 1 workbook opened? <code>2</code> If no, then are you sure your worksheet names do not have any leading or trailing spaces?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497452165, "post_id": 44547826, "comment_id": 76087064, "body": "The other error you will get once you have sorted that is because of <code>Sheets(&quot;worksheet1&quot;).End(xlUp)</code>"}, {"owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "reply_to_user": {"reputation": 243, "user_id": 6456800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7d9c1c5f3fb0426747663d2c944482?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6456800/unknown"}, "edited": false, "score": 1, "creation_date": 1497452366, "post_id": 44547826, "comment_id": 76087212, "body": "so @RamAnuragi code somewhat worked, after I removed trailing spaces. thank you guys. however, this code replaced my previous data instead of pasting It under"}], "answers": [{"tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": true, "score": 1, "last_activity_date": 1497452172, "last_edit_date": 1497452172, "creation_date": 1497451292, "answer_id": 44547930, "question_id": 44547826, "link": "https://stackoverflow.com/questions/44547826/how-to-paste-data-from-one-worksheet-under-changing-data-from-another-worksheet/44547930#44547930", "title": "How to paste data from one worksheet under changing data from another worksheet?", "body": "<p>Try:</p>\n\n<pre><code>Sub macro8()\nSheets(\"worksheet2\").UsedRange.Copy Destination:=Sheets(\"worksheet1\").UsedRange.End(xlDown).Offset(1, 0)\nEnd Sub\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Then do it the right way. You can change the column letter \"A\" with the letter of your continuous Column.</p>\n\n<pre><code>Sub macro8()\nDim Rng1 As Range, Rng2 As Range, ws1 As Worksheet, ws2 As Worksheet\n\nSet ws1 = Worksheets(\"worksheet1\")\nSet ws2 = Worksheets(\"worksheet2\")\nSet Rng2 = ws2.UsedRange 'Copy range\nSet Rng1 = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Offset(1, 0) 'Paste range\n\nRng2.Copy Destination:=Rng1 'Copy/Paste\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 44547930, "answer_count": 1, "score": 0, "last_activity_date": 1497452172, "creation_date": 1497451062, "last_edit_date": 1497451237, "question_id": 44547826, "link": "https://stackoverflow.com/questions/44547826/how-to-paste-data-from-one-worksheet-under-changing-data-from-another-worksheet", "title": "How to paste data from one worksheet under changing data from another worksheet?", "body": "<p>I've been extensively researching this question but none of my findings have helped me fix my code. </p>\n\n<p>I'm trying to copy all the data from <code>worksheet2</code> and paste directly under the data from <code>worksheet1</code> (which changes every month). This is what I have so far but every time I try to run it, it says </p>\n\n<blockquote>\n  <p>Runtime Error 9 'Subscript out of range'.</p>\n</blockquote>\n\n<pre><code>Sub macro8()\n    Sheets(\"worksheet2\").UsedRange.Copy Destination:=Sheets(\"worksheet1\").End(xlUp).Offset(1, 0)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 8059525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5090f898b6089cc2d6e05917b1f479a2?s=128&d=identicon&r=PG&f=1", "display_name": "denns den", "link": "https://stackoverflow.com/users/8059525/denns-den"}, "edited": false, "score": 0, "creation_date": 1497451610, "post_id": 44547785, "comment_id": 76086666, "body": "it is not unique, as it does not get number between 2 dates"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1497452087, "post_id": 44547785, "comment_id": 76087005, "body": "It ranks a subgroup within a larger group according to one or more columns of criteria. That is the essence of your question here."}, {"owner": {"reputation": 1, "user_id": 8059525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5090f898b6089cc2d6e05917b1f479a2?s=128&d=identicon&r=PG&f=1", "display_name": "denns den", "link": "https://stackoverflow.com/users/8059525/denns-den"}, "edited": false, "score": 0, "creation_date": 1497452457, "post_id": 44547785, "comment_id": 76087283, "body": "NO THIS TO GET  UNIQUE VALUES AND MY QUESTION IS TO GET TOP HIGHEST VALES."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1497452651, "post_id": 44547785, "comment_id": 76087408, "body": "You do understand what RANK does don&#39;t you?"}, {"owner": {"reputation": 1, "user_id": 8059525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5090f898b6089cc2d6e05917b1f479a2?s=128&d=identicon&r=PG&f=1", "display_name": "denns den", "link": "https://stackoverflow.com/users/8059525/denns-den"}, "edited": false, "score": 0, "creation_date": 1497452886, "post_id": 44547785, "comment_id": 76087558, "body": "no I don&#39;t want to get the rank. I want users and there number"}], "owner": {"reputation": 1, "user_id": 8059525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5090f898b6089cc2d6e05917b1f479a2?s=128&d=identicon&r=PG&f=1", "display_name": "denns den", "link": "https://stackoverflow.com/users/8059525/denns-den"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1497451366, "answer_count": 0, "score": 0, "last_activity_date": 1497453695, "creation_date": 1497450984, "last_edit_date": 1531161705, "question_id": 44547785, "link": "https://stackoverflow.com/questions/44547785/how-to-extract-5-number-and-nanmes-from-the-list", "closed_reason": "Duplicate", "title": "How to extract 5 number and nanmes from the list", "body": "<p>I have a spreadsheet in which I have user ,numbers ,scored and names. how I can get list lost 5 user have scored maximum between dates .I want show user name with date and higer number scored.<br>\nData screenshot:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/saS3Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/saS3Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried this formula and successfully got  maximum value  </p>\n\n<pre><code>=MAX(IF(B2:B15&gt;=G4, IF(B2:B15&lt;=G5, C2:C15)))\n</code></pre>\n"}, {"tags": ["excel", "vba", "sorting", "combobox"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1497450845, "post_id": 44547630, "comment_id": 76086098, "body": "try <code>ucase(ComboBox1.List(b))...</code> or <code>option compare text</code> perhaps"}, {"owner": {"reputation": 11, "user_id": 2634528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47830a7b34b8ae864bec097008044936?s=128&d=identicon&r=PG", "display_name": "AVB", "link": "https://stackoverflow.com/users/2634528/avb"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497451782, "post_id": 44547630, "comment_id": 76086779, "body": "Thanks, it worked. So easy (once you know how to do it :-) ) I changed my code into:  If UCase(ComboBox1.List(b)) &lt; UCase(ComboBox1.List(a)) Then ..."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1497452083, "creation_date": 1497452083, "answer_id": 44548207, "question_id": 44547630, "link": "https://stackoverflow.com/questions/44547630/sorting-data-in-combobox-case-insensitive/44548207#44548207", "title": "Sorting data in combobox case insensitive", "body": "<p>try <code>ucase(ComboBox1.List(b))...</code> or <code>option compare text perhaps</code> </p>\n"}], "owner": {"reputation": 11, "user_id": 2634528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47830a7b34b8ae864bec097008044936?s=128&d=identicon&r=PG", "display_name": "AVB", "link": "https://stackoverflow.com/users/2634528/avb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497452083, "creation_date": 1497450536, "last_edit_date": 1497450603, "question_id": 44547630, "link": "https://stackoverflow.com/questions/44547630/sorting-data-in-combobox-case-insensitive", "title": "Sorting data in combobox case insensitive", "body": "<p>I'm trying to make a combobox that gets its values from a range. I only want to see unique values and it must be sorted in alphabetical order (case insensitive).</p>\n\n<p>Everything works fine except the sorting of data. Sorting is case sensitive but this is not what I want.</p>\n\n<p>Sorting is like:</p>\n\n<pre><code>Door\nRoom\nWindow\nkitchen\n</code></pre>\n\n<p>But the way I want it:</p>\n\n<pre><code>Door\nkitchen\nRoom\nWindow\n</code></pre>\n\n<p>Below you can find my code:</p>\n\n<pre><code>Dim x, a, b As Long, c As Variant    \n Dim DataRng As String\n\n Worksheets(\"House\").Activate    \n\n 'Unique Records    \n For x = 2 To Cells(Rows.Count, 4).End(xlUp).Row    \n     If WorksheetFunction.CountIf(Range(\"D2:D\" &amp; x), Cells(x, 4)) = 1 Then    \n         ComboBox1.AddItem Cells(x, 4).Value    \n     End If    \n Next\n\n 'Alphabetic Order    \n\n For a = 0 To ComboBox1.ListCount - 1    \n   For b = a To ComboBox1.ListCount - 1    \n        If ComboBox1.List(b) &lt; ComboBox1.List(a) Then    \n            c = ComboBox1.List(a)    \n            ComboBox1.List(a) = ComboBox1.List(b)    \n            ComboBox1.List(b) = c    \n       End If    \n   Next    \n  Next \nEnd Sub\n</code></pre>\n\n<p>I hope someone can solve my problem or can give me a hint.</p>\n"}, {"tags": ["c#", ".net", "vba", "smtp"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7028626, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pwqCqQOyJmo/AAAAAAAAAAI/AAAAAAAAG2U/_esiSHwnbe8/photo.jpg?sz=128", "display_name": "Bhanu Prakash", "link": "https://stackoverflow.com/users/7028626/bhanu-prakash"}, "edited": false, "score": 0, "creation_date": 1497452874, "post_id": 44547816, "comment_id": 76087550, "body": "Thank you, I tried it and it is not even working in local host. only    Outlook.MailItem oMsg = (Outlook.MailItem)oApp.CreateItem(Outlook.OlItemType.olMailI&zwnj;&#8203;tem);"}], "tags": [], "owner": {"reputation": 1, "user_id": 8160688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1329214663864267/picture?type=large", "display_name": "Mawlud Fariq", "link": "https://stackoverflow.com/users/8160688/mawlud-fariq"}, "is_accepted": false, "score": 0, "last_activity_date": 1497451051, "creation_date": 1497451051, "answer_id": 44547816, "question_id": 44547226, "link": "https://stackoverflow.com/questions/44547226/not-able-to-send-e-mail-through-iis-server-working-in-local/44547816#44547816", "title": "Not able to send E-mail through IIS server (Working in local )", "body": "<p>Test this Code:</p>\n\n<pre><code>        MailMessage mail = new MailMessage();\n        SmtpClient SmtpServer = new SmtpClient(\"smtp.live.com\");\n\n        mail.From = new MailAddress(\"mawlud.f.m@hotmail.com\");\n        mail.To.Add(\"mawlud.f.m@gmail.com\");\n\n        mail.Subject = \"Mail Subject\";\n        mail.Body = \"Mail Body\";\n\n        SmtpServer.Port = 587;\n        SmtpServer.Credentials = new System.Net.NetworkCredential(\"mawlud.f.m@hotmail.com\", \"Write Your Password\");\n\n        SmtpServer.EnableSsl = true;\n        SmtpServer.Send(mail);\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7028626, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pwqCqQOyJmo/AAAAAAAAAAI/AAAAAAAAG2U/_esiSHwnbe8/photo.jpg?sz=128", "display_name": "Bhanu Prakash", "link": "https://stackoverflow.com/users/7028626/bhanu-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498659952, "creation_date": 1497449439, "question_id": 44547226, "link": "https://stackoverflow.com/questions/44547226/not-able-to-send-e-mail-through-iis-server-working-in-local", "title": "Not able to send E-mail through IIS server (Working in local )", "body": "<p>I've been working on this from months, please someone help me solve this. Thanks </p>\n\n<pre><code> try\n        {\n            SmtpClient smtpServer = new SmtpClient();\n            MailMessage mail = new MailMessage();\n            smtpServer.Credentials = new System.Net.NetworkCredential(\"iejabdb@otlook.com\", \"throughput\");\n            smtpServer.Port = 25;\n            smtpServer.Host = \"*****\";\n            smtpServer.EnableSsl = true;\n            smtpServer.UseDefaultCredentials = true;\n            mail.From = new MailAddress(\"*****@outlook.com\", \"Work Order System\");\n            mail.To.Add(\"*******@outlook.com\");\n            // mail.To.Add(receiptsArray.ToString());\n            mail.Subject = \"Test\";\n            mail.Body = \"Hello\";\n            smtpServer.Send(mail);\n        }\n</code></pre>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1497449243, "post_id": 44547011, "comment_id": 76084876, "body": "How is it not working? Is there an error, or simply not doing it?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1497449281, "post_id": 44547011, "comment_id": 76084908, "body": "can you also show how you set each sheet to it&#39;s workbook ? are they both open when running the code?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1497449771, "post_id": 44547240, "comment_id": 76085256, "body": "Does that overlook the .Areas issue with a discontiguous range?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1497449834, "post_id": 44547240, "comment_id": 76085304, "body": "@Jeeped - Good thinking, I&#39;m not sure actually...Edit: Nope - if there are visible rows, then hidden rows, then visible, then hidden, then.... it seems to just grab the first non-hidden rows and ignores the others."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1497449792, "last_edit_date": 1497449792, "creation_date": 1497449473, "answer_id": 44547240, "question_id": 44547011, "link": "https://stackoverflow.com/questions/44547011/vba-pastespecial-not-working-after-using-specialcells-copy/44547240#44547240", "title": "VBA - PasteSpecial not working after using SpecialCells.Copy", "body": "<p>Try this. Instead of doing <code>PasteSpecial</code>, since you just need values, you can set the ranges equal to eachother.</p>\n\n<pre><code>Dim copyRng As Range\nWith originSheet\n    .AutoFilterMode = False\n    With .Range(\"A7:AA\" &amp; lastRowOriginSheet)\n        .AutoFilter Field:=2, Criteria1:=projectNumber\n        Set copyRng = .SpecialCells(xlCellTypeVisible)\n    End With\nEnd With\n' destinationSheet.Range(\"B4\").Value = copyRng.Value\nWith destinationSheet\n    .Range(.Cells(4, 2), .Cells(4 + copyRng.Rows.Count - 1, 2 + copyRng.Columns.Count - 1)).Value = copyRng.Value\nEnd With\n</code></pre>\n\n<p>(this is assuming your worksheet and lastRow and projectNumber are all declared properly and working).</p>\n\n<p>Edited because if you just do <code>Range(\"B4\").Value = Range(\"A1:Z100\").Value</code>, it's only going to put the first value in your copied range in the cell. You need to expand the destination range to be the size of the copy range.</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1497450003, "post_id": 44547323, "comment_id": 76085456, "body": "Does the <code>...Range(&quot;B4&quot;)</code> work properly here? As I noted in my Edit, when I did <code>Range(&quot;B4&quot;).Value = Range(&quot;H2:K20&quot;).Value</code>, it only put a single value in <code>B4</code>, and didn&#39;t do the remaining values."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1497450076, "post_id": 44547323, "comment_id": 76085511, "body": "If you do a value transfer you have to match the size of the destination range with the source range; you can use just the upper-left corner cell in a copy &amp; paste."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1497450642, "post_id": 44547323, "comment_id": 76085955, "body": "++ <code>PasteSpecial does not work on a discontiguous range.</code> True that."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1497451495, "post_id": 44547323, "comment_id": 76086571, "body": "@Jeeped - Ah, I didn&#39;t know that (about the Value transfer not doing the whole range, but copy/paste does).  Good to know!!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1497449723, "creation_date": 1497449723, "answer_id": 44547323, "question_id": 44547011, "link": "https://stackoverflow.com/questions/44547011/vba-pastespecial-not-working-after-using-specialcells-copy/44547323#44547323", "title": "VBA - PasteSpecial not working after using SpecialCells.Copy", "body": "<p>PasteSpecial does not work on a discontiguous range. If you have one hidden row in among visible rows then you have a discontiguous range. However, due to the nature of a discontiguous range, a straight copy and paste will paste formats and the values from formulas; i.e. it cannot determine how to shift the cell ranges in formulas so it just pastes values.</p>\n\n<pre><code>With originSheet\n    .AutoFilterMode = False\n    With .Range(\"A7:AA\" &amp; lastRowOriginSheet)\n        .AutoFilter Field:=2, Criteria1:=projectNumber\n        'you should probably check to ensure you have visible cells before trying to copy them\n        .SpecialCells(xlCellTypeVisible).Copy destination:=destinationSheet.Range(\"B4\")\n    End With\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 4, "last_activity_date": 1497450619, "creation_date": 1497450619, "answer_id": 44547656, "question_id": 44547011, "link": "https://stackoverflow.com/questions/44547011/vba-pastespecial-not-working-after-using-specialcells-copy/44547656#44547656", "title": "VBA - PasteSpecial not working after using SpecialCells.Copy", "body": "<p>What @Jeeped has mentioned is very true that you cannot used <code>Paste Special</code> on a filtered range if they are <code>Non Contiguous</code>. However there is a way to achieve what you want :)</p>\n\n<p>You have to loop through each <code>area</code> of the filtered range and then use <code>Paste Special</code> as shown below</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim lastRowOriginSheet As Long\n    Dim filteredRange As Range, a As Range\n    Dim projectNumber As Long\n\n    '~~&gt; I have set these for testing. Change as applicable\n    projectNumber = 1\n    Set ws = Sheet1\n    Set destinationSheet = Sheet2\n    lastRowOriginSheet = 16\n\n    With ws\n        .AutoFilterMode = False\n\n        With .Range(\"A7:AA\" &amp; lastRowOriginSheet)\n            .AutoFilter Field:=2, Criteria1:=projectNumber\n\n            Set filteredRange = .Offset(1, 0).SpecialCells(xlCellTypeVisible)\n\n            '~~&gt; Loop through each area\n            For Each a In filteredRange.Areas\n                With destinationSheet\n                    '~~&gt; Find Next available row\n                    lRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row + 1\n\n                    a.Copy\n                    destinationSheet.Range(\"B\" &amp; lRow).PasteSpecial xlPasteValues\n                End With\n            Next a\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>In Action</strong><a href=\"https://i.stack.imgur.com/KEBod.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KEBod.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 8160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b052111d5c41765b019178e70e9ce36?s=128&d=identicon&r=PG&f=1", "display_name": "jb4x", "link": "https://stackoverflow.com/users/8160885/jb4x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1098, "favorite_count": 1, "accepted_answer_id": 44547656, "answer_count": 3, "score": 2, "last_activity_date": 1525021184, "creation_date": 1497448864, "last_edit_date": 1525021184, "question_id": 44547011, "link": "https://stackoverflow.com/questions/44547011/vba-pastespecial-not-working-after-using-specialcells-copy", "title": "VBA - PasteSpecial not working after using SpecialCells.Copy", "body": "<p>To sum up, I try to copy some filtered data from a workbook A to a workbook B keeping the formatting of the workbook B. </p>\n\n<p>Here is the relevant part of my code: </p>\n\n<pre><code>With originSheet\n    .AutoFilterMode = False\n    With .Range(\"A7:AA\" &amp; lastRowOriginSheet)\n        .AutoFilter Field:=2, Criteria1:=projectNumber\n        .SpecialCells(xlCellTypeVisible).Copy\n    End With\nEnd With\ndestinationSheet.Range(\"B4\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>The paste special is not working and this is the formatting of the workbook A that is used.</p>\n\n<hr>\n\n<p>Solved:</p>\n\n<p>The problem was that you can't use PasteSpecial in a discontinuous range. </p>\n\n<p>So I went with the solution of Siddharth Rout to go through all the areas of the filtered range: </p>\n\n<pre><code>        With originSheet\n            .AutoFilterMode = False\n\n            With .Range(\"A7:AA\" &amp; lastRowOriginSheet)\n                .AutoFilter Field:=2, Criteria1:=projectNumber\n\n                Set filteredRange = .Offset(1, 0).SpecialCells(xlCellTypeVisible)\n\n                '~~&gt; Loop through each area\n                For Each area In filteredRange.Areas\n                    With destinationSheet\n                        '~~&gt; Find Next available row\n                        lRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row + 1\n\n                        area.Copy\n                        destinationSheet.Range(\"B\" &amp; lRow).PasteSpecial xlPasteValues\n                    End With\n                Next area\n            End With\n        End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 2, "creation_date": 1497449893, "post_id": 44546938, "comment_id": 76085352, "body": "You may like to take a look at this thr3ead: <a href=\"https://answers.microsoft.com/en-us/office/forum/office_2007-excel/the-calculation-option-keeps-switching-from-auto/2ed29346-b946-4aaf-9c19-83911eea812e\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/office/forum/office_2007-excel/&hellip;</a> The argument there is that if the first workbook opened during a session has calculation set to manual all others will inherit this setting. So, you should look at other workbooks which turn off automatic calculation and make sure it is turned on again before they close."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497458801, "post_id": 44546938, "comment_id": 76091337, "body": "@Variatus i used to have a macro that turns off automatic calculation but I deleted it and now i have a new computer and move the personal macro workbook to the new pc but I&#39;ve checked and the macro that use to turn off automatic calculation is not there because I&#39;ve deleted before moving to the new pc. So my question is why is still happening ?"}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497470481, "post_id": 44546938, "comment_id": 76097785, "body": "@Variatus \t Is there a reason why the <code>Sheets.Selec</code> line will trigger the automatic calculation to manual? I have recompile and no errors and debug it and when the code hits <code>Sheets.Select</code> it automatically changes to manual now why is that? I&#39;ve commented out the line and the calculation mode remains automatic but i don&#39;t know the reason why it does that."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497609380, "post_id": 44546938, "comment_id": 76161903, "body": "Not everything you delete is gone. To clean out a VBA project, export all code (use VBE&#39;s export function), make a copy of the workbook&#39;s sheets in an xlsx file, completely delete the xlsm file. Then import the code back into the xlsx file and save as macro-enabled. This will remove any hidden backups of past code snippets."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497609631, "post_id": 44546938, "comment_id": 76162059, "body": "Another thought would be to investigate what <code>Sheets.Select</code> implies: how many sheets and what is on those sheets. In theory the implication could be an amount of calculation that can&#39;t be handled or doesn&#39;t need to be handled or involves data on other workbooks (including deleted ones) that might have (had) automatic calculation turned off. There is a lot of scope in this. <code>Sheets.Select</code> doesn&#39;t have many good reasons why it should be necessary."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497612747, "post_id": 44546938, "comment_id": 76163980, "body": "@Variatus is it better if i export everything and delete the personal macro workbook and creat a new one? Will that solve the problem and import everything back again?"}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497625964, "post_id": 44546938, "comment_id": 76172990, "body": "@Variatus The code above is in the personal macro workbook i just open the excel file from email run the above code print the reports and then close excel. There is no save on the hdd also this sheets doesn&#39;t contain any formulas what so ever so I don&#39;t release understand why it goes to manual when code hits the &#39;Sheets.Select&#39;. Don&#39;t know what to do I&#39;ve commented out that code and seems that it&#39;s working fine but that doesn&#39;t solve my problem. If anyone has any other ideas i can try to fix this i will also try  your approach at home and will let you know the outcome."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497662720, "post_id": 44546938, "comment_id": 76187918, "body": "Yes. The old Wb must be deleted, and the new Wb must be created from a Wb which never had any code in it."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1497662973, "post_id": 44546938, "comment_id": 76187969, "body": "What does <code>Sheets.Select</code> do? I am proceeding from the thought that selecting all or many sheets might disable auto-calc by design, at least under some circumstances. If so, it should be re-enabled equally automatically when the sheets are released. Can you try that? But before going there I wonder if <code>Sheets.Select</code> can be avoided altogether. What&#39;s the purpose of this command within the context of your macro?"}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497682942, "post_id": 44546938, "comment_id": 76191158, "body": "@Variatus I guess it can be avoided it just selects all sheets in the workbook so i can print preview all and then print all sheets instead of doing one by one. But can someone test this and let me know if this is the case. Because with it does this and I don&#39;t know whether it&#39;s something from the macro or this is how excel behaves. The file that I&#39;m formatting it&#39;s just a report that i need just to print but it&#39;s not the way i need it to print as it&#39;s in portrait and the margins are not right and I don&#39;t need all the columns so i just edit it a little. No formulas involved."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497707758, "post_id": 44546938, "comment_id": 76197875, "body": "@Variatus Just tried deleting everything and creating from scratch I&#39;ve deleted the personal macro workbook and created from scratch but it does the same thing. Still, the problem is there and it&#39;s the same line that triggers the change to manual. Any other ideas that I can try??? And tried setting it back to automatic but it&#39;s not working for me."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497770577, "post_id": 44546938, "comment_id": 76211728, "body": "Isn&#39;t it true that your Personal Web is invisible? I don&#39;t know if you can select invisible worksheets. This thought raises also the question of which Wb&#39;s sheets are being selected and whether Sheets = Worksheets in that Wb."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497770979, "post_id": 44546938, "comment_id": 76211804, "body": "Create a loop which (a) selects each worksheet (sheet) in turn and see if any one of them triggers the anomality. Then extend the code to (b) add one sheet at a time to the simultaneous selection. See at which point the anomality occurs. Then try changing the sequence. You might be able to identify one sheet that causes the pb."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497771052, "post_id": 44546938, "comment_id": 76211820, "body": "@Variatus Yes the personal macro workbook is hidden I just only want to select all worksheets in the active workbook."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1497777740, "post_id": 44546938, "comment_id": 76213406, "body": "@Variatus I&#39;ve managed to solve my problem you were right basically if you manually select all sheets and then go to settings under formula excel changes automatically to manual and after you deselect sheets it will revert it back to automatic. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "edited": false, "score": 0, "creation_date": 1497461826, "post_id": 44548410, "comment_id": 76093099, "body": "i used to have a macro that turns off automatic calculation but I deleted it and now i have a new computer and move the personal macro workbook to the new pc but I&#39;ve checked and the macro that use to turn off automatic calculation is not there because I&#39;ve deleted before moving to the new pc. So my question is why is still happening ?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "edited": false, "score": 0, "creation_date": 1497462624, "post_id": 44548410, "comment_id": 76093587, "body": "In any case it&#39;s not because of anything in the code you posted."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "edited": false, "score": 0, "creation_date": 1497463018, "post_id": 44548410, "comment_id": 76093794, "body": "So any ideas on how to fix it because I tried every macro in the personal macro workbook and every time i run the above code is changes to manual. There is an email I received with this file that i need to edit and print this file is not saved on the pc so I just open check to see if the workbook is automatic and it is i run the above code go back check and it&#39;s manual i change back to automatic and print the file and quit excel. Is there a way to fix it?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "edited": false, "score": 0, "creation_date": 1497463202, "post_id": 44548410, "comment_id": 76093901, "body": "Do you have any event code that might trigger? (Worksheet_change and such?)"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "edited": false, "score": 0, "creation_date": 1497463691, "post_id": 44548410, "comment_id": 76094162, "body": "Check your VBE settings. It might be that you have to recompile the personal macro workbook if compile on demand was turned off for that project. Other than that try stepping through the code with F8 to see if something unexpected executes. Since there&#39;s nothing wrong with what you posted it&#39;s guess work for me."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "edited": false, "score": 0, "creation_date": 1497465999, "post_id": 44548410, "comment_id": 76095387, "body": "Is there a reason why the <code>Sheets.Select</code> will trigger the automatic calculation to manual? I have recompile and no errors and debug it and when the code hits <code>Sheets.Select</code> it automatically changes to manual now why is that?"}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "edited": false, "score": 0, "creation_date": 1497466289, "post_id": 44548410, "comment_id": 76095583, "body": "In the past i used the below code to make macros run faster but i notice that excel started acting funny jumping from automatic calculation to manual so i deleted the code so now it should be working ok but it&#39;s not. <code>Sub OptimizeVBA(isOn As Boolean)     Application.Calculation = IIf(isOn, xlCalculationManual, xlCalculationAutomatic)     Application.EnableEvents = Not(isOn)     Application.ScreenUpdating = Not(isOn)     ActiveSheet.DisplayPageBreaks = Not(isOn) End Sub   &#39;Some macro Sub ExampleMacro()     OptimizeVBA True     &#39;Your code here     OptimizeVBA False End Sub</code>"}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1497466579, "post_id": 44548410, "comment_id": 76095766, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/146692/discussion-between-quicksilver-and-rik-sportel\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 1, "last_activity_date": 1497452654, "creation_date": 1497452654, "answer_id": 44548410, "question_id": 44546938, "link": "https://stackoverflow.com/questions/44546938/why-automatic-calculation-turned-off-by-vba-macro/44548410#44548410", "title": "Why automatic calculation turned off by VBA macro?", "body": "<p>This Macro runs perfectly without turning off calculations. </p>\n\n<p>If these functions are used within a loop that opens other books, then Variatus his comment is correct - It's a setting at application level, so all books opened within the same Application instance will indeed be affected if there's a workbook that executes code that includes <code>Application.Calculation = xlCalculationManual</code> when opened </p>\n\n<p>A workaround is to instantiate a seperate object as \"New Application\" and use that one to open additional workbooks. Example code:</p>\n\n<p>Instead of:</p>\n\n<pre><code>Dim wb as Workbook\nSet wb = Workbooks.Open(\"Somepath\\somefile.xlsm\")\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>Dim xlApp as Application\nDim wb as Workbook\n\nSet xlApp = New Application\n\nSet wb = xlApp.Workbooks.Open(\"Somepath\\somefile.xlsm\")\n'Do stuff \n\nwb.Close\nxlApp.Close\nSet xlApp = Nothing\n</code></pre>\n\n<p>The alternative is to store the current setting in a variable and reset it at the very end of execution:</p>\n\n<pre><code>'At the very beginning:\nDim calcSetting as Integer\ncalcSetting = Application.Calculation\n\n'Do all execution\n\n'At the every end:\nApplication.Calculation = calcSetting\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "is_accepted": true, "score": 1, "last_activity_date": 1497777557, "creation_date": 1497777557, "answer_id": 44613520, "question_id": 44546938, "link": "https://stackoverflow.com/questions/44546938/why-automatic-calculation-turned-off-by-vba-macro/44613520#44613520", "title": "Why automatic calculation turned off by VBA macro?", "body": "<p>I just salved my problem that I was facing with excel changing to manual from automatic calculation with @Variatus help. The problem is if you go and right click and select all worksheets excel automatically changes to manual but as soon as you right click and <code>ungroup sheets</code> this will change back to <code>automatic calculation</code>. So I've change my code to select the first sheet to deselect all sheets at the end of my code and have only one sheet active so the calculation is back to automatic. Also change from selecting all sheets to <code>Worksheets.PrintOut preview:=True</code> that will have the same effect but it's much clear the intention of the code. So need to be careful when selecting multiple worksheets to later deselect them otherwise it will create a problem down the line messing up the calculation from automatic to manual. Thank you for all your help.</p>\n\n<pre><code>Option Explicit\n Public WS As Worksheet\n\n    Public Sub editAllSheets()\n'\n'\n    Dim myResult As VbMsgBoxResult\n\n    myResult = MsgBox(\"Are you sure you want to edit all sheets in this workbook?\", vbQuestion + vbYesNo + vbDefaultButton1, \"Edit Workbook?\")\n    If myResult = vbNo Then Exit Sub\n\n       On Error GoTo ErrorHandler\n\n            For Each WS In ActiveWorkbook.Worksheets\n            WS.Activate\n            Application.ScreenUpdating = False\n             editingProperties WS\n            Application.ScreenUpdating = True\n                Next WS\n\n            MsgBox \"Please note:\" &amp; vbNewLine &amp; vbNewLine &amp; \"1. You will be redirected to print preview all your reports.\" &amp; vbNewLine &amp; \"2. Proceed with printing reports.\", vbInformation, \"Process Completed!\"\n\n         Worksheets.PrintOut preview:=True\n\n         Sheets(1).Select\n\n        Exit Sub '&lt;--- exit here if no error occured\nErrorHandler:\n    Debug.Print Err.Description\n        MsgBox \"Sorry, an error occured.\" &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n\n    End Sub\n\n    Private Sub editingProperties(WS As Worksheet)\n\nDim columnsToDelete As Range\n\nWith WS\n       .Columns(\"A:F\").UnMerge\n\n    Set columnsToDelete = Application.Union(.Columns(\"B:C\"), _\n                                            .Columns(\"E:J\"), _\n                                            .Columns(\"N:P\"), _\n                                            .Columns(\"T\"))\n        columnsToDelete.Delete\n\n       .Cells.EntireColumn.AutoFit\n       .Range(\"A1:B2\").Merge\n\n   End With\n\n\n     With WS.PageSetup\n            .printArea = \"\"\n            .PrintTitleRows = \"\"\n            .PrintTitleColumns = \"\"\n            .LeftHeader = \"\"\n            .CenterHeader = \"\"\n            .RightHeader = \"\"\n            .LeftFooter = \"\"\n            .CenterFooter = \"\"\n            .RightFooter = \"\"\n            .LeftMargin = Application.InchesToPoints(0.25)\n            .RightMargin = Application.InchesToPoints(0.25)\n            .TopMargin = Application.InchesToPoints(0.75)\n            .BottomMargin = Application.InchesToPoints(0.75)\n            .HeaderMargin = Application.InchesToPoints(0.3)\n            .FooterMargin = Application.InchesToPoints(0.3)\n            .Orientation = xlLandscape\n            .Zoom = False\n            .FitToPagesWide = 1\n            .FitToPagesTall = 1\n\n        End With\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1459, "favorite_count": 0, "accepted_answer_id": 44613520, "answer_count": 2, "score": 0, "last_activity_date": 1497777557, "creation_date": 1497448679, "last_edit_date": 1531164843, "question_id": 44546938, "link": "https://stackoverflow.com/questions/44546938/why-automatic-calculation-turned-off-by-vba-macro", "title": "Why automatic calculation turned off by VBA macro?", "body": "<p>I have the below code that turns off automatic calculation and i can't find a reason why is doing this. I use office 2016 and previously was using 2007 noticed back then that was going to manual but didn't know from which macro now i located the one that triggers the change but still don't know why. Any help on clarifying this will be much appreciated.</p>\n\n<pre><code>Public Sub editAllSheets()\n'\n'\n'\n    Dim myResult As VbMsgBoxResult\nDim WS As Worksheet\n\n    myResult = MsgBox(\"Are you sure you want to edit all sheets in this workbook?\", vbQuestion + vbYesNo + vbDefaultButton1, \"Edit Workbook?\")\n    If myResult = vbNo Then Exit Sub\n\n       On Error GoTo ErrorHandler\n\n            For Each WS In ActiveWorkbook.Worksheets\n            WS.Activate\n            Application.ScreenUpdating = False\n             editingProperties WS\n             Application.ScreenUpdating = True\n                Next WS\n            Sheets.Select\n\n            MsgBox \"Please note:\" &amp; vbNewLine &amp; vbNewLine &amp; \"1. All the sheets are selected.\" &amp; vbNewLine &amp; \"2. Proceed with print preview to view and print all reports.\" &amp; vbNewLine &amp; \"3. To print preview or print only 1 report of this workbook you need to click on a different sheet to deselect all.\", vbInformation, \"Process Completed!\"\n\n        Exit Sub '&lt;--- exit here if no error occured\nErrorHandler:\n    Debug.Print Err.Description\n    Application.ScreenUpdating = True\n        MsgBox \"Sorry, an error occured.\" &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n\n    End Sub\n\n    Private Sub editingProperties(WS As Worksheet)\n\nDim columnsToDelete As Range\n\nWith WS\n       .Columns(\"A:F\").UnMerge\n\n    Set columnsToDelete = Application.Union(.Columns(\"B:C\"), _\n                                            .Columns(\"F:K\"), _\n                                            .Columns(\"P:R\"), _\n                                            .Columns(\"V:W\"))\n        columnsToDelete.Delete\n\n       .Cells.EntireColumn.AutoFit\n       .Range(\"A1:B2\").Merge\n\n   End With\n\n\n     With WS.PageSetup\n            .PrintArea = \"\"\n            .PrintTitleRows = \"\"\n            .PrintTitleColumns = \"\"\n            .LeftHeader = \"\"\n            .CenterHeader = \"\"\n            .RightHeader = \"\"\n            .LeftFooter = \"\"\n            .CenterFooter = \"\"\n            .RightFooter = \"\"\n            .LeftMargin = Application.InchesToPoints(0.25)\n            .RightMargin = Application.InchesToPoints(0.25)\n            .TopMargin = Application.InchesToPoints(0.75)\n            .BottomMargin = Application.InchesToPoints(0.75)\n            .HeaderMargin = Application.InchesToPoints(0.3)\n            .FooterMargin = Application.InchesToPoints(0.3)\n            .Orientation = xlLandscape\n            .Zoom = False\n           .FitToPagesWide = 1\n            .FitToPagesTall = 1\n\n        End With\n    End Sub\n</code></pre>\n\n<p>In the past, I used the below code to make macros faster but I notice a change from automatic calculation to manual without running anything so I deleted not sure if it's still related. Any help on solving this will be much appreciated.</p>\n\n<pre><code>Option Explicit\nSub OptimizeVBA(isOn As Boolean)\n    Application.Calculation = IIf(isOn, xlCalculationManual, xlCalculationAutomatic)\n    Application.EnableEvents = Not(isOn)\n    Application.ScreenUpdating = Not(isOn)\n    ActiveSheet.DisplayPageBreaks = Not(isOn)\nEnd Sub\n\n'Some macro\nSub ExampleMacro()\n    OptimizeVBA True\n    'Your code here\n    OptimizeVBA False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1497448643, "post_id": 44546846, "comment_id": 76084405, "body": "<code>datediff</code> function"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1497448725, "post_id": 44546930, "comment_id": 76084477, "body": "or similarly: <code>=DATE(YEAR(A2),12,31)-DATE(YEAR(A2),1,1)+1</code>"}, {"owner": {"reputation": 1097, "user_id": 7042778, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9c7b56f9d0d40f16a5cb69e0905e2d79?s=128&d=identicon&r=PG&f=1", "display_name": "MCM", "link": "https://stackoverflow.com/users/7042778/mcm"}, "edited": false, "score": 0, "creation_date": 1497449087, "post_id": 44546930, "comment_id": 76084769, "body": "Thanks a lot. I was looking more somthing like the answer above."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1497448660, "creation_date": 1497448660, "answer_id": 44546930, "question_id": 44546846, "link": "https://stackoverflow.com/questions/44546846/number-of-days-in-a-year-excel-vba/44546930#44546930", "title": "Number of days in a year Excel VBA", "body": "<p>Just subtract 12/31 of the year previous from 12/31 of the year desired:</p>\n\n<pre><code>=DATE(YEAR(A2),12,31)-DATE(YEAR(A2)-1,12,31)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/u61CP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u61CP.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1097, "user_id": 7042778, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9c7b56f9d0d40f16a5cb69e0905e2d79?s=128&d=identicon&r=PG&f=1", "display_name": "MCM", "link": "https://stackoverflow.com/users/7042778/mcm"}, "edited": false, "score": 0, "creation_date": 1497449017, "post_id": 44546982, "comment_id": 76084717, "body": "Perfect that is what I was looking for."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1497449215, "post_id": 44546982, "comment_id": 76084853, "body": "since it is days that the op want this is less typing: <code>daysinyear = DateSerial(lngyear + 1, 1, 1) - DateSerial(lngyear, 1, 1)</code>"}, {"owner": {"reputation": 1097, "user_id": 7042778, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9c7b56f9d0d40f16a5cb69e0905e2d79?s=128&d=identicon&r=PG&f=1", "display_name": "MCM", "link": "https://stackoverflow.com/users/7042778/mcm"}, "edited": false, "score": 0, "creation_date": 1497449485, "post_id": 44546982, "comment_id": 76085039, "body": "Perfect that is even simpler :)"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 7, "last_activity_date": 1497448804, "creation_date": 1497448804, "answer_id": 44546982, "question_id": 44546846, "link": "https://stackoverflow.com/questions/44546846/number-of-days-in-a-year-excel-vba/44546982#44546982", "title": "Number of days in a year Excel VBA", "body": "<p>or </p>\n\n<pre><code>Public Function daysinyear(lngyear As Long) As Long\n    daysinyear = DateDiff(\"d\", DateSerial(lngyear, 1, 1), DateSerial(lngyear + 1, 1, 1))\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1497449009, "post_id": 44547045, "comment_id": 76084709, "body": "Note that this isn&#39;t foolproof.  The year 1900 is not a leapyear (only every 00 year divisible by 400 is a leapyear, which is why 2000 was one)"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1497449670, "post_id": 44547045, "comment_id": 76085193, "body": "Updated with a more full solution using this method."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1497450955, "post_id": 44547045, "comment_id": 76086182, "body": "Odd bit of Excel trivia. It was Lotus that originally screwed up the &#39;1900-as-a-leap-year&#39; calculation and never fixed it. When Excel came along, they had to intentionally make the same mistake to provide cross-platform compatibility with Lotus which was the <i>defacto standard</i> at the time."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 4, "last_activity_date": 1497450603, "last_edit_date": 1497450603, "creation_date": 1497448954, "answer_id": 44547045, "question_id": 44546846, "link": "https://stackoverflow.com/questions/44546846/number-of-days-in-a-year-excel-vba/44547045#44547045", "title": "Number of days in a year Excel VBA", "body": "<p>This works for most purposes e.g. 1901-2099:</p>\n\n<pre><code>=IF(MOD(YEAR(A1),4),365,366)\n</code></pre>\n\n<p>As @tigeravatar pointed out, for more rigorous logic try this:</p>\n\n<pre><code>=IF(MOD(YEAR(A1),4),365,IF(MOD(YEAR(A1),100),366,IF(MOD(YEAR(A1),400),365,366)))\n</code></pre>\n\n<p>Source: <a href=\"https://en.wikipedia.org/wiki/Leap_year\" rel=\"nofollow noreferrer\">Wikipedia's</a> handy algorithm:</p>\n\n<blockquote>\n  <ol>\n  <li>if (year is not divisible by 4) then (it is a common year)</li>\n  <li>else if (year is not divisible by 100) then (it is a leap year)</li>\n  <li>else if (year is not divisible by 400) then (it is a common year)</li>\n  <li>else (it is a leap year)</li>\n  </ol>\n</blockquote>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1497450808, "creation_date": 1497450808, "answer_id": 44547721, "question_id": 44546846, "link": "https://stackoverflow.com/questions/44546846/number-of-days-in-a-year-excel-vba/44547721#44547721", "title": "Number of days in a year Excel VBA", "body": "<p>The <a href=\"https://support.office.com/en-us/article/DAYS-function-57740535-d549-4395-8728-0f07bff0b9df\" rel=\"nofollow noreferrer\">DAYS function</a> was introduced with Excel 2013.</p>\n\n<pre><code>=DAYS(DATE(2017, 12, 31), DATE(2017, 1, 1))+1\n</code></pre>\n\n<p>The <a href=\"https://support.office.com/en-US/article/NETWORKDAYS-INTL-function-A9B26239-4F20-46A1-9AB8-4E925BFD5E28\" rel=\"nofollow noreferrer\">NETWORKDAYS.INTL function</a> was introduced at the same time. Set it to include all days.</p>\n\n<pre><code>=NETWORKDAYS.INTL(DATE(2017, 1, 1), DATE(2017, 12, 31), \"0000000\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 8907742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiXbC.jpg?s=128&g=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8907742/jpr"}, "is_accepted": false, "score": 0, "last_activity_date": 1550053081, "creation_date": 1550053081, "answer_id": 54667682, "question_id": 44546846, "link": "https://stackoverflow.com/questions/44546846/number-of-days-in-a-year-excel-vba/54667682#54667682", "title": "Number of days in a year Excel VBA", "body": "<p>The question asks for a VBA solution. Here is one that determines the number of days based on the existence of the leap day:</p>\n\n<pre><code>Public Function daysinyear(lngyear As Long) As Long\n    daysinyear = 368 - Month(DateSerial(lngyear, 2, 29))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1097, "user_id": 7042778, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9c7b56f9d0d40f16a5cb69e0905e2d79?s=128&d=identicon&r=PG&f=1", "display_name": "MCM", "link": "https://stackoverflow.com/users/7042778/mcm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4201, "favorite_count": 0, "accepted_answer_id": 44546982, "answer_count": 5, "score": 1, "last_activity_date": 1550053081, "creation_date": 1497448464, "last_edit_date": 1497449737, "question_id": 44546846, "link": "https://stackoverflow.com/questions/44546846/number-of-days-in-a-year-excel-vba", "title": "Number of days in a year Excel VBA", "body": "<p>I am trying to calculate the number of days for a dedicated year based on a date, e.g. 2015 using excel vba. 2015 should have 365 days which is a non-leap year and 2016 are 366 which is a leap year. </p>\n\n<p>A date would be e.g. 01.02.2015 and based on the year 2015 I would like to know how many days are in 2015. Is there a way doing it in vba?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1497448202, "post_id": 44546581, "comment_id": 76084031, "body": "<code>ThisWorkbook.Path</code> always returns a <code>vbNullString</code> (same as <code>&quot;&quot;</code>) if the workbook is a new workbook (or eg. an unsaved copy of an existing workbook) that was never saved before. Because how can it know the path you are going to save it later on?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497448246, "post_id": 44546581, "comment_id": 76084069, "body": "Are you sure that <code>ThisWorkbook.Path =&quot;&quot;</code>. Can you add this line <code>Msgbox Thisworkbook.path</code> before the <code>If</code> condition?"}, {"owner": {"reputation": 97, "user_id": 7469948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed61ca128d14949852799e1a9d93083?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/7469948/gregory"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1497448499, "post_id": 44546581, "comment_id": 76084286, "body": "@Peh , indeed but the file is saved on the net-drive. Is there another way to find where the users opened the file?"}, {"owner": {"reputation": 97, "user_id": 7469948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed61ca128d14949852799e1a9d93083?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/7469948/gregory"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497448652, "post_id": 44546581, "comment_id": 76084414, "body": "@SiddharthRout , yes that&#39;s how I found out that Thisworkbook.Path is returning &quot;&quot; or like &#39;Peh&#39; said above &#39;vbNullString&#39;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497449000, "post_id": 44546581, "comment_id": 76084703, "body": "That is strange. I have never come across this scenario (assuming that the file was opened from the networkpath)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1497449778, "post_id": 44546581, "comment_id": 76085262, "body": "If I open an existing workbook from a network path and run <code>debug.Print ThisWorkbook.Path</code> I get something like <code>\\\\servername\\shareddrive\\folder\\ </code>. Asking again \u2026 (1) are you sure that <code>ThisWorkbook.Path</code> is empty? Please verify! The code in your question does not show that you verify this. (2) Which server OS and client OS are you using when it is empty? (3) How is it opened? From a file explorer? Via browser (Intranet) link?"}, {"owner": {"reputation": 165, "user_id": 1194396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b8813689b4a973e952074f08529dacc?s=128&d=identicon&r=PG&f=1", "display_name": "ositra", "link": "https://stackoverflow.com/users/1194396/ositra"}, "edited": false, "score": 0, "creation_date": 1531985635, "post_id": 44546581, "comment_id": 89804773, "body": "I have the same problem. Network file. Need to to check the path of the file that has been opened. Can&#39;t save the file beforehand to use .path"}], "owner": {"reputation": 97, "user_id": 7469948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed61ca128d14949852799e1a9d93083?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/7469948/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1942, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497448098, "creation_date": 1497447808, "last_edit_date": 1531164843, "question_id": 44546581, "link": "https://stackoverflow.com/questions/44546581/thisworkbook-path-activeworkbook-path-returns-on-some-devices", "title": "Thisworkbook.Path / Activeworkbook.Path returns &quot;&quot; on some devices", "body": "<p>I have a short VBA code to check the current file location.\nDue to security reasons the file should always be on our network drive.</p>\n\n<p>The strange part is, that on some devices the current path is \"\" ?</p>\n\n<p>Code:</p>\n\n<pre><code>'----------CHECK FILE LOCATION----------------------\nIf ThisWorkbook.Path = \"\\\\Exampledrive\\Examplefolder\\test\" Then\n\nElse\n    MsgBox (\"Security Issue, file will be removed\"), vbCritical\n    ThisWorkbook.ChangeFileAccess xlReadOnly\n    Kill ThisWorkbook.FullName\n    ActiveWorkbook.Close SaveChanges:=False\nEnd If\n</code></pre>\n\n<p>Many thanks!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1497446887, "post_id": 44546193, "comment_id": 76082942, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers."}, {"owner": {"reputation": 13, "user_id": 8160717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560681640610547/picture?type=large", "display_name": "Blair McLelland", "link": "https://stackoverflow.com/users/8160717/blair-mclelland"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1497447480, "post_id": 44546193, "comment_id": 76083433, "body": "Sorry, i&#39;ve specified the problem more clearly now"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1497447880, "post_id": 44546193, "comment_id": 76083748, "body": "You missed the part where you need to provide the code you are trying.  It would also help if you mock up data and expected outcome."}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1497447889, "creation_date": 1497447889, "answer_id": 44546608, "question_id": 44546193, "link": "https://stackoverflow.com/questions/44546193/excel-loop-through-range-charge-discharge-of-a-battery/44546608#44546608", "title": "Excel Loop through Range- Charge Discharge of a battery", "body": "<p>You need to have something that tells Excel whether the battery charge is decreasing (draining) or increasing (charging).  Here is an example showing a possible solution.</p>\n\n<p>Initial Setup:</p>\n\n<ul>\n<li>Cell C2 has the number <code>1</code> entered in manually</li>\n<li>Cell D2 has the word <code>Drain</code> entered in manually</li>\n<li>Cell C3 (and copied down) has this formula:\n\n<ul>\n<li><code>=MAX(0,MIN(1,ROUND(C2+IF(D2=\"Drain\",-0.1,0.1),1)))</code></li>\n</ul></li>\n<li>Cell D3 (and copied down) has this formula:\n\n<ul>\n<li><code>=IF(C3=0,\"Charge\",IF(C3=1,\"Drain\",D2))</code></li>\n</ul></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/Xn3Ci.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xn3Ci.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 8160717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560681640610547/picture?type=large", "display_name": "Blair McLelland", "link": "https://stackoverflow.com/users/8160717/blair-mclelland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 44546608, "answer_count": 1, "score": -1, "last_activity_date": 1497447889, "creation_date": 1497446816, "last_edit_date": 1531161705, "question_id": 44546193, "link": "https://stackoverflow.com/questions/44546193/excel-loop-through-range-charge-discharge-of-a-battery", "title": "Excel Loop through Range- Charge Discharge of a battery", "body": "<p>I am trying to use excel to simulate the charging and discharging of a battery. As in once the battery reaches 1, the level of charge will decrease until it reaches 0 and then begin charging again back to 1. </p>\n\n<p>I have tried using multiple IF functions that do not seem to be working as, for example:IFS(cell&lt;=1, cell-10%, cell>0, cell+10%), the array will always continue to decrease or increase past 0 and 1 respectively and will never loop within the range.</p>\n\n<p>Hypothetically you can say that it increases 10% an hour from 0-1 and decreases 10% an hour from 1-0.</p>\n\n<p>Any help much appreciated thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 1, "creation_date": 1497446796, "post_id": 44546141, "comment_id": 76082867, "body": "I believe you need to do that through Regional Settings in Windows."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1497446841, "post_id": 44546141, "comment_id": 76082900, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43863482/vba-changing-decimal-to-comma-automaticaly\">VBA changing decimal to comma automaticaly</a>"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1497447748, "post_id": 44546141, "comment_id": 76083649, "body": "You need to format the cell&#39;s as text for this to work. Otherwise regional formats takes over."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1497448029, "post_id": 44546141, "comment_id": 76083884, "body": "Just change the .NumberFormat property."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1497453332, "post_id": 44546141, "comment_id": 76087929, "body": "You&#39;re working against the value. You could just change to <code>Cell.Value = Application.WorksheetFunction.Substitute(Cell.Text, &quot;.&quot;, &quot;,&quot;)</code> However if you&#39;re actually using the values, you&#39;ll run into numbers stored as text and that kind of errors, as well as unexpected numberformatting settings."}], "answers": [{"comments": [{"owner": {"reputation": 6477, "user_id": 9608718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414d776388a58815290c0efc4a4bb114?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Riabov", "link": "https://stackoverflow.com/users/9608718/alex-riabov"}, "edited": false, "score": 2, "creation_date": 1533401212, "post_id": 51687426, "comment_id": 90337251, "body": "While this code may answer the question, providing additional context regarding why and/or how this code answers the question improves its long-term value."}], "tags": [], "owner": {"reputation": 1, "user_id": 10180586, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e6df0dbb447958982683a5220e777736?s=128&d=identicon&r=PG", "display_name": "Joop", "link": "https://stackoverflow.com/users/10180586/joop"}, "is_accepted": false, "score": 0, "last_activity_date": 1533409276, "last_edit_date": 1533409276, "creation_date": 1533399281, "answer_id": 51687426, "question_id": 44546141, "link": "https://stackoverflow.com/questions/44546141/vba-replace-dot-with-comma/51687426#51687426", "title": "VBA Replace dot with comma", "body": "<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nWith Application\n.DecimalSeparator = \",\"\n.UseSystemSeparators = True\nEnd With\nEnd Sub\n\nPrivate Sub Workbook_Open()\nWith Application\n.DecimalSeparator = \".\"\n.UseSystemSeparators = False\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7635801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66332587d1385ca45a1f6f74b30ae553?s=128&d=identicon&r=PG&f=1", "display_name": "najibk", "link": "https://stackoverflow.com/users/7635801/najibk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5536, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1533409276, "creation_date": 1497446668, "last_edit_date": 1497450107, "question_id": 44546141, "link": "https://stackoverflow.com/questions/44546141/vba-replace-dot-with-comma", "title": "VBA Replace dot with comma", "body": "<p>I have just started developing macros with VBA. I have some trouble replacing dots with commas using my macro  </p>\n\n<p>I tried these codes :  </p>\n\n<pre><code>Dim Cell As Range\n\nFor Each Cell In Range(Cells(1, 1), Cells(Cells(Rows.Count, 1).End(xlUp).Row, Cells(1, Columns.Count).End(xlToLeft).Column))\n  Cell.Value = Application.WorksheetFunction.Substitute(Cell.Value, \".\", \",\")\nNext\n</code></pre>\n\n<p>And This one  </p>\n\n<pre><code>Range(Cells(1, 1), Cells(Cells(Rows.Count, 1).End(xlUp).Row, Cells(1, Columns.Count).End(xlToLeft).Column)).Select\nSelection.Replace What:=\".\", Replacement:=\",\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n</code></pre>\n\n<p>But both give wrong result. For example for 124.419022 it gives 124 419 022\ninstead of 124.419022  </p>\n\n<p>Can anyone please help me find a solution for this problem ?  </p>\n\n<p>Thanks in advance  </p>\n"}, {"tags": ["jquery", "vba", "jquery-select2", "browser-automation"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1497446122, "post_id": 44545772, "comment_id": 76082298, "body": "have you tried to get it from the class name?  also <code>.fireevent</code> also <code>clicik</code>?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497534482, "post_id": 44545772, "comment_id": 76127169, "body": "No, not yet.  But we will now!  Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1497534268, "post_id": 44552211, "comment_id": 76126997, "body": "Thank you.  I think your first solution might be helpful because it will allow me to trigger the dropdown.  My problem on this is that this is an &quot;&lt;input&quot; box and does not have an associated &quot;&lt;select&quot; box.  Through trial and error I&#39;ve discovered that the select boxes on our website can be changed with the command similar to myDoc.parentWindow.execScript &quot;$(&#39;#s2id_beanCounter&#39;).val(&#39;Bruce Lee&#39;).trigger(&#39;change&#39;)&quot;."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1497534273, "post_id": 44552211, "comment_id": 76127003, "body": "That will change the select box without the need for the drop down box at all, the caveat being your value must be an exact match of one of the list items, or in other words valid.  But this input box is much trickier and I think we&#39;ll have to use the logic of your first suggestion to handle it.  Thanks!  I&#39;ll let you know how it comes out."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1497982940, "post_id": 44552211, "comment_id": 76306151, "body": "so far your advice (part 1) has got me started very well.  Now I&#39;m trying to select a name from the list of names that comes down in the drop down list.  In your example there was only one person named &quot;Bruce&quot; - and your code selects his name perfectly.  But if there are several people with the same last name I need to select the correct one.  I&#39;ve added the coder to my question above.  Would you please look at it and possibly advise me?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1498013761, "post_id": 44552211, "comment_id": 76317411, "body": "@JohnMuggins could you tell, which version of <code>select2</code> are you using? The html produced in my demo page looks different. Maybe I am using different version then you. I am using version <code>Select2 4.0.3</code>. So please have a look into the file <code>select2.js</code> at the very top there is the version."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1498047693, "post_id": 44552211, "comment_id": 76335891, "body": "It has a css file in this directory: select2-3.4.1.  Again, this is an input box.  All of the other search boxes are select boxes and can be triggered with execscript, but this one they chose to use an input box.  I think because the data list is very large, probably 20,000 or more names.  This is our company&#39;s new software and again they made it horrible for the workers to engage with.  It&#39;s a 2 min process that now takes 10."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1498048257, "post_id": 44552211, "comment_id": 76336329, "body": "I think I need to use some sort of mouseevent to choose, but haven&#39;t been successful."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1498247642, "post_id": 44552211, "comment_id": 76440761, "body": "@JohnMuggins the information about the version of <code>select2</code> should be the first thing I had to ask :). See edit for the version <code>3.4.1</code>. In this version the <code>select2</code> attaches to  <code>mouseup</code> event of the <code>select2-result-label</code> element. This post is probably my longest one here on SO :). HTH"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1498483380, "post_id": 44552211, "comment_id": 76502240, "body": "totally correct @dee!  You hit it right on the nail head.  Thank you so much.  I&#39;m putting the final working code below for anyone else who might need it in the future, but you deserve the credit.  And for the record this is the best guidance I&#39;ve had."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1498487473, "post_id": 44552211, "comment_id": 76505042, "body": "@JohnMuggins You are welcome, I am glad it helped! It was tough one :)"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1498540209, "post_id": 44552211, "comment_id": 76525691, "body": "@JohnMuggins yes it was fun, I like jQuery! If the answer solved your problem, can you mark it as accepted?"}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": true, "score": 2, "last_activity_date": 1498283264, "last_edit_date": 1498283264, "creation_date": 1497465255, "answer_id": 44552211, "question_id": 44545772, "link": "https://stackoverflow.com/questions/44545772/filling-html-input-boxes-that-were-created-with-select2/44552211#44552211", "title": "Filling HTML Input Boxes That Were Created With Select2", "body": "<blockquote>\n  <p>For Version 4.0.3 of select 2</p>\n</blockquote>\n\n<p><em>Solution 1</em></p>\n\n<p>In <code>select2.js</code> there is function:</p>\n\n<pre><code>this.$selection.on('mousedown', function (evt) {\n  // Only respond to left clicks\n  if (evt.which !== 1) {\n    return;\n  }\n\n  self.trigger('toggle', {\n    originalEvent: evt\n  });\n});\n</code></pre>\n\n<p>This function handles the <code>mousedown</code> event of the <code>selection</code> so first I have tried to send <code>mousedown</code> to the <code>selection</code> so we get the <code>selection</code> open and then to put the text into search box. Finally it is necessary to send input event to trigger searching.</p>\n\n<pre><code>Sub Select2Demo()\n\n    Dim ie As SHDocVw.InternetExplorer\n    Dim doc As MSHTML.HTMLDocument\n    Dim url As String\n\n    url = \"file:///C:/Temp/StackOverflow/html/Select2VbaDemo.html\"\n    Set ie = New SHDocVw.InternetExplorer\n    ie.Visible = True\n    ie.navigate url\n\n    While ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Wend\n\n    Set doc = ie.document\n\n    ' Open drop down\n    Dim sp As HTMLSpanElement\n    Set sp = doc.querySelector(\"span[class^=select2-selection]\")\n    SendMouseDownEvent doc, sp\n\n    ' Put value into search box\n    Dim inp\n    Set inp = doc.querySelector(\"input[class=select2-search__field]\")\n    inp.Value = \"BR\"\n\n    ' Send input event to trigger searching of text 'BR\"\n    Dim kev\n    Set kev = doc.createEvent(\"KeyboardEvent\")\n    kev.initEvent \"input\", True, False\n    inp.dispatchEvent kev\n\n    'ie.Quit\nEnd Sub\n\nPrivate Sub SendMouseDownEvent(doc As MSHTML.HTMLDocument, target As IEventTarget)\n    Dim mev As Object\n    Dim eventType As String\n    Dim canBubble As Boolean\n    Dim cancelable As Boolean\n    Dim viewArg As IHTMLWindow2\n    Dim detailArg As Long\n    Dim screenXArg As Long\n    Dim screenYArg As Long\n    Dim clientXArg As Long\n    Dim clientYArg As Long\n    Dim ctrlKeyArg As Boolean\n    Dim altKeyArg As Boolean\n    Dim shiftKeyArg As Boolean\n    Dim metaKeyArg As Boolean\n    Dim buttonArg As Object ' Unsupported Variant-Type\n    Dim relatedTargetArg As IEventTarget\n\n    Set mev = doc.createEvent(\"MouseEvent\")\n    eventType = \"mousedown\"\n    canBubble = True\n    cancelable = False\n    Set viewArg = doc.parentWindow\n    Set relatedTargetArg = target\n\n    mev.initMouseEvent eventType, canBubble, cancelable, viewArg, _\n        detailArg, screenXArg, screenYArg, clientXArg, clientYArg, _\n        ctrlKeyArg, altKeyArg, shiftKeyArg, metaKeyArg, buttonArg, _\n        relatedTargetArg\n    target.dispatchEvent mev\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><em>Solution 2</em></p>\n\n<p>Other idea would be to put <code>focus</code> to the <code>selection</code> and simply send <code>{ENTER}</code> which is the same as when the user opens the <code>selection</code>.\nWe need the <code>selection</code> to be opened because then the <code>input</code> will be added to the DOM (otherwise it is not there). The following code worked for me. </p>\n\n<p>Notice the <code>SetFocusIE</code> which ensures that the <code>IE-Window</code> is active one and so the <code>SendKeys</code> will target the right window. HTH.</p>\n\n<pre><code>Option Explicit\n\n' Add reference to Microsoft Internet Controls (SHDocVw)\n' Add reference to Microsoft HTML Object Library\n\nPrivate Declare Function SetFocusIE Lib \"user32\" Alias \"SetFocus\" _ \n    (ByVal hwnd As Long) As Long\n\nSub Select2Demo2()\n\n    Dim ie As SHDocVw.InternetExplorer\n    Dim doc As MSHTML.HTMLDocument\n    Dim url As String\n\n    url = \"file:///C:/Temp/StackOverflow/html/Select2VbaDemo.html\"\n    Set ie = New SHDocVw.InternetExplorer\n    ie.Visible = True\n    ie.navigate url\n\n    While ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Wend\n\n    Set doc = ie.document\n\n    Dim sp As HTMLSpanElement\n    Set sp = doc.querySelector(\"span[class^=select2-selection]\")\n\n    sp.Click ' Selection gets focus\n    SetFocusIE ie.hwnd ' IE gets active window\n    SendKeys \"~\", True ' Sends ENTER: Selection opens\n\n    ' put value to search box then \n    Dim inp\n    Set inp = doc.querySelector(\"input[class=select2-search__field]\")\n    inp.Value = \"BR\"\n\n    ie.Quit\nEnd Sub\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Sample page used</p>\n</blockquote>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n\n&lt;head&gt;\n&lt;!-- saved from url=(0016)http://localhost --&gt;\n&lt;meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\" /&gt;\n&lt;script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-2.2.4.min.js\"&gt;&lt;/script&gt;\n&lt;link href=\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css\" rel=\"stylesheet\" /&gt;\n&lt;script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.js\"&gt;&lt;/script&gt;\n&lt;title&gt;Untitled 1&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;script type=\"text/javascript\"&gt;\n        $(document).ready(function() {\n          $(\"#s2id_beanCounter\").select2();     \n        });\n    &lt;/script&gt;\n\n    &lt;div class=\"s2-example\" &gt;           \n        &lt;label class=\"control-label\" for=\"s2id_beanCounter\"&gt;\n            Enter Employee Name\n            &lt;select class=\"js-example-basic-single js-states form-control\" id=\"s2id_beanCounter\" style=\"width:100%\"&gt;\n                  &lt;option value=\"JD\"&gt;John Doe&lt;/option&gt;\n                  &lt;option value=\"BL\"&gt;Bruce Lee&lt;/option&gt;\n            &lt;/select&gt;\n        &lt;/label&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Result im IE</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/g5lKm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g5lKm.jpg\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>EDIT: For Version 3.4.1 of select2</p>\n</blockquote>\n\n<p>In version 3.4.1 it looks different. There is this function resposible for selecting the highlighted element:</p>\n\n<pre><code>this.dropdown.on(\"mouseup\", resultsSelector, this.bind(function (e) {\n    if ($(e.target).closest(\".select2-result-selectable\").length &gt; 0) {\n        this.highlightUnderEvent(e);\n        this.selectHighlighted(e);\n    }\n}));\n</code></pre>\n\n<p>So the following code can be used to highlight and select one of the filtered elements. HTH</p>\n\n<pre><code>Option Explicit\n\n' Add reference to Microsoft Internet Controls (SHDocVw)\n' Add reference to Microsoft HTML Object Library\n\nSub Select2DemoVersion341()\n\n    Dim ie As SHDocVw.InternetExplorer\n    Dim doc As MSHTML.HTMLDocument\n    Dim url As String\n\n    url = \"file:///C:/Temp/StackOverflow/html/select2demo/Select2VbaDemo.html\"\n    Set ie = New SHDocVw.InternetExplorer\n    ie.Visible = True\n    ie.navigate url\n\n    While ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Wend\n\n    Set doc = ie.document\n\n    ' Get reference to target serach input box before select2 starts to mess up with the DOM when the select opens\n    Dim inp As HTMLInputElement\n    Set inp = doc.querySelector(\"div[class^=select2-container] input[class=select2-input]\")\n\n    ' Open drop down\n    Dim select2Choice As HTMLAnchorElement\n    Set select2Choice = doc.querySelector(\"a[class^=select2-choice]\")\n    SendMouseEvent doc, select2Choice, \"mousedown\"\n\n    ' Put value into search box\n    inp.Value = \"mengela\"\n\n    ' Send input event to trigger searching of text 'mengela\"\n    Dim kev\n    Set kev = doc.createEvent(\"KeyboardEvent\")\n    kev.initEvent \"input\", True, False\n    inp.dispatchEvent kev\n\n     ' Get the search results\n    Dim selectResultUl As HTMLUListElement\n    Set selectResultUl = doc.querySelector(\"ul[class=select2-results]\")\n    If selectResultUl.Children.Length = 1 Then\n        ' Verify 'No results found' posibility\n        If selectResultUl.Children(0).className = \"select2-no-results\" Then\n            MsgBox \"No results\"\n            ie.Quit\n            Exit Sub\n        End If\n    End If\n\n    ' Deselect currently selected item by removing select2-highlighted class\n    Dim selectedResultsLis As IHTMLElementCollection\n    Dim selectResultsLi As HTMLLIElement\n    Set selectedResultsLis = selectResultUl.getElementsByTagName(\"li\")\n    For Each selectResultsLi In selectedResultsLis\n        If selectResultsLi.className Like \"*select2-highlighted*\" Then\n            selectResultsLi.className = VBA.Strings.Replace(selectResultsLi.className, \"select2-highlighted\", \"\")\n            Exit For\n        End If\n    Next selectResultsLi\n\n    ' Select another li-element, e.g. last one by adding select2-highlighted class\n    Dim newSelectionLi As HTMLLIElement\n    Set newSelectionLi = selectedResultsLis(selectedResultsLis.Length - 1)\n    newSelectionLi.className = newSelectionLi.className &amp; \" select2-highlighted\"\n\n    ' Send mouseup to result label to select the highligted element\n    Dim resultLabel As HTMLDivElement\n    Set resultLabel = newSelectionLi.getElementsByClassName(\"select2-result-label\")(0)\n    SendMouseEvent doc, resultLabel, \"mouseup\"\n\n    'ie.Quit\nEnd Sub\n\nPrivate Sub SendMouseEvent(doc As MSHTML.HTMLDocument, target As IEventTarget, eventTypeVal)\n    Dim mev As Object\n    Dim eventType As String\n    Dim canBubble As Boolean\n    Dim cancelable As Boolean\n    Dim viewArg As IHTMLWindow2\n    Dim detailArg As Long\n    Dim screenXArg As Long\n    Dim screenYArg As Long\n    Dim clientXArg As Long\n    Dim clientYArg As Long\n    Dim ctrlKeyArg As Boolean\n    Dim altKeyArg As Boolean\n    Dim shiftKeyArg As Boolean\n    Dim metaKeyArg As Boolean\n    Dim buttonArg As Object ' Unsupported Variant-Type\n    Dim relatedTargetArg As IEventTarget\n\n    Set mev = doc.createEvent(\"MouseEvent\")\n    eventType = eventTypeVal\n    canBubble = True\n    cancelable = False\n    Set viewArg = doc.parentWindow\n    Set relatedTargetArg = target\n\n    mev.initMouseEvent eventType, canBubble, cancelable, viewArg, _\n        detailArg, screenXArg, screenYArg, clientXArg, clientYArg, _\n        ctrlKeyArg, altKeyArg, shiftKeyArg, metaKeyArg, buttonArg, _\n        relatedTargetArg\n    target.dispatchEvent mev\nEnd Sub    \n</code></pre>\n\n<p>Demo page with select2.js/css of version 3.4.1 can be downloaded from my <a href=\"https://www.dropbox.com/s/630efk5cky3wejb/select2demo.zip?dl=0\" rel=\"nofollow noreferrer\">dropbox</a>  as zip file.</p>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 1, "last_activity_date": 1498483177, "last_edit_date": 1498483177, "creation_date": 1498053103, "answer_id": 44678092, "question_id": 44545772, "link": "https://stackoverflow.com/questions/44545772/filling-html-input-boxes-that-were-created-with-select2/44678092#44678092", "title": "Filling HTML Input Boxes That Were Created With Select2", "body": "<p>This code was derived with the help of Dee above, so if you find it useful please give him a tic up.  Select2 is an addon helper for select boxes, but in this case it used an \"input\" box so finding a way to select from a dropdown list is a bit different than for the selectboxes.  You might need to adjust the 'children' elements to suit you specific needs.  Here it was trial and error to find the correct elements because they had neither names or id's.</p>\n\n<pre><code>Sub open_EMPLOYEE_name_box_1()\n\n    Dim ie As SHDocVw.InternetExplorer, _\n        i As Long, objShell, objAllWindows, ow, myElement As IEventTarget, _\n        myArray1() As String, tempNumb As Integer, myDoc As HTMLDocument, kev\n\n    i = 2:    tempNumb = 1:    ReDim myArray1(1 To 1):\n    ReDim myArray1(1 To 1):    Set objShell = CreateObject(\"Shell.Application\")\n    Set objAllWindows = objShell.Windows\n\n    For Each ow In objAllWindows\n        If (InStr(1, ow, \"Internet Explorer\", vbTextCompare)) Then\n            If ow.document.Title = \"Company Name : Company Page\" Then\n                Set ie = ow\n                Set myDoc = ie.document\n                GoTo mainProg\n            End If\n            tempNumb = tempNumb + 1\n            If Not ow.document.Title = \"\" Then\n                ReDim Preserve myArray1(1 To tempNumb)\n            Else\n                Exit For\n            End If\n            i = i + 1\n        End If\n    Next\n\nmainProg:\n'/////////////////////  THIS BRINGS UP THE SMITH LIST\n  Set myElement = myDoc.getElementById(\"s2id_employeeName\").Children(0)\n  SendMouseDownEvent myDoc, myElement\n    Set myElement = myDoc.getElementById(\"s2id_employeeName\").Children(0)\n    Set myElement = myDoc.getElementById(\"select2-drop\").Children(0).Children(0)\n    myElement.Value = \"Smith\"\n    Set kev = myDoc.createEvent(\"KeyboardEvent\")\n    kev.initEvent \"input\", True, False\n    myElement.dispatchEvent kev\n\n'/////////////////////////// THIS SELECTS \"STEVEN R BISHOP (HEBRON)\"\nApplication.Wait Now + #12:00:03 AM#    '   3 second wait for dropdown box to finish\nSet myClassResults = myDoc.getElementsByClassName(\"select2-result-label\")\nFor Each cl In myClassResults\n    If cl.innerText = \"STEVEN R SMITH (CARMEL)\" Then\n        Set myElement = cl\n        SendMouseUpEvent myDoc, myElement\n    End If\nNext\n\n\n\nendItAll:\nSet myClassResults = Nothing\nSet myElement = Nothing\nSet objAllWindows = Nothing\nSet myDoc = Nothing\nSet ie = Nothing\nEnd Sub\n\n\nPrivate Sub SendMouseDownEvent(doc As MSHTML.HTMLDocument, target As IEventTarget)\n    Dim mev As Object\n    Dim eventType As String\n    Dim canBubble As Boolean\n    Dim cancelable As Boolean\n    Dim viewArg As IHTMLWindow2\n    Dim detailArg As Long\n    Dim screenXArg As Long\n    Dim screenYArg As Long\n    Dim clientXArg As Long\n    Dim clientYArg As Long\n    Dim ctrlKeyArg As Boolean\n    Dim altKeyArg As Boolean\n    Dim shiftKeyArg As Boolean\n    Dim metaKeyArg As Boolean\n    Dim buttonArg As Object ' Unsupported Variant-Type\n    Dim relatedTargetArg As IEventTarget\n        Dim kev\n\n    Set mev = doc.createEvent(\"MouseEvent\")\n    eventType = \"mousedown\"\n    canBubble = True\n    cancelable = False\n    Set viewArg = doc.parentWindow\n    Set relatedTargetArg = target\n\n    mev.initMouseEvent eventType, canBubble, cancelable, viewArg, _\n        detailArg, screenXArg, screenYArg, clientXArg, clientYArg, _\n        ctrlKeyArg, altKeyArg, shiftKeyArg, metaKeyArg, buttonArg, _\n        relatedTargetArg\n    target.dispatchEvent mev\nEnd Sub\n\nPrivate Sub SendMouseUpEvent(doc As MSHTML.HTMLDocument, target As IEventTarget)\n    Dim mev As Object\n    Dim eventType As String\n    Dim canBubble As Boolean\n    Dim cancelable As Boolean\n    Dim viewArg As IHTMLWindow2\n    Dim detailArg As Long\n    Dim screenXArg As Long\n    Dim screenYArg As Long\n    Dim clientXArg As Long\n    Dim clientYArg As Long\n    Dim ctrlKeyArg As Boolean\n    Dim altKeyArg As Boolean\n    Dim shiftKeyArg As Boolean\n    Dim metaKeyArg As Boolean\n    Dim buttonArg As Object ' Unsupported Variant-Type\n    Dim relatedTargetArg As IEventTarget\n        Dim kev\n\n    Set mev = doc.createEvent(\"MouseEvent\")\n    eventType = \"mouseup\"\n    canBubble = True\n    cancelable = False\n    Set viewArg = doc.parentWindow\n    Set relatedTargetArg = target\n\n    mev.initMouseEvent eventType, canBubble, cancelable, viewArg, _\n        detailArg, screenXArg, screenYArg, clientXArg, clientYArg, _\n        ctrlKeyArg, altKeyArg, shiftKeyArg, metaKeyArg, buttonArg, _\n        relatedTargetArg\n    target.dispatchEvent mev\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1387, "favorite_count": 1, "accepted_answer_id": 44552211, "answer_count": 2, "score": 1, "last_activity_date": 1498483177, "creation_date": 1497445735, "last_edit_date": 1497982646, "question_id": 44545772, "link": "https://stackoverflow.com/questions/44545772/filling-html-input-boxes-that-were-created-with-select2", "title": "Filling HTML Input Boxes That Were Created With Select2", "body": "<p>I'm using Excel VBA to automate a web page.  The \"Select\" boxes and \"Input\" boxes were created by a jQuery platform called \"Select2.\"</p>\n\n<p>When the user clicks on a \"Select box\" (which appears as an input box) a dropdown box pops up asking the user to type in two characters.  I've discovered that you can add a valid data item into this box with this command by inserting the select box ID.</p>\n\n<pre><code>myDoc.parentWindow.execScript \"$('#s2id_broomCloset').val('Swiffer - Model 2010').trigger('change')\"\n</code></pre>\n\n<p>Most of the input boxes are like any other where you can change them with </p>\n\n<pre><code>myDoc.GetElementByID(\"broomCloset\").value = \"Swiffer\"\n</code></pre>\n\n<p>However, there is one input box built with Select2 which involves a validation drop down list asking the user to type the first two characters and it lists employees whose last names start with those two characters.  Then the user is supposed to select the employee from the list.</p>\n\n<p>This input box is tied to an \"\n\n<p><a href=\"https://i.stack.imgur.com/8JCqY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8JCqY.png\" alt=\"enter image description here\"></a></p>\n\n<p>I was able to use the advice of </p>\n\n<p>I have tried everything I can think of to enter a valid response into this input box.  Here are a couple of failed attempts:</p>\n\n<pre><code>myDoc.GetElementByID(\"s2id_beanCounter\").Children(0).Clicik\nmyDoc.parentWindow.execScript \"$('#s2id_beanCounter').trigger('onclick')\"\n</code></pre>\n\n<p>It would be a tremendous help if you could lead me to an answer as how can I put a valid input into this box or at least how to click the box to make the drop down list appear.</p>\n\n<p>Edited 06-20-2017</p>\n\n<p>Using advice from @dee I was able to get the last name into the searchable input elelment and it drops down all of the people with that last name.  As you can see from the html code below the first name in the drop down box is highlighted.</p>\n\n<p>When I hover the mouse over any of the names, the name under the mouse becomes the highlighted name.  And of course a left click of the mouse enters that name into the input box.</p>\n\n<p>How can I automate the process of highlighting the name we need form the UL list and click it to put into the input box as a valid value?</p>\n\n<p>The one caveat about this search is that it only searches the last name.  </p>\n\n<pre><code>&lt;div class=\"select2-drop select2-display-none bigdrop select2-with-searchbox select2-drop-active\" id=\"select2-drop\" style=\"left: 1049.13px; top: 227.83px; width: 238px; display: block;\"&gt;   \n  &lt;div class=\"select2-search\"&gt;       \n      &lt;input class=\"select2-input\" spellcheck=\"false\" type=\"text\" autocomplete=\"off\" autocapitalize=\"off\" autocorrect=\"off\"&gt;   \n &lt;/div&gt;   \n\n  &lt;ul class=\"select2-results\"&gt;\n      &lt;li class=\"select2-results-dept-0 select2-result select2-result-selectable select2-highlighted\"&gt;\n          &lt;div class=\"select2-result-label\"&gt;\n              &lt;div&gt;JOSEPH MENGELA (ARGENTINA)&lt;/div&gt;&lt;/div&gt;\n      &lt;/li&gt;\n\n      &lt;li class=\"select2-results-dept-0 select2-result select2-result-selectable\"&gt;\n          &lt;div class=\"select2-result-label\"&gt;\n              &lt;div&gt;TOMMY MENGELA (ITALY)&lt;/div&gt;\n          &lt;/div&gt;\n      &lt;/li&gt;\n\n      &lt;li class=\"select2-results-dept-0 select2-result select2-result-selectable\"&gt;\n          &lt;div class=\"select2-result-label\"&gt;\n              &lt;div&gt;SUSAN H MENGELA (POLAND)&lt;/div&gt;\n          &lt;/div&gt;\n      &lt;/li&gt;\n   &lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Here is the code I used to get the dropdown box to show all the names of people in our system with that last name.</p>\n\n<pre><code>Set myElement = myDoc.getElementById(\"s2id_IDofInputBoxHere\").Children(0)\nSendMouseDownEvent myDoc, myElement\nSet myElement = myDoc.getElementById(\"select2-drop\").Children(0).Children(0)\nmyDoc.getElementById(\"select2-drop\").Children(0).Children(0).Value = \"mengela\"\n' Send input event to trigger searching of text 'BR\"\nDim kev\nSet kev = myDoc.createEvent(\"KeyboardEvent\")\nkev.initEvent \"input\", True, False\nmyElement.dispatchEvent kev\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 890, "user_id": 4537270, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ihOUv.jpg?s=128&g=1", "display_name": "XsiSec", "link": "https://stackoverflow.com/users/4537270/xsisec"}, "is_accepted": false, "score": 1, "last_activity_date": 1497445595, "creation_date": 1497445595, "answer_id": 44545714, "question_id": 44545619, "link": "https://stackoverflow.com/questions/44545619/vba-how-to-extract-all-files-names-from-a-folder-without-using-application-fi/44545714#44545714", "title": "VBA; how to extract all files names from a folder - without using Application.FileDialog object", "body": "<p>See example below </p>\n\n<pre><code>Public Sub Listpng()\nConst strFolder As String = \"C:\\SomeFolder\\\"\nConst strPattern As String = \"*.png\"\nDim strFile As String\nstrFile = Dir(strFolder &amp; strPattern, vbNormal)\nDo While Len(strFile) &gt; 0\nDebug.Print strFile '&lt;- view this in Immediate window; Ctrl+g will take you there\nstrFile = Dir\nLoop\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 287, "user_id": 6688323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/04jC5.jpg?s=128&g=1", "display_name": "michal roesler", "link": "https://stackoverflow.com/users/6688323/michal-roesler"}, "edited": false, "score": 0, "creation_date": 1497446219, "post_id": 44545866, "comment_id": 76082379, "body": "Please explain what is this variable necessary for?? <code>Dim flag As Boolean</code>  what is it&#39;s job in the code??"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 287, "user_id": 6688323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/04jC5.jpg?s=128&g=1", "display_name": "michal roesler", "link": "https://stackoverflow.com/users/6688323/michal-roesler"}, "edited": false, "score": 1, "creation_date": 1497446762, "post_id": 44545866, "comment_id": 76082835, "body": "It loops throgh the file until the <code>directory =&quot;&quot;</code> so all files have been checked. You could also say <code>While varDirectory &lt;&gt;&quot;&quot;</code>. It didnt wrote this piece of code."}, {"owner": {"reputation": 287, "user_id": 6688323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/04jC5.jpg?s=128&g=1", "display_name": "michal roesler", "link": "https://stackoverflow.com/users/6688323/michal-roesler"}, "edited": false, "score": 0, "creation_date": 1497451631, "post_id": 44545866, "comment_id": 76086678, "body": "why <code>varDirectory</code> is dimmed as Variant? Isn&#39;t it holding string values? please explain this a little. I&#39;m just very beginner, therefore I need to understand this."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 287, "user_id": 6688323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/04jC5.jpg?s=128&g=1", "display_name": "michal roesler", "link": "https://stackoverflow.com/users/6688323/michal-roesler"}, "edited": false, "score": 0, "creation_date": 1497452635, "post_id": 44545866, "comment_id": 76087392, "body": "I edited to what you should do. i agree that the previous answer was straight up bad. i didnt look it trough. you are right with the fact, that it only stores strings. i dont know why they chose to use a variant for it."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 287, "user_id": 6688323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/04jC5.jpg?s=128&g=1", "display_name": "michal roesler", "link": "https://stackoverflow.com/users/6688323/michal-roesler"}, "edited": false, "score": 0, "creation_date": 1497453355, "post_id": 44545866, "comment_id": 76087951, "body": "If you need more informations about the <code>Dir</code> function check out the microsoft documentation: <a href=\"https://msdn.microsoft.com/en-us/library/dk008ty4(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/dk008ty4(v=vs.90).aspx</a>"}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 1, "last_activity_date": 1497452536, "last_edit_date": 1497452536, "creation_date": 1497445953, "answer_id": 44545866, "question_id": 44545619, "link": "https://stackoverflow.com/questions/44545619/vba-how-to-extract-all-files-names-from-a-folder-without-using-application-fi/44545866#44545866", "title": "VBA; how to extract all files names from a folder - without using Application.FileDialog object", "body": "<pre><code>Sub Files()\nDim sht As Worksheet\nDim strDirectory As String, strFile As String\nDim i As Integer: i = 1\n\nSet sht = Worksheets(\"Sheet1\")\nstrDirectory = \"C:\\Users\\User\\Desktop\\\"\nstrFile = Dir(strDirectory, vbNormal)\n\nDo While strFile &lt;&gt; \"\"\n    With sht\n        .Cells(i, 1) = strFile\n        .Cells(i, 2) = strDirectory + strFile\n    End With\n    'returns the next file or directory in the path\n    strFile = Dir()\n    i = i + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1497446642, "creation_date": 1497446642, "answer_id": 44546132, "question_id": 44545619, "link": "https://stackoverflow.com/questions/44545619/vba-how-to-extract-all-files-names-from-a-folder-without-using-application-fi/44546132#44546132", "title": "VBA; how to extract all files names from a folder - without using Application.FileDialog object", "body": "<p>There's a couple of procedures I use depending on whether I want subfolders as well.</p>\n\n<p>This loops through the folder and adds path &amp; name to a collection:</p>\n\n<pre><code>Sub Test1()\n    Dim colFiles As Collection\n    Dim itm As Variant\n\n    Set colFiles = New Collection\n\n    EnumerateFiles \"C:\\Users\\michal\\SkyDrive\\csv\\bossa\\mstcgl_mst\\\", \"*.xls*\", colFiles\n\n    For Each itm In colFiles\n        Debug.Print itm\n    Next itm\nEnd Sub\n\nSub EnumerateFiles(ByVal sDirectory As String, _\n    ByVal sFileSpec As String, _\n    ByRef cCollection As Collection)\n\n    Dim sTemp As String\n\n    sTemp = Dir$(sDirectory &amp; sFileSpec)\n    Do While Len(sTemp) &gt; 0\n        cCollection.Add sDirectory &amp; sTemp\n        sTemp = Dir$\n    Loop\nEnd Sub\n</code></pre>\n\n<p>This second way goes through the subfolders as well returning path &amp; name.  For some reason if you change <code>InclSubFolders</code> to False it only returns the name - got to sort that bit out.  </p>\n\n<pre><code>Sub Test2()\n    Dim vFiles As Variant\n    Dim itm As Variant\n\n    vFiles = EnumerateFiles_2(\"C:\\Users\\michal\\SkyDrive\\csv\\bossa\\mstcgl_mst\\\", \"xls*\")\n\n    For Each itm In vFiles\n        Debug.Print itm\n    Next itm\nEnd Sub\n\nPublic Function EnumerateFiles_2(sDirectory As String, _\n            Optional sFileSpec As String = \"*\", _\n            Optional InclSubFolders As Boolean = True) As Variant\n\n    EnumerateFiles_2 = Filter(Split(CreateObject(\"WScript.Shell\").Exec _\n        (\"CMD /C DIR \"\"\" &amp; sDirectory &amp; \"*.\" &amp; sFileSpec &amp; \"\"\" \" &amp; _\n        IIf(InclSubFolders, \"/S \", \"\") &amp; \"/B /A:-D\").StdOut.ReadAll, vbCrLf), \".\")\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 6688323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/04jC5.jpg?s=128&g=1", "display_name": "michal roesler", "link": "https://stackoverflow.com/users/6688323/michal-roesler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1237, "favorite_count": 0, "accepted_answer_id": 44545866, "answer_count": 3, "score": 1, "last_activity_date": 1497452536, "creation_date": 1497445345, "question_id": 44545619, "link": "https://stackoverflow.com/questions/44545619/vba-how-to-extract-all-files-names-from-a-folder-without-using-application-fi", "title": "VBA; how to extract all files names from a folder - without using Application.FileDialog object", "body": "<p>As in the Question: the task is to extract all files names from a folder, but the folder path needs to be hard coded into the macro, to prevent these dialog boxes asking me things and wasting my time.\nI will not change this folder. It will be the same one until the end of time, and I want to extract the files names into the Excel column, starting from second row.\nthis is the folder I want to extract ALL files names from.\n\"C:\\Users\\michal\\SkyDrive\\csv\\bossa\\mstcgl_mst\\\"</p>\n\n<p>this is my portion of code:</p>\n\n<pre><code>Option Explicit\nSub GetFileNames()\nDim axRow As Long          ' inside the Sheet(\"Lista\") row#\nDim xDirectory As String   \nDim xFname As String       ' name of the file    \nDim InitialFoldr$        \nDim start As Double\nDim finish As Double\nDim total_time As Double\n\nstart = Timer\nThisWorkbook.Sheets(\"Lista\").Range(\"D2\").Activate\n  InitialFolder = \"C:\\Users\\michal\\SkyDrive\\csv\\bossa\\mstcgl_mst\"\n  If Right(InitialFolder, 1) &lt;&gt; \"\\\" Then\n     InitialFolder = InitialFolder &amp; \"\\\"\n  End If\n\n  Application.InitialFolder.Show\n\n    If InitialFolder.SelectedItems.Count &lt;&gt; 0 Then    \n       xDirectory = .SelectedItems(1) &amp; \"\\\"  \n         xFname = Dir(xDirectory, vbArchive)   \n          ' Dir's job is to return a string representing\n          ' the name of a file, directory, or an archive that matches a specified pattern.\n            Do While xFname &lt;&gt; \"\"   ' there is already xFname value (1st file name) assigned.\n               ActiveCell.Offset(xRow) = xFname                                        \n               xRow = xRow + 1    ' nast\u0119pny xRow\n               xFname = Dir()    \n            Loop                  \n   End If\n End With\n\n finish = Timer                              ' Set end time.\n total_time = Round(finish - start, 3)       ' Calculate total time.\n MsgBox \"This code ran successfully in \" &amp; total_time &amp; \" seconds\", vbInformation\n\nEnd Sub\n</code></pre>\n\n<p>this is the line that crushes:\n<code>If InitialFolder.SelectedItems.Count &lt;&gt; 0 Then\n     xDirectory = .SelectedItems(1) &amp; \"\\\"</code></p>\n\n<p>And two more important questions in the .png file.\n<a href=\"https://i.stack.imgur.com/yeUMU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yeUMU.png\" alt=\"enter image description here\"></a>\nPlease, respond to them as well - it's very important 4 me.</p>\n\n<p>Or if U guys know any other method to do this faster just don't hesitate and share Your Code with me - I'll be very grateful.</p>\n"}, {"tags": ["vba", "powerpoint", "real-time-clock"], "owner": {"reputation": 11, "user_id": 8111454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c360d2b1ca37ccefd3f333db48b512c?s=128&d=identicon&r=PG&f=1", "display_name": "Devin", "link": "https://stackoverflow.com/users/8111454/devin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2562, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497621073, "creation_date": 1497445318, "last_edit_date": 1497621073, "question_id": 44545607, "link": "https://stackoverflow.com/questions/44545607/vba-code-for-powerpoint-dynamic-clock", "title": "VBA Code for PowerPoint Dynamic Clock", "body": "<p>I want to create a dynamic clock in PowerPoint and have it show up in the same location on all slides. Below is the code I have been working on to create the dynamic clock.</p>\n\n<p>Instead of \"Do Until 1 &lt; 0\", I probably want something along the lines of \"Do Until PowerPoint Exit Slideshow Mode\" but I'm not sure how to do that. </p>\n\n<p>I tried creating a shape in the PowerPoint slide master, but I'm not sure how to define that shape in the Shapes() portion of the code. I've only ever been able to get the clock to run in Shapes (1) and Shapes(2) - i.e. the default text boxes in the slides.</p>\n\n<pre><code>Sub OnSlideShowPageChange()\n  Dim time As Date\n  Dim count As Integer\n\n  time = Now()\n\n  Do Until 1 &lt; 0\n    DoEvents\n\n    With\n      ActivePresentation.Slides(SlideShowWindows(1).View.CurrentShowPosition).Shapes(1).TextFrame.TextRange\n      .Text = Format((Now()), \"hh:mm:ss\")\n    End With\n  Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497444993, "post_id": 44545435, "comment_id": 76081399, "body": "it will be <code>.formula</code>"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 0, "creation_date": 1497445781, "post_id": 44545548, "comment_id": 76082040, "body": "Yes, indeed, that works now! Big thanks for your quick reply :)"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 2, "last_activity_date": 1497445176, "creation_date": 1497445176, "answer_id": 44545548, "question_id": 44545435, "link": "https://stackoverflow.com/questions/44545435/use-of-asterisk-error-13-mismatch-vlookup/44545548#44545548", "title": "Use of asterisk * - Error 13 Mismatch - Vlookup", "body": "<p>Try this:</p>\n\n<pre><code>Range(\"K2:K\" &amp; LastRow).Formula = \"=IF(ISNA(VLOOKUP(\"\"*\"\"&amp;J2&amp;\"\"*\"\",CDL_Greece!C:C,1,0)),J2,VLOOKUP(\"\"*\"\"&amp;J2&amp;\"\"*\"\",CDL_Greece!C:C,1,0))\"\n</code></pre>\n\n<p>If you want quotes <code>\"</code> in your worksheet formula you need to use double quotes <code>\"\"</code> in your code.</p>\n"}], "owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497570642, "creation_date": 1497444923, "last_edit_date": 1497570642, "question_id": 44545435, "link": "https://stackoverflow.com/questions/44545435/use-of-asterisk-error-13-mismatch-vlookup", "title": "Use of asterisk * - Error 13 Mismatch - Vlookup", "body": "<p>I'm struggling with the following issue: I'm trying to insert an asterisk (*) in a formula containing a vlookup function in VBA. I'm getting an error 13 mismatch and I don't know how to solve it. I suppose the format isn't good. Here is my code: </p>\n\n<pre><code>Dim sht As Worksheet, LastRow As Long     \n\nSet sht = ThisWorkbook.Worksheets(\"JDE_Greece\")\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nsht.Activate     \nRange(\"K2:K\" &amp; LastRow).Value = _                        \n     \"=IF(ISNA(VLOOKUP(\"*\"&amp;J2&amp;\"*\",CDL_Greece!C:C,1,0)),J2, VLOOKUP(\"*\"&amp;J2&amp;\"*\",CDL_Greece!C:C,1,0))\"                        \n</code></pre>\n\n<p>I'v seen that we can use the character ~ that would allow to use this asterisk. But it doesn't work on my side.</p>\n\n<p>Does anyone have any clues on this issue?\nThanks in advance :)</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1769, "user_id": 3157310, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/UXDWF.png?s=128&g=1", "display_name": "SaggingRufus", "link": "https://stackoverflow.com/users/3157310/saggingrufus"}, "edited": false, "score": 0, "creation_date": 1497444679, "post_id": 44545298, "comment_id": 76081164, "body": "You may want to check out SE code review: <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> Stack overflow isn&#39;t really supposed to be used for reviewing code."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1497445617, "post_id": 44545298, "comment_id": 76081899, "body": "There is no need to use the FSO at all, there are built in functions that make it easy to load a file into an array with a few lines of code E.g. <a href=\"https://stackoverflow.com/a/11542133/246342\">stackoverflow.com/a/11542133/246342</a>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1497979294, "post_id": 44545298, "comment_id": 76303947, "body": "you can save settings in the registry with SaveSetting and GetSetting <a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/getsetting-function\" rel=\"nofollow noreferrer\">msdn.microsoft.com/VBA/Language-Reference-VBA/articles/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1497978883, "creation_date": 1497978883, "answer_id": 44659296, "question_id": 44545298, "link": "https://stackoverflow.com/questions/44545298/vba-read-and-write-lines-to-text-file/44659296#44659296", "title": "VBA: Read and Write lines to text file", "body": "<p>I would append data to a text file, from the top down, but not overwriting data that already exists in the text file.</p>\n\n<p>'Starting the program and sub procedure to write VBA code to write the data to a text file Append.</p>\n\n<pre><code>Sub VBA_to_append_existing_text_file()\n\n'Declaring the strFile_Path variable as String Data Type to store the text file path.\nDim strFile_Path As String\n\n'Assigning the Existing File path to the variable strFile_Path.\nstrFile_Path = \"C:\\your_path_here\\test.txt\"\n\n'Opening the text file for Append with FileNumber as 1.\nOpen strFile_Path For Append As #1\n\n'Writing to the sample text to the File using FileNumber and Write Command.\nYourValue = Worksheets(\"Sheet1\").Range(\"A1\").Value\nWrite #1, YourValue\n\n'Closing the File using FileNumber.\nClose #1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 7975744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3299b2920c8c47f5c7d4e63613b54275?s=128&d=identicon&r=PG&f=1", "display_name": "Quint", "link": "https://stackoverflow.com/users/7975744/quint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 11196, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1613174780, "creation_date": 1497444554, "question_id": 44545298, "link": "https://stackoverflow.com/questions/44545298/vba-read-and-write-lines-to-text-file", "title": "VBA: Read and Write lines to text file", "body": "<p>I have managed to hack together a function that reads or writes to lines in a text file. I'm using it to save some settings for my application. Just wanting see everyones input and to see if there is a better way to edit a line in the text file. Specifically the part that builds an array to edit lines. This is what I have.</p>\n\n<pre><code>Public ReadOptionsOutput As String\nPublic FSO As New FileSystemObject\nPublic TxtFileOutPut As String\n\nPublic Function TxtFile(WritetoFile As Boolean, FileDir As String, line As \nVariant, What As String)\nDim FileContent() As Variant\nDim Idx As Integer\nDim Txtstream As Object\n\n'////////////////Write to file///////////////\nIf WritetoFile = True Then\nSet Txtstream = FSO.OpenTextFile(FileDir, ForReading, False)\nIdx = 0\n\nOn Error GoTo Err1 'To catch the last blank line. Dont see another way to \nsee if .ReadLine is blank\nDo 'Build an array to edit lines in Text file\n    Idx = Idx + 1\n    ReDim Preserve FileContent(1 To Idx)\n    FileContent(Idx) = Txtstream.ReadLine\nLoop\nErr1:\nOpen FileDir For Output As #1: Close #1 'Delet all text inside of File\nSet Txtstream = Nothing\nSet Txtstream = FSO.OpenTextFile(FileDir, ForAppending, False)\nFileContent(line) = What 'Edit line in the array\n    For Idx = 1 To Idx - 1\n        Txtstream.WriteLine (FileContent(Idx)) 'Write everything back to \ntextfile\n    Next\n\n'/////////////////////Read file///////////////\nElseIf WritetoFile = False Then 'Reads Line in file only\nSet Txtstream = FSO.OpenTextFile(FileDir, ForReading, False)\nNextLine = 1\n\nDo 'Loop thru to selected line and read it\n    TxtLine = Txtstream.ReadLine\n    If NextLine = line Then\n        TxtFileOutPut = TxtLine\n    End If\n    NextLine = NextLine + 1\nLoop Until NextLine &gt; line\nEnd If\nTxtstream.Close\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 681, "user_id": 5686960, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8ed1f6bfa4e7ecb17577af34fad4c0dc?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/5686960/luke"}, "edited": false, "score": 2, "creation_date": 1497443603, "post_id": 44544907, "comment_id": 76080338, "body": "Please see <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1497443904, "creation_date": 1497443904, "answer_id": 44545039, "question_id": 44544907, "link": "https://stackoverflow.com/questions/44544907/hi-im-and-able-to-send-notifications-via-email-from-excel-using-vba-now-im-tryin/44545039#44545039", "title": "Hi im and able to send notifications via email from excel using VBA now im trying to get the information that was updated into th", "body": "<p>This will show you how to convert a Range to HTML (for the body of an Email)</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/s1/outlook/bmail2.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s1/outlook/bmail2.htm</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8160301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e69bd21e1377d2534d94f22630c38c7?s=128&d=identicon&r=PG", "display_name": "Christine01", "link": "https://stackoverflow.com/users/8160301/christine01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1497443904, "creation_date": 1497443519, "question_id": 44544907, "link": "https://stackoverflow.com/questions/44544907/hi-im-and-able-to-send-notifications-via-email-from-excel-using-vba-now-im-tryin", "title": "Hi im and able to send notifications via email from excel using VBA now im trying to get the information that was updated into th", "body": "<p>Hi im and able to send notifications via email from excel using VBA now im trying to get the information that was updated into the body of the email(objMessage.HTMLBody = ) in my case it will always be Sheet1 (A5:K5) any advise?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1497442892, "post_id": 44544629, "comment_id": 76079835, "body": "It works ! I had a problem with copy celles in the new column, thank you !"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 2, "creation_date": 1497442936, "post_id": 44544629, "comment_id": 76079859, "body": "@babou your&#39;e welcome :) feel free to mark as &quot;Answer&quot;"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 4, "last_activity_date": 1497442734, "creation_date": 1497442734, "answer_id": 44544629, "question_id": 44544555, "link": "https://stackoverflow.com/questions/44544555/if-my-cells-have-no-color-then-copy-it/44544629#44544629", "title": "If my cells have no color, then copy it", "body": "<p>The code below loops through all the cells in <code>Range(\"C8:C17\")</code>, and checks if the current cell is not colored. If it's not colores, then it pastes it to column A at the next empty row (starting from the first row).</p>\n\n<pre><code>Option Explicit\n\nSub CopyColCells()\n\nDim a As Long\nDim C As Range\n\na = 1 'we set the row where we start filling in the single sames\nFor Each C In Range(\"C8:C17\")\n    If C.Interior.ColorIndex = xlColorIndexNone Then\n       Cells(a, \"A\").Value = C.Value\n       a = a + 1\n    End If\nNext C\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 0, "accepted_answer_id": 44544629, "answer_count": 1, "score": 0, "last_activity_date": 1534852319, "creation_date": 1497442542, "last_edit_date": 1531164843, "question_id": 44544555, "link": "https://stackoverflow.com/questions/44544555/if-my-cells-have-no-color-then-copy-it", "title": "If my cells have no color, then copy it", "body": "<p>Good morning,</p>\n\n<p>I have a range in C8:C17\nsome of cells are in red, and some without color.\nI want that cells without colors are transferred into column A.</p>\n\n<p>This is my code :</p>\n\n<pre><code>Dim a As Long\n    a = 1 'we set the row where we start filling in the single sames\n     If Range(\"C8:C17\").Interior.ColorIndex = xlColorIndexNone Then\n        Cells(a, \"A\").Value = Range(\"C8:C17\").Value\n        a = a + 1\n     End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1497442147, "post_id": 44544058, "comment_id": 76079283, "body": "Why not simply add an <code>if</code> statment before <code>zWeeks = (Cells(r, &quot;E&quot;) - Cells(r, &quot;D&quot;)) &#47; 7 </code>? Something like <code>if Cells(r, &quot;E&quot;)=&quot;&quot; then zText =&quot;Project not started&quot; else RestOfYourCode</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1497450958, "post_id": 44544391, "comment_id": 76086184, "body": "@Komal Rohilla did code help? Feedback is always welcome."}], "tags": [], "owner": {"reputation": 2883, "user_id": 641426, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TokCH.jpg?s=128&g=1", "display_name": "Pablo notPicasso", "link": "https://stackoverflow.com/users/641426/pablo-notpicasso"}, "is_accepted": false, "score": 0, "last_activity_date": 1497469259, "last_edit_date": 1497469259, "creation_date": 1497442150, "answer_id": 44544391, "question_id": 44544058, "link": "https://stackoverflow.com/questions/44544058/comparing-dates-in-two-columns-and-highlighting-the-cell/44544391#44544391", "title": "Comparing dates in two columns and highlighting the cell", "body": "<p>Check:</p>\n\n<pre><code>Sub dateCompare()\nzLastRow = Range(\"D\" &amp; Rows.Count).End(xlUp).Row    'last data row\n\n'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nFor r = 2 To zLastRow\n    If IsEmpty(Cells(r, \"E\").Value) Then 'check if column is empty\n        zColour = xlNone\n        zText = \" check dates\"\n    else\n        zWeeks = (Cells(r, \"E\") - Cells(r, \"D\")) / 7        'date difference in weeks\n\n        Select Case zWeeks\n            Case Is &gt; 4                                         'later than 4 weeks\n               zColour = vbRed\n               zText = \"Project delayed \" &amp; Int(zWeeks) &amp; \" weeks\"\n            Case 2 To 4                                         'between 2 and 4 weeks\n                zColour = vbYellow\n                zText = \"Project ongoing\"\n            Case Is &lt; 2                                         'less than 2 weeks\n                zColour = vbGreen\n                zText = \"Project On-Time\"\n        End Select\n    End if\n\n    Cells(r, \"D\").Interior.Color = zColour              'set cell background colour\n    Cells(r, \"F\") = zText                               'set project status\n\nNext\n'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8160174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c1a5e5390e7cda2ee7b718572beab0d?s=128&d=identicon&r=PG&f=1", "display_name": "Komal Rohilla", "link": "https://stackoverflow.com/users/8160174/komal-rohilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497469259, "creation_date": 1497441273, "last_edit_date": 1497441822, "question_id": 44544058, "link": "https://stackoverflow.com/questions/44544058/comparing-dates-in-two-columns-and-highlighting-the-cell", "title": "Comparing dates in two columns and highlighting the cell", "body": "<p>I'm comparing the two dates in the two columns (D and E).\nThe Dates in column D are source dates and the dates in column E are start date of the project.</p>\n\n<p>I'm calculating the difference in two dates as weeks and pasting the result in the column F and highlighting it accordingly.</p>\n\n<p>I have 4 cases with me:</p>\n\n<ul>\n<li>Case 1: If the sourcing date is > 4 weeks of start date then the status is <em>\"Project delayed\"</em>.</li>\n<li>Case 2: If the source date is &lt; 2 weeks of the start date then the status is \"<em>Project on time</em>\".</li>\n<li>Case 3: If the source date is &lt; 4 weeks, > 2 weeks of the start date the status is \"<em>Project remaining</em>\".</li>\n</ul>\n\n<p>I have achieved the tree cases.</p>\n\n<ul>\n<li>Case 4: there is a possibility that in some cases the column E does not have any date and it is empty. In this Situation, I would like to have an if case, that says \"<em>Project not started</em>\".</li>\n</ul>\n\n<p>I tried it as Null but, I could not figure out, why this case 4 was not working. </p>\n\n<pre><code>Sub dateCompare()\n    zLastRow = Range(\"D\" &amp; Rows.Count).End(xlUp).Row   'last data row\n\n    '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    For r = 2 To zLastRow\n        zWeeks = (Cells(r, \"E\") - Cells(r, \"D\")) / 7   'date difference in weeks\n\n        Select Case zWeeks\n            Case Is &gt; 4                                'later than 4 weeks\n                zColour = vbRed\n                zText = \"Project delayed \" &amp; Int(zWeeks) &amp; \" weeks\"\n\n            Case 2 To 4                                'between 2 and 4 weeks\n                zColour = vbYellow\n                zText = \"Project ongoing\"\n\n            Case Is &lt; 2                                'less than 2 weeks\n                zColour = vbGreen\n                zText = \"Project On-Time\"\n\n            Case Else                                  'in case of duff data..\n                zColour = xlNone\n                zText = \" check dates\"\n        End Select\n\n        Cells(r, \"D\").Interior.Color = zColour         'set cell background colour\n        Cells(r, \"F\") = zText                          'set project status\n    Next\n    '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nEnd Sub\n</code></pre>\n\n<p>Kindly help me to solve this issue.<br>\nRegards,\nMikz</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497441430, "post_id": 44544094, "comment_id": 76078689, "body": "You could use the same <code>LEFT</code> approach in conditional formatting also."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497441566, "post_id": 44544094, "comment_id": 76078806, "body": "I read <code>I have tried conditional formatting already</code> as tried but failed.  No worries."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1497441486, "last_edit_date": 1497441486, "creation_date": 1497441370, "answer_id": 44544094, "question_id": 44543918, "link": "https://stackoverflow.com/questions/44543918/comparing-two-columns-with-id/44544094#44544094", "title": "Comparing two columns with ID", "body": "<p>Try the code below:</p>\n\n<pre><code>Option Explicit\n\nSub RangeTest()\n\nDim targetWorksheet As Worksheet\nDim i As Long\nDim totalrows As Integer\n\nFor i = 2 To 112\n    Set targetWorksheet = Worksheets(\"Preparation sheet\")\n    With targetWorksheet\n        If Left(.Cells(i, 1), 11) = Left(.Cells(i, 2), 11) Then\n            .Cells(i, 3) = \"Yes\"\n            .Cells(i, 3).Interior.Color = RGB(0, 255, 0)\n        Else\n            .Cells(i, 3) = \"NO\"\n            .Cells(i, 3).Interior.Color = RGB(255, 0, 0)\n        End If\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 44544094, "answer_count": 1, "score": 1, "last_activity_date": 1593677322, "creation_date": 1497440846, "last_edit_date": 1593677322, "question_id": 44543918, "link": "https://stackoverflow.com/questions/44543918/comparing-two-columns-with-id", "title": "Comparing two columns with ID", "body": "<p>I am comparing two columns A and B. \nThe columns A and B contains the ID from a Database. </p>\n\n<p>The ID is 13 digits long, but most of the cases they are 11 digits long. </p>\n\n<ol>\n<li>Case 1: If column A has an ID ABC02369000 and column B has an ID ABC02369000 the result is match.</li>\n<li>Case 2: If column A has an ID ABC14285500 and column B has an ID ABC1428550000 the result is still match.</li>\n<li>Case 3: If column A has an ID ABC15184200 and column B has an ID ABC15144200 the result is no match.</li>\n</ol>\n\n<p>I would like to have a code for this criteria. If it is matched, then highlighted as green, else as red.</p>\n\n<p>I have tried conditional formatting already. I would be glad, if I can have it in code. </p>\n\n<pre><code>Sub RangeTest()\n    Dim targetWorksheet As Worksheet\n    Dim i As Long\n    Dim totalrows As Integer\n\n    For i = 2 To 112\n        Set targetWorksheet = Worksheets(\"Preparation sheet\")\n        With targetWorksheet\n            Cells(i, 3) = IIf(Cells(i, 1) = Cells(i, 2), \"Yes\", \"NO\")\n            Cells(i, 3).Interior.Color = IIf(Cells(i, 3) = \"Yes\", RGB(0, 255, 0), RGB(255, 0, 0))\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8160148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b21b3768057ff5f478cafd8a24e633?s=128&d=identicon&r=PG&f=1", "display_name": "Junker", "link": "https://stackoverflow.com/users/8160148/junker"}, "edited": false, "score": 0, "creation_date": 1497530153, "post_id": 44543804, "comment_id": 76123861, "body": "Hi,  No, the chart in excel will update based on variables and user input. So a certain value will change the chart configuration and output, and thumbnails associated.   What I am trying to do is take that entire chart (and anything inside it) and export as a .png/.jpeg etc. into a PowerPoint slide. I&#39;ve been looking at other scripts and I seemed to get error messages I can&#39;t diagnose, but with this one it got part of the chart, only an element, but not the whole thing.   Junker"}], "tags": [], "owner": {"reputation": 160, "user_id": 7383531, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fb21e7252e649fdacadf13131c2c0239?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/7383531/james"}, "is_accepted": false, "score": 0, "last_activity_date": 1497440536, "creation_date": 1497440536, "answer_id": 44543804, "question_id": 44543706, "link": "https://stackoverflow.com/questions/44543706/exporting-chart-from-excel-to-powerpoint-using-vba/44543804#44543804", "title": "Exporting chart from Excel to Powerpoint using VBA", "body": "<p>What exactly are you trying to do?</p>\n\n<p>If you are just looking to display a chart that updates based on the content of your excel workbook you can simply copy the chart across and it creates a link between the two. When both your presentation and workbook are open it will update the chart automatically with no need for VBA.</p>\n"}], "owner": {"reputation": 11, "user_id": 8160148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b21b3768057ff5f478cafd8a24e633?s=128&d=identicon&r=PG&f=1", "display_name": "Junker", "link": "https://stackoverflow.com/users/8160148/junker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497440559, "creation_date": 1497440279, "last_edit_date": 1497440559, "question_id": 44543706, "link": "https://stackoverflow.com/questions/44543706/exporting-chart-from-excel-to-powerpoint-using-vba", "title": "Exporting chart from Excel to Powerpoint using VBA", "body": "<p>So after a bit of digging I got some help to find a code to export a chart from Excel to Powerpoint, problem is it is only selecting an object.  </p>\n\n<pre><code>Sub ertert()\n    With New PowerPoint.Application\n        With .Presentations.Add\n            With .Slides.Add(1, 12)\n                ActiveSheet.ChartObjects(1).CopyPicture xlPrinter, xlPicture\n                .Shapes.Paste\n                .Shapes(1).Select\n                .Application.ActiveWindow.Selection.ShapeRange.Align msoAlignMiddles, True\n                .Application.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\n            End With\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>the object it's selecting is a chart/vlookup image result inside of a larger chart (the object itself is named) so basically it's only getting a small part of the item itself. </p>\n\n<p>Question is where I went wrong in having it only select an item? Also I would like to know how to modify this code to add to an existing Powerpoint (assuming the existing one is already open).  </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1497883108, "creation_date": 1497883108, "answer_id": 44633461, "question_id": 44543537, "link": "https://stackoverflow.com/questions/44543537/automatically-saving-real-time-data-in-stack-in-excel/44633461#44633461", "title": "Automatically saving Real time Data in stack in excel", "body": "<p>I would append data to a text file, all day long, and then do some analytics on at, maybe at the end of the day, or as needed.</p>\n\n<pre><code>'Starting the program and sub procedure to write VBA code to write the data to a text file Append.\nSub VBA_to_append_existing_text_file()\n\n'Declaring the strFile_Path variable as String Data Type to store the text file path.\nDim strFile_Path As String\n\n'Assigning the Existing File path to the variable strFile_Path.\nstrFile_Path = \"C:\\your_path_here\\test.txt\"\n\n'Opening the text file for Append with FileNumber as 1.\nOpen strFile_Path For Append As #1\n\n'Writing to the sample text to the File using FileNumber and Write Command.\nYourValue = Worksheets(\"Sheet1\").Range(\"A1\").Value\nWrite #1, YourValue\n\n'Closing the File using FileNumber.\nClose #1\n\nEnd Sub\n</code></pre>\n\n<p>Run the Macro every 2 minutes, or however frequently you want.</p>\n\n<pre><code>Sub my_Procedure()\n    MsgBox \"hello world\"        \n    Call test ' for starting timer again\nEnd Sub\n\nSub test()\n    Application.OnTime Now + TimeValue(\"00:02:00\"), \"my_Procedure\"\nEnd Sub\n</code></pre>\n\n<p>You can use Excel or R for the analytics.</p>\n"}], "owner": {"reputation": 1, "user_id": 8160135, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AlELMpuB204/AAAAAAAAAAI/AAAAAAAAADg/3Fg-VoSx23s/photo.jpg?sz=128", "display_name": "rupesh pawar", "link": "https://stackoverflow.com/users/8160135/rupesh-pawar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 798, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1497883108, "creation_date": 1497439802, "last_edit_date": 1531161705, "question_id": 44543537, "link": "https://stackoverflow.com/questions/44543537/automatically-saving-real-time-data-in-stack-in-excel", "title": "Automatically saving Real time Data in stack in excel", "body": "<p>I am not a programmer. I need help with excel. I have table in excel which linked with web-site and display values in cells on real time basis.  I am trying to save the value of a cell which changes every after 2 Minutes. I want to save the value of the cell in another cell automatically before it changes to another value in next minute(before Automatic refreshing done in excel). since the cell is receiving real time data. I want to save the old data and use it for calculations. I want to do it automatically for me. How do I do that using excel? Your help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19, "user_id": 6743256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e60d776d46fb6ff13be8f9c407f2bf2a?s=128&d=identicon&r=PG&f=1", "display_name": "Nilesh Pawar", "link": "https://stackoverflow.com/users/6743256/nilesh-pawar"}, "edited": false, "score": 0, "creation_date": 1497439797, "post_id": 44543504, "comment_id": 76077480, "body": "Set i = considered as Date. Getting an error With Range(i &amp; Lr) .FormulaR1C1 = _     &quot;=IFERROR(VLOOKUP(RC[-22],&#39;Credit Pivot&#39;!C[-22]:C[-21],2,0),&quot;&quot; &quot;&quot;)&quot;. I am unable set &quot;i&quot;."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497451891, "post_id": 44543504, "comment_id": 76086863, "body": "<code>1</code> How have you declared i? <code>2</code> What is the value of i <code>3</code> What is the error that you are getting?"}, {"owner": {"reputation": 19, "user_id": 6743256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e60d776d46fb6ff13be8f9c407f2bf2a?s=128&d=identicon&r=PG&f=1", "display_name": "Nilesh Pawar", "link": "https://stackoverflow.com/users/6743256/nilesh-pawar"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497507666, "post_id": 44543504, "comment_id": 76109303, "body": "1)No. 2)Value of i is Date.3)I am getting an error for  With Range(i &amp; Lr)             .FormulaR1C1 = _             &quot;=IFERROR(VLOOKUP(RC[-22],&#39;Credit Pivot&#39;!C[-22]:C[-21],2,0),&quot;&quot; &quot;&quot;)&quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497507839, "post_id": 44543504, "comment_id": 76109381, "body": "Please reread my 3 question and give exact answers. Your answers are very vague. Step though the code to give me the exact value and error message"}, {"owner": {"reputation": 19, "user_id": 6743256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e60d776d46fb6ff13be8f9c407f2bf2a?s=128&d=identicon&r=PG&f=1", "display_name": "Nilesh Pawar", "link": "https://stackoverflow.com/users/6743256/nilesh-pawar"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497512130, "post_id": 44543504, "comment_id": 76111817, "body": "Getting an error message &quot;Method &#39;Range&#39; of object&#39;_Global&#39; failed&quot;"}, {"owner": {"reputation": 19, "user_id": 6743256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e60d776d46fb6ff13be8f9c407f2bf2a?s=128&d=identicon&r=PG&f=1", "display_name": "Nilesh Pawar", "link": "https://stackoverflow.com/users/6743256/nilesh-pawar"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497514214, "post_id": 44543504, "comment_id": 76113170, "body": "1) Yes, Set i = Workbooks(&quot;June-2017&quot;).Sheets(&quot;Daily Match&quot;).Range(&quot;M12&quot;)"}, {"owner": {"reputation": 19, "user_id": 6743256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e60d776d46fb6ff13be8f9c407f2bf2a?s=128&d=identicon&r=PG&f=1", "display_name": "Nilesh Pawar", "link": "https://stackoverflow.com/users/6743256/nilesh-pawar"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497677060, "post_id": 44543504, "comment_id": 76189896, "body": "1 question answer is &quot;Yes&quot;,"}, {"owner": {"reputation": 19, "user_id": 6743256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e60d776d46fb6ff13be8f9c407f2bf2a?s=128&d=identicon&r=PG&f=1", "display_name": "Nilesh Pawar", "link": "https://stackoverflow.com/users/6743256/nilesh-pawar"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1497677153, "post_id": 44543504, "comment_id": 76189914, "body": "2nd question answer is Date range i.e .Range(&quot;M12&quot;) which i have given on sheet (&quot;Daily Match&quot;)"}], "owner": {"reputation": 19, "user_id": 6743256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e60d776d46fb6ff13be8f9c407f2bf2a?s=128&d=identicon&r=PG&f=1", "display_name": "Nilesh Pawar", "link": "https://stackoverflow.com/users/6743256/nilesh-pawar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497439883, "creation_date": 1497439725, "last_edit_date": 1531164843, "question_id": 44543504, "link": "https://stackoverflow.com/questions/44543504/want-to-do-vlookup-with-date-range-in-column-wise-getting-an-error-message", "title": "Want to do vlookup with Date range in column wise, getting an error message", "body": "<pre><code>Set i = Workbooks(\"June-2017\").Sheets(\"Daily Match\").Range(\"M12\")\n\nWorkbooks(\"June-2017\").Sheets(\"Retail Network\").Activate\n\nWith ActiveSheet\n    If .AutoFilterMode Then AutoFilterMode = False\n    With .Cells(1, 1).CurrentRegion\n        'lColumn = ws.UsedRange.Columns.Count\n        Lr = Worksheets(\"Retail Network\").Cells(Rows.Count, \"A\").End(xlUp).Row\n        'Lc = Worksheets(\"Retail Network\").Cells(Columns.Count,\"1R\").End(xlLeft).Column\n\n        With Range(i &amp; Lr)\n            .FormulaR1C1 = _\n            \"=IFERROR(VLOOKUP(RC[-22],'Credit Pivot'!C[-22]:C[-21],2,0),\"\" \"\")\"\n            ActiveWorkbook.RefreshAll\n            .Value = .Value\n        End With\n    End With\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1497468770, "post_id": 44543401, "comment_id": 76096875, "body": "Maybe not possible, review <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834420.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff834420.aspx</a>. See the Note."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1497469273, "post_id": 44543401, "comment_id": 76097127, "body": "Or maybe have to go &#39;old school&#39; route <a href=\"https://msdn.microsoft.com/en-us/library/office/ff862548.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff862548.aspx</a>"}], "owner": {"reputation": 159, "user_id": 5179321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ec2c077f8c8bcb3d8313897477a568c?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5179321/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497446636, "creation_date": 1497439455, "last_edit_date": 1531164843, "question_id": 44543401, "link": "https://stackoverflow.com/questions/44543401/vba-to-clear-files-from-microsoft-access", "title": "VBA to clear files from microsoft access", "body": "<p>Please advise as to how to remove recent file history from Microsoft access. Below coding is clearing history from excel but I want to clear it from MS access.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim i As Integer\n  For i = 1 To Application.RecentFiles.Count\n   Application.RecentFiles(i).Delete\n  Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1497439871, "post_id": 44543248, "comment_id": 76077543, "body": "Which module do you have this in?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1497440998, "post_id": 44543248, "comment_id": 76078344, "body": "Macro security settings different on the remote machine?"}], "owner": {"reputation": 33, "user_id": 8148827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b24bd843584742305b4d2e1650f4e61?s=128&d=identicon&r=PG&f=1", "display_name": " kumar", "link": "https://stackoverflow.com/users/8148827/kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497439228, "creation_date": 1497439038, "last_edit_date": 1531161705, "question_id": 44543248, "link": "https://stackoverflow.com/questions/44543248/excel-macro-is-closing-automatically", "title": "Excel macro is closing automatically", "body": "<p>When I try to run the macro code, it is closing automatically without executing the code. This issue is only in my remote machine not in the local.\nIs this issue relates with Excel version or my remote machine. Can anyone help me on this issue.</p>\n\n<p>For example sample code:</p>\n\n<pre><code>Sub test\n    MsgBox \"a\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497438478, "post_id": 44542919, "comment_id": 76076480, "body": "show your table structure and your attempts so far."}, {"owner": {"reputation": 2591, "user_id": 885838, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/kYqCd.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/885838/vlad"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497438884, "post_id": 44542919, "comment_id": 76076783, "body": "I added picture @Nathan_Sav"}, {"owner": {"reputation": 2591, "user_id": 885838, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/kYqCd.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/885838/vlad"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497438910, "post_id": 44542919, "comment_id": 76076800, "body": "I will close the question, its just I don&#39;t know where to search for info."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497439530, "post_id": 44542919, "comment_id": 76077281, "body": "<code>cint([tipprod])</code> would be a good start <code>cint([tpprod]) + DMAX()</code> would be another idea, so if max tipprod is 3, this would start at 4?"}, {"owner": {"reputation": 2591, "user_id": 885838, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/kYqCd.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/885838/vlad"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497439720, "post_id": 44542919, "comment_id": 76077426, "body": "@Nathan_Sav the square brackets show an input window. I don&#39;t need input window."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1497439859, "post_id": 44542919, "comment_id": 76077530, "body": "see edit, it&#39;s a misspelt field name, so dome research on this to assist you, I wont do it so you can copy verbatim, you&#39;ll need to use this to further your own knowledge to solve."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1497447655, "creation_date": 1497447655, "answer_id": 44546529, "question_id": 44542919, "link": "https://stackoverflow.com/questions/44542919/how-to-generate-incremental-numbers-in-query-access-2000/44546529#44546529", "title": "How to generate incremental numbers in query, Access 2000?", "body": "<p>You can use this function which if for exactly the purpose. See in-line comments for typical usage:</p>\n\n<pre><code>Public Function RowCounter( _\n  ByVal strKey As String, _\n  ByVal booReset As Boolean, _\n  Optional ByVal strGroupKey As String) _\n  As Long\n\n' Builds consecutive RowIDs in select, append or create query\n' with the possibility of automatic reset.\n' Optionally a grouping key can be passed to reset the row count\n' for every group key.\n'\n' Usage (typical select query):\n'   SELECT RowCounter(CStr([ID]),False) AS RowID, *\n'   FROM tblSomeTable\n'   WHERE (RowCounter(CStr([ID]),False) &lt;&gt; RowCounter(\"\",True));\n'\n' Usage (with group key):\n'   SELECT RowCounter(CStr([ID]),False,CStr[GroupID])) AS RowID, *\n'   FROM tblSomeTable\n'   WHERE (RowCounter(CStr([ID]),False) &lt;&gt; RowCounter(\"\",True));\n'\n' The Where statement resets the counter when the query is run\n' and is needed for browsing a select query.\n'\n' Usage (typical append query, manual reset):\n' 1. Reset counter manually:\n'   Call RowCounter(vbNullString, False)\n' 2. Run query:\n'   INSERT INTO tblTemp ( RowID )\n'   SELECT RowCounter(CStr([ID]),False) AS RowID, *\n'   FROM tblSomeTable;\n'\n' Usage (typical append query, automatic reset):\n'   INSERT INTO tblTemp ( RowID )\n'   SELECT RowCounter(CStr([ID]),False) AS RowID, *\n'   FROM tblSomeTable\n'   WHERE (RowCounter(\"\",True)=0);\n'\n' 2002-04-13. Cactus Data ApS. CPH\n' 2002-09-09. Str() sometimes fails. Replaced with CStr().\n' 2005-10-21. Str(col.Count + 1) reduced to col.Count + 1.\n' 2008-02-27. Optional group parameter added.\n' 2010-08-04. Corrected that group key missed first row in group.\n\n  Static col      As New Collection\n  Static strGroup As String\n\n  On Error GoTo Err_RowCounter\n\n  If booReset = True Then\n    Set col = Nothing\n  ElseIf strGroup &lt;&gt; strGroupKey Then\n    Set col = Nothing\n    strGroup = strGroupKey\n    col.Add 1, strKey\n  Else\n    col.Add col.Count + 1, strKey\n  End If\n\n  RowCounter = col(strKey)\n\nExit_RowCounter:\n  Exit Function\n\nErr_RowCounter:\n  Select Case Err\n    Case 457\n      ' Key is present.\n      Resume Next\n    Case Else\n      ' Some other error.\n      Resume Exit_RowCounter\n  End Select\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2591, "user_id": 885838, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/kYqCd.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/885838/vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "accepted_answer_id": 44546529, "answer_count": 1, "score": 0, "last_activity_date": 1497447655, "creation_date": 1497438113, "last_edit_date": 1497438862, "question_id": 44542919, "link": "https://stackoverflow.com/questions/44542919/how-to-generate-incremental-numbers-in-query-access-2000", "title": "How to generate incremental numbers in query, Access 2000?", "body": "<p>I need to create query in Access 2000, but I want my first column to be generated sequence of incremental numbers, like 1, 2, 3, 4 etc... \nI plan to append this to a query so that I can then generate good report. </p>\n\n<p>How can i do that, how should I use expression builder, some example of it?</p>\n\n<p>Also some good tutorials on Expression Builder would be quite useful?</p>\n\n<p><a href=\"https://i.stack.imgur.com/gtFXE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gtFXE.png\" alt=\"query access 2000\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1497436574, "post_id": 44542158, "comment_id": 76075028, "body": "Are the files on a local drive like  <i>*C:*</i>  or on a network drive like <i>*\\\\somewhere\\*</i> ??"}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 1, "creation_date": 1497437858, "post_id": 44542158, "comment_id": 76076036, "body": "what is the value in cell <code>B5,B6,B7</code>? are you including <code>&quot;\\&quot;</code> between folderpath and filepath? is file name with its extension?"}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1497506855, "post_id": 44542158, "comment_id": 76108949, "body": "I realised I was not adding the &quot;\\&quot; at the end of the folder path."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 1, "last_activity_date": 1497438764, "creation_date": 1497438764, "answer_id": 44543145, "question_id": 44542158, "link": "https://stackoverflow.com/questions/44542158/copying-file-from-one-destination-folder-to-another/44543145#44543145", "title": "Copying file from one destination folder to another", "body": "<p>when using <code>sSFolder &amp; sFile</code> make sure you have a \"\\\" between the 2 variables, like this</p>\n\n<pre><code>sSFolder &amp; \"\\\" &amp; sFile\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 732, "user_id": 3025905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2fa2b33fcfe80d872becd5026ebb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "PankajKushwaha", "link": "https://stackoverflow.com/users/3025905/pankajkushwaha"}, "is_accepted": false, "score": 0, "last_activity_date": 1497439653, "creation_date": 1497439653, "answer_id": 44543477, "question_id": 44542158, "link": "https://stackoverflow.com/questions/44542158/copying-file-from-one-destination-folder-to-another/44543477#44543477", "title": "Copying file from one destination folder to another", "body": "<p>Use path separator:</p>\n\n<pre><code>If Not FSO.FileExists(sSFolder &amp; Application.PathSeparator &amp; sFile) Then\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 44543145, "answer_count": 2, "score": 1, "last_activity_date": 1497439653, "creation_date": 1497436183, "question_id": 44542158, "link": "https://stackoverflow.com/questions/44542158/copying-file-from-one-destination-folder-to-another", "title": "Copying file from one destination folder to another", "body": "<p>I am currently trying to copy a file from one folder to another specified folder using Excel VBA Macro,my data is on Sheet 1 on Excel, I've set my file name to be on cell B5, the source folder is on B6, and the destination folder is on cell B7. This is my code below :</p>\n\n<pre><code>'In this Example I am Copying the File From one loaction to another location\n'as per the details specified in the Worksheet.\nSub sbCopyingAFileReadFromSheet()\n'Declaration\nDim FSO\nDim sFile As String\nDim sSFolder As String\nDim sDFolder As String\n\nsFile = Sheets(\"Sheet1\").Range(\"B5\")\n\nsSFolder = Sheets(\"Sheet1\").Range(\"B6\")\n\nsDFolder = Sheets(\"Sheet1\").Range(\"B7\")\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nIf Not FSO.FileExists(sSFolder &amp; sFile) Then\nMsgBox \"Specified File Not Found in Source Folder\", vbInformation, \"Not Found\"\n\nElseIf Not FSO.FileExists(sDFolder &amp; sFile) Then\nFSO.CopyFile (sSFolder &amp; sFile), sDFolder, True\nMsgBox \"Specified File Copied to Destination Folder Successfully\", vbInformation, \"Done!\"\nElse\nMsgBox \"Specified File Already Exists In The Destination Folder\", vbExclamation, \"File Already Exists\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>but a \"Specified File Not Found in Source Folder\" error message keeps on popping up even though the file is in the source folder. Please assist</p>\n"}, {"tags": ["xml", "vba", "infopath"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1497640577, "creation_date": 1497640577, "answer_id": 44596469, "question_id": 44541781, "link": "https://stackoverflow.com/questions/44541781/download-infopath-attachment-into-harddrive-with-vba/44596469#44596469", "title": "Download Infopath Attachment into harddrive with VBA", "body": "<p>What do you mean 'download'?  From the web?  Try this.</p>\n\n<pre><code>Sub Test()\n Dim FileNum As Long\n Dim FileData() As Byte\n Dim MyFile As String\n Dim WHTTP As Object\n\n On Error Resume Next\n Set WHTTP = CreateObject(\"WinHTTP.WinHTTPrequest.5\")\n If Err.Number &lt;&gt; 0 Then\n Set WHTTP = CreateObject(\"WinHTTP.WinHTTPrequest.5.1\")\n End If\n On Error GoTo 0\n\n MyFile = \"website xxxx.com\"\n\n WHTTP.Open \"GET\", MyFile, False\n WHTTP.Send here is where I stop. This is the error message:\n \"Run-time error '-2147012867 (80072efd)':\nA connection with the server could not be established\"\n FileData = WHTTP.ResponseBody\n Set WHTTP = Nothing\n\n If Dir(\"c:\\test\", vbDirectory) = Empty Then MkDir \"c:\\test\"\n\n FileNum = FreeFile\n Open \"the file I downloaded \" For Binary Access Write As #FileNum\n Put #FileNum, 1, FileData\n Close #FileNum\n\n MsgBox \"Open the folder [ c:\\test] for the downloaded file...\"\n End Sub\n</code></pre>\n\n<p>Also, take a look at this.</p>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/en-US/bd0ee306-7bb5-4ce4-8341-edd9475f84ad/excel-2007-use-vba-to-download-save-csv-from-url\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/bd0ee306-7bb5-4ce4-8341-edd9475f84ad/excel-2007-use-vba-to-download-save-csv-from-url</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8159749, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EnhI_uf0_IM/AAAAAAAAAAI/AAAAAAAAAD4/UI5YOfFwE6w/photo.jpg?sz=128", "display_name": "Desmond Yeow", "link": "https://stackoverflow.com/users/8159749/desmond-yeow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497640577, "creation_date": 1497435167, "question_id": 44541781, "link": "https://stackoverflow.com/questions/44541781/download-infopath-attachment-into-harddrive-with-vba", "title": "Download Infopath Attachment into harddrive with VBA", "body": "<p>I have about 1000 xml infopath document that contains attachments in it. I'm looking for a way to download the infopath attachments into my drive through VBA, but I couldn't find any lead on this. Any code or tutorial will be appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1497436243, "post_id": 44541780, "comment_id": 76074795, "body": "The <code>&gt;</code> symbol means <code>greater than</code>, not <code>less than</code>. If you enter <code>&gt;5</code> it will mean <code>greater than 5</code>, not <code>less than 5</code>. Apart from these basics of understanding the symbols for the operators, you don&#39;t specify what unit the <code>5</code> should be applied to. Years or months? The data architecture in this sheet is very unfortunate, especially since there is not even a space between the number and the unit text. Who creates such bad data??? And why??"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1497436247, "post_id": 44541780, "comment_id": 76074802, "body": "It would be so much easier to use a whole number for months, like 38 for three years and two months, but at least determine the duration with a consistent unit. Using a text field like this for a value that can be expressed by a number is -- well -- very unwise. You would be much better off changing the way the duration is stored, than trying to find a complicated VBA routine that will splice the text back into a numeric value."}, {"owner": {"reputation": 11, "user_id": 7064123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DeGKbi12e5M/AAAAAAAAAAI/AAAAAAAAD_Q/ypjbzYSPsUA/photo.jpg?sz=128", "display_name": "Bibin Biju", "link": "https://stackoverflow.com/users/7064123/bibin-biju"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1497437603, "post_id": 44541780, "comment_id": 76075815, "body": "really sorry for that mistake @teylyn greater than 5 years i meant. Do you have that complicated routine in your hand. like splitting the year then adding it to a list A in integer form, then removing all the values less than 5  nd again filtering the excel with values in list A..? Is this possible in VBA..?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1497437959, "post_id": 44541780, "comment_id": 76076091, "body": "Less than five WHAT? Years or months??"}, {"owner": {"reputation": 11, "user_id": 7064123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DeGKbi12e5M/AAAAAAAAAAI/AAAAAAAAD_Q/ypjbzYSPsUA/photo.jpg?sz=128", "display_name": "Bibin Biju", "link": "https://stackoverflow.com/users/7064123/bibin-biju"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1497438148, "post_id": 44541780, "comment_id": 76076236, "body": "Years, I just need to get those years greater than 5"}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 3, "last_activity_date": 1497438400, "creation_date": 1497438400, "answer_id": 44543027, "question_id": 44541780, "link": "https://stackoverflow.com/questions/44541780/how-to-filter-an-excel-columns-which-contain-date-time-as-string/44543027#44543027", "title": "How to filter an excel columns which contain date/time as string", "body": "<p>Consider the following screenshot. Column a has the unfortunate text with years and months.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UgbGA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UgbGA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Column B splits out the years. Column C splits out the months. Column D has the total number of months for the time frame. With this in place, you can filter by any of the columns using the filter options of the Autofilter built into an Excel table. </p>\n\n<p>The formulas are as follows:</p>\n\n<p>Years: <code>=MID([@total],1,FIND(\"Years\",[@total])-1)+0</code></p>\n\n<p>Months: <code>=MID(SUBSTITUTE([@total],\"Months\",\"\"),FIND(\" \",[@total])+1,99)+0</code></p>\n\n<p>Duration in months: <code>=([@years]*12)+[@months]</code></p>\n\n<p>Now just use the filters in the drop down butttons of the column headers and there is no need for VBA at all.</p>\n"}], "owner": {"reputation": 11, "user_id": 7064123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DeGKbi12e5M/AAAAAAAAAAI/AAAAAAAAD_Q/ypjbzYSPsUA/photo.jpg?sz=128", "display_name": "Bibin Biju", "link": "https://stackoverflow.com/users/7064123/bibin-biju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497881774, "creation_date": 1497435163, "last_edit_date": 1497435868, "question_id": 44541780, "link": "https://stackoverflow.com/questions/44541780/how-to-filter-an-excel-columns-which-contain-date-time-as-string", "title": "How to filter an excel columns which contain date/time as string", "body": "<p>I have an excel sheet to filter a Column. The column relates to total experience of a person. The values are like 5years 2Months, 32Years 6Months etc... all the values are in String format. I need the following functionality.</p>\n\n<ul>\n<li><ol>\n<li>when i enter >5 in a textbox(which i will create in a form), it should display only experience which are less than 5(filtering) . I need an idea how to do this in vba.</li>\n</ol></li>\n</ul>\n\n<p>Can anyone help..? I just need a way to do this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/QXSCu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QXSCu.jpg\" alt=\"Screenshot of the column\"></a></p>\n"}, {"tags": ["excel", "vba", "datetime", "countif"], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1497436132, "post_id": 44541795, "comment_id": 76074717, "body": "It&#39;s perfectly fine to use <code>time</code> as a variable name it&#39;s a member of the <code>VBA</code> library, not a reserved keyword."}], "tags": [], "owner": {"reputation": 178, "user_id": 7797433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f96c98c332cc99a3f6b6d27761b2c4?s=128&d=identicon&r=PG&f=1", "display_name": "gr8tech", "link": "https://stackoverflow.com/users/7797433/gr8tech"}, "is_accepted": false, "score": 0, "last_activity_date": 1497435197, "creation_date": 1497435197, "answer_id": 44541795, "question_id": 44541556, "link": "https://stackoverflow.com/questions/44541556/how-to-apply-worksheetfunction-countifs-depending-on-time/44541795#44541795", "title": "How to apply WorksheetFunction.CountIfs depending on time?", "body": "<p>Try and use a different variable for setting the date and time.  \"Time\" is built in VBA and will return the current time and so Range(\"I15\").Value will be set to the current time and not 08:00 as required</p>\n\n<pre><code>Dim wksdata As Worksheet\nDim xyz as String\nDim startTime as String\n\nSet wksdata = Sheets(\"Data\")\nstartTime = Date + TimeValue(\"08:00:00\") 'Set Time value as todays date 8am\nWorksheets(\"Calculations\").Range(\"I15\").Value = startTime 'set calculations \nworksheet cell I15 as the time value\n\nWorksheets(\"Data)\").Range(\"U:U\").NumberFormat = \"dd/mm/yyyy hh:mm:ss\"  \n'converts time column to time format\n\n\nxyz = WorksheetFunction.CountIfs(wksdata.Range(\"I:I\"), \"xyz\", \nwksdata.Range(\"K:K\"), \"C\", wksdata.Range(\"U:U\"), \"&lt;\" &amp; \nWorksheets(\"Calculations\").Range(\"I15\").Value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 0, "last_activity_date": 1559805463, "creation_date": 1559805463, "answer_id": 56472606, "question_id": 44541556, "link": "https://stackoverflow.com/questions/44541556/how-to-apply-worksheetfunction-countifs-depending-on-time/56472606#56472606", "title": "How to apply WorksheetFunction.CountIfs depending on time?", "body": "<p>The date part needs to be converted into a Long. Once this is done, the formula works correctly. Here is a sample of how this could be done using a similar formula:</p>\n\n<pre><code>Sub test_method()\n\nRange(\"B1\") = Now()\nRange(\"B1\").NumberFormat = \"dd/mm/yyyy hh:mm:ss\"\n\n'Trying to calculate using a VBA date in the worksheet formula doesn't work\n'This returns 0\nDebug.Print WorksheetFunction.CountIfs(Range(\"B1:B10\"), \"&gt;\" &amp; (Now() - 0.75))\n\n'Now we change it to a long and it yields the correct answer\n'returns 1\nDebug.Print WorksheetFunction.CountIfs(Range(\"B1:B10\"), \"&gt;\" &amp; CLng((Now() - 0.75)))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17656, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1611275251, "creation_date": 1497434567, "last_edit_date": 1611275251, "question_id": 44541556, "link": "https://stackoverflow.com/questions/44541556/how-to-apply-worksheetfunction-countifs-depending-on-time", "title": "How to apply WorksheetFunction.CountIfs depending on time?", "body": "<p>I am trying to count records on Sheet2.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Dim wksdata As Worksheet\nDim xyz as String\nDim Time as String\n\nSet wksdata = Sheets(&quot;Data&quot;)\n\nTime = Date + TimeValue(&quot;08:00:00&quot;) 'Set Time value as todays date 8am\n\n'set calculations worksheet cell I15 as the time value\nWorksheets(&quot;Calculations&quot;).Range(&quot;I15&quot;).Value = Time\n\n'converts time column to time format\nWorksheets(&quot;Data)&quot;).Range(&quot;U:U&quot;).NumberFormat = &quot;dd/mm/yyyy hh:mm:ss&quot;\n\nxyz = WorksheetFunction.CountIfs(wksdata.Range(&quot;I:I&quot;), &quot;xyz&quot;, _\n  wksdata.Range(&quot;K:K&quot;), &quot;C&quot;, wksdata.Range(&quot;U:U&quot;), &quot;&lt;&quot; &amp; _\n  Worksheets(&quot;Calculations&quot;).Range(&quot;I15&quot;).Value)\n</code></pre>\n<p>If I apply this directly in a worksheet it works with the same logic.</p>\n<p>Why isn't it working in VBA?</p>\n"}, {"tags": ["excel", "vba", "for-loop", "outlook", "email-attachments"], "answers": [{"tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1497439472, "creation_date": 1497439472, "answer_id": 44543411, "question_id": 44541528, "link": "https://stackoverflow.com/questions/44541528/attaching-multiple-files-to-outlook-email-in-a-loop/44543411#44543411", "title": "Attaching Multiple files to Outlook Email in a loop", "body": "<p>In your code variable x value remains same during executing the loop. That\u2019s why its attaching the same file every time when loop gets executed.</p>\n\n<p>Try this</p>\n\n<pre><code>    For LoopAttach = x To 1 Step -1\n        .Attachments.Add ws.Range(\"E9\").Offset(LoopAttach - 1, 0) _\n        &amp; ws.Range(\"F9\").Offset(LoopAttach - 1, 0)\n    Next LoopAttach\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "is_accepted": false, "score": 0, "last_activity_date": 1497439547, "creation_date": 1497439547, "answer_id": 44543443, "question_id": 44541528, "link": "https://stackoverflow.com/questions/44541528/attaching-multiple-files-to-outlook-email-in-a-loop/44543443#44543443", "title": "Attaching Multiple files to Outlook Email in a loop", "body": "<p>This is simple mistake - x is constant limit of for loop. You need to use <code>LoopAttach</code> variable instead of <code>x</code>.</p>\n\n<pre><code>For LoopAttach = 1 To x\n    .Attachments.Add ws.Range(\"E9\").Offset(LoopAttach - 1, 0) _\n    &amp; ws.Range(\"F9\").Offset(LoopAttach - 1, 0)\nNext LoopAttach\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8103123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500147988f9158986a0acddafe5812e?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/8103123/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 906, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499724632, "creation_date": 1497434501, "last_edit_date": 1499724632, "question_id": 44541528, "link": "https://stackoverflow.com/questions/44541528/attaching-multiple-files-to-outlook-email-in-a-loop", "title": "Attaching Multiple files to Outlook Email in a loop", "body": "<p>I am trying to draw editable inputs from cells in the active spreadsheet. I managed to generate an email in Outlook and attach multiple files. </p>\n\n<p>The problem is instead of cycling through each cell with data (and different directory inputs) thereby attaching \"x\" amount of individual files, it attaches the same file \"x\" times.</p>\n\n<pre><code>Option Explicit\n\nSub TESTCreateEmail()\n\n\n    'define variables for outlook\n    Dim olApp As Outlook.Application\n    Dim olMail As Outlook.MailItem\n\n    'define variables for attachements to email\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim LoopAttach As Integer\n    Dim x As Integer\n    Dim y As Integer\n\n    x = Range(\"E9\", Range(\"E100\").End(xlUp)).Count\n\n    'set parameters for outlook\n    Set olApp = New Outlook.Application\n    Set olMail = olApp.CreateItem(olMailItem)\n\n    'set parameters for attachements to email\n    Set wb = ThisWorkbook\n    Set ws = wb.Application.ActiveSheet\n\n    'create email\n    With olMail\n\n        .To = ws.Range(\"H9\")\n        .CC = ws.Range(\"I9\")\n        olMail.SentOnBehalfOfName = \"email@email.com\"\n        olMail.Recipients.ResolveAll\n        .BodyFormat = olFormatHTML\n\n        olMail.HTMLBody = \"&lt;html&gt;&lt;p&gt;&lt;font face=\"\"Calibri\"\"&gt;&lt;font size=3&gt;Dear Sir/ Madam,&lt;/p&gt;\"\n\n        'loop to attach multiple files\n        For LoopAttach = 1 To x\n            .Attachments.Add ws.Range(\"E9\").Offset(x - 1, 0) _\n            &amp; ws.Range(\"F9\").Offset(x - 1, 0)\n        Next LoopAttach\n\n       .Display\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/k55yb.jpg\" alt=\"Examples of Excel input and resulting Outlook email\"></p>\n"}, {"tags": ["vba", "excel", "date"], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1497972571, "post_id": 44541916, "comment_id": 76299839, "body": "With respect to that case, I would like to add a case, If column A and B is present and Column D is present, But there is no date in column E , it should print remaning. How would i do this ? sorry that i am adding this requirement really late."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1497973177, "post_id": 44541916, "comment_id": 76300256, "body": "@Mikz can you post a new question with that request, otherwise posts here will never be closed. Don&#39;t worry, other users (and me) will jump to answer"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1497973454, "post_id": 44541916, "comment_id": 76300442, "body": "@ shai Rado, I already posted as new request under the Name Macros for comparing dates and ID  and highlighting them . but that answer was not satisfying."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1497979089, "last_edit_date": 1497979089, "creation_date": 1497435549, "answer_id": 44541916, "question_id": 44541457, "link": "https://stackoverflow.com/questions/44541457/comparing-the-dates-and-highlighting-the-result/44541916#44541916", "title": "Comparing the dates and highlighting the result", "body": "<p>Before calculating <code>zWeeks</code> check the column \"E\" is not empty, with <code>If Len(Trim(Cells(r, \"E\"))) = 0 Then</code>. Afterwards, use your <code>Select Case</code>.</p>\n\n<p>Also, you can use <code>DateDiff</code> function, with the first parameter being <code>\"ww\"</code> (weeks), to calculate directly the difference in weeks between the dats in column \"E\" amd column \"D\".</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub dateCompare()\n\nDim r As Long, zLastRow As Long\nDim zWeeks As Double, zcolour As Long\nDim Ztext  As String\n\nzLastRow = Cells(Rows.Count, \"D\").End(xlUp).Row\n\nFor r = 2 To zLastRow\n    If Len(Trim(Cells(r, \"E\"))) = 0 Then ' column \"E\" is empty\n        ' do something....\n    Else ' column \"E\" is not empty\n        zWeeks = DateDiff(\"ww\", Cells(r, \"D\"), Cells(r, \"E\"))\n\n        Select Case zWeeks\n            Case Is &gt; 4\n                zcolour = vbRed\n                Ztext = \"Project Delayed \" &amp; Int(zWeeks) &amp; \" weeks\"\n            Case 2 To 4\n                zcolour = vbYellow\n                Ztext = \"Project Remaining\"\n            Case Is &lt; 2\n                zcolour = vbGreen\n                Ztext = \"Project On-Time\"\n            Case Else\n                zcolour = xlNone\n                Ztext = \" Check Status\"\n        End Select\n\n        Cells(r, \"F\").Interior.Color = zcolour\n        Cells(r, \"F\") = Ztext\n    End If\nNext r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 44541916, "answer_count": 1, "score": 1, "last_activity_date": 1497979089, "creation_date": 1497434315, "last_edit_date": 1497437213, "question_id": 44541457, "link": "https://stackoverflow.com/questions/44541457/comparing-the-dates-and-highlighting-the-result", "title": "Comparing the dates and highlighting the result", "body": "<p>I am comparing two Dates in columns D and E of My worksheet. </p>\n\n<p>Column D contains the source Date and column E contains the Start date. </p>\n\n<p>I have 4 cases to compare the date. </p>\n\n<p>Case 1. If the sorce date is &lt; 2 weeks of start date, then print Project on time. </p>\n\n<p>case 2: if the source date is > 4 weeks of start date , then print Project delay. </p>\n\n<p>case 3: if the source date is between 2 to 4 weeks of start date, then print Project is remaning. </p>\n\n<p>I have derived the code for the above cases, Now </p>\n\n<p>Case 4: not everytime the column E is filled with date, they are empty sometimes. </p>\n\n<p>So, How would i add a null Statement here. I tried adding an null Statement, but it failed. </p>\n\n<p>Below is the code. </p>\n\n<pre><code>Sub dateCompare()\n\nzLastRow = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nFor r = 2 To zLastRow\n\n    zWeeks = (Cells(r, \"E\") - Cells(r, \"D\")) / 7\n    Select Case zWeeks\n        Case Is &gt; 4\n            zcolour = vbRed\n            Ztext = \"Project Delayed \" &amp; Int(zWeeks) &amp; \" weeks\"\n        Case 2 To 4\n            zcolour = vbYellow\n            Ztext = \"Project Remaining\"\n        Case Is &lt; 2\n            zcolour = vbGreen\n            Ztext = \"Project On-Time\"\n        Case Else\n            zcolour = xlNone\n            Ztext = \" Check Status\"\n    End Select\n\n    Cells(r, \"F\").Interior.Color = zcolour\n    Cells(r, \"F\") = Ztext            \nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1497434616, "post_id": 44541291, "comment_id": 76073651, "body": "Change the TableDestination argument to <code>pivotTableWs.Cells(1, 1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1497434923, "creation_date": 1497434923, "answer_id": 44541681, "question_id": 44541291, "link": "https://stackoverflow.com/questions/44541291/vba-create-pivot-table/44541681#44541681", "title": "vba: create pivot table", "body": "<p>I've added 2 Object variables <code>PvtTbl As PivotTable</code> and <code>PvtCache As PivotCache</code> to make the code more dynamic.</p>\n\n<p>Other explanations are inside the code below (as comments).</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub AutoPivot()\n\nDim PvtTbl As PivotTable\nDim PvtCache As PivotCache\n\nDim PvtTblName As String\nDim pivotTableWs As Worksheet\n\nPvtTblName = \"pivotTableName\"\n\n' set the worksheet object where we will create the Pivot-Table\nSet pivotTableWs = Sheets.Add(after:=Worksheets(\"Sheet1\"))\n\n' set the Pivot Cache (the Range is static)\nSet PvtCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"Sheet1!R1C1:R1048576C8\")\n\n' create a new Pivot Table in the new created sheet\nSet PvtTbl = pivotTableWs.PivotTables.Add(PivotCache:=PvtCache, TableDestination:=pivotTableWs.Range(\"A1\"), TableName:=PvtTblName)\n\n' after we set the PvtTbl object, we can easily modifty all it's properties\nWith PvtTbl\n    .ColumnGrand = True\n    .HasAutoFormat = True\n    .DisplayErrorString = False\n    .DisplayNullString = True\n    .EnableDrilldown = True\n    .ErrorString = \"\"\n    .MergeLabels = False\n    .NullString = \"\"\n    .PageFieldOrder = 2\n    .PageFieldWrapCount = 0\n    .PreserveFormatting = True\n    .RowGrand = True\n    .SaveData = True\n    .PrintTitles = False\n    .RepeatItemsOnEachPrintedPage = True\n    .TotalsAnnotation = False\n    .CompactRowIndent = 1\n    .InGridDropZones = False\n    .DisplayFieldCaptions = True\n    .DisplayMemberPropertyTooltips = False\n    .DisplayContextTooltips = True\n    .ShowDrillIndicators = True\n    .PrintDrillIndicators = False\n    .AllowMultipleFilters = False\n    .SortUsingCustomLists = True\n    .FieldListSortAscending = False\n    .ShowValuesRow = False\n    .CalculatedMembersInFilters = False\n    .RowAxisLayout xlCompactRow\n\n    With .PivotCache\n        .RefreshOnFileOpen = False\n        .MissingItemsLimit = xlMissingItemsDefault\n    End With\n\n    .RepeatAllLabels xlRepeatLabels\n\n    With .PivotFields(\"field1\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n\n    .AddDataField .PivotFields(\"ticketid\"), \"Count of field1\", xlCount\n\n    With .PivotFields(\"field2\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13005971, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GjhYhR0HI1QedakMLRZeJl-kfzTlSXZSjZCk4_jpw=k-s128", "display_name": "Gabriel Luca", "link": "https://stackoverflow.com/users/13005971/gabriel-luca"}, "is_accepted": false, "score": 0, "last_activity_date": 1583328245, "creation_date": 1583328245, "answer_id": 60527150, "question_id": 44541291, "link": "https://stackoverflow.com/questions/44541291/vba-create-pivot-table/60527150#60527150", "title": "vba: create pivot table", "body": "<p>I had the same need for a loop. This is what I used (with comments). It should work with any dataset.</p>\n\n<pre><code>Sub createPivot()\n'declare Range variable\nDim dataRange As Range  \n\n\n'get last row and last column in the data sheet\nlastrow = Cells(Rows.Count, 1).End(xlUp).Row\nlastcol = Cells(1, Columns.Count).End(xlToLeft).Column\n\n'set value for  dataRange; this is dynamic and will work for any dataset\nSet dataRange = Range(Cells(1, 1), Cells(lastrow, lastcol))\ndataRange.Select\n\n'create new WS and insert blank pivot table\nSheets.Add\nActiveSheet.Name = \"Pivot\"\nActiveWorkbook.PivotCaches.Create(xlDatabase, dataRange, 6).CreatePivotTable Sheets(\"Pivot\").Range(\"A3\"), \"PivotTable1\", dataRange, 6\n\n\n' the following 2 blocks are optional\n'Insert Row Fields\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Rights Holder\")\n.Orientation = xlRowField\n.Position = 1\nEnd With\n\n'Insert Values fields\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Number of tracks\")\n.Orientation = xlDataField\n.Function = xlSum\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 6791322, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/2RgQr.png?s=128&g=1", "display_name": "Alessandro95", "link": "https://stackoverflow.com/users/6791322/alessandro95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 0, "accepted_answer_id": 44541681, "answer_count": 2, "score": 0, "last_activity_date": 1583328245, "creation_date": 1497433945, "question_id": 44541291, "link": "https://stackoverflow.com/questions/44541291/vba-create-pivot-table", "title": "vba: create pivot table", "body": "<p>I have to create a pivot table using vba but i got the following error: \"Run-time error '438' Object doesn't support this property or method\" about this code: <code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"Sheet1!R1C1:R1048576C8\", Version:=6).CreatePivotTable TableDestination:= _\n        pivotTableWs!R1C1, tableName:=tableName, DefaultVersion:=6</code></p>\n\n<p>here the complete source</p>\n\n<pre><code>Dim tableName As String\nDim pivotTableWs As Worksheet\n\ntableName = \"pivotTableName\"\n\nSet pivotTableWs = Sheets.Add(after:=Worksheets(\"Sheet1\"))\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Sheet1!R1C1:R1048576C8\", Version:=6).CreatePivotTable TableDestination:= _\n    pivotTableWs!R1C1, tableName:=tableName, DefaultVersion:=6\nSheets(pivotTableWs).Select\nCells(1, 1).Select\nWith ActiveSheet.PivotTables(tableName)\n    .ColumnGrand = True\n    .HasAutoFormat = True\n    .DisplayErrorString = False\n    .DisplayNullString = True\n    .EnableDrilldown = True\n    .ErrorString = \"\"\n    .MergeLabels = False\n    .NullString = \"\"\n    .PageFieldOrder = 2\n    .PageFieldWrapCount = 0\n    .PreserveFormatting = True\n    .RowGrand = True\n    .SaveData = True\n    .PrintTitles = False\n    .RepeatItemsOnEachPrintedPage = True\n    .TotalsAnnotation = False\n    .CompactRowIndent = 1\n    .InGridDropZones = False\n    .DisplayFieldCaptions = True\n    .DisplayMemberPropertyTooltips = False\n    .DisplayContextTooltips = True\n    .ShowDrillIndicators = True\n    .PrintDrillIndicators = False\n    .AllowMultipleFilters = False\n    .SortUsingCustomLists = True\n    .FieldListSortAscending = False\n    .ShowValuesRow = False\n    .CalculatedMembersInFilters = False\n    .RowAxisLayout xlCompactRow\nEnd With\nWith ActiveSheet.PivotTables(tableName).PivotCache\n    .RefreshOnFileOpen = False\n    .MissingItemsLimit = xlMissingItemsDefault\nEnd With\nActiveSheet.PivotTables(tableName).RepeatAllLabels xlRepeatLabels\nWith ActiveSheet.PivotTables(tableName).PivotFields(\"field1\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nActiveSheet.PivotTables(tableName).AddDataField ActiveSheet.PivotTables( _\n    tableName).PivotFields(\"ticketid\"), \"Count of field1\", xlCount\nWith ActiveSheet.PivotTables(tableName).PivotFields(\"field2\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\n</code></pre>\n\n<p>I create this code using \"Developer\" tab, selected \"Macro register\" and i create pivot table manually</p>\n"}, {"tags": ["sql-server", "vba"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8062937, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/655dfbcc5bca69c8730796e2c1735924?s=128&d=identicon&r=PG&f=1", "display_name": "jangho yoon", "link": "https://stackoverflow.com/users/8062937/jangho-yoon"}, "edited": false, "score": 0, "creation_date": 1497435148, "post_id": 44541429, "comment_id": 76074051, "body": "Thanks a lot!!! But when I fix that code, I get following error...:[Microsoft][ODBC SQL Server Driver] Syntax error or access violation. Do you know how to solve this error, too?"}, {"owner": {"reputation": 755, "user_id": 3936048, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f4b962520cf7e1a405d6dbbd620cf405?s=128&d=identicon&r=PG&f=1", "display_name": "Harsh Sharma", "link": "https://stackoverflow.com/users/3936048/harsh-sharma"}, "reply_to_user": {"reputation": 61, "user_id": 8062937, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/655dfbcc5bca69c8730796e2c1735924?s=128&d=identicon&r=PG&f=1", "display_name": "jangho yoon", "link": "https://stackoverflow.com/users/8062937/jangho-yoon"}, "edited": false, "score": 0, "creation_date": 1497436219, "post_id": 44541429, "comment_id": 76074770, "body": "Are you connectting Access/Excel (VB6) to MS SQL Server?"}, {"owner": {"reputation": 61, "user_id": 8062937, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/655dfbcc5bca69c8730796e2c1735924?s=128&d=identicon&r=PG&f=1", "display_name": "jangho yoon", "link": "https://stackoverflow.com/users/8062937/jangho-yoon"}, "edited": false, "score": 0, "creation_date": 1497436416, "post_id": 44541429, "comment_id": 76074914, "body": "Yes, connecting Access and mssql server"}, {"owner": {"reputation": 755, "user_id": 3936048, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f4b962520cf7e1a405d6dbbd620cf405?s=128&d=identicon&r=PG&f=1", "display_name": "Harsh Sharma", "link": "https://stackoverflow.com/users/3936048/harsh-sharma"}, "reply_to_user": {"reputation": 61, "user_id": 8062937, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/655dfbcc5bca69c8730796e2c1735924?s=128&d=identicon&r=PG&f=1", "display_name": "jangho yoon", "link": "https://stackoverflow.com/users/8062937/jangho-yoon"}, "edited": false, "score": 0, "creation_date": 1497436528, "post_id": 44541429, "comment_id": 76075001, "body": "I just modified my actual post and posted new code, please try this, it will work for you."}], "tags": [], "owner": {"reputation": 755, "user_id": 3936048, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f4b962520cf7e1a405d6dbbd620cf405?s=128&d=identicon&r=PG&f=1", "display_name": "Harsh Sharma", "link": "https://stackoverflow.com/users/3936048/harsh-sharma"}, "is_accepted": true, "score": 1, "last_activity_date": 1497436470, "last_edit_date": 1497436470, "creation_date": 1497434265, "answer_id": 44541429, "question_id": 44541283, "link": "https://stackoverflow.com/questions/44541283/vba-mssql-connection-error/44541429#44541429", "title": "vba mssql connection error", "body": "<p>It looks like you are executing <strong>dbo.Version</strong> as a SP or a SQL Command which is wrong.</p>\n\n<p>You should execute the command in <strong>strSQL</strong> object instead. So after the modifications your code will look something like this:</p>\n\n<pre><code>strSQL = \"SELECT * FROM dbo.Version\"\n\nSet cmd = New ADODB.Command\ncmd.CommandText = strSQL\ncmd.CommandType = adCmdStoredProc\ncmd.ActiveConnection = conn\n</code></pre>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>I replicated the same issue in MS Excel to read data from MS SQl Server by using the following code and it worked for me:</p>\n\n<pre><code> 'Declare variables'\n    Set objMyConn = New ADODB.Connection\n    Set objMyRecordset = New ADODB.Recordset\n    Dim strSQL As String\n\n'Open Connection'\n    objMyConn.ConnectionString = \"Provider=SQLOLEDB;Data Source=HARSH-SHARMA\\SQLEXPRESS;Initial Catalog=db1;User ID=sa;Password=pass001;\"\n    objMyConn.Open\n\n'Set and Excecute SQL Command'\n    strSQL = \"select * from Subject\"\n\n'Open Recordset'\n    Set objMyRecordset.ActiveConnection = objMyConn\n    objMyRecordset.Open strSQL\n\n'Copy Data to Excel'\n    ActiveSheet.Range(\"A1\").CopyFromRecordset (objMyRecordset)\n</code></pre>\n\n<p>Please try this.</p>\n"}], "owner": {"reputation": 61, "user_id": 8062937, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/655dfbcc5bca69c8730796e2c1735924?s=128&d=identicon&r=PG&f=1", "display_name": "jangho yoon", "link": "https://stackoverflow.com/users/8062937/jangho-yoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 44541429, "answer_count": 1, "score": 0, "last_activity_date": 1497436470, "creation_date": 1497433927, "question_id": 44541283, "link": "https://stackoverflow.com/questions/44541283/vba-mssql-connection-error", "title": "vba mssql connection error", "body": "<p>I am trying to connect sql with Access.\nWhat I want to do is simply get data from mssql using select statement.\nHere is the code. </p>\n\n<pre><code>Sub ConnectSQLServer()\n\nDim cmd As ADODB.Command\nDim conn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim strConn As String\nDim par As ADODB.Parameter\nDim strSQL As String\n\n\nstrConn = \"DRIVER=SQL Server;SERVER=CHU-AS-0004;DATABASE=RTC_LaplaceD_DEV;Trusted_Connection=Yes;\"\n\nSet conn = New ADODB.Connection\nconn.Open strConn\n\nSet cmd = New ADODB.Command\ncmd.CommandText = \"dbo.Version\"\ncmd.CommandType = adCmdStoredProc\ncmd.ActiveConnection = conn\n\nstrSQL = \"SELECT * FROM dbo.Version\"\n\n\ncmd.Execute\nconn.Close\n\nSet conn = Nothing\nSet cmd = Nothing\nEnd Sub\n</code></pre>\n\n<p>When I execute this code, I get error like \"[Microsoft][ODBC SQL Server Driver][SQL Server] The request for procedure 'Version' failed because 'Version' is a table object.'</p>\n\n<p>I know that I need to add something after \"strSQL = SELECT * FROM dbo.Version\" but I do not know exactly how to fill in.\nCould you please help me with this?</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497433892, "creation_date": 1497433666, "last_edit_date": 1497433892, "question_id": 44541177, "link": "https://stackoverflow.com/questions/44541177/automatic-update-of-textbox-value-based-on-last-value-in-worksheet", "title": "Automatic update of textbox value based on last value in worksheet", "body": "<p><a href=\"https://i.stack.imgur.com/5ZCNG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5ZCNG.png\" alt=\"enter image description here\"></a>\nI have these in a worksheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/UbTfZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UbTfZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then on a userform, I want that as I change the chapter, the No. part automatically updates that if on the worksheet, Chapter 1 last No. is 1 so No. on the userform automatically updates to 2, then same with Chapter 2 and 3. </p>\n\n<p>This is what I tried: </p>\n\n<pre><code>    Dim label As Control\n    For ctr = 1 To InfoForm.Chapter.ListCount - 1\n        For Each label In InfoForm.Controls\n            If TypeName(label) = \"Label\" Then\n                i = i + 1\n                Dim WhatChapter As String\n                WhatChapter = InfoForm.Chapter\n                lastNum = Cells(.Rows.Count, \"A\").End(xlUp).Row\n                If WhatChapter = \"Chapter \" &amp; ctr Then\n                    If Cells(lastNum, i).Value = \"No.\" Then\n                        Num.Value = 1\n                    Else\n                       Num.Value = Cells(lastNum, i).Value\n                    End If\n                End If\n            End If\n        Next\n    Next ctr\n</code></pre>\n"}, {"tags": ["excel", "for-loop", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1497431838, "post_id": 44539772, "comment_id": 76071589, "body": "Please elaborate on what rows you get the errors, and where pagebreaks are inserted where they shouldn&#39;t be. Could you show us a printscreen of your sheet where you indicate the pagebreaks and where they should be?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1497431934, "post_id": 44539772, "comment_id": 76071658, "body": "Also does your sheet contain more then 2 pages, if so reset your <code>HowTall</code> to 0 after inserting the pagebreak, otherwise it keeps inserting them every row."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1497432184, "post_id": 44539772, "comment_id": 76071853, "body": "Also if Check only exists after Op, then the code could be simplified by using  <code>If cell.Offset(-tmpcounter, 0).value = &quot;Op&quot; OR cell.Offset(-tmpcounter, 0).value = &quot;Check&quot; Then</code> and place here the code to insert a pagebreak. This way you can remove the other <code>If</code> statement."}, {"owner": {"reputation": 3, "user_id": 8159185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f87f583e0633dd688d05643a581de19?s=128&d=identicon&r=PG&f=1", "display_name": "David Wilson", "link": "https://stackoverflow.com/users/8159185/david-wilson"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1497432991, "post_id": 44539772, "comment_id": 76072412, "body": "this is what it looks like currently, it is inserting page breaks after every Op and every Check. Check does only exist after Op so that would be good to eliminate one of the If statements!"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1497433039, "post_id": 44539772, "comment_id": 76072451, "body": "Also you forget to stop going upward after you found the check."}, {"owner": {"reputation": 3, "user_id": 8159185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f87f583e0633dd688d05643a581de19?s=128&d=identicon&r=PG&f=1", "display_name": "David Wilson", "link": "https://stackoverflow.com/users/8159185/david-wilson"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1497433693, "post_id": 44539772, "comment_id": 76072945, "body": "!<a href=\"https://ibb.co/ixzYTQ\" rel=\"nofollow noreferrer\">Image</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "is_accepted": true, "score": 0, "last_activity_date": 1497437119, "last_edit_date": 1497437119, "creation_date": 1497435230, "answer_id": 44541802, "question_id": 44539772, "link": "https://stackoverflow.com/questions/44539772/set-excel-print-areas-based-on-row-heights/44541802#44541802", "title": "Set excel print areas based on row heights", "body": "<p>Added my suggested improvements in your original code:</p>\n\n<pre><code>Sub TotalHeight()\nDim HowTall As Long\nDim Count As Long\nDim TotalHeight As Long\nDim tmpcounter1 As Long\n\nHowTall = 0\nCount = 0\nTotalHeight = 0\n\n\nDim cell As Range\n   For Each cell In Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n    'If Not cell.Hidden Then\n        HowTall = HowTall + cell.RowHeight\n        'Count = Count + 1\n        If HowTall &gt; 832 Then\n            Debug.Print cell.Row\n            For tmpcounter = 0 To 100\n                If cell.Offset(-tmpcounter, 0).Value = \"Op\" Or cell.Offset(-tmpcounter, 0).Value = \"Check\" Then\n                        PageBreakRowNo = cell.Offset(-tmpcounter + 1, 0).Row\n                        tmpcounter1 = tmpcounter\n                        Debug.Print \"Op / Check found at row \" &amp; PageBreakRowNo\n                        Sheets(\"Dispensary\").HPageBreaks.Add Before:=cell.Offset(-tmpcounter + 2, 0)\n                        Exit for 'to stop looking upwards\n                End If\n             Next tmpcounter\n        HowTall = 0 'reset HowTall to start again for the next page\n            For i = tmpcounter1 +1 to 0 Step -1 'Calculate the HowTall lost due to stepping back\n                HowTall = HowTall + cell.Offset(i,0).RowHeight\n            Next i\n        End If ' end of of HowTall &gt;832 loop\n     Next 'end of for each cell in Column B loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8159185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f87f583e0633dd688d05643a581de19?s=128&d=identicon&r=PG&f=1", "display_name": "David Wilson", "link": "https://stackoverflow.com/users/8159185/david-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 44541802, "answer_count": 1, "score": 0, "last_activity_date": 1497437119, "creation_date": 1497429870, "last_edit_date": 1531161705, "question_id": 44539772, "link": "https://stackoverflow.com/questions/44539772/set-excel-print-areas-based-on-row-heights", "title": "Set excel print areas based on row heights", "body": "<p>I have been battling with this code for several days now and would appreciate some guidance on where I am going wrong. </p>\n\n<p>My project is to create a printable document format containing manufacturing instructions and spaces for operators to write manual entries, which requires a minimum cell size when printed onto A4. These instructions will be varied but in all cases will be signed in column B, and in some cases will be countersigned. The marker in column B for a signature is \"Op\" and the marker for a countersignature is \"Check\". </p>\n\n<p>In order to regulate cell size for the printed document I am attempting to count row heights up until a fixed total (832), from that point I want the code to go up and look for the first \"Op\", if the \"Op\" has a \"Check\" in the cell below then insert a page break below \"Check\", if not then insert a page break below \"Op\". From there I want the code to continue to the bottom of the document inserting page breaks every time it counts 832 total rows.</p>\n\n<p>I am not sure if that methodology is the best for achieving what I am aiming for but would appreciate some feedback on what I have so far, I am getting an run time error 1004 on this code and it is inserting page breaks in the wrong places. </p>\n\n<pre><code>Sub TotalHeight()\n    Dim HowTall As Long\n    Dim Count As Long\n    Dim TotalHeight As Long\n\n    HowTall = 0\n    Count = 0\n    TotalHeight = 0\n\n\nDim cell As Range\n       For Each cell In Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n        'If Not cell.Hidden Then\n            HowTall = HowTall + cell.RowHeight\n            'Count = Count + 1\n            If HowTall &gt; 832 Then\n                Debug.Print cell.Row\n                For tmpcounter = 0 To 100\n                   ' If (Range(cell.Row).Offset(-tmpcounter, 0).Value) = \"Op\" Then\n                    If cell.Offset(-tmpcounter, 0).Value = \"Op\" Then\n                        If cell.Offset(-tmpcounter + 1, 0).Value = \"Check\" Then\n                            'Found Check - get current row\n                            PageBreakRowNo = cell.Offset(-tmpcounter + 1, 0).Row\n                            Debug.Print \"Check found at row \" &amp; PageBreakRowNo\n                            Sheets(\"Dispensary\").HPageBreaks.Add Before:=cell.Offset(-tmpcounter + 2, 0)\n                        Else\n                            'Only found Op - Get current row\n                            PageBreakRowNo = cell.Offset(-tmpcounter, 0).Row\n                            Debug.Print \"Op found at row \" &amp; PageBreakRowNo\n                            Sheets(\"Dispensary\").HPageBreaks.Add Before:=cell.Offset(-tmpcounter + 1, 0)\n                        End If\n                    End If\n                 Next tmpcounter\n            End If ' end of of HowTall &gt;832 loop\n         Next 'end of for each cell in Column B loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "web-scraping", "frames", "excel-web-query"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7590076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/295f45f7e3f068f786c5346667849f4b?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/7590076/andreas"}, "edited": false, "score": 0, "creation_date": 1497800308, "post_id": 44596669, "comment_id": 76219480, "body": "Hi ryguy72 and thank you very much! Unfortunately I get an error &quot;our of range&quot;. I made a work around for the issue and I now use imacros chrome plugin to scrap the content and then import it via VBA into excel. But of course a direct way would b propably way more convienient. Best wishes Andreas"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 1, "user_id": 7590076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/295f45f7e3f068f786c5346667849f4b?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/7590076/andreas"}, "edited": false, "score": 0, "creation_date": 1497874117, "post_id": 44596669, "comment_id": 76245828, "body": "When you step through the code, by hitting F8 over and over, where does the error &quot;our of range&quot; occur?  Which line throws the error?  That should be a clue.  Although, I can&#39;t surmise where the error would be?  I don&#39;t see anything suspect and everything worked fine for me."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1497641401, "creation_date": 1497641401, "answer_id": 44596669, "question_id": 44539310, "link": "https://stackoverflow.com/questions/44539310/web-query-where-there-are-multiple-frames/44596669#44596669", "title": "Web Query where there are multiple Frames", "body": "<p>Hummmm, I'm not exactly sure what you are doing here, but can you try the code below?</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim ie As Object\n    Dim links As Variant, lnk As Variant\n    Dim rowcount As Long\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = True\n    ie.navigate \"https://www.xing.com/search/members?section=members&amp;keywords=IT&amp;filters%5Bcontact_level%5D=non_contact\"\n\n    'Wait for site to fully load\n    'ie.Navigate2 URL\n    Do While ie.Busy = True\n       DoEvents\n    Loop\n\n    Set links = ie.document.getElementsByTagName(\"a\")\n\n    rowcount = 1\n\n    With Sheets(\"Sheet1\")\n        For Each lnk In links\n        'Debug.Print lnk.innerText\n            'If lnk.classname Like \"*Real Statistics Examples Part 1*\" Then\n                .Range(\"A\" &amp; rowcount) = lnk.innerText\n                rowcount = rowcount + 1\n                'Exit For\n            'End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1528618235, "last_edit_date": 1528618235, "creation_date": 1528617007, "answer_id": 50781611, "question_id": 44539310, "link": "https://stackoverflow.com/questions/44539310/web-query-where-there-are-multiple-frames/50781611#50781611", "title": "Web Query where there are multiple Frames", "body": "<p><strong>General:</strong></p>\n\n<p>I think in your research you may have come across <a href=\"http://www.vbaexpress.com/forum/showthread.php?40649-Automating-IE-to-get-data-from-a-website\" rel=\"nofollow noreferrer\">this</a> question and misunderstood how it relates/doesn't relate to your circumstance.</p>\n\n<p>I don't think iFrames are relevant to your query. If you are after the list of names, their details and the URLs to their pages you can use the code below.</p>\n\n<hr>\n\n<p><strong>CSS Selectors</strong></p>\n\n<p>To target the elements of interest I use the following two <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS selectors</a>. These use style infomation on the page to target the elements:</p>\n\n<pre><code>.SearchResults-link\n.SearchResults-item\n</code></pre>\n\n<p><code>\".\"</code> means class, which is like saying <code>.getElementsByClassName</code>. The first gets the links, and the second gets the description information on the first page.</p>\n\n<p>With respect to the first CSS selector: The actual link required is dynamically constructed, but we can use the fact that the actual profile URLs have a common base string of <code>\"https://www.xing.com/profile/\"</code>, which is then followed by the profileName. So, in function <code>GetURL</code>, we parse the outerHTML returned by the CSS selector to get the profileName and concatenate it with the <code>BASESTRING</code> constant to get our actual profile link. </p>\n\n<hr>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = True\n        .navigate \"https://www.xing.com/publicsearch/query?search%5Bq%5D=IT\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim a As Object, exitTime As Date, linksNodeList As Object, profileNodeList As Object\n\n'        exitTime = Now + TimeSerial(0, 0, 5) '&lt;== uncomment this section if timing problems\n'\n'        Do\n'            DoEvents\n'            On Error Resume Next\n'            Set linksNodeList = .document.querySelectorAll(\".SearchResults-link\")\n'            On Error GoTo 0\n'            If Now &gt; exitTime Then Exit Do\n'        Loop While linksNodeList Is Nothing\n\n        Set linksNodeList = .document.querySelectorAll(\".SearchResults-link\") '&lt;== comment this out if uncommented section above\n        Set profileNodeList = .document.querySelectorAll(\".SearchResults-item\")\n\n        Dim i As Long\n        For i = 0 To profileNodeList.Length - 1\n            Debug.Print \"Profile link: \" &amp; GetURL(linksNodeList.item(i).outerHTML)\n            Debug.Print \"Basic info: \" &amp; profileNodeList.item(i).innerText\n        Next i\n    End With\nEnd Sub\n\nPublic Function GetURL(ByVal htmlSection As String) As String\n    Const BASESTRING As String = \"https://www.xing.com/profile/\"\n    Dim arr() As String\n    arr = Split(htmlSection, \"/\")\n    GetURL = BASESTRING &amp; Replace$(Split((arr(UBound(arr) - 1)), \"&gt;\")(0), Chr$(34), vbNullString)\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Example return information:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/zYf2b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zYf2b.png\" alt=\"Output example\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 7590076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/295f45f7e3f068f786c5346667849f4b?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/7590076/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 719, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1560702403, "creation_date": 1497428531, "last_edit_date": 1560702403, "question_id": 44539310, "link": "https://stackoverflow.com/questions/44539310/web-query-where-there-are-multiple-frames", "title": "Web Query where there are multiple Frames", "body": "<p>My goal is to scrape the source code of a web page.</p>\n\n<p>The site seems to have different Frames which is why my code won't work properly.</p>\n\n<p>I tried to modify a code which I found online which should solve the Frame issue.</p>\n\n<p>The following code creates an error (object required) at:  </p>\n\n<p><code>Set profileFrame .document.getElementById(\"profileFrame\")</code></p>\n\n<pre><code>Public Sub IE_Automation()\n\n 'Needs references to Microsoft Internet Controls and Microsoft HTML Object Library\n\nDim baseURL As String\nDim IE As InternetExplorer\nDim HTMLdoc As HTMLDocument\nDim profileFrame As HTMLIFrame\nDim slotsDiv As HTMLDivElement\n\n'example URL with multiple frames\nbaseURL = \"https://www.xing.com/search/members?section=members&amp;keywords=IT&amp;filters%5Bcontact_level%5D=non_contact\"\n\nSet IE = New InternetExplorer\nWith IE\n    .Visible = True\n\n     'Navigate to the main page\n\n    .navigate baseURL &amp; \"/publictrophy/index.htm?onlinename=ace_anubis\"\n    While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n\n     'Get the profileFrame iframe and navigate to it\n\n    Set profileFrame = .document.getElementById(\"profileFrame\")\n\n    .navigate baseURL &amp; profileFrame.src\n    While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n\n    Set HTMLdoc = .document\nEnd With\n\n 'Display all the text in the profileFrame iframe\n\nMsgBox HTMLdoc.body.innerText\n\n'Display just the text in the slots_container div\n\nSet slotsDiv = HTMLdoc.getElementById(\"slots_container\")\nMsgBox slotsDiv.innerText\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1497427850, "post_id": 44539016, "comment_id": 76068809, "body": "(1) Use <code>objListObj.Resize Range(&quot;A1:D&quot; &amp; IncreasedRange)</code> to append a variable value to an existing string. Otherwise the variable name would be recognized as part of the string. (2) Always use <code>Long</code> instead of <code>Integer</code>, Excel has more rows than <code>Integer</code> can handle."}, {"owner": {"reputation": 457, "user_id": 7924493, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/227be45ef8a37f0eba642e8cce1b4624?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7924493/jordan"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1497428328, "post_id": 44539016, "comment_id": 76069135, "body": "I got the following error when i tried that : Rum-time error &#39;13&#39; typ mismatch"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1497428595, "post_id": 44539016, "comment_id": 76069282, "body": "Better to specify the sheet too: <code>objListObj.Resize wrksht.Range(&quot;A1:D&quot; &amp; IncreasedRange)</code>"}, {"owner": {"reputation": 457, "user_id": 7924493, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/227be45ef8a37f0eba642e8cce1b4624?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7924493/jordan"}, "edited": false, "score": 0, "creation_date": 1497428772, "post_id": 44539016, "comment_id": 76069397, "body": "Now i seem to be getting the following error when changing the value  &quot; The range you have specified is invalid......&quot;   any ideas?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1497431310, "post_id": 44539016, "comment_id": 76071226, "body": "This is probably because <code>IncreasedRange</code> is <code>0</code> because <code>Worksheets(&quot;Sheet1&quot;).Cells(3, &quot;G&quot;).Value</code> is empty or no valid number."}, {"owner": {"reputation": 457, "user_id": 7924493, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/227be45ef8a37f0eba642e8cce1b4624?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7924493/jordan"}, "edited": false, "score": 0, "creation_date": 1497433047, "post_id": 44539016, "comment_id": 76072456, "body": "Yes you are correct! Thank you! Another question:  I&#39;m trying to delete rows in a specifc range. I tried this:   Range(&quot;A&quot;&amp;IncreasedRange &quot;:D&quot;&amp;CurrentSize)).Delete Shift:=xlToLeft                                                                                              But it does not seem to work."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1497435378, "post_id": 44539016, "comment_id": 76074203, "body": "Because you missed a <code>&amp;</code>, you need to connect all variable names and string parts like <code>Range(&quot;A&quot; &amp; IncreasedRange &amp; &quot;:D&quot; &amp; CurrentSize).Delete Shift:=xlToLeft</code>"}], "owner": {"reputation": 457, "user_id": 7924493, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/227be45ef8a37f0eba642e8cce1b4624?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7924493/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2658, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499246062, "creation_date": 1497427658, "last_edit_date": 1499246062, "question_id": 44539016, "link": "https://stackoverflow.com/questions/44539016/resize-table-vba-excel", "title": "Resize Table VBA Excel", "body": "<p>I currently have table that ranges from A1:D1</p>\n\n<p>I want to resize it from A1:DIncreasedRange where IncreasedRanged is a Value(Integer) found in cell G3. I have tried that following:</p>\n\n<pre><code>Sub ResizeList()\n  Dim wrksht As Worksheet\n  Dim objListObj As ListObject\n  Dim IncreasedRange As Ingter\n\n  Set wrksht = ActiveWorkbook.Worksheets(\"Sheet1\")\n  Set objListObj = wrksht.ListObjects(\"Table1\")\n\n  IncreasedRange = Worksheets(\"Sheet1\").Cells(3, \"G\").Value\n  MsgBox (IncreasedRange)\n\n  objListObj.Resize Range(\"A1:(D+IncreasedRange)\")\nEnd Sub\n</code></pre>\n\n<p>If I try: </p>\n\n<pre><code>objListObj.Resize Range(\"A1:D15)\")\n</code></pre>\n\n<p>The code works fine otherwise I get an error. Any ideas?<br>\nI have also tried:</p>\n\n<pre><code> objListObj.Resize objListObj.Resize Range(IncreasedRange)\n</code></pre>\n"}, {"tags": ["excel", "vba", "controls", "activex"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 2, "creation_date": 1497427728, "post_id": 44538952, "comment_id": 76068715, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1497427761, "post_id": 44538952, "comment_id": 76068744, "body": "I&#39;ve reformatted the code blocks, we don&#39;t use BBCode here - it&#39;s Markdown. There&#39;s a formatting button in the editor."}, {"owner": {"reputation": 1, "user_id": 8159053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ff02a995ec2fcbbc797155b2e4468e?s=128&d=identicon&r=PG&f=1", "display_name": "Emmanuel Horvat", "link": "https://stackoverflow.com/users/8159053/emmanuel-horvat"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1497428624, "post_id": 44538952, "comment_id": 76069301, "body": "I have read the Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers? post"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1497430225, "post_id": 44538952, "comment_id": 76070385, "body": "I will roll back your edit, please do not add it again. If you wish to insist upon it, please ping me first with <code>@halfer</code>, so we can involve a moderator. Adding it really does not help you. Thank you."}], "owner": {"reputation": 1, "user_id": 8159053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ff02a995ec2fcbbc797155b2e4468e?s=128&d=identicon&r=PG&f=1", "display_name": "Emmanuel Horvat", "link": "https://stackoverflow.com/users/8159053/emmanuel-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497430238, "creation_date": 1497427441, "last_edit_date": 1497430238, "question_id": 44538952, "link": "https://stackoverflow.com/questions/44538952/excel-tab-between-controls-not-keydown-activate-worksheet", "title": "Excel Tab between Controls NOT Keydown &gt; Activate (Worksheet)", "body": "<p>I'm working on a small project for my manager at work and its related to some kind of a appraisal form. So I created a document full with text boxes made with ActiveX controls.</p>\n\n<p>They're placed within a worksheet so not a user-form. I have been looking through forums and eventually came to this forum and got a answer to do this.</p>\n\n<pre><code>Public Sub f2_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = 9 Then f3.Activate\nEnd Sub\n</code></pre>\n\n<p>This works really well but I stumble into a problem. I got 37 text boxes named f1-f37, this line of code forces me to retype the code 37 times.</p>\n\n<p>I asked colleagues one told me to make a parameter and call the parameter. I have no experience with this but I think it's not what I want.</p>\n\n<p>What I would like is a piece of code that switches from a f1>f2>f3>f4....\nIs this possible in a loop or a piece of code containing variables?</p>\n\n<pre><code>'Declaration of the fields, something like this\nf(x) as textbox\n\nTAB pressed \n    Activate f(x)\n        if pressed again.\n           Activate f(x) ' This will be the next f(x) in the worksheet\n             'and so on\n</code></pre>\n\n<p>I have no experience in VBA as you see above.</p>\n"}, {"tags": ["vba", "excel", "unicode", "locale"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1497427270, "post_id": 44538401, "comment_id": 76068418, "body": "I wonder what happens if you hard-code the symbols using <code>.Frame1.Caption = Chr(123)&amp;Chr(456) etc.</code> Then ofcourse you need to fill in the right ascii numbers for the symbols"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1497427307, "post_id": 44538401, "comment_id": 76068438, "body": "This is due to lacking unicode support. There are workarounds like <a href=\"https://groups.google.com/forum/#!topic/microsoft.public.office.developer.vba/O0_MG0n9tOU\" rel=\"nofollow noreferrer\">this</a> but they&#39;re really cumbersome."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1497427543, "post_id": 44538401, "comment_id": 76068600, "body": "@Luuklag ASCII != Unicode. You will at least need <code>ChrW()</code> to get a unicode character (see <a href=\"https://msdn.microsoft.com/en-us/library/613dxh46(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Chr, ChrW Functions</a>)."}, {"owner": {"reputation": 51, "user_id": 6732010, "user_type": "registered", "profile_image": "https://graph.facebook.com/860416920755754/picture?type=large", "display_name": "Alexandr  Panchenko", "link": "https://stackoverflow.com/users/6732010/alexandr-panchenko"}, "edited": false, "score": 0, "creation_date": 1497437134, "post_id": 44538401, "comment_id": 76075475, "body": "thanks,its some part help me:"}, {"owner": {"reputation": 51, "user_id": 6732010, "user_type": "registered", "profile_image": "https://graph.facebook.com/860416920755754/picture?type=large", "display_name": "Alexandr  Panchenko", "link": "https://stackoverflow.com/users/6732010/alexandr-panchenko"}, "edited": false, "score": 0, "creation_date": 1497437592, "post_id": 44538401, "comment_id": 76075805, "body": "<a href=\"https://pastebin.com/tWEVGAFm\" rel=\"nofollow noreferrer\">pastebin.com/tWEVGAFm</a> its help for MsgBox, but how can apply for UserForm head and for Inputbox?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1497439142, "post_id": 44538401, "comment_id": 76076994, "body": "For a UserForm the approach you posted doesn&#39;t work. Therefore you need a completely different approach. Have a look <a href=\"https://groups.google.com/d/msg/microsoft.public.office.developer.vba/O0_MG0n9tOU/kmGVLwKBcK0J\" rel=\"nofollow noreferrer\">here</a> to get an idea. Doing this is fiddling around a lot there is no neat solution."}], "owner": {"reputation": 51, "user_id": 6732010, "user_type": "registered", "profile_image": "https://graph.facebook.com/860416920755754/picture?type=large", "display_name": "Alexandr  Panchenko", "link": "https://stackoverflow.com/users/6732010/alexandr-panchenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497426695, "creation_date": 1497425842, "last_edit_date": 1592644375, "question_id": 44538401, "link": "https://stackoverflow.com/questions/44538401/excel-fragmentary-unicode-support-can-it-change", "title": "Excel fragmentary unicode support - can it change?", "body": "<p>If I use unicode symbol in Excel files, its some part looks correct, some times - no.</p>\n<p>As example I use Russian, and macro assign label for UserForm window, key, form element, and for MsgBox calling button.\nBut in form element it looks correct, in UserForm head - i see ???, and in MsgBox too.</p>\n<p>You can see into this screenshot:\n<a href=\"https://i.stack.imgur.com/Vx8df.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vx8df.png\" alt=\"problem\" /></a></p>\n<p>Or use this file for test this:\n<a href=\"https://1drv.ms/x/s!AgThWBJfRj69vBbRCIWgvMjHq-nm\" rel=\"nofollow noreferrer\">https://1drv.ms/x/s!AgThWBJfRj69vBbRCIWgvMjHq-nm</a></p>\n<p>So, if you know way to slowe this problem (I need show all symbol) - write me</p>\n<p>This problem have solution - change locale for non-unicode symbol. But I can't do this into all my client computer, as example.</p>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1497424897, "post_id": 44537729, "comment_id": 76066864, "body": "&quot;<i>Will my code crash?</i>&quot;: Really? Is this the sixty-four-thousand-dollar question? Why just don&#39;t you backup your file and run the code and see what happens? Just to say: Code review questions are meant to be off-topic here. You need to ask a <i>specific</i> question to an issue you have with your code (see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1497424903, "post_id": 44537729, "comment_id": 76066865, "body": "Side note: (1) If you declare <code>Dim ldata, lcodes As Long</code> then only the last variable is of type <code>Long</code> the first remains <code>Variant</code>. You need to specify a type for <b>every</b> variable like <code>Dim ldata As Long, lcodes As Long</code>. (2) Never use <code>Integer</code> unless you communicate with old APIs. Always use <code>Long</code> instead, especially for row counts, because Excel has more rows than <code>Integer</code> can handle. Read <a href=\"https://stackoverflow.com/a/26409520/3219613\">here</a> for some background about Integer and Long."}], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1497424188, "creation_date": 1497424188, "answer_id": 44537854, "question_id": 44537729, "link": "https://stackoverflow.com/questions/44537729/count-string-within-string-using-vba/44537854#44537854", "title": "Count string within string using VBA", "body": "<p>Seems your code is OK. But if you want to match only the first part of string (a'ka StartsWith), i'd change only this line:</p>\n\n<pre><code>If InStr(Worksheets(\"Sheet1\").Range(\"C\" &amp; j), Range(\"C\" &amp; i)) &lt;&gt; 0 Then\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>If Worksheets(\"Sheet1\").Range(\"C\" &amp; j) Like Range(\"C\" &amp; i) &amp; \"*\" Then\n</code></pre>\n\n<p>For further details, please see: <a href=\"https://msdn.microsoft.com/en-us/library/ee440632(v=office.12).aspx\" rel=\"nofollow noreferrer\">Wildcard Characters used in String Comparisons</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6637260"}, "is_accepted": false, "score": 0, "last_activity_date": 1497424647, "last_edit_date": 1497424647, "creation_date": 1497424288, "answer_id": 44537877, "question_id": 44537729, "link": "https://stackoverflow.com/questions/44537729/count-string-within-string-using-vba/44537877#44537877", "title": "Count string within string using VBA", "body": "<p>Use Dictionnary</p>\n\n<pre><code>Dim Dict As Scripting.Dictionary\nSet Dict = New Scripting.Dictionary\n\nArr = Split(\"refer your text here\", \"_\")\n\nFor I = LBound(Arr) To UBound(Arr)\n    If Dict.Exists(Arr(I)) Then\n        Dict(Arr(I)) = Dict(Arr(I)) + 1 'increment\n    Else\n        Dict.Add Arr(I), 1\n    End If\nNext I\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "edited": false, "score": 0, "creation_date": 1497434894, "post_id": 44538983, "comment_id": 76073871, "body": "Thanks, this works well for me. Yes, I knew about NP, NPA thing. It&#39;s OK for this version. I will just try to edit it, so if the code is first part of the string, then not to count them. And also if the count is zero, then to left blank."}, {"owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "edited": false, "score": 0, "creation_date": 1497435710, "post_id": 44538983, "comment_id": 76074434, "body": "Also, when I try to add more keywords like &quot;NP&quot; it still counts them."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "edited": false, "score": 0, "creation_date": 1497437779, "post_id": 44538983, "comment_id": 76075963, "body": "you need to add a line in the <code>if</code> statement after the NP line <code>(InStr(1, VntItem, &quot;NewValue&quot;) = 0) And _</code>."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1497427516, "creation_date": 1497427516, "answer_id": 44538983, "question_id": 44537729, "link": "https://stackoverflow.com/questions/44537729/count-string-within-string-using-vba/44538983#44538983", "title": "Count string within string using VBA", "body": "<p>This may be OTT for the requirement but should work quite quickly.</p>\n\n<pre><code>Public Sub Sample()\nDim WkSht       As Worksheet\nDim LngRow      As Long\nDim AryLookup() As String\nDim VntItem     As Variant\n\n'We put what we want to search into an array, this makes it a lot quicker to search\nSet WkSht = ThisWorkbook.Worksheets(\"Sheet1\")\n    ReDim AryLookup(0)\n    LngRow = 1\n    Do Until WkSht.Range(\"A\" &amp; LngRow) = \"\"\n        If AryLookup(UBound(AryLookup, 1)) &lt;&gt; \"\" Then ReDim Preserve AryLookup(UBound(AryLookup, 1) + 1)\n        AryLookup(UBound(AryLookup, 1)) = Trim(UCase(WkSht.Range(\"A\" &amp; LngRow)))\n        LngRow = LngRow + 1\n    Loop\nSet WkSht = Nothing\n\n'Then we go down the list and check the array against each item\nSet WkSht = ActiveSheet\n    LngRow = 1\n    Do Until WkSht.Range(\"A\" &amp; LngRow) = \"\"\n        WkSht.Range(\"B\" &amp; LngRow) = 0\n        For Each VntItem In AryLookup()\n\n            'This looks for the match without any of the exclusion items\n            If (InStr(1, VntItem, Trim(UCase(WkSht.Range(\"A\" &amp; LngRow)))) &lt;&gt; 0) And _\n                (InStr(1, VntItem, \"NP\") = 0) And _\n                (InStr(1, VntItem, \"ISK\") = 0) Then\n                WkSht.Range(\"B\" &amp; LngRow) = WkSht.Range(\"B\" &amp; LngRow) + 1\n            End If\n        Next\n        LngRow = LngRow + 1\n    Loop\nSet WkSht = Nothing\n\nMsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n\n<p>Basically, the 60,000 data strings will go into an array in memory, then the array will be searched against the 1,000 products. Searching in memory should be quick.</p>\n\n<p>One thing I would raise is the exclusion method may produce false positives.</p>\n\n<p>For example, excluding <code>NP</code> will exclude: -</p>\n\n<p><code>NP_41533258_DO-003_14910884</code></p>\n\n<p><code>NPA_41533258_DO-003_14910884</code></p>\n\n<p><code>41533258_ANP_DO-003_14910884</code></p>\n\n<p>You may want to think about the method overall.</p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1497428617, "creation_date": 1497428617, "answer_id": 44539334, "question_id": 44537729, "link": "https://stackoverflow.com/questions/44537729/count-string-within-string-using-vba/44539334#44539334", "title": "Count string within string using VBA", "body": "<p>Have you considered an array formula, not sure how it will perform vs code, but, you could do something along these lines, where list is in A and prod numbers in B</p>\n\n<p><code>=SUM(IF(NOT(ISERR(SEARCH(B1 &amp; \"_\",$A$1:$A$5,1)))*(ISERR(SEARCH(\"NP_\",$A$1:$A$5,1))),1,0))</code></p>\n\n<p>Where \"NP\" would be replaced by a range containing the exclusions, I've left as NP to show what's happening.</p>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1497454117, "last_edit_date": 1497454117, "creation_date": 1497453715, "answer_id": 44548784, "question_id": 44537729, "link": "https://stackoverflow.com/questions/44537729/count-string-within-string-using-vba/44548784#44548784", "title": "Count string within string using VBA", "body": "<p>The code would be like this. But I don't know the speed.</p>\n\n<pre><code>Sub test()\n    Dim vDB, vLook, vSum(), Sum As Long\n    Dim Ws As Worksheet, dbWs As Worksheet\n    Dim s As String, sF As String, sCode As String\n    Dim i As Long, j As Long, n As Long\n\n    Set dbWs = Sheets(\"Sheet1\")\n    Set Ws = ActiveSheet\n\n    With Ws\n        vLook = .Range(\"a1\", .Range(\"a\" &amp; Rows.Count).End(xlUp))\n    End With\n    With dbWs\n        vDB = .Range(\"c1\", .Range(\"c\" &amp; Rows.Count).End(xlUp))\n    End With\n\n    n = UBound(vLook, 1)\n\n    ReDim vSum(1 To n, 1 To 1)\n    For i = 1 To n\n        sF = Split(vLook(i, 1), \"-\")(0)\n        sCode = Replace(vLook(i, 1), sF, \"\")\n        Sum = 0\n        For j = 1 To UBound(vDB, 1)\n            s = vDB(j, 1)\n            If Left(s, Len(sF)) = sF Or InStr(s, \"NP\") Or InStr(s, \"ISK\") Then\n            Else\n                If InStr(s, sCode) Then\n                    Sum = Sum + 1\n                End If\n            End If\n        Next j\n        If Sum &gt; 0 Then\n            vSum(i, 1) = Sum\n        End If\n    Next i\n    Ws.Range(\"h1\").Resize(n) = vSum\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1497454117, "creation_date": 1497423814, "last_edit_date": 1497424620, "question_id": 44537729, "link": "https://stackoverflow.com/questions/44537729/count-string-within-string-using-vba", "title": "Count string within string using VBA", "body": "<p>I have product codes: (they are in C column of active sheet)</p>\n\n<pre><code>DO-001\nDO-002\nDO-003\nDO-004\n</code></pre>\n\n<p>And I have big list of data: (they are in C column of \"Sheet1\")</p>\n\n<pre><code>41300100_DO-001_14215171\n41300104_DO-001_14215173\nK1_ISK_41300661_DO-002_13190369\nNP_41533258_DO-003_14910884\nDO-003_DD_44_ddd\n</code></pre>\n\n<p>And I want to count how many times do the product codes appear in the list of data. So the result for this case'd be: (result is H column of active sheet)</p>\n\n<pre><code>DO-001   2\nDO-002   1\nDO-003   2\nDO-004 \n</code></pre>\n\n<p>I have done this with this code:</p>\n\n<pre><code>Sub CountcodesPLC()\n    Dim i, j As Integer, icount As Integer\n    Dim ldata, lcodes As Long\n\n    icount = 0\n\n    lcodes = Cells(Rows.Count, 3).End(xlUp).Row\n    ldata = Worksheets(\"Sheet1\").Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 10 To lcodes\n        For j = 2 To ldata\n            If InStr(Worksheets(\"Sheet1\").Range(\"C\" &amp; j), Range(\"C\" &amp; i)) &lt;&gt; 0 Then\n                icount = icount + 1\n            End If\n        Next j\n\n        If icount &lt;&gt; 0 Then\n            Range(\"H\" &amp; i).Value = icount\n        End If\n\n       icount = 0\n    Next i\nEnd Sub\n</code></pre>\n\n<p>But I want to change it, so if the list of data contains some key words like \"NP\", \"ISK\", then not to count them, or if the first part of the data is the code then also not to count them, so the result for this example would be:</p>\n\n<pre><code>DO-001   2\nDO-002 \nDO-003 \nDO-004\n</code></pre>\n\n<p>Also, I'll have around 1.000 product codes, and around 60.000 strings of data.\nWill my code crash?   </p>\n"}, {"tags": ["sql-server", "vba"], "answers": [{"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1497420541, "last_edit_date": 1497420541, "creation_date": 1497420071, "answer_id": 44536610, "question_id": 44536545, "link": "https://stackoverflow.com/questions/44536545/vba-connecting-to-sql-server/44536610#44536610", "title": "VBA connecting to SQL Server", "body": "<p><a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/open-method-ado-recordset\" rel=\"nofollow noreferrer\"><code>Open</code></a> is a method, and cannot be set with an <code>=</code>.</p>\n\n<p>You probably want something like this:</p>\n\n<pre><code>rs.Open \"SELECT * FROM [dbo].[Version]\", conn\n</code></pre>\n\n<p>Once you have called <code>Open</code>, then you can iterate through the Recordset's rows using the <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/bof-eof-properties-ado\" rel=\"nofollow noreferrer\"><code>EOF</code></a> property and the <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado\" rel=\"nofollow noreferrer\"><code>MoveNext</code></a> method:</p>\n\n<pre><code>Do While Not rs.EOF\n    Debug.Print rs.Fields(1)\n    'You could also use rs!FieldName, where FieldName is the name of a column\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "is_accepted": false, "score": 0, "last_activity_date": 1502363621, "creation_date": 1502363621, "answer_id": 45612145, "question_id": 44536545, "link": "https://stackoverflow.com/questions/44536545/vba-connecting-to-sql-server/45612145#45612145", "title": "VBA connecting to SQL Server", "body": "<p>Change your code to the following:</p>\n\n<pre><code>Set cmd = New ADODB.Command\ncmd.CommandText = \"SELECT * FROM [dbo].[Version]\"\ncmd.CommandType = adCmdText\ncmd.ActiveConnection = conn\n\nSet rs = cmd.Execute\n\nDo While Not rs.EOF\n    'do something with rs.Fields(0) '\n    rs.MoveNext\nLoop\nSet conn = Nothing\nSet cmd = Nothing\n</code></pre>\n\n<p>rs.Fields is a zero based collection that means that the first field is 0, not 1.\nYou can get subsequent fields by rs.Fields(1), rs.Fields(2) etc. Or you can use Field names, with the syntax rs.Fields(\"MyFieldName\").</p>\n\n<p>Note when using a string command (\"SELECT * FROM ..\") the CommandType is adCmdText. The syntax for the Recordset is SET rs = cmd.Execute.  Also you must invoke MoveNext in your loop, otherwise you get stuck in the loop!</p>\n"}], "owner": {"reputation": 61, "user_id": 8062937, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/655dfbcc5bca69c8730796e2c1735924?s=128&d=identicon&r=PG&f=1", "display_name": "jangho yoon", "link": "https://stackoverflow.com/users/8062937/jangho-yoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502363621, "creation_date": 1497419835, "last_edit_date": 1502362340, "question_id": 44536545, "link": "https://stackoverflow.com/questions/44536545/vba-connecting-to-sql-server", "title": "VBA connecting to SQL Server", "body": "<p>I am having trouble when connecting VBA to SQL Server:</p>\n\n<pre><code>Sub ConnectSQLServer()\n\nDim cmd As ADODB.Command\nDim conn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim strConn As String\n\nDim par As ADODB.Parameter\nDim strSQL As String\n\nstrConn = \"DRIVER=SQL Server;SERVER=CHU-AS-0004;DATABASE=RTC_LaplaceD_DEV;Trusted_Connection=Yes;\"\n\nSet conn = New ADODB.Connection\nconn.Open strConn\n\nSet cmd = New ADODB.Command\ncmd.CommandText = \"dbo.Version\"\ncmd.CommandType = adCmdStoredProc\ncmd.ActiveConnection = conn\n\nrs.Open = \"SELECT * FROM [dbo].[Version]\"\n\ncmd.Execute rs\nSet conn = Nothing\nSet cmd = Nothing\n\n\nsConnString = \"\"\nEnd Sub\n</code></pre>\n\n<p>I just want to select all values from the table named <code>[dbo].[Version]</code>, but when I execute it, I get an error:</p>\n\n<blockquote>\n  <p>Compile error: Expected Function or Variable' </p>\n</blockquote>\n\n<p>and the line with <code>rs.Open</code> is highlighted.</p>\n\n<p>Would you help me to solve this problem? </p>\n"}, {"tags": ["vba", "internet-explorer"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1497419914, "post_id": 44536315, "comment_id": 76064023, "body": "Try <code>While Site.Busy Or Site.ReadyState &lt;&gt; 4: DoEvents: Wend</code>."}, {"owner": {"reputation": 21, "user_id": 8158342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64f518bb9d5cf6d91ebb3b0f95fd511?s=128&d=identicon&r=PG&f=1", "display_name": "Kaktus Kaktus", "link": "https://stackoverflow.com/users/8158342/kaktus-kaktus"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1497428394, "post_id": 44536315, "comment_id": 76069165, "body": "Super , It&#39;s works"}, {"owner": {"reputation": 21, "user_id": 8158342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64f518bb9d5cf6d91ebb3b0f95fd511?s=128&d=identicon&r=PG&f=1", "display_name": "Kaktus Kaktus", "link": "https://stackoverflow.com/users/8158342/kaktus-kaktus"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1498050691, "post_id": 44536315, "comment_id": 76338344, "body": "I have another problem , now is error nbr &#39;424&#39; Obect required. hen I debug in this moment everything works good."}], "answers": [{"tags": [], "owner": {"reputation": 604, "user_id": 3064448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LOvOX.png?s=128&g=1", "display_name": "davinceleecode", "link": "https://stackoverflow.com/users/3064448/davinceleecode"}, "is_accepted": false, "score": 0, "last_activity_date": 1576597368, "creation_date": 1576597368, "answer_id": 59377632, "question_id": 44536315, "link": "https://stackoverflow.com/questions/44536315/logging-on-to-website-error-getelementbyid-runtime-error-91/59377632#59377632", "title": "Logging on to website error: getElementById runtime error 91", "body": "<p>Try this code below:</p>\n\n<p>Create a module and place this code below:</p>\n\n<pre><code>Public Site As New InternetExplorer\n</code></pre>\n\n<p><br/>\nHere is your new fb_login function:</p>\n\n<pre><code>    Dim FB_ID As String\n    Dim FB_PW As String\n    Dim URL As String\n    Dim oHTMLDoc As Object\n\n\n    URL = \"Facebook.com\"\n\n    FB_ID = InputBox(\"Podaj adress e-mail do logowania\")\n    FB_PW = InputBox(\"Podaj Haslo FB\")\n\n\n    Site.Navigate2 URL\n    Site.Visible = True\n\n    WaitWhileBrowserIsLoading 1500\n\n    Set oHTMLDoc = Site.document\n\n    oHTMLDoc.getElementById(\"email\").Value = FB_ID\n    oHTMLDoc.getElementById(\"pass\").Value = FB_PW\n    oHTMLDoc.getElementById(\"loginbutton\").Click\n</code></pre>\n\n<p><br/>\nInclude this function below for checking the browser's state:</p>\n\n<pre><code>Public Sub WaitWhileBrowserIsLoading(Optional intWaitForBrowserToBecomeBusy As Integer = 0, Optional timeOutSeconds As Double = 0)\n    With Site\n        'wait for the browser to become busy to avoid skipping through without checking\n        If intWaitForBrowserToBecomeBusy = 0 Then\n            Sleep 800\n        Else\n            Sleep intWaitForBrowserToBecomeBusy\n        End If\n\n        Dim startTime As Double\n        startTime = Timer\n        Dim timePassed As Double\n        timePassed = 0\n        'Wait IE\n        Do While .readyState &lt;&gt; READYSTATE_COMPLETE\n            Sleep 100\n            DoEvents\n            If timeOutSeconds &lt;&gt; 0 Then\n                timePassed = Timer - startTime\n                If timePassed &gt; timeOutSeconds Then Exit Sub\n            End If\n        Loop\n        'Wait document\n        Do While .document.readyState &lt;&gt; \"complete\"\n            Sleep 100\n        Loop\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8158342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64f518bb9d5cf6d91ebb3b0f95fd511?s=128&d=identicon&r=PG&f=1", "display_name": "Kaktus Kaktus", "link": "https://stackoverflow.com/users/8158342/kaktus-kaktus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1587971982, "creation_date": 1497418890, "last_edit_date": 1587971982, "question_id": 44536315, "link": "https://stackoverflow.com/questions/44536315/logging-on-to-website-error-getelementbyid-runtime-error-91", "title": "Logging on to website error: getElementById runtime error 91", "body": "<p>I have VBA code to log on to Facebook. When I start I have a </p>\n\n<blockquote>\n  <p>runtime error 91  \"Object variable or with block variable not set\".</p>\n</blockquote>\n\n<p>When I debug everything works.</p>\n\n<pre><code>Option Explicit\n\nSub FB_Login()\n    Dim Site As Object\n    Set Site = CreateObject(\"InternetExplorer.application\")\n    Dim FB_ID As String\n    Dim FB_PW As String\n    Dim URL As String\n    Dim oHTMLDoc As Object\n\n    FB_ID = InputBox(\"Podaj adress e-mail do logowania\")\n    FB_PW = InputBox(\"Podaj Has\u0142o FB\")\n\n    Site.Visible = False\n\n    URL = \"Facebook.com\"\n\n    Site.navigate URL\n    While Site.busy\n    Wend\n\n    Set oHTMLDoc = Site.document\n\n    oHTMLDoc.getElementById(\"email\").Value = \"\"    'Gives error\n    oHTMLDoc.getElementById(\"email\").Value = FB_ID    'Gives error\n    oHTMLDoc.getElementById(\"pass\").Value = FB_PW  'Run-time error '424'\n    oHTMLDoc.getElementById(\"loginbutton\").Click   'Object required\n\n    While Site.busy\n    Wend\n    Site.Visible = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8117827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/432da8532025fda7caefef26b7cf84e4?s=128&d=identicon&r=PG&f=1", "display_name": "herman925", "link": "https://stackoverflow.com/users/8117827/herman925"}, "edited": false, "score": 0, "creation_date": 1497417737, "post_id": 44535838, "comment_id": 76063051, "body": "Thanks! Now I&#39;ve learned something new again - it&#39;s .Controls!  And how could I forget about Exit For.....thanks~~~"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1497424162, "post_id": 44535838, "comment_id": 76066322, "body": "You&#39;ll get errors if there&#39;s other types of controls on the userform."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1497416723, "creation_date": 1497416723, "answer_id": 44535838, "question_id": 44535704, "link": "https://stackoverflow.com/questions/44535704/excel-userform-check-if-all-checkboxes-in-a-userform-are-checked/44535838#44535838", "title": "(Excel Userform) Check if all checkboxes in a Userform are checked", "body": "<p>You can do this by:</p>\n\n<ul>\n<li>assume that all checkboxes are checked by setting a flag to <code>True</code></li>\n<li>iterate the checkboxes and if one is not checked set the flag to <code>False</code> and exit</li>\n<li>at the end of the loop, if all checkboxes were checked then the flag is still <code>True</code></li>\n</ul>\n\n<p>You can refer to the checkboxes dynamically by using the <code>Me.Controls</code> collection and pass in the name of the checkbox like <code>\"Step1_\" &amp; i</code>.</p>\n\n<p>Example code:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Step1_Confirm_Click()\n\n    Dim i As Long '&lt;-- use Long, not Byte\n    Dim blnResult As Boolean\n\n    ' set a flag to assume that it is true that all checkboxes are checked\n    blnResult = True\n\n    ' get the value of each check box\n    For i = 1 To 4\n        If Me.Controls(\"Step1_\" &amp; i).Value = False Then\n            blnResult = False\n            Exit For '&lt;-- skip loop if at least one box not checked\n        End If\n    Next i\n\n    ' check the value of the flag\n    If blnResult = False Then\n        MsgBox \"Please make sure you have done all\"\n    Else\n        ' all boxes checked ...\n        MsgBox \"All checked\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 8117827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/432da8532025fda7caefef26b7cf84e4?s=128&d=identicon&r=PG&f=1", "display_name": "herman925", "link": "https://stackoverflow.com/users/8117827/herman925"}, "edited": false, "score": 0, "creation_date": 1497417802, "post_id": 44535881, "comment_id": 76063075, "body": "Yes I later thought about this myself and I actually made it work. And of course your solution worked too! Thanks"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 8117827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/432da8532025fda7caefef26b7cf84e4?s=128&d=identicon&r=PG&f=1", "display_name": "herman925", "link": "https://stackoverflow.com/users/8117827/herman925"}, "edited": false, "score": 0, "creation_date": 1497417900, "post_id": 44535881, "comment_id": 76063118, "body": "@herman925 your;e welcome, since you accepted Robi&#39;;s answer, you can upvote mine (if it helped you)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1497423541, "post_id": 44535881, "comment_id": 76065961, "body": "I upvoted you just for using <code>TypeName</code> and not <code>TypeOf</code> ;)"}, {"owner": {"reputation": 51, "user_id": 8117827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/432da8532025fda7caefef26b7cf84e4?s=128&d=identicon&r=PG&f=1", "display_name": "herman925", "link": "https://stackoverflow.com/users/8117827/herman925"}, "edited": false, "score": 0, "creation_date": 1497601191, "post_id": 44535881, "comment_id": 76156290, "body": "@ShaiRado Yes it did! It broadened by scope of experience to do something else similar in the future"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1497416907, "creation_date": 1497416907, "answer_id": 44535881, "question_id": 44535704, "link": "https://stackoverflow.com/questions/44535704/excel-userform-check-if-all-checkboxes-in-a-userform-are-checked/44535881#44535881", "title": "(Excel Userform) Check if all checkboxes in a Userform are checked", "body": "<p>Try the code below (explanations inside the code as comments):</p>\n\n<pre><code>Private Sub Step1_Confirm_Click()\n\nDim i As Long\nDim Ctrl As Control\n\n' loop through all user_form control\nFor Each Ctrl In IOSP_Acc_R_Approval.Controls\n    If TypeName(Ctrl) = \"CheckBox\" Then ' check if control type is Check-Box\n        If Ctrl.Value = True Then ' check if check-box is checked\n            i = i + 1\n        End If\n    End If\nNext Ctrl\n\nIf i &lt; 4 Then ' not all 4 check-boxes are checked\n    MsgBox \"Please make sure you have done all\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6637260"}, "is_accepted": false, "score": 0, "last_activity_date": 1497424001, "creation_date": 1497424001, "answer_id": 44537789, "question_id": 44535704, "link": "https://stackoverflow.com/questions/44535704/excel-userform-check-if-all-checkboxes-in-a-userform-are-checked/44537789#44537789", "title": "(Excel Userform) Check if all checkboxes in a Userform are checked", "body": "<pre><code>    Done=true \nFor i = 1 To 4\n            Done = Done*Step1_(i).value\n        Next i\nif done `then`\nmsgbox \"All checkboxes are checked\"\nend if\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8117827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/432da8532025fda7caefef26b7cf84e4?s=128&d=identicon&r=PG&f=1", "display_name": "herman925", "link": "https://stackoverflow.com/users/8117827/herman925"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4225, "favorite_count": 0, "accepted_answer_id": 44535838, "answer_count": 3, "score": 2, "last_activity_date": 1497424001, "creation_date": 1497415944, "last_edit_date": 1531164843, "question_id": 44535704, "link": "https://stackoverflow.com/questions/44535704/excel-userform-check-if-all-checkboxes-in-a-userform-are-checked", "title": "(Excel Userform) Check if all checkboxes in a Userform are checked", "body": "<p>Never tried UserForm checkboxes before so I don't even know how to point to the Checkboxes in a Userform.</p>\n\n<p>This is what I have at the moment....and I know, I know, it is completely wrong. Please help?</p>\n\n<pre><code>Private Sub Step1_Confirm_Click()\n    Dim i As Byte\n    Dim Done As Boolean\n\n    For i = 1 To 4\n        If Step1_(i).value = True Then\n            Done = True\n        End If\n    Next i\n\n    If Not Done = True Then\n        MsgBox \"Please make sure you have done all\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Basically I have:</p>\n\n<ol>\n<li><p>A Userform called <code>IOSP_Acc_R_Approval_Step1</code></p></li>\n<li><p>4 checkboxes called <code>Step1_1</code>; <code>Step1_2</code>; <code>Step1_3</code>; <code>Step1_4</code></p></li>\n<li><p>A button called <code>Step1_Confirm</code></p></li>\n<li><p>I want the button to show Error, if not all checkboxes are checked - meaning that all checkboxes have to be checked....(in case my English is too bad to convey my meaning)</p></li>\n</ol>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1497415845, "creation_date": 1497415845, "answer_id": 44535683, "question_id": 44535606, "link": "https://stackoverflow.com/questions/44535606/vba-checkmark-return-yes-if-double-clicked-and-removed/44535683#44535683", "title": "VBA Checkmark - Return &#39;Yes&#39; if double clicked and removed", "body": "<p>To display the word \"YES\" change the line :</p>\n\n<pre><code>Target.ClearContents\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>Target.Value = \"YES\"\n</code></pre>\n\n<p><strong><em>Full Code</em></strong></p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    On Error GoTo 1\n    If Not Intersect(Target, Range(\"A2:Z200\")) Is Nothing Then\n        Application.EnableEvents = False\n        If Target.Value = ChrW(&amp;H2713) Then\n            Target.Value = \"YES\"\n        Else\n            Target.Value = ChrW(&amp;H2713)\n        End If\n        Cancel = True\n    End If\n\n    On Error GoTo 0\n1   Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1497421889, "creation_date": 1497421889, "answer_id": 44537118, "question_id": 44535606, "link": "https://stackoverflow.com/questions/44535606/vba-checkmark-return-yes-if-double-clicked-and-removed/44537118#44537118", "title": "VBA Checkmark - Return &#39;Yes&#39; if double clicked and removed", "body": "<p>This will replace the original value with a checkmark and then restore the original value on re-clicking, but it only works for text values and only changes the <em>appearance</em> of the cell...</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    If Not Intersect(Target, Range(\"A2:Z200\")) Is Nothing Then\n        On Error GoTo haveError\n        Application.EnableEvents = False\n        If Target.NumberFormat Like \";;;*\" Then\n            Target.NumberFormat = \"General\"\n        Else\n            Target.NumberFormat = \";;;\" &amp; ChrW(&amp;H2713)\n        End If\n        Cancel = True\n    End If\n\nhaveError:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8158131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64eeb49e72ffd9702fd029260a77bfd4?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/8158131/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1497421889, "creation_date": 1497415376, "last_edit_date": 1531164843, "question_id": 44535606, "link": "https://stackoverflow.com/questions/44535606/vba-checkmark-return-yes-if-double-clicked-and-removed", "title": "VBA Checkmark - Return &#39;Yes&#39; if double clicked and removed", "body": "<p>I use the below VBA code to display a checkmark/tick when a cell is double clicked. At times, the checkmark/tick needs to be removed. To remove the checkmark/tick, the cell needs to be double clicked again. Once double clicked to remove the checkmark/tick, the cell return as blank. My question is; would it be possible to display the word \u2018YES\u2019 rather than having the cell blank?</p>\n\n<p>Or as an even better option, is it possible to return the original text (before the cell was even double clicked) in the cell when double clicked (to remove checkmark/tick) rather than return as blank?</p>\n\n<p>I hope this makes sense! Thank you in advance!</p>\n\n<p>Below is the VBA code I have used for the checkmark/tick:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    On Error GoTo 1\n    If Not Intersect(Target, Range(\"A2:Z200\")) Is Nothing Then\n        Application.EnableEvents = False\n        If Target.Value = ChrW(&amp;H2713) Then\n            Target.ClearContents\n            Cancel = True\n        Else\n            Target.Value = ChrW(&amp;H2713)\n            Cancel = True\n        End If\n    End If\n\n    On Error GoTo 0\n1   Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1497421210, "creation_date": 1497421210, "answer_id": 44536930, "question_id": 44535362, "link": "https://stackoverflow.com/questions/44535362/how-can-you-set-two-named-ranges-as-a-chart-data-source/44536930#44536930", "title": "How can you set two named ranges as a chart data source?", "body": "<p>You can set a new Series' <code>Values</code> and <code>XValues</code> separately:</p>\n\n<pre><code>Sub Tester()\n\n    Dim JRange As Range, DRange As Range, chtObj, cht As Chart\n    Dim StartRow, LastRow, sht\n\n    StartRow = 3 'for testing\n    LastRow = 15 'for testing\n    Set sht = ActiveSheet\n\n    Set JRange = sht.Range(sht.Cells(StartRow, 10), sht.Cells(LastRow, 10))\n    Set DRange = sht.Range(sht.Cells(StartRow, 4), sht.Cells(LastRow, 4))\n\n\n    Set chtObj = ActiveSheet.ChartObjects.Add(Left:=300, _\n               Width:=325.9842519685, Top:=10, Height:=277.5118110236)\n\n    With chtObj.Chart\n        .ChartType = xlLine\n        .ChartStyle = 2\n        With .SeriesCollection.NewSeries\n            .Values = JRange\n            .XValues = DRange\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497421210, "creation_date": 1497414053, "question_id": 44535362, "link": "https://stackoverflow.com/questions/44535362/how-can-you-set-two-named-ranges-as-a-chart-data-source", "title": "How can you set two named ranges as a chart data source?", "body": "<p>I have two named ranges as detailed below:</p>\n\n<pre><code>Set JRange = sht.Range(sht.Cells(StartRow, 10), sht.Cells(LastRow, 10))\nSet DRange = sht.Range(sht.Cells(StartRow, 4), sht.Cells(LastRow, 4))\n</code></pre>\n\n<p>I want to use both of them as sources for my specified chart macro. This is what I have:</p>\n\n<pre><code>Set Chart = ActiveSheet.ChartObjects.Add(Left:=300, Width:=325.9842519685, Top:=10, Height:=277.5118110236)\n\nWith Chart\n    .Chart.SetSourceData Source:=Range(DRange) And (JRange), PlotBy:=xlColumns\n    .Chart.ChartType = xlLine\n    .Chart.ChartStyle = 2\n    .Height = 277.5118110236\n    .Width = 325.9842519685\n</code></pre>\n\n<p>Any help would be much appreciated!</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "edited": false, "score": 0, "creation_date": 1497412071, "post_id": 44535038, "comment_id": 76061208, "body": "Let me guess: you are using Excel in a version previous to 2013, and that&#39;s the maximum allowed as a range for this Excel spreadsheet, and that&#39;s why it reset. If that&#39;s not the case, please add the Excel version you&#39;re using to your question."}, {"owner": {"reputation": 427, "user_id": 3380970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3eb71049ce9a52bd81bdd1eec14e870?s=128&d=identicon&r=PG&f=1", "display_name": "xiience", "link": "https://stackoverflow.com/users/3380970/xiience"}, "edited": false, "score": 0, "creation_date": 1497412117, "post_id": 44535038, "comment_id": 76061217, "body": "This may be of some interest to you: <a href=\"https://stackoverflow.com/a/18558328/3380970\">stackoverflow.com/a/18558328/3380970</a>"}, {"owner": {"reputation": 3, "user_id": 8157875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6d7822cb76671181690283ecad393d?s=128&d=identicon&r=PG&f=1", "display_name": "dadazhu", "link": "https://stackoverflow.com/users/8157875/dadazhu"}, "edited": false, "score": 0, "creation_date": 1497412610, "post_id": 44535038, "comment_id": 76061334, "body": "Thanks Hila. No, I am actually using Excel 2010 which allows 1048576 rows."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1497412959, "post_id": 44535038, "comment_id": 76061453, "body": "Where&#39;s the code for LastUsedRow?"}, {"owner": {"reputation": 3, "user_id": 8157875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6d7822cb76671181690283ecad393d?s=128&d=identicon&r=PG&f=1", "display_name": "dadazhu", "link": "https://stackoverflow.com/users/8157875/dadazhu"}, "edited": false, "score": 0, "creation_date": 1497412968, "post_id": 44535038, "comment_id": 76061457, "body": "To xiience, I declared N as the long data type, I thought it should be adequate in dealing with size growth of the array"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1497413129, "post_id": 44535038, "comment_id": 76061512, "body": "IsArrayEmpty may also be important..."}, {"owner": {"reputation": 3, "user_id": 8157875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6d7822cb76671181690283ecad393d?s=128&d=identicon&r=PG&f=1", "display_name": "dadazhu", "link": "https://stackoverflow.com/users/8157875/dadazhu"}, "edited": false, "score": 0, "creation_date": 1497413146, "post_id": 44535038, "comment_id": 76061516, "body": "To Tim, just added the function in my post. Though I don&#39;t think the function caused the problem. The code worked fine if the N is less than 32767."}, {"owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "edited": false, "score": 0, "creation_date": 1497413234, "post_id": 44535038, "comment_id": 76061540, "body": "Maybe you are using Excel 2010 but the file is saved as Excel xls (93-2003 version) and not as xlsx?"}, {"owner": {"reputation": 3, "user_id": 8157875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6d7822cb76671181690283ecad393d?s=128&d=identicon&r=PG&f=1", "display_name": "dadazhu", "link": "https://stackoverflow.com/users/8157875/dadazhu"}, "edited": false, "score": 0, "creation_date": 1497413303, "post_id": 44535038, "comment_id": 76061554, "body": "To Hida, the file is saved as a binary file."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497413383, "post_id": 44535038, "comment_id": 76061584, "body": "Hida - previous row limit was 64k not 32k"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1497413483, "post_id": 44535038, "comment_id": 76061607, "body": "put a break on <code>ReDim v(0)</code> and see when it runs.  Note you have <code>Dim i As Integer</code> in that last function...  That will trigger an out of bounds error above ~32k which will then trigger your array to be reset"}, {"owner": {"reputation": 3, "user_id": 8157875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6d7822cb76671181690283ecad393d?s=128&d=identicon&r=PG&f=1", "display_name": "dadazhu", "link": "https://stackoverflow.com/users/8157875/dadazhu"}, "edited": false, "score": 0, "creation_date": 1497413954, "post_id": 44535038, "comment_id": 76061730, "body": "To Tim, you are the champ!!! Thank you so much. I would never think about it.:)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8157875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6d7822cb76671181690283ecad393d?s=128&d=identicon&r=PG&f=1", "display_name": "dadazhu", "link": "https://stackoverflow.com/users/8157875/dadazhu"}, "edited": false, "score": 0, "creation_date": 1497414237, "post_id": 44535301, "comment_id": 76061831, "body": "Yes indeed. Again, much appreciated."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1497413670, "creation_date": 1497413670, "answer_id": 44535301, "question_id": 44535038, "link": "https://stackoverflow.com/questions/44535038/vba-array-size-reset-once-hitting-32767-excel-2010/44535301#44535301", "title": "VBA array size reset once hitting 32767 (Excel 2010)", "body": "<p>Note you have Dim i As Integer in that last IsArrayEmpty function... </p>\n\n<p>That will trigger an out of bounds error above ~32k which will then trigger your array to be reset.</p>\n"}], "owner": {"reputation": 3, "user_id": 8157875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6d7822cb76671181690283ecad393d?s=128&d=identicon&r=PG&f=1", "display_name": "dadazhu", "link": "https://stackoverflow.com/users/8157875/dadazhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 44535301, "answer_count": 1, "score": 0, "last_activity_date": 1520354029, "creation_date": 1497411842, "last_edit_date": 1520354029, "question_id": 44535038, "link": "https://stackoverflow.com/questions/44535038/vba-array-size-reset-once-hitting-32767-excel-2010", "title": "VBA array size reset once hitting 32767 (Excel 2010)", "body": "<p>I use a 1D dynamic array to hold values that total numbers of them will be 60K plus. This seems like an easy task but I noticed that once the size of the array reaches 32767, it started from 0 again. Any suggestion will be appreciated. </p>\n\n<p>My code:</p>\n\n<pre><code>Sub GetHours()\n\nDim R As Long, i As Long, N As Long, var, vRaw, v\n\nR = LastUsedRow(Sheet1)\nWith Sheet1\n      vRaw = .Range(.Cells(2, 1), .Cells(R, 22)).Value\nEnd With\n\nFor i = 1 To R - 1\n    var = vRaw(i, 12)\n    If IsNumeric(var) Then\n        If IsArrayEmpty(v) Then\n            ReDim v(0)\n            v(0) = i\n        Else\n            N = UBound(v) + 1\n            ReDim Preserve v(N)\n            v(N) = i\n        End If\n\n    End If\nNext\n\nEnd Sub\n\nFunction LastUsedRow(ByVal ws As Worksheet) As Long\n\nDim lastrow As Long\n\nOn Error GoTo errHandler\nlastrow = ws.Cells.Find(What:=\"*\", After:=[A1], _\n                         SearchOrder:=xlByRows, _\n                         SearchDirection:=xlPrevious).Row\n\nLastUsedRow = lastrow\nExit Function\n\nerrHandler:\n    LastUsedRow = 0\n\nEnd Function\n\nFunction IsArrayEmpty(anArray As Variant)\nDim i As Integer\nOn Error Resume Next\ni = UBound(anArray, 1)\n\nIf Err.Number = 0 Then\n    IsArrayEmpty = False\nElse\n    IsArrayEmpty = True\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1497409306, "post_id": 44534675, "comment_id": 76060625, "body": "This looks like it could be a lot of work. What have you tried so far? At the very least, you&#39;re going to need to create a userform to retrieve the start date and end date."}, {"owner": {"reputation": 5, "user_id": 5979186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/463e7e1aeb81d9e6e407caaa49804b90?s=128&d=identicon&r=PG&f=1", "display_name": "yael", "link": "https://stackoverflow.com/users/5979186/yael"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1497410139, "post_id": 44534675, "comment_id": 76060808, "body": "What I&#39;ve already done is using functions in excel, a lot of vlookups and some other functions just to filter the data that I need in that form and that&#39;s giving a heavy toll on excel making it slow."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1497424031, "post_id": 44534675, "comment_id": 76066240, "body": "Please understand that Stack Overflow is not a free code writing service. People are not here to solve your issue for you but to <b>assist you to solve your issue yourself</b>. Therefore you need to show your code with a <b>detailed</b> description of \u2026 (1) what the code actually does, (2) where you got stuck and (3) if there are any error messages and where they occur. If possible give a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your issue. Also read <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> to understand why your question is too broad to answer."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 0, "last_activity_date": 1497629276, "creation_date": 1497629276, "answer_id": 44593615, "question_id": 44534675, "link": "https://stackoverflow.com/questions/44534675/macro-code-to-generate-a-formatted-excel/44593615#44593615", "title": "Macro code to generate a formatted Excel", "body": "<p>Try it like this.</p>\n\n<pre><code>Public Sub MyFilter()\n    Dim lngStart As Long, lngEnd As Long\n    lngStart = Range(\"E1\").Value 'assume this is the start date\n    lngEnd = Range(\"E2\").Value 'assume this is the end date\n    Range(\"C1:C13\").AutoFilter field:=1, _\n        Criteria1:=\"&gt;=\" &amp; lngStart, _\n        Operator:=xlAnd, _\n        Criteria2:=\"&lt;=\" &amp; lngEnd\nEnd Sub\n</code></pre>\n\n<p>All details are here.</p>\n\n<p><a href=\"https://www.extendoffice.com/documents/excel/910-excel-filter-between-two-dates.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/910-excel-filter-between-two-dates.html</a></p>\n"}], "owner": {"reputation": 5, "user_id": 5979186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/463e7e1aeb81d9e6e407caaa49804b90?s=128&d=identicon&r=PG&f=1", "display_name": "yael", "link": "https://stackoverflow.com/users/5979186/yael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 44593615, "answer_count": 1, "score": -5, "last_activity_date": 1497629276, "creation_date": 1497409110, "last_edit_date": 1531161705, "question_id": 44534675, "link": "https://stackoverflow.com/questions/44534675/macro-code-to-generate-a-formatted-excel", "title": "Macro code to generate a formatted Excel", "body": "<p>I have a database in my Excel with this format</p>\n\n<pre><code>Cosumer    Date    Ref #    Product Code    Description    U/M   Qty   Price   Transaction\n</code></pre>\n\n<p>I want a macro code which when I run it, a dialog text box will appear indicating \"Start Date\" and \"End Date\" and after encoding the start date and end date, it will generate a new excel file that has this format:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ayBvF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ayBvF.png\" alt=\"enter image description here\"></a></p>\n\n<p>I hope someone will help me, thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1497409814, "post_id": 44534668, "comment_id": 76060735, "body": "Start by removing the <code>On Error Resume Next</code>.  Then get rid of the <code>goto</code> and use a proper loop. After that, you can use the debugger to step through the code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497410045, "post_id": 44534668, "comment_id": 76060792, "body": "Your loop has no exit condition"}, {"owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1497410294, "post_id": 44534668, "comment_id": 76060828, "body": "@TimWilliams I thought the &quot;loop&quot; only loops until the brng.Borders(xlEdgeBottom).Weight = xlMedium is True. Is it not?"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1497410847, "post_id": 44534668, "comment_id": 76060938, "body": "No, your code will continue &quot;looping&quot; because you never told it to stop. See my answer below."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1497510860, "post_id": 44534668, "comment_id": 76111038, "body": "You should read this <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> before you start ranting..."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "edited": false, "score": 0, "creation_date": 1497412986, "post_id": 44534880, "comment_id": 76061464, "body": "Thanks for your input. Your code however only works if the cell with the xlEdgeBottom border (or the rows after that) is a non-blank cell. I want the code to work even with blank cells. Is it possible to achieve this? Thanks again for your advice. I will definitely take note."}], "tags": [], "owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1497414339, "last_edit_date": 1497414339, "creation_date": 1497410761, "answer_id": 44534880, "question_id": 44534668, "link": "https://stackoverflow.com/questions/44534668/find-the-cell-with-a-thick-bottom-border-by-rows/44534880#44534880", "title": "Find the cell with a thick bottom border by rows", "body": "<p>Try this:</p>\n\n<pre><code>Dim ws As Worksheet\nDim brng As Range\nDim Last_Row As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"My Sheet Name\")    '&lt;-- Replace this with your sheet name\n    Set brng = ws.Range(\"C13\")\n    Last_Row = brng.Row + ws.UsedRange.Rows.Count - 1\n\n    Do While brng.Row &lt;= Last_Row\n        If brng.Borders(xlEdgeBottom).Weight = xlMedium Then\n            brng = \"found it!\"\n            Exit Sub\n        End If\n        Set brng = brng.Offset(1)\n    Loop\n</code></pre>\n\n<p>Some unsolicited advice:</p>\n\n<ul>\n<li>don't use \"On Error Resume...\" until you make your code working. It will hide your code problems; </li>\n<li>don't use \"worksheet(number)\" to assign worksheet. If the worksheet number changes, your code will fail. Use the worksheet name instead;</li>\n<li>Don't use GoTo. It's a bad coding style, and you almost never need it;</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1497423814, "post_id": 44537578, "comment_id": 76066118, "body": "In this piece of code you really don&#39;t need the <code>Else</code>, since you&#39;re not doing anything anyway. Still not looping properly like in RADO&#39;s answer. Other than that it&#39;ll work. GoTo is a construction that was necessary back in the early days of Basic, when proper error handling constructions weren&#39;t implemented."}, {"owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1497489572, "post_id": 44537578, "comment_id": 76104366, "body": "Yes if the person who keeps downvoting my stuff tell me why, so that I can learn from your response, that&#39;d be great. Don&#39;t just downvote and leave. It&#39;s helping no one."}], "tags": [], "owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "is_accepted": false, "score": -1, "last_activity_date": 1497423344, "creation_date": 1497423344, "answer_id": 44537578, "question_id": 44534668, "link": "https://stackoverflow.com/questions/44534668/find-the-cell-with-a-thick-bottom-border-by-rows/44537578#44537578", "title": "Find the cell with a thick bottom border by rows", "body": "<p>This is the answer to my initial question. </p>\n\n<pre><code>Sub FindThiccBottomBorder()\n\nDim ws2 As Worksheet\nSet ws2 = Sheets(\"Sheet2\")\n\nDim brng As Range\nSet brng = ws2.Range(\"C13\")\n\nstart:\nIf brng.Borders(xlEdgeBottom).Weight = xlMedium Then\n    brng.FormulaR1C1 = \"found it!\"\n    Exit Sub\nElse\nEnd If\n\nset brng = brng.Offset(1)\nGoTo start\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "is_accepted": true, "score": 1, "last_activity_date": 1498785834, "creation_date": 1498785834, "answer_id": 44837252, "question_id": 44534668, "link": "https://stackoverflow.com/questions/44534668/find-the-cell-with-a-thick-bottom-border-by-rows/44837252#44837252", "title": "Find the cell with a thick bottom border by rows", "body": "<p>The following is a better code to perform the same procedure.</p>\n\n<pre><code>Dim rngBottom As Range\nSet rngBottom = Range(\"C13\")\n\nDo Until rngBottom.Borders(xlEdgeBottom).Weight = xlMedium\nSet rngBottom = rngBottom.Offset(1)\nLoop\nrngBottom.Value = \"found it!\"\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 44837252, "answer_count": 3, "score": 0, "last_activity_date": 1574630445, "creation_date": 1497409079, "last_edit_date": 1574630445, "question_id": 44534668, "link": "https://stackoverflow.com/questions/44534668/find-the-cell-with-a-thick-bottom-border-by-rows", "title": "Find the cell with a thick bottom border by rows", "body": "<p>I'm trying to find the cell with a thick bottom border by rows.</p>\n\n<p>The following code makes my whole workbook stop responding and I have to restart it.</p>\n\n<pre><code>Sub FindThiccBottomBorder()\n\nDim ws2 As Worksheet\nSet ws2 = Sheets(2)\n\nDim brng As Range\nSet brng = ws2.Range(\"C13\")\n\nstart:\nIf brng.Borders(xlEdgeBottom).Weight = xlMedium Then\n    On Error Resume Next\n    brng.FormulaR1C1 = \"found it!\"\nElse\n    brng = brng.Offset(1)\n    GoTo start\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1497403905, "post_id": 44533885, "comment_id": 76059306, "body": "I&#39;m not sure about the type mismatch but why are you offsetting up when your r range is End(xlUp)?"}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "edited": false, "score": 0, "creation_date": 1497404475, "post_id": 44533885, "comment_id": 76059446, "body": "Won&#39;t splitting it into columns function of excel work? follow this link <a href=\"https://support.office.com/en-us/article/Split-text-into-different-columns-with-the-Convert-Text-to-Columns-Wizard-30b14928-5550-41f5-97ca-7a3e9c363ed7\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 57, "user_id": 6884483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/255b6d6b07b7c2b62d9d73fb21f7ec40?s=128&d=identicon&r=PG&f=1", "display_name": "dner", "link": "https://stackoverflow.com/users/6884483/dner"}, "edited": false, "score": 0, "creation_date": 1497404527, "post_id": 44533885, "comment_id": 76059459, "body": "The formula is meant to take data that looks like this: A | B | 1; 2; 3 and turn it into a set of three rows of A | B | 1, A | B | 2, A | B | 3 but for a set of 5 &quot;AB&quot; columns and 8000 total rows"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1497406775, "post_id": 44533885, "comment_id": 76059984, "body": "Code is working for me.  It&#39;s certainly a strange line of code to give a &quot;Type mismatch&quot; error.  What is the value of <code>r.Row</code> when it crashes?  Is there anything strange about that row?"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1497406881, "post_id": 44533885, "comment_id": 76060011, "body": "Why do you need this line at all? You are not using the copy anywhere."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 1, "creation_date": 1497406926, "post_id": 44533885, "comment_id": 76060024, "body": "@RADO the <code>insert</code> line will use it to create a copy by insertion."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1497407004, "post_id": 44533885, "comment_id": 76060039, "body": "Off-topic: <a href=\"https://stackoverflow.com/a/42425847/4926357\">splitByColB</a> should be renamed <code>splitByColH</code> here. :P"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1497407201, "post_id": 44533885, "comment_id": 76060081, "body": "difficult to assess. We can only speculate. Is your worksheet protected? do you have merged cells? any information could be useful."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1497424851, "post_id": 44533885, "comment_id": 76066822, "body": "Executes perfectly here. Also when r.Row is hidden, r is empty, when it&#39;s a merged cell, etc. (Excel 2016). Type mismatch is a bit strange to me, since the types are correct everywhere, it seems. Anyway I can&#39;t seem to break it."}], "owner": {"reputation": 57, "user_id": 6884483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/255b6d6b07b7c2b62d9d73fb21f7ec40?s=128&d=identicon&r=PG&f=1", "display_name": "dner", "link": "https://stackoverflow.com/users/6884483/dner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497406292, "creation_date": 1497403077, "last_edit_date": 1497406292, "question_id": 44533885, "link": "https://stackoverflow.com/questions/44533885/run-time-error-13-type-mismatch", "title": "Run-Time Error 13 - Type Mismatch", "body": "<p>I set up this code to identify a character in a column and split the contents of that column into as many rows as that character is present. It's been working for a while but now I'm receiving a run-time error. I tried to debug the code and it appears that the bolded line is the cause of the problem. Does anyone have an idea of how to fix this type of problem?</p>\n\n<pre><code>Sub splitByColB()\n    Dim r As Range, i As Long, ar\n    Set r = Worksheets(\"SheetNAme\").Range(\"H999999\").End(xlUp)\n    Do While r.Row &gt; 1\n        ar = Split(r.Value, \";\")\n        If UBound(ar) &gt;= 0 Then r.Value = ar(0)\n        For i = UBound(ar) To 1 Step -1\n            r.EntireRow.Copy         '&lt;------------ Line causing problem\n            r.Offset(1).EntireRow.Insert\n            r.Offset(1).Value = ar(i)\n        Next\n        Set r = r.Offset(-1)\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1418, "user_id": 1339732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jk0rJ.jpg?s=128&g=1", "display_name": "Phd. Burak &#214;zt&#252;rk", "link": "https://stackoverflow.com/users/1339732/phd-burak-%c3%96zt%c3%bcrk"}, "edited": false, "score": 0, "creation_date": 1497399181, "post_id": 44533354, "comment_id": 76058356, "body": "I dont understand what is your problem but you could change your variable name Find.."}, {"owner": {"reputation": 31, "user_id": 4053860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/951b62641c73af21418dfa99596886b0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Craig", "link": "https://stackoverflow.com/users/4053860/steven-craig"}, "reply_to_user": {"reputation": 1418, "user_id": 1339732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jk0rJ.jpg?s=128&g=1", "display_name": "Phd. Burak &#214;zt&#252;rk", "link": "https://stackoverflow.com/users/1339732/phd-burak-%c3%96zt%c3%bcrk"}, "edited": false, "score": 0, "creation_date": 1497399663, "post_id": 44533354, "comment_id": 76058467, "body": "I have edited the info, my problem is the findrow is blank when running the code. When I come out of VBA and manually try to find the info it is already populated in the find box. Could it be an issue with the date? Column A of the data tab is basically 2 years of dates starting from 01/01/17"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1497399756, "post_id": 44533354, "comment_id": 76058488, "body": "Try <code>Set FindWor = .Find(what:=Find)</code>. Also, I suggest not using <code>Find</code> as a variable name, since it&#39;s a function in Excel, use something like <code>findRng</code>..."}, {"owner": {"reputation": 31, "user_id": 4053860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/951b62641c73af21418dfa99596886b0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Craig", "link": "https://stackoverflow.com/users/4053860/steven-craig"}, "edited": false, "score": 0, "creation_date": 1497400750, "post_id": 44533354, "comment_id": 76058701, "body": "Thanks for the help so far. I have made changes to the code which is now running but it is enterin the value in the next row after the last column, does anyone have any thoughts on this part? <code>Private Sub Enter_Click()  Dim FindWor As Range Dim Findrng As String Dim FindRowNumber As Long    Find = Format(Me.Date1, &quot;DD&#47;MM&#47;YYYY&quot;) With Worksheets(&quot;Data&quot;).Range(&quot;$A:$A&quot;) Set FindWor = .Find(what:=Findrng) FindRowNumber = FindWor.Row  .Cells(FindRowNumber, 2).Value = Me.Event1 End With   End Sub</code>"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1497399807, "creation_date": 1497399807, "answer_id": 44533506, "question_id": 44533354, "link": "https://stackoverflow.com/questions/44533354/vba-find-function-not-working/44533506#44533506", "title": "VBA Find Function not working", "body": "<p>You must <code>Dim</code> FindRowNumber as <strong>Long</strong></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 4053860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/951b62641c73af21418dfa99596886b0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Craig", "link": "https://stackoverflow.com/users/4053860/steven-craig"}, "edited": false, "score": 0, "creation_date": 1497400944, "post_id": 44533565, "comment_id": 76058756, "body": "Sorry I am not sure I understand what you mean. I have added a format to my text that I am looking to find, will this help? I can add in some code to return a comment box i no value is found. I hadn&#39;t thought of that so thanks."}, {"owner": {"reputation": 31, "user_id": 4053860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/951b62641c73af21418dfa99596886b0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Craig", "link": "https://stackoverflow.com/users/4053860/steven-craig"}, "edited": false, "score": 0, "creation_date": 1497431521, "post_id": 44533565, "comment_id": 76071357, "body": "Hi @ThunderFrame, I have changed my code to include the optional details but this brought more issues, I think this was due to the Optional After as I am not starting on the sheet that I am wanting to search on but I am searching from a User Form. My main issue looks to be around the fact that I am searching for a date as the code above works for a &quot;Word&quot;. Can you recommend anything for searching for dates?"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1497401191, "last_edit_date": 1497401191, "creation_date": 1497400328, "answer_id": 44533565, "question_id": 44533354, "link": "https://stackoverflow.com/questions/44533354/vba-find-function-not-working/44533565#44533565", "title": "VBA Find Function not working", "body": "<p>The <code>Find</code> method has a number of optional arguments, that don't have predefined defaults, but rather, they default to the values that were last used, either through code, or through the Excel user interface. <strong>You should explicitly state all of the arguments in order to get consistent and expected behavior</strong>.</p>\n\n<p>The <code>Range.Find</code> method is defined as:</p>\n\n<p><code>Function Find(What, Optional After, Optional LookIn, Optional LookAt, Optional SearchOrder, Optional SearchDirection As XlSearchDirection = xlNext, Optional MatchCase, Optional MatchByte, Optional SearchFormat) As Range</code></p>\n\n<p>You need to provide values for <em>all</em> of those arguments, even though they're marked as <code>Optional</code></p>\n\n<p>The <code>Find</code> method can also return a <code>Nothing</code> reference if a match cannot be found, so you need to test for <code>Nothing</code> before inspecting the <code>Row</code> property. For example:</p>\n\n<pre><code>Set FindRow = .Find(Find)\nIf Not FindRow Is Nothing Then\n    FindRowNumber = FindRow.Row\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 4053860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/951b62641c73af21418dfa99596886b0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Craig", "link": "https://stackoverflow.com/users/4053860/steven-craig"}, "edited": false, "score": 0, "creation_date": 1497472573, "post_id": 44546381, "comment_id": 76098820, "body": "That is exactly what I needed. Working now. Thanks for the help."}], "tags": [], "owner": {"reputation": 732, "user_id": 3025905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2fa2b33fcfe80d872becd5026ebb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "PankajKushwaha", "link": "https://stackoverflow.com/users/3025905/pankajkushwaha"}, "is_accepted": true, "score": 1, "last_activity_date": 1497447270, "creation_date": 1497447270, "answer_id": 44546381, "question_id": 44533354, "link": "https://stackoverflow.com/questions/44533354/vba-find-function-not-working/44546381#44546381", "title": "VBA Find Function not working", "body": "<p>This :</p>\n\n<pre><code>Set FindWor = .Find(what:=Findrng)\n</code></pre>\n\n<p>Findrng is a string ,and the data there is date , so it will definitely return nothing.</p>\n\n<p>If you are not sure what will your code search weather string or date , first find the value as string , if not found convert it to date and do a search again </p>\n\n<pre><code>    Set FindWor = .Find(what:=Findrng)\n\n    if  FindWor  is nothing  then\n           Set FindWor = .Find(what:=cdate(Findrng))\n    end if\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4053860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/951b62641c73af21418dfa99596886b0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Craig", "link": "https://stackoverflow.com/users/4053860/steven-craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7049, "favorite_count": 1, "accepted_answer_id": 44546381, "answer_count": 3, "score": 1, "last_activity_date": 1497447270, "creation_date": 1497398617, "last_edit_date": 1497431332, "question_id": 44533354, "link": "https://stackoverflow.com/questions/44533354/vba-find-function-not-working", "title": "VBA Find Function not working", "body": "<p>I am trying to use vba code to search for a value in another sheet and return the row number so the adjacent cell can be filled in with a string. The problem is that the \"findrow\" is returning blank. The \".find(findrng) shows as 14/01/17 when I try to Run and hover over that part.</p>\n\n<p>If I change the Findrng to a word such as \"Home\" and enter this on the file the code returns the correct row number so the problem must be with the date. Can anyone help with using .Find for dates?</p>\n\n<pre><code>Private Sub Enter_Click()\nDim FindWor As Range\nDim Findrng As String\nDim FindRowNumber As Long\n\nFindrng = Me.Date1\nWith Worksheets(\"Data\").Range(\"$A:$A\")\nSet FindWor = .Find(what:=Findrng)\nFindRowNumber = FindWor.Row\n\n.Cells(FindRowNumber, 2).Value = Me.Event1\nEnd With\n\n End Sub\n</code></pre>\n\n<p>Thanks</p>\n\n<p>Steven</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2013"], "comments": [{"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1497418295, "post_id": 44532360, "comment_id": 76063316, "body": "I&#39;m not sure if this applies to subreports but here&#39;s a list of sections, just in case you haven&#39;t seen it before: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192668.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff192668.aspx</a>. Maybe you can access a subreport like a subform <code>Forms.frmName....Form.sfrmName...</code>; <code>Reports.rptName...Report.srptName</code>. Hth."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1497433587, "post_id": 44532360, "comment_id": 76072856, "body": "I&#39;d be intrigued if there is a solution to this - I have the same problem and have a similar workaround that only works when the form not a control has focus. I wondered if setting the focus to the subcontainer on clicking any of the controls would work?"}, {"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1497434657, "post_id": 44532360, "comment_id": 76073698, "body": "That&#39;s what i was thinking. It didn&#39;t occur to me right away that my comment above would still involve clicking and setfocus. Maybe not what&#39;s desired but might work. I doubt that just hovering and scrolling will be possible."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1497435575, "post_id": 44532360, "comment_id": 76074354, "body": "i tried this on access 2010 and couldn&#39;t re produce. it&#39;s scrolling/navigating through each record regardless if a column or row has focus."}, {"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1497436013, "post_id": 44532360, "comment_id": 76074632, "body": "I just tried too, using a subreport and it scrolled. I just reread the OP and I can&#39;t tell which v of Access you&#39;re using (OP) and if this is forms or reports (in case it does matter). I&#39;m using the latest Access but I tested in an .mdb file, if that matters."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1497451858, "post_id": 44532360, "comment_id": 76086828, "body": "@krishKM see my edit for how I got into this secenario and how to reproduce."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 1, "creation_date": 1497451942, "post_id": 44532360, "comment_id": 76086913, "body": "@wazz I&#39;m using a subreport (the object type but my report itself doesn&#39;t have a subreport in it) within a form. It does make a difference in that a subreport within a report works just fine. My file is an accdb."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1497452148, "post_id": 44532360, "comment_id": 76087046, "body": "yes that&#39;s why you have added the code from MS &quot;Report_MouseWheel&quot;. after adding that code it works? Also I don&#39;t use adp so i used me.count instead of Me.Recordset.RecordCount"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1497453329, "post_id": 44532360, "comment_id": 76087925, "body": "@krishKM reports don&#39;t have a recordset <i>except</i> in ADP. So you can&#39;t use <code>Me.Recordset.count</code>."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1497453971, "post_id": 44532360, "comment_id": 76088428, "body": "@krishKM oh except I see what you were pointing out in my code above. That should not have been Recordset.RecordCount. Not sure how that happened...either way question remained the same."}], "answers": [{"comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497453581, "post_id": 44548547, "comment_id": 76088133, "body": "This is better in that something that shouldn&#39;t take focus can&#39;t have it. It does mean though that someone trying to put focus into the subreport to scroll it can&#39;t do that unless they click between controls. Maybe that&#39;s ok."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497453877, "post_id": 44548547, "comment_id": 76088351, "body": "The reason for this is that I have too much data to show everything at once and i need grouping. A subform can&#39;t do grouping like a report can and a report unto itself can&#39;t do dynamic filtering like a form can. Thus I have a report inside a form. Regarding you&#39;re attempt to reproduce, that&#39;s correct. And that&#39;s why I have that code in the MouseWheel event. But if focus is in a textbox (or other focusable control) during <code>DoCmd.GoToRecord , , acNext, 1</code>/<code>acPrevious</code> then all sorts of weird things happen. Particularly because CurrentRecord in a report is relative to the grouping level."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1497454278, "post_id": 44548547, "comment_id": 76088642, "body": "I feel like if I space things strategically so the user can sort of click most places this is a good solution. Not perfect but certainly better than before."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1497454133, "last_edit_date": 1497454133, "creation_date": 1497453033, "answer_id": 44548547, "question_id": 44532360, "link": "https://stackoverflow.com/questions/44532360/scrolling-in-subreports-where-parent-is-a-form/44548547#44548547", "title": "Scrolling in subreports where parent is a form", "body": "<p>To prevent controls on the subreport from getting the focus, you can set them all to <code>Enabled = No</code>. This should keep the focus on the sections.</p>\n\n<p>FWIW, I tried to reproduce this, but for me the subreport (in report view) on an unbound form never scrolls with the mouse wheel. No matter where the focus is.</p>\n\n<p><strong>Edit</strong> With the <code>Report_MouseWheel</code> code in place, it sort of works. I replaced <code>Me.Recordset.RecordCount</code> with the number of records in the test table for testing purposes.</p>\n\n<p>Generally, I find it a rather strange thing to do (putting a subreport on a form).</p>\n\n<p><strong>Edit 2</strong> Ah, I see, grouping. Ok.</p>\n\n<p>I tried putting a transparent button above the detail section to prevent the disabled controls from not being clickable, but that didn't work.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14415586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022bf66a9e86d13ab61deb7133374dc2?s=128&d=identicon&r=PG&f=1", "display_name": "iamzenigma", "link": "https://stackoverflow.com/users/14415586/iamzenigma"}, "is_accepted": false, "score": 0, "last_activity_date": 1602178833, "creation_date": 1602178833, "answer_id": 64267922, "question_id": 44532360, "link": "https://stackoverflow.com/questions/44532360/scrolling-in-subreports-where-parent-is-a-form/64267922#64267922", "title": "Scrolling in subreports where parent is a form", "body": "<p>A workaround I found to work is to first encapsulate the report in another (empty) report, <em>then</em> add the nested report as a sub-report into the form. This way scrolling seems to remain intact.</p>\n<p>A problem with this approach is that the load time will suffer. I find it to especially slow down reports that have big queries or a lot of data behind them.</p>\n<p>Life would be much easier if this scrolling problem could just be fixed by MS.</p>\n<p>If anyone knows of a better approach, I'm all ears!</p>\n"}], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 0, "accepted_answer_id": 44548547, "answer_count": 2, "score": 2, "last_activity_date": 1602178833, "creation_date": 1497391515, "last_edit_date": 1497453925, "question_id": 44532360, "link": "https://stackoverflow.com/questions/44532360/scrolling-in-subreports-where-parent-is-a-form", "title": "Scrolling in subreports where parent is a form", "body": "<p>I'm having trouble scrolling in a report that is in a Sub Report/Form control on a form. I can scroll by clicking and dragging on the scroll bar just fine but I would like to use the mouse wheel. </p>\n\n<p>I see that this <a href=\"https://support.microsoft.com/en-us/help/2458709/you-cannot-use-the-mouse-wheel-to-scroll-through-records-in-an-access-2007-or-access-2010-form\" rel=\"nofollow noreferrer\">functionality was removed</a> as something that just happens natively on the 2007 to 2010 transition. (I know that links says it's for subforms but I'm pretty sure it is valid also for subreports based on everything else I've read).</p>\n\n<p>I adapted their workaround code like this</p>\n\n<pre><code>Private Sub Report_MouseWheel(ByVal Page As Boolean, ByVal Count As Long)\n    Dim r As Long\n    If Not Me.Dirty Then\n        Do While r &lt; Abs(Count)\n            If (Count &lt; 0) And (Me.CurrentRecord &gt;= 1) Then\n                DoCmd.GoToRecord , , acPrevious, 1\n            ElseIf (Count &gt; 0) then 'And (Me.CurrentRecord &lt; Me.Count) Then 'This said Me.RecordSet.RecordCount but that was wrong. Also looking at the count here seems to just mess things up actually. \n                DoCmd.GoToRecord , , acNext, 1\n           End If\n           r = r + 1\n        Loop\n    End If\nEnd Sub\n</code></pre>\n\n<p>but this does not work well at all when a control has focus. The text box which says \"June 2016\" is the thing that has focus in the below picture.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1q1Pf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1q1Pf.png\" alt=\"enter image description here\"></a></p>\n\n<p>It <em>does</em> work very well when only a report section has focus/no controls have focus. I.e. when you click to the right of the width of the report. I'm not sure exactly what the state is called.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8z2sQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8z2sQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I don't know is how can I set the section to have focus/take focus away from every other focusable control. </p>\n\n<p>Edit:</p>\n\n<p>You can reproduce the scenario I'm trying to fix with the following steps (this is Access 2010 but it should hold true for Access 2013. I can't speak to 2016)</p>\n\n<ul>\n<li><p>In a new database make some test table\n<a href=\"https://i.stack.imgur.com/dedcF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dedcF.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Make a basic report off that data\n<a href=\"https://i.stack.imgur.com/ycyId.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ycyId.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Create a new form and add that basic report as a <code>Subform/Subreport</code> object\n<a href=\"https://i.stack.imgur.com/vjYVD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vjYVD.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>When you run open the form in Form View, put focus into the subreport and use the mouse wheel nothing happens. The frame doesn't scroll nor does the CurrentRecord change.</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/bz7Gb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bz7Gb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "edited": false, "score": 0, "creation_date": 1497410822, "post_id": 44532293, "comment_id": 76060931, "body": "Are you looking for code to loop through all the bookmarks or content controls to apply the formatting to?"}], "answers": [{"comments": [{"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "reply_to_user": {"reputation": 115, "user_id": 1203121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40bb29f2d384dfd64e39a65e5d347644?s=128&d=identicon&r=PG", "display_name": "1990Mustafa", "link": "https://stackoverflow.com/users/1203121/1990mustafa"}, "edited": false, "score": 0, "creation_date": 1497480538, "post_id": 44534893, "comment_id": 76102217, "body": "@1990Mustafa yes, within your loop you can check the bookmark being worked on and skip it (Something like <code>If Bmk.Name = &quot;ALTERNATIVE&quot;</code>"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1497410860, "creation_date": 1497410860, "answer_id": 44534893, "question_id": 44532293, "link": "https://stackoverflow.com/questions/44532293/format-text-using-vba-word/44534893#44534893", "title": "Format text using VBA Word", "body": "<p>Perhaps something like this might do?</p>\n\n<pre><code>Dim Bmk As Bookmark\n\nFor Each Bmk In ActiveDocument.Bookmarks\n    Debug.Print Bmk.Range.Font.TextColor\nNext Bmk\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 1203121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40bb29f2d384dfd64e39a65e5d347644?s=128&d=identicon&r=PG", "display_name": "1990Mustafa", "link": "https://stackoverflow.com/users/1203121/1990mustafa"}, "edited": false, "score": 0, "creation_date": 1497467665, "post_id": 44534951, "comment_id": 76096300, "body": "can the first code be written so only Rich Text content control get affected?"}, {"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "reply_to_user": {"reputation": 115, "user_id": 1203121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40bb29f2d384dfd64e39a65e5d347644?s=128&d=identicon&r=PG", "display_name": "1990Mustafa", "link": "https://stackoverflow.com/users/1203121/1990mustafa"}, "edited": false, "score": 0, "creation_date": 1497478213, "post_id": 44534951, "comment_id": 76101516, "body": "Sure, code updated to reflect searching for content controls of type <code>wdContentControlRichText</code>"}], "tags": [], "owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "is_accepted": true, "score": 1, "last_activity_date": 1497478389, "last_edit_date": 1497478389, "creation_date": 1497411244, "answer_id": 44534951, "question_id": 44532293, "link": "https://stackoverflow.com/questions/44532293/format-text-using-vba-word/44534951#44534951", "title": "Format text using VBA Word", "body": "<p>Depending on your needs you could use either approach: </p>\n\n<ol>\n<li><p>Loop through the Content controls to update the formatting:</p>\n\n<pre><code>For Each oContentControl In ActiveDocument.ContentControls\n    oContentControl.Range.Font.Color = RGB(255, 0, 0) 'Red\nNext\n</code></pre></li>\n<li><p>Loop through all the bookmarks to achieve the same result:</p>\n\n<pre><code>For Each bookmark In ActiveDocument.Bookmarks\n    bookmark.Range.Font.Color = RGB(255, 0, 0) 'Red\nNext\n</code></pre></li>\n</ol>\n\n<p><strong>EDIT</strong></p>\n\n<p>As per request, below is how to fine tune the above loop for content controls of a certain type (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff197873.aspx\" rel=\"nofollow noreferrer\">MSDN Link for types</a>).</p>\n\n<p>1.a Loop through all richText content controls to update the formatting:</p>\n\n<pre><code>For Each oContentControl In ActiveDocument.ContentControls\n    If oContentControl .Type = wdContentControlRichText Then\n        oContentControl.Range.Font.Color = RGB(255, 0, 0) 'Red\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 1203121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40bb29f2d384dfd64e39a65e5d347644?s=128&d=identicon&r=PG", "display_name": "1990Mustafa", "link": "https://stackoverflow.com/users/1203121/1990mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 44534951, "answer_count": 2, "score": 1, "last_activity_date": 1593903964, "creation_date": 1497391203, "last_edit_date": 1593903964, "question_id": 44532293, "link": "https://stackoverflow.com/questions/44532293/format-text-using-vba-word", "title": "Format text using VBA Word", "body": "<p>I am fairly new so please excuse my ignorance..\nI want to format bookmark (Rich Text Content Control).</p>\n\n<p>I have the following code to do that </p>\n\n<pre><code>ActiveDocument.Bookmarks(\"ALTERNATIVE\").Range.Font.TextColor = back\nmore formatting to text\n</code></pre>\n\n<p>My question is how can I do that efficiently? Is there a way to select multiple bookmarks or select all Rich Text Content Control to do the format on all of them in the same code?</p>\n"}, {"tags": ["vba", "loops", "powerpoint", "chdir"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1497392525, "post_id": 44532285, "comment_id": 76056686, "body": "well obvious if the dir change needs to occur within the loop it should be in it...."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1497482952, "post_id": 44532285, "comment_id": 76102905, "body": "Continuation of <a href=\"https://stackoverflow.com/questions/44528624/how-to-convert-all-potx-files-to-pptx-files-with-vba\" title=\"how to convert all potx files to pptx files with vba\">stackoverflow.com/questions/44528624/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497452845, "post_id": 44532895, "comment_id": 76087523, "body": "I need to go up one directory to open first and then I want to save it in that same directory"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497479232, "post_id": 44532895, "comment_id": 76101836, "body": "That makes no sense, you are polling files in a dir but you want to go up a dir before opening them? by the very nature of that, the files won&#39;t be in that dir unless you have duplicated every single file into the parent folder (which my code would still work in theory as it would work on the original not the duplicate). Need more details before I can help further."}, {"owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497480872, "post_id": 44532895, "comment_id": 76102314, "body": "hmm there is a misunderstanding.. I have a folder (Processing) on my desktop with multiple processing files within, matlab, vba, etc. I copy this folder into another folder (Data1) full of hundreds of files, which is always a different folder for each data set. Then I open my processing files which are one level down, process data, then delete the folder Processing from the Data1 folder. This is so I can take my processing folder with me anywhere to run through these data sets. Also keeps it easy to share with others."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497483020, "post_id": 44532895, "comment_id": 76102928, "body": "I think what you need to do is to edit the question and put a file structure layout in there. Then we can better understand what you need."}, {"owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "edited": false, "score": 0, "creation_date": 1497486212, "post_id": 44532895, "comment_id": 76103701, "body": "Ok, I edited the description. As I mentioned I would like to keep the path generalized since it will change for each user."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1497394906, "creation_date": 1497394906, "answer_id": 44532895, "question_id": 44532285, "link": "https://stackoverflow.com/questions/44532285/how-to-change-directory-when-performing-a-loop-in-vba/44532895#44532895", "title": "How to change directory when performing a loop in VBA?", "body": "<p>You don't really need to use chdir, you can just put the dir in the saveas:</p>\n\n<pre><code>Sub loopFiles()\n\nDim fso As New FileSystemObject, fil As File, fold As Folder, yourfolder As String, UpOneDir As String\n\nSet fold = fso.GetFolder(Application.ActivePresentation.Path)\n\nFor Each fil In fold.Files\n\n    If InStr(1, fil.name, \".potx\") &gt; 0 Then\n        Application.Presentations.Open fil.Path\n        UpOneDir = Left(fil.Path, Len(fil.Path) - Len(fil.name) - 1 - Len(Split(Left(fil.Path, Len(fil.Path) - Len(fil.name) - 1), \"\\\")(UBound(Split(Left(fil.Path, Len(fil.Path) - Len(fil.name) - 1), \"\\\")))))\n        ActivePresentation.SaveAs UpOneDir &amp; Replace(fil.name, \".potx\", \".pptx\"), ppSaveAsDefault\n        ActivePresentation.Close\n\n        fil.Delete True\n    End If\n\nNext fil\n\nEnd Sub\n</code></pre>\n\n<p>I created a variable called UpOneDir which takes fil.path and removes the fil.name from it. I then split the result using the \"\\\" and work out the length of the value of the upper boundary of the array, I then take the left side of the string minus that length we just calculated.</p>\n\n<p>It looks really messy but it works. There may be an easier way to do this using the file system object, I just don't use it enough to know off the top of my head.</p>\n\n<p>You could make it look pretty if you really wanted to by stepping out the parts of the UpOneDir creation into little parts but I get the sense that this will be a once use thing for you to simply convert some files to the current powerpoint format.</p>\n"}], "owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497486085, "creation_date": 1497391164, "last_edit_date": 1497486085, "question_id": 44532285, "link": "https://stackoverflow.com/questions/44532285/how-to-change-directory-when-performing-a-loop-in-vba", "title": "How to change directory when performing a loop in VBA?", "body": "<p>I would like to go up one level to process the following loop. I thought I could use ChDir but I see that when I call the files in, I would be in the incorrect directory. Any help would be appreciated.</p>\n\n<p>I would like to generalize the path because the directory is always changing and is different for other users. </p>\n\n<p>Though, here is a reference of how I would like the code to work.. The files I am processing would be in Data1 and this VBA module would be in Processing, see below. So I would need to go up one directory, to Data1, to pull the files, convert them, and then save the converted files in the same directory, Data1.</p>\n\n<p>C:\\Users\\Documents\\CDRL\\Data1\\Processing</p>\n\n<pre><code>Sub loopFiles()\n\nDim fso As New FileSystemObject\nDim fil As File\nDim fold As Folder\nDim yourfolder As String\n\nSet fold = fso.GetFolder(Application.ActivePresentation.Path)\n\nChDir \"..\"\n\nFor Each fil In fold.Files\n\n    If InStr(1, fil.Name, \".potx\") &gt; 0 Then\n        Application.Presentations.Open fil.Path\n        ActivePresentation.SaveAs Replace(fil.Path, \".potx\", \".pptx\"), ppSaveAsDefault\n        ActivePresentation.Close\n\n        fil.Delete True\n    End If\n\nNext fil\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access-2007"], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1497466798, "creation_date": 1497466798, "answer_id": 44552672, "question_id": 44531678, "link": "https://stackoverflow.com/questions/44531678/access-report-to-excel-with-bold-border-lines/44552672#44552672", "title": "Access report to Excel with bold border lines?", "body": "<pre><code>.Range(\"A1:B6\").Borders.LineStyle=1\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8033533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b001e39ddd5744e7ba7f525775d200fc?s=128&d=identicon&r=PG&f=1", "display_name": "mike Raste", "link": "https://stackoverflow.com/users/8033533/mike-raste"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497466798, "creation_date": 1497388426, "question_id": 44531678, "link": "https://stackoverflow.com/questions/44531678/access-report-to-excel-with-bold-border-lines", "title": "Access report to Excel with bold border lines?", "body": "<p>I have an Access program that takes 2 different related exported csv reports from the ERP and reads them and created on excel output. I would like to have the excel have better grid lines known in 'Format Cells' then 'Border' then hit 'Outline' and 'Inside' this makes it easier to read.</p>\n\n<p>I would like to if I can add this to my code shown that creates the excel output.</p>\n\n<pre><code>Do Until mydeptset.EOF\n            mypos = mydeptset.AbsolutePosition\n            If mypos &gt; 0 Then\n                If Int(mypos / 10) &gt; 0 Then\n                    If mypos Mod 10 = 0 Then\n                        m = 2\n                        n = k + 5\n                        .Activate\n                         .Range(\"A1:AF5\").Select\n                         myxls.Selection.Copy\n\n                         .Range(\"A\" &amp; CStr(n)).Select\n                         .Paste\n                         .Range(\"A\" &amp; n + 3 &amp; \":AF\" &amp; CStr(n + 3)).Clear\n                         mydtset.MoveFirst\n                         n = n + 5\n                         k = n\n                         Do Until mydtset.EOF\n                            .Cells(k, 1) = mydtset!dt\n                            mydtset.MoveNext\n                            k = k + 1\n                        Loop\n                        .Cells(k, 1) = \"Tot\"\n                        .Cells(k, 1).HorizontalAlignment = 2\n                        .Cells(k, 1).Font.Bold = True\n                    End If\n                End If\n            Else\n                n = 4\n                 mydtset.MoveFirst\n                 m = 2\n                k = 6\n                Do Until mydtset.EOF\n                    .Cells(k, 1) = mydtset!dt\n                    mydtset.MoveNext\n                    k = k + 1\n                Loop\n                .Cells(k, 1) = \"Tot\"\n                .Cells(k, 1).HorizontalAlignment = 2\n                .Cells(k, 1).Font.Bold = True\n            End If\n            If n = 4 Then\n                k = 4\n            Else\n                k = n - 2\n            End If\n                .Cells(k, m) = mydeptset!drname\n                With .Cells(k, m)\n                    .Font.Bold = True\n                    .Font.Size = 8\n                    .HorizontalAlignment = 1\n                End With\n</code></pre>\n"}]