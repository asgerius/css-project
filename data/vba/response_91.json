[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6763296, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/85fc99949a16cbe290a64e4ff775ef11?s=128&d=identicon&r=PG&f=1", "display_name": "RARV", "link": "https://stackoverflow.com/users/6763296/rarv"}, "edited": false, "score": 0, "creation_date": 1475771921, "post_id": 39887577, "comment_id": 67088202, "body": "Could you explain a little more, because I am checking and it seems that is similar to what I need only that on my case I think that I need to repeat first column the x time and tranpose the other column to row but not sure if the link shows how or maybe I need to understand a little more that macro.  But I will appreciate the advice"}], "tags": [], "owner": {"reputation": 61, "user_id": 6924140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512d5f6915e65b21c262609e5157ff47?s=128&d=identicon&r=PG&f=1", "display_name": "AjCorneel", "link": "https://stackoverflow.com/users/6924140/ajcorneel"}, "is_accepted": true, "score": 1, "last_activity_date": 1475728358, "creation_date": 1475728358, "answer_id": 39887577, "question_id": 39884606, "link": "https://stackoverflow.com/questions/39884606/macro-to-copy-first-section-and-use-next-group-of-column-that-are-the-sales/39887577#39887577", "title": "Macro to copy first section, and use next group of column that are the sales", "body": "<p>These instructions look like they might be a good first step in the right direction:\n<a href=\"https://www.extendoffice.com/documents/excel/705-excel-convert-table-to-list.html#excel\" rel=\"nofollow\">https://www.extendoffice.com/documents/excel/705-excel-convert-table-to-list.html#excel</a></p>\n\n<p>If you need any further help implementing, just let me know.</p>\n"}], "owner": {"reputation": 31, "user_id": 6763296, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/85fc99949a16cbe290a64e4ff775ef11?s=128&d=identicon&r=PG&f=1", "display_name": "RARV", "link": "https://stackoverflow.com/users/6763296/rarv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 39887577, "answer_count": 1, "score": 0, "last_activity_date": 1475728358, "creation_date": 1475706045, "last_edit_date": 1531161705, "question_id": 39884606, "link": "https://stackoverflow.com/questions/39884606/macro-to-copy-first-section-and-use-next-group-of-column-that-are-the-sales", "title": "Macro to copy first section, and use next group of column that are the sales", "body": "<p>now I am working with an excel file that have the sales of differents POS or store but I need to convert it from row to a kind of combination of row and column the idea is the following.</p>\n\n<pre><code>Original Excel has\n\nColumn a      Column b   Column C   Column D    Column E\nItem          TacoBell   KFC        Pizza HUT   Dominos\nFlour          10           8          11         9 \nEgg            15           9          10         16    \nSugar          20           22         12         18\n\nSo the result excel need to be like\n\nColumn a      Column b   \nItem          TacoBell  \nFlour          10         \nEgg            15         \nSugar          20         \nColumn a      Column b   \nItem          TacoBell  \nFlour          10         \nEgg            15          \nSugar          20          \nColumn a       Column D    \nItem           Pizza HUT   \nFlour              11        \nEgg                10           \nSugar              12         \nColumn a      Column E\nItem            Dominos\nFlour           9 \nEgg             16    \nSugar           18\n</code></pre>\n\n<p>Please give any advice or guide me on doing it, I want to learn how to solve it.</p>\n\n<p>Thanks on advance..</p>\n"}, {"tags": ["vba", "excel", "pivot"], "answers": [{"comments": [{"owner": {"reputation": 6035, "user_id": 237109, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/eaa8d828dadadec5ddf8b2277d267d72?s=128&d=identicon&r=PG", "display_name": "Micah Armantrout", "link": "https://stackoverflow.com/users/237109/micah-armantrout"}, "edited": false, "score": 0, "creation_date": 1554481136, "post_id": 39898181, "comment_id": 97782569, "body": "I get false for every item even though the item is checked"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1475762744, "creation_date": 1475762744, "answer_id": 39898181, "question_id": 39884591, "link": "https://stackoverflow.com/questions/39884591/how-to-check-if-multiple-items-are-selected-in-a-pivot-table/39898181#39898181", "title": "How to check if multiple items are selected in a pivot table?", "body": "<p>Try the sample code below:</p>\n\n<pre><code>Sub Check_PivotFilter_Selection()\n\nDim pvt As PivotTable\nDim fld As PivotField\nDim itm As PivotItem\nDim flt As PivotFilter\n\nDim i As Integer\n\nSet xbFuente = ThisWorkbook\nSet xlDatos = xbFuente.Worksheets(\"TABLAS\")\nSet pvt = xlDatos.PivotTables(\"MAIN\")\n\npvt.ManualUpdate = True\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nIf pvt.ShowPageMultipleItemLabel = True Then\n   Debug.Print \"The words 'Multiple Items' can be displayed.\"\nEnd If\n\n\nFor Each fld In pvt.PageFields\n    Debug.Print fld.Name &amp; \" -- \" &amp; fld.Orientation &amp; \" -- \" &amp; fld.EnableItemSelection &amp; \" -- \" &amp; fld.EnableMultiplePageItems &amp; \" -- \"\n\n    ' loop through all items in Field, and check which ones are Selected (and which ones are not)\n    For Each itm In fld.PivotItems\n\n        If itm.Visible = True Then\n            Debug.Print \" Item \" &amp; itm.Name &amp; \" in Field \" &amp; fld.Name &amp; \" is Visible (Selected) \"\n        Else\n            Debug.Print \" Item \" &amp; itm.Name &amp; \" in Field \" &amp; fld.Name &amp; \" is Hidden (Not Selected) \"\n        End If\n\n    Next itm    \nNext fld\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5324817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4768d7f265069dabfc89f8d1545041ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ximo", "link": "https://stackoverflow.com/users/5324817/ximo"}, "is_accepted": false, "score": 0, "last_activity_date": 1475788508, "creation_date": 1475788508, "answer_id": 39905730, "question_id": 39884591, "link": "https://stackoverflow.com/questions/39884591/how-to-check-if-multiple-items-are-selected-in-a-pivot-table/39905730#39905730", "title": "How to check if multiple items are selected in a pivot table?", "body": "<p>i check your code and i have same result as mine. In my tests last week i tried with .hidden &amp; .visible properties and it works fine if i do not select \"multiple items selected\".</p>\n\n<pre><code>Warranty Flag -- 3 -- Verdadero -- Verdadero -- \nItem I in Field Warranty Flag is Hidden (Not Selected) \nItem O in Field Warranty Flag is Hidden (Not Selected) \nItem IW in Field Warranty Flag is Hidden (Not Selected)\n</code></pre>\n\n<p>Pivot table was created manually, not created by vba and i am working with excel 2010.</p>\n"}], "owner": {"reputation": 31, "user_id": 5324817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4768d7f265069dabfc89f8d1545041ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ximo", "link": "https://stackoverflow.com/users/5324817/ximo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1475788508, "creation_date": 1475705957, "last_edit_date": 1531164843, "question_id": 39884591, "link": "https://stackoverflow.com/questions/39884591/how-to-check-if-multiple-items-are-selected-in-a-pivot-table", "title": "How to check if multiple items are selected in a pivot table?", "body": "<p>Is it possible to know which items are checked in a PivotTable filter in case <code>MultipleItems</code> are allowed?</p>\n\n<p>I only see <code>.Visible</code> property to check it but it only works if multiple items are not allowed.\nIf multiple items are allowed and checked <code>.Visible</code> property, you only see \"ALL\" instead of all items selected.</p>\n\n<p>Any way to do it?</p>\n\n<pre><code>Dim pvt As PivotTable\nDim fld As PivotField\nDim itm As PivotItem\nDim flt As PivotFilter\n\nDim i As Integer\n\n\nSet xbFuente = ThisWorkbook\nSet xlDatos = xbFuente.Worksheets(\"TABLAS\")\nSet pvt = xlDatos.PivotTables(\"MAIN\")\n\npvt.ManualUpdate = True\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nIf pvt.ShowPageMultipleItemLabel = True Then\n   Debug.Print \"The words 'Multiple Items' can be displayed.\"\nEnd If\n\nFor Each fld In pvt.PageFields        \n    Debug.Print fld.Name &amp; \" -- \" &amp; fld.Orientation &amp; \" -- \" &amp; fld.EnableItemSelection &amp; \" -- \" &amp; fld.EnableMultiplePageItems &amp; \" -- \"\n\n\n    If fld.AllItemsVisible = True Then\n    ' If all items are visible  \"ALL\"\n        For Each itm In fld.VisibleItems\n            Debug.Print \"---- ALLITEMSVISIBLE TRUE --\" &amp; \"VISIBLE\" &amp; \" -- \" &amp; itm.Name &amp; \" -- \" &amp; itm.Visible\n        Next\n    Else\n        For Each itm In fld.VisibleItems\n            Debug.Print \"---- ALLITEMSVISIBLE FALSE --\" &amp; \"VISIBLE\" &amp; itm.Name &amp; \" -- \" &amp; itm.Visible\n        Next\n        For Each itm In fld.HiddenItems\n            Debug.Print \"--------ALLITEMSVISIBLE FALSE --\" &amp; \"HIDDEN -- \" &amp; itm.Name &amp; \" -- \" &amp; itm.Visible\n        Next\n        For Each itm In fld.PivotItems\n            Debug.Print \"--------ALLITEMSVISIBLE FALSE --\" &amp; \"HIDDEN -- \" &amp; itm.Name &amp; \" -- \" &amp; itm.Value\n        Next\n    End If\n\n    Next\n</code></pre>\n\n<p><strong>Result</strong>:\n<code>Warranty Flag -- 3 -- Verdadero -- Verdadero -- \n---- ALLITEMSVISIBLE FALSE --VISIBLE(All) -- Verdadero\n--------ALLITEMSVISIBLE FALSE --HIDDEN -- A -- Falso\n--------ALLITEMSVISIBLE FALSE --HIDDEN -- I -- Falso\n--------ALLITEMSVISIBLE FALSE --HIDDEN -- O -- Falso\n--------ALLITEMSVISIBLE FALSE --HIDDEN -- P -- Falso</code></p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1475732506, "post_id": 39885324, "comment_id": 67062904, "body": "Could you describe a little the snippet you suggested? This creates searchable content and help your answer being viewed."}], "tags": [], "owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "is_accepted": false, "score": 0, "last_activity_date": 1475710851, "creation_date": 1475710851, "answer_id": 39885324, "question_id": 39884398, "link": "https://stackoverflow.com/questions/39884398/add-data-field-to-pivot-based-on-cell/39885324#39885324", "title": "Add Data field to Pivot based on cell", "body": "<pre><code>Sub adddynamic()\nDim pt As PivotTable\nDim pf As PivotField\nDim f As String\n\nf = Range(\"d21\")\nSet pt = ActiveSheet.PivotTables(\"PivotTable1\")\nSet pf = pt.PivotFields(f)\npt.AddDataField pf, \"Sum of \" &amp; f, xlSum\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1475710851, "creation_date": 1475704879, "question_id": 39884398, "link": "https://stackoverflow.com/questions/39884398/add-data-field-to-pivot-based-on-cell", "title": "Add Data field to Pivot based on cell", "body": "<p>I am trying to create an interactive pivot table by allowing the user to select which data field to show (ie dollars earned, dollars spent).  I have the following code that works</p>\n\n<pre><code>Sub AddMoreFields()\n\n With ActiveSheet.PivotTables(\"PivotTable1\")\n .AddDataField ActiveSheet.PivotTables( _\n \"PivotTable1\").PivotFields(\"Dollars_spent\")\n End With\n\nEnd Sub\n</code></pre>\n\n<p>However, i want to change it to something like the following, so that a user can select which data to show</p>\n\n<pre><code>Sub AddMoreFields()\n\n With ActiveSheet.PivotTables(\"PivotTable1\")\n .AddDataField ActiveSheet.PivotTables( _\n \"PivotTable1\").PivotFields(Range(\"d21\"))\n End With\n\nEnd Sub\n</code></pre>\n\n<p>Range(\"D21\") would actually be a drop down list in which a user could select between dollars earned and dollars spent.  However, when i try use this i get an error stating that Rang(\"D21\") is not a pivot field.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 1, "creation_date": 1475702792, "post_id": 39883884, "comment_id": 67054816, "body": "get rid of this - it&#39;s not necessary: <code>Range(&quot;A4&quot;).End(xlDown).Select</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1475702828, "post_id": 39883884, "comment_id": 67054831, "body": "1. Don&#39;t use <code>ActiveCell</code> use <code>Target</code> as the cell in whcih they click is passed to the sub.  2. <code>Cell.EntireRow.Hidden = Cell.Value =  Target.Offset(0, -2).value</code> 3. <code>For Each Cell In Range(&quot;A4&quot;, Cells(Rows.Count,1).End(xlUp))</code>"}, {"owner": {"reputation": 27, "user_id": 6919617, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ab43078d8e55b0315fc5a5effecaa439?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doe", "link": "https://stackoverflow.com/users/6919617/m-doe"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475703040, "post_id": 39883884, "comment_id": 67054935, "body": "@ScottCraner - perfect this works great. i&#39;m not sure i can upvote comments, if you would like to post this briefly as a answer i will be happy to upvote. thanks"}, {"owner": {"reputation": 27, "user_id": 6919617, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ab43078d8e55b0315fc5a5effecaa439?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doe", "link": "https://stackoverflow.com/users/6919617/m-doe"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475703449, "post_id": 39883884, "comment_id": 67055116, "body": "@ScottCraner is there also a way i could hide all the rows matching the target row values in column A - but without hiding the actual target row itself? so say there were 4 rows with number 12 in column A. If i click row1 it would hide rows2,3 and 4 without hiding row 1?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6919617, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ab43078d8e55b0315fc5a5effecaa439?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doe", "link": "https://stackoverflow.com/users/6919617/m-doe"}, "edited": false, "score": 0, "creation_date": 1475833373, "post_id": 39884458, "comment_id": 67112407, "body": "Thank you for your code, i have tried to use this, however it hides blank rows at the top of my spreadsheet which do not have any values at all and do not have matching values. Please can you help me figure out why this is happening?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1475705234, "creation_date": 1475705234, "answer_id": 39884458, "question_id": 39883884, "link": "https://stackoverflow.com/questions/39883884/excel-vba-hide-all-rows-where-value-active-cell-offset-cell-value/39884458#39884458", "title": "Excel VBA - Hide All Rows where value = Active Cell Offset Cell Value?", "body": "<p>This will hide the alternative rows, but hide hide the row with ActiveCell:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub\n    If Not Intersect(Target, Range(\"C:C\")) Is Nothing And Target.Value = \"Click to Hide\" Then\n        valu = Cells(Target.Row, 1).Value\n        For i = 1 To ActiveSheet.UsedRange.Rows.Count\n            If Cells(i, 1).Value = valu Then\n                Cells(i, 1).EntireRow.Hidden = True\n            Else\n                Cells(i, 1).EntireRow.Hidden = False\n            End If\n        Next i\n        Target.EntireRow.Hidden = False\n    Else\n        Rows.Hidden = False\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6919617, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ab43078d8e55b0315fc5a5effecaa439?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doe", "link": "https://stackoverflow.com/users/6919617/m-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1549, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475705234, "creation_date": 1475702470, "question_id": 39883884, "link": "https://stackoverflow.com/questions/39883884/excel-vba-hide-all-rows-where-value-active-cell-offset-cell-value", "title": "Excel VBA - Hide All Rows where value = Active Cell Offset Cell Value?", "body": "<p>I have a spreadsheet laid out like so:</p>\n\n<pre><code>A        B            C\n12       Row1         Click to Hide\n12       Row2         Click to Hide\n5        Row3         Click to Hide\n4        Row4         Click to Hide\n12       Row5         Click to Hide\n</code></pre>\n\n<p>I am using the following vba code to try and hide all rows which share the same number (in Column A) as the activeCell Row which the user has clicked to hide.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nIf Not Intersect(ActiveCell, Range(\"C:C\")) Is Nothing And ActiveCell.Value = \"Click to Hide\" Then\n\n\nDim Cell As Range\n\nApplication.ScreenUpdating = False\n\nRange(\"A4\").End(xlDown).Select\n\n\nFor Each Cell In Range(ActiveCell, \"A4\")\nCell.EntireRow.Hidden = ActiveCell.Offset(0, -2)\n\nNext\nApplication.ScreenUpdating = True\n\n\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>So for instance, if a user clicks 'Click to Hide' in column C on Row1, all rows with the number 12 in column A should be hidden.</p>\n\n<p>At the moment i am getting an error code, 1004 offset of object or range failed.\nPlease can someone show me where i am going wrong? Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "hyperlink", "macros"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 2, "creation_date": 1475702407, "post_id": 39883823, "comment_id": 67054651, "body": "Tip: avoid using <code>On Error Resume Next</code> because it doesn&#39;t let you gracefully handle errors on a granular basis."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475702408, "post_id": 39883823, "comment_id": 67054653, "body": "What do you mean by &quot;won&#39;t work&quot;?  What happens?"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1475702427, "post_id": 39883823, "comment_id": 67054664, "body": "Also, how do you want your macro to work if a workbook doesn&#39;t have any hyperlinks? You write &quot;I want it to get the HTTP link&quot; without being clear about what the link is - or how it&#39;s created, or what happens if there isn&#39;t one - or if there are multiple links."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475703149, "post_id": 39883823, "comment_id": 67054977, "body": "To use it in any workbook on your computer.  Create a personal.xlsb workbook for the vba.  Put this in one of those modules.  Then you would call it <code>=Personal.xlsb!GetURL(A1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1475706391, "creation_date": 1475706391, "answer_id": 39884664, "question_id": 39883823, "link": "https://stackoverflow.com/questions/39883823/excel-macro-is-not-working/39884664#39884664", "title": "Excel macro is not working", "body": "<p>There are 2 approaches that I can think about to perform this:\n<br>1. Make an Add In that would contain your UDF and install properly \n<br><a href=\"https://support.microsoft.com/en-us/kb/151490\" rel=\"nofollow\">Official Documentantion</a>\nI think this is the best approach due to your statement</p>\n\n<blockquote>\n  <p><em>Quote: anytime I open Excel and use =GetURL(A1) I want it to get the HTTP link.</em>></p>\n</blockquote>\n\n<p><br>2. You may use the UDF from the original workbook like so:</p>\n\n<pre><code>=Book1.xlsm!GetURL(A1)\n</code></pre>\n\n<p>As long as the workbook is opened</p>\n"}], "owner": {"reputation": 81, "user_id": 6436098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/V3Tmt.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6436098/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475706391, "creation_date": 1475702236, "last_edit_date": 1475702434, "question_id": 39883823, "link": "https://stackoverflow.com/questions/39883823/excel-macro-is-not-working", "title": "Excel macro is not working", "body": "<p>I had successfully created a macro, but had to keep recreating it for every Excel doc I wanted to use it in. Now it won't work for any of the workbooks.</p>\n\n<pre><code>Function GetURL(rng As Range) As String\n  On Error Resume Next\n  GetURL = rng.Hyperlinks(1).Address\nEnd Function\n</code></pre>\n\n<p>What I would like to do is activate this macro across ALL workbooks, anytime I open Excel and use <code>=GetURL(A1)</code> I want it to get the HTTP link.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1475700803, "post_id": 39883348, "comment_id": 67053974, "body": "what error? could you provide an [mvce]?"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1475702596, "creation_date": 1475702596, "answer_id": 39883912, "question_id": 39883348, "link": "https://stackoverflow.com/questions/39883348/vba-activechart-seriescollectionnumero-xvalues/39883912#39883912", "title": "VBA ActiveChart.SeriesCollection(numero).XValues", "body": "<blockquote>\n<pre><code>Sheets(ComboBox6.Text).Range(Cells(i + 1, ma), Cells(1 + i, ho))\n</code></pre>\n</blockquote>\n\n<p>The <code>.Range</code> call is qualified with a specific <code>Sheet</code>.</p>\n\n<p><code>Cells</code> calls, on the other hand, aren't; they're <em>implicitly</em> referring to the <code>ActiveSheet</code> - if that's not the same sheet <code>.Range</code> is qualified with, you can expect an error to happen.</p>\n\n<p>Keep a reference to your sheet with a <code>With</code> block, and qualify your <code>Range</code> and <code>Cells</code> calls with a dot:</p>\n\n<pre><code>With Worksheets(comboBox6.Text)\n    ActiveChart.SeriesCollection(numero).Values = _\n        .Range(.Cells(i + 1, ma), .Cells(i + 1, ho))\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6928612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a499c03718091fb3005c4128a81bd7?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos D. Hurtado", "link": "https://stackoverflow.com/users/6928612/carlos-d-hurtado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 39883912, "answer_count": 1, "score": 0, "last_activity_date": 1475958079, "creation_date": 1475700381, "last_edit_date": 1531161705, "question_id": 39883348, "link": "https://stackoverflow.com/questions/39883348/vba-activechart-seriescollectionnumero-xvalues", "title": "VBA ActiveChart.SeriesCollection(numero).XValues", "body": "<p>I have this code;   </p>\n\n<p>I am creating charts in Excel, but a mistake always appears when I am creating xValues. Help me. </p>\n\n<pre><code>Private Sub CommandButton3_Click()\n   Dim VectorGrafica(26) As Integer\n   Dim cuenta As Integer\n   Dim ho As Integer\n   Dim ma As Integer\n   Dim ejex As Range\n   Dim numero As Integer\n   Dim ejey As Range    \n\n  cuenta = 0\n  da = 1\n  If ComboBox3 = \"\" Or ComboBox4 = \"\" Then\n  MsgBox \"No ha determinado el horizonte de tiempo\", vbOKOnly, \"Horizonte de   tiempo\"\n End If\n\n For s = 24 To 46\n If Controls(\"CheckBox\" &amp; s) = True Then\n cuenta = 1 + cuenta\n VectorGrafica(da) = 1\n da = da + 1\n Else\n VectorGrafica(da) = 0\n da = da + 1\n End If\n Next s\n\n If cuenta = 0 Then\n MsgBox \"No ha seleccionado ning\u00fan rubro\", vbOKOnly, \"Rubros\"\n End If\n\n If cuenta &gt; 0 Then\n    numero = 1\n\n    Select Case ComboBox3.ListIndex\n    Case 0\n    ma = 2\n    Case 1\n    ma = 3\n    Case 2\n    ma = 4\n    Case 3\n    ma = 5\n     Case 4\n    ma = 6\n     Case 5\n    ma = 7\n     Case 6\n    ma = 8\n     Case 7\n    ma = 9\n     Case 8\n    ma = 10\n     Case 9\n    ma = 11\n     Case 10\n    ma = 12\n     Case 11\n    ma = 13\n\n    End Select\n\n    Select Case ComboBox4.ListIndex\n\n    Case 0\n    ho = 2\n\n    Case 1\n    ho = 3\n\n    Case 2\n    pa = 4\n\n    Case 3\n    ho = 5\n\n    Case 4\n    ho = 6\n\n    Case 5\n    ho = 7\n\n    Case 6\n    ho = 8\n\n    Case 7\n    ho = 9\n\n    Case 8\n    ho = 10\n\n    Case 9\n    ho = 11\n\n    Case 10\n    ho = 12\n\n    Case 11\n    ho = 13\n\n    End Select\n\n      Dim hola As Range    \n\n    ActiveSheet.Shapes.AddChart2(240, xlXYScatterSmooth).Select\n    For i = 1 To 25\n    If VectorGrafica(i) = 1 Then\n\n        ActiveChart.Activate\n\n    Set rangodenombre = Sheets(ComboBox6.Text).Cells(i + 1, 1)\n    ActiveChart.SeriesCollection.NewSeries\n    ActiveChart.FullSeriesCollection(numero).Name = rangodenombre\n\n  ActiveChart.SeriesCollection(numero).XValues = \n\n_Sheets(ComboBox6.Text).Range(Cells(1, ma), Cells(1, ho))\n\n   ActiveChart.SeriesCollection(numero).Values =\n\n Sheets(ComboBox6.Text).Range(Cells(i + 1, ma), Cells(1 + i, ho))***\n\n    numero = numero + 1\n\n    End If\n    Next i       \n\n End If     \nEnd Sub\n</code></pre>\n\n<p>The part with *** shows me an error, but I don't know why.\nI am treating to do chart in Excel. Please help me!</p>\n"}, {"tags": ["arrays", "vba", "split"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1475699703, "post_id": 39883108, "comment_id": 67053439, "body": "You are stuck using replace(), or if you really don&#39;t want that then you can parse character-by-character and that&#39;s going to be even <i>more</i> work.  Or just wrap this up in a function and move on.  If you have mixtures of multi- and single- character delimiters make sure to Replace the longer strings first."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1475699870, "post_id": 39883108, "comment_id": 67053535, "body": "@TimWilliams I did just that. I made this to answer someone else&#39;s question and it worked so well, and I couldn&#39;t find anything as simple anywhere else, so I posted this as a simple &quot;answer my own question&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1475700137, "post_id": 39883108, "comment_id": 67053658, "body": "Aha! - i hadn&#39;t twigged it was your answer!"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475715721, "post_id": 39883108, "comment_id": 67058393, "body": "@ThomasInzina I think I see what you&#39;re talking about. As far as the multiple delimiter portion goes, I just thought of an example that would break the code. For that, I take back my snarkyness."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1475716364, "post_id": 39883108, "comment_id": 67058524, "body": "I get your point about answering your own question.  Personally, I think that code review might be a better forum for this."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475758196, "post_id": 39883108, "comment_id": 67078552, "body": "@ThomasInzina I didn&#39;t understand what you had meant that it couldn&#39;t do multi-character delimiters until I tried using it in a different way (i tried using it on code and delimiting the word &quot;For&quot; and what do you know it split the code up with &quot;f&quot;, &quot;o&quot;, and &quot;r&quot; as delimiters..). I&#39;ve updated the function to include an actual multi-character delimiter option."}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475699566, "post_id": 39883109, "comment_id": 67053369, "body": "This is simply a replace of all the delimiters for a common one. Of course its done very nicely but still as per the OP requirements isn&#39;t a viable solution. Though turning the problem in my head I don&#39;t see any other viable way of doing it."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475699706, "post_id": 39883109, "comment_id": 67053441, "body": "Well, look at what the last <code>For Loop</code> does. Essentially there&#39;s no difference between having multiple characters as a delimiter, and single characters. The problem people would run into (errors being thrown around) was because their array would be filled with blanks. So I got rid of the blanks with the function, essentially turning multiple character delimiters into single character delimiters, leaving only the desired values left over to fill the array. :D"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1475700012, "post_id": 39883109, "comment_id": 67053601, "body": "Since you&#39;ve done this as an &quot;answer my own question&quot; post, you could also accept the answer."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475706076, "post_id": 39883109, "comment_id": 67056053, "body": "@nbayly What about <a href=\"http://stackoverflow.com/a/39884122/111794\">regular expressions</a>?"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475758171, "post_id": 39883109, "comment_id": 67078543, "body": "@nbayly I didn&#39;t understand what you had meant that it couldn&#39;t do multi-character delimiters until I tried using it in a different way (i tried using it on code and delimiting the word &quot;For&quot; and what do you know it split the code up with &quot;f&quot;, &quot;o&quot;, and &quot;r&quot; as delimiters..). I&#39;ve updated the function to include an actual multi-character delimiter option."}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 1, "last_activity_date": 1475759891, "last_edit_date": 1475759891, "creation_date": 1475699324, "answer_id": 39883109, "question_id": 39883108, "link": "https://stackoverflow.com/questions/39883108/vba-how-to-build-an-array-with-multiple-delimiters-of-varying-sizes/39883109#39883109", "title": "VBA - How to build an array with multiple delimiters of varying sizes?", "body": "<p><strong>In this situation, I found the following function to be perfect for my needs:</strong></p>\n\n<pre><code>Function MultiSplit(SourceText As String, Optional SingleCharDelimiter As String, Optional MultiCharDelimiter As String, _\n    Optional Separator As String) As String()\n'Created by Tyeler for use by all.\n'SourceText is your input string.\n'SingleCharDelimiter is a string of desired delimiters.\n'SingleCharDelimiter format is a string fully concatenated with no character separation.\n'  (ex. \"-.;:, \" MultiSplit will use those 6 characters as delimiters)\n'SingleCharDelimiter's will remove blanks from the array in the event two single delimiters\n'  are next to each other.\n'MultiCharDelimiter is a string of specific multi-character delimiters.\n'MultiCharDelimiters can be separated by the optional Separator\n'Separator is an optional value used to separate multiple MultiCharDelimiters.\n'  (ex. MultiCharDelimiter = \"A A,B B,C C\" // Separator = \",\" // This will make the function\n'    delimit a string by \"A A\", \"B B\", and \"C C\")\n'MultiSplit will make an array based on any delimiter (Including delimiters with\n'  multiple characters).\n\n\n    If MultiCharDelimiter = \"\" And SingleCharDelimiter = \"\" Then Exit Function\n    Dim i As Integer, n As Integer, dlimit\n    Dim delColl As New Collection\n    Dim newString As String: newString = SourceText\n    Dim delArr() As String, strgArr() As String, delFull() As String\n    Dim delSep As String, a As Integer: a = 33\n\n    Do While InStr(SingleCharDelimiter, Chr(a)) &lt;&gt; 0 Or InStr(MultiCharDelimiter, Chr(a)) &lt;&gt; 0 _\n        Or InStr(Separator, Chr(a)) &lt;&gt; 0 Or InStr(SourceString, Chr(a)) &lt;&gt; 0 'Find intermediate delimiter\n            a = a + 1\n    Loop\n    delSep = Chr(a)\n\n    If MultiCharDelimiter &lt;&gt; \"\" Then\n        If Separator &lt;&gt; \"\" Then 'If there's no delimiter for the delimiter array, assume MultiCharDelimiter is the delimiter\n            delArr() = Split(MultiCharDelimiter, Separator)\n            For i = 0 To UBound(delArr)\n                If InStr(newString, delArr(i)) &lt;&gt; 0 Then newString = Replace(newString, delArr(i), delSep)\n            Next i\n        Else\n            newString = Replace(newString, MultiCharDelimiter, delSep)\n        End If\n    End If\n    Erase delArr\n\n    For i = 1 To Len(SingleCharDelimiter) 'Build a collection of user defined delimiters\n        delColl.Add Mid(SingleCharDelimiter, i, 1)\n    Next i\n\n    For Each dlimit In delColl 'Replace all delimiters in the string with a single common one\n        newString = Replace(newString, dlimit, delSep)\n    Next dlimit\n\n    strgArr() = Split(newString, delSep)\n    ReDim delFull(LBound(strgArr) To UBound(strgArr))\n    n = LBound(strgArr)\n\n    For i = LBound(strgArr) To UBound(strgArr) 'Get rid of empty array items\n        If strgArr(i) &lt;&gt; \"\" Then\n            delFull(n) = strgArr(i)\n            n = n + 1\n        End If\n    Next i\n\n    n = n - 1\n    ReDim Preserve delFull(LBound(strgArr) To n)\n    MultiSplit = delFull 'Send the delimited array\n    Erase delFull\n    Erase strgArr\nEnd Function\n</code></pre>\n\n<p><strong>This function will return an array of values that were separated by user defined delimiters.</strong></p>\n\n<p><strong>To use this function, simply call on it and supply your full string and desired delimiters:</strong></p>\n\n<pre><code>Sub Example1()\n    Dim exString As String\n    Dim myString() As String\n    Dim c, n\n\n    exString = \"A,B C;D &gt; E\"\n\n    myString() = MultiSplit(exString, \", ;\", \" &gt; \")\n    n = 0\n    For Each c In myString\n        Debug.Print \"(\" &amp; n &amp; \") = \" &amp; c\n        n = n + 1\n    Next c\nEnd Sub\n</code></pre>\n\n<p><strong>This will yield the desired result where the array is filled with only ABCDE.</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/IFDnm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IFDnm.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>A more complicated example:</strong></p>\n\n<pre><code>Sub Example2()\n    Dim myString As String, c, n\n\n    n = 0\n    myString = \"The,Quickupside-downBrownjelloFox_Jumped[Over]             ThegiantLazyjelloDog\"\n\n    For Each c In MultiSplit(myString, \",_[] \", \"upside-down,jello,giant\", \",\")\n        Debug.Print \"(\" &amp; n &amp; \") = \" &amp; c\n        n = n + 1\n    Next c\nEnd Sub\n</code></pre>\n\n<p><strong>This will yield the following:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/XTwGX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XTwGX.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475715237, "post_id": 39883326, "comment_id": 67058323, "body": "This was the approach I had initially tried, but I felt the code just looked repetitive, which to me has always meant I can loop it. I was also running into issues where multiple characters being delimited in some cases, and not in others was throwing errors where I had it applied."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1475700289, "creation_date": 1475700289, "answer_id": 39883326, "question_id": 39883108, "link": "https://stackoverflow.com/questions/39883108/vba-how-to-build-an-array-with-multiple-delimiters-of-varying-sizes/39883326#39883326", "title": "VBA - How to build an array with multiple delimiters of varying sizes?", "body": "<p>Perhaps:</p>\n\n<pre><code>Sub Example()\n\n    Dim exString As String\n    Dim myString() As String\n\n    exString = \"A,B C;D &gt; E\"\n    exString = Replace(exString, \",\", \" \")\n    exString = Replace(exString, \";\", \" \")\n    exString = Replace(exString, \"&gt;\", \" \")\n    exString = Application.WorksheetFunction.Trim(exString)\n\n    myString() = Split(exString, \" \")\n\n    msg = \"\"\n    For Each a In myString\n        msg = msg &amp; vbCrLf &amp; a\n    Next a\n\n    MsgBox msg\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wHyag.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wHyag.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475704637, "post_id": 39884122, "comment_id": 67055574, "body": "You could use a greedy negated character class of delimiters for the pattern; then create a match collection which you can dump into an array"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475705639, "post_id": 39884122, "comment_id": 67055912, "body": "@RonRosenfeld It&#39;s a little more complicated, because the VBScript regex object model doesn&#39;t allow you to assign the matches collection into an array; it involves iterating over the matches. Nevertheless, I&#39;ve updated accordingly."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475715372, "post_id": 39884122, "comment_id": 67058340, "body": "@ZevSpitz This is a really cool way of doing. I admit I really don&#39;t know anything about regular expressions. I&#39;ve never used them before and nothings directed me to go this route. I&#39;m definitely going to look into it, thanks for the great answer!"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475771740, "post_id": 39884122, "comment_id": 67088085, "body": "@Tyeler Updated to show how to get an array from a <code>MatchCollection</code>."}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 2, "last_activity_date": 1475771578, "last_edit_date": 1495540101, "creation_date": 1475703436, "answer_id": 39884122, "question_id": 39883108, "link": "https://stackoverflow.com/questions/39883108/vba-how-to-build-an-array-with-multiple-delimiters-of-varying-sizes/39884122#39884122", "title": "VBA - How to build an array with multiple delimiters of varying sizes?", "body": "<p>You can <a href=\"http://regex.info/blog/2006-09-15/247\" rel=\"nofollow noreferrer\">have lots of problems</a> in VBA as well:</p>\n\n<pre><code>'Add a reference to Microsoft VBScript Regular Expressions 5.5 (Tools -&gt; References...)\n\nDim exString As String\nexString = \"A,B C;D &gt; E\"\n\nDim re As New RegExp\nre.Pattern = \"(,| |;|&gt;)+\"\nre.Global = True\n\nDim myString() As String\nmyString = Split(re.Replace(\"A,B C;D &gt; E\", \",\"), \",\")\n</code></pre>\n\n<p>Setting <code>re.Pattern</code> defines what to look for. <code>|</code> represents finding <code>A or B</code>, so the regular expression will match on <code>,</code> or <code></code> or <code>;</code> or <code>&gt;</code>.</p>\n\n<p>Multiple instances should be treated as one (e.g. between the <code>D</code> and the <code>E</code> there are three characters, but there should be only one split), so add a <code>+</code> at the end (and wrap everything else in <code>()</code>).</p>\n\n<p><code>Replace</code> then replaces any of the matched patterns with <code>,</code> and gives back a string like this:</p>\n\n<blockquote>\n  <p>A,B,C,D,E</p>\n</blockquote>\n\n<p>on which we can simply call <code>Split</code> to get back the array.</p>\n\n<ul>\n<li>Reference: <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops/22542835#22542835\">VBScript Regular Expressions</a></li>\n</ul>\n\n<hr>\n\n<p>Instead of using regular expressions to match the delimiter characters, you could use regexes to match the non-delimiter characters:</p>\n\n<pre><code>Dim re As New RegExp\nre.Pattern = \"[^, ;&gt;]+\"   'The ^ unmatches any characters within the []\nre.Global = True\n\nDim match As Match\nFor Each match In re.Execute(exString)\n    'do something with each result here\n    Debug.Print match.Value\nNext\n</code></pre>\n\n<p>This is sufficient if all you need is to iterate over the results and do something with them. If you specifically need an array with the results:</p>\n\n<pre><code>Dim re As New RegExp\nre.Pattern = \"[^, ;&gt;]+\"\nre.Global = True\n\nDim matches As MatchCollection\nSet matches = re.Execute(exString)\nReDim myString(matches.Count) As String\nDim i As Integer\nFor i = 0 To matches.Count - 1\n    myString(i) = matches(i).Value\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475760048, "post_id": 39886203, "comment_id": 67079944, "body": "I never knew something like <code>ParamArray</code> existed. I searched everywhere for a function that could do something similar to what you have here and couldn&#39;t find anything remotely close to that. +1 for simplicity."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475760272, "post_id": 39886203, "comment_id": 67080105, "body": "Thanks  Note: you can&#39;t use optional parameters with ParamArray and you ParamArray is limited to 29 parameters in xl 2003 or older and 60 parameters in 2007 or newer."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475760873, "post_id": 39886203, "comment_id": 67080520, "body": "I&#39;m checking it out right now. I thought I was sharing something cool but this has become more of a learning experience for me than providing anything useful. I did fix the function in my answer to actually answer my own question. It&#39;s a lot more coding than this though, and I&#39;m worried it isn&#39;t as user-friendly or intuitive as I thought it was. Thanks for your answer!!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475766379, "post_id": 39886203, "comment_id": 67084665, "body": "@Tyeler thanks for the edit.  It was good work, I will gladly upvote it if you post it as another answer.  I rejected it because I wanted to keep my answer simple.  I am still on the fence on whether the sort is the right thing to do (e.g. &quot; &gt;&quot; or &quot;&gt; &quot; could make a difference).  I think that the user needs to ensure that the order of operations doesn&#39;t matter when he chooses them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475766391, "post_id": 39886203, "comment_id": 67084674, "body": "@Tyeler Often times it is necessary to have empty elements.  Take for instance a CVS file.  It is understood that every line in the file has same number of columns.  If you were to remove the empty elements when you parsed the file then the columns would not line up properly."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475766607, "post_id": 39886203, "comment_id": 67084850, "body": "That&#39;s true. It&#39;s difficult to write this in an all inclusive way. I think a function like this is something excel needs, but I can think of instances in which having those blanks in the arrays would cause errors, but then there&#39;s times like you just said, where those blanks are desirable. Maybe a boolean?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475767664, "post_id": 39886203, "comment_id": 67085644, "body": "I noticed at the end of your routines that you <code>Erase</code> your arrays.  It really isn&#39;t necessary.  The variables within a routine share the same scope as the routine.  When the routine exits the VBA garbage collector cleans them all up.  You would want to Erase large arrays, if there was more code to execute before the procedure ended."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475768722, "post_id": 39886203, "comment_id": 67086316, "body": "True! I don&#39;t know why I had it in my head that the arrays would stay built until the next use of the function.. I don&#39;t know why I keep thinking arrays are static.... I added the answer like you suggested with the boolean statement included."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1475718063, "creation_date": 1475718063, "answer_id": 39886203, "question_id": 39883108, "link": "https://stackoverflow.com/questions/39883108/vba-how-to-build-an-array-with-multiple-delimiters-of-varying-sizes/39886203#39886203", "title": "VBA - How to build an array with multiple delimiters of varying sizes?", "body": "<p>You were on the right track with your function.  Using a ParamArray you can easily change the number and position of your delimiters.</p>\n\n<h2>Code</h2>\n\n<pre><code>Function MultiSplit(SourceText As String, ParamArray Delimiters()) As String()\n    Dim v As Variant\n\n    For Each v In Delimiters\n        SourceText = Replace(SourceText, v, \"\u2022\")\n    Next\n\n    MultiSplit = Split(SourceText, \"\u2022\")\n\nEnd Function\n</code></pre>\n\n<h2>Test</h2>\n\n<pre><code>Sub Test()\n    Const example As String = \"A,B C;D &gt; E\"\n    Dim a1, a2, a3, Incorrect\n\n    Incorrect = MultiSplit(example, \" \", \" &gt; \")\n    a1 = MultiSplit(example, \" &gt; \", \",\", \";\", \" \")\n    a2 = MultiSplit(example, \" &gt; \", \",\")\n    a3 = MultiSplit(example, \" &gt; \")\nEnd Sub\n</code></pre>\n\n<h2>Result</h2>\n\n<p><a href=\"https://i.stack.imgur.com/ViJLK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ViJLK.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>NOTE:</strong> When using multi-character delimiters, the order that the delimiters are processed matters. Notice that A1 is split proper but Incorrect is not split as intended because the space delimiter came before <code>\" &gt; \"</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1475779319, "post_id": 39900248, "comment_id": 67092250, "body": "Looks good.  Have you been to <a href=\"http://codereview.stackexchange.com/\">Code Review</a>?  I think that you&#39;d like that site a lot."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475803160, "post_id": 39900248, "comment_id": 67101097, "body": "I haven&#39;t. This is my first post where I shared a question-answer because I used the first function I had put up to help someone else with their question and it worked so perfect for that scenario, and was unique to anything I could find on web, that I wanted to share it and hopefully help others who were in the same bind. I am going to see what CodeReview has to offer, because I&#39;ve gained way more than I thought I would out of this experience. Thank you :)"}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": true, "score": 1, "last_activity_date": 1475817021, "last_edit_date": 1475817021, "creation_date": 1475768340, "answer_id": 39900248, "question_id": 39883108, "link": "https://stackoverflow.com/questions/39883108/vba-how-to-build-an-array-with-multiple-delimiters-of-varying-sizes/39900248#39900248", "title": "VBA - How to build an array with multiple delimiters of varying sizes?", "body": "<p><strong>The following is a built-upon version of the code that Thomas Inzina graciously provided.</strong></p>\n\n<p><em>The following limitations have been removed:</em></p>\n\n<ul>\n<li>The order that the delimiters are listed in the function.</li>\n<li>The temporary delimiter being a set specific character.</li>\n<li>The option to include or remove empty array items.</li>\n<li>The function changing the reference (ByRef vs ByVal)</li>\n<li>Passing an array of delimiters vs listing individual delimiters</li>\n</ul>\n\n<blockquote>\n<pre><code>Function MultiSplitX(ByVal SourceText As String, RemoveBlankItems As Boolean, ParamArray Delimiters()) As String()\n    Dim a As Integer, b As Integer, n As Integer\n    Dim i As Integer: i = 251\n    Dim u As Variant, v As Variant\n    Dim tempArr() As String, finalArr() As String, fDelimiters() As String\n\n    If InStr(TypeName(Delimiters(0)), \"()\") &lt;&gt; 0 And LBound(Delimiters) = UBound(Delimiters) Then\n        ReDim fDelimiters(LBound(Delimiters(0)) To UBound(Delimiters(0))) 'If passing array vs array items then\n        For a = LBound(Delimiters(0)) To UBound(Delimiters(0))            'build that array\n            fDelimiters(a) = Delimiters(0)(a)\n        Next a\n    Else\n        fDelimiters = Delimiters(0)\n    End If\n\n    Do While InStr(SourceText, Chr(i)) &lt;&gt; 0 And i &lt; 251 'Find an unused character\n        i = i + 1\n    Loop\n    If i = 251 Then 'If no unused character in SourceText, use single character delimiter from supplied\n        For a = LBound(fDelimiters) To UBound(fDelimiters)\n            If Len(fDelimiters(a)) = 1 Then i = Asc(fDelimiters(a))\n        Next a\n    End If\n    If i = 251 Then 'If no single character delimiters can be used, error.\n        MsgBox \"SourceText uses all character type.\" &amp; vbCrLf &amp; \"Cannot split SourceText into an array.\", _\n            vbCritical, \"MultiSplitX Run-Time Error\"\n        Exit Function\n    End If\n    Debug.Print i\n\n\n    For a = LBound(fDelimiters) To UBound(fDelimiters) 'Sort Delimiters by length\n        For b = a + 1 To UBound(fDelimiters)\n            If Len(fDelimiters(a)) &lt; Len(fDelimiters(b)) Then\n                u = fDelimiters(b)\n                fDelimiters(b) = fDelimiters(a)\n                fDelimiters(a) = u\n            End If\n        Next b\n    Next a\n\n    For Each v In fDelimiters 'Replace Delimiters with a common character\n        SourceText = Replace(SourceText, v, Chr(i))\n    Next\n\n    tempArr() = Split(SourceText, Chr(i)) 'Remove empty array items\n    If RemoveBlankItems = True Then\n        ReDim finalArr(LBound(tempArr) To UBound(tempArr))\n        n = LBound(tempArr)\n        For i = LBound(tempArr) To UBound(tempArr)\n            If tempArr(i) &lt;&gt; \"\" Then\n                finalArr(n) = tempArr(i)\n                n = n + 1\n            End If\n        Next i\n        n = n - 1\n        ReDim Preserve finalArr(LBound(tempArr) To n)\n\n        MultiSplitX = finalArr\n    Else: MultiSplitX = tempArr\n    End If\nEnd Function\n</code></pre>\n</blockquote>\n\n<p>Use of this function doesn't change from how Thomas had it, with the exception that there's an added boolean statement.</p>\n\n<hr>\n\n<p><strong><em>Example 1</em></strong></p>\n\n<p>In this example, <code>RemoveBlankItems</code> has been set to <code>True</code>.</p>\n\n<pre><code>Sub Example1()\n    Dim myString As String, c, n\n\n    n = 0\n    myString = \"The,Quickupside-downBrownjelloFox_Jumped[Over]             ThegiantLazyjelloDog\"\n\n    For Each c In MultiSplitX(myString, True, \",\", \"-\", \"upside-down\", \"jello\", \" \", \"[\", \"]\", \"giant\", \"_\")\n        Debug.Print \"(\" &amp; n &amp; \") = \" &amp; c\n        n = n + 1\n    Next c\nEnd Sub\n</code></pre>\n\n<p>This results in the following output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/A7r7E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A7r7E.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em>Example 2</em></strong></p>\n\n<p>In this example we have <code>RemoveBlankItems</code> set to <code>False</code>.</p>\n\n<pre><code>Sub Example2()\n    Dim myString As String, c, n\n\n    n = 0\n    myString = \"The,Quickupside-downBrownjelloFox_Jumped[Over]             ThegiantLazyjelloDog\"\n\n    For Each c In MultiSplitX(myString, True, \",\", \"-\", \"upside-down\", \"jello\", \" \", \"[\", \"]\", \"giant\", \"_\")\n        Debug.Print \"(\" &amp; n &amp; \") = \" &amp; c\n        n = n + 1\n    Next c\n    Debug.Print myString\nEnd Sub\n</code></pre>\n\n<p>This results in the following output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LrzIj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LrzIj.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em>Example 3</em></strong></p>\n\n<p>In this example, instead of listing our delimiters in the function, we have them typed out in a string and insert an array in the function instead:</p>\n\n<pre><code>Sub Example3()\n    Dim myString As String, c, n\n    Dim myDelimiters As String\n\n    n = 0\n    myString = \"The,Quickupside-downBrownjelloFox_Jumped[Over]             ThegiantLazyjelloDog\"\n    myDelimiters = \",|-|upside-down|jello| |[|]|giant|_\"\n\n    For Each c In MultiSplitX(myString, True, Split(myDelimiters, \"|\"))\n        Debug.Print \"(\" &amp; n &amp; \") = \" &amp; c\n        n = n + 1\n    Next c\n    Debug.Print myString\nEnd Sub\n</code></pre>\n\n<p>This has the same result as if they had been listed individually:</p>\n\n<p><a href=\"https://i.stack.imgur.com/A7r7E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A7r7E.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h2>The Reason <code>RemoveBlankItems</code> Is Desirable</h2>\n\n<p>There are some instances in which you DON'T want to have blanks in your array. An example of this would be if you're using your array as a bank of search words that are cycling through a range on a spread sheet. Another example would be if you're manipulating strings of text based on values in the array.</p>\n\n<p>There are also times when you would want to retain the blanks in the array. As Thomas described, in the event you're using this on a CSV file, where maintaining the spaces as columns is desired. Or you're using it to break apart, for example, HTML coding and wish to retain the line format.</p>\n"}], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 39900248, "answer_count": 5, "score": 0, "last_activity_date": 1475817021, "creation_date": 1475699324, "last_edit_date": 1475703509, "question_id": 39883108, "link": "https://stackoverflow.com/questions/39883108/vba-how-to-build-an-array-with-multiple-delimiters-of-varying-sizes", "title": "VBA - How to build an array with multiple delimiters of varying sizes?", "body": "<p>How can I build an array if I have multiple delimiters, where some delimiters are single character and others are multiple characters?</p>\n\n<pre><code>Sub Example()\n    Dim exString As String\n    Dim myString() As String\n\n    exString = \"A,B C;D &gt; E\"\n\n    myString() = Split(exString, \",\" &amp; \" \" &amp; \";\" &amp; \" &gt; \")\nEnd Sub\n</code></pre>\n\n<p>The result I want in my array is:</p>\n\n<pre><code>myString(0) is A\nmyString(1) is B\nmyString(2) is C\nmyString(3) is D\nmyString(4) is E\n</code></pre>\n\n<p>But using <code>Split()</code> in this way doesn't work. I do know that I can use <code>Replace()</code> to replace every single delimiter with a common one, but I have a lot of different delimiters and variations of multiple character delimiters. Using <code>Replace()</code> isn't desirable to me. What can I do?</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1475706668, "post_id": 39883101, "comment_id": 67056219, "body": "You can add a reference to <b>Microsoft Internet Controls</b> and you&#39;ll have typed variables (<code>Dim IE As New SHDocVw.InternetExplorer</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "edited": false, "score": 0, "creation_date": 1475713046, "post_id": 39884587, "comment_id": 67057826, "body": "Ok, I believe that I placed your code in the right locations(See the modified code at <a href=\"http://pastebin.com/BcSVEejd\" rel=\"nofollow noreferrer\">pastebin.com/BcSVEejd</a>) and I can see it doing the looping function, but would it be possible for the loop to open a new IE window and then pull the info from row 3 and so forth? Thanks"}, {"owner": {"reputation": 368, "user_id": 6868389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gkskf.png?s=128&g=1", "display_name": "lllpratll", "link": "https://stackoverflow.com/users/6868389/lllpratll"}, "reply_to_user": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "edited": false, "score": 0, "creation_date": 1475798554, "post_id": 39884587, "comment_id": 67100164, "body": "I&#39;m not sure what you mean here. You want to open a new IE window to enter each line? Isn&#39;t your initial solution of just clicking next and entering a line and clicking next etc. a better way to do this?"}, {"owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "edited": false, "score": 0, "creation_date": 1475799078, "post_id": 39884587, "comment_id": 67100251, "body": "If possible, I would like to check multiple rows one after the other. So I would enter all the info into excel, run VBA code, and have Internet Explorer open and enter what is in row 2 on the web site and click next. After that, have it open another Internet Explorer window and enter row 3 and so on."}, {"owner": {"reputation": 368, "user_id": 6868389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gkskf.png?s=128&g=1", "display_name": "lllpratll", "link": "https://stackoverflow.com/users/6868389/lllpratll"}, "reply_to_user": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "edited": false, "score": 0, "creation_date": 1475801441, "post_id": 39884587, "comment_id": 67100741, "body": "ok makes sense, you just need to move the start of your loop further up the code so it encases the creation of the IE object and the navigation, you should also close the IE window before opening a new one:  move the chunk:      Dim i as integer     i = 2     do while (ThisWorkbook.Sheets(&quot;sheet1&quot;).cells(i, 1).value &lt;&gt; &quot;&quot;)  right up to the top right after:  Sub FillInternetForm()  Add the following lines after the line &quot;Next&quot; right at the bottom but still enclosed by the loop  IE.Quit Set IE = Nothing"}], "tags": [], "owner": {"reputation": 368, "user_id": 6868389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gkskf.png?s=128&g=1", "display_name": "lllpratll", "link": "https://stackoverflow.com/users/6868389/lllpratll"}, "is_accepted": false, "score": 1, "last_activity_date": 1475705937, "creation_date": 1475705937, "answer_id": 39884587, "question_id": 39883101, "link": "https://stackoverflow.com/questions/39883101/excel-vba-to-enter-data-online-with-ie-and-loop-through-rows/39884587#39884587", "title": "Excel VBA to Enter Data Online With IE and Loop Through Rows", "body": "<p>You just need to wrap your code in a loop..</p>\n\n<pre><code>Dim i as integer\ni = 2\ndo while (ThisWorkbook.Sheets(\"sheet1\").cells(i, 1).value &lt;&gt; \"\")\n  'your code from Application.wait line to end of next button click\n  i = i + 1\nloop\n</code></pre>\n\n<p>This assumes an empty row can be identified by column A being empty. You could change the condition on the while loop if this assumption is bad</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "edited": false, "score": 0, "creation_date": 1475843883, "post_id": 39907798, "comment_id": 67118857, "body": "Ok, the loop is working good, but I want the IE window to stay open after next is clicked so I won&#39;t be using IE.Quit line.The issue I see now, is that it will not enter the info on row 3. This could because of the coding of the <code>IE.Document.All</code> which specifies the range."}], "tags": [], "owner": {"reputation": 368, "user_id": 6868389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gkskf.png?s=128&g=1", "display_name": "lllpratll", "link": "https://stackoverflow.com/users/6868389/lllpratll"}, "is_accepted": false, "score": 0, "last_activity_date": 1475801751, "creation_date": 1475801751, "answer_id": 39907798, "question_id": 39883101, "link": "https://stackoverflow.com/questions/39883101/excel-vba-to-enter-data-online-with-ie-and-loop-through-rows/39907798#39907798", "title": "Excel VBA to Enter Data Online With IE and Loop Through Rows", "body": "<p>sorry had to right a new answer because the formatting was going weird</p>\n\n<p>ok makes sense, you just need to move the start of your loop further up the code so it encases the creation of the IE object and the navigation, you should also close the IE window before opening a new one:</p>\n\n<p>move the chunk:</p>\n\n<pre><code>Dim i as integer\ni = 2\ndo while (ThisWorkbook.Sheets(\"sheet1\").cells(i, 1).value &lt;&gt; \"\")\n</code></pre>\n\n<p>right up to the top right after:</p>\n\n<p>Sub FillInternetForm()</p>\n\n<p>Add the following lines after the line \"Next\" right at the bottom but still enclosed by the loop</p>\n\n<p>IE.Quit</p>\n\n<p>Set IE = Nothing</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1476146122, "creation_date": 1476146122, "answer_id": 39968767, "question_id": 39883101, "link": "https://stackoverflow.com/questions/39883101/excel-vba-to-enter-data-online-with-ie-and-loop-through-rows/39968767#39968767", "title": "Excel VBA to Enter Data Online With IE and Loop Through Rows", "body": "<p>I was able to accomplish what I wanted with the following. Thanks to those that commented.</p>\n\n<pre><code>Sub FillInternetForm()\n\nRange(\"A2\").Select\n\nDo Until IsEmpty(ActiveCell)\n\n  Dim IE As Object\n  Set IE = CreateObject(\"InternetExplorer.Application\")\n'create new instance of IE. use reference to return current open IE if\n'you want to use open IE window. Easiest way I know of is via title bar.\n  IE.Navigate \"https://mygift.giftcardmall.com/Card/Login?returnURL=Transactions\"\n'go to web page listed inside quotes\n  IE.Visible = True\n  While IE.busy\n    DoEvents  'wait until IE is done loading page.\n  Wend\n\n'pause if needed\n  Application.Wait Now + TimeValue(\"00:00:02\")\n\n  IE.Document.All(\"CardNumber\").Value = ActiveCell.Value\n\n  ActiveCell.Offset(0, 1).Select\n  IE.Document.All(\"ExpirationMonth\").Value = ActiveCell.Value\n\n  ActiveCell.Offset(0, 1).Select\n  IE.Document.All(\"ExpirationYear\").Value = ActiveCell.Value\n\n  ActiveCell.Offset(0, 1).Select\n  IE.Document.All(\"SecurityCode\").Value = ActiveCell.Value\n\n  ActiveCell.Offset(1, -3).Select\n\n'presses the next button\nSet tags = IE.Document.GetElementsByTagname(\"Input\")\nFor Each tagx In tags\n    If tagx.Value = \"Next\" Then\n        tagx.Click\n        Exit For\n    End If\nNext\n\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1966, "favorite_count": 1, "accepted_answer_id": 39968767, "answer_count": 3, "score": 0, "last_activity_date": 1476146122, "creation_date": 1475699278, "last_edit_date": 1475844490, "question_id": 39883101, "link": "https://stackoverflow.com/questions/39883101/excel-vba-to-enter-data-online-with-ie-and-loop-through-rows", "title": "Excel VBA to Enter Data Online With IE and Loop Through Rows", "body": "<p>I'm trying to use Excel VBA to pull the info from columns A2-D2 and enter it into the web site and then click the \"Next\" button. The code below is what I have so far which works fine for entering the info found on row 2 only.</p>\n\n<p>I'm hoping to achieve that IE opens a new window, enters the values in cells A2 through D2, clicks the \"Next\" button, and then loops to open another new IE window and enters the values in cells A3 through D3 until it hits an empty cell.</p>\n\n<p>Here are the current numbers that I'm using for testing, <a href=\"http://imgur.com/a/88XEF\" rel=\"nofollow\">http://imgur.com/a/88XEF</a>.</p>\n\n<p>Thanks in advance for any suggestions.</p>\n\n<pre><code>Sub FillInternetForm()\n  Dim IE As Object\n  Set IE = CreateObject(\"InternetExplorer.Application\")\n'create new instance of IE. use reference to return current open IE if\n'you want to use open IE window. Easiest way I know of is via title bar.\n  IE.Navigate \"https://mygift.giftcardmall.com/Card/Login?returnURL=Transactions\"\n'go to web page listed inside quotes\n  IE.Visible = True\n  While IE.busy\n    DoEvents  'wait until IE is done loading page.\n  Wend\n'pause if needed\n  Application.Wait Now + TimeValue(\"00:00:02\")\n\n  IE.Document.All(\"CardNumber\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"a2\")\n\n  IE.Document.All(\"ExpirationMonth\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"b2\")\n\n  IE.Document.All(\"ExpirationYear\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"c2\")\n\n  IE.Document.All(\"SecurityCode\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"d2\")\n\n'presses the next button\nSet tags = IE.Document.GetElementsByTagname(\"Input\")\nFor Each tagx In tags\n    If tagx.Value = \"Next\" Then\n        tagx.Click\n        Exit For\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 6377106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CTYzchYE5mY/AAAAAAAAAAI/AAAAAAAAACQ/SBsRgzsQAdA/photo.jpg?sz=128", "display_name": "Luciano Gon&#231;alves", "link": "https://stackoverflow.com/users/6377106/luciano-gon%c3%a7alves"}, "is_accepted": false, "score": 0, "last_activity_date": 1475725229, "last_edit_date": 1475725229, "creation_date": 1475698780, "answer_id": 39882975, "question_id": 39882683, "link": "https://stackoverflow.com/questions/39882683/vba-zoom-level-setting/39882975#39882975", "title": "VBA Zoom Level Setting", "body": "<p>You can use <code>ActiveWindow.Zoom</code>.</p>\n\n<pre><code>ActiveWindow.Zoom = 70\nActiveWindow.Zoom = 10\nActiveWindow.Zoom = 120\nActiveWindow.Zoom = 110\nActiveWindow.Zoom = 100\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6928471, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4PW6mBCfKH0/AAAAAAAAAAI/AAAAAAAAAFU/W6anXrCN4XE/photo.jpg?sz=128", "display_name": "Eric Walker", "link": "https://stackoverflow.com/users/6928471/eric-walker"}, "edited": false, "score": 0, "creation_date": 1475700268, "post_id": 39883008, "comment_id": 67053727, "body": "I have tested this and it works but I still need to have a starting zoom level of 75 or something. How can I adjust with that as the starting point?"}], "tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": false, "score": 0, "last_activity_date": 1475698903, "creation_date": 1475698903, "answer_id": 39883008, "question_id": 39882683, "link": "https://stackoverflow.com/questions/39882683/vba-zoom-level-setting/39883008#39883008", "title": "VBA Zoom Level Setting", "body": "<p>Use <code>Activewindow.zoom = activewindow.zoom -10</code> to zoom out, and <code>Activewindow.zoom = activewindow.zoom +10</code> to zoom in.</p>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 6828565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e7c6730d334c619c3562dd41a0df00?s=128&d=identicon&r=PG&f=1", "display_name": "DGulledge", "link": "https://stackoverflow.com/users/6828565/dgulledge"}, "is_accepted": false, "score": 1, "last_activity_date": 1475699168, "creation_date": 1475699168, "answer_id": 39883076, "question_id": 39882683, "link": "https://stackoverflow.com/questions/39882683/vba-zoom-level-setting/39883076#39883076", "title": "VBA Zoom Level Setting", "body": "<p>This code is untested but should give you the idea... Link your buttons to the DecreaseZoom and IncreaseZoom subroutines.</p>\n\n<pre><code>Public ZoomSetting As Integer\n\nSub DecreaseZoom  \n    If ZoomSetting = 0 Then\n        ZoomSetting = 100\n    End If\n    If ZoomSetting &gt; 10 Then\n        ZoomSetting = ZoomSetting - 10\n        SetZoom\n    End If\nEnd Sub\n\nSub IncreaseZoom\n    If ZoomSetting = 0 Then\n        ZoomSetting = 100\n    End If\n    If ZoomSetting &lt; 400 Then\n        ZoomSetting = ZoomSetting + 10\n        SetZoom\n    End If\nEnd Sub\n\nSub SetZoom()\n    Dim CurrentWS As Worksheet, TempWS As Worksheet\n    CurrentWS = ActiveWorksheet\n    For Each TempWS In Worksheets\n        TempWS.Select\n        ActiveWindow.Zoom = ZoomLevel\n    Next\n    CurrentWS.Select\nEnd Sub\n</code></pre>\n\n<p>FYI, if you select all worksheets in your workbook using the tabs you can then set the zoom and it will apply to all worksheets.</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 6377106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CTYzchYE5mY/AAAAAAAAAAI/AAAAAAAAACQ/SBsRgzsQAdA/photo.jpg?sz=128", "display_name": "Luciano Gon&#231;alves", "link": "https://stackoverflow.com/users/6377106/luciano-gon%c3%a7alves"}, "is_accepted": false, "score": 2, "last_activity_date": 1479473344, "creation_date": 1479473344, "answer_id": 40677561, "question_id": 39882683, "link": "https://stackoverflow.com/questions/39882683/vba-zoom-level-setting/40677561#40677561", "title": "VBA Zoom Level Setting", "body": "<blockquote>\n  <p>I have tested this and it works but I still need to have a starting\n  zoom level of 75 or something. How can I adjust with that as the\n  starting point? \u2013 Eric Walker Oct 5 at 20:44</p>\n</blockquote>\n\n<p>you can use</p>\n\n<pre><code>Public Sub Auto_Open()\n    ActiveWindow.zoom = 75\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6928471, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4PW6mBCfKH0/AAAAAAAAAAI/AAAAAAAAAFU/W6anXrCN4XE/photo.jpg?sz=128", "display_name": "Eric Walker", "link": "https://stackoverflow.com/users/6928471/eric-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2611, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1479473344, "creation_date": 1475697617, "last_edit_date": 1531164843, "question_id": 39882683, "link": "https://stackoverflow.com/questions/39882683/vba-zoom-level-setting", "title": "VBA Zoom Level Setting", "body": "<p>What VBA command can I use to set a standard zoom level for all excel worksheets, that also allows me to increase/decrease the zoom level by 10% by clicking?</p>\n\n<p>FYI: I am creating two buttons (zoom in and zoom out) in excel that allows user to adjust zoom settings from title page of document - will adjust entire workbook.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3055019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c1e3dad895ebce0207b5c289b6b8f9f?s=128&d=identicon&r=PG&f=1", "display_name": "user3055019", "link": "https://stackoverflow.com/users/3055019/user3055019"}, "edited": false, "score": 0, "creation_date": 1475699574, "post_id": 39883004, "comment_id": 67053373, "body": "I tried to do it the way Kyle suggested, but it results in the same Run-time error 1004. The debugger highlights the following section of the code: &quot;Sheets(&quot;Committed Costs&quot;).Range(showhide2(i, 2)).EntireRow.Hidden = False&quot;"}, {"owner": {"reputation": 17, "user_id": 3055019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c1e3dad895ebce0207b5c289b6b8f9f?s=128&d=identicon&r=PG&f=1", "display_name": "user3055019", "link": "https://stackoverflow.com/users/3055019/user3055019"}, "edited": false, "score": 0, "creation_date": 1475699973, "post_id": 39883004, "comment_id": 67053581, "body": "Yes, I noticed that too, I&#39;ll keep it consistent and use showhide2(i,1), but it didn&#39;t solve the problem, unfortunately."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 17, "user_id": 3055019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c1e3dad895ebce0207b5c289b6b8f9f?s=128&d=identicon&r=PG&f=1", "display_name": "user3055019", "link": "https://stackoverflow.com/users/3055019/user3055019"}, "edited": false, "score": 0, "creation_date": 1475700004, "post_id": 39883004, "comment_id": 67053597, "body": "@user3055019 - are all the range names defined in your macro workbook&#39;s Settings sheet, in cells E7:E716 defined?  (You will get that error if the cell is empty, or the range name does not exist.)  You may need an extra If statement wrapped around the existing one, i.e. <code>If showhide1(i, 2) &lt;&gt; &quot;&quot; Then</code> <code>If showhide1(i, 1) = 1 Then</code> ... <code>End If</code> <code>End If</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 17, "user_id": 3055019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c1e3dad895ebce0207b5c289b6b8f9f?s=128&d=identicon&r=PG&f=1", "display_name": "user3055019", "link": "https://stackoverflow.com/users/3055019/user3055019"}, "edited": false, "score": 0, "creation_date": 1475700492, "post_id": 39883004, "comment_id": 67053838, "body": "@user3055019 - Oops - change <code>showhide1</code> to <code>showhide2</code> in my suggested change - I copy/pasted my suggestion from the &quot;inconsistent&quot; version of the code."}, {"owner": {"reputation": 17, "user_id": 3055019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c1e3dad895ebce0207b5c289b6b8f9f?s=128&d=identicon&r=PG&f=1", "display_name": "user3055019", "link": "https://stackoverflow.com/users/3055019/user3055019"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1475701416, "post_id": 39883004, "comment_id": 67054247, "body": "@YowE3K This is beautiful, thank you very much, your solution worked! I did have a few cc_xxxx codes that were not defined on the Committed Costs worksheet. I limited the showhide1 range to include only the ranges with defined names and it worked beautifully! Now I have to define names for the other 500+ sections."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1475700489, "last_edit_date": 1475700489, "creation_date": 1475698896, "answer_id": 39883004, "question_id": 39882567, "link": "https://stackoverflow.com/questions/39882567/hide-certain-named-ranges-in-another-worksheet-based-on-condition/39883004#39883004", "title": "Hide certain named ranges in another worksheet based on condition", "body": "<p>This is a simple fix, it is around how you reference your array items. Also, there is no need to loop through your column indexes as they are never used. Change your code to the below. why you pass the array values as <code>\"showhide2(i,2)\"</code> it is looking for a sheet titled \"showhide2(i,2)\", as opposed to the value stored in <code>showhide2(i,2)</code>. </p>\n\n<pre><code>Dim showhide1 As Range\nSet showhide1 = ThisWorkbook.Worksheets(\"Settings\").Range(\"d7:g716\")\nDim showhide2 As Variant\nshowhide2 = showhide1.Value\nDim i As Integer, j As Integer\n\nFor i = LBound(showhide2, 1) To UBound(showhide2, 1)\n     If showhide2(i, 1) = 1 Then\n         Sheets(\"Committed Costs\").Range(showhide2(i,2)).EntireRow.Hidden = True\n     Else\n         Sheets(\"Committed Costs\").Range(showhide2(i,2)).EntireRow.Hidden = False\n     End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3055019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c1e3dad895ebce0207b5c289b6b8f9f?s=128&d=identicon&r=PG&f=1", "display_name": "user3055019", "link": "https://stackoverflow.com/users/3055019/user3055019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 39883004, "answer_count": 1, "score": 1, "last_activity_date": 1568993159, "creation_date": 1475697171, "last_edit_date": 1568993159, "question_id": 39882567, "link": "https://stackoverflow.com/questions/39882567/hide-certain-named-ranges-in-another-worksheet-based-on-condition", "title": "Hide certain named ranges in another worksheet based on condition", "body": "<p>I am working on a code to hide named ranges in another worksheet based on a condition.</p>\n\n<p>I have a worksheet called \"Committed Costs\":<br>\n<img src=\"https://i.stack.imgur.com/RDEw1.png\" alt=\"enter image description here\">]<a href=\"https://i.stack.imgur.com/RDEw1.png\" rel=\"nofollow noreferrer\">1</a></p>\n\n<p>There will be many more lines at the bottom (I have a little over 7000 right now). Range A3:E14 is named cc_0101, range A14:E26 is named cc_0195. And there are many more below. </p>\n\n<p>I have a \"Settings\" worksheet:<br>\n<a href=\"https://i.stack.imgur.com/Rw6rf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rw6rf.png\" alt=\"enter image description here\"></a></p>\n\n<p>Column C is a drop-down with two options: \"Show\" and \"Hide\". The formula in column D shows 1 if \"Hide\" is selected and 0 if \"Show\" is selected. Now I want the macro to go through the list of accounts on the \"Settings\" worksheet and if D8=1, then the whole cc_0101 named range from \"Committed Costs\" worksheet should be hidden, if D9=0, then cc_0195 should not be hidden and so forth. So basically, the macro now has to grab the value from column E for each row.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>Dim showhide1 As Range\nSet showhide1 = ThisWorkbook.Worksheets(\"Settings\").Range(\"d7:g716\")\nDim showhide2 As Variant\nshowhide2 = showhide1.Value\nDim i As Integer, j As Integer\n\nFor i = LBound(showhide2, 1) To UBound(showhide2, 1)\n  For j = LBound(showhide2, 2) To UBound(showhide2, 2)\n    If showhide1(i, 1) = 1 Then\n      Sheets(\"Committed Costs\").Range(\"showhide2(i,2)\").EntireRow.Hidden = True\n    Else\n      Sheets(\"Committed Costs\").Range(\"showhide2(i,2)\").EntireRow.Hidden = False\n    End If\n  Next j\nNext i\n</code></pre>\n\n<p>The code produces</p>\n\n<blockquote>\n  <p>Run-time error 1004.</p>\n</blockquote>\n\n<p>Before I started reading about arrays and everything the code looked as follows:</p>\n\n<pre><code>Dim drng As Range, d as Range\nDim erng As Range, e as Range\n\nSet drng = Range(\"D7:D716\")\nSet erng = Range(\"E7:E716\")\n\nFor Each d In drng\n  If d = 1 Then\n    Sheets(\"Committed Costs\").Range(\"e\").EntireRow.Hidden = True\n  Else\n    Sheets(\"Committed Costs\").Range(\"e\").EntireRow.Hidden = False\n  End If\nNext d\n</code></pre>\n\n<p>Then I realized that I am not defining \"e\" in any way, so the macro won't know to grab the value from column E (I am guessing). The only way I got the condition to work was:</p>\n\n<pre><code>Dim d as Range\nSet d = Range(\"D8\")\n\nIf d = 1 Then\n  Sheets(\"Committed Costs\").Range(\"cc_0101\").EntireRow.Hidden = True\nElse\n  Sheets(\"Committed Costs\").Range(\"cc_0101\").EntireRow.Hidden = False\nEnd If\n</code></pre>\n\n<p>but that doesn't serve the purpose. I have to hard-code the name of the range, which is cc_0101 in the example and the code only compares one line (row 8), instead of going through the whole list of accounts.</p>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 223, "user_id": 2849961, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/198ba405a859218b97e7c4047a15f232?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/2849961/eric"}, "edited": false, "score": 0, "creation_date": 1475698508, "post_id": 39882781, "comment_id": 67052809, "body": "this would make me connect directly to the MS Sql Server database.  I want to use a linked table"}], "tags": [], "owner": {"reputation": 352, "user_id": 6464618, "user_type": "registered", "profile_image": "https://graph.facebook.com/1137504556323282/picture?type=large", "display_name": "Rafael Mori", "link": "https://stackoverflow.com/users/6464618/rafael-mori"}, "is_accepted": false, "score": 0, "last_activity_date": 1475697959, "creation_date": 1475697959, "answer_id": 39882781, "question_id": 39882552, "link": "https://stackoverflow.com/questions/39882552/unable-to-open-linked-access-2003-table-to-ms-sql-server-in-vba-code/39882781#39882781", "title": "Unable to open Linked Access 2003 table to MS SQL Server in VBA code", "body": "<p>You need to connect to your DB using ADO. Is simple and easy. Just change to your info and enjoy it.</p>\n\n<pre><code>Dim cn As ADODB.Connection\nDim rs As ADODB.Recordset\n\nServerName = \"yourServer,yourPort(example: 1442)\" 'Enter your server name and a port here\nDatabaseName = \"yourDBinTheServer\" 'Enter your  database name here\nUserID = \"yourUserID\" 'Enter your user ID here\nPassword = \"yourPassword\" 'Enter your password here\n\nSet rs = New ADODB.Recordset\nSet cn = New ADODB.Connection\n\ncn.Open \"Driver={SQL Server};Server=\" &amp; ServerName &amp; \";Database=\" &amp; DatabaseName &amp; \";Uid=\" &amp; UserID &amp; \";Pwd=\" &amp; Password &amp; \";\"\nrs.open yourQueryAsString, cn\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1475699417, "post_id": 39882987, "comment_id": 67053288, "body": "Welcome to Stack Overflow! While this might be a valuable hint to solve the problem, an answer really needs to demonstrate the solution.  Please <a href=\"https://stackoverflow.com/posts/39882987/edit\">edit</a> to provide example code to show what you mean. Alternatively, consider writing this as a comment instead."}], "tags": [], "owner": {"reputation": 1, "user_id": 6928244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKDsy.jpg?s=128&g=1", "display_name": "djeos", "link": "https://stackoverflow.com/users/6928244/djeos"}, "is_accepted": false, "score": 0, "last_activity_date": 1475698807, "creation_date": 1475698807, "answer_id": 39882987, "question_id": 39882552, "link": "https://stackoverflow.com/questions/39882552/unable-to-open-linked-access-2003-table-to-ms-sql-server-in-vba-code/39882987#39882987", "title": "Unable to open Linked Access 2003 table to MS SQL Server in VBA code", "body": "<p>Make sure you store the user credentials used to connect to the database...\n(attribute dbAttachSavePWD)</p>\n"}, {"comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1475700437, "post_id": 39883290, "comment_id": 67053809, "body": "You beat me to it, although I was going to suggest <code>... , dbOpenDynaset, dbSeeChanges)</code>."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1475700629, "post_id": 39883290, "comment_id": 67053899, "body": "Indeed, if linked MSSQL tables have an identity column, <code>dbSeeChanges</code> may need to be specified depending on recordset operations."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1475700102, "creation_date": 1475700102, "answer_id": 39883290, "question_id": 39882552, "link": "https://stackoverflow.com/questions/39882552/unable-to-open-linked-access-2003-table-to-ms-sql-server-in-vba-code/39883290#39883290", "title": "Unable to open Linked Access 2003 table to MS SQL Server in VBA code", "body": "<p>Consider using <code>dbOpenDynaset</code> option which is used by default for linked tables or stored queries whereas <code>dbOpenTable</code> is used for local tables as mentioned for <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820966.aspx\" rel=\"nofollow\">OpenRecordset()</a> method:</p>\n\n<blockquote>\n  <p>If you open a Recordset in a Microsoft Access workspace and you don't\n  specify a type, OpenRecordset creates a table-type Recordset, if\n  possible. If you specify a linked table or query, OpenRecordset\n  creates a dynaset-type Recordset.</p>\n</blockquote>\n\n<pre><code>Set rs = CurrentDb.OpenRecordset(\"dbo_tbl_EventLogs\", dbOpenDynaset)\n</code></pre>\n"}], "owner": {"reputation": 223, "user_id": 2849961, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/198ba405a859218b97e7c4047a15f232?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/2849961/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 39883290, "answer_count": 3, "score": 0, "last_activity_date": 1475700102, "creation_date": 1475697128, "question_id": 39882552, "link": "https://stackoverflow.com/questions/39882552/unable-to-open-linked-access-2003-table-to-ms-sql-server-in-vba-code", "title": "Unable to open Linked Access 2003 table to MS SQL Server in VBA code", "body": "<p>I have a table in Access 2003 that is linked to a MS SQL server table.\nI am able to go into the Access table, manually update it and see the changes\nreflected in the MS Sql server table. </p>\n\n<p>However, I'm unable to even just open the table and put the result in the  record set in my VBA code.  </p>\n\n<pre><code>Set rs = CurrentDb.OpenRecordset(\"dbo_tbl_EventLogs\", dbOpenTable)\n</code></pre>\n\n<p>(rs is always at nothing)</p>\n\n<p>The same line of code works on a 'local' Access table. </p>\n"}, {"tags": ["windows", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475708862, "post_id": 39882703, "comment_id": 67056842, "body": "Can you update your answer to include the relevant information from your links? That way it will still be helpful to others if your links die."}], "tags": [], "owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "is_accepted": false, "score": 1, "last_activity_date": 1475697694, "creation_date": 1475697694, "answer_id": 39882703, "question_id": 39882298, "link": "https://stackoverflow.com/questions/39882298/windows-7-right-click-on-file-and-run-custom-excel-vba-script/39882703#39882703", "title": "Windows 7: Right click on file and run custom Excel VBA script", "body": "<p>This is possible, but if you're on a company computer, I doubt that you'll be able to do some of the required steps. </p>\n\n<p>1) write a VBScript for your macro according to the following guide:</p>\n\n<p><a href=\"http://wellsr.com/vba/2015/excel/run-macro-without-opening-excel-using-vbscript/\" rel=\"nofollow\">http://wellsr.com/vba/2015/excel/run-macro-without-opening-excel-using-vbscript/</a></p>\n\n<p>2) Launch the VBS you wrote in Step 1 from the right click menu, according to the following guide:</p>\n\n<p><a href=\"http://www.visualbasicscript.com/Launch-vbs-from-the-rightclick-menu-advanced-m32062.aspx\" rel=\"nofollow\">http://www.visualbasicscript.com/Launch-vbs-from-the-rightclick-menu-advanced-m32062.aspx</a></p>\n\n<p>Best of luck!</p>\n"}], "owner": {"reputation": 577, "user_id": 1125663, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/af96000115315214022f55112b9dc4d9?s=128&d=identicon&r=PG", "display_name": "Saladsamurai", "link": "https://stackoverflow.com/users/1125663/saladsamurai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475697694, "creation_date": 1475696307, "question_id": 39882298, "link": "https://stackoverflow.com/questions/39882298/windows-7-right-click-on-file-and-run-custom-excel-vba-script", "title": "Windows 7: Right click on file and run custom Excel VBA script", "body": "<p>I wrote a macro in Excel VBA that can scrape files with an .f06 extension for certain data and then creates a spreadsheet that summarizes the data.</p>\n\n<p>It is inconvenient to have to find the Excel workbook, open it, run the macro, &amp; select the .f06 file to generate this summary.</p>\n\n<p>I prefer to right-click on the .f06 file directly and have an option called 'scrape' that I could select and then it would run the code automatically.</p>\n\n<p>1) Is this possible?  </p>\n\n<p>2) Can I use the existing macro-enabled Excel spreadsheet as the referenced code?  Or do I need to re-write it in another language?</p>\n\n<p>I am using Windows 7 Enterprise SP1 if relevant.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1475696466, "post_id": 39882196, "comment_id": 67051699, "body": "Column <b>X</b> or column <b>Z</b> ??"}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1475696772, "post_id": 39882196, "comment_id": 67051899, "body": "Well, I need to select column X in the range, but I need it to check A:Z in determining whether or not it is blank."}], "answers": [{"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 2, "last_activity_date": 1475696685, "creation_date": 1475696685, "answer_id": 39882409, "question_id": 39882196, "link": "https://stackoverflow.com/questions/39882196/excel-vba-selecting-range-to-last-completely-blank-row/39882409#39882409", "title": "Excel VBA - selecting range to last completely blank row", "body": "<p>simply set <code>Lastrow</code> to</p>\n\n<pre><code>Lastrow = Range(\"A:Z\").Find(\"*\", , , , xlByRows, xlPrevious).Row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 0, "last_activity_date": 1475696823, "creation_date": 1475696823, "answer_id": 39882450, "question_id": 39882196, "link": "https://stackoverflow.com/questions/39882196/excel-vba-selecting-range-to-last-completely-blank-row/39882450#39882450", "title": "Excel VBA - selecting range to last completely blank row", "body": "<p>I'm all but certain there is a better way, but one such way is to loop through you columns and find the last row of each and then determine which one of those is the greatest.</p>\n\n<pre><code>maxRow = 0\nfor i=1 to 24 'A through X\n    if maxRow &lt; ActiveSheet.Cells(Rows.Count, i).End(xlUp).Row then\n        maxRow = ActiveSheet.Cells(Rows.Count, i).End(xlUp).Row\n    end if\nnext i\n</code></pre>\n\n<p>Then <code>maxRow</code> is what you want <code>lastrow</code> to be.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 6879800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa0bc6e389b1f212ec4269b370fb3c1?s=128&d=identicon&r=PG&f=1", "display_name": "arc", "link": "https://stackoverflow.com/users/6879800/arc"}, "is_accepted": false, "score": 0, "last_activity_date": 1475696926, "creation_date": 1475696926, "answer_id": 39882482, "question_id": 39882196, "link": "https://stackoverflow.com/questions/39882196/excel-vba-selecting-range-to-last-completely-blank-row/39882482#39882482", "title": "Excel VBA - selecting range to last completely blank row", "body": "<p>You could iterate through all of the columns and compare the last row of each column. You could then change the lastRow variable whenever you find a column with more rows like so:</p>\n\n<pre><code>Dim i As Integer\nDim lastRow As Integer\nlastRow = 1\nFor i = 1 To 26\n    Dim lst As Integer\n    lst = Cells(Rows.Count, i).End(xlUp).Row\n    If lst &gt; lastRow Then\n        lastRow = lst\n    End If\nNext\nRange(\"A84:X\" &amp; lastRow).Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "is_accepted": false, "score": 0, "last_activity_date": 1475697964, "creation_date": 1475697964, "answer_id": 39882783, "question_id": 39882196, "link": "https://stackoverflow.com/questions/39882196/excel-vba-selecting-range-to-last-completely-blank-row/39882783#39882783", "title": "Excel VBA - selecting range to last completely blank row", "body": "<p>You can make use of the usedrange function, which returns the complete range of used cells on your sheet:, as follows:</p>\n\n<p>Worksheets(\"worksheetName\").UsedRange.lastRow </p>\n\n<p>This would give you the last <em>used</em> row, not just the last row with data in the first column</p>\n"}], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3025, "favorite_count": 0, "accepted_answer_id": 39882409, "answer_count": 4, "score": 0, "last_activity_date": 1475697964, "creation_date": 1475695866, "question_id": 39882196, "link": "https://stackoverflow.com/questions/39882196/excel-vba-selecting-range-to-last-completely-blank-row", "title": "Excel VBA - selecting range to last completely blank row", "body": "<p>I have some VBA code that needs to select a range from A84 to X. I'm using this code to select that range to the last row in the data.</p>\n\n<pre><code>Dim Lastrow As Integer\nLastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\nRange(\"A84:X\" &amp; Lastrow).Select\n</code></pre>\n\n<p>This stops at the first row with a blank cell in the A column. I need it to check columns A through Z, not just A. For example, if there is a value in column A on rows 84 to 94, but for row 95, there's only data in column F or R, it won't include row 95. How can this look at columns A:Z to determine whether or not the row is blank?</p>\n"}, {"tags": ["excel", "criteria", "copy-paste", "multiple-conditions", "vba"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 6210257, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/127dfd2da781e41d18ce1c6016394ef4?s=128&d=identicon&r=PG&f=1", "display_name": "D Hellenborg", "link": "https://stackoverflow.com/users/6210257/d-hellenborg"}, "edited": false, "score": 0, "creation_date": 1475792267, "post_id": 39888516, "comment_id": 67098305, "body": "Still get the same error tho, might it be something else that makes it give me that error? And thanks for the notify with the wrong row in Example 1. When in debug mode and i run the code i can hold the mouse over c.value = empty for some reason if that is helping.."}], "tags": [], "owner": {"reputation": 61, "user_id": 6924140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512d5f6915e65b21c262609e5157ff47?s=128&d=identicon&r=PG&f=1", "display_name": "AjCorneel", "link": "https://stackoverflow.com/users/6924140/ajcorneel"}, "is_accepted": false, "score": 0, "last_activity_date": 1475733357, "creation_date": 1475733357, "answer_id": 39888516, "question_id": 39882166, "link": "https://stackoverflow.com/questions/39882166/copy-from-one-sheet-to-another-workbook-based-on-multiple-criteria-vba-excel/39888516#39888516", "title": "Copy from one sheet to another workbook based on multiple criteria VBA Excel", "body": "<p>It seems like Excel is looking for the worksheet in the wrong file. You need to activate the right workbook before inserting the values. Like this:</p>\n\n<pre><code>Sub NPS()\nDim sh1 As Worksheet, sh2 As Worksheet, c As Range, wb2 As Workbook, fn As Range\nSet sh1 = ThisWorkbook.ActiveSheet\nSet wb2 = Workbooks.Open(\"F:\\Excel\\Chef\\NPS Samtal 777 agentniv\u00e5.xlsx\")\n    For Each c In sh1.Range(\"C8\", sh1.Cells(Rows.Count, 3).End(xlUp))\n         wb2.Activate       \n         Set sh2 = wb2.Sheets(c.Value)\n         Set fn = sh2.Rows(24).Find(sh1.Range(\"B5\").Value, , xlValues, xlWhole)\n         If Not fn Is Nothing Then\n                fn.Offset(1) = sh1.Range(\"E5\").Value\n         End If\n     Next\nEnd Sub\n</code></pre>\n\n<p>On a side note: the worksheets in your ppsTest file are not aligned (the NPS -tal is in a different row in Example 1).</p>\n"}], "owner": {"reputation": 99, "user_id": 6210257, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/127dfd2da781e41d18ce1c6016394ef4?s=128&d=identicon&r=PG&f=1", "display_name": "D Hellenborg", "link": "https://stackoverflow.com/users/6210257/d-hellenborg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2459, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475733357, "creation_date": 1475695764, "last_edit_date": 1531161705, "question_id": 39882166, "link": "https://stackoverflow.com/questions/39882166/copy-from-one-sheet-to-another-workbook-based-on-multiple-criteria-vba-excel", "title": "Copy from one sheet to another workbook based on multiple criteria VBA Excel", "body": "<p>I have two diffrent workbooks, From one of them i want to copy certain value based on multiple criteria. </p>\n\n<p>In this example i will call each workbook wb1 and wb2. There will be shared wb links in the end of the post as example to make it more clear how it looks..</p>\n\n<p>So in wb1 i have a list of names that also have their own sheet in wb2.\nWhen i open wb1 i want to copy the value under cell called \"NPS\" to each sheet in wb2 with the same name, In wb2 i have different month  and a few other varibles that i have to add manual. So what i want it to do is copy value from NPS to the data under NPS and match it with the same Month that is also mentioned in wb1.</p>\n\n<p>What i have so far is this code, but it doesnt realy make it.. Since i get an \"subsribtion out of range\"  on this part Set sh2 = wb2.Sheets(c.Value). what im guessing is that it cant identify the sheets by the value even tho its named exaclty the same.</p>\n\n<pre><code>Sub NPS()\nDim sh1 As Worksheet, sh2 As Worksheet, c As Range, wb2 As Workbook, fn As Range\nSet sh1 = ThisWorkbook.ActiveSheet\nSet wb2 = Workbooks.Open(\"F:\\Excel\\Chef\\NPS Samtal 777 agentniv\u00e5.xlsx\")\n    For Each c In sh1.Range(\"C8\", sh1.Cells(Rows.Count, 3).End(xlUp))\n        Set sh2 = wb2.Sheets(c.Value)\n        Set fn = sh2.Rows(24).Find(sh1.Range(\"B5\").Value, , xlValues, xlWhole)\n        If Not fn Is Nothing Then\n               fn.Offset(1) = sh1.Range(\"E5\").Value\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>WB1: <a href=\"https://docs.google.com/spreadsheets/d/14CyC2CQWWH-Bxifw2EBni0Uj2YjlN-kIUVki2rle3LA/edit#gid=1398323909\" rel=\"nofollow\">https://docs.google.com/spreadsheets/d/14CyC2CQWWH-Bxifw2EBni0Uj2YjlN-kIUVki2rle3LA/edit#gid=1398323909</a></p>\n\n<p>WB2: <a href=\"https://docs.google.com/spreadsheets/d/1vcfnluE_PSm5dEEeHuBPA9XRoP-VPQRk3YDE7ONS-NE/edit?usp=sharing\" rel=\"nofollow\">https://docs.google.com/spreadsheets/d/1vcfnluE_PSm5dEEeHuBPA9XRoP-VPQRk3YDE7ONS-NE/edit?usp=sharing</a></p>\n\n<p>IF anyone have any suggestions i would be very pleased.</p>\n\n<p>//regards Daniel</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1475701745, "post_id": 39882081, "comment_id": 67054383, "body": "`&quot; Operator:=&quot; is missing the dot qualifier."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1475711675, "post_id": 39882081, "comment_id": 67057527, "body": "So <code>ActiveDynamicRange</code> is a fixed String <code>$C$3:$C$3</code>? Why not just use a Named Range to replace <code>Inventory_October_2016!$C$3:$C$3</code> (which is not dynamic at all) and use that name? e.g. <code>, Formula1:=&quot;=NewNamedRange&quot;</code>."}, {"owner": {"reputation": 1, "user_id": 5452142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FrR67Zo--KM/AAAAAAAAAAI/AAAAAAAAAAA/nfWVs8GQdEA/photo.jpg?sz=128", "display_name": "Fred Michel", "link": "https://stackoverflow.com/users/5452142/fred-michel"}, "edited": false, "score": 0, "creation_date": 1476198082, "post_id": 39882081, "comment_id": 67239373, "body": "Hi, thanks for the Reply. The exemple of Inventory_October_2016!$C$3:$C$3 is only for my current situation  but it&#39;s not always the case. If another Item is added to the list, it will be Inventory_October_2016!$C$3:$C$4, Inventory_October_2016!$C$3:$C$5 and so on."}, {"owner": {"reputation": 1, "user_id": 5452142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FrR67Zo--KM/AAAAAAAAAAI/AAAAAAAAAAA/nfWVs8GQdEA/photo.jpg?sz=128", "display_name": "Fred Michel", "link": "https://stackoverflow.com/users/5452142/fred-michel"}, "edited": false, "score": 0, "creation_date": 1476198370, "post_id": 39882081, "comment_id": 67239582, "body": "@PatriK The range is created base on the number of non empty cells   <code>items = Application.WorksheetFunction.CountA(Sheets(CurSheetName).Ra&zwnj;&#8203;nge(&quot;ITEM_NO&quot;))</code>  <code>If items &gt; 1 Then               FirstCell = Sheets(CurSheetName).Range(&quot;ITEM_NO&quot;).Cells(1, 1).Address               LastCell = Sheets(CurSheetName).Range(&quot;ITEM_NO&quot;).Cells(items, 1).Address               ActiveDynamicRange = FirstCell &amp; &quot;:&quot; &amp; LastCell            Else               FirstCell = Sheets(CurSheetName).Range(&quot;ITEM_NO&quot;).Cells(1, 1).Address               ActiveDynamicRange = FirstCell &amp; &quot;:&quot; &amp; FirstCell            End If</code>"}], "owner": {"reputation": 1, "user_id": 5452142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FrR67Zo--KM/AAAAAAAAAAI/AAAAAAAAAAA/nfWVs8GQdEA/photo.jpg?sz=128", "display_name": "Fred Michel", "link": "https://stackoverflow.com/users/5452142/fred-michel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475695366, "creation_date": 1475695366, "question_id": 39882081, "link": "https://stackoverflow.com/questions/39882081/excel-dynamic-list-with-vba", "title": "Excel Dynamic List with VBA", "body": "<p>I am working on an excel inventory Worksheet with a Dynamic Data Validation for my Dropdown list. I don't know why exactly, but the minute I add an extra Row in the sheet where the validation occurs, I have the following error:</p>\n\n<pre><code>Run-time error '1004':\nApplication-defined or object-defined error \n</code></pre>\n\n<p>My code is fired BeforeDoubleClick</p>\n\n<pre><code>Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n</code></pre>\n\n<p>This is the piece of code which keeps on giving me an error at the Formula1: section. I am not sure why, but it only happens the minute I add an extra line in the actite worksheet where the action is triggered. </p>\n\n<pre><code>If Not Intersect(Target, Range(\"List_Items\")) Is Nothing Then\n                    Var = CurSheetName &amp; \"!\" &amp; ActiveDynamicRange\n                    With Selection.Validation\n                        .Delete\n                        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n                         Operator:=xlBetween, Formula1:=\"=\" &amp; Var\n                        .IgnoreBlank = True\n                        .InCellDropdown = True\n                        .InputTitle = \"\"\n                        .ErrorTitle = \"\"\n                        .InputMessage = \"\"\n                        .ErrorMessage = \"\"\n                        .ShowInput = True\n                        .ShowError = True\n                    End With\n                End If\n</code></pre>\n\n<p>The Var variable is set up as follow: </p>\n\n<pre><code>Var = CurSheetName &amp; \"!\" &amp; ActiveDynamicRange\n</code></pre>\n\n<p>which corresponds to: Inventory_October_2016!$C$3:$C$3</p>\n\n<p>If I remove the line, it works fine. But the minute I add a new line, it starts bugging. Does anybody have an idea why please?</p>\n\n<p>Thanky you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475695105, "post_id": 39881847, "comment_id": 67050937, "body": "Are the dates stored as strings then? Or are they formatted as dates? If they are already dates there is no need to extract info by string manipulation.  You could just use the function <code>MONTH()</code> in another column and sort on that field."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475699589, "post_id": 39881847, "comment_id": 67053379, "body": "And if they are text strings, just sort using a Custom List"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475703974, "post_id": 39881847, "comment_id": 67055338, "body": "And do you want to order months regardless of years as the &#39;15 months precede &#39;14 months? This could be problematic in data consumption/analysis."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 6757605, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9bd31793ba8237d014c7a16fad47d3c?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6757605/ct4242"}, "is_accepted": false, "score": 0, "last_activity_date": 1475704692, "creation_date": 1475704692, "answer_id": 39884362, "question_id": 39881847, "link": "https://stackoverflow.com/questions/39881847/macro-to-calendarize-data/39884362#39884362", "title": "Macro to Calendarize Data", "body": "<p>I ended up just creating a loop that looks for \"Jan\" and gets all the data from there. </p>\n\n<pre><code>'Loop to dynamically calendarize data\n''Loop returns 2 arrays, length 12, index 0-11, \"electic\" and \"heating\" in Jan to Dec format\ncomplete = False\nFor i = 9 To 20\n    If Left(target.Sheets(\"Sheet1\").Cells(i, 1).Value, 3) = \"Jan\" Then\n        For j = 0 To (20 - i)\n            carryOver = i + j\n            electric(j) = target.Sheets(\"Sheet1\").Cells(carryOver, 2).Value\n            heating(j) = target.Sheets(\"Sheet1\").Cells(carryOver, 5).Value\n        Next j\n        complete = True\n    ElseIf complete = True Then\n        For k = j To 11\n            electric(k) = target.Sheets(\"Sheet1\").Cells(9 + (k - j), 2).Value\n            heating(k) = target.Sheets(\"Sheet1\").Cells(9 + (k - j), 5).Value\n        Next k\n        GoTo end_of_for\n    End If\nNext i\nend_of_for:\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6757605, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9bd31793ba8237d014c7a16fad47d3c?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6757605/ct4242"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1475704692, "creation_date": 1475694443, "last_edit_date": 1475695240, "question_id": 39881847, "link": "https://stackoverflow.com/questions/39881847/macro-to-calendarize-data", "title": "Macro to Calendarize Data", "body": "<p><strong>Problem:</strong></p>\n\n<p>I am writing a macro to do some data input for me. These data reports all have the same format (date in column 1, value in column 2), except the order of the months of data change from client to client. Currently I have written the macro to grab the data from another sheet and bring it into the current sheet. But now I need to write something to take the data and get it into the correct format.</p>\n\n<p>Example: This client is organized from Apr-Mar (again, it could be any 12 month combination) and I need to get it into Jan-Dec, regardless of year. </p>\n\n<p>Before:</p>\n\n<pre><code>Apr-14  37,645\n\nMay-14  47,000\n\nJun-14  11,600\n\nJul-14  33,503\n\nAug-14  38,550\n\nSep-14  36,063\n\nOct-14  39,246\n\nNov-14  30,315\n\nDec-14  28,403\n\nJan-15  25,799\n\nFeb-15  24,302\n\nMar-15  27,873\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>Jan-15  25,799\n\nFeb-15  24,302\n\nMar-15  27,873\n\nApr-14  37,645\n\nMay-14  47,000\n\nJun-14  11,600\n\nJul-14  33,503\n\nAug-14  38,550\n\nSep-14  36,063\n\nOct-14  39,246\n\nNov-14  30,315\n\nDec-14  28,403 \n</code></pre>\n\n<p><strong>Attempt at a Solution:</strong></p>\n\n<p>I am hesitant to post it as it's incomplete and would be hard to follow. All it does is parse the first date cell to get the first 3 letters corresponding to a month, then check against 12 if/elseif statements. There must be a better way to write it, I just can't think of it. </p>\n\n<p>Any and all help is appreciated. I'm sure a shove in the right direction would help! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1475693176, "post_id": 39881464, "comment_id": 67049849, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/21443737/vba-excel-2010-renaming-named-ranges\" title=\"vba excel 2010 renaming named ranges\">stackoverflow.com/questions/21443737/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475695339, "post_id": 39881987, "comment_id": 67051084, "body": "This I believe will leave all the old named ranges still active. The new named ranges will exist but will just be duplicate of the old. You need to add in your loop to go around and then delete the old named ranges after you rename them. Also I would suggest that we require some more effort from the OP before we provide solutions to their questions."}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475695864, "post_id": 39881987, "comment_id": 67051361, "body": "Since we&#39;re changing the name each time, it does not duplicate the named ranges. It just renames them."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475696657, "post_id": 39881987, "comment_id": 67051823, "body": "I tested it out using Excel 2016 and I have confirmed that it does not just rename them. It creates a new named range and keeps the old named range. This is also stated in the post I linked on my comment on the original posting. I did this by creating a named range, then writing a sub that renames it. After running I can see in the <code>Name Manager</code> that there are 2 named ranges referencing the same address. You also confirm this by creating a named range, then selecting the same range and placing a different string in the <code>Name Box</code>. You will then result in 2 named ranges, not 1."}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475696762, "post_id": 39881987, "comment_id": 67051895, "body": "I tested it out using Excel 2010 and I have confirmed that it does just rename them. I don&#39;t know if this is related to the version being used."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475701293, "post_id": 39881987, "comment_id": 67054180, "body": "@nbayly tested in Excel 2010 - the <a href=\"http://stackoverflow.com/a/21444144/445425\">one of the methods</a> (<code>Range(&quot;Name&quot;).Name = </code>) used in that other post leaves the old name in place, this method (using the Name object) does not"}], "tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": true, "score": 0, "last_activity_date": 1475695015, "creation_date": 1475695015, "answer_id": 39881987, "question_id": 39881464, "link": "https://stackoverflow.com/questions/39881464/changing-named-range/39881987#39881987", "title": "Changing Named Range", "body": "<pre><code>Sub Renames()\n    Const csOld As String = \"KWH\"\n    Const csNew As String = \"THR\"\n\n    Dim strN As Name\n\n    For Each strN In ActiveWorkbook.Names\n        If InStr(1, strN.Name, csOld) &lt;&gt; 0 Then\n            strN.Name = Replace(strN.Name, csOld, csNew)\n        End If\n    Next strN\nEnd Sub\n</code></pre>\n\n<p>Use the Constants at the top to control what text is being replaced in each name, and what is being inserted in its place.</p>\n"}], "owner": {"reputation": 665, "user_id": 847211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/33c99875849a4d7e40c4555ec78ddb8a?s=128&d=identicon&r=PG", "display_name": "Michael Downey", "link": "https://stackoverflow.com/users/847211/michael-downey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 39881987, "answer_count": 1, "score": 0, "last_activity_date": 1475695015, "creation_date": 1475692925, "question_id": 39881464, "link": "https://stackoverflow.com/questions/39881464/changing-named-range", "title": "Changing Named Range", "body": "<p>How would I create a macro to find and replace part of a named range.</p>\n\n<p>Lets say I have CKWH_1, CKWH_2 </p>\n\n<p>Is there a way to replace KWH with THR so it became CTHR_1, CTHR_2 </p>\n\n<p>Thank you. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 202, "user_id": 4979789, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/064fbb3d6fc8c5a4d3fe3577be4ffc8e?s=128&d=identicon&r=PG&f=1", "display_name": "ZealousHypocrites", "link": "https://stackoverflow.com/users/4979789/zealoushypocrites"}, "edited": false, "score": 0, "creation_date": 1475695057, "post_id": 39881332, "comment_id": 67050907, "body": "I think I figured it out...? When getting the error I was clicking the &quot;Debug&quot; button on the error message so it would highlight the code where the error was happening. It would bring up the Case Select and highlight the line with Call, so I thought that was where the error was happening. I looked into the Sub itself and down the way a bit there is a piece of code which references a sheet that no longer exists in this tool."}, {"owner": {"reputation": 202, "user_id": 4979789, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/064fbb3d6fc8c5a4d3fe3577be4ffc8e?s=128&d=identicon&r=PG&f=1", "display_name": "ZealousHypocrites", "link": "https://stackoverflow.com/users/4979789/zealoushypocrites"}, "edited": false, "score": 0, "creation_date": 1475695061, "post_id": 39881332, "comment_id": 67050908, "body": "Obviously that would give me an Out of Range error, but the debug wasn&#39;t showing me that part of the code and the code leading up to it wasn&#39;t even executed yet. Option Explicit is enabled on all Sheets, and even if the Sub itself contained the error it should at least have run the code leading up to that point instead of highlighting the Case Select code from way before it...at least so I thought. Is this what happened? I&#39;m still not entirely sure."}], "owner": {"reputation": 202, "user_id": 4979789, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/064fbb3d6fc8c5a4d3fe3577be4ffc8e?s=128&d=identicon&r=PG&f=1", "display_name": "ZealousHypocrites", "link": "https://stackoverflow.com/users/4979789/zealoushypocrites"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475693674, "creation_date": 1475692373, "last_edit_date": 1531164843, "question_id": 39881332, "link": "https://stackoverflow.com/questions/39881332/call-sub-giving-subscript-out-of-range-when-not-in-break-mode", "title": "Call Sub giving Subscript Out of Range when not in Break Mode", "body": "<p>I have a tool which pulls info from pdfs into Excel. There are three different types of pulls it can do so there is a Case Select which tells it which one to use. The problem I'm encountering is...odd...</p>\n\n<p>On Sheet5, the \"Browse\" sheet which is basically the control panel, you choose which method of comparison you want then click \"Go\". It then picks which of the three subs on Sheet4 to call and off it goes. Code is here:</p>\n\n<pre><code>    Select Case CompMeth$\n       Case \"Pri\"\n            Call Sheet4.PDFCopyImagePri\n       Case \"Luf\"\n            Call Sheet4.PDFCopyImageLuf\n       Case \"All\"\n            Call Sheet4.PDFCopyImageAll\n    End Select\n</code></pre>\n\n<p>The second two are giving me a \"Subscript out of range\" error but <em>NOT</em> in break mode. If I put a break point just at the top of that code and run it line by line by using F8 then it works and goes to the Sub in Sheet4. I only can get the error when I let it run at normal speed.</p>\n\n<p>The three subs are all on Sheet4, and all three are correctly selected and work in break mode, but the \"Luf\" and \"All\" give me the error when trying to select the sub while not in break mode.</p>\n\n<p>The first Sub works in call cases, and the three subs all reside on Sheet4 and they even all begin the same for the first dozen lines or so of code... I'm very confused... I've tried copying the Sub's name directly from Sheet4, I've tried using the menu which suggests stuff when typing \"Sheet4.\" to choose the Sub name, I've tried renaming the Sub by removing the \"Copy\" from the name in both places. No matter what it seems to only work while in break mode, but not normally. To be clear the Case Select is working. It gets to the \"Call\" line and that's where it is giving the error.</p>\n\n<p>Edit: An additional note that I'm not sure is useful or not is that this tool is a modified version of another tool which uses the <em>same exact</em> Case Select and Subs, and that tool is still working just fine. In fact this new tool is literally that old tool saved as a new name. I can't even begin to imagine why the literally same exact code works on one but not the next. :(</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1517, "user_id": 3103548, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fc5d2ec8ea51202fa67b95400ef14a89?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Nguyen", "link": "https://stackoverflow.com/users/3103548/dale-nguyen"}, "edited": false, "score": 0, "creation_date": 1475694984, "post_id": 39881685, "comment_id": 67050864, "body": "Thanks for the fast answer. I have question about step one. The table is not really incremental. The number and value could be different and randomly. For example: 1,2,5,10,13... Is there any ways that we can improve the first formula? =IF(B3&lt;B2,A2+1,A2)"}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "reply_to_user": {"reputation": 1517, "user_id": 3103548, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fc5d2ec8ea51202fa67b95400ef14a89?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Nguyen", "link": "https://stackoverflow.com/users/3103548/dale-nguyen"}, "edited": false, "score": 0, "creation_date": 1475695360, "post_id": 39881685, "comment_id": 67051095, "body": "If I&#39;m following correctly, the <code>Row_ID</code> in your example is something like an identifier, rather than a simple indicator of where in the table that value is, and thus it should be repeated on each row of our new table that pulls from that data row - is that correct? If so, yes, we can include that as well. We won&#39;t change the first formula, though - I&#39;ll edit the answer to include this step."}, {"owner": {"reputation": 1517, "user_id": 3103548, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fc5d2ec8ea51202fa67b95400ef14a89?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Nguyen", "link": "https://stackoverflow.com/users/3103548/dale-nguyen"}, "edited": false, "score": 0, "creation_date": 1475697336, "post_id": 39881685, "comment_id": 67052207, "body": "Thank @Werrf. I&#39;m consuming your idea. Looks like it really works! In the column_id, can it be shown as Value 1, Value 2 and Value 3 instead of id number?"}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "reply_to_user": {"reputation": 1517, "user_id": 3103548, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fc5d2ec8ea51202fa67b95400ef14a89?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Nguyen", "link": "https://stackoverflow.com/users/3103548/dale-nguyen"}, "edited": false, "score": 0, "creation_date": 1475697382, "post_id": 39881685, "comment_id": 67052228, "body": "The number is what it&#39;s using to find which column the data is coming from. If you want to include the Value 1, Value 2 and Value 3 as well, you can do the same thing we did to bring across the ID, but make the column absolute, ie: <code>=OFFSET(Sheet1!$A$1,0,B2).</code> Put that in another column so you have something like <code>Row | Column | Row ID | Column ID | Value</code>"}, {"owner": {"reputation": 1517, "user_id": 3103548, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fc5d2ec8ea51202fa67b95400ef14a89?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Nguyen", "link": "https://stackoverflow.com/users/3103548/dale-nguyen"}, "edited": false, "score": 0, "creation_date": 1475697651, "post_id": 39881685, "comment_id": 67052353, "body": "Thanks a lot. You&#39;re the best!"}], "tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": true, "score": 1, "last_activity_date": 1475695794, "last_edit_date": 1475695794, "creation_date": 1475693820, "answer_id": 39881685, "question_id": 39880916, "link": "https://stackoverflow.com/questions/39880916/generate-new-table-from-a-current-table-in-excel/39881685#39881685", "title": "Generate new table from a current table in excel", "body": "<p>Well. There's no single formula that's going to do the job, obviously, but we have a few options we can use.  I'll assume that the new table is going to start in cell A1 of Sheet2. Adjust accordingly.</p>\n\n<p>Start with manually entered headers\n<code>Row_ID | Column_ID | Value</code></p>\n\n<p>In the first column, first row, enter a 1. In rows below, use this formula: <code>=IF(B3&lt;B2,A2+1,A2)</code> This will increment the value in the first column by 1 each time the second column resets its numbering.</p>\n\n<p>In the second column, first row, enter a 1. The formula we'll use for this one will need some tweaking, but the basic version is: <code>=IF(MOD(ROW()**+1**,**3**)=0,1,B2+1)</code> </p>\n\n<p>This formula is going to essentially count up to a certain point, then reset its numbering. The point it will count to, and where it will reset, will vary depending on the amount of data you have and which row you're starting from.  Replace the <strong>3</strong> with the number of data columns you have, and remove the **s. The +1 is needed to increase the Row() counter to the SAME NUMBER as your number of data columns. So in my example, with 3 data columns and starting on row 2, the ROW() function gives us 2, so we need to add 1 to that to get up to a total of 3. If I had 5 data columns, I would add 3 to the total. Hope that makes sense.</p>\n\n<p>These two formulae should give you a set of row and column numbers. Copying the formula down will force the values to increase as needed, thus:</p>\n\n<pre><code>Row_ID | Column_ID | Value\n   1   |     1     |\n   1   |     2     |\n   1   |     3     |\n   2   |     1     |\n</code></pre>\n\n<p>...etc.</p>\n\n<p>Finally, to bring in the values, we'll use an <code>OFFSET</code> formula in the Value column: <code>=OFFSET(Sheet1!$A$1,A2,B2)</code> That formula starts from a reference cell - A1, in this case - then moves down x number of rows and across y number of columns to return a value. X and Y are provided by the formulas we already have.  Your final structure will be something like this:</p>\n\n<pre><code>Row_ID | Column_ID | Value\n   1   |     1     |=OFFSET(...\n=IF(...|=IF(MOD(...|=OFFSET(...\n</code></pre>\n\n<p>I hope all that made sense. Please let me know if there's anything that doesn't, and I'll try to troubleshoot.</p>\n\n<p>EDITED TO ADD:\nIf the Row ID is something like a key that needs to be included with each value, we can get that fairly easily. We'll include another column with a slightly modified OFFSET formula: <code>=OFFSET(Sheet1!$A$1,A2,0)</code></p>\n\n<p>With this version of the formula we're not changing the column as we go down, just the row when it changes. It allows the values in the first row to be repeated in every row of the table. So this is my input:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EELYn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EELYn.png\" alt=\"This is my test input\"></a></p>\n\n<p>And this is my output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6EI6F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6EI6F.png\" alt=\"And this is my output\"></a></p>\n\n<p>Notice that the ID repeats on each line of the output for the same item.</p>\n"}], "owner": {"reputation": 1517, "user_id": 3103548, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fc5d2ec8ea51202fa67b95400ef14a89?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Nguyen", "link": "https://stackoverflow.com/users/3103548/dale-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 39881685, "answer_count": 1, "score": -2, "last_activity_date": 1475695794, "creation_date": 1475690859, "last_edit_date": 1531161705, "question_id": 39880916, "link": "https://stackoverflow.com/questions/39880916/generate-new-table-from-a-current-table-in-excel", "title": "Generate new table from a current table in excel", "body": "<p>I have sample table like this: </p>\n\n<pre><code>ID | 1 | 2 | 3\n-------------\n1  | 0 | 1 | 0\n--------------\n2  | 1 | 1 | 1\n</code></pre>\n\n<p>Then I want to generate a new table from that table. It will take the second row (1) then compare with each column (1, 2, 3) then print value of the matrix ( 0 - 1 - 0 ). For example:</p>\n\n<pre><code>Row_ID | Column_ID | Value\n--------------------------\n1      | 1         | 0\n--------------------------\n1      | 2         | 1\n--------------------------\n1      | 3         | 0\n--------------------------\n2      | 1         | 1\n--------------------------\n2      | 2         | 1\n--------------------------\n2      | 3         | 1\n</code></pre>\n\n<p>I'm not sure how or where to start by using formula. Please help. Thanks,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "edited": false, "score": 0, "creation_date": 1475689011, "post_id": 39880378, "comment_id": 67047511, "body": "Is there a particular reason you&#39;re using R1C1 notation to get the range? Because that&#39;s the source of your problem, and the solution will depend on why you&#39;re using that notation."}, {"owner": {"reputation": 33, "user_id": 6757605, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9bd31793ba8237d014c7a16fad47d3c?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6757605/ct4242"}, "reply_to_user": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "edited": false, "score": 0, "creation_date": 1475689080, "post_id": 39880378, "comment_id": 67047548, "body": "No particular reason, just have always used R1C1"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1475689234, "post_id": 39880378, "comment_id": 67047629, "body": "Use <code>y.Sheets(&quot;Adjustment&quot;).Cells(57, 4).PasteSpecial</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1475689334, "post_id": 39880378, "comment_id": 67047696, "body": "When you <code>.Open</code> a workbook, typically it becomes the <code>ActiveWorkbook</code>. <code>Set y = ActiveWorkbook</code> <b>before</b> you open the source workbook."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1475696723, "post_id": 39880526, "comment_id": 67051868, "body": "Another good reason not to use Copy / PasteSpecial is the fact that it goes via the clipboard, and if the user is doing anything while the macro is running in the background, and the user also copy / pastes something, the results can be disastrous.  +1 for recommending against its use!"}], "tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": true, "score": 4, "last_activity_date": 1475689436, "creation_date": 1475689436, "answer_id": 39880526, "question_id": 39880378, "link": "https://stackoverflow.com/questions/39880378/how-to-copy-a-range-of-cells/39880526#39880526", "title": "How to copy a range of cells", "body": "<p>The RANGE object expects A1 notation rather than R1C1 notation. The CELLS object can use row number and column number (though you don't need the R..C.. structure there, either.</p>\n\n<pre><code>Sub getfilename()\n\nDim myFilePath As String\nDim target As Workbook, y As Workbook\n\nmyFilePath = Application.GetOpenFilename()\n\nSet y = ActiveWorkbook\n\n'copying\nSet target = Workbooks.Open(myFilePath)\n\n'Here we're using the A1 notation\ntarget.Sheets(\"Sheet1\").Range(\"B2\",\"B9\").Copy\n\n'Here we're using the Row &amp; Column numbers notation\ny.Sheets(\"Adjustment\").Cells(57, 4).PasteSpecial\n\n'close\ntarget.Close\n\nEnd Sub\n</code></pre>\n\n<p>In addition, you don't actually need to use the Copy and PasteSpecial methods to duplicate values. It's not too big a deal in a small macro like this, but in a larger process you'd find it more efficient to duplicate the values directly using something like:\n    target.Range(\"A1\",\"A10\").value = source.Range(\"A1\",\"A10\").value</p>\n"}], "owner": {"reputation": 33, "user_id": 6757605, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9bd31793ba8237d014c7a16fad47d3c?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6757605/ct4242"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 39880526, "answer_count": 1, "score": 0, "last_activity_date": 1568999819, "creation_date": 1475688827, "last_edit_date": 1568999819, "question_id": 39880378, "link": "https://stackoverflow.com/questions/39880378/how-to-copy-a-range-of-cells", "title": "How to copy a range of cells", "body": "<p>I am trying to copy data from a closed Excel file to the workbook I am currently in. I would like to browse for the file and then have the macro do the rest.</p>\n\n<p>I am getting an error in the target workbook that says</p>\n\n<blockquote>\n  <p>\"Application-defined or object defined error.\"</p>\n</blockquote>\n\n<p>Below is what I have so far. Target is the workbook I am opening and y is the current one, or should be at least! </p>\n\n<pre><code>Option Explicit\nSub getfilename()\n\nDim myFilePath As String\nDim target As Workbook, y As Workbook\n\nmyFilePath = Application.GetOpenFilename()\n\n'copying\nSet target = Workbooks.Open(myFilePath)\n\ntarget.Sheets(\"Sheet1\").Range(\"R9C2:R20C2\").Copy\n\n'pasting\nSet y = ActiveWorkbook\n\ny.Sheets(\"Adjustment\").Cells(\"R57C4\").PasteSpecial\n\n'close\ntarget.Close\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": true, "score": 1, "last_activity_date": 1475689837, "creation_date": 1475689837, "answer_id": 39880635, "question_id": 39880364, "link": "https://stackoverflow.com/questions/39880364/changing-printarea-page-size-using-vba/39880635#39880635", "title": "Changing PrintArea page size using VBA", "body": "<p>You can use the <code>HPageBreaks.add</code> method to create a new page break in a given location. For example:</p>\n\n<pre><code>Sub PageBreaks()\n    Dim shtSheet As Worksheet\n\n    Set shtSheet = ActiveSheet\n\n    shtSheet.HPageBreaks.Add before:=Range(\"A10\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 12952, "user_id": 2398375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a5530da29f23682b10bb5568076f83d?s=128&d=identicon&r=PG", "display_name": "Dioxin", "link": "https://stackoverflow.com/users/2398375/dioxin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 39880635, "answer_count": 1, "score": 0, "last_activity_date": 1475689837, "creation_date": 1475688776, "last_edit_date": 1475689304, "question_id": 39880364, "link": "https://stackoverflow.com/questions/39880364/changing-printarea-page-size-using-vba", "title": "Changing PrintArea page size using VBA", "body": "<p>When the <code>PrintArea</code> consumes more than 1 page, you can adjust the page size ratio in Page Break View via the dashed line in the picture below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yKLLk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yKLLk.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there a way to adjust the size ratio using VBA? I couldn't find any properties exposed by <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196103.aspx\" rel=\"nofollow noreferrer\"><code>PageSetup</code></a> that allows this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475688224, "post_id": 39880037, "comment_id": 67047055, "body": "I have never heard of <code>Dir$()</code> function? Is this a regular variation of <code>Dir()</code>? I would venture that that is the nature of your issue."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475688291, "post_id": 39880037, "comment_id": 67047087, "body": "I can&#39;t reproduce your error on my computer. When you step through the macro with F8, with a non-existing file, does it loop through your <code>If</code> statement, or skip it? It skips it for me."}, {"owner": {"reputation": 11, "user_id": 6927741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef34f3cd5f7abbae14087b2939b499a6?s=128&d=identicon&r=PG&f=1", "display_name": "lawtli23", "link": "https://stackoverflow.com/users/6927741/lawtli23"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475689277, "post_id": 39880037, "comment_id": 67047653, "body": "Getting the same error if I remove the $. @BruceWayne when I step through it, it highlights the If statement with no error, then at the next step, it highlights the If statement with an error."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1475689367, "post_id": 39880037, "comment_id": 67047720, "body": "Is that your actuql path?  houldnt it be more like C:\\Users ?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475689429, "post_id": 39880037, "comment_id": 67047748, "body": "What&#39;s the path, are you on Windows? Replace it with <code>&quot;C:\\Users\\me\\Downloads\\myfile.csv&quot;</code>.  And I&#39;m assuming <code>myfile.csv</code> does <i>not</i> exist anywhere in that folder."}, {"owner": {"reputation": 11, "user_id": 6927741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef34f3cd5f7abbae14087b2939b499a6?s=128&d=identicon&r=PG&f=1", "display_name": "lawtli23", "link": "https://stackoverflow.com/users/6927741/lawtli23"}, "edited": false, "score": 0, "creation_date": 1475689513, "post_id": 39880037, "comment_id": 67047787, "body": "I&#39;m on a Mac, path is the same with username and filename changed. It works when that file does exist in the folder."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1475689948, "post_id": 39880037, "comment_id": 67048030, "body": "@nbayly - See <a href=\"http://stackoverflow.com/documentation/vba/877/declaring-variables/2960/type-hints#t=201610051751594390861\">this example</a> on Documentation."}, {"owner": {"reputation": 11, "user_id": 6927741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef34f3cd5f7abbae14087b2939b499a6?s=128&d=identicon&r=PG&f=1", "display_name": "lawtli23", "link": "https://stackoverflow.com/users/6927741/lawtli23"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475695960, "post_id": 39880037, "comment_id": 67051418, "body": "@Comintern see my edit - I couldn&#39;t get it to work using Dir() and MacID"}], "owner": {"reputation": 11, "user_id": 6927741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef34f3cd5f7abbae14087b2939b499a6?s=128&d=identicon&r=PG&f=1", "display_name": "lawtli23", "link": "https://stackoverflow.com/users/6927741/lawtli23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 811, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475695898, "creation_date": 1475687580, "last_edit_date": 1495540856, "question_id": 39880037, "link": "https://stackoverflow.com/questions/39880037/deleting-a-file-in-vba-error-53", "title": "Deleting a file in VBA - Error 53", "body": "<p>I have a Sub in VBA (on a Mac) to delete a file, and it works correctly when the file exists. However, I get \"Run-time error '53' File not found\" when the file doesn't exist, even though the code is checking if it exists.</p>\n\n<p>I tried a couple of different subs including from <a href=\"http://word.mvps.org/faqs/macrosvba/DeleteFiles.htm\" rel=\"nofollow noreferrer\">http://word.mvps.org/faqs/macrosvba/DeleteFiles.htm</a> and \n<a href=\"https://stackoverflow.com/questions/67835/deleting-a-file-in-vba\">Deleting a file in VBA</a></p>\n\n<pre><code>Sub DeleteFile()\n\nDim KillFile As String\nKillFile = \"/Users/me/Downloads/myfile.csv\"\n'Check that file exists\nIf Len(Dir$(KillFile)) &gt; 0 Then\n    'First remove readonly attribute, if set\n    SetAttr KillFile, vbNormal\n    'Then delete the file\n    Kill KillFile\nElse\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Why am I getting this error when it should already be handled by the If statement?</p>\n\n<p>Thanks.</p>\n\n<p>EDIT: I want to delete/search for only this specific file, can I do that with Dir and MacID? I don't need to comb the directory for all CSV or TEXT files.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1475686776, "post_id": 39879721, "comment_id": 67046275, "body": "Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834621.aspx\" rel=\"nofollow noreferrer\">Union method</a> to collect all of the cells into a single <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a> then use <code>rng.entirerow.delete</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1475857573, "post_id": 39880157, "comment_id": 67127407, "body": "This is also a nice piece of code. Thanks for your help Dirk!"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 1, "last_activity_date": 1475688009, "creation_date": 1475688009, "answer_id": 39880157, "question_id": 39879721, "link": "https://stackoverflow.com/questions/39879721/storing-multiple-values-in-variant-and-delete-rows-at-the-end-of-sub/39880157#39880157", "title": "Storing multiple values in variant and delete rows at the end of sub", "body": "<p>As you need a range holding all rows, you can collect it in one \"on the run\" like this:</p>\n\n<pre><code>Sub FixData()\n\n  Dim wsData As Worksheet\n  wsData = ThisWorkbook.Worksheets(\"Data\")\n\n  Dim val As Variant\n  val = ThisWorkbook.Worksheets(\"Data2\").Range(\"C1\").Value\n\n  Dim DelRows As Range, x As Long\n\n  For x = 2 To wsData.Cells(wsData.Rows.Count, 4).End(xlUp).Row\n    If wsData.Range(\"J\" &amp; x).Value &lt;&gt; val Then\n      If DelRows Is Nothing Then\n        Set DelRows = wsData.Rows(x)\n      Else\n        Set DelRows = Union(wsData.Rows(x), DelRows)\n      End If\n    Else\n      wsData.Range(\"AF\" &amp; x).Value = wsData.Range(\"J\" &amp; x).Value\n    End If\n  Next x\n\n  DelRows.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1475857528, "post_id": 39882437, "comment_id": 67127381, "body": "Wow this is so quick! Thanks so much for your help Thomas."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1475858095, "post_id": 39882437, "comment_id": 67127682, "body": "Quick question: How come Dim Data, Data1 &amp; TargetValue do not have do be defined?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1475858401, "post_id": 39882437, "comment_id": 67127825, "body": "If you don&#39;t specify a declaration type, the variable type defaults to Variant."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1475696780, "creation_date": 1475696780, "answer_id": 39882437, "question_id": 39879721, "link": "https://stackoverflow.com/questions/39879721/storing-multiple-values-in-variant-and-delete-rows-at-the-end-of-sub/39882437#39882437", "title": "Storing multiple values in variant and delete rows at the end of sub", "body": "<p>The fastest way is to </p>\n\n<ul>\n<li>Load the data into an array </li>\n<li>Copy the valid data into a second array</li>\n<li>Clear the contents of the range</li>\n<li>Write the second array back to the worksheet</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub FixData()\n    Dim Source As Range\n    Dim Data, Data1, TargetValue\n    Dim x As Long, x1 As Long, y As Long\n\n    Set Source = Worksheets(\"Data\").Range(\"A1\").CurrentRegion\n    TargetValue = Worksheets(\"Data2\").Range(\"C1\")\n\n    Data = Source.Value\n    ReDim Data1(1 To UBound(Data, 1), 1 To UBound(Data, 2))\n\n    For x = 1 To UBound(Data, 1)\n        If x = 1 Or Data(x, 10) = TargetValue Then\n            x1 = x1 + 1\n            For y = 1 To UBound(Data, 2)\n                Data1(x1, y) = Data(x, y)\n            Next\n        End If\n    Next\n\n    Source.ClearContents\n    Source.Resize(x1).Value = Data1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 39882437, "answer_count": 2, "score": 0, "last_activity_date": 1475696780, "creation_date": 1475686433, "question_id": 39879721, "link": "https://stackoverflow.com/questions/39879721/storing-multiple-values-in-variant-and-delete-rows-at-the-end-of-sub", "title": "Storing multiple values in variant and delete rows at the end of sub", "body": "<p>I have written the following code which is supposed to run through a data set and delete all rows that do not match the value in call C1. In my original code I deleted line by line and the code was very slow, so now I am trying to add all values to a variant and delete all cells at the end. Is this possible?</p>\n\n<pre><code>Sub FixData()\n\nDim wbFeeReport As Workbook\nDim wsData As Worksheet\nDim wsData2 As Worksheet\nDim FrRngCount As Range\nDim x As Long\nDim y As Long\nDim varRows As Variant\n\nSet wbFeeReport = ThisWorkbook\nSet wsData = wbFeeReport.Worksheets(\"Data\")\nSet wsData2 = wbFeeReport.Worksheets(\"Data2\")\n\nSet FrRngCount = wsData.Range(\"D:D\")\ny = Application.WorksheetFunction.CountA(FrRngCount)\n\nFor x = y To 2 Step -1\nIf wsData.Range(\"J\" &amp; x).Value &lt;&gt; wsData2.Range(\"C1\").Value Then\nvarRows = x\nElse\nwsData.Range(\"AF\" &amp; x).Value = wsData.Range(\"J\" &amp; x).Value\nEnd If\nNext x\n\nwsData.Rows(varRows).EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>Right now the code only deletes the last row as the variant is overwritten each time as it runs through the loop. Any suggestions on how I can store all values in the variant and delete the rows I don't need at the end?</p>\n\n<p>Thanks for you help!</p>\n"}, {"tags": ["vba", "outlook", "outlook-2016"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1475843524, "post_id": 39879409, "comment_id": 67118638, "body": "Save all attachments found with the rule. Reproduce in VBA the process of opening the file and searching for the text. Kill the file if the text is not found."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 1, "last_activity_date": 1476135147, "last_edit_date": 1495541212, "creation_date": 1475929464, "answer_id": 39932319, "question_id": 39879409, "link": "https://stackoverflow.com/questions/39879409/office-365-outlook-2016-move-a-file-with-an-attachment-that-contains-a-string-to/39932319#39932319", "title": "Office 365/Outlook 2016 Move a file with an attachment that contains a string to another folder", "body": "<p>You have been a member for 26 months so you should be aware this site is for programmers to help each other develop.  You have asked way too much in a single question and have made no obvious attempt to break it down.  If someone gave you macro that was almost what you wanted, would you understand it enough to finish it?  I will try to get you started. </p>\n\n<p>I know nothing that suggests a rule exists that can test for a particular string within a particular type of attachment and, if found, save that attachment.  I am not an experienced user of rules so this may be my ignorance.  The SuperUser site would be a better place to ask about such a rule. I will suggest a macro.  Start by running the macro manually every hour or once per day or whenever.  There are more advanced techniques but let\u2019s get the macro working before we worry about the most convenient way to run it.</p>\n\n<p>First, look at this answer of mine: <a href=\"https://stackoverflow.com/a/12146315/973283\">How to copy Outlook mail message into excel using VBA or Macros</a></p>\n\n<p>We get a lot of questions along to lines: \u201cI am trying to extract xxxx from emails and copy it to an Excel workbook\u201d.  This is accompanied by an image of the email.  What the questioners seem unable to understand is that an image of the email tells us nothing about what the email\u2019s body looks like to a VBA macro.  Is it text or Html or both? If Html, is the formatting native or CSS? Does it use SPAN or DIV elements with class or id attributes to identify the different sections?</p>\n\n<p>The referenced macro was an attempt to help questioners understand this issue.  It creates a new Excel workbook and outputs to it the major properties of every email in Inbox.</p>\n\n<p>There is nothing in your question to suggest you are interested in output to Excel but I think this is a good start for you.  It reads down Inbox examining every email.  It extracts subject and sender which might be interesting. It lists the type and name of every attachment which you will need. It outputs the text and Html bodies which might be interesting.</p>\n\n<p>Download that macro, change the destination folder as instructed and run the macro.  Search the workbook for one of your \u201clog file\u201d emails.  Is the text within the Xml file the only indication that it is a log file email?  This macro gives the structure you want (it reads down the Inbox) but contains lots of stuff of no interest to you.  You can either delete the uninteresting bits from that macro or create a new macro by extracting the interesting bits.  Can you do that?  If you cannot, you will not be able to cope with the more advanced functionality necessary for a complete solution to your requirement.</p>\n\n<p>I will have to update, the referenced answer.  I have recently upgraded to Outlook 2016 and have found an issue.  My installation does not use the default Inbox which the macro searches so the macro would create an empty workbook.  Outlook 2016 has created a \u201cstore\u201d per email address with names of the form: abcdefghi@isp.com. In the folder pane, these are the top names in each hierarchy.  Each of these stores contains its own Inbox which is where new emails sent to the relevant address are stored.  If your installation is like mine, you will have to replace:</p>\n\n<p><code>Set FolderTgt = CreateObject(\"Outlook.Application\"). _</code><br>\n<code>GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox)</code><br>\nby<br>\n<code>Set FolderTgt = CreateObject(\"Outlook.Application\"). _</code><br>\n<code>GetNamespace(\"MAPI\").Folders(\"abcdefghi@isp.com\").Folders(\"Inbox\")</code><br></p>\n\n<p>Once you have the structure of your macro, the next problem is to identify the emails with an Xml attachment that contains the identifying text.  You cannot look at an email\u2019s attachment directly.  You have to save them to disc and process them there.  With VBA you can open an Xml file as a text file and scan for the identifying text.  If I understand correctly, it is Xml files containing the identifying text you require.  If so, if an Xml contains the identifying text, it is left on disc otherwise it is deleted.  If the Xml file is retained, you need to move the email to another folder so it will not be examined again.</p>\n\n<p>I have: (1) saved attachments to disc, (2) moved emails from one folder to another and (3) processed text files with VBA, although never from Outlook, but never in one macro.  I will treat this as a training exercise for myself and develop the code you need to drop into the macro I have told you to develop.</p>\n\n<p>Possible issue 1: How big are these log files?  There seem to be a limit of around 15Mb for emails. VBA can easily process files of 15Mb but you do not want to load an entire file of this size into memory if the identifying text is in the first 1,000 bytes.</p>\n\n<p>Possible issue 2: Do the log files have unique names? If they have unique names, they can be saved under those names.  If they do not have unique names, unique names will have to be generated for them.  A unique name could be as simple as \u201cLFnnnn.Xml\u201d where \u201cnnnn\u201d is one more than the number of the previous log file.  Alternatively, it could be as complex as you want.   </p>\n\n<p><strong>Update</strong></p>\n\n<p>Rereading your question, I believe if I may have misinterpreted your requirement.  I read that you wanted the log file attachments moved to a disc folder.  I believe niton read it the same way.  I now believe you want the mail item moved to a new Outlook folder and do not specify what is to happen to the log file attachment.  I do not think this misinterpretation is important or makes a material difference to the required macro.  An email containing a log file <strong>has</strong> to be moved to a new Outlook because otherwise it would be processed again and again.  A log file <strong>has</strong> to be extracted to a disc folder so that its contents can be checked.  My code leaves an Xml file containing the identifying text on disc.  One additional statement would delete such an Xml file just as those Xml files that do not contain the identifying text are deleted.  I assume the log files have to be extracted sometime. Perhaps you did not appreciate that they would have to be extracted to meet your requirement.  I leave you to decide whether or not to add that <code>Kill</code> statement.</p>\n\n<p>I said the default Inbox may not be the Inbox into which these emails are loaded.  I have created a little macro that outputs the user name of the store containing the default Inbox which you may find helpful:</p>\n\n<pre><code>Sub DsplUsernameOfDefaultStore()\n\n  Dim NS As Outlook.NameSpace\n  Dim DefaultInboxFldr As MAPIFolder\n\n  Set NS = CreateObject(\"Outlook.Application\").GetNamespace(\"MAPI\")\n  Set DefaultInboxFldr = NS.GetDefaultFolder(olFolderInbox)\n\n  Debug.Print DefaultInboxFldr.Parent.Name\n\nEnd Sub\n</code></pre>\n\n<p>The following macro does all the heavy lifting for your requirement:</p>\n\n<pre><code>Public Sub SaveInterestingAttachment(ByRef ItemCrnt As MailItem, _\n                                     ByVal IdentExtn As String, _\n                                     ByVal IdentText As String, _\n                                     ByVal DestDiscFldr As String, _\n                                     ByRef DestOlkFldr As MAPIFolder)\n\n  ' * ItemCrnt may contain one or more attachments which have extension\n  '   IdentExtn and which contains text IdentText. If it contains such\n  '   attachment(s) then the macro:\n  '     * saves all such attachments to disc folder DestDiscFldr\n  '     * moves the mail item to output folder DestOlkFldr.\n  ' * Comparisons of IdentExtn and IdentText against file extensions and\n  '   contents are case insensitive because the strings are converted to\n  '   lower case before comparisons.\n  ' * The phrase \"saves all such attachments\" is perhaps slightly\n  '   misleading. An attachment can only be checked to contain the\n  '   identifying text by saving it to disc, opening it and scanning the\n  '   contents. So all attachments with extension IdentExtn are saved to\n  '   disc and those that do not contain IdentText are deleted.\n\n  ' Warning: This code assumes DestDiscFldr has a trailing \\\n  ' Warning: This code does not test for an existing file with the same name\n  ' Warning: To compile, this macro needs a Reference to \"Microsoft Scripting\n  '          RunTime\". Click Tools then References. Click box against\n  '          \"Microsoft Scripting RunTime\" if not already ticked. The Reference\n  '          will be at the top if ticked. Unticked references are in\n  '          alphabetic sequence.\n\n  Const ForReading As Long = 1\n  Const OpenAsAscii As Long = 0\n\n  Dim FileContents As String\n  Dim FileXml As TextStream\n  Dim Fso As FileSystemObject\n  Dim InxA As Long\n  Dim LcExtn As String:   LcExtn = LCase(IdentExtn)\n  Dim LenExtn As Long:    LenExtn = Len(IdentExtn)\n  Dim LcIdText As String: LcIdText = LCase(IdentText)\n  Dim MoveEmail As Boolean\n  Dim PathFileName As String\n\n  With ItemCrnt\n    If .Attachments.Count &gt; 0 Then\n      Set Fso = CreateObject(\"Scripting.FileSystemObject\")\n      MoveEmail = False\n      For InxA = 1 To .Attachments.Count\n        If Right$(LCase(.Attachments(InxA).FileName), 1 + LenExtn) = _\n                                                             \".\" &amp; LcExtn Then\n\n          ' My test files do not have unique names. Adding received time and\n          ' subject was an easy way of making the names unique and demonstrates\n          ' some options.\n          PathFileName = DestDiscFldr &amp; Format(.ReceivedTime, \"yymmddhhmmss\") &amp; _\n                                        \" \" &amp; .Subject &amp; \" \" &amp; _\n                                        .Attachments(InxA).FileName\n          .Attachments(InxA).SaveAsFile PathFileName\n\n          Set FileXml = Fso.OpenTextFile(PathFileName, ForReading, OpenAsAscii)\n\n          FileContents = FileXml.ReadAll\n          ' If your log files are large snd the identifying text is near\n          ' the beginning, Read(N) would read the first N characters\n\n          If InStr(1, LCase(FileContents), LcIdText) &lt;&gt; 0 Then\n            ' Xml file contains identifiying text\n            ' Leave Xml on disc. Move email to save folder\n            MoveEmail = True\n            FileXml.Close\n          Else\n            ' Delete Xml file. Leave email in Inbox unless another attachment\n            ' contained the identifying text\n            FileXml.Close\n            Kill PathFileName\n          End If\n\n          Set FileXml = Nothing\n\n        End If\n      Next\n      If MoveEmail Then\n        .Move DestOlkFldr\n      End If\n      Set Fso = Nothing\n    End If\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>This macro has five parameters:</p>\n\n<ul>\n<li>A reference to the Mail Item to be tested.</li>\n<li>The value of the extension to be tested.</li>\n<li>The value of the identifying text.</li>\n<li>The value of the disc folder to which attachments are to be saved.</li>\n<li>A reference to the Outlook folder to which appropriate Mail Items are to be moved. </li>\n</ul>\n\n<p>I am very confident that eventually this code will have to be called from two different parent macros so making the Mail Item a parameter was necessary.  The other parameters could have been hard coded into the macro but making them parameters was no extra effort and parameters are usually easier to explain that values buried in the body of a macro.</p>\n\n<p>You need to work down this macro reading the comments and reviewing the statements.  My test data is based on my understanding of your requirement.  If I have misunderstood and my test data is faulty, this macro may fail with your data.  You will need to carefully check the code and then carefully test it with your data.</p>\n\n<p>I needed a test harness to test this macro since a macro with parameters cannot be called by the user.  If you have created a macro to read down the Inbox, it will be very similar to my test harness.  My test harness reads down the Inbox and calls <code>SaveInterestingAttachment</code> for each Mail Item.</p>\n\n<p>Even more than <code>SaveInterestingAttachment</code>, this macro must be carefully checked and updated.  This macro references folders on my disc and folders within my Outlook installation. These references will have to be updated.  </p>\n\n<pre><code>Sub TestSaveInterestingAttachment()\n\n  ' For every mail item in Inbox, call SaveInterestingAttachment.\n\n  Dim DestOlkFldr As MAPIFolder\n  Dim SrcOlkFldr As MAPIFolder\n  Dim InxItemCrnt As Long\n  Dim NS As Outlook.NameSpace\n\n  Set NS = CreateObject(\"Outlook.Application\").GetNamespace(\"MAPI\")\n\n  ' You only need one of the next two Set statements. If your Inbox is not\n  ' Outlook's default then amend the second to reference your default Inbox.\n\n  ' This is the easiest way to reference the default Inbox.\n  ' However, you must be careful if, like me, you have multiple email addresses\n  ' each with their own Inbox. The default Inbox may not be where you think it is.\n  Set SrcOlkFldr = NS.GetDefaultFolder(olFolderInbox)\n\n  ' This references the Inbox in a specific PST or OST file.\n  ' \"abcdefghi@MyIsp.com\" is the user name that Outlook gave the PST file in\n  ' which it stores emails sent to this account when I created the account. The user\n  ' name is the name Output displays to the user. The file name on disk is different. \n  Set SrcOlkFldr = NS.Folders(\"abcdefghi@MyIsp.com\").Folders(\"Inbox\")\n\n  ' I do not know where you want to save processed emails.\n  ' In this description, a \"store\" is a file on disc in which Outlook stores\n  ' your mail items, calendar items, tasks and so on. When you look at the\n  ' folder pane, names against the left edge are the user names of stores.\n  ' Indented names are folders within a store. The name of the file on disc\n  ' is probably the same as the user name but with an extension of PST or OST.\n  ' The first Set statement below shows how to reference a folder at the same\n  ' level as Inbox in the same store. It does this by using property Parent to\n  ' go up one level and then property Folders to go down one level.\n  ' The second Set statement below shows how to reference a sub-folder of\n  ' Inbox.  It does this by using property Folders to go down one level.\n  ' The third Set statement below shows how tp reference a folder \"Processed2\"\n  ' within folder \"Inbox\" within store \"outlook data file\".\n  ' None of these Set statements will meet your requirements. Use these\n  ' examples to build a Set statement suitable for your requirements.\n  Set DestOlkFldr = SrcOlkFldr.Parent.Folders(\"!Tony\")\n  Set DestOlkFldr = SrcOlkFldr.Folders(\"Processed3\")\n  Set DestOlkFldr = NS.Folders(\"outlook data file\").Folders(\"Inbox\").Folders(\"Processed2\")\n\n  ' This examines the emails in reverse order.\n  ' If I process email number 5 and then move it to another folder,\n  ' the number of all subsequence emails is decreased by 1. If I looked at the\n  ' emails in ascending sequence, email 6 would be ignored because it would have\n  ' been renumbered when I looked for it. By looking at the emails in reverse\n  ' sequence, I ensure email 6 has bee processed before the removal of email 5\n  ' changes its number.\n\n  With SrcOlkFldr.Items\n    For InxItemCrnt = .Count To 1 Step -1\n      If .Item(InxItemCrnt).Class = olMail Then\n        ' I am only interested in mail items.\n        ' You will need to replace the identying text and the\n        ' destination disc folder\n        Call SaveInterestingAttachment(.Item(InxItemCrnt), \"Xml\", _\n                                       \"identifying text\", _\n                                       \"C:\\DataArea\\SO\\\", DestOlkFldr)\n      End If  ' .Class = olMail\n    Next InxItemCrnt\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>I have attempted a second test harness.  I have recently upgraded to Outlook 2016 and this is the first time I have attempted to use events with it.  Code which worked perfectly with my previous version no longer works.  There are a number of possible reasons for this code not working.  Until I have identified the cause, I will give no further information about this second test harness.</p>\n\n<p><strong>Update 2</strong></p>\n\n<p>I have now fixed the problem with my second test harness.  A statement that worked with Outlook 2003, which I was still using until a couple of months ago, apparently does not work with Outlook 2016.</p>\n\n<p>You will need a routine based on my first test harness because that routine searches Inbox for log file emails that have already arrived.  I also believe it is an easier routine for testing <code>SaveInterestingAttachment</code> until you have updated it to your exact requirements.</p>\n\n<p>The second test harness sits in the background monitoring new emails and processing those containing log files.</p>\n\n<p>I have a home installation and emails register as new when they are downloaded from my ISP\u2019s server to my hard drive.  An email can only be downloaded while I have Outlook open.  Once I have run test harness 1 to clear my Inbox of previously received log file emails, I can rely on test harness 2 to handle any future log file emails.</p>\n\n<p>If you have an office installation, then your emails may register as new when they reach your organisation\u2019s server. If that is the case, you will always need a routine based on test harness 1 to handle those log file emails that arrive overnight or whenever you do not have Outlook open.</p>\n\n<p>From within Outlook\u2019s Visual Basic Editor, look as the Project Explorer pane.  On my installation, the top line is \u201cProject1 (VbaProject.OTM)\u201d. On your installation, the top line might be slightly different.</p>\n\n<p>If there is a \u201c+\u201d to the left of \u201cProject1 (VbaProject.OTM)\u201d, click that \u201c+\u201d to display the items under \u201cProject1 (VbaProject.OTM)\u201d.  On my installation these are: \u201cMicrosoft Outlook Objects\u201d, \u201cForms\u201d and \u201cModules\u201d.  You will not have any forms.</p>\n\n<p>If there is a \u201c+\u201d to the left of \u201cMicrosoft Outlook Objects\u201d, click that \u201c+\u201d to display the items under \u201cMicrosoft Outlook Objects\u201d.  The only item displayed will be \u201cThisOutlookSession\u201d.</p>\n\n<p>Click \u201cThisOutlookSession\u201d and the code area will become blank.  This is a special code area.  Previously you will have created modules which are suitable for storing general routines.  The code below will only work if it is within \u201cThisOutlookSession\u201d.</p>\n\n<p>As before, this code will have to be amended to match your Outlook installation and your disc layout.  The full code is at the bottom but I introduce it bit by bit to help you understand what it is doing.</p>\n\n<p>My code contains:</p>\n\n<ul>\n<li>Option Explicit</li>\n<li>Two variables that can be accessed by either of the subroutines.</li>\n<li>Subroutine Application_Startup()</li>\n<li>Subroutine InboxItems_ItemAdd(ByVal Item As Object)</li>\n</ul>\n\n<p>You should have <code>Option Explicit</code> at the top of every module.  Look it up if you do not know why.</p>\n\n<p><code>Subroutine Application_Startup()</code> will be executed every time you open Outlook.  With this routine in place, you will be warned about \u201cThisOutlookSession\u201d before Outlook opens.  You need to enable macros if Application_Startup() is to be executed.</p>\n\n<p>I suggest you start by copying the following:</p>\n\n<pre><code>Private Sub Application_Startup()\n\n  ' This event routine is called when Outlook is started\n\n  Dim UserName As String\n\n  With Session\n    UserName = .CurrentUser\n  End With\n\n  MsgBox \"Welcome \" &amp; UserName\n\nEnd Sub\n</code></pre>\n\n<p>Having copied this code to \"ThisOutlookSession\", close Outlook and save your VBA project.  Reopen Outlook, enable macros and you will see a message box saying \"Welcome Stephanie\".   This serves no useful purpose but ensures we have the envelope correct before we do anything important.</p>\n\n<p>Copy: <code>Private WithEvents InboxItems As Items</code>.  Study the statement starting <code>Set InboxItems =</code> and the comments above it.  You will need to construct a version of this statement appropriate for your Inbox.  This Set statement makes InBoxItems reference to the Inbox.  To confirm, go to the end of the macro where you will find:</p>\n\n<pre><code>Debug.Print InboxItems.Count\nIf InboxItems.Count &gt; 0 Then\n  With InboxItems.Item(1)\n    Debug.Print .ReceivedTime &amp; \" \" &amp; .Subject &amp; \" \" &amp; .SenderEmailAddress\n  End With\nEnd If\n</code></pre>\n\n<p>These statements output the number of items in the Inbox and details of the first email which is almost certainly the oldest email.  Once you have copied these statements, close Outlook, save the VBA project and then open Outlook again.  If all is as it should be, the Immediate Window will contain a count and details of an email.  If it is not, we need to identify the cause and correct it before continuing.</p>\n\n<p>Copy: <code>Private DestOlkFldr As MAPIFolder</code>. Study the statement starting <code>Set DestOlkFldr =</code> and the comments above it.   You will need to construct a version of this statement appropriate for your destination Outlook folder.  Again go to the end of the macro where you will find:</p>\n\n<pre><code>Debug.Print DestOlkFldr.Name\nDebug.Print DestOlkFldr.Parent.Name\nDebug.Print DestOlkFldr.Parent.Parent.Name\n</code></pre>\n\n<p>On my system these display:</p>\n\n<pre><code>Processed2\nInbox\nOutlook Data File\n</code></pre>\n\n<p>Copy or create as many <code>Debug.Print</code> statements as appropriate for how deeply nested your destination Outlook folder is.  Close Outlook, save the VBA project and then open Outlook again. Are the correct names displayed?  If so, <code>Sub Application_Startup()</code> is correct.  Delete the diagnostic statements which are no longer required.</p>\n\n<p>We are now ready to create <code>Sub InboxItems_ItemAdd(ByVal Item As Object)</code>.  I would start with: </p>\n\n<pre><code>Private Sub InboxItems_ItemAdd(ByVal Item As Object)\n\n  If TypeOf Item Is MailItem Then\n    With Item\n      Debug.Print \"Mail item received at \" &amp; .ReceivedTime &amp; \" from \" &amp; _\n                  .SenderEmailAddress &amp; \"(\" &amp; .Sender &amp; \")\"\n    End With\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>Close Outlook, save the VBA project, open Outlook again and wait for some emails to arrive.  If necessary, send yourself an email.  Details of those emails should be in the Immediate Window.</p>\n\n<p>Finally, update and copy this statement:</p>\n\n<pre><code>Call SaveInterestingAttachment(Item, \"Xml\", _\n                               \"identifying text\", _\n                               \"C:\\DataArea\\SO\\\", DestOlkFldr)\n</code></pre>\n\n<p>Close Outlook, save the VBA project, open Outlook again and wait for some log file emails to arrive.  Are they being processed correctly?</p>\n\n<p>Finally, a recap:</p>\n\n<p><code>Application_Startup()</code> is a reserved name.  A subroutine with this name will be executed automatically when Outlook is opened.  This is an example of an event routine.  Event routines are executed when the appropriate event occurs.  I have included the code in <code>Application_Startup()</code>necessary to prepare for the new email arrived event.</p>\n\n<p><code>InboxItems_ItemAdd(ByVal Item As Object)</code> is the reserved name and mandatory specification for the <code>Add item to InboxItems</code> (that is new email arrived) event routine.  <code>InboxItems</code> was the <code>WithEvents</code> variable we declared at the top and initialised with <code>Application_Startup()</code>.  </p>\n\n<p>If you are not used to thinking about computer events and what you want to happen when they occur, they can be a little tricky to understand although once you do, you will have difficulty remembering what the problem was.  I have introduced them in tiny steps.  This is how I try out new functionality. If necessary, sleep on it.  Trust me, suddenly it will all make sense.</p>\n\n<p>Come back with questions as necessary but the more you can understand on your own, the faster you will develop.  </p>\n\n<pre><code>Option Explicit\nPrivate WithEvents InboxItems As Items\nPrivate DestOlkFldr As MAPIFolder\nPrivate Sub Application_Startup()\n\n  ' This event routine is called when Outlook is started\n\n  Dim UserName As String\n\n  With Session\n\n    ' In TestSaveInterestingAttachment() you have a statement like:\n    '       Set SrcOlkFldr = NS.GetDefaultFolder(olFolderInbox)\n    '    or Set SrcOlkFldr = NS.Folders(\"abcdefghi@Isp.com\").Folders(\"Inbox\")\n    ' You need a similar statement here without the \"NS\" at the beginning\n    ' and with \".Items\" at the end.  For example:\n    'Set InboxItems = .GetDefaultFolder(olFolderInbox).Items\n    Set InboxItems = .Folders(\"abcdefghi@Isp.com\").Folders(\"Inbox\").Items\n\n    ' In TestSaveInterestingAttachment() you have a statement like:\n    '       Set DestOlkFldr = SrcOlkFldr.Parent.Folders(\"!Tony\")\n    '    or Set DestOlkFldr = SrcOlkFldr.Folders(\"Processed3\")\n    '    or Set DestOlkFldr = NS.Folders(\"outlook data file\").Folders(\"Inbox\").Folders(\"Processed2\")\n    ' There is no equivalent of SrcOlkFldr here so you cannot use the first two formats\n    ' as a basis for the statement here.  You must use the third format, without the\n    ' leading NS, at the basis for the statement here. For example:\n    Set DestOlkFldr = .Folders(\"outlook data file\").Folders(\"Inbox\").Folders(\"Processed2\")\n\n    UserName = .CurrentUser\n\n  End With\n\n  MsgBox \"Welcome \" &amp; UserName\n\n  Debug.Print InboxItems.Count\n  If InboxItems.Count &gt; 0 Then\n    With InboxItems.Item(1)\n      Debug.Print .ReceivedTime &amp; \" \" &amp; .Subject &amp; \" \" &amp; .SenderEmailAddress\n    End With\n  End If\n\n  Debug.Print DestOlkFldr.Name\n  Debug.Print DestOlkFldr.Parent.Name\n  Debug.Print DestOlkFldr.Parent.Parent.Name\n\n\nEnd Sub\nPrivate Sub InboxItems_ItemAdd(ByVal Item As Object)\n\n  ' This event routine is called each time an item is added to Inbox because of:\n\n  '    \"Private WithEvents InboxItems As Items\" at the top of this ThisOutlookSession\n  ' and\n  '    \"Set InboxItems = Session.GetDefaultFolder(olFolderInbox).Items\"\n  ' or \"Set InboxItems = Session.Folders(\"abcdefghi@Isp \").Folders(\"Inbox\").Items\"\n  ' within \"Private Sub Application_Startup()\"\n\n  If TypeOf Item Is MailItem Then\n    With Item\n      Debug.Print \"Mail item received at \" &amp; .ReceivedTime &amp; \" from \" &amp; _\n                  .SenderEmailAddress &amp; \"(\" &amp; .Sender &amp; \")\"\n    End With\n    ' You will need to replace the identying text and the\n    ' destination disc folder\n    Call SaveInterestingAttachment(Item, \"Xml\", _\n                                   \"identifying text\", _\n                                   \"C:\\DataArea\\SO\\\", DestOlkFldr)\n  End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3918270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3eee52d546a5a52217e825dbe1dd852?s=128&d=identicon&r=PG&f=1", "display_name": "Stephanie", "link": "https://stackoverflow.com/users/3918270/stephanie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593415545, "creation_date": 1475685269, "last_edit_date": 1593415545, "question_id": 39879409, "link": "https://stackoverflow.com/questions/39879409/office-365-outlook-2016-move-a-file-with-an-attachment-that-contains-a-string-to", "title": "Office 365/Outlook 2016 Move a file with an attachment that contains a string to another folder", "body": "<p>I receive multiple log files per day and would like to create a rule or vba script that will move the email to a specified folder. The catch is, it should only be moved if it contains specific text in an xml attachment. I'm new to VBA and couldn't find anything that look particularly helpful online, and I couldn't find a way to do it with a rule. </p>\n\n<p>I am able to find the correct files to move if I do a manual search [ext:xml attachment:TestScriptFailed], but I'm not sure how to translate that into a rule or VBA script to automate the transfer process.</p>\n"}, {"tags": ["string", "vba", "function", "recursion", "replace"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1475685244, "post_id": 39879265, "comment_id": 67045399, "body": "I&#39;m not sure you even need recursion for this"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475685780, "post_id": 39879265, "comment_id": 67045741, "body": "Without having any idea about what this does, perhaps changing the declaration <code>checkexpressionvalidity(srchstr As String)</code> to <code>checkexpressionvalidity(ByVal srchstr As String)</code> will fix it. The default pass by reference makes recursion hard to manage."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6682556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b35af17663e89f5879744a16bf6a3dc?s=128&d=identicon&r=PG&f=1", "display_name": "Programmingnovice20", "link": "https://stackoverflow.com/users/6682556/programmingnovice20"}, "edited": false, "score": 0, "creation_date": 1475688552, "post_id": 39879498, "comment_id": 67047244, "body": "Thanks for this. I won&#39;t be able to check this until tomorrow but I had a couple of questions just by looking at your 2nd code (the non recursive one): 1. what&#39;s the significance of the $ sign in CheckExp(str$...) and 2. won&#39;t your str = Replace(str, Mid(SPECIALS, i, 1), repl) only work for the 1st instance of each character it finds in the string? i.e., will it replace more than one &#39;/&#39;, &quot;*&quot; etc. with &quot;_&#39;. That&#39;s why i used recursive because i didn&#39;t think the replace function would work on all instances.  Thanks again for your detailed explanation."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 25, "user_id": 6682556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b35af17663e89f5879744a16bf6a3dc?s=128&d=identicon&r=PG&f=1", "display_name": "Programmingnovice20", "link": "https://stackoverflow.com/users/6682556/programmingnovice20"}, "edited": false, "score": 0, "creation_date": 1475690762, "post_id": 39879498, "comment_id": 67048465, "body": "<code>CheckExp(str$...)</code> the <code>$</code> is VBA short-hand notation for <code>As String</code>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 25, "user_id": 6682556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b35af17663e89f5879744a16bf6a3dc?s=128&d=identicon&r=PG&f=1", "display_name": "Programmingnovice20", "link": "https://stackoverflow.com/users/6682556/programmingnovice20"}, "edited": false, "score": 0, "creation_date": 1475690977, "post_id": 39879498, "comment_id": 67048592, "body": "<i>i didn&#39;t think the replace function would work on all instances.</i>  But did you try it ??  :)  -- The <code>Replace</code> function has optional parameter of <code>Count</code> with default value of <code>-1</code>. If not assigned in the function call, <code>Replace</code> will replace <i>all</i> instances. The <code>Count</code> argument can be specified to restrict the number of occurences that will be replaced, by specifying any positive integer)"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 4, "last_activity_date": 1475687074, "last_edit_date": 1475687074, "creation_date": 1475685579, "answer_id": 39879498, "question_id": 39879265, "link": "https://stackoverflow.com/questions/39879265/vba-simple-recursive-function-query/39879498#39879498", "title": "VBA - Simple recursive function query", "body": "<p>Your loop is iterating over <em>each</em> character in the <code>specialchar</code> array, and the <code>Instr</code> test is operating against the <code>srchstr</code> from the initial function call, at each iteration. You <em>could</em> fix that, kind of, by doing this:</p>\n\n<pre><code>revname = srchstr\nFor i = 0 To 7\n    If InStr(1, revname, specialchar(i), vbBinaryCompare) &gt; 0 Then\n        revname = Replace(revname, specialchar(i), \"_\")\n        checkexpressionvalidity = checkexpressionvalidity(revname)\n    End If\nNext\n</code></pre>\n\n<p>But the recursion seems unnecessary and redundant, and you'll still end up with multiple <code>Print</code> outputs, albeit they're all <em>correct</em> this time:</p>\n\n<pre><code>I_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p_erson\n</code></pre>\n\n<p>Doesn't this solve it without recursion?</p>\n\n<pre><code>Const SPECIALS = \"\\/:;*?&lt;&gt;|\"\n\nSub check_exp()\nDim strname As String\nDim strname2 As String\nstrname = \"I\\ am/ a / &lt;  stupid p*erson\"\nstrname2 = CheckExp(strname)\n\nEnd Sub\n\nFunction CheckExp(str$, Optional repl = \"_\")\nDim i As Long\nFor i = 1 To Len(SPECIALS)\n    str = Replace(str, Mid(SPECIALS, i, 1), repl)\nNext\nCheckExp = str\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1475686924, "creation_date": 1475686924, "answer_id": 39879859, "question_id": 39879265, "link": "https://stackoverflow.com/questions/39879265/vba-simple-recursive-function-query/39879859#39879859", "title": "VBA - Simple recursive function query", "body": "<p>As @DavidZemens, you don't need recursion to do this. However, if you <strong><em>do</em></strong> recurse it, you'll get multiple passes on identical data for 2 reasons.  You always start from the same position in the string with your <code>Instr</code> call <em>and</em> loop through all elements of the <code>specialchar</code> array.  You would need to pass one or the other as a parameter in your recursive call:</p>\n\n<pre><code>'Passing starting position for Instr:\nFunction checkexpressionvalidity(srchstr As String, Optional starting As Integer = 1) As String\n    Dim specialchar() As String\n    Dim revname As String\n    Dim pos As Integer\n\n    specialchar = Split(\"\\,/,:,*,?,&lt;,&gt;,|\", \",\")\n\n    For i = 0 To 7\n        pos = InStr(starting, srchstr, specialchar(i), vbBinaryCompare)\n        If pos &gt; 0 Then\n            revname = Replace(srchstr, specialchar(i), \"_\")\n            checkexpressionvalidity = checkexpressionvalidity(revname)\n            Exit For\n        End If\n    Next\n\n    checkexpressionvalidity = revname\n    Debug.Print revname\nEnd Function\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n<pre><code>I_ am_ a _ _  stupid p_erson\nI_ am_ a _ &lt;  stupid p_erson\nI_ am_ a _ &lt;  stupid p*erson\nI_ am/ a / &lt;  stupid p*erson\n</code></pre>\n</blockquote>\n\n<p>Or:</p>\n\n<pre><code>'Passing index of specialchar:\nFunction checkexpressionvalidity(srchstr As String, Optional index As Integer = 0) As String\n    Dim specialchar() As String\n    Dim revname As String\n    Dim pos As Integer\n\n    specialchar = Split(\"\\,/,:,*,?,&lt;,&gt;,|\", \",\")\n\n    For i = index To 7\n        pos = InStr(1, srchstr, specialchar(i), vbBinaryCompare)\n        If pos &gt; 0 Then\n            revname = Replace(srchstr, specialchar(i), \"_\")\n            checkexpressionvalidity = checkexpressionvalidity(revname, i + 1)\n            Exit For\n        End If\n    Next\n\n    checkexpressionvalidity = revname\n    Debug.Print revname\nEnd Function\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n<pre><code>I_ am_ a _ _  stupid p_erson\nI_ am_ a _ &lt;  stupid p_erson\nI_ am_ a _ &lt;  stupid p*erson\nI_ am/ a / &lt;  stupid p*erson\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 0, "last_activity_date": 1475688360, "creation_date": 1475688360, "answer_id": 39880245, "question_id": 39879265, "link": "https://stackoverflow.com/questions/39879265/vba-simple-recursive-function-query/39880245#39880245", "title": "VBA - Simple recursive function query", "body": "<p>Another proposal</p>\n\n<pre><code>Function checkexpressionvalidity(srchstr As String) As String\nDim specialchar(0 To 7) As String\nDim revname As String\nDim pos As Integer\nspecialchar(0) = \"\\\"\nspecialchar(1) = \"/\"\nspecialchar(2) = \":\"\nspecialchar(3) = \"*\"\nspecialchar(4) = \"?\"\nspecialchar(5) = \"&lt;\"\nspecialchar(6) = \"&gt;\"\nspecialchar(7) = \"|\"\nrevname = srchstr\nFor i = 0 To 7\n    If InStr(1, srchstr, specialchar(i), vbBinaryCompare) &gt; 0 Then\n        revname = Replace(revname, specialchar(i), \"_\")\n    End If\nNext\n\ncheckexpressionvalidity = revname\nDebug.Print revname\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6682556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b35af17663e89f5879744a16bf6a3dc?s=128&d=identicon&r=PG&f=1", "display_name": "Programmingnovice20", "link": "https://stackoverflow.com/users/6682556/programmingnovice20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 39879498, "answer_count": 3, "score": 1, "last_activity_date": 1475688360, "creation_date": 1475684806, "question_id": 39879265, "link": "https://stackoverflow.com/questions/39879265/vba-simple-recursive-function-query", "title": "VBA - Simple recursive function query", "body": "<p>I almost feel embarrassed asking this but i have spent a better part of 3 hours staring at this and i can't find what's wrong with it. It's a simple recursive function to replace certain characters in a string with \"_\".</p>\n\n<p>Function:</p>\n\n<pre><code>Function checkexpressionvalidity(srchstr As String) As String\nDim specialchar(0 To 7) As String\nDim revname As String\nDim pos As Integer\nspecialchar(0) = \"\\\"\nspecialchar(1) = \"/\"\nspecialchar(2) = \":\"\nspecialchar(3) = \"*\"\nspecialchar(4) = \"?\"\nspecialchar(5) = \"&lt;\"\nspecialchar(6) = \"&gt;\"\nspecialchar(7) = \"|\"\n\nFor i = 0 To 7\n    If InStr(1, srchstr, specialchar(i), vbBinaryCompare) &gt; 0 Then\n        revname = Replace(srchstr, specialchar(i), \"_\")\n        checkexpressionvalidity = checkexpressionvalidity(revname)\n    End If\nNext\n\ncheckexpressionvalidity = revname\ndebug.print revname\nEnd Function\n</code></pre>\n\n<p>Test Module:</p>\n\n<pre><code>Sub check_exp()\nDim strname As String\nDim strname2 As String\nstrname = \"I\\ am/ a / &lt;  stupid p*erson\"\nstrname2 = checkexpressionvalidity(strname)\n\nEnd Sub\n</code></pre>\n\n<p>Debug.print results:</p>\n\n<pre><code>I_ am_ a _ _  stupid p_erson    '------&gt; Clearly it works the first time.\n                                         Can't figure out why it goes back\n                                         and redoes it.\n\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p*erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI_ am/ a / _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI_ am/ a / _  stupid p_erson\nI_ am/ a / _  stupid p*erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI_ am_ a _ _  stupid p*erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI\\ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI\\ am_ a _ _  stupid p_erson\nI\\ am_ a _ _  stupid p*erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI_ am/ a / _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI\\ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI\\ am_ a _ _  stupid p_erson\nI\\ am/ a / _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI_ am/ a / _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI\\ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\n\nI_ am_ a _ _  stupid p_erson\nI\\ am_ a _ _  stupid p_erson\nI\\ am/ a / _  stupid p_erson\nI\\ am/ a / _  stupid p*erson\nI\\ am/ a / _  stupid p*erson\n</code></pre>\n\n<p>I am sure I am missing something really obvious. </p>\n\n<p>Please help.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "is_accepted": true, "score": 1, "last_activity_date": 1475685504, "creation_date": 1475685504, "answer_id": 39879473, "question_id": 39878984, "link": "https://stackoverflow.com/questions/39878984/vba-dateadd-not-working-as-expected/39879473#39879473", "title": "VBA DateAdd not working as expected", "body": "<p>Not sure if this qualifies as an answer but it does get around the problem.  It seems pasting the date as <code>String</code> get's around the issue.  And searching around it seems this is a problem with Excel adding dates and moving days.</p>\n\n<pre><code>Sub test()\nDim i As Integer\nDim currentDate As Date\nDim currentDate2 As String\n\nWith ThisWorkbook.Sheets(1)\n    .Cells.Clear\n    .Cells(1, 1) = \"DateTime\"\n    .Cells(1, 2) = \"Day\"\n\n    currentDate = CDate(\"10/3/2016 11:59:30 PM\")\n    currentDate2 = currentDate\n    For i = 1 To 10\n        .Cells(i + 1, 1) = currentDate2\n        .Cells(i + 1, 2) = Day(currentDate)\n        '.Cells(i + 1, 3) = test\n        currentDate = DateTime.DateAdd(\"s\", 5, currentDate)\n        currentDate2 = currentDate\n    Next i\n\n    .Columns(1).NumberFormat = \"m/d/yyyy h:mm:ss AM/PM\"\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1475686076, "last_edit_date": 1475686076, "creation_date": 1475685558, "answer_id": 39879488, "question_id": 39878984, "link": "https://stackoverflow.com/questions/39878984/vba-dateadd-not-working-as-expected/39879488#39879488", "title": "VBA DateAdd not working as expected", "body": "<p>That appears to be an Excel formatting bug.  In fact, the VBA values are correct:</p>\n\n<pre><code>Sub Example()\n    Dim i As Integer\n    Dim currentDate As Date\n    currentDate = CDate(\"10/3/2016 11:59:30 PM\")\n    For i = 1 To 10\n        Debug.Print currentDate, Day(currentDate)\n        currentDate = DateTime.DateAdd(\"s\", 5, currentDate)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n<pre><code>10/3/2016 11:59:30 PM        3 \n10/3/2016 11:59:35 PM        3 \n10/3/2016 11:59:40 PM        3 \n10/3/2016 11:59:45 PM        3 \n10/3/2016 11:59:50 PM        3 \n10/3/2016 11:59:55 PM        3 \n10/4/2016      4 \n10/4/2016 12:00:05 AM        4 \n10/4/2016 12:00:10 AM        4 \n10/4/2016 12:00:15 AM        4\n</code></pre>\n</blockquote>\n\n<p>The moral seems to be that if you're doing date arithmetic in Excel and have to correctly represent midnight, you should add a tiny delta as a workaround:</p>\n\n<pre><code> currentDate = CDate(\"10/3/2016 11:59:30 PM\") + 0.00000000001\n</code></pre>\n\n<p>This \"tricks\" Excel into using the correct date for 12:00 AM. </p>\n"}], "owner": {"reputation": 1946, "user_id": 3055415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Ohl7R.jpg?s=128&g=1", "display_name": "Justin Moser", "link": "https://stackoverflow.com/users/3055415/justin-moser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 0, "accepted_answer_id": 39879473, "answer_count": 2, "score": 4, "last_activity_date": 1475686785, "creation_date": 1475683824, "last_edit_date": 1531164843, "question_id": 39878984, "link": "https://stackoverflow.com/questions/39878984/vba-dateadd-not-working-as-expected", "title": "VBA DateAdd not working as expected", "body": "<p>I am using the DateTime.DateAdd VBA function in Excel to create a column of dates. Using the code below, the day does not change as expected when the time progresses to midnight.</p>\n\n<pre><code>Sub test()\n    Dim i As Integer\n    Dim currentDate As Date\n\n    With ThisWorkbook.Sheets(1)\n        .Cells.Clear\n        .Cells(1, 1) = \"DateTime\"\n        .Cells(1, 2) = \"Day\"\n\n        currentDate = CDate(\"10/3/2016 11:59:30 PM\")\n\n        For i = 1 To 10\n            .Cells(i + 1, 1) = currentDate\n            .Cells(i + 1, 2) = DateTime.Day(currentDate)\n            currentDate = DateTime.DateAdd(\"s\", 5, currentDate)\n        Next i\n\n        .Columns(1).NumberFormat = \"m/d/yyyy h:mm:ss AM/PM\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<ul>\n<li>DateTime | Day</li>\n<li>10/3/2016 11:59:30 PM | 3</li>\n<li>10/3/2016 11:59:35 PM | 3</li>\n<li>10/3/2016 11:59:40 PM | 3</li>\n<li>10/3/2016 11:59:45 PM | 3 </li>\n<li>10/3/2016 11:59:50 PM | 3</li>\n<li>10/3/2016 11:59:55 PM | 3</li>\n<li>10/<strong>3</strong>/2016 12:00:00 AM | <strong>4</strong>  <em>(day values do not match!)</em></li>\n<li>10/4/2016 12:00:05 AM | 4</li>\n<li>10/4/2016 12:00:10 AM | 4</li>\n<li>10/4/2016 12:00:15 AM | 4</li>\n</ul>\n\n<p>Changing the number format to military time gives a similar result. If I use the output dates as the x-values for a chart, the chart will use the 'incorrect' day value. However, the day changes as expected if I change the start time in the code to 10/3/2016 11:59:45 PM. Am I doing something wrong or is there an alternate more stable way to add time to a Date in VBA?</p>\n\n<p>EDIT:</p>\n\n<p>Excellent workarounds provided by mrbungle and Comintern.  They both achieve the same end result but I like mrbungle's method just a hair better because it avoids altering the value, albeit a negligible amount.</p>\n\n<p>To summarize the alternatives:</p>\n\n<pre><code>Sub test()\n    Dim i As Integer\n    Dim currentDate As Date\n\n    With ThisWorkbook.Sheets(1)\n        .Cells.Clear\n        .Cells(1, 1) = \"DateTime\"\n        .Cells(1, 2) = \"Day\"\n\n        currentDate = CDate(\"10/3/2016 11:59:30 PM\")\n\n        For i = 1 To 10\n            .Cells(i + 1, 1) = CStr(currentDate) ' mrbungle's method\n            .Cells(i + 1, 1) = currentDate + 0.000000001 ' Comintern's method\n            .Cells(i + 1, 2) = DateTime.Day(currentDate)\n            currentDate = DateTime.DateAdd(\"s\", 5, currentDate)\n        Next i\n\n        .Columns(1).NumberFormat = \"m/d/yyyy h:mm:ss AM/PM\"\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "security"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1475682128, "post_id": 39878276, "comment_id": 67043337, "body": "How much is your time worth? How many sheets of data would the customer need to attempt to defraud you with to make it worth your time to test this? This sounds like more of an issue with the contract terms than any code."}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475683385, "post_id": 39878276, "comment_id": 67044167, "body": "I will not be in a position to check use or misuse. Not only would I probably never know, I wouldn&#39;t be in a good position <i>at all</i> to verify if I suspected something.  I think many (many!) of these files will be ordered. I also suspect some subcontractors <i>will</i> attempt abuse. If they figure out a method, I could be totally replaced, and only see my numbers slowly dwindle. Let me put it this way: It is WELL worth my time."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1475684355, "post_id": 39878276, "comment_id": 67044788, "body": "If your customers are not technically knowledgeable you could encode the sheet data into a &quot;hash&quot; and add that to your VBA code (then password protect the project).  All of that you could do using VBA.  Of course, it&#39;s possible to crack the VBA project password if you know how to use Google...  EDIT: re-reading your question you seem to want to allow for <i>some</i> editing, so a hash may not work out, but some other less-visible way of storing the original data (Custom XML part?) might work."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1475686144, "post_id": 39878276, "comment_id": 67045930, "body": "Just to echo @TimWilliams - if a user is determined to get to your code that&#39;s stored in an Excel file, there are myriad ways they can try to get in.  Excel&#39;s (Office&#39;s?) security isn&#39;t that hard to break if you really want to.  How tech. savvy are your clients? Why not just run your macros on the data, then save just the data and give that to the customer? Do they <i>need</i> to have the <code>.xlsm</code> or would simply <code>.xlsx</code> work?"}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475686516, "post_id": 39878276, "comment_id": 67046147, "body": "@BruceWayne Yes there is a reason: it&#39;s all their data. I&#39;m just adding automated ways to enter metadata, track, and report that data. It&#39;s the VB they are purchasing."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475686879, "post_id": 39878276, "comment_id": 67046330, "body": "They&#39;re purchasing the VB, but you want to lock them out of seeing it?  I think this question is less of an SO issue, and more of a contractual one, or am I misunderstanding?"}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1475687318, "post_id": 39878276, "comment_id": 67046568, "body": "They are purchasing a workbook that has vb functionality. I <i>will</i> contract appropriately. I&#39;m asking how to protect in <i>case</i> of infringement. As stated above I will not be able to verify if they are <i>upholding</i> the contract. I think this is an appropriate question: <b>I&#39;m asking about a functional way to detect spreadsheet data change after initial import (in a secure way, or as secure as possible).</b> The &quot;contractual&quot; stuff is a red herring."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1475687703, "post_id": 39878276, "comment_id": 67046787, "body": "Ah I see.  I think this is more suited perhaps for <a href=\"http://superuser.com/\">SuperUser</a>. For the record, I don&#39;t know if I&#39;d trust my business/IP to the security of MS Office."}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1475687824, "post_id": 39878276, "comment_id": 67046847, "body": "Ok, well, since I want <i>some</i> flexibility in the changing of data, it does seem like the solution will be code based. I&#39;m hoping for some good input."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1475968626, "post_id": 39878276, "comment_id": 67158334, "body": "what sort of flexibility you have to give to the customer? Is this flexibility achieved by code? Does the customer need to change data in the main sheet?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1475969133, "post_id": 39878276, "comment_id": 67158435, "body": "How periodically they provide the data to be processed?"}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1476109303, "post_id": 39878276, "comment_id": 67200520, "body": "There are some columns that they can completely change. I know what these are...I don&#39;t track them (in my proposed solution). There are some columns that should be considered static data...but I&#39;d like to allow for some administrative type corrections (perhaps a spelling error, or fix a typo, or even add, remove an entire row).   This flexibility would be done by them simply modifying the core data in the main sheet directly (outside of the already identified columns that are expected to change.)"}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1476109446, "post_id": 39878276, "comment_id": 67200607, "body": "re: how periodic:   I&#39;ll use a template. They give me a sheet with raw data, I import that into my vb laden template, Save As a new sheet (xlsm), and send them that new sheet. So after I import into the template and save as, there should never be a reimport or drastic change to the static data on the saved sheet (but still allow for <i>some</i> administrative adjustments of the &quot;static&quot; columns)."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1476242690, "post_id": 39878276, "comment_id": 67258521, "body": "so do you just receive the data and return to the it processed once, or you received at a later date and batch of data to be processed and returned, if so how periodically this happens?"}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1476293540, "post_id": 39878276, "comment_id": 67287585, "body": "I&#39;m not sure I fully understand the question...it might need to be reworded a bit, but I think the answer is this: I receive data, <i>I</i> import it into the vba excel sheet. I save it and give them this new vba inclusive copy. Data is not imported into that saved version again (thus the whole point of this question). I will receive, import, save, and deliver new sheets potential several times a week."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1476354712, "post_id": 39878276, "comment_id": 67313926, "body": "Out of curiosity, could this not be done via a web portal? so the customer can upload their file and you can provide them the interface to make amendments as per their requirement. You can than run your code (server side) and give the results in expected format (i.e. Excel worksheet or XML). Admittedly this will probably require major rework on your side but it does give you more control"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476390017, "post_id": 39878276, "comment_id": 67337622, "body": "My understanding is that your VBA code does two <i>things</i>: 1) process new data; and this is what your customer is currently paying you for 2) give your customer some browsing and querying utilities over processed data. If that is the case you could separate functions in two different xlsm and give your customer the 2nd one only. Sorry if my understanding is wrong"}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1476392044, "post_id": 39878276, "comment_id": 67338775, "body": "The best I can do here is tell you that it is <i>like</i> the following: 1. The customer has an existing workbook that has a page of thousands of widgets. 2. Each widget is listed on a row with information about the widget. 3. I import the widget data to a new workbook and sheet. 4. <i>The new sheet allows them to enter many-to-one cross-reference items for each widget</i> with custom vba entry form(s) and vba data-validation(s) and vba summary information (for the widget row). I make it easy and fast for them to enter validated cross-reference data."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476396663, "post_id": 39878276, "comment_id": 67340973, "body": "So the main functionalities are data querying summarizing, and cross validation, and these functionalities depend on current data versioning (otherwise I wouldn&#39;t understand your customer recurrent need of your services) you could split your data processing in such a way to get to the point of writing down all needed &quot;versioning dependant&quot; subcalculated tables and then 1) turn custom vba entry (user?)forms into sheet forms with ActiveX controls referencing those &quot;static&quot; ranges 2) have data validation reference those &quot;static&quot; ranges again 3) leave little vba for &quot;final&quot; summarizations"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1476396800, "post_id": 39878276, "comment_id": 67341052, "body": "This way you would pass them a workbook with &quot;metadata&quot; they would need your &quot;1st step&quot; vba to distill from new data. The workbook would be heavier but &quot;semi-static&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1475701627, "post_id": 39881570, "comment_id": 67054344, "body": "Ok. Good thoughts. I&#39;m not sure about the &quot;Save As&quot; though. They could just copy the file and rename it in Windows. And if they did, I&#39;m not sure I care. I DO care if they then paste a whole bunch of new data on the sheet and try to reuse it."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1475978246, "post_id": 39881570, "comment_id": 67159945, "body": "Events can be disable by users and enable back as they wish <code>Application.EnableEvents = False</code>."}], "tags": [], "owner": {"reputation": 9, "user_id": 6927947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/888a7ae2f8819789fb777981c1a99fbe?s=128&d=identicon&r=PG&f=1", "display_name": "mabiesen", "link": "https://stackoverflow.com/users/6927947/mabiesen"}, "is_accepted": false, "score": 0, "last_activity_date": 1475693329, "creation_date": 1475693329, "answer_id": 39881570, "question_id": 39878276, "link": "https://stackoverflow.com/questions/39878276/secure-excel-workbook-with-vba-from-reuse-with-different-data/39881570#39881570", "title": "Secure Excel Workbook (with VBA) from reuse with different data", "body": "<p>Concern 1 seems to be basic re-use of the file.  You could create a sub in the ThisWorkbook module to destroy code located in other modules in the event that save-as is selected.</p>\n\n<p>Concern 2 seems to be someone hacking your password protection. A similar tactic could be employed such as using \"opening the developer window\" as your event instead of save as.</p>\n\n<p>I have experimented with save events to log user entries with great success using the ThisWorkbook module. I am not certain how/if one could detect if the developer tab is opened.</p>\n"}, {"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 1, "creation_date": 1475970230, "post_id": 39933743, "comment_id": 67158658, "body": "Also need to protect the workbook structure otherwise, with your workbook active, this code makes the <code>License</code> sheet visible <code>ActiveWorkbook.Sheets(&quot;License&quot;).Visible = xlSheetVisible</code>"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1475978451, "post_id": 39933743, "comment_id": 67159974, "body": "Suggest to use a Change Event rather that Workbook_Open as users can disable events just before opening the workbook and set it back afterwards.  <code>Application.EnableEvents = False</code>"}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1476035037, "post_id": 39933743, "comment_id": 67173354, "body": "Ok, but in both comments above, doesn&#39;t step 1 prevent that?  I&#39;ve locked the vba code. Am I missing something."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1476043002, "post_id": 39933743, "comment_id": 67176056, "body": "It can be done from other workbook, or even from the immediate window..."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1476043145, "post_id": 39933743, "comment_id": 67176110, "body": "what about my other questions, I&#39;m trying to help you but can&#39;t if you don&#39;t provide information..."}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1476109027, "post_id": 39933743, "comment_id": 67200345, "body": "WOW! Another workbook! That&#39;s a backdoor I really hadn&#39;t thought of. (Darn!) As for your other question, I&#39;m not sure I understand. If I use the Change event, can&#39;t they still disable events, make the change, then re-enable? I&#39;m sure you have a good point here...I&#39;m just not getting it."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 2, "creation_date": 1476183473, "post_id": 39933743, "comment_id": 67230146, "body": "If you put a password, they can crack it ==&gt; they know how you check the license.  Then they open with disabled event, modify the license and done. ==&gt; see my above answer: there is no way that will be but &quot;time consuming&quot;, except putting some of the actual code, what does the job, on a server or a DLL..."}], "tags": [], "owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "is_accepted": false, "score": 0, "last_activity_date": 1475937950, "creation_date": 1475937950, "answer_id": 39933743, "question_id": 39878276, "link": "https://stackoverflow.com/questions/39878276/secure-excel-workbook-with-vba-from-reuse-with-different-data/39933743#39933743", "title": "Secure Excel Workbook (with VBA) from reuse with different data", "body": "<p>Here's what I've done. Perhaps there is a entirely better approach, or there are tweeks to the below that will make it better:</p>\n\n<ol>\n<li><p>From the VBA Tools menu > VBAProject Properties > Protection (tab), I Locked the project for viewing with a password.</p></li>\n<li><p>I created a new \"License\" sheet. \nThis sheet is hidden from the user. If you hide the sheet via code like this:</p></li>\n</ol>\n\n<p><code>Me.Visible = xlSheetVeryHidden</code></p>\n\n<p>then then sheet cannot be un-hidden by the user (it requires running vba code to unhide).</p>\n\n<ol start=\"3\">\n<li>On initial import I sample:\n\n<ul>\n<li>Number of imported rows</li>\n<li>x number of randomly selected cells *from the columns I know won't/shouldn't change. (There are columns they are allowed to change freely.)</li>\n</ul></li>\n</ol>\n\n<p>I store these on the \"License\" sheet in <strong>Address</strong> / <strong>Value</strong> pairs.</p>\n\n<p><a href=\"https://i.stack.imgur.com/L6g6n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L6g6n.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"4\">\n<li>When the workbook is opened, the <code>Workbook_Open</code> event fires and then does a quick comparison of the <em>current</em> number of rows, and the <em>current</em> values for the addresses stored on the \"License\" sheet.  I then do a percentage calculation: If the rows are more than x% different, or the number of changed values is more that y% then I</li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sheets(1).Protect LOCKOUT_PASSWORD\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n</code></pre>\n\n<p>There is also a method for unlocking the sheets if necessary.</p>\n"}, {"tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 1, "last_activity_date": 1476182749, "last_edit_date": 1476182749, "creation_date": 1476182422, "answer_id": 39975471, "question_id": 39878276, "link": "https://stackoverflow.com/questions/39878276/secure-excel-workbook-with-vba-from-reuse-with-different-data/39975471#39975471", "title": "Secure Excel Workbook (with VBA) from reuse with different data", "body": "<p>Whatever you do it will be feasible to crack it (VBA code is easy to crack). However:</p>\n\n<ul>\n<li>there is the contract so... that's not legal for them to do it</li>\n<li>you can put part of the code on a FTP server and control physically what is being executed</li>\n</ul>\n\n<p>Very nices ideas here though</p>\n"}, {"tags": [], "owner": {"reputation": 2221, "user_id": 1505990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FIKz5.jpg?s=128&g=1", "display_name": "Jon Carlstedt", "link": "https://stackoverflow.com/users/1505990/jon-carlstedt"}, "is_accepted": false, "score": -1, "last_activity_date": 1476185687, "creation_date": 1476185687, "answer_id": 39976356, "question_id": 39878276, "link": "https://stackoverflow.com/questions/39878276/secure-excel-workbook-with-vba-from-reuse-with-different-data/39976356#39976356", "title": "Secure Excel Workbook (with VBA) from reuse with different data", "body": "<p>I would create another workbook that contains the code and then reference the customers wb from that one.</p>\n"}, {"comments": [{"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1476210550, "post_id": 39983246, "comment_id": 67246972, "body": "If only.  In this case it won&#39;t work. What they need is the vba-automated data entry and data-processing stuff I&#39;m giving them, including stuff like user forms.  Keep thinking out of the box. It looks like that what it&#39;s going to take."}], "tags": [], "owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "is_accepted": false, "score": 0, "last_activity_date": 1476207313, "creation_date": 1476207313, "answer_id": 39983246, "question_id": 39878276, "link": "https://stackoverflow.com/questions/39878276/secure-excel-workbook-with-vba-from-reuse-with-different-data/39983246#39983246", "title": "Secure Excel Workbook (with VBA) from reuse with different data", "body": "<p>This might be too simple of an answer, but sometimes we fail to think of the simplest solutions:</p>\n\n<p>Why don't you simply provide the customer with only a copy of the output? You could run their data through your macro-enabled workbook, copy the output sheet into a new workbook, and then break all links so that there's no formulas, updating, or ties to your workbook. </p>\n"}, {"comments": [{"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1476295508, "post_id": 40005269, "comment_id": 67288768, "body": "I find this a very interesting option. Due consideration."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "reply_to_user": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 1, "creation_date": 1476692652, "post_id": 40005269, "comment_id": 67435901, "body": "If you decide to buy any software of third party, be prepared that what you need, is the top most expensive license offered. Do not think that anything like &quot;home&quot; of &quot;small business&quot; license will suffice. Ask for the price for developers, so that any trace of third party will not be in your worksheet. Read carefully agreements, EULA etc."}], "tags": [], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "is_accepted": false, "score": 1, "last_activity_date": 1476294943, "creation_date": 1476294943, "answer_id": 40005269, "question_id": 39878276, "link": "https://stackoverflow.com/questions/39878276/secure-excel-workbook-with-vba-from-reuse-with-different-data/40005269#40005269", "title": "Secure Excel Workbook (with VBA) from reuse with different data", "body": "<p>Compile Excel file to EXE. Google for that. </p>\n"}, {"comments": [{"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1476483252, "post_id": 40050384, "comment_id": 67381527, "body": "1st I&#39;m not going to time expire my workbook. Still I chose this as the answer because of the TYPE of approach. I think to solve the issue, it will require the use of the two elements in this solution: 1. the dependency on a compiled file (assembly, dll, etc.).  2. a way to communicate the uniqueness of the workbook. --- I&#39;ll have to think of the best way to incorporate the two, but whatever I do, the next person with the issue will have to figure out their own individualized implementation of these two elements.   Thank you sir!"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 1, "last_activity_date": 1476471985, "creation_date": 1476471985, "answer_id": 40050384, "question_id": 39878276, "link": "https://stackoverflow.com/questions/39878276/secure-excel-workbook-with-vba-from-reuse-with-different-data/40050384#40050384", "title": "Secure Excel Workbook (with VBA) from reuse with different data", "body": "<p><strong>Perhaps Time-expire the functionality in your code</strong></p>\n\n<p>So thank you for this question.  Thank you for setting a bounty.  It is a very interesting question given your desire to monetise the VBA code, as a VBA programmer I generally resign myself to not being able to monetise VBA code.  It is good that you insist and I will contribute an attempt at an answer.</p>\n\n<p>Firstly, let me join the chorus of answers that say VBA is easily hacked.  The password protection can be broken.  I would join the chorus of respondents who say you should pick a compiled language as the vessel for your code.  Why not try C# or VB.NET housed in a Visual Studio Tools For Office (VSTO) .NET assembly?  </p>\n\n<p>VSTO will associate a compiled assembly with a workbook.  This mechanism is worth knowing because if you insist on VBA we can use the same mechanism (see later).  Each workbook has a CustomDocumentProperties collection where one can set custom properties (it says Document not Spreadsheet because the same can be found in Word so Document is the generalised case).</p>\n\n<p>Excel will look at the workbook's CustomDocumentProperties collection and search for \"_AssemblyName\" and \"_AssemblyLocation\"; if _AssemblyName is an asterisk then it knows it needs to load a .NET/VSTO assembly, the _AssemblyLocation provides a lookup to the file to load (you'll have to dig in on this, I forget the details).    <a href=\"https://books.google.co.uk/books?id=9qtENHmR6OwC&amp;pg=SA2-PA97&amp;lpg=SA2-PA97&amp;dq=vsto%20documentproperties&amp;source=bl&amp;ots=puYQTftNYB&amp;sig=HYeOV1v6U45uq7_7ZHpdGQ_oh5I&amp;hl=en&amp;sa=X&amp;ved=0ahUKEwjAlMGd-9rPAhXpJ8AKHcPfDuw4ChDoAQghMAI#v=onepage&amp;q=vsto%20documentproperties&amp;f=false\" rel=\"nofollow\">Reference</a></p>\n\n<p>Anyway, I'm reminded of VSTO CustomDocumentProperties mechanism because if you insist on using VBA then I suggest storing a value in the CustomDocumentProperties collection that helps you time expire the functionality of your code.  Note do not use the BuiltInDocumentProperties(\"Creation Date\") because it is easily identifiable; instead use a codeword, say \"BlackHawk\".  Here is some sample code.</p>\n\n<pre><code>Sub WriteProperty()\n\n    ThisWorkbook.BuiltinDocumentProperties(\"Creation Date\") = CDate(\"13/10/2016 19:15:22\")\n\n\n    If IsEmpty(CustomDocumentPropertiesItemOERN(ThisWorkbook, \"BlackHawk\")) Then\n        Call ThisWorkbook.CustomDocumentProperties.Add(\"BlackHawk\", False, MsoDocProperties.msoPropertyTypeDate, Now())\n    End If\n\n\nEnd Sub\n\nFunction CustomDocumentPropertiesItemOERN(ByVal wb As Excel.Workbook, ByVal vKey As Variant)\n    On Error Resume Next\n    CustomDocumentPropertiesItemOERN = wb.CustomDocumentProperties.Item(vKey)\nEnd Function\n\n\nSub ReadProperty()\n\n    Debug.Print \"ThisWorkbook.BuiltinDocumentProperties(\"\"Creation Date\"\"):=\" &amp; ThisWorkbook.BuiltinDocumentProperties(\"Creation Date\")\n    Debug.Print \"CustomDocumentPropertiesItemOERN(ThisWorkbook, \"\"BlackHawk\"\"):=\" &amp; CustomDocumentPropertiesItemOERN(ThisWorkbook, \"BlackHawk\")\n\nEnd Sub\n</code></pre>\n\n<p>So you could set CustomDocumentProperty \"BlackHawk\" to the workbook's initial creation time and then allow the client to use the code for 24 hours, or even 48 hours (careful with weekends, create Friday work through to Tuesday) and then afterwards the code can refuse to operate and instead throw a message saying pay LimaNightHawk more money!</p>\n\n<p>P.S.  Good luck with your revenue model.</p>\n\n<p>P.P.S. I read your profile, thanks for your military service.</p>\n"}], "owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 1, "accepted_answer_id": 40050384, "answer_count": 7, "score": 6, "last_activity_date": 1476471985, "creation_date": 1475681791, "last_edit_date": 1475841458, "question_id": 39878276, "link": "https://stackoverflow.com/questions/39878276/secure-excel-workbook-with-vba-from-reuse-with-different-data", "title": "Secure Excel Workbook (with VBA) from reuse with different data", "body": "<p>I have created an Excel Workbook with a lot of VBA code for a customer.  The customer will provide me with data. I will import that data into the VBA laden template, Save it as an xlsm, and deliver it to the customer. I get paid by the Workbook so I need to prevent them from trying to copy new data into the existing workbook and reusing it.</p>\n\n<p><strong>How can I <em>somehow</em> prevent the customer from reusing a workbook by just entering in new data on the main Worksheet, then saving as a new Workbook</strong>, and getting the use of the VBA code for free. (Alternately they could copy the file in windows then enter new data on the copied version.) <strong>I need to detect a <em>significant</em> change in data from the initial imported data.</strong></p>\n\n<p>The data on the main sheet is fairly static (perhaps even totally static on many known columns). I'm thinking about randomly sampling some of the cell data on import (perhaps 10 random cells, or number of rows, etc.), and storing that data <em>somewhere</em>. If, say, 50% of the cells change data, I could just disable (or short-circuit) the public entry points in the code...or something else?</p>\n\n<p>I'd like to allow for <em>some</em> flexibility on the part of the customer, but prevent abuse.</p>\n\n<ul>\n<li>Is there a better way than my general idea, above? </li>\n<li>Where could I store that data (it should be part of the sheet, but not changeable by the customer). Perhaps a hidden sheet with password locked cells?</li>\n<li>Is there some accepted way of doing this that I'm unaware of?</li>\n</ul>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1475681827, "post_id": 39878216, "comment_id": 67043147, "body": "<code>sqrt</code> should be <code>Sqr</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1475683299, "post_id": 39878216, "comment_id": 67044116, "body": "It seems you are confusing the C++ <a href=\"https://msdn.microsoft.com/en-us/library/f1xa99e6.aspx\" rel=\"nofollow noreferrer\">sqrt</a> function with VBA&#39;s <a href=\"https://msdn.microsoft.com/en-us/library/aa263367.aspx\" rel=\"nofollow noreferrer\">sqr</a> function."}, {"owner": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "edited": false, "score": 0, "creation_date": 1475683644, "post_id": 39878216, "comment_id": 67044336, "body": "Public sub Uzd(x as Integer) as Integer If x = 1 Or x = 2 Then Uzd = (2 * x + 3) / sqrt(x ^ 2 + 3 * x + 2) Else  msgbox &quot;Incorrect data&quot; End If End sub"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "edited": false, "score": 1, "creation_date": 1475684208, "post_id": 39878216, "comment_id": 67044694, "body": "@Ary a <code>Sub</code> procedure can&#39;t return a value, so it can&#39;t be <code>As Integer</code>. Also you&#39;re still using the non-existing <code>sqrt</code> function which is OP&#39;s exact problem here, and you&#39;re introducing presentation concerns by making OP&#39;s function bring up a <code>MsgBox</code>, which makes the function impossible to write unit tests for."}, {"owner": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "edited": false, "score": 0, "creation_date": 1475684404, "post_id": 39878216, "comment_id": 67044813, "body": "Sorry, I could not edit my comment."}, {"owner": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "edited": false, "score": 0, "creation_date": 1475684575, "post_id": 39878216, "comment_id": 67044935, "body": "But OP function returns both integer and a String according to his condition, while the function is defined as a string function... An error should be occurred, shouldn&#39;t it?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "edited": false, "score": 0, "creation_date": 1475684967, "post_id": 39878216, "comment_id": 67045211, "body": "@Ary no. The numeric result will be implicitly converted to a <code>String</code>. Parameter <code>x</code> is also implicitly declared as a <code>Variant</code> and should be an explicit <code>Integer</code> or <code>Long</code>, and the function should be raising a runtime error about the invalid parameter instead of returning a magic string and requiring the caller to verify every result against the <code>&quot;Incorrect data&quot;</code> string literal."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1475683782, "creation_date": 1475683782, "answer_id": 39878967, "question_id": 39878216, "link": "https://stackoverflow.com/questions/39878216/vba-square-equalities-sub-or-function-not-defined/39878967#39878967", "title": "(VBA) Square equalities - Sub or function not defined", "body": "<p>The function you're trying to use is located in the <code>VBA</code> type library, in the <code>Math</code> module:</p>\n\n<p><img src=\"https://i.stack.imgur.com/9tLKA.png\" alt=\"Object Browser\"></p>\n\n<p>You can avoid such typos by using IntelliSense and fully-qualifying the global-scope functions you use:</p>\n\n<pre><code>Uzd = (2 * x + 3) / Math.Sqr(x ^ 2 + 3 * x + 2)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/YHIRY.png\" alt=\"IntelliSense\"></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6927303"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475683805, "creation_date": 1475681639, "last_edit_date": 1475683805, "question_id": 39878216, "link": "https://stackoverflow.com/questions/39878216/vba-square-equalities-sub-or-function-not-defined", "title": "(VBA) Square equalities - Sub or function not defined", "body": "<p>I'm facing some problems with my exercise test in uni, but after editing some code it seems like something is wrong there.</p>\n\n<pre><code>Public Function Uzd(x) As String\n    If x = 1 Or x = 2 Then\n        Uzd = (2 * x + 3) / sqrt(x ^ 2 + 3 * x + 2)\n    Else\n        Uzd = \"Incorrect data\"\n    End If\n\nEnd Function\n</code></pre>\n\n<p>After running code I get - Sub or function not defined</p>\n"}, {"tags": ["excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475681835, "post_id": 39877813, "comment_id": 67043153, "body": "Are you sure you don&#39;t need <code>ie.Document.getElementsByTagName(&quot;input&quot;)(6)</code>?  I believe this is the &quot;Search&quot; button next to the address input field (verified against the .OuterHTML). The same problem persists, but let&#39;s make sure you&#39;re getting a handle on the correct button..."}, {"owner": {"reputation": 23, "user_id": 6927161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4a8817ee654c3dc104e64b28650716?s=128&d=identicon&r=PG&f=1", "display_name": "CJones", "link": "https://stackoverflow.com/users/6927161/cjones"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475848600, "post_id": 39877813, "comment_id": 67121798, "body": "Thanks! You are right. I Was working on a similar thing with a different site and found that the Input tag was not the number I was expecting and went back and found that Input 6 worked as well. Thanks for your help."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6927161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4a8817ee654c3dc104e64b28650716?s=128&d=identicon&r=PG&f=1", "display_name": "CJones", "link": "https://stackoverflow.com/users/6927161/cjones"}, "edited": false, "score": 0, "creation_date": 1475848934, "post_id": 39878421, "comment_id": 67122037, "body": "Thanks David. I had the incorrect handle for the input button i wanted to click so I was able to solve it by getting the correct number. This code appears to work as well. Thanks for your help."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1475683156, "last_edit_date": 1495542898, "creation_date": 1475682190, "answer_id": 39878421, "question_id": 39877813, "link": "https://stackoverflow.com/questions/39877813/excel-vb-macro-to-scrape-webpage-cant-code-to-click-html-button/39878421#39878421", "title": "Excel VB Macro to scrape webpage. Can&#39;t code to click html button", "body": "<p>Try this solution, which I found from <a href=\"https://stackoverflow.com/a/4631447/1467082\">this answer</a> to a <a href=\"https://stackoverflow.com/questions/3247391/click-button-or-execute-javascript-function-with-vba\">similar question</a>. That answer was not accepted, but I have tested this with your code and seems to be working.</p>\n\n<pre><code>Private Sub SiteData()\n\nDim ie As Object\nDim utility As Variant\nDim HTMLButton\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Navigate \"http://www.puco.ohio.gov/pucogis/address/search.cfm\"\nie.Visible = True\n\nWhile ie.Busy\nDoEvents\nWend\n\nie.Document.all(\"address\").Value = ThisWorkbook.Sheets(\"Site Info\").Range(\"D14\")\n\nWhile ie.Busy\nDoEvents\nWend\n\nCall ie.Document.parentWindow.execScript(\"codeAddress()\")\n\n\nWhile ie.Busy\nDoEvents\nWend\n\nSet utility = ie.Document.getElementById(\"supName\")\nThisWorkbook.Sheets(\"Site Info\").Range(\"D50\") = utility.innerText\n\nie.Quit\nSet ie = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>If you don't know or can't reasonably anticipate the function call <code>codeAddress()</code>, then you can try something like this to derive it from the button's <code>onclick</code> property:</p>\n\n<pre><code>Dim fn$\nfn = HTMLButton.onclick\nfn = Mid(fn, InStr(fn, \"{\"))\nfn = Trim(Replace(Replace(Replace(fn, \"{\", vbNullString), \"}\", vbNullString), vbLf, vbNullString))\nCall ie.Document.parentWindow.execScript(fn)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475683190, "post_id": 39878737, "comment_id": 67044047, "body": "This would appear to be a duplicate solution to the answer I posted 15 minutes ago..."}, {"owner": {"reputation": 1, "user_id": 2163008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LF102.png?s=128&g=1", "display_name": "user2163008", "link": "https://stackoverflow.com/users/2163008/user2163008"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475776619, "post_id": 39878737, "comment_id": 67090730, "body": "yes I saw the issue and while preparing solution you posted yours then I posted before seeing that you already posted  sorry for that duplication."}], "tags": [], "owner": {"reputation": 1, "user_id": 2163008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LF102.png?s=128&g=1", "display_name": "user2163008", "link": "https://stackoverflow.com/users/2163008/user2163008"}, "is_accepted": false, "score": 0, "last_activity_date": 1475683119, "last_edit_date": 1495535648, "creation_date": 1475683119, "answer_id": 39878737, "question_id": 39877813, "link": "https://stackoverflow.com/questions/39877813/excel-vb-macro-to-scrape-webpage-cant-code-to-click-html-button/39878737#39878737", "title": "Excel VB Macro to scrape webpage. Can&#39;t code to click html button", "body": "<p>You can call the JavaScript directly. try this it will work</p>\n\n<p><strong>Instead of:</strong></p>\n\n<p>Set HTMLButton = ie.Document.getElementsByTagName(\"input\")(2)</p>\n\n<p>HTMLButton.Click</p>\n\n<p><strong>use</strong> </p>\n\n<p>ie.Document.parentWindow.execScript code:=\"codeAddress()\"</p>\n\n<ul>\n<li>note that IE may prompt you to confirm every run so you may need to\nstop showing this message for smooth operation</li>\n</ul>\n\n<hr>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\nDim ie As Object\nDim utility As Variant\nDim HTMLButton\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Navigate \"http://www.puco.ohio.gov/pucogis/address/search.cfm\"\nie.Visible = True\n\nWhile ie.Busy\nDoEvents\nWend\n\nie.Document.all(\"address\").Value = ThisWorkbook.Sheets(\"Site Info\").Range(\"D14\")\n\nWhile ie.Busy\nDoEvents\nWend\n\nie.Document.parentWindow.execScript code:=\"codeAddress()\"\n'Set HTMLButton = ie.Document.getElementsByTagName(\"input\")(2)\n'HTMLButton.Click\n\nWhile ie.Busy\nDoEvents\nWend\n\nSet utility = ie.Document.getElementById(\"supName\")\nThisWorkbook.Sheets(\"Site Info\").Range(\"D16\") = utility.innerText\n\nie.Quit\nSet ie = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>thanks also to this article helped me to solve your problem\n<a href=\"https://stackoverflow.com/questions/31521205/how-to-find-and-call-javascript-method-from-vba\">How to find and call javascript method from vba</a></p>\n"}], "owner": {"reputation": 23, "user_id": 6927161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4a8817ee654c3dc104e64b28650716?s=128&d=identicon&r=PG&f=1", "display_name": "CJones", "link": "https://stackoverflow.com/users/6927161/cjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 39878421, "answer_count": 2, "score": 2, "last_activity_date": 1475683156, "creation_date": 1475680474, "last_edit_date": 1531164843, "question_id": 39877813, "link": "https://stackoverflow.com/questions/39877813/excel-vb-macro-to-scrape-webpage-cant-code-to-click-html-button", "title": "Excel VB Macro to scrape webpage. Can&#39;t code to click html button", "body": "<p>I have a short excel macro that is designed to:\n1) Open Internet Explorer and navigate to \"<a href=\"http://www.puco.ohio.gov/pucogis/address/search.cfm\" rel=\"nofollow\">http://www.puco.ohio.gov/pucogis/address/search.cfm</a>\"\n2) Fill out a form on that site with data from the excel workbook\n3) Click a button to submit the form\n4) Scrape some innertext from the website and place it in a cell in the workbook\n5) Close Internet Explorer</p>\n\n<p>I can not get step 3 to work. That is, I can not get the click/submit function to work with this website. When the button is clicked the website populates with information specific to the information entered in the form. Everything else in the code is working. I have searched for an answer and tried the submit verses click approach with no luck.</p>\n\n<p>Thanks for you help.</p>\n\n<p>Code below:</p>\n\n<pre><code>Private Sub SiteData()\n\nDim ie As Object\nDim utility As Variant\nDim HTMLButton\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Navigate \"http://www.puco.ohio.gov/pucogis/address/search.cfm\"\nie.Visible = True\n\nWhile ie.Busy\nDoEvents\nWend\n\nie.Document.all(\"address\").Value = ThisWorkbook.Sheets(\"Site Info\").Range(\"D14\")\n\nWhile ie.Busy\nDoEvents\nWend\n\nSet HTMLButton = ie.Document.getElementsByTagName(\"input\")(1)\nHTMLButton.Click\n\nWhile ie.Busy\nDoEvents\nWend\n\nSet utility = ie.Document.getElementById(\"supName\")\nThisWorkbook.Sheets(\"Site Info\").Range(\"D50\") = utility.innerText\n\nie.Quit\nSet ie = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1475680028, "post_id": 39877615, "comment_id": 67041975, "body": "what value do you get for <code>N_Values</code> ? debug it in F8 mode, Or use last row in this method <code>N_Values = Cells(Rows.Count, &quot;B&quot;).End(xlUp).Row</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1475680169, "post_id": 39877615, "comment_id": 67042087, "body": "What second if statement? Do you mean the second loop? That won&#39;t run until you dismiss somewhere between 0 and N_Values - 6 message boxes."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1475680779, "post_id": 39877615, "comment_id": 67042476, "body": "As above; you are looping from row 6 to N_Values first for column 2, then doing it again for column 3.  It will complete all of one before it does the other.  Put both <code>IF</code> statements inside the first loop and delete the second one..."}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 5412162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb30c00ff0ecf1a3409f8b1a03ff2c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Vroenguard", "link": "https://stackoverflow.com/users/5412162/vroenguard"}, "is_accepted": true, "score": 1, "last_activity_date": 1475680825, "creation_date": 1475680825, "answer_id": 39877941, "question_id": 39877615, "link": "https://stackoverflow.com/questions/39877615/vba-stuck-in-a-loop-and-not-moving-on-to-next-command/39877941#39877941", "title": "vba stuck in a loop and not moving on to next command", "body": "<p>You declare the string :</p>\n\n<pre><code>Dim IntermediateString As String\n</code></pre>\n\n<p>Then you affect a value to it (by the way, the .Value is optional, cells(x, y) and cells(x, y).Value are the same) :</p>\n\n<pre><code>IntermediateString = Cells(i, 2).Value\n</code></pre>\n\n<p>But then you don't do anything with this string, so I'm pretty sure that's not what you intended to do (you could comment both of those line, your program would run the same way).</p>\n\n<p>Also, seeing as your program is coded, you should have at most as much messages \"The Range of Cells Has Already Been Formated as Percentage\" as the number of lines in the B column, but it should eventually keep going to reach second if statement.</p>\n\n<p>I suggest you open the execution window (Ctrl + G), and replace the occurences of \"MsgBox\" in your code by Debug.Print. You will see the message in the execution window, but it won't pause the execution of the program (much better way to debug)</p>\n"}], "owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 39877941, "answer_count": 1, "score": 0, "last_activity_date": 1475680825, "creation_date": 1475679896, "question_id": 39877615, "link": "https://stackoverflow.com/questions/39877615/vba-stuck-in-a-loop-and-not-moving-on-to-next-command", "title": "vba stuck in a loop and not moving on to next command", "body": "<p>i have written the following code:</p>\n\n<pre><code>Public Sub SortMyData()\n\n'approach: convert line to string and concatenate to that as it's a lot less picky than Excel's formats, then replace cell value with the new string.\n'          Excel will then define the string type as either Percentage or Scientific depending on the magnitude.\nDim i As Integer\nDim g As Integer\nDim N_Values As Integer\nDim IntermediateString As String\n\nN_Values = Cells(1048576, 2).End(xlUp).Row 'retrieves the final filled row in column 2 (B)\n\nFor i = 6 To N_Values 'iteration loop from 6 (first row of value) to N_Values (last filled row)\n\n    If Cells(i, 2).NumberFormat &lt;&gt; \"0.0%\" Then\n        IntermediateString = Cells(i, 2).Value\n        Cells(i, 2).NumberFormat = \"0.0%\"\n        Cells(i, 2).Value = Cells(i, 2).Value / 100\n    Else\n        MsgBox (\"The Range of Cells Has Already Been Formated as Percentage\")\n    End If\nNext i\n\nFor g = 6 To N_Values 'iteration loop from 6 (first row of value) to N_Values (last filled row)\n    If Len(Cells(g, 3) &gt; 3) Then\n        Cells(g, 3).Value = Cells(g, 3).Value / 1000\n    Else\n        MsgBox (\"Data is correct so no action will be taken\")\n    End If\nNext g\nEnd Sub\n</code></pre>\n\n<p>the code runs fine but it does not move onto the secont if statement, it just keeps on running the first one and displaying the MsgBox (\"The Range of Cells Has Already Been Formated as Percentage\") so i dont know where i have made a mistake?\ni am a rookie by the way so go easy on me!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475679831, "post_id": 39877435, "comment_id": 67041819, "body": "Does any part of the code actually do a <code>.Save</code> or <code>.SaveAs</code>? When you catch the open SaveAs dialog, can you break &amp; enter debug to see what line is causing this?"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475685832, "post_id": 39877435, "comment_id": 67045764, "body": "What error handling is there to catch the intermittent problem?"}, {"owner": {"reputation": 1, "user_id": 6927068, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n332xgOxfnQ/AAAAAAAAAAI/AAAAAAAAAAA/R71Efw530rc/photo.jpg?sz=128", "display_name": "Ronald Fitzpatrick", "link": "https://stackoverflow.com/users/6927068/ronald-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1475778437, "post_id": 39877435, "comment_id": 67091748, "body": "It&#39;s an automated process.  Any error handling is set up to send me an email with whatever error code has been encountered then to quit the application.    When this happens no error is generated. At least no email is sent.  As far as breaking, it just stops the code completely.  If there are routines I could add to try and catch it, I&#39;d be happy to start there."}, {"owner": {"reputation": 1, "user_id": 6927068, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n332xgOxfnQ/AAAAAAAAAAI/AAAAAAAAAAA/R71Efw530rc/photo.jpg?sz=128", "display_name": "Ronald Fitzpatrick", "link": "https://stackoverflow.com/users/6927068/ronald-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1475778710, "post_id": 39877435, "comment_id": 67091907, "body": "To more directly answer the &#39;is there a <code>.Save</code> or <code>.SaveAs</code>, yes.  There are both. I can&#39;t swear which it&#39;s hanging at.  The process starts with the .csv, then saves it as an .xlsx, does some trimming and calculating, then saves it as a different name to reflect the processed version vs. the raw form."}, {"owner": {"reputation": 1, "user_id": 6927068, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n332xgOxfnQ/AAAAAAAAAAI/AAAAAAAAAAA/R71Efw530rc/photo.jpg?sz=128", "display_name": "Ronald Fitzpatrick", "link": "https://stackoverflow.com/users/6927068/ronald-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1476116583, "post_id": 39877435, "comment_id": 67205027, "body": "I was able to catch it today.  It won&#39;t actually break when pressing Ctrl-C.  I just have the window:  <b>Saving</b>  <i>Saving as: &#39;filepath and name.xlsx&#39;</i>  When I click cancel it goes on as if no error has occurred.  At this point I&#39;m not convinced it&#39;s an error at all.  At least not in the normal sense.  Has anyone experienced something like this where a lag or temporary connection failure with a network drive might cause similar symptoms?  My next step is to start trying to save to a local drive and see if the problem persists."}, {"owner": {"reputation": 1, "user_id": 6927068, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n332xgOxfnQ/AAAAAAAAAAI/AAAAAAAAAAA/R71Efw530rc/photo.jpg?sz=128", "display_name": "Ronald Fitzpatrick", "link": "https://stackoverflow.com/users/6927068/ronald-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1476361456, "post_id": 39877435, "comment_id": 67318474, "body": "OK, final (I hope) follow up.  I re-coded the routine to save everything locally to the hard drive then moved the files to the network via the <code>.FileSystemObject</code> method and, I&#39;m GUESSING, since there&#39;s no msgbox to pop up and hang on it&#39;s worked flawlessly."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10682645, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6222ea96e4058edcdc14000ca4cded78?s=128&d=identicon&r=PG", "display_name": "John Morrill", "link": "https://stackoverflow.com/users/10682645/john-morrill"}, "is_accepted": false, "score": 2, "last_activity_date": 1542750589, "creation_date": 1542750589, "answer_id": 53402108, "question_id": 39877435, "link": "https://stackoverflow.com/questions/39877435/excel-2010-2013-intermittently-pauses-when-saving-workbooks-via-vba/53402108#53402108", "title": "Excel 2010/2013 intermittently pauses when saving workbooks via VBA", "body": "<p>I solved this problem by adding calls to DoEvents before and after the .SAVEAS or .SAVE calls.  It's just two days, but this seems to have taken a process that I run daily multiple times a day (that creates multiple workbooks to a shared drive and never got through a day without this bug happening) to being a perfectly hands off process.</p>\n"}], "owner": {"reputation": 1, "user_id": 6927068, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n332xgOxfnQ/AAAAAAAAAAI/AAAAAAAAAAA/R71Efw530rc/photo.jpg?sz=128", "display_name": "Ronald Fitzpatrick", "link": "https://stackoverflow.com/users/6927068/ronald-fitzpatrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542750589, "creation_date": 1475679491, "last_edit_date": 1531164843, "question_id": 39877435, "link": "https://stackoverflow.com/questions/39877435/excel-2010-2013-intermittently-pauses-when-saving-workbooks-via-vba", "title": "Excel 2010/2013 intermittently pauses when saving workbooks via VBA", "body": "<p>I've had an intermittent problem for the last couple years and it's finally gotten to the point where I really need to try tracking down a solution.</p>\n\n<p>I'm running a VBA script that takes various csv files that are spit out over the course of the day and chops them up for use in various other processes. </p>\n\n<p>Every 20 minutes it opens a workbook with a 'Workbook_Open' block that does the work. When it finishes the job it closes the Excel application. It does this all day, every day.</p>\n\n<p>MOST of the time this goes off without a hitch. OCCASIONALLY, it will hang up as it's trying to save a workbook.  What I see when I catch it is the \"Save as\" box with the file path/name and the cancel button.  It just waits there until someone clicks \"Cancel\" or the system fails from trying to open Excel too many times.</p>\n\n<p>If I catch it and click the button then it will proceed on as if nothing abnormal had happened.  Otherwise it just waits there for the user to click the button, as if it were any other msgbox/inputbox.</p>\n\n<p>The weird thing is that the file is saved regardless of whether or not I click \"Cancel\" or kill the application or whatever.  There doesn't seem to be any pattern to when it happens.</p>\n\n<p>I've tried searching for similar issues but all my searches inevitably come up with results relating to system/application crashes. This isn't that.  Excel will continue as normal, even to the point of continuing to save files in the way it SHOULD behave, if I click cancel.</p>\n\n<p>Help?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1475678649, "post_id": 39877066, "comment_id": 67040802, "body": "You&#39;re using xlPasteAll one time but xlPasteValuesAndNumberFormats the other times. Perhaps that&#39;s why?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1475679005, "post_id": 39877066, "comment_id": 67041125, "body": "Why are you starting a new Excel session at each iteration? You can stick to your current Excel session and use WorkBooks.Open() to open new workbooks and then close them with Close() method once you are done."}, {"owner": {"reputation": 59, "user_id": 4954131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/666c06627ed4c59282cd097024efb7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/4954131/francis"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475682164, "post_id": 39877066, "comment_id": 67043371, "body": "@Comintern, see edited post with picture."}, {"owner": {"reputation": 59, "user_id": 4954131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/666c06627ed4c59282cd097024efb7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/4954131/francis"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1475682210, "post_id": 39877066, "comment_id": 67043396, "body": "@user3598756, different files are created and exported. Hence the individual sessions."}, {"owner": {"reputation": 59, "user_id": 4954131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/666c06627ed4c59282cd097024efb7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/4954131/francis"}, "reply_to_user": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1475682221, "post_id": 39877066, "comment_id": 67043407, "body": "@Jbjstam, I&#39;ll try and test that."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1475916729, "post_id": 39877066, "comment_id": 67143601, "body": "@Francis, you can open, create and export different files staying in the same Excel session. Opening more Excel sessions will slow down the code. Furthermore at the end you are left with all of them open and you must eventually close them."}], "owner": {"reputation": 59, "user_id": 4954131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/666c06627ed4c59282cd097024efb7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/4954131/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475682145, "creation_date": 1475678541, "last_edit_date": 1475682145, "question_id": 39877066, "link": "https://stackoverflow.com/questions/39877066/vba-pasting-row-as-image", "title": "VBA pasting row as image", "body": "<p><a href=\"https://i.stack.imgur.com/C51ao.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C51ao.png\" alt=\"enter image description here\"></a>Just have a quick question regarding paste. I have a script that exports individual rows into a newly created workbook. However, the problem is that the pasted values are in the form of image. Additionally, the comments are skipped. I used the same code for pasting into other sheets of the same workbook, and there is no issue.</p>\n\n<p>I can't seem to find the reason why. Any help would be greatly appreciated.</p>\n\n<p>Thanks</p>\n\n<pre><code>Private Sub DC_1Month_Button_Click()\n'Searches for crews working on MFDC (7343) and exports a new spreadsheet looking 3 weeks ahead for each person\n\nIf MsgBox(\"Export DC individual schedules?\") = vbNo Then\n    Exit Sub\nEnd If\n\nOn Error GoTo CleanFail\n\nDim nowCol As Integer, lastCol As Integer, endCol As Integer, crewRow As Integer\nDim masterSheet As Worksheet, newExcel As Object, newBook As Workbook, newSheet As Worksheet\nDim startRow As Integer, endRow As Integer\nDim currentName As String, currentProject As String\n\nstartRow = 3\nendRow = UsedRange.Row - 1 + UsedRange.Rows.count\nlastcoln = UsedRange.Column - 1 + UsedRange.Columns.count\nSet masterSheet = ThisWorkbook.Worksheets(\"Master Schedule\")\n\n'Find columns for today and date 3 weeks after\nnowCol = Range(Cells(2, 1), Cells(2, lastcoln)).Find(what:=Month(Date) &amp; \"/\" &amp; Day(Date) &amp; \"/\" &amp; Year(Date)).Column\nendCol = Range(Cells(2, 1), Cells(2, lastcoln)).Find(what:=Month(DateAdd(\"d\", 30, Date)) &amp; \"/\" &amp; Day(DateAdd(\"d\", 30, Date)) &amp; \"/\" &amp; Year(DateAdd(\"d\", 30, Date))).Column\n\n'Disable screen flashing while doing copying and exports\nApplication.ScreenUpdating = False\n\n'Loop through crew members\nFor i = 3 To endRow\n    'Store current row's values\n    currentName = Replace(ActiveSheet.Cells(i, 2).Value, \"SA: \", \"\")\n    currentProject = ActiveSheet.Cells(i, 3).Value\n\n    'Search the value from the Project column for the MFDC project number\n    If InStr(1, currentProject, \"7343\") &gt; 0 Then\n\n    'Load schedule template\n    Set newExcel = CreateObject(\"Excel.Application\")\n    newExcel.DisplayAlerts = False\n    newExcel.Workbooks.Open \"\\\\VALGEOFS01\\SurveyProjectManagers\\304Schedule\\Templates\\DC_3Week_Template.xlsx\"\n    Set newBook = newExcel.Workbooks(1)\n    Set newSheet = newBook.Worksheets(1)\n\n    'Copy and paste header rows\n    masterSheet.Range(masterSheet.Cells(1, nowCol), masterSheet.Cells(2, endCol)).Copy 'Destination:=newSheet.Range(\"A1\")\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n    newSheet.Range(newSheet.Cells(1, 6), newSheet.Cells(1, endCol - 1)).PasteSpecial xlPasteValuesAndNumberFormats\n    Application.CutCopyMode = False\n\n    'Copy and paste crew member's location\n    masterSheet.Range(masterSheet.Cells(i, 2), masterSheet.Cells(i, 6)).Copy 'Destination:=newSheet.Range(\"A3\")\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n    newSheet.Range(\"A3\").PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n    Application.CutCopyMode = False\n\n    'Copy schedule data for crew member\n    masterSheet.Range(masterSheet.Cells(i, nowCol), masterSheet.Cells(i, endCol)).Copy\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n    newSheet.Cells(3, 6).PasteSpecial Paste:=xlPasteAll\n    Application.CutCopyMode = False\n\n    'Save individual's schedule\n    With newBook\n        .Title = currentName &amp; \" MFDC Schedule\"\n        .SaveAs Filename:=\"\\\\VALGEOFS01\\SurveyProjectManagers\\304Schedule\\MFDC Individual Schedules\\\" &amp; currentName &amp; \" MFDC Schedule \" &amp; Format(Date, \"yymmdd\") &amp; \".xlsx\", AccessMode:=xlExclusive, ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges\n        .Close (True)\n    End With\n\n    End If\nNext i\n\nCleanExit:\n    MsgBox \"Export complete\"\n    'Restore normal screen updating\n    Application.ScreenUpdating = True\n    Exit Sub\n\nCleanFail:\n\n    If Err.Number &lt;&gt; 0 Then\n        Msg = \"Error # \" &amp; Str(Err.Number) &amp; \" was generated by \" &amp; Err.Source &amp; Chr(13) &amp; Err.Description\n        MsgBox Msg, , \"Error\", Err.HelpFile, Err.HelpContext\n    End If\n    Resume CleanExit\n    Resume\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7066, "user_id": 1856015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MnsaK.png?s=128&g=1", "display_name": "Adrian Wragg", "link": "https://stackoverflow.com/users/1856015/adrian-wragg"}, "edited": false, "score": 2, "creation_date": 1475678161, "post_id": 39876874, "comment_id": 67040398, "body": "If in doubt, go for yyyy-MM-dd."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1475678258, "post_id": 39876874, "comment_id": 67040464, "body": "Provide dates as dates, not strings."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1475678533, "post_id": 39876874, "comment_id": 67040707, "body": "@ Adrian - Thanks, good idea"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1475678550, "post_id": 39876874, "comment_id": 67040724, "body": "@ Comintern - They are dates"}], "answers": [{"comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1475678845, "post_id": 39877059, "comment_id": 67040997, "body": "Thanks for the answer. Sure, I get that, but what if the (dd/mm/yyy) date is something like 01/02/2016? With my regional settings that&#39;s what DateSerial(2016, 2, 1) will return. If in the US would it return 02/01/2016? The MSDN page for DateSerial is not specific about this."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 2, "creation_date": 1475679017, "post_id": 39877059, "comment_id": 67041138, "body": "@Absinthe the <i>format</i> is a <b>representation</b> of the <code>Date</code> value; it is NOT the value itself. As long as you have <code>Date</code> values <code>As Date</code>, you don&#39;t have to worry about its representation."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 2, "creation_date": 1475679033, "post_id": 39877059, "comment_id": 67041151, "body": "@Absinthe - <code>DateSerial</code> has nothing to do with regional settings. It takes specific year, month, day arguments."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1475679351, "post_id": 39877059, "comment_id": 67041441, "body": "The MSDN page for DateSerial is very specific about this; the three parameters determine the resulting date value."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 5, "last_activity_date": 1475678534, "creation_date": 1475678534, "answer_id": 39877059, "question_id": 39876874, "link": "https://stackoverflow.com/questions/39876874/regional-date-format-when-updating-recordset-in-vba/39877059#39877059", "title": "Regional date format when updating recordset in VBA", "body": "<p>You won't provide a format but a <em>value</em>. Formats are for display only.</p>\n\n<pre><code>Dim Date1 As Date\n\n' Set Date1 to some value.\nDate1 = DateSerial(2016, 10, 15)\n\nrs!YourDateField.Value = Date1\n</code></pre>\n"}], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 39877059, "answer_count": 1, "score": 0, "last_activity_date": 1475678534, "creation_date": 1475678082, "question_id": 39876874, "link": "https://stackoverflow.com/questions/39876874/regional-date-format-when-updating-recordset-in-vba", "title": "Regional date format when updating recordset in VBA", "body": "<p>I'm based in the UK and am developing an Access 2016 DB for a client in the US.</p>\n\n<p>I need to update some dates in a table programmatically and I've done so by  editing a RecordSet.</p>\n\n<p>My question is this: If I provide the dates in UK format (dd/mm/yyyy) will the database store it as US format (mm/dd/yyyy) on my clients computers? </p>\n\n<p>I've no way to test this without changing my regional settings in Windows which I'm not keen to do.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "ms-access", "odbc", "ms-access-2007"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1475683870, "post_id": 39876732, "comment_id": 67044483, "body": "<i>&quot;I tried to remove the dbDenyWrite but the problem isn&#39;t solved.&quot;</i> - what does that mean exactly? The same error is shown? Or another problem arises? -- You don&#39;t edit an existing record, so I don&#39;t see why you would need <code>dbDenyWrite</code> at all."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1475694232, "post_id": 39876732, "comment_id": 67050463, "body": "Just use mydb.openrecordset(req) does it still give you error?"}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1475699339, "post_id": 39876732, "comment_id": 67053248, "body": "try adding the <code>dbSeeChanges</code> switch, see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820966.aspx\" rel=\"nofollow noreferrer\">this</a>"}], "owner": {"reputation": 318, "user_id": 3691612, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/FpqBe.jpg?s=128&g=1", "display_name": "romulus001", "link": "https://stackoverflow.com/users/3691612/romulus001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475697573, "creation_date": 1475677742, "last_edit_date": 1475697573, "question_id": 39876732, "link": "https://stackoverflow.com/questions/39876732/vba-access-2007-odbc-cannot-lock-all-records", "title": "VBA Access 2007 - ODBC cannot lock all records", "body": "<p>I'm working on a heavy project which consists in migrating Microsoft Access local tables to Microsoft SQL Server, and I'm having troubles with a specific one. </p>\n\n<p>I'm using the ODBC driver to MS SQL Server to link to my table <code>IMMATRICULATION</code>. Its column name <code>IMMAT</code> is a primary key. In my VBA code, I'm running this:</p>\n\n<pre><code>Dim mydb As Database\nDim myrs As Recordset\nDim req As String\nSet mydb = CurrentDb()\n\nDoCmd.Hourglass True\n\nreq = \"SELECT * FROM IMMATRICULATION WHERE IMMAT ='\" &amp; Me.Liste_CANum &amp; \"'\"\nSet myrs = mydb.OpenRecordset(req, dbOpenDynaset, dbDenyWrite)\n\nIf myrs.RecordCount &gt; 0 Then\n    IMMAT = myrs![IMMAT]\n    MARQUE = myrs![MARQUE]\n    MODELE = myrs![MODELE]\n    PRIX = myrs![PRIX]\n    DATE = myrs![DATE]\n    AMO_DUREE = myrs![AMO_DUREE]\n    AMO_MONTANT = myrs![AMO_MONTANT]\n    AMO_DEBUT = myrs![AMO_DEBUT]\n    AMO_FIN = myrs![AMO_FIN]\n    ASS_MONTANT = myrs![ASS_MONTANT]\n    SOM = myrs![SOMMEIL]\nElse\n    myrs.AddNew\n    myrs![IMMAT] = Me.Liste_CANum\n    myrs.Update\n    IMMAT = Me.Liste_CANum\n    MARQUE = \"\"\n    MODELE = \"\"\n    PRIX = \"\"\n    DATE = \"\"\n    AMO_DUREE = \"\"\n    AMO_MONTANT = \"\"\n    AMO_DEBUT = \"\"\n    AMO_FIN = \"\"\n    ASS_MONTANT = \"\"\n    SOM = \"Non\"\nEnd If\nmyrs.Close\nmydb.Close\nDoCmd.Hourglass False\n</code></pre>\n\n<p>but this line of code doesn't work:</p>\n\n<pre><code>Set myrs = mydb.OpenRecordset(req, dbOpenDynaset, dbDenyWrite)\n</code></pre>\n\n<p>And the following error message pops-up:</p>\n\n<pre><code>ODBC -- cannot lock all records\n</code></pre>\n\n<p>Do you have any ideas of how to solve my problem? I tried to remove the <code>dbDenyWrite</code> but the problem isn't solved.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 515, "user_id": 2949700, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6Yssn.png?s=128&g=1", "display_name": "Socii", "link": "https://stackoverflow.com/users/2949700/socii"}, "edited": false, "score": 2, "creation_date": 1475678868, "post_id": 39875934, "comment_id": 67041018, "body": "I get an &quot;argument not optional&quot; error when I try the above code, so I think you&#39;ll need to specify the index of the new Node. Try <code>shap2.Nodes.Insert shap2.Nodes.Count, msoSegmentLine, msoEditingAuto, 1, 1</code>; this will insert a new Node after the last Node in the Shape."}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "reply_to_user": {"reputation": 515, "user_id": 2949700, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6Yssn.png?s=128&g=1", "display_name": "Socii", "link": "https://stackoverflow.com/users/2949700/socii"}, "edited": false, "score": 0, "creation_date": 1475996301, "post_id": 39875934, "comment_id": 67162779, "body": "@Socii This code insert a Line instead of a point, i want a insert a point not line, Ever shape has only 4 points, which is 1,2,3,4, i want to insert 5."}, {"owner": {"reputation": 515, "user_id": 2949700, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6Yssn.png?s=128&g=1", "display_name": "Socii", "link": "https://stackoverflow.com/users/2949700/socii"}, "edited": false, "score": 0, "creation_date": 1476010198, "post_id": 39875934, "comment_id": 67165940, "body": "My bad... use <code>msoSegmentCurve</code> instead of <code>msoSegmentLine</code>. And if you already know how many points you have you can specify point 5 in your line of code: <code>shap2.Nodes.Insert 5, msoSegmentCurve, msoEditingAuto, 1, 1</code> should work."}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "reply_to_user": {"reputation": 515, "user_id": 2949700, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6Yssn.png?s=128&g=1", "display_name": "Socii", "link": "https://stackoverflow.com/users/2949700/socii"}, "edited": false, "score": 0, "creation_date": 1476103794, "post_id": 39875934, "comment_id": 67196850, "body": "@Socii    Is it possible to insert points without adding msoSegmentLine or Curve... I am adding shape then want to add points for the connection.. something like this ...  Set conn = w.Shapes.AddConnector(msoConnectorStraight, 1, 1, 1, 1)              conn.ConnectorFormat.BeginConnect shap1, 4              conn.ConnectorFormat.EndConnect shap2, 2"}, {"owner": {"reputation": 515, "user_id": 2949700, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6Yssn.png?s=128&g=1", "display_name": "Socii", "link": "https://stackoverflow.com/users/2949700/socii"}, "edited": false, "score": 0, "creation_date": 1476216527, "post_id": 39875934, "comment_id": 67250404, "body": "Not that I know of, although I haven&#39;t done much VBA programming with shapes so I may be wrong. If you&#39;re aiming to add a connector between two shapes using the shortest path however, you can use the <code>RerouteConnections</code> method to adjust the connector. This will eliminate the need to add any extra points to the shape. <code>RerouteConnections</code> method is at <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840394.aspx\" rel=\"nofollow noreferrer\">MSDN page</a>, and this post (<a href=\"http://stackoverflow.com/questions/21022636/how-to-link-existing-shapes-in-excel-with-a-straight-line-using-vba-dynamically\" title=\"how to link existing shapes in excel with a straight line using vba dynamically\">stackoverflow.com/questions/21022636/&hellip;</a>) may be useful."}], "owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1036, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1477119828, "creation_date": 1475675679, "last_edit_date": 1531164843, "question_id": 39875934, "link": "https://stackoverflow.com/questions/39875934/how-can-i-add-points-or-nodes-to-a-shape-in-vba", "title": "How can i add points or nodes to a shape in vba?", "body": "<p>I am trying to add points or nodes to a shape, so instead of having 4 points, I can h<a href=\"https://i.stack.imgur.com/8oZ9q.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/8oZ9q.jpg\" alt=\"enter image description here\"></a>ave more</p>\n\n<p>Here is my code adding shapes</p>\n\n<pre><code>Set shap2 = w.Shapes.AddShape(1, 330, 55, 100, 40)\nshap2.Nodes.Insert , 6, msoEditingAuto, 1, 1 \n</code></pre>\n\n<p>I am getting an error when I am trying to add Nodes... Any idea?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 2, "creation_date": 1475677122, "post_id": 39875649, "comment_id": 67039560, "body": "Try a pivot table."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6926672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd108936c3f2cfa39603dd7b4571fe73?s=128&d=identicon&r=PG&f=1", "display_name": "S. Perry", "link": "https://stackoverflow.com/users/6926672/s-perry"}, "edited": false, "score": 0, "creation_date": 1475693252, "post_id": 39877522, "comment_id": 67049897, "body": "Thanks! I am not an Excel expert, I appreciate the help"}, {"owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "reply_to_user": {"reputation": 3, "user_id": 6926672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd108936c3f2cfa39603dd7b4571fe73?s=128&d=identicon&r=PG&f=1", "display_name": "S. Perry", "link": "https://stackoverflow.com/users/6926672/s-perry"}, "edited": false, "score": 0, "creation_date": 1475693688, "post_id": 39877522, "comment_id": 67050139, "body": "no problem! feel free to ask if you need anymore help."}], "tags": [], "owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "is_accepted": true, "score": 0, "last_activity_date": 1475679685, "creation_date": 1475679685, "answer_id": 39877522, "question_id": 39875649, "link": "https://stackoverflow.com/questions/39875649/i-need-to-take-unique-values-from-one-sheet-in-excel-total-them-up-by-unique-va/39877522#39877522", "title": "I need to take unique values from one sheet in excel, total them up by unique values and place the data in another sheet", "body": "<p>This is definitely possible. </p>\n\n<p>Here's a step by step:</p>\n\n<p>1) Select all of your data, click \"INSERT\" tab, click \"Pivot Table\"</p>\n\n<p>2) In your Pivot Table Fields window, drag Company Names from fields into the ROWS box.</p>\n\n<p>3) In your Pivot Table Fields window, drag Company Names from fields into the VALUES box. Make sure that it says \"Count of Company Names\". If it doesn't, click the arrow next to it, click Value Field Settings, and change it appropriately. </p>\n\n<p>4) In your Pivot Table Fields window, drag Contract Dollars from fields into the VALUES box. Make sure that it says \"Sum of Contract Dollars\".  If it doesn't, click the arrow next to it, click Value Field Settings, and change it appropriately. </p>\n\n<p>You should now have a handy table that shows all of the data you were asking for. </p>\n"}], "owner": {"reputation": 3, "user_id": 6926672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd108936c3f2cfa39603dd7b4571fe73?s=128&d=identicon&r=PG&f=1", "display_name": "S. Perry", "link": "https://stackoverflow.com/users/6926672/s-perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 39877522, "answer_count": 1, "score": -2, "last_activity_date": 1475679685, "creation_date": 1475674961, "last_edit_date": 1531161705, "question_id": 39875649, "link": "https://stackoverflow.com/questions/39875649/i-need-to-take-unique-values-from-one-sheet-in-excel-total-them-up-by-unique-va", "title": "I need to take unique values from one sheet in excel, total them up by unique values and place the data in another sheet", "body": "<p>Scenario:</p>\n\n<p>I have a list of Company names associated with individual contracts all in the column labeled \"Company\". I need to take each unique company name, create a column on another sheet within the workbook, total up the number of times that company appears and then total up the total contract dollars. example:</p>\n\n<p>Company                       Total \nRiordan &amp; Scully Insurance        $312.70 \nRiordan &amp; Scully Insurance        $904.80 </p>\n\n<p>So I need the data to show up in sheet 2 like this:</p>\n\n<p>Company                       Contracts        Total\nRiordan &amp; Scully Insurance        2            $1217.50</p>\n\n<p>Is this possible in excel?</p>\n"}, {"tags": ["excel", "hide", "vba"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475676037, "post_id": 39875633, "comment_id": 67038737, "body": "Why doesn&#39;t it work too well?"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1475676991, "last_edit_date": 1475676991, "creation_date": 1475676668, "answer_id": 39876292, "question_id": 39875633, "link": "https://stackoverflow.com/questions/39875633/hide-row-in-excel-if-3-of-the-cells-are-blank/39876292#39876292", "title": "Hide row in Excel if 3 of the cells are blank", "body": "<p>Try the code below:</p>\n\n<pre><code>Sub Celltest2()\n\nDim rw As Range, cel As Range\nDim i As Integer\nDim celset As Range\nDim LastRow As Long\n\n\nWith Sheets(\"Phonelist\")\n    ' find last row with data in Columns \"D, \"E\" and \"F\" &gt;&gt; modify to your needs\n    LastRow = WorksheetFunction.Max(.Cells(.Rows.Count, \"D\").End(xlUp).Row, _\n                                    .Cells(.Rows.Count, \"E\").End(xlUp).Row, _\n                                    .Cells(.Rows.Count, \"F\").End(xlUp).Row)\n\n    For Each rw In .Range(\"D2:F\" &amp; LastRow).Rows\n        If WorksheetFunction.CountA(Range(\"D\" &amp; rw.Row &amp; \":F\" &amp; rw.Row)) = 0 Then\n            rw.EntireRow.Hidden = True\n        End If\n    Next rw\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Option 2</strong>: You can replace the loop above (the one that starts with <code>For Each rw In .Range(\"D2:F\" &amp; LastRow).Rows</code>) with the following loop:</p>\n\n<pre><code>For i = 2 To LastRow\n    If WorksheetFunction.CountA(Range(\"D\" &amp; i &amp; \":P\" &amp; i)) = 0 Then\n        Rows(i).EntireRow.Hidden = True\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 3998184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1ea75591d0349efc20d67d583c6d12c3?s=128&d=identicon&r=PG&f=1", "display_name": "aric8456", "link": "https://stackoverflow.com/users/3998184/aric8456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 39876292, "answer_count": 1, "score": 0, "last_activity_date": 1475676991, "creation_date": 1475674905, "last_edit_date": 1531164843, "question_id": 39875633, "link": "https://stackoverflow.com/questions/39875633/hide-row-in-excel-if-3-of-the-cells-are-blank", "title": "Hide row in Excel if 3 of the cells are blank", "body": "<p>I have a Sheet with columns A through F. I'm looking for the program to run through all the rows (Is there a way for it to only do active rows?) and check if D1 &amp; E1 &amp; F1 are blank, then hide the row (and so on). </p>\n\n<p>Here's what I have which doesn't really work too well....</p>\n\n<pre><code> Sub Celltest2()\n Dim rw As Range, cel As Range\n Dim i As Integer\n Dim celset As Range\n\n For Each rw In Sheets(\"Phonelist\").Range(\"D2:F5000\").Rows\n    For Each cel In rw.Cells\n            If Len(cel.Text) = 0 Then\n            cel.EntireRow.Hidden = True\n\n            End If\n    Next\nNext\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475675013, "post_id": 39875602, "comment_id": 67037881, "body": "what is <code>Checker</code>?  I do not see it declared."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475678186, "post_id": 39875602, "comment_id": 67040419, "body": "I suspect this is related to the side effect in your <code>Checker()</code> function that calls <code>Application.OnTime</code>. You should probably exit if it returns false, because it will schedule the macro once <i>for each additional loop iteration</i> if you don&#39;t. Everything else seems to work fine when I test it."}, {"owner": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475679173, "post_id": 39875602, "comment_id": 67041273, "body": "@Comintern Sorry I&#39;m not quite getting it, how would the checker function look if I were to incorporate this?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475679309, "post_id": 39875602, "comment_id": 67041407, "body": "<code>If Checker = True Then ... [existing code] ... Else Exit For</code>"}, {"owner": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "edited": false, "score": 0, "creation_date": 1475679519, "post_id": 39875602, "comment_id": 67041577, "body": "I&#39;ve currently got this (sorry it&#39;s not pretty), but the problem is...it populates for the first cell fine and pastes the value next it it. It then tries the next cell in the range and enters it, but doesn&#39;t paste the value. It then repeats with the first cell again, and so it continues? <a href=\"http://pastebin.com/sdcW9HLN\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475680461, "post_id": 39875602, "comment_id": 67042281, "body": "@CuriousStudent what cells are you trying to copy ? copy Cell &quot;E26&quot; , and then which cell should be next ? Cell &quot;E27&quot; or Cell &quot;F26&quot; ?"}, {"owner": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475680567, "post_id": 39875602, "comment_id": 67042349, "body": "@ShaiRado - it should always be E26 over and over. The range (M53 and so on) are different inputs, and I want to grab E26 (the output) each time"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475680931, "post_id": 39875602, "comment_id": 67042580, "body": "I understand that, but if the first cell in your loop fails the <code>Checker = True</code> test, you&#39;ll end up calling <code>Application.OnTime</code> multiple times unless you paste &quot;request&quot; into <code>Range(&quot;E19&quot;)</code>. Step through it with the debugger.  You&#39;ll see that your loop functions just fine, and goes through each cell as expected. But if <code>.Find(&quot;request&quot;, LookIn:=xlValues)</code> returns <code>Nothing</code> in <code>Checker</code>, you&#39;ll re-enter the macro after 6 seconds, and possibly multiple times."}, {"owner": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475681310, "post_id": 39875602, "comment_id": 67042814, "body": "@Comintern - It is strange though, that even when that condition is satisfied, it doesn&#39;t paste the value for the next cell in the range. It does this only for the first one"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475681393, "post_id": 39875602, "comment_id": 67042868, "body": "Comment out <code>Application.ScreenUpdating = False</code> and step through it with a debugger."}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "edited": false, "score": 0, "creation_date": 1475675384, "post_id": 39875748, "comment_id": 67038197, "body": "I&#39;m not sure I quite follow. I&#39;ve pasted the checker function itself above"}, {"owner": {"reputation": 36, "user_id": 6920029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8d3c9ef4623b835faf616de182415a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6920029/kyle"}, "reply_to_user": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "edited": false, "score": 0, "creation_date": 1475675510, "post_id": 39875748, "comment_id": 67038292, "body": "please ignore the &quot;Checker&quot; comment i placed before you edited your post."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475675874, "post_id": 39875748, "comment_id": 67038597, "body": "try avoiding using <code>Select</code>, you can just use <code>Range(&quot;E26&quot;).Copy</code> and <code>Range(&quot;N53&quot;).Offset(n).PasteSpecial xlPasteValues</code>"}, {"owner": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475676009, "post_id": 39875748, "comment_id": 67038707, "body": "Thanks @ShaiRado, I&#39;ve made these changes. But is there any reason you can see why the code doesn&#39;t loop through the cells properly? It appears to just run on M55, and it continues to run too, continuously populating N54 again and again with the value in M55"}, {"owner": {"reputation": 36, "user_id": 6920029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8d3c9ef4623b835faf616de182415a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6920029/kyle"}, "reply_to_user": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "edited": false, "score": 0, "creation_date": 1475676608, "post_id": 39875748, "comment_id": 67039154, "body": "@CuriousStudent what are you trying to achieve? The code is looping through the range and copying cell value and pasting it to Range(&quot;E19&quot;). if checker is true you are pasting at fixed Range(&quot;N53&quot;) + offset by n."}, {"owner": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "edited": false, "score": 0, "creation_date": 1475676740, "post_id": 39875748, "comment_id": 67039254, "body": "I want to paste the value in M53, run through the code, paste to N53. Then I want to paste in the value in M54, run through the code, then Paste to N53 + offset 1, etc"}, {"owner": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "edited": false, "score": 0, "creation_date": 1475678813, "post_id": 39875748, "comment_id": 67040964, "body": "Thanks both. For some reason, it isn&#39;t behaving properly and won&#39;t loop through the cells. Also - it seems to like to continually populate one cell at the end of the range, repopulating the same number into cell N53 + offset"}], "tags": [], "owner": {"reputation": 36, "user_id": 6920029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8d3c9ef4623b835faf616de182415a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6920029/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1475678509, "last_edit_date": 1475678509, "creation_date": 1475675223, "answer_id": 39875748, "question_id": 39875602, "link": "https://stackoverflow.com/questions/39875602/excel-for-each-cell-not-working/39875748#39875748", "title": "Excel For Each Cell Not Working?", "body": "<p>Please try this.</p>\n\n<pre><code>Sub TestMacro2()\n    Sub TestMacro2()\nDim cell As Range\nDim Strike As Range\nSet Strike = Range(\"M53:M54\")\n\nApplication.ScreenUpdating = False\nFor Each cell In Strike\n    cell.Copy\n    Range(\"E19\").PasteSpecial xlPasteValues 'fixed range\n\n        If Checker = True Then\n            ActiveSheet.Calculate\n            Range(\"E26\").Copy\n            cell.Offset(0, 1).PasteSpecial xlPasteValues\n        End If\nNext cell\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 565, "user_id": 6562240, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a3ba6a945cb92d20ec289f418e8eec1?s=128&d=identicon&r=PG", "display_name": "Curious Student", "link": "https://stackoverflow.com/users/6562240/curious-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1475678509, "creation_date": 1475674843, "last_edit_date": 1531164843, "question_id": 39875602, "link": "https://stackoverflow.com/questions/39875602/excel-for-each-cell-not-working", "title": "Excel For Each Cell Not Working?", "body": "<p>I am trying to get the code to loop through the range. For example, it should be taking the value in cell M53, using it, then running through the code, and doing the same thing with the value in cell M54. The first iteration works, but then it just seems to continuously keep running in cell M53.</p>\n\n<p>I am struggling to work this one out.</p>\n\n<pre><code>Sub TestMacro1()\n\nDim n As Integer\nDim Strike As Range\n\nSet Strike = Range(\"M53:M54\")\nn = 1\nApplication.ScreenUpdating = False\n\nFor Each cell In Strike\n    cell.Select\n    Selection.Copy\n    Range(\"E19\").PasteSpecial xlPasteValues\n\n    If Checker = True Then\n        Range(\"E26\").Select\n        Selection.Copy\n        Range(\"N53\").Offset(n).PasteSpecial xlPasteValues\n        n = n + 1\n    End If\nNext cell\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The Checker Function is defined as:</p>\n\n<pre><code>Function Checker() As Boolean\n\nDim tmp\nDim c As Object\n\ntmp = False\nActiveSheet.Calculate\nActiveSheet.Calculate\n\nWith ActiveSheet.UsedRange\n    Set c = .Find(\"request\", LookIn:=xlValues)\n    If Not c Is Nothing Then\n        Application.OnTime Now + TimeValue(\"00:00:06\"), \"TestMacro1\"\n        tmp = False\n    Else\n        tmp = True\n    End If\nEnd With\n\nChecker = tmp\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 31, "user_id": 6693033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b87f1b9bb7a12911fcd42f933a0e17e?s=128&d=identicon&r=PG&f=1", "display_name": "Totos", "link": "https://stackoverflow.com/users/6693033/totos"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1475677220, "post_id": 39875580, "comment_id": 67039650, "body": "the error is: Run-time error &#39;-2147217843 (80040e4d)&#39;:[Microsoft][ODBC SQL Server Driver]Login failed for user &#39;USER ID&#39;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1475677375, "post_id": 39875580, "comment_id": 67039767, "body": "If you want to use Windows Authentication, don&#39;t provide a user ID / password in the connection string."}, {"owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "edited": false, "score": 0, "creation_date": 1475678484, "post_id": 39875580, "comment_id": 67040652, "body": "Mat nailed it, just make sure all users who will use this macro have public access to the SQL server and database. Or, add them to a group on the domain which has access."}, {"owner": {"reputation": 31, "user_id": 6693033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b87f1b9bb7a12911fcd42f933a0e17e?s=128&d=identicon&r=PG&f=1", "display_name": "Totos", "link": "https://stackoverflow.com/users/6693033/totos"}, "edited": false, "score": 0, "creation_date": 1475679664, "post_id": 39875580, "comment_id": 67041692, "body": "Awesome! Thank you so much, it works!!"}], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1475677514, "post_id": 39876529, "comment_id": 67039891, "body": "Great answer, better cartoon"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1475677705, "last_edit_date": 1475677705, "creation_date": 1475677247, "answer_id": 39876529, "question_id": 39875580, "link": "https://stackoverflow.com/questions/39875580/sql-management-studio-2012-with-excel-vba-connection-string-set-up/39876529#39876529", "title": "SQL Management Studio 2012 with Excel vba connection string set up", "body": "\n\n<h3>Authentication</h3>\n\n<p>If you're connecting to SQL Server, you should prefer Windows Authentication if that's available: you create a <em>Login</em> at server level for a group of Active Directory users, and then you create a Windows-Authenticated <em>User</em> in your database using that login.</p>\n\n<p>That way you are keeping passwords and usernames out of hard-coded strings, and let the network deal with authentication.</p>\n\n<p>Assuming you don't want to be maintaining passwords in dozens of copies of macro-enabled workbooks across your network, you'll want to use Windows Authentication.</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>Integrated Security=SSPI; Persist Security Info=True;\n</code></pre>\n\n<hr>\n\n<h3>Server</h3>\n\n<p>Connection strings <em>are</em> annoying - seems there's a different format/wording for every single different thing that's able to parse them!</p>\n\n<p>Since you're using ADODB, you'll want to specify a <em>Provider</em>, a <em>Data Source</em> and, optionally, an <em>Initial Catalog</em>:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>Provider=SQLOLEDB.1; Data Source=SQL Server instance name; Initial Catalog=Database name;\n</code></pre>\n\n<hr>\n\n<h3>Who?</h3>\n\n<p>Each connection can be monitored on the server; when building your connection string you can optionally specify a <em>Workstation ID</em> to identify the machine the connection is for.</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>Workstation ID=computer name;\n</code></pre>\n\n<p>You can get the computer name by fetching the environment variable value, using <code>Environ$</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Function GetWorkstationId() As String\n    GetWorkstationId = Environ$(\"ComputerName\")\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Given a SQL Server instance named <code>SomeSqlServer</code>, a database named <code>SomeDatabase</code>, and using Windows Authentication, the ADODB connection string would look like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim connString As String\nconnString = \"Provider=SQLOLEDB.1; Data Source=SomeSqlServer; Initial Catalog=SomeDatabase; Integrated Security=SSPI; Persist Security Info=True;\"\n</code></pre>\n\n<p>Given SQL Authentication (with a hard-coded user name and password) for <code>SomeUser</code> with <code>SomePassword</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>connString = \"Provider=SQLOLEDB.1; Data Source=SomeSqlServer; Initial Catalog=SomeDatabase; UID=SomeUser; PWD=SomePassword;\"\n</code></pre>\n\n<hr>\n\n<h3>Commands</h3>\n\n<p>You don't want to be concatenating arbitrary user input into a WHERE clause; avoid executing an SQL string directly from the <code>ADODB.Connection</code> object.</p>\n\n<p>Instead, create an <code>ADODB.Command</code>, and <em>parameterize</em> your query.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim sql As String\nsql = \"SELECT Foo, Bar FROM dbo.FooBars WHERE Foo = ? AND DateInserted &gt; ?\"\n</code></pre>\n\n<p>Here we have 2 parameters.</p>\n\n<p>First we create the <em>command</em>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim cmd As ADODB.Command\nSet cmd = New ADODB.Command\ncmd.ActiveConnection = conn\ncmd.CommandType = adCmdText\ncmd.CommandText = sql\n</code></pre>\n\n<p>Then its parameters, assuming we have their respective values in <code>param1Value</code> and <code>param2Value</code> local variables:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim param1 As ADODB.Parameter ' a string parameter\nSet param1 = New ADODB.Parameter\nparam1.Type = adVarWChar\nparam1.Direction = adParamInput\nparam1.Size = Len(param1Value)\nparam1.Value = param1Value\ncmd.Parameters.Append param1\n\nDim param2 As ADODB.Parameter ' a date parameter\nSet param2 = New ADODB.Parameter\nparam2.Type = adDate\nparam2.Direction = adParamInput\nparam2.Value = param2Value\ncmd.Parameters.Append param2\n</code></pre>\n\n<p>Then we retrieve the recordset by executing the command:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim results As ADODB.Recordset\nSet results = cmd.Execute\n</code></pre>\n\n<p>Of course this looks very verbose, but it can easily be refactored into functions dedicated to creating a parameter given a value of a certain type.</p>\n\n<p>As a result, you avoid this situation, because you're no longer executing arbitrary user input concatenated into a query:</p>\n\n<p><a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bbeuy.png\" alt=\"XKCD: Exploits of a Mom\"></a></p>\n"}], "owner": {"reputation": 31, "user_id": 6693033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b87f1b9bb7a12911fcd42f933a0e17e?s=128&d=identicon&r=PG&f=1", "display_name": "Totos", "link": "https://stackoverflow.com/users/6693033/totos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2931, "favorite_count": 0, "accepted_answer_id": 39876529, "answer_count": 1, "score": 1, "last_activity_date": 1475677705, "creation_date": 1475674787, "last_edit_date": 1531164843, "question_id": 39875580, "link": "https://stackoverflow.com/questions/39875580/sql-management-studio-2012-with-excel-vba-connection-string-set-up", "title": "SQL Management Studio 2012 with Excel vba connection string set up", "body": "<p>I would like to set up a vba code that would connect to sql management studio 2012 a run the query, which I would specify in the vba code. I have read every similar question here on stack overflow but when I try to replicate them, I always get an error, ussualy that the login failed for user. </p>\n\n<p>I think I am setting up the string connection wrong. Also, I would need the user authentication by Windows authentication.</p>\n\n<p>I know the database name, server name and my user name.</p>\n\n<p>This is the code I am using and which is giving me an error.</p>\n\n<pre><code>Sub ConnectionExample6()\n Dim cnn As ADODB.Connection\n Dim rs As ADODB.Recordset\n\n Set cnn = New ADODB.Connection\n\n ' Open a connection by referencing the ODBC driver.\n cnn.ConnectionString = \"driver={SQL Server};\" &amp; _\n  \"server=SERVER NAME;uid=USER ID;pwd=MyPassword;database=DATABASE NAME\"\n cnn.Open\n\n' Create a Recordset by executing an SQL statement.\n Set rs = cnn.Execute(\"Select top 100 * from \"TABLE NAME\" aac \" &amp; _\n \"where aac.EffectiveDate = '10/04/16'\")\n\n ' Close the connection.\n rs.Close\n\nEnd Sub\n</code></pre>\n\n<p>Can someone walk me through the connection string and how to set it up step by step? Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1475674732, "post_id": 39875314, "comment_id": 67037656, "body": "<code>=IF(A1&#47;1024&#47;1024&gt;1,ROUND(A1&#47;1024&#47;1024,2) &amp; &quot; MB&quot;,IF(A1&#47;1024&gt;1,ROUND(A1&#47;1024,2) &amp; &quot; kB&quot;,A1 &amp; &quot; B&quot;))</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1475678070, "creation_date": 1475678070, "answer_id": 39876868, "question_id": 39875314, "link": "https://stackoverflow.com/questions/39875314/converting-bytes-to-kb-and-mb-pending-of-the-cell-data-in-vba/39876868#39876868", "title": "converting bytes to kB and MB pending of the cell data in vba", "body": "<p>If you can handle using 10\u00b3 (aka <em>1,000</em>) as a Kb instead of 2\u00b9\u2070 (aka <em>1,024</em>) and 10\u2076 (aka <em>1,000,000</em>) as a Mb instead of 2\u00b2\u2070 (aka <em>1,048,576</em>) then a <a href=\"https://support.office.com/en-us/article/Number-format-codes-5026BBD6-04BC-48CD-BF33-80F18B4EAE68\" rel=\"nofollow noreferrer\">Custom Number Format Code</a> will preserve the raw underlying value while displaying the unit of size.</p>\n\n<pre><code>range(\"B2:B99\").NumberFormat = \"[Color10][&gt;999999]0,, \\M\\b;[Color13][&gt;999]0, K\\b;[Color3]0 \\B;\"\n</code></pre>\n\n<p>I have also added blue for Mb, green for Kb and red for B.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RIXMv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RIXMv.png\" alt=\"MB_KB_B\"></a></p>\n"}], "owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 39876868, "answer_count": 1, "score": 0, "last_activity_date": 1475678070, "creation_date": 1475674134, "question_id": 39875314, "link": "https://stackoverflow.com/questions/39875314/converting-bytes-to-kb-and-mb-pending-of-the-cell-data-in-vba", "title": "converting bytes to kB and MB pending of the cell data in vba", "body": "<p>Simple question:\nLets say i have got 2 cells (A1 and A2). on A1 i have a value of 16000000 and on cell A2 a value of 230000.\nboth values are in bytes. what i need is to be able to convert them to MB and kB respectively with VBA code.</p>\n\n<p>i can start dividing A1/1024/1024 and A2/1024 but what i would like to know is how do i make the vba code diferentiate between the 2 values and then convert them to their respective category.\ni could convert both of them to MB by dividing by 1024 but that would leave me with cell A2 with a value of 0.23MB.\ni am not asking for code to be written for me, just for an explanation on how to do this if possible.</p>\n"}, {"tags": ["sql", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 1308, "user_id": 3017149, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/K18gw.jpg?s=128&g=1", "display_name": "Tedo G.", "link": "https://stackoverflow.com/users/3017149/tedo-g"}, "edited": false, "score": 0, "creation_date": 1475674394, "post_id": 39875225, "comment_id": 67037382, "body": "Why do not you search on internet first? :) thats simpliest"}], "answers": [{"tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": true, "score": 1, "last_activity_date": 1475674020, "creation_date": 1475674020, "answer_id": 39875282, "question_id": 39875225, "link": "https://stackoverflow.com/questions/39875225/whats-the-query-that-filters-a-table-in-order-to-display-only-a-portion-of-the/39875282#39875282", "title": "Whats the query that filters a table, in order to display only a portion of the results in ms access", "body": "<p>Going by just what you said, you can try the following query:</p>\n\n<pre><code>SELECT *\nFROM yourTable\nWHERE quantity &gt; 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1475674488, "creation_date": 1475674488, "answer_id": 39875470, "question_id": 39875225, "link": "https://stackoverflow.com/questions/39875225/whats-the-query-that-filters-a-table-in-order-to-display-only-a-portion-of-the/39875470#39875470", "title": "Whats the query that filters a table, in order to display only a portion of the results in ms access", "body": "<p>You need to use a combination of VBA and SQL.  I assume you wish to use vba, as you added the tag.  A good place to start is here:</p>\n\n<p><a href=\"http://www.fontstuff.com/access/acctut15.htm\" rel=\"nofollow\">http://www.fontstuff.com/access/acctut15.htm</a></p>\n\n<p>That said if you just want to use the SQL query then Tim's answer has everything you need</p>\n"}], "owner": {"reputation": 37, "user_id": 5979952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4958500e24bf46cfddd5c69bc5e69d91?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitris Afendras", "link": "https://stackoverflow.com/users/5979952/dimitris-afendras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 39875282, "answer_count": 2, "score": 0, "last_activity_date": 1475674488, "creation_date": 1475673877, "question_id": 39875225, "link": "https://stackoverflow.com/questions/39875225/whats-the-query-that-filters-a-table-in-order-to-display-only-a-portion-of-the", "title": "Whats the query that filters a table, in order to display only a portion of the results in ms access", "body": "<p>I have a table with many entrys but i only want to display the items with quantity over 0. What a query like that would be like? and how do i use it? Complete noob in Access and VBA</p>\n"}, {"tags": ["c#", "excel", "rtd", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 4090620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca9331020f2911f1614eea9ffc700c90?s=128&d=identicon&r=PG&f=1", "display_name": "AlexO", "link": "https://stackoverflow.com/users/4090620/alexo"}, "edited": false, "score": 0, "creation_date": 1475833490, "post_id": 39893365, "comment_id": 67112492, "body": "Spoke too soon!  I still have two VMs that this does not fix.  I&#39;ve fixed the VM where I have dev tools installed e.g. Visual Studio etc. but two that are clean Win 10 VMs with Excel 2016 installed are still not updating."}, {"owner": {"reputation": 79, "user_id": 4090620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca9331020f2911f1614eea9ffc700c90?s=128&d=identicon&r=PG&f=1", "display_name": "AlexO", "link": "https://stackoverflow.com/users/4090620/alexo"}, "edited": false, "score": 0, "creation_date": 1475835329, "post_id": 39893365, "comment_id": 67113660, "body": "Updating Excel 2016 appears to be the solution as well as setting the ThrottleInterval.  The Dev machine was up-to-date but the other two test machine were not.  Doing this update and the RTD is working.  So it possibly was a bug in Excel however I still need to set the ThrottleInterval otherwise it still requires a manual refresh."}], "tags": [], "owner": {"reputation": 79, "user_id": 4090620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca9331020f2911f1614eea9ffc700c90?s=128&d=identicon&r=PG&f=1", "display_name": "AlexO", "link": "https://stackoverflow.com/users/4090620/alexo"}, "is_accepted": false, "score": 0, "last_activity_date": 1475834447, "last_edit_date": 1592644375, "creation_date": 1475749001, "answer_id": 39893365, "question_id": 39874985, "link": "https://stackoverflow.com/questions/39874985/using-rtd-with-excel-2016-on-windows-10-does-not-refresh/39893365#39893365", "title": "Using RTD with Excel 2016 on Windows 10 Does Not Refresh", "body": "<p>I've been playing around with &quot;Application.RTD.ThrottleInterval&quot; and this has fixed it.  On a clean install of Windows 10 with Excel 2016 the default value appears to be &quot;2000&quot; (although not written to the registry).  It behaves like it is set as &quot;-1&quot;.  This is strange install behaviour I've now experienced this on three machine with Windows 10 and Office 2016.</p>\n<p>Setting this value to 2000 manually now gives ticking values (after restarting Excel).  It is also persisted across Excel sessions.  So perhaps the problem in Excel installer (or initial run of RTD in Excel) on Windows 10 setting this value to -1 rather than the documented value of 2000?</p>\n<p>Reg Key:\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office[\u2026|14.0|15.0|16.0|\u2026]\\Excel\\Options\\RTDThrottleInterval</p>\n<blockquote>\n<p>-1 -&gt; Manual mode. Never automatically refreshes. Excel.Application.RTD.RefreshData must be called.</p>\n<p>0 -&gt; Checks for updates every chance it gets.</p>\n<p>greater 0 -&gt; Excel waits at least the specified number of milliseconds before getting updates.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1054, "user_id": 4977706, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BA0E0OMgvhY/AAAAAAAAAAI/AAAAAAAAAO0/_d-987UK6qU/photo.jpg?sz=128", "display_name": "Anna Dolbina", "link": "https://stackoverflow.com/users/4977706/anna-dolbina"}, "is_accepted": false, "score": 0, "last_activity_date": 1612969041, "creation_date": 1612969041, "answer_id": 66139351, "question_id": 39874985, "link": "https://stackoverflow.com/questions/39874985/using-rtd-with-excel-2016-on-windows-10-does-not-refresh/66139351#66139351", "title": "Using RTD with Excel 2016 on Windows 10 Does Not Refresh", "body": "<p>When I was working with the RTD server, I have found out that sometimes the RTD connection issues are somehow related to UAC, and elevating the rights for the server just made the problem vanish.</p>\n"}], "owner": {"reputation": 79, "user_id": 4090620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca9331020f2911f1614eea9ffc700c90?s=128&d=identicon&r=PG&f=1", "display_name": "AlexO", "link": "https://stackoverflow.com/users/4090620/alexo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1713, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1612969041, "creation_date": 1475673243, "last_edit_date": 1531161705, "question_id": 39874985, "link": "https://stackoverflow.com/questions/39874985/using-rtd-with-excel-2016-on-windows-10-does-not-refresh", "title": "Using RTD with Excel 2016 on Windows 10 Does Not Refresh", "body": "<p>I'm trying to use RTD with Excel 2016 on Windows 10 and find that it does not refresh the values without a forced update using \"Application.RTD.RefreshData\" in the VBA Editor.</p>\n\n<p>I've tried several RTD servers and the problem appears common only to the Excel 2016 and Windows 10 combination.  Windows 7 and Excel 2016 works as expected.  The problem is only with Windows 10.  Using Excel 2013 and Windows 10 is OK.  The Excel 2016 has all the latest updates so it is not related to the issue experienced at the end of 2015 where a server had to be specified. This bug has been subsequently fixed by Microsoft.</p>\n\n<p>To give a simple example, taking a RTD server like that described in <a href=\"http://blog.learningtree.com/excel-creating-rtd-server-c/\" rel=\"nofollow\">http://blog.learningtree.com/excel-creating-rtd-server-c/</a> it will give a value in an Excel cell on first entering the formula but will not \"tick\" (refresh) the value automatically.  If \"Application.RTD.RefreshData\" is used the value updates.</p>\n\n<p>Debugging the RTD server it appears that Excel 2016 is not calling RefreshData() as it does in other OSs or Excel versions.</p>\n\n<p>I've tried this on two machines and can replicate it every time.  Can't help feeling this is a bug in Excel 2016 when run on Windows 10?</p>\n"}, {"tags": ["excel", "vba", "loops", "macros", "screen-scraping"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475672832, "post_id": 39874763, "comment_id": 67036130, "body": "I&#39;m surprised this works at all - remove the <code>Set IE = Nothing</code> from inside the <code>With IE</code> block."}, {"owner": {"reputation": 45, "user_id": 6722686, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/83f1f47d7d12d267a246ebc797e75c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Henry K", "link": "https://stackoverflow.com/users/6722686/henry-k"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475673096, "post_id": 39874763, "comment_id": 67036314, "body": "You&#39;re the best! That was actually leftover from a suggestion by someone else. I removed it, and the macro is cycling fine so far."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6722686, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/83f1f47d7d12d267a246ebc797e75c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Henry K", "link": "https://stackoverflow.com/users/6722686/henry-k"}, "edited": false, "score": 0, "creation_date": 1475673678, "post_id": 39875090, "comment_id": 67036799, "body": "Hmm, I see where you&#39;re coming from with the Set IE = Nothing, but I&#39;m not sure I follow with the second issue. The macro makes it through the .ready state, I think because it&#39;s able to cycle through the list of URLs I provide it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 45, "user_id": 6722686, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/83f1f47d7d12d267a246ebc797e75c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Henry K", "link": "https://stackoverflow.com/users/6722686/henry-k"}, "edited": false, "score": 0, "creation_date": 1475674805, "post_id": 39875090, "comment_id": 67037711, "body": "@HenryK - If you try to pass a <code>vbNullString</code> for IE to navigate to, it doesn&#39;t do anything. That means this loop: <code>While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend</code> will never exit because <code>.Busy</code> will be false and <code>.readyState</code> will be stuck at 0."}, {"owner": {"reputation": 45, "user_id": 6722686, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/83f1f47d7d12d267a246ebc797e75c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Henry K", "link": "https://stackoverflow.com/users/6722686/henry-k"}, "edited": false, "score": 0, "creation_date": 1475675042, "post_id": 39875090, "comment_id": 67037908, "body": "So I added the step you recommended for the vbnull string and, the macro is freezing again. It makes it through about 20 links, and then just freezes."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 45, "user_id": 6722686, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/83f1f47d7d12d267a246ebc797e75c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Henry K", "link": "https://stackoverflow.com/users/6722686/henry-k"}, "edited": false, "score": 0, "creation_date": 1475676876, "post_id": 39875090, "comment_id": 67039362, "body": "@HenryK - The next step would be to add a timeout to your loop.  <a href=\"http://stackoverflow.com/a/22113734/4088852\">See this answer</a>."}, {"owner": {"reputation": 45, "user_id": 6722686, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/83f1f47d7d12d267a246ebc797e75c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Henry K", "link": "https://stackoverflow.com/users/6722686/henry-k"}, "edited": false, "score": 0, "creation_date": 1475679068, "post_id": 39875090, "comment_id": 67041186, "body": "You the man again. Running smooth now. Through 100 loops and counting."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1475673523, "creation_date": 1475673523, "answer_id": 39875090, "question_id": 39874763, "link": "https://stackoverflow.com/questions/39874763/scraping-macro-freezing-after-just-a-couple-loops/39875090#39875090", "title": "Scraping Macro Freezing after Just a Couple Loops", "body": "<p>2 issues.  First (and likely not related to the issue since you don't mention a run-time error) is that you are releasing the IE object inside your <code>With IE</code> block.  Remove this line:</p>\n\n<pre><code>Set IE = Nothing\n</code></pre>\n\n<p>The second issue (and more likely the cause of the hang), is that you never test the value of <code>rngLink</code> before passing it to <code>.Navigate</code>.  If <code>rngLink</code> evaluates to <code>vbNullString</code>, the IE object will never change the <code>.readyState</code> from <code>READYSTATE_UNINITIALIZED</code>, so your wait loop will never exit. I'd add a simple test:</p>\n\n<pre><code>If rngLink &lt;&gt; vbNullString Then\n    .navigate rngLink\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6722686, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/83f1f47d7d12d267a246ebc797e75c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Henry K", "link": "https://stackoverflow.com/users/6722686/henry-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 39875090, "answer_count": 1, "score": 0, "last_activity_date": 1538335867, "creation_date": 1475672627, "last_edit_date": 1538335867, "question_id": 39874763, "link": "https://stackoverflow.com/questions/39874763/scraping-macro-freezing-after-just-a-couple-loops", "title": "Scraping Macro Freezing after Just a Couple Loops", "body": "<p>I have a scraping macro that used to work just fine, and is now freezing after just a couple loops (sometimes one). I've done what I can think of to optimize the macro to not take up too much CPU. I am completely confused as to why the macro would be freezing like this. My code is below, any tips or critiques would be much appreciated!</p>\n\n<pre><code>    Application.DisplayStatusBar = True\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Dim wb1 As Workbook\n    Dim ws1 As Worksheet\n    Dim Rows As Long, IE As InternetExplorer\n    Dim i As Long\n    Dim rngLinks As Range, rngLink As Range\n\n    Sheet1.Cells.ClearContents\n    Sheets(\"Landing Page\").Select\n    Range(\"E7\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet1\").Range(\"A1\").PasteSpecial xlPasteValues\n\n    Sheets(\"Landing Page\").Select\n    Range(\"B5\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n\n    Set wb1 = ThisWorkbook\n    Set ws1 = wb1.Worksheets(\"Sheet1\")\n    Set IE = New InternetExplorer\n\n    Rows = ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row\n    Set rngLinks = ws1.Range(\"A2:A\" &amp; Rows)\n    i = 2\n\n    With IE\n        .Visible = True\n\n        For Each rngLink In rngLinks\n            .navigate (rngLink)\n\n            While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n            Application.Wait (Now() + TimeValue(\"00:00:004\"))\n\n            Dim doc As Object, dd As String\n            Set doc = IE.document\n\n            On Error GoTo Errorhandler:\n            dd = doc.getElementsByClassName(\"price-display csTile-price\")(0).innerText\n\n            ws1.Range(\"B\" &amp; i).Value = dd\n\n            i = i + 1\n\n            Application.StatusBar = i\n\n            dd = \"\"\n\n            Set IE = Nothing\n        Next rngLink\n    End With\n\nErrorhandler:\n\n    dd = \"\"\n\n    Resume Next\n\n    Application.Calculation = xlCalculationAutomatic\n    ws1.Activate\n    Set rngLinks = Nothing\n\n    'Strip out everything but total price\n\n    Range(\"C2\").Select\n    ActiveCell.FormulaR1C1 = \"=LEFT(RC[-1],FIND(\"\" \"\",RC[-1])-0)\"\n    Range(\"C2\").Select\n    Selection.AutoFill Destination:=Range(\"C2:C\" &amp; Rows), Type:=xlFillDefault\n    Range(\"C2:C\" &amp; Rows).Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                           :=False, Transpose:=False\n\n    'Apply OnlyNums formula to remove delimeters\n    Range(\"D2\").Select\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"=OnlyNums(RC[-1])\"\n    Range(\"D2\").Select\n    Selection.AutoFill Destination:=Range(\"D2:D\" &amp; Rows), Type:=xlFillDefault\n    Range(\"D2:D\" &amp; Rows).Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                           :=False, Transpose:=False\n\n    'Add decimal back in\n    Range(\"E2\").Select\n    ActiveCell.FormulaR1C1 = \"=iferror(RC[-1]/100,\"\" \"\")\"\n    Range(\"E2\").Select\n    Selection.AutoFill Destination:=Range(\"E2:E\" &amp; Rows), Type:=xlFillDefault\n    Range(\"E2:E\" &amp; Rows).Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                           :=False, Transpose:=False\n    Application.CutCopyMode = False\n    Selection.Style = \"Currency\"\n\n    'Remove columns C and D\n    Columns(\"C:D\").Select\n    Selection.Delete Shift:=xlToLeft\n\n    'Add column headers to F and G\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"HTML Export (Raw)\"\n\n    Range(\"C1\").Select\n    ActiveCell.FormulaR1C1 = \"Price\"\n\n    Application.DisplayStatusBar = True\n    Application.EnableEvents = True\n    Application.DisplayPageBreaks = False\n\n    Range(\"D1\").Select\n    ActiveCell.FormulaR1C1 = \"Collection Date\"\n    Rows2 = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n    Range(\"D2:D\" &amp; Rows2).Value = Date\n    Range(\"E1\").Select\n    ActiveCell.FormulaR1C1 = \"Company Store Number\"\n    Range(\"F1\").Select\n    ActiveCell.FormulaR1C1 = \"UPC\"\n\n    Sheets(\"Landing Page\").Select\n    Range(\"B8\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet1\").Range(\"E2\").PasteSpecial xlPasteValues\n\n    Sheets(\"Landing Page\").Select\n    Range(\"E8\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet1\").Range(\"A2\").PasteSpecial xlPasteValues\n\n    Sheets(\"Landing Page\").Select\n    Range(\"D8\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet1\").Range(\"F2\").PasteSpecial xlPasteValues\n\n    ws1.Activate\n\n    Application.Calculation = xlCalculationAutomatic\n\n    Dim acc As New Access.Application\n\n    acc.OpenCurrentDatabase \"S:\\Aditem\\Pricing\\Scraping\\Database.accdb\"\n    acc.DoCmd.TransferSpreadsheet _\n        TransferType:=acImport, _\n        SpreadSheetType:=acSpreadsheetTypeExcel12, _\n        TableName:=\"Company\", _\n        Filename:=Application.ActiveWorkbook.FullName, _\n        HasFieldNames:=True, _\n        Range:=\"Sheet1$C1:F\" &amp; Rows\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1475674536, "post_id": 39875215, "comment_id": 67037492, "body": "thank you for you reply. On you first function I get an error on &quot;Activate&quot; line &quot;Activate method of Range class failed&quot;. On the Second function, correct me if am wrong I have just changed the function to Private Sub Worksheet_Changes(ByVal sh As Object, ByVal Target As Range), but its still giving me generic message &quot;Cell or Chart you are trying to change is protected...&quot;"}, {"owner": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1475674924, "post_id": 39875215, "comment_id": 67037810, "body": "If you don&#39;t use <code>Select</code> remove the <code>Activate</code>."}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1475675210, "post_id": 39875215, "comment_id": 67038047, "body": "yeah, I have commented the Activate and first function working fine."}, {"owner": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1475675632, "post_id": 39875215, "comment_id": 67038386, "body": "Remove the <code>ByVal sh as Object</code> in <code>Private Sub WorkBook_SheetChange</code>. Then, remplace <code>sh.Range(&quot;$E$19:$I$3000&quot;)</code> by <code>Range(&quot;$E$19:$I$3000&quot;)</code>. And finally, write <code>Private Sub WorkBook_SheetChange(Range(&quot;E20:I3019&quot;))</code> after <code>.Range(&quot;E20:I3019&quot;).Locked = False</code>"}, {"owner": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1475675917, "post_id": 39875215, "comment_id": 67038627, "body": "I hope those private subs are in the same module...Otherwise try to change private into public. If something helps you could you please, put it useful?"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1475676405, "post_id": 39875215, "comment_id": 67039013, "body": "Definitely, I think we are closer. Both the functions are on different sheet? Do you want me to use on same sheet. I am totally confused with your last comment &quot;And finally, write Private Sub WorkBook_SheetChange(Range(&quot;E20:I3019&quot;)) after .Range(&quot;E20:I3019&quot;).Locked = False&quot; ......"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1475677032, "post_id": 39875215, "comment_id": 67039496, "body": "I changed function to Private Sub Worksheet_Change(ByVal Target As Range). It throwing a prompt now. Unfortunately, its throwing prompt when the cells are unlocked not while its locked/disabled."}, {"owner": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1475678346, "post_id": 39875215, "comment_id": 67040539, "body": "Sorry but I can not help you without any code. Great if it showing the prompt. It is now a problem of logic. Yout just have to change your condition, just call the function when <code>.Range(&quot;E20:I3019&quot;).Locked = True</code> .... I wanted you to call the sub inside the other but you figured out as I understood. If it helped you, could please upvote?"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1475678779, "post_id": 39875215, "comment_id": 67040931, "body": "thank you. I will try to play around. But not sure if its helps me to serve my purpose. Thank you very much for your help!!"}], "tags": [], "owner": {"reputation": 118, "user_id": 2336626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d03c21b2405a636c6cc360f92603cb7c?s=128&d=identicon&r=PG", "display_name": "Ary", "link": "https://stackoverflow.com/users/2336626/ary"}, "is_accepted": true, "score": 1, "last_activity_date": 1475678503, "last_edit_date": 1475678503, "creation_date": 1475673859, "answer_id": 39875215, "question_id": 39874664, "link": "https://stackoverflow.com/questions/39874664/vba-to-throw-a-prompt-when-clicked-on-protected-cell/39875215#39875215", "title": "VBA to throw a prompt when clicked on protected cell", "body": "<p>First. You should remove the <code>Sheets(\"SubSheet\").Select</code>. If you running your code and your are not inside the sheet, it could occur an error. try to do:</p>\n\n<pre><code>with ThisWorkbook.Sheets(\"SubSheet\")\n  If UCase$(Range(\"E30\").Value) = \"YES\" Then\n    .Range(\"E20:I3019\").Locked = False\n    .Range(\"E20:I3019\").Activate\n  Else\n    .Range(\"E20:I3019\").Locked = True\n  End If\nend with\n</code></pre>\n\n<p>Second. You don't return the target range. I mean your <code>Private Sub WorkBook_SheetChange</code> waits for a <code>ByVal Target</code> as a parameter and your <code>Private Sub Worksheet_Change</code> returns any value.It should be a function returning the range or the cell you have selected for me.</p>\n\n<p>EDIT:</p>\n\n<pre><code>with ThisWorkbook.Sheets(\"SubSheet\")\n  If UCase$(Range(\"E30\").Value) = \"YES\" Then\n    .Range(\"E20:I3019\").Locked = False\n  Else\n    .Range(\"E20:I3019\").Locked = True\n     WorkBook_SheetChange Range(\"E20:I3019\")\n  End If\nend with\n</code></pre>\n\n<p>And </p>\n\n<pre><code>Private Sub WorkBook_SheetChange(ByVal Target as Range)\n    If Intersect (Target, Range(\"$E$19:$I$3000\")) Is Nothing Then Exit Sub\n    MsgBox \"Please select the appropriate dropdown on MAIN Sheet \" &amp;    Target.Address\n    With Application\n       .EnableEvents = False\n       .UnDo\n       .EnableEvents = True\n    End With\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 39875215, "answer_count": 1, "score": 0, "last_activity_date": 1475678503, "creation_date": 1475672380, "question_id": 39874664, "link": "https://stackoverflow.com/questions/39874664/vba-to-throw-a-prompt-when-clicked-on-protected-cell", "title": "VBA to throw a prompt when clicked on protected cell", "body": "<p>I have Workbook with both Sheet/workbook is protected.\nI have a code to lock/disable certain range of cells when the drop-down value \"no\" And unlock/enable when value of drop down is \"yes\"\nWhereas, drop-down value and cells I would like to disable are on different sheets.</p>\n\n<p>Dropdown on \"Main Sheet\"\nRange of cells on \"Sub Sheet\"</p>\n\n<p>I also need to throw a prompt to user when he clicks on protected range and when the value is set to \"No\".</p>\n\n<p>I am using following code on \"Main Sheet\"</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim worksh As Integer\nDim worksheetexists As Boolean\nDim str1 As String\n\nIf UCase$(Range(\"E30\").Value) = \"YES\" Then\n               Sheets(\"SubSheet\").Select\n               Sheets(\"SubSheet\").Range(\"E20:I3019\").Locked = False\n               Sheets(\"SubSheet\").Range(\"E20:I3019\").Activate\n           Else\n                Sheets(\"SubSheet\").Range(\"E20:I3019\").Locked = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Following code on Sub Sheet</p>\n\n<pre><code>Private Sub WorkBook_SheetChange(ByVal sh as Object, ByVal Target as Range)\nIf Intersect (Target, sh.Range(\"$E$19:$I$3000\")) Is Nothing Then Exit Sub\nMsgBox \"Please select the appropriate dropdown on MAIN Sheet \" &amp; Target.Address\nWith Application\n    .EnableEvents = False\n    .UnDo\n    .EnableEvents = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Not sure, where am I going wrong as Its not throwing prompt when user clicks on protected cells.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 1, "last_activity_date": 1475674527, "last_edit_date": 1475674527, "creation_date": 1475673448, "answer_id": 39875063, "question_id": 39873445, "link": "https://stackoverflow.com/questions/39873445/display-items-in-a-list-with-font-colors-in-vba/39875063#39875063", "title": "Display items in a list with font colors in vba", "body": "<p>Do you want to use coloured fonts or coloured backgrounds?  If font, you need a selection of dark colours.  If backgrounds, you need a selection of light colours.</p>\n\n<p>Next pick some colours you like are which are sufficiently different to give adequate contrast.</p>\n\n<p>Having selected the colours, you want from the palette, go back to the palette and select \u201cMore Colours\u201d then \u201cCustom\u201d for each colour.  This will show the red, green and blue components which you have to record.</p>\n\n<p>This is my list of colours:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3Wrwm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Wrwm.png\" alt=\"My colour table\"></a></p>\n\n<p>I have selected four dark and four light colours.  You only need two but you can have as many as you wish.  I have not put a lot of thought into my selection of colours, so I doubt this list will appeal to you.</p>\n\n<p>Next load this information to an array:</p>\n\n<pre><code> Dim Colours() As Variant\n Colours = VBA.Array(RGB(0, 0, 0), RGB(192, 0, 0), RGB(0, 32, 96), RGB(55, 86, 35))\n \u2018 or\n Colours = VBA.Array(RGB(248, 203, 173), RGB(255, 230, 153), RGB(180, 198, 231), RGB(169, 208, 142))\n</code></pre>\n\n<p>' You cycle though these colours so:</p>\n\n<p>InxColour = LBound(Colours)</p>\n\n<pre><code>  'For Each row\n    'If need new colour because current cell different from previous\n      InxColour = InxColour + 1\n      If InxColour &gt; UBound(Colours) Then\n        InxColour = LBound(Colours)\n      End If\n    End If\n    'Colour cell\n  Next\n</code></pre>\n\n<p>To colour a cell, use one of the following:</p>\n\n<pre><code>.Cells(Row, Column).Font.Color = Colours(InxColour)\n.Cells(Row, Column).Interior.Color = Colours(InxColour)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1475677376, "post_id": 39876342, "comment_id": 67039769, "body": "Please do not select each cell.  Select is much slower than .Cell(Row, Column).  You can reduce the duration a little by adding <code>Application.ScreenUpdating = False</code> at the top."}], "tags": [], "owner": {"reputation": 199, "user_id": 4415301, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p2GZU.jpg?s=128&g=1", "display_name": "Obfuscated", "link": "https://stackoverflow.com/users/4415301/obfuscated"}, "is_accepted": false, "score": 0, "last_activity_date": 1475676780, "creation_date": 1475676780, "answer_id": 39876342, "question_id": 39873445, "link": "https://stackoverflow.com/questions/39873445/display-items-in-a-list-with-font-colors-in-vba/39876342#39876342", "title": "Display items in a list with font colors in vba", "body": "<p>What I came up with is this:</p>\n\n<pre><code>Sub ColrFonts()\nDim rn As Long\nDim LastSel As String\nDim MyCounter As Integer\n\n' Make entire column font = black\nRange(\"A:A\").Select\nWith Selection.font\n    .Color = vbBlack\nEnd With\n\nrn = getlast1(\"A\") ' function to find last row number used\nMyCounter = 1\n\nLastSel = Range(\"A4\").Value\n\nFor a = 5 To rn\n    LastSel = Range(\"A\" &amp; a - 1).Value\n    Range(\"A\" &amp; a).Select\n    If Range(\"A\" &amp; a) = LastSel Then\n        With Selection.font\n            If MyCounter = 1 Then\n                .Color = vbBlack\n            End If\n            If MyCounter = 2 Then\n                .Color = vbRed\n            End If\n        End With\n    End If\n    If Range(\"A\" &amp; a) &lt;&gt; LastSel Then\n        MyCounter = MyCounter + 1\n        If MyCounter = 3 Then MyCounter = 1\n            With Selection.font\n            If MyCounter = 1 Then\n                .Color = vbBlack\n            End If\n            If MyCounter = 2 Then\n                .Color = vbRed\n            End If\n        End With\n    End If\nNext a\nEnd Sub\n</code></pre>\n\n<p>I put this together after I posted my question.\nI can \"plod\" through and usually come up with something but,\nI was hoping there would be a more efficient way of doing it.</p>\n"}], "owner": {"reputation": 199, "user_id": 4415301, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p2GZU.jpg?s=128&g=1", "display_name": "Obfuscated", "link": "https://stackoverflow.com/users/4415301/obfuscated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475676780, "creation_date": 1475669004, "last_edit_date": 1531164843, "question_id": 39873445, "link": "https://stackoverflow.com/questions/39873445/display-items-in-a-list-with-font-colors-in-vba", "title": "Display items in a list with font colors in vba", "body": "<p>It was tough making a title for this question...</p>\n\n<p>I have a list (ever changing) that may look similar to this...</p>\n\n<pre><code>DS100\nDS100\nDS200\nDS200\nDS300\nDS300\n</code></pre>\n\n<p>New items may/will be added that may/will be the same or different from an existing item. A sort routine puts them all in order like above. I then need to change the color of the font when a difference is found.\nFor example: DS100 - Blue font, DS200 - Red font, DS300 - Back to blue font.</p>\n\n<p>Each section may be 1 to ?? rows of entries. I want to tell at a glance, where the items change by changing the font color at the end of the sort routine. (Clear as mud?)</p>\n"}, {"tags": ["vba", "excel", "merge", "calendar"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 3014531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620c0c44cbe55a6357dee7dff7c17a0c?s=128&d=identicon&r=PG&f=1", "display_name": "JavaStarta", "link": "https://stackoverflow.com/users/3014531/javastarta"}, "edited": false, "score": 0, "creation_date": 1475671063, "post_id": 39873975, "comment_id": 67034832, "body": "Axel, thank you very much indeed for that perfect answer. That&#39;s got the it working 100% now, appreciate the quick response! Have a great day, mine certainly is better now. Thanks again!"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 1, "last_activity_date": 1475670496, "creation_date": 1475670496, "answer_id": 39873975, "question_id": 39873414, "link": "https://stackoverflow.com/questions/39873414/excel-2003-calendar-object-vba-wont-work-when-clicking-merged-cells/39873975#39873975", "title": "Excel 2003: Calendar Object / VBA won&#39;t work when clicking merged cells", "body": "<p>If you select a merged cell's range, then <code>Target.Cells.Count</code> is always greater than 1. There are more than one cell, even if you can't select them individually.</p>\n\n<p>If you need only allow select single cells or single merged ranges, then you could do:</p>\n\n<pre><code>If Target.Address &lt;&gt; Target.Cells(1, 1).MergeArea.Address Then Exit Sub\n</code></pre>\n\n<p>This will work with single cells and with merged cells.</p>\n"}], "owner": {"reputation": 67, "user_id": 3014531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620c0c44cbe55a6357dee7dff7c17a0c?s=128&d=identicon&r=PG&f=1", "display_name": "JavaStarta", "link": "https://stackoverflow.com/users/3014531/javastarta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 39873975, "answer_count": 1, "score": 0, "last_activity_date": 1475670496, "creation_date": 1475668920, "question_id": 39873414, "link": "https://stackoverflow.com/questions/39873414/excel-2003-calendar-object-vba-wont-work-when-clicking-merged-cells", "title": "Excel 2003: Calendar Object / VBA won&#39;t work when clicking merged cells", "body": "<p>I'm having a little issue getting the calendar object I've inserted into my excel sheet to work. I have an identical calendar object, with identical (except for the column reference) code on another sheet that works perfectly. The only difference is that in Sheet A (the problem sheet) the cells I'm selecting (where I want the calendar object to pop up) are merged and centered. This seems to cause an issue. When I set the reference in the code to be the entire of column L for  example, the calendar object will work for all cells in that column that have not been merged or centered. (To be clear, the cells are only merged in the column and not across any rows). Does anyone have any idea how I can solve this? I have to have those cells merged, there isn't anyway I can get round that. If anyone has any suggestions I'd really appreciate it, this has been driving me nuts all day! Thank you in advance.</p>\n\n<p>Code (not my own) is below; </p>\n\n<pre><code>    Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n     If Target.Cells.Count &gt; 1 Then Exit Sub\n      'Change this to your range of dates\n     If Not Intersect(Target, Range(\"L:L\")) Is Nothing Then\n       Calendar2.Top = Target.Top + Target.Height\n       Calendar2.Left = Target.Left + Target.Width / 2 - Calendar2.Width / 2\n       Calendar2.Visible = True\n       Calendar2.Value = Now\n     ElseIf Calendar2.Visible Then Calendar2.Visible = False\n    End If\n End Sub\n Private Sub Calendar2_Click()\n ActiveCell.Value = (Calendar2.Value)\n ActiveCell.NumberFormat = \"dd mmm yy\"\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv", "macros"], "answers": [{"tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 1, "last_activity_date": 1475669303, "creation_date": 1475669303, "answer_id": 39873565, "question_id": 39873234, "link": "https://stackoverflow.com/questions/39873234/how-to-add-quotes-for-every-string-value-in-a-csv-file-via-excel-vba/39873565#39873565", "title": "How to add quotes for every string value in a csv file via Excel VBA?", "body": "<p>Read the text file in using line input, then taylor the following process to your needs:</p>\n\n<pre><code>Sub y()\na = \"a,b,c,d\"\n\n'Split into 1d Array\nb = Split(a, \",\", , vbTextCompare)\n\n'for each element in array add the quotes\nFor c = 0 To UBound(b)\n    b(c) = \"\"\"\" &amp; b(c) &amp; \"\"\"\"\nNext c\n\n'join the product up\nd = Join(b, \",\")\n\n'Print her out\nDebug.Print d\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6901770, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154642415173159/picture?type=large", "display_name": "Agung Hutomo", "link": "https://stackoverflow.com/users/6901770/agung-hutomo"}, "is_accepted": false, "score": 0, "last_activity_date": 1475669792, "creation_date": 1475669792, "answer_id": 39873716, "question_id": 39873234, "link": "https://stackoverflow.com/questions/39873234/how-to-add-quotes-for-every-string-value-in-a-csv-file-via-excel-vba/39873716#39873716", "title": "How to add quotes for every string value in a csv file via Excel VBA?", "body": "<p>use workbooks.opentext filename:=\"your csv file with path\",\nIt will open the csv and separate them into cells,\nthen apply your macro and save again as csv</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1475678797, "last_edit_date": 1495535550, "creation_date": 1475678797, "answer_id": 39877172, "question_id": 39873234, "link": "https://stackoverflow.com/questions/39873234/how-to-add-quotes-for-every-string-value-in-a-csv-file-via-excel-vba/39877172#39877172", "title": "How to add quotes for every string value in a csv file via Excel VBA?", "body": "<p>By emulating a string builder I was able to process a CSV file with 59,507 Rows x 9 Columns in just over 3 seconds.  This process is much faster that standard concatenation.  </p>\n\n<p>This function was modified from my answer to <a href=\"https://stackoverflow.com/questions/39597999/turn-excel-range-into-vba-string/39863267#39863267\">Turn Excel range into VBA string</a></p>\n\n<h2>Test</h2>\n\n<pre><code>Sub TestProcessCSVFile()\n    Dim s As String\n    Dim Start: Start = Timer\n\n    ProcessCSVFile \"C:\\Users\\Owner\\Downloads\\SampleCSVFile_53000kb.csv\", \"C:\\Users\\Owner\\Downloads\\_temp.csv\"\n\n    Debug.Print \"Execution Time: \"; Timer - Start; \"Second(s)\"\n\nEnd Sub\n</code></pre>\n\n<h2>Code</h2>\n\n<pre><code>Sub ProcessCSVFile(OldFile As String, NewFile As String)\n    Dim Data As String, text As String\n    Dim vCell\n    Dim length As Long\n\n    Open OldFile For Binary As #1\n    Data = Space$(LOF(1))\n    Get #1, , Data\n    Close #1\n\n    text = Space(Len(Data) * 1.5)\n\n    For Each vCell In Split(Replace(Data, vbCrLf, \",\" &amp; vbCrLf &amp; \",\"), \",\")\n        If Len(vCell) + length + 5 &gt; Len(text) Then text = text &amp; Space(Len(Data) * 0.1)\n\n        If vCell = vbCrLf Then\n            Mid(text, length, 1) = vbCrLf\n        ElseIf IsNumeric(vCell) Then\n            Mid(text, length + 1, Len(vCell) + 1) = vCell &amp; \",\"\n            length = length + Len(vCell) + 1\n        Else\n            Mid(text, length + 1, Len(vCell) + 3) = Chr(34) &amp; vCell &amp; Chr(34) &amp; \",\"\n            length = length + Len(vCell) + 3\n        End If\n\n    Next\n\n    Open NewFile For Output As #1\n    Print #1, Left(text, length - 1)\n    Close #1\n\nEnd Sub\n</code></pre>\n\n<h2>Results</h2>\n\n<p><a href=\"https://i.stack.imgur.com/SOebm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SOebm.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 913, "user_id": 6699735, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f06803a9fde9186cd86ab8a02ff122ac?s=128&d=identicon&r=PG&f=1", "display_name": "vlad.rad", "link": "https://stackoverflow.com/users/6699735/vlad-rad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "accepted_answer_id": 39877172, "answer_count": 3, "score": 0, "last_activity_date": 1475678797, "creation_date": 1475668385, "last_edit_date": 1475668871, "question_id": 39873234, "link": "https://stackoverflow.com/questions/39873234/how-to-add-quotes-for-every-string-value-in-a-csv-file-via-excel-vba", "title": "How to add quotes for every string value in a csv file via Excel VBA?", "body": "<p>I have a csv file, and I need a VBA function that adds quotes to every string value in the file, so that something like</p>\n\n<pre><code>vertical,device_name,value\nmobile,Apple iPad,0\nmobile,HTC,3\n</code></pre>\n\n<p>looks like </p>\n\n<pre><code>\"vertical\",\"device_name\",\"value\"\n\"mobile\",\"Apple iPad\",0\n\"mobile\",\"HTC\",3\n</code></pre>\n\n<p>What I have found until now is a macro, </p>\n\n<pre><code>Sub QuotesAroundText()\n    Dim c As Range\n    For Each c In Selection\n        If Not IsNumeric(c.Value) Then\n            c.Value = \"\"\"\" &amp; c.Value &amp; \"\"\"\"\n        End If\n    Next c\nEnd Sub\n</code></pre>\n\n<p>that does almost exactly what I need - it add the quotes, but not to string, but to excel cells. That means, that this macro does work correctly in a xlsx file, but not in a csv file.</p>\n\n<p>So I need a vba code that adds quotes not to cells, but to string, that are between commas. </p>\n"}, {"tags": ["vba", "text", "macros", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "edited": false, "score": 0, "creation_date": 1475675040, "post_id": 39873427, "comment_id": 67037906, "body": "Thanks. How do I do this for the selected text?"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 3, "last_activity_date": 1475668958, "creation_date": 1475668958, "answer_id": 39873427, "question_id": 39873213, "link": "https://stackoverflow.com/questions/39873213/reverse-text-word-by-word/39873427#39873427", "title": "Reverse text word by word", "body": "<p>When you are using a for each loop, you are unable to change the word, so use a for loop:</p>\n\n<pre><code>Dim i As Integer\n\nFor i = 1 To ActiveDocument.Words.Count Step 1\n\n    ActiveDocument.Words(i) = StrReverse(ActiveDocument.Words(i)) &amp; \" \"\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": 0, "last_activity_date": 1475679733, "creation_date": 1475679733, "answer_id": 39877544, "question_id": 39873213, "link": "https://stackoverflow.com/questions/39873213/reverse-text-word-by-word/39877544#39877544", "title": "Reverse text word by word", "body": "<pre><code>Sub ReverseSelectedWords()\n    Dim i As Integer\n    Dim oWords As Words\n    Dim oWord As Range\n\n    Set oWords = Selection.Range.Words\n\n    For i = 1 To oWords.Count Step 1\n\n        Set oWord = oWords(i)\n\n        ''Make sure the word range doesn't include a space\n        Do While oWord.Characters.Last.text = \" \"\n            Call oWord.MoveEnd(WdUnits.wdCharacter, -1)\n        Loop\n\n        Debug.Print \"'\" &amp; oWord.text &amp; \"'\"\n        oWord.text = StrReverse(oWord.text)\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1490616273, "creation_date": 1475668296, "question_id": 39873213, "link": "https://stackoverflow.com/questions/39873213/reverse-text-word-by-word", "title": "Reverse text word by word", "body": "<p>I want to reverse words in a Word document like this: \"elpmaS texT\" becomes \"Sample Text\".  </p>\n\n<p>I tried something like this:  </p>\n\n<pre><code>For Each word In ActiveDocument.Words\n    word = StrReverse(word)\nNext word\n</code></pre>\n\n<p>However it doesn't work.  </p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["arrays", "vba", "excel", "properties"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1475673283, "post_id": 39872663, "comment_id": 67036474, "body": "I can&#39;t explain why but would guess that a fixed size copy of the array is actually being passed to the property let procedure. The only real difference between your <code>Property Let</code> and your <code>LetDummy</code> sub is that property procedures always take their arguments <code>ByVal</code> and since you can&#39;t pass an array ByVal in VBA, it has to be getting a copy. Why it works if you call the property directly, I couldn&#39;t say for sure."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508458265, "post_id": 39872663, "comment_id": 80629026, "body": "Wow, Excel actually crashed on me (the whole &quot;Excel has stopped working&quot; thing) trying to experiment with this."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508463189, "post_id": 39872663, "comment_id": 80630209, "body": "@Rory - <i>property procedures always take their arguments <code>ByVal</code></i> - Is that documented somewhere? I can see that the <code>VarPtr</code> on a property argument is different, so it&#39;s clearly a copy, but the <a href=\"https://msdn.microsoft.com/en-us/library/aa266197(v=vs.60).aspx\" rel=\"nofollow noreferrer\">documentation</a> just says &quot;ByRef is the default in Visual Basic&quot;"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 2, "creation_date": 1508484489, "post_id": 39872663, "comment_id": 80636003, "body": "@ThunderFrame it&#39;s in the language specification: &quot;If the &lt;value-param&gt; of a &lt;property-LHS-declaration&gt; does not have a &lt;parameter-mechanism&gt; element or has a &lt;parameter-mechanism&gt; consisting of the keyword ByRef, it has the same meaning as if it instead had a &lt;parameter-mechanism&gt; element consisting of the keyword ByVal.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1476003556, "post_id": 39873027, "comment_id": 67164347, "body": "@markovcd, so you chose to add a new variable and accept the little more hussle it brings along instead of simply declaring <code>Public Property Let Dummy(v As Variant)</code>?"}, {"owner": {"reputation": 147, "user_id": 4850829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89569a7b38bd5f11bd8f481fef66e4a2?s=128&d=identicon&r=PG&f=1", "display_name": "markovcd", "link": "https://stackoverflow.com/users/4850829/markovcd"}, "edited": false, "score": 0, "creation_date": 1476275713, "post_id": 39873027, "comment_id": 67275141, "body": "Changing type to variant made cascade of errors in my code. Decided to go with this one. Upvoted your answer of course as it is valid."}], "tags": [], "owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "is_accepted": true, "score": 4, "last_activity_date": 1475667710, "creation_date": 1475667710, "answer_id": 39873027, "question_id": 39872663, "link": "https://stackoverflow.com/questions/39872663/inconsistent-behavior-when-assigning-array-to-a-property-let/39873027#39873027", "title": "Inconsistent behavior when assigning array to a property let", "body": "<p>It looks like a bug to me since Error 51 says to contact MS if you get it.</p>\n\n<p>If I create a local variable, assign it, then pass it along it seems to work.</p>\n\n<p>Very hacky.</p>\n\n<pre><code>Option Explicit\n\nPrivate ary() As Integer\n\nPublic Property Get Dummy() As Integer()\n    Dummy = ary\nEnd Property\n\nPublic Property Let Dummy(v() As Integer)\n    Debug.Print \"In Dummy\" &amp; UBound(v)\n    ary = v\n\nEnd Property\n\nPublic Sub LetDummy(v() As Integer)\n    Debug.Print \"In LetDummy\" &amp; UBound(v)\nEnd Sub\n\nSub Foo()\n    ReDim i(0 To 2) As Integer\n    i(0) = 3\n    i(1) = 45\n    i(2) = 10\n\n    Call Bar(i)  ' internal error 51\nEnd Sub\n\nSub Foo2()\n    ReDim i(0 To 2) As Integer\n    i(0) = 3\n    i(1) = 45\n    i(2) = 10\n\n    Bar2 i ' no error\nEnd Sub\n\nSub Foo3()\n    ReDim i(0 To 2) As Integer\n    i(0) = 3\n    i(1) = 45\n    i(2) = 10\n\n    Dummy = i ' no error\nEnd Sub\n\nSub Bar(j() As Integer)\n    Dim i() As Integer\n    i = j\n\n    Dummy = i\n\n    Dim x As Integer\n    Dim myary() As Integer\n    myary = Dummy\n    For x = 0 To 2\n        Debug.Print myary(x)\n    Next\nEnd Sub\n\nSub Bar2(j() As Integer)\n    LetDummy j\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1475678441, "post_id": 39873577, "comment_id": 67040615, "body": "Would the brave downvoter ever add some kind note and have both the OP and me know what&#39;s wrong with this answer and let me improve it. I can add that, of course, it works."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1475735311, "post_id": 39873577, "comment_id": 67064092, "body": "I got to this solution after experimenting such a behavior as Rory described. In fact my last trial was to pass the array by reference while this was not permitted. So I decided to try with Variant type instead of an array and it worked. BTW if I fullfilled your question you may want to mark answer as accepted. Thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1475669342, "creation_date": 1475669342, "answer_id": 39873577, "question_id": 39872663, "link": "https://stackoverflow.com/questions/39872663/inconsistent-behavior-when-assigning-array-to-a-property-let/39873577#39873577", "title": "Inconsistent behavior when assigning array to a property let", "body": "<p>use <code>Variant</code></p>\n\n<pre><code>Public Property Let Dummy(v As Variant)\n\nEnd Property\n\n'rest is the same\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1508463218, "creation_date": 1508463218, "answer_id": 46841174, "question_id": 39872663, "link": "https://stackoverflow.com/questions/39872663/inconsistent-behavior-when-assigning-array-to-a-property-let/46841174#46841174", "title": "Inconsistent behavior when assigning array to a property let", "body": "<p>That's quite an interesting bug. While trying to reproduce it I came up with this:</p>\n\n<pre><code>Public Property Let Foo(ByRef values() As Long)\nEnd Property\n\nPublic Sub Test()\n    Dim values(0 To 1) As Long\n    values(0) = 1\n    values(1) = 2\n    IllegalByRefArray values\nEnd Sub\n\nPrivate Sub IllegalByRefArray(ByRef values() As Long)\n    Stop 'break here or crash Excel\n    Foo = values\nEnd Sub\n</code></pre>\n\n<p>Instead of run-time error 51, I got a hard crash. \"Excel has stopped working\", and poof, gone. Running 64-bit Excel 2010.</p>\n\n<p>Running Excel with a Visual Studio debugger attached, I could see how the EXCEL.EXE process completely blows up on the <code>Foo = values</code> assignment:</p>\n\n<blockquote>\n  <p>Unhandled exception at 0x00007FFF834E4B90 (ntdll.dll) in EXCEL.EXE: 0xC0000028: An invalid or unaligned stack was encountered during an unwind operation</p>\n</blockquote>\n\n<p>So there's definitely something fishy going on. Thing is, a property that exposes an array is kind of a weird thing in the first place: <em>normally</em> you would <em>encapsulate</em> the array and expose an <em>indexed property</em>, i.e. something like this:</p>\n\n<pre><code>Private internal() As Long 'todo initialize\n\nPublic Property Let Foo(ByVal index As Long, ByVal value As Long)\n    internal(index) = value\nEnd Property\n\nPublic Property Get Foo(ByVal index As Long) As Long\n    Foo = internal(index)\nEnd Property\n</code></pre>\n\n<p>Still, the language doesn't explicitly forbid exposing an array as a property... or does it?</p>\n\n<p>This is a compile-time error, namely, <strong><em>can't assign to array</em></strong>:</p>\n\n<pre><code>Public Property Let Foo(ByRef values() As Long)\nEnd Property\n\nPublic Sub Test()\n    Dim values(0 To 1) As Long\n    values(0) = 1\n    values(1) = 2\n    Foo = values ' compile error / can't assign to array\nEnd Sub\n</code></pre>\n\n<p>So passing the array to a procedure that then relays it to the <code>Property Let</code> seems like a hack to leverage the VBE's rather poor static code analysis in order to get around a compile error that's probably there for a reason.</p>\n\n<p>We know we can't pass an array <code>ByVal</code> in VBA. Trying to do so isn't even a <em>compile error</em>, it's a <em>syntax error</em> and the VBE is quite obviously unhappy with it:</p>\n\n<p><img src=\"https://i.stack.imgur.com/O9YwU.png\" alt=\"Private Sub IllegalByValArray(ByVal values() As Long)\"></p>\n\n<p>This points back to <a href=\"https://stackoverflow.com/questions/39872663/inconsistent-behavior-when-assigning-array-to-a-property-let#comment67036474_39872663\">Rory's comment</a> about properties implicitly passing parameters <code>ByVal</code>. Here's some proof:</p>\n\n<pre><code>Public Property Let Foo(ByRef values As Variant)\n    Debug.Print \"Foo: \" &amp; VarPtr(values)\nEnd Property\n\nPublic Sub Test()\n    Dim values(0 To 1) As Long\n    values(0) = 1\n    values(1) = 2\n\n    Dim v As Variant\n    v = values\n\n    Debug.Print \"Test: \" &amp; VarPtr(v)\n    IllegalByRefArray v\nEnd Sub\n\nPrivate Sub IllegalByRefArray(ByRef values As Variant)\n    Debug.Print \"IllegalByRefArray: \" &amp; VarPtr(values)\n    Foo = values\nEnd Sub\n</code></pre>\n\n<p>Running the <code>Test</code> procedure prints this (or similar) output:</p>\n\n<pre><code>Test: 196542488\nIllegalByRefArray: 196542488\nFoo: 196542352\n</code></pre>\n\n<p>Notice the variable pointer is the same in <code>Test</code> and <code>IllegalByRefArray</code>, but different in <code>Foo</code>, <em>regardless of the <code>ByRef</code> modifier</em>. If you change the modifier in <code>IllegalByRefArray</code> to <code>ByVal</code>, you'll get 3 different values instead:</p>\n\n<pre><code>Test: 196542488\nIllegalByRefArray: 196542384\nFoo: 196542336\n</code></pre>\n\n<p>From the accepted answer:</p>\n\n<blockquote>\n  <p><em>If I create a local variable, assign it, then pass it along it seems to work.</em></p>\n</blockquote>\n\n<p>Of course it does; you're now passing a different pointer than the one you received, and VBA tries by several means described above, to discourage you from passing a pointer to an array into a <code>Property Let</code> mutator: VBA is trying to tell you in so many ways, that what you're doing isn't something you <em>should</em> be doing.</p>\n\n<p>Do things the right way, keep the array encapsulated, and expose an indexed property instead of allowing <em>the array itself</em> to be overwritten.</p>\n\n<p>Or make it a public field if you don't care for encapsulation: that property serves literally no purpose.</p>\n\n<pre><code>Public Values() As Long\n</code></pre>\n\n<p>There, assign at will.</p>\n\n<p>If you <em>must</em> have a <code>Property Let</code> mutator for that array, the clean solution is to <a href=\"https://stackoverflow.com/a/39873577/1188513\">pass the array as a <code>Variant</code></a>; yes, this means you need to adjust the rest of your code.</p>\n\n<hr>\n\n<h2>TL;DR:</h2>\n\n<p>A <code>ByRef</code> modifier on a <code>Property Let</code> mutator <strong>makes no sense</strong>: it's a <strong>blatant lie</strong> (it's <strong>not</strong> passed by reference!) and makes your code very confusing. Don't stick a <code>ByRef</code> modifier on a <code>Property Let</code> value parameter just to satisfy the language syntax which otherwise refuses to pass an array parameter - you're twisting VBA's arm, jeopardizing your users' unsaved work, and making your code tell lies.</p>\n\n<p>Pass a <code>Variant</code> instead, or properly encapsulate your array through an indexed property. Anything else is just a dirty stinking hack.</p>\n"}], "owner": {"reputation": 147, "user_id": 4850829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89569a7b38bd5f11bd8f481fef66e4a2?s=128&d=identicon&r=PG&f=1", "display_name": "markovcd", "link": "https://stackoverflow.com/users/4850829/markovcd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 3, "accepted_answer_id": 39873027, "answer_count": 3, "score": 6, "last_activity_date": 1508463218, "creation_date": 1475666634, "last_edit_date": 1531164843, "question_id": 39872663, "link": "https://stackoverflow.com/questions/39872663/inconsistent-behavior-when-assigning-array-to-a-property-let", "title": "Inconsistent behavior when assigning array to a property let", "body": "<p>Consider following code:</p>\n\n<pre><code>Option Explicit\n\nPublic Property Let Dummy(v() As Integer)\n\nEnd Property\n\nPublic Sub LetDummy(v() As Integer)\n\nEnd Sub\n\nSub Foo()\n    ReDim i(0 To 2) As Integer\n    i(0) = 3\n    i(1) = 45\n    i(2) = 10\n\n    Bar i ' internal error 51\nEnd Sub\n\nSub Foo2()\n    ReDim i(0 To 2) As Integer\n    i(0) = 3\n    i(1) = 45\n    i(2) = 10\n\n    Bar2 i ' no error\nEnd Sub\n\nSub Foo3()\n    ReDim i(0 To 2) As Integer\n    i(0) = 3\n    i(1) = 45\n    i(2) = 10\n\n    Dummy = i ' no error\nEnd Sub\n\nSub Bar(j() As Integer)\n    Dummy = j\nEnd Sub\n\nSub Bar2(j() As Integer)\n    LetDummy j\nEnd Sub\n</code></pre>\n\n<p>When I run macro 'Foo' i get message 'internal error 51' but 'Foo2' and 'Foo3' runs fine. What's the reason for this behavior? Or is it simply a bug in VBA? How to fix this error?   </p>\n\n<p>Background: In my application I want to assign array provided as function argument to property of type array. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6869944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/513729a831b1989f135418b449c98b7d?s=128&d=identicon&r=PG&f=1", "display_name": "Manpreet Gujral", "link": "https://stackoverflow.com/users/6869944/manpreet-gujral"}, "edited": false, "score": 0, "creation_date": 1475745191, "post_id": 39875623, "comment_id": 67069954, "body": "Thanks for your response. Doesn&#39;t work for me. I don&#39;t get any error but it doesn&#39;t lock the row."}], "tags": [], "owner": {"reputation": 68, "user_id": 5412162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb30c00ff0ecf1a3409f8b1a03ff2c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Vroenguard", "link": "https://stackoverflow.com/users/5412162/vroenguard"}, "is_accepted": false, "score": 0, "last_activity_date": 1475674889, "creation_date": 1475674889, "answer_id": 39875623, "question_id": 39872623, "link": "https://stackoverflow.com/questions/39872623/lock-row-for-particular-month/39875623#39875623", "title": "Lock Row for Particular Month", "body": "<p>I'm not so sure what you were trying to accomplish with the existing code, but based purely on what you explained, I think this should do the trick :</p>\n\n<pre><code>Dim DestSh As Worksheet\nDim lastrow As Long\nDim i As Integer\n\nSet DestSh = Sheets(\"Consultant &amp; Teacher\")\n\nWith DestSh\n    'finds the last row with data on A column\n    lastrow = Range(\"A65536\").End(xlUp).Row\n\n    'parse all rows\n    For i = 2 To lastrow\n       'if your conditions are met\n       If Month(.Cells(i, 16)) &gt; Month(.Cells(1, 1)) Then\n          .Range(\"A\" &amp; i).EntireRow.Cells.Locked = True 'lock the row\n       End If\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6869944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/513729a831b1989f135418b449c98b7d?s=128&d=identicon&r=PG&f=1", "display_name": "Manpreet Gujral", "link": "https://stackoverflow.com/users/6869944/manpreet-gujral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475674889, "creation_date": 1475666537, "last_edit_date": 1475669373, "question_id": 39872623, "link": "https://stackoverflow.com/questions/39872623/lock-row-for-particular-month", "title": "Lock Row for Particular Month", "body": "<p>My data has cell A1 containing Month. </p>\n\n<p>A2:Z999 : Employee details.\nColumn P: Date of joining.</p>\n\n<p>I want to code such that, when P>A1, it should lock the row for that employee since it's old data. Only rows without date, or empty rows 999 onward, should be empty. </p>\n\n<p>Please help! Right now my code below locks everything.</p>\n\n<pre><code>Dim DestSh As Worksheet\nDim lastrow As Long\n\n\nSet DestSh = Sheets(\"Consultant &amp; Teacher\")\n\nWith DestSh\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        lastrow = .Columns(\"A:z\").Find(What:=\"*\", _\n                      After:=.Range(\"A1\"), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).Row\n    Else\n        MsgBox \"Insufficient rows\"\n\n    End If\n\n    If Range(\"A1\").Value = \"April\" Then\n    .Unprotect Password:=\"MyPassword\"\n    .Cells.Locked = False\n    .Range(\"A2:Z\" &amp; lastrow).Locked = True\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1477044903, "post_id": 39872458, "comment_id": 67615255, "body": "In the normal course of events you could not expect an answer to this question here.  You ask for far too much for a single question and show no effort.  However, I have been developing a macro along the lines you require for myself.  I will post it when I finished."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1477091522, "creation_date": 1477091522, "answer_id": 40186626, "question_id": 39872458, "link": "https://stackoverflow.com/questions/39872458/how-do-i-copy-structure-of-pst-file-to-new-pst-file-thru-vba-macro/40186626#40186626", "title": "How do I copy structure of Pst file to new pst file thru VBA macro", "body": "<p>In the normal course of events, you would not have got any answer to your question.  This is not a free coding service.  This site exists to allow programmers to help one another develop.  If you post your faulty code and explain how its behaviour differs from what you seek, someone will help often within minutes on the Excel VBA but more slowly on the Outlook VBA site.</p>\n\n<p>You are getting this answer because I have been coding a macro for myself which appears to match your requirement.  The comments are those I write to allow myself to return to the macro in six or twelve months and update it.  I have tested it by using it.  It has not had the systematic testing I would normally give a macro before release.  It does not delete anything so if it fails it will not do any permanent damage.  The most likely failure is that it will just stop with the VBA interpreter reporting an error.  If this happens then add a comment describing the scenario and I will attempt to fix the error.</p>\n\n<p>Subroutine <code>CtrlMoveEmailsByYear</code> is the only macro you will have to rewrite. Subroutine <code>MoveEmailsByYear</code> and <code>function GetCreateFldr2Full</code> are the macros specifically coded to meet this requirement.  All other subroutines and function are general functions some of which I have used for years.</p>\n\n<p>Consider subroutine <code>CtrlMoveEmailsByYear</code>:</p>\n\n<pre><code>Sub CtrlMoveEmailsByYear()\n\n  Dim FldrDestRoot As Folder\n  Dim FldrSrcRoot As Folder\n\n  Set FldrSrcRoot = GetFolderRef(\"dell\", \"!Tony\")\n\n  Set FldrDestRoot = GetFolderRef(\"tony archive 2010\")\n  Call MoveEmailsByYear(FldrSrcRoot, FldrDestRoot, 2010)\n\n  Set FldrDestRoot = GetFolderRef(\"tony archive 2011\")\n  Call MoveEmailsByYear(FldrSrcRoot, FldrDestRoot, 2011)\n\nEnd Sub\n</code></pre>\n\n<p>\u201cdell\u201d is the name of a PST file.  I copied it to my current laptop from an earlier laptop.  \u201c!Tony\u201d is a folder within the PST file that contains my private emails.  \u201cdell\u201d contains other folders which I either do not wish to save or which I wish to save differently.</p>\n\n<p><code>GetFolderRef</code> is one of my standard routines. The first (compulsory) parameter is the user/display name of a store.  A PST file is a type of store.  The leftmost names in Outlook\u2019s folder pane are the user/display names of stores. The second (optional) parameter is the name of a folder within the store.  There can be third, fourth, fifth parameters (up to whatever depth is required) for the names of sub and sub-sub folders.  The routine returns a reference to the named folder if it exists. I have used <code>GetFolderRef</code> to get references to \u201cdell->!Tony\u201d, \u201ctony archive 2010\u201d and \u201ctony archive 2011\u201d</p>\n\n<p>These references are used in calls of <code>MoveEmailsByYear</code>.  Its parameters are a source folder, a destination folder and a year.  It moves all emails for the specified year from the source folder to the destination folder.  The move retains the structure.  For example, if folder \u201cdell->!Tony-> Amazon->TraderA\u201d contains an email from the specified year, that email will be moved to \u201ctony archive 2010->Amazon->TraderA\u201d.  The destination folder will be created if it does not already exist.</p>\n\n<p>You will need to create an equivalent macro with appropriately constructed calls of <code>MoveEmailsByYear</code>.  The default \u201cInbox\u201d is in store \u201coutlook data file\u201d but that may not be where your emails are held.  Use the names from your folder pane.  On my system Outlook has created a store per email account with names that match the email addresses so I have one inbox per current email account plus one per old computer.</p>\n\n<p>Warning: I have dozens of macros.  I believe I have extracted every macro used by <code>MoveEmailsByYear</code> or the routines it calls.  If you get a report saying \u201cmacro Xxxxx not specified\u201d then sorry.  Tell me and I will add it to the answer.</p>\n\n<pre><code>Sub MoveEmailsByYear(ByRef FldrSrcRoot As Folder, ByRef FldrDestRoot As Folder, _\n                     ByVal YearToCopy As Long)\n\n  ' FldrSrcRoot:  A folder\n  ' FldrDestRoot: Another folder that cannot be in the same store.\n  ' YearToCopy:   A four digit year\n\n  ' The routine moves emails with a ReceivedTime within YearToCopy from FldrSrcRoot,\n  ' or a folder under FldrSrcRoot, to the equivalent position in FldDestRoot.\n  ' See function GetCreateFldr2Full for information on how the new folder is created.\n\n  ' The restriction that FldrSrcRoot and FldrDestRoot cannot be in the same store is\n  ' to avoid any possibility that FldrSrcRoot and FldrDestRoot do not overlap to an\n  ' email is moved to a sub-folder within FldrDestRoot and then moved to a\n  ' sub-sub-folder within FldrDestRoot and so on indefinitely.\n\n  \u2018 Coded by Tony Dallimore\n\n  Dim FldrDestCrnt As Folder\n  Dim FldrSrcCrnt As Folder\n  Dim FldrSrcLast As Folder\n  Dim FldrSrcCrntNames() As String\n  Dim FldrSrcLastNames() As String\n  Dim InxN As Long\n  Dim MailItemCrnt As MailItem\n  Dim NewFldr As Boolean\n\n  Set FldrSrcLast = Nothing\n  Call GetNextMailItem(\"I\", MailItemCrnt, FldrSrcCrnt, FldrSrcRoot)\n\n  Do While Not MailItemCrnt Is Nothing\n     With MailItemCrnt\n       If Year(.ReceivedTime) = YearToCopy Then\n         If FldrSrcLast Is Nothing Then\n           ' FldrSrcLast not initialised so this is first mail item from required year\n           NewFldr = True\n         ElseIf FldrSrcLast &lt;&gt; FldrSrcCrnt Then\n           ' Different folders\n           NewFldr = True\n         End If\n         If NewFldr Then\n           FldrSrcLastNames = GetFolderNames(FldrSrcCrnt)\n           Set FldrDestCrnt = GetCreateFldr2Full(FldrSrcRoot, FldrSrcCrnt, FldrDestRoot)\n         End If\n         .Move FldrDestCrnt\n       End If\n     End With\n     Call GetNextMailItem(\"N\", MailItemCrnt, FldrSrcCrnt)\n  Loop\n\nEnd Sub\n\nPublic Sub DeNestParamArray(Denested() As Variant, ParamArray Original() As Variant)\n\n  ' Each time a ParamArray is passed to a sub-routine, it is nested in a one\n  ' element Variant array.  This routine finds the bottom level of the nesting and\n  ' sets RetnValue to the values in the original parameter array so that other routines\n  ' need not be concerned with this complication.\n\n  '  Coded by Tony Dallimore\n\n  Dim Bounds         As Collection\n  Dim Inx1           As Long\n  Dim Inx2           As Long\n  Dim DenestedCrnt() As Variant\n  Dim DenestedTemp() As Variant\n\n  DenestedCrnt = Original\n  ' Find bottom level of nesting\n  Do While True\n    If VarType(DenestedCrnt) &lt; vbArray Then\n      ' Have found a non-array element so must have reached the bottom level\n      Debug.Assert False   ' Should have exited loop at previous level\n      Exit Do\n    End If\n    Call NumberOfDimensions(Bounds, DenestedCrnt)\n    ' There is one entry in Bounds per dimension in NestedCrnt\n    ' Each entry is an array: Bounds(N)(0) = Lower bound of dimension N\n    ' and Bounds(N)(1) = Upper bound of dimenssion N\n    If Bounds.Count = 1 Then\n      If Bounds(1)(0) &gt; Bounds(1)(1) Then\n        ' The original ParamArray was empty\n        Denested = DenestedCrnt\n        Exit Sub\n      ElseIf Bounds(1)(0) = Bounds(1)(1) Then\n        ' This is a one element array\n        If VarType(DenestedCrnt(Bounds(1)(0))) &lt; vbArray Then\n          ' But it does not contain an array so the user only specified\n          ' one value (a literal or a non-array variable)\n          ' This is a valid exit from this loop\n            Exit Do\n        End If\n        ' The following sometimes crashed Outlook\n        'DenestedCrnt = DenestedCrnt(Bounds(1)(0))\n        If VarType(DenestedCrnt(Bounds(1)(0))) = vbArray + vbString Then\n          ' DenestedCrnt(Bounds(1)(0))) is an array of strings.\n          ' This is the array sought but it must be converted to an array\n          ' of variants with lower bound = 0 before it can be returned.\n          ReDim Denested(0 To UBound(DenestedCrnt(Bounds(1)(0))) - LBound(DenestedCrnt(Bounds(1)(0))))\n          Inx2 = LBound(DenestedCrnt)\n          For Inx1 = 0 To UBound(Denested)\n            Denested(Inx1) = DenestedCrnt(Bounds(1)(0))(Inx2)\n            Inx2 = Inx2 + 1\n          Next\n          Exit Sub\n        End If\n        DenestedTemp = DenestedCrnt(Bounds(1)(0))\n        DenestedCrnt = DenestedTemp\n      Else\n        ' This is a one-dimensional, non-nested array\n        ' This is the usual exit from this loop\n        Exit Do\n      End If\n    Else\n      ' This is an array but not a one-dimensional array\n      ' There is no code for this situation\n      Debug.Assert False\n      Exit Do\n    End If\n  Loop\n\n  ' Have found bottom level array.  Save contents in Return array.\n  If LBound(DenestedCrnt) &lt;&gt; 0 Then\n    ' A ParamArray should have a lower bound of 0.  Assume the ParamArray\n    ' was loaded with a 1D array that did not have a lower bound of 0.\n    ' Build Denested so it has standard lbound\n    ReDim Denested(0 To UBound(DenestedCrnt) - LBound(DenestedCrnt))\n    Inx2 = LBound(DenestedCrnt)\n    For Inx1 = 0 To UBound(Denested)\n      Denested(Inx1) = DenestedCrnt(Inx2)\n      Inx2 = Inx2 + 1\n    Next\n  Else\n    Denested = DenestedCrnt\n  End If\n\nEnd Sub\nFunction GetCreateFldr2Full(ByRef Fldr1Root As Folder, ByRef Fldr1Full As Folder, _\n                            ByRef Fldr2Root As Folder) As Folder\n\n  ' Fldr1Root is a folder.\n  ' Fldr1Full is a child of Fld1Root.\n  ' Fldr2Root is another folder.\n  ' The routine returns a reference to folder Fldr2Full where Fldr2Full's\n  ' position within Fldr2Root matches the position of Fldr1Full's\n  ' position within Fldr1Root.\n\n  ' For example:\n  '   If   Fldr1Root is      A-&gt;B-&gt;C\n  '   and  Fldr1Full is      A-&gt;B-&gt;C-&gt;D-&gt;E\n  '   and  Fldr2Root is      Z-&gt;Y-&gt;X\n  '   then Fldr2Full will be Z-&gt;Y-&gt;X-&gt;D-&gt;E\n\n  ' Fldr1Root, Fldr1Full and Fldr2Roor must exist.\n  ' Fldr1Full must be a child of Fldr1Root.\n  ' If either of the above conditions are not met, the routine returns Nothing.\n  ' The routine will find Fldr2Full if it already exists or create it if it does not.\n\n  ' Coded by Tony Dallimore\n\n  Dim Fldr1FullNames() As String\n  Dim Fldr1RootNames() As String\n  Dim Fldr2Chld As Folder\n  Dim Fldr2Crnt As Folder\n  Dim Fldr2FullNames() As String\n  Dim Fldr2RootNames() As String\n  Dim InxFull1Crnt As Long\n\n  Fldr1RootNames = GetFolderNames(Fldr1Root)\n  Fldr1FullNames = GetFolderNames(Fldr1Full)\n  Fldr2RootNames = GetFolderNames(Fldr2Root)\n\n  If UBound(Fldr1RootNames) &gt;= UBound(Fldr1FullNames) Then\n    ' The full name is not longer than the root name so it cannot be a child\n    Debug.Assert False\n    Set GetCreateFldr2Full = Nothing\n    Exit Function\n  End If\n\n  ' Match names within Fldr1Root and Fldr1Full to:\n  '  * Check Fldr1Full is within Fldr1Root\n  '  * Find \"tail\" that will have to be added to Fldr2Root to create Fldr2Full\n  For InxFull1Crnt = 0 To UBound(Fldr1RootNames)\n    If Fldr1RootNames(InxFull1Crnt) &lt;&gt; Fldr1FullNames(InxFull1Crnt) Then\n      ' The root name does not match the start of the full name\n      Set GetCreateFldr2Full = Nothing\n      Exit Function\n    End If\n  Next\n\n  ' UBound(Fldr1RootName) + 1 To UBound(Fldr1FullName) is the \"tail\" of\n  ' Fldr1Full. Check there is an identical tail for Fldr2Root and, if there\n  ' isn't, create it.\n  Set Fldr2Crnt = Fldr2Root\n  For InxFull1Crnt = UBound(Fldr1RootNames) + 1 To UBound(Fldr1FullNames)\n    Err.Clear\n    Set Fldr2Chld = Nothing\n    On Error Resume Next\n    Set Fldr2Chld = Fldr2Crnt.Folders(Fldr1FullNames(InxFull1Crnt))\n    On Error GoTo 0\n    If Fldr2Chld Is Nothing Then\n      ' Fldr2Crnt.Folders(Fldr1FullName(InxFull1Crnt)) does not exist\n      ' so create it\n      Set Fldr2Chld = Fldr2Crnt.Folders.Add(Fldr1FullNames(InxFull1Crnt))\n      ' Since folder did not exist within Fldr2Root, its children can't exist\n      ' either. I could take advantage of this knowledge and not check existence\n      ' of children but I think it is simpler not to.\n    End If\n    Set Fldr2Crnt = Fldr2Chld\n  Next\n\n  Set GetCreateFldr2Full = Fldr2Crnt\n\nEnd Function\nFunction GetFolderNames(ByRef Fldr As Folder) As String()\n\n  ' * Fldr is a folder. It could be a store, the child of a store,\n  '   the grandchild of a store or more deeply nested.\n  ' * Return the name of that folder as a string array in the sequence:\n  '    (0)=StoreName (1)=Level1FolderName (2)=Level2FolderName  ...\n\n  ' Coded by Tony Dallimore\n\n  Dim FldrCrnt As Folder\n  Dim FldrNameCrnt As String\n  Dim FldrNames() As String\n  Dim FldrNamesRev() As String\n  Dim FldrPrnt As Folder\n  Dim InxFn As Long\n  Dim InxFnR As Long\n\n  Set FldrCrnt = Fldr\n  FldrNameCrnt = FldrCrnt.Name\n  ReDim FldrNamesRev(0 To 0)\n  FldrNamesRev(0) = Fldr.Name\n  ' Loop getting parents until FldrCrnt has no parent.\n  ' Add names of Fldr and all its parents to FldrName as they are found\n  Do While True\n    Set FldrPrnt = Nothing\n    On Error Resume Next\n    Set FldrPrnt = FldrCrnt.Parent\n    On Error GoTo 0\n    If FldrPrnt Is Nothing Then\n      ' FldrCrnt has no parent\n      Exit Do\n    End If\n    ReDim Preserve FldrNamesRev(0 To UBound(FldrNamesRev) + 1)\n    FldrNamesRev(UBound(FldrNamesRev)) = FldrPrnt.Name\n    Set FldrCrnt = FldrPrnt\n  Loop\n\n  ' Copy names to FldrNames in reverse sequence so they end up in the correct sequence\n  ReDim FldrNames(0 To UBound(FldrNamesRev))\n  InxFn = 0\n  For InxFnR = UBound(FldrNamesRev) To 0 Step -1\n    FldrNames(InxFn) = FldrNamesRev(InxFnR)\n    InxFn = InxFn + 1\n  Next\n\n  GetFolderNames = FldrNames\n\nEnd Function\nPublic Function GetFolderRef(ParamArray FolderNames() As Variant) As Folder\n\n  ' FolderNames can be used as a conventional ParamArray: a list of values. Those\n  ' Values must all be strings.\n  ' Alternatively, its parameter can be a preloaded one-dimensional array of type\n  ' Variant or String. If of type Variant, the values must all be strings.\n  ' The first, compulsory, entry in FolderNames is the name of a Store.\n  ' Each subsequent, optional, entry  in FolderNames is the name of a folder\n  ' within the folder identified by the previous names.  Example calls:\n  '  1) Set Fldr = GetFolderRef(\"outlook data file\")\n  '  2) Set Fldr = GetFolderRef(\"outlook data file\", \"Inbox\", \"Processed\")\n  '  3) MyArray = Array(\"outlook data file\", \"Inbox\", \"Processed\")\n  '     Set Fldr = GetFolderRef(MyArray)\n  ' Return a reference to the folder identified by the names or Nothing if it\n  ' does not exist\n\n  ' Coded by Tony Dallimore\n\n  Dim FolderNamesDenested() As Variant\n  Dim ErrNum As Long\n  Dim FldrChld As Folder\n  Dim FldrCrnt As Folder\n  Dim InxP As Long\n\n  ' See sub DeNestParamArray for an explanation of its purpose.\n  Call DeNestParamArray(FolderNamesDenested, FolderNames)\n\n  If LBound(FolderNamesDenested) &gt; UBound(FolderNamesDenested) Then\n    ' No names specified\n    Set GetFolderRef = Nothing\n    Exit Function\n  End If\n\n  For InxP = 0 To UBound(FolderNamesDenested)\n    If VarType(FolderNamesDenested(InxP)) &lt;&gt; vbString Then\n      ' Value is not a string\n      Debug.Assert False     ' Fatal error\n      Set GetFolderRef = Nothing\n      Exit Function\n    End If\n  Next\n\n  Set FldrCrnt = Nothing\n  On Error Resume Next\n  Set FldrCrnt = Session.Folders(FolderNamesDenested(0))\n  On Error GoTo 0\n  If FldrCrnt Is Nothing Then\n    ' Store name not recognised\n    Debug.Print FolderNamesDenested(0) &amp; \" is not recognised as a store\"\n    Debug.Assert False     ' Fatal error\n    Set GetFolderRef = Nothing\n    Exit Function\n  End If\n\n  For InxP = 1 To UBound(FolderNamesDenested)\n  Set FldrChld = Nothing\n    On Error Resume Next\n    Set FldrChld = FldrCrnt.Folders(FolderNamesDenested(InxP))\n    On Error GoTo 0\n    If FldrChld Is Nothing Then\n      ' Folder name not recognised\n      Debug.Print FolderNamesDenested(InxP) &amp; \" is not recognised as a folder within \" &amp; _\n                  Join(GetFolderNames(FldrCrnt), \"-&gt;\")\n      Debug.Assert False    ' Fatal error\n      Set GetFolderRef = Nothing\n      Exit Function\n    End If\n    Set FldrCrnt = FldrChld\n    Set FldrChld = Nothing\n  Next\n\n  Set GetFolderRef = FldrCrnt\n\nEnd Function\nPublic Sub GetNextMailItem(ByVal Action As String, ByRef MailItemNext As MailItem, _\n                           ByRef MailItemFolder As Folder, _\n                           ParamArray Params() As Variant)\n\n  ' Each call returns the next mail item from the specified folder or folder list.\n  ' It may be called repeatedly until all mail items in the specified folder or\n  ' folder list have been returned\n\n  ' On return, if MailItemNext is Nothing, there are no [more] mail items in the\n  ' specified folder or folder list. Otherwise, MailItemNext is a reference to the next\n  ' mail item and MailItemFolderName contains the name of the folder. See below for\n  ' format of folder names used by this routine.\n\n  ' * If Action = \"I\", the routine initialises itself and then returns the first mail\n  '   item, if any, in the first specified folder.\n  ' * If Action = \"N\", the routine returns the next mail item, if any, from its list of\n  '   folders. Params() is ignored since values were stored during the Action = \"I\" call.\n  ' * MailItemNext will be Nothing if no [more] mail items are present in the folder or\n  '   folder list to search.\n  ' * MailItemFolder is the the folder containing MailItemNext.\n  ' * Params is only used if Action = \"I\"\n  ' * Each value in Params, if any, is a folders to be searched for emails.  If Params is\n  '   empty, every folder in every store will be searched for emails.\n\n  ' Example uses:\n  '\n  '    Call GetMailItemNext(\"I\", MailItemCrnt, MainItemPrntName)\n  '    Do While Not MailItemCrnt Is Nothing\n  '      ' Process mail item\n  '      Call GetMailItemNext(\"N\", MailItemCrnt, MainItemPrntName)\n  '    Loop\n  ' or\n  '    Set FldrSrcRoot = GetFolderRef(\"outlook data file\" &amp; vbTab &amp; \"Inbox\")\n  '    Call GetMailItemNext(\"I\", MailItemCrnt, MainItemPrntName, vbTab, FldrSrcRoot)\n  '    Do While Not MailItemCrnt Is Nothing\n  '      ' Process mail item\n  '      Call GetMailItemNext(\"N\", MailItemCrnt, MainItemPrntName)\n  '    Loop\n  '\n  ' Coded by Tony Dallimore\n\n  ' The routine uses three static variables:\n  '  1) name of folder holding pending mail items\n  '  2) collection MailItemsPending\n  '  4) collection FolderSearchPending\n\n  ' * The first part of the routine is only executed if Action = \"I\". It analyses\n  '   the values in Params, if any, and initialises the static variables as\n  '   appropriate.\n  ' * The second part of the routine is a loop which is always executed. Each\n  '   repeat of the loop:\n  '    * If MailItemsPending contains any mail items, the first mail item\n  '      is removed from the collection and returned to the caller in\n  '      MailItemNext and MailItemFolderName.\n  '    * if FolderSearchPending is empty, MailItemNext is set to Nothing\n  '      and the routine exits.\n  '    * The first folder in FolderSearchPending is removed from the collection\n  '      and processed as follows:\n  '       * If this folder contains mail items, they are added to MailItemsPending.\n  '       * If this folder has any sub-folders, they are added to the beginning of\n  '         FolderSearchPending.\n  '    * The loop repeats to process the first new mail item, if any, or the next\n  '      search folder, if any.\n\n  Static FolderMainItem() As String\n  ' Values in MailItemsPending are arrays with two entries. Entry 0 is a reference to\n  ' the folder holding the mail item. Entry 1 is a reference to the mail item.\n  Static MailItemsPending As New Collection\n  ' Values in FolderSearchsPending are references to folders.\n  Static FolderSearchsPending As New Collection\n\n  Dim FolderChld As Folder\n  Dim FolderChldNameStr As String\n  Dim InxChld As Long    ' Index into child folders of folder\n  Dim InxInsert As Long  ' Position within collection at which new\n                         ' element is to be inserted\n  Dim InxItm As Long     ' Index into mail items within folder\n  Dim InxPrm As Long     ' Index into Params\n  Dim FolderSearch As Folder\n  Dim FolderSearchNameArr As String\n  Dim FolderSearchNameStr As String\n\n  If LCase(Action) = \"n\" Then\n    ' Drop through to handle next mail item\n  ElseIf LCase(Action) = \"i\" Then\n    ' Code for Action = \"I\"\n    If UBound(Params) = -1 Then\n      ' No search folders specified\n      ' Search every folder in every store\n      With Session\n        For InxChld = 1 To .Folders.Count\n          Set FolderChld = .Folders(InxChld)\n          FolderSearchsPending.Add FolderChld\n        Next\n      End With\n    Else\n      ' One or more search folders specified\n      For InxPrm = 0 To UBound(Params)\n        If TypeOf Params(InxPrm) Is Folder Then\n          FolderSearchsPending.Add Params(InxPrm)\n        Else\n          Debug.Print \"The \" &amp; InxPrm + 5 &amp; \"th parameter in the call of GetNextMailItem\" &amp; _\n                      \" is not a string. It should be a reference to a folder.\"\n          Debug.Assert False      ' Fatal error\n          Set MailItemNext = Nothing\n          Exit Sub\n        End If\n      Next\n    End If\n  Else\n    ' Invalid value for Action\n    Set MailItemNext = Nothing\n    Exit Sub\n  End If\n\n  ' Loop until have mail item to return or there are no [more] mail items to return\n  Do While True\n    If MailItemsPending.Count &gt; 0 Then\n      ' Extract values from first entry for return to caller and then remove first entry\n      Set MailItemFolder = MailItemsPending(1)(0)\n      Set MailItemNext = MailItemsPending(1)(1)\n      MailItemsPending.Remove 1\n      Exit Sub\n    ElseIf FolderSearchsPending.Count = 0 Then\n      ' No more folders to search\n      Set MailItemNext = Nothing\n      Set MailItemFolder = Nothing\n      Exit Sub\n    Else\n      ' Extract first search folder, process and store results if any\n      Set FolderSearch = FolderSearchsPending(1)\n      FolderSearchsPending.Remove 1\n      If Not FolderSearch.Parent Is Nothing Then\n        ' This is not a store so it is a folder that could contain mail items\n        For InxItm = 1 To FolderSearch.Items.Count\n          If TypeOf FolderSearch.Items(InxItm) Is MailItem Then\n            MailItemsPending.Add VBA.Array(FolderSearch, _\n                                           FolderSearch.Items(InxItm))\n          End If\n        Next\n      End If\n      ' Now add any children to the start of FolderSearchsPending\n      InxInsert = 1   ' Insertion point of first child folder\n      For InxChld = 1 To FolderSearch.Folders.Count\n        With FolderSearch.Folders(InxChld)\n          Select Case .Name\n            Case \"Calendar\", \"Contacts\", \"Journal\", \"Notes\", \"Tasks\", \"RSS Feeds\", _\n                 \"Conversation Action Settings\", \"Quick Step Settings\"\n              ' Ignore folders that cannot (should not?) contain mail items\n            Case \"Deleted Items\"\n              ' Ignore mail items deleted by user\n            Case Else\n              ' This folder can contain mail items\n              If InxInsert &lt; FolderSearchsPending.Count Then\n                ' Insert new element before at least one existing element\n                FolderSearchsPending.Add Item:=FolderSearch.Folders(InxChld), Before:=InxInsert\n              Else\n                ' Add new element after any existing elements\n                FolderSearchsPending.Add FolderSearch.Folders(InxChld)\n              End If\n              ' Insert any further children after child just added\n              InxInsert = InxInsert + 1\n          End Select\n        End With\n      Next\n    End If\n  Loop\n\nEnd Sub\nPublic Function NumberOfDimensions(ByRef Bounds As Collection, _\n                                   ParamArray Params() As Variant) As Long\n\n  ' Example calls of this routine are:\n  '    NumDim = NumberOfDimensions(Bounds, MyArray)\n  ' or NumDim = NumberOfDimensions(Bounds, Worksheets(\"Sheet1\").Range(\"D4:E20\"))\n\n  ' * Returns the number of dimensions of Params(LBound(Params)).  Param is a ParamArray.\n  '   MyArray, in the example call, is held as the first element of array Params.  That is\n  '   it is held as Params(LBound(Params)) or Params(LBdP) where LBdP = LBound(Params).\n  ' * If the array to test is a regular array, then, in exit, for each dimension, the lower\n  '   and upper bounds are recorded in Bounds. Entries in Bounds are zero-based arrays\n  '   with two entries: lower bound and upper bound.\n  ' * If the array is a worksheet range, the lower bound values in Bounds are 1 and the\n  '   upper bound values are the number of rows (first entry in Bounds) or columns (second\n  '   entry in Bounds)\n  ' * The collection Bounds is of most value to routines that can be pased an array as\n  '   a parameter but does not know if that array is a regular array or a range. The values\n  '   returned in Bounds means that whether the test array is a regular array or a range,\n  '   its elements can be accessed so:\n  '      For InxDim1 = Bounds(0)(0) to Bounds(0)(1)\n  '        For InxDim2 = Bounds(1)(0) to Bounds(1)(1)\n  '          :  :  :\n  '        Next\n  '      Next\n\n  ' If there is an official way of determining the number of dimensions, I cannot find it.\n\n  ' This routine tests for dimension 1, 2, 3 and so on until it get a failure.\n  ' By trapping that failure it can determine the last test that did not fail.\n\n  ' *  Params() is a ParamArray because it allows the passing of arrays of any type.\n  ' *  The array to be tested in not Params but Params(LBound(Params)).\n  ' *  The routine does not check for more than one parameter.  If the call was\n  '    NumDim(Bounds, MyArray1, MyArray2), it would ignore MyArray2.\n\n  ' Coded by Tony Dallimore\n\n  Dim InxDim As Long\n  Dim Lbd As Long\n  Dim LBdC As Long\n  Dim LBdP As Long\n  Dim LBdR As Long\n  Dim NumDim As Long\n  Dim TestArray As Variant\n  Dim UBdC As Long\n  Dim UBdR As Long\n\n  Set Bounds = New Collection\n\n  If VarType(Params(LBound(Params))) &lt; vbArray Then\n    ' Variable to test is not an array\n    NumberOfDimensions = 0\n    Exit Function\n  End If\n\n  On Error Resume Next\n\n  LBdP = LBound(Params)\n\n  TestArray = Params(LBdP)\n\n  NumDim = 1\n  Do While True\n    Lbd = LBound(TestArray, NumDim)\n    'Lbd = LBound(Params(LBdP), NumDim)\n    If Err.Number &lt;&gt; 0 Then\n      If NumDim &gt; 1 Then\n        ' Only known reason for failing is because array\n        ' does not have NumDim dimensions\n        NumberOfDimensions = NumDim - 1\n        On Error GoTo 0\n        For InxDim = 1 To NumberOfDimensions\n          Bounds.Add VBA.Array(LBound(TestArray, InxDim), UBound(TestArray, InxDim))\n          'Bounds.Add VBA.Array(LBound(Params(LBdP), InxDim), _\n                               UBound(Params(LBdP), InxDim))\n        Next\n        Exit Function\n      Else\n        Err.Clear\n        Bounds.Add VBA.Array(TestArray.Row, TestArray.Rows.Count - TestArray.Row + 1)\n        Bounds.Add VBA.Array(TestArray.Column, TestArray.Columns.Count - TestArray.Column + 1)\n        If Err.Number &lt;&gt; 0 Then\n          ' I do not know how got here.  Investigate\n          Debug.Assert False\n          NumberOfDimensions = 0\n          Exit Function\n        End If\n        On Error GoTo 0\n        NumberOfDimensions = 2\n        Exit Function\n      End If\n\n    End If\n    NumDim = NumDim + 1\n  Loop\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6833832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26fcbc37a57a803f1ed15cae86f43ed6?s=128&d=identicon&r=PG&f=1", "display_name": "Biswajit", "link": "https://stackoverflow.com/users/6833832/biswajit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 706, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1593074578, "creation_date": 1475666074, "last_edit_date": 1593074578, "question_id": 39872458, "link": "https://stackoverflow.com/questions/39872458/how-do-i-copy-structure-of-pst-file-to-new-pst-file-thru-vba-macro", "title": "How do I copy structure of Pst file to new pst file thru VBA macro", "body": "<p>How do I split my default PST file year wise thru VBA macro Such as New Pst File Name may be Year-2015.pst. It should contain the all the mails which are belongs to year 2015 ( all folders ).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475666813, "post_id": 39872354, "comment_id": 67032010, "body": "what is <code>ActiveSheet.MainSheet</code> ? is <code>MainSheet</code> defined and set as a Wroksheet ?"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475670704, "post_id": 39872354, "comment_id": 67034598, "body": "I just renamed the default &quot;Sheet1&quot; name to &quot;MainSheet&quot; for mentioned Worksheet in this Workbook."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1475671261, "post_id": 39872846, "comment_id": 67034978, "body": "a more question: can I have three activeX (Radio Button) related to one cell with three different value (1 or 2 or 3) like radio button in form control?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1475672152, "post_id": 39872846, "comment_id": 67035612, "body": "@Kasra not sure about it, never tried it. You can post a new question with your updated code. and please mark this as Answer"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1475673417, "post_id": 39872846, "comment_id": 67036590, "body": "Thank you again ... how can I set as answer?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1475673477, "post_id": 39872846, "comment_id": 67036646, "body": "@Kasra you put a &quot;V&quot; next to me answer (on the top left side of my answer post)"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1475674355, "post_id": 39872846, "comment_id": 67037354, "body": "I clicked on the &quot; ^ &quot; symbol on top-left your answer. alse I set &quot;Active&quot; tag on the top of your answer...  is it true my friend?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1475667177, "creation_date": 1475667177, "answer_id": 39872846, "question_id": 39872354, "link": "https://stackoverflow.com/questions/39872354/it-is-correct-for-hide-or-unhide-a-control-by-vba-in-excel-2010/39872846#39872846", "title": "It is correct for hide or unhide a control by VBA in Excel 2010?", "body": "<p>Assuming your ActiveX <code>OptionButton</code> is Named \"OptionButton1\", the code below (tested) will work:</p>\n\n<pre><code>Option Explicit\n\nSub MS_Method()\n\nDim Sht                 As Worksheet\n\n' modify \"MainSheet\" to your sheet name (where you have your OptionButton)\nSet Sht = ThisWorkbook.Sheets(\"MainSheet\")\n\nIf Range(\"C18\").Value = 2 Then\n    Sht.OLEObjects(\"OptionButton1\").Visible = False\nElseIf Range(\"C18\").Value = 1 Then\n    Sht.OLEObjects(\"OptionButton1\").Visible = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 39872846, "answer_count": 1, "score": 1, "last_activity_date": 1475667794, "creation_date": 1475665726, "last_edit_date": 1531161705, "question_id": 39872354, "link": "https://stackoverflow.com/questions/39872354/it-is-correct-for-hide-or-unhide-a-control-by-vba-in-excel-2010", "title": "It is correct for hide or unhide a control by VBA in Excel 2010?", "body": "<p>I have a sheet named \"MainSheet\" in a Workbook in Excel 2010.</p>\n\n<p>this sheet included an activeX control named \"OptionButton1\". when the cell's value of \"C18\" is \"2\" then this control should be hide.</p>\n\n<p>I wrote below code but does not work.</p>\n\n<p>\u25ba a more question: can I have three activeX (Radio Button) related to one cell with three different value like radio button in form control?</p>\n\n<p>Any advice is appreciated. :)</p>\n\n<pre><code>Sub MS_Method()\n\nIf Range(\"C18\").Value = 2 Then\n\n    ActiveSheet.MainSheet(\"OptionButton1\").Visible = False\n\nElseIf Range(\"C18\").Value = 1 Then\n\n    ActiveSheet.MainSheet(\"OptionButton1\").Visible = True\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1475665661, "post_id": 39872306, "comment_id": 67031187, "body": "Do you have a question?"}, {"owner": {"reputation": 1308, "user_id": 3017149, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/K18gw.jpg?s=128&g=1", "display_name": "Tedo G.", "link": "https://stackoverflow.com/users/3017149/tedo-g"}, "edited": false, "score": 0, "creation_date": 1475665954, "post_id": 39872306, "comment_id": 67031383, "body": "So, whats your Problem?"}, {"owner": {"reputation": 37, "user_id": 5979952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4958500e24bf46cfddd5c69bc5e69d91?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitris Afendras", "link": "https://stackoverflow.com/users/5979952/dimitris-afendras"}, "edited": false, "score": 0, "creation_date": 1475666081, "post_id": 39872306, "comment_id": 67031458, "body": "Yes i need a way to get the number from the quantity textbox and add it to the datatable by pressing a button"}, {"owner": {"reputation": 37, "user_id": 5979952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4958500e24bf46cfddd5c69bc5e69d91?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitris Afendras", "link": "https://stackoverflow.com/users/5979952/dimitris-afendras"}, "edited": false, "score": 0, "creation_date": 1475666171, "post_id": 39872306, "comment_id": 67031519, "body": "the quantity textbox is in a subform contained in my main form how do i access its properties?"}, {"owner": {"reputation": 1308, "user_id": 3017149, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/K18gw.jpg?s=128&g=1", "display_name": "Tedo G.", "link": "https://stackoverflow.com/users/3017149/tedo-g"}, "edited": false, "score": 0, "creation_date": 1475667579, "post_id": 39872306, "comment_id": 67032504, "body": "<code>TextBoxValue = Forms!YourSubform!YourTextbox</code> Then make an insert statement with this parameter"}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1475679526, "post_id": 39872306, "comment_id": 67041585, "body": "Don&#39;t expect people to do all your job. Try some things, then ask for particular issue. Not &quot;how to do my whole project&quot;. Have fun and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> please."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1475689046, "post_id": 39872306, "comment_id": 67047528, "body": "Your SQL statement gets you halfway there.  Use that same SQL statement to retrieve a &quot;recordset&quot; and use that to get your [Quantity] that you can use in an UPDATE/INSERT/DELETE statement."}], "owner": {"reputation": 37, "user_id": 5979952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4958500e24bf46cfddd5c69bc5e69d91?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitris Afendras", "link": "https://stackoverflow.com/users/5979952/dimitris-afendras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594641266, "creation_date": 1475665595, "last_edit_date": 1594641266, "question_id": 39872306, "link": "https://stackoverflow.com/questions/39872306/query-to-get-a-subforms-text-value-from-the-main-form", "title": "Query to get a subforms text value from the main form", "body": "<p>I'm trying to select/update/add/delete stuff from a textbox in a sub-form which is in my main form. I need a way to access the said textboxes value and interact with it. This code is from a search box I created.</p>\n\n<pre><code>Private Sub btnSearch_Click()\n  Dim SQL As String\n\n  SQL = \"SELECT row.product_id, row.product_name, row.impacode, row.product_description, row.explanation, row.mu, row.category_name, row.Quantity \" _\n    &amp; \"FROM row \" _\n    &amp; \"Where product_name LIKE '*\" &amp; Me.txtKeywords &amp; \"*' \" _\n    &amp; \"OR category_name LIKE '*\" &amp; Me.txtKeywords &amp; \"*' \" _\n    &amp; \"ORDER BY row.impacode \"\n\n   Me.SubCatalog.Form.RecordSource = SQL\n   Me.SubCatalog.Form.Requery\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/xnONH.png\" alt=\"enter image description here\"></p>\n\n<p>I want to access the quantity textbox, get the number, and update the table or remove it etc...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1475665716, "post_id": 39872238, "comment_id": 67031224, "body": "You have a typo there : ` lRow = replaceSheet.Cells(Rows.Count, aCell).End(x1Up).Row` it&#39;s <code>xLUp</code> change the <code>1</code> to <code>l</code>"}, {"owner": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1475666254, "post_id": 39872238, "comment_id": 67031590, "body": "Oh, God, I feel so stupid, thanks for pointing it out, I&#39;ve now got it working, not sure if you can get your comment into the answers so I can accept it. I wish Excel would point these things out better!"}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "edited": false, "score": 1, "creation_date": 1475668354, "post_id": 39872619, "comment_id": 67033014, "body": "Although this did answer the question about what is wrong, I should point out that replace loop is there to get each lookup item, search for it in the column, and replace each one within that, whereas this code just pastes the entire array, in order, to the new column."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1475666520, "creation_date": 1475666520, "answer_id": 39872619, "question_id": 39872238, "link": "https://stackoverflow.com/questions/39872238/find-a-column-by-header-name-and-replace-values-in-column-with-array-items/39872619#39872619", "title": "Find a column by header name and replace values in column with array items", "body": "<p>As pointed out in comments, you have a typo there : <code>lRow = replaceSheet.Cells(Rows.Count, aCell).End(x1Up).Row</code> it's <code>xLUp</code> change the <code>1</code> to <code>l</code></p>\n\n<p>A few changes to use ranges and avoid using replace with the array to simply put the values as you already have them in the good order :</p>\n\n<pre><code>Sub ChangeCol()\n\nDim strArray As Variant\nDim TotalRows As Long\nDim replaceSheet As Worksheet\nDim lookupSheet As Worksheet\nDim I As Long\nDim lRow As Long\nDim ColToCopy As Long\nDim MatchedHeader As Range\nDim ZoneToFill As Range\n\n    'Set worksheets\n    Set lookupSheet = ThisWorkbook.Sheets(1)\n    Set replaceSheet = ThisWorkbook.Sheets(2)\n\n    'Load lookupArray\n    ColToCopy = 2\n    TotalRows = lookupSheet.Cells(lookupSheet.Rows.Count, ColToCopy).End(xlUp).Row\n    strArray = lookupSheet.Range(Cells(2, ColToCopy), Cells(TotalRows, ColToCopy)).Value\n    MsgBox \"Loaded \" &amp; UBound(strArray) &amp; \" items!\"\n\n    'Find column to replace values\n    Set MatchedHeader = replaceSheet.Range(\"A1:DD1\").Find(What:=\"NewCol\", LookIn:=xlValues, LookAt:=xlWhole, _\n                        MatchCase:=False, SearchFormat:=False)\n\n    lRow = replaceSheet.Cells(replaceSheet.Rows.Count, MatchedHeader.Column).End(xlUp).Row\n\n    'Resize the range to fit the array and send the values in\n    MatchedHeader.Offset(1, 0).Resize(UBound(strArray, 1), UBound(strArray, 2)).Value = strArray\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 0, "accepted_answer_id": 39872619, "answer_count": 1, "score": 1, "last_activity_date": 1475666520, "creation_date": 1475665365, "question_id": 39872238, "link": "https://stackoverflow.com/questions/39872238/find-a-column-by-header-name-and-replace-values-in-column-with-array-items", "title": "Find a column by header name and replace values in column with array items", "body": "<p>I've been asked to create a tool that will allow me to replace numerical values with text values using a lookup, the lookup values come from a worksheet (\"lookupSheet\", for the purpose of this question), and are intended to replace the numerical values in another worksheet (\"replaceSheet\", for the purpose of this question.) So if 0=dog,1=cat,2=cow,3=sheep And my original column looks like:</p>\n\n<pre><code>NewCol\n0\n1\n2\n3\n1\n0\n</code></pre>\n\n<p>It should then, after running on the lookup range, look like:</p>\n\n<pre><code>NewCol\nDog\nCat\nCow\nSheep\nCat\nDog\n</code></pre>\n\n<p>The lookup values are always in the order of their corresponding number, so it is easy to pass this in to an array. However, one issue is that the column header remains the same, but could change in its position within different worksheets, so I've tried to adapt code that worked so it will first find the header by its name (\"NewCol\", for the purposes of this question), get the column reference, and then apply the loop to change values to this. However, every time I get to the loop in my code, I get an application defined or object defined error, and I'm unsure what it is I'm doing wrong. I put a break point on the \"lRow =\" line, and after this is when the error occurs.</p>\n\n<pre><code>Sub ChangeCol()\n\nDim strArray As Variant\nDim TotalRows As Long\nDim replaceSheet As Worksheet\nDim lookupSheet As Worksheet\nDim I As Long\nDim lRow As Long\nDim aCell As Long\n\n    'Set worksheets\n    Set lookupSheet = ThisWorkbook.Sheets(1)\n    Set replaceSheet = ThisWorkbook.Sheets(2)\n\n    'Load lookupArray\n    TotalRows = lookupSheet.Rows(Rows.Count).End(xlUp).Row\n    strArray = lookupSheet.Range(Cells(2, 2), Cells(TotalRows, 2)).Value\n    MsgBox \"Loaded \" &amp; UBound(strArray) &amp; \" items!\"\n\n    'Find column to replace values\n    aCell = replaceSheet.Range(\"A1:DD1\").Find(What:=\"NewCol\", LookIn:=xlValues, LookAt:=xlWhole, _\n    MatchCase:=False, SearchFormat:=False).Column\n\n    lRow = replaceSheet.Cells(Rows.Count, aCell).End(x1Up).Row\n\n    'Loop through lookup array and replace values\n    For I = 1 To UBound(strArray)\n        replaceSheet.Columns(aCell).replace What:=(I - 1), Replacement:=strArray(I, 1), LookAt:=xlWhole, MatchCase:=True\n    Next I\n\nEnd Sub\n</code></pre>\n\n<p>I'm unsure what is going wrong with it, or if there is a better way around this, any help on where I'm going wrong is much appreciated.</p>\n"}, {"tags": ["sql-server", "vba"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1475665429, "post_id": 39872196, "comment_id": 67031031, "body": "<a href=\"http://stackoverflow.com/questions/7076801/error-must-declare-the-scalar-variable-for-insert-statements-in-multiple-data\" title=\"error must declare the scalar variable for insert statements in multiple data\">stackoverflow.com/questions/7076801/&hellip;</a> may help you"}, {"owner": {"reputation": 6247, "user_id": 439497, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/913585cae910787fdd2186698cc7698e?s=128&d=identicon&r=PG", "display_name": "ManInMoon", "link": "https://stackoverflow.com/users/439497/maninmoon"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1475665719, "post_id": 39872196, "comment_id": 67031226, "body": "No, that&#39;s a different thing. This is about creating parameters in ADODB"}, {"owner": {"reputation": 8287, "user_id": 3611669, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f87a44fc3ba9cfb0975908cba210dc30?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoG", "link": "https://stackoverflow.com/users/3611669/guidog"}, "edited": false, "score": 0, "creation_date": 1475665833, "post_id": 39872196, "comment_id": 67031297, "body": "have you checked with profiler how the insert command that is send to the database lookes like ? Maybe you can find some clue there"}, {"owner": {"reputation": 8287, "user_id": 3611669, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f87a44fc3ba9cfb0975908cba210dc30?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoG", "link": "https://stackoverflow.com/users/3611669/guidog"}, "edited": false, "score": 0, "creation_date": 1475665966, "post_id": 39872196, "comment_id": 67031393, "body": "I dont know vb but in c# some idiot at microsoft made it so that when the value you give for a parameter is null then the whole parameter is left out of the command, thus giving exact this error"}], "answers": [{"tags": [], "owner": {"reputation": 2454, "user_id": 3873776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5fa0c0947803cfe188af71b206ee81d?s=128&d=identicon&r=PG&f=1", "display_name": "beercohol", "link": "https://stackoverflow.com/users/3873776/beercohol"}, "is_accepted": false, "score": 2, "last_activity_date": 1475666996, "creation_date": 1475666996, "answer_id": 39872788, "question_id": 39872196, "link": "https://stackoverflow.com/questions/39872196/error-when-using-parameters-in-adodb/39872788#39872788", "title": "Error when using Parameters in ADODB", "body": "<p>You can't name your parameters in the SQL command text as you've tried to do.</p>\n\n<p>If you change all of them simply to the \"?\" placeholder then your code should work, e.g.</p>\n\n<pre><code>Dim strSQL As String\n\nstrSQL = \"INSERT INTO [\" &amp; AccountCode &amp; \"].[Orders] ( OrderID,OrderDate,BarUTC,OrderUTC,Exchange,Symbol,OrderSignedAmount,OrderPrice,Type,TargetPosition,AccountIdent,Status)\" _\n          &amp; \" VALUES ( ?,?,?,?,?,?,?,?,?,?,?,?)\"\n\nDim cmd As New ADODB.Command\nSet cmd.ActiveConnection = objMyConn\n\ncmd.CommandText = strSQL\ncmd.CommandType = adCmdText\ncmd.NamedParameters = True\nSeqNum = SeqNum + 1\nAccountIdent = AccountCode + \":\" + ModelCode\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderID\", adInteger, adParamInput, -1, SeqNum)\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderDate\", adDate, adParamInput, 0, Date)\ncmd.Parameters.Append cmd.CreateParameter(\"@BarUTC\", adDBTimeStamp, adParamInput, 0, Time)\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderUTC\", adDBTimeStamp, adParamInput, 0, Time)\ncmd.Parameters.Append cmd.CreateParameter(\"@Exchange\", adVarChar, adParamInput, -1, \"Future\")\ncmd.Parameters.Append cmd.CreateParameter(\"@Symbol\", adVarChar, adParamInput, -1, Symbol)\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderSignedAmount\", adInteger, adParamInput, , TargetPosition)\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderPrice\", adDouble, adParamInput, , -1)\ncmd.Parameters.Append cmd.CreateParameter(\"@Type\", adVarChar, adParamInput, -1, \"MARKETIOC\")\ncmd.Parameters.Append cmd.CreateParameter(\"@TargetPosition\", adInteger, adParamInput, , TargetPosition)\ncmd.Parameters.Append cmd.CreateParameter(\"@AccountIdent\", adVarChar, adParamInput, -1, AccountIdent)\ncmd.Parameters.Append cmd.CreateParameter(\"@Status\", adVarChar, adParamInput, -1, \"NEW\")\n\ncmd.Execute\n</code></pre>\n\n<p>At that point it doesn't matter what you call them when you create the command parameters. Take note that the parameters are passed by ordinal position not by name!</p>\n\n<p>If you want to name the parameters in your SQL code nicely then you should look into creating a stored procedure, although your dynamic schema name would make that tricky.</p>\n\n<p>You could possibly also use <code>sp_executesql</code>. <a href=\"https://msdn.microsoft.com/en-us/library/ms188001.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms188001.aspx</a></p>\n"}], "owner": {"reputation": 6247, "user_id": 439497, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/913585cae910787fdd2186698cc7698e?s=128&d=identicon&r=PG", "display_name": "ManInMoon", "link": "https://stackoverflow.com/users/439497/maninmoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475666996, "creation_date": 1475665239, "question_id": 39872196, "link": "https://stackoverflow.com/questions/39872196/error-when-using-parameters-in-adodb", "title": "Error when using Parameters in ADODB", "body": "<pre><code>Dim strSQL As String\n\nstrSQL = \"INSERT INTO [\" &amp; AccountCode &amp; \"].[Orders] ( OrderID,OrderDate,BarUTC,OrderUTC,Exchange,Symbol,OrderSignedAmount,OrderPrice,Type,TargetPosition,AccountIdent,Status)\" _\n          &amp; \" VALUES ( @OrderID,@OrderDate,@BarUTC,@OrderUTC,@Exchange,@Symbol,@OrderSignedAmount,@OrderPrice,@Type,@TargetPosition,@AccountIdent,@Status)\"\n\nDim cmd As New ADODB.Command\nSet cmd.ActiveConnection = objMyConn\n\ncmd.CommandText = strSQL\ncmd.CommandType = adCmdText\ncmd.NamedParameters = True\nSeqNum = SeqNum + 1\nAccountIdent = AccountCode + \":\" + ModelCode\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderID\", adInteger, adParamInput, -1, SeqNum)\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderDate\", adDate, adParamInput, 0, Date)\ncmd.Parameters.Append cmd.CreateParameter(\"@BarUTC\", adDBTimeStamp, adParamInput, 0, Time)\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderUTC\", adDBTimeStamp, adParamInput, 0, Time)\ncmd.Parameters.Append cmd.CreateParameter(\"@Exchange\", adVarChar, adParamInput, -1, \"Future\")\ncmd.Parameters.Append cmd.CreateParameter(\"@Symbol\", adVarChar, adParamInput, -1, Symbol)\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderSignedAmount\", adInteger, adParamInput, , TargetPosition)\ncmd.Parameters.Append cmd.CreateParameter(\"@OrderPrice\", adDouble, adParamInput, , -1)\ncmd.Parameters.Append cmd.CreateParameter(\"@Type\", adVarChar, adParamInput, -1, \"MARKETIOC\")\ncmd.Parameters.Append cmd.CreateParameter(\"@TargetPosition\", adInteger, adParamInput, , TargetPosition)\ncmd.Parameters.Append cmd.CreateParameter(\"@AccountIdent\", adVarChar, adParamInput, -1, AccountIdent)\ncmd.Parameters.Append cmd.CreateParameter(\"@Status\", adVarChar, adParamInput, -1, \"NEW\")\n\ncmd.Execute\n</code></pre>\n\n<p>This gives me a \"Must declare the scalar variable error \"@OrderID\"</p>\n\n<p>Why?</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1475664921, "post_id": 39871992, "comment_id": 67030698, "body": "Range objects have a <code>Find</code> method. There is seldom any good reason for looping through a range, searching for a value cell by cell."}, {"owner": {"reputation": 1, "user_id": 4822952, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-ReaRNfsGa6Q/AAAAAAAAAAI/AAAAAAAAARI/cufCDh--qvs/photo.jpg?sz=128", "display_name": "Sir Ivan", "link": "https://stackoverflow.com/users/4822952/sir-ivan"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475665063, "post_id": 39871992, "comment_id": 67030786, "body": "i use that code, because im going to search a number like this &quot;205156&quot; like that, whenever i put a number, data corresponds into that number will be automatically populated in other textbox like this  Textbox1: employee No. Textbox2: will automatically show the name of employee textbox3: will automatically show the address of employee"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475665578, "post_id": 39871992, "comment_id": 67031140, "body": "&quot;i use that code, because im going to search a number ...&quot; . This is perfectly consistent with using the <code>Find</code> method. VBA isn&#39;t the fastest language out there (since it runs in a byte-code interpreter). Something like <code>Find</code> is written in C and has direct access to the underlying data structures (rather than having to constantly go through the Excel object model). When searching through large ranges it is noticeably faster. Maybe you don&#39;t have time to refactor your code right now, but it is a good idea to become familiar with using <code>Range(whatever).Find()</code>."}, {"owner": {"reputation": 1, "user_id": 4822952, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-ReaRNfsGa6Q/AAAAAAAAAAI/AAAAAAAAARI/cufCDh--qvs/photo.jpg?sz=128", "display_name": "Sir Ivan", "link": "https://stackoverflow.com/users/4822952/sir-ivan"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475665722, "post_id": 39871992, "comment_id": 67031228, "body": "i need some help with this one, im having hardtime to set my code to search the offset named sheet, if you can modify the code, that would be a great help for me"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475665775, "post_id": 39871992, "comment_id": 67031261, "body": "Unfortunately, I need to go to work soon. Good luck."}], "owner": {"reputation": 1, "user_id": 4822952, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-ReaRNfsGa6Q/AAAAAAAAAAI/AAAAAAAAARI/cufCDh--qvs/photo.jpg?sz=128", "display_name": "Sir Ivan", "link": "https://stackoverflow.com/users/4822952/sir-ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 691, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475664695, "creation_date": 1475664695, "question_id": 39871992, "link": "https://stackoverflow.com/questions/39871992/excel-vba-userform-search", "title": "excel vba userform search", "body": "<p>i need some help with search function with this, how can i convert this that userform will search other sheet of my workbook</p>\n\n<p>name of other sheet is \"DataSource\"</p>\n\n<p>im planning to separate the data into another sheet of workbook then define a name and i will make it as offset so inshort whenever i put another data it will be able to search with the use of my search userform</p>\n\n<p>This is my code</p>\n\n<pre><code>Sub GetData()\nDim id As Integer, i As Integer, j As Integer, flag As Boolean\n\nIf IsNumeric(UserForm1.TextBox1.Value) Then\n    flag = False\n    i = 0\n    id = UserForm1.TextBox1.Value\n\n    Do While Cells(i + 1, 1).Value &lt;&gt; \"\"\n\n        If Cells(i + 1, 1).Value = id Then\n            flag = True\n            For j = 2 To 3\n                UserForm1.Controls(\"TextBox\" &amp; j).Value = Cells(i + 1, j).Value\n            Next j\n        End If\n\n        i = i + 1\n\n    Loop\n\n    If flag = False Then\n        For j = 2 To 3\n            UserForm1.Controls(\"TextBox\" &amp; j).Value = \"\"\n        Next j\n    End If\n\nElse\n    ClearForm\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This is my code for editing data</p>\n\n<pre><code>Sub EditAdd()\n\nDim emptyRow As Long\n\nIf UserForm1.TextBox1.Value &lt;&gt; \"\" Then\n    flag = False\n    i = 0\n    id = UserForm1.TextBox1.Value\n    emptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n    Do While Cells(i + 1, 1).Value &lt;&gt; \"\"\n\n        If Cells(i + 1, 1).Value = id Then\n            flag = True\n            For j = 2 To 3\n                Cells(i + 1, j).Value = UserForm1.Controls(\"TextBox\" &amp; j).Value\n            Next j\n        End If\n\n        i = i + 1\n\n    Loop\n\n    If flag = False Then\n        For j = 1 To 3\n            Cells(emptyRow, j).Value = UserForm1.Controls(\"TextBox\" &amp; j).Value\n        Next j\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This is defined name of Datasource sheet</p>\n\n<p>Name: data</p>\n\n<pre><code>=OFFSET(DataSource!$A:$A,1,0,COUNTA(DataSource!$A:$A)-1,1)\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1475665278, "post_id": 39871814, "comment_id": 67030939, "body": "Which command do you use? <code>SaveAs</code>? Insert your code too so we can have a bit more info! ;)"}, {"owner": {"reputation": 1, "user_id": 6715664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f50ef7c86d9f7e0c8a0ad0e03091e27?s=128&d=identicon&r=PG&f=1", "display_name": "Adeep", "link": "https://stackoverflow.com/users/6715664/adeep"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1475670814, "post_id": 39871814, "comment_id": 67034671, "body": "I am trying to save a pdf in Network drive that takes time like 30 seconds and showing the saving location. I want to hide this saving location"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1475670985, "post_id": 39871814, "comment_id": 67034785, "body": "So... do you have any code or are you manually saving it?"}, {"owner": {"reputation": 1, "user_id": 6715664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f50ef7c86d9f7e0c8a0ad0e03091e27?s=128&d=identicon&r=PG&f=1", "display_name": "Adeep", "link": "https://stackoverflow.com/users/6715664/adeep"}, "edited": false, "score": 0, "creation_date": 1475736709, "post_id": 39871814, "comment_id": 67064785, "body": "I am trying to save it by code. in code i used -   Application.ScreenUpdating = False Application.EnableEvents = False Application.DisplayAlerts = False   But Still seen this mesage"}], "owner": {"reputation": 1, "user_id": 6715664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f50ef7c86d9f7e0c8a0ad0e03091e27?s=128&d=identicon&r=PG&f=1", "display_name": "Adeep", "link": "https://stackoverflow.com/users/6715664/adeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475960911, "creation_date": 1475664148, "last_edit_date": 1475960911, "question_id": 39871814, "link": "https://stackoverflow.com/questions/39871814/hide-saving-location-in-saving-dialog-vba", "title": "Hide saving location in saving dialog VBA", "body": "<p><img src=\"https://i.stack.imgur.com/MPB8l.jpg\" alt=\"enter image description here\"></p>\n\n<p>Can anyone tell me how to hide this dialog box I used below code?</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.DisplayAlerts = False\n</code></pre>\n"}, {"tags": ["vb.net", "vba", "winapi", "ms-access-2010", "sqlfilestream"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1475664431, "post_id": 39871736, "comment_id": 67030352, "body": "Are you overcomplicating this? ADO can read/write FILESTREAM data trivially: (<a href=\"https://www.experts-exchange.com/questions/26923910/How-to-save-and-read-files-stored-as-FileStream-in-SQL-Server-2008-from-MS-Access-2007-vba.html\" rel=\"nofollow noreferrer\">E.g.</a>) - If for whatever reason you can&#39;t do this you would build the VB.Net code into a COM Visible assembly DLL and call it from VBA via a reference."}, {"owner": {"reputation": 354, "user_id": 4654311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/064f9c225b88b7d777e533a713964a06?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Quigley", "link": "https://stackoverflow.com/users/4654311/patrick-quigley"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1475667157, "post_id": 39871736, "comment_id": 67032241, "body": "Hi Alex,   I&#39;ve tried using adodb.stream to read the BLOB data. I ran into a problem there of having no idea what each file extension or original (before being added to a filestream column) file name was. If I am able to access that information I&#39;d be able to use ADO sure.  However, the second suggestions sounds good.  Can you point me towards resources for building a COM visible assembly DLL? I know how to add the reference after it&#39;s written but, no idea how to write one myself."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1475668500, "post_id": 39871736, "comment_id": 67033105, "body": "You can do that with a select query: <code>select file_strm_col.PathName() from your_table where id=x</code>"}, {"owner": {"reputation": 354, "user_id": 4654311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/064f9c225b88b7d777e533a713964a06?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Quigley", "link": "https://stackoverflow.com/users/4654311/patrick-quigley"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1475823212, "post_id": 39871736, "comment_id": 67106825, "body": "PathName() is no good unfortunately. PathName() returns the current path of the file in the file container. Based on what is returned, the file is given its own name by the filestream system.  For example if I insert the file &#39;mypdf.pdf&#39; into a filestream enabled column, PathName() will return a string which doesn&#39;t contain &#39;mypdf&#39; or &#39;.pdf&#39;.  I&#39;d need to know the original file name of &#39;mypdf.pdf&#39;."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1475838001, "post_id": 39871736, "comment_id": 67115231, "body": "That&#39;s as good as it gets iirc as the original file name is not exposed, how were you going to do it using the API you mention?"}, {"owner": {"reputation": 354, "user_id": 4654311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/064f9c225b88b7d777e533a713964a06?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Quigley", "link": "https://stackoverflow.com/users/4654311/patrick-quigley"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1475846998, "post_id": 39871736, "comment_id": 67120792, "body": "Hey Alex, I&#39;m a few hours into building a COM viable assembly DLL as per your suggestion. Thank you for suggesting that, I didn&#39;t realize I could write my own. I&#39;m writing it in C# using Visual Studio Community.  The DLL will allow me to make use of C#&#39;s &#39;SqlFileStream&#39; class within my VBA Access client.  I&#39;ll answer the question when/if I&#39;ve succeeded."}], "owner": {"reputation": 354, "user_id": 4654311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/064f9c225b88b7d777e533a713964a06?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Quigley", "link": "https://stackoverflow.com/users/4654311/patrick-quigley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1475663916, "creation_date": 1475663916, "question_id": 39871736, "link": "https://stackoverflow.com/questions/39871736/how-can-i-run-vb-net-code-from-within-access-2010-vba-accessing-win-32-opensq", "title": "How can I run vb.NET code from within Access 2010 (vba)? Accessing win 32 OpenSqlFilestream API through vb.NET, within Access 2010", "body": "<p>thanks for your time good people!</p>\n\n<p>I am adapting an Access 2010 client to work with a new SQL Express Server 2008 back end. The back end is up and running. No problems there. Filestream is configured and working fine.</p>\n\n<p>My problem relates to acessing the filestream BLOB data I've stored in the SQL Express Server 2008 instance from my client. Specifically accessing the data through the win 32 OpenSqlFilestream API as detailed here: <a href=\"https://msdn.microsoft.com/en-us/library/cc645940.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/cc645940.aspx</a></p>\n\n<p>I know I cannot access this API within VBA. I have to write all the relevant code in a different language. Therefore I plan to write a mini-program in VB.NET which will consist of a pop up form that allows users to add, edit, delete etc the files stored through filestream. </p>\n\n<p><strong>I want to open this mini VB.NET program from within Access 2010 as a pop up form.</strong></p>\n\n<p>How do i do this? I have never written or compiled a program in vb.NET, furthermore I don't know how I can then call this program from within my VBA code in the Access 2010 client.</p>\n\n<p>Please help.</p>\n\n<p>Thanks,</p>\n\n<p>Patrick Quigley</p>\n"}, {"tags": ["excel", "keyboard-shortcuts", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1475663685, "post_id": 39871323, "comment_id": 67029882, "body": "Check this thread: <a href=\"http://stackoverflow.com/questions/16862306/excel-vba-to-list-key-bindings-onkey\" title=\"excel vba to list key bindings onkey\">stackoverflow.com/questions/16862306/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1475665424, "post_id": 39871493, "comment_id": 67031024, "body": "Thanks, that was the first place I looked at. It&#39;s empty but I&#39;m sure that I could launch it from the keyboard."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 4, "last_activity_date": 1519829105, "last_edit_date": 1519829105, "creation_date": 1475663222, "answer_id": 39871493, "question_id": 39871323, "link": "https://stackoverflow.com/questions/39871323/forgotten-vba-keyboard-shortcut/39871493#39871493", "title": "Forgotten VBA keyboard shortcut", "body": "<p>Bring up the Macro dialog box (<kbd>Alt</kbd>+<kbd>F8</kbd> or Macros on the View ribbon).  </p>\n\n<p><a href=\"https://i.stack.imgur.com/xhm9x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xhm9x.png\" alt=\"enter image description here\"></a></p>\n\n<p>Select your macro.  </p>\n\n<p>Click the <strong>Options</strong> button.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/NJiwQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NJiwQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": true, "score": 0, "last_activity_date": 1476001991, "creation_date": 1476001991, "answer_id": 39941581, "question_id": 39871323, "link": "https://stackoverflow.com/questions/39871323/forgotten-vba-keyboard-shortcut/39941581#39941581", "title": "Forgotten VBA keyboard shortcut", "body": "<p>Well, I found it.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.OnKey \"{F12}\", \"MyMacro\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 39941581, "answer_count": 2, "score": 0, "last_activity_date": 1519829105, "creation_date": 1475662670, "last_edit_date": 1531164843, "question_id": 39871323, "link": "https://stackoverflow.com/questions/39871323/forgotten-vba-keyboard-shortcut", "title": "Forgotten VBA keyboard shortcut", "body": "<p>I assigned my macro to a keyboard shortcut in Excel-VBA. It was a long time ago and I forgot to which key. How can I see it?</p>\n"}, {"tags": ["excel", "vba", "macos", "printing", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6921783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300368de1b6604ebae216735d0b59fbc?s=128&d=identicon&r=PG&f=1", "display_name": "Hlrhodes", "link": "https://stackoverflow.com/users/6921783/hlrhodes"}, "edited": false, "score": 0, "creation_date": 1475672816, "post_id": 39872050, "comment_id": 67036118, "body": "Thank you for your reply.  Yes, my file is on a network.  Sorry I&#39;m new to VBA so I have tried out both of your pieces of code but I can&#39;t seem to get either one to work.  I have added the &quot;//&quot; to the beginning of my file path. The total length of my file path is 160 characters long - I don&#39;t know if that is what is causing the problem?  The error message I am getting when I run the second piece of code that you sent says &quot;Compile Error: User-defined type not define&quot; and this highlights the code      objWord As Word.Application  Any ideas?"}, {"owner": {"reputation": 11, "user_id": 6921783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300368de1b6604ebae216735d0b59fbc?s=128&d=identicon&r=PG&f=1", "display_name": "Hlrhodes", "link": "https://stackoverflow.com/users/6921783/hlrhodes"}, "edited": false, "score": 0, "creation_date": 1475673137, "post_id": 39872050, "comment_id": 67036345, "body": "For the first piece of code which tests if the file exists or the file path is correct I get the error message &quot;Compile error: Expected: expression&quot;"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 11, "user_id": 6921783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300368de1b6604ebae216735d0b59fbc?s=128&d=identicon&r=PG&f=1", "display_name": "Hlrhodes", "link": "https://stackoverflow.com/users/6921783/hlrhodes"}, "edited": false, "score": 0, "creation_date": 1475685297, "post_id": 39872050, "comment_id": 67045436, "body": "@Hlrhodes : The length won&#39;t be an issue under 255 chars, try the edit (google immediate window if you don&#39;t know it). I&#39;ve removed the <code>Word.App-Doc</code> and the test to see if the file exists, this should work that way. Not sure how to test the file existence on Mac... :/"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1475685163, "last_edit_date": 1475685163, "creation_date": 1475664819, "answer_id": 39872050, "question_id": 39870994, "link": "https://stackoverflow.com/questions/39870994/using-a-mac-print-a-word-document-using-a-macro-in-excel/39872050#39872050", "title": "Using a MAC, print a Word document using a macro in Excel", "body": "<p>Is your file on a network?</p>\n\n<p>Use that code in Word VBE to get the path of your file in the immediate window :</p>\n\n<pre><code>Sub get_path()\n   Debug.Print ActiveDocument.Path\nEnd Sub\n</code></pre>\n\n<p>Try this function to test if the file exists (not sure how to make this work on Mac...) :</p>\n\n<pre><code>Public Function File_Exist(sFilePath As String) As Boolean\n    Dim sProv As String\n    On Error GoTo ErrorHandler\n        sProv = Dir(sFilePath, vbDirectory)\n\n        File_Exist = (sProv &lt;&gt; \"\")\n    On Error GoTo 0\n    Exit Function\n\nErrorHandler:\n    MsgBox Prompt:=\"Error on test file= \" &amp; sFilePath &amp; vbCrLf &amp; Err.Number &amp; vbCrLf &amp; Err.Description\nEnd Function\n</code></pre>\n\n<p>And your code with some improvements :</p>\n\n<pre><code>ans = MsgBox(Prompt:=\"Document 1\", Buttons:=vbYesNo, Title:=\"Print\")\nIf ans = vbYes Then\n    Dim objWord As Object\n    Dim objDoc As Object\n    Dim sFilePath As String\n    ''If the file is a network, you should start the path with //\n    sFilePath = \"New_path_from_Word_immediate_window\"\n\n    On Error Resume Next\n    Set objWord = GetObject(, \"Word.Application\")\n    If Err.Number &lt;&gt; 0 Then\n        Set objWord = CreateObject(\"Word.Application\")\n    End If\n    On Error GoTo 0\n\n\n    objWord.Visible = False\n    'Enter filename and path here\n    'If File_Exist(sFilePath) Then\n        Set objDoc = objWord.Documents.Open(sFilePath)\n        objDoc.PrintOut\n        objDoc.Close\n    'Else\n        'MsgBox \"File doesn't exist!\" &amp; vbCrLf &amp; sFilePath, vbCritical + vbOKOnly\n    'End If\n\n    objWord.Quit\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6921783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300368de1b6604ebae216735d0b59fbc?s=128&d=identicon&r=PG&f=1", "display_name": "Hlrhodes", "link": "https://stackoverflow.com/users/6921783/hlrhodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 612, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592988981, "creation_date": 1475661685, "last_edit_date": 1592988981, "question_id": 39870994, "link": "https://stackoverflow.com/questions/39870994/using-a-mac-print-a-word-document-using-a-macro-in-excel", "title": "Using a MAC, print a Word document using a macro in Excel", "body": "<p>I am using a MAC and I'm trying to create a macro that will print a Word document from my Excel worksheet. The user does not need to see the word document, they just need to print it.</p>\n\n<p>After looking through some of the previous questions answered in this forum I managed to write some code that worked on my PC at home. </p>\n\n<p>However, I changed the file path and filename and copied the code to my MAC that I am using at work and the code no longer seems to work. I wonder if the code has to be different when using a MAC?</p>\n\n<p>I am using Microsoft Excel for Mac 2011, version 14.6.8.</p>\n\n<pre><code>ans = MsgBox(Prompt:=\"Document 1\", Buttons:=vbYesNo, Title:=\"Print\")\nIf ans = vbYes Then\n    Dim objWord\n    Dim objDoc\n    Set objWord = CreateObject(\"Word.Application\")\n    'Enter filename and path here\n    Set objDoc = objWord.Documents.Open(\"/Volumes/.../Document 1.docx\")\n    objWord.Visible = False\n    objDoc.PrintOut\n    objWord.Quit\nEnd If\n</code></pre>\n\n<p>Sometimes the code gets stuck at <code>CreateObject(\"Word.Application\")</code> and sometimes the code get stuck where I have written the file path and filename. </p>\n\n<p>I'm not entirely sure that I have written the file path correctly..?</p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 3176869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7bec26d7576f3d5fa0346f9f0bec12bf?s=128&d=identicon&r=PG&f=1", "display_name": "Malteaser6900", "link": "https://stackoverflow.com/users/3176869/malteaser6900"}, "edited": false, "score": 0, "creation_date": 1475671992, "post_id": 39873117, "comment_id": 67035502, "body": "that will only work up to a(99), once I hit a(100) that will be sorted after a(10) then a(11) etc... I&#39;d rather not have to prefix multiple 0s to my filenames..."}, {"owner": {"reputation": 26, "user_id": 5851385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067687d517ca2358b06bcec599cefd1a?s=128&d=identicon&r=PG&f=1", "display_name": "hans_h", "link": "https://stackoverflow.com/users/5851385/hans-h"}, "reply_to_user": {"reputation": 63, "user_id": 3176869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7bec26d7576f3d5fa0346f9f0bec12bf?s=128&d=identicon&r=PG&f=1", "display_name": "Malteaser6900", "link": "https://stackoverflow.com/users/3176869/malteaser6900"}, "edited": false, "score": 0, "creation_date": 1475680380, "post_id": 39873117, "comment_id": 67042236, "body": "Got it. Got some code done, that should sort you problem out. Just can&#39;t test it right now &#39;cause I don&#39;t have outlook at home. I&#39;ll come back to you tomorrow!"}, {"owner": {"reputation": 26, "user_id": 5851385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067687d517ca2358b06bcec599cefd1a?s=128&d=identicon&r=PG&f=1", "display_name": "hans_h", "link": "https://stackoverflow.com/users/5851385/hans-h"}, "reply_to_user": {"reputation": 63, "user_id": 3176869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7bec26d7576f3d5fa0346f9f0bec12bf?s=128&d=identicon&r=PG&f=1", "display_name": "Malteaser6900", "link": "https://stackoverflow.com/users/3176869/malteaser6900"}, "edited": false, "score": 0, "creation_date": 1475744890, "post_id": 39873117, "comment_id": 67069768, "body": "So. The code is there and should work! Hope it helps."}, {"owner": {"reputation": 63, "user_id": 3176869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7bec26d7576f3d5fa0346f9f0bec12bf?s=128&d=identicon&r=PG&f=1", "display_name": "Malteaser6900", "link": "https://stackoverflow.com/users/3176869/malteaser6900"}, "edited": false, "score": 0, "creation_date": 1475751333, "post_id": 39873117, "comment_id": 67073886, "body": "that took quite a bit of effort thank you! Worked exactly as I wanted, just had to make one small tweak when adding the files to the ListBox"}, {"owner": {"reputation": 26, "user_id": 5851385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067687d517ca2358b06bcec599cefd1a?s=128&d=identicon&r=PG&f=1", "display_name": "hans_h", "link": "https://stackoverflow.com/users/5851385/hans-h"}, "reply_to_user": {"reputation": 63, "user_id": 3176869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7bec26d7576f3d5fa0346f9f0bec12bf?s=128&d=identicon&r=PG&f=1", "display_name": "Malteaser6900", "link": "https://stackoverflow.com/users/3176869/malteaser6900"}, "edited": false, "score": 0, "creation_date": 1475753147, "post_id": 39873117, "comment_id": 67075049, "body": "no problem. i even think this could all be done without the DirArray, using the ListBox itself as the Container for sorting. but well, maybe another time :)"}], "tags": [], "owner": {"reputation": 26, "user_id": 5851385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067687d517ca2358b06bcec599cefd1a?s=128&d=identicon&r=PG&f=1", "display_name": "hans_h", "link": "https://stackoverflow.com/users/5851385/hans-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1475753794, "last_edit_date": 1475753794, "creation_date": 1475667976, "answer_id": 39873117, "question_id": 39870948, "link": "https://stackoverflow.com/questions/39870948/ordering-files-in-a-listbox-alphabetically-and-not-numerically/39873117#39873117", "title": "Ordering Files in a Listbox Alphabetically and not Numerically", "body": "<p>The easiest way I see the problem solved is to just name the docx-files a(01), a(02) etc. This way your code works as intended. At least for me ;)</p>\n\n<p>Markus</p>\n\n<p>OK, so here's the code i came up with if the renaming is not an option:</p>\n\n<pre><code>Private Sub GetFiles(strFolder As String)\n\n    Dim DirArray() As Variant\n    ReDim Preserve DirArray(0 To 0) As Variant\n\n    Me.ListFiles.Clear\n\n    '---- Get the filenames into an array ----\n    Dim sFileName As String\n    sFileName = Dir$(strFolder)\n\n    Do While sFileName &lt;&gt; vbNullString\n\n        DirArray(UBound(DirArray)) = sFileName\n\n        sFileName = Dir$\n\n        If sFileName &lt;&gt; vbNullString Then\n            ReDim Preserve DirArray(0 To UBound(DirArray) + 1) As Variant\n        End If\n    Loop\n\n    '---- Sort the array ----\n    Dim i As Integer\n    Dim j As Integer\n\n    Dim CompareTemp1 As String\n    Dim CompareTemp2 As String\n\n    For i = LBound(DirArray) To UBound(DirArray)\n        For j = i To UBound(DirArray)\n\n            '---- Compare two neighbouring filename-numbers\n            '---- If the one lower in the list has a lower number, they'll be switched around ----\n            If GetNumbersFromFileName(CStr(DirArray(j))) &lt; GetNumbersFromFileName(CStr(DirArray(i))) Then\n\n                '---- Change the neighbouring filenames order ----\n                CompareTemp1 = DirArray(i)\n                CompareTemp2 = DirArray(j)\n                DirArray(i) = CompareTemp2\n                DirArray(j) = CompareTemp1\n\n           End If\n        Next j\n    Next i\n    '---- Once all this is done, the DirArray should have the desired order, with the undesireables on top ----\n\n    '---- Display the new filename-order in your ListBox ----\n    For i = 0 To UBound(DirArray) - 1\n\n        '---- Display only filenames with (##) ----\n        If GetNumbersFromFileName(CStr(DirArray(i))) &lt;&gt; -1 Then\n            AddItems Me.ListFiles, (CStr(DirArray(i))), strFolder\n        End If\n\n    Next i\n\n    ReDim DirArray(0) As Variant\n\nEnd Sub\n\nPrivate Function GetNumbersFromFileName(sFileNameToCheck As String) As Integer\n\n    Dim iOpenBracketPosition As Integer\n    Dim iClosedBracketPosition As Integer\n\n    '---- Get the bracket-positions ----\n    iOpenBracketPosition = InStr(1, sFileNameToCheck, \"(\")\n    iClosedBracketPosition = InStr(1, sFileNameToCheck, \")\")\n\n    '---- In case one of the brackets is missing, the file will be pushed to the top ----\n    If iOpenBracketPosition = 0 Or iClosedBracketPosition = 0 Then\n        GetNumbersFromFileName = -1\n        Exit Function\n    End If\n\n    '---- Return the Number in between the brackets ----\n    GetNumbersFromFileName = CInt(Mid$(sFileNameToCheck, iOpenBracketPosition + 1, iClosedBracketPosition - iOpenBracketPosition - 1))\n\nEnd Function\n</code></pre>\n\n<p>Hope that makes some sense!\nCheers!\nMarkus</p>\n"}], "owner": {"reputation": 63, "user_id": 3176869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7bec26d7576f3d5fa0346f9f0bec12bf?s=128&d=identicon&r=PG&f=1", "display_name": "Malteaser6900", "link": "https://stackoverflow.com/users/3176869/malteaser6900"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 39873117, "answer_count": 1, "score": 0, "last_activity_date": 1475753794, "creation_date": 1475661580, "question_id": 39870948, "link": "https://stackoverflow.com/questions/39870948/ordering-files-in-a-listbox-alphabetically-and-not-numerically", "title": "Ordering Files in a Listbox Alphabetically and not Numerically", "body": "<p>I am trying to add a list of files from a folder to a listbox in a specific order.\nAt the moment, I sort the files in explorer view based on a numeric tag and then rename each of the files so that they are named a(1).docx, a(2).docx, a(3).docx etc. My problem kicks in when I hit a(10).docx and a(11).docx as the ordering is alphabetic and not numeric. When the files enter the listbox they go in order of a(1), a(10), a(11), a(12) etc.\nIs there an easier way to overcome this ordering issue?\nSee below for code excerpt</p>\n\n<pre><code>Private Sub GetFiles(strFolder As String)\n    If Right(strFolder, 1) &lt;&gt; Chr(92) Then strFolder = strFolder &amp; Chr(92)\n    On Error GoTo lbl_Exit:\n    sName = Dir$(strFolder)\n    Me.ListFiles.Clear          'ListFiles is my listbox\n    Do While sName &lt;&gt; \"\"\n        AddItems Me.ListFiles, sName, strFolder\n        sName = Dir$\n    Loop\nlbl_Exit:\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1475661946, "last_edit_date": 1475661946, "creation_date": 1475661462, "answer_id": 39870908, "question_id": 39870682, "link": "https://stackoverflow.com/questions/39870682/how-to-handle-run-time-error-5174-in-excel-if-the-file-not-present-in-the-direct/39870908#39870908", "title": "how to handle run time error 5174 in excel if the file not present in the directory?", "body": "<p>The error handling can be done like this:</p>\n\n<pre><code>sub Main\nDim savename, FileExt, FileName As String\nDim i, finalrow As Integer\nDim wdvar As Word.Application\nDim wrdDoc As Word.Document\n\nOn Error GoTo Main_Error\n\nSet wdvar = CreateObject(\"Word.Application\")\nwdvar.Visible = True         \n\nFileName = Environ(\"UserProfile\") &amp; \"\\Desktop\\Report.docx\"\nSet wrdDoc = wdvar.Documents.Open(FileName)\n\nWith wdvar\n    .Visible = True\n    .Activate\n\n\n   .Documents.Add\n'...\non error goto 0\nexit sub\nMain_error\n   if err.number = 5174 then\n   'you may write something here\nelse\n   'normally a msgbox for the error \nend if\nend sub\n</code></pre>\n\n<p>Additionally 1: if you want to create the file, you may do it from the error handler or you can simply check whether the file is existing. Depends what you want: -> <a href=\"http://www.rondebruin.nl/win/s9/win003.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s9/win003.htm</a></p>\n\n<p>Additionally 2: \ndo not use integers, but use long, and declare each variable on a separate line, otherwise you declare them as vars.</p>\n"}, {"comments": [{"owner": {"reputation": 900, "user_id": 403911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9rmqm.jpg?s=128&g=1", "display_name": "Joe Bourne", "link": "https://stackoverflow.com/users/403911/joe-bourne"}, "edited": false, "score": 1, "creation_date": 1475665372, "post_id": 39871118, "comment_id": 67030996, "body": "Use the Scripting.FileSystemObject instead. it has a nice FileExists() function. Much cleaner than using the old Dir function."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 900, "user_id": 403911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9rmqm.jpg?s=128&g=1", "display_name": "Joe Bourne", "link": "https://stackoverflow.com/users/403911/joe-bourne"}, "edited": false, "score": 0, "creation_date": 1475665547, "post_id": 39871118, "comment_id": 67031108, "body": "@JoeBourne : Sure, but you don&#39;t need to load references to use <code>Dir</code> so it&#39;s much easier to share with others! ;)"}, {"owner": {"reputation": 900, "user_id": 403911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9rmqm.jpg?s=128&g=1", "display_name": "Joe Bourne", "link": "https://stackoverflow.com/users/403911/joe-bourne"}, "edited": false, "score": 0, "creation_date": 1475665690, "post_id": 39871118, "comment_id": 67031206, "body": "the Op is late binding the &quot;Word.Application&quot; so could easily late bind the scripting.filesystemobject as well - no real need to add the reference, but its lazy not to."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1475662050, "creation_date": 1475662050, "answer_id": 39871118, "question_id": 39870682, "link": "https://stackoverflow.com/questions/39870682/how-to-handle-run-time-error-5174-in-excel-if-the-file-not-present-in-the-direct/39871118#39871118", "title": "how to handle run time error 5174 in excel if the file not present in the directory?", "body": "<p>Personnaly, I use this function :</p>\n\n<pre><code>Public Function File_Exist(sFilePath As String) As Boolean\n    Dim sProv As String\n    On Error GoTo ErrorHandler\n        sProv = Dir(sFilePath, vbDirectory)\n\n        File_Exist = (sProv &lt;&gt; \"\")\n    On Error GoTo 0\n    Exit Function\n\nErrorHandler:\n    MsgBox prompt:=\"Error on test file= \" &amp; sFilePath &amp; vbCrLf &amp; _\n           Err.Number &amp; vbCrLf &amp; Err.Description\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Where do you need to use it :</p>\n\n<pre><code>If File_Exist(Filename) Then\n    Set wrdDoc = wdvar.Documents.Open(Filename)\nElse\n    With wdvar\n        .Visible = True\n        .Activate\n\n       .Documents.Add\n    End With\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 900, "user_id": 403911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9rmqm.jpg?s=128&g=1", "display_name": "Joe Bourne", "link": "https://stackoverflow.com/users/403911/joe-bourne"}, "is_accepted": false, "score": 1, "last_activity_date": 1475666250, "last_edit_date": 1475666250, "creation_date": 1475665596, "answer_id": 39872307, "question_id": 39870682, "link": "https://stackoverflow.com/questions/39870682/how-to-handle-run-time-error-5174-in-excel-if-the-file-not-present-in-the-direct/39872307#39872307", "title": "how to handle run time error 5174 in excel if the file not present in the directory?", "body": "<p>add a reference to Microsoft Scripting Runtime and use the Scripting.FilesystemObject.\nIt has a nice handy \"FileExists()\" function that you can use to test if a file exists.</p>\n\n<pre><code>   Dim fso as new Scripting.FileSystemobject\n\n   If (fso.FileExists(strPath)) Then\n      debug.print \"File Exists\"\n   Else\n      debug.print \"File Not Found\"\n   End If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3830, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1475666250, "creation_date": 1475660834, "last_edit_date": 1475661521, "question_id": 39870682, "link": "https://stackoverflow.com/questions/39870682/how-to-handle-run-time-error-5174-in-excel-if-the-file-not-present-in-the-direct", "title": "how to handle run time error 5174 in excel if the file not present in the directory?", "body": "<p>I need to check whether a file is present in the directory.</p>\n\n<p>If file NOT present i should create a new one. </p>\n\n<p>But at run time the Excel gives an error; </p>\n\n<blockquote>\n  <p>\"Run-time error 5174: Application defined or object defined error\".</p>\n</blockquote>\n\n<p>Is there any exception handling technique in VBA to catch these run time error?</p>\n\n<p>How can i overcome this issue so that i can create a file if non existant?</p>\n\n<pre><code>Dim savename, FileExt, FileName As String\nDim i, finalrow As Integer\nDim wdvar As Word.Application\nDim wrdDoc As Word.Document\n\nSet wdvar = CreateObject(\"Word.Application\")\nwdvar.Visible = True         \n\nFileName = Environ(\"UserProfile\") &amp; \"\\Desktop\\Report.docx\"\nSet wrdDoc = wdvar.Documents.Open(FileName)\n\nWith wdvar\n    .Visible = True\n    .Activate\n\n\n   .Documents.Add\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 4960767, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153331817435930/picture?type=large", "display_name": "Ali_bean", "link": "https://stackoverflow.com/users/4960767/ali-bean"}, "edited": false, "score": 1, "creation_date": 1475663123, "post_id": 39870779, "comment_id": 67029542, "body": "Some presentations have complex layout so I want to preserve that, and just add in the new branding logo. Thanks though!"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 1, "last_activity_date": 1475661104, "creation_date": 1475661104, "answer_id": 39870779, "question_id": 39870607, "link": "https://stackoverflow.com/questions/39870607/powerpoint-vba-adding-image-to-every-slide/39870779#39870779", "title": "PowerPoint VBA adding image to every slide", "body": "<p>Have you considered using Masters? A Master will allow you to define a font and image for all Slides that use that Master.</p>\n"}, {"comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1475700170, "post_id": 39870891, "comment_id": 67053682, "body": "You&#39;ll want to dim oTop as Single rather than Integer or you&#39;ll either run into errors or lose accuracy when PPT/VBA converts a .Top value like 10123 to 10"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1475766173, "post_id": 39870891, "comment_id": 67084509, "body": "@SteveRindsberg : I didn&#39;t see that, Thx! I corrected it! ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1475766268, "post_id": 39870891, "comment_id": 67084591, "body": "@Ali_Bean : Check the comment from Steve! It&#39;ll help you to place the image properly!"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 3, "last_activity_date": 1475766200, "last_edit_date": 1475766200, "creation_date": 1475661417, "answer_id": 39870891, "question_id": 39870607, "link": "https://stackoverflow.com/questions/39870607/powerpoint-vba-adding-image-to-every-slide/39870891#39870891", "title": "PowerPoint VBA adding image to every slide", "body": "<p>2 things :</p>\n\n<p><strong>About your code :</strong> Try to avoid using <code>.Select</code> and <code>Selection</code></p>\n\n<p><code>ActiveWindow.Selection.SlideRange.Shapes.AddPicture</code> should be <code>sld.Shapes.AddPicture</code></p>\n\n<p><code>ActiveWindow</code> will only be the visible slide in your PPT app.</p>\n\n<p><strong>About the idea :</strong></p>\n\n<p>You should go to <code>View</code> menu, <code>Slide Master</code> and edit the default layout that you use to avoid using some code! ;)</p>\n\n<pre><code>Sub InsertLogoOnEveryPage()\n\nDim sld As Slide\nDim shp As Shape\nDim sFontName As String\nDim oTop As Single\n\n' font:\nsFontName = \"Times\"\n\nFor Each sld In ActivePresentation.Slides\n\n    Debug.Print sld.Name\n    'Insert logo.\n    sld.Shapes.AddPicture FileName:=\"C:\\Users\\R3uKH2\\Desktop\\Dive zones.png\", _\n        LinkToFile:=msoFalse, _\n        SaveWithDocument:=msoTrue, Left:=60, Top:=oTop, _\n        Width:=330, Height:=330\n\n    For Each shp In sld.Shapes\n        With shp\n            If .HasTextFrame Then\n                    If .TextFrame.HasText Then\n                        .TextFrame.TextRange.Font.Name = sFontName\n                    End If\n                End If\n        End With\n    Next shp\n    oTop = oTop + 10\nNext sld\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 4960767, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153331817435930/picture?type=large", "display_name": "Ali_bean", "link": "https://stackoverflow.com/users/4960767/ali-bean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2183, "favorite_count": 0, "accepted_answer_id": 39870891, "answer_count": 2, "score": 3, "last_activity_date": 1475766200, "creation_date": 1475660650, "last_edit_date": 1475660792, "question_id": 39870607, "link": "https://stackoverflow.com/questions/39870607/powerpoint-vba-adding-image-to-every-slide", "title": "PowerPoint VBA adding image to every slide", "body": "<p>I'm writing a simple macro to change the font and add a logo to every slide in a power point. </p>\n\n<p>The problem is that the font is updating on every slide, but the image is only pasting on a single slide. - So I end up with 30 images on top of each other on a single slide (not 1 image on each slide as I require)</p>\n\n<p>I have the following:</p>\n\n<pre><code>Sub InsertLogoOnEveryPage()\n\nDim sld As Slide\nDim shp As Shape\nDim sFontName As String\nDim oTop As Integer\n\n' font:\nsFontName = \"Times\"\n\nFor Each sld In ActivePresentation.Slides\n\n    Debug.Print sld.Name\n    'Insert logo.\n    ActiveWindow.Selection.SlideRange.Shapes.AddPicture( _\n    FileName:=\"PATH\\Logo_RGB.png\", _\n    LinkToFile:=msoFalse, _\n    SaveWithDocument:=msoTrue, Left:=60, Top:=oTop, _\n    Width:=330, Height:=330).Select\n\n    For Each shp In sld.Shapes\n        With shp\n            If .HasTextFrame Then\n                    If .TextFrame.HasText Then\n                        .TextFrame.TextRange.Font.Name = sFontName\n                    End If\n                End If\n        End With\n    Next shp\n    oTop = oTop + 10\nNext sld\n\nEnd Sub\n</code></pre>\n\n<p>Any help on solving this would be awesome, thanks!</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6640064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4fbf5051fb1b155a236e9f9c62136d62?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba", "link": "https://stackoverflow.com/users/6640064/kuba"}, "edited": false, "score": 0, "creation_date": 1475743486, "post_id": 39879741, "comment_id": 67068752, "body": "Well still when you select the date, it throws the message from day after too. I have looked into similar code and it works the same way, so I don&#39;t know if it can be fixed. Anyway, thank you @niton !"}, {"owner": {"reputation": 13, "user_id": 6640064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4fbf5051fb1b155a236e9f9c62136d62?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba", "link": "https://stackoverflow.com/users/6640064/kuba"}, "edited": false, "score": 0, "creation_date": 1475746277, "post_id": 39879741, "comment_id": 67070738, "body": "Or is it maybe possible to just read the categories only from today, without writing the date?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 13, "user_id": 6640064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4fbf5051fb1b155a236e9f9c62136d62?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba", "link": "https://stackoverflow.com/users/6640064/kuba"}, "edited": false, "score": 0, "creation_date": 1475844734, "post_id": 39879741, "comment_id": 67119391, "body": "Is it that you do not understand the &gt;= can be =? Set myItems = objFolder.items.Restrict(&quot;[Received] = &#39;&quot; &amp; oDate &amp; &quot;&#39;&quot;)"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1475686512, "creation_date": 1475686512, "answer_id": 39879741, "question_id": 39869975, "link": "https://stackoverflow.com/questions/39869975/counting-categories-based-on-date/39879741#39879741", "title": "Counting categories based on date", "body": "<p>The date format, valid for someone else, is likely not valid for you.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub HowManyEmails()\n\n    Dim objFolder As Folder\n    Dim EmailCount As Integer\n\n    Dim myItem As Object\n    Dim o As Variant\n\n    Dim dateStr As String\n    Dim myItems As items\n    Dim dict As Object\n    Dim msg As String\n    Dim oDate As String\n\n    On Error Resume Next\n    Set objFolder = ActiveExplorer.CurrentFolder\n\n    If err.number &lt;&gt; 0 Then\n        err.Clear\n        MsgBox \"No such folder.\"\n        Exit Sub\n    End If\n\n    ' Must closely follow an On Error Resume Next\n    On Error GoTo 0\n\n    EmailCount = objFolder.items.count\n    MsgBox \"Number of emails in the folder: \" &amp; EmailCount, , \"email count\"\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    ' oDate = InputBox(\"Date for count (Format D-M-YYYY\")\n    oDate = InputBox(\"Date for count (Format YYYY-m-d\")\n\n    Set myItems = objFolder.items.Restrict(\"[Received] &gt;= '\" &amp; oDate &amp; \"'\")\n\n    ' myItems.SetColumns (\"Categories\") ' You will find this error due to On Error GoTo 0\n\n    For Each myItem In myItems\n        dateStr = myItem.Categories\n        If Not dict.exists(dateStr) Then\n            dict(dateStr) = 0\n        End If\n        dict(dateStr) = CLng(dict(dateStr)) + 1\n    Next myItem\n\n    msg = \"\"\n    For Each o In dict.Keys\n        If o = \"\" Then\n            msg = msg &amp; dict(o) &amp; \":   \" &amp; \"Not categorized\" &amp; vbCrLf\n        Else\n            msg = msg &amp; dict(o) &amp; \":   \" &amp; o &amp; vbCrLf\n        End If\n    Next\n    MsgBox msg\n\nExitRoutine:\n    Set objFolder = Nothing\n    Set dict = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6640064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4fbf5051fb1b155a236e9f9c62136d62?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba", "link": "https://stackoverflow.com/users/6640064/kuba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "accepted_answer_id": 39879741, "answer_count": 1, "score": 1, "last_activity_date": 1611620626, "creation_date": 1475658984, "last_edit_date": 1611620626, "question_id": 39869975, "link": "https://stackoverflow.com/questions/39869975/counting-categories-based-on-date", "title": "Counting categories based on date", "body": "<p>The code below does not count categories from specific day properly:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub HowManyEmails()\n    Dim objOutlook As Object, objnSpace As Object, objFolder As MAPIFolder\n    Dim EmailCount As Integer\n    Set objOutlook = CreateObject(&quot;Outlook.Application&quot;)\n    Set objnSpace = objOutlook.GetNamespace(&quot;MAPI&quot;)\n\n    On Error Resume Next\n\n    Set objFolder = Session.GetFolderFromID(Application.ActiveExplorer.CurrentFolder.EntryID)\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        MsgBox &quot;No such folder.&quot;\n        Exit Sub\n    End If\n    EmailCount = objFolder.Items.Count\n    MsgBox &quot;Number of emails in the folder: &quot; &amp; EmailCount, , &quot;email count&quot;\n    Dim dateStr As String\n    Dim myItems As Outlook.Items\n    Dim dict As Object\n    Dim msg As String\n    Dim oDate As String\n    \n    Set dict = CreateObject(&quot;Scripting.Dictionary&quot;)\n    oDate = InputBox(&quot;Date for count (Format D-M-YYYY&quot;)\n    Set myItems = objFolder.Items.Restrict(&quot;[Received] &gt;= '&quot; &amp; oDate &amp; &quot;'&quot;)\n    myItems.SetColumns (&quot;Categories&quot;)\n    For Each myItem In myItems\n        dateStr = myItem.Categories\n        If Not dict.Exists(dateStr) Then\n            dict(dateStr) = 0\n        End If\n        dict(dateStr) = CLng(dict(dateStr)) + 1\n    Next myItem\n    msg = &quot;&quot;\n    For Each o In dict.Keys\n        msg = msg &amp; o &amp; &quot;:   &quot; &amp; dict(o) &amp; vbCrLf\n    Next\n    MsgBox msg\n    Set objFolder = Nothing\n    Set objnSpace = Nothing\n    Set objOutlook = Nothing\nEnd Sub\n</code></pre>\n<p>When you write a date, the output is just categories and emails count which doesn't match the chosen date.</p>\n"}, {"tags": ["excel", "keypress", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 121, "user_id": 4793429, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b486c65903066c9c7af9bc6db127f0d1?s=128&d=identicon&r=PG&f=1", "display_name": "lala_12", "link": "https://stackoverflow.com/users/4793429/lala-12"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1475659638, "post_id": 39869806, "comment_id": 67027225, "body": "I have already tried recreating the solution, but it doesn&#39;t seem to work for me. I wan&#39;t to trigger the macro, when I press the key &quot;r&quot;, &quot;t&quot;, &quot;z&quot;, and &quot;x&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "is_accepted": false, "score": 0, "last_activity_date": 1475666051, "creation_date": 1475666051, "answer_id": 39872446, "question_id": 39869806, "link": "https://stackoverflow.com/questions/39869806/application-onkey-does-not-work/39872446#39872446", "title": "Application.OnKey does not work", "body": "<p>This works for me. Add the code to a module, save the workbook close then reopen it.</p>\n\n<pre><code>Private Sub Workbook_Activate()\n\n    Application.OnKey \"r\", \"MyEvent\"\n    Application.OnKey \"t\", \"MyEvent\"\n    Application.OnKey \"x\", \"MyEvent\"\n    Application.OnKey \"z\", \"MyEvent\"\n\nEnd Sub\n\nPrivate Sub Workbook_Deactivate()\n\n    Application.OnKey \"r\"\n    Application.OnKey \"t\"\n    Application.OnKey \"x\"\n    Application.OnKey \"z\"\n\nEnd Sub\n\nPublic Sub MyEvent()\n    MsgBox \"Hello\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4793429, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b486c65903066c9c7af9bc6db127f0d1?s=128&d=identicon&r=PG&f=1", "display_name": "lala_12", "link": "https://stackoverflow.com/users/4793429/lala-12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4040, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477759455, "creation_date": 1475658560, "last_edit_date": 1531161705, "question_id": 39869806, "link": "https://stackoverflow.com/questions/39869806/application-onkey-does-not-work", "title": "Application.OnKey does not work", "body": "<p>I am trying to execute a sub, when I press a specific key in Excel 2013, using the <code>Application.OnKey</code> method.</p>\n\n<p>I have the following code</p>\n\n<pre><code>Public Sub Workbook_Open()\n    Application.OnKey \"{r}\", \"MyEvent\"\n    Application.OnKey \"{t}\", \"MyEvent\"\n    Application.OnKey \"{x}\", \"MyEvent\"\n    Application.OnKey \"{z}\", \"MyEvent\"\nEnd Sub\n\nPublic Sub Workbook_BeforeClose(Cancel As Boolean)\n    Application.OnKey \"{r}\"\n    Application.OnKey \"{t}\"\n    Application.OnKey \"{x}\"\n    Application.OnKey \"{z}\"\nEnd Sub\n\nPublic Sub MyEvent()\n    MsgBox \"Hello\"\nEnd Sub\n</code></pre>\n\n<p>When I press the keys the sub <code>MyEvent</code> does not executes. How can I modify the code to make it work?</p>\n\n<hr>\n\n<p><strong>EDIT</strong>: I want the keys to be pressed to be: <code>r</code>, <code>t</code>, <code>x</code>, and <code>z</code> instead of <code>ENTER</code>. </p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6925122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2659d036ab299be6352c4d9a2474900c?s=128&d=identicon&r=PG&f=1", "display_name": "H King", "link": "https://stackoverflow.com/users/6925122/h-king"}, "edited": false, "score": 0, "creation_date": 1475663314, "post_id": 39869790, "comment_id": 67029643, "body": "Thank you for your assistance. The first part, &quot;otherObject.Visible = False&quot;, is used to hide the main Word application (so it doesn&#39;t appear in the task bar, nor does the main Word window open, only the open dialog shows). Number (2) is now fixed, guess as I said got myself confused, the extra &quot;fd.Show&quot; was left over from trying to fix (1)."}, {"owner": {"reputation": 151, "user_id": 5257520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153534737047192/picture?type=large", "display_name": "snibbo", "link": "https://stackoverflow.com/users/5257520/snibbo"}, "reply_to_user": {"reputation": 11, "user_id": 6925122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2659d036ab299be6352c4d9a2474900c?s=128&d=identicon&r=PG&f=1", "display_name": "H King", "link": "https://stackoverflow.com/users/6925122/h-king"}, "edited": false, "score": 0, "creation_date": 1475665076, "post_id": 39869790, "comment_id": 67030801, "body": "How do you want to call the macro? Within an own menu item? For me it works fine..."}, {"owner": {"reputation": 151, "user_id": 5257520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153534737047192/picture?type=large", "display_name": "snibbo", "link": "https://stackoverflow.com/users/5257520/snibbo"}, "reply_to_user": {"reputation": 11, "user_id": 6925122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2659d036ab299be6352c4d9a2474900c?s=128&d=identicon&r=PG&f=1", "display_name": "H King", "link": "https://stackoverflow.com/users/6925122/h-king"}, "edited": false, "score": 0, "creation_date": 1475665287, "post_id": 39869790, "comment_id": 67030947, "body": "Additionally, I recommend you to delete &quot;On Error GoTo Final&quot; and try to catch errors by your own. E.g. check if fileaddress is NULL..."}, {"owner": {"reputation": 11, "user_id": 6925122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2659d036ab299be6352c4d9a2474900c?s=128&d=identicon&r=PG&f=1", "display_name": "H King", "link": "https://stackoverflow.com/users/6925122/h-king"}, "edited": false, "score": 0, "creation_date": 1475668137, "post_id": 39869790, "comment_id": 67032869, "body": "It is called by buttons in the Quick Access and Main Tool Bars. I will investigate proper error catching, the current method was implemented as the quickest and easiest method; although it just silent quits. Hmmm I wonder whats different because even implementing both your first changes still leaves the Word Application and Dialog Box opening in the background, as evidenced by Word appearing and flashing in the task bar."}], "tags": [], "owner": {"reputation": 151, "user_id": 5257520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153534737047192/picture?type=large", "display_name": "snibbo", "link": "https://stackoverflow.com/users/5257520/snibbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1475658527, "creation_date": 1475658527, "answer_id": 39869790, "question_id": 39869441, "link": "https://stackoverflow.com/questions/39869441/load-template-and-attach-chosen-file/39869790#39869790", "title": "Load template and attach chosen file", "body": "<p>Your file Dialog is probably not shown, because of the line \"otherObject.Visible = False\"</p>\n\n<p>Number (2) might be solved if you delete one of your \"fd.Show\". Looks like you call it twice...</p>\n"}], "owner": {"reputation": 11, "user_id": 6925122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2659d036ab299be6352c4d9a2474900c?s=128&d=identicon&r=PG&f=1", "display_name": "H King", "link": "https://stackoverflow.com/users/6925122/h-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 475, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593157837, "creation_date": 1475657540, "last_edit_date": 1593157837, "question_id": 39869441, "link": "https://stackoverflow.com/questions/39869441/load-template-and-attach-chosen-file", "title": "Load template and attach chosen file", "body": "<p>The aim of this project is to:</p>\n\n<ul>\n<li>Load template from network personal drive (currently working)</li>\n<li>Open Dialog Window, using Word (as that loads quicker for me), set to a different network folder (function achieved - just)</li>\n<li>Choose and attach user chosen file (prefered option for multi-file selection but that was to complex and thus beyond the time I can afford to dedicate to the project)</li>\n<li>Using previous filepath, build and apply the subject line based on the file name. (currently working)</li>\n</ul>\n\n<p>The macro is called by a button in the Quick Access or Main Tool Bars.</p>\n\n<p>The problems: </p>\n\n<ol>\n<li><p>when the \"Browse\" window appears, it does so behind outlook/hidden UNLESS the macro code has been viewed in the editor at some time since Outlook was opened; every fix either show the entire Word program or seems to have no effect.</p></li>\n<li><p>when you choose a file in the \"Browse\" and then click \"OK\", a second \"Browse\" window opens where you have to choose a file again and this time click \"Open\"; this second file is then the one that is attached to the email.<strong>&lt;--FIXED</strong></p></li>\n</ol>\n\n<p>System Details (even though not all will be of importance) </p>\n\n<pre><code>Windows 7 64bit\nOffice Professional 2010\n</code></pre>\n\n<p>The Code</p>\n\n<pre><code>Sub New_Orders_Email()\n\n    Dim NewMail As Outlook.MailItem\n    Dim otherObject As Word.Application\n    Dim fd As Office.FileDialog\n    Dim fileaddress As String\n    Dim filename As String\n\n    On Error GoTo Final\n\n    'Set template to use\n    Set NewMail = Application.CreateItemFromTemplate(\"P:\\Office Templates\\Orders SCI - 1617.oft\")\n\n\n    'Set to use Word for Attach File Dialog\n    Set otherObject = New Word.Application\n    otherObject.Visible = False\n\n    Set fd = otherObject.Application.FileDialog(msoFileDialogFilePicker)\n\n    With fd\n    .AllowMultiSelect = False\n    .InitialFileName = \"R:\\Science\\Technician Documents\\Budgets &amp; Orders\\2016 - 2017\\Orders\\\"\n    .Show\n    End With\n\n    fd.Show\n\n    fileaddress = fd.SelectedItems(1)\n\n    'Aquire File Name in correct form for Subject Line\n    Dim MidStart As Long\n    MidStart = InStrRev(fileaddress, \"\\\") + 16\n\n    Dim MidEnd As Long\n    MidEnd = InStrRev(fileaddress, \".\")\n\n    filename = Mid(fileaddress, MidStart, MidEnd - MidStart)\n\n    'Load template, attach single file and apply correct Subject\n    NewMail.Display\n    NewMail.Attachments.Add (fileaddress)\n    NewMail.Subject = \"Order No: \" + filename\n    otherObject.Quit\n\n    Set otherObject = Nothing\n    Final:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dynamic", "range", "named"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475659539, "post_id": 39869431, "comment_id": 67027167, "body": "What error are you getting and on which line?"}, {"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475661052, "post_id": 39869431, "comment_id": 67028241, "body": "Sorry, My question was not clear. it was not an error. I wanted to keep the page set up of each named range intact while exporting; hence each named range data reflect in each page. I was able to do that when I enter named range manually. I want to keep original page setting of each named range in &quot;rs&quot; and export in first set of code."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475672190, "post_id": 39869431, "comment_id": 67035631, "body": "Are you working with contiguous range in different sheets?"}, {"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475674120, "post_id": 39869431, "comment_id": 67037151, "body": "I am working with contiguous range in same sheet."}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1475729502, "post_id": 39877028, "comment_id": 67061851, "body": "Proposed solution still give one page(Three named range data merged together) in single PDF file, whereas my need is three page output (for each named range) in single PDF file. I edited the question with page set up of each named range, Is something wrong with page setup ?   Note: I was able to do when passed the all the named range manually."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1475741249, "post_id": 39877028, "comment_id": 67067338, "body": "That&#39;s bizarre cos I got a PDF file with 3 pages (1 for each range). Do the ranges on your sheet overlap?"}, {"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1475742543, "post_id": 39877028, "comment_id": 67068136, "body": "No, will you check my current page settings, which I gave in the question now?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1475746956, "post_id": 39877028, "comment_id": 67071167, "body": "I don&#39;t think page setup would affect named ranges (I could be wrong though). Any chance you can provide a snapshot of your worksheet and highlight the ranges?"}, {"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1475829346, "post_id": 39877028, "comment_id": 67110103, "body": "It worked for me. What went wrong initially was, I didn&#39;t give any space (Blank Row) between first Named Range to other named range. That was the reason. Its working. Thank you!"}, {"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1475938823, "post_id": 39877028, "comment_id": 67149515, "body": "I tried the same method to export into word; however each named range is not coming in different page of workbook. How can we get that done?. I tried to modify the code with different method. its failed."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1476350219, "post_id": 39877028, "comment_id": 67310828, "body": "I would suggest to start a new question as that&#39;s different problem. Let me know once you have and I&#39;ll try to help"}, {"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1476350566, "post_id": 39877028, "comment_id": 67311060, "body": "I posted another question, Will you look into that ?"}, {"owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1476350587, "post_id": 39877028, "comment_id": 67311072, "body": "<a href=\"http://stackoverflow.com/questions/40003210/excel-vba-copy-pasting-each-named-range-to-word\" title=\"excel vba copy pasting each named range to word\">stackoverflow.com/questions/40003210/&hellip;</a>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "edited": false, "score": 0, "creation_date": 1476350744, "post_id": 39877028, "comment_id": 67311173, "body": "Yeah no worries. Bit busy at work at the moment but will have a look and post my reply on that question"}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": true, "score": 1, "last_activity_date": 1475678475, "creation_date": 1475678475, "answer_id": 39877028, "question_id": 39869431, "link": "https://stackoverflow.com/questions/39869431/excel-vba-print-multiple-named-range-in-seperate-page-of-pdf/39877028#39877028", "title": "Excel VBA Print multiple named range in seperate page of PDF", "body": "<p>Below UDF worked for me (I had it in a module):<br></p>\n\n<pre><code>Sub ExportRangeToPDF(ByVal WSName As String)\n\n    Dim oRng As Range\n    Dim strPath As String: strPath = \"C:\\temp\\Temp\\\"\n    Dim intCount As Integer\n\n    For intCount = 1 To ActiveWorkbook.Names.Count\n\n        If InStr(1, LCase(ActiveWorkbook.Names(intCount).RefersToRange.Name.Name), LCase(WSName)) &gt; 0 Then\n\n            If oRng Is Nothing Then\n                Set oRng = Range(ActiveWorkbook.Names(intCount).RefersToRange.Name.Name)\n            Else\n                Set oRng = Union(oRng, Range(ActiveWorkbook.Names(intCount).RefersToRange.Name.Name))\n            End If\n\n        End If\n\n    Next\n\n    oRng.ExportAsFixedFormat xlTypePDF, strPath &amp; \"test.pdf\", , , False\n\n    Set oRng = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE</strong>: I had some 'solver' and 'filterdatabase' ranges in the workbook I was working on so had to add some validation for those before it worked. If you have any such ranges in your workbook, you might have to do the same</p>\n"}], "owner": {"reputation": 213, "user_id": 6915311, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dbbfb9dbf5d288c9f01eeb9b40298632?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/6915311/manish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "accepted_answer_id": 39877028, "answer_count": 1, "score": 0, "last_activity_date": 1475685051, "creation_date": 1475657501, "last_edit_date": 1475685051, "question_id": 39869431, "link": "https://stackoverflow.com/questions/39869431/excel-vba-print-multiple-named-range-in-seperate-page-of-pdf", "title": "Excel VBA Print multiple named range in seperate page of PDF", "body": "<p>I have list of named ranges and each range I set it to suit single page. I use following code to export into PDF, where It get merged together into single page.</p>\n\n<pre><code>Dim wbBook As Workbook\nDim i As Integer\nDim rs As Range\n\nSet wbBook = ActiveWorkbook\nSet rs = wbBook.Names(1).RefersToRange\nFor i = 2 To wbBook.Names.Count\n   Set rs = Union(rs, wbBook.Names(i).RefersToRange)\nNext\n\nrs.ExportAsFixedFormat xlTypePDF, strPath, , , False\n</code></pre>\n\n<p>But below code works for me, when I enter range name manually. Whereas my named range are dynamic. I think, above code needs some modification to work. Will anyone assist me to get this done?</p>\n\n<pre><code>Set rs = wbBook.Range(\"Page_1,Page_2,Page_3\")\nrs.Select\nSelection.ExportAsFixedFormat xlTypePDF, strPath, , , False\n</code></pre>\n\n<p>Proposed solution still give one page. I provided below the page setup, Is something wrong with page setup ?</p>\n\n<pre><code>With Sheet1.PageSetup\n.PrintArea = Range(Cells(iBeginRow, 1), Cells(iRow + 2, 5)).Address\n.CenterHorizontally = True\n.CenterVertically = True\n.Orientation = xlLandscape\n.LeftMargin = Application.InchesToPoints(0)\n.RightMargin = Application.InchesToPoints(0)\n.TopMargin = Application.InchesToPoints(0)\n.BottomMargin = Application.InchesToPoints(0)\n.HeaderMargin = Application.InchesToPoints(0)\n.FooterMargin = Application.InchesToPoints(0)\n.PrintQuality = 600\n.FitToPagesWide = 1\n.FitToPagesTall = 1\nEnd With\n</code></pre>\n\n<p>Then I dynamically name the range</p>\n\n<pre><code>Sheet1.Range(Cells(iBeginRow, 1), Cells(iRow + 2, 5)).Select\nSelection.Name = \"Page_\" &amp; PageNum\n</code></pre>\n"}, {"tags": ["vba", "excel", "date", "date-formatting"], "comments": [{"owner": {"reputation": 91, "user_id": 6750958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02417e3c0e164e00bc31d98a1cb3231?s=128&d=identicon&r=PG&f=1", "display_name": "msaint", "link": "https://stackoverflow.com/users/6750958/msaint"}, "edited": false, "score": 0, "creation_date": 1475660482, "post_id": 39869278, "comment_id": 67027821, "body": "try cDate(format(currentCell.Value, &quot;dd.mm.yy&quot;))"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1475661813, "post_id": 39869278, "comment_id": 67028783, "body": "Can you post more of the code?  The way you reference cells in particular?"}], "answers": [{"comments": [{"owner": {"reputation": 547, "user_id": 5064264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad87062c740de600a42a7a0a859cbf8e?s=128&d=identicon&r=PG", "display_name": "user121391", "link": "https://stackoverflow.com/users/5064264/user121391"}, "edited": false, "score": 0, "creation_date": 1475661019, "post_id": 39869550, "comment_id": 67028219, "body": "Thanks for the suggestion, it does not work unfortunately, still 4 digits. I&#39;ll update the question."}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 2, "last_activity_date": 1475657863, "creation_date": 1475657863, "answer_id": 39869550, "question_id": 39869278, "link": "https://stackoverflow.com/questions/39869278/excel-vba-reformatting-date-to-very-short-date-with-two-digit-years-does-not-wo/39869550#39869550", "title": "Excel VBA: Reformatting date to very short date with two-digit-years does not work", "body": "<p>Try \n<code>format(date, \"dd.mm.yy\")</code></p>\n\n<p>This will give you answer in string format if that is acceptable?\nTo give this some context:</p>\n\n<pre><code>Sub Datings()\n    Dim d As Date\n    d = Now\n    Debug.Print d, Format(d, \"dd/mm/yy\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 2, "last_activity_date": 1475662674, "creation_date": 1475662674, "answer_id": 39871324, "question_id": 39869278, "link": "https://stackoverflow.com/questions/39869278/excel-vba-reformatting-date-to-very-short-date-with-two-digit-years-does-not-wo/39871324#39871324", "title": "Excel VBA: Reformatting date to very short date with two-digit-years does not work", "body": "<p>Convert the text date to something recognised by Excel as a date (replace the <strong>.</strong> with <strong>/</strong> as you did originally, then just update the numberformat in the cell.</p>\n\n<pre><code>Sheet1.Range(\"A1\") = Replace(Sheet1.Range(\"A1\"), \".\", \"/\")\nSheet1.Range(\"A1\").NumberFormat = \"dd.mm.yy\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 547, "user_id": 5064264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad87062c740de600a42a7a0a859cbf8e?s=128&d=identicon&r=PG", "display_name": "user121391", "link": "https://stackoverflow.com/users/5064264/user121391"}, "is_accepted": false, "score": 1, "last_activity_date": 1475669470, "creation_date": 1475669470, "answer_id": 39873620, "question_id": 39869278, "link": "https://stackoverflow.com/questions/39869278/excel-vba-reformatting-date-to-very-short-date-with-two-digit-years-does-not-wo/39873620#39873620", "title": "Excel VBA: Reformatting date to very short date with two-digit-years does not work", "body": "<p>After the suggestion to add more surrounding code by tom preston, I've tried Darren Bartrup-Cook's example code on the first cell as a very basic test. It did not work, so I used breakpoints to skip through all code before and after this piece of code.</p>\n\n<p>This revealed that all the time, it <em>was</em> working correctly, but <em>later</em> other code reverted the formatting by calling <code>Cells(1,1).Value = \"\" &amp; Cells(1,1).Value</code> on the correctly formatted cells. I did not notice it because in the GUI it was still shown as <em>Format: Date</em>, although internally it was overwritten.</p>\n\n<hr>\n\n<p>The complete solution was therefore as simple as using</p>\n\n<pre><code>Range(\"A1:A\" &amp; lastRow).Replace What:=\".\", replacement:=\"/\", LookAt:=xlPart\nSheet1.Range(\"A1:A\" &amp; lastRow).NumberFormat = \"dd.mm.yy\"\n</code></pre>\n\n<p>and <em>not</em> touching column A later on.</p>\n\n<hr>\n\n<p>So, lesson learned: use many breakpoints to narrow down the problem and check that you do not shoot yourself in the foot later on.</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1475669646, "creation_date": 1475669646, "answer_id": 39873665, "question_id": 39869278, "link": "https://stackoverflow.com/questions/39869278/excel-vba-reformatting-date-to-very-short-date-with-two-digit-years-does-not-wo/39873665#39873665", "title": "Excel VBA: Reformatting date to very short date with two-digit-years does not work", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\nSub ReformatDate()\n    Dim C As Range\n    Dim V As Variant\n    For Each C In Selection\n        With C.Offset(0, 1)\n            .NumberFormat = \"dd.mm.yy\"\n            If IsDate(C) Then\n                .Value = C\n            Else\n                V = Split(C.Text, \".\")\n                .Value = DateSerial(V(0), V(1), V(2))\n            End If\n        End With\n    Next C\nEnd Sub\n</code></pre>\n\n<ul>\n<li>If your system recognizes the value as a date, then just reformat</li>\n<li>If your system does NOT recognize the value as a date, then convert it\n\n<ul>\n<li>Split it using the <code>dot</code> as a delimiter</li>\n<li>Convert the parts to a real date</li>\n<li>write it back and format accordingly</li>\n</ul></li>\n</ul>\n\n<p>You'll need to make appropriate modifications if you want it to overwrite, instead of putting the value in the next column; and if you want to use a more automatic method of selecting the range to convert.</p>\n"}], "owner": {"reputation": 547, "user_id": 5064264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad87062c740de600a42a7a0a859cbf8e?s=128&d=identicon&r=PG", "display_name": "user121391", "link": "https://stackoverflow.com/users/5064264/user121391"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1683, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1475669646, "creation_date": 1475657079, "last_edit_date": 1475661107, "question_id": 39869278, "link": "https://stackoverflow.com/questions/39869278/excel-vba-reformatting-date-to-very-short-date-with-two-digit-years-does-not-wo", "title": "Excel VBA: Reformatting date to very short date with two-digit-years does not work", "body": "<p>I have a list of dates exported from another application. Initially they are formatted as Standard, without any special or automatic conversion, in the format <code>YYYY.MM.DD</code>.</p>\n\n<p>Previously I just replaced the dots with slashes and Excel recognized the dates as dates, automatically formatting them to the appropriate locale <code>DD.MM.YYYY</code>, which worked fine.</p>\n\n<p>Now, I just wanted to remove the first two digits of the year (new format <code>DD.MM.YY</code>), but it does not work in any way I've tried. What I have done so far:</p>\n\n<ul>\n<li><code>currentCell.Value = CDate(currentCell.Value)</code>: This switches the format to date, but the standard long formatting still applies.</li>\n<li><code>currentCell.NumberFormat = \"dd.mm.yy;@\"</code> As seen from recording a macro and changing the value manually. Does not seem to make any difference in output format.</li>\n<li><code>currentCell.Value = FormatDateTime(currentCell.Value, vbShortDate)</code>: Does not work, as Short Date is <code>DD.MM.YYYY</code>, not <code>DD.MM.YY</code> in the current locale.</li>\n<li><code>format(date, \"dd.mm.yy\")</code> as suggested by Tom Preston and msaint: Does not change the output compared to the NumberFormat version.</li>\n</ul>\n\n<p>Another strange thing I've observed: After applying the date change per VBA, manual change of date format via the GUI is not possible anymore/seems to not have any effect.</p>\n\n<p>What could be the cause of this and how could I achieve the really short date in VBA?</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475658999, "post_id": 39868879, "comment_id": 67026796, "body": "Can you provide a snapshot of your worksheet? Also, the way you have your code, if a value is changed in <code>rng.cells</code>, it will always return a match as you are not ignoring the cell where the value was changed"}, {"owner": {"reputation": 1, "user_id": 6896135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296da8a2a1c65b6055d4da00417bfd34?s=128&d=identicon&r=PG&f=1", "display_name": "solati", "link": "https://stackoverflow.com/users/6896135/solati"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475663905, "post_id": 39868879, "comment_id": 67030019, "body": "I don&#39;t know how to paste a snapshot."}, {"owner": {"reputation": 1, "user_id": 6896135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296da8a2a1c65b6055d4da00417bfd34?s=128&d=identicon&r=PG&f=1", "display_name": "solati", "link": "https://stackoverflow.com/users/6896135/solati"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475664055, "post_id": 39868879, "comment_id": 67030110, "body": "a have numer of names and surnames (separated by &quot; &quot;) in each cell in columns A:H, each pair is spearateted with &quot;, &quot;. macro should prevent me from entering more than 2 pairs in this range (somewhere in the cell)"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475664602, "post_id": 39868879, "comment_id": 67030474, "body": "If the names in a cell are always separated by &quot;,&quot;, can you not just get the count of commas in the cells and base your validation on that?"}, {"owner": {"reputation": 1, "user_id": 6896135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296da8a2a1c65b6055d4da00417bfd34?s=128&d=identicon&r=PG&f=1", "display_name": "solati", "link": "https://stackoverflow.com/users/6896135/solati"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475669935, "post_id": 39868879, "comment_id": 67034073, "body": "I don&#39;t know how to do that"}], "owner": {"reputation": 1, "user_id": 6896135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296da8a2a1c65b6055d4da00417bfd34?s=128&d=identicon&r=PG&f=1", "display_name": "solati", "link": "https://stackoverflow.com/users/6896135/solati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475655860, "creation_date": 1475655860, "question_id": 39868879, "link": "https://stackoverflow.com/questions/39868879/prevent-duplicates-in-the-range-of-cells", "title": "prevent duplicates in the range of cells", "body": "<p>I have a macro which prevents duplicates within the range A:H</p>\n\n<p>But I don't know how to change the macro so it prevents input of \"[name] [space] [surname]\" more than twice. There can be a number of \"[name] [space] [surname]\" in one cell </p>\n\n<pre><code> Option Explicit\n Option Compare Text\n\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim rng As Range, cel As Range\nDim What As Variant\n\n\nSet rng = ActiveSheet.UsedRange.Columns(\"A:H\")\nIf Target.Value = \"\" Then Exit Sub\nIf Not Intersect(Target, rng) Is Nothing Then\nWhat = \"*\" &amp; Target.Value &amp; \"*\"\nFor Each cel In rng.Cells\n    If cel.Value Like What Then\n        Target.ClearContents\n        MsgBox \"Text already present!\"\n    End If\nNext cel\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "conditional-formatting", "vba"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475656470, "post_id": 39868462, "comment_id": 67025164, "body": "It would be best to show what you&#39;ve done first. You can add formatting of a cell quite easily as part of your update process."}, {"owner": {"reputation": 109, "user_id": 6886431, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/28469072af870d763617dce69e9cc21e?s=128&d=identicon&r=PG&f=1", "display_name": "MopMop", "link": "https://stackoverflow.com/users/6886431/mopmop"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475662444, "post_id": 39868462, "comment_id": 67029148, "body": "Just realized I messed up the code formatting, but there it is... But since I am copying a gorup of cells how can I differencitate those who have been updated and those who haven&#39;t ?"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6886431, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/28469072af870d763617dce69e9cc21e?s=128&d=identicon&r=PG&f=1", "display_name": "MopMop", "link": "https://stackoverflow.com/users/6886431/mopmop"}, "edited": false, "score": 0, "creation_date": 1475665882, "post_id": 39871237, "comment_id": 67031332, "body": "Yes but the problem is that there is a lot of changes that could be made on the line, and I would like to know if it is possible to put different formatting only on cells which value have changed"}, {"owner": {"reputation": 36, "user_id": 6921506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7838419697adf560b69c80d57ae5b98f?s=128&d=identicon&r=PG&f=1", "display_name": "James Bayley", "link": "https://stackoverflow.com/users/6921506/james-bayley"}, "reply_to_user": {"reputation": 109, "user_id": 6886431, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/28469072af870d763617dce69e9cc21e?s=128&d=identicon&r=PG&f=1", "display_name": "MopMop", "link": "https://stackoverflow.com/users/6886431/mopmop"}, "edited": false, "score": 0, "creation_date": 1475671749, "post_id": 39871237, "comment_id": 67035334, "body": "Then instead of a line-range you can use a single cell, changing it&#39;s formatting right after you change it&#39;s value (and still have the indexes in hand)."}, {"owner": {"reputation": 109, "user_id": 6886431, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/28469072af870d763617dce69e9cc21e?s=128&d=identicon&r=PG&f=1", "display_name": "MopMop", "link": "https://stackoverflow.com/users/6886431/mopmop"}, "edited": false, "score": 0, "creation_date": 1475672624, "post_id": 39871237, "comment_id": 67035964, "body": "But I don&#39;t understand how to implement that as I am already changing the line, it would mean I would have to rewrite entirely the code to use single cells instead..?"}], "tags": [], "owner": {"reputation": 36, "user_id": 6921506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7838419697adf560b69c80d57ae5b98f?s=128&d=identicon&r=PG&f=1", "display_name": "James Bayley", "link": "https://stackoverflow.com/users/6921506/james-bayley"}, "is_accepted": true, "score": 1, "last_activity_date": 1475662419, "creation_date": 1475662419, "answer_id": 39871237, "question_id": 39868462, "link": "https://stackoverflow.com/questions/39868462/add-conditional-formating-to-updated-cells/39871237#39871237", "title": "Add conditional formating to updated cells", "body": "<p>If painting the updated line in a different color suits you, you can use something as simple as this (makes the line yellow):</p>\n\n<pre><code>Range(\"E\" &amp; currLine &amp; \":AQ\" &amp; currLine).Interior.Color = 65535\n</code></pre>\n\n<p>Of course before launching the loop which updates data you should paint the whole sheet into one color (white or any other).</p>\n"}], "owner": {"reputation": 109, "user_id": 6886431, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/28469072af870d763617dce69e9cc21e?s=128&d=identicon&r=PG&f=1", "display_name": "MopMop", "link": "https://stackoverflow.com/users/6886431/mopmop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 39871237, "answer_count": 1, "score": 0, "last_activity_date": 1508771658, "creation_date": 1475654460, "last_edit_date": 1531164843, "question_id": 39868462, "link": "https://stackoverflow.com/questions/39868462/add-conditional-formating-to-updated-cells", "title": "Add conditional formating to updated cells", "body": "<p>I am working on an Excel launch tracker sheet that gets most of its information from an external database. I have code that compares the two sheets to add missing information from the database extract to my launch tracker sheet. </p>\n\n<p>This code is comparing if three conditions match between the two sheets and if so, it replaces the line (from column E until column AQ), if not it adds up the line at the end of the launch tracking sheet.</p>\n\n<p>How do I add conditional formatting to the updated cells?</p>\n\n<p>This is the code I have so far!</p>\n\n<pre><code>Option Explicit\nPublic Const FM As String = \"Launch Tracker\"\nPublic Const lidebFM As Byte = 3\nPublic Const FL As String = \"LAT - Master Data\"\nPublic Const lidebFL As Byte = 3\nPublic Const co1 As Byte = 8  ' colonne H\nPublic Const co2 As Byte = 15 ' colonne O\nPublic Const co3 As Byte = 17 ' colonne Q\nPublic Sub Update()\nDim lifinFL As Long, liFL As Long\nDim lifinFM As Long, liFM As Long\nDim obj As Object\nDim V1 As String, V2 As String, V3 As String\nWith Sheets(FL)\n  ' derni\u00e8re ligne feuille FL\n  lifinFL = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n  ' boucle sur les lignes de FL\n  For liFL = lidebFL To lifinFL\n    ' derni\u00e8re ligne de FM\n    lifinFM = Sheets(FM).Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n    ' comparaison des Item ID\n    V1 = .Cells(liFL, co1).Value\n    ' recherche de V1 dans FM colonne co1\n    Set obj = Sheets(FM).Columns(co1).Find(V1, , , xlWhole)\n    ' si pas trouve lifm = 1\u00b0 ligne dispo dans FM pour copie\n    If obj Is Nothing Then\n      liFM = lifinFM + 1\n    ' sinon V1 est trouve \u00e0 la ligne liFM\n    Else\n      liFM = obj.Row\n      ' compraison de MARKET et SAP\n      V2 = .Cells(liFL, co2).Value\n      V3 = .Cells(liFL, co3).Value\n      ' si identiques on garde liFM = liobj pour ecrasement\n      If V2 = Sheets(FM).Cells(liFM, co2).Value And V3 = Sheets(FM).Cells(liFM, co3).Value Then\n        ' rien\n      Else\n      ' si non identiques lifm = 1\u00b0 ligne dispo dans FM pour copie\n        liFM = lifinFM + 1\n      End If\n    End If\n    ' copie de la ligne liFL dans FM \u00e0 la ligne liFM\n    '.Rows(liFL).Copy Sheets(FM).Cells(liFM, 1)\n    'prendre juste les cellules \u00e0 la place de la ligne\n    .Range(.Cells(liFL, 5), .Cells(liFL, 43)).Copy Sheets(FM).Cells(liFM, 5)\n  Next liFL\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "excel", "vba"], "comments": [{"owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "edited": false, "score": 0, "creation_date": 1475654334, "post_id": 39868364, "comment_id": 67024038, "body": "What is the error you get and which line is responsible for it?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1475655891, "post_id": 39868364, "comment_id": 67024852, "body": "You didn&#39;t close <code>conn</code> before trying to reset its properties."}, {"owner": {"reputation": 21, "user_id": 6857081, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-_bcTf51uatA/AAAAAAAAAAI/AAAAAAAAAIc/QaMaFFrQsLI/photo.jpg?sz=128", "display_name": "Bharat Kumar", "link": "https://stackoverflow.com/users/6857081/bharat-kumar"}, "edited": false, "score": 0, "creation_date": 1475657599, "post_id": 39868364, "comment_id": 67025869, "body": "this line is responsible conn.provider=&quot;sqloledb&quot;  and error is 3705 operation is not allowed when the object is open Lajo Arpad"}, {"owner": {"reputation": 21, "user_id": 6857081, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-_bcTf51uatA/AAAAAAAAAAI/AAAAAAAAAIc/QaMaFFrQsLI/photo.jpg?sz=128", "display_name": "Bharat Kumar", "link": "https://stackoverflow.com/users/6857081/bharat-kumar"}, "edited": false, "score": 0, "creation_date": 1475657969, "post_id": 39868364, "comment_id": 67026101, "body": "when i close conn  of first code is run and show error operation is not allowed when the object is open  Roy"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1475659854, "post_id": 39868364, "comment_id": 67027394, "body": "Sorry, I didn&#39;t follow that at all."}], "answers": [{"tags": [], "owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "is_accepted": false, "score": 0, "last_activity_date": 1475745287, "creation_date": 1475745287, "answer_id": 39892095, "question_id": 39868364, "link": "https://stackoverflow.com/questions/39868364/3705-operation-is-not-allowed-when-the-object-is-open/39892095#39892095", "title": "3705 operation is not allowed when the object is open", "body": "<p>Set the CursorLocation property of the ADO Recordset to <code>adUseClient</code>:</p>\n\n<pre><code>conn.CursorLocation = adUseClient\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6857081, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-_bcTf51uatA/AAAAAAAAAAI/AAAAAAAAAIc/QaMaFFrQsLI/photo.jpg?sz=128", "display_name": "Bharat Kumar", "link": "https://stackoverflow.com/users/6857081/bharat-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 555, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475745287, "creation_date": 1475654153, "last_edit_date": 1531164843, "question_id": 39868364, "link": "https://stackoverflow.com/questions/39868364/3705-operation-is-not-allowed-when-the-object-is-open", "title": "3705 operation is not allowed when the object is open", "body": "<p>I have some data in an Excel form and I want to import it into database. I also want to retrieve some data from database. I am using VBA for connecting to database it my code is giving me an error.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Button1_Click()\n\n\n   Dim conn As New ADODB.Connection\n   Dim rs As New ADODB.Recordset\n\n\n       'Open a connection to SQL Server\n       conn.Provider = \"sqloledb\"\n       conn.Properties(\"Prompt\") = adPromptAlways\n       conn.Open \"Data Source=localhost;Initial Catalog=bank;\"\n\n       'conn.Open \"Provider=SQLOLEDB;Data Source=ASUSBOOK\\SQL2012;Initial Catalog=ExcelDemo;Integrated Security=SSPI;\"\n       Set rs.ActiveConnection = conn\n           rs.Open \"select code from info\"\n           startrow = 2\n\n           Do Until rs.EOF\n           Cells(startrow, 5) = rs.Fields(0).Value\n\n\n           rs.MoveNext\n           startrow = startrow + 1\n\n           Loop\n\n           rs.Close\n           Set rs = Nothing\n\n\n    Dim iRowNo As Integer\n    Dim accountno, Amount, code As String\n    Dim Rowcount As Integer\n    Rowcount = 1\n\n\n    With Sheets(\"Sheet1\")\n\n\n        iRowNo = 2\n\n            Do Until .Cells(iRowNo, 1) = \"\"\n            accountno = .Cells(iRowNo, 1)\n            Amount = .Cells(iRowNo, 2)\n            .Cells(iRowNo, 3) = \"OK\"\n            .Cells(iRowNo, 4) = Rowcount\n            .Cells(iRowNo, 5) = Post_Date\n\n            'Generate and execute sql statement to import the excel rows to SQL Server table\n            conn.Provider = \"sqloledb\"\n            conn.Properties(\"Prompt\") = adPromptAlways\n            conn.Open \"Data Source=localhost;Initial Catalog=bank;\"\n            conn.Execute \"insert into dbo.Customers (AccountNo,Amount,code) values ('\" &amp; accountno &amp; \"', '\" &amp; Amount &amp; \"', '\" &amp; code &amp; \"')\"\n\n            iRowNo = iRowNo + 1\n            Rowcount = Rowcount + 1\n            DoEvents\n\n        Loop\n\n        MsgBox \"Customers imported.\"\n\n        conn.Close\n        Set conn = Nothing\n\n    End With\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475654167, "post_id": 39868257, "comment_id": 67023937, "body": "Hi. Can you please elaborate on how to do that? I am not able to understand."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475655037, "post_id": 39868257, "comment_id": 67024423, "body": "As @teylyn mentioned, you can still use Excel forms for user interaction and then enter data into a Access database (although I&#39;m not a big fan of Access as a database). Google something like &quot;update access database via excel vba&quot;. Should give you enough examples of how to interact with Access database from Excel. Just as a side note: I wouldn&#39;t recommend using Access forms as they are not true forms"}, {"owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475655160, "post_id": 39868257, "comment_id": 67024481, "body": "Hi @Zac Thanks for your reply. If you don&#39;t recommend Access then what do you think I should use?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1475655594, "post_id": 39868257, "comment_id": 67024713, "body": "It really depends on the size of your data. If you don&#39;t expect your data to be too large (as in grow over time) then Access is good enough. But if you expect your data set to grow over time then I would consider something like SQL database. You can still interact with the SQL database from Excel VBA (i.e. Update, Add, Delete .. etc) hence giving you the flexibility to still use Excel Froms"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 3, "last_activity_date": 1475653825, "creation_date": 1475653825, "answer_id": 39868257, "question_id": 39868171, "link": "https://stackoverflow.com/questions/39868171/change-to-next-available-row-when-there-is-a-conflict-in-shared-workbook/39868257#39868257", "title": "Change to next available row when there is a conflict in shared workbook", "body": "<p>You don't. Excel has not been designed for simultaneous editing by multiple users. Although shared workbooks are possible, they have many limitations, the most annoying of which is that they will become corrupt eventually, show erratic behaviour and are impossible to troubleshoot. </p>\n\n<p>If you need simultaneous edit access, consider a database like Access or SQL. You can still use Excel as a front end. </p>\n"}, {"comments": [{"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 0, "creation_date": 1475654115, "post_id": 39868270, "comment_id": 67023895, "body": "Maybe you might consider moving that form and creating same thing in access?"}, {"owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475654272, "post_id": 39868270, "comment_id": 67024000, "body": "Hi, So in acess I need to create the form and link it with excel so that data is entered in excel?"}, {"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "reply_to_user": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475654417, "post_id": 39868270, "comment_id": 67024089, "body": "No, consider moving everything to Access. Access is a database and that can work with multiple users, data entered in Access forms would be stored in access database."}, {"owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475654885, "post_id": 39868270, "comment_id": 67024338, "body": "Okay. Thanks but I need to use excel only"}, {"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "reply_to_user": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475654973, "post_id": 39868270, "comment_id": 67024394, "body": "Sure, no problem just forget about multiple user being able to edit data correctly :)"}, {"owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475655514, "post_id": 39868270, "comment_id": 67024666, "body": "Yeah I know sharing workbook is a pain. But i have no other option"}], "tags": [], "owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "is_accepted": false, "score": 0, "last_activity_date": 1475653865, "creation_date": 1475653865, "answer_id": 39868270, "question_id": 39868171, "link": "https://stackoverflow.com/questions/39868171/change-to-next-available-row-when-there-is-a-conflict-in-shared-workbook/39868270#39868270", "title": "Change to next available row when there is a conflict in shared workbook", "body": "<p>Normally by doing a check if your row is different than blank like this:</p>\n\n<pre><code>indx = 1                       'this is the generated index of your row\nIf Cells(1, indx) &lt;&gt; \"\" Then   '1 is your column, in this case A\n    indx = indx + 1\nEnd If\n</code></pre>\n\n<p>But if you have multiple users accessing it the cell will not be updated in the second user worksheet, they are not synchronised and data entered by the 1st user remains invisible for the second up to the point when he reopens it.</p>\n"}], "owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568996912, "creation_date": 1475653526, "last_edit_date": 1568996912, "question_id": 39868171, "link": "https://stackoverflow.com/questions/39868171/change-to-next-available-row-when-there-is-a-conflict-in-shared-workbook", "title": "Change to next available row when there is a conflict in shared workbook", "body": "<p>I have a workbook which is shared among multiple users. </p>\n\n<p>There is a <code>Userform</code> which asks for data and stores it in the workbook. It generates a row number where the user will enter data. </p>\n\n<p>When two users open the <code>Userform</code> at the same time and one submits the data before other, Excel shows the conflict to other user. </p>\n\n<p>Instead it should go to the next row and save the data. How can I do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1475651976, "post_id": 39867690, "comment_id": 67022712, "body": "Do it as formatting, not as part of the value."}, {"owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1475652146, "post_id": 39867690, "comment_id": 67022807, "body": "@jonrsharpe so do i need to change .value for .format?"}], "answers": [{"comments": [{"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 0, "creation_date": 1475655252, "post_id": 39867895, "comment_id": 67024539, "body": "just be aware that when you change formatting from general to percent it multiplies value by 100 so 1 = 100%. If you have 10 in cell and want it to be converted directly to 10% divide your data by 100 first: <code>[d1].Value = [d1].Value &#47; 100</code> <code>[d1].NumberFormat = &quot;0.00%&quot;</code>"}], "tags": [], "owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "is_accepted": true, "score": 3, "last_activity_date": 1475653269, "last_edit_date": 1475653269, "creation_date": 1475652620, "answer_id": 39867895, "question_id": 39867690, "link": "https://stackoverflow.com/questions/39867690/converting-symbol-to-string-in-vba/39867895#39867895", "title": "converting % symbol to string in vba", "body": "<p>Use <code>Cells(1, 5).NumberFormat = \"0.00%\"</code>, <code>Range(\"B11\").NumberFormat = \"0.00%\"</code> or <code>[B11].NumberFormat = \"0.00%\"</code> to change formatting of a cell instead of trying to add character to a number. You might need to change the 0.00 to any other formatting type that suits your need.</p>\n\n<p>You mentioned that the data is numerical and you probably want to keep it that way if you use it in calculations, changing of formatting should be your choice.</p>\n"}, {"comments": [{"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 0, "creation_date": 1475652891, "post_id": 39867955, "comment_id": 67023207, "body": "this however will change your data from numerical that you had to a string"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1475652766, "creation_date": 1475652766, "answer_id": 39867955, "question_id": 39867690, "link": "https://stackoverflow.com/questions/39867690/converting-symbol-to-string-in-vba/39867955#39867955", "title": "converting % symbol to string in vba", "body": "<p>Concerning your code, you probably need something like this:</p>\n\n<pre><code>[h6]= cstr([h6].text &amp; ChrW(U + 37))\n</code></pre>\n\n<p>However, it just adds the symbol for H6.</p>\n"}, {"comments": [{"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 0, "creation_date": 1475653229, "post_id": 39868050, "comment_id": 67023393, "body": "a bit late, please check answers before posting"}, {"owner": {"reputation": 11, "user_id": 6911524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/585bffe363740522ee7f6b4464393767?s=128&d=identicon&r=PG&f=1", "display_name": "king_excel", "link": "https://stackoverflow.com/users/6911524/king-excel"}, "reply_to_user": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 0, "creation_date": 1475664228, "post_id": 39868050, "comment_id": 67030219, "body": "page was not refreshed to check answers, and besides posting do not harm so it is not a competition dude"}], "tags": [], "owner": {"reputation": 11, "user_id": 6911524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/585bffe363740522ee7f6b4464393767?s=128&d=identicon&r=PG&f=1", "display_name": "king_excel", "link": "https://stackoverflow.com/users/6911524/king-excel"}, "is_accepted": false, "score": 1, "last_activity_date": 1475653124, "creation_date": 1475653124, "answer_id": 39868050, "question_id": 39867690, "link": "https://stackoverflow.com/questions/39867690/converting-symbol-to-string-in-vba/39868050#39868050", "title": "converting % symbol to string in vba", "body": "<p>Use the below code, it is tested and works fine for me:</p>\n\n<pre><code>Sub Button1_Click()\n    Sheet1.Cells(11, 2).Value = 200\n    Sheet1.Cells(11, 2).NumberFormat = \"0.00%\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 39867895, "answer_count": 3, "score": 2, "last_activity_date": 1475656925, "creation_date": 1475651880, "last_edit_date": 1475656925, "question_id": 39867690, "link": "https://stackoverflow.com/questions/39867690/converting-symbol-to-string-in-vba", "title": "converting % symbol to string in vba", "body": "<p>My Question is simple:\nall I want to do is add the \"%\" symbol to a cell that contains numerical data.\nHere is the code that I wrote:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\n With Range(\"B11\")\n    .Select\n    .Value = [B11] &amp; ChrW(U + 37)\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>the result I get is that the numerical data gets divided by 100 and the % symbol is not added. I have tried to replace the ChrW(U + 37) with \"%\" but it doesn't work.\nI am very new to vba so I need all the help I can get!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 0, "creation_date": 1475654668, "post_id": 39868287, "comment_id": 67024224, "body": "Ah, my bad. I posted an answer based on VB keyword. Label is a nice alternative."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 0, "creation_date": 1475655526, "post_id": 39868287, "comment_id": 67024673, "body": "@pav - Yeah, I&#39;ve done that on several occasions - googled something using &quot;VBA&quot; as part of the search terms, found a reference in MSDN, read it, posted an answer, and not realised that the MSDN page had nothing to do with VBA at all."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 5, "last_activity_date": 1475653922, "creation_date": 1475653922, "answer_id": 39868287, "question_id": 39867524, "link": "https://stackoverflow.com/questions/39867524/excel-vba-how-to-skip-to-next-iteration-in-a-do-until-loop/39868287#39868287", "title": "Excel VBA - how to skip to next iteration in a Do Until...Loop", "body": "<p>VBA does not have a <code>Continue</code> statement.  You can get around it by doing something like</p>\n\n<pre><code>Do Until IsEmpty(xlSheet.Cells(row + 1, 1))\n   row = row + 1\n   If xlSheet.Cells(row, 2) &lt;&gt; \"Epic\" Then\n       xlSheet.Cells(row, 1).Value = 5\n   End If\nLoop\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Do Until IsEmpty(xlSheet.Cells(row + 1, 1))\n    row = row + 1\n    If xlSheet.Cells(row, 2) = \"Epic\" Then\n        GoTo ContinueDo\n    End If\n    xlSheet.Cells(row, 1).Value = 5\nContinueDo:\nLoop\n</code></pre>\n\n<hr>\n\n<p>Note: In both versions I changed <code>IsEmpty(xlSheet.Cells(row, 1))</code> to <code>IsEmpty(xlSheet.Cells(row + 1, 1))</code> or else you will end up with an infinite loop.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9424857, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e6d606c15cdccf9eda1a99916395c1bb?s=128&d=identicon&r=PG", "display_name": "Rob Duikersloot", "link": "https://stackoverflow.com/users/9424857/rob-duikersloot"}, "is_accepted": false, "score": 1, "last_activity_date": 1519838150, "creation_date": 1519838150, "answer_id": 49035140, "question_id": 39867524, "link": "https://stackoverflow.com/questions/39867524/excel-vba-how-to-skip-to-next-iteration-in-a-do-until-loop/49035140#49035140", "title": "Excel VBA - how to skip to next iteration in a Do Until...Loop", "body": "<p>So this is another possibility that works for me. Just skip the unwanted lines...</p>\n\n<pre><code>Do Until IsEmpty(xlSheet.Cells(row, 1))\n   row = row + 1\n   Do while xlSheet.Cells(row, 2) = \"Epic\" \n      row = row + 1\n   Loop\n   xlSheet.Cells(row, 1).Value = 5\nLoop\n</code></pre>\n"}], "owner": {"reputation": 229, "user_id": 5243835, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4000fa928b8628205aed35c1fe21ee02?s=128&d=identicon&r=PG&f=1", "display_name": "Tzvibe", "link": "https://stackoverflow.com/users/5243835/tzvibe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28240, "favorite_count": 1, "accepted_answer_id": 39868287, "answer_count": 2, "score": 4, "last_activity_date": 1519838150, "creation_date": 1475651337, "last_edit_date": 1531164843, "question_id": 39867524, "link": "https://stackoverflow.com/questions/39867524/excel-vba-how-to-skip-to-next-iteration-in-a-do-until-loop", "title": "Excel VBA - how to skip to next iteration in a Do Until...Loop", "body": "<p>I'm trying to skip to the next iteration in my vba code, with the 'continue' statement. Its not working..</p>\n\n<pre><code>  Do Until IsEmpty(xlSheet.Cells(row, 1))\n       row = row + 1\n       If xlSheet.Cells(row, 2) = \"Epic\" Then\n          Continue\n       End If\n       xlSheet.Cells(row, 1).Value = 5\n  Loop\n</code></pre>\n\n<p>Any idea??\nThanks..</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475649980, "post_id": 39867039, "comment_id": 67021593, "body": "Hi. Thanks for your reply. So there is no way that the shared worksheet can be protected and run the macro ?"}, {"owner": {"reputation": 1064, "user_id": 6887294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOIuR.jpg?s=128&g=1", "display_name": "Aditya Pansare", "link": "https://stackoverflow.com/users/6887294/aditya-pansare"}, "reply_to_user": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475650282, "post_id": 39867039, "comment_id": 67021749, "body": "I&#39;m searching work around for this issue since 3 years. But failed. Till the time I didn&#39;t find any solution for this. So either I create separate data file for each user &amp; one Master data file. Before start working I distribute data from Master to every one and At the end update master file with the user&#39;s data files. It is quite lengthy code but works for me most of the time. If only one user is using the protected file and updating using macros it work perfectly fine."}, {"owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475650658, "post_id": 39867039, "comment_id": 67021948, "body": "I have multiple users accessing the data, making changes at the same time."}, {"owner": {"reputation": 1064, "user_id": 6887294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOIuR.jpg?s=128&g=1", "display_name": "Aditya Pansare", "link": "https://stackoverflow.com/users/6887294/aditya-pansare"}, "reply_to_user": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475650920, "post_id": 39867039, "comment_id": 67022090, "body": "I understand what you want to do. But you can find a way to do it if you distribute the data between users. and collect after their work is done. Seems to be silly, but it works for me."}, {"owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "edited": false, "score": 0, "creation_date": 1475652981, "post_id": 39867039, "comment_id": 67023247, "body": "I think it&#39;s better to use MS Access for such situation, where there shouldn&#39;t be problem with multiple users accessing same data source, correct me if I&#39;m wrong"}, {"owner": {"reputation": 1064, "user_id": 6887294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOIuR.jpg?s=128&g=1", "display_name": "Aditya Pansare", "link": "https://stackoverflow.com/users/6887294/aditya-pansare"}, "edited": false, "score": 0, "creation_date": 1475654693, "post_id": 39867039, "comment_id": 67024235, "body": "Yes it is better. But excel is very flexible and easy to use as compare with Access. Both has their own positive &amp; negative points."}], "tags": [], "owner": {"reputation": 1064, "user_id": 6887294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOIuR.jpg?s=128&g=1", "display_name": "Aditya Pansare", "link": "https://stackoverflow.com/users/6887294/aditya-pansare"}, "is_accepted": true, "score": 1, "last_activity_date": 1475649663, "creation_date": 1475649663, "answer_id": 39867039, "question_id": 39866544, "link": "https://stackoverflow.com/questions/39866544/how-to-protect-a-worksheet-in-a-shared-workbook/39867039#39867039", "title": "How to protect a Worksheet in a Shared Workbook?", "body": "<p>Shared Workbooks/Worksheets have limitations... check here.. <a href=\"https://support.office.com/en-us/article/Use-a-shared-workbook-to-collaborate-49b833c0-873b-48d8-8bf2-c1c59a628534\" rel=\"nofollow\">https://support.office.com/en-us/article/Use-a-shared-workbook-to-collaborate-49b833c0-873b-48d8-8bf2-c1c59a628534</a></p>\n"}], "owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 39867039, "answer_count": 1, "score": 1, "last_activity_date": 1568996258, "creation_date": 1475647753, "last_edit_date": 1568996258, "question_id": 39866544, "link": "https://stackoverflow.com/questions/39866544/how-to-protect-a-worksheet-in-a-shared-workbook", "title": "How to protect a Worksheet in a Shared Workbook?", "body": "<p>I have a workbook which will be shared among multiple users. A macro will be run to enter data from userform in the Excel sheet.</p>\n\n<p>The sheet needs to be protected so users can't edit it.</p>\n\n<p>I had ws.Unprotect</p>\n\n<p>My macro code</p>\n\n<pre><code>ws.Protect UserInterfaceOnly:=True\n</code></pre>\n\n<p>When the workbook is shared it shows the following error:</p>\n\n<blockquote>\n  <p>runtime error 1004 method ' protect of object '_worksheet' failed</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "edited": false, "score": 0, "creation_date": 1475646304, "post_id": 39865692, "comment_id": 67020081, "body": "This is exactly what i want, thank you so much, can you explain to me this part INDEX(A:A,CEILING(ROW(A1)/2,1))?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "edited": false, "score": 0, "creation_date": 1475650220, "post_id": 39865692, "comment_id": 67021714, "body": "I added an explanation."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1475650210, "last_edit_date": 1475650210, "creation_date": 1475643296, "answer_id": 39865692, "question_id": 39865455, "link": "https://stackoverflow.com/questions/39865455/excel-inserting-data-in-between-row-field/39865692#39865692", "title": "Excel Inserting data in between row field", "body": "<p>Formula approach</p>\n\n<pre><code>=IF(ISODD(ROW(A1)),INDEX(A:A,CEILING(ROW(A1)/2,1)),\"go\")\n</code></pre>\n\n<p>Copy down as far as required. You can then copy the resulting column and paste it over itself with Paste Special > Values, then delete the original column. </p>\n\n<p><strong>Explanation</strong>: Read the formula from the inside out. <code>Row(A1)</code> will return the number 1. Divided by 2, returns 0.5, use Ceiling to return the next full integer, which is 1. Copied down to row 3, for example, <code>Row(A3)</code> returns 3, divide by 2 = 1.5, round up to next full integer returns 2.</p>\n\n<p>So, in row 1 the formula evaluates to <code>Index(A:A,1)</code>, which means \"return the first cell in the range A:A\". In row 3 the formula evaluates to <code>Index(A:A,2)</code> which means - You got it! In row 5, we will get <code>Index(A:A,3)</code> and so on. </p>\n\n<p>Run the formula through the Evaluate Formula tool on the Formulas ribbon to see these actions performed step by step.</p>\n"}], "owner": {"reputation": 143, "user_id": 4154774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-V66i1uE4Abs/AAAAAAAAAAI/AAAAAAAAADA/xCEOKmcqxlw/photo.jpg?sz=128", "display_name": "lye yan nian", "link": "https://stackoverflow.com/users/4154774/lye-yan-nian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 39865692, "answer_count": 1, "score": 0, "last_activity_date": 1475650210, "creation_date": 1475641719, "last_edit_date": 1531161705, "question_id": 39865455, "link": "https://stackoverflow.com/questions/39865455/excel-inserting-data-in-between-row-field", "title": "Excel Inserting data in between row field", "body": "<p>i have created a sample table in below which is quite similar to simulate the situations i am facing. i need an excel vba code or can it be done using formula?<br>\n<strong>Current Table</strong></p>\n\n<pre><code>column1   | \n------------\n  A       | \n  A       | \n  A       |   \n  B       |   \n  B       | \n  C       | \n  D       |   \n  D       |     \n</code></pre>\n\n<p><strong>Outcome desired</strong>    </p>\n\n<pre><code>column1   | \n------------\n  A       | \n  go      |\n  A       |\n  go      | \n  A       |\n  go      |   \n  B       |\n  go      |   \n  B       |\n  go      | \n  C       |\n  go      | \n  D       |\n  go      |   \n  D       | \n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 1, "creation_date": 1475647675, "post_id": 39865719, "comment_id": 67020584, "body": "Here are the limitaions of shared workbook in office 2016.<a href=\"https://support.office.com/en-us/article/Use-a-shared-workbook-to-collaborate-49b833c0-873b-48d8-8bf2-c1c59a628534\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 59, "user_id": 4954131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/666c06627ed4c59282cd097024efb7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/4954131/francis"}, "edited": false, "score": 0, "creation_date": 1475679067, "post_id": 39865719, "comment_id": 67041184, "body": "Thank you. Is there any workarounds for a shared workbook that you know of?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1475695928, "post_id": 39865719, "comment_id": 67051394, "body": "If you need simultaneous multi user access, use a database like Access or SQL. You can still have the user front end in Excel."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1475643417, "creation_date": 1475643417, "answer_id": 39865719, "question_id": 39865300, "link": "https://stackoverflow.com/questions/39865300/vba-code-cannot-run-in-shared-workbook/39865719#39865719", "title": "VBA code cannot run in shared workbook", "body": "<p>Shared workbooks have limitations. The biggest one is that they can become corrupt at any time and are impossible to troubleshoot because their behaviour is not consistent. </p>\n\n<p>Avoid shared workbooks. </p>\n"}], "owner": {"reputation": 59, "user_id": 4954131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/666c06627ed4c59282cd097024efb7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/4954131/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1196, "favorite_count": 0, "accepted_answer_id": 39865719, "answer_count": 1, "score": 0, "last_activity_date": 1475643417, "creation_date": 1475640595, "question_id": 39865300, "link": "https://stackoverflow.com/questions/39865300/vba-code-cannot-run-in-shared-workbook", "title": "VBA code cannot run in shared workbook", "body": "<p>Just a concern regarding shared workbooks. I have a script that moves a certain row to the appropriate sheet based on cell values. </p>\n\n<p>When I copy the row, the format is usually pasted in unshared workbooks.</p>\n\n<p>However, in shared workbooks, formats are completely ignored.</p>\n\n<p>I can't seem the find the reason why....</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks</p>\n\n<pre><code>Sub RunScriptButton_Click()\n'On Error GoTo CleanFail\n\nIf MsgBox(\"Run Script?\", vbYesNo, \"Run Script\") = vbNo Then\n    Exit Sub\nEnd If\n\n'Disables screen flashing when the information is updated\nApplication.ScreenUpdating = False\n\nDim project As String, ws As Worksheet, ignoredSheets As Object, scheduleSheets As Object\nDim legendSht As Worksheet, masterSht As Worksheet\nDim i As Integer, j As Integer, k As Integer, x As Integer, y As Integer, z As Integer\nDim lastrow As Integer, lastcoln As Integer, lastrow2 As Integer, lastrow3 As Integer, lastRowLegend As Integer\nDim rowht As Double, rowht2 As Double\nDim count As Integer, SAcount As Integer\nDim ID As String, name As Range, allppl As Range, allppl2 As Range\nDim month_col As Range, month_col_no As Integer, next_month_col As Range, next_month As Integer\nDim mcount1 As Integer, mcount2 As Integer, first As Integer, secnd As Integer\nDim monthrow As Integer, script_info_row As Integer, proj_coln As Integer, name_coln As Integer, assist_coln As Integer\n\nSet legendSht = ThisWorkbook.Worksheets(\"Legend\")\nSet masterSht = ThisWorkbook.Worksheets(\"Master Schedule\")\n\n'----------------------------------------------------------\n' Set the worksheet names to be ignored by the script (non-schedule sheets)\n' Add additional exceptions by adding a new item to the dictionary with \"Sheet Name\", [next number]\n\nSet ignoredSheets = CreateObject(\"Scripting.Dictionary\")\nignoredSheets.Add \"Legend\", 1\nignoredSheets.Add \"Master Schedule\", 2\nignoredSheets.Add \"Surveyor Overview\", 3\n'----------------------------------------------------------\n\nlastRowLegend = legendSht.UsedRange.Row - 1 + legendSht.UsedRange.Rows.count\nscript_info_row = legendSht.Range(legendSht.Cells(1, 1), legendSht.Cells(lastRowLegend, 1)).Find(what:=\"Script Information\").Row + 1\n\nWith masterSht\n    'Find last row with data on the master schedule sheet\n    Set tempRange = .Cells(.Rows.count, \"B\").End(xlUp)\n    lastrow = tempRange.Row\n\n    'Find last column with data on the master schedule sheet\n    If .Cells(2, .Columns.count) &lt;&gt; vbNullString Then\n        Set tempRange = .Cells(2, .Columns.count)\n        lastcoln = tempRange.Column\n    Else\n        Set tempRange = .Cells(2, .Columns.count).End(xlToLeft)\n        lastcoln = tempRange.Column\n    End If\n\n    proj_coln = .Range(.Cells(1, 1), .Cells(1, lastcoln)).Find(what:=\"Project\").Column\n    name_coln = .Range(.Cells(1, 1), .Cells(1, lastcoln)).Find(what:=\"Name\").Column\n    assist_coln = .Range(.Cells(1, 1), .Cells(1, lastcoln)).Find(what:=\"Assistant\").Column\n    'startCol = .Range(.Cells(1, 1), .Cells(1, lastcoln)).Find(what:=CStr(lastUpdateDate + 1)).Column\n    'endCol = .Range(.Cells(1, 1), .Cells(1, lastcoln)).Find(what:=CStr(currentDate)).Column\nEnd With\n\nSet scheduleSheets = CreateObject(\"Scripting.Dictionary\")\n\n'Loops through each worksheet except for legend and master schedule worksheet and deletes all information\nFor Each ws In ThisWorkbook.Worksheets\n    If Not ignoredSheets.Exists(ws.name) Then\n        ws.Cells.Delete\n\n        'Repositions buttons that get shoved off the page?\n        'For Each Control In ws.Shapes\n        '    If Control.Type = msoOLEControlObject Then\n        '        Control.Top = 48\n        '        Control.Left = 9.75\n        '    End If\n        'Next Control\n\n        'MsgBox Mid(ws.name, InStr(ws.name, \"(\") + 1, InStr(ws.name, \")\") - InStr(ws.name, \"(\") - 1)\n        scheduleSheets.Add Mid(ws.name, InStr(ws.name, \"(\") + 1, InStr(ws.name, \")\") - InStr(ws.name, \"(\") - 1), ws.Index\n    End If\nNext ws\n\n'copies the headers and dates from master schedule sheet\nWith masterSht\n    .Range(.Cells(1, 1), .Cells(2, lastcoln)).Copy\n    rowht = .Rows(1).RowHeight\n    rowht2 = .Rows(2).RowHeight\nEnd With\n\n'pastes the copied headers into every sheet except for ignored sheets\nFor Each ws In ThisWorkbook.Worksheets\n    If Not ignoredSheets.Exists(ws.name) Then\n        With ws\n            .Range(\"A1\").PasteSpecial xlPasteColumnWidths\n            .Range(\"A1\").PasteSpecial xlPasteFormats\n            .Range(\"A1\").PasteSpecial xlPasteValuesAndNumberFormats\n            .Rows(1).RowHeight = rowht\n            .Rows(2).RowHeight = rowht2\n        End With\n    End If\nNext ws\n\n'Checks number in Project column of Master Schedule and copies row into sheet with matching number between brackets in sheet name\nFor i = 3 To lastrow\n    project = masterSht.Cells(i, proj_coln)\n\n    'Loop through stored sheet project numbers and compare to current row to find the correct sheet to copy to\n    For Each strKey In scheduleSheets.Keys()\n        If InStr(project, strKey) &lt;&gt; 0 Then\n            masterSht.Range(masterSht.Cells(i, 1), masterSht.Cells(i, lastcoln)).Copy\n            ThisWorkbook.Sheets(scheduleSheets.Item(strKey)).Range(\"A\" &amp; i).PasteSpecial xlPasteColumnWidths\n            ThisWorkbook.Sheets(scheduleSheets.Item(strKey)).Range(\"A\" &amp; i).PasteSpecial xlPasteFormats\n            ThisWorkbook.Sheets(scheduleSheets.Item(strKey)).Range(\"A\" &amp; i).PasteSpecial xlPasteValuesAndNumberFormats\n            ThisWorkbook.Sheets(scheduleSheets.Item(strKey)).Range(\"A\" &amp; i).PasteSpecial xlPasteComments\n\n            'If only one project number in this item, then break out of looping through sheet names and go to next row in schedule\n            If InStr(project, \"/\") = 0 Then\n                Exit For\n            End If\n        End If\n    Next\nNext i\n\n'Deletes empty rows in sheets other than legend and master schedule\nFor Each ws In ThisWorkbook.Worksheets\n    If Not ignoredSheets.Exists(ws.name) Then\n        ws.Cells.EntireColumn.Hidden = False\n        With ws.UsedRange\n            For j = .Rows.count To 3 Step -1\n                If Application.WorksheetFunction.CountA(.Rows(j).EntireRow) = 0 Then\n                    .Rows(j).EntireRow.Delete\n                End If\n            Next j\n        End With\n\n        lastrow = ws.UsedRange.Rows.count\n\n        'Count the number of survey assistants in each project worksheet\n        SAcount = Application.WorksheetFunction.CountIfs(ws.Range(ws.Cells(3, name_coln), ws.Cells(lastrow, name_coln)), \"SA:*\")\n\n        'Crew count labels\n        ws.Range(\"A\" &amp; lastrow + 1) = \"Total Crew Count: \" &amp; lastrow - 2 - SAcount\n        ws.Range(\"E\" &amp; lastrow + 2) = \"Double Crew Count\"\n        ws.Range(\"E\" &amp; lastrow + 3) = \"Single Crew Count\"\n\n        'Get total crew count by counting number of party chiefs (hide SAs)\n        Set allppl = ws.Range(ws.Cells(3, name_coln), ws.Cells(lastrow, name_coln))\n        For Each name In allppl\n            If Left(name, 3) = \"SA:\" Then\n                name.EntireRow.Hidden = True\n            End If\n        Next name\n\n        'Tally active crews for each day\n        For j = assist_coln To lastcoln\n\n            'Find 3 letter code for current project sheet\n            ID = Application.WorksheetFunction.Index(Sheet1.Range(Sheet1.Cells(script_info_row, 1), Sheet1.Cells(lastRowLegend, 3)), _\n            Application.WorksheetFunction.Match(ws.name, Sheet1.Range(Sheet1.Cells(script_info_row, 1), Sheet1.Cells(lastRowLegend, 1)), 0), 2)\n\n            'Count number of active crews for the current day\n            count = COUNTIFv(ws.Range(ws.Cells(2, j), ws.Cells(lastrow, j)), \"*\" &amp; ID &amp; \"*\")\n            ws.Cells(lastrow + 1, j).Value = count\n        Next j\n\n        'Unhide all cells\n        ws.Cells.EntireRow.Hidden = False\n\n        'Hide all crew except survey assistants to determine number of 2-man crews\n        If lastrow - 2 - SAcount &gt; 0 Then\n            For Each name In allppl\n                If Left(name, 3) &lt;&gt; \"SA:\" Then\n                    name.EntireRow.Hidden = True\n                End If\n            Next name\n        End If\n        'Tally active 2-man crews for each day\n        For j = assist_coln To lastcoln\n            'ID = Application.WorksheetFunction.Index(Sheet1.Range(Sheet1.Cells(script_info_row, 1), Sheet1.Cells(lastRowLegend, 3)), _\n            'Application.WorksheetFunction.Match(ws.name, Sheet1.Range(Sheet1.Cells(script_info_row, 1), Sheet1.Cells(lastRowLegend, 1)), 0), 2)\n\n            count2 = COUNTIFv(ws.Range(ws.Cells(2, j), ws.Cells(lastrow, j)), \"*\" &amp; ID &amp; \"*\")\n\n            ws.Cells(lastrow + 2, j).Value = count2                              'Active two-man crews for current date\n            ws.Cells(lastrow + 3, j).Value = ws.Cells(lastrow + 1, j) - count2   'One-man crew = Total crew - 2M crew\n            Next j\n\n        ws.Cells.EntireRow.Hidden = False\n\n        'Hide all schedule columns prior to current day\n        month_col_no = ws.Range(ws.Cells(2, 1), ws.Cells(2, lastcoln)).Find(what:=Format(Now, \"m/d/yyyy\")).Column\n\n        ws.Range(ws.Cells(1, assist_coln), ws.Cells(1, month_col_no - 1)).EntireColumn.Hidden = True\n\n        ws.Activate\n        ActiveWindow.ScrollRow = 1\n\n        'Tabulate monthly crew counts\n        lastrow3 = ws.UsedRange.Rows.count\n        monthrow = lastrow3 + 1\n\n        For i = Month(Date) To 12\n            month_col_no = ws.Range(ws.Cells(2, 1), ws.Cells(2, lastcoln)).Find(what:=i &amp; \"/1/\" &amp; Year(Date)).Column\n            If i &lt;&gt; 12 Then\n                next_month = ws.Range(ws.Cells(2, 1), ws.Cells(2, lastcoln)).Find(what:=i + 1 &amp; \"/1/\" &amp; Year(Date)).Column\n            Else\n                next_month = ws.Range(ws.Cells(2, 1), ws.Cells(2, lastcoln)).Find(what:=\"12/31/\" &amp; Year(Date)).Column + 1\n            End If\n\n            mcount1 = Application.Sum(ws.Range(ws.Cells(lastrow3 - 1, month_col_no), ws.Cells(lastrow3 - 1, next_month - 1)))\n            mcount2 = Application.Sum(ws.Range(ws.Cells(lastrow3, month_col_no), ws.Cells(lastrow3, next_month - 1)))\n            ws.Cells(monthrow, 1) = MonthName(i) &amp; \" Double Crew Total: \" &amp; mcount1\n            ws.Cells(monthrow + 1, 1) = MonthName(i) &amp; \" Single Crew Total: \" &amp; mcount2\n\n            monthrow = monthrow + 2\n        Next i\n    End If\nNext ws\n\nWith masterSht\n    .Activate\n    ActiveWindow.ScrollRow = 1\n    month_col_no = .Range(.Cells(2, 1), .Cells(2, lastcoln)).Find(what:=Month(Date) &amp; \"/\" &amp; Day(Date) &amp; \"/\" &amp; Year(Date)).Column\n    .Range(.Cells(1, assist_coln + 1), .Cells(1, month_col_no - 1)).EntireColumn.Hidden = True\nEnd With\n\n'enables screen flash and auto calculation again\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\n'CleanExit:\n    'Cleanup code\n    MsgBox \"Process complete\"\n'    Exit Sub\n\n'CleanFail:\n'    Raise Err.Number\n'    Resume CleanExit\n'    Resume\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1475644234, "post_id": 39865228, "comment_id": 67019326, "body": "Did you test that? <code>-</code> is the subtraction operator and your statement returns the number <code>14</code> to the cell."}, {"owner": {"reputation": 434, "user_id": 6660064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/637972e56c3c22a580bf23d33fb07383?s=128&d=identicon&r=PG", "display_name": "Janwilx72", "link": "https://stackoverflow.com/users/6660064/janwilx72"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1475727072, "post_id": 39865228, "comment_id": 67061199, "body": "I do believe that I have misunderstood the question, I apologise. I thought that was the purpose of the question"}], "tags": [], "owner": {"reputation": 434, "user_id": 6660064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/637972e56c3c22a580bf23d33fb07383?s=128&d=identicon&r=PG", "display_name": "Janwilx72", "link": "https://stackoverflow.com/users/6660064/janwilx72"}, "is_accepted": false, "score": -1, "last_activity_date": 1475640100, "creation_date": 1475640100, "answer_id": 39865228, "question_id": 39865160, "link": "https://stackoverflow.com/questions/39865160/excel-formula-copying-value-with-0-string/39865228#39865228", "title": "excel formula copying value with 0 string", "body": "<pre><code>Range(\"D1\").Value = Range(\"A1\").Value - Range(\"B1\").Value - Range(\"C1\").Value\n</code></pre>\n\n<p>Note: Here, the values within the brackets refer to the cells the numbers are located in, these are just examples.</p>\n"}, {"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1475644141, "creation_date": 1475644141, "answer_id": 39865826, "question_id": 39865160, "link": "https://stackoverflow.com/questions/39865160/excel-formula-copying-value-with-0-string/39865826#39865826", "title": "excel formula copying value with 0 string", "body": "<p>Just concatenate the strings from the cells with the \"-\" text string. The concatenation operator is the ampersand sign <code>&amp;</code></p>\n\n<pre><code>Sub test()\n\nRange(\"D1\") = Range(\"A1\") &amp; \"-\" &amp; Range(\"B1\") &amp; \"-\" &amp; Range(\"C1\")\n\nEnd Sub\n</code></pre>\n\n<p>Or use a formula instead of VBA:</p>\n\n<pre><code>=A1&amp;\"-\"&amp;B1&amp;\"-\"&amp;C1\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4264332, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/100001113521513/picture?type=large", "display_name": "mics", "link": "https://stackoverflow.com/users/4264332/mics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1475644141, "creation_date": 1475639599, "last_edit_date": 1531161705, "question_id": 39865160, "link": "https://stackoverflow.com/questions/39865160/excel-formula-copying-value-with-0-string", "title": "excel formula copying value with 0 string", "body": "<p>i have a cell A, B, and C.</p>\n\n<p>A=16</p>\n\n<p>B=01</p>\n\n<p>C=0001</p>\n\n<p>my question is i want a value of the cell D is like this D = 16-01-0001.</p>\n\n<p>Note cell D is dynamic sometimes in cell D the value is 0021 or 0321 . .</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 1, "creation_date": 1475638925, "post_id": 39864712, "comment_id": 67017894, "body": "&quot;I have 6 columns for 6 different subjects&quot;. Bad bad idea. You should store results per student per course. Do read up on normalization."}], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1475636663, "creation_date": 1475636663, "answer_id": 39864779, "question_id": 39864712, "link": "https://stackoverflow.com/questions/39864712/dynamic-label-caption-in-a-report-using-vba/39864779#39864779", "title": "Dynamic label caption in a report using vba", "body": "<p>If you want to display different values for different rows in report/form, you should use bound text boxes. Labels and unbound text boxes will be the same for all rows in details section. Add new calculated column for optional label in base query and use it instead of label.</p>\n"}], "owner": {"reputation": 73, "user_id": 1927980, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/55ebc9055b5b4514cc11f07d29837254?s=128&d=identicon&r=PG", "display_name": "Dikshant Ghimire", "link": "https://stackoverflow.com/users/1927980/dikshant-ghimire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 0, "accepted_answer_id": 39864779, "answer_count": 1, "score": 0, "last_activity_date": 1475636663, "creation_date": 1475636116, "question_id": 39864712, "link": "https://stackoverflow.com/questions/39864712/dynamic-label-caption-in-a-report-using-vba", "title": "Dynamic label caption in a report using vba", "body": "<p>I am trying to design an indididual report card for the students of my college. I have a table called \"tbl_student\" where their marks are stored. I have 6 columns for 6 different subjects. A student can choose only 5 subjects i.e 4 being required and Computer and Maths are optional subjects where a student can choose either one.<br>\nNow, if a std chooses Comp. then marks in the maths column is 0, likewise for maths.\nI am trying to print an individual report cards for 10 students. But one of the label for the optional should display Computer or Mathematics based on the value of the column. \nHere is the code i tried</p>\n\n<pre><code>'declare the variables\n Dim d As Database\n Dim r As Recordset\n Dim comp As Field, maths As Field\n\n 'the data from the table \n Set d = CurrentDb()\nSet r = d.OpenRecordset(\"tbl_student\")\nSet id = r.Fields(\"Student ID\")\nSet comp = r.Fields(\"Computer\")\nSet maths = r.Fields(\"Mathematics\")\n\n'check for the column value\n While Not r.EOF\n If (comp = 0) Then\nMe.labelOptional.Caption = \"Mathematics\"\nElseIf (maths = 0) Then\nMe.labelOptional.Caption = \"Computer\"\n    Else\n    Me.labelOptional.Caption = \"none\"\n   End If\n</code></pre>\n\n<p>The result is it captions all the labels the same for all students.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 6924140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512d5f6915e65b21c262609e5157ff47?s=128&d=identicon&r=PG&f=1", "display_name": "AjCorneel", "link": "https://stackoverflow.com/users/6924140/ajcorneel"}, "is_accepted": true, "score": 1, "last_activity_date": 1475639222, "creation_date": 1475639222, "answer_id": 39865115, "question_id": 39864513, "link": "https://stackoverflow.com/questions/39864513/excel-print-rows-where-selection-criteria/39865115#39865115", "title": "Excel Print Rows WHERE (Selection Criteria)", "body": "<p>If you're interested in printing one manager at a time, your best option is probably to just go with an AutoFilter. </p>\n\n<pre><code>Sub Dept_BGT_Print()\nDim Sel_Manager As String\n'Specify headers to be repeated at the top\nWith ActiveSheet.PageSetup\n        .PrintTitleRows = \"$1:$1\"\n        .PrintTitleColumns = \"\"\nEnd With\n\n'Manager selection through simple Inputbox\n Sel_Manager = InputBox(\"Which manager?\")\n'Insert autofilter for worksheet\nCells.Select\nSelection.AutoFilter\n'Select manager defined in inputbox\nActiveSheet.Range(\"A1\", Range(\"D1\").End(xlDown)).AutoFilter Field:=1, Criteria1:=Sel_Manager\n 'Select range to be printed and specify manager in filename\nActiveSheet.Range(\"A1\", Range(\"D1\").End(xlDown)).Select\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"Employees for manager \" &amp; manager &amp; \".pdf\", Quality:=xlQualityStandard, \n _IncludeDocProperties:=True, IgnorePrintAreas:=False,  OpenAfterPublish:=True\n\n 'remove autofilter\n  ActiveSheet.ShowAllData\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 39865115, "answer_count": 1, "score": 0, "last_activity_date": 1475639222, "creation_date": 1475634393, "question_id": 39864513, "link": "https://stackoverflow.com/questions/39864513/excel-print-rows-where-selection-criteria", "title": "Excel Print Rows WHERE (Selection Criteria)", "body": "<p>I have a file has 4 columns (A B C D) with the \"Manager\" in column A and the Employee numbers in Column B with example info per employee in C &amp; D. What I would like to do is to be able to have a print macro that would print all the employees under each manager on a PDF with the headers repeating at the top. So when the print macro is clicked on, it would ask, \"Which Manager\"? Then it would be clicked and then it would print the PDF. </p>\n\n<p>Is this possible? I've been researching loops and I was thinking that would be the way to do it but cannot seem to figure out how to replace my \"Range\" below.  It is example code that I use in another file with static ranges.</p>\n\n<p>Any help is much appreciated! Thank you.  P.S. sorry about the code formatting, I cannot seem to get used to Stack Overflow's way of editing it.</p>\n\n<pre><code>Sub Dept_BGT_Print()\nRange(\"C14:R45\").Select\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"John Dept BGT.pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\nTrue\nRange(\"C47:R59\").Select\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"HR Dept BGT.pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\nTrue\nRange(\"C62:R126\").Select\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"Marketing &amp; Sales Dept BGT.pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\nTrue\nRange(\"C128:R207\").Select\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"Skip Dept BGT.pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\nTrue\nRange(\"C209:R250\").Select\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"Amy Dept BGT.pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\nTrue\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 152, "user_id": 5614795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2d99f97fc11aa0a587b26428d1a484?s=128&d=identicon&r=PG&f=1", "display_name": "emjaySX", "link": "https://stackoverflow.com/users/5614795/emjaysx"}, "is_accepted": false, "score": 0, "last_activity_date": 1477371113, "last_edit_date": 1477371113, "creation_date": 1475633974, "answer_id": 39864468, "question_id": 39864436, "link": "https://stackoverflow.com/questions/39864436/vba-excel-copying-cell-contents-to-another-via-column-and-row-offset/39864468#39864468", "title": "VBA Excel Copying Cell contents to another via column and row offset", "body": "<pre><code>activecell.Offset(-1, 17).Value = activecell.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1475774548, "post_id": 39866042, "comment_id": 67089598, "body": "@DennisMoore, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1475645360, "creation_date": 1475645360, "answer_id": 39866042, "question_id": 39864436, "link": "https://stackoverflow.com/questions/39864436/vba-excel-copying-cell-contents-to-another-via-column-and-row-offset/39866042#39866042", "title": "VBA Excel Copying Cell contents to another via column and row offset", "body": "<pre><code>Sub A_Copy_To_Prior_Row_column()\n'\n' A_Copy_To_Prior_Row_column Macro\n'\n\n'\n    Application.CutCopyMode = False\n    With Selection\n        .Copy\n         ActiveSheet.Paste Destination:=.Offset(-1, 17)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3297296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a21c8313b4a248cf46d0cb10857be5e?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Moore", "link": "https://stackoverflow.com/users/3297296/dennis-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1477371113, "creation_date": 1475633700, "last_edit_date": 1475640966, "question_id": 39864436, "link": "https://stackoverflow.com/questions/39864436/vba-excel-copying-cell-contents-to-another-via-column-and-row-offset", "title": "VBA Excel Copying Cell contents to another via column and row offset", "body": "<p>Here is my code</p>\n\n<pre><code>Sub A_Copy_To_Prior_Row_column()\n'\n' A_Copy_To_Prior_Row_column Macro\n'\n\n'\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"R183\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>Where R183 is I need to not a specific cell, but a cell based on minus 1 row, and +17 columns of the selected/highlighted cell I wish to copy </p>\n"}, {"tags": ["vba", "excel", "worksheet-function"], "comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 1, "creation_date": 1475633084, "post_id": 39863973, "comment_id": 67016549, "body": "5x5 grid in A2:J6.... 5x5 = 25..... 5x10(A-J) = 50.... Say again? Also, most people here won&#39;t help with homework questions, especially if you don&#39;t have a specific question about the homework question that you&#39;re stuck on. You&#39;re basically asking us to do it for you at this point. Do you have a specific problem that you can&#39;t work around?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1475648346, "post_id": 39863973, "comment_id": 67020851, "body": "&quot;A2:J6&quot; is not a <i>&quot;5x5 grid&quot;</i>"}, {"owner": {"reputation": 1, "user_id": 6923802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d001ccd6bbf7fdc5527acac946a1fda2?s=128&d=identicon&r=PG&f=1", "display_name": "Varsil", "link": "https://stackoverflow.com/users/6923802/varsil"}, "edited": false, "score": 0, "creation_date": 1475709822, "post_id": 39863973, "comment_id": 67057054, "body": "It would seem as though I used the wrong cells. It should have been A2:E6. As far as this being a homework assignment, you are far from correct in that assumption. This is actually a personal project of mine that I got stuck in trying to finish. However, I have actually realized what I was trying to do is way more complicated than necessary and as such, no longer need any help. But thanks anyways!"}], "owner": {"reputation": 1, "user_id": 6923802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d001ccd6bbf7fdc5527acac946a1fda2?s=128&d=identicon&r=PG&f=1", "display_name": "Varsil", "link": "https://stackoverflow.com/users/6923802/varsil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475632098, "creation_date": 1475629826, "last_edit_date": 1475632098, "question_id": 39863973, "link": "https://stackoverflow.com/questions/39863973/finding-text-and-returning-cell-address", "title": "Finding text and returning cell address", "body": "<p>I have a 5x5 grid in cells A2:J6. Each cell contains an answer to a question. In cells A10 through A60, I have a random collection of answers. What I am trying to do is create a formula that will search for each answer within the range A2:J6. If it finds a match, it will return the cell address. However, I want to do this with 25 5x5 grids, with the same 50 answers.</p>\n\n<p>My current setup is basically a huge collection of nested IFS, IFERRORS, CELL, INDEX, and MATCH functions, which require me to manually update for each of the 25 grids because I have to test each 5x5 grid by their individual columns. </p>\n\n<p>I am open to using VBA if it will make the situation less tedious.</p>\n\n<p>I am also looking for a way to then search the results for a specific pattern (ie. A2:A6 and if it exists, give an appropriate response).</p>\n\n<p>My setup for that looks like this: <code>=IF(AND(ISNUMBER(MATCH(\"$A$2\",My_Range,0))...</code> (partial formula sample)\nwith the ISNUMBER and MATCH statement repeated for each of the individual items I am looking for.</p>\n\n<p>Can I simplify these any?</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1475630498, "post_id": 39863898, "comment_id": 67016014, "body": "Do you have <code>Option Explicit</code> in your module (it will be the first line if it&#39;s there).  If so, then that&#39;s good, but you will need to add <code>Dim blah as Variant</code> to your sub"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1475631080, "creation_date": 1475631080, "answer_id": 39864133, "question_id": 39863898, "link": "https://stackoverflow.com/questions/39863898/excel-vba-autofill-and-source-is-range-of-cells/39864133#39864133", "title": "Excel VBA autofill and source is range of cells", "body": "<p>Chris Neilsen is probably right.  You mostly likely have <code>Option Explicit</code> at the top of the userform  module which requires <code>blah</code> to be decalred.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim blah As Variant\n    UserForm1.Label1 = Date\n    For Each blah In [ident]\n        UserForm1.ComboBox4.AddItem blah\n    Next blah\n\nEnd Sub\n</code></pre>\n\n<p>Here are two other ways that you can define the range:</p>\n\n<p><code>For Each blah In [OFFSET(DataSource!$A:$A,1,0,COUNTA(DataSource!$A:$A)-1,1)]</code></p>\n\n<p><code>For Each blah In Range(\"OFFSET(DataSource!$A:$A,1,0,COUNTA(DataSource!$A:$A)-1,1)\")</code></p>\n"}], "owner": {"reputation": 1, "user_id": 4822952, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-ReaRNfsGa6Q/AAAAAAAAAAI/AAAAAAAAARI/cufCDh--qvs/photo.jpg?sz=128", "display_name": "Sir Ivan", "link": "https://stackoverflow.com/users/4822952/sir-ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582808996, "creation_date": 1475629059, "last_edit_date": 1582808996, "question_id": 39863898, "link": "https://stackoverflow.com/questions/39863898/excel-vba-autofill-and-source-is-range-of-cells", "title": "Excel VBA autofill and source is range of cells", "body": "<p>I have define a name for my data, so when I put a new data in my cell, it will be also included on my autofill code</p>\n\n<p>name of cell is ident</p>\n\n<pre><code>=OFFSET(DataSource!$A:$A,1,0,COUNTA(DataSource!$A:$A)-1,1)\n</code></pre>\n\n<p>This is my code for autofill on combo box</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nUserForm1.Label1 = Date\nFor Each blah In [ident]\n    UserForm1.ComboBox4.AddItem blah\nNext blah\n\nEnd Sub\n</code></pre>\n\n<p>Im getting an error, variable not define and highlighted \"blah\"</p>\n"}, {"tags": ["excel", "checkbox", "activex", "vba"], "comments": [{"owner": {"reputation": 1380, "user_id": 3560873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4i37O.jpg?s=128&g=1", "display_name": "searchengine27", "link": "https://stackoverflow.com/users/3560873/searchengine27"}, "edited": false, "score": 1, "creation_date": 1475634108, "post_id": 39863846, "comment_id": 67016776, "body": "Please add code snippets of what you&#39;ve already tried."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1475685380, "post_id": 39864074, "comment_id": 67045489, "body": "Thank you so much for the quick reply. I was actually embarrassed to add what I tried.  I was orig. able to get the copy button to work, but not the checkboxes. This is my first try at this. But the above works Perfect!!! Thank you so much! There is one other thing I forgot to mention. It there a way to add code so only one checkbox can be checked at a time?  Thank you so much!!!"}, {"owner": {"reputation": 368, "user_id": 6868389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gkskf.png?s=128&g=1", "display_name": "lllpratll", "link": "https://stackoverflow.com/users/6868389/lllpratll"}, "reply_to_user": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1475798218, "post_id": 39864074, "comment_id": 67100084, "body": "I&#39;m not sure what you mean by &quot;so only one checkbox can be checked at a time&quot; can you make it clearer please?"}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1475872614, "post_id": 39864074, "comment_id": 67134559, "body": "Sorry about that! Lets see....So, I have a copy button  with 3 checkboxes (A1, A2 &amp; A3), depending on what check box is checked when I hit the copy button it will copy a specific cell number.  However, I only want one check box to be able to be check at one time.  So, if I push &quot;A1&quot;  then select &quot;A2&quot; it will cause &quot;A1&quot; to uncheck. Hope that helps! :)"}, {"owner": {"reputation": 368, "user_id": 6868389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gkskf.png?s=128&g=1", "display_name": "lllpratll", "link": "https://stackoverflow.com/users/6868389/lllpratll"}, "reply_to_user": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1475894612, "post_id": 39864074, "comment_id": 67139622, "body": "Ah yes I understand now.. You could add some code so that when you change the value of a checkbox the others change accordingly however a much neater way to do it would be to use option buttons. They function similarly to check boxes however by default you can only select one at a time, should be perfect for this. You will need to replace you check boxes with option buttons and change the code from CheckBox1.Value to OptionButton1.Value etc but that should do it, link below for more info on option buttons :)  <a href=\"http://www.excel-easy.com/vba/examples/option-buttons.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/option-buttons.html</a>"}], "tags": [], "owner": {"reputation": 368, "user_id": 6868389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gkskf.png?s=128&g=1", "display_name": "lllpratll", "link": "https://stackoverflow.com/users/6868389/lllpratll"}, "is_accepted": false, "score": 1, "last_activity_date": 1475630649, "creation_date": 1475630649, "answer_id": 39864074, "question_id": 39863846, "link": "https://stackoverflow.com/questions/39863846/excel-form-vba-code-to-copy-a-cell-when-a-check-box-is-selected/39864074#39864074", "title": "Excel Form: VBA Code to copy a cell when a check box is selected", "body": "<p>this assumes your copy button is named CopyButton \nit will copy cell A1 if a check box named CheckBox1 is checked\nA2 if CheckBox2 is checked etc you can change the cell references below\nyou didn't really specify what to do with the copied data so it just copies it and does nothing</p>\n\n<pre><code>Public Sub CopyButton_Click()\n\n    if(CheckBox1.Value = true) then\n        ActiveSheet.Range(\"A1\").copy\n    end if\n\n    if(CheckBox2.Value = true) then\n        ActiveSheet.Range(\"A2\").copy\n    end if\n\n    'copy the chunk above for more check boxes\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1604, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475630649, "creation_date": 1475628637, "last_edit_date": 1531161705, "question_id": 39863846, "link": "https://stackoverflow.com/questions/39863846/excel-form-vba-code-to-copy-a-cell-when-a-check-box-is-selected", "title": "Excel Form: VBA Code to copy a cell when a check box is selected", "body": "<p>I am new to Excel forms and was wondering if someone could help with a simple code for a program I am trying to create for work. Basically, to make my job easier! </p>\n\n<p>What I'm looking for is code that when a specific checkbox is selected and I hit a copy button, it copies a specific cell. I will have multiple checkboxes but just one copy button. Any help would be greatly appreciated!</p>\n"}, {"tags": ["arrays", "vba", "excel", "rtd"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475629414, "post_id": 39863496, "comment_id": 67015790, "body": "For a formula, you can use the <code>INDEX</code> function."}, {"owner": {"reputation": 33, "user_id": 3550039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73540bb331d7739f6477b18254cba505?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3550039/josh"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475674506, "post_id": 39863496, "comment_id": 67037461, "body": "Thanks @Ron, I have looked at INDEX but I don&#39;t see how the INDEX function is used in this case. I can only find examples of INDEX being used to refer to a cell reference. At this point, the entire array exists in cell A1. If I named cell A1 &quot;letters,&quot; then in A2 it would be great if I could put =letters[2] and get &quot;b&quot; (or &quot;c&quot; if the index is base 0). The answer from John gets me 90% there."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475674731, "post_id": 39863496, "comment_id": 67037654, "body": "There is no requirement that the array argument for the Index function be a range.  You would place the <code>RTD</code> formula as the <code>array</code> argument, and then look at the different rows (or columns depending on how RTD returns).  Something like <code>INDEX(RTD(...),2,1)</code>  should return the second element in the array.  If it is returning a string that looks like an array, then this would not work."}, {"owner": {"reputation": 33, "user_id": 3550039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73540bb331d7739f6477b18254cba505?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3550039/josh"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475676316, "post_id": 39863496, "comment_id": 67038957, "body": "@RonRosenfeld Perfect, thank you. Using John&#39;s function below, this works: <code>=INDEX(ParseArray(A1),1,2)</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1475631466, "post_id": 39863666, "comment_id": 67016203, "body": "You Split for rows but not for columns. It would be simpler to Evaluate it like the article you referred did."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475636179, "post_id": 39863666, "comment_id": 67017202, "body": "@ThomasInzina  Good points, but OP specifically said that in their application it was a 1-dimensional array. <code>Evaluate</code> would turn it into one of those annoying pseudo 2 dimensional arrays which wouldn&#39;t be quite as convenient for some applications."}, {"owner": {"reputation": 33, "user_id": 3550039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73540bb331d7739f6477b18254cba505?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3550039/josh"}, "edited": false, "score": 0, "creation_date": 1475675826, "post_id": 39863666, "comment_id": 67038552, "body": "Thanks, @JohnColeman! This is great. My next step is to populate a combo box with the elements of the array. I would like to be able to count the elements of the array, return an element by index, and other things via VBA. Rather than be handed the answer, are there any other documents you would recommend to learn more about working with arrays in VBA?"}, {"owner": {"reputation": 33, "user_id": 3550039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73540bb331d7739f6477b18254cba505?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3550039/josh"}, "edited": false, "score": 0, "creation_date": 1475676699, "post_id": 39863666, "comment_id": 67039223, "body": "<code>=INDEX(ParseArray(A1),1,2)</code> gives me the second element, and <code>=COUNTA(ParseArray(A1))</code> gives me the number of elements."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475676719, "post_id": 39863666, "comment_id": 67039236, "body": "I&#39;m sure there are tutorials/ youtube videos out there, but if you like books I would recommend John Walkenbach&#39;s &quot;Excel VBA Programming for Dummies&quot;. I first learned VBA through an earlier edition of that book. His website is also a good source of information (<a href=\"http://spreadsheetpage.com/\" rel=\"nofollow noreferrer\">spreadsheetpage.com</a> )"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475676851, "post_id": 39863666, "comment_id": 67039347, "body": "If you assign <code>ParseArray(A1)</code> to a variable, say <code>A</code>, then simply <code>A(0)</code> is the first element, <code>A(1)</code> is the second, and <code>UBound(A) + 1</code> is the number of elements."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 3, "last_activity_date": 1475627081, "creation_date": 1475627081, "answer_id": 39863666, "question_id": 39863496, "link": "https://stackoverflow.com/questions/39863496/parse-an-array-returned-from-rtd-in-excel/39863666#39863666", "title": "Parse an array returned from RTD in Excel", "body": "<p><a href=\"https://support.microsoft.com/en-us/kb/286258\" rel=\"nofollow\">This</a> documentation suggests that <code>RTD</code> returns a string. If so, the following should be able to parse it, returning the result as an array:</p>\n\n<pre><code>Function ParseArray(ArrayString As String) As Variant\n    Dim s As String\n    s = Replace(ArrayString, \"{\", \"\")\n    s = Replace(s, \"}\", \"\")\n    s = Replace(s, \"\"\"\", \"\")\n    ParseArray = Split(s, \";\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3550039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73540bb331d7739f6477b18254cba505?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3550039/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 39863666, "answer_count": 1, "score": 0, "last_activity_date": 1475645486, "creation_date": 1475625664, "last_edit_date": 1592644375, "question_id": 39863496, "link": "https://stackoverflow.com/questions/39863496/parse-an-array-returned-from-rtd-in-excel", "title": "Parse an array returned from RTD in Excel", "body": "<p>I am using an RTD formula in an Excel worksheet to receive a list of items in cell A1:</p>\n<pre><code>=RTD(&quot;josh.rtd&quot;,,&quot;Letters&quot;,,&quot;Lower&quot;)\n</code></pre>\n<p>The returned list in cell A1 is in curly bracket and delimited by semi colons. Basically, it's a one dimensional array of rows and looks like this</p>\n<blockquote>\n<p>{&quot;a&quot;;&quot;b&quot;;&quot;c&quot;;&quot;d&quot;}</p>\n</blockquote>\n<p>If I copy that result, and paste the values in A2, then copy A2, select four cells from a column in a spreadsheet, such as A3:A6, and type an &quot;=&quot; in the formula window, and paste the result,</p>\n<pre><code>={&quot;a&quot;;&quot;b&quot;;&quot;c&quot;;&quot;d&quot;}\n</code></pre>\n<p>I can hold down <kbd>ctrl</kbd>+<kbd>shift</kbd>+<kbd>enter</kbd> and populate each of those cells with an element of the array like this:</p>\n<blockquote>\n<p>a</p>\n<p>b</p>\n<p>c</p>\n<p>d</p>\n</blockquote>\n<p>My question is this: is there a formula I can use to parse that original RTD formula result? I want to populate a combo box control with the elements of that array. I would love to be able to do this either in a cell formula or via VBA.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 7168, "user_id": 6842716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cxds5.png?s=128&g=1", "display_name": "JohnG", "link": "https://stackoverflow.com/users/6842716/johng"}, "edited": false, "score": 0, "creation_date": 1475638353, "post_id": 39863358, "comment_id": 67017759, "body": "hello cricketbird. This may be a dumb question but... as you say <i>I have VBA code that creates two spreadsheets and then opens them. However, my code opens these spreadsheets in different instances of Excel.</i> ... Then don&#39;t open them in different instances. If you have an openMethod that creates its own instance, then I would think you could make another method that would create one instance of the excel app and open both files. Just guessing here."}, {"owner": {"reputation": 500, "user_id": 1366961, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e87788fe19740942c164471359931e5?s=128&d=identicon&r=PG", "display_name": "datakritter", "link": "https://stackoverflow.com/users/1366961/datakritter"}, "reply_to_user": {"reputation": 7168, "user_id": 6842716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cxds5.png?s=128&g=1", "display_name": "JohnG", "link": "https://stackoverflow.com/users/6842716/johng"}, "edited": false, "score": 0, "creation_date": 1475662583, "post_id": 39863358, "comment_id": 67029236, "body": "I guess that&#39;s what I&#39;m asking - what <i>is</i> an open method that does NOT create 2 instances?"}], "answers": [{"tags": [], "owner": {"reputation": 500, "user_id": 1366961, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e87788fe19740942c164471359931e5?s=128&d=identicon&r=PG", "display_name": "datakritter", "link": "https://stackoverflow.com/users/1366961/datakritter"}, "is_accepted": true, "score": 1, "last_activity_date": 1476025386, "creation_date": 1476025386, "answer_id": 39945031, "question_id": 39863358, "link": "https://stackoverflow.com/questions/39863358/vba-how-to-export-two-queries-to-excel-in-the-same-instance-of-excel/39945031#39945031", "title": "VBA: How to export two queries to Excel in the same instance of Excel?", "body": "<p>Okay - found the answer.  You have to create an instance of excel manually, and then open the worksheets within that:</p>\n\n<pre><code>        Dim ApXL As Object\n        Dim xlWBk1 As Object\n        Dim xlWBk2 As Object\n\nDoCmd.OutputTo acOutputQuery, \"CrossTab\", \"ExcelWorkbook(*.xlsx)\", \"C:\\Path\\To\\File1\", False, \"\", , acExportQualityPrint\nDoCmd.OutputTo acOutputQuery, \"MyQuery\", \"ExcelWorkbook(*.xlsx)\", \"C:\\Path\\To\\File2\", False, \"\", , acExportQualityPrint\n\nSet ApXL = CreateObject(\"Excel.Application\")\n            Set xlWBk1 = ApXL.Workbooks.Open(C:\\Path\\To\\File1)\n            Set xlWBk2 = ApXL.Workbooks.Open(C:\\Path\\To\\File2)\n</code></pre>\n"}], "owner": {"reputation": 500, "user_id": 1366961, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e87788fe19740942c164471359931e5?s=128&d=identicon&r=PG", "display_name": "datakritter", "link": "https://stackoverflow.com/users/1366961/datakritter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 39945031, "answer_count": 1, "score": 0, "last_activity_date": 1594641254, "creation_date": 1475624533, "last_edit_date": 1594641254, "question_id": 39863358, "link": "https://stackoverflow.com/questions/39863358/vba-how-to-export-two-queries-to-excel-in-the-same-instance-of-excel", "title": "VBA: How to export two queries to Excel in the same instance of Excel?", "body": "<p>In MS Access, I have VBA code that creates two spreadsheets and then opens them.  However, my code opens these spreadsheets in different instances of Excel.  The spreadsheets refer to one another, and so they need to open in the same instance to work properly.  Opening the files together manually from the desktop (in a single instance) works fine (the spreadsheets can find the data in their partner).   </p>\n\n<p>How can I ask them to open in the same instance? </p>\n\n<pre><code>DoCmd.OutputTo acOutputQuery, \"CrossTab\", \"ExcelWorkbook(*.xlsx)\", \"C:\\Users\\10331654\\Desktop\\CrossTab.xlsx\", True, \"\", , acExportQualityPrint\nDoCmd.OutputTo acOutputQuery, \"MyQuery\", \"ExcelWorkbook(*.xlsx)\", \"C:\\Users\\10331654\\Desktop\\MyQuery.xlsx\", True, \"\", , acExportQualityPrint\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1475621758, "post_id": 39862785, "comment_id": 67014040, "body": "<i>I try to expand it on all the rows in the table I get error messages</i>  really? Let me guess what they are...  No, actually, why don&#39;t you tell us?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1475704509, "post_id": 39862785, "comment_id": 67055527, "body": "@chrisneilsen <i>It&#39;s written on my screen, can&#39;t you read?</i>"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1475628350, "creation_date": 1475628350, "answer_id": 39863814, "question_id": 39862785, "link": "https://stackoverflow.com/questions/39862785/excel-vba-code-to-compare-text-strings-in-two-columns-and-highlight-certain-text/39863814#39863814", "title": "Excel VBA code to compare text strings in two columns and highlight certain text strings not the whole cell?", "body": "<p><strong>If</strong> your code works correctly on the first row (I haven't tested it, so will just trust that you are correct), then the following is, I think, what you want to change:</p>\n\n<pre><code>Sub Test1()\n  Dim strString$, x&amp;\n  Dim rngCell As Range\n\n  Application.ScreenUpdating = False\n  For Each rngCell In Range(\"S2\", Range(\"S\" &amp; Rows.Count).End(xlUp))\n      With rngCell\n          .Font.ColorIndex = 1\n          strString = Cells(rngCell.Row, \"G\").Value\n          For x = 1 To Len(.Text) - Len(strString) Step 1\n              If Mid(.Text, x, Len(strString)) = strString Then .Characters(x, Len(strString)).Font.ColorIndex = 5\n          Next x\n      End With\n  Next rngCell\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>i.e. move the calculation of <code>strString</code> inside the loop and base it on the value in column G of the row being processed.</p>\n"}, {"tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": false, "score": 0, "last_activity_date": 1475628508, "last_edit_date": 1495541785, "creation_date": 1475628508, "answer_id": 39863829, "question_id": 39862785, "link": "https://stackoverflow.com/questions/39862785/excel-vba-code-to-compare-text-strings-in-two-columns-and-highlight-certain-text/39863829#39863829", "title": "Excel VBA code to compare text strings in two columns and highlight certain text strings not the whole cell?", "body": "<p>I just gave someone this answer to a very <a href=\"https://stackoverflow.com/questions/39708050/formatting-list-of-text-strings-in-excel/39708675#39708675\">similar question</a>...</p>\n\n<pre><code>Sub ColorMatchingString()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(1)\n    Dim strTest As Collection: Set strTest = New Collection\n    Dim udRange As Range: Set udRange = ws.Range(\"AC2:AC311\") 'Define Search Ranges\n    Dim myCell, myMatch, myString, i\n    Dim temp() As String, tempLength As Integer, stringLength As Integer\n    Dim startLength as Integer\n\n    For Each myMatch In udRange 'Build the collection with Search Range Values\n        strTest.Add myMatch.Value\n    Next myMatch\n\n    For Each myCell In ws.Range(\"A2:AB1125\") 'Loop through each cell in range\n        temp() = Split(myCell.Text, \", \") 'define our temp array as \",\" delimited\n        startLength = 0\n        stringLength = 0\n\n        For i = 0 To UBound(temp) 'Loop through each item in temp array\n            tempLength = Len(temp(i))\n            stringLength = stringLength + tempLength + 2\n\n            For Each myString In strTest\n  'Below compares the temp array value to the collection value. If matched, color red.\n                If StrComp(temp(i), myString, vbTextCompare) = 0 Then \n                    startLength = stringLength - tempLength - 1\n                    myCell.Characters(startLength, tempLength).Font.Color = vbRed\n                End If\n            Next myString\n        Next i\n        Erase temp 'Always clear your array when it's defined in a loop\n    Next myCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 529, "user_id": 6923497, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/df133132b3bf7f127409517e67e25576?s=128&d=identicon&r=PG&f=1", "display_name": "Curious ", "link": "https://stackoverflow.com/users/6923497/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2299, "favorite_count": 0, "accepted_answer_id": 39863814, "answer_count": 2, "score": -1, "last_activity_date": 1475628508, "creation_date": 1475620439, "last_edit_date": 1531161705, "question_id": 39862785, "link": "https://stackoverflow.com/questions/39862785/excel-vba-code-to-compare-text-strings-in-two-columns-and-highlight-certain-text", "title": "Excel VBA code to compare text strings in two columns and highlight certain text strings not the whole cell?", "body": "<p>I need to do a vba code to compare texts in two columns and highlight matched texts in the second column. I started on the code and below is what I got so far. It works fine on the first row, how to modify the code to apply this for the entire table not just the first row. I'm new to VBA and any help would be great. </p>\n\n<pre><code>Sub Test1()\n  Dim strString$, x&amp;\n  Dim rngCell As Range\n\n  strString = Range(\"G2\").Value\n  Application.ScreenUpdating = False\n  For Each rngCell In Range(\"S2\", Range(\"S\" &amp; Rows.Count).End(xlUp))\n      With rngCell\n          .Font.ColorIndex = 1\n          For x = 1 To Len(.Text) - Len(strString) Step 1\n              If Mid(.Text, x, Len(strString)) = strString Then .Characters(x, Len(strString)).Font.ColorIndex = 5\n          Next x\n      End With\n  Next rngCell\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1475621507, "post_id": 39862558, "comment_id": 67013966, "body": "Unique is a &quot;named argument&quot; and the <code>:=</code> is used to assign its value.  <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251503.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg251503.aspx</a>"}, {"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1475650530, "post_id": 39862558, "comment_id": 67021886, "body": "<a href=\"http://stackoverflow.com/documentation/vba/1179/procedure-calls/16450/optional-arguments#t=201610050655003223225\">stackoverflow.com/documentation/vba/1179/procedure-calls/164&zwnj;&#8203;50/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 6923453, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3fIITQ2AsIo/AAAAAAAAAAI/AAAAAAAAAAA/puFMNY90zuY/photo.jpg?sz=128", "display_name": "Vinod Ravi", "link": "https://stackoverflow.com/users/6923453/vinod-ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475619094, "creation_date": 1475619094, "question_id": 39862558, "link": "https://stackoverflow.com/questions/39862558/unique-true-syntax-in-vba-excel", "title": "&quot;Unique:=True &quot; syntax in vba excel", "body": "<p>I'm new to vba excel and working with Advance filter in vba excel for some school assignment. </p>\n\n<p>I came across the code \"Unique:=True\". I'm trying to understand what this means. \nWhat does the \":=\" operator mean ? </p>\n\n<p>thanks in advance. </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1475618276, "post_id": 39862335, "comment_id": 67012849, "body": "Perhaps this could explain? <a href=\"http://stackoverflow.com/questions/17706422/why-is-outlook-unable-to-save-a-particular-type-of-attachments\" title=\"why is outlook unable to save a particular type of attachments\">stackoverflow.com/questions/17706422/&hellip;</a>  FYI, in the future, please note the line of code that throws the error....it makes it a lot easier on anyone trying to help."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1475618666, "post_id": 39862335, "comment_id": 67012996, "body": "What is the value of the Atmt.Type property?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5225238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/989d73cfd9fdf5baa2a2fcc516bb90f8?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Zardus", "link": "https://stackoverflow.com/users/5225238/brian-zardus"}, "is_accepted": false, "score": 0, "last_activity_date": 1475705881, "creation_date": 1475705881, "answer_id": 39884572, "question_id": 39862335, "link": "https://stackoverflow.com/questions/39862335/adding-an-appointment-sent-as-an-attachment-to-a-calendar/39884572#39884572", "title": "Adding an Appointment sent as an Attachment to a Calendar", "body": "<p>Below is the corrected vba. The Attachment saves as a AppointmentItem, not a MeetingItem, which was causing the issues.</p>\n\n<pre><code>Sub SaveAttatchments()\nOn Error GoTo SaveAttachments_err\n\nDim myNameSpace As Outlook.NameSpace\nDim InboxFolder As Outlook.Folder\nDim myCalendarFolder As Outlook.Folder\n\nDim myMtgReq As Outlook.MeetingItem\nDim myAppt As Outlook.AppointmentItem\nDim Atmt As Attachment\n\nDim FileName As String\nDim i As Integer\n\nSet myNameSpace = Application.GetNamespace(\"MAPI\")\nSet InboxFolder = myNameSpace.GetDefaultFolder(olFolderInbox)\nSet myCalendarFolder = myNameSpace.GetDefaultFolder(olFolderCalendar)\n\n\nFilePath = \"C:\\temp\\\"\n\n' Check each message for attachments\nFor Each Item In InboxFolder.Items\nIf Item.Subject = \"Conf Calendar\" Then\nFor Each Atmt In Item.Attachments\n\n'Save the attachment in folder\nFileName = FilePath &amp; Atmt.FileName\nAtmt.SaveAsFile FileName\n\n'Import the ics from the folder and put an entry in Calendar\nSet myAppt = myNameSpace.OpenSharedItem(FileName)\nmyAppt.Save\n\ni = i + 1\nNext Atmt\n\nEnd If\nNext Item\n\n' Clear memory\nSaveAttachments_exit:\n\nSet Atmt = Nothing\nSet Item= Nothing\nSet myMtgReq = Nothing\nExit Sub\n\nSaveAttachments_err:\nMsgBox \"An unexpected error has occurred.\" _\n&amp; vbCrLf &amp; \"Please note and report the following information.\" _\n&amp; vbCrLf &amp; \"Macro Name: SaveAttachments\" _\n&amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n&amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n, vbCritical, \"Error!\"\nResume SaveAttachments_exit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5225238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/989d73cfd9fdf5baa2a2fcc516bb90f8?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Zardus", "link": "https://stackoverflow.com/users/5225238/brian-zardus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1266, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1612034721, "creation_date": 1475617813, "last_edit_date": 1612034721, "question_id": 39862335, "link": "https://stackoverflow.com/questions/39862335/adding-an-appointment-sent-as-an-attachment-to-a-calendar", "title": "Adding an Appointment sent as an Attachment to a Calendar", "body": "<p>Automated emails with .ics attachments are being received in an Outlook Shared mailbox.</p>\n<p>I am trying to open that attachment, and save that Meeting/Appointment to the Calendar.</p>\n<p>I tried a number of ways. For my latest iteration I am hoping to add this macro directly on the Shared Calendar's mailbox. Let me know if it makes more sense for the emails to be sent to my personal Outlook mailbox, where I then call the macro from a &quot;run a script&quot; Outlook Rule, and route it to the Shared Calendar.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SaveAttatchments()\n    \n    ' This Outlook macro checks at the Outlook Inbox for messages\n    ' with attached files (of *.ics type) and put a entry in the calendar.\n    \n    On Error GoTo SaveAttachments_err\n    \n    Dim InboxFolder As Outlook.Folder\n    Dim myCalendarFolder As Outlook.Folder\n    Dim myMtgReq As Outlook.MeetingItem \n    Dim mynamespace As Outlook.NameSpace\n    Dim Atmt As Attachment\n    Dim FileName As String\n    Dim i As Integer\n    \n    Set mynamespace = Application.GetNamespace(&quot;MAPI&quot;)\n    Set InboxFolder = mynamespace.GetDefaultFolder(olFolderInbox)\n    Set myCalendarFolder = mynamespace.GetDefaultFolder(olFolderCalendar)\n    \n    FilePath = &quot;C:\\temp\\&quot;\n    \n    ' Check each message for attachments\n    For Each Item In InboxFolder.Items\n        For Each Atmt In Item.Attachments\n            If Right(Atmt.FileName, 3) = &quot;ics&quot; Then\n\n                'Save the attachment in folder\n                FileName = FilePath &amp; Atmt.FileName\n                Atmt.SaveAsFile FileName\n\n                'Import the ics from the folder and put an entry in Calendar\n                Set myMtgReq = mynamespace.OpenSharedFolder(FileName)\n                myMtgReq.GetAssociatedAppointment (True)\n                i = i + 1\n    \n            End If\n        Next Atmt\n    Next Item\n\nSaveAttachments_exit:\n    \n    Set Atmt = Nothing\n    Set Item = Nothing\n    Set myMtgReq = Nothing\n    Exit Sub\n\nSaveAttachments_err:\n    MsgBox &quot;An unexpected error has occurred.&quot; _\n    &amp; vbCrLf &amp; &quot;Please note and report the following information.&quot; _\n    &amp; vbCrLf &amp; &quot;Macro Name: SaveAttachments&quot; _\n    &amp; vbCrLf &amp; &quot;Error Number: &quot; &amp; Err.Number _\n    &amp; vbCrLf &amp; &quot;Error Description: &quot; &amp; Err.Description _\n    , vbCritical, &quot;Error!&quot;\n    Resume SaveAttachments_exit\n    \nEnd Sub\n</code></pre>\n<p>I get the following:</p>\n<blockquote>\n<p>&quot;Outlook cannot perform this action on this type of attachment.&quot;</p>\n</blockquote>\n"}, {"tags": ["sql", "excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1475618120, "post_id": 39862330, "comment_id": 67012794, "body": "Please add the full SQL of the append query (?) you tried to your question."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1475618619, "post_id": 39862330, "comment_id": 67012976, "body": "I used the design wizard with minimal to no SQL of my own."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1475618946, "post_id": 39862330, "comment_id": 67013093, "body": "That is not a problem, just switch the query to SQL view and copy/paste the SQL text into your question."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1475676376, "post_id": 39862330, "comment_id": 67038992, "body": "INSERT INTO Consolidated_Data ( [Physician_First Name],     [Physician _Last Name], Degree )     SELECT Left([Full Name],InStr([Full Name],&#39; &#39;)-1) AS PullFirst,    Source_OddName.[Last Name], Source_OddName.Degree     FROM Consolidated_Data, Source_OddName;"}], "answers": [{"tags": [], "owner": {"reputation": 1125, "user_id": 1819403, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wnFWz.jpg?s=128&g=1", "display_name": "Anthony Griggs", "link": "https://stackoverflow.com/users/1819403/anthony-griggs"}, "is_accepted": false, "score": 0, "last_activity_date": 1475619135, "creation_date": 1475619135, "answer_id": 39862569, "question_id": 39862330, "link": "https://stackoverflow.com/questions/39862330/i-need-to-pull-a-first-name-from-a-full-name-during-an-append/39862569#39862569", "title": "I need to pull a first name from a full name during an append", "body": "<p>Maybe an easy fix is to just import it as normal... then do an UPDATE to get the first name from the already existing Full Name column. The append or INSERT statement should have worked so something is going on to create the additional records. But if you are not into figuring out why these additional records are being populated, or are just in a rush then the UPDATE Query should do what you need.</p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 6906936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nDOef.jpg?s=128&g=1", "display_name": "servant", "link": "https://stackoverflow.com/users/6906936/servant"}, "is_accepted": false, "score": 0, "last_activity_date": 1475619298, "creation_date": 1475619298, "answer_id": 39862598, "question_id": 39862330, "link": "https://stackoverflow.com/questions/39862330/i-need-to-pull-a-first-name-from-a-full-name-during-an-append/39862598#39862598", "title": "I need to pull a first name from a full name during an append", "body": "<p>I assume that since some of the tables had the separated first name, your consolidated final table has a first name field. If you can go back to your 492-record table, simply create an update query where the FirstName column is updated to the expression you used above, with strName being replaced by the FullName column name.  If you want to be a little more sophisticated and not mess with the rows that already have a correct first name, simply add a criteria on the query where the FirstName column is \"Is Null\".</p>\n"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475683173, "creation_date": 1475617781, "last_edit_date": 1475683173, "question_id": 39862330, "link": "https://stackoverflow.com/questions/39862330/i-need-to-pull-a-first-name-from-a-full-name-during-an-append", "title": "I need to pull a first name from a full name during an append", "body": "<p>So I've got a bunch of excel spreadsheets with different column headers and different formatting. I need all of them imported into an Access DB that I've been working with.</p>\n\n<p>So I've essentially imported them all as separate tables and then consolidated, by appending them all, to one final table. In doing so I've encountered an issue. I need to pull every customer's first name, but on one spreadsheet FULL_NAME is the only column I can pull it from.</p>\n\n<p>The problem is this...the format is like \"John Michael Doe, MD\"...which is a headache when I only need to pull John.</p>\n\n<p>I tried the following expression as an append field</p>\n\n<pre><code>Left([strName],InStr([strName],\u201d \u201c)-1)\n</code></pre>\n\n<p>It kind of worked. What ended up happening is that it assigned EVERY first name to EVERY existing record. So I already have 492 records in the table I was appending to and there were 200 fields in this one, so I ended up with nearly 100,000 records. NOT FUN.</p>\n\n<p>Is there a way around this?</p>\n\n<p><strong>Edit:</strong> Append query from comment:</p>\n\n<pre><code>INSERT INTO Consolidated_Data ( [Physician_First Name], [Physician _Last Name], Degree ) \nSELECT Left([Full Name],InStr([Full Name],' ')-1) AS PullFirst, \n       Source_OddName.[Last Name], Source_OddName.Degree \nFROM Consolidated_Data, Source_OddName\n</code></pre>\n"}, {"tags": ["excel", "runtime-error", "autofill", "vba"], "comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1475610305, "post_id": 39860495, "comment_id": 67009063, "body": "Is this part of a <code>Worksheet_Change</code> procedure?"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 2, "creation_date": 1475610559, "post_id": 39860495, "comment_id": 67009189, "body": "Um... I dont use <code>Select Case</code> very much, but I&#39;ve never seen it constructed like this before.. What is <code>(changedcell)</code>? Where is your <code>Case</code>? Isn&#39;t the point of writing a <code>Select Case</code> so that you <i>don&#39;t have to make a bunch of <code>If Then Else</code> statements?</i>"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475610733, "post_id": 39860495, "comment_id": 67009277, "body": "<a href=\"http://www.excel-easy.com/vba/examples/select-case.html\" rel=\"nofollow noreferrer\">An example of <code>Select Case</code></a>, what Microsoft has to say <a href=\"https://msdn.microsoft.com/en-us/library/cy37t14y.aspx\" rel=\"nofollow noreferrer\">about <code>Select Case</code></a>"}, {"owner": {"reputation": 457, "user_id": 4515125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-rCNR0REYrms/AAAAAAAAAAI/AAAAAAAAABA/doHrukMdDwA/photo.jpg?sz=128", "display_name": "Christine Ross", "link": "https://stackoverflow.com/users/4515125/christine-ross"}, "edited": false, "score": 0, "creation_date": 1475610991, "post_id": 39860495, "comment_id": 67009394, "body": "Please check what autofill fills in the cells; explanation of the error <a href=\"https://msdn.microsoft.com/en-us/library/aa264979(v=vs.60).aspx\" rel=\"nofollow noreferrer\">link</a> points to a wrong content in the cells."}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "edited": false, "score": 0, "creation_date": 1475614375, "post_id": 39860495, "comment_id": 67011033, "body": "Yeah, this is the exact opposite of what <code>Select Case</code> is for. I can&#39;t say for certain, but I suspect it&#39;s the Case statement itself that&#39;s throwing the error. It&#39;s expecting a Boolean expression and it&#39;s getting a series of ranges."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475611727, "post_id": 39860846, "comment_id": 67009744, "body": "I would test if target intersects with the rIssues range, just to avoid looping when any cell is changed.  That is, I assume the OP has this in a WorkSheet_Change Event.  Also make sure EnableEvents is returned to True."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475612239, "post_id": 39860846, "comment_id": 67009973, "body": "@ScottCraner I&#39;m assuming this is part of a Worksheet_Change Event, also assuming the intersection and all other related parts are there as and working fine as the question affirms it fails only when using autofill in the case select, so it seems all other parts (we just don&#39;t know how what it is) are well covered. Thanks for the input..."}, {"owner": {"reputation": 3, "user_id": 6762630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60c2e8889e6b7f0f0a7d2fef9f05c0b1?s=128&d=identicon&r=PG", "display_name": "Heath", "link": "https://stackoverflow.com/users/6762630/heath"}, "edited": false, "score": 0, "creation_date": 1475612252, "post_id": 39860846, "comment_id": 67009984, "body": "EEM solved my issue! Also, thanks for the advice Scott. EnableEvents returns to true at the end of the sub."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1475611444, "creation_date": 1475611444, "answer_id": 39860846, "question_id": 39860495, "link": "https://stackoverflow.com/questions/39860495/what-is-causing-this-run-time-error-13-type-mis-match/39860846#39860846", "title": "What is causing this Run-time Error 13 &quot;Type Mis-Match&quot;?", "body": "<p>Try this:</p>\n\n<pre><code>Dim rIssues As Range\nDim rCll As Range\n    Set rIssues = Range(\"F15,F19,F23,F27,F30,F39,F42,F45,F50,F53,F54\")\n    For Each rCll In rIssues\n        If rCll.Value = \"Yes\" Then Issues = 1 + Issues\n    Next\n\n    If Issues &gt; 1 Then\n        Application.EnableEvents = False\n        MsgBox \"Issues Management has already been selected under another old solution category.\", _\n            vbCritical, \"Duplicate Use Case Selected\"\n        Range(Target.Address).Value = \"\"\n     End If\n</code></pre>\n\n<p>Suggest to read the following pages:</p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264596.aspx\" rel=\"nofollow\">For Each...Next Statement</a>,  </p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/gg278665.aspx\" rel=\"nofollow\">Select Case Statement</a></p>\n"}], "owner": {"reputation": 3, "user_id": 6762630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60c2e8889e6b7f0f0a7d2fef9f05c0b1?s=128&d=identicon&r=PG", "display_name": "Heath", "link": "https://stackoverflow.com/users/6762630/heath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 39860846, "answer_count": 1, "score": 0, "last_activity_date": 1475614807, "creation_date": 1475610080, "last_edit_date": 1531161705, "question_id": 39860495, "link": "https://stackoverflow.com/questions/39860495/what-is-causing-this-run-time-error-13-type-mis-match", "title": "What is causing this Run-time Error 13 &quot;Type Mis-Match&quot;?", "body": "<p>The code below increments a variable based upon which cells contain \"Yes\". It works just until I use auto-fill to set the value for any of the cells in F13:F59 to \"Yes\". When I type in the word \"Yes\" manually, the run-time error does not occur. However auto-fill, seems to be causing the issue. </p>\n\n<pre><code>Select Case (changedcell)\n'Issues Mgmt\nCase Range(\"F15\"), Range(\"F19\"), Range(\"F23\"), Range(\"F27\"), Range(\"F30\"), Range(\"F39\"), Range(\"F42\"), Range(\"F45\"), Range(\"F50\"), Range(\"F53\"), Range(\"F54\") 'Issues\n      If Range(\"F15\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F19\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F23\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F27\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F30\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F39\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F42\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F45\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F50\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F53\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n      If Range(\"F54\").Value = \"Yes\" Then\n        issues = issues + 1\n      End If\n\n      If issues &gt; 1 Then\n    Application.EnableEvents = False\n        MsgBox \"Issues Management has already been selected under another old solution category.\", vbCritical, \"Duplicate Use Case Selected\"\n        Range(target.Address).Value = \"\"\n     End If\nEnd Select\n</code></pre>\n\n<p>This first part of the code is where the error occurs. Any thoughts?</p>\n\n<pre><code>Case Range(\"F15\"), Range(\"F19\"), Range(\"F23\"), Range(\"F27\"), Range(\"F30\"), Range(\"F39\"), Range(\"F42\"), Range(\"F45\"), Range(\"F50\"), Range(\"F53\"), Range(\"F54\") 'Issues\n</code></pre>\n"}, {"tags": ["ms-access", "combobox", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1475617893, "post_id": 39860150, "comment_id": 67012713, "body": "Define your LogArray as an array of strings:  <code>Dim LogArray() as String</code>"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1475657019, "creation_date": 1475657019, "answer_id": 39869260, "question_id": 39860150, "link": "https://stackoverflow.com/questions/39860150/split-the-contents-of-combobox/39869260#39869260", "title": "Split the contents of Combobox", "body": "<p>I find it simpler to use a Variant:</p>\n\n<pre><code>Dim LogArray As Variant\n\nIf AreaCB.Value &lt;&gt; \"No Changes Needed\" Then\n    LogArray = Split(Me!Bay1CB.Value, \",\")\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1484322801, "creation_date": 1484322801, "answer_id": 41638510, "question_id": 39860150, "link": "https://stackoverflow.com/questions/39860150/split-the-contents-of-combobox/41638510#41638510", "title": "Split the contents of Combobox", "body": "<p>Should be pretty simple.</p>\n\n<pre><code>ComboBox1.Items.AddRange(ini.ReadValue(\"Schools\", \"Schools\").Split(\",\").ToArray)\n</code></pre>\n\n<p>Etc...</p>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594640659, "creation_date": 1475608817, "last_edit_date": 1594640659, "question_id": 39860150, "link": "https://stackoverflow.com/questions/39860150/split-the-contents-of-combobox", "title": "Split the contents of Combobox", "body": "<p>I have a combobox the allow for multiple entries that are delimited with comas.</p>\n\n<p>Trying to split those values into an array.  Using the following:</p>\n\n<pre><code>Dim LogArray As String\n   If AreaCB.Value &lt;&gt; \"No Changes Needed\" Then\n   LogArray = Split(Me.Bay1CB.Value, \",\")\n   End If\n</code></pre>\n\n<p>If statement bombs with type mismatch. I Tried all kinds of combinations, to no avail.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475613167, "post_id": 39859929, "comment_id": 67010451, "body": "Look into R1C1 formulas and change the third criterion in the Index formula into that format."}, {"owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475665512, "post_id": 39859929, "comment_id": 67031081, "body": "The formula works just right, the thing i&#39;m having trouble is with autofill"}, {"owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475668283, "post_id": 39859929, "comment_id": 67032963, "body": "I managed to Autofill right but only on the active cell, what can i change to make it autofill on every variable? <code>lngLastColumn = Cells.Find(What:=&quot;*&quot;, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column</code>  <code>Range(ActiveCell, Cells(ActiveCell.Row, lngLastColumn)).FillRight</code>"}, {"owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475669491, "post_id": 39859929, "comment_id": 67033764, "body": "I did it, used <code>Cells(Cells(i, 3)</code> as a variation on <code>ActiveCell</code>"}], "owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475608055, "creation_date": 1475607977, "last_edit_date": 1475608055, "question_id": 39859929, "link": "https://stackoverflow.com/questions/39859929/autofill-right-index-match-with-column-variation", "title": "AutoFill Right Index Match with column variation", "body": "<p>The below code applies a formula  every 7th row, and i would like it to AutoFill Right until the last column -1 (Because the last column has a SUM).</p>\n\n<pre><code>Sub test5()\n\n'Prv. Cheg\n\nDim ShtPlan     As Worksheet\nDim ActSht      As Worksheet\nDim lastRow     As Long\nDim sheetName   As String\nDim lookupFrom  As String\nDim myRange     As String\nDim myRange2    As String\nDim i           As Long\n\n\nSet ActSht = Sheets(\"Plan1\")\nlastRow = ActSht.Cells(ActSht.Rows.Count, 2).End(xlUp).Row ' Checks last row with data\n\nsheetName = 'mysheet\nSet ShtPlan = Sheets(\"Plan1\")\n\nmyRange = \"'\" &amp; sheetName &amp; \"'!$A:$P\"\nmyRange2 = \"'\" &amp; sheetName &amp; \"'!$A:$A\"\n\nFor i = 5 To lastRow Step 7\n    lookupFrom = ActSht.Cells(i - 3, 1).Address\n    Cells(i, 3).Formula = \"=INDEX(\" &amp; myRange &amp; \",\" &amp; \"MATCH\" &amp; \"(\" &amp; lookupFrom &amp; \",\" &amp; myRange2 &amp; \",\" &amp; \"0)+3\" &amp; \",\" &amp; \"COLUMN(A1)+3)\"\n'The formula COLUMN (A1) changes the result accordingly.\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1475607337, "post_id": 39859665, "comment_id": 67007418, "body": "<code>ThisWorkbook.SaveAs</code> &gt;&gt; <code>ActiveWorkbook.SaveAs</code>  In Excel VBA <code>ThisWorkbook</code> is the workbook in which the code is running"}, {"owner": {"reputation": 103, "user_id": 5190428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3y5Qr.jpg?s=128&g=1", "display_name": "Brett Nelson", "link": "https://stackoverflow.com/users/5190428/brett-nelson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1475607535, "post_id": 39859665, "comment_id": 67007517, "body": "Thank you didn&#39;t think there was a different but I see it now"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1475609510, "post_id": 39859665, "comment_id": 67008627, "body": "Also be aware that your logic may be a bit off - if there is no file with the name specified in cell A1 (i.e. &quot;String1&quot;) existing in the C:\\String1 directory, the user will be asked whether they wish to save the file there, thus creating the file C:\\String1\\String1.xlsx.  But if a file called C:\\String1\\String1 already exists (which, admittedly, is unlikely as usually files will have an extension), the workbook will be saved back to the location it was opened from, which might be D:\\NonString2\\Variable3.xlsx."}, {"owner": {"reputation": 103, "user_id": 5190428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3y5Qr.jpg?s=128&g=1", "display_name": "Brett Nelson", "link": "https://stackoverflow.com/users/5190428/brett-nelson"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1475614215, "post_id": 39859665, "comment_id": 67010958, "body": "@YowE3K my logic was if the the cell = this its part of a form - if a part of the form check if the file exist with the name - if no ask to be saved - if not just save the file but I&#39;m a fairly new to VBA so don&#39;t bust my chops too hard :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1475614787, "post_id": 39859665, "comment_id": 67011234, "body": "Also, I just noticed that you are using <code>Len(FPath &amp; &quot;\\&quot; &amp; FName) = 0</code> - that statement will always evaluate to <code>False</code> because the <code>&quot;\\&quot;</code> which is part of the string whose length is being tested will ensure that the length is always at least one character.  I&#39;m used to statements such as <code>Len(Dir(FPath &amp; &quot;\\&quot; &amp; FName)) = 0</code> (which tests to see whether the file exists) and just automatically read that instead of what was actually coded.  I suspect that what I <b>thought</b> it said is what you intended to code."}, {"owner": {"reputation": 103, "user_id": 5190428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3y5Qr.jpg?s=128&g=1", "display_name": "Brett Nelson", "link": "https://stackoverflow.com/users/5190428/brett-nelson"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1475615154, "post_id": 39859665, "comment_id": 67011390, "body": "@YowE3K would &quot;If Len(fullName) = 0 Then&quot; solve that issue"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1475616083, "post_id": 39859665, "comment_id": 67011849, "body": "Using <code>If Len(Dir(fullName)) = 0 Then</code> would test for the existence of a file with the path/filename of <code>fullname</code>, so that would be an improvement, but it still leaves you with the issues I mentioned in my first comment.  Does A1 contain a filename (e.g. &quot;xyz.xlsx&quot;) or just the base part (e.g. &quot;xyz&quot;)?  If it is the full filename, then <code>Len(Dir(fullName)) = 0</code> will be OK, but if it is just the base part you will need to use something like <code>Len(Dir(fullname &amp; &quot;.*&quot;)) = 0</code>.  (That will still leave you with the problem of saving to the original location rather than replacing an existing file.)"}, {"owner": {"reputation": 103, "user_id": 5190428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3y5Qr.jpg?s=128&g=1", "display_name": "Brett Nelson", "link": "https://stackoverflow.com/users/5190428/brett-nelson"}, "edited": false, "score": 0, "creation_date": 1475616839, "post_id": 39859665, "comment_id": 67012235, "body": "The cell only contains a partial name and I didn&#39;t include it in the question but I use Formatfile:=56 for the older version of excel (.xls) so if I say FName =.rng.Text &amp; &quot;.xls&quot; this would include the extension of what to look for - would this work?"}, {"owner": {"reputation": 103, "user_id": 5190428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3y5Qr.jpg?s=128&g=1", "display_name": "Brett Nelson", "link": "https://stackoverflow.com/users/5190428/brett-nelson"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1475693365, "post_id": 39859665, "comment_id": 67049966, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/125025/discussion-between-brett-nelson-and-yowe3k\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1475607527, "creation_date": 1475607527, "answer_id": 39859815, "question_id": 39859665, "link": "https://stackoverflow.com/questions/39859665/excel-personal-xlsb-saving-document-macro/39859815#39859815", "title": "Excel Personal.xlsb saving document Macro", "body": "<p><code>ThisWorkbook</code> refers to the workbook where the code resides. Presumably, the code being in the Personal.xlsb, that is why it's saving the XLSB file and not the activeworkbook.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>Dim FName           As String\nDim FPath           As String\nDim fullName As String\nDim rng As Range\nDim s as String\ns = \"String1\"\nWith ActiveWorkbook\n    Set rng = .Sheets(\"Sheet1\").Range(\"A1\")\n    If rng.Value = s Then\n        FPath = \"C:\\\" &amp; s\n        FName = rng.Text\n        fullName = FPath &amp; \"\\\" &amp; FName\n        If Len(fullName) = 0 Then \n            If MsgBox(\"Do you want to Save File As: \" &amp; FName &amp; \"?\", vbYesNo + vbQuestion, \"Microsoft Excel\") = vbYes Then\n                .SaveAs Filename:=fullName\n            End If\n        Else\n            .Save\n        End If\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 5190428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3y5Qr.jpg?s=128&g=1", "display_name": "Brett Nelson", "link": "https://stackoverflow.com/users/5190428/brett-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 39859815, "answer_count": 1, "score": 0, "last_activity_date": 1475607527, "creation_date": 1475607020, "question_id": 39859665, "link": "https://stackoverflow.com/questions/39859665/excel-personal-xlsb-saving-document-macro", "title": "Excel Personal.xlsb saving document Macro", "body": "<p>I have a macro to see if a cell contains this string if so executes a \"save as\" command with this set name standard. When I try to run the macro the if statements seem to not work. When I go through step by step it hits the if statements but saves the personal.xlsb instead of the file I'm working on. Here the code I know I have something wrong with it</p>\n\n<pre><code>Dim FName           As String\nDim FPath           As String\nDim answer          As Integer\nIf ActiveWorkbook.Sheets(\"Sheet1\").Range(\"A1\") = \"String1\" Then\n    FPath = \"C:\\String1\"\n    FName = Sheets(\"Sheet1\").Range(\"A1\").Text\n    If Len(FPath &amp; \"\\\" &amp; FName) = 0 Then \n        answer = MsgBox(\"Do you want to Save File As: \" &amp; FName &amp; \"?\", vbYesNo + vbQuestion, \"Microsoft Excel\")\n        If answer = vbYes Then\n            ThisWorkbook.SaveAs Filename:=FPath &amp; \"\\\" &amp; FName\n        End If\n    Else\n        ThisWorkbook.Save\n    End If\nEnd If\n</code></pre>\n\n<p>I am open to suggestion the most I was is to check if the file contains a string if so verify it does not already exist and if so just save instead of save as.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1475608410, "post_id": 39859487, "comment_id": 67007980, "body": "you need to use an update statement such as: CurrentDb.Execute &quot;UPDATE TableName SET FieldName = -1 WHERE &lt;Record to update condition&gt;&quot;"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1475610186, "post_id": 39859487, "comment_id": 67008998, "body": "While it might be possible to bind a form to two tables at once using a query that joins the two and uses the DISTINCT keyword, you&#39;re probably better off using @Sorceri&#39;s suggestion to directly update that single field directly in the other table with SQL based on your criteria."}, {"owner": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475613497, "post_id": 39859487, "comment_id": 67010613, "body": "I like this approach a lot since I use Oracle, but I am getting a compile error saying end of statement expected. I tried it with the quote in front of UPDATE and without. Is there any syntax missing in what you gave me?  I really want it to work!"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1475621792, "post_id": 39859487, "comment_id": 67014054, "body": "I would update your question with what you are using so we can see it."}, {"owner": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475625303, "post_id": 39859487, "comment_id": 67014899, "body": "I am using Access 2013... not MySQL. Is that what you mean?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1475677573, "post_id": 39859487, "comment_id": 67039952, "body": "no, I mean show us your update statement that is causing the error.  So after my suggestion what change did you make?"}, {"owner": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475688224, "post_id": 39859487, "comment_id": 67047054, "body": "Sorry... just wanted to answer you properly. So I have updated it above. I tried it half a dozen ways. I would love for this way to work, because I am comfy with Oracle queries. I hope you can help me get it to work!"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1475688852, "post_id": 39859487, "comment_id": 67047424, "body": "Are you changing 1 record  or all records in the ProjectCompletion table that have an ID in the Project table?"}, {"owner": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475695614, "post_id": 39859487, "comment_id": 67051232, "body": "There is a save and a delete button for each record. I am able to save or delete the one record with a macro, so I know the buttons are acting on the one record they are supposed to act upon. Yes... only one record is saved or deleted at a time."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475701105, "post_id": 39882973, "comment_id": 67054116, "body": "You are right that it the save button is in a form (subform). I did it exactly the way you described. No compile error, but the box still has no check in it. I tried adding the right hand side of &quot;=&quot; back in front of Me.CurrentRecord just to try it, but again get a compile error. With the way you explained it, how does it know which field is the foreign key?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475701952, "post_id": 39882973, "comment_id": 67054470, "body": "@985hunter CurrentRecord points to the current record # of the form, if these do not correspond to your record IDs then we need to get the record ID.   Can you show the macro for deleting and saving as this may help to determine how to obtain the correct Record ID."}, {"owner": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475703978, "post_id": 39882973, "comment_id": 67055341, "body": "I&#39;ve added it in my question. I appreciate the help you are giving me!"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475705594, "post_id": 39882973, "comment_id": 67055900, "body": "@985hunter  I have updated the example to look at the recordset of the form and get the ProjectID"}, {"owner": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475708951, "post_id": 39882973, "comment_id": 67056865, "body": "I really appreciate your patience! Your code is working!  Yay!  I have another problem now where I am not getting focus within another subform, so I need to work on that next. Thank you again for your help!"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "edited": false, "score": 0, "creation_date": 1475763643, "post_id": 39882973, "comment_id": 67082513, "body": "@985hunter  don&#39;t forget to mark the question as answered."}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 0, "last_activity_date": 1475705568, "last_edit_date": 1475705568, "creation_date": 1475698769, "answer_id": 39882973, "question_id": 39859487, "link": "https://stackoverflow.com/questions/39859487/use-vba-to-set-checkbox-in-table-not-form/39882973#39882973", "title": "Use VBA to set checkbox in table not form", "body": "<p>ok, so I am guessing this is a form module.  The problem is that it has no clue what record you are looking to update so you need to use the CurrentRecord property</p>\n\n<pre><code>CurrentDb.Execute \"UPDATE ProjectCompletion SET [ProjectCompletion].[Done] = -1 WHERE [ProjectCompletion].[ProjectCompID] = \" &amp; Me.Recordset.Fields(\"ProjectID\").Value\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6901855, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a3c5bf9e41e016c12789375b7d85784?s=128&d=identicon&r=PG&f=1", "display_name": "985ranch", "link": "https://stackoverflow.com/users/6901855/985ranch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 39882973, "answer_count": 1, "score": 0, "last_activity_date": 1594641279, "creation_date": 1475606377, "last_edit_date": 1594641279, "question_id": 39859487, "link": "https://stackoverflow.com/questions/39859487/use-vba-to-set-checkbox-in-table-not-form", "title": "Use VBA to set checkbox in table not form", "body": "<p>In the code for a <code>SAVE</code> button, I want to save the record, and mark a checkbox in a specific table which is not the same table as the one where I am saving a record. It's basically like a checklist table to indicate something has been done. I know -1 represents a check mark so I have tried:</p>\n\n<pre><code>Me.tblProjectCompletion.Done = -1\n</code></pre>\n\n<p>and I have tried it without the <code>Me</code>.</p>\n\n<p>I also tried putting it into a form first to save it into a table but that caused other problems. If I can save the check mark in the table I want for the projectID  it would be best, so I have also tried:</p>\n\n<pre><code>if ProjectCompletion.ProjectCompID = Project.ProjectID then tblProjectCompletion.Done = -1\n</code></pre>\n\n<p>But code like that is not working either.  Any suggestions?</p>\n\n<pre><code>Currentdb.Execute\nUpdate ProjectCompletion\nSet [ProjectCompletion].[Done] = -1\nWHERE [ProjectCompletion].[ProjectCompID] = [Project].[ProjectID]\n</code></pre>\n\n<p>I've tried this code with and without brackets and quotes, and a semicolon at the end. With this pattern it stops on Execute and says <code>argument not optional</code>. The following code works. I just need to add the checking of the check box.</p>\n\n<pre><code>Private Sub Save_Record_Click()\nDoCmd.RunCommand acCmdSaveRecord\nIf Me.Dirty Then\nMe.Dirty = False\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475606293, "post_id": 39859365, "comment_id": 67006823, "body": "Real quick suggestion: See how you put the worksheet before you used <code>ListObjects</code>? Do that every time you use <code>Range()</code>, <code>Cells()</code>, <code>Rows.Count</code>, etc. That will tell VBA which sheet to get that info from. Otherwise, it&#39;s using the <code>ActiveSheet</code>, and that may produce unexpected results."}, {"owner": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475607299, "post_id": 39859365, "comment_id": 67007400, "body": "@BruceWayne  ^^ Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475614561, "post_id": 39861301, "comment_id": 67011125, "body": "Thank you. I tried using this and it is properly adding a row to the table and starting data input in the first column, but subsequent iterations continue to add the data in the first column, next available row. I have 40 cells defined in <code>dataRange</code> and I need each one to go into the next column after the one before it."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475617178, "post_id": 39861301, "comment_id": 67012392, "body": "OK, that&#39;s new information.  So you want to only add one new row, and insert all data into that row?  See update"}, {"owner": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475618455, "post_id": 39861301, "comment_id": 67012907, "body": "Thanks, Chris. I was trying to work that out ever since you posted and this update helps. It is still throwing me an &quot;Application-defined or object-defined error&quot; at <code>TableRange.Cells(1, i) = Sheets(&quot;FORM&quot;).Range(c)</code> though."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475619203, "post_id": 39861301, "comment_id": 67013177, "body": "Based on your code <code>= Sheets(&quot;FORM&quot;).Range(c)</code> I&#39;m guessing <code>dataRange</code> is a list of addresses on sheet <code>FROM</code>.  Is that correct?  If the value of <code>c</code> is not a valid address (eg <code>C10&#39;) that will cause an error.  can you post (edit your Q) some sample data for both </code>recordsTable` and <code>dataRange</code>"}, {"owner": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475619774, "post_id": 39861301, "comment_id": 67013364, "body": "Q updated, as requested. Hopefully it&#39;s what you were looking for."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475620070, "post_id": 39861301, "comment_id": 67013457, "body": "Looks like what I expected.  Possible cause of the error: maybe there is an issue in <code>dataRange</code>, I assume it&#39;s a Named Range - maybe its extending beyond the data so <code>c</code> is getting a blank? What&#39;s the value of <code>c</code> when you get the error?"}, {"owner": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475620306, "post_id": 39861301, "comment_id": 67013519, "body": "When I mouse over <code>TableRange.Cells(1, i)</code> it shows that section as throwing the error. The value of <code>c</code> is showing as <code>J6</code>. I just checked to verify that <code>&quot;dataRange&quot;</code> is a defined range that only includes the 40 cells defining where on <code>&quot;FORM&quot;</code> I need to get data from."}, {"owner": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475620717, "post_id": 39861301, "comment_id": 67013671, "body": "I did not copy paste so I did not have the typo in my code. Mine says <code>Set lo = Worksheets((&quot;Records&quot;).ListObjects(&quot;RecordsTable&quot;)</code>. I don&#39;t think that was the problem."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475620718, "post_id": 39861301, "comment_id": 67013672, "body": "Ok, just realised <code>i</code> should be initialised to <code>1</code> (dumb error on my part, sorry, post updated)"}, {"owner": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475620884, "post_id": 39861301, "comment_id": 67013740, "body": "I got it, Chris. Iterations in a range are &quot;1&quot; based, not &quot;0&quot; based. I needed to start <code>i = 1</code> not <code>i = 0</code>. It works perfectly now. Thank you so much, Chris - I really appreciate your putting up with my lack of knowledge in this."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "edited": false, "score": 0, "creation_date": 1475621009, "post_id": 39861301, "comment_id": 67013783, "body": "No problem, glad to help.  See latest update to make use of column labels in <code>dataRange</code>"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1475620919, "last_edit_date": 1475620919, "creation_date": 1475613362, "answer_id": 39861301, "question_id": 39859365, "link": "https://stackoverflow.com/questions/39859365/excel-vba-how-to-find-first-empty-row-within-a-table-for-a-loop-routine/39861301#39861301", "title": "Excel VBA: How to find first empty row within a Table for a Loop routine?", "body": "<p>Assuming you really have a Table, adding data to a Table (ListObject) using it's properties and methods:</p>\n\n<pre><code>Sub Demo()\n    Dim lo As ListObject\n    Dim c As Range\n\n    Set lo = Worksheets(\"Records\").ListObjects(\"RecordsTable\")\n\n    For Each c In Sheets(\"V\").Range(\"dataRange\")\n        If Not lo.InsertRowRange Is Nothing Then\n            lo.InsertRowRange.Cells(1, 1) = Sheets(\"FORM\").Range(c)\n        Else\n            lo.ListRows.Add.Range.Cells(1, 1) = Sheets(\"FORM\").Range(c)\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Note: looping a range on sheet <code>V</code> and using that as a pointer to data on sheet <code>FORM</code>, copied from your answer - I'm assuming you know what you are doing here </p>\n\n<p>Based on OP comment, adding data a single new row</p>\n\n<pre><code>Sub Demo()\n    Dim lo As ListObject\n    Dim c As Range, TableRange As Range\n    Dim i As Long\n\n    Set lo = Worksheetsheets(\"Records\").ListObjects(\"RecordsTable\")\n\n    If Not lo.InsertRowRange Is Nothing Then\n        Set TableRange = lo.InsertRowRange\n    Else\n        Set TableRange = lo.ListRows.Add.Range\n    End If\n    i = 1\n    For Each c In Sheets(\"V\").Range(\"dataRange\")\n        TableRange.Cells(1, i) = Sheets(\"FORM\").Range(c)\n        i = i + 1\n    Next\nEnd Sub\n</code></pre>\n\n<p>Note, this assumes that the order of the table columns is the same as the order of <code>dataRange</code>.  It may be better to include table field names in <code>dataRange</code> to avoid any mismatch issues</p>\n\n<p>As mentioned in updated OP, if column labels are in the next column, replace the <code>For</code> loop with this (and add <code>Dim r as Range, col as long</code> to declarations)</p>\n\n<pre><code>    For Each c In Sheets(\"V\").Range(\"dataRange\")\n        If Not c = vbNullString Then\n            Set r = Worksheets(\"FORM\").Range(c.Value)\n            col = lo.ListColumns(c.Offset(, 1).Value).Index\n            TableRange.Cells(1, col) = r.Value\n        End If\n    Next\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6890538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NqOIKW492WM/AAAAAAAAAAI/AAAAAAAAAMk/MIJpTSN2biU/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6890538/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6756, "favorite_count": 0, "accepted_answer_id": 39861301, "answer_count": 1, "score": 1, "last_activity_date": 1475620919, "creation_date": 1475605858, "last_edit_date": 1475619725, "question_id": 39859365, "link": "https://stackoverflow.com/questions/39859365/excel-vba-how-to-find-first-empty-row-within-a-table-for-a-loop-routine", "title": "Excel VBA: How to find first empty row within a Table for a Loop routine?", "body": "<p>I reformatted a range of <code>Sheets(\"Records\")</code> in a workbook as a <code>Table (named \"RecordsTable\")</code> to make it easier to do <code>INDEX(MATCH,MATCH)</code> functions for generating reports.... but now I screwed up my looping routine for filling that range from the input on <code>Sheets(\"FORM\")</code>.</p>\n\n<p>It used to be:</p>\n\n<pre><code>Set r = Sheets(\"Records\").Range(A &amp; Rows.Count).End(x1Up).Offset(1, 0)\n\ni = 0\n\n   For Each c In Range(\"dataRange\")              \n   'dataRange is a list of cells to reference from the FORM input sheet\n\n   r.Offset(0, i).Value = Worksheets(\"FORM\").Range(c)\n   i = i + 1\nNext\n</code></pre>\n\n<p>However this code is now selecting the first row at the END of <code>\"RecordsTable\"</code> (row 501, as I defined 500 rows in my table) and inserting the data there.</p>\n\n<p>I tried to change it to this:</p>\n\n<pre><code>Set r = Sheets(\"Records\").ListObjects(\"RecordsTable\").DataBodyRange(\"A\" &amp; Rows.Count).End(x1Up).Offset(1, 0)\n\ni = 0\n\n   For Each c In Range(\"dataRange\")              \n\n   r.Offset(0, i).Value = Worksheets(\"FORM\").Range(c)\n   i = i + 1\nNext\n</code></pre>\n\n<p>But this code is still selecting row 501 and making that row part of <code>\"RecordsTable\"</code>.\nHow can I properly <code>Set \"r\" to =</code> the first empty row in <code>\"RecordsTable\"</code>?</p>\n\n<p>For reference, <code>Column \"A\" in \"RecordsTable\"</code> has the header <code>[INV #]</code>. Also, when I step into the <code>\"Set r = ...\"</code> line, <code>Rows.Count</code> is returning a value of 1million+ (ie, total rows on the sheet) - if I understand this correctly, I want it to return a value of 500 (ie, total rows in table) - is that correct?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p><code>\"dataRange\"</code> is a single column list of cell references (I do have them labeled in column B, as @chrisneilsen suggest:</p>\n\n<p><strong>A</strong></p>\n\n<p>J6</p>\n\n<p>Y6</p>\n\n<p>J8</p>\n\n<p>J10</p>\n\n<p>Y8</p>\n\n<p>etc.</p>\n\n<p>They are the cells on <code>Sheets(\"FORM\")</code> that I need to pull data from and populate into my table, in the order indicated in <code>\"dataRange\"</code>.</p>\n"}, {"tags": ["vba", "math"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1475605860, "post_id": 39859344, "comment_id": 67006599, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/326476/how-to-round-a-number-in-vba-to-the-nearest-5-or-10-or-x\">How to round a number in VBA to the nearest 5? (or 10 or X)</a>"}, {"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1475606174, "post_id": 39859344, "comment_id": 67006767, "body": "which is where the <code>or X</code> comes in... once you know how to round to a 10, then extending that to 100 should be trivial. and note that 599 rounding  to 500 is NOT the nearest. That&#39;s simply rounding DOWN. 599 would round 600 if you&#39;re rounding to &quot;nearest&quot;."}, {"owner": {"reputation": 21, "user_id": 6810889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26e99db7c3033236b248697cde35f065?s=128&d=identicon&r=PG&f=1", "display_name": "JustAnotherPersonYouDontKnow", "link": "https://stackoverflow.com/users/6810889/justanotherpersonyoudontknow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475606288, "post_id": 39859344, "comment_id": 67006819, "body": "@ScottCraner that did it. thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1475606306, "creation_date": 1475606306, "answer_id": 39859467, "question_id": 39859344, "link": "https://stackoverflow.com/questions/39859344/how-to-always-find-the-nearest-hundredth/39859467#39859467", "title": "How to always find the nearest hundredth?", "body": "<p>There are two ways to do this:</p>\n\n<pre><code>Round((mynum-50)/100,0)*100\n</code></pre>\n\n<p>And using the Worksheet Function:</p>\n\n<pre><code>Application.WorksheetFunction.RoundDown(mynum,-2)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6810889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26e99db7c3033236b248697cde35f065?s=128&d=identicon&r=PG&f=1", "display_name": "JustAnotherPersonYouDontKnow", "link": "https://stackoverflow.com/users/6810889/justanotherpersonyoudontknow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 39859467, "answer_count": 1, "score": 1, "last_activity_date": 1475606306, "creation_date": 1475605796, "question_id": 39859344, "link": "https://stackoverflow.com/questions/39859344/how-to-always-find-the-nearest-hundredth", "title": "How to always find the nearest hundredth?", "body": "<p>I have a number which can always change. I want to find the previous hundredth of that number. I'm only able to find the closest hundredth. Here's how I'm doing it atm:</p>\n\n<pre><code>Dim  mynum as integer \nmynum = 549\nDim tempnumber as integer\ntempnumber = Round(mynum / 100, 0) * 100 '&gt;&gt;&gt; equals 500 which is correct\n</code></pre>\n\n<p>What if mynum was 551? >> it will get 600 which i don't want, i only want 500 whether the number is 556, 588, or 599, i want the number to still be 500.</p>\n\n<p>I want it to be 599 >> 500, 799>> 700. Basically the hundredth of the current number. </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1475613127, "post_id": 39858947, "comment_id": 67010427, "body": "What have tried/started so far? have <a href=\"https://stackoverflow.com/search\">searched?</a>"}, {"owner": {"reputation": 11, "user_id": 6922466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ddfa8487343eb4cbcfcf091b46688ba?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Holden", "link": "https://stackoverflow.com/users/6922466/charles-holden"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1475615393, "post_id": 39858947, "comment_id": 67011510, "body": "I haven&#39;t tried anything. I don&#39;t really know where to start. My programming knowledge is limited at best.Also, everything I have searched only renames the file, it doesn&#39;t email it to a new recipient. Thanks,"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6922466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ddfa8487343eb4cbcfcf091b46688ba?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Holden", "link": "https://stackoverflow.com/users/6922466/charles-holden"}, "edited": false, "score": 0, "creation_date": 1475771440, "post_id": 39868174, "comment_id": 67087890, "body": "OK, I set this up in Visual Basic editor in Outlook and created a rule to tell Outlook to run this script. It only works when I am exiting the Rules and Alerts editor and check the box that says &quot;Run this rule now&quot; If I do that, it works perfectly, but it will not work automatically when an email arrives in the inbox."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 11, "user_id": 6922466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ddfa8487343eb4cbcfcf091b46688ba?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Holden", "link": "https://stackoverflow.com/users/6922466/charles-holden"}, "edited": false, "score": 0, "creation_date": 1475778117, "post_id": 39868174, "comment_id": 67091581, "body": "@CharlesHolden if it runs then there is nothing wrong with code, restart your  Outlook and see if the  <a href=\"https://support.office.com/en-us/article/Enable-or-disable-macros-in-Office-documents-7B4FDD2E-174F-47E2-9611-9EFE4F860B12?ui=en-US&amp;rs=en-US&amp;ad=US&amp;fromAR=1\" rel=\"nofollow noreferrer\">macro is allowed to run</a> also look in to <a href=\"https://support.office.com/en-us/article/Digitally-sign-your-macro-project-956E9CC8-BBF6-4365-8BFA-98505ECD1C01\" rel=\"nofollow noreferrer\">Digitally sign your macro project</a>"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1475766728, "last_edit_date": 1475766728, "creation_date": 1475653529, "answer_id": 39868174, "question_id": 39858947, "link": "https://stackoverflow.com/questions/39858947/rule-macro-to-rename-pdf-files-and-resend-to-different-recipient/39868174#39868174", "title": "Rule/Macro to rename pdf files and resend to different recipient?", "body": "<p>Set your outlook rule and call the following scrip, </p>\n\n<pre><code>Option Explicit\nPublic Sub SaveAtmts(Item As Outlook.MailItem)\n    Dim Atmt As Outlook.Attachment\n    Dim Path As String\n    Dim SaveAtmt As String\n    Dim AtmtName As String\n\n    Path = \"C:\\Temp\\\"\n    AtmtName = Item.Subject &amp; \".pdf\"\n\n    For Each Atmt In Item.Attachments\n        If Right(Atmt.FileName, 3) = \"pdf\" Then\n            SaveAtmt = Path &amp; AtmtName\n            Atmt.SaveAsFile SaveAtmt\n        End If\n    Next\n\n'   // Email the file\n    Set Item = Application.CreateItem(olMailItem)\n\n    With Item\n        .Subject = \"Subject\"\n        .body = AtmtName &amp; \" Report Attached \"\n        .To = \"0m3r@Email.com\"\n        .Attachments.Add SaveAtmt\n'        // Display msg\n'        .Display\n'        ' Or Send\n        .Send\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6922466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ddfa8487343eb4cbcfcf091b46688ba?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Holden", "link": "https://stackoverflow.com/users/6922466/charles-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 515, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593327760, "creation_date": 1475604259, "last_edit_date": 1593327760, "question_id": 39858947, "link": "https://stackoverflow.com/questions/39858947/rule-macro-to-rename-pdf-files-and-resend-to-different-recipient", "title": "Rule/Macro to rename pdf files and resend to different recipient?", "body": "<p>How do I rename a <strong><code>pdf</code></strong> attachment the same as the subject line and then email the renamed file to a different recipient. </p>\n\n<p>For instance, the email I receive will have a subject line of <strong><code>\"123456-CHM78912\"</code></strong> but the attachment <strong><code>pdf</code></strong> name will be <strong><code>\"INV-5\"</code></strong>. </p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\n    Dim objAtt As Outlook.Attachment\n    Dim saveFolder As String\n    saveFolder = \"C:\\Temp\\\"\n\n    For Each objAtt In itm.Attachments\n        objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; objAtt.DisplayName\n        Set objAtt = Nothing\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1475607136, "post_id": 39858829, "comment_id": 67007304, "body": "If you are using Late Binding it&#39;s likely the enum for wdDoNotSaveChanges isn&#39;t being found. I don&#39;t think you need to use this, just use <code>ActiveDocument.Close False</code>. Same thing for the Application, <code>Application.Quit False</code>"}, {"owner": {"reputation": 71, "user_id": 5455684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe500eef3e45ea006e98902d81fcd88?s=128&d=identicon&r=PG&f=1", "display_name": "A.J", "link": "https://stackoverflow.com/users/5455684/a-j"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1475607777, "post_id": 39858829, "comment_id": 67007652, "body": "Thanks for the quick reply!  I just tried your suggestion but unfortunately it exhibited the same behavior."}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 1, "creation_date": 1475609259, "post_id": 39858829, "comment_id": 67008466, "body": "Can you explain what the if condition should check? And can you also explain what <code>ThisDocument</code> is? It seems you run into the else-branch."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1475610698, "post_id": 39858829, "comment_id": 67009257, "body": "I can&#39;t replicate this - both code branches function as expected, both from the macro menu and in the debugger.  Is this in an event handler?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 1, "creation_date": 1475610742, "post_id": 39858829, "comment_id": 67009282, "body": "@DirkVollmar <code>ThisDocument</code> is the Word VBA object reference to the document containing the VBA code being executed.  Essentially, if there is only one document open and it&#39;s the one with the code, the sub should Quit word, otherwise it should just close the open document"}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1475610856, "post_id": 39858829, "comment_id": 67009329, "body": "@Dave: Thanks, for the explanation, but I wanted to know what <code>ThisDocument</code> is in this specific case. I wasn&#39;t very clear about that, sorry..."}, {"owner": {"reputation": 71, "user_id": 5455684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe500eef3e45ea006e98902d81fcd88?s=128&d=identicon&r=PG&f=1", "display_name": "A.J", "link": "https://stackoverflow.com/users/5455684/a-j"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475618148, "post_id": 39858829, "comment_id": 67012806, "body": "@Comintern It is tied to an ActiveX Command Button that users can click. The code behind it is named: Sub FirstSave_Click()"}, {"owner": {"reputation": 71, "user_id": 5455684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe500eef3e45ea006e98902d81fcd88?s=128&d=identicon&r=PG&f=1", "display_name": "A.J", "link": "https://stackoverflow.com/users/5455684/a-j"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1475618223, "post_id": 39858829, "comment_id": 67012829, "body": "@DirkVollmar ,@Dave summed up the logic more eloquently than I could, but to provide some extra detail, the output of my debugging to check that the code <i>should</i> be working is as follows:  <code>Document Count = 1</code> <code>ActiveDocument Name = Document1.docx</code> <code>ThisDocument Name = Document1.docx</code> <code>All conditions met</code>  Because there is only 1 document open, and because I can be assured that the 1 open document is named what I expect it should be named, it should follow the first If statement and quit the program."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1475650163, "post_id": 39858829, "comment_id": 67021686, "body": "Me too can&#39;t &quot;normally&quot; replicate that behavior. Unless I unsafely play with <code>Dim wObj  As Object &#47;Set wObj = CreateObject(&quot;word.Application&quot;)</code> adding a <code>wObj.Visible=True</code> and without properly closing it. Bottom line, if you switch off your PC and start a Word session anew, get rid of any possible <code>CreateObject</code> in any other sub or event handler  then your <code>If (Documents.count = 1) And (ActiveDocument.Name = ThisDocument.Name) Then</code> thing should properly work."}, {"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1475650445, "post_id": 39858829, "comment_id": 67021843, "body": "Just compare ThisDocument = ActiveDocument? Or at the very least use .FullName..."}], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 471269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5cad4f209518f9f6015fbb4b9c74cc?s=128&d=identicon&r=PG", "display_name": "IIsi 50MHz", "link": "https://stackoverflow.com/users/471269/iisi-50mhz"}, "is_accepted": false, "score": 0, "last_activity_date": 1564422808, "creation_date": 1564422808, "answer_id": 57259082, "question_id": 39858829, "link": "https://stackoverflow.com/questions/39858829/word-vba-application-quit-issue/57259082#57259082", "title": "Word VBA Application.Quit issue", "body": "<p>When having this issue in Excel, I found I had to tell Excel to close all documents after calling <code>Application.Quit</code>.</p>\n\n<ul>\n<li>Because Excel can retain a reference to any workbook after the workbook's window closes (workbook still present in VBA Editor, unreleased object references)\u2026</li>\n<li>Because I can't always know that my document is the first document that has been opened by this instance of Excel\u2026</li>\n<li>Because I must accept the presence of an Excel add-in that can cause workbooks to appear modified immediately after a save (due to changes to invisible worbook properties)\u2026</li>\n<li>Because my usecase requires Excel to quit\u2026</li>\n</ul>\n\n<p>Adapted for Microsoft Word:</p>\n\n<pre><code>'Actual handling of unsaved documents omitted from this answer\nIf savedAllDocuments Or UserDoesNotCare Then\n    Application.Quit wdDoNotSaveChanges\n    Dim doc As Document\n    For Each doc in Application.Documents\n        doc.Close SaveChanges:=False\n    Next doc\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 9700298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LzBBW.png?s=128&g=1", "display_name": "Traveler", "link": "https://stackoverflow.com/users/9700298/traveler"}, "is_accepted": false, "score": 0, "last_activity_date": 1592782621, "creation_date": 1592782621, "answer_id": 62505583, "question_id": 39858829, "link": "https://stackoverflow.com/questions/39858829/word-vba-application-quit-issue/62505583#62505583", "title": "Word VBA Application.Quit issue", "body": "<p>I had a simular issue with Application.Quit (quitting Word from within an Excel macro). It turned out, that it was related to the status of Application.ScreenUpdating.\nThe macro hung when in Excel ScreenUpdating was set to false, but continued correctly with:</p>\n<pre><code>Application.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5455684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe500eef3e45ea006e98902d81fcd88?s=128&d=identicon&r=PG&f=1", "display_name": "A.J", "link": "https://stackoverflow.com/users/5455684/a-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1845, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1592782621, "creation_date": 1475603824, "question_id": 39858829, "link": "https://stackoverflow.com/questions/39858829/word-vba-application-quit-issue", "title": "Word VBA Application.Quit issue", "body": "<pre><code>If (Documents.count = 1) And (ActiveDocument.Name = ThisDocument.Name) Then\n    Application.DisplayAlerts = False\n    Application.Quit (wdDoNotSaveChanges)\nElse\n    Application.DisplayAlerts = False\n    ActiveDocument.Close (wdDoNotSaveChanges)\nEnd If\n</code></pre>\n\n<p>I'm having issues with the above code, in that when the code clears that first If statement (meaning it is the only document open and the name of the document is as expected), it still won't close out of the Word Application completely.  It instead will only close the document and then leave a \"blank\" Word window open.</p>\n\n<p>I know it is clearing the first If statement because I wrote a quick check of each element to a debug file, and everything shows up as expected.  Additionally, if I step through the code it indeed moves along as it should.</p>\n\n<p>Interestingly/Frustratingly if I step through the code in debug mode and get to the section in the code for Application.Quit, it does indeed quit the entire program!  So I'm really not sure why it doesn't work when I just run the code as opposed to stepping through it.</p>\n\n<p>Have tried:</p>\n\n<p>1 - Adding an 'Exit Sub' line after Application.Quit</p>\n\n<p>2 - Setting the Word Application as an object explicitly:</p>\n\n<pre><code>Dim wObj  As Object\nSet wObj = CreateObject(\"word.Application\")\n'Application.Quit (wdDoNotSaveChanges) '\nwObj.Quit (wdDoNotSaveChanges)\nSet wObj = Nothing\n</code></pre>\n\n<p>3 - Adding a before close event:</p>\n\n<pre><code>Sub DocumentBeforeClose()\nActiveDocument.Saved = True\nEnd Sub\n</code></pre>\n\n<p>Any help would be much appreciated!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6922419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0966d05fbfaee634c176cffd66c2c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Jobinpicard", "link": "https://stackoverflow.com/users/6922419/paul-jobinpicard"}, "edited": false, "score": 0, "creation_date": 1475605867, "post_id": 39859252, "comment_id": 67006602, "body": "Hey this is great, unfortunately I need every pixel and not just ones that I click on because I need the color breakdown of the whole image. Thanks a lot though!"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 1, "user_id": 6922419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0966d05fbfaee634c176cffd66c2c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Jobinpicard", "link": "https://stackoverflow.com/users/6922419/paul-jobinpicard"}, "edited": false, "score": 0, "creation_date": 1475606338, "post_id": 39859252, "comment_id": 67006855, "body": "I can&#39;t analize the code right know, but it seems that you&#39;re getting cursor position (<code>GetCursorPos</code>) and the get the color of that position (<code>pLocation.x, pLocation.y</code>). I think you should skip that code, and make a loop that scan all the image, recording and averaging pixels colors."}], "tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": false, "score": 0, "last_activity_date": 1475605412, "creation_date": 1475605412, "answer_id": 39859252, "question_id": 39858778, "link": "https://stackoverflow.com/questions/39858778/how-to-count-and-categorize-pixels-in-a-jpeg-using-vba-in-excel/39859252#39859252", "title": "How to count and categorize pixels in a jpeg using VBA in excel?", "body": "<p>Many years ago I tried something like that. I look right now at the code, and really don't understand it properly, and have no time to reduce it to their essentials. Anyway, it might help you to get started. Paste the following code, paste an image in that sheet, and assign the macro Picture1_Click to the image. Then click on the image, and you'll get RGB of that point.</p>\n\n<pre><code>Private Declare Function GetPixel Lib \"gdi32\" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long) As Long\nPrivate Declare Function GetCursorPos Lib \"user32\" (ByRef lpPoint As POINT) As Long\nPrivate Declare Function GetWindowDC Lib \"user32\" (ByVal hwnd As Long) As Long\n\n    Dim C As Long\n    Dim R As Long\n    Dim G As Long\n    Dim B As Long\n    Dim la As Integer\n\n\nPrivate Type POINT\n    x As Long\n    y As Long\nEnd Type\nSub Picture1_Click()\n\n    Dim pLocation As POINT\n    Dim lColour, lDC As Long\n    la = la + 1\n    lDC = GetWindowDC(0)\n    Call GetCursorPos(pLocation)\n    Rprom = 0\n    For i = -5 To 5\n    For j = -5 To 5\n    lColour = GetPixel(lDC, pLocation.x + i, pLocation.y + j)\n\n    C = lColour\n    R = C Mod 256\n    G = C \\ 256 Mod 256\n    B = C \\ 65536 Mod 256\n    Rprom = Rprom + R\n    Next j\n    Next i\n    Rprom = Rprom / 121\n    getRGB2 = \"R=\" &amp; R &amp; \", G=\" &amp; G &amp; \", B=\" &amp; B\n    Range(\"a\" &amp; la + 1).Value = la\n    Range(\"b\" &amp; la + 1).Value = R\n    Range(\"c\" &amp; la + 1).Value = G\n    Range(\"d\" &amp; la + 1).Value = B\n    Range(\"e\" &amp; la + 1).Value = Rprom\n    Range(\"f\" &amp; la + 1).Value = pLocation.x\n    Range(\"g\" &amp; la + 1).Value = pLocation.y\n    ActiveSheet.Shapes.AddShape(msoShapeRectangle, pLocation.x, pLocation.y, 10, 10). _\n        Select\n    'ActiveSheet.Shapes.AddShape(msoShapeRectangle, 20, 20, 10, 10). _\n        Select\n    Selection.ShapeRange.Fill.Visible = msoTrue\n    Selection.ShapeRange.Fill.Solid\n    Selection.ShapeRange.Fill.ForeColor.SchemeColor = 10\n    Selection.ShapeRange.Fill.Transparency = 0.5\n    Selection.ShapeRange.Line.Weight = 0.75\n    Selection.ShapeRange.Line.DashStyle = msoLineSolid\n    Selection.ShapeRange.Line.Style = msoLineSingle\n    Selection.ShapeRange.Line.Transparency = 0#\n    Selection.ShapeRange.Line.Visible = msoTrue\n    Selection.ShapeRange.Line.ForeColor.SchemeColor = 10\n    Selection.ShapeRange.Line.BackColor.RGB = RGB(255, 255, 255)\n\n    Selection.Characters.Text = la\n    With Selection.Font\n        .Name = \"Arial\"\n        .FontStyle = \"Normal\"\n        .Size = 6\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ColorIndex = xlAutomatic\n    End With\n    Selection.ShapeRange.TextFrame.MarginLeft = 0#\n    Selection.ShapeRange.TextFrame.MarginRight = 0#\n    Selection.ShapeRange.TextFrame.MarginTop = 0#\n    Selection.ShapeRange.TextFrame.MarginBottom = 0#\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6922419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0966d05fbfaee634c176cffd66c2c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Jobinpicard", "link": "https://stackoverflow.com/users/6922419/paul-jobinpicard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1135, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1475605412, "creation_date": 1475603560, "question_id": 39858778, "link": "https://stackoverflow.com/questions/39858778/how-to-count-and-categorize-pixels-in-a-jpeg-using-vba-in-excel", "title": "How to count and categorize pixels in a jpeg using VBA in excel?", "body": "<p>I am looking to use excel to analyze pictures for number of pixels in images, instead of buying a software package for it. I have three ranges on the RGB spectrum that I will use to categorize each pixel. I want my program to read each pixel and see what category it falls into and output this into a cell or a msg box. I am just unfamiliar with the syntax behind this as the algorithm is fairly simple and just requires a for loop. </p>\n"}]