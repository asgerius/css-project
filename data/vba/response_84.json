[{"tags": ["vba", "ms-access", "append"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1471477417, "post_id": 39007690, "comment_id": 65367400, "body": "Simply requery the form: <code>Me.Form.Requery</code> after append queries."}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 5744754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNRWn.png?s=128&g=1", "display_name": "cChacon", "link": "https://stackoverflow.com/users/5744754/cchacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1471477199, "creation_date": 1471477199, "answer_id": 39007849, "question_id": 39007690, "link": "https://stackoverflow.com/questions/39007690/vba-issue-with-running-delete-sql-strings-append-queries/39007849#39007849", "title": "VBA issue with running &quot;delete&quot; SQL strings &amp; append queries", "body": "<p>It sounds like your form is bound to the data table.  What you should do is unbind the form before the series of queries are run and then re-bind.  Your code will look similar to this:</p>\n\n<pre><code>frmMain.DataSource = nothing\nDoCmd.SetWarnings False\nDoCmd.RunSQL \"DELETE ...\"\n... etc.\nDoCmd.SetWarnings True\nfrmMain.DataSource = \"myTable\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6618116, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154160656105239/picture?type=large", "display_name": "Farid", "link": "https://stackoverflow.com/users/6618116/farid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593958006, "creation_date": 1471476178, "last_edit_date": 1593958006, "question_id": 39007690, "link": "https://stackoverflow.com/questions/39007690/vba-issue-with-running-delete-sql-strings-append-queries", "title": "VBA issue with running &quot;delete&quot; SQL strings &amp; append queries", "body": "<p>I have this VBA code below, which runs on open of a form in MS Access. This code is meant to delete all records from several tables, and then run saved append queries (that are quite complex) to fill in those tables once again, with fresh data every time.</p>\n\n<p>The form that opens (after this code runs) is based on the last table that gets updated in the code sequence (PDSForecast), and I have confirmed that the append query for that table works and loads the correct data in.</p>\n\n<p>The issue though is, when the form based on that table is opened (which triggered this code to run in the first place), all the records show up as #Deleted for some reason, even though the append query that populates the table this form is based on is the last piece of code that runs before the form opens, and it works. Can someone help me understand what I'm doing wrong here?</p>\n\n<p>Thanks!</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n\n    DoCmd.SetWarnings False\n\n    DoCmd.RunSQL \"DELETE FROM ECIInventTransIntentDim\"\n    DoCmd.RunSQL \"DELETE FROM CurrentOH\"\n    DoCmd.RunSQL \"DELETE FROM CurrentOO\"\n    DoCmd.RunSQL \"DELETE FROM RequirementsAXAPTA\"\n    DoCmd.RunSQL \"DELETE FROM AvgWeeklyUsage\"\n    DoCmd.RunSQL \"DELETE FROM PDSForecast\"\n\n    DoCmd.OpenQuery \"Query_ECIINVENTTRANSINVENTDIM\"\n    DoCmd.OpenQuery \"Query_CURRENTOH\"\n    DoCmd.OpenQuery \"Query_CURRENTOO\"\n    DoCmd.OpenQuery \"Query_REQUIREMENTSAXAPTA\"\n    DoCmd.OpenQuery \"Query_AVGWEEKLYUSAGE\"\n    DoCmd.OpenQuery \"Query_PDSFORECAST\"\n\n    DoCmd.SetWarnings True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 77, "user_id": 5454278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9cf9897342dac86d2f0bbd712aaa54?s=128&d=identicon&r=PG&f=1", "display_name": "Info_wars", "link": "https://stackoverflow.com/users/5454278/info-wars"}, "edited": false, "score": 0, "creation_date": 1471475508, "post_id": 39007598, "comment_id": 65366891, "body": "Just upvoted u for good"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471492309, "post_id": 39008924, "comment_id": 65371041, "body": "Wow that looks good! Thank you. I&#39;m getting a subscript out of range error though, seems to be a common error with arrays within loops. Is it because the number of elements specified is wrong?  The error is specifically coming from       arr2 = Split(Trim(arr1(1)), Space(1))"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471492690, "post_id": 39008924, "comment_id": 65371138, "body": "Does one of your (non-blank) addresses have no comma?  The code is assuming that there is a comma, and therefore splitting the original into the first part (arr1(0)) and the second part (arr1(1), and it assumes the second part has at least 2 spaces (creating arr2(0), arr2(1), arr2(2) and possibly arr2(3), etc)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471492724, "post_id": 39008924, "comment_id": 65371147, "body": "I&#39;ll update the answer to bring up a msgbox if an error occurs.  Done."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471493075, "post_id": 39008924, "comment_id": 65371221, "body": "Nope every address has a comma, the address refiner pulls the address from Google which has that same standard output."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471493133, "post_id": 39008924, "comment_id": 65371242, "body": "It says there is no comma on row 2 and 3, but there is.  12 Smith St, Chatswood NSW 2067 62 Norma Rd, Myaree WA 6154"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471493336, "post_id": 39008924, "comment_id": 65371302, "body": "Hmmm - I just posted those values into D2 and D3 of a blank workbook, then ran the code, and it didn&#39;t complain.  The addresses are in column D aren&#39;t they?  (I assumed they were based on the <code>.Range(&quot;D&quot; &amp; .Rows.Count).End(xlUp).Row</code> that you had in your question.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471493433, "post_id": 39008924, "comment_id": 65371326, "body": "I&#39;ve just done another update - this time changing the MsgBox messages to display the string that it is looking at when it gets the error."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471493557, "post_id": 39008924, "comment_id": 65371366, "body": "The addresses are in C but i changed the range to C, then the split up address should go in the columns across.  [link]<a href=\"http://imgur.com/a/cADzu\" rel=\"nofollow noreferrer\">imgur.com/a/cADzu</a>"}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471493680, "post_id": 39008924, "comment_id": 65371401, "body": "Just ran your new code, it says theres no comma in Object Nodelist and google.com+=searchquery etc. It must be referencing the wrong place where the addresses are not stored."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471493684, "post_id": 39008924, "comment_id": 65371403, "body": "If the addresses are in column C, change the code to use <code>.Range(&quot;C&quot; &amp; .Rows.Count).End(xlUp).Row</code> instead of <code>.Range(&quot;D&quot; &amp; .Rows.Count).End(xlUp).Row</code>, and to use <code>strTest = .Cells(LngRow, 3).Value</code> instead of <code>strTest = .Cells(LngRow, 4).Value</code>."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471493762, "post_id": 39008924, "comment_id": 65371435, "body": "Ah yes that fixed it! Perfect! Correct answer here."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471493818, "post_id": 39008924, "comment_id": 65371451, "body": "It seems strange seeing suburbs I recognise in a question!!  (Chatswood and Epping and Mascot - and one of them is even on the good side of the harbour!)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1471493396, "last_edit_date": 1471493396, "creation_date": 1471486437, "answer_id": 39008924, "question_id": 39007598, "link": "https://stackoverflow.com/questions/39007598/running-a-string-splitting-function-in-a-loop/39008924#39008924", "title": "Running a string splitting function in a loop", "body": "<pre><code>Sub Button7_Click()\n    Dim strTest     As String\n\n    Dim arr1\n    Dim arr2\n\n    Dim StreetAddress As String\n    Dim Postcode As String\n    Dim StateCode As String\n    Dim Suburb As String\n\n    Dim LngRow As Long\n    Dim i As Integer\n\n    With ActiveSheet\n        For LngRow = 2 To .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row\n            strTest = .Cells(LngRow, 4).Value\n\n            If Len(Trim(strTest)) &gt; 0 Then\n\n                arr1 = Split(strTest, \",\")\n                If UBound(arr1) - LBound(arr1) &lt; 1 Then\n                    MsgBox \"No comma in address on row \" &amp; LngRow &amp; \" '\" &amp; strTest &amp; \"'\"\n                Else\n                    arr2 = Split(Trim(arr1(1)), Space(1))\n                    If UBound(arr2) - LBound(arr2) &lt; 2 Then\n                        MsgBox \"Only \" &amp; UBound(arr2) - LBound(arr2) &amp; \" spaces after the comma in address on row \" &amp; LngRow &amp; \" '\" &amp; strTest &amp; \"'\"\n                    Else\n\n                        StreetAddress = arr1(0)\n                        Postcode = arr2(UBound(arr2))\n                        StateCode = arr2(UBound(arr2) - 1)\n                        Suburb = \"\"\n                        For i = LBound(arr2) To UBound(arr2) - 2\n                            Suburb = Suburb &amp; \" \" &amp; arr2(i)\n                        Next\n                        .Cells(LngRow, 5).Value = Trim(StreetAddress)\n                        .Cells(LngRow, 6).Value = Trim(Suburb)\n                        .Cells(LngRow, 7).Value = Trim(StateCode)\n                        .Cells(LngRow, 8).Value = Trim(Postcode)\n                    End If\n                End If\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": false, "score": 0, "last_activity_date": 1471492306, "creation_date": 1471492306, "answer_id": 39009720, "question_id": 39007598, "link": "https://stackoverflow.com/questions/39007598/running-a-string-splitting-function-in-a-loop/39009720#39009720", "title": "Running a string splitting function in a loop", "body": "<p>Alternatively, you can use <code>Range.TextToColumns</code> method to parse a column of cells that contain text into several columns. Here I'm assuming your address data in column A and the suburb is only a single word:</p>\n\n<pre><code>Sub AddressSpliter()\nDim LastRow&amp;, iRow&amp;\nOn Error Resume Next\nApplication.DisplayAlerts = False\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor iRow = 2 To LastRow\n    Cells(iRow, 1).TextToColumns Destination:=Cells(iRow, 2), DataType:=xlDelimited, Comma:=True\n    ResetText2Columns\n    Cells(iRow, 3).TextToColumns Destination:=Cells(iRow, 3), DataType:=xlDelimited, Space:=True\n    ResetText2Columns\nNext\nApplication.DisplayAlerts = True\nEnd Sub\n\nSub ResetText2Columns()\nOn Error Resume Next\nCells(2, 1).TextToColumns Destination:=Cells(2, 1), DataType:=xlDelimited, ConsecutiveDelimiter:=False, _\n            Tab:=False, Semicolon:=False, Comma:=False, Space:=False, Other:=False, OtherChar:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 1, "accepted_answer_id": 39008924, "answer_count": 2, "score": 1, "last_activity_date": 1471493396, "creation_date": 1471475352, "question_id": 39007598, "link": "https://stackoverflow.com/questions/39007598/running-a-string-splitting-function-in-a-loop", "title": "Running a string splitting function in a loop", "body": "<p>I have an excel sheet, with a column filled with about 10 complete standard addresses with intermittent blank (nulls)</p>\n\n<p>All addresses are in the same format:</p>\n\n<p>123 Street Name, Suburb QLD 4123</p>\n\n<p>What i'm trying to do is create an automatic splitter where upon a BUtton7_Click the macro loops through the column and splits up the street name with number, suburb, state code and post code into separate columns. Thanks to a contributor here I got a good core function working which separates the address given as a static value.</p>\n\n<pre><code>Sub Button7_Click()\nDim strTest     As String\n\nDim arr1\nDim arr2\n\nDim StreetAddress As String\nDim Postcode As String\nDim StateCode As String\nDim SubUrb As String\n\n\nstrTest = \"62 Norma Rd, Myaree WA 6154\"\n\narr1 = Split(strTest, \",\")\narr2 = Split(Trim(arr1(1)), Space(1))\n\nStreetAddress = arr1(0)\nPostcode = arr2(2)\nStateCode = arr2(1)\nSubUrb = arr2(0)\n\nRange(\"E3\").Value = arr1(0)\nRange(\"F3\").Value = arr2(0)\nRange(\"G3\").Value = arr2(1)\nRange(\"H3\").Value = arr2(2)\n\n\nEnd Sub\n</code></pre>\n\n<p>The issue I'm facing is getting that to run...</p>\n\n<ol>\n<li>In a loop</li>\n<li>Independent of the column size (However I do know I need to use something like \"For LngRow = 2 To Wksht.Range(\"D\" &amp; Wksht.Rows.Count).End(xlUp).Row\"</li>\n<li>Ignoring Null values (Need to use if Len(address_string) > 0 Then exit)</li>\n<li>Using ubound for double name suburbs.</li>\n</ol>\n\n<p>I figure the best first step is to build the loop, then implement case validation, then column count and lastly ubound.</p>\n\n<p>However I tried using a loop function used in my last question but it didn't work and I have never used ubound before, can someone help me?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1471473039, "post_id": 39007189, "comment_id": 65366189, "body": "Could you please elaborate?"}], "answers": [{"tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": 1, "last_activity_date": 1471474998, "creation_date": 1471474998, "answer_id": 39007541, "question_id": 39007189, "link": "https://stackoverflow.com/questions/39007189/choose-between-multiple-value-if-true-false-options/39007541#39007541", "title": "Choose between multiple &quot;Value if true/false&quot; options", "body": "<p>No that is not possible: either a cell's value is determined by a formula, or not. You cannot have both.</p>\n\n<p>What you can do though, is use a nearby cell for that kind of choice (check the dropdown possibility via data validation). Then the <code>IFERROR</code> function could read that other cell's value when there is an error condition. If there is no error that other cell's value will obviously be ignored.</p>\n"}], "owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1471474998, "creation_date": 1471472742, "last_edit_date": 1531161705, "question_id": 39007189, "link": "https://stackoverflow.com/questions/39007189/choose-between-multiple-value-if-true-false-options", "title": "Choose between multiple &quot;Value if true/false&quot; options", "body": "<p>I have a cell which contains a certain iferror function.</p>\n\n<p>In case everything's ok - I want to get the normal output of the function.\nHowever, if there's an error (for example - #N/A), I want that cell to let me choose manuually which text I want to show in that cell - but in case there's another change in the function parameters that causes the original function to become TRUE again, I want the original function back - with its original output.</p>\n\n<p>Is it possible? </p>\n"}, {"tags": ["excel", "numbers", "sequential", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6728259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b49cabc0c7a0f5c96501d3d3c776331?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/6728259/scott"}, "edited": false, "score": 0, "creation_date": 1471476144, "post_id": 39006972, "comment_id": 65367057, "body": "Thank you - does exactly as needed so I kinda feel like an idiot asking this question. I was still digging for a formula solution and came across this. =IFERROR(INDEX(Sheet1!D:D,IF(MOD(ROW(A12),12)=0,&quot;&quot;,ROUNDUP(R&zwnj;&#8203;OW(A12)/12,0)),1),&quot;&quot;&zwnj;&#8203;) Basically, fill down with this and it parses in a similar manner.  This works except the count is fixed at a set value in the formula. I do not believe it is possible but can it be modified to read a specified value like the VBA? Again, thank you for the VBA and will use it unless I can find a formula. Scott"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 6728259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b49cabc0c7a0f5c96501d3d3c776331?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/6728259/scott"}, "edited": false, "score": 0, "creation_date": 1471482018, "post_id": 39006972, "comment_id": 65368492, "body": "I can think of a way that I <b>might</b> be able to do it just using Excel formulae, but it would take several columns, and wouldn&#39;t be pretty.  I wouldn&#39;t use such a method myself unless this was the <b>only</b> part of the process that was requiring VBA."}, {"owner": {"reputation": 1, "user_id": 6728259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b49cabc0c7a0f5c96501d3d3c776331?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/6728259/scott"}, "edited": false, "score": 0, "creation_date": 1471530630, "post_id": 39006972, "comment_id": 65392185, "body": "I agree and that is my rub. Document is numerous tabs deep with various vlookups replicating data for various groups. This set is the only one requiring a script. Concern is someone will update one of the other primary tables and not run the script to complete updates to this tab. What you provided works great and I appreciate the help. Would really like to remove the one manual update step if possible."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1471471476, "creation_date": 1471471476, "answer_id": 39006972, "question_id": 39006870, "link": "https://stackoverflow.com/questions/39006870/replicating-cells-with-addition-of-sequential-number-based-on-a-variable/39006972#39006972", "title": "Replicating cells with addition of sequential number based on a variable", "body": "<p>Untested, but should do what you want:</p>\n\n<pre><code>Dim ws1 As Worksheet\nDim ws2 As Worksheet\nDim row1 As Long\nDim row2 As Long\nDim iter As Long\nSet ws1 = Worksheets(\"Sheet1\")\nSet ws2 = Worksheets(\"Sheet2\")\nrow1 = 1\nrow2 = 1\nDo While ws1.Cells(row1, 1).Value &lt;&gt; \"\"\n    For iter = 1 to ws1.Cells(row1, 2).Value\n        ws2.Cells(row2, 1).Value = ws1.Cells(row1, 1).Value &amp; iter\n        row2 = row2 + 1\n    Next\n    row1 = row1 + 1\nLoop \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6728259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b49cabc0c7a0f5c96501d3d3c776331?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/6728259/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471477627, "creation_date": 1471470980, "last_edit_date": 1531164843, "question_id": 39006870, "link": "https://stackoverflow.com/questions/39006870/replicating-cells-with-addition-of-sequential-number-based-on-a-variable", "title": "Replicating cells with addition of sequential number based on a variable", "body": "<p>looking for some help in excel with a replication process. Would prefer to do by formula but I am pretty sure it will need to be VBA. On sheet 1 I have two columns; A has distinct names, B has a number ranging from 1 to 15. I need to create a column on sheet 2 with the name in sheet 1 column A replicated the number of time specified on sheet 1 column B. In addition, I need to add the replication count to the value being created on sheet 2.</p>\n\n<p>As an example\nSheet 1</p>\n\n<pre><code>column A, column B\nsam, 3\nsusan, 2\n</code></pre>\n\n<p>sheet 2 column a would look like</p>\n\n<pre><code>sam1\nsam2\nsam3\nsusan1\nsusan2\n</code></pre>\n\n<p>Been rummaging around the net for some time and just can\u2019t find the right combination of code. Any assistance would be appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1471470502, "post_id": 39006628, "comment_id": 65365282, "body": "This seems like a very much error-prone way of going about value comparisons. Consider treating numeric values as numeric values - their string representation on a worksheet has nothing to do with the underlying numeric value. e.g. <code>If CCur(cellValue1) = CCur(cellValue2) Then</code> will be much more reliable, and not locale-dependent."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 6668363, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d2f59c32ac2b463fdcb42a5efcfd75fd?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6668363/bob"}, "edited": false, "score": 0, "creation_date": 1471485083, "post_id": 39006771, "comment_id": 65369261, "body": "Looks like the Range(&quot;A1&quot;).Text yield the format I need. Thank you!!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 91, "user_id": 6668363, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d2f59c32ac2b463fdcb42a5efcfd75fd?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6668363/bob"}, "edited": false, "score": 0, "creation_date": 1471485425, "post_id": 39006771, "comment_id": 65369353, "body": "You may actually be better off formatting it using <code>Format(Range(&quot;A1&quot;).Value, &quot;$#,##0&quot;)</code> because, based on your question, <code>Range(&quot;A1&quot;).Text</code> will give <code>$4,250.00</code> and that won&#39;t appear in the sample string you gave in the comment to cyboashu, but specifically formatting it as &quot;$#,##0&quot; will give <code>$4,250</code> which will appear in the sample string."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1471470762, "last_edit_date": 1471470762, "creation_date": 1471470367, "answer_id": 39006771, "question_id": 39006628, "link": "https://stackoverflow.com/questions/39006628/vba-currency-to-text-conversion/39006771#39006771", "title": "VBA Currency to Text Conversion", "body": "<p>A numeric value can be formatted to currency in VBA using <code>Format(value, \"Currency\")</code>, e.g. <code>Format(Range(\"A1\").Value, \"Currency\")</code>.</p>\n\n<p>Also, the <code>.Text</code> property will return the formatted string, so <code>Range(\"A1\").Text</code> would give you a string of <code>$4,250.00</code> if cell A1 contained 4250 and was formatted in a standard currency format.</p>\n\n<p>In Excel itself, I would suggest using a formula such as <code>=TEXT(A1,\"$#,##0.00\")</code>.</p>\n"}], "owner": {"reputation": 91, "user_id": 6668363, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d2f59c32ac2b463fdcb42a5efcfd75fd?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6668363/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2329, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471472782, "creation_date": 1471469615, "question_id": 39006628, "link": "https://stackoverflow.com/questions/39006628/vba-currency-to-text-conversion", "title": "VBA Currency to Text Conversion", "body": "<p>I have a list of currency values in one WorkSheet such as $4,250.00 that I want to compare to the equivalent text/string; e.g. \"$4,250\" in another Worksheet. When I convert the currency value to text prior to the InStr comparison, I lose the \"$\" and \",\" resulting in \"4250\" which makes the comparison false. Is there a way to convert the currency value to text and not lose the format?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1471465869, "post_id": 39005624, "comment_id": 65363162, "body": "Just read MSDN: <a href=\"https://msdn.microsoft.com/en-us/library/w8k3cys2.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/w8k3cys2.aspx</a> When you ReDim with preserve then you may only change the last dimension (not the first one)."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1471465911, "post_id": 39005624, "comment_id": 65363187, "body": "You may want to look at <a href=\"http://stackoverflow.com/questions/7817427/excel-2007-vba-array-size-limit\">this too</a>"}, {"owner": {"reputation": 27, "user_id": 3143986, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1fc360ddb2b6a102c55289784a1e7b1?s=128&d=identicon&r=PG&f=1", "display_name": "Leoxanigm", "link": "https://stackoverflow.com/users/3143986/leoxanigm"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1471542224, "post_id": 39005624, "comment_id": 65399664, "body": "@Sgdva Thank you very much for the link. I installed excel 64 bit and it works perfectly now."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1471542821, "post_id": 39005624, "comment_id": 65399978, "body": "If it helped please, mark answer accepted :)"}], "answers": [{"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 0, "last_activity_date": 1471542765, "last_edit_date": 1495535630, "creation_date": 1471542765, "answer_id": 39024622, "question_id": 39005624, "link": "https://stackoverflow.com/questions/39005624/run-time-error-7-out-of-memory-when-trying-to-run-vba-code/39024622#39024622", "title": "Run Time Error &#39;7&#39;. Out of Memory when trying to run VBA code", "body": "<p><strong><em>Solution:</em></strong>\n<br>Install Excel 64 bits, Excel 32 bits can't handle that amount of memory\n<br><strong>Disclaimer</strong>\n<br>While <a href=\"https://stackoverflow.com/questions/7817427/excel-2007-vba-array-size-limit\">this question</a> basically has the same memory problem, it may be confusing what the real solution is (the one provided here). If you would like to discuss either or not this answer should be deleted, please comment below before down voting.</p>\n"}], "owner": {"reputation": 27, "user_id": 3143986, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1fc360ddb2b6a102c55289784a1e7b1?s=128&d=identicon&r=PG&f=1", "display_name": "Leoxanigm", "link": "https://stackoverflow.com/users/3143986/leoxanigm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 0, "accepted_answer_id": 39024622, "answer_count": 1, "score": 0, "last_activity_date": 1471542765, "creation_date": 1471465331, "last_edit_date": 1531164843, "question_id": 39005624, "link": "https://stackoverflow.com/questions/39005624/run-time-error-7-out-of-memory-when-trying-to-run-vba-code", "title": "Run Time Error &#39;7&#39;. Out of Memory when trying to run VBA code", "body": "<p>Basically what the code does is, it looks for duplicate values in rows and transposes the corresponding values to columns. The code works perfectly for small amount of rows. The problem is I've a lot of spreadsheets with 600,000+ rows of data. Now when I select all the data and run the code it gives me \"Run Time Error '7': Out of Memory\" error. </p>\n\n<p>The line the debugger highlights is:</p>\n\n<pre><code>ReDim Preserve xArr1(1 To UBound(xArr1, 1), 1 To xArr2(1) + t - 1)\n</code></pre>\n\n<p>And here is the whole VBA code:</p>\n\n<pre><code>Sub ConvertTable()\nUpdate 20150113\nDim xArr1 As Variant\nDim xArr2 As Variant\nDim InputRng As Range, OutRng As Range\nDim xRows As Long\nxTitleId = \"KutoolsforExcel\"\nSet InputRng = Application.Selection\nSet InputRng = Application.InputBox(\"Range :\", xTitleId, InputRng.Address, Type:=8)\nSet OutRng = Application.InputBox(\"Out put to (single cell):\", xTitleId, Type:=8)\nSet OutRng = OutRng.Range(\"A1\")\nxArr1 = InputRng.Value\nt = UBound(xArr1, 2): xRows = 1\nWith CreateObject(\"Scripting.Dictionary\")\n    .CompareMode = 1\n    For i = 2 To UBound(xArr1, 1)\n        If Not .exists(xArr1(i, 1)) Then\n            xRows = xRows + 1: .Item(xArr1(i, 1)) = VBA.Array(xRows, t)\n            For ii = 1 To t\n                xArr1(xRows, ii) = xArr1(i, ii)\n            Next\n        Else\n            xArr2 = .Item(xArr1(i, 1))\n            If UBound(xArr1, 2) &lt; xArr2(1) + t - 1 Then\n                ReDim Preserve xArr1(1 To UBound(xArr1, 1), 1 To xArr2(1) + t - 1)\n                For ii = 2 To t\n                    xArr1(1, xArr2(1) + ii - 1) = xArr1(1, ii)\n                Next\n            End If\n            For ii = 2 To t\n                xArr1(xArr2(0), xArr2(1) + ii - 1) = xArr1(i, ii)\n            Next\n            xArr2(1) = xArr2(1) + t - 1: .Item(xArr1(i, 1)) = xArr2\n        End If\n    Next\nEnd With\nOutRng.Resize(xRows, UBound(xArr1, 2)).Value = xArr1\nEnd Sub\n</code></pre>\n\n<p>Credit: I found the original VBA code from <a href=\"https://www.extendoffice.com/documents/excel/2538-excel-transpose-duplicate-row-to-columns.html#a1\" rel=\"nofollow\">here</a>.</p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["vba", "ms-publisher"], "answers": [{"tags": [], "owner": {"reputation": 963, "user_id": 1091553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b778f61a387e36d2da16466e4683b617?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/1091553/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1471523044, "creation_date": 1471523044, "answer_id": 39018154, "question_id": 39005513, "link": "https://stackoverflow.com/questions/39005513/how-can-i-set-the-background-colour-of-the-selected-cell-in-publisher/39018154#39018154", "title": "How can I set the background colour of the selected cell in publisher", "body": "<p>I now have a working version, though I am sure it is not the correct or most elegant way to achieve the goal.  </p>\n\n<p>It also currently only works if the cell itself is entirely highlighted rather than just the text within it or just the cursor being in the cell.  I may work to improve this later.</p>\n\n<p>Working code in Publisher 2016:</p>\n\n<pre><code>Sub invert_square()\n\nFor Each square In Selection.TableCellRange\n    If square.Selected = True Then\n        square.Fill.ForeColor.RGB = RGB(0, 0, 0)\n        square.TextRange.Font.Color.RGB = RGB(255, 255, 255)\n        Exit For\n    End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": 0, "last_activity_date": 1475052791, "creation_date": 1475052791, "answer_id": 39742498, "question_id": 39005513, "link": "https://stackoverflow.com/questions/39005513/how-can-i-set-the-background-colour-of-the-selected-cell-in-publisher/39742498#39742498", "title": "How can I set the background colour of the selected cell in publisher", "body": "<p>This expands your code so that it works for the entire table if the table as a whole is selected (selection type pbSelectionShape and shape type pbTable) and for the entire cell if the selection is of type pbSelectionText.</p>\n\n<p>The trick for the latter functionality is that the .ContainingObject refers to the entire Shape, and that every Table Shape consists of one Story object. The .Start and .End properties of a TextRange object refer to its position within it's Story object. By comparing these two properties, we are able to identify which cell the selected text belongs to (it is not possible in Publisher to simultaneously select a little bit of text in several different cells).</p>\n\n<p>Before I figured out this approach, I tried to call .Parent until TypeName() would equal \"Cell\", but this wouldn't work because the .Parent for Selection.TextRange is Selection (and not the Parent in the document itself as I had hoped)</p>\n\n<pre><code>Option Explicit\n\nSub InvertSquare()\n    ActiveDocument.BeginCustomUndoAction \"Invert square\"\n\n    Dim oCell As Cell\n    Dim oShape As Shape\n\n    If selection.Type = pbSelectionTableCells Then\n        Debug.Print \"Table cells\"\n\n        For Each oCell In selection.TableCellRange\n            SetInvertedColors oCell\n        Next oCell\n\n    ElseIf selection.Type = pbSelectionText Then\n        Debug.Print \"Text\"\n\n        Dim selText As TextRange\n        Dim x As Variant\n\n        Set selText = selection.TextRange\n        Set x = selText.ContainingObject\n\n        If TypeName(x) = \"Shape\" Then\n            If x.Type = pbTable Then\n                For Each oCell In x.Table.Cells\n                    If oCell.HasText Then\n                        If oCell.TextRange.Start &lt;= selText.Start Then\n                            If oCell.TextRange.End &gt;= selText.End Then\n                                SetInvertedColors oCell\n                                Exit For\n                            End If\n                        End If\n                    End If\n\n                Next oCell\n            End If\n        End If\n\n    ElseIf selection.Type = pbSelectionShape Then\n        Debug.Print \"ShapeRange\"\n\n        Dim oShapes As ShapeRange\n\n        Set oShapes = selection.ShapeRange\n        For Each oShape In oShapes\n            If oShape.Type = pbTable Then\n                For Each oCell In selection.TableCellRange\n                    SetInvertedColors oCell\n                Next oCell\n                Exit For\n            End If\n        Next oShape\n        Debug.Print \"Shape\"\n    End If\n\n    ActiveDocument.BeginCustomUndoAction \"Invert square\"\nEnd Sub\n\n\nSub SetInvertedColors(oCell As Cell)\n    Debug.Print oCell.TextRange.Text\n    oCell.TextRange.Font.Color = RGB(255, 255, 255)\n    ''oCell.Fill.ForeColor.RGB = RGB(0, 0, 0) ''Out of memory error for whatever reason\nEnd Sub\n</code></pre>\n\n<p>For some reason, I get an out of memory error when I try to set the .ForeColor.RGB in Publisher, but this happens with your code for me too, so I'm hoping that it works for you anyway if you uncomment the second last line.</p>\n"}], "owner": {"reputation": 963, "user_id": 1091553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b778f61a387e36d2da16466e4683b617?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/1091553/rory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 39018154, "answer_count": 2, "score": 1, "last_activity_date": 1475052791, "creation_date": 1471464922, "last_edit_date": 1471516376, "question_id": 39005513, "link": "https://stackoverflow.com/questions/39005513/how-can-i-set-the-background-colour-of-the-selected-cell-in-publisher", "title": "How can I set the background colour of the selected cell in publisher", "body": "<p>I'm trying to create a macro that sets the font colour of text in a cell to white and the cell background to black using VBA in Publisher.</p>\n\n<p>So far I have managed to set up the font colour to change but I'm really struggling with the background - I can't find the right value to change.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>Sub set_to_clue()\n\nSelection.TextRange.Font.Color.RGB = RGB(255, 255, 255)\nSelection.TextRange.Font.Fill.BackColor.RGB = RGB(0, 0, 0)\n\nEnd Sub\n</code></pre>\n\n<p><strong>Progress</strong>\nWith a bit of further trial and error I have worked out how to get cell backgrounds to change, however currently I can only do it by specifying an item number for the <code>CellRange</code>.  This means that the cell that changes colour is hard coded rather than the selected one.  How can I calculate the item number?</p>\n\n<pre><code>Sub set_to_clue()\n\nSelection.TextRange.Font.Color.RGB = RGB(255, 255, 255)\nSelection.TableCellRange.Item(10).Fill.ForeColor.RGB = RGB(0, 255, 0)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3263, "user_id": 3706778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IpRV8.png?s=128&g=1", "display_name": "Major", "link": "https://stackoverflow.com/users/3706778/major"}, "edited": false, "score": 1, "creation_date": 1596466423, "post_id": 39006609, "comment_id": 111812689, "body": "It sort of works however if NumLock is not set then F2 does not work :) Also F2 messes up NumLock... IT IS HORRIBLE.... <a href=\"https://www.mrexcel.com/board/threads/vba-sendkeys-f2-and-numlock-issue.922779/\" rel=\"nofollow noreferrer\">mrexcel.com/board/threads/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 3, "last_activity_date": 1578020441, "last_edit_date": 1578020441, "creation_date": 1471469532, "answer_id": 39006609, "question_id": 39005459, "link": "https://stackoverflow.com/questions/39005459/go-to-cell-edit-mode-and-select-all-cell-text-with-vba/39006609#39006609", "title": "Go to cell edit mode and select all cell text with VBA", "body": "<p>Sadly, there is no way to catch this event. Your only way to go is \"sending keys,\" and since all of them have to be pressed at the same time, this is the best workaround -to my knowledge- that you can do: either use <a href=\"http://www.exceltrick.com/formulas_macros/vba-wait-and-sleep-functions/\" rel=\"nofollow noreferrer\">sleep or wait</a> function.</p>\n\n<pre><code>Application.SendKeys (\"{F2}{HOME}\")\nApplication.Wait Now + TimeValue(\"00:00:01\")\nApplication.SendKeys (\"+{END}\")\n</code></pre>\n\n<p><strong><em>Explanation</em></strong>\n<br> Sending keys relies on the processor speed, so it will always be variable. Even if the code is well written, you have to consider some time to let it \"press\" -virtually- all the keys at the same time.</p>\n"}], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3003, "favorite_count": 1, "accepted_answer_id": 39006609, "answer_count": 1, "score": 3, "last_activity_date": 1578020441, "creation_date": 1471464742, "last_edit_date": 1531164843, "question_id": 39005459, "link": "https://stackoverflow.com/questions/39005459/go-to-cell-edit-mode-and-select-all-cell-text-with-vba", "title": "Go to cell edit mode and select all cell text with VBA", "body": "<p>I am wrote a macro that checks for changes to certain cells.  If the new value in a cell doesn't meet certain criteria, it enters the cell in edit mode and selects all text in that cell using keyboard shortcuts:</p>\n\n<pre><code>Application.SendKeys (\"{HOME}+{END}\")\n</code></pre>\n\n<p>This always enters edit mode, but often fails to select the text.  I'm looking for something more reliable.  Any ideas?</p>\n\n<p>Here's the entire macro:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n' -------------------------------\n' Only run the macro if a single cell is selected\n    If Target.Cells.CountLarge &gt; 1 Then Exit Sub\n\n' -------------------------------\n' Declare variables\n    Dim cell As Range\n    Dim AccountToFind As String\n\n' -------------------------------\n' Assign values to shared variables\n    AccountToFind = Target.Value\n\n' -------------------------------\n' Validate change in HEADER, column D\n    If Not Intersect(Target, Target.Worksheet.Range(\"D:D\")) Is Nothing And Target.Value &lt;&gt; \"\" Then\n\n        For Each cell In Sheets(\"_coding references\").Range(\"AccountsPayable[NAME]\")\n            If cell.Value = AccountToFind Then Exit Sub  ' passed validation\n        Next cell\n\n        Target.Select\n\n        MsgBox (\"'\" &amp; AccountToFind &amp; \"'\" &amp; vbNewLine &amp; vbNewLine &amp; \"This is not a listed A/P account!\")\n\n' --------------------------------------------------------------\n' --------------------------------------------------------------\n' HERE'S THE PROBLEMATIC CODE\n' --------------------------------------------------------------\n            Application.SendKeys (\"{F2}{HOME}+{END}\")\n' --------------------------------------------------------------\n' --------------------------------------------------------------\n' --------------------------------------------------------------\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "stored-procedures"], "comments": [{"owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "edited": false, "score": 0, "creation_date": 1471468645, "post_id": 39005232, "comment_id": 65364489, "body": "Do you simply want to know the row(s) exists?  Or do you want to look at the column values for the (possibly) returned row(s)?"}], "answers": [{"tags": [], "owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1471468250, "last_edit_date": 1471468250, "creation_date": 1471464040, "answer_id": 39005285, "question_id": 39005232, "link": "https://stackoverflow.com/questions/39005232/vba-got-to-check-record-set-eof-using-a-stored-procedure/39005285#39005285", "title": "VBA: Got to check record set EOF using a stored procedure", "body": "<pre><code>declare @PID varchar(24)\nselect @PID = 'abc'\n\nif exists ( SELECT * FROM commerce_product WHERE pf_id = @PID )\nBEGIN\n    Select 'it exists'\nEND\nELSE\nBEGIN\n    Select 'it does not exist'\nEND\n</code></pre>\n\n<p>=========APPEND</p>\n\n<pre><code>CREATE PROCEDURE dbo.RecordsExist\n( @PID varchar(24)\n ,@MyOutValue bit OUTPUT)\nAS\n\nif exists ( SELECT * FROM commerce_product WHERE pf_id = @PID )\nBEGIN\n    Select @MyOutValue = 1\nEND\nELSE\nBEGIN\n    Select @MyOutValue = 1\nEND\n\nRETURN\n\nGO\n</code></pre>\n\n<p>...</p>\n\n<p>Test it in TSQL Land</p>\n\n<pre><code>DECLARE @PID varchar(24)\n       ,@MyOutValue         int\nSET @PID='abc'\nEXEC dbo.RecordsExist @PID, @MyOutValue OUTPUT\nPRINT @MyOutValue \n</code></pre>\n\n<hr>\n\n<p>Then follow this article to wire up your ADODB call... to get an output parameter</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/kb/194792\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/194792</a></p>\n\n<p>But something like this:</p>\n\n<pre><code>Set cnn = New adodb.Connection\ncnn.ConnectionString = \"MyConnectionString\"\n\ncnn.Open cnn.ConnectionString\n\nSet cmd = New adodb.Command\ncmd.ActiveConnection = cnn\ncmd.CommandType = adCmdStoredProc\ncmd.CommandText = \"dbo.RecordsExist\"\n\n\nSet param1 = cmd.CreateParameter\n               (\"@PID\", adChar, adParamInput, 1, \"abc\")\ncmd.Parameters.Append param1\n\nSet param2 = cmd.CreateParameter\n               (\"@MyOutValue\", adBit, adParamOutput, , adParamReturnValue)\ncmd.Parameters.Append param2\n\nrs.CursorType = adOpenStatic\nrs.CursorLocation = adUseClient\nrs.LockType = adLockOptimistic\nrs.Open cmd\n\n\nSet myResult = cmd.Parameters(\"MyOutValue\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1471468457, "last_edit_date": 1471468457, "creation_date": 1471468148, "answer_id": 39006320, "question_id": 39005232, "link": "https://stackoverflow.com/questions/39005232/vba-got-to-check-record-set-eof-using-a-stored-procedure/39006320#39006320", "title": "VBA: Got to check record set EOF using a stored procedure", "body": "<p>First create the procedure:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>create procedure dbo.DoSomething @id int\nbegin\n    select * from dbo.commerce_product where pf_id = @id\nend\n</code></pre>\n\n<p>Then modify your VBA code to run a parameterized <code>Command</code>; instead of \"opening a recordset\", you <code>Execute</code> the command and <em>get</em> a recordset:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim adoConnection As New ADODB.Connection\nadoConnection.ConnectionString = \"connection string\"\nadoConnection.Open\n\nDim cmd As New ADODB.Command\ncmd.ActiveConnection = adoConnection\ncmd.CommandType = adCmdStoredProc\ncmd.CommandText = \"DoSomething\" ' the name of the stored procedure\n\nDim param As New ADODB.Parameter\nparam.Type = adInteger\nparam.Direction = adParamInput\nparam.Value = 42 'the ID value\ncmd.Parameters.Append param\n\nDim result As ADODB.Recordset\nSet result = cmd.Execute\n</code></pre>\n\n<p>From there it's the same <em>iterating a recordset</em> story (notice the <code>BOF</code> check - <code>BOF</code> will be <code>True</code> if there are no records):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>While Not result.BOF And Not result.EOF\n    'will loop as long as there are records\n    result.MoveNext\nWend\n</code></pre>\n\n<p>And don't forget to close both your recordset and the connection when you're done:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>result.Close\nadoconnection.Close\n</code></pre>\n"}], "owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 39006320, "answer_count": 2, "score": 0, "last_activity_date": 1471468457, "creation_date": 1471463841, "question_id": 39005232, "link": "https://stackoverflow.com/questions/39005232/vba-got-to-check-record-set-eof-using-a-stored-procedure", "title": "VBA: Got to check record set EOF using a stored procedure", "body": "<p>I apologize in advance if the title of my question is not accurate enough. </p>\n\n<p>I would like to know how to convert a statement such as:</p>\n\n<pre><code>ADORS.Open \"SELECT * FROM commerce_product WHERE pf_id = '\" &amp; PID &amp; \"'\", , adOpenStatic, adLockReadOnly\n\nIf ADORS.EOF Then\n    ' Do this\nElse\n    ' Do that\nEnd If\n</code></pre>\n\n<p>Rather than have the SQL query in the VBA code, I would like to call a stored procedure in SQL Server. </p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping", "html-lists"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471463579, "post_id": 39005111, "comment_id": 65361971, "body": "<code>getElementByValue</code> is what ?  What happens when you run that code?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1471464580, "post_id": 39005111, "comment_id": 65362496, "body": "Try  ObjPage.Document.getElementByID(&quot;consultant_ti&quot;).getElements&zwnj;&#8203;ByTagName(&quot;a&quot;)(0).Cl&zwnj;&#8203;ick. This should click the item."}, {"owner": {"reputation": 21, "user_id": 5458071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf8d3076bc2a4eac3075d3e65ca8686?s=128&d=identicon&r=PG&f=1", "display_name": "Strategorm", "link": "https://stackoverflow.com/users/5458071/strategorm"}, "edited": false, "score": 0, "creation_date": 1471464613, "post_id": 39005111, "comment_id": 65362514, "body": "That has been used as well as getElementByID and it will run to the Operation Completed prompt, but will not activate the tab."}, {"owner": {"reputation": 21, "user_id": 5458071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf8d3076bc2a4eac3075d3e65ca8686?s=128&d=identicon&r=PG&f=1", "display_name": "Strategorm", "link": "https://stackoverflow.com/users/5458071/strategorm"}, "edited": false, "score": 0, "creation_date": 1471464903, "post_id": 39005111, "comment_id": 65362661, "body": "It worked with a FireEvent! Thank you! Function FnConsultantView(ObjPage)     With ObjPage         .getElementById (&quot;consultant_ti&quot;)         .getElementsByTagName(&quot;a&quot;)(0).FireEvent (&quot;onclick&quot;)     End With     MsgBox (&quot;Operation Completed&quot;)"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1471464965, "post_id": 39005111, "comment_id": 65362690, "body": "You want to process the click event. The FireEvent responds to the event (Click) happening first."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472370781, "post_id": 39005111, "comment_id": 65718908, "body": "@RyanWildry seems you may post your comment as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5458071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf8d3076bc2a4eac3075d3e65ca8686?s=128&d=identicon&r=PG&f=1", "display_name": "Strategorm", "link": "https://stackoverflow.com/users/5458071/strategorm"}, "is_accepted": false, "score": 0, "last_activity_date": 1507540818, "last_edit_date": 1507540818, "creation_date": 1472668886, "answer_id": 39256817, "question_id": 39005111, "link": "https://stackoverflow.com/questions/39005111/excel-web-scraping-fireevent-on-ul-list-item/39256817#39256817", "title": "Excel Web Scraping - fireEvent on ul list item", "body": "<p>It worked with a FireEvent. </p>\n\n<pre><code>Function FnConsultantView(ObjPage) \nWith ObjPage .getElementById (\"consultant_ti\") .getElementsByTagName(\"a\")(0).FireEvent (\"onclick\") \nEnd With MsgBox (\"Operation Completed\")\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5458071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf8d3076bc2a4eac3075d3e65ca8686?s=128&d=identicon&r=PG&f=1", "display_name": "Strategorm", "link": "https://stackoverflow.com/users/5458071/strategorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1507540818, "creation_date": 1471463329, "last_edit_date": 1495535624, "question_id": 39005111, "link": "https://stackoverflow.com/questions/39005111/excel-web-scraping-fireevent-on-ul-list-item", "title": "Excel Web Scraping - fireEvent on ul list item", "body": "<p>Thank you in advance for any assistance that can be offered. I am trying to activate a link with Excel VBA to change the view of the data presented by a dashboard. I have managed to perform the login and navigation process and believe that the scraping element will run smoothly after this step. I don't believe that I am targeting the right elements or am not structuring the VBA sequence correctly.</p>\n\n<p>I am attempting to trigger the 'consultant view' within the HTML below:</p>\n\n<pre><code>&lt;div style=\"width:100%; clear:both\"&gt;\n    &lt;ul class=\"tab_menu clearfix\" style=\"padding-top:5px;\"&gt;\n        &lt;li id=\"site_ti\" class=\"table_tab_item\"&gt;\n            &lt;a href=\"#\" onclick=\"update_table_tab('site'); return false;\"&gt;By Site&lt;/a&gt;\n        &lt;/li&gt;\n        &lt;li id=\"director_ti\" class=\"table_tab_item\"&gt;\n            &lt;a href=\"#\" onclick=\"update_table_tab('director'); return false;\"&gt;By Director&lt;/a&gt;\n        &lt;/li&gt;\n        &lt;li id=\"team_lead_ti\" class=\"table_tab_item\"&gt;\n            &lt;a href=\"#\" onclick=\"update_table_tab('team_lead'); return false;\"&gt;By Team Manager&lt;/a&gt;\n        &lt;/li&gt;\n        &lt;li id=\"consultant_ti\" class=\"table_tab_item\"&gt;\n            &lt;a href=\"#\" onclick=\"update_table_tab('consultant'); return false;\"&gt;By Consultant&lt;/a&gt;\n        &lt;/li&gt;\n    &lt;/ul&gt;\n</code></pre>\n\n<p>I have thusfar used the following routines with no result:</p>\n\n<p>These are the declarations at the beginning of the Public Sub:</p>\n\n<pre><code>Public Sub Huddle_Report_Scrape(ObjIE)\nDim ie As SHDocVw.InternetExplorer\nDim doc As MSHTML.HTMLDocument 'If you have a reference to the HTML Object Library\nDim objShell, obj, objInputs, objButtons As Object\n\nDim htmldoc As MSHTML.IHTMLDocument 'Document object\n\nDim tbl As MSHTML.IHTMLElementCollection\nDim eleColtr As MSHTML.IHTMLElementCollection 'Element collection for tr tags\nDim eleColtd As MSHTML.IHTMLElementCollection 'Element collection for td tags\n\nDim eleRow As MSHTML.IHTMLElement 'Row elements\nDim eleCol As MSHTML.IHTMLElement 'Column elements\n\nDim Table As MSHTML.HTMLTable\nDim row As MSHTML.HTMLTableRow\nDim cell As MSHTML.HTMLTableCell\nDim col As MSHTML.HTMLTableCol    \n</code></pre>\n\n<p>Below is the function I am calling to trigger the consultant view.</p>\n\n<pre><code>Function FnConsultantView(ObjPage)\nWith ObjPage\n\nSet li = .getElementByValue(\"consultant\")\n    With li\n        .Focus\n        .FireEvent \"onclick\"\n    End With\nEnd With\nMsgBox (\"Operation Completed\")\n</code></pre>\n\n<p>I have also attempted to use elements from the following post without much luck: <a href=\"https://stackoverflow.com/questions/31955265/fireevent-and-ie11\">FireEvent and IE11</a></p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1471464208, "post_id": 39005105, "comment_id": 65362311, "body": "Your error message re a failed connection is actually being generated if you can&#39;t create the ADODB.Connection <b>object</b>, not if it can&#39;t connect to the database.  Move the <code>con.Open</code> statement before you do the test to see if it could be opened, and then let us know if you get a &quot;Failed database connection&quot; message."}, {"owner": {"reputation": 1180, "user_id": 2132230, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/247c0ea21dcbf6fd84c5e21a34cb0b18?s=128&d=identicon&r=PG", "display_name": "Sanya", "link": "https://stackoverflow.com/users/2132230/sanya"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1471464785, "post_id": 39005105, "comment_id": 65362595, "body": "Good catch. And no, the error was not generated. Thank you for catching that though."}], "answers": [{"comments": [{"owner": {"reputation": 1180, "user_id": 2132230, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/247c0ea21dcbf6fd84c5e21a34cb0b18?s=128&d=identicon&r=PG", "display_name": "Sanya", "link": "https://stackoverflow.com/users/2132230/sanya"}, "edited": false, "score": 0, "creation_date": 1471464738, "post_id": 39005318, "comment_id": 65362572, "body": "You are right. And what&#39;s weird is that i used to use the &quot;%&quot; but in Access 2010, the wildcard is actually the asterisk &quot;*&quot;. I wonder why they are so different"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 2, "last_activity_date": 1471464168, "last_edit_date": 1495540295, "creation_date": 1471464168, "answer_id": 39005318, "question_id": 39005105, "link": "https://stackoverflow.com/questions/39005105/excel-vba-sql-from-access-no-results/39005318#39005318", "title": "Excel VBA SQL from Access no results", "body": "<p>I think I know why this is happening. The wildcard in Access is <code>*</code>, but for most other variants of SQL it is <code>%</code>. You are using ADO here. See <a href=\"https://stackoverflow.com/questions/25634506/like-operator-works-in-ms-access-but-not-ado\">this</a></p>\n\n<p>Try this instead:</p>\n\n<p><code>keyStr = \"%\" &amp; searchStr &amp; \"%\" 'Not sure if you need the extra \"'s either</code></p>\n"}], "owner": {"reputation": 1180, "user_id": 2132230, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/247c0ea21dcbf6fd84c5e21a34cb0b18?s=128&d=identicon&r=PG", "display_name": "Sanya", "link": "https://stackoverflow.com/users/2132230/sanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "accepted_answer_id": 39005318, "answer_count": 1, "score": 0, "last_activity_date": 1593958014, "creation_date": 1471463297, "last_edit_date": 1593958014, "question_id": 39005105, "link": "https://stackoverflow.com/questions/39005105/excel-vba-sql-from-access-no-results", "title": "Excel VBA SQL from Access no results", "body": "<p>Using Excel 2010 to query an Access 2010 Database (via UserForms). </p>\n\n<p>When I execute the code, I get my Message Box \"No Results\" (called near the end of the sub). However, there should be 12 records that pull up when I enter in a certain search string. </p>\n\n<p>I thought maybe my SQL string was incorrect so I wrote the SQL statement to Sheet1 Cell A2. I then opened up my Access Database, created a SQL query, and copy/pasted the SQL statement from cell A2 - It worked perfectly. --> So it's not the SQL statement.</p>\n\n<p>Why is my code not finding the data? The SQL statement works fine. I'm not getting any errors when I try to establish an ADODB connection.</p>\n\n<p><strong>EDIT</strong>: <em>I use the exact same database connection setup in another sub and it works fine.</em></p>\n\n<pre><code>Private Sub searchAllInJobs(searchStr As String)\n    Dim con As Object, rs As Object, accessFile As String, strTable As String, sql As String, keyStr As String, i As Integer\n\n    accessFile = \"******************\"  '&lt;--hidden on purpose\n\n    Set con = CreateObject(\"ADODB.connection\")\n\n    If Err.Number &lt;&gt; 0 Then\n        MsgBox \"Failed database connection\", vbCritical, \"Connection Error\"\n    Exit Sub\n    End If\n\n    On Error GoTo 0\n\n    con.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; accessFile\n\n    'Wild card string\n    keyStr = \"\"\"*\" &amp; searchStr &amp; \"*\"\"\"\n\n   'I have tested this SQL statement in the Access database and works great\n    sql = \"SELECT * FROM tbl_job_tables WHERE ([MODELNO] LIKE \" &amp; keyStr &amp; \");\"\n    'Write the SQL to a cell, to make sure the statement was constructed properly\n    Sheets(\"Sheet1\").Range(\"A2\").value = sql\n\n    Set rs = CreateObject(\"ADODB.Recordset\")\n\n    'Open the database recordset from the SQL statement\n    rs.Open sql, con\n\n    'Clear the current ListBox\n    Me.list_SearchJobs.Clear\n\n    i = 0\n\n    If Not (rs.EOF and rs.BOF) Then\n        'Move to the first item\n        rs.MoveFirst\n\n        'While going through the records, if you haven't reached the End-of-file then...\n         Do While Not rs.EOF\n\n            With Me.list_SearchJobs\n               .AddItem\n                   .List(i, 0) = rs!JOB_NUM\n                   .List(i, 1) = rs!customer\n                   .List(i, 2) = rs!MODELNO\n                   .List(i, 3) = rs!CREATE_DATE\n            End With\n            i = i + 1\n            rs.MoveNext\n         Loop\n\n         'Close the recordset and database connection\n         rs.Close\n         con.Close\n\n         'Set the objects to \"Nothing\" (clears the cache)\n         Set rs = Nothing\n         Set con = Nothing\n\n    Else\n        'Close the recordset and database connection\n        rs.Close\n        con.Close\n\n        'Set the objects to \"Nothing\" (clears the cache)\n        Set rs = Nothing\n        Set con = Nothing\n\n        MsgBox \"No Results\", vbCritical, \"No results\"\n    Exit Sub\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1471465861, "post_id": 39004932, "comment_id": 65363157, "body": "Which line is the error on?"}], "answers": [{"tags": [], "owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "is_accepted": false, "score": 0, "last_activity_date": 1471471699, "creation_date": 1471471699, "answer_id": 39007010, "question_id": 39004932, "link": "https://stackoverflow.com/questions/39004932/implementing-wait-until-element-available-in-excel-vba/39007010#39007010", "title": "Implementing wait until element available in Excel-VBA", "body": "<p>You are getting an error because the HTML document has not fully loaded. In your do loop add this:</p>\n\n<pre><code>Do Until IE.ReadyState = READYSTATE_COMPLETE\n    DoEvents\nLoop\nSet html = IE.Document\n</code></pre>\n\n<p>only after you properly reference the loaded object will it make sense to:</p>\n\n<pre><code>Set testObject = html.getElementById(\"j_username\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4374019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SlSSyC1KDfU/AAAAAAAAAAI/AAAAAAAAADY/NgAONZEKUyk/photo.jpg?sz=128", "display_name": "Narendra kumar varma", "link": "https://stackoverflow.com/users/4374019/narendra-kumar-varma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 684, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1502790828, "creation_date": 1471462631, "last_edit_date": 1531164843, "question_id": 39004932, "link": "https://stackoverflow.com/questions/39004932/implementing-wait-until-element-available-in-excel-vba", "title": "Implementing wait until element available in Excel-VBA", "body": "<p>I tried implementing to wait until the element is available (Found in Stackoverflow itself) but getting error:</p>\n\n<blockquote>\n  <p>Run-time error '-2147467259 (80004005)':<br>Automation error<br>Unspecified error</p>\n</blockquote>\n\n<p>Following is the code snippet:</p>\n\n<pre><code>Do\n    Set testObject = Nothing\n    On Error Resume Next\n    Set testObject = html.getElementById(\"j_username\")\n    On Error GoTo 0\n    DoEvents\nLoop While testObject Is Nothing\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2204315"}, "edited": false, "score": 0, "creation_date": 1471509665, "post_id": 39006068, "comment_id": 65377967, "body": "Thanks. I don&#39;t use macros, just vba. I&#39;ll do some wider exploration of what&#39;s going on."}], "tags": [], "owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1471467124, "creation_date": 1471467124, "answer_id": 39006068, "question_id": 39004879, "link": "https://stackoverflow.com/questions/39004879/control-dropdown-doesn-t-work/39006068#39006068", "title": "Control.Dropdown doesn\u2019t work", "body": "<p>Its hard to tell what's going on from what you've described, but if you're seeing it momentarily, it sounds like you might have a conflict in your code somewhere.  Do you have any macros or expression builder events in place?  If so, there's a possibility of conflicting between these events and your VBA code.  </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2204315"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594655350, "creation_date": 1471462403, "last_edit_date": 1594655350, "question_id": 39004879, "link": "https://stackoverflow.com/questions/39004879/control-dropdown-doesn-t-work", "title": "Control.Dropdown doesn\u2019t work", "body": "<p>I have a form with a combo box cboListPeople. The GotFocus event is cboListPeople.Dropdown.  For a fraction of a second I think I can see the dropdown but it immediately closes. Focus remains with cboListPeople and when clicked, the dropdown appears as expected. I have tried loading the form at another control thus:</p>\n\n<pre><code>Private Sub Form_Load()\n\nMe.Role.LimitToList = True\nDoCmd.GoToControl \u201cOfficerLookup\u201d\ncboListPeople.SetFocus\n\nEnd Sub\n</code></pre>\n\n<p>The result is the same problem as initially outlined above.</p>\n"}, {"tags": ["excel", "vba", "import", "chat", "whatsapp"], "comments": [{"owner": {"reputation": 67, "user_id": 6725947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8525286acf76fb8c00cdfd9fa957533f?s=128&d=identicon&r=PG&f=1", "display_name": "hey", "link": "https://stackoverflow.com/users/6725947/hey"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1471464056, "post_id": 39004770, "comment_id": 65362233, "body": "David, thanks anyway. It&#39;s my first posting, if that matters. Yes, I have code I have trouble making work the way I want, see the edit above. And yes, I&#39;d like some free code, and some free words of wisdom, but only to push me in the right direction. And I&#39;d appreciate it if you could grant me some."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1471464197, "post_id": 39004770, "comment_id": 65362308, "body": "I would try reading the text using the <code>FileSystemObject</code>. Looks like you could parse based on the <code>23.05.16</code> format at the beginning of each line."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1471469723, "post_id": 39004770, "comment_id": 65364966, "body": "@hey thanks for editing to include your code -- I have a suggestion that I posted below. If your file is funky in terms of line breaks, we can add some additional logic to handle those.  Let&#39;s see how it works."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 6725947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8525286acf76fb8c00cdfd9fa957533f?s=128&d=identicon&r=PG&f=1", "display_name": "hey", "link": "https://stackoverflow.com/users/6725947/hey"}, "edited": false, "score": 0, "creation_date": 1471541883, "post_id": 39006638, "comment_id": 65399465, "body": "David, thanks for your input, but the code you suggested doesn&#39;t seem to do the job. I will edit my post above to include a screenshot of the resulting column."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 67, "user_id": 6725947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8525286acf76fb8c00cdfd9fa957533f?s=128&d=identicon&r=PG&f=1", "display_name": "hey", "link": "https://stackoverflow.com/users/6725947/hey"}, "edited": false, "score": 0, "creation_date": 1471541954, "post_id": 39006638, "comment_id": 65399520, "body": "Can you also edit your post to include <i>actual text input instead of screenshot</i>?"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1471541988, "last_edit_date": 1471541988, "creation_date": 1471469651, "answer_id": 39006638, "question_id": 39004770, "link": "https://stackoverflow.com/questions/39004770/excel-vba-troube-importing-whatsapp-chat-history-files-into-an-excel-sheet/39006638#39006638", "title": "Excel VBA - Troube importing WhatsApp chat history files into an Excel sheet", "body": "<p>OK, so since the OpenText method isn't working for you, let's start with something like this which uses the built-in I/O methods (<a href=\"https://msdn.microsoft.com/en-us/library/office/gg264163.aspx\" rel=\"nofollow\">Open</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264130.aspx\" rel=\"nofollow\">Line Input</a>) for reading files, it should be faster than <code>FileSystemObject</code> and since you're dealing with the raw text/data, you will have more flexibility than just using the <code>Workbooks.OpenText</code>.</p>\n\n<p>If your text file is mangled (as it seems to be in the screenshots you've provided) we may need to add some conditional logic to identify when each \"line\" starts, but to get started, let's see how this works.</p>\n\n<p>It will begin writing each line in Column A, at Row 1 and then sequentially to rows 2+ for each successive line.</p>\n\n<pre><code>Option Explicit\nSub f()\nDim ChatFileNm\nDim FF As Long\nDim destination As Range\nDim ctr As Long\nDim ln$\n\nChatFileNm = Application.GetOpenFilename(FileFilter:=\"Text Files (*.txt), &gt;*.txt\", Title:=\"Select Chat File To Be Opened\")\nIf ChatFileNm = False Then Exit Sub\nSet destination = Range(\"A1\")\nFF = FreeFile\nOpen ChatFileNm For Input As FF\nDo Until EOF(FF)\n    Line Input #FF, ln\n    'Write the line in to the destination\n    destination.Offset(ctr).Value = ln\n    'Increment the counter\n    ctr = ctr + 1\nLoop\n'Release the lock on the file\nClose FF\n\nEnd Sub\n</code></pre>\n\n<p>Alternatively, build the entire text string from the file, and use the <code>Split</code> function with <code>Chr(10)</code> as your delimiter:</p>\n\n<pre><code>Option Explicit\nSub f()\nDim ChatFileNm\nDim FF As Long\nDim destination As Range\nDim ln$, txt$\n\nChatFileNm = Application.GetOpenFilename(FileFilter:=\"Text Files (*.txt), &gt;*.txt\", Title:=\"Select Chat File To Be Opened\")\nIf ChatFileNm = False Then Exit Sub\nSet destination = Range(\"A1\")\nFF = FreeFile\nOpen ChatFileNm For Input As FF\nDo Until EOF(FF)\n    Line Input #FF, ln\n    'Write the line in to the destination\n    txt = txt &amp; ln\nLoop\n'Release the lock on the file\nClose FF\n\n'Write to the sheet:\nDim lines\nlines = Split(txt, Chr(10))\nRange(\"A1\").Resize(Ubound(lines)+1).Value = Application.Transpose(lines)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6725947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8525286acf76fb8c00cdfd9fa957533f?s=128&d=identicon&r=PG&f=1", "display_name": "hey", "link": "https://stackoverflow.com/users/6725947/hey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1592, "favorite_count": 1, "accepted_answer_id": 39006638, "answer_count": 1, "score": 0, "last_activity_date": 1471542111, "creation_date": 1471462046, "last_edit_date": 1471542111, "question_id": 39004770, "link": "https://stackoverflow.com/questions/39004770/excel-vba-troube-importing-whatsapp-chat-history-files-into-an-excel-sheet", "title": "Excel VBA - Troube importing WhatsApp chat history files into an Excel sheet", "body": "<p>Here is what a typical WhatsApp history chat file (.txt) looks like if opened in Notepad. </p>\n\n<p><a href=\"https://i.stack.imgur.com/TMIgm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TMIgm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note that there are 4 messages in the example, each starting with a date/time stamp &amp; username. \nAlso, there're characters present that mark the end of every message (and seem to be Chr(10) to me).</p>\n\n<p>What's more, the 3rd message (the to-buy list) consists of multiple lines, which in WhatsApp chat is achieved by hitting the Enter key.</p>\n\n<p>My goal is to import the data above into an Excel sheet so as each of the four messages ends up in a row of its own, like below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WSPAU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WSPAU.jpg\" alt=\"Desired result.xls\"></a></p>\n\n<p>So far, I've been trying and failing miserably using the Workbook.OpenText method. The problem is that the multiple lines of the to-buy list end up in separate rows rather than being treated as a whole message.</p>\n\n<p>I need a quick and elegant solution, too, as I'll need to process huge chat files with thousands of messages. \nSo, of course, I could loop through and merge lines based on whether they have  date/time/username stamps, but that takes a whole lot of time on a big file.</p>\n\n<p><strong>EDIT:</strong> Please, find below the code that I'm using at the moment to import the .txt files. I was not <em>demanding</em> an elegant solution, sorry if it came out like that. I just meant I would love for it to be elegant eventually, just need a clue or two, or more.</p>\n\n<pre><code>Sub ImportTXT ()\n\nChatFileNm = Application.GetOpenFilename(FileFilter:=\"Text Files (*.txt), &gt;*.txt\", Title:=\"Select Chat File To Be Opened\")\n\nIf ChatFileNm = False Then Exit Sub\n\nSourceSheet = FSO.GetBaseName(ChatFileNm)\n\nWorkbooks.OpenText filename:= _\n        ChatFileNm, _\n        Origin:=65001, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _\n        xlTextQualifierNone, ConsecutiveDelimiter:=False, _ \n        Tab:=False,&gt;Semicolon:=False, _\n        Comma:=False, Space:=False, FieldInfo:=Array(Array(1, 1), _\n        Array(2, 1)), DecimalSeparator:=\".\", ThousandsSeparator:=\",\", _\n        TrailingMinusNumbers:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1471462561, "post_id": 39004674, "comment_id": 65361412, "body": "Protip: try to <a href=\"https://stackoverflow.com/posts/39004674/edit\">edit</a> your title so that someone having a similar problem would type it in a Google search box and find your question (and its answers!). As it stands, this title applies to virtually every single VBA question ever asked on this site."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 2, "creation_date": 1471463151, "post_id": 39004674, "comment_id": 65361721, "body": "The <code>BeforeUpdate</code> event is called before an update is made to an existing record that is loaded in the form. However you said after <i>insert</i> an amount is it a new record or an already existing one?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1471505365, "post_id": 39004674, "comment_id": 65375634, "body": "Move the code to the <i>AfterUpdate</i> event."}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "is_accepted": true, "score": 1, "last_activity_date": 1475675028, "last_edit_date": 1475675028, "creation_date": 1471516466, "answer_id": 39015969, "question_id": 39004674, "link": "https://stackoverflow.com/questions/39004674/why-vba-code-for-enable-disable-buttons-doesnt-work/39015969#39015969", "title": "Why VBA Code for Enable/Disable Buttons doesn&#39;t work?", "body": "<p>Ok guys, thank you...\nespecially Mat's Mug and litelite :)</p>\n\n<p>Finally, the codes with removing a line (last line about \"Refresh\" order) works correctly. the final codes are below:</p>\n\n<p>Private Sub PrEvFees_BeforeUpdate(Cancel As Integer)</p>\n\n<pre><code>If Me.PrEvFees.Value &gt;= 300 Then\n\n    OpenReportFRR.Enabled = True\n    OpenFRRDraft.Enabled = False\n\nElse\n\n    OpenReportFRR.Enabled = False\n    OpenFRRDraft.Enabled = True\n\nEnd If\n\n    DoCmd.Save\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 39015969, "answer_count": 1, "score": 0, "last_activity_date": 1475675028, "creation_date": 1471461697, "last_edit_date": 1471514787, "question_id": 39004674, "link": "https://stackoverflow.com/questions/39004674/why-vba-code-for-enable-disable-buttons-doesnt-work", "title": "Why VBA Code for Enable/Disable Buttons doesn&#39;t work?", "body": "<p>I have a Numeric field in a table. the field named \"Pr330USD\"\nin a form, control source of a textbox named \"PrEvFees\" has been linked to that field.</p>\n\n<p>I have also two buttons named:</p>\n\n<p>OpenReportFRR</p>\n\n<p>OpenFRRDraft</p>\n\n<p>for opening two different Reports.</p>\n\n<p>I wrote below codes aforementioned buttons:</p>\n\n<pre><code>Private Sub PrEvFees_BeforeUpdate(Cancel As Integer)\n    If Me.PrEvFees.Value &gt;= 300 Then\n        OpenReportFRR.Enabled = True\n        OpenFRRDraft.Enabled = False\n    Else\n        OpenReportFRR.Enabled = False\n        OpenFRRDraft.Enabled = True\n    End If\n\n    DoCmd.Save\n    DoCmd.RefreshRecord\n\nEnd Sub\n</code></pre>\n\n<p>Problems are:\nAfter insert an amount (less than 300 USD or above) the buttons doesn't change their situations and also Refresh command doesn't work (I have on the line included \"DoCmd.RefreshRecord\" a yellow alert).</p>\n\n<p>any idea is thanks full.</p>\n"}, {"tags": ["excel", "vba", "activex", "pivot-table"], "comments": [{"owner": {"reputation": 1, "user_id": 6562622, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/215973980b93c191f6d7378434688578?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Marcondes", "link": "https://stackoverflow.com/users/6562622/leonardo-marcondes"}, "edited": false, "score": 0, "creation_date": 1471461570, "post_id": 39004607, "comment_id": 65360914, "body": "ps: the vba that I put is just for last week...my intention is to do the same macro with some changes for last month"}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 2, "last_activity_date": 1471822473, "last_edit_date": 1471822473, "creation_date": 1471819168, "answer_id": 39069463, "question_id": 39004607, "link": "https://stackoverflow.com/questions/39004607/filtering-pivot-table-with-vba/39069463#39069463", "title": "Filtering pivot table with vba", "body": "<p>It's not possible to hide all items in a PivotField. You always have to leave at least one visible.</p>\n\n<p>It will be much faster and easier if you use VBA to leverage the inbuilt <em>Date Filters</em> functionality i.e. this:\n<a href=\"https://i.stack.imgur.com/jHvIx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jHvIx.jpg\" alt=\"DateFilter\"></a></p>\n\n<p>Here's a sample file where I do just that:\n<a href=\"https://1drv.ms/x/s!Ah_zTnaUo4DzjhezQ3OTq9tq1APC\" rel=\"nofollow noreferrer\">https://1drv.ms/x/s!Ah_zTnaUo4DzjhezQ3OTq9tq1APC</a></p>\n\n<p>Note that this functionality is only available on RowFields or ColumnFields. So my code below won't work on PageFields. </p>\n\n<p>Here's a generic routine that lets you choose what interval type and interval period you want to filter the pivot field on, as well as optionally select the date you want to count forward/back from.</p>\n\n<pre><code>Sub Pivots_FilterPeriod(sInterval As String, _\n                        lNumber As Long, _\n                        Optional vRelativeTo As Variant, _\n                        Optional pf As PivotField)\n\n    'Programmer:        Jeff Weir\n    'Contact:           weir.jeff@gmail.com\n    'Description:       Lets you programatically filter a Pivot RowField or ColumnField by specifying\n    '                   an interval type (e.g. days, weeks, months, quarters, years)\n    '                   as well as an interval count (e.g. 7, -7)\n    '                   If the optional vRelativeTo field is left blank, it counts back/foward from\n    '                   the youngest/oldest item depending on whether lNumber is positive/negative\n    '                   It leverages off the inbuilt DateFilters functionality, and as such does not\n    '                   work on RowFields.\n\n\n    Dim dteDateAdd As Date\n    Dim dteFrom As Date\n    Dim dteTo As Date\n\n    On Error GoTo errhandler\n\n    If pf Is Nothing Then\n        On Error Resume Next\n        Set pf = ActiveCell.PivotField\n        On Error GoTo errhandler\n        If pf Is Nothing Then GoTo errhandler\n    End If\n\n    With pf\n        If .DataType = xlDate _\n            And .Orientation &lt;&gt; xlPageField _\n            And .Orientation &lt;&gt; xlDataField Then\n\n            If IsMissing(vRelativeTo) Or vRelativeTo = \"\" Then\n                .AutoSort xlAscending, \"Date\"\n                If lNumber &gt; 0 Then\n                    vRelativeTo = .PivotItems(1)\n                Else\n                    vRelativeTo = .PivotItems(.PivotItems.Count)\n                End If\n            End If\n\n            Select Case UCase(sInterval)\n                Case \"D\", \"DD\", \"DDD\", \"DDDD\", \"DAY\", \"DAYS\": sInterval = \"d\"\n                Case \"W\", \"WW\", \"WWW\", \"WWWW\", \"WEEK\", \"WEEKS\": sInterval = \"ww\"\n                Case \"M\", \"MM\", \"MMM\", \"MMMM\", \"MONTH\", \"MONTHS\": sInterval = \"m\"\n                Case \"Q\", \"QQ\", \"QQQ\", \"QQQQ\", \"QUARTER\", \"QUARTERS\": sInterval = \"q\"\n                Case \"Y\", \"YY\", \"YYY\", \"YYYY\", \"YEAR\", \"YEARS\": sInterval = \"yyyy\"\n            End Select\n\n            dteDateAdd = DateAdd(sInterval, lNumber, vRelativeTo)\n            If lNumber &gt; 0 Then\n                dteDateAdd = dteDateAdd - 1\n            Else\n                dteDateAdd = dteDateAdd + 1\n            End If\n\n            If dteDateAdd &lt; vRelativeTo Then\n                dteFrom = dteDateAdd\n                dteTo = vRelativeTo\n            Else\n                dteFrom = vRelativeTo\n                dteTo = dteDateAdd\n            End If\n\n            With Application\n                .ScreenUpdating = False\n                .EnableEvents = False\n                .Calculation = xlCalculationManual\n            End With\n\n            .ClearAllFilters\n            .PivotFilters.Add2 _\n                Type:=xlDateBetween, _\n                Value1:=CStr(dteFrom), _\n                Value2:=CStr(dteTo)\n        End If\n    End With\n\nerrhandler:\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Here's some screenshots demonstrating how it looks in practice, using different parameters.</p>\n\n<p>This shows how to filter on the last 5 days from the most recent data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9fmVA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9fmVA.jpg\" alt=\"Last 5 days from most recent data\"></a></p>\n\n<p>And by changing the sign, it works out that we must want the first 5 days from the oldest data on record:</p>\n\n<p><a href=\"https://i.stack.imgur.com/70lZG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/70lZG.jpg\" alt=\"First 5 days from oldest records\"></a></p>\n\n<p>If you specify an actual date in that RelativeTo field, it will count forward/back from there depending on whether the Number parameter is positive/negative. Here's the next 5 days from today's date as I write this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/e88Wi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e88Wi.jpg\" alt=\"Next 5 days from today\"></a></p>\n\n<p>...and here's the last 5 days:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0NU3d.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0NU3d.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>It will let you specify whether you want days, weeks, quarters, months, or years. For instance, here's the last 2 weeks counting back from the most recent record:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Yhd30.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yhd30.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I'm using a Worksheet_Change event here to trigger it, but you can hook it up to a button if you like, and feed it the parameters you want.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim bContinue As Boolean\n    If Not Intersect(Target, Range(\"Interval\")) Is Nothing Then bContinue = True\n    If Not Intersect(Target, Range(\"Number\")) Is Nothing Then bContinue = True\n    If Not Intersect(Target, Range(\"RelativeTo\")) Is Nothing Then bContinue = True\n    If bContinue Then Pivots_FilterPeriod [Interval], [Number], [RelativeTo], Sheet1.PivotTables(1).PivotFields(\"Date\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6562622, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/215973980b93c191f6d7378434688578?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Marcondes", "link": "https://stackoverflow.com/users/6562622/leonardo-marcondes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2786, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471822473, "creation_date": 1471461482, "question_id": 39004607, "link": "https://stackoverflow.com/questions/39004607/filtering-pivot-table-with-vba", "title": "Filtering pivot table with vba", "body": "<p>I have a chart that picks the info from a pivot table that I have with daily data.\nI am trying to create activeX buttons so it can filter the data which is as ROW LABEL, to see how my data behaved in the last week and in the last month</p>\n\n<p>So, what I have until now and it is not working is:</p>\n\n<p>Private Sub weekbtn1_Click()\n    Dim i As Integer</p>\n\n<pre><code>If weekbtn1 = True Then\ni = 0\nDo Until Datavalue(date) - i = 42005\nWith ActiveSheet.PivotTables(\"Pivotcompsprice\").PivotFields(\"Date\")\n    .PivotItems DateValue(Date) - i.Visible = False\n    i = i + 1\nEnd With    \nLoop\n\ni = 0\nDo Until i = 7\nWith ActiveSheet.PivotTables(\"Pivotcompsprice\").PivotFields(\"Date\")\n    .PivotItems Datevalue(date) - i.Visible = True\nEnd With\nLoop\nElse\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n\n<p>I put this 42005 because it is the last date that I have the data which is 1/1/2015...I was thinking that it was possible to filter all the data as \"false\" and then Making True what I want, but it doesn't work!</p>\n\n<p>Can someone help me?</p>\n"}, {"tags": ["excel", "vba", "performance", "search", "sharepoint"], "owner": {"reputation": 11, "user_id": 6727741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe4abff82d9cb64fa951c9d82e6adab?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6727741/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1471460785, "creation_date": 1471460785, "question_id": 39004433, "link": "https://stackoverflow.com/questions/39004433/search-through-folders-subfolders-faster", "title": "Search through folders/subfolders faster", "body": "<p>I'm trying to search multiple folders on our Sharepoint site and their subfolders for Excel documents matching some criteria, then copy data from the workbooks into a summary book (don't really need help with that part). I've searched all over, and came up with the following code, but it is ridiculously slow (I have close to 1000 folders each with multiple subfolders to look through). I'm curious if anyone knows a faster way since this can run all weekend, and still not be even close.</p>\n\n<pre><code>Sub Main()\n\nOn Error GoTo ErrHandler\n\nDim fso, oFolder, oSubfolder, oFile, queue As Collection\nDim StartTime As Double\nDim MinutesElapsed, FileString As String\nConst MyDir As String = \"\\\\hp.sharepoint.com@SSL\\...\"\n\n' Remember time macro starts\nStartTime = Timer\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet queue = New Collection\nqueue.Add fso.GetFolder(MyDir)\n\nDo While queue.Count &gt; 0\n    Set oFolder = queue(1)\n    queue.Remove 1 'dequeue\n    For Each oSubfolder In oFolder.SubFolders\n        queue.Add oSubfolder 'enqueue\n    Next oSubfolder\n    For Each oFile In oFolder.Files\n        FileString = fso.GetFileName(oFile)\n        If InStr(FileString, \"FAI\") &gt; 0 Then\n            Call FAI(oFile) ' Copies data from files\n        ElseIf InStr(FileString, \"CPK\") &gt; 0 Then\n            Call CPK(oFile) ' Copies data from files\n        End If\n    Next oFile\nLoop\n\nApplication.CutCopyMode = False\nActiveSheet.Range(\"A1\").Select\n\n'Determine how long code took to run\nMinutesElapsed = Format((Timer - StartTime) / 86400, \"hh:mm:ss\")\nDebug.Print \"This code ran successfully in \" &amp; MinutesElapsed, vbInformation\n\nExit Sub\n\nErrHandler:\n    Debug.Print Err.Number &amp; \" \" &amp; Err.Description\n    Resume Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba", "sql-server-2008", "date"], "comments": [{"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 0, "creation_date": 1471470382, "post_id": 39004255, "comment_id": 65365221, "body": "In your VBA SQL construction string you might need to add in the single quote characters around the date literals and perhaps use the format function on the date values to ensure the VBA dates are being properly formatted to a &#39;mm/dd/yyyy&#39; string."}], "answers": [{"comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1471466146, "post_id": 39004813, "comment_id": 65363291, "body": "Great catch on the <code>&gt;=</code> and <code>&lt;=</code>... +1 for that! However, I&#39;m still getting the automation error. Please see my edit."}, {"owner": {"reputation": 81, "user_id": 5364769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3BkoZsqEvVo/AAAAAAAAAAI/AAAAAAAAAW0/hP-U0YWhGsw/photo.jpg?sz=128", "display_name": "Chris Erwin", "link": "https://stackoverflow.com/users/5364769/chris-erwin"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1471466420, "post_id": 39004813, "comment_id": 65363429, "body": "It&#39;s a VBA error, and unfortunately I don&#39;t know anything about VBA.  Do you have access to query SQL directly?  I&#39;d suggest confirming the query works through SQL Management Studio, and then changing your VBA code to do something simple like select top 10 Name from Information, and my guess is that you&#39;ll get the same error as it&#39;s probably unrelated to any particular SQL query."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1471532901, "post_id": 39004813, "comment_id": 65393780, "body": "Your query would be awesome if my data were cleaner. Any chance you know how I can deal with the variability of the dates?"}, {"owner": {"reputation": 81, "user_id": 5364769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3BkoZsqEvVo/AAAAAAAAAAI/AAAAAAAAAW0/hP-U0YWhGsw/photo.jpg?sz=128", "display_name": "Chris Erwin", "link": "https://stackoverflow.com/users/5364769/chris-erwin"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1471544277, "post_id": 39004813, "comment_id": 65400743, "body": "Yikes.  Yes, ideally you would fix the data.  An easy way to do this would be to copy it to a new table in the correct format, and selecting from the new table.  You&#39;d still have the old table in case something goes awry.    Another option is a view on the table, and inside the view you fix the dates with a bunch of case statements (basically if it&#39;s mm/dd/yyyy use 101 for the convert, if mm/dd/yy use 1, etc).  See <a href=\"http://www.sqlusa.com/bestpractices/datetimeconversion/\" rel=\"nofollow noreferrer\">sqlusa.com/bestpractices/datetimeconversion</a> .  This way your VBA query is simple, and the view is the one-time complex item."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1471633907, "post_id": 39004813, "comment_id": 65442216, "body": "Interesting tidbit: One of the dates is 9/2/605 (I&#39;m sure it was meant to be 9/2/05 or maybe 06). VBA recognizes that as a valid date and works with it just fine. However, Excel crashes if you try to insert that value into a cell formatted as a date."}], "tags": [], "owner": {"reputation": 81, "user_id": 5364769, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3BkoZsqEvVo/AAAAAAAAAAI/AAAAAAAAAW0/hP-U0YWhGsw/photo.jpg?sz=128", "display_name": "Chris Erwin", "link": "https://stackoverflow.com/users/5364769/chris-erwin"}, "is_accepted": true, "score": 2, "last_activity_date": 1471462178, "creation_date": 1471462178, "answer_id": 39004813, "question_id": 39004255, "link": "https://stackoverflow.com/questions/39004255/sql-selecting-all-data-between-date-ranges-when-date-is-stored-as-nvarchar/39004813#39004813", "title": "SQL Selecting all data between date ranges when date is stored as nvarchar", "body": "<p>You need to switch your >= and &lt;=.  Right now you're looking for people with start dates AFTER your target date and end dates BEFORE your target date.  But I assume that's just a typo in your example.</p>\n\n<p>You're on the right track though.  When you say you want to do this in VBA, I'd caution against doing any logic in VBA.  Do all of your filtering in SQL, and just use VBA to call the SQL.  Also, don't forget that you can connect Excel directly to SQL as a data source and skip VBA.  </p>\n\n<p>Anyway, your SQL query should look something like this:</p>\n\n<pre><code>SELECT  Name\nFROM    dbo.INFORMATION\nWHERE   CONVERT(DATETIME, Start_Date, 101) &lt;= @targetdate\n        AND CONVERT(DATETIME, End_Date, 101) &gt;= @targetdate\n</code></pre>\n\n<p>But then you have the case of someone with no end date.  Let's fix it so it all fits in one query.</p>\n\n<pre><code>SELECT  Name\nFROM    dbo.INFORMATION\nWHERE   CONVERT(DATETIME, Start_Date, 101) &lt;= @targetdate\n                    AND     CASE End_Date\n                              WHEN '' THEN GETDATE()\n                              ELSE CONVERT(DATETIME, End_Date, 101)\n                            END &gt;= @targetdate\n</code></pre>\n\n<p>Here we're using their end date if they have one, and if they don't we're using now.  If your target date could ever be in the future, then you could use an arbitrarily large date instead.</p>\n\n<p>One last item is to make it more readable, using BETWEEN:</p>\n\n<pre><code>SELECT  Name\nFROM    dbo.INFORMATION\nWHERE   @targetdate BETWEEN CONVERT(DATETIME, Start_Date, 101)\n                    AND     CASE End_Date\n                              WHEN '' THEN GETDATE()\n                              ELSE CONVERT(DATETIME, End_Date, 101)\n                            END\n</code></pre>\n"}], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 0, "accepted_answer_id": 39004813, "answer_count": 1, "score": 0, "last_activity_date": 1471531014, "creation_date": 1471459965, "last_edit_date": 1471531014, "question_id": 39004255, "link": "https://stackoverflow.com/questions/39004255/sql-selecting-all-data-between-date-ranges-when-date-is-stored-as-nvarchar", "title": "SQL Selecting all data between date ranges when date is stored as nvarchar", "body": "<p>I inherited a T-SQL table with <code>Start_Date</code> and <code>End_Date</code> columns that are <code>nvarchar</code> data types. I need to select all the records for a particular day who's start date is before that date but have an end date after that date. </p>\n\n<p>Another wrinkle is that some people are still current and do not have an <code>end_date</code>. Sadly, I cannot just convert the data type of the column to a date. I am trying to write this in VBA because </p>\n\n<ol>\n<li>my boss understands Excel, and </li>\n<li>the reports he is doing must be sent as Excel</li>\n</ol>\n\n<p>For example:</p>\n\n<pre><code>Name    Start_Date    End_Date\nJoe     12/1/2014     6/15/2016\nBob     8/28/2013     6/5/2014\nJon     1/27/2015     12/18/2015\nTim     8/28/2013     \n</code></pre>\n\n<p>If my selected date were 8/15/2015, my returned data should be </p>\n\n<pre><code>Name    Start_Date    End_Date\nJoe     12/1/2014     6/15/2016\nJon     1/27/2015     12/18/2015\nTim     8/28/2013     \n</code></pre>\n\n<p>I've tried the following queries, but they return <code>Run-time error -2147217900 (80040e14) Automation error</code></p>\n\n<pre><code>SELECT NAME \nFROM INFORMATION \nWHERE CONVERT(datetime, START_DATE, 101) &gt;= '12/1/2015' \n  AND CONVERT(datetime, END_DATE, 101) &lt;= '12/31/2015'\n\nSELECT NAME \nFROM INFORMATION \nWHERE START_DATE &gt;= '12/1/2015'\n</code></pre>\n\n<hr>\n\n<p>Edit:\nI am using the following code to construct my query:</p>\n\n<pre><code>For intYear = Year(Now()) To 2012 Step -1\n    For intMonth = 12 To 1 Step -1\n        FirstDayOfMonth = DateSerial(intYear, intMonth, 1)\n        LastDayOfMonth = DateSerial(intYear, intMonth + 1, 0)\n        SQL = \"SELECT NAME FROM dbo.INFORMATION \" &amp; _\n              \"WHERE CONVERT(DATETIME, START_DATE, 101) &lt;= \" &amp; FirstDayOfMonth &amp; \" AND \" &amp; _\n              \"CASE END_DATE WHEN '' THEN GETDATE() \" &amp; _\n              \"ELSE CONVERT(DATETIME, END_DATE, 101) END &gt;= \" &amp; LastDayOfMonth\n        Debug.Print SQL\n        'Output:\n        'SELECT NAME FROM dbo.INFORMATION WHERE CONVERT(DATETIME, START_DATE, 101) \n        '&lt;= 12/1/2016 AND CASE END_DATE WHEN '' THEN GETDATE() ELSE \n        'CONVERT(DATETIME, END_DATE, 101) END &gt;= 12/31/2016\n        Set rs = cn.Execute(SQL)\n    Next intMonth\nNext intYear\n</code></pre>\n\n<hr>\n\n<p>Update 2: </p>\n\n<p>I set <code>SQL</code> to the literal query rather than dynamically generating it and put in error catching (which I really should have done long ago). I think putting single quotes around the dates will cause it to be a string rather than a date, but I tried it both ways. </p>\n\n<pre><code>SQL = \"SELECT EMPLOYEE_NAME FROM dbo.INFORMATION \" &amp; _\n      \"WHERE CONVERT(DATETIME, START_DATE, 101) &lt;= 12/01/2016 \" &amp; _\n      \"AND CASE END_DATE \" &amp; _\n      \"WHEN '' THEN GETDATE() \" &amp; _\n      \"ELSE CONVERT(DATETIME, END_DATE, 101) \" &amp; _\n      \"END &gt;= 12/31/2016\"\n</code></pre>\n\n<p>Both with and without single quotes the actual SQL error from SSMS is:</p>\n\n<pre><code>Msg 241, Level 16, State 1, Line 4\nConversion failed when converting date and/or time from character string.\n</code></pre>\n\n<p>Looking at the data in the table, I can see that some dates are NULL, some are blank, and some are mm/dd/yy (or even m/d/yy). I wanted SQL to do all the heavy lifting, but now I'm trying to determine if it will be tougher to <code>SELECT *</code> and deal with it in Excel or engage my boss, his peers, and my grandboss to 'fix' the table.</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1471460600, "post_id": 39004161, "comment_id": 65360463, "body": "Are you trying to read the TD&#39;s of each TR from the website?"}, {"owner": {"reputation": 3, "user_id": 6727699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82693bcc01f4262e39f6bc48de7396be?s=128&d=identicon&r=PG&f=1", "display_name": "miracleclam", "link": "https://stackoverflow.com/users/6727699/miracleclam"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1473195835, "post_id": 39004161, "comment_id": 66045494, "body": "HI Ryan,I have a huge dataset that I would like to copy from my website. How do I make this work for large data set? Many thanks in advance!  For Each TR In TR_Elements         Set TD_Elements = TR.getElementsByTagName(&quot;td&quot;)         ColumnNumb = 1         For Each TD In TD_Elements             &#39;Consider using an array to save the values to memory if there is going             &#39;to be a lot of data to be moved over             ActiveSheet.Cells(RowNumb, ColumnNumb).Value = TD.InnerText             ColumnNumb = ColumnNumb + 1         Next         RowNumb = RowNumb + 1     Next"}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 3, "user_id": 6727699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82693bcc01f4262e39f6bc48de7396be?s=128&d=identicon&r=PG&f=1", "display_name": "miracleclam", "link": "https://stackoverflow.com/users/6727699/miracleclam"}, "edited": false, "score": 0, "creation_date": 1471530090, "post_id": 39008067, "comment_id": 65391750, "body": "Hi there, not sure I follow the question. The table should be pulled over in the same format from the web."}, {"owner": {"reputation": 3, "user_id": 6727699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82693bcc01f4262e39f6bc48de7396be?s=128&d=identicon&r=PG&f=1", "display_name": "miracleclam", "link": "https://stackoverflow.com/users/6727699/miracleclam"}, "edited": false, "score": 0, "creation_date": 1471530650, "post_id": 39008067, "comment_id": 65392201, "body": "You&#39;re awesome Ryan! Thank you so very much!"}, {"owner": {"reputation": 3, "user_id": 6727699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82693bcc01f4262e39f6bc48de7396be?s=128&d=identicon&r=PG&f=1", "display_name": "miracleclam", "link": "https://stackoverflow.com/users/6727699/miracleclam"}, "edited": false, "score": 0, "creation_date": 1471530686, "post_id": 39008067, "comment_id": 65392225, "body": "Please ignore my earlier Q, deleted it. Thank you very much again!"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 0, "last_activity_date": 1471523837, "last_edit_date": 1471523837, "creation_date": 1471478930, "answer_id": 39008067, "question_id": 39004161, "link": "https://stackoverflow.com/questions/39004161/excel-vba-run-time-error-438-object-doesnt-support-this-property-or-method-wh/39008067#39008067", "title": "Excel VBA-Run-time error 438. Object doesn&#39;t support this property or method. When trying to copy website table to excel", "body": "<p>Below is some code that should be able to grab the data from the HTML table from the SSRS report and extract it to Excel. </p>\n\n<p>Basically the code will iterate through all the TRs and TDs in the Table Element, and output the InnerText to Excel. If you are moving <em>a lot</em> of data over, please consider writing to an array, then doing the write all at once by setting to an equally sized range object.</p>\n\n<p>I also cleaned up the code, mostly removing variables that were not referenced and reduced some of the lines by combining some statements together</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetSSRSData()\n    On Error GoTo errhand:\n    Application.ScreenUpdating = False\n    Dim IE            As Object: Set IE = CreateObject(\"InternetExplorer.Application\")\n    Dim TR_Elements   As Object\n    Dim TR            As Object ' Table Row\n    Dim TD_Elements   As Object\n    Dim TD            As Object ' Table Data\n    Dim RowNumb       As Integer\n    Dim Columns       As Integer\n    Dim ColumnNumb    As Integer\n\n    With IE\n        .Visible = True\n        .Navigate (\"http://internalwebsite_SSRSReport\")\n\n        While .ReadyState &lt;&gt; 4: DoEvents: Wend ' Wait for page load\n        'Fill the form out with dates\n        .Document.All.Item(\"ctl31_ctl03_txtValue\").InnerText = Format(\"7/1/2016\", \"m/d/yyyy\")\n        .Document.All.Item(\"ctl31_ctl05_txtValue\").InnerText = Format(\"7/31/2016\", \"m/d/yyyy\")\n        Wait 2\n\n        'Click the DropDown\n        .Document.getElementsByName(\"ctl31_ctl04_divDropDown\").Item.Click\n        Wait 2\n\n        ' Click the other button\n        .Document.getElementsByName(\"ctl31_ctl04_ctl00\").Item.Click\n    End With\n\n    Wait 2\n    While IE.busy: DoEvents: Wend ' Wait for page load\n    Wait 2\n\n    'Clearing any unnecessary or old data in Sheet1\n    Sheets(\"Sheet1\").Range(\"A1:K500\").ClearContents\n    Set TR_Elements = IE.Document.getelementbyId(\"ctl31_ctl09_ReportArea\").getElementsByTagName(\"tr\")\n    RowNumb = 1\n    ColumnNumb = 1\n    'Tables usually consists of TR (Table Rows), and -\n    'TD (Table Data)\n    For Each TR In TR_Elements\n        Set TD_Elements = TR.getElementsByTagName(\"td\")\n        ColumnNumb = 1\n        For Each TD In TD_Elements\n            'Consider using an array to save the values to memory if there is going\n            'to be a lot of data to be moved over\n            ActiveSheet.Cells(RowNumb, ColumnNumb).Value = TD.InnerText\n            ColumnNumb = ColumnNumb + 1\n        Next\n        RowNumb = RowNumb + 1\n    Next\n\n    ' cleaning up memory\n    IE.Quit\n    Set IE = Nothing\n    Set TD_Elements = Nothing\n    Set TR_Elements = Nothing\n    Set TD = Nothing\n    Set TR = Nothing\n    Application.ScreenUpdating = True\n\nerrhand:\n     Application.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub Wait(ByVal nSec As Long)\n    nSec = nSec + Timer\n    While nSec &gt; Timer\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6727699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82693bcc01f4262e39f6bc48de7396be?s=128&d=identicon&r=PG&f=1", "display_name": "miracleclam", "link": "https://stackoverflow.com/users/6727699/miracleclam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2863, "favorite_count": 0, "accepted_answer_id": 39008067, "answer_count": 1, "score": 0, "last_activity_date": 1471523837, "creation_date": 1471459643, "last_edit_date": 1471461365, "question_id": 39004161, "link": "https://stackoverflow.com/questions/39004161/excel-vba-run-time-error-438-object-doesnt-support-this-property-or-method-wh", "title": "Excel VBA-Run-time error 438. Object doesn&#39;t support this property or method. When trying to copy website table to excel", "body": "<p>I am trying to extract table from an internal website to excel by giving some input parameters. Everything works until it refreshes the website data with my inputs. The part I get the run-time error 438 is marked (<code>For r = 1 To elemCollection.Rows.Length - 1</code>). I also tried to load the data from website to excel using web query and the table wasn't showing up on my excel spreadsheet. \"It gives the following error-This page might not function correctly because either your browser does not support scripts or active scripting is disabled. Your browser does not support scripts or has been configured not to allow scripts. The report viewer web control http handler has not been registered in the application's web config file.\"</p>\n\n<p>Wondering if this has anything to do with permissions.</p>\n\n<p>VBA code below:</p>\n\n<pre><code>Option Explicit\nSub Macro1()\n\n  Dim IE As Object, obj As Object\n  Dim StartDate As Object\n  Dim EndDate As Object\n  Dim myState As String\n  Dim r As Integer, c As Integer, t As Integer\n  Dim elemCollection As Object, curHTMLRow As Object\n  Dim wb As Workbook\n  Dim ws As Worksheet\n  Dim objCollection As Object\n  Dim objElement As Object\n  Dim i As Long\n\n  Set IE = CreateObject(\"InternetExplorer.Application\")\n\n  IE.Visible = True\n\n  IE.navigate (\"http://internalwebsite_SSRSReport\")\n\n  ' we ensure that the web page downloads completely before we fill the form automatically\n  While IE.ReadyState &lt;&gt; 4: DoEvents: Wend\n\n  IE.Document.All.Item(\"ctl31_ctl03_txtValue\").InnerText = Format(\"7/1/2016\", \"m/d/yyyy\")\n  IE.Document.All.Item(\"ctl31_ctl05_txtValue\").InnerText = Format(\"7/31/2016\", \"m/d/yyyy\")\n\n  Wait 2\n\n  IE.Document.getElementsByName(\"ctl31_ctl04_divDropDown\").Item.Click\n\n  Wait 2\n\n  ' accessing the button\n  IE.Document.getElementsByName(\"ctl31_ctl04_ctl00\").Item.Click\n  Wait 2\n  ' again ensuring that the web page loads completely before we start scraping data\n  While IE.busy: DoEvents: Wend\n\n      Wait 2\n\n     'Clearing any unnecessary or old data in Sheet1\n      ThisWorkbook.Sheets(\"Sheet1\").Activate\n      Range(\"A1:K500\").ClearContents\n\n      Set elemCollection =  IE.Document.getelementbyId(\"ctl31_ctl09_ReportArea\")\n\n      'error here\n      For r = 1 To elemCollection.Rows.Length - 1\n\n      Set curHTMLRow = elemCollection.Rows(r)\n      For c = 0 To curHTMLRow.Cells.Length - 1\n          Cells(r + 1, c + 1) = curHTMLRow.Cells(c).InnerText\n      Next\n  Next\n\n  ' cleaning up memory\n  IE.Quit\n  Set IE = Nothing\n\nEnd Sub\nPrivate Sub Wait(ByVal nSec As Long)\n    nSec = nSec + Timer\n    While nSec &gt; Timer\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1471459983, "post_id": 39003693, "comment_id": 65360127, "body": "That <code>[E1:E15]</code> notation might be valid, but it&#39;s implicitly referring to the active worksheet in the active workbook. You might want to be more explicit about it and assign <code>ActiveSheet.Range(&quot;E1:E15&quot;).Value</code> instead; that way it will be much easier to later parameterize the worksheet. Not to mention that it&#39;s not a notation that&#39;s commonly encountered, so avoiding it might spare a little &quot;WTF&quot; moment to whoever ends up maintaining your code."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1471498023, "post_id": 39003693, "comment_id": 65372577, "body": "The array you created was actually a 1D array, not a Row or Column type which are 2D types which are required."}], "answers": [{"comments": [{"owner": {"reputation": 369, "user_id": 4376334, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e06150df313cb68e4d5c5d78321f3769?s=128&d=identicon&r=PG&f=1", "display_name": "jim mako", "link": "https://stackoverflow.com/users/4376334/jim-mako"}, "edited": false, "score": 0, "creation_date": 1471458886, "post_id": 39003766, "comment_id": 65359548, "body": "Perfect, thanks for the code. I was unaware that the array created was horizontal! Thanks!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1471458095, "creation_date": 1471458095, "answer_id": 39003766, "question_id": 39003693, "link": "https://stackoverflow.com/questions/39003693/vba-pasting-variant-values/39003766#39003766", "title": "VBA - Pasting Variant Values", "body": "<p>You are trying to pass a horizontal array into a vertical range.</p>\n\n<p>Either transpose the array or make that array 2D with the second dimension of 1:</p>\n\n<pre><code>Sub TEST()\n\nDim SIZE As Integer\nSIZE = 15\n\nDim VECTOR() As Integer\nReDim VECTOR(1 To SIZE, 1 To 1)\n\nDim i\n\nFor i = 1 To SIZE\n\n    VECTOR(i, 1) = i\n\nNext i\n\n[E1:E15].Value = VECTOR\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The Transpose version:</p>\n\n<pre><code>Sub TEST()\n\nDim SIZE As Integer\nSIZE = 15\n\nDim VECTOR() As Integer\nReDim VECTOR(1 To SIZE)\n\nDim i\n\nFor i = 1 To SIZE\n\n    VECTOR(i) = i\n\nNext i\n\n[E1:E15].Value = Application.Transpose(VECTOR)\n\nEnd Sub\n</code></pre>\n\n<p>One warning: Transpose has a limitation to the number of items it can handle.</p>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1471459435, "creation_date": 1471459435, "answer_id": 39004110, "question_id": 39003693, "link": "https://stackoverflow.com/questions/39003693/vba-pasting-variant-values/39004110#39004110", "title": "VBA - Pasting Variant Values", "body": "<p>or just </p>\n\n<pre><code>[E1:E15] = [row(E1:E15)]\n</code></pre>\n"}], "owner": {"reputation": 369, "user_id": 4376334, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e06150df313cb68e4d5c5d78321f3769?s=128&d=identicon&r=PG&f=1", "display_name": "jim mako", "link": "https://stackoverflow.com/users/4376334/jim-mako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1211, "favorite_count": 0, "accepted_answer_id": 39003766, "answer_count": 2, "score": 0, "last_activity_date": 1471459435, "creation_date": 1471457814, "question_id": 39003693, "link": "https://stackoverflow.com/questions/39003693/vba-pasting-variant-values", "title": "VBA - Pasting Variant Values", "body": "<p>I have a problem pasting a variant in Excel to a specified range. I have the following code below but the output in <code>[E1:E15]</code> is 0 for the whole range. What I would like to see is 1 all the way to 15.</p>\n\n<p>I was unable to find a solution to this specific problem (partly because I could not identify what this problem is defined as withing Excel terminology). Any help for this specific code or a more natural way to complete this in VBA is much appreciated. Thanks!</p>\n\n<pre><code>Sub TEST()\n\nDim SIZE As Integer\nSIZE = 15\n\nDim VECTOR() As Integer\nReDim VECTOR(SIZE)\n\nDim i\n\nFor i = 1 To SIZE\n\n    VECTOR(i) = i\n\nNext i\n\n[E1:E15].Value = VECTOR\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1471457779, "post_id": 39003629, "comment_id": 65358912, "body": "So in Table 3 what do you start with, Only the IDs or both the IDs and Names?"}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1471458318, "post_id": 39003629, "comment_id": 65359213, "body": "@ScottCraner ID is most important here"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1471463176, "post_id": 39003629, "comment_id": 65361735, "body": "If the row or column in which it starts is not defined then the best way to proceed is to to make the data into actual tables with proper table structures and do what @Slai stated.  Otherwise the formulas will get unruly and prone to error."}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1471464216, "post_id": 39003629, "comment_id": 65362316, "body": "@ScottCraner that&#39;s a lot of memory for 500k rows, okay well thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1471461518, "post_id": 39004588, "comment_id": 65360887, "body": "thats exactly what i have in the question.... but it assumes table header location is same... i want it to SEARCH"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 1, "creation_date": 1471461868, "post_id": 39004588, "comment_id": 65361067, "body": "@JamAndJammies with Excel tables the order or location of the column does not matter even if you re-arrange the columns in Table2 as it references the range by the header name."}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1471462663, "post_id": 39004588, "comment_id": 65361469, "body": "Doesn&#39;t work, I dont think you understand the question. There&#39;s no way to know which col needs to be added if its not searched or specify. I added a picture"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1471464092, "post_id": 39004588, "comment_id": 65362252, "body": "@JamAndJammies I don&#39;t think you understand the answer. I added a picture too. If you format the ranges as tables, in Excel 2007 or above you can use <a href=\"https://support.office.com/en-us/article/Using-structured-references-with-Excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e?ui=en-US&amp;rs=en-US&amp;ad=US&amp;fromAR=1\" rel=\"nofollow noreferrer\">structured references</a>"}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1471464093, "post_id": 39004588, "comment_id": 65362253, "body": "I don&#39;t know what version of excel you have, but that doesn&#39;t show anything.. you are literally putting in <code>Table2[Income]</code>? This doesn&#39;t even look right... I don&#39;t know how you can get there.."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1471464263, "post_id": 39004588, "comment_id": 65362344, "body": "@JamAndJammies you can select the table ranges and in the Home tab select Format as Table (or click Table in the Insert tab)"}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1471464423, "post_id": 39004588, "comment_id": 65362422, "body": "okay thanks.. quite a disappointing though... seems memory intensive.....but thanks"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1471464773, "post_id": 39004588, "comment_id": 65362588, "body": "@JamAndJammies I expect this to be a tiny bit more efficient than a Index/Match Excel formula. You can compare by saving the file as <code>.xls</code> which will remove the structured references and convert them to absolute addresses like in your example."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 1, "last_activity_date": 1471463534, "last_edit_date": 1471463534, "creation_date": 1471461422, "answer_id": 39004588, "question_id": 39003629, "link": "https://stackoverflow.com/questions/39003629/sumif-rows-and-columns-from-two-or-more-tables-using-header-index-match/39004588#39004588", "title": "sumif rows and columns from two or more tables using header Index/Match", "body": "<p>If the tables are Excel Tables ( Home > Format as Table ) then you can copy Table<strong>2</strong> and add a new table column with this formula</p>\n\n<pre><code>= SUMIF( Table2[ID], [ID], Table2[Income] )\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/U3ntt.png\" alt=\"\"></p>\n"}], "owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "accepted_answer_id": 39004588, "answer_count": 1, "score": 0, "last_activity_date": 1471463534, "creation_date": 1471457563, "last_edit_date": 1471462688, "question_id": 39003629, "link": "https://stackoverflow.com/questions/39003629/sumif-rows-and-columns-from-two-or-more-tables-using-header-index-match", "title": "sumif rows and columns from two or more tables using header Index/Match", "body": "<p>How do I sumif rows and columns from two tables? The formula should match each tables row number and column headers, find the intersection and sum it.\nI can only do this manually using sumif, but I'd like an actual formula so I don't need to search for the header for Table 2. I'm open to forumla or vba</p>\n\n<p>essentially the formula is so:\n<code>=SUMIF(\"Table 3 ID Column\",Table 1 ID,\"Table 2 Income\")</code></p>\n\n<p>This is not correct but looking for something like this:\n<code>=SUMIF(\"Table 3 Col\", Value, ADDRESS(MATCH(Value,Col array,0) , MATCH(header Value ,header array,0),1))</code></p>\n\n<p>Example</p>\n\n<pre><code>Table 1\nID  Name\n25173   Blue\n25710   Debbie\n64092   John\n64094   Apples\n6959    Oranges\n6983    Amy\n\n\nTable 2\nID  Income\n25173   142\n6983    298\n64092   2205\n25173   462\n25173   346\n64092   644\n\n\nTable 3\nDesired Output      \nID  Name    Income\n25173   Blue    950\n25710   Debbie  0\n64092   John    2849\n64094   Apples  0\n6959    Oranges 0\n6983    Amy 0\n</code></pre>\n\n<p>[[update]]\n[<img src=\"https://i.stack.imgur.com/Zuaia.png\" alt=\"enter image description here\">]<a href=\"https://i.stack.imgur.com/Zuaia.png\" rel=\"nofollow noreferrer\">1</a></p>\n"}, {"tags": ["vba", "macros", "solidworks"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1471458689, "post_id": 39003593, "comment_id": 65359429, "body": "Did you edit the question to include my answer or because you made a copy/paste error the first time?"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1471457789, "post_id": 39003665, "comment_id": 65358918, "body": "Then what does <code>Set swApp = Application.SldWorks</code> do?"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1471458073, "post_id": 39003665, "comment_id": 65359078, "body": "@GSerg From what i can find on the internet, it returns the currently running SolidWork instance. And (probably) nothing if it is not running."}, {"owner": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471458222, "post_id": 39003665, "comment_id": 65359161, "body": "I tried what you said, and it still pops up with the same error, when I hover the mouse over debug&#39;d line, it say&#39;s &#39;Part = Nothing&#39;. How do I set the part as a GLOBAL variable, that each function can access ??"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471458283, "post_id": 39003665, "comment_id": 65359193, "body": "@UndergradEngineer23 global variables are to be avoided at all cost. It would be better practice to add it as a parameter to the subs"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471458315, "post_id": 39003665, "comment_id": 65359210, "body": "@UndergradEngineer23 did it at least change the line where it happended?"}, {"owner": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471458365, "post_id": 39003665, "comment_id": 65359248, "body": "How do I add it as a paramter ? Sorry not fimilar with vba :)"}, {"owner": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471458400, "post_id": 39003665, "comment_id": 65359270, "body": "Nope, sorry the line where it debug errors, is actually in the last function Proc20()"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471458597, "post_id": 39003665, "comment_id": 65359370, "body": "@UndergradEngineer23 <a href=\"http://stackoverflow.com/documentation/vba/topics?page=1\">read the doc</a> it got a whole bunch of information about how to use vba."}, {"owner": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471458799, "post_id": 39003665, "comment_id": 65359492, "body": "I understand, is there a simple way? I tried Proc1(Part), however I now get error &#39;438&#39;, Object doesn&#39;t support this property or method"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471458911, "post_id": 39003665, "comment_id": 65359560, "body": "@UndergradEngineer23 you also nee to change the declaration of the sub. Also, do not put <code>(</code> and <code>)</code> when calling subs"}, {"owner": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471458952, "post_id": 39003665, "comment_id": 65359584, "body": "@litelite How and what do I change the declaration of sub to ? Thank you :)"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "edited": false, "score": 0, "creation_date": 1471459053, "post_id": 39003665, "comment_id": 65359643, "body": "@UndergradEngineer23 I feel that i am repeating myself, but <a href=\"https://msdn.microsoft.com/en-us/library/831f9wka.aspx\" rel=\"nofollow noreferrer\">read the doc</a> (microsoft&#39;s doc this time)"}], "tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": false, "score": 3, "last_activity_date": 1471457707, "creation_date": 1471457707, "answer_id": 39003665, "question_id": 39003593, "link": "https://stackoverflow.com/questions/39003593/vba-run-time-error-91-object-variable-or-with-block-variable-not-set/39003665#39003665", "title": "vba Run-time error &#39;91&#39;: Object variable or With block variable not set", "body": "<p>it means that <code>swApp</code> is <code>Nothing</code> because you did not actually <a href=\"https://support.office.com/en-us/article/CreateObject-Function-31917b05-1530-48f5-86d6-d2bd748aad74\" rel=\"nofollow\">create</a> it.</p>\n\n<p>Heres how to do it :</p>\n\n<pre><code> Set swApp = CreateObject(\"SldWorks.Application\")\n</code></pre>\n\n<p><strong>Source :</strong> Taken straight from the <a href=\"http://help.solidworks.com/2012/English/api/sldworksapi/Create_and_Rename_Objects_Example_VB.htm\" rel=\"nofollow\">doc</a></p>\n"}, {"tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": false, "score": 0, "last_activity_date": 1476496363, "creation_date": 1476496363, "answer_id": 40054173, "question_id": 39003593, "link": "https://stackoverflow.com/questions/39003593/vba-run-time-error-91-object-variable-or-with-block-variable-not-set/40054173#40054173", "title": "vba Run-time error &#39;91&#39;: Object variable or With block variable not set", "body": "<p>You're setting a variable to a <code>nothing</code>.</p>\n\n<p>Better do this way (with early binding):</p>\n\n<pre><code>Dim swApp as SldWorks.SldWorks\nSet swApp = Application.SldWorks\n</code></pre>\n\n<p>This would allow you to utilize intellisense.</p>\n"}], "owner": {"reputation": 143, "user_id": 3130203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf377e17251b83550c5adb524c60647a?s=128&d=identicon&r=PG&f=1", "display_name": "CodexAres", "link": "https://stackoverflow.com/users/3130203/codexares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1886, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476496363, "creation_date": 1471457423, "last_edit_date": 1592644375, "question_id": 39003593, "link": "https://stackoverflow.com/questions/39003593/vba-run-time-error-91-object-variable-or-with-block-variable-not-set", "title": "vba Run-time error &#39;91&#39;: Object variable or With block variable not set", "body": "<p>I'm trying to run a Solid-Works VBA macro, should be an easy fix, however I don't know what to change.</p>\n<p>When I run the code the code error's with the</p>\n<blockquote>\n<p>Run-time error '91'</p>\n<p>Object variable or With block variable not set</p>\n</blockquote>\n<p>When I click debug it shows me this line</p>\n<blockquote>\n<p>Set Part = swApp.ActiveDoc</p>\n</blockquote>\n<p>I truly do not know where to look, what to do, that might be causing, so any help is much appreciated. The essential parts of the code can be seen below (where the ... indicates missing code, which is the same structure as the other functions). The full code can be see here: <a href=\"https://github.com/samholt/solidworks_prop/blob/master/macro.swb\" rel=\"nofollow noreferrer\">Macro_Source_File</a></p>\n<pre><code>Dim swApp As Object\nDim Part As Object\nDim boolstatus As Boolean\nDim longstatus As Long, longwarnings As Long\nSub main()\nSet swApp = CreateObject(&quot;SldWorks.Application&quot;)\nSet Part = swApp.ActiveDoc\nProc1\nProc2\nProc3\nProc4\nProc5\nProc6\nProc7\nProc8\nProc9\nProc10\nProc11\nProc12\nProc13\nProc14\nProc15\nProc16\nProc17\nProc18\nProc19\nProc20\nPart.ClearSelection2 True\nboolstatus = Part.Extension.SelectByID2(&quot;Curve1&quot;, &quot;REFERENCECURVES&quot;, -0.00231262, -0.00182843, 0.020955, False, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve2&quot;, &quot;REFERENCECURVES&quot;, -0.0021168, -0.00236411, 0.02720474, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve3&quot;, &quot;REFERENCECURVES&quot;, -0.00223617, -0.0027144, 0.03345447, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve4&quot;, &quot;REFERENCECURVES&quot;, -0.00249537, -0.00287881, 0.03970421, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve5&quot;, &quot;REFERENCECURVES&quot;, -0.00282783, -0.00287835, 0.04595395, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve6&quot;, &quot;REFERENCECURVES&quot;, -0.00351723, -0.00287119, 0.05220368, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve7&quot;, &quot;REFERENCECURVES&quot;, -0.0055227, -0.0032572, 0.05845342, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve8&quot;, &quot;REFERENCECURVES&quot;, -0.00756485, -0.0034921, 0.06470316, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve9&quot;, &quot;REFERENCECURVES&quot;, -0.00948977, -0.00359409, 0.07095289, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve10&quot;, &quot;REFERENCECURVES&quot;, -0.01123743, -0.00358632, 0.07720263, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve11&quot;, &quot;REFERENCECURVES&quot;, -0.01275123, -0.00349398, 0.08345237, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve12&quot;, &quot;REFERENCECURVES&quot;, -0.01289014, -0.00310294, 0.08970211, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve13&quot;, &quot;REFERENCECURVES&quot;, -0.01208902, -0.00258381, 0.09595184, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve14&quot;, &quot;REFERENCECURVES&quot;, -0.01103539, -0.00209482, 0.10220158, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve15&quot;, &quot;REFERENCECURVES&quot;, -0.00978747, -0.00163788, 0.10845132, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve16&quot;, &quot;REFERENCECURVES&quot;, -0.00828882, -0.00121351, 0.11470105, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve17&quot;, &quot;REFERENCECURVES&quot;, -0.00686848, -0.00083556, 0.12095079, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve18&quot;, &quot;REFERENCECURVES&quot;, -0.00678812, -0.00066149, 0.12720053, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve19&quot;, &quot;REFERENCECURVES&quot;, -0.00585563, -0.00585251, 0.13245522, True, 1, Nothing, 0)\nboolstatus = Part.Extension.SelectByID2(&quot;Curve20&quot;, &quot;REFERENCECURVES&quot;, -0.00522598, -0.01340759, 0.13263761, True, 1, Nothing, 0)\nPart.FeatureManager.InsertProtrusionBlend False, True, False, 1, 6, 6, 1, 1, True, True, False, 0, 0, 0, True, True, True\nEnd Sub\n\nSub Proc1()\nSet Part = swApp.ActiveDoc\nPart.InsertCurveFileBegin\nboolstatus = Part.InsertCurveFilePoint(-0.00231262, -0.00182843, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.00232201, -0.00179355, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.0023492, -0.00169261, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.00193825, -0.00141403, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.001174, -0.00099736, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.00022623, -0.00050828, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00087785, 0.00002491, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00210496, 0.00057278, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00341658, 0.00110609, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00477003, 0.00159708, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00612951, 0.00202043, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00745767, 0.00233337, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00869064, 0.00252003, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00977735, 0.0025858, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.01067256, 0.00254594, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.01134017, 0.00242162, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.01175535, 0.00223452, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.01190555, 0.00200133, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.01190555, 0.00200133, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.01178923, 0.00175006, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.01141567, 0.00150298, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.01080407, 0.00126068, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00998055, 0.00102135, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00897647, 0.00077979, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00782706, 0.0005274, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00657067, 0.00025367, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00523448, -0.00004854, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00386212, -0.00035713, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.0025091, -0.00066457, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00122199, -0.00096449, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(0.00004512, -0.00124691, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.00098083, -0.00149976, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.00181994, -0.00171086, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.00231106, -0.00183422, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.00231224, -0.00182982, 0.020955)\nboolstatus = Part.InsertCurveFilePoint(-0.00231262, -0.00182843, 0.020955)\nboolstatus = Part.InsertCurveFileEnd()\nboolstatus = Part.SelectedFeatureProperties(0, 0, 0, 0, 0, 0, 0, 1, 0, &quot;Curve1&quot;)\nEnd Sub\n\nSub Proc2()\nSet Part = swApp.ActiveDoc\nPart.InsertCurveFileBegin\nboolstatus = Part.InsertCurveFilePoint(-0.0021168, -0.00236411, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00213034, -0.00232574, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00216954, -0.00221468, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00223031, -0.00204246, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00167844, -0.00160452, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00065574, -0.00097391, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00053875, -0.00028036, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00187018, 0.00044021, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00329779, 0.0011517, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00477601, 0.00181922, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00626681, 0.00241128, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00773188, 0.00287663, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00910086, 0.00319197, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.0103159, 0.00335898, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.01132489, 0.00339094, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.01208546, 0.00330851, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.01256786, 0.00313392, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.01275656, 0.00288487, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.01275656, 0.00288487, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.01264744, 0.00259265, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.012249, 0.00228309, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.01158277, 0.00195851, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.01067824, 0.00161909, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00957108, 0.00126169, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.0083016, 0.00087967, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00691378, 0.00046452, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00543877, 0.00001052, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00392367, -0.00045373, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.0024302, -0.00091504, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(0.00101012, -0.00136224, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00028764, -0.00178035, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00141839, -0.00215231, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00211132, -0.00237963, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00211455, -0.00237048, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.00211626, -0.00236563, 0.02720474)\nboolstatus = Part.InsertCurveFilePoint(-0.0021168, -0.00236411, 0.02720474)\nboolstatus = Part.InsertCurveFileEnd()\nboolstatus = Part.SelectedFeatureProperties(0, 0, 0, 0, 0, 0, 0, 1, 0, &quot;Curve2&quot;)\nEnd Sub\n\n.\n.\n.\n\nSub Proc20()\nSet Part = swApp.ActiveDoc\nPart.InsertCurveFileBegin\nboolstatus = Part.InsertCurveFilePoint(-0.00522598, -0.01340759, 0.13263761)\nboolstatus = Part.InsertCurveFilePoint(-0.00522724, -0.01340759, 0.1326561)\nboolstatus = Part.InsertCurveFilePoint(-0.00523089, -0.01340759, 0.13270962)\nboolstatus = Part.InsertCurveFilePoint(-0.00523654, -0.01340759, 0.13279261)\nboolstatus = Part.InsertCurveFilePoint(-0.00524364, -0.01340759, 0.13289681)\nboolstatus = Part.InsertCurveFilePoint(-0.00525152, -0.01340759, 0.13301238)\nboolstatus = Part.InsertCurveFilePoint(-0.00525946, -0.01340759, 0.13312893)\nboolstatus = Part.InsertCurveFilePoint(-0.00465279, -0.01340759, 0.13327821)\nboolstatus = Part.InsertCurveFilePoint(-0.00393952, -0.01340759, 0.13341622)\nboolstatus = Part.InsertCurveFilePoint(-0.00320939, -0.01340759, 0.13352877)\nboolstatus = Part.InsertCurveFilePoint(-0.00248296, -0.01340759, 0.13360667)\nboolstatus = Part.InsertCurveFilePoint(-0.00178327, -0.01340759, 0.13363211)\nboolstatus = Part.InsertCurveFilePoint(-0.00114406, -0.01340759, 0.13360345)\nboolstatus = Part.InsertCurveFilePoint(-0.0005905, -0.01340759, 0.13352848)\nboolstatus = Part.InsertCurveFilePoint(-0.00014384, -0.01340759, 0.13341938)\nboolstatus = Part.InsertCurveFilePoint(0.00017986, -0.01340759, 0.1332904)\nboolstatus = Part.InsertCurveFilePoint(0.00037024, -0.01340759, 0.13315493)\nboolstatus = Part.InsertCurveFilePoint(0.00042266, -0.01340759, 0.13302262)\nboolstatus = Part.InsertCurveFilePoint(0.00042266, -0.01340759, 0.13302262)\nboolstatus = Part.InsertCurveFilePoint(0.00033912, -0.01340759, 0.1329077)\nboolstatus = Part.InsertCurveFilePoint(0.0001265, -0.01340759, 0.13282048)\nboolstatus = Part.InsertCurveFilePoint(-0.00020546, -0.01340759, 0.13275933)\nboolstatus = Part.InsertCurveFilePoint(-0.0006438, -0.01340759, 0.13272076)\nboolstatus = Part.InsertCurveFilePoint(-0.00117325, -0.01340759, 0.13269902)\nboolstatus = Part.InsertCurveFilePoint(-0.00177694, -0.01340759, 0.13268629)\nboolstatus = Part.InsertCurveFilePoint(-0.0024366, -0.01340759, 0.13267345)\nboolstatus = Part.InsertCurveFilePoint(-0.00313926, -0.01340759, 0.13265421)\nboolstatus = Part.InsertCurveFilePoint(-0.00386076, -0.01340759, 0.13263536)\nboolstatus = Part.InsertCurveFilePoint(-0.00457242, -0.01340759, 0.13261517)\nboolstatus = Part.InsertCurveFilePoint(-0.00522301, -0.01340759, 0.13259405)\nboolstatus = Part.InsertCurveFilePoint(-0.00522417, -0.01340759, 0.13261114)\nboolstatus = Part.InsertCurveFilePoint(-0.00522496, -0.01340759, 0.13262275)\nboolstatus = Part.InsertCurveFilePoint(-0.00522547, -0.01340759, 0.13263013)\nboolstatus = Part.InsertCurveFilePoint(-0.00522577, -0.01340759, 0.13263454)\nboolstatus = Part.InsertCurveFilePoint(-0.00522593, -0.01340759, 0.13263688)\nboolstatus = Part.InsertCurveFilePoint(-0.00522598, -0.01340759, 0.13263761)\nboolstatus = Part.InsertCurveFileEnd()\nboolstatus = Part.SelectedFeatureProperties(0, 0, 0, 0, 0, 0, 0, 1, 0, &quot;Curve20&quot;)\nEnd Sub\n</code></pre>\n<p>Thank you so much !</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1471455839, "post_id": 39003081, "comment_id": 65357856, "body": "When I try implementing this I get runtime error 438"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 1, "creation_date": 1471456377, "post_id": 39003081, "comment_id": 65358133, "body": "I made a small change. Hope you do not mind it? You may rollback the changes if you want. @johndoe253: Try it now."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1471456463, "post_id": 39003081, "comment_id": 65358188, "body": "@SiddharthRout Appreciate the help.  I was working on an example."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 1, "creation_date": 1471456483, "post_id": 39003081, "comment_id": 65358201, "body": "@johndoe253 see edit. You may need to refresh the screen."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1471456486, "post_id": 39003081, "comment_id": 65358204, "body": "Your original code was correct. it was just missing <code>.Text</code>"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1471456851, "post_id": 39003081, "comment_id": 65358397, "body": "@ScottCraner sorry to ask again but I have a type mismatch when the .text is in there."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 1, "creation_date": 1471457109, "post_id": 39003081, "comment_id": 65358527, "body": "@johndoe253 just did another edit.  See if that helps.  I tested it on some made up data and it seems to work for me.  Make sure that none of the cells have errors."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1471456869, "last_edit_date": 1471456869, "creation_date": 1471455597, "answer_id": 39003081, "question_id": 39003028, "link": "https://stackoverflow.com/questions/39003028/check-string-for-uppercase-characters/39003081#39003081", "title": "Check string for uppercase characters", "body": "<p>You would check if the characters uppercase equals the present character:</p>\n\n<pre><code> While UCase(rng.Characters(iEnd, 1).Text) = rng.Characters(iEnd, 1).Text And Not rng.Characters(iEnd, 1).Font.Italic\u200b\n</code></pre>\n\n<p>Thanks @SiddharthRoth for the assist.</p>\n\n<p>Now that you have shown the full code, One more note.  You should avoid naming variables, subs and function by words that are used in excel.</p>\n\n<p>So change the name to <code>Itlc</code> or something else:</p>\n\n<pre><code>Function Itlc(rng As Range) As Variant\n    Dim strng As String\n    Dim iEnd As Long, iIni As Long, strngLen As Long\n\n    strngLen = Len(rng.Value2)\n    iIni = 1\n\n    Do While iEnd &lt;= strngLen\n       Do While UCase(rng.Characters(iEnd, 1).Text) = rng.Characters(iEnd, 1).Text And Not rng.Characters(iEnd, 1).Font.Italic\n            If iEnd = strngLen Then Exit Do\n            iEnd = iEnd + 1\n        Loop\n        If iEnd &gt; iIni Then strng = strng &amp; Mid(rng.Value2, iIni, iEnd - iIni) &amp; \"|\"\n        iEnd = iEnd + 1\n        iIni = iEnd\n    Loop\n\n    If strng &lt;&gt; \"\" Then Itlc = Split(Left(strng, Len(strng) - 1), \"|\")\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 3, "last_activity_date": 1471510048, "creation_date": 1471510048, "answer_id": 39013700, "question_id": 39003028, "link": "https://stackoverflow.com/questions/39003028/check-string-for-uppercase-characters/39013700#39013700", "title": "Check string for uppercase characters", "body": "<p>You could do this quickly withut looping using a <code>Regexp</code>:</p>\n\n<pre><code>Function OpalsOut(StrIn As String) As Variant\nDim objRegex As Object\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n  .Pattern = \"[A-Z]+\"\n  .Global = True\n  .ignorecase = False\nIf .test(StrIn) Then\n    Set OpalsOut = .Execute(StrIn)\nElse\n    OpalsOut = \"No match\"\"\"\nEnd If\nEnd With\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11977342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6b56d7f3f99213e98616e996c8712b2?s=128&d=identicon&r=PG&f=1", "display_name": "4CORE", "link": "https://stackoverflow.com/users/11977342/4core"}, "is_accepted": false, "score": 0, "last_activity_date": 1566813744, "last_edit_date": 1566813744, "creation_date": 1566807933, "answer_id": 57654294, "question_id": 39003028, "link": "https://stackoverflow.com/questions/39003028/check-string-for-uppercase-characters/57654294#57654294", "title": "Check string for uppercase characters", "body": "<pre><code>Function CheckUppercase(inpt)\n    For i = 0 To Len(inpt) - 1\n        nwSt = Left$(Right(inpt, Len(inpt) - i), 1)\n        Select Case nwSt\n            Case \" \", \",\", \".\", \";\"\n                uUCase = 1\n            Case Else\n                If nwSt Like \"*[A-Z]*\" Then uUCase = 1 Else uUCase = 0: Exit For\n        End Select\n    Next\n    If uUCase = 0 Then CheckUppercase = 0 Else CheckUppercase = 1\n    ' 0 means there is lowercase inside\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1589, "user_id": 7521686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UDBYX71fG0s/AAAAAAAAAAI/AAAAAAAACk4/hZf1PXHUCRA/photo.jpg?sz=128", "display_name": "Calos", "link": "https://stackoverflow.com/users/7521686/calos"}, "edited": false, "score": 1, "creation_date": 1587948611, "post_id": 61440481, "comment_id": 108702914, "body": "Code-only answers are considered low quality: make sure to provide an explanation what your code does and how it solves the problem. It will help the asker and future readers both if you can add more information in your post. See <a href=\"https://meta.stackexchange.com/questions/114762/\">Explaining entirely code-based answers</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 13410128, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7mxdHauGE1k/AAAAAAAAAAI/AAAAAAAAAAA/AAKWJJMqif8j_hBQoZvDamenO6YbtW9Rkg/photo.jpg?sz=128", "display_name": "user13410128", "link": "https://stackoverflow.com/users/13410128/user13410128"}, "is_accepted": false, "score": 0, "last_activity_date": 1587903177, "last_edit_date": 1587903177, "creation_date": 1587902832, "answer_id": 61440481, "question_id": 39003028, "link": "https://stackoverflow.com/questions/39003028/check-string-for-uppercase-characters/61440481#61440481", "title": "Check string for uppercase characters", "body": "<pre><code>Function IsUpperInString(sInput As String) As Boolean\nDim sAplhabetAZ As String\nDim sCurrChar As String\nDim iLengthInput As Integer\nDim bResult As Boolean\n\nOn Error GoTo IsUpperInStringERROR\n\n    sAplhabetAZ = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n\n    bResult = False\n    iLengthInput = Len(sInput)\n\n    If (iLengthInput = 0) Then\n       IsUpperInString = bResult\n       Exit Function\n    End If\n\n    For iCounter = 1 To iLengthInput\n        sCurrChar = Mid(sInput, iCounter, 1)\n        If (Instr(1, sAplhabetAZ, sCurrChar, vbBinaryCompare) &gt; 0) Then\n           bResult = True\n           GoTo ExitThisFunction\n        End If\n    Next iCounter\n\nExitThisFunction:\n\nIsUpperInString = bResult\n\nExit Function\n\n    IsUpperInStringERROR:\n    MsgBox \"Function IsUpperInStringERROR: \" &amp; Str(Err.Number) &amp; \" - \" &amp; Err.Description\n    GoTo ExitThisFunction\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1597330189, "post_id": 62498085, "comment_id": 112103148, "body": "This only tests the FIRST character in the string. It does not test ALL of the characters in a string."}], "tags": [], "owner": {"reputation": 1, "user_id": 13785724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd5fff7db70907227094835e9ef1905?s=128&d=identicon&r=PG&f=1", "display_name": "TomRioux", "link": "https://stackoverflow.com/users/13785724/tomrioux"}, "is_accepted": false, "score": 0, "last_activity_date": 1592740042, "creation_date": 1592740042, "answer_id": 62498085, "question_id": 39003028, "link": "https://stackoverflow.com/questions/39003028/check-string-for-uppercase-characters/62498085#62498085", "title": "Check string for uppercase characters", "body": "<pre><code>Function isUpperCase(parString As String) As Boolean\n    Dim value As Integer\n    value = Asc(Left(parString, 1))\n    isUpperCase = (value &gt;= 65 And value &lt;= 90) Or _\n                  (value &gt;= 192 And value &lt;= 214) Or _\n                  (value &gt;= 216 And value &lt;= 223) Or _\n                  (value = 128) Or _\n                  (value = 138) Or _\n                  (value = 140) Or _\n                  (value = 142) Or _\n                  (value = 154) Or _\n                  (value = 156) Or _\n                  (value &gt;= 158 And value &lt;= 159) Or _\n                  (value = 163) Or _\n                  (value = 165)\nEnd Function 'isUpperCase\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 2, "last_activity_date": 1597343755, "last_edit_date": 1597343755, "creation_date": 1597108368, "answer_id": 63350130, "question_id": 39003028, "link": "https://stackoverflow.com/questions/39003028/check-string-for-uppercase-characters/63350130#63350130", "title": "Check string for uppercase characters", "body": "<p>It's as simple as this:</p>\n<pre><code>Function IsUpper(ByVal s) As Boolean\n    IsUpper = UCase(s) = s\nEnd Function\n</code></pre>\n<p>The idea here is to create a copy of the string and transform the copy to upper case. If the input argument string was indeed upper case to begin with then the transformed copy should now equal the input exactly.</p>\n<p>If you have changed Excel VBA's default for comparing text values to <code>Option Compare Text</code> then you will need a different solution. But this case is rare. The above should work in Excel VBA the vast majority of times.</p>\n<p>The following function based on RegEx is one alternative that will work even with <code>Option Compare Text</code>:</p>\n<pre><code>Function IsUpper(s) As Boolean\n    With CreateObject(&quot;VBScript.RegExp&quot;)\n        .Pattern = &quot;^[^a-z]*$&quot;\n        IsUpper = .Test(s)\n    End With\nEnd Function\n</code></pre>\n<p>And this second function will also work in Access VBA which defaults to another string comparison option.</p>\n"}, {"comments": [{"owner": {"reputation": 20105, "user_id": 7920473, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10155688613669453/picture?type=large", "display_name": "Arun Vinoth", "link": "https://stackoverflow.com/users/7920473/arun-vinoth"}, "edited": false, "score": 0, "creation_date": 1597448623, "post_id": 63418448, "comment_id": 112145897, "body": "add some context to explain how your answer will solve problem, that will really help the community in long run."}, {"owner": {"reputation": 1, "user_id": 13785724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd5fff7db70907227094835e9ef1905?s=128&d=identicon&r=PG&f=1", "display_name": "TomRioux", "link": "https://stackoverflow.com/users/13785724/tomrioux"}, "reply_to_user": {"reputation": 20105, "user_id": 7920473, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10155688613669453/picture?type=large", "display_name": "Arun Vinoth", "link": "https://stackoverflow.com/users/7920473/arun-vinoth"}, "edited": false, "score": 0, "creation_date": 1597573042, "post_id": 63418448, "comment_id": 112171616, "body": "Function isAllUppercase will test all characters in the string"}], "tags": [], "owner": {"reputation": 1, "user_id": 13785724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd5fff7db70907227094835e9ef1905?s=128&d=identicon&r=PG&f=1", "display_name": "TomRioux", "link": "https://stackoverflow.com/users/13785724/tomrioux"}, "is_accepted": false, "score": 0, "last_activity_date": 1597430686, "creation_date": 1597430686, "answer_id": 63418448, "question_id": 39003028, "link": "https://stackoverflow.com/questions/39003028/check-string-for-uppercase-characters/63418448#63418448", "title": "Check string for uppercase characters", "body": "<pre><code>Function isAllUppercase(parString As String) As Boolean\n    Dim lenParString As Long\n    Dim pos As Long\n    Dim temp As String\n    lenParString = Len(parString)\n    isAllUppercase = True\n    For pos = 1 To lenParString\n        temp = Mid(parString, pos, 1)\n        If (isAlpha(temp) And isUpperCase(temp) = False) Then\n            isAllUppercase = False\n            Exit Function\n        End If\n    Next pos\nEnd Function 'isAllUppercase\n\nFunction isAlpha(parString As String) As Boolean\n    Dim lenParString As Integer\n    Dim pos As Integer\n    lenParString = Len(parString)\n    For pos = 1 To lenParString\n        Select Case Asc(Mid(parString, pos, 1))\n            Case 65 To 90, _\n                 97 To 122, _\n                 138, _\n                 140, _\n                 142, _\n                 154, _\n                 156, _\n                 158 To 159, _\n                 192 To 214, _\n                 216 To 246, _\n                 249 To 255\n'               65-90=A-Z, 97-122=a-z\n'               138=\u0160, 140=\u0152, 142=\u017d, 154=\u0161, 156=\u0153, 158=\u017e, 159=\u0178, 192-214=\u00c0-\u00d6, 216-246=\u00d8-\u00f6, 248-255=\u00f8-\u00ff\n                isAlpha = True\n            Case Else\n                isAlpha = False\n                Exit For\n        End Select\n    Next pos\nEnd Function 'isAlpha\n\nFunction isUpperCase(parString As String) As Boolean\n    Select Case Asc(Left(parString, 1))\n        Case 65 To 90, _\n             138, _\n             140, _\n             142, _\n             159, _\n             192 To 214, _\n             216 To 222\n'           65-90=A-Z\n'           138=\u0160, 140=\u0152, 142=\u017d, 159=\u0178, 192-214=\u00c0-\u00d6, 216-222=\u00d8-\u00de\n            isUpperCase = True\n        Case Else\n            isUpperCase = False\n    End Select\nEnd Function 'isUpperCase\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4446, "favorite_count": 0, "accepted_answer_id": 39003081, "answer_count": 7, "score": 2, "last_activity_date": 1597430686, "creation_date": 1471455389, "last_edit_date": 1569594240, "question_id": 39003028, "link": "https://stackoverflow.com/questions/39003028/check-string-for-uppercase-characters", "title": "Check string for uppercase characters", "body": "<p>How do I check each character in a cell to see if it is upper case?</p>\n\n<p>UCASE converts letters to uppercase but I want to check.</p>\n\n<p>I'm not sure where the \"do\" statement should go.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function Italic(rng As Range) As Variant\n    Dim strng As String\n    Dim iEnd As Long, iIni As Long, strngLen As Long\n\n    strngLen = Len(rng.Value2)\n    iIni = 1\n\n    Do While iEnd &lt;= strngLen\n       Do While UCase(Mid(rng.Value, iEnd, 1)) = Mid(rng.Value, iEnd, 1) And Not rng.Characters(iEnd, 1).Font.Italic\n            If iEnd = strngLen Then Exit Do\n            iEnd = iEnd + 1\n        Loop\n        If iEnd &gt; iIni Then strng = strng &amp; Mid(rng.Value2, iIni, iEnd - iIni) &amp; \"|\"\n        iEnd = iEnd + 1\n        iIni = iEnd\n    Loop\n\n    If strng &lt;&gt; \"\" Then Italic = Split(Left(strng, Len(strng) - 1), \"|\")\n\nEnd Function\n</code></pre>\n\n<p>I'm not sure what I should do within that \"uppercase\".</p>\n"}, {"tags": ["vba", "ms-access", "report"], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1471456175, "creation_date": 1471456175, "answer_id": 39003244, "question_id": 39002902, "link": "https://stackoverflow.com/questions/39002902/cant-change-background-color-in-access/39003244#39003244", "title": "Can&#39;t change background color in access", "body": "<p>Give this a shot, you were pretty close.</p>\n\n<pre><code>Const WHITE = 16777215\nConst GRAY = 14540253\nPrivate Sub Detail_Print(Cancel As Integer, PrintCount As Integer)\n    If Len(Trim(Me![Text61])) = 0 Then GoTo color_box\n\n    If (Me![LineNum] Mod 2) = 0 Then\n        Me![Text60].BackColor = GRAY\n        Me![bmnh].BackColor = GRAY\n        Me![c_val].BackColor = GRAY\n        Me![Text61].BackColor = GRAY\n    Else\n        Me![Text60].BackColor = WHITE\n        Me![c_val].BackColor = WHITE\n        Me![Text61].BackColor = WHITE\n        Me![bmnh].BackColor = WHITE\n    End If\n\nexit_here:\n    Exit Sub\n\ncolor_box:  \n    Me![Text61].BackColor = GRAY\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6727504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e7413982677972f301a3ca2fe3a9d41?s=128&d=identicon&r=PG&f=1", "display_name": "kevin t", "link": "https://stackoverflow.com/users/6727504/kevin-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593958019, "creation_date": 1471454923, "last_edit_date": 1593958019, "question_id": 39002902, "link": "https://stackoverflow.com/questions/39002902/cant-change-background-color-in-access", "title": "Can&#39;t change background color in access", "body": "<p>I've attempted multiple changes to this, I'm trying to fill the background on an empty box in an access report but can't get this to do so. My eyes are exhausted and just don't see where I've gone wrong</p>\n\n<pre><code>Private Sub Detail_Print(Cancel As Integer, PrintCount As Integer)\nOn Len(Trim(Me![Text61])) = vbNullString GoTo color_box\n\nConst WHITE = 16777215\nConst GRAY = 14540253\n\n If (Me![LineNum] Mod 2) = 0 Then\n\n    Me![Text60].BackColor = GRAY\n    Me![bmnh].BackColor = GRAY\n    Me![c_val].BackColor = GRAY\n    Me![Text61].BackColor = GRAY\n\nElse\n\n    Me![Text60].BackColor = WHITE\n    Me![c_val].BackColor = WHITE\n    Me![Text61].BackColor = WHITE\n    Me![bmnh].BackColor = WHITE\n\nEnd If\n\nexit_here:\n    Exit Sub\n\n\ncolor_box:\n        Me![Text61].BackColor = GRAY\nResume exit_here\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1471454936, "post_id": 39002857, "comment_id": 65357367, "body": "When using multiple workbooks/worksheets, you should use variables to store those.  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Don&#39;t use <code>.Select</code>/<code>.Activate</code></a>. You&#39;re probably getting errors from that.  For instance, <code>erow</code> should equal <code>ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Offset(1, 0).Row</code>, but you should swich out the <code>Activesheet</code> with the one you intend to work with.  Also, what errors do you get, at what line?"}, {"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1471455620, "post_id": 39002857, "comment_id": 65357741, "body": "@BruceWayne. In an attempt to copy A &amp; L i adjusted the following line which returns an error 13 (type mismatch) <code>Range(Cells(i, 1) And Cells(i, 12)).Select</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1471456231, "post_id": 39002857, "comment_id": 65358056, "body": "That&#39;s odd - it shouldn&#39;t. What is the code before that? I&#39;m going to assume it&#39;s your use of the worksheets. If the data is on the &quot;Statistics&quot; sheet, try this: <code>Worksheets(&quot;Statistics&quot;).Range(Worksheets(&quot;Statistics&quot;).Cell&zwnj;&#8203;s(i, 1), Worksheets(&quot;Statistics&quot;).Cells(i, 12)).Select</code>"}, {"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1471457208, "post_id": 39002857, "comment_id": 65358580, "body": "Isn&#39;t the solution provided copying the range from A to L rather than A and L? Coping the entire row is not an issue, i&#39;m just trying to copy those two columns in particular"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 1, "creation_date": 1471460216, "post_id": 39003833, "comment_id": 65360238, "body": "This is great, thanks Bruce. Admittedly it&#39;s not quite working yet but I can tweak it to work with my sheet. Thank you :)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1471458305, "creation_date": 1471458305, "answer_id": 39003833, "question_id": 39002857, "link": "https://stackoverflow.com/questions/39002857/transferring-data-from-one-workbook-to-another/39003833#39003833", "title": "Transferring data from one workbook to another", "body": "<p>I think I see what you're trying. I suggest giving your worksheets a variable, and then you can select entire columns via <code>Range()</code>:</p>\n\n<pre><code>Sub t()\nDim mainWS As Worksheet\nSet mainWS = ActiveWorkbook.Worksheets(\"Sheet1\") ' Tweak as necessary, this sheet is where your main data is (the non-blank cell, and \"\u00fc\") \n\nlastRow = mainWS.Cells(mainWS.Rows.Count,1).End(xlUp).Row 'or whatever your formula is. Make sure to reference the worksheet\n\nFor i = 3 To lastRow\n    If mainWS.Cells(i, 1) &lt;&gt; \"\" And mainWS.Cells(i, 13) = \"\u00fc\" Then\n        mainWS.Range(\"A:A,L:L\").Select\n        Selection.Copy\n\n        Workbooks.Open Filename:=iForm\n        'Worksheets(\"Statistics\").Select\n        Set statWS = ActiveWorkbook.Worksheets(\"Statistics\")\n\n        erow = statWS.Cells(statWS.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n        statWS.Cells(erow, 1).PasteSpecial Paste:=xlPasteValues\n        ActiveWorkbook.Save\n        ActiveWorkbook.Close\n        Application.CutCopyMode = False\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>And note, I left in <code>.Select</code>, just to keep it similar to your OP. Although you should definitely look into <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code></a></p>\n"}], "owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 39003833, "answer_count": 1, "score": 0, "last_activity_date": 1471458305, "creation_date": 1471454733, "question_id": 39002857, "link": "https://stackoverflow.com/questions/39002857/transferring-data-from-one-workbook-to-another", "title": "Transferring data from one workbook to another", "body": "<p>The below script currently loops through a list of data and copies a range from one workbook to another depending on a value in a cell. </p>\n\n<pre><code>For i = 3 To LastRow\n\nIf Cells(i, 1) &lt;&gt; \"\" And Cells(i, 13) = \"\u00fc\" Then\nRange(Cells(i, 1), Cells(i, 12)).Select\nSelection.Copy\n\nworkbooks.Open Filename:=iForm\nWorksheets(\"Statistics\").Select\nerow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\nWorksheets(\"Statistics\").Cells(erow, 1).PasteSpecial Paste:=xlPasteValues\nActiveWorkbook.Save\nActiveWorkbook.Close\nApplication.CutCopyMode = False\nEnd If\nNext i\n</code></pre>\n\n<p>Rather copying the range from A:L I would like to copy columns A &amp; L, I've tried updating this however I keep getting errors, please help.\nI thank you in advance.</p>\n"}, {"tags": ["vba", "excel", "chi-squared"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1471454692, "post_id": 39002775, "comment_id": 65357237, "body": "Which line do you receive this error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1471454866, "post_id": 39002775, "comment_id": 65357326, "body": "Try it as <code>Chi_square_result = Application.Chitest(my_array1, my_array2)</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471454934, "post_id": 39002775, "comment_id": 65357364, "body": "<code>formula(2) = my_array1</code> should be <code>formula(2) = my_array</code>?"}, {"owner": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471455032, "post_id": 39002775, "comment_id": 65357421, "body": "This line - &gt; formula(2) = my_array1"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471455084, "post_id": 39002775, "comment_id": 65357445, "body": "You do not have a <code>my_array1</code>. You have <code>my_array</code>"}, {"owner": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471455114, "post_id": 39002775, "comment_id": 65357457, "body": "Siddharth, please ignore this. just a typo. i was trying other method to solve this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1471455169, "post_id": 39002775, "comment_id": 65357498, "body": "You cannot stuff a variant array into a single array element of a string array."}, {"owner": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471455442, "post_id": 39002775, "comment_id": 65357638, "body": "I tried changing that array into a string array. still the same error. Or am i misunderstanding it?  I tried the Chi_square_result = Application.Chitest(my_array, my_array2) . It returns 0"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471455543, "post_id": 39002996, "comment_id": 65357690, "body": "Hi SandPiper, what would be more straight forward way? I think the problem i have is turning all the values i have into array because Chisquare function only takes 2 arrays as input."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471460359, "post_id": 39002996, "comment_id": 65360328, "body": "I was not familiar with it, so I looked up CHITEST(). It is a worksheet function, so the way to access it in VBA would be Application.WorksheetFunction.ChiTest(Range1, Range2). It is expecting a range, and I do not know of a way to pass that function anything other than a range. That is likely why you are getting an error."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471460558, "post_id": 39002996, "comment_id": 65360446, "body": "Also, your line where you Dim out your observed variables has different variable names than the defined observed variables right below it. Then, in your arrays you are not using any of these variables but instead inserting brand new ones into the elements."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471460812, "post_id": 39002996, "comment_id": 65360563, "body": "Out of curiosity, is there any reason to do this task in VBA instead of on a spreadsheet? If you really need it in VBA, there are a few ways to do it. You can do the calculation on a worksheet with a cell formula then refer to that cell value in VBA. Or, you can look up what that chi test formula is and retype it in VBA using the values you have."}, {"owner": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1474259117, "post_id": 39002996, "comment_id": 66441104, "body": "Just need to create a new function that has chi square as part of the calculation. we want to avoid doing the lookup in the worksheet cells"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1474288840, "post_id": 39002996, "comment_id": 66456509, "body": "Always a good practice. Continuous references back to cells slows everything down."}], "tags": [], "owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "is_accepted": false, "score": 2, "last_activity_date": 1471455259, "creation_date": 1471455259, "answer_id": 39002996, "question_id": 39002775, "link": "https://stackoverflow.com/questions/39002775/computing-the-chisquare/39002996#39002996", "title": "Computing the ChiSquare", "body": "<p>If you are writing a function, you have your format wrong.</p>\n\n<pre><code>Function Chi_square_result(A as Long, B as Long, C as Long, D as Long) as Double\n    'All your manipulations here\n\n    Chi_square_result = (Your math equation)\n\nEnd Function\n</code></pre>\n\n<p>You also never defined my_array1, I am assuming it is supposed to be where you typed 'my_array'. I also do not think Join is your best bet. You are trying to do an awful lot of array manipulation, and I think your dimensions are getting you. It would be better to do it in a more straight forward way.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471456327, "post_id": 39003063, "comment_id": 65358113, "body": "Jeeped, thanks. I use this in immediate window and it works. However, using the same method have the &#39;Public Function chi_square_2() As Integer&#39; and have the &#39;chi_square_2 = Application.ChiTest(my_array1, my_array2)&#39;  It returns 0. I am not familiar with VBA so I am not sure what i did wrong"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471456410, "post_id": 39003063, "comment_id": 65358162, "body": "I cannot test fully as you&#39;ve provided no sample data nor expected results but <code>0.257280177154182</code> is not an integer, it is a double."}, {"owner": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "edited": false, "score": 0, "creation_date": 1471456672, "post_id": 39003063, "comment_id": 65358303, "body": "oh, nevermind. I had a typo. That&#39;s greatlearning something new about Application object and evalute :) thanks"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1471455538, "creation_date": 1471455538, "answer_id": 39003063, "question_id": 39002775, "link": "https://stackoverflow.com/questions/39002775/computing-the-chisquare/39003063#39003063", "title": "Computing the ChiSquare", "body": "<p>The evaluate is expecting worksheet cell ranges. Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194565.aspx\" rel=\"nofollow\">Excel Application object</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow\">WorksheetFunction object</a> to compute the function within VBA.</p>\n\n<p>This proofs out.</p>\n\n<pre><code>Dim dbl As Double\nDim my_array1(1, 1)\nmy_array1(0, 0) = 1\nmy_array1(0, 1) = 2\nmy_array1(1, 0) = 3\nmy_array1(1, 1) = 4\n\nDim my_array2(1, 1)\nmy_array2(0, 0) = 2\nmy_array2(0, 1) = 3\nmy_array2(1, 0) = 4\nmy_array2(1, 1) = 5\n\ndbl = Application.ChiTest(my_array1, my_array2)\nDebug.Print dbl\n</code></pre>\n\n<p>Result from the VBE's Immediate window: <code>0.257280177154182</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 4535248, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8a1924a6a0d1044c43bcae659ed52e0?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/4535248/brian-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 0, "accepted_answer_id": 39003063, "answer_count": 2, "score": 1, "last_activity_date": 1471455711, "creation_date": 1471454432, "last_edit_date": 1471455711, "question_id": 39002775, "link": "https://stackoverflow.com/questions/39002775/computing-the-chisquare", "title": "Computing the ChiSquare", "body": "<p>I am writing a user-defined function in excel vba. So this new function:</p>\n\n<ol>\n<li>takes 4 input value</li>\n<li>some calculation to generate into 8 numbers. ( 2 arrays - each array has 4 numbers)</li>\n<li>do a chisquare test </li>\n<li>return 1 output value</li>\n</ol>\n\n<p>Code:</p>\n\n<pre><code>Sub test()\n    Dim A, B, C, D As Variant\n    A = 33\n    B = 710\n    C = 54\n    D = 656\n\n    'Observed Value\n    Dim O_A As Variant\n    Dim O_B As Variant\n    Dim O_V As Variant\n    Dim O_D As Variant\n\n    'Define Observer Value\n    O_C_A = 'Some Calucation'\n    O_C_B = 'Some Calucation'\n    O_T_C = 'Some Calucation'\n    O_T_C = 'Some Calucation'\n\n    'Expected Value\n    Dim E_C_A As Variant\n    Dim E_C_B As Variant\n    Dim E_T_C As Variant\n    Dim E_T_D As Variant\n\n    'Define Expected Value\n    E_C_A = 'Some Calucation'\n    E_C_B = 'Some Calucation'\n    E_T_C = 'Some Calucation'\n    E_T_D = 'Some Calucation'\n\n    'Create array(2x2)\n    Dim Chi_square_result As Variant\n\n    Dim my_array(1, 1)\n    my_array(0, 0) = O_C_Mesaurement\n    my_array(0, 1) = O_C_Balance\n    my_array(1, 0) = O_T_Measurement\n    my_array(1, 1) = O_T_Balance\n\n    Dim my_array2(1, 1)\n    my_array2(0, 0) = E_C_Mesaurement\n    my_array2(0, 1) = E_C_Balance\n    my_array2(1, 0) = E_T_Measurement\n    my_array2(1, 1) = E_T_Balance\n\n    'Create a chi square test formula'\n    Dim formula(1 To 5) As String\n    formula(1) = \"CHITEST(\"\n    formula(2) = my_array\n    formula(3) = \",\"\n    formula(4) = my_array2\n    formula(5) = \")\"\n\n    'Chi Square\n    Chi_square_result = evaluate(Join(formula, \"\"))\nend sub\n</code></pre>\n\n<p>It gives a runtime error '13', saving type mismatch. This is because of the concatenation of the formula. </p>\n"}, {"tags": ["excel", "vba", "ms-access", "openfiledialog", "cancel-button"], "comments": [{"owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "edited": false, "score": 0, "creation_date": 1471466926, "post_id": 39002662, "comment_id": 65363684, "body": "I suggest you change your tags to include excel-vba and to remove vb.net"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6727456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d5f43330f5758c0c0203afc206a200e?s=128&d=identicon&r=PG&f=1", "display_name": "peterqng", "link": "https://stackoverflow.com/users/6727456/peterqng"}, "edited": false, "score": 0, "creation_date": 1471457167, "post_id": 39003055, "comment_id": 65358559, "body": "Hmm... still seems to be popping up again after I press the cancel button. Sorry I am a rather novice with this."}, {"owner": {"reputation": 60, "user_id": 6480535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5IcwK.jpg?s=128&g=1", "display_name": "xeph", "link": "https://stackoverflow.com/users/6480535/xeph"}, "reply_to_user": {"reputation": 3, "user_id": 6727456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d5f43330f5758c0c0203afc206a200e?s=128&d=identicon&r=PG&f=1", "display_name": "peterqng", "link": "https://stackoverflow.com/users/6727456/peterqng"}, "edited": false, "score": 0, "creation_date": 1471458742, "post_id": 39003055, "comment_id": 65359463, "body": "even when replacing your while loop? are you in visual studio or using vba in access/excel?"}, {"owner": {"reputation": 3, "user_id": 6727456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d5f43330f5758c0c0203afc206a200e?s=128&d=identicon&r=PG&f=1", "display_name": "peterqng", "link": "https://stackoverflow.com/users/6727456/peterqng"}, "edited": false, "score": 0, "creation_date": 1471465378, "post_id": 39003055, "comment_id": 65362921, "body": "VBA in AccessExcel"}, {"owner": {"reputation": 60, "user_id": 6480535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5IcwK.jpg?s=128&g=1", "display_name": "xeph", "link": "https://stackoverflow.com/users/6480535/xeph"}, "reply_to_user": {"reputation": 3, "user_id": 6727456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d5f43330f5758c0c0203afc206a200e?s=128&d=identicon&r=PG&f=1", "display_name": "peterqng", "link": "https://stackoverflow.com/users/6727456/peterqng"}, "edited": false, "score": 0, "creation_date": 1471466096, "post_id": 39003055, "comment_id": 65363269, "body": "I can&#39;t test more since I don&#39;t have office near me but I think that changing your loop should resolve your problem since you&#39;re never exiting the loop when you click on <i>Cancel</i> (else clause of <code>response = vbYes</code>) because fileSet is still set to <code>False</code>. I&#39;ve updated my answer if you want to check it."}], "tags": [], "owner": {"reputation": 60, "user_id": 6480535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5IcwK.jpg?s=128&g=1", "display_name": "xeph", "link": "https://stackoverflow.com/users/6480535/xeph"}, "is_accepted": false, "score": 0, "last_activity_date": 1471459186, "last_edit_date": 1471459186, "creation_date": 1471455516, "answer_id": 39003055, "question_id": 39002662, "link": "https://stackoverflow.com/questions/39002662/cancel-button-on-open-file-dialog-doesnt-close-window-for-visual-basic/39003055#39003055", "title": "Cancel Button On Open File Dialog Doesn&#39;t Close Window For Visual Basic", "body": "<p>your fileSet is equal to False in your else clause</p>\n\n<pre><code>If response = vbYes Then\n    fileSet = True\nElse\n    fileSet = False\nEnd If\n</code></pre>\n\n<p>I would first replace with a do/while loop because you can only exit prematurely with a GOTO statement if I remember correctly.</p>\n\n<pre><code>Dim strFilter As String\nDim strOutputFileName As String, compareFileName As String, response As Integer, fileSet As Boolean\n\nstrFilter = ahtAddFilterItem(strFilter, \"Excel Files (*.xlsx)\", \"*.xlsx\")\n\nfileSet = False\nDo While fileSet = False\n    strOutputFileName = ahtCommonFileOpenSave( _\n                    Filter:=strFilter, _\n                    OpenFile:=False, _\n                    DialogTitle:=\"Choose an image file...\", _\n                    Flags:=ahtOFN_HIDEREADONLY)\n\n\n    If Len(strOutputFileName) &gt; 0 Then\n        compareFileName = Dir(strOutputFileName)\n        If compareFileName &lt;&gt; \"\" Then 'find exist file with the same name\n            response = MsgBox(\"The current file name already exists. Do you want to replace the file \" &amp; strOutputFileName &amp; \" with the current one?\", vbYesNo)\n            If response = vbYes Then\n                fileSet = True      'replace old file\n                Kill strOutputFileName\n            Else\n                fileSet = False\n                Exit Do\n            End If\n        Else 'no file exists with the same name\n            fileSet = True\n        End If\n    End If\nLoop\nMe.txt_File_Level1.Value = strOutputFileName\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6727456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d5f43330f5758c0c0203afc206a200e?s=128&d=identicon&r=PG&f=1", "display_name": "peterqng", "link": "https://stackoverflow.com/users/6727456/peterqng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 818, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507547801, "creation_date": 1471454064, "last_edit_date": 1507547801, "question_id": 39002662, "link": "https://stackoverflow.com/questions/39002662/cancel-button-on-open-file-dialog-doesnt-close-window-for-visual-basic", "title": "Cancel Button On Open File Dialog Doesn&#39;t Close Window For Visual Basic", "body": "<p>I am writing a window asking for a prompt to ask the user to save a file. It closes and asks if they want to overwrite a file, except when I press cancel it is still stuck in the while loop. Does anyone know the code for a cancel/close window? </p>\n\n<pre><code>Private Sub btn_Browse1_Click()\n\n  Dim strFilter As String\nDim strOutputFileName As String, compareFileName As String, response As Integer, fileSet As Boolean\n\nstrFilter = ahtAddFilterItem(strFilter, \"Excel Files (*.xlsx)\", \"*.xlsx\")\n\nfileSet = False\nWhile fileSet = False\n    strOutputFileName = ahtCommonFileOpenSave( _\n                        Filter:=strFilter, _\n                        OpenFile:=False, _\n                        DialogTitle:=\"Choose an image file...\", _\n                        Flags:=ahtOFN_HIDEREADONLY)\n\n\n        If Len(strOutputFileName) &gt; 0 Then\n        compareFileName = Dir(strOutputFileName)\n        If compareFileName &lt;&gt; \"\" Then 'find exist file with the same name\n            response = MsgBox(\"The current file name already exists. Do you want to replace the file \" &amp; strOutputFileName &amp; \" with the current one?\", vbYesNo)\n            If response = vbYes Then\n                fileSet = True      'replace old file\n                Kill strOutputFileName\n            Else\n                fileSet = False\n            End If\n        Else 'no file exists with the same name\n            fileSet = True\n        End If\n\n    End If\nWend\nMe.txt_File_Level1.Value = strOutputFileName\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1471876533, "post_id": 39003774, "comment_id": 65512399, "body": "Is there a reason you did not add a .OnAction? When I add one, it doesn&#39;t want to enter the referenced function."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1471458115, "creation_date": 1471458115, "answer_id": 39003774, "question_id": 39002396, "link": "https://stackoverflow.com/questions/39002396/custom-right-click-while-inside-a-cell/39003774#39003774", "title": "Custom right click while inside a cell", "body": "<p>That is accessed through the <code>Formula Bar</code> Commandbar.</p>\n\n<p>See the following code and let us know if it resolves the problem.</p>\n\n<pre><code>Dim cbar As CommandBar\n\nSet cbar = Application.CommandBars(\"Formula Bar\")\n\nWith cbar.Controls.Add(Temporary:=True, Type:=msoControlButton, Before:=1)\n    .FaceId = 1111\n    .Caption = \"TEST\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 39003774, "answer_count": 1, "score": 0, "last_activity_date": 1471458115, "creation_date": 1471453130, "question_id": 39002396, "link": "https://stackoverflow.com/questions/39002396/custom-right-click-while-inside-a-cell", "title": "Custom right click while inside a cell", "body": "<p>I have a custom right click menu using the following syntax to add stuff to the context menu:</p>\n\n<pre><code>Function RightClickOnMoMAction(targ As String)\n    Dim cbar As CommandBar\n    Set cbar = Application.CommandBars(\"Cell\")\n\n    With cbar.Controls.add(Temporary:=True, Type:=msoControlButton, before:=1)\n        .BeginGroup = False\n        .FaceId = 1111\n        .Caption = targ\n        .OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!'rcFollowSlide \"\"\" &amp; targ &amp; \"\"\"\" &amp; \"'\"\n    End With\nEnd Function\n</code></pre>\n\n<p>It works very well when I right click a cell. However, when I \"enter\" in the cell, for example if I'm writing something inside the cell, the right click has a different context menu altogether. <strong>How do I trap the right click when INSIDE a cell? If it's even possible.</strong> I want to have access to my custom menu in both cases.</p>\n\n<p>For reference, here is my context menu:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F0sDx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F0sDx.png\" alt=\"enter image description here\"></a></p>\n\n<p>And here is the right click when editing the inside of a cell (The cursor disappeared but I drew it in blue over the screen capture, I am writing in the cell):</p>\n\n<p><a href=\"https://i.stack.imgur.com/UThh9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UThh9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1471450692, "post_id": 39001639, "comment_id": 65355036, "body": "What do you hope to gain from preventing someone from changing the filters? If you have data you don&#39;t want people to view, then only grant access to an edited document. Anyone with access to your filtered spreadsheet could still read the underlying file to view the hidden data."}, {"owner": {"reputation": 127, "user_id": 6479946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad469122f51c6849f1d78fc7dc61ecf9?s=128&d=identicon&r=PG&f=1", "display_name": "Doog_Dooger", "link": "https://stackoverflow.com/users/6479946/doog-dooger"}, "reply_to_user": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1471450890, "post_id": 39001639, "comment_id": 65355162, "body": "Hi Phylogenesis. I have written the code to detect the users employee ID based on the computer username <code>Int(Environ(&quot;Username&quot;))</code> and it filters the data to only show their data. I have protected the sheet so they cannot access anything else but the Advanced filter option is causing the problem. I understand that if they really want to get in to the code to disable this then they can but this is just to stop most users from getting access to this."}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1471451117, "post_id": 39001639, "comment_id": 65355286, "body": "The problem is that you can read the file outside of Excel (or use VBA) to read the hidden data. If you&#39;re doing this for security reasons, it&#39;s pretty much a waste of time."}, {"owner": {"reputation": 127, "user_id": 6479946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad469122f51c6849f1d78fc7dc61ecf9?s=128&d=identicon&r=PG&f=1", "display_name": "Doog_Dooger", "link": "https://stackoverflow.com/users/6479946/doog-dooger"}, "reply_to_user": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1471451315, "post_id": 39001639, "comment_id": 65355405, "body": "It is partially for security but I understand that if they really want access to the data they can get it. However they would need to go out of their way to access this if I can disable Advanced filter. Even so I would like to understand if this is possible in Excel 2013 or if they have stopped us from disabling this. Thanks"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1471453752, "post_id": 39001639, "comment_id": 65356719, "body": "Just to be clear: there are numerous possibilities to bypass Excel security (if you can even call that) once you allow someone to open an Excel file. Just remember that the protection is only as good as the software enforcing it. Excel files cannot only be opened with MS Excel! And there are numerous programs out there which simply don&#39;t enforce  <i>any</i> kind of protection once the file is open. Yet, a bit easier: just create a new empty Excel file and put in cell <code>A1</code> the formula <code>=[ProtectedExcelFile.xlsm]Sheet1!A1</code> and copy the formula down and across. And there you have an unprotected copy."}, {"owner": {"reputation": 143, "user_id": 7480185, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-gurNcdV0CkQ/AAAAAAAAAAI/AAAAAAAAHWA/StXs4OsnKC8/photo.jpg?sz=128", "display_name": "Robert Loughrey", "link": "https://stackoverflow.com/users/7480185/robert-loughrey"}, "edited": false, "score": 0, "creation_date": 1581957501, "post_id": 39001639, "comment_id": 106602251, "body": "Seriously I think we understand that someone CAN get to the data if they want to. I myself would like an answer to the question however. If one of my employees loads up the program and accesses the data then that&#39;s enough for me to prove their bad actions and fire them. I need a &quot;nuisance lock&quot;  to keep my good employees from accidentally seeing what they didn&#39;t mean to."}], "answers": [{"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 1, "last_activity_date": 1471454792, "last_edit_date": 1525816150, "creation_date": 1471453876, "answer_id": 39002606, "question_id": 39001639, "link": "https://stackoverflow.com/questions/39001639/disable-advanced-filter-in-excel-2013/39002606#39002606", "title": "Disable Advanced Filter in Excel 2013", "body": "<p><br><strong><em>Solution Suggested</em></strong><br>\nThe approach will be hiding the button from the user interface: the advantage on this solution is that the code is not in VBA (entirely) so, <em>is not that easy</em> for the user to modify it (or know what is going on backstage).\n<br><strong><em>Answer Explanation/Next steps</em></strong><br>\nIt's really a deep answer with many steps involved in it so, I'll just post guidance and some useful links, that way you may research about it first. \n<br>1. Download <a href=\"http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2009/08/06/7293.aspx\" rel=\"nofollow noreferrer\">Custom UI Editor for Microsoft Office</a>: this helps to modify the user interface for the document.\n<br>2. Look for tutorials; start to code there with something basic like adding a tab and a button, <a href=\"http://www.rondebruin.nl/win/s2/win001.htm\" rel=\"nofollow noreferrer\">(this is a good one)</a>\n<br>3. Back to Excel, look for life cycle and custom events, <a href=\"http://www.cpearson.com/excel/Events.aspx\" rel=\"nofollow noreferrer\">this is a good place to start</a>\n<br>4. You'll need to catch the event when the Ribbon is loaded; in that time, you'd need to  disable the button, these links (<a href=\"http://www.rondebruin.nl/win/s2/win012.htm\" rel=\"nofollow noreferrer\">1</a>,<a href=\"http://www.rondebruin.nl/win/s2/win013.htm\" rel=\"nofollow noreferrer\">2</a>) are useful to show the steps and some example workbooks for it.\n<br>5. Locate the ID for the button and disable it (Hint: The idMSO = AdvancedFilterDialog, if you 've followed the previous steps, it will make sense here-).\n<br><strong><em>Further information/Answer Disclaimer</em></strong>\n<br>Excel is not a software that can handle security deeply; if you are trying to restrict the user somehow in the original file, you should try other approaches -IG: a copy of a workbook for reference only, while the master one is saved in a sharepoint only modifiable by people authorized for it-.<br>\n<br> While FAQ in S.O is strict about referencing to other sites without using a proper reference for it, this is a deep step solution that would take pages to explain even a random example; appealing to the guiding topic, this answer should be ok.</p>\n"}], "owner": {"reputation": 127, "user_id": 6479946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad469122f51c6849f1d78fc7dc61ecf9?s=128&d=identicon&r=PG&f=1", "display_name": "Doog_Dooger", "link": "https://stackoverflow.com/users/6479946/doog-dooger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 39002606, "answer_count": 1, "score": 1, "last_activity_date": 1471454792, "creation_date": 1471450550, "last_edit_date": 1531161705, "question_id": 39001639, "link": "https://stackoverflow.com/questions/39001639/disable-advanced-filter-in-excel-2013", "title": "Disable Advanced Filter in Excel 2013", "body": "<p>I was wondering if anyone could help me to disable the Advanced Filter option in Excel 2013.</p>\n\n<p>I have used the following to disable all other data ribbon options:</p>\n\n<pre><code>.Protect UserInterfaceOnly:=True\n</code></pre>\n\n<p>But advanced filter is still able to be selected. With this they can unfilter the data. </p>\n\n<p>The following code used to work in older versions of Excel but I cannot seem to get it to work for Excel 2013:</p>\n\n<pre><code>    Application.CommandBars(\"Worksheet Menu Bar\").Controls _\n    (\"&amp;Data\").Controls(\"&amp;Filter\").Controls(\"&amp;Advanced Filter...\").Enabled = False\n</code></pre>\n\n<p>If anyone could help me out with this or point me in the right direction then it would be appreciated. </p>\n\n<p>Thanks guys. </p>\n"}, {"tags": ["html", "vba", "collections", "elements"], "comments": [{"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1471449850, "post_id": 39001283, "comment_id": 65354511, "body": "I have been trying with .getElementsBy...but as mentioned here: <a href=\"http://stackoverflow.com/questions/15191847/use-getelementbyid-on-htmlelement-instead-of-htmldocument\" title=\"use getelementbyid on htmlelement instead of htmldocument\">stackoverflow.com/questions/15191847/&hellip;</a> | in vba we cannot write: Document.getElementById(&quot;target&quot;).getElementsByTagName(&quot;tr&quot;)&zwnj;&#8203;."}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "edited": false, "score": 0, "creation_date": 1471452055, "post_id": 39001679, "comment_id": 65355794, "body": "I will debug but I don&#39;t think this is correct as this script would also catch the &quot;tr&quot; under &quot;thead&quot; and I said I only want those under &quot;tbody&quot;"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 2, "last_activity_date": 1471452206, "last_edit_date": 1471452206, "creation_date": 1471450674, "answer_id": 39001679, "question_id": 39001283, "link": "https://stackoverflow.com/questions/39001283/vba-create-collection-with-html-elements/39001679#39001679", "title": "Vba create collection with HTML elements", "body": "<p>This should work for what you are after. Basically you want to select the element that contains the table, then select all the TRs of that table. </p>\n\n<p>Updated to include selecting the table body as well. </p>\n\n<pre><code> dim Elements as Object\n\n Set Elements = Browser.Document.getElementsByClassName(\"mega-table\")(0).getElementsByTag\u200c\u200bName(\"tbody\")\u200c(0).getElementsByTag\u200c\u200bName(\"tr\")\u200c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": -1, "last_activity_date": 1471451863, "creation_date": 1471451863, "answer_id": 39002010, "question_id": 39001283, "link": "https://stackoverflow.com/questions/39001283/vba-create-collection-with-html-elements/39002010#39002010", "title": "Vba create collection with HTML elements", "body": "<pre><code>Sub IE()\n\n'   Internet Controls Libraray\n'   Microsoft HTML Controls Library\n\nDim I As SHDocVw.InternetExplorer\nDim D As HTMLDocument\nDim C As MSHTML.IHTMLElementCollection\nSet I = New SHDocVw.InternetExplorer\n\nI.Visible = True\n\nI.Navigate (\"http://www.stackoverflow.com\")\n\nWhile I.Busy Or I.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nWend\n\nSet D = I.Document\n\nSet C = D.getElementsByTagName(\"TR\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1529565004, "creation_date": 1529565004, "answer_id": 50962443, "question_id": 39001283, "link": "https://stackoverflow.com/questions/39001283/vba-create-collection-with-html-elements/50962443#50962443", "title": "Vba create collection with HTML elements", "body": "<p>You could use a CSS selector:</p>\n\n<pre><code>browser.document.querySelectorAll(\".mega-table tbody tr\")\n</code></pre>\n\n<p>This returns a <strong><em>nodeList</em></strong> rather than a \"collection\"; but you can still loop its length.</p>\n\n<p>It says select <code>tr</code> tags within <code>tbody</code> tag within elements with className (<code>\".\"</code>) of <code>mega-table</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/U9gOe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U9gOe.png\" alt=\"CSS query results\"></a></p>\n"}], "owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1903, "favorite_count": 0, "accepted_answer_id": 39001679, "answer_count": 3, "score": 1, "last_activity_date": 1529565004, "creation_date": 1471449372, "question_id": 39001283, "link": "https://stackoverflow.com/questions/39001283/vba-create-collection-with-html-elements", "title": "Vba create collection with HTML elements", "body": "<p>I am trying to catch web data using VBA.</p>\n\n<p>I have such HTML lines:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div class=\"table-wrapper\"&gt;\n  &lt;table class=\"mega-table\"&gt;\n    &lt;thead&gt;\n       &lt;tr&gt;\u2026&lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n       &lt;tr&gt;\u2026&lt;/tr&gt;\n       &lt;tr&gt;\u2026&lt;/tr&gt;\n       &lt;tr&gt;\u2026&lt;/tr&gt;\n       &lt;tr&gt;\u2026&lt;/tr&gt;\n    &lt;/tbody&gt;\n  &lt;/table&gt;\n&lt;/div&gt;\n</code></pre>\n\n\n\n<p>How can I create a collection for \"tbody\"? (Later I want to loop through all the elements it contains (all the \"tr\")).</p>\n"}, {"tags": ["ms-access", "vba", "office365"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471460965, "post_id": 39001263, "comment_id": 65360633, "body": "Do you have another version or a runtime version of MS-Access installed? Are these computers both 64 bit Windows 10 systems?"}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471548764, "post_id": 39001263, "comment_id": 65403109, "body": "Both are 64 bit running windows 10 and office 365.  FYI the same application runs on a 32 bit windows 7 system.  There is no other version of ACCESS on any of the machines.  I hope this doesn&#39;t mean a reinstall on the failing machine. Also all the drivers are up to date as well and are windows and office updates up to date."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471556967, "post_id": 39001263, "comment_id": 65406784, "body": "Is your code above running in one function or in two? It seems odd that you&#39;ve set the recordset connection and then open it with the &quot;same&quot; connection, assuming colCon variable is still valid. Can you <code>debug.print colCon</code> and copy/paste it to your question?"}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471558974, "post_id": 39001263, "comment_id": 65407459, "body": "Mitch, I pasted Colcon into the question after the Thanks."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471560116, "post_id": 39001263, "comment_id": 65407815, "body": "Just wondering about the OLEDB provider and the Access Database Engine in Office 365. Can you try a simple test of opening that same recordset using DAO? <code>Dim daoRS as DAO.Recordset   SET daoRS = Currentdb.OpenRecordset(ColSQL)</code>"}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471618126, "post_id": 39001263, "comment_id": 65433518, "body": "Ran dao and it worked just fine.  What does that tell us about ADO problem?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471623804, "post_id": 39001263, "comment_id": 65437017, "body": "I&#39;m guessing since I rarely use ADO unless connecting to SQL Server or MySQL, but I do believe it has something to do with the <code>Microsoft.ACE.OLEDB.12.0</code> provider and being on a 64 bit system. If you really want to persist with ADODB, you could try installing the Access 2013 Runtime Redistributable and see if the correct drivers are installed. I tend to stay away from ADO unless pushed into it."}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471635068, "post_id": 39001263, "comment_id": 65442750, "body": "Why do you avoid ADO, I was under the impression that it was the latest and greatest? ADO works when connecting to SQL Server, but not to a dinky ACCESS table.  Maybe we should go to chat. I&#39;d like to learn more. But thanks for the help"}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471643310, "post_id": 39001263, "comment_id": 65446071, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/121390/discussion-between-jpl458-and-dbmitch\">continue this discussion in chat</a>."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471647128, "post_id": 39001263, "comment_id": 65447106, "body": "Sorry - won&#39;t be getting into any long winded discussions about ADO vs DAO - there&#39;s lots of information and debate out there. I&#39;ve been programming in Access for 20 years and it&#39;s just a personal preference based on real life experience with both. Server based databases use very different engines than the JET DAO Engine used on Access tables. ADO was meant to work seamlessly with the SQL Server, and Oracle dbs of the world. Microsoft quit pushing (and defaulting to) ADO - and actually default to DAO in the later versions. By the way - your &quot;dinky&quot; Access databases can reach up to 2GB in size"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1471747450, "post_id": 39001263, "comment_id": 65470286, "body": "and under tools-&gt;references, what reference do you have set  for ADO?"}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "edited": false, "score": 0, "creation_date": 1471891442, "post_id": 39001263, "comment_id": 65520946, "body": "Lesson learned.  If I am accessing SQL Server use ADO.  If going after ACCESS tables use DAO.  BTW I just tried to get to a different ACCESS table with ADO and got the same error on the machine that I write the code on. ALSO I din&#39;t mean that ACCESS tables are &quot;dinky&quot; in general, just the one I ws trying to open.  Only one record."}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "edited": false, "score": 0, "creation_date": 1471891481, "post_id": 39001263, "comment_id": 65520968, "body": "And, Thanks a lot. Really learned something.  jpl458"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "edited": false, "score": 0, "creation_date": 1471553054, "post_id": 39004775, "comment_id": 65405270, "body": "It did not return an error and I have repaired Office online  several times as well as the quick repair.  From my reading I am suspecting a dll problem, but I have no clue as to what it would be or how to find it.  I just tried a couple of solutions that were on utube, but nothing works so far."}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1471462056, "creation_date": 1471462056, "answer_id": 39004775, "question_id": 39001263, "link": "https://stackoverflow.com/questions/39001263/access-class-not-registered/39004775#39004775", "title": "ACCESS Class not registered", "body": "<p>Can you confirm if it is your install or the database by:\n<strong>Create a new database and run this in the Immediate Window:</strong></p>\n\n<pre><code>? CurrentProject.Connection\n</code></pre>\n\n<blockquote>\n  <p>If you get an error here - it rules out an issue associated\n  specifically with your database.</p>\n</blockquote>\n\n<p><strong>If that returns an error then try a Repair of your Office365 Installation</strong>  </p>\n\n<ul>\n<li>Start by opening Programs and Features in the Control Panel.<br>\nIn Windows 10 you can get there by pulling up the hidden quick access menu <em>(To access it in Windows 10, just right-click the Start button and you\u2019ll see a menu of a lot of the familiar built-in utilities you used in Windows 7 \u2013 including the Control Panel.</em></li>\n<li>Select Microsoft Office 365 in the program list and then click<code>Change/Repair</code> on the command bar. </li>\n<li>Try the first option, <code>Quick Repair</code>, which is much faster and tries\nto fix the problem without a data connection</li>\n<li>If that doesn\u2019t resolve the problem, then go back and try the <code>Online\nRepair</code> option.</li>\n</ul>\n\n<p>Once the installation is complete, restart your computer just to be sure and launch your app and verify if the problem was resolved.</p>\n\n<blockquote>\n  <p><strong>Reference Links</strong><br>\n  <a href=\"http://www.fmsinc.com/microsoftaccess/errors/class_not_registered/index.htm\" rel=\"nofollow\">FMS Article</a><br>\n  <a href=\"http://www.groovypost.com/howto/repair-microsoft-office-365-installation/\" rel=\"nofollow\">Repairing Office 365</a></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5042721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b18aa8bfb9cefb45fe2d9973c4eb523?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Van Duffelen", "link": "https://stackoverflow.com/users/5042721/simon-van-duffelen"}, "is_accepted": false, "score": 1, "last_activity_date": 1516825378, "creation_date": 1516825378, "answer_id": 48430982, "question_id": 39001263, "link": "https://stackoverflow.com/questions/39001263/access-class-not-registered/48430982#48430982", "title": "ACCESS Class not registered", "body": "<p>I had this Issue with ADODB. The Class that requires registration was the data provider in the connection string. In my Case it was SQL Server Native client that needed installation. Repairing Office did absolutely nothing. But it may help for someone with a different data provider.</p>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4119, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1516825378, "creation_date": 1471449316, "last_edit_date": 1471559159, "question_id": 39001263, "link": "https://stackoverflow.com/questions/39001263/access-class-not-registered", "title": "ACCESS Class not registered", "body": "<p>I've posted a question on this problem before, and since there are more and nore references to it on the web, I wanted to see if anyone in here encountered a similar problem.  I have two computers both running Windows 10 and Office 365. I get the error on the desk top when I run the following code:</p>\n\n<pre><code>Dim Colcon As ADODB.Connection\nSet Colcon = CurrentProject.Connection\nDim ColRs As New ADODB.Recordset\nColRs.ActiveConnection = Colcon\n\nDim ColSQL As String\nColSQL = \"SELECT ColTbl.LastDate, ColTbl.ColCode\"\nColSQL = ColSQL + \" FROM ColTbl\"\nColRs.Open ColSQL, Colcon, adOpenStatic, adLockReadOnly\n</code></pre>\n\n<p>The last line throws \"Class not registered\", but the same code runs perfectly on my Surface using the same environment. Have tried different solution obtained on the web, non of which work.  Just wondering if anyone else is having this problem in ACCESS. (According to the web this error can be associated with anything, when you read the posts from folks having the problem)</p>\n\n<p>Thanks</p>\n\n<p>Mitch' here is debug.print of Colcon.  I don't see what this has to do with the problem, but here it is. BTW I don't know what this stuff means.</p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=U:\\SSP Supervisor_Log\\SSp_LogBook -Ver 11.accdb;\nMode=Share Deny None;Extended Properties=\"\";\nJet OLEDB:System database=C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Access\\System1.mdw;\nJet OLEDB:Registry Path=Software\\Microsoft\\Office\\16.0\\Access\\Access Connectivity Engine;\nJet OLEDB:Database Password=\"\";Jet OLEDB:Engine Type=6;Jet OLEDB:Database Locking Mode=1;\nJet OLEDB:Global Partial Bulk Ops=2;\nJet OLEDB:Global Bulk Transactions=1;Jet OLEDB:New Database Password=\"\";\nJet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False;\nJet OLEDB:Don't Copy Locale on Compact=False;\nJet OLEDB:Compact Without Replica Repair=False;Jet OLEDB:SFP=False;\nJet OLEDB:Support Complex Data=True;Jet OLEDB:Bypass UserInfo Validation=False;\nJet OLEDB:Limited DB Caching=False;Jet OLEDB:Bypass ChoiceField Validation=False\n</code></pre>\n"}, {"tags": ["r", "vba", "excel", "rexcel"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1471450105, "post_id": 39001260, "comment_id": 65354678, "body": "I&#39;m not an &#39;R&#39; programmer at all, but what is your code for &#39;myfunction&#39;?  Perhaps the problem lies there?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1471460612, "post_id": 39001260, "comment_id": 65360469, "body": "If your question is in respect to <code>R</code> only then please remove the VBA and Excel-VBA tags. If you have a question of <code>R</code> in <code>VBA</code> then please append the VBA code to the question. Also, could you please elaborate on the <code>R</code> host you&#39;re using to execute the <code>R</code> code: <a href=\"http://rcom.univie.ac.at/download.html\" rel=\"nofollow noreferrer\">RExcel</a>, <a href=\"https://msdn.microsoft.com/en-us/library/mt604845.aspx\" rel=\"nofollow noreferrer\">R via SQL</a>, <a href=\"http://stackoverflow.com/a/24065842\">calling Rscript</a>, or some other mean?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6727163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d14351326a83a9dc87d442854888a07?s=128&d=identicon&r=PG&f=1", "display_name": "Carlotta", "link": "https://stackoverflow.com/users/6727163/carlotta"}, "is_accepted": false, "score": 0, "last_activity_date": 1471510329, "creation_date": 1471510329, "answer_id": 39013802, "question_id": 39001260, "link": "https://stackoverflow.com/questions/39001260/run-user-defined-r-function-from-vba/39013802#39013802", "title": "Run user-defined R function from VBA", "body": "<p>Thanks for your answers. </p>\n\n<p>I don't think the problem comes from my R code, because when I run the function \"myfuntion\" in R, it works.</p>\n\n<p>I am using Rexcel to execute my R code. Here is the VBA Code:</p>\n\n<p>Sub Compute_BC()</p>\n\n<p>Dim shell As Object\n    Set shell = VBA.CreateObject(\"WScript.Shell\")\n    Dim waitTillComplete As Boolean: waitTillComplete = True\n    Dim style As Integer: style = 1\n    Dim errorCode As Integer\n    Dim path As String</p>\n\n<pre><code>Dim simul, level As Variant\nDim spd1, spd2, spd3, swap_rate As Variant\nDim date_valo As String\n</code></pre>\n\n<p>simul = BC.Range(\"B6\").Value</p>\n\n<p>level = BC.Range(\"B4\").Value</p>\n\n<p>spd1 = BC.Range(\"B13\").Value</p>\n\n<p>spd2 = BC.Range(\"C13\").Value</p>\n\n<p>spd3 = BC.Range(\"D13\").Value</p>\n\n<p>date_valo = BC.Range(\"B1\").Value</p>\n\n<p>swap_rate = BC.Range(\"B5\").Value</p>\n\n<p>path = \"\"\"\" &amp; Cells.Range(\"RhomeDir\") &amp; \"\"\" \"\"\" &amp; Cells.Range(\"MyRscript\") &amp; \"\"\"\" &amp; \" \" &amp; simul &amp; \" \" &amp; level &amp; \" \" &amp; spd1 &amp; \" \" &amp; spd2 &amp; \" \" &amp; spd3 &amp; \" \" &amp; date_valo &amp; \" \" &amp; swap_rate</p>\n\n<p>errorCode = shell.Run(path, style, waitTillComplete)</p>\n\n<p>End Sub</p>\n\n<p>Rmq: I tested this VBA code with a simple R file, and it worked. The problem comes when in my R file, there is a call to a function I define.</p>\n"}], "owner": {"reputation": 1, "user_id": 6727163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d14351326a83a9dc87d442854888a07?s=128&d=identicon&r=PG&f=1", "display_name": "Carlotta", "link": "https://stackoverflow.com/users/6727163/carlotta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471510329, "creation_date": 1471449309, "last_edit_date": 1531164843, "question_id": 39001260, "link": "https://stackoverflow.com/questions/39001260/run-user-defined-r-function-from-vba", "title": "Run user-defined R function from VBA", "body": "<p>I have a problem while I am trying to call a R function I have created, in VBA. The problem does not come from the connection between VBA and R, but when my R code has to call my own function, the program stops. To make it clearer, here is the R code:</p>\n\n<pre><code>args = commandArgs(trailingOnly=T)\nsink('Y:/Documents/BC10.txt', append=F, type = \"output\",split=TRUE)\nsource(\"Y:/Documents/myfunction.R\")\ncat('TEST !!')\nsimul = args[1]\nlevel = args[2]\nspd1 = args[3]\nspd2 = args[4]\nspd3 = args[5]\ndate_valo = toString(args[6])\nswap_rate = args[7]\nl1 = 0\nu1 = 0.03\nrho2 = 0.5\ncat('\\nparameters are: ', simul,  level, spd1 , spd2, spd3, date_valo, swap_rate)\n\nPV_eq=PV_eq=myfunction(l1,u1,spd1,rho2,simul,level, date_valo, swap_rate)\ncat(PV_eq)\nsink()\n</code></pre>\n\n<p>When I run my VBA code, the program does well concerning the display of the parameters in the text file \"BC10.txt\", but it does not display PV_eq. So, I supposed the program does not manage to call my user-defined function \"myfunction\".</p>\n\n<p>Does anybody has an idea of the problem I encounter ? Maybe, I have to add something in my VBA code (or R code) so that VBA takes into account user-defined function ?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 23, "user_id": 6727200, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-HBBgqaGwi38/AAAAAAAAAAI/AAAAAAAACJo/FtTx9rELgfM/photo.jpg?sz=128", "display_name": "Vaibhav Miglani", "link": "https://stackoverflow.com/users/6727200/vaibhav-miglani"}, "reply_to_user": {"reputation": 889, "user_id": 678860, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51273ac86c97cc7cca19f3c114f50f7b?s=128&d=identicon&r=PG&f=1", "display_name": "warunapww", "link": "https://stackoverflow.com/users/678860/warunapww"}, "edited": false, "score": 0, "creation_date": 1471449556, "post_id": 39001180, "comment_id": 65354338, "body": "i used nested for loops to search for the alphabet first, when i find it, &quot;Exit For&quot; is implemented. then the respective number is shown. it is a tedious process as I have hundreds of rows and nested for loop will run 100*2 times, resulting in slowing down of my algorithm."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471449799, "post_id": 39001180, "comment_id": 65354481, "body": "if you want to search for alphabet, create a key-value pair. use dictionary. once you load the dictionary.. No inner/ no outer / no loop at at all required get value ."}, {"owner": {"reputation": 23, "user_id": 6727200, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-HBBgqaGwi38/AAAAAAAAAAI/AAAAAAAACJo/FtTx9rELgfM/photo.jpg?sz=128", "display_name": "Vaibhav Miglani", "link": "https://stackoverflow.com/users/6727200/vaibhav-miglani"}, "edited": false, "score": 0, "creation_date": 1471450033, "post_id": 39001180, "comment_id": 65354622, "body": "Can you pls write the code for the given question? would really appreciate it!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1471450416, "post_id": 39001180, "comment_id": 65354861, "body": "Stack Overflow is not a code writing service.  It is a site dedicated to helping overcome specific problems with existing code.  Please put the code you have tried in the original post using the edit."}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1471452072, "creation_date": 1471452072, "answer_id": 39002072, "question_id": 39001180, "link": "https://stackoverflow.com/questions/39001180/search-for-elements-in-a-2-d-array-in-vba/39002072#39002072", "title": "search for elements in a 2-D array in vba", "body": "<p>Using a dictionary or collection is good approach to learn, and I'd recommend reviewing these data structures. </p>\n\n<p>Here's an alternative approach using some built-in VBA functions. Basically it will lookup the ASCII code, and then offset that number to align to with the values you presented earlier, e.g, A-->6. </p>\n\n<pre><code>Public Function OffsetChar(ByVal Character As String, _\n                           Optional ByVal OffsetValue As Integer) As Integer\n    OffsetChar = Asc(UCase(Left(Character, 1))) + OffsetValue\nEnd Function\n\nPublic Sub SO_Example()\n    Debug.Print OffsetChar(\"a\", -59) ' This will return 6\nEnd Sub\n</code></pre>\n\n<p>It should be very quick as well.</p>\n"}], "owner": {"reputation": 23, "user_id": 6727200, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-HBBgqaGwi38/AAAAAAAAAAI/AAAAAAAACJo/FtTx9rELgfM/photo.jpg?sz=128", "display_name": "Vaibhav Miglani", "link": "https://stackoverflow.com/users/6727200/vaibhav-miglani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471452072, "creation_date": 1471449100, "last_edit_date": 1471449225, "question_id": 39001180, "link": "https://stackoverflow.com/questions/39001180/search-for-elements-in-a-2-d-array-in-vba", "title": "search for elements in a 2-D array in vba", "body": "<p>Code: VBA</p>\n\n<p>Suppose there is a 2-D array</p>\n\n<p>counter(1 to 8, 1 to 2) as string</p>\n\n<pre><code>A   6\n\nB   7\n\nC   8\n\nD   9\n\nE   10\n\nF   11\n\nG   12\n\nH   13\n</code></pre>\n\n<p>I want to get the corresponding number to the alphabets if I use.</p>\n\n<p>counter(\"F\",2).</p>\n\n<p>how do i do it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1471449808, "post_id": 39000968, "comment_id": 65354489, "body": "Avoid using Select and Selection <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "is_accepted": false, "score": 0, "last_activity_date": 1471453657, "creation_date": 1471453657, "answer_id": 39002547, "question_id": 39000968, "link": "https://stackoverflow.com/questions/39000968/how-to-fix-runtime-error-91-on-sql-query/39002547#39002547", "title": "How to fix runtime error 91 on SQL Query?", "body": "<p>You are trying to reference an object that was never set.</p>\n\n<pre><code>Dim MyQueryTbl as QueryTable\n\nSet MyQueryTbl = Sheet1.QueryTables(1)\n</code></pre>\n\n<p>Then you can manipulate your MyQueryTbl object.</p>\n"}], "owner": {"reputation": 1, "user_id": 6726776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a690443ac8d5c62e91b8aa3da24db63?s=128&d=identicon&r=PG&f=1", "display_name": "Traxam", "link": "https://stackoverflow.com/users/6726776/traxam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 801, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471453657, "creation_date": 1471448492, "last_edit_date": 1531164843, "question_id": 39000968, "link": "https://stackoverflow.com/questions/39000968/how-to-fix-runtime-error-91-on-sql-query", "title": "How to fix runtime error 91 on SQL Query?", "body": "<p>This code requests two input variables from the user and then uses those variables in a query to return data from internal company software. I adapted this code from a macro that someone else at the company uses without issue.</p>\n\n<p>My macro:</p>\n\n<ul>\n<li>Compiles without issue</li>\n<li>Experiences run-time error '91': Object variable or With block variable not set\n\n<ul>\n<li>Occurs at <code>With.Selection.ListObject.QueryTable</code></li>\n</ul></li>\n</ul>\n\n<p>NOTE: Some details e.g. company name, server, login etc removed!</p>\n\n<pre><code>Option Explicit\n\nPublic EN As String\nPublic REV As String\nDim SearchString As String\nDim SearchString1 As String\nDim SearchString2 As String\n\n\nPublic Sub QueryImport()\n\nEN = Import_Details.EN.Value\nREV = Import_Details.REV.Value\n\nApplication.ScreenUpdating = False\n\nUnload Import_Details\n\nSearchString = EN\nSearchString = EN &amp; Chr(37)\nSearchString = EN &amp; Chr(47) &amp; REV &amp; Chr(37)\n\nSheets(\"Import\").Range(\"A2\").Select\n\nWith Selection.ListObject.QueryTable\n     .Connection = _\n    \"ODBC;DRIVER=SQL Server;SERVER=XXXXXX-       XX;UID=XX;PWD=XXXXXX;APP=Microsoft Office 2013;WSID=XXXX;DATABASE=XXX-Live\"\n    .CommandText = _\n    \"SELECT Enquirys_list_with_Parts.\"\"Item No\"\", Enquirys_list_with_Parts.Description, Enquirys_list_with_Parts.\"\"Part No\"\", Enquirys_list_with_Parts.Qty, Enquirys_list_with_Parts.Price, Enquirys_list_with_Parts.Total\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n    \"FROM \"\"Emax-Live\"\".dbo.ENQUIRY_LINES_LIST ENQUIRY_LINES_LIST, \"\"Emax-Live\"\".dbo.Enquirys_list_with_Parts Enquirys_list_with_Parts, \"\"Emax-Live\"\".dbo.Quote_Line_Qty_Drop_list Quote_Line_Qty_Drop_list\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n    \"WHERE Enquirys_list_with_Parts.\"\"Enquiry No\"\" = ENQUIRY_LINES_LIST.\"\"Enquiry No\"\" AND Enquirys_list_with_Parts.\"\"Part No\"\" = Quote_Line_Qty_Drop_list.Part_No AND ENQUIRY_LINES_LIST.Enquiry_Line_id = Enquirys_list_with_Parts.Enquiry_Line_id AND ((Enquirys_list_with_Parts.\"\"Enquiry No\"\" Like '\" &amp; SearchString1 &amp; \"' And Enquirys_list_with_Parts.\"\"Enquiry No\"\" Like '\" &amp; SearchString &amp; \"') AND (Quote_Line_Qty_Drop_list.\"\"Quote No\"\" Like '\" &amp; SearchString2 &amp; \"'))\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n    \"ORDER BY Enquirys_list_with_Parts.\"\"Item No\"\"\" _\n\n    .Refresh BackgroundQuery:=False\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "compiler-errors"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1471448528, "post_id": 39000870, "comment_id": 65353689, "body": "Have you included &quot;Option Explicit&quot; at the top of your code? This forces you to define all your variables. This might help find the problem!"}, {"owner": {"reputation": 365, "user_id": 4905989, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/305de7f210e1aa951377c6692b23cb79?s=128&d=identicon&r=PG&f=1", "display_name": "Troll_Hunter", "link": "https://stackoverflow.com/users/4905989/troll-hunter"}, "reply_to_user": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1471448887, "post_id": 39000870, "comment_id": 65353931, "body": "That is actually included in the file already it is highlight the TOS"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1471449007, "post_id": 39000870, "comment_id": 65354006, "body": "Where is TOS in your code?"}, {"owner": {"reputation": 365, "user_id": 4905989, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/305de7f210e1aa951377c6692b23cb79?s=128&d=identicon&r=PG&f=1", "display_name": "Troll_Hunter", "link": "https://stackoverflow.com/users/4905989/troll-hunter"}, "edited": false, "score": 0, "creation_date": 1471449412, "post_id": 39000870, "comment_id": 65354256, "body": "Sorry the error message just says Compile error: Variable not defined&quot;"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1471449452, "post_id": 39000870, "comment_id": 65354279, "body": "If it says that it would highlight the variable in question. did it?"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1471449756, "post_id": 39000870, "comment_id": 65354454, "body": "Look at all those curlies..."}, {"owner": {"reputation": 365, "user_id": 4905989, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/305de7f210e1aa951377c6692b23cb79?s=128&d=identicon&r=PG&f=1", "display_name": "Troll_Hunter", "link": "https://stackoverflow.com/users/4905989/troll-hunter"}, "edited": false, "score": 0, "creation_date": 1471449821, "post_id": 39000870, "comment_id": 65354496, "body": "Yes, it was &quot;TOC&quot;. I think part of the problem I&#39;m having now is due to copying and pasting the code in, since re-typing the text gets rid of some of the errors. I&#39;m now having trouble with the two lines that start with SubAddress and TextToDisplay- it says &#39;Compile error: Method or data member not found&#39;."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1471450024, "post_id": 39000870, "comment_id": 65354614, "body": "replace all <code>\u201c</code> and  <code>\u201d</code> with  <code>&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1471450429, "post_id": 39001541, "comment_id": 65354867, "body": "Note that the &quot;Shift+2&quot; and &quot;shares the @ key&quot; parts are entirely dependent on your keyboard layout and locale. Shift+2 makes a &quot;@&quot; on my en-US keyboard, and I get a single quote using the &#39;/&quot; key. That part of your answer is probably better off left out."}, {"owner": {"reputation": 365, "user_id": 4905989, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/305de7f210e1aa951377c6692b23cb79?s=128&d=identicon&r=PG&f=1", "display_name": "Troll_Hunter", "link": "https://stackoverflow.com/users/4905989/troll-hunter"}, "edited": false, "score": 0, "creation_date": 1471450497, "post_id": 39001541, "comment_id": 65354904, "body": "Got it- changing the quotation marks fixed a lot of it, but I&#39;m still running into problems with SubAddress and TextToDisplay. Any idea how to solve those issues?"}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1471450243, "creation_date": 1471450243, "answer_id": 39001541, "question_id": 39000870, "link": "https://stackoverflow.com/questions/39000870/variable-error-with-macro-in-vba/39001541#39001541", "title": "Variable Error with macro in VBA", "body": "<p>I believe the problem is in the quotation marks, there are angled/curly brackets being used and this is stopping the code being read properly.</p>\n\n<p>Taking the first instance of the issue: -</p>\n\n<pre><code>.Worksheets(\u201cTOC\u201d).Delete\n</code></pre>\n\n<p>You receive the error:-</p>\n\n<blockquote>\n  <p>Compile Error:</p>\n  \n  <p>Variable not defined</p>\n</blockquote>\n\n<p>and <code>\u201cTOC\u201d</code> is highlighted. This is occurring because the wrong quotation marks are being so <code>TOC</code> is not being seen as a literal string but instead <code>\u201cTOC\u201d</code> is being presumed to be a variable, that is not defined (i.e. does not exist).</p>\n\n<p>This can be fixed by going through your code and replacing all the below: -</p>\n\n<p>Change <code>\u201c</code> (Angled open quotation) to <code>\"</code> (straight quotation (<kbd>shift</kbd>+<kbd>2</kbd>)</p>\n\n<p>Change <code>\u201d</code> (Angled close quotation) to <code>\"</code> (straight quotation (<kbd>shift</kbd>+<kbd>2</kbd>)</p>\n\n<p>Change <code>\u2018</code> (Angled apostrophe) to <code>'</code> (straight single quotation (<kbd>'</kbd>, shares the <kbd>@</kbd> key)</p>\n"}], "owner": {"reputation": 365, "user_id": 4905989, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/305de7f210e1aa951377c6692b23cb79?s=128&d=identicon&r=PG&f=1", "display_name": "Troll_Hunter", "link": "https://stackoverflow.com/users/4905989/troll-hunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471450243, "creation_date": 1471448189, "question_id": 39000870, "link": "https://stackoverflow.com/questions/39000870/variable-error-with-macro-in-vba", "title": "Variable Error with macro in VBA", "body": "<p>I am new to VBA in excel and I ran into an error that I am unsure how to interpret. I was wondering if somebody could help. I am trying to create s table of contents for an excel file and I found a macro online. It is posted below:</p>\n\n<pre><code>Sub Create_TOC()\nDim wbBook As Workbook\nDim wsActive As Worksheet\nDim wsSheet As Worksheet\nDim lnRow As Long\nDim lnPages As Long\nDim lnCount As Long\nSet wbBook = ActiveWorkbook\nWith Application\n    .DisplayAlerts = False\n    .ScreenUpdating = False\nEnd With\n    'If the TOC sheet already exist delete it and add a new\n    'worksheet.\nOn Error Resume Next\nWith wbBook\n    .Worksheets(\u201cTOC\u201d).Delete\n    .Worksheets.Add Before:=.Worksheets(1)\nEnd With\nOn Error GoTo 0\nSet wsActive = wbBook.ActiveSheet\nWith wsActive\n    .Name = \u201cTOC\u201d\n    With .Range(\u201cA1:B1\u201d)\n        .Value = VBA.Array(\u201cTable of Contents\u201d, \u201cSheet # \u2013 # of Pages\u201d)\n        .Font.Bold = True\n    End With\nEnd With\nlnRow = 2\nlnCount = 1\n\u2018Iterate through the worksheets in the workbook and create\n\u2018sheetnames, add hyperlink and count &amp; write the running number\n\u2018of pages to be printed for each sheet on the TOC sheet.\nFor Each wsSheet In wbBook.Worksheets\n    If wsSheet.Name &lt;&gt; wsActive.Name Then\n        wsSheet.Activate\n        With wsActive\n            .Hyperlinks.Add .Cells(lnRow, 1), \u201c\u201d, _\n            SubAddress:=\u201d\u2018\u201d &amp; wsSheet.Name &amp; \u201c\u2018!A1\u201d, _\n            TextToDisplay:=wsSheet.Name\n             lnPages = wsSheet.PageSetup.Pages().Count\n            .Cells(lnRow, 2).Value = \u201c\u2018\u201d &amp; lnCount &amp; \u201c - \u201d &amp; lnPages\n        End With\n        lnRow = lnRow + 1\n        lnCount = lnCount + 1\n    End If\nNext wsSheet\nwsActive.Activate\nwsActive.Columns(\u201cA:B\u201d).EntireColumn.AutoFit\nWith Application\n    .DisplayAlerts = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The error which I received was this:</p>\n\n<pre><code>Compile Error: Variable TOS not defined.\n</code></pre>\n\n<p>I am really new to this and I am unsure about what this means. Could somebody provide a detailed explanation on what the problem is and how to go about fixing it.</p>\n"}, {"tags": ["vba", "excel", "sorting", "alphanumeric"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1471450690, "post_id": 39000691, "comment_id": 65355034, "body": "When building something like this, I would put all four parts into their own cells.  Then you can sort via the columns in the order desired.  You can concatenate the columns if you want a single cell output.  As it is you will need to parse the data into its four parts then sort."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1471454798, "post_id": 39000691, "comment_id": 65357285, "body": "How does 1VENT fit your pattern?"}, {"owner": {"reputation": 11, "user_id": 6726909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8069ebbd71dca48af79e5bd24f6ef25?s=128&d=identicon&r=PG&f=1", "display_name": "MaxK", "link": "https://stackoverflow.com/users/6726909/maxk"}, "edited": false, "score": 0, "creation_date": 1471457872, "post_id": 39000691, "comment_id": 65358970, "body": "1VENT is an anomaly and would be sorted as VE for device type then 1 for sheet."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1471451702, "post_id": 39001929, "comment_id": 65355602, "body": "I would have used arrays to speed things up but done essentially the same thing."}, {"owner": {"reputation": 11, "user_id": 6726909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8069ebbd71dca48af79e5bd24f6ef25?s=128&d=identicon&r=PG&f=1", "display_name": "MaxK", "link": "https://stackoverflow.com/users/6726909/maxk"}, "edited": false, "score": 0, "creation_date": 1471459098, "post_id": 39001929, "comment_id": 65359663, "body": "That&#39;s what I have been doing manually and I don&#39;t even have to breakout device id and part, so I only have 3 columns. then I sort by type and it works. Thanks, this speeds up things greatly."}, {"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "reply_to_user": {"reputation": 11, "user_id": 6726909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8069ebbd71dca48af79e5bd24f6ef25?s=128&d=identicon&r=PG&f=1", "display_name": "MaxK", "link": "https://stackoverflow.com/users/6726909/maxk"}, "edited": false, "score": 0, "creation_date": 1471470973, "post_id": 39001929, "comment_id": 65365444, "body": "@MaxK no problem. If this is what you were looking for just click the checkmark to close the question."}], "tags": [], "owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "is_accepted": false, "score": 2, "last_activity_date": 1471452665, "last_edit_date": 1471452665, "creation_date": 1471451525, "answer_id": 39001929, "question_id": 39000691, "link": "https://stackoverflow.com/questions/39000691/alphanumeric-sorting-in-excel-using-vba/39001929#39001929", "title": "Alphanumeric sorting in Excel using VBA", "body": "<p>I don't know if this is the most efficient way of doing it, but based on how your BOMs are constructed, it might be easier to split out the data into temporary columns, then sort it, then delete the columns.</p>\n\n<p>Your sorting requirements and order seem too complex to do it any other way that I know of.</p>\n\n<pre><code>Sub SortBOMS()\nDim workingRange As Range\nDim workingCell As Range\nDim pageNumber As String\nDim deviceType As String\nDim deviceID As String\nDim devicePart As String\nDim i As Integer\n\nApplication.ScreenUpdating = False\n\n'Obtains the full list. (Assumes you have no data after the 1millionth row)\nSet workingRange = Range(\"A1:A\" &amp; Range(\"A1000000\").End(xlUp).Row)\n\nFor Each workingCell In workingRange.Cells\n\n    'Builds the page number\n    pageNumber = \"\"\n    For i = 1 To 3  'Used 3 since 200 is 3 characters\n        If IsNumeric(Mid(workingCell.Text, i, 1)) Then\n            pageNumber = pageNumber &amp; Mid(workingCell.Text, i, 1)\n        Else          \n            Exit For    'Exits as soon as encounters a letter\n        End If\n    Next i\n    'Writes the value after converting it to an integer\n    Range(\"B\" &amp; workingCell.Row).Value = CInt(pageNumber)\n\n    'Builds the device type\n    deviceType = \"\"\n    For i = 1 To 2  'Used 2 since ZZ is 2 characters\n        If Not (IsNumeric(Mid(Split(workingCell.Text, pageNumber)(1), i, 1))) Then\n            deviceType = deviceType &amp; Mid(Split(workingCell.Text, pageNumber)(1), i, 1)\n        Else\n            Exit For    'Exits as soon as encounters a number\n        End If\n    Next i\n    'Writes the value\n    Range(\"C\" &amp; workingCell.Row).Value = deviceType\n\n    'Builds the device ID\n    deviceID = \"\"\n    For i = 1 To 2  'Used 2 since 99 is 2 characters\n        If IsNumeric(Mid(Split(workingCell.Text, pageNumber &amp; deviceType)(1), i, 1)) Then\n            deviceID = deviceID &amp; Mid(Split(workingCell.Text, pageNumber &amp; deviceType)(1), i, 1)\n        Else    \n            Exit For    'Exits as soon as encounters a letter or a dash\n        End If\n    Next i\n    'Writes the value after converting it to an integer\n    On Error Resume Next\n    Range(\"D\" &amp; workingCell.Row).Value = CInt(deviceID)\n    On Error GoTo 0\n\n    'Builds the device part\n    devicePart = \"\"\n    If InStr(1, workingCell.Text, \"-\", vbTextCompare) &gt; 0 Then\n        devicePart = Split(workingCell.Text, \"-\")(1)\n    End If\n    'Writes the value\n    Range(\"E\" &amp; workingCell.Row).Value = devicePart\nNext workingCell\n\n'Clean up\nApplication.ScreenUpdating = True\nSet workingRange = Nothing\nSet workingCell = Nothing\nEnd Sub\n</code></pre>\n\n<p>After this runs, you should be able to sort the way you want to. Also, to get the results you want sort in this order, not the order you mentioned in the post:</p>\n\n<ol>\n<li>Device Type</li>\n<li>Page Number</li>\n<li>Device ID</li>\n<li>Device Part</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 6726909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8069ebbd71dca48af79e5bd24f6ef25?s=128&d=identicon&r=PG&f=1", "display_name": "MaxK", "link": "https://stackoverflow.com/users/6726909/maxk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1858, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1512504594, "creation_date": 1471447598, "last_edit_date": 1512504594, "question_id": 39000691, "link": "https://stackoverflow.com/questions/39000691/alphanumeric-sorting-in-excel-using-vba", "title": "Alphanumeric sorting in Excel using VBA", "body": "<p>I use create Bills Of Materials in Excel before importing into another program and I'm trying to sort these lists by Reference Designation which consist of prefix page number 1-200,  followed by device type A-ZZ, followed by device number (ID) on that page 1-99, followed by letter which represents part of device A-Z (if that device consists of multiple parts).  <br/>Here are examples of RefDes:<br/></p>\n\n<pre><code>1Q1\n1S6\n1S7\n1T1\n1VENT\n1X1\n1X2\n1Y1\n1Z1-A\n1Z1-B\n2A1-A\n2A1-B\n2A1-C\n22M1\n2QF1\n2RB1\n2Z1-A\n2Z1-B\n13A1-A\n13A1-B\n13A1-C\n3A2-A\n3A2-B\n3A2-C\n</code></pre>\n\n<p>I want it sorted first by Device type A-ZZ, then by device ID, then device part, then by page.</p>\n\n<pre><code>1A1A\n....\n1A1Z\n1A2A\n....\n1A2Z\n2A1A\n....\n2A1Z\n....\n200A99Z\n1B1A\n....\n200ZZ99Z\n</code></pre>\n\n<p>So that the list above is sorted like this:</p>\n\n<pre><code>2A1-A\n2A1-B\n2A1-C\n3A1-A\n3A1-B\n3A1-C\n13A1-A\n13A1-B\n13A1-C\n22M1\n1Q1\n2QF1\n2RB1\n1S6\n1S7\n1T1\n1VENT\n1X1\n1X2\n1Z1-A\n1Z1-B\n2Z1-A\n2Z1-B\n</code></pre>\n\n<p>So far I have been able to sort by page then by device type and even then it sorts wrong: 1A-1ZZ, then 1xA-1xZZ, then 2A-2ZZ, then 2xA-2xZZ, etc... I can get rid of the dash (-) when I build the BOM.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1471445987, "post_id": 39000100, "comment_id": 65351951, "body": "So you want a list of Months separated by commas instead of a new msgbox for each month?"}, {"owner": {"reputation": 698, "user_id": 4244020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55d4e02944f4aaed2b934a701950a4df?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy8ball", "link": "https://stackoverflow.com/users/4244020/jimmy8ball"}, "reply_to_user": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1471446089, "post_id": 39000100, "comment_id": 65352037, "body": "Yes exactly, the query is returning distinct month names from the table, I need to see where there is more than one month name in the table and output via msgbox, separated by comma."}, {"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1471448826, "post_id": 39000100, "comment_id": 65353894, "body": "I edited my answer to answer your question"}], "answers": [{"comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1471448971, "post_id": 39000229, "comment_id": 65353986, "body": "That <code>rs.firstMove</code> will generate an error. And you can actually remove the whole If block <code>If Not rs.EOF Then     rs.firstMove</code> with associated <code>End if</code> but you&#39;ll get an error if <code>mthString = &quot;&quot;</code> - should check for empty string before extracting Left value"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1471466500, "post_id": 39000229, "comment_id": 65363461, "body": "It is <code>rs.MoveFirst</code> not <code>rs.firstMove</code>. Also as far as I know it is not safe to make the assumption that Access will open a recordset on the first record so the proper way to check for no records is `if rs.BOF=False OR rs.EOF=False&#39; (or use NOT instead of =False, but it looks cleaner not confusing the OR and the NOTs). It is possible that your recordset will open at the end (rs.EOF=True) even if there are records which is why you have to check that the cursor is not at the beginning and at the end at the same time, which can only happen with zero records returned."}], "tags": [], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "is_accepted": false, "score": 0, "last_activity_date": 1471448237, "last_edit_date": 1471448237, "creation_date": 1471446207, "answer_id": 39000229, "question_id": 39000100, "link": "https://stackoverflow.com/questions/39000100/vb-access-msgbox-to-return-sql-query-with-multiple-results/39000229#39000229", "title": "VB Access MsgBox to return SQL Query WIth Multiple Results", "body": "<p>You could create the comma separated string in the loop and then msgbox that string with something like this:</p>\n\n<pre><code>Dim rs As DAO.Recordset\nDim mthString as string\nmthString=\"\"\nSet rs=CurrentDB.OpenRecordset(\"Qry_MonthName\")\n If Not rs.EOF Then\n    rs.firstMove\n      Do Until rs.EOF\n      mthString = mthString &amp; rs.Fields(0) &amp; \", \"\n      rs.MoveNext ' if you forget this an infinite loop will occur\n     Loop\n   End if\n' remove last comma\nmthString=left(mthString,len(mthString)-2)\nmsgbox \"Records loaded for the months: \" &amp; mthString\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 698, "user_id": 4244020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55d4e02944f4aaed2b934a701950a4df?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy8ball", "link": "https://stackoverflow.com/users/4244020/jimmy8ball"}, "edited": false, "score": 0, "creation_date": 1471504113, "post_id": 39006311, "comment_id": 65375012, "body": "Thanks very much both of these answers got me the desired output thankyou very much."}], "tags": [], "owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "is_accepted": true, "score": 0, "last_activity_date": 1471468119, "creation_date": 1471468119, "answer_id": 39006311, "question_id": 39000100, "link": "https://stackoverflow.com/questions/39000100/vb-access-msgbox-to-return-sql-query-with-multiple-results/39006311#39006311", "title": "VB Access MsgBox to return SQL Query WIth Multiple Results", "body": "<p>Try this:</p>\n\n<pre><code>Dim rs As DAO.Recordset\nDim strOutput As String\nDim i As Integer\n\nSet rs = CurrentDb.OpenRecordset(\"Qry_MonthName\")\n\nWith rs\n    'test for empty recordset\n    If Not .EOF And Not .BOF Then\n        .MoveLast\n        .MoveFirst\n\n        For i = 0 To (.RecordCount - 1)\n            'test for last record\n            If i = (.RecordCount - 1) Then\n                'last record\n                strOutput = strOutput + !yourField\n            Else\n                'all other records\n                strOutput = strOutput + !yourField + \", \"\n            End If\n\n            .MoveNext\n        Next\n    End If\n    .Close\nEnd With\n    'execute messagebox\n    MsgBox strOutput\nSet rs = Nothing\n</code></pre>\n"}], "owner": {"reputation": 698, "user_id": 4244020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55d4e02944f4aaed2b934a701950a4df?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy8ball", "link": "https://stackoverflow.com/users/4244020/jimmy8ball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1373, "favorite_count": 0, "accepted_answer_id": 39006311, "answer_count": 2, "score": 0, "last_activity_date": 1471468119, "creation_date": 1471445896, "question_id": 39000100, "link": "https://stackoverflow.com/questions/39000100/vb-access-msgbox-to-return-sql-query-with-multiple-results", "title": "VB Access MsgBox to return SQL Query WIth Multiple Results", "body": "<p>I am trying to return multiple values to a message box output in MS Access using VB, I have been successful so far using the below code, I now need to extend so the message box outputs comma separated distinct month names.</p>\n\n<pre><code>Dim rs As DAO.Recordset\nSet rs=CurrentDB.OpenRecordset(\"Qry_MonthName\")\n If Not rs.EOF Then\nMsgBox \"Records Loaded Are For The Month Of: \" &amp; rs.Fields(0)\nEnd if\n</code></pre>\n\n<p>Can anyone advise please?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 3, "creation_date": 1471444852, "post_id": 38999614, "comment_id": 65351159, "body": "1) Check what&#39;s crashing. Are you using too many resources, or is the usage ok but the macro takes so long that Excel goes unresponsive, then you crash Excel by trying to get it to respond? If it&#39;s just a very long macro and you want to be able to check its status, consider adding in a <code>DoEvents</code> every once in a while. 2) Speed up the code. There are lots of references to <code>Cells</code> here, which will be slower than storing and accessing an array. Check out our sister site Code Review for more help on optimizing."}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1471445154, "post_id": 38999614, "comment_id": 65351382, "body": "@Mikegrann 1) Resource usage runs between 2 - 6% when idle. When I&#39;m running the code, it shoots up to between 75 - 95%, with 3 of the 4 processors running full out for maybe 10 seconds. it then drops down to about 25%, but is unresponsive. If I click on it, use Crtl+Brk, or ESC, the system crashes. 2) Not sure how I would use an array in this. could you advise?"}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 1, "creation_date": 1471445190, "post_id": 38999614, "comment_id": 65351403, "body": "32 bit or 64bit version of Excel?"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1471445336, "post_id": 38999614, "comment_id": 65351517, "body": "add <code>DoEvents</code> before each <code>wend</code>"}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471445490, "post_id": 38999614, "comment_id": 65351625, "body": "@MatsLind I would think it is 32 bit, based on the normal usage within the company (non-dev, non-IT, normally used for small calcs)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1471445491, "post_id": 38999614, "comment_id": 65351626, "body": "Stop playing around with the cells and use a variant array. I&#39;ll try to work something up."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 5, "creation_date": 1471445643, "post_id": 38999614, "comment_id": 65351721, "body": "@GaryEvans probably just on the outer loop, max. The inner loop only goes through 12 items, and it should execute <i>relatively</i> quickly. No sense  surrounding that much processor time to <code>DoEvents</code>. I&#39;d probably do something more like run <code>DoEvents</code> once every X number of loops of the outer loop. Tune it for reasonable responsiveness (whatever definition you might have of that)."}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 1, "creation_date": 1471445662, "post_id": 38999614, "comment_id": 65351734, "body": "Then your memory resourses are quite scarce, your theroetical limit is 2GB but practically 32-bit Excel starts to misbehave already when it has used up like 1.5 GB. Look in this blogpost on how to check memory usage for the applicattion: <a href=\"http://msexcelandvba.blogspot.se/2016/07/32-bit-excel-stay-away-from-its-memory.html\" rel=\"nofollow noreferrer\">msexcelandvba.blogspot.se/2016/07/&hellip;</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 4, "creation_date": 1471445899, "post_id": 38999614, "comment_id": 65351885, "body": "This looks like an XY problem to me. Can you forget all this for a moment and explain what are you trying to achieve with this humongous code?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1471446164, "post_id": 38999614, "comment_id": 65352093, "body": "A lot of good comments here. I will reiterate the use of a variant array and <code>DoEvents</code>. I have used both with very good results. The one caution is the overuse of <code>DoEvents</code> as you can fill up your stack with too many calls. I&#39;ve never run into that specific issue though, and I&#39;ve used it pretty liberally in a few macros."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1471446239, "post_id": 38999614, "comment_id": 65352138, "body": "@Kyle - I don&#39;t think <code>DoEvents</code> is necessary and this (as written) should execute in several seconds; certainly less than 10."}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471446270, "post_id": 38999614, "comment_id": 65352165, "body": "@SiddharthRout The initial data is derived from one system, and it needs to be transformed into the layout, format, and data needed for a second system. the second system can&#39;t do the transformation itself, and doing it by hand is a nightmare. The code will need to be run a few dozen times, on spreadsheets with 950,000+ rows of data in each. (It was planned by a group of people who can barely use Outlook)  :("}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1471447190, "post_id": 38999614, "comment_id": 65352826, "body": "Why is <code>strResult</code> assigned an integer?"}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471447359, "post_id": 38999614, "comment_id": 65352945, "body": "@Clauric Did you check the memory usage? To minimize usage, have no other sheets open, avoid cell formulas and formatting!"}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 0, "creation_date": 1471447442, "post_id": 38999614, "comment_id": 65353010, "body": "@Jeeped it is assigned an integer as the value will be a whole number between 1 and 26. It is designed to turn an uppercase letter into a number."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1471447465, "post_id": 38999614, "comment_id": 65353023, "body": "@Jeeped, probably right on the <code>DoEvents</code> not being necessary, but I question whether this can execute that fast &quot;as written&quot;. Certainly under 10 seconds with the same logic, but using arrays."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 3, "creation_date": 1471447587, "post_id": 38999614, "comment_id": 65353108, "body": "@Clauric Less important of a concern, but I would recommend changing all the ElseIfs to Case statements also."}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471447644, "post_id": 38999614, "comment_id": 65353138, "body": "@MatsLind no other sheets open, no formulae within the sheet, and no other Office based product open. when running, Excel jumps to about 704,000K memory (according to task manager), but drops down to about 50,000K otherwise. As an example, having this page open is using 150,000K"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1471447751, "post_id": 38999614, "comment_id": 65353205, "body": "Why is the Countifs based on ranges like <code>Range(&quot;A1:A&quot; &amp; b)</code> when you start <code>b</code> at 100001?"}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 0, "creation_date": 1471447865, "post_id": 38999614, "comment_id": 65353263, "body": "@jeeped there is already 100,000 rows done using this code. It crashes at about row 105,000. The count still needs to start at 0. In an ideal world, the code will start at 2, and run to 1,048,576"}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471448100, "post_id": 38999614, "comment_id": 65353394, "body": "@Clauric  does it stay at 700 MB? Where does it stand when it crashes?"}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471448220, "post_id": 38999614, "comment_id": 65353485, "body": "@MatsLind When it crashes, it drops back down to 50,000K. I assume it is MB, but giving exactly what it says in Task Manager"}], "answers": [{"comments": [{"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 0, "creation_date": 1471448673, "post_id": 39000861, "comment_id": 65353791, "body": "looks like a very nice code. From my reading, I would then need to convert the formulae to absolute values. Is that correct?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 2, "creation_date": 1471448805, "post_id": 39000861, "comment_id": 65353877, "body": "It it again a simple and single line of code... <code>Range(&quot;A100001:L25000&quot;).Value=Range(&quot;A100001:L25000&quot;).Value</code> You can put this at the end of the code :)"}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471450047, "post_id": 39000861, "comment_id": 65354629, "body": "@Siddarth Rout Didnt you forget a &quot;0&quot;, shouldn&#39;t it be &quot;L250000&quot;?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471450285, "post_id": 39000861, "comment_id": 65354789, "body": "@MatsLind: Yup I did :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471450624, "post_id": 39000861, "comment_id": 65354986, "body": "@Jeeped: You have option explicit on? &#39;Dim i as long&#39;"}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 0, "creation_date": 1471511895, "post_id": 39000861, "comment_id": 65379326, "body": "@SiddharthRout I tested the code out, and it works for 90% of the values. The only error is in the final section, where it is just returning the value from cells(2,i+13) for every cell"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 1, "creation_date": 1471517233, "post_id": 39000861, "comment_id": 65382836, "body": "@Clauric: That is because that what we are asking it to do ;) Simply amend that and it will work"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 5, "last_activity_date": 1471448725, "last_edit_date": 1471448725, "creation_date": 1471448161, "answer_id": 39000861, "question_id": 38999614, "link": "https://stackoverflow.com/questions/38999614/excel-2010-keeps-crashing-after-more-than-x-number-of-loops/39000861#39000861", "title": "Excel 2010 keeps crashing after more than X number of loops", "body": "<p>This just took me less than 5 seconds to populate <code>10</code> columns out of <code>12</code>. It may be because most of my sheet was empty but none the less, if you switch off calculations/screenupdating, it will be faster.</p>\n\n<p>The only two columns that it doesn't populate is <code>C</code> and <code>D</code>. You cannot use a formula approach for it as it exceeds the <code>If</code> condition requirements. You can write a small loop for those 2.</p>\n\n<p>There is no need to loop from row <code>100001</code> to <code>250000</code> and from Columns <code>1</code> to <code>12</code>. You can enter a formula in those cells in one go. Here is an example</p>\n\n<pre><code>Sub Sample()\n    '~~&gt; When a = 1 i.e Col A\n    range(\"A100001:A250000\").Formula = \"=IF(N100001=\"\"EEEE\"\",\"\"1234\"\",IF(N100001=\"\"ZYXW\"\",\"\"2468\"\",IF(N100001=\"\"AAAA\"\",\"\"3579\"\",IF(N100001=\"\"BBBB\"\",\"\"9764\"\",IF(N100001=\"\"DDDD\"\",\"\"8631\"\",\"\"ZZZZ\"\")))))\"\n\n    range(\"B100001:B250000\").Formula = \"=IF(O100001=\"\"5\"\",\"\"JPY\"\",IF(O100001=\"\"4\"\",\"\"GBP\"\",IF(O100001=\"\"3\"\",\"\"CHF\"\",IF(O100001=\"\"2\"\",\"\"USD\"\",IF(O100001=\"\"1\"\",\"\"EUR\"\",\"\"YYYY\"\")))))\"\n\n    '3,4 This needs to be coded\n\n    range(\"E100001:E250000\").Value = range(\"Q100001:Q250000\").Value\n\n    range(\"F100001:F250000\").Formula = \"=IF(S100001=\"\"SB\"\",\"\"Sub\"\",IF(S100001=\"\"RD\"\",\"\"Red\"\",\"\"XXXX\"\"))\"\n\n    For i = 7 To 12\n        range(Cells(100001, i), Cells(250000, i)).Formula = \"=\" &amp; Cells(100001, i + 13).Address\n    Next i\nEnd Sub\n</code></pre>\n\n<p>When I ran this code, this is what I got</p>\n\n<p><a href=\"https://i.stack.imgur.com/4ptKM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4ptKM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1471451599, "creation_date": 1471451599, "answer_id": 39001945, "question_id": 38999614, "link": "https://stackoverflow.com/questions/38999614/excel-2010-keeps-crashing-after-more-than-x-number-of-loops/39001945#39001945", "title": "Excel 2010 keeps crashing after more than X number of loops", "body": "<p>This is the variant in-memory processing I discussed earlier in comments. While it is actually a little slower that the formula approach offered earlier, it is also more complete; in particular using a dictionary object to calculate the countifs.</p>\n\n<pre><code>Option Explicit\n\nSub bigRun()\n    Dim a As Long, b As Long, i As Long, j As Long\n    Dim c As Variant, d As Variant, e As Variant  '&lt;~~??????\n    Dim vals As Variant\n    Dim ab As String, strResult As String\n    Dim dABs As Object\n\n    appTGGL\n\n    Set dABs = CreateObject(\"Scripting.Dictionary\")\n    dABs.CompareMode = vbTextCompare\n\n    With Worksheets(\"Sheet1\")\n        vals = .Range(\"A100001:Z250000\").Value2\n        For b = 100001 To 250000\n            For a = 1 To 12\n                Select Case a\n                    Case 1\n                        Select Case vals(b - 100000, 14)\n                            Case \"EEEE\"\n                                vals(b - 100000, a) = 1234\n                            Case \"ZYXW\"\n                                vals(b - 100000, a) = 2468\n                            Case \"AAAA\"\n                                vals(b - 100000, a) = 3579\n                            Case \"BBBB\"\n                                vals(b - 100000, a) = 9764\n                            Case \"DDDD\"\n                                vals(b - 100000, a) = 8631\n                            Case Else\n                                vals(b - 100000, a) = \"ZZZZ\"\n                        End Select\n                    Case 2\n                        Select Case vals(b - 100000, 15)\n                            Case 5\n                                vals(b - 100000, a) = \"JPY\"\n                            Case 4\n                                vals(b - 100000, a) = \"GBP\"\n                            Case 3\n                                vals(b - 100000, a) = \"CHF\"\n                            Case 2\n                                vals(b - 100000, a) = \"USD\"\n                            Case 1\n                                vals(b - 100000, a) = \"EUR\"\n                            Case Else\n                                vals(b - 100000, a) = \"YYYY\"\n                        End Select\n                    Case 3\n                        Select Case vals(b - 100000, 16)\n                            Case 10234\n                                vals(b - 100000, a) = \"A27Z2\"\n                            Case 10420\n                                vals(b - 100000, a) = \"B28Y\"\n                            Case 10432\n                                vals(b - 100000, a) = \"C29X\"\n                            Case 18953\n                                vals(b - 100000, a) = \"D30W\"\n                            Case 21048\n                                vals(b - 100000, a) = \"E31V\"\n                            Case 36542\n                                vals(b - 100000, a) = \"F32U\"\n                            Case 36954\n                                vals(b - 100000, a) = \"G33T\"\n                            Case 65425\n                                vals(b - 100000, a) = \"H34S\"\n                            Case 75963\n                                vals(b - 100000, a) = \"I35R\"\n                            Case 84563\n                                vals(b - 100000, a) = \"J36Q\"\n                            Case Else\n                                vals(b - 100000, a) = \"XXXX\"\n                        End Select\n                    Case 4\n                        ab = Join(Array(vals(b - 100000, 1), vals(b - 100000, 2)), ChrW(8203))\n                        If dABs.exists(ab) Then\n                            j = dABs.Item(ab) + 1\n                        Else\n                            j = 1\n                        End If\n                        dABs.Item(ab) = j\n\n                        strResult = 1\n                        For i = 1 To Len(vals(b - 100000, 18))\n                            Select Case Asc(Mid(vals(b - 100000, 18), i, 1))\n                                Case 65 To 90:\n                                    strResult = strResult + Asc(Mid(vals(b - 100000, 18), i, 1)) - 64\n                                Case Else\n                                    strResult = strResult + Mid(vals(b - 100000, 18), i, 1)\n                            End Select\n                        Next\n\n                        vals(b - 100000, a) = Join(Array(vals(b - 100000, 1), _\n                                                         vals(b - 100000, 2), _\n                                                         strResult, j), _\n                                                   Chr(32) &amp; Chr(45) &amp; Chr(32))\n                    Case 5\n                        vals(b - 100000, a) = vals(b - 100000, 17)\n                    Case 6\n                        Select Case vals(b - 100000, 19)\n                            Case \"SB\"\n                                vals(b - 100000, a) = \"Sub\"\n                            Case \"RD\"\n                                vals(b - 100000, a) = \"Red\"\n                            Case Else\n                                vals(b - 100000, a) = \"XXXX\"\n                        End Select\n                    Case 7 To 12\n                        vals(b - 100000, a) = vals(b - 100000, a + 13)\n                End Select\n            Next a\n        Next b\n\n        .Range(\"A100001\").Resize(UBound(vals, 1), UBound(vals, 2)) = vals\n\n        '.Columns(\"M:Q\").Delete Shift:=xlToLeft\n        '.Columns(\"N:V\").Delete Shift:=xlToLeft\n\n    End With\n\n    dABs.RemoveAll: Set dABs = Nothing\n    appTGGL bTGGL:=False\n\nEnd Sub\n\nPublic Sub appTGGL(Optional bTGGL As Boolean = True)\n    With Application\n        .ScreenUpdating = bTGGL\n        .EnableEvents = bTGGL\n        .DisplayAlerts = bTGGL\n        .Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\n    End With\n    Debug.Print Timer\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/JjA0r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JjA0r.png\" alt=\"enter image description here\"></a></p>\n\n<p>My sample data is available temporarily <a href=\"https://dl.dropboxusercontent.com/u/100009401/Fix_Big_Loop_Variants.xlsb\" rel=\"nofollow noreferrer\">here</a>. Elapsed time on an old i5 business class laptop that closely mirrors your own configuration was ~13 seconds.</p>\n"}], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 1, "accepted_answer_id": 39001945, "answer_count": 2, "score": 5, "last_activity_date": 1471451599, "creation_date": 1471444540, "question_id": 38999614, "link": "https://stackoverflow.com/questions/38999614/excel-2010-keeps-crashing-after-more-than-x-number-of-loops", "title": "Excel 2010 keeps crashing after more than X number of loops", "body": "<p>I have a macro (below) that is designed to run 150,000 iterations before ending. However, after I run the code for more than 1,000 iterations, Excel goes to \"Not responding\" mode, and then crashes. I've left it for more than 12 hours, but it does not get any better. The code has previously been used to run the first 100,000 iterations, and is needed to run up to 1,048,576 iterations, in stages of 250,000.</p>\n\n<p>The crashes also bring down Outlook, IE, as well as Chrome (although I've stopped running them at the same time, but still crashes).</p>\n\n<p>If I run the code via F8, or to a checkpoint via F5, the code runs fine. However, that is impractical for another 948,576 iterations.</p>\n\n<p>Any suggestions on how to resolve the issue, so it doesn't crash constantly?</p>\n\n<p>The system specs are:\nExcel 2010\ni5 (3rd gen)\n8 GB RAM</p>\n\n<p>Code:</p>\n\n<pre><code>Dim a As Variant\nDim b As Variant\nDim c As Variant\nDim d As Variant\nDim e As Variant\nDim i As Integer\nDim j As Double\nDim strResult As Double\n\na = 1\nb = 100001\n\nWhile b &lt;= 250000\n\n    While a &lt;= 12\n\n        If a = 1 Then\n\n            If Cells(b, 14) = \"EEEE\" Then\n                Cells(b, a) = 1234\n            ElseIf Cells(b, 14) = \"ZYXW\" Then\n                Cells(b, a) = 2468\n            ElseIf Cells(b, 14) = \"AAAA\" Then\n                Cells(b, a) = 3579\n            ElseIf Cells(b, 14) = \"BBBB\" Then\n                Cells(b, a) = 9764\n            ElseIf Cells(b, 14) = \"DDDD\" Then\n                Cells(b, a) = 8631\n            Else\n                Cells(b, a) = \"ZZZZ\"\n            End If\n\n        ElseIf a = 2 Then\n\n            If Cells(b, 15) = 5 Then\n                Cells(b, a) = \"JPY\"\n            ElseIf Cells(b, 15) = 4 Then\n                Cells(b, a) = \"GBP\"\n            ElseIf Cells(b, 15) = 3 Then\n                Cells(b, a) = \"CHF\"\n            ElseIf Cells(b, 15) = 2 Then\n                Cells(b, a) = \"USD\"\n            ElseIf Cells(b, 15) = 1 Then\n                Cells(b, a) = \"EUR\"\n            Else\n                Cells(b, a) = \"YYYY\"\n            End If\n\n        ElseIf a = 3 Then\n\n            If Cells(b, 16) = 10234 Then\n                Cells(b, a) = \"A27Z2\"\n            ElseIf Cells(b, 16) = 10420 Then\n                Cells(b, a) = \"B28Y\"\n            ElseIf Cells(b, 16) = 10432 Then\n                Cells(b, a) = \"C29X\"\n            ElseIf Cells(b, 16) = 18953 Then\n                Cells(b, a) = \"D30W\"\n            ElseIf Cells(b, 16) = 21048 Then\n                Cells(b, a) = \"E31V\"\n            ElseIf Cells(b, 16) = 36542 Then\n                Cells(b, a) = \"F32U\"\n            ElseIf Cells(b, 16) = 36954 Then\n                Cells(b, a) = \"G33T\"\n            ElseIf Cells(b, 16) = 65425 Then\n                Cells(b, a) = \"H34S\"\n            ElseIf Cells(b, 16) = 75963 Then\n                Cells(b, a) = \"I35R\"\n            ElseIf Cells(b, 16) = 84563 Then\n                Cells(b, a) = \"J36Q\"\n            Else\n                Cells(b, a) = \"XXXX\"\n            End If\n\n        ElseIf a = 4 Then\n\n            strResult = 1\n            For i = 1 To Len(Cells(b, 18))\n                Select Case Asc(Mid(Cells(b, 18), i, 1))\n                    Case 65 To 90:\n                        strResult = strResult + Asc(Mid(Cells(b, 18), i, 1)) - 64\n                    Case Else\n                        strResult = strResult + Mid(Cells(b, 18), i, 1)\n                End Select\n            Next\n\n            j = WorksheetFunction.CountIfs(Range(\"A1:A\" &amp; b), Range(\"A\" &amp; b), Range(\"B1:B\" &amp; b), Range(\"B\" &amp; b))\n\n            Cells(b, a) = Cells(b, 1) &amp; \" - \" &amp; Cells(b, 2) &amp; strResult &amp; \" - \" &amp; j\n\n        ElseIf a = 5 Then\n\n            Cells(b, a) = Cells(b, 17)\n\n        ElseIf a = 6 Then\n\n            If Cells(b, 19) = \"SB\" Then\n                Cells(b, a) = \"Sub\"\n            ElseIf Cells(b, 19) = \"RD\" Then\n                Cells(b, a) = \"Red\"\n            Else\n                Cells(b, a) = \"XXXX\"\n            End If\n\n        ElseIf a &gt;= 7 Then\n\n            Cells(b, a) = Cells(b, a + 13)\n\n        End If\n\n        a = a + 1\n\n    Wend\n\n    b = b + 1\n    a = 1\n\nWend\n\n    Columns(\"M:Q\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"N:V\").Select\n    Selection.Delete Shift:=xlToLeft\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1471445195, "post_id": 38999586, "comment_id": 65351405, "body": "What is <code>txtInput_PM_EN_DRAFT</code>?  Is it a form or a control?  If that is the name of a form which is contained in a subform control, you need to use the name of the control ... which can be different than the name of the form it contains."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1471445306, "post_id": 38999586, "comment_id": 65351492, "body": "It is the name of the control that is directly on the form. There are no subforms. However, it is inside a tab control form, if that makes a difference."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1471445750, "post_id": 38999586, "comment_id": 65351793, "body": "It seems Access believes the form does not contain a control named <code>txtInput_PM_EN_DRAF\u200c\u200bT</code>.  I suggest you the examine names of the controls which Access thinks the form contains.  With your form open in form view, try this as a single line in the Immediate window: <code>for each ctl in Forms!YourFormNameHere.Controls : ? ctl.name : next</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1471445925, "post_id": 38999586, "comment_id": 65351902, "body": "Later you will need to alter your code because nothing is ever equal to Null, not even another Null.  But that is not the cause of the problem you&#39;re facing right now."}, {"owner": {"reputation": 443, "user_id": 1045151, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2oguu.jpg?s=128&g=1", "display_name": "Sham Yemul", "link": "https://stackoverflow.com/users/1045151/sham-yemul"}, "edited": false, "score": 1, "creation_date": 1471494324, "post_id": 38999586, "comment_id": 65371581, "body": "Can you please give an example of what can be value of sLang and few of the names of the controls on your form. Make sure the string &quot;txtInput_PM_&quot; &amp; sLang &amp; &quot;_DRAFT&quot; makes a control name that is exactly there on the form, control names are not case sensitive which please note. So I guess the control names could be txtInput_PM_EN_DRAFT. To handle this situation if the control does not exists on the form, @dbmitch had suggested error handling which will pop-up message of such control does not exists."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1471503527, "post_id": 38999586, "comment_id": 65374718, "body": "@HansUp You were right that there was a spelling mistake in one of the forms. I also changed the NULL issue. THank you for you help!"}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1471503565, "post_id": 39001503, "comment_id": 65374743, "body": "I used your code with error handling. Worked perfectly after I also changed the naming issue. Thank you for your help as well!"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 5, "last_activity_date": 1471450124, "creation_date": 1471450124, "answer_id": 39001503, "question_id": 38999586, "link": "https://stackoverflow.com/questions/38999586/how-to-reference-control-names-dynamically-in-ms-access/39001503#39001503", "title": "How to reference control names dynamically in MS Access", "body": "<p>I think you need to add some basic troubleshooting. The answer is probably simpler than you think. It's likely you're just trying to lookup a textbox with mispelled name or it's failing on the Null comparison (as suggested by @HansUp)</p>\n\n<p>I would try modifying your basic sub and testing it with this subroutine. As long as your code is in your current form and you're not referencing a subform your method will work.</p>\n\n<pre><code>Private Sub UpdatePMText(sLang As String)\n\n    Const ERR_MISSING_CONTROL   As Long = 2465\n\nOn Error GoTo Err_UpdatePMText\n    Dim sTextBox    As String\n\n    sTextBox = \"txtInput_PM_\" &amp; sLang &amp; \"_DRAFT\"\n\n    'Check if there is text in the box.\n    If Nz(Me.Controls(sTextBox).Value, \"\") = \"\" Then\n        MsgBox (\"There is no text in the \" &amp; sLang &amp; \" DRAFT Field.\" &amp; vbNewLine &amp; \"The operation will not be executed.\")\n        Exit Sub\n    End If\n\n    Exit Sub\n\nErr_UpdatePMText:\n    If Err.Number = ERR_MISSING_CONTROL Then\n        MsgBox \"Error: No Such Textbox: \" &amp; sTextBox\n    Else\n        MsgBox \"Error Looking Up Textbox: \"\"\" &amp; sTextBox &amp; \"\"\"\" &amp; vbCrLf &amp; Err.Description\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11458, "favorite_count": 0, "accepted_answer_id": 39001503, "answer_count": 1, "score": 1, "last_activity_date": 1594641103, "creation_date": 1471444466, "last_edit_date": 1594641103, "question_id": 38999586, "link": "https://stackoverflow.com/questions/38999586/how-to-reference-control-names-dynamically-in-ms-access", "title": "How to reference control names dynamically in MS Access", "body": "<p>I have the following code in an MS Access Form object. </p>\n\n<pre><code>Private Sub UpdatePMText(sLang As String)\n'Used to pass both Mandate and Language Info to called Sub that will execute the queries\nDim iMandate As Integer\n\n'Check if there is text in the box.\nIf Me.Controls(\"txtInput_PM_\" &amp; sLang &amp; \"_DRAFT\") = Null Or Me.Controls(\"txtInput_PM_\" &amp; sLang &amp; \"_DRAFT\") = \"\" Then\n    MsgBox (\"There is no text in the \" &amp; sLang &amp; \" DRAFT Field.\" &amp; vbNewLine &amp; \"The operation will not be executed.\")\n    Exit Sub\nEnd If\n\niMandate = Me.txtMandateID\nCall modUpdateText.macro_PMText(iMandate, sLang)\n\nEnd Sub\n</code></pre>\n\n<p>If I refer to the Controls directly and simply type out the names of the forms, for example <code>txtInput_PM_EN_DRAFT</code> then the code works as intended.</p>\n\n<p>The error message I get is that Access can't find the \"Field\" I'm referring to when I am on the first <code>IF</code> statement line. I have tried changing the <code>.Controls</code> to <code>.Fields</code> but that didn't work either.</p>\n\n<p>I do not want to repeat the same code for every language I need to run. How do I reference control names dynamically in MS Access? What am I missing?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 2, "creation_date": 1471443421, "post_id": 38999118, "comment_id": 65349946, "body": "Have you tried to write a macro to do this, or have you even tried to record a macro (as you complete the task) to see what Excel is doing?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6726550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb13938ea264491fa624e831b5c00719?s=128&d=identicon&r=PG&f=1", "display_name": "user6726550", "link": "https://stackoverflow.com/users/6726550/user6726550"}, "edited": false, "score": 0, "creation_date": 1472824931, "post_id": 38999662, "comment_id": 65922276, "body": "Thank you for spending time on this and thank you for the suggested code. These forums are new to me and obviously I have misunderstood something. It is interesting though that you are met with not so welcoming remarks. I have little VBA experience but years (decades) of excel functions and standard macro recording. I didn&#39;t get the code to work a 100% but I will work on it and see if I can solve it. It finds one &quot;Case&quot; and saves that in two different names."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 29, "user_id": 6726550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb13938ea264491fa624e831b5c00719?s=128&d=identicon&r=PG&f=1", "display_name": "user6726550", "link": "https://stackoverflow.com/users/6726550/user6726550"}, "edited": false, "score": 0, "creation_date": 1472842487, "post_id": 38999662, "comment_id": 65932175, "body": "No problem. If you found the answer to be the best solution, make sure you go ahead and mark it as accepted!"}], "tags": [], "owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "is_accepted": false, "score": 1, "last_activity_date": 1471444697, "creation_date": 1471444697, "answer_id": 38999662, "question_id": 38999118, "link": "https://stackoverflow.com/questions/38999118/excel-macro-that-saves-all-open-workbooks-if-they-meet-certain-criteria/38999662#38999662", "title": "Excel macro that saves all open workbooks if they meet certain criteria", "body": "<p>Do you have any experience with VBA? I used the macro recorder to figure out how to save. I made the following code and tested it, it worked fine for me. I did try running it twice and it prompted me if I wanted to overwrite the file. There is no other error handling built in it though. </p>\n\n<pre><code>Sub SaveWorkbooks()\n\nDim WB As Workbook\nDim FileName As String, FolderPath As String\nDim SaveWorkbook As Boolean\n\nFolderPath = \"Y:\\risk\"\nChDir FolderPath\n\nFor Each WB In Workbooks\n    Select Case WB.Sheets(1).Range(\"A1\").Value\n        Case Is = \"Currency\"\n            FileName = \"CCY\"\n        Case Is = \"Interest\"\n            FileName = \"IR\"\n        Case Else\n            FileName = \"\"\n    End Select\n    'Make sure it's not saving not applicable workbooks\n    If FileName &lt;&gt; \"\" Then SaveWorkbook = True Else SaveWorkbook = False\n\n    If SaveWorkbook = True Then\n        ActiveWorkbook.SaveAs FileName:=FolderPath &amp; \"\\\" &amp; FileName &amp; \".xlsx\", _\n            FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n    End If\n\nNext WB\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "is_accepted": false, "score": 1, "last_activity_date": 1471444893, "creation_date": 1471444893, "answer_id": 38999743, "question_id": 38999118, "link": "https://stackoverflow.com/questions/38999118/excel-macro-that-saves-all-open-workbooks-if-they-meet-certain-criteria/38999743#38999743", "title": "Excel macro that saves all open workbooks if they meet certain criteria", "body": "<p>I agree, with @thecoshman this hurt my eyes to read. This one time I'll make an exception. Try this:</p>\n\n<pre><code>Sub SaveWorkbooks()\nDim workbookObj As Workbook\n\nFor Each workbookObj In Excel.Workbooks\n    If workbookObj.Sheets(\"Book1\").Range(\"A1\").Value = \"whatever\" Then\n        workbookObj.Save\n        workbookObj.Close\n    End If\nNext workbookObj\n\n'Clean up\nSet workbookObj = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6726550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb13938ea264491fa624e831b5c00719?s=128&d=identicon&r=PG&f=1", "display_name": "user6726550", "link": "https://stackoverflow.com/users/6726550/user6726550"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1471459551, "creation_date": 1471443158, "last_edit_date": 1471459551, "question_id": 38999118, "link": "https://stackoverflow.com/questions/38999118/excel-macro-that-saves-all-open-workbooks-if-they-meet-certain-criteria", "title": "Excel macro that saves all open workbooks if they meet certain criteria", "body": "<p>How do I write a macro that runs through open workbooks and saves them with a specific name depending on the contents of each workbook. Each workbook have unique column headings in worksheet \"Book1\" so the workbook can be determined by the text in cell A1. If workbook and worksheet Book1 and cell A1 = \"Currency\" save active workbook as Y:\\risk\\CCY.csv if cell A1 = \"Interest\" save active workbook as Y:\\risk\\IR.csv. Loop through all open workbooks until no open workbooks meets the criteria. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1471442330, "post_id": 38998768, "comment_id": 65349088, "body": "Take out the error handler - does it throw any errors? If so, which one(s) and where?"}, {"owner": {"reputation": 142, "user_id": 5231306, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ef5ff363f7526feb5f70befa0782612?s=128&d=identicon&r=PG&f=1", "display_name": "Raptor776", "link": "https://stackoverflow.com/users/5231306/raptor776"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1471442460, "post_id": 38998768, "comment_id": 65349203, "body": "There are two, On Error Resume Next, or in the If Err.Number statement?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471443020, "post_id": 38998768, "comment_id": 65349660, "body": "in case of error your code goes to infinite loop and then stack overflow literally:)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1471443044, "post_id": 38998768, "comment_id": 65349680, "body": "What happens if you add <code>DoEvents</code> after every paste statement as well? i.e after the line <code>mySlide.Shapes.PasteSpecial ppPasteBitmap</code>. Also if you are latebinding, have you set the value of <code>ppPasteBitmap </code>?"}, {"owner": {"reputation": 142, "user_id": 5231306, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ef5ff363f7526feb5f70befa0782612?s=128&d=identicon&r=PG&f=1", "display_name": "Raptor776", "link": "https://stackoverflow.com/users/5231306/raptor776"}, "edited": false, "score": 0, "creation_date": 1471443204, "post_id": 38998768, "comment_id": 65349783, "body": "No I have not. Let me get back to you with the error because now it seems to be running without any problems. So let me try multiple scenarios that might cause the program to fail so I will be able to provide more details regarding the error."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471443283, "post_id": 38998768, "comment_id": 65349839, "body": "If it is working fine now then I guess the <code>DoEvents</code> trick just might help you..."}, {"owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 1, "creation_date": 1471443312, "post_id": 38998768, "comment_id": 65349860, "body": "try to change <code>ppPasteBitmap</code> to <code>ppPasteEnhancedMetafile</code>?"}, {"owner": {"reputation": 142, "user_id": 5231306, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ef5ff363f7526feb5f70befa0782612?s=128&d=identicon&r=PG&f=1", "display_name": "Raptor776", "link": "https://stackoverflow.com/users/5231306/raptor776"}, "edited": false, "score": 0, "creation_date": 1471443527, "post_id": 38998768, "comment_id": 65350052, "body": "I will try that winghei, Siddrhat the problem is it runs fine for a bit and then will sporadically start crashing. So not a total foolproof method yet"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1471443587, "post_id": 38998768, "comment_id": 65350112, "body": "@Raptor776 test my code below, I export all my Excel Ranges to PowerPoint Slides with this method"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471443906, "post_id": 38998768, "comment_id": 65350384, "body": "Did you even try the suggestion that I gave?"}, {"owner": {"reputation": 142, "user_id": 5231306, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ef5ff363f7526feb5f70befa0782612?s=128&d=identicon&r=PG&f=1", "display_name": "Raptor776", "link": "https://stackoverflow.com/users/5231306/raptor776"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471444723, "post_id": 38998768, "comment_id": 65351063, "body": "@Siddharth so keeping the rest of the code the same, and adding the line DoEvents after mySlide.Shapes.Past\u200c\u200beSpecial ppPasteBitmap didnt make a difference"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471444772, "post_id": 38998768, "comment_id": 65351100, "body": "Did it crash after inserting that line?"}], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 5231306, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ef5ff363f7526feb5f70befa0782612?s=128&d=identicon&r=PG&f=1", "display_name": "Raptor776", "link": "https://stackoverflow.com/users/5231306/raptor776"}, "edited": false, "score": 0, "creation_date": 1471443852, "post_id": 38999252, "comment_id": 65350336, "body": "Thanks! Will try this piece of code. Right now the old code somehow seems to be running fine. But I will build this code into the next revision for more robustness."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1471443532, "creation_date": 1471443532, "answer_id": 38999252, "question_id": 38998768, "link": "https://stackoverflow.com/questions/38998768/microsoft-excel-copy-paste-to-powerpoint-both-files-crashing/38999252#38999252", "title": "Microsoft Excel copy paste to Powerpoint, both files crashing", "body": "<p>Assuming you declared and set-up <code>mySlide</code> correctly to your desired slide, use the following code:</p>\n\n<pre><code>Dim myShape                             As Object\n\nSet myShape = mySlide.Shapes.PasteSpecial(ppPasteBitmap)\n\n'Set position:\nmyShape.Left = 50\nmyShape.Top = 141\nmyShape.Width = 620\nmyShape.Height = 320\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 5231306, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ef5ff363f7526feb5f70befa0782612?s=128&d=identicon&r=PG&f=1", "display_name": "Raptor776", "link": "https://stackoverflow.com/users/5231306/raptor776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471443532, "creation_date": 1471442224, "question_id": 38998768, "link": "https://stackoverflow.com/questions/38998768/microsoft-excel-copy-paste-to-powerpoint-both-files-crashing", "title": "Microsoft Excel copy paste to Powerpoint, both files crashing", "body": "<p>I have the following VBA code where I am copying an excel range to Powerpoint. I have played around with adding various delays to ensure the copy paste command is executed correctly, however the file crashed regardless of the delay. </p>\n\n<p>I currently have a <code>Do loop</code> and the file still crashes without exiting the loop. If somebody could provide some guidance, it will be greatly appreciated</p>\n\n<pre><code>rng.Copy\nDoEvents\n\nDo\n    On Error Resume Next\n    mySlide.Shapes.PasteSpecial ppPasteBitmap  '2 = ppPasteEnhancedMetafile\n    Set myShape = mySlide.Shapes(mySlide.Shapes.Count)\n    'Set position:\n    myShape.Left = 50\n    myShape.Top = 141\n    myShape.Width = 620\n    myShape.Height = 320\n\n    If Err.Number = 0 Then\n        On Error GoTo 0\n        Exit Do\n    End If\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 1, "creation_date": 1471441929, "post_id": 38998496, "comment_id": 65348808, "body": "I&#39;m sorry, i don&#39;t see any picture here or a link to it. What is that you are stuck with?"}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 2, "creation_date": 1471442696, "post_id": 38998496, "comment_id": 65349414, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12796973/function-to-convert-column-number-to-letter\">Function to convert column number to letter?</a>"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471442707, "post_id": 38998496, "comment_id": 65349426, "body": "@partyhatpanda..... deleted my answer. missed the letter part in question. :) Thanks for spotting that."}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": false, "score": 0, "last_activity_date": 1471442244, "creation_date": 1471442244, "answer_id": 38998775, "question_id": 38998496, "link": "https://stackoverflow.com/questions/38998496/excel-vba-find-column-name-of-first-blank-cell-in-row/38998775#38998775", "title": "Excel VBA Find column name of first blank cell in row", "body": "<p>I have a function that converts a column number to its letter, but I will try and convert it to simple code.</p>\n\n<pre><code>dim colLetter as string\nDim vArr\nvArr = Split(Cells(1, columnNumber).address(True, False), \"$\")\ncolLetter = vArr(0)\n</code></pre>\n\n<p>I am not sure how well it works standalone. The function that I use is:</p>\n\n<pre><code>Public Function Col_Letter(lngCol As Long) As String\n\nDim vArr\nvArr = Split(Cells(1, lngCol).address(True, False), \"$\")\nCol_Letter = vArr(0)\n\nEnd Function\n</code></pre>\n\n<p>And I know that works. Use whichever you like!</p>\n"}, {"comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1471444920, "post_id": 38999376, "comment_id": 65351206, "body": "@Jeeped I&#39;m pretty sure there are other ways to do this, but this gets it done :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1471444973, "post_id": 38999376, "comment_id": 65351243, "body": "My method was very close but I specified relative row and column addressing and replaced the 20 with vbNullString."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 1, "last_activity_date": 1471443876, "creation_date": 1471443876, "answer_id": 38999376, "question_id": 38998496, "link": "https://stackoverflow.com/questions/38998496/excel-vba-find-column-name-of-first-blank-cell-in-row/38999376#38999376", "title": "Excel VBA Find column name of first blank cell in row", "body": "<p>Your query of: -</p>\n\n<blockquote>\n  <p>to find the first blank/empty cell in row</p>\n</blockquote>\n\n<p>Is not answered by your code <code>wks2.Cells(20, wks2.Columns.Count).End(xlToLeft).Column</code>. Its a subtle but significant difference.</p>\n\n<p><code>.End(xlToLeft)</code> or <code>.End(xlUp)</code> is often used to find the <em>last</em> used cell in a row/column, a common requirement. To find the first used cell you either want to check each one or create a range based on all blank cells in a range, and look at the first item in that range.</p>\n\n<p>The below code did it for me, and included the column reference as a letter.</p>\n\n<pre><code>Public Sub Sample()\nDim wkb2        As Excel.Workbook\nDim wks2        As Excel.Worksheet\nDim strMSG      As String\nDim StrColumn   As String\nSet wkb2 = ThisWorkbook\n    Set wks2 = wkb2.Worksheets(\"Daily\")\n        StrColumn = Replace(wks2.Range(\"20:20\").SpecialCells(xlCellTypeBlanks).Cells(1, 1).Address, \"$\", \"\")\n        StrColumn = Left(StrColumn, Len(StrColumn) - 2)\n    Set wks2 = Nothing\nSet wkb2 = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6362894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-9VO69KHGVjA/AAAAAAAAAAI/AAAAAAAAADE/RF56hFLC-DY/photo.jpg?sz=128", "display_name": "Josh James", "link": "https://stackoverflow.com/users/6362894/josh-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1911, "favorite_count": 0, "accepted_answer_id": 38999376, "answer_count": 2, "score": 1, "last_activity_date": 1471443876, "creation_date": 1471441624, "last_edit_date": 1471443065, "question_id": 38998496, "link": "https://stackoverflow.com/questions/38998496/excel-vba-find-column-name-of-first-blank-cell-in-row", "title": "Excel VBA Find column name of first blank cell in row", "body": "<p>I am working in excel.  I need to be able to find the first blank/empty cell in row 20 starting from column A.  The return should be the actual column namei.e. AB, AAD, etc. What I am going to do is paste a value into this cell. Here is a picture of it with that row highlighted in green. </p>\n\n<pre><code>Dim wkb As Excel.Workbook\nDim wks2 As Excel.Worksheet\nDim strMSG As String\nDim LastRow As Long\n\nSet wkb2 = ThisWorkbook\nSet wks2 = wkb2.Sheets(\"Daily\")\ncolumnNumber = wks2.Cells(20, wks2.Columns.Count).End(xlToLeft).Column\n</code></pre>\n"}, {"tags": ["excel", "vba", "zip"], "owner": {"reputation": 55, "user_id": 6726572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed6b7692f19625dcb229a50c7e6b72c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Turner", "link": "https://stackoverflow.com/users/6726572/adam-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561802972, "creation_date": 1471441585, "last_edit_date": 1561802972, "question_id": 38998474, "link": "https://stackoverflow.com/questions/38998474/vba-copy-file-to-zip-difficulty", "title": "VBA copy file to .zip difficulty", "body": "<p>I am trying to package roughly 20-30 excel files into one zip to be emailed out after a process completes.  I am able to create the .zip file, and to copy files from one directory to another.  What I have not been able to do is copy a file into the .zip file.  Here is the code I have:</p>\n\n<hr>\n\n<pre><code>zipFile = \"C:\\testZip.zip\"\nzipPath = \"C:\\testZipFolder\\\"\nNewZip (zipFile)\nSet fs = CreateObject(\"scripting.filesystemobject\")\nfile = Dir(zipPath)\nSet zipFolder = fs.getfolder(zipPath)\nWhile (file &lt;&gt; \"\")\n  If InStr(file, \".xlsx\") &gt; 0 Then\n            I = I + 1\n            Set f = fs.getfile(\"C:\\\" &amp; file)\n            f.Copy (zipPath)\n            Debug.Print Err.Number\n            Debug.Print Err.Description\n</code></pre>\n\n<p>NewZip is a method that creates the .zip file.  I can open the .zip and move a file to it manually.  When I run the above code I get error 438: Object doesn't support this property or method.  If I change the destination path to some other folder, it will copy the file.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 102, "user_id": 2605995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3m5sB.jpg?s=128&g=1", "display_name": "raemaerne", "link": "https://stackoverflow.com/users/2605995/raemaerne"}, "edited": false, "score": 4, "creation_date": 1471440899, "post_id": 38998147, "comment_id": 65348023, "body": "Don&#39;t use VBA where it is not necessary. You can simply solve this without a macro with the excel function <code>SUMIF</code>"}], "answers": [{"tags": [], "owner": {"reputation": 102, "user_id": 2605995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3m5sB.jpg?s=128&g=1", "display_name": "raemaerne", "link": "https://stackoverflow.com/users/2605995/raemaerne"}, "is_accepted": false, "score": 4, "last_activity_date": 1471441520, "last_edit_date": 1471441520, "creation_date": 1471441066, "answer_id": 38998264, "question_id": 38998147, "link": "https://stackoverflow.com/questions/38998147/excel-vba-code-to-subtract/38998264#38998264", "title": "Excel VBA code to subtract", "body": "<p>Assuming Column B is the \"Amount\" Column and Column C is the \"Paid\" column, simply use the formula in the cell for \"left to pay\"</p>\n\n<pre><code>=SUMIF(C2:C4,\"=NO\",B2:B4)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "is_accepted": false, "score": 0, "last_activity_date": 1471441390, "creation_date": 1471441390, "answer_id": 38998399, "question_id": 38998147, "link": "https://stackoverflow.com/questions/38998147/excel-vba-code-to-subtract/38998399#38998399", "title": "Excel VBA code to subtract", "body": "<p>You can just use a <code>Formula</code> to evaluate the <code>Column</code> Paid:</p>\n\n<pre><code>=SUMIF(C2:C4;\"No\";B2:B4)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6726576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdda2d0eb4cef473d295aacf38b85fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Jose E", "link": "https://stackoverflow.com/users/6726576/jose-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1471441520, "creation_date": 1471440739, "last_edit_date": 1471440886, "question_id": 38998147, "link": "https://stackoverflow.com/questions/38998147/excel-vba-code-to-subtract", "title": "Excel VBA code to subtract", "body": "<p>I have the following table</p>\n\n<pre><code>Bills Amount Paid\n\nFood  $100    No\n\nGas   $200    Yes\n\nCar   $300    Yes\n\nTotal $600\n\nTotal left to pay: $400\n</code></pre>\n\n<p>And I have the following code</p>\n\n<pre><code>Sub Bills()\n\n    Range(\"C2\").Select\n    Do Until IsEmpty(ActiveCell)\n        If ActiveCell = \"Yes\" Then Range(\"B6\") = Range(\"B5\") - ActiveCell.Offset(0, -1)\n        ActiveCell.Offset(1, 0).Select\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>But it only subtracts the first \"Yes\" and when I change another to \"Yes\" i do not see were is getting the new amount to subtract it from. what am I missing?</p>\n\n<p>Goal: Whenever I have paid a bill and come here and select \"Yes\" and run the code it will subtract it from the total and show me how much I still have left to pay on bills.</p>\n\n<p>Thanks  in advance</p>\n"}, {"tags": ["excel", "vba", "loops", "refresh"], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 3, "last_activity_date": 1578016714, "last_edit_date": 1578016714, "creation_date": 1471440621, "answer_id": 38998099, "question_id": 38998059, "link": "https://stackoverflow.com/questions/38998059/pause-vba-loop-until-sheet-is-recalculated/38998099#38998099", "title": "Pause VBA loop until sheet is recalculated", "body": "<p>Use <code>Do While</code> \u2013 <code>If</code> is of no use. For <code>If</code> the code will evaluate once and then move forward. <code>Do While</code> will keep it looping until the condition is satisfied.</p>\n\n<pre><code>Do\n    DoEvents\nLoop While Not Application.CalculationState = xlDone\n</code></pre>\n"}], "owner": {"reputation": 806, "user_id": 6721603, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/41b37480f2461eabdca384d0819dca90?s=128&d=identicon&r=PG&f=1", "display_name": "freddy888", "link": "https://stackoverflow.com/users/6721603/freddy888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2239, "favorite_count": 0, "accepted_answer_id": 38998099, "answer_count": 1, "score": 1, "last_activity_date": 1578016714, "creation_date": 1471440510, "last_edit_date": 1578016645, "question_id": 38998059, "link": "https://stackoverflow.com/questions/38998059/pause-vba-loop-until-sheet-is-recalculated", "title": "Pause VBA loop until sheet is recalculated", "body": "<p>I searched Google until page 10, but could not find a solution for this. \n I have a loop in VBA, but want it to wait before proceeding until the sheet has recalculated.</p>\n\n<p>What most people suggest is employ <code>DoEvents</code>. However, that does not work for me.</p>\n\n<p>Here is my code so far, which does not wait until the sheet calculated:</p>\n\n<pre><code>Sub Replaceifrebalance() \nDim x As Integer \n\nNumRows = Range(\"CF16\", Range(\"CF16\").End(xlDown)).Rows.Count \n\nRange(\"CF16\").Select \n\nFor x = 1 To NumRows \n    If Range(\"CF\" &amp; x).Value &gt; 0 Then \n        Range(\"AW15:BF15\").Select \n        Application.CutCopyMode = False \n        Selection.Copy \n        Range(\"AW1\").Select \n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ \n        :=False, Transpose:=False \n        Range(\"AW\" &amp; 1 &amp; \":BF\" &amp; 1).Copy Worksheets(\"Timeseries\").Range(\"BI\" &amp; x &amp; \":BR\" &amp; x) \n\n        Application.Calculate \n        If Not Application.CalculationState = xlDone Then \n            DoEvents \n        End If \n    End If \n\nNext \n\nEnd Sub \n</code></pre>\n\n<p>Does anyone know a different solution than this one?:</p>\n\n<pre><code>  Application.Calculate \n    If Not Application.CalculationState = xlDone Then \n        DoEvents \n    End If \n</code></pre>\n"}, {"tags": ["c#", "excel", "vba"], "comments": [{"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1471440054, "post_id": 38997796, "comment_id": 65347350, "body": "I have never used but witn Interop there is Application.Run() method to run a macro."}, {"owner": {"reputation": 2866, "user_id": 327395, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lYouK.jpg?s=128&g=1", "display_name": "dazedandconfused", "link": "https://stackoverflow.com/users/327395/dazedandconfused"}, "edited": false, "score": 0, "creation_date": 1471440122, "post_id": 38997796, "comment_id": 65347417, "body": "This might be useful... <a href=\"http://stackoverflow.com/questions/9301354/inject-and-execute-excel-vba-code-into-spreadsheet-received-from-external-source\" title=\"inject and execute excel vba code into spreadsheet received from external source\">stackoverflow.com/questions/9301354/&hellip;</a>"}, {"owner": {"reputation": 343, "user_id": 4193116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0026bd50142b4050a9dc8e6e42c326?s=128&d=identicon&r=PG&f=1", "display_name": "prizm1", "link": "https://stackoverflow.com/users/4193116/prizm1"}, "edited": false, "score": 0, "creation_date": 1471440142, "post_id": 38997796, "comment_id": 65347435, "body": "<a href=\"http://stackoverflow.com/questions/38975802/excel-interop-c-sharp-cant-add-vbproject-error-800a03ec-on-workbook-vbproject-v/38978442?noredirect=1#comment65333643_38978442\" title=\"excel interop c sharp cant add vbproject error 800a03ec on workbook vbproject v\">stackoverflow.com/questions/38975802/&hellip;</a> fairly recent"}], "answers": [{"comments": [{"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "edited": false, "score": 0, "creation_date": 1471442247, "post_id": 38998670, "comment_id": 65349010, "body": "This runs an external file. I want to avoid that, b/c it means that the application will have to know where the file is on every users PC."}, {"owner": {"reputation": 399, "user_id": 3071558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001165848883/picture?type=large", "display_name": "Alvimar", "link": "https://stackoverflow.com/users/3071558/alvimar"}, "reply_to_user": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "edited": false, "score": 1, "creation_date": 1471442809, "post_id": 38998670, "comment_id": 65349506, "body": "You can have an Excel file that is the standard model with the macro to run. At run time you can clone your model and import or programmatically create the data for the clone, and run the macro."}], "tags": [], "owner": {"reputation": 399, "user_id": 3071558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001165848883/picture?type=large", "display_name": "Alvimar", "link": "https://stackoverflow.com/users/3071558/alvimar"}, "is_accepted": true, "score": 5, "last_activity_date": 1471441995, "last_edit_date": 1495539961, "creation_date": 1471441995, "answer_id": 38998670, "question_id": 38997796, "link": "https://stackoverflow.com/questions/38997796/run-a-macro-from-c/38998670#38998670", "title": "Run a Macro from C#", "body": "<p>You can run the macro as it is in Excel. \nLook at this:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/14248592/running-an-excel-macro-via-c-run-a-macro-from-one-workbook-on-another\">Running an Excel Macro via C#: Run a macro from one workbook on another?</a></p>\n\n<p><a href=\"http://oakdome.com/programming/CSharp_RunExcelMacro.php\" rel=\"noreferrer\">http://oakdome.com/programming/CSharp_RunExcelMacro.php</a></p>\n\n<p>If you do not want Excel to be visible during the execution, set the Visible property to false for the Excel.ApplicationClass.</p>\n"}, {"tags": [], "owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "is_accepted": false, "score": 1, "last_activity_date": 1553112288, "creation_date": 1553112288, "answer_id": 55269318, "question_id": 38997796, "link": "https://stackoverflow.com/questions/38997796/run-a-macro-from-c/55269318#55269318", "title": "Run a Macro from C#", "body": "<p>Here is example for this solution. I created workbook HelloWorldVBACodeExample.xlsm. Then in this workbook Module1 and VBA code:</p>\n\n<pre><code>Sub HelloWorld(word)\n\n  MsgBox \"Hello world and \" &amp; word\n\nEnd Sub\n</code></pre>\n\n<p>Then created console application with C# code:</p>\n\n<pre><code>using Microsoft.Office.Interop.Excel;\nusing _Excel = Microsoft.Office.Interop.Excel;\nusing System;\nusing System.IO;\n\nnamespace ConsoleAppCallVBA\n{\n    class Program\n    {\n    static void Main(string[] args)\n    {\n\n        string errorMessage = string.\n\n        #region Check is Excel is installed in the PC on which program is executed\n\n        _Application excel = new _Excel.Application();\n        if (excel == null)\n        {\n\n            errorMessage = \"EXCEL could not be started.\" + \"\\n\" +\n                \"This program is able to form reports only on PC with installed Excel. \" + \"\\n\" +\n                \"Check that your office installation is correct.\";\n            Console.WriteLine(errorMessage);\n        }\n\n        #endregion\n\n        excel.Visible = true;\n\n        string fileName = \"HelloWorldVBACodeExample.xlsm\";\n        string pathToExcelXlsmFile = Path.Combine(path, fileName);\n\n        Workbook wb;\n        Worksheet ws;\n        int sheetNumber = 1;\n        wb = excel.Workbooks.Open(pathToExcelXlsmFile);\n        ws = wb.Worksheets[sheetNumber];\n\n        //Call VBA code\n        excel.GetType().InvokeMember(\"Run\", System.Reflection.BindingFlags.Default | System.Reflection.BindingFlags.InvokeMethod, null, excel, new Object[] { \"HelloWorldVBACodeExample.xlsm!HelloWorld\", \"My Name\"});\n\n\n        #region Close excel object - release memory from this application\n\n        excel.Quit();\n        System.Runtime.InteropServices.Marshal.FinalReleaseComObject(excel);\n\n        #endregion\n        }\n     }\n }\n</code></pre>\n\n<p>During execution this C# code executed VBA code and showed in message box text \"Helo world and My Name\". In the case when this code snippet will be used, to string variable path must be assigned correct path of the directory where will be  xlsm file with VBA code.</p>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 11006286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b33d347d89602c1d8a3624041740af?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11006286/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1575903265, "creation_date": 1575903265, "answer_id": 59251380, "question_id": 38997796, "link": "https://stackoverflow.com/questions/38997796/run-a-macro-from-c/59251380#59251380", "title": "Run a Macro from C#", "body": "<p>You will have to enable msoAutomationSecurity to low and execute the macro as a string. However, you will probably want to reset the security setting to high after your done using the spreadsheets.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>    public void ExecuteExcelMacro(string sourceFile)\n    {\n        ExcelApp.Application ExcelApp = new ExcelApp.Application();\n        ExcelApp.DisplayAlerts = false;\n        ExcelApp.Visible = false;\n        ExcelApp.AutomationSecurity = Microsoft.Office.Core.MsoAutomationSecurity.msoAutomationSecurityLow;\n        ExcelApp.Workbook ExcelWorkBook = ExcelApp.Workbooks.Open(sourceFile);\n\n        string macro = \"Sheet1.SendEmailToUser\";\n\n        try\n        {\n            ExcelApp.Run(macro);\n            Console.WriteLine(\"Macro: \" + macro + \" exceuted successfully\");\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine(\"Unable to Run Macro: \" + macro + \" Exception: \" + ex.Message);\n        }\n\n        ExcelWorkBook.Close(false);\n        ExcelApp.Quit();\n        if (ExcelWorkBook != null) { System.Runtime.InteropServices.Marshal.ReleaseComObject(ExcelWorkBook); }\n        if (ExcelApp != null) { System.Runtime.InteropServices.Marshal.ReleaseComObject(ExcelApp); }\n    }\n</code></pre>\n"}], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18489, "favorite_count": 2, "accepted_answer_id": 38998670, "answer_count": 3, "score": 2, "last_activity_date": 1575903265, "creation_date": 1471439831, "last_edit_date": 1562341572, "question_id": 38997796, "link": "https://stackoverflow.com/questions/38997796/run-a-macro-from-c", "title": "Run a Macro from C#", "body": "<p>I am aware you can use  <code>Microsoft.Office.Interop.Excel;</code> to use VBA commands inside of a C# program.</p>\n\n<p>I have VBA that is close to 10,000 lines of code and translating that into C# compatible commands is just unrealistic. It creates a workbook and performs data manipulation and formatting to be printed as the user requests.</p>\n\n<p>Is there a way of storing the macro in C# and creating a workbook that I can then run the macro on as is?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471439489, "post_id": 38997449, "comment_id": 65346849, "body": "Try &quot;If Year(PivotItem.Value)&quot;."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471442885, "post_id": 38997449, "comment_id": 65349564, "body": "@Qqqqq  try the code in my answer below"}, {"owner": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "reply_to_user": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471452604, "post_id": 38997449, "comment_id": 65356104, "body": "@Mats Lind .value didn&#39;t work because Excel added less than and greater than values so not all values in the year field are formatted with 2015, 2016, etc. formats."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "edited": false, "score": 0, "creation_date": 1471452758, "post_id": 38999012, "comment_id": 65356172, "body": "assumption 2 doesn&#39;t hold true, as excel adds a &lt;1/1/2010 and &gt;8/1/2016 value to the Years field.  I tried updating my code and now I&#39;m getting a new error.  I edited my question to reflect current code.  Any further suggestions would be appreciated!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "edited": false, "score": 0, "creation_date": 1471453005, "post_id": 38999012, "comment_id": 65356293, "body": "@Qqqqq buy now you have changed your post code, and half of the responses are not relevant, usually we don&#39;t do it on SO. In what format do you get the &quot;Years&quot; field ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "edited": false, "score": 0, "creation_date": 1471453516, "post_id": 38999012, "comment_id": 65356594, "body": "@Qqqqq try edited code (if your &quot;Years&quot; is formatted as &quot;dd/dd/yyyy&quot;)"}, {"owner": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "edited": false, "score": 0, "creation_date": 1471457192, "post_id": 38999012, "comment_id": 65358574, "body": "Sorry about changing the original post. I&#39;m brand new here, and got a little confused about the best way to show updated code.  I have put the original post back as it was, and now the new code is shown as Edit 1."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "edited": false, "score": 0, "creation_date": 1471457368, "post_id": 38999012, "comment_id": 65358674, "body": "Can u upload a screen shot of one of your Pivot tables? I want to see how the fields and the data looks like (I can&#39;t simulate your error with my data)"}, {"owner": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "edited": false, "score": 0, "creation_date": 1471457733, "post_id": 38999012, "comment_id": 65358883, "body": "I reset the macro and ran through it again, and with the line &quot;If Year(CDate(ptItm.Value)) &lt; cy Then&quot; I get type mismatch error."}, {"owner": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "edited": false, "score": 0, "creation_date": 1471457964, "post_id": 38999012, "comment_id": 65359019, "body": "The original data is a date field, grouped into years.  The original dates are formatted as 1/1/2010  3:58:55 PM.  I think the pivot table just picks up 1/1/2010.  The first ptItm.value = &quot;&lt;1/1/2010&quot;.  (I don&#39;t know how to upload screenshots here.)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "edited": false, "score": 0, "creation_date": 1471526036, "post_id": 38999012, "comment_id": 65388737, "body": "@Qqqqq are your dates grouped into <code>Month</code> and <code>Year</code> ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "edited": false, "score": 0, "creation_date": 1471528575, "post_id": 38999012, "comment_id": 65390580, "body": "@Qqqqq try the modified code (just figured it out now , I hope), it handles the dates stored in your Pivot in diffrent types of Strings"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1471528531, "last_edit_date": 1471528531, "creation_date": 1471442863, "answer_id": 38999012, "question_id": 38997449, "link": "https://stackoverflow.com/questions/38997449/collapse-pivot-table-detail-for-prior-years/38999012#38999012", "title": "Collapse pivot table detail for prior years", "body": "<p>As long as <code>Range(H1).value</code> is a date (cy is a number), then the code below colapses all Years &lt; cy :</p>\n\n<pre><code>Option Explicit\n\nSub Collapse_Pivot_PrevYears()\n\nDim ws                  As Worksheet\nDim datecell            As Range\nDim cy                  As Long\nDim pvtFld              As PivotField\nDim pvtitem             As PivotItem\nDim pvtTbl              As PivotTable\n\n\nApplication.ScreenUpdating = False\n\nSet datecell = ThisWorkbook.Worksheets(\"Index\").Range(\"H1\")\ncy = year(datecell)\n\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name Like \"1\" &amp; \"*\" Or ws.Name Like \"2\" &amp; \"*\" Or ws.Name Like \"3\" &amp; \"*\" Then\n\n        Set pvtTbl = ws.PivotTables(\"PivotTable1\")\n\n        ' set Pivot field variable to \"Years\"\n        Set pvtFld = ws.PivotTables(\"PivotTable1\").PivotFields(\"Years\")\n\n        For Each pvtitem In pvtFld.PivotItems\n            Dim pvtYear         As Long\n\n            ' added: manipulation of Date formats in different types of strings\n            Select Case Len(pvtitem.Name)\n                Case 4   ' date in format of \"2011\" , \"2012\"\n                    pvtYear = CLng(pvtitem.Value)\n\n                Case 11  ' date in format of \"&lt;01/01/2010\"\n                    pvtYear = year(CDate(Mid(pvtitem.Value, 2)))\n\n                Case Else ' if you will have any other date formats in the future\n\n            End Select\n\n            If pvtYear &lt; cy Then\n                pvtFld.PivotItems(CStr(pvtYear)).ShowDetail = False\n            Else\n                pvtitem.ShowDetail = True\n            End If\n\n\n\n        Next pvtitem\n\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472035526, "post_id": 39005215, "comment_id": 65587897, "body": "Since you took 99% of my code, please mark my answer as &quot;answer&quot;"}, {"owner": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472251339, "post_id": 39005215, "comment_id": 65693353, "body": "@Shai Rado You did help me with fine-tuning my code, and I am very appreciative of your input.  I ended up using the final code I posted back here on Aug 17, and didn&#39;t see your Aug 18 edits until today.  I would love to mark your answer as &quot;answer&quot;, but I&#39;ve never tried the code in your final post. I did mark your answer useful, but it doesn&#39;t show &#39;cause I don&#39;t have status."}], "tags": [], "owner": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "is_accepted": false, "score": 0, "last_activity_date": 1471463766, "creation_date": 1471463766, "answer_id": 39005215, "question_id": 38997449, "link": "https://stackoverflow.com/questions/38997449/collapse-pivot-table-detail-for-prior-years/39005215#39005215", "title": "Collapse pivot table detail for prior years", "body": "<p>Thank you for helping me work this out, Shai Rado.  It turns out the last code I asked about would have worked if I had used ShowDetail instead of ShowDetails.  I guess it is all in the details. :)</p>\n\n<p>For anyone else who might want a macro that collapses all prior year details in multiple pivot tables across multiple worksheets, this is my final code:</p>\n\n<pre><code>Sub CollapsePYDetail()\n'\n' Colapse prior year detail\n'\nDim ws As Worksheet\nDim pt As PivotTable\nDim ptItm As PivotItem\nDim datecell As Range\nDim cy As Long\nDim ptItmY As Long\n\n'Turn off screen updating\nApplication.ScreenUpdating = False\n\n'Change calculation option to manual\nApplication.Calculation = xlManual\n\n'Make the status bar visible\nApplication.DisplayStatusBar = True\n\n'Set the location where the cutoff date is stored (update the worksheet name and cell for your use)\nSet datecell = ThisWorkbook.Worksheets(\"Index\").Range(\"H1\")\ncy = Year(datecell)\n\nFor Each ws In ThisWorkbook.Worksheets\n\n    'Show the progress in the statusbar:\n    Application.StatusBar = \"Collapsing prior year detail on tab \" &amp; ws.Name\n\n    'Loop through worksheets with pivot tables (update with your worksheet name criteria, or eliminate this if statement if you want to loop through all worksheets) \n    If ws.Name Like \"1\" &amp; \"*\" Or ws.Name Like \"2\" &amp; \"*\" Or ws.Name Like \"3\" &amp; \"*\" Then\n        'Loop through each pivot table on the worksheet\n        For Each pt In ws.PivotTables\n            'Loop through each item in the Years field, collapsing everything not in the current year\n            For Each ptItm In pt.PivotFields(\"Years\").PivotItems\n                ptItmY = Right(ptItm, 4)\n                If ptItmY = cy Then\n                    ptItm.ShowDetail = True\n                    'Use \"on error to resume next\" to prevent an error where the detail is already collapsed\n                    On Error Resume Next\n                    Else: ptItm.ShowDetail = False\n                End If\n            Next ptItm\n        Next pt\n    End If\nNext ws\n\n'Notify user the process has finished\nMsgBox \"Prior year detail has been collapsed for all tabs.\"\n\n'Reset the statusbar:\nApplication.StatusBar = False\n\n'Return calculation option to automatic\nApplication.Calculation = xlAutomatic\n\n'Turn on screen updating\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "is_accepted": false, "score": 0, "last_activity_date": 1572397733, "creation_date": 1572397733, "answer_id": 58617446, "question_id": 38997449, "link": "https://stackoverflow.com/questions/38997449/collapse-pivot-table-detail-for-prior-years/58617446#58617446", "title": "Collapse pivot table detail for prior years", "body": "<p>OP has clearly resolved issue, but I will post how I did it with my code to perhaps help future readers who end up on this page.</p>\n\n<p><strong>This is how I create the PivotField:</strong></p>\n\n<pre><code>With PSheet.PivotTables(\"PivotTable\").PivotFields(\"Date\")\n .Orientation = xlRowField\n .Position = 1\n .DataRange.Cells(1).Group Periods:=Array(False, False, False, True, True, False, True)\n 'Seconds--&gt;Minutes--&gt;Hours--&gt;Days--&gt;Months--&gt;Quarters--&gt;Years\nEnd With\n</code></pre>\n\n<p><strong>This is how I expand/collapse it to desired level:</strong></p>\n\n<pre><code>With PSheet.PivotTables(\"PivotTable\")\n .PivotFields(\"Years\").ShowDetail = False\n .PivotFields(\"Months\").ShowDetail = False\n .PivotFields(\"Years\").PivotItems(Format(Now(), \"yyyy\")).DrillTo \"Months\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6726313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78271a41daf8bfef073fca32ca8eac?s=128&d=identicon&r=PG&f=1", "display_name": "Qqqqq", "link": "https://stackoverflow.com/users/6726313/qqqqq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 679, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1580265414, "creation_date": 1471438983, "last_edit_date": 1580265414, "question_id": 38997449, "link": "https://stackoverflow.com/questions/38997449/collapse-pivot-table-detail-for-prior-years", "title": "Collapse pivot table detail for prior years", "body": "<p>I have a workbook with about 120 tabs, each containing one or two pivot tables.</p>\n\n<p>The pivot tables are updated and refreshed monthly.</p>\n\n<p>I am struggling to collapse all prior year data.</p>\n\n<p>This code works, but I need to update and re-run it for each prior year:</p>\n\n<pre><code>Dim ws As Worksheet\nApplication.ScreenUpdating = False\n\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name Like \"1\" &amp; \"*\" Or ws.Name Like \"2\" &amp; \"*\" Or ws.Name Like \"3\" &amp; \"*\" Then\n        ws.PivotTables(\"PivotTable1\").PivotFields(\"Years\").PivotItems(\"2015\"). _\n            ShowDetail = False\n        On Error Resume Next\n        ws.PivotTables(\"PivotTable2\").PivotFields(\"Years\").PivotItems(\"2015\"). _\n            ShowDetail = False\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>I would prefer code that can collapse all prior year data.  </p>\n\n<p>I tried the following, and it produces a</p>\n\n<blockquote>\n  <p>run-time error 438 object doesn't support this property or method:</p>\n</blockquote>\n\n<pre><code>Dim ws As Worksheet\nDim datecell As Range\nDim cy As Long\n\nApplication.ScreenUpdating = False\n\nSet datecell = ThisWorkbook.Worksheets(\"Index\").Range(\"H1\")\ncy = Year(datecell)\n\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name Like \"1\" &amp; \"*\" Or ws.Name Like \"2\" &amp; \"*\" Or ws.Name Like \"3\" &amp; \"*\" Then\n        'the following line produces the \n        ' run-time 438 object doesn't support this property or method error\n        If Year(ws.PivotTables(\"PivotTable1\").PivotFields(\"Years\").PivotItems) &lt; cy Then\n            PivotItem.ShowDetails = False\n        End If\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>I also tried the following, and it produces a</p>\n\n<blockquote>\n  <p>run-time error 13 type mismatch:</p>\n</blockquote>\n\n<pre><code>Dim ws As Worksheet\nDim datecell As Range\nDim cy As Long\n\nApplication.ScreenUpdating = False\n\nSet datecell = ThisWorkbook.Worksheets(\"Index\").Range(\"H1\")\ncy = Year(datecell)\n\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name Like \"1\" &amp; \"*\" Or ws.Name Like \"2\" &amp; \"*\" Or ws.Name Like \"3\" &amp; \"*\" Then\n        For Each PivotItem In ws.PivotTables(\"PivotTable1\").PivotFields(\"Years\").PivotItems\n            'the following line produces the run-time 13 type mismatch error\n            If Year(PivotItem) &lt; cy Then\n                PivotItem.ShowDetails = False\n            End If\n        Next PivotItem\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>How do I correct my code?</p>\n\n<p>Edit 1:<br>\nThe following code produces a</p>\n\n<blockquote>\n  <p>run-time error 438: Object doesn't support this property or method:</p>\n</blockquote>\n\n<pre><code>Dim ws As Worksheet\nDim pt As PivotTable\nDim ptItm As PivotItem\nDim datecell As Range\nDim cy As Long\nDim ptItmY As Long\n\nApplication.ScreenUpdating = False\n\nSet datecell = ThisWorkbook.Worksheets(\"Index\").Range(\"H1\")\ncy = Year(datecell)\n\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name Like \"1\" &amp; \"*\" Or ws.Name Like \"2\" &amp; \"*\" Or ws.Name Like \"3\" &amp; \"*\" Then\n        For Each pt In ws.PivotTables\n            For Each ptItm In pt.PivotFields(\"Years\").PivotItems\n                ptItmY = Right(ptItm, 4)\n                If ptItmY &lt; cy Then\n                    'the following line produces\n                    ' run-time error 438: Object doesn't support this property or method\n                    ptItm.ShowDetails = False\n                    Else: ptItm.ShowDetails = True\n                End If\n            Next ptItm\n        Next pt\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>Uploaded image of a pivot table:\n<a href=\"https://i.stack.imgur.com/307xs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/307xs.jpg\" alt=\"Pivot table format\"></a></p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6204178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/217fa27c93ac0576080b8ade3a481e6d?s=128&d=identicon&r=PG&f=1", "display_name": "Spotless ", "link": "https://stackoverflow.com/users/6204178/spotless"}, "edited": false, "score": 0, "creation_date": 1471439467, "post_id": 38997463, "comment_id": 65346831, "body": "Thanks, but i don&#39;t get it. I don&#39;t understand your code actually. Where is the paste?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 1, "user_id": 6204178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/217fa27c93ac0576080b8ade3a481e6d?s=128&d=identicon&r=PG&f=1", "display_name": "Spotless ", "link": "https://stackoverflow.com/users/6204178/spotless"}, "edited": false, "score": 0, "creation_date": 1471439545, "post_id": 38997463, "comment_id": 65346905, "body": "in the same line as copy. Read this, it will help : <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837760.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff837760.aspx</a>"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1471439023, "creation_date": 1471439023, "answer_id": 38997463, "question_id": 38997269, "link": "https://stackoverflow.com/questions/38997269/vba-loop-to-start-a-macro/38997463#38997463", "title": "Vba loop to start A macro", "body": "<p>This line is wrong <code>Sheet2.cells(\"A3\").Paste</code> \nChange your code as </p>\n\n<pre><code>Sheet1.Cells(2, 1).Copy Sheet2.Range(\"A3\")\nApplication.CutCopyMode = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1471443235, "creation_date": 1471443235, "answer_id": 38999149, "question_id": 38997269, "link": "https://stackoverflow.com/questions/38997269/vba-loop-to-start-a-macro/38999149#38999149", "title": "Vba loop to start A macro", "body": "<p>use some little good coding habits:</p>\n\n<pre><code>Option Explicit '&lt;--| this will force you to explicitly declare each variable but will repay you with much more control over your code and save both code debugging and maintaining time\n\nSub macro1()\n    Dim i As Long '&lt;--| better use Long instead of Integer type\n\n    For i = 6 To 100\n        Sheet2.Cells(\"A3\").Value = Sheet1.Cells(i, 1).Value '&lt;--| just copy values\n        macro2 '&lt;--| call macro2, no need far \"Call\" keyword\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6204178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/217fa27c93ac0576080b8ade3a481e6d?s=128&d=identicon&r=PG&f=1", "display_name": "Spotless ", "link": "https://stackoverflow.com/users/6204178/spotless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1471443235, "creation_date": 1471438546, "last_edit_date": 1471438761, "question_id": 38997269, "link": "https://stackoverflow.com/questions/38997269/vba-loop-to-start-a-macro", "title": "Vba loop to start A macro", "body": "<p>I have some issues with a function.</p>\n\n<p>I have date in column A6 to A100\nI would like to do this: for each date, copy this date and start a macro base on the date.\nIt only copy but thats it its not working. A y idea? Thanks </p>\n\n<p>So far I have this: </p>\n\n<pre><code> Sub macro1\n    Dim I as variant \n    Din sheet1 as worksheet\n    Dim sheet2 as worksheet \n\n    For I = 6 to 100\n    Sheet1.cells(I,1).copy\n    Sheet2.cells(\"A3\").paste\n\n    Call macro2\n\n    Next i\n\nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "replace", "constants"], "comments": [{"owner": {"reputation": 21, "user_id": 4093449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a416c8f0659b026cfbb281d2dcacece?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4093449/dan"}, "edited": false, "score": 0, "creation_date": 1471437365, "post_id": 38996722, "comment_id": 65345128, "body": "I&#39;ve tried:  ////    .Replace What:=&quot;$A$&quot; &amp; fn ///// But that doesn&#39;t work, I get an error of sorts"}, {"owner": {"reputation": 21, "user_id": 4093449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a416c8f0659b026cfbb281d2dcacece?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4093449/dan"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1471438347, "post_id": 38996722, "comment_id": 65345891, "body": "I wonder if I did a newVariable = &quot;$A$&quot; &amp; fn, instead of using fn to replace, I use newVariable. Since it doesn&#39;t look like you can create $A$fn."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1471438561, "post_id": 38996722, "comment_id": 65346070, "body": "other option is to use named ranges instead of address for fixed locations."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4093449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a416c8f0659b026cfbb281d2dcacece?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4093449/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1471439187, "creation_date": 1471439187, "answer_id": 38997528, "question_id": 38996722, "link": "https://stackoverflow.com/questions/38996722/replace-specific-criteria-once/38997528#38997528", "title": "Replace specific criteria once", "body": "<p>Adding a new variable to combine the constraints $A$ to the cell #, seems to work compared to trying to combine $A$ and the cell # within the replace code.  </p>\n\n<pre><code>    For fn = 1 To 10000\n    Set networkCell = Cells(fn, 1)\n        If networkCell.Value = \"New Station Template\" Then\n            Range(Cells(fn, 1), Cells(fn + 5, 10)).Copy\n            Range(Cells(endRow, 1), Cells(endRow + 5, 10)).Select\n            ActiveSheet.Paste\n            Cells(endRow, 1).Value = \"New Station\"\n            oldForm = \u201c$A$\u201d &amp; fn\n            newForm = \u201c$A$\u201d &amp; endRow\n            Range(Cells(endRow + 2, 2), Cells(endRow + 2, 7)).Replace What:= oldForm, Replacement:= newForm,  SearchOrder:=xlByColumns, MatchCase:=True\n\n            count = count + 1\n            Exit For\n        End If\n    Next\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4093449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a416c8f0659b026cfbb281d2dcacece?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4093449/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471439187, "creation_date": 1471437001, "last_edit_date": 1471437503, "question_id": 38996722, "link": "https://stackoverflow.com/questions/38996722/replace-specific-criteria-once", "title": "Replace specific criteria once", "body": "<p>been learning VBA and it's already helped 10 fold with the projects I'm working on.</p>\n\n<p>I've hit a snag though.</p>\n\n<p>Right now I currently have a \"template table\", which has formulas built into it.</p>\n\n<p>It looks something like this:</p>\n\n<pre><code>Name\nDate  Revenue   Cost  profit  margin\n8/08  $10,000   $5000 $5000   100%\n\nTotal xxx       xxx    xxx\n</code></pre>\n\n<p>So when I have a new name to add, I copy that whole \"template table\" and paste it below the last cells used (I looped to find the last cell, so this is labeled endRow).  Inside the 8/08 date row (for revenue/cost) I have an indirect formula, so I lookup the 'Name' within the sheet name 8/08 (I label the sheet names the date). </p>\n\n<p>I need to keep the 'Name' a constant so it's $A$20 for that whole box. As I add new dates, it stays $A$20, while the other formulas change as I insert the dates (IE references the date directly to the left).</p>\n\n<p>This is what I've been doing to replace the formula. Only issue is, if my template is in cell $A$9, and I go to replace the 9 to say 25, if the formula for the date tab is say 19, it changes the 19 to 125.  So it's changing all the 9's to 25. I just want to change the formula that was $A$fn but I get an error doing that.</p>\n\n<p>fn = my for loop to discover where the template box is. So I'm replacing that original formula with the new cell that I pasted it to</p>\n\n<pre><code>Range(Cells(endRow + 2, 2), Cells(endRow + 2, 7)).Replace What:=fn,    Replacement:=endRow, SearchOrder:=xlByColumns, MatchCase:=True\n</code></pre>\n\n<p>So the question is, how to change $A$x (x being the cell #) to $A$y (the new cell #) and not touching Ax.  </p>\n\n<pre><code>    For fn = 1 To 10000\n    Set networkCell = Cells(fn, 1)\n        If networkCell.Value = \"New Station Template\" Then\n            Range(Cells(fn, 1), Cells(fn + 5, 10)).Copy\n            Range(Cells(endRow, 1), Cells(endRow + 5, 10)).Select\n            ActiveSheet.Paste\n            Cells(endRow, 1).Value = \"New Station\"\n            Range(Cells(endRow + 2, 2), Cells(endRow + 2, 7)).Replace What:=fn, Replacement:=endRow, SearchOrder:=xlByColumns, MatchCase:=True\n            count = count + 1\n            Exit For\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["vba", "date", "if-statement"], "answers": [{"tags": [], "owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "is_accepted": false, "score": 0, "last_activity_date": 1471442249, "creation_date": 1471442249, "answer_id": 38998779, "question_id": 38996524, "link": "https://stackoverflow.com/questions/38996524/run-a-code-if-a-range-contains-a-date-in-a-given-period/38998779#38998779", "title": "Run a code if a range contains a date in a given period", "body": "<p>The following code should do the work:</p>\n\n<pre><code>Sub CheckDate()\n\nDim MyRange As Range: Set MyRange = Range(Cells(1, 2), Cells(Rows.Count, 2).End(xlUp))\nDim DateCell As Range\n\n    For Each DateCell In MyRange\n\n        If Year(DateCell) = 2015 Then\n\n            DateCell.Offset(0, 11).Formula = \"=AVERAGEIFS(I:I,B:B,\"\"&gt;=\"\"&amp;DATE(2015,1,1),B:B,\"\"&lt;=\"\"&amp;DATE(2015,12,31),G:G,\"\"=FALSE\"\")\"\n\n        End If\n\n    Next DateCell\n\nEnd Sub\n</code></pre>\n\n<p>I set <code>MyRange</code> from B1 to the last non empty row, then I do do a <code>For Each</code> loop through it and check if the year of the date is equal to 2015, if it is I apply your formula using <code>.Offset(0, 11)</code> which stay on the same row (0) and move 11 columns to the right (11) so to column M in the same row.</p>\n"}], "owner": {"reputation": 29, "user_id": 6234420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c4aff8d7d8b32fe7d652e488ca9a6125?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/6234420/niko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471442249, "creation_date": 1471436483, "last_edit_date": 1471438810, "question_id": 38996524, "link": "https://stackoverflow.com/questions/38996524/run-a-code-if-a-range-contains-a-date-in-a-given-period", "title": "Run a code if a range contains a date in a given period", "body": "<p>I want to come up with a code that checks if B:B contains dates between 1/1/2015 and 12/31/2015. If the criteria is met then I want the code to run the following code:</p>\n\n<pre><code>Range(\"m2\").Formula = \"=AVERAGEIFS(I:I,B:B,\"\"&gt;=\"\"&amp;DATE(2015,1,1),B:B,\"\"&lt;=\"\"&amp;DATE(2015,12,31),G:G,\"\"=FALSE\"\")\" \n</code></pre>\n\n<p>And if the criteria is not met the I need no further actions to be taken. I also need to refer to the period in a way that will enable the code to work with all date&amp;region formats.</p>\n\n<p>Any help on the matter is highly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 195, "user_id": 3751928, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f2c4db40c072b503d699cfbb79620512?s=128&d=identicon&r=PG&f=1", "display_name": "GEnGEr", "link": "https://stackoverflow.com/users/3751928/genger"}, "edited": false, "score": 0, "creation_date": 1471436059, "post_id": 38996219, "comment_id": 65344224, "body": "putting a &#39; bevore the ip should solve the problem"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 195, "user_id": 3751928, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f2c4db40c072b503d699cfbb79620512?s=128&d=identicon&r=PG&f=1", "display_name": "GEnGEr", "link": "https://stackoverflow.com/users/3751928/genger"}, "edited": false, "score": 0, "creation_date": 1471436275, "post_id": 38996219, "comment_id": 65344372, "body": "You might update your question and tell people which country you are in (I guess you are in Turkey) and this helps people understand that your thousands separator is a <code>.</code> and not a <code>,</code> like in English-speaking countries. Agree with comment from @GEnGEr to use a <code>&#39;</code> before the input, if possible."}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 6618313, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/291864316b256fb10e1ee584dde53375?s=128&d=identicon&r=PG&f=1", "display_name": "Mopaed", "link": "https://stackoverflow.com/users/6618313/mopaed"}, "is_accepted": false, "score": 0, "last_activity_date": 1473762134, "last_edit_date": 1473762134, "creation_date": 1471436315, "answer_id": 38996465, "question_id": 38996219, "link": "https://stackoverflow.com/questions/38996219/funny-and-annoying-excel-issue-with-ip-the-address/38996465#38996465", "title": "Funny and annoying excel issue with IP the address", "body": "<p>If you are copy and pasting this ID adress you should press crtl + w so that Excel is getting the value of the cell and not the cell out of the other documents. This was helping by Errors with numbers which I got formatted to Dates.</p>\n\n<p>If you are typing in the adress manually you should Format the whole column or row before you are inserting the IP- Adress this may help.</p>\n\n<p>The last possibility is to write a macro which is automatically started if something in the column is changed and then it should insert the dots for you. </p>\n"}, {"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471442476, "post_id": 38998770, "comment_id": 65349218, "body": "it should resolve the issue. I don&#39;t see any reason why not. ++"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471442508, "post_id": 38998770, "comment_id": 65349243, "body": "macro enabled file is .xlsm :) 2007 onwards."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1471447516, "post_id": 38998770, "comment_id": 65353059, "body": "Thanks! I&#39;m forced against my will to use Excel in Swedish at work, so most of my workhours are spent on trying to figure out what the function I know by heart is called in swedish. You may think it&#39;s logic, but you are wrong ;-)"}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 2, "last_activity_date": 1471442229, "creation_date": 1471442229, "answer_id": 38998770, "question_id": 38996219, "link": "https://stackoverflow.com/questions/38996219/funny-and-annoying-excel-issue-with-ip-the-address/38998770#38998770", "title": "Funny and annoying excel issue with IP the address", "body": "<p>You can use VBA to autotoggle the thousands separator.  </p>\n\n<p>Open VBA editor by ALT + F11<br>\nDoubleclick on ThisWorkbook in project window on the left.<br>\nIn the textwindow that opens paste this code:  </p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    With Application\n        .UseSystemSeparators = True\n    End With\n\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    With Application\n        .ThousandsSeparator = \",\"\n        .UseSystemSeparators = False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This will make \",\" a thousands separator for Excel when you open the workbook and reset it to \"default\" when you close.<br>\nKeep in mind that if you have two workbooks open this may cause conflicts on the other workbook, or if Excel by some reason crashes.<br>\nIf it does crash, reopen this workbook and close it again (unless you need to keep working with it).<br>\nThe important thing to remember is that the workbook needs to be closed to reset the settings of Excel.  </p>\n\n<p>EDIT; after you added the code you need to save the file as and Excel file with macrocode (can't remember the correct name of it) and close and reopen it.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6726209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/477ddd7aee3d3fac9c9bb8f71eccc2ca?s=128&d=identicon&r=PG&f=1", "display_name": "Ege Oncel", "link": "https://stackoverflow.com/users/6726209/ege-oncel"}, "is_accepted": false, "score": 0, "last_activity_date": 1471585943, "creation_date": 1471585943, "answer_id": 39031961, "question_id": 38996219, "link": "https://stackoverflow.com/questions/38996219/funny-and-annoying-excel-issue-with-ip-the-address/39031961#39031961", "title": "Funny and annoying excel issue with IP the address", "body": "<p>Thanks guys putting a ' before the number worked as a charm.</p>\n"}], "owner": {"reputation": 11, "user_id": 6726209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/477ddd7aee3d3fac9c9bb8f71eccc2ca?s=128&d=identicon&r=PG&f=1", "display_name": "Ege Oncel", "link": "https://stackoverflow.com/users/6726209/ege-oncel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1473762134, "creation_date": 1471435659, "question_id": 38996219, "link": "https://stackoverflow.com/questions/38996219/funny-and-annoying-excel-issue-with-ip-the-address", "title": "Funny and annoying excel issue with IP the address", "body": "<p>so here is my problem. When I type 10.100.100.10 in excel, it is perfectly fine. If I type 10.100.100.100 or any other number with more digits excel automatically gets rid of the dots. I can solve this by replacing the cell formats to text. But this leads me to another problem. I have to add dots again once after the format change and that is not very easy due to the nature of the files that I work with. Even if I do that, when I try to find/replace for example 10.100.100 with 10.100.900 , all the dots get removed again.</p>\n\n<p>note: I tried to fix the cell format when replacing, that did not work.\nnote 2: My pc and excel are 64 bits.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "if-statement", "macros"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 4, "creation_date": 1471432634, "post_id": 38994705, "comment_id": 65341902, "body": "I think you&#39;ve answered your own question &quot;a simple if statement&quot; I doubt you&#39;ll get anyone to write it for you."}, {"owner": {"reputation": 365, "user_id": 4890963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-736h1CBQBh8/AAAAAAAAAAI/AAAAAAAABbc/4ybXk5rbcb4/photo.jpg?sz=128", "display_name": "CyberClaw", "link": "https://stackoverflow.com/users/4890963/cyberclaw"}, "edited": false, "score": 1, "creation_date": 1471432755, "post_id": 38994705, "comment_id": 65342004, "body": "Start by showing what you tried. People are more inclined to help you correct your mistakes, than do your (simple) job for you. It&#39;s actually how stackoverflow works."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1471436843, "post_id": 38994705, "comment_id": 65344755, "body": "You don&#39;t even need VBA for this...a simple <code>Formula</code> will do"}, {"owner": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "edited": false, "score": 0, "creation_date": 1471437094, "post_id": 38994705, "comment_id": 65344906, "body": "It is automated data that is already part of a bigger macro, having a formula would not work as the amount of cells changes on a monthly basis."}, {"owner": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "edited": false, "score": 0, "creation_date": 1471437983, "post_id": 38994705, "comment_id": 65345619, "body": "Range(&quot;HD5&quot;).Select     ActiveCell.FormulaR1C1 = &quot;=IF(RC[-190]&gt;1,&quot;&quot;ND&quot;&quot;,&quot;&quot;NA&quot;&quot;)&quot;     Range(&quot;HD5&quot;).Select     Selection.Copy     Range(Selection, Selection.End(xlDown)).Select     Application.CutCopyMode = False     Selection.FillDown"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1471454670, "post_id": 38994705, "comment_id": 65357229, "body": "u don need vba or formula to do this. a simple find and replace will do. first find all &#39;1&#39; and replace with NA, then find all numbers and replace with ND"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "edited": false, "score": 0, "creation_date": 1471443391, "post_id": 38998774, "comment_id": 65349918, "body": "I am getting an error with workingrange as nothing, apologies if I am being stupid here, is there something I should be doing differently to what you have posted above.  P.s. thank you for your help with this"}, {"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "reply_to_user": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "edited": false, "score": 0, "creation_date": 1471444106, "post_id": 38998774, "comment_id": 65350574, "body": "Sorry my bad, I just noticed two bugs with my code. I fixed them now. Just copy paste it and try again."}], "tags": [], "owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "is_accepted": false, "score": 0, "last_activity_date": 1471444057, "last_edit_date": 1471444057, "creation_date": 1471442243, "answer_id": 38998774, "question_id": 38994705, "link": "https://stackoverflow.com/questions/38994705/if-a-value-in-one-field-is-x-then-make-a-value-in-another-field-y-using-vba/38998774#38998774", "title": "If a value in one field is x then make a value in another field y using VBA", "body": "<p>Ok so I noticed a few things wrong with your code. </p>\n\n<p>First your first \"If\" statement treats the value as a string because you have string value of \"1\" and not the integer value 1 that is being tested. </p>\n\n<p>Second, if you have thousands of rows that you are processing and reading/writing to you should always turn off <code>ScreenUpdating</code>. </p>\n\n<p>Finally, to make your code more efficient use the range objects instead of <code>Cells(x,y)</code>.</p>\n\n<p>Give this a try and let me know if it works for you:</p>\n\n<pre><code>Sub Change()\nDim workingRange As Range\nDim workingCell As Range\n\n'This will make your code run much faster. Make sure to turn it back on at the end as I did.\nApplication.ScreenUpdating = False\n\n'Sets the range up. (Assumes you have no data below the 1millionth row)\nSet workingRange = Range(\"V5:V\" &amp; Range(\"V1000000\").End(xlUp).Row)\n\n'Loops through all the cells in Column V that have data\nFor Each workingCell In workingRange.Cells\n    If workingCell.Value = 1 Then Cells(workingCell.Row, 212).Value = \"NA\"\n    If workingCell.Value &gt; 1 Then Cells(workingCell.Row, 212).Value = \"ND\"\nNext workingCell\n\n\n\n'Turns Screen Updating back on\nApplication.ScreenUpdating = True\n\n'Clean up\nSet workingRange = Nothing\nSet workingCell = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5707595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad1168764435309b2dfff1d8d44b5f9?s=128&d=identicon&r=PG&f=1", "display_name": "JDRows", "link": "https://stackoverflow.com/users/5707595/jdrows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1405, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1471444057, "creation_date": 1471431415, "last_edit_date": 1471436996, "question_id": 38994705, "link": "https://stackoverflow.com/questions/38994705/if-a-value-in-one-field-is-x-then-make-a-value-in-another-field-y-using-vba", "title": "If a value in one field is x then make a value in another field y using VBA", "body": "<p>I currently have a spreadsheet that has a number of borrowers. I wish for if the number of borrowers in column V is more than 1 for it to return a value of NA in column HD and if it is just one borrower for it to return a value of ND.</p>\n\n<p>I currently have the following but could somebody please advise how I get this to start from the fifth row down and if there is a faster way as there are tens of thousands of fields and it is doing each one manually.</p>\n\n<p>Sub Change()</p>\n\n<p>Dim lngLoop As Long</p>\n\n<p>lngLoop = 1</p>\n\n<p>For lngLoop = 1 To Rows.Count</p>\n\n<p>If Cells(lngLoop, 22).Value = \"1\" Then Cells(lngLoop, 212).Value = \"NA\"</p>\n\n<p>If Cells(lngLoop, 22).Value > 1 Then Cells(lngLoop, 212).Value = \"ND\"</p>\n\n<p>Next lngLoop\nEnd Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1471431142, "post_id": 38994564, "comment_id": 65340919, "body": "it needs to be an array for more than one, is it an array?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471525807, "post_id": 38994564, "comment_id": 65388566, "body": "@Bob have you tried any of the answers you reveiced here ?"}, {"owner": {"reputation": 91, "user_id": 6668363, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d2f59c32ac2b463fdcb42a5efcfd75fd?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6668363/bob"}, "edited": false, "score": 0, "creation_date": 1471545407, "post_id": 38994564, "comment_id": 65401323, "body": "Yes. Problem solved"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471585312, "post_id": 38994564, "comment_id": 65413529, "body": "so mark as answer and upvote the answer people worked on to assist you"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472035600, "post_id": 38994564, "comment_id": 65587944, "body": "@Bob please mark as answe one of the answer you got here and helped you. this is the way SO works"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1471431327, "creation_date": 1471431327, "answer_id": 38994671, "question_id": 38994564, "link": "https://stackoverflow.com/questions/38994564/move-worksheet-to-string-variable/38994671#38994671", "title": "Move Worksheet to String Variable", "body": "<p>you can't  assign a string like this, if you want to asign the whole Range in <strong><em>Column A</em></strong>, you nned a loop, like this:</p>\n\n<pre><code>For i = 1 To LastRow\n    SheetString = SheetString &amp; \";\" &amp; Range(\"A\" &amp; i).Value\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 6668363, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d2f59c32ac2b463fdcb42a5efcfd75fd?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6668363/bob"}, "edited": false, "score": 0, "creation_date": 1471432915, "post_id": 38995139, "comment_id": 65342140, "body": "Thanks! I&#39;ll give that a try."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1471432634, "creation_date": 1471432634, "answer_id": 38995139, "question_id": 38994564, "link": "https://stackoverflow.com/questions/38994564/move-worksheet-to-string-variable/38995139#38995139", "title": "Move Worksheet to String Variable", "body": "<p>See this example</p>\n\n<pre><code>Sub Sample()\n    Dim SheetString As String\n    LastRow = 12 '&lt;~~ Example\n    SheetString = range(\"a1:a\" &amp; LastRow).Value\nEnd Sub\n</code></pre>\n\n<p>You can't do this. You can store the entire column in an array though. For that you have to declare <code>SheetString</code> as <code>Variant</code> as shown below else you will get the <code>Type Mismatch</code> error as you are currently getting</p>\n\n<pre><code>Sub Sample()\n    Dim SheetString As Variant\n    LastRow = 12 '&lt;~~ Example\n    SheetString = range(\"a1:a\" &amp; LastRow).Value\nEnd Sub\n</code></pre>\n\n<p>This will create an array which you can loop to access</p>\n\n<pre><code>For i = LBound(SheetString) To UBound(SheetString)\n    Debug.Print SheetString(i, 1)\nNext i\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6668363, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d2f59c32ac2b463fdcb42a5efcfd75fd?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6668363/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 38994671, "answer_count": 2, "score": 0, "last_activity_date": 1471432634, "creation_date": 1471430991, "last_edit_date": 1531164843, "question_id": 38994564, "link": "https://stackoverflow.com/questions/38994564/move-worksheet-to-string-variable", "title": "Move Worksheet to String Variable", "body": "<p>I am having trouble making a string variable equal to the cell in a worksheet since I get a type mismatch. I would also like to make a single string variable (SheetString) equal to all worksheet content. A portion of my code is below:</p>\n\n<pre><code>    Range(\"A1\").Select\n    Set sht = ThisWorkbook.Worksheets(\"Sheet3\")\n    LastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n    Set rng = Range(\"A1:A\" &amp; LastRow).SpecialCells(xlCellTypeBlanks)\n    rng.EntireRow.Delete\n    LastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n    'MsgBox (Continue)\n    Set rng = Range(\"A1:A\" &amp; LastRow)\n\n    'For x = 1 To LastRow\n        'RowString = cell(x, 1).Value\n        'if instr(,RowString,(\"Sheet1\").\n    SheetString = Range(\"a1:a\" &amp; LastRow).Value\n    MsgBox (Continue)\n    IE.Quit\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "pivot-table", "olap"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471432231, "post_id": 38994482, "comment_id": 65341592, "body": "Question - are 106679 , 106680, 107049 all items in Pivot Field <code>Campaign</code> ?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471432323, "post_id": 38994482, "comment_id": 65341661, "body": "@ShaiRado yes, this time, but NeXT time i need to change campaign there could be more or less selected items"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471433832, "post_id": 38994482, "comment_id": 65342746, "body": "see my answer below, it doesn&#39;t include setting the Pivot table and fields, only filtering the items you requested in all Pivot Tables"}], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1471434551, "post_id": 38995547, "comment_id": 65343199, "body": "That solves part of <b>2</b> and this helps. Get a <code>run-time error 1004</code> here:     <code>Set pvtFld = PvtTbl.PivotFields(&quot;Campaign&quot;)</code>. Cant get PivotFields-attribute to PivotTable-class"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1471434771, "post_id": 38995547, "comment_id": 65343351, "body": "@krib can you be more specific ? when did you get this error ? after it ran ok on 1 Pivot ? not all ? Do all of your Pivot Tables sit in the same sheet ?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1471435182, "post_id": 38995547, "comment_id": 65343613, "body": "I tried to step through it (trying to learn) and got that error on that line before anything was altered. Not all are in that one sheet, but that I can figure out."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1471435975, "post_id": 38995547, "comment_id": 65344171, "body": "I tired to simulate an error, only thing I could think of is if your PivotTable name is different than in the array, ot if &quot;Campaign&quot; is somehow spelled differently ?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1471436364, "post_id": 38995547, "comment_id": 65344424, "body": "tried a few times, ends up with the same error on the same line <code>Set pvtFld = PvtTbl.PivotFields(&quot;Campaign&quot;)</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1471436424, "post_id": 38995547, "comment_id": 65344467, "body": "you are not helping me solve this, can you answer my questions above ?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1471436601, "post_id": 38995547, "comment_id": 65344584, "body": "copied pivottable names directly from the pivot and <code>Campaign</code> is also correct. Everything from my original post is from recorded macro. Your help is much appreciated, make no mistake about that ;)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1471436664, "post_id": 38995547, "comment_id": 65344635, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/121166/discussion-between-shai-rado-and-krib\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1471435766, "last_edit_date": 1471435766, "creation_date": 1471433778, "answer_id": 38995547, "question_id": 38994482, "link": "https://stackoverflow.com/questions/38994482/set-items-list-to-multiple-pivot-tables/38995547#38995547", "title": "set Items list to multiple pivot tables", "body": "<p>The code below loops through all PivotTable Names is <code>pvtTblNameArr</code> (array), in Sheet name \"<strong><em>SheetPivot</em></strong>\" (modify according to your sheet name).</p>\n\n<pre><code>Option Explicit\n\nSub GetPivotFilter()\n\nDim PvtTbl              As PivotTable\nDim pvtitem             As PivotItem\nDim pvtFld              As PivotField\nDim pvtTblNameArr()     As Variant\nDim i                   As Integer\n\n' modify this array to all PivotTable names you need to modify (in the same sheet)\npvtTblNameArr() = Array(\"Pivottabell4\", \"Pivottabell8\")\n\n' loop though Pivot Table Names\nFor i = LBound(pvtTblNameArr) To UBound(pvtTblNameArr)\n\n    ' change \"SheetPivot\" to your sheet name\n    Set PvtTbl = ThisWorkbook.Sheets(\"SheetPivot\").PivotTables(pvtTblNameArr(i))\n\n    ' set Pivot field variable to \"Campaign\"\n    Set pvtFld = PvtTbl.PivotFields(\"Campaign\")\n\n    ' lop through all Pivot Items in \"Campaign\" Pivot Field\n    For Each pvtitem In pvtFld.PivotItems\n\n        Select Case pvtitem.Name\n            Case 106679, 106680, 107049\n                pvtitem.Visible = True\n\n            Case Else\n                pvtitem.Visible = False\n\n        End Select\n\n    Next pvtitem\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471435766, "creation_date": 1471430785, "last_edit_date": 1531164843, "question_id": 38994482, "link": "https://stackoverflow.com/questions/38994482/set-items-list-to-multiple-pivot-tables", "title": "set Items list to multiple pivot tables", "body": "<p>Been trying to set same items list to multiple OLAP pivot tables based on the changes I do in one out of the many pivot tables in a workbook.</p>\n\n<p>The recorded macro is (this removes old selections as well):</p>\n\n<pre><code>Sub GetPivotFilter()\n\nActiveSheet.PivotTables(\"Pivottabell4\").PivotFields( _\n    \"[DimCampaign].[Campaigns].[Campaign]\").VisibleItemsList = Array( _\n    \"[DimCampaign].[Campaigns].[Campaign].&amp;[106679]\", _ 'generated after i select campaing\n    \"[DimCampaign].[Campaigns].[Campaign].&amp;[106680]\", _'generated after i select campaing\n\n    \"[DimCampaign].[Campaigns].[Campaign].&amp;[107049]\")'generated after i select campaing\n\n\nEnd Sub\n</code></pre>\n\n<p><em>1</em> How can i extract the changes I do in the first pivot (i wont know the numbers before i make the change)?</p>\n\n<p><em>2</em> How can I get this to apply to those pivot tables that has the option to add campaign?</p>\n\n<p>The solution I have at the moment looks messy, but works:</p>\n\n<pre><code>Sub SetPivotFilter()\n\nActiveSheet.PivotTables(\"Pivottabell4\").PivotFields( _\n\"[DimCampaign].[Campaigns].[Campaign]\").VisibleItemsList = Array( _\n\"[DimCampaign].[Campaigns].[Campaign].&amp;[106679]\", _     \n\"[DimCampaign].[Campaigns].[Campaign].&amp;[106680]\", _    \n\"[DimCampaign].[Campaigns].[Campaign].&amp;[107049]\")\nActiveSheet.PivotTables(\"Pivottabell18\").PivotFields( _\n\"[DimCampaign].[Campaigns].[Campaign]\").VisibleItemsList = Array( _\n\"[DimCampaign].[Campaigns].[Campaign].&amp;[106679]\", _     \n\"[DimCampaign].[Campaigns].[Campaign].&amp;[106680]\", _    \n\"[DimCampaign].[Campaigns].[Campaign].&amp;[107049]\")\n'and so on\nEnd Sub \n</code></pre>\n\n<p>All help is much appreciated</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1471430254, "creation_date": 1471430254, "answer_id": 38994290, "question_id": 38994221, "link": "https://stackoverflow.com/questions/38994221/delete-function-for-databaseobject/38994290#38994290", "title": "delete function for databaseobject", "body": "<p>No, different object types need different delete methods. </p>\n\n<p>So you need a <code>Select Case</code> distinction.</p>\n"}], "owner": {"reputation": 117, "user_id": 4763480, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/182ab40958ef5ef2dd541753bc3a1059?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/4763480/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 38994290, "answer_count": 1, "score": 0, "last_activity_date": 1471430254, "creation_date": 1471430082, "last_edit_date": 1471430170, "question_id": 38994221, "link": "https://stackoverflow.com/questions/38994221/delete-function-for-databaseobject", "title": "delete function for databaseobject", "body": "<p>the following code is a convenience tool to delete a table if it already exists in a database: </p>\n\n<pre><code>Function DeleteTableIfExists(tablename As String)\nIf Not IsNull(DLookup(\"Name\", \"MSysObjects\", \"Name='\" &amp; tablename &amp; \"'\")) Then\nCurrentDb.TableDefs.Delete (tablename)\nEnd If\nEnd Function\n</code></pre>\n\n<p>i wanted to extend this function for all database objects ( e.g. forms and queries ). is there a way to do it without making a case distinction ( by some build in vba function that i am not aware of)?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471430571, "post_id": 38994269, "comment_id": 65340555, "body": "Hi, Thank you for you quick reply. Sorry I probably should have put this in the original question. The range I use for L and M will vary every time, either smaller or bigger. I have been replacing the Autofill code with this...  <code>ActiveCell.Offset(0, -1).Select Selection.End(xlDown).Select ActiveCell.Offset(0, 1).Select range(Selection, Selection.End(xlUp)).Select Selection.FillDown</code>  But the error was occuring before I even changed it to that. And still occured after I had changed it."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471430847, "post_id": 38994269, "comment_id": 65340722, "body": "I have updated the above post. You may have to refresh it"}, {"owner": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471431259, "post_id": 38994269, "comment_id": 65340988, "body": "Hi, Thanks again. Sorry, I&#39;m not all that experienced in this! Store in a variable has gone right over my head. The sheet, is a sheet of orders, so the range can vary day to day, so the range I need the formula in could be  L1:L102, or L1:L80, Or L1:L600, same with the M column. There will always be the same amount of columns.  So to dumb it down for me, what do I need to put in and where?  Thank you again!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471431368, "post_id": 38994269, "comment_id": 65341063, "body": "If the rows change from 1:102 to 1:80 then simply change <code>Rw1 = 1: Rw2 = 102</code> to <code>Rw1 = 1: Rw2 = 80</code> And if the columns change then amend <code>Col1 = &quot;L&quot;: Col2 = &quot;M&quot;</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471431506, "post_id": 38994269, "comment_id": 65341152, "body": "If you are not sure what the last row will be then see <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">THIS</a> link on how to find that via code"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471431582, "post_id": 38994269, "comment_id": 65341207, "body": "Will it always be Col L and Col M?"}, {"owner": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471431751, "post_id": 38994269, "comment_id": 65341306, "body": "Thank you I will look at that link. And yes, always L and M."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471431790, "post_id": 38994269, "comment_id": 65341320, "body": "I already anticipated your comment. Refresh the page and see the latest edit in the above post ;)"}, {"owner": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471433575, "post_id": 38994269, "comment_id": 65342581, "body": "Hi, Thank you very much for the simplification. It has correctly filled in L1 &amp; M1, but not filled it down at all?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "edited": false, "score": 0, "creation_date": 1471433700, "post_id": 38994269, "comment_id": 65342671, "body": "Yes because <code>lRow = .Range(&quot;L&quot; &amp; .Rows.Count).End(xlUp).Row</code> was an example ;) I wanted you to figure it out yourself... You need to change it to <code>lRow = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row</code>"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1471431839, "last_edit_date": 1495535629, "creation_date": 1471430204, "answer_id": 38994269, "question_id": 38994023, "link": "https://stackoverflow.com/questions/38994023/recorded-autofill-macro-error-a-value-used-in-the-formula-is-of-the-wrong-data/38994269#38994269", "title": "Recorded AutoFill macro error: A value used in the formula is of the wrong data type", "body": "<p>Avoid the use of <code>.Select</code> You may want to see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n\n<p>All that code can be written in just two lines</p>\n\n<pre><code>range(\"L1:L102\").Formula = \"=CheckColor1(A1)\"\nrange(\"M1:M102\").Formula = \"=L1\"\n</code></pre>\n\n<p>Replace your code with these two lines and try again. It will work this time.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>The idea is not to use <code>.Autofill</code> but to enter the formula in the complete range in ONE GO.</p>\n\n<p>If the columns \"L\" and \"M\" are fixed and the rows may change everytime then find the last row of column \"L\" and incorporate that into your code. See this</p>\n\n<pre><code>Dim lRow As Long\n\nWith Worksheet(\"Orders\")\n    lRow = .Range(\"L\" &amp; .Rows.Count).End(xlUp).Row\n\n    .Range(\"L1:L\" &amp; lRow).Formula = \"=CheckColor1(A1)\"\n    .Range(\"M1:M\" &amp; lRow).Formula = \"=L1\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6725764, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1739390652986938/picture?type=large", "display_name": "Jade Rotheram-Loddo", "link": "https://stackoverflow.com/users/6725764/jade-rotheram-loddo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "accepted_answer_id": 38994269, "answer_count": 1, "score": 1, "last_activity_date": 1544155414, "creation_date": 1471429529, "last_edit_date": 1544155414, "question_id": 38994023, "link": "https://stackoverflow.com/questions/38994023/recorded-autofill-macro-error-a-value-used-in-the-formula-is-of-the-wrong-data", "title": "Recorded AutoFill macro error: A value used in the formula is of the wrong data type", "body": "<p>I have a function which gives a value depending on the colour of a specified cell.</p>\n\n<pre><code>Function CheckColor1(range)\nIf range.Interior.Color = RGB(189, 215, 238) Then\n    CheckColor1 = \"R\"\nElseIf range.Interior.Color = RGB(255, 230, 153) Then\n    CheckColor1 = \"C\"\nEnd If\nEnd Function\n</code></pre>\n\n<p>In L1 I have =CheckColor1(a1) and I fill down for all rows. It gives me the corresponding \"R\" and \"C\" for each row.</p>\n\n<p>I then, in M1, use an =L1 next to it, fill down again, copy > paste values. I tried copy > paste values directly on the L Column, but it does not work.</p>\n\n<p>I recorded this. Which gave me:</p>\n\n<pre><code>range(\"L1\").Select\nActiveCell.FormulaR1C1 = \"=CheckColor1(RC[-11])\"\nrange(\"L1\").Select\nSelection.AutoFill Destination:=range(\"L1:L102\")\nrange(\"L1:L102\").Select\nrange(\"M1\").Select\nActiveCell.FormulaR1C1 = \"=RC[-1]\"\nrange(\"M1\").Select\nSelection.AutoFill Destination:=range(\"M1:M102\")\nrange(\"M1:M102\").Select\n</code></pre>\n\n<p>However, when I run the Macro, I get the first value correctly in L1, but then all values underneath that I get a #VALUE error. Which says A Value used in the formula is of the wrong data type.</p>\n\n<p>The Columns are \"General\" format.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471428822, "post_id": 38993719, "comment_id": 65339285, "body": "extract to where ? an array ? <code>tab1</code> and <code>tab2</code> are <code>&quot;Sheet1&quot;</code> and <code>&quot;Sheet2&quot;</code> ?"}, {"owner": {"reputation": 458, "user_id": 4297055, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SU5oe.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4297055/pablo"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471428886, "post_id": 38993719, "comment_id": 65339338, "body": "From sheet1 to sheet2."}], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 4297055, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SU5oe.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4297055/pablo"}, "edited": false, "score": 0, "creation_date": 1471428973, "post_id": 38993790, "comment_id": 65339412, "body": "Later I will need to store that values."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 458, "user_id": 4297055, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SU5oe.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4297055/pablo"}, "edited": false, "score": 0, "creation_date": 1471428995, "post_id": 38993790, "comment_id": 65339430, "body": "Where have you mentioned that in the question?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 3, "creation_date": 1471429008, "post_id": 38993790, "comment_id": 65339441, "body": "wow , typing faster than light speed ! do you have all answers already ready and categorized :)"}, {"owner": {"reputation": 458, "user_id": 4297055, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SU5oe.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4297055/pablo"}, "edited": false, "score": 0, "creation_date": 1471429083, "post_id": 38993790, "comment_id": 65339496, "body": "I didn&#39;t added for clarification."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471429188, "post_id": 38993790, "comment_id": 65339578, "body": "I have updated the above post. You may have to refresh it"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1471429168, "last_edit_date": 1471429168, "creation_date": 1471428869, "answer_id": 38993790, "question_id": 38993719, "link": "https://stackoverflow.com/questions/38993719/extracting-values-from-each-cell-using-a-loop-and-printing-in-another-tab/38993790#38993790", "title": "Extracting values from each cell using a loop and printing in another tab", "body": "<p>Why need a loop for this?</p>\n\n<p>You can directly copy/assign the values. See this example</p>\n\n<pre><code>'~~&gt; Change `A1:A190` to the relevant range when you want the output...\nSheets(\"Sheet2\").Range(\"A1:A190\").Value = Sheets(\"Sheet1\").Range(\"P10:P1200\").Value\n</code></pre>\n\n<p>or</p>\n\n<pre><code>'~~&gt; Change `A1` to the relevant range when you want the output...\nSheets(\"Sheet1\").Range(\"P10:P1200\").Copy Sheets(\"Sheet2\").Range(\"A1\")\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>As per user's updated request, he wants to store the values as well. In such a scenario, you can store the values to an array and then from there you can output it to the relevant sheet</p>\n\n<p>Here is an example</p>\n\n<pre><code>Dim MyAr As variant\n\nMyAr = Sheets(\"Sheet1\").Range(\"P10:P1200\").Value\n</code></pre>\n\n<p>If you want selected values from the array then loop through the array and then output it to the relevant sheet.</p>\n\n<pre><code>'~~&gt; looping through the array\nFor i = LBound(MyAr) To Ubound(MyAr)\n    Debug.Print MyAr(i,1)\nNext i\n</code></pre>\n\n<p>If you would like to output the complete array to the worksheet in one go then you can do this as well </p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"A1\").Resize(Ubound(MyAr),1).Value = MyAr\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 4297055, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SU5oe.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4297055/pablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 38993790, "answer_count": 1, "score": 0, "last_activity_date": 1471429168, "creation_date": 1471428667, "last_edit_date": 1471428909, "question_id": 38993719, "link": "https://stackoverflow.com/questions/38993719/extracting-values-from-each-cell-using-a-loop-and-printing-in-another-tab", "title": "Extracting values from each cell using a loop and printing in another tab", "body": "<p>I have the following:</p>\n\n<pre><code>Sub loopCell()\n\nDim cell As range\nFor Each cell In range(\"p10:p200\")\n\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>I want to extract the value of every cell that my loop iterates. After that, I want to print values in another sheet and store the values in a variable/array.</p>\n"}, {"tags": ["excel", "vba", "for-loop", "ms-word"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1471428628, "post_id": 38993618, "comment_id": 65339156, "body": "Try something like this for I=0 to .contentcontrols.count, set CCTrl = .contentcontrols(I)"}], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 5665422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-ZjJuNkfFnlA/AAAAAAAAAAI/AAAAAAAAABw/2xNy6z_ACgw/photo.jpg?sz=128", "display_name": "S rick", "link": "https://stackoverflow.com/users/5665422/s-rick"}, "is_accepted": false, "score": 0, "last_activity_date": 1471430343, "creation_date": 1471430343, "answer_id": 38994322, "question_id": 38993618, "link": "https://stackoverflow.com/questions/38993618/how-can-i-delete-an-object-which-is-the-subject-of-a-loop/38994322#38994322", "title": "How can I delete an object which is the subject of a loop?", "body": "<p>So after some messing around and looking into how the local variables properties changed as a stepped through the code I have found that the line:</p>\n\n<pre><code>CCtrl.ParentContentControl.Range.Text = CCtrlText\n</code></pre>\n\n<p>Was in effect replacing the Content Control (CC) in it's ParentCC range property with the input text, and therefore deleting the duplicated CC.</p>\n\n<p><code>CCtrl.Delete</code> was trying to delete an object that had already been deleted and that swhy it was throwing an error.</p>\n"}, {"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 0, "last_activity_date": 1471431299, "creation_date": 1471431299, "answer_id": 38994659, "question_id": 38993618, "link": "https://stackoverflow.com/questions/38993618/how-can-i-delete-an-object-which-is-the-subject-of-a-loop/38994659#38994659", "title": "How can I delete an object which is the subject of a loop?", "body": "<p>I think with a foreach loop you can't alter the contents of the list/array without impacting the function of the loop.  If you instead use the indexers, it should allow you to alter the collection, since you are not impacting the loop (number to number):</p>\n\n<pre><code>Dim i As Integer\nDim c As ContentControl\n\nFor i = 1 To d.ContentControls.Count\n  Set c = d.ContentControls(i)\n  c.Delete\nNext i\n</code></pre>\n"}], "owner": {"reputation": 34, "user_id": 5665422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-ZjJuNkfFnlA/AAAAAAAAAAI/AAAAAAAAABw/2xNy6z_ACgw/photo.jpg?sz=128", "display_name": "S rick", "link": "https://stackoverflow.com/users/5665422/s-rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1507305534, "creation_date": 1471428393, "last_edit_date": 1507305534, "question_id": 38993618, "link": "https://stackoverflow.com/questions/38993618/how-can-i-delete-an-object-which-is-the-subject-of-a-loop", "title": "How can I delete an object which is the subject of a loop?", "body": "<p>The problem I have is that the user is copying from one content control and pasting it into another accidentally. When extracting the data from this form, it then picks up that extra CC and therefore the value twice over.</p>\n\n<p>When pulling the data I'm trying to see if a CC has a ParentCC and then delete it, but I keep getting </p>\n\n<blockquote>\n  <p>Run time error 5825: Object has been deleted.</p>\n</blockquote>\n\n<p>I can understand why but I'm unsure as to how get around it, nothing I've searched seems to work.</p>\n\n<pre><code>'With Word document Statement precedes this\nFor Each CCtrl In .ContentControls\n\n    CCtrlText = CCtrl.Range.Text\n\n    If Not CCtrl.ParentContentControl Is Nothing Then\n        CCtrl.ParentContentControl.Range.Text = CCtrlText\n        CCtrl.Delete\n    End If\nNext\n</code></pre>\n\n<p>How can I remove this content control which is duplicated inside the other and retain the input information?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1471441128, "post_id": 38993323, "comment_id": 65348213, "body": "What&#39;s the problem? What&#39;s the question?"}, {"owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1471442617, "post_id": 38993323, "comment_id": 65349345, "body": "Hi Peter, the question is in the code: 1) Path= Sheets(&quot;Summary&quot;).Range(&quot;B2&quot;).Value ---&gt;  it does not read the value of B2, why?  =&gt;   Filename = Dir(&quot;Path&quot; &amp; &quot;*.xls&quot;) can not be read  and 2) COPY THE WORKBOOK 1 INTO SHEET with the name from Cell A2   SEE please the last part of the code"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1471443628, "post_id": 38993323, "comment_id": 65350144, "body": "what do you mean by copying a workbook into a worksheet? Wouldn&#39;t it just be the opposite?"}, {"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 1, "creation_date": 1471444060, "post_id": 38993323, "comment_id": 65350531, "body": "Use the &#39;Path&#39; value and not a literal string: Filename = Dir(Path &amp; &quot;*.xls&quot;)"}, {"owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1471444216, "post_id": 38993323, "comment_id": 65350663, "body": "@user3598756: I have a folder (C:\\My_Work\\scortix&#41; which contains diff. excel files (like file_1.xls, file_2.xls, ....). Now I want go there and copy every workbook  into a sheet  of the existing excel. For instance copy file_1.xls into Total sheet, file_2.xls  into leasing sheet etc."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1471447526, "post_id": 38993323, "comment_id": 65353068, "body": "What about if 2 workbooks have the same sheet name? How would it copy it here?"}, {"owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1471608743, "post_id": 38993323, "comment_id": 65426926, "body": "@Sgdva the second workbook is rather empty and has just one sheet where the macro exists and copies all other workbooks as sheets in this workbook"}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "edited": false, "score": 0, "creation_date": 1471608616, "post_id": 39000641, "comment_id": 65426836, "body": "thanks a lot and sorry for delay the first  problem is fixt within &#39;with&#39; but I have still problems with &#39;Dir&#39;  Filename is still empty! In the Loop I want to Import the workbooks from the Path into summary.xls  AS SHEETS! something like (here is: Import the sheets from the Excel file into summary)  For Each sheet In Workbooks(fileName).Worksheets     total = Workbooks(&quot;summary.xls&quot;).Worksheets.count     Workbooks(fileName).Worksheets(sheet.Name).Copy _     after:=Workbooks(&quot;summary.xls&quot;).Worksheets(total) Next sheet"}], "tags": [], "owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "is_accepted": false, "score": 0, "last_activity_date": 1471702928, "last_edit_date": 1471702928, "creation_date": 1471447425, "answer_id": 39000641, "question_id": 38993323, "link": "https://stackoverflow.com/questions/38993323/copy-different-workbooks-from-an-folder-into-different-sheets-in-one-workbook/39000641#39000641", "title": "Copy different workbooks from an folder into different sheets in one workbook", "body": "<p>To fix the first problem try:</p>\n\n<pre><code>With Application.Workbooks(\"BookName\").Sheets(\"Summary\")\n    Path = .Range(\"B1\").Text &amp; \"\\\" &amp; .Range(\"A2\").Text\nEnd With\n</code></pre>\n\n<p>For the second your variable <code>Path</code> is in quotes which it shouldn't be as it is not a string but a string variable. Not too sure why you had the wildcard asterisk in there either...</p>\n\n<pre><code>Filename = Dir(Path &amp; \".xls\")\n</code></pre>\n\n<p>For the last part, your <code>For Loop</code> is missing what it is that you want to cycle through (ie. cells)</p>\n\n<pre><code>For Each MyCell In MyRange.Cells\n    Sheets.Add After:=Sheets(Sheets.Count) 'creates a new worksheet\n    Sheets(Sheets.Count).Name = MyCell.Value ' renames the new worksheet\nNext MyCell\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1471702928, "creation_date": 1471427604, "last_edit_date": 1531164843, "question_id": 38993323, "link": "https://stackoverflow.com/questions/38993323/copy-different-workbooks-from-an-folder-into-different-sheets-in-one-workbook", "title": "Copy different workbooks from an folder into different sheets in one workbook", "body": "<p>I wrote the following code to clean the workbook and then to create empty sheets </p>\n\n<pre><code>Sub conclusion()\nDim xWs As Worksheet\nDim Path As String, Filename As String\n\n\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    For Each xWs In Application.ActiveWorkbook.Worksheets\n        If xWs.Name &lt;&gt; \"Sheet1\" And xWs.Name &lt;&gt; \"Summary\" Then\n            xWs.Delete\n        End If\n    Next\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n    ' create new sheets\n\n    Dim MyCell As Range, MyRange As Range\n\n    Set MyRange = Sheets(\"Summary\").Range(\"A2\")\n    Set MyRange = Range(MyRange, MyRange.End(xlDown))\n\n    For Each MyCell In MyRange\n        Sheets.Add After:=Sheets(Sheets.Count) 'creates a new worksheet\n        Sheets(Sheets.Count).Name = MyCell.Value ' renames the new worksheet\n    Next MyCell\n\n    ' copy the workbooks into the sheets (My question )\n\nEnd Sub\n</code></pre>\n\n<p>and then it should read the path from a cell in my case B2 and look for all xls files in this folder and copy to the crated sheets whose names are in <a href=\"https://i.stack.imgur.com/Z94sg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z94sg.png\" alt=\"range A2\"></a></p>\n\n<p>I wrote the following</p>\n\n<pre><code> Path= Sheets(\"Summary\").Range(\"B2\").Value ***( it does not read the value of B2, why? )***\n  Filename = Dir(\"Path\" &amp; \"*.xls\")\n  Do While Filename &lt;&gt; \"\"\n\n***here is my question, how can I write the following:\nCOPY THE WORKBOOK 1 INTO SHEET with the name from Cell A2*** \n  Loop\n</code></pre>\n"}, {"tags": ["excel", "math", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471427192, "post_id": 38993050, "comment_id": 65338140, "body": "A screen print of you excel with sample data could be of more help as well"}, {"owner": {"reputation": 3, "user_id": 3084318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f889b2249fcac203abf3b78f2fcebc?s=128&d=identicon&r=PG&f=1", "display_name": "No1Customer", "link": "https://stackoverflow.com/users/3084318/no1customer"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471428282, "post_id": 38993050, "comment_id": 65338902, "body": "Now added screenshot"}, {"owner": {"reputation": 3, "user_id": 3084318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f889b2249fcac203abf3b78f2fcebc?s=128&d=identicon&r=PG&f=1", "display_name": "No1Customer", "link": "https://stackoverflow.com/users/3084318/no1customer"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471429701, "post_id": 38993050, "comment_id": 65339940, "body": "By the way, i cant do an IF statement (if between x and y, then 1...) because this could potentially be thousands of pallets.  My IF statement would be huge!!"}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1471430169, "post_id": 38993050, "comment_id": 65340283, "body": "Maybe Excel isn&#39;t the right tool for this job."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1471436602, "post_id": 38993050, "comment_id": 65344586, "body": "@duffymo Why not? This doesn&#39;t surpass Excel capabilities in any way, it doesn&#39;t even need VBA"}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 1, "creation_date": 1471436661, "post_id": 38993050, "comment_id": 65344634, "body": "The accepted answer says you&#39;re right.  I was leaping to the assumption that this was an optimization problem of some kind, with constraints to be satisfied.  It&#39;s far simpler than that."}], "answers": [{"tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": true, "score": 1, "last_activity_date": 1471430288, "creation_date": 1471430288, "answer_id": 38994296, "question_id": 38993050, "link": "https://stackoverflow.com/questions/38993050/excel-formula-how-to-allocate-pallets-to-trucks/38994296#38994296", "title": "Excel Formula - How to allocate pallets to trucks", "body": "<p>Try to use below formula, t worked perfectly as expected\n <code>=CONCATENATE(C8,\"Truck\",IF(D8/IF(C8=\"Chill\",$C$3,IF(C8=\"Dry\",$C$2,IF(C8=\"Frozen\",$C$4,0)))&lt;1,1,ROUNDUP(D8/IF(C8=\"Chill\",$C$3,IF(C8=\"Dry\",$C$2,IF(C8=\"Frozen\",$C$4,0))),0)))</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/OS3j2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OS3j2.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 3084318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f889b2249fcac203abf3b78f2fcebc?s=128&d=identicon&r=PG&f=1", "display_name": "No1Customer", "link": "https://stackoverflow.com/users/3084318/no1customer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 38994296, "answer_count": 1, "score": -2, "last_activity_date": 1471430288, "creation_date": 1471426799, "last_edit_date": 1531161705, "question_id": 38993050, "link": "https://stackoverflow.com/questions/38993050/excel-formula-how-to-allocate-pallets-to-trucks", "title": "Excel Formula - How to allocate pallets to trucks", "body": "<p>I have a list of pallets in excel with the pallet number, and the temp type (Dry / Chilled / Frozen).</p>\n\n<p>Each truck type (Dry / Chill / Frozen Truck) can carry different amounts of pallets:</p>\n\n<ul>\n<li>Dry truck = 20 pallets</li>\n<li>Chill Truck = 19 pallets</li>\n<li>Frozen Truck = 18 pallets</li>\n</ul>\n\n<p>I now need to allocate \"truck number\" to each pallet.  The truck number is just a chronological number (IE. Dry1, Dry2, Dry3...).  So for example, the first 20 Dry pallets in the list will be allocated in \"DryTruck1\".  The next 20 pallets will be allocated in \"DryTruck2\" etc.</p>\n\n<p>I cant think of the formula to do this.  I've created my own counters for the pallets.  So i have a column on each line displaying \"DryPallet1\", \"DryPallet2\" etc.  But i don't know the best way to somehow use this to allocate each pallet to a truck based on the capacity of the truck. </p>\n\n<p>Any help would be much appreciated!  Thanks for your time!</p>\n\n<p>EDIT: Added pic of problem to visualize easier:\n<a href=\"http://imgur.com/a/TO0dQ\" rel=\"nofollow\">http://imgur.com/a/TO0dQ</a></p>\n"}, {"tags": ["vba", "excel", "variables", "public"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1471427934, "post_id": 38992992, "comment_id": 65338640, "body": "I allways use the &quot;overkill&quot; approcah, I just add a dedicated module (I call it <i>Global_Var</i>) and there I declare all my Global variables. In your example <code>Global Counter As Integer</code>."}, {"owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "edited": false, "score": 1, "creation_date": 1471429024, "post_id": 38992992, "comment_id": 65339452, "body": "There is no obvious error in the parts of the code you have included here, so the problem is in some other part of what you are doing. But I notice that Counter is capitalized in one place, not in others: either you have copied incorrectly, or the code display parser thinks that they are different variables."}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 2, "last_activity_date": 1471434625, "last_edit_date": 1471434625, "creation_date": 1471433255, "answer_id": 38995369, "question_id": 38992992, "link": "https://stackoverflow.com/questions/38992992/vba-using-public-variables-for-other-subs/38995369#38995369", "title": "VBA : Using Public variables for other subs", "body": "<p>@ShaiRado already pointed it out in the comments. Below are some details around that :</p>\n\n<p><strong><code>Public</code></strong> types doesn't have visibility through out the VBA project, atleast not without their Object reference. So, If you declare a variable as <code>Public</code> inside a worksheet object\\ UserForm \\ Class, you need to use full reference for that variable. e.g if <code>Counter</code> is declared inside Sheet1 then use <code>Sheet1.Counter</code>.</p>\n\n<p><strong><code>Global</code></strong> variables on the other hand are accesible through out the VBA project. You dont need to call their parent  object names for refernce. Just one catch here, <code>Global</code> variables can only be declared inside Standard Modules.  object\\ UserForm \\ Class, they don't allow global variable declaration inside them. </p>\n\n<p>In case of requirements for Project wide access, always declare <code>Global</code>. </p>\n\n<p>Another thing is <strong><code>Option Explicit</code></strong>, if you had it in your code, instead of unexpected output/behavior you woud have got the error <code>Variable not defined</code> with codde highlihgted at </p>\n\n<blockquote>\n  <p>Range(\"F1\").Value = counter</p>\n</blockquote>\n\n<p>That would have made debugging much easier. :)</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 5039212, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Fr3wZvgNIN4/AAAAAAAAAAI/AAAAAAAACAQ/ng4qbe3Uwwk/photo.jpg?sz=128", "display_name": "Ricardo Rosas", "link": "https://stackoverflow.com/users/5039212/ricardo-rosas"}, "is_accepted": false, "score": -1, "last_activity_date": 1471436200, "creation_date": 1471436200, "answer_id": 38996417, "question_id": 38992992, "link": "https://stackoverflow.com/questions/38992992/vba-using-public-variables-for-other-subs/38996417#38996417", "title": "VBA : Using Public variables for other subs", "body": "<p>So, I solved it by simply calling the function before my new sub!</p>\n\n<pre><code>Sub Test()\nCall count()\nRange(\"F1\").Value = counter\n\nend sub \n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5039212, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Fr3wZvgNIN4/AAAAAAAAAAI/AAAAAAAACAQ/ng4qbe3Uwwk/photo.jpg?sz=128", "display_name": "Ricardo Rosas", "link": "https://stackoverflow.com/users/5039212/ricardo-rosas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1054, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1471436200, "creation_date": 1471426690, "last_edit_date": 1471434689, "question_id": 38992992, "link": "https://stackoverflow.com/questions/38992992/vba-using-public-variables-for-other-subs", "title": "VBA : Using Public variables for other subs", "body": "<p>Excel-VBA. I want to create a variable that I will use in a couple of other subs later. Following other questions on this I declared the variable publicly</p>\n\n<pre><code>Public Counter As Integer\n</code></pre>\n\n<p>Then, I proceeded to give a value to the variable using a sub</p>\n\n<pre><code>Sub Count()\nSet sh2= ActiveWorkbook.Sheets(\"Sheet2\")\nSet sh1 = ActiveWorkbook.Sheets(\"Sheet1\")\nDim rng As Range\nDim trng As Range\nSet trng = sh2.Range(\"A4:HV4\")\n\nFor Each rng In trng\n    If rng.Value = \"Name\" Then\n    Counter = Range(rng, rng.End(xlToLeft)).Columns.count\n    End If\nNext rng\n</code></pre>\n\n<p>If I try to test on the same sub which value count has e.g. </p>\n\n<pre><code>sh1.range(\"B1\").value = counter\n</code></pre>\n\n<p>I get the right number.</p>\n\n<p>However, once I try calling it on another sub, the value is 0!</p>\n\n<pre><code>Sub Test()\n\nRange(\"F1\").Value = counter\n\nend sub \n</code></pre>\n\n<p>I have also tried calling the Count sub on my test sub, but also no result. </p>\n\n<p>Any ideas? Thanks!</p>\n"}, {"tags": ["arrays", "string", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1471426908, "post_id": 38992945, "comment_id": 65337973, "body": "You could use some worksheet functions in it, like match to find the ID, similarly match to find the skill in the row.  So rather than looping the column, then the row, you could say <code>lngFoundRow=application.worksheetfunction.match(strFindID,ws&zwnj;&#8203;2.range(A:A),false)</code>  and then something like <code>lngFoundSkill = application.worksheetfunction.match(strFindSkill,ws2.range(&quot;&zwnj;&#8203;a&quot; &amp; lngFoundRow &amp; &quot;:z&quot; &amp; lngFoundRow)</code>"}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1471429478, "post_id": 38992945, "comment_id": 65339789, "body": "First of all, thank you for taking your time to answer here. - - In your example, strFindID would then be the Array with all IDs from the Database? So the &quot;IDAr&quot; from my bottom try?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1471429745, "post_id": 38992945, "comment_id": 65339973, "body": "Your ID, would come from your loop in WS1, then you&#39;d check for a match in WS2 for the ID, then when you get that match, its the row number in the range, so if match(&quot;1234&quot;,ws2.range(A:A),false) gave 100, your found row would be 100, then you&#39;d look for the skill, in the range you require, say B:X of the same row, so match(&quot;Maths&quot;,ws2.range(&quot;B&quot; &amp; ROWFOUND &amp; &quot;:X&quot; &amp; ROWFOUND) then <code>ws2.range(&quot;A&quot; &amp; ROWFOUND &amp; &quot;:X&quot; &amp; ROWFOUND).copy ws3.location</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "edited": false, "score": 0, "creation_date": 1471432270, "post_id": 38994455, "comment_id": 65341621, "body": "Is that &quot;Thanks&quot;? :)"}, {"owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "edited": false, "score": 0, "creation_date": 1471435234, "post_id": 38994455, "comment_id": 65343661, "body": "Could you just quickly elaborate what strSkill would be in your code? An array similar to the &quot;MyAr&quot; in the code I posted?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "edited": false, "score": 0, "creation_date": 1471449776, "post_id": 38994455, "comment_id": 65354468, "body": "The skill you are looking for, as in MATHS"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1471430711, "creation_date": 1471430711, "answer_id": 38994455, "question_id": 38992945, "link": "https://stackoverflow.com/questions/38992945/vba-consolidate-information-for-the-same-ids-from-2-worksheets-on-a-3rd-sheet/38994455#38994455", "title": "VBA Consolidate Information for the same ID&#39;s from 2 Worksheets on a 3rd Sheet", "body": "<pre><code>Sub CodeForLazyPoster()\n\nDim rIDs As Excel.Range\nDim ID As Excel.Range\nDim lFoundRow As Long\n\nSet rIDs = Worksheets(\"Sheet1\").Range(\"a1:a10\")\n\nFor Each ID In rIDs\n\n    lFoundRow = FindRow(ID)\n\n    If lFoundRow &gt; 0 Then\n\n        If FindSkill(\"Maths\", Worksheets(\"Sheet2\").Range(\"B\" &amp; lFoundRow)) Then\n\n            '   Copy here\n\n\n        End If\n\n    End If\n\nNext ID\n\n\nEnd Sub\n\nFunction FindRow(strFind) As Long\n\nFindRow = 0\n\nOn Error Resume Next\n\nFindRow = Application.WorksheetFunction.Match( _\n        strFind, Worksheets(\"Sheet2\").Range(\"a1:a10\"), False)\n\nEnd Function\n\nFunction FindSkill(strSkill As String, rngLookIn As Excel.Range) As Boolean\n\nDim tmp As Integer\n\nFindSkill = False\n\nOn Error GoTo eHandle\n\ntmp = Application.WorksheetFunction.Match(strSkill, rngLookIn, False)\n\nFindSkill = True\n\nExit Function\n\neHandle:\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6564572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/065318f29600094c43907e2d413c6232?s=128&d=identicon&r=PG&f=1", "display_name": "InternInNeed", "link": "https://stackoverflow.com/users/6564572/interninneed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 38994455, "answer_count": 1, "score": 0, "last_activity_date": 1471506690, "creation_date": 1471426553, "last_edit_date": 1471506690, "question_id": 38992945, "link": "https://stackoverflow.com/questions/38992945/vba-consolidate-information-for-the-same-ids-from-2-worksheets-on-a-3rd-sheet", "title": "VBA Consolidate Information for the same ID&#39;s from 2 Worksheets on a 3rd Sheet", "body": "<p>After a lot of googling and trying I am asking you for help regarding the following Problem. </p>\n\n<ul>\n<li><p><strong>Worksheet 1</strong> (Database) has the <strong>ID's</strong> and a lot of Information in <strong>Column D</strong></p></li>\n<li><p><strong>Worksheet 2</strong> (Skills) has the <strong>ID's</strong> in <strong>Row 1</strong> and all <strong>respective skills</strong> in the <strong>rows below</strong> the column for each ID.</p></li>\n<li><p><strong>Worksheet 3 (Output)</strong> is needed to populate Listboxes and Graphs and can be considered empty</p></li>\n</ul>\n\n<p>For Illustration purposes: <a href=\"http://imgur.com/a/Nt88C\" rel=\"nofollow\">http://imgur.com/a/Nt88C</a></p>\n\n<p>Via <strong>comboboxes</strong>, the <strong>skill</strong> the user is looking for is <strong>selected</strong>. This Skill <strong>then</strong> needs to be <strong>matched</strong> <strong>against</strong> the skills of <strong>each ID</strong> on <strong>Worksheet 2</strong>. </p>\n\n<p><strong>If a match</strong> is found, the respective ID shall be found on <strong>Worksheet 1</strong> and certain <strong>Information from there</strong> copied <strong>to Worksheet 3</strong>.</p>\n\n<p>My take on this has been to find each ID in Worksheet 1, match it with all ID's on Worksheet 2 and look through the respective rows for a match. However, every more efficient way is welcome.</p>\n\n<p>Here my code:</p>\n\n<p><em>The comboboxes</em></p>\n\n<pre><code>Dim wb As Workbook\nSet wb = ActiveWorkbook\nDim ws1, ws2, ws3, ws4 As Worksheet\nSet ws1 = wb.Worksheets(\"Meta DB\")\nSet ws2 = wb.Worksheets(\"Criteria\")\nSet ws3 = wb.Worksheets(\"Supplier Criteria TreeView\")\nSet ws4 = wb.Worksheets(\"Supplier Skills\")\n\n'1. - - get all Suppliers for the selected Input\n'Redefine for clarity\nDim strFind As String\n\n'1.0. - - Clear previously used ranges\nws3.Range(\"A2:L28\").Clear\nws3.Range(\"A30:L100\").Clear\nws3.Range(\"V2:V20\").Clear\n\n'1.1. - - Get value to search for and range to go through (depending on combobox selections)\nIf Me.comboProduct.ListIndex = -1 And Me.comboSubGroup.ListIndex = -1 And Me.comboCG.ListIndex &lt;&gt; -1 Then\n    strFind = Me.comboCG.value\nElseIf Me.comboProduct.ListIndex = -1 And Me.comboSubGroup.ListIndex &lt;&gt; -1 And Me.comboCG.ListIndex &lt;&gt; -1 Then\n    strFind = Me.comboSubGroup.value\nElseIf Me.comboProduct.ListIndex &lt;&gt; -1 And Me.comboSubGroup.ListIndex &lt;&gt; -1 And Me.comboCG.ListIndex &lt;&gt; -1 Then\n    strFind = Me.comboProduct.value\nEnd If\n</code></pre>\n\n<p><strong>Try 1:</strong></p>\n\n<pre><code>Dim rng1, rng2 As Range\nDim lRow, j, k As Long\nDim IDrow As String\n\n'Paste starting at row 2 or 30 in ws3, respectively (Active / Inactive)\nj = 2\nk = 30\n\nFor Each rng1 In ws1.Range(\"D4:D500\")\n    If Rng &lt;&gt; \"\" Then\n        For Each rng2 In ws4.Range(\"A1:ZZ1\")\n            If rng2 &lt;&gt; \"\" Then\n                If rng1.value = rng2.value Then\n                    For lRow = 2 To ws4.UsedRange.Rows.Count\n                        IDrow = ws4.Cells(lRow, rng2).value\n                        If InStr(1, IDrow, strFind, vbTextCompare) &gt; 0 Then\n                            'Check for active Supplier in current Database-row\n                            If ws1.Range(\"E\" &amp; rng1) = \"Yes\" Then\n                                'Copy row of Database to row j of ws3 then increment j\n                                ws1.Range(\"B\" &amp; rng1 &amp; \":\" &amp; \"E\" &amp; rng1).Copy Destination:=ws3.Range(\"B\" &amp; j &amp; \":\" &amp; \"E\" &amp; j) 'Copy Name, Potential Supplier, ID, Active\n                                j = j + 1\n                            'ElseIf inactive Supplier, post further down from 30 onwards. Second listbox populates from there\n                            ElseIf ws1.Range(\"E\" &amp; rng1) = \"No\" Then\n                                ws1.Range(\"B\" &amp; rng1 &amp; \":\" &amp; \"E\" &amp; rng1).Copy Destination:=ws3.Range(\"B\" &amp; k &amp; \":\" &amp; \"E\" &amp; k) 'Copy Name, Potential Supplier, ID, Active\n                                k = k + 1\n                            Else\n                                Exit Sub\n                            End If\n                        End If\n                    Next lRow\n                End If\n            End If\n        Next rng2\n    End If\nNext rng1\n</code></pre>\n\n<p><strong>Try 2:</strong></p>\n\n<pre><code>Dim IDAr, MyAr, TempAr As Variant\nDim lRow, lastRow, entryrow, LCol, e As Long\nDim ColumnLetter As String\n\nentryrow = ws3.Range(\"B\" &amp; Rows.Count).End(xlUp).row + 1\n\nws1LRow = ws1.Range(\"D\" &amp; ws1.Rows.Count).End(xlUp).row\nIDAr = ws1.Range(\"D4:D\" &amp; lRow).value\n\n\nSet f = ws4.Range(\"A1:ZZ1\").Find(What:=IDAr, LookIn:=xlValues, Lookat:=xlWhole, MatchCase:=False)\nColumnLetter = Split(f.Address, \"$\")(1)\n\nlastRow = ws4.Range(ColumnLetter &amp; \"2:\" &amp; ColumnLetter &amp; \"50\").End(xlUp).row\n\nMyAr = ws4.Range(ColumnLetter &amp; \"1:\" &amp; ColumnLetter &amp; lastRow).value\n\nWith ws3\n    'If IsArray(MyAr) Then\n        For i = LBound(MyAr) To UBound(MyAr)\n            TempAr = Split(MyAr(i, 1), \"\\\")\n            For e = 0 To 2\n                TempAr(e) = ValueToCompare\n                    If InStr(1, ValueToCompare, strFind, vbTextCompare) &gt; 0 Then\n                        ws3.Range(\"B\" &amp; entryrow).value = \"Test if it works\"\n                        '.\n                        '.\n                        '.\n                    End If\n            Next e\n        Next i\n</code></pre>\n\n<p>Thank you all in advance for any tips!</p>\n"}, {"tags": ["excel", "ms-access", "vba", "excel-2007"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471426313, "post_id": 38992156, "comment_id": 65337588, "body": "Specify the cell where you want to paste the copied values."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471426363, "post_id": 38992156, "comment_id": 65337618, "body": "I want to paste the copied cells in Sheet Three from cell A1 with the headers from Sheet 1 as well. It has headers from A1 to Q1."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471426946, "post_id": 38992156, "comment_id": 65337998, "body": "I&#39;m sorry, i&#39;m bit confused. Can you please paste sample screen prints of your data and expected output. If not explain be a bit more clearly."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471432444, "post_id": 38992156, "comment_id": 65341749, "body": "What i understand is, Sheet1 has id&#39;s corresponding to values present in sheet2, so ther will be an entry with id as 455 in sheet1, 500..etc, So when ever you see status of all  455,476,497 is closed, you need to copy rows corresponding to 455,476,497(3 rows from sheet1) and paste to sheet3. On same lines if 502 is closed and 503 is open, should skip it Am i right in my understanding?"}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471433700, "post_id": 38992156, "comment_id": 65342672, "body": "I have updated the sheet details. I think you understood what i wanted to do. Check 456,476,497 if all of their status is closed find the original row in sheet 1 and paste it in sheet 4 including the header in sheet 1."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471433913, "post_id": 38992156, "comment_id": 65342797, "body": "Thanks a lot for taking time and making it very clear, have a clarification, i see 455 is open, but still it is copied to output, is it typo error?"}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471433979, "post_id": 38992156, "comment_id": 65342835, "body": "It shd be 455. typo in sheet 2, 455 status should have been closed and 456 status shd be open. thanks for pointing it out."}, {"owner": {"reputation": 102, "user_id": 2605995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3m5sB.jpg?s=128&g=1", "display_name": "raemaerne", "link": "https://stackoverflow.com/users/2605995/raemaerne"}, "edited": false, "score": 0, "creation_date": 1471437930, "post_id": 38992156, "comment_id": 65345585, "body": "So if I understood right, the row number <code>N</code> in Sheet 3 contains all the order IDs of row <code>N+1</code> in Sheet 1? So what you actually have to do is loop through Sheet 3, search for every order ID in that row and check in Sheet 2 if it is closed. If all are, then copy the corresponding row of Sheet 1 to Sheet4?"}], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 2605995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3m5sB.jpg?s=128&g=1", "display_name": "raemaerne", "link": "https://stackoverflow.com/users/2605995/raemaerne"}, "edited": false, "score": 0, "creation_date": 1471439672, "post_id": 38997443, "comment_id": 65347014, "body": "You could break the loop through the elements in <code>sheet2Range.Rows</code> if the element is found. Also you don&#39;t have to loop through Sheet1, simply take the row on line N+1, if you found it on row N in Sheet 3."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1471439679, "post_id": 38997443, "comment_id": 65347020, "body": "Thank you so much for your time! :) I will try it out."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1471498799, "post_id": 38997443, "comment_id": 65372821, "body": "Hi Siva, When I try to integrate it into my sheet i experience some errors. Can u explain how ur code works from the ShtRowNum = 1 ? I already edited my code accordingly."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1471508848, "post_id": 38997443, "comment_id": 65377532, "body": "@Manick9, I have added my comments in the code. Hope i made my self clear, please let me know if you any thing is not clear. If possible, share your entire code in Question, we can fix the issues and make it work."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1471521826, "post_id": 38997443, "comment_id": 65385753, "body": "I have uploaded the links. Pls advise how to fix the issue. I think it is because assigned_tasks is empty."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471524557, "post_id": 38997443, "comment_id": 65387684, "body": "Please let me know which line of the code is throwing the error?"}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1471525203, "post_id": 38997443, "comment_id": 65388114, "body": "Line 96. Do you want me to upload the macro file?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471525311, "post_id": 38997443, "comment_id": 65388202, "body": "Sorry, can you please specify the code, i&#39;m not able to figure out the lines from images. If you can upload the code file."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471526736, "post_id": 38997443, "comment_id": 65389237, "body": "I guess you are right, for some of your data, <code>analysis_tasks</code> is empty string, so its throwing error, what you can do is add one more condition, change <code>If (totalCellsinRow_2 = statusCount_2)</code> to <code>If ((totalCellsinRow_2 = statusCount_2) And totalCellsinRow_2 &lt;&gt;0 )</code> and try, i guess that should work"}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1471591965, "post_id": 38997443, "comment_id": 65416711, "body": "@Siva  Need your help. My data for the first three sheets come from 3 separate workbooks. i need to clear the first 3 sheets and import data everyday.   My source filename is in this format (filename_ddmm) daily_1908, event_1908, exp_1908. I tried storing the date in custom format but cant drop the year. 2nd issue is when i try to copy i get an error cos the data size is too big. How do u overcome this errors?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471598484, "post_id": 38997443, "comment_id": 65420568, "body": "I didn&#39;t understand your first issue. Regarding Issue2, if you are trying to copy entire sheet data from source to destination, then i would suggest simply copy sheet from source to destination and delete your old sheet in destination. Other case if you are copying only some portion of data from source sheet to destination, probably have to look for a solution."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471599311, "post_id": 38997443, "comment_id": 65421082, "body": "I tried running your code, i don&#39;t see any issues here, except Clipboard message. You can skip those messages by adding <code>Application.DisplayAlerts = False</code> before <code>Wb1.Close SaveChanges:=False</code>and <code>Application.DisplayAlerts = True</code> after it. This will stop all popup display."}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": true, "score": 1, "last_activity_date": 1471508617, "last_edit_date": 1471508617, "creation_date": 1471438952, "answer_id": 38997443, "question_id": 38992156, "link": "https://stackoverflow.com/questions/38992156/finding-status-of-data-and-copying-across-sheets/38997443#38997443", "title": "Finding status of data and copying across sheets", "body": "<p>Please try the below code</p>\n\n<pre><code>Sub FindStausAndCopy()\n\nDim sheet1Range As Range\nDim sheet2Range As Range\nDim sheet3Range As Range\n\nDim sheet1RowCount As Integer\nDim sheet1ColCount As Integer\n\nDim sheet2RowCount As Integer\nDim sheet2ColCount As Integer\n\nDim sheet3RowCount As Integer\nDim sheet3ColCount As Integer\n\nDim shtRowNum As Integer\nDim totalCellsinRow  As Integer\nDim statusCount As Integer\nDim orders As String\n\nDim range1Row As Variant\nDim range2Row As Variant\nDim range3Row As Variant\nDim cellVal As Variant\n\n\n\nsheet1RowCount = Worksheets(\"Sheet1\").UsedRange.Rows.Count\nsheet1ColCount = Worksheets(\"Sheet1\").UsedRange.Columns.Count\n\nsheet2RowCount = Worksheets(\"Sheet2\").UsedRange.Rows.Count\nsheet2ColCount = Worksheets(\"Sheet2\").UsedRange.Columns.Count\n\nsheet3RowCount = Worksheets(\"Sheet3\").UsedRange.Rows.Count\nsheet3ColCount = Worksheets(\"Sheet3\").UsedRange.Columns.Count\n\nWorksheets(\"sheet1\").Activate\nSet sheet1Range = Worksheets(\"Sheet1\").Range(Cells(1, 1), Cells(sheet1RowCount, sheet1ColCount))\nWorksheets(\"sheet2\").Activate\nSet sheet2Range = Worksheets(\"Sheet2\").Range(Cells(1, 1), Cells(sheet2RowCount, sheet2ColCount))\nWorksheets(\"sheet3\").Activate\nSet sheet3Range = Worksheets(\"Sheet3\").Range(Cells(1, 1), Cells(sheet3RowCount, sheet3ColCount))\n\nshtRowNum = 1 'This is for incrementing the Row in Sheet4\n'Iterating through Each row in Sheet3 and then through\n'each cell in a particular row\n'Loop1\nFor Each range3Row In sheet3Range.Rows\ntotalCellsinRow = 0  ' to count no of order numbers in sheet3 rows\nstatusCount = 0      ' to count the status of orders \norders = \"\"          ' to store all order numbers with coma seperated\n\n    'Iterating throgh each Order in a row and identifing the status\n    'Loop2\n    For Each cellVal In range3Row.Cells\n    If (cellVal &lt;&gt; \"\") Then\n     totalCellsinRow = totalCellsinRow + 1 'Increments for every order\n     'Iterating through each row in sheet2 to check the status and\n     ' Increment status count\n     'Loop3\n         For Each range2Row In sheet2Range.Rows\n            If (range2Row.Cells(1) = cellVal And range2Row.Cells(4) = \"Closed\") Then\n            statusCount = statusCount + 1 'Increments only when order is closed\n            orders = orders &amp; \", \" &amp; cellVal\n            End If\n        Next range2Row\n        'By the time Loop3 is completed we get the status of one order\n        End If\n    Next cellVal\n    'By the time Loop2 is completed, we get the overall status of all orders\n    ' in a row of sheet3\n    ' If statusCount = totalCellsinRow which implies every order\n    ' present in a row is closed\n    If (totalCellsinRow = statusCount) Then\n        'Lopp4: Iterating throgh each row of sheet1 to find Matching ID\n        'The reason for iterating through rows,even if the order of the ID\n        ' changes, code should be in a position to identify the right row\n        ' to copy\n        For Each range1Row In sheet1Range.Rows\n            If (range1Row.Cells(4) = Trim(Right(orders, Len(orders) - 1))) Then\n              If (shtRowNum = 1) Then\n              'Copying the Header row to sheet4 only once.\n              sheet1Range.Rows(1).Copy Destination:=Worksheets(\"sheet4\").Cells(1, 1) \n              shtRowNum = shtRowNum + 1\n            End If\n            'Copying the row from sheet1 to sheet4\n            range1Row.Copy Destination:=Worksheets(\"Sheet4\").Cells(shtRowNum, 1)\n            shtRowNum = shtRowNum + 1\n          End If\n        Next range1Row\n        'By the time Loop4 is completed a ID row for the closed Orders will \n        ' be copied to Sheet4\n    End If\nNext range3Row\n'By the time Loop1 is completed all the orders status will be read\n' Corresponding Id rows will be copied to sheet4 with Header row\n\nEnd Sub\n</code></pre>\n\n<p>Below are the results\n<a href=\"https://i.stack.imgur.com/SKMmq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SKMmq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 38997443, "answer_count": 1, "score": 0, "last_activity_date": 1594641523, "creation_date": 1471424164, "last_edit_date": 1594641523, "question_id": 38992156, "link": "https://stackoverflow.com/questions/38992156/finding-status-of-data-and-copying-across-sheets", "title": "Finding status of data and copying across sheets", "body": "<p>I am very new to VBA. Hope someone can help me out. Thanks a lot.</p>\n\n<p>Sheet 1 (Data to be copied to Sheet 4)</p>\n\n<pre><code>     A       B        C           D\n 1  ID    Header 2  Header 3    Orders\n 2 5000                      455,476,497\n 3 5012                          500\n 4 5015                        502,503 \n</code></pre>\n\n<p>Sheet 2 (Data)</p>\n\n<pre><code>     A         B         C         D ........ Q\n1  Orders ID         Header 2   Status   Header 4\n2   455                         Closed\n3   456                          Open\n4   476                         Closed\n5   497                         Closed\n</code></pre>\n\n<p>Sheet 3</p>\n\n<pre><code>   A    B    C    D\n1 455  476  497\n2 500\n3 502  503\n</code></pre>\n\n<p>Sheet 4 (Output Sheet)</p>\n\n<pre><code>     A       B        C           D\n 1  ID    Header 2  Header 3    Orders\n 2 5000                      455,476,497\n 3\n</code></pre>\n\n<p>Task: I need to check the status of the following ids 455, 476 and 497 in sheet 3. If the status of all IDs in a row is closed then copy the whole row from sheet 1 to sheet 4, if not move on to the next line.</p>\n\n<pre><code>For a = 1 To Range(\"A1\").End(xlDown).Row\n\n    For b = 1 To Range(\"A1\").End(xlToRight).Column\n        Cells(1, b).Select\n\n        Selection.Copy\n        Sheets(\"Orders\").Select            \n\n       (Unsure what to put here)\n\n    Next b\nNext a\n</code></pre>\n\n<p>I need more reputation to post images here. So, posting the links\n(only 2 allowed )</p>\n\n<p><a href=\"http://imgur.com/K8H2JhD\" rel=\"nofollow\">http://imgur.com/K8H2JhD</a>, <a href=\"http://imgur.com/KjeIDVm\" rel=\"nofollow\">http://imgur.com/KjeIDVm</a>, U0Z7mfm, qWOJ3VM</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3556, "user_id": 5300473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/88eaa2b57410990d33dfa1b9330b77ae?s=128&d=identicon&r=PG", "display_name": "Spitzbueb", "link": "https://stackoverflow.com/users/5300473/spitzbueb"}, "edited": false, "score": 1, "creation_date": 1471423243, "post_id": 38991827, "comment_id": 65335618, "body": "Try: &quot;=[7.xlsx]sheet1!R3&quot; &amp; i &amp; &quot;5&quot;"}, {"owner": {"reputation": 23, "user_id": 6725297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c6ee7a946bbe82b0158dbae3f8277c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6725297/dave"}, "reply_to_user": {"reputation": 3556, "user_id": 5300473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/88eaa2b57410990d33dfa1b9330b77ae?s=128&d=identicon&r=PG", "display_name": "Spitzbueb", "link": "https://stackoverflow.com/users/5300473/spitzbueb"}, "edited": false, "score": 0, "creation_date": 1471424114, "post_id": 38991827, "comment_id": 65336177, "body": "@Wernerson Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6725297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c6ee7a946bbe82b0158dbae3f8277c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6725297/dave"}, "edited": false, "score": 0, "creation_date": 1471424167, "post_id": 38992042, "comment_id": 65336209, "body": "That&#39;s it. Thank you! The &quot;FormulaR1C1&quot; part, is for using the formula in the A1 cell?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 23, "user_id": 6725297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c6ee7a946bbe82b0158dbae3f8277c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6725297/dave"}, "edited": false, "score": 0, "creation_date": 1471424596, "post_id": 38992042, "comment_id": 65336500, "body": "You can use either <code>.FormulaR1C1</code> or <code>.Formula</code>. The former uses <code>R1C1</code> notation and the latter uses <code>A1</code> notation"}, {"owner": {"reputation": 23, "user_id": 6725297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c6ee7a946bbe82b0158dbae3f8277c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6725297/dave"}, "edited": false, "score": 0, "creation_date": 1471426826, "post_id": 38992042, "comment_id": 65337923, "body": "Ok, great. Thanks you!"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1471423833, "creation_date": 1471423833, "answer_id": 38992042, "question_id": 38991827, "link": "https://stackoverflow.com/questions/38991827/access-cells-in-other-file-with-variable/38992042#38992042", "title": "Access cells in other file with variable", "body": "<p>I don't think you want to replace <code>C</code> as it signifies the column in <code>RC</code> notation.</p>\n\n<p>If you want to change the row then use this</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=[7.xlsx]sheet1!R\" &amp; i &amp; \"C5\" \n</code></pre>\n\n<p>If you want to change the column then use this</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=[7.xlsx]sheet1!R3C\" &amp; i\n</code></pre>\n\n<p>Note that in RC notation, R1C1 means Cell A1. Changing <code>C</code> will give you an error.</p>\n"}], "owner": {"reputation": 23, "user_id": 6725297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c6ee7a946bbe82b0158dbae3f8277c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6725297/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 38992042, "answer_count": 1, "score": 2, "last_activity_date": 1471423833, "creation_date": 1471423077, "question_id": 38991827, "link": "https://stackoverflow.com/questions/38991827/access-cells-in-other-file-with-variable", "title": "Access cells in other file with variable", "body": "<p>I'm taking info from one file to another, using: (<strong>7.xlsx</strong> is the file name)</p>\n\n<pre><code>Cells(13, 4).Select\nActiveCell.FormulaR1C1 = \"=[7.xlsx]sheet1!R3C5\"\n</code></pre>\n\n<p>In this situation, I am taking the information from C5 spot. <em>But</em> I want to take the info not from this spot only, but from different spots, using loop.</p>\n\n<pre><code>Dim i As Integer\nFor i = 3 To 17\n    Cells(i, 4).Select // works fine\n    ActiveCell.FormulaR1C1 = \"=[7.xlsx]sheet1!R3C5\" // I want to put the\n                                                   // \"i\" instead of the C\n</code></pre>\n\n<p>Any idea how I can do it?<br>\nThanks in advance!</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"reputation": 343, "user_id": 4193116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0026bd50142b4050a9dc8e6e42c326?s=128&d=identicon&r=PG&f=1", "display_name": "prizm1", "link": "https://stackoverflow.com/users/4193116/prizm1"}, "is_accepted": false, "score": 0, "last_activity_date": 1471423717, "creation_date": 1471423717, "answer_id": 38991999, "question_id": 38991505, "link": "https://stackoverflow.com/questions/38991505/separating-string-into-columns-using-excel-vba/38991999#38991999", "title": "Separating string into columns using Excel VBA", "body": "<p>Excel already provides functionality which could achieve what you want. The only requirement is that you save the data to the disc and open it from a existing file. The function is called Workbooks.OpenText, but be aware that it exactly sticks to the given parameters, if you give in the wrong delimiter for example it may give you wrong results in the end or won't open the file correctly splitted.</p>\n\n<pre><code>Workbooks.OpenText \"filename\", _\nDataType:=XlTextParsingType.xlDelimited, Origin:=XlPlatform.xlWindows, _\nSpace:=True, TextQualifier:=XlTextQualifier.xlTextQualifierNone\n</code></pre>\n\n<p>This would open a Space seperated Text or CSV file and put the values into many columns, returning an Workbooks Object were further operations can unfold.</p>\n\n<p>The other approach would be to read the Text Linewise and use the VBA String Split to \"manually\" enter them in corresponding Rows and Columns, which has the advantage that you can manipulate data and strip out characters you don't want to have into the file on the fly. If you want I could give an example for that also.</p>\n"}, {"comments": [{"owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 0, "creation_date": 1471423936, "post_id": 38992010, "comment_id": 65336070, "body": "i think you need to take ubound of arr2 for postcode and state code just in case suburb is two words"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "edited": false, "score": 0, "creation_date": 1471424075, "post_id": 38992010, "comment_id": 65336145, "body": "if any part changes its size, whole code goes for a toss. :) It will give incorrect result. That&#39;s why the statment..<code>going by description in the question and assuming that the address format will remain same</code>.... some times one needs to hedge :) but thanks for the comment."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1471423748, "creation_date": 1471423748, "answer_id": 38992010, "question_id": 38991505, "link": "https://stackoverflow.com/questions/38991505/separating-string-into-columns-using-excel-vba/38992010#38992010", "title": "Separating string into columns using Excel VBA", "body": "<p>going by description in the  question  and assuming that the address format will remain same, here is one approach using <code>Split</code></p>\n\n<pre><code>Private Sub tt()\n    Dim strTest     As String\n\n    Dim arr1\n    Dim arr2\n    Dim arr3\n\n    Dim StreetAddress As String\n    Dim Postcode As String\n    Dim StateCode As String\n    Dim SubUrb As String\n\n\n    strTest = \"123 Fake Street, Suburbia QLD 4123\"\n\n    arr1 = Split(strTest, \",\")\n    StreetAddress = arr1(0)\n\n    arr2 = Split(Trim(arr1(1)), Space(1))\n\n    Postcode = arr2(2)\n    StateCode = arr2(1)\n    SubUrb = arr2(0)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2229040, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8076cdfdbfe2061edcace397681c67d6?s=128&d=identicon&r=PG", "display_name": "user2229040", "link": "https://stackoverflow.com/users/2229040/user2229040"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1471423748, "creation_date": 1471422047, "question_id": 38991505, "link": "https://stackoverflow.com/questions/38991505/separating-string-into-columns-using-excel-vba", "title": "Separating string into columns using Excel VBA", "body": "<p>I'm trying to write a macro in VBA to split a bunch of addresses all in the same format into separate columns. So a street address column, suburb, postcode and state code column. The addresses all follow this format:</p>\n\n<p>123 Fake Street, Suburbia QLD 4123</p>\n\n<p>I wish I could approach this using SQL but I'm trying to keep this function inside an excel workbook where addresses would be central.</p>\n\n<p>My planned approach is to write a for loop which counts the length of column D (where the addresses are stored)...so</p>\n\n<pre><code>   For LngRow = 2 To Wksht.Range(\"D\" &amp; Wksht.Rows.Count).End(xlUp).Row\n       //concate/parse here//\n   Next\n</code></pre>\n\n<p>and then it would follow a standard procedure of working backwards where it would separate and write the postcode (4 digits), then the state code (an array of state codes), then the suburb (the string between the state code and the delimiting comma after the street address), and finally the street address which is whatever string is remaining after the rest has been removed and rewritten.</p>\n\n<p>I figure working backwards is best since the street address changes whereas the final 3 bits of info are standard.</p>\n\n<p>Is it possible to write such a macro in VBA? Especially given how SQLish it seems.</p>\n"}, {"tags": ["vba", "excel", "macros", "copy"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1471443845, "post_id": 38991399, "comment_id": 65350332, "body": "what problems\\errors are you facing with your code?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6725273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef12fd32d8046266da6836f68242cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Sz_Csill", "link": "https://stackoverflow.com/users/6725273/sz-csill"}, "edited": false, "score": 0, "creation_date": 1471423118, "post_id": 38991545, "comment_id": 65335525, "body": "Oh, it lookes nice, thanks! But actually my real problem is to have a general target, so I can use it every file which has the word &quot;Allocation&quot; in its file name. Could you please give me some ideas for that, as well?"}, {"owner": {"reputation": 1, "user_id": 6725273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef12fd32d8046266da6836f68242cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Sz_Csill", "link": "https://stackoverflow.com/users/6725273/sz-csill"}, "edited": false, "score": 0, "creation_date": 1471428511, "post_id": 38991545, "comment_id": 65339078, "body": "I tried it and it didn&#39;t work for me. I haven&#39;t got any messages or debugs. When I open the target file, I only got a message if I enable or disable macros, and it doesn&#39;t copy the sheet.. I saved both the target and source file to the desktop and I give that location for the folder, but nothing happens.."}, {"owner": {"reputation": 635, "user_id": 5444243, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206921510469410/picture?type=large", "display_name": "Gabor", "link": "https://stackoverflow.com/users/5444243/gabor"}, "reply_to_user": {"reputation": 1, "user_id": 6725273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef12fd32d8046266da6836f68242cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Sz_Csill", "link": "https://stackoverflow.com/users/6725273/sz-csill"}, "edited": false, "score": 0, "creation_date": 1471437036, "post_id": 38991545, "comment_id": 65344874, "body": "I&#39;ve tested it again and it works for me. Did you change the path setting in the folder variable? Also, try to comment out the Application.DisplayAlerts = False to see any error messages."}], "tags": [], "owner": {"reputation": 635, "user_id": 5444243, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206921510469410/picture?type=large", "display_name": "Gabor", "link": "https://stackoverflow.com/users/5444243/gabor"}, "is_accepted": false, "score": 0, "last_activity_date": 1471425719, "last_edit_date": 1495542785, "creation_date": 1471422173, "answer_id": 38991545, "question_id": 38991399, "link": "https://stackoverflow.com/questions/38991399/how-to-copy-a-worksheet-from-one-workbook-to-others-in-vba/38991545#38991545", "title": "How to copy a worksheet from one workbook to others in VBA", "body": "<p>I'd do it like this:</p>\n\n<pre><code>Sub Button1_Click()\n    Dim source_worksheet As Worksheet\n    Dim source_workbook As Workbook\n    Dim target_workbook As Workbook\n\n    Set source_workbook = ActiveWorkbook\n    Set target_workbook = Workbooks.Add()\n    Set source_worksheet = source_workbook.Sheets(\"needtocopy\")\n\n    source_worksheet.Copy Before:=target_workbook.Sheets(1)\nEnd Sub\n</code></pre>\n\n<p>This piece of code is a bit verbose but the purpose is to give you an idea where things are happening.</p>\n\n<p>The selection of the target workbook is done on the Set target_workbook row. Here you can create a new workbook (like I'm doing it in this example), or open an existing workbook.</p>\n\n<p>To open an exisiting workbook, replace the Set target_workbook row with this:</p>\n\n<pre><code>Set target_workbook = Workbooks.Open(\"target.xls\")\n</code></pre>\n\n<p>At the end, you can add some saving and closing functionality as well:</p>\n\n<pre><code>target_workbook.Save\ntarget_workbook.Close\n</code></pre>\n\n<p>To get a list of files in a folder you need to define an object with Dir (as described in this post: <a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">Loop through files in a folder using VBA?</a>):</p>\n\n<pre><code>Sub Button1_Click()\nDim source_worksheet As Worksheet\nDim source_workbook As Workbook\nDim target_workbook As Workbook\n\nSet source_workbook = ActiveWorkbook\nSet source_worksheet = source_workbook.Sheets(\"needtocopy\")\n\nDim file As Variant\nDim folder As String\nfolder = \"C:\\test\\\"\nfile = Dir(folder)\nApplication.DisplayAlerts = False\nWhile (file &lt;&gt; \"\")\n    If InStr(file, \"Allocation\") &lt;&gt; 0 Then\n        Set target_workbook = Workbooks.Open(folder &amp; file)\n        source_worksheet.Copy Before:=target_workbook.Sheets(1)\n        target_workbook.Save\n        target_workbook.Close\n    End If\n    file = Dir\nWend\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6725273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef12fd32d8046266da6836f68242cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Sz_Csill", "link": "https://stackoverflow.com/users/6725273/sz-csill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471425719, "creation_date": 1471421670, "last_edit_date": 1471423706, "question_id": 38991399, "link": "https://stackoverflow.com/questions/38991399/how-to-copy-a-worksheet-from-one-workbook-to-others-in-vba", "title": "How to copy a worksheet from one workbook to others in VBA", "body": "<p>I'd like to copy a sheet with formulas to other workbooks, so it is important to have a general target, which I can use for other workbooks, as well, not just for one. \nHere is my code: </p>\n\n<pre><code>Sub Macro1()\n\n    Windows(\"Filefromcopy.xls\").Activate\n    Sheets(\"needtocopy\").Select\n    Sheets(\"needtocopy\").Copy Before:=Workbooks(\"target.xls\").Sheets(1)\nEnd Sub\n</code></pre>\n\n<p>Could you please give me some help?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471421462, "post_id": 38991215, "comment_id": 65334575, "body": "i would advise to modify to <code>Dim As Long, bb As Long</code> just to be sure, not necessarily to resolve this issue"}, {"owner": {"reputation": 11, "user_id": 6667292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab8fe7face91d4e4ace81cba95bf6cc7?s=128&d=identicon&r=PG&f=1", "display_name": "JayF", "link": "https://stackoverflow.com/users/6667292/jayf"}, "edited": false, "score": 0, "creation_date": 1471421665, "post_id": 38991215, "comment_id": 65334693, "body": "I am getting the error on the line: aa = DBWS.Columns(&quot;a&quot;).Find(what:=cws.Range(&quot;b1&quot;).Value, after:=DBWS.Range(&quot;a1&quot;)).Row"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471421668, "post_id": 38991337, "comment_id": 65334694, "body": "maybe I&#39;m tired today, but what is the point of using the <code>bb = Range(&quot;a&quot; &amp; aa).Row</code> ?  if <code>aa = DBWS.Columns(&quot;a&quot;).Find(what:=cws.Range(&quot;b1&quot;).Value, after:=DBWS.Range(&quot;a1&quot;)).Row</code> returns a row number, and then he is putting it inside a range in order to get the row number, in this case isn&#39;t it <code>bb = aa</code> ?"}, {"owner": {"reputation": 11, "user_id": 6667292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab8fe7face91d4e4ace81cba95bf6cc7?s=128&d=identicon&r=PG&f=1", "display_name": "JayF", "link": "https://stackoverflow.com/users/6667292/jayf"}, "edited": false, "score": 0, "creation_date": 1471421871, "post_id": 38991337, "comment_id": 65334807, "body": "Very possible sloppy coding on my part..  With your Proposed change Teylyn I have the following: &#39;Automation error - The Object invoked has disconnected from its clients&#39;"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1471421470, "creation_date": 1471421470, "answer_id": 38991337, "question_id": 38991215, "link": "https://stackoverflow.com/questions/38991215/vba-1004-error-pulling-data-from-other-sheet/38991337#38991337", "title": "VBA 1004 error pulling data from other sheet", "body": "<p>You're not qualifying the context for</p>\n\n<pre><code>bb = Range(\"a\" &amp; aa).Row\n</code></pre>\n\n<p>Excel does not know which sheet this Range refers to. Same for the other unqualified Range statements. </p>\n"}, {"tags": [], "owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "is_accepted": false, "score": 1, "last_activity_date": 1471422591, "last_edit_date": 1471422591, "creation_date": 1471422129, "answer_id": 38991536, "question_id": 38991215, "link": "https://stackoverflow.com/questions/38991215/vba-1004-error-pulling-data-from-other-sheet/38991536#38991536", "title": "VBA 1004 error pulling data from other sheet", "body": "<p>Consider <code>DBWS.Columns(\"a\")...</code> change to <code>DBWS.Columns(\"a:a\")...</code> </p>\n\n<p><code>a</code>is not a valid reference.</p>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1471423148, "creation_date": 1471423148, "answer_id": 38991848, "question_id": 38991215, "link": "https://stackoverflow.com/questions/38991215/vba-1004-error-pulling-data-from-other-sheet/38991848#38991848", "title": "VBA 1004 error pulling data from other sheet", "body": "<p>As @SickDimesion mentioned, you have to change <code>Columns(\"a\")</code> to <code>DBWS.Columns(\"a:a\")</code> or to <code>DBWS.Columns(1)</code></p>\n\n<p>After doing that change, you <strong>may</strong> still get an error because, you are directly trying to get the row. What if the <code>.Find</code> didn't return a match?</p>\n\n<p>Consider changing your code to this</p>\n\n<pre><code>Dim aCell as Range\n\nset aCell = DBWS.Columns(1).Find(what:=cws.Range(\"b1\").Value, _\n                                 after:=DBWS.Range(\"a1\"))\n\nIf Not aCell Is Nothing Then\n    aa = aCell.Row\nElse\n    Msgbox \"Value Not Found\"\n    Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6667292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab8fe7face91d4e4ace81cba95bf6cc7?s=128&d=identicon&r=PG&f=1", "display_name": "JayF", "link": "https://stackoverflow.com/users/6667292/jayf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1471423148, "creation_date": 1471421124, "last_edit_date": 1471421280, "question_id": 38991215, "link": "https://stackoverflow.com/questions/38991215/vba-1004-error-pulling-data-from-other-sheet", "title": "VBA 1004 error pulling data from other sheet", "body": "<p>Bit of a strange Object/User Defined 1004 error that I'm having.. maybe I'm just overlooking something.</p>\n\n<p>I'm looking to implement a code very similar to one that I have used on another sheet. Essentially the sheet is a dashboard, the only cell used by the user is \"b1\" in the activesheet as this allows the user to choose from a dropdown menu of choices. Upon the change the information should reference ClientDB sheet to find the correct row, then pull the information from it.</p>\n\n<p>Ive used very similar code previously with no hitch.. Just wondering if there is something I may be overlooking?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim DBWS As Worksheet, cws As Worksheet, sws As Worksheet\nDim aa As Integer, bb As Integer, cc As Integer, dd As Integer\n\nSet DBWS = ActiveWorkbook.Sheets(\"ClientDB\")\nSet cws = ActiveWorkbook.Sheets(\"ClientBoard\")\n\naa = DBWS.Columns(\"a\").Find(what:=cws.Range(\"b1\").Value, after:=DBWS.Range(\"a1\")).Row\nbb = Range(\"a\" &amp; aa).Row\n\n\n'contact\nRange(\"b3\").Value = DBWS.Cells(bb, \"H\").Value\n'number\nRange(\"b4\").Value = DBWS.Cells(bb, \"I\").Value\n'email\n\nRange(\"b5\").Value = DBWS.Cells(bb, \"J\").Value\n</code></pre>\n\n<p>'etc.. etc.. etc..</p>\n\n<p>Extra Note: If I run an Error Handler to bypass the 1004 error it will eventually populate after a few errorhandler cycles</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p>Thanks!</p>\n\n<p>Jay</p>\n"}, {"tags": ["excel", "vba", "loops", "checkbox", "userform"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1471421607, "post_id": 38991201, "comment_id": 65334655, "body": "Working code in need of optimizations should be posted on <a href=\"https://codereview.stackexchange.com/\">CodeReview</a> . AFAIK you will need to build the name of the control as a string and pass it as a key to the controls collection."}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1471421939, "creation_date": 1471421939, "answer_id": 38991481, "question_id": 38991201, "link": "https://stackoverflow.com/questions/38991201/excel-vba-how-to-loop-through-checkboxes-based-on-name/38991481#38991481", "title": "Excel VBA: How to loop through checkboxes based on name", "body": "<p>As a follow up answer to my comment, here is what I think you are looking for:</p>\n\n<pre><code>    arow = lastAns - qRow\n    Dim i As Long, ctl As Control\n    For i = 1 To 4\n        Set ctl = Me.Controls(\"CheckBox\" &amp; i)\n        If i &lt;= arow Then\n            ctl.Visible = True\n            ctl.Caption = Cells(qRow + i - 1, 5)\n        Else\n            ctl.Visible = False\n        End If\n    Next i\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 6578531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431ec9c553ec5f84f5b41a1cb33c930f?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/6578531/doug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2533, "favorite_count": 0, "accepted_answer_id": 38991481, "answer_count": 1, "score": 0, "last_activity_date": 1471421939, "creation_date": 1471421060, "question_id": 38991201, "link": "https://stackoverflow.com/questions/38991201/excel-vba-how-to-loop-through-checkboxes-based-on-name", "title": "Excel VBA: How to loop through checkboxes based on name", "body": "<p>I want to build a survey using excel and vba. I have a table with questions and answers. As the survey starts, my code will list the answers by overwriting the checkboxes' labels on a form. I will fetch their answer and write them in a column by using True or False value of a checkbox.</p>\n\n<p>Variable \"aRow\" is the number of the answers for each question. \"lastAns\" is the row number of the last answer. Depending on the number of the answer, some checkboxes will be hidden, shown. \"CheckBox1\" to \"CheckBox4\" are the names of the checkboxes.</p>\n\n<p>The following code works, but it is too long and I want to have a better method to loop through the checkboxes and changing their labels each time. Please show me how to do it!\nThanks you so much!</p>\n\n<pre><code>     `lastAns = Cells(qRow, 5).End(xlDown).Row + 1\n       aRow = lastAns - qRow\n        If aRow &gt;= 1 Then\n            Me.CheckBox1.Visible = True\n            Me.CheckBox1.Caption = Cells(qRow, 5)\n            Else: Me.CheckBox1.Visible = False\n        End If\n        If aRow &gt;= 2 Then\n            Me.CheckBox2.Visible = True\n            Me.CheckBox2.Caption = Cells(qRow + 1, 5)\n            Else: Me.CheckBox2.Visible = False\n            End If\n        If aRow &gt;= 3 Then\n            Me.CheckBox3.Visible = True\n            Me.CheckBox3.Caption = Cells(qRow + 2, 5)\n            Else: Me.CheckBox3.Visible = False\n            End If\n        If aRow &gt;= 4 Then\n            Me.CheckBox4.Visible = True\n            Me.CheckBox4.Caption = Cells(qRow + 3, 5)\n            Else: Me.CheckBox4.Visible = False\n            End If\n               .....SAME CODE CONTINUES TILL 7...`\n</code></pre>\n"}, {"tags": ["vba", "excel", "rest", "servicenow"], "comments": [{"owner": {"reputation": 2850, "user_id": 1178273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GGAFP.png?s=128&g=1", "display_name": "makim", "link": "https://stackoverflow.com/users/1178273/makim"}, "edited": false, "score": 0, "creation_date": 1474889910, "post_id": 38991146, "comment_id": 66701687, "body": "The only other option for extracting data you have are the REST/SOAP Interfaces of Service-Now. But I think you can&#39;t do that in Excel."}], "answers": [{"tags": [], "owner": {"reputation": 8602, "user_id": 5936628, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67edb9182ec767573ef95539c533b0a9?s=128&d=identicon&r=PG&f=1", "display_name": "Anil_M", "link": "https://stackoverflow.com/users/5936628/anil-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1476712576, "last_edit_date": 1495540828, "creation_date": 1476712576, "answer_id": 40088334, "question_id": 38991146, "link": "https://stackoverflow.com/questions/38991146/extract-incident-details-from-service-now-in-excel/40088334#40088334", "title": "Extract incident details from Service Now in Excel", "body": "<p>It's been a while since this question is asked. Hopefully following is still useful.  </p>\n\n<p>I am extracting change data (not incident) , but the process still should be same. You will need to gather incident table and column information. Then there are couple of ways to approach the problem.</p>\n\n<p>1) If the data you are extracting has fixed parameters , such as fixed period or fixed column or group etc., then you can create a report within servicenow and then use REST/SOAP API to get the data in text/csv format. You can use different python modules to convert from csv to xls or xlsx depending on you need. I used <code>openpyXL</code> ,<code>csv</code> , <code>xlsreader</code> ,<code>xlswriter</code> etc.</p>\n\n<p>See here for a example\n<a href=\"https://stackoverflow.com/questions/37167270/servicenow-how-to-use-soap-to-download-reports\">ServiceNow - How to use SOAP to download reports</a></p>\n\n<p>2) If the data has dynmaic parameters where you need to change columns, dates or filter etc, you can still use soap / REST API but form query within python scripts instead of having static report. This way you can change it based on your requirement on the fly.</p>\n\n<p>Here is an example query  for DB. you can use example for above. Just switch <code>url</code> with following.</p>\n\n<pre><code>table_name = 'u_change_table_name' #SN DB holding change/INCIDENT info\n\ntable_limit = 800\n\ntable_query = 'active=true&amp;sysparm_display_value=true&amp;planned_start_date=today'\n\ndate_query = 'chg_start_date&gt;=javascript:gs.daysAgoStart(1)^active=true^chg_type=normal'\n\ntable_fields = 'chg_number,chg_start_date,chg_duration,chg_end_date'  #Actual column names from DB and not from SN report.\n\nurl= (\n      'https://yourcompany.service-now.com/api/now/table/' +table_name +\\\n       '?sysparm_query=' + date_query + '&amp;sysparm_fields=' \\\n       + table_fields  + '&amp;sysparm_limit=' +  str(table_limit)\n     )\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6607619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b19921925a0d3557dd0a73a3b4ae4d9b?s=128&d=identicon&r=PG&f=1", "display_name": "Shravan Vishwanathan", "link": "https://stackoverflow.com/users/6607619/shravan-vishwanathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3610, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1502816108, "creation_date": 1471420886, "last_edit_date": 1502816108, "question_id": 38991146, "link": "https://stackoverflow.com/questions/38991146/extract-incident-details-from-service-now-in-excel", "title": "Extract incident details from Service Now in Excel", "body": "<p>I am trying to extract ticket details from Service Now. Is there a way to extract the details without ODBC ? I have also tried the solution mentioned in  [1]: <a href=\"https://community.servicenow.com/docs/DOC-3844\" rel=\"nofollow noreferrer\">https://community.servicenow.com/docs/DOC-3844</a>, but I am receiving an error 9 -subscript out of range.</p>\n\n<p>Is there a better way to extract details efficiently? I tried asking this in the service now forum but I thought I might get other opinions from here.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1471441624, "creation_date": 1471441624, "answer_id": 38998495, "question_id": 38989892, "link": "https://stackoverflow.com/questions/38989892/how-to-select-one-by-one-particular-string-in-word-vba-script/38998495#38998495", "title": "How to select one by one particular string in word vba script?", "body": "<p>You need to specify the correct font formatting in your find operation (note the <code>.Font.Bold = True</code> part below):</p>\n\n<pre><code>With Selection.Find\n    .ClearFormatting\n    .Font.Bold = True\n    .Replacement.ClearFormatting\n    .text = \"\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\n</code></pre>\n\n<p>Then, of course, it depends what you want to do with the bold text. Currently the code above just configures the <code>Find</code> object to search for bold text.  </p>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1471441912, "creation_date": 1471441912, "answer_id": 38998624, "question_id": 38989892, "link": "https://stackoverflow.com/questions/38989892/how-to-select-one-by-one-particular-string-in-word-vba-script/38998624#38998624", "title": "How to select one by one particular string in word vba script?", "body": "<p>It's not <strong>strong</strong> you're looking for, it's <code>Font.Bold</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub FindBold()\n    Dim myDoc As Document\n    Set myDoc = ThisDocument\n\n    Dim searchRange As Range\n    Dim foundRange As Range\n    Set searchRange = myDoc.Range(0, myDoc.Range.End)\n    With searchRange.Find\n        .ClearFormatting\n        .Forward = True\n        .Font.Bold = True\n        .Execute\n        Do While .Found\n            Set foundRange = searchRange\n            foundRange.Select\n            foundRange.Collapse direction:=wdCollapseEnd\n            MsgBox \"Found bold text.\"\n            .Execute\n        Loop\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 1445949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d68781e906c5d89a6b8114f74fa7c3?s=128&d=identicon&r=PG", "display_name": "Perl handler", "link": "https://stackoverflow.com/users/1445949/perl-handler"}, "is_accepted": false, "score": 0, "last_activity_date": 1471495428, "creation_date": 1471495428, "answer_id": 39010162, "question_id": 38989892, "link": "https://stackoverflow.com/questions/38989892/how-to-select-one-by-one-particular-string-in-word-vba-script/39010162#39010162", "title": "How to select one by one particular string in word vba script?", "body": "<p>My ans:</p>\n\n<pre><code>Sub RepalaceStrong()\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = \"&lt;Strong\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n  Selection.Find.Execute\n    Selection.Extend\n\n    With Selection.Find\n        .Text = \"&lt;/Strong&gt;\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\nSelection.Find.Execute\nSelection.Collapse Direction:=wdCollapseEnd\nEnd Sub\n</code></pre>\n\n<p>I got it ....</p>\n"}], "owner": {"reputation": 89, "user_id": 1445949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d68781e906c5d89a6b8114f74fa7c3?s=128&d=identicon&r=PG", "display_name": "Perl handler", "link": "https://stackoverflow.com/users/1445949/perl-handler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1571570186, "creation_date": 1471416559, "last_edit_date": 1571570186, "question_id": 38989892, "link": "https://stackoverflow.com/questions/38989892/how-to-select-one-by-one-particular-string-in-word-vba-script", "title": "How to select one by one particular string in word vba script?", "body": "<p>I need selection particular content each paragraph in ms word 2013. I try to select content using by vba script..</p>\n\n<pre><code>Sub RepalaceStrong()\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = \"&lt;Strong\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Extend\n    With Selection.Find\n        .Text = \"&lt;/Strong&gt;\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>But i tried this code, i can't select one by one text.</p>\n\n<p><strong>Input:</strong></p>\n\n<pre><code>In general, a vector field is a function whose domain is a set of points in  &lt;Strong&gt; a vector field is &lt;/Strong&gt; a vector field is &lt;Strong&gt;function&lt;/Strong&gt; whose domain is a set of points \n\n&gt;In general, a vector field is a function whose &lt;Strong&gt;domain&lt;/Strong&gt; is a set of points\n</code></pre>\n\n<p>Is it possible to select one by one all strong elements...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1471415858, "post_id": 38989522, "comment_id": 65331399, "body": "Do not schedule the OnTime if you are going to rerun StartTimer upon completion of the called procedure."}, {"owner": {"reputation": 1517, "user_id": 4259922, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ab0b41e72934448eba6644f19b26fc82?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Saluja", "link": "https://stackoverflow.com/users/4259922/rohit-saluja"}, "edited": false, "score": 0, "creation_date": 1471415972, "post_id": 38989522, "comment_id": 65331459, "body": "@Jeeped I need to schedule the OnTime to keep these functions call in loop."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1471416096, "post_id": 38989522, "comment_id": 65331531, "body": "<code>RunWhen = Now + TimeSerial(0, 0, cRunIntervalSeconds)</code>  Not &quot;TimeValue&quot;"}, {"owner": {"reputation": 1517, "user_id": 4259922, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ab0b41e72934448eba6644f19b26fc82?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Saluja", "link": "https://stackoverflow.com/users/4259922/rohit-saluja"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471416237, "post_id": 38989522, "comment_id": 65331601, "body": "@TimWilliams AFAIK both functions returns the time, TimeValue takes a string while TimeSerial takes long, Also I have tested this thing using TimeSerial as well but it still does not work."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1471416291, "post_id": 38989522, "comment_id": 65331622, "body": "Works fine for me with that change.  Your code as posted causes a compile-time error on <code>TimeValue</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1517, "user_id": 4259922, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ab0b41e72934448eba6644f19b26fc82?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Saluja", "link": "https://stackoverflow.com/users/4259922/rohit-saluja"}, "edited": false, "score": 0, "creation_date": 1471416760, "post_id": 38989829, "comment_id": 65331900, "body": "Oh,Okay my bad I just mixed both of these function and confused myself"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1471416348, "creation_date": 1471416348, "answer_id": 38989829, "question_id": 38989522, "link": "https://stackoverflow.com/questions/38989522/ontime-function-confusion/38989829#38989829", "title": "OnTime function Confusion", "body": "<p>You should be using the <a href=\"https://msdn.microsoft.com/en-us/library/ws25fd2z.aspx\" rel=\"nofollow\">TimeSerial</a> function, not <a href=\"https://msdn.microsoft.com/en-us/library/hz2ahtzs%28v=vs.90%29.aspx\" rel=\"nofollow\">TimeValue</a>.</p>\n\n<pre><code>Option Explicit\n\nPublic RunWhen As Double\nPublic Const cRunIntervalSeconds = 5 ' two minutes\nPublic Const cRunWhat = \"TheSub\"  ' the name of the procedure to run\n\nSub StartTimer()\n    RunWhen = Now + TimeSerial(0, 0, cRunIntervalSeconds)\n    Application.OnTime EarliestTime:=RunWhen, Procedure:=cRunWhat\nEnd Sub\n\n\nSub TheSub()\n    ''''''''''''''''''''''''\n    ' Your code here\n    ''''''''''''''''''''''''\n    Debug.Print \"hi this is working\"\n    StartTimer  ' Reschedule the procedure\nEnd Sub\n</code></pre>\n\n<p>This works and you can watch the VBE's Immediate window to see it run through.</p>\n"}], "owner": {"reputation": 1517, "user_id": 4259922, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ab0b41e72934448eba6644f19b26fc82?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Saluja", "link": "https://stackoverflow.com/users/4259922/rohit-saluja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 38989829, "answer_count": 1, "score": 2, "last_activity_date": 1472154806, "creation_date": 1471415410, "last_edit_date": 1472154806, "question_id": 38989522, "link": "https://stackoverflow.com/questions/38989522/ontime-function-confusion", "title": "OnTime function Confusion", "body": "<p>I have written down below VBA code to be executed after every 5 seconds but it does not work. </p>\n\n<pre><code>Option Explicit\n\nPublic RunWhen As Double\nPublic Const cRunIntervalSeconds = 5 ' two minutes\nPublic Const cRunWhat = \"TheSub\"  ' the name of the procedure to run\n\nSub StartTimer()\n    RunWhen = Now + TimeValue(0, 0, cRunIntervalSeconds)\n    Application.OnTime EarliestTime:=RunWhen, Procedure:=cRunWhat, _\n        Schedule:=True\nEnd Sub\n\n\nSub TheSub()\n    ''''''''''''''''''''''''\n    ' Your code here\n    ''''''''''''''''''''''''\n    MsgBox \"hi this is working\"\n    StartTimer  ' Reschedule the procedure\nEnd Sub\n</code></pre>\n\n<p>What is that I am missing here ?</p>\n\n<p>Also a simple expression like below also don't works</p>\n\n<pre><code>Sub test()\n    Application.ontime (now() + TimeValue(\"0:0:5\")),\"test\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "directory"], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 6546590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ceebcf90fc76eabbf3e34f3723bede1?s=128&d=identicon&r=PG&f=1", "display_name": "mrwd", "link": "https://stackoverflow.com/users/6546590/mrwd"}, "edited": false, "score": 0, "creation_date": 1471417843, "post_id": 38989601, "comment_id": 65332471, "body": "Thank you! Works good. The only problem is that this command:                       <code>ThisWorkbook.Sheets(1).SaveAs NewPath &amp; &quot;\\Secret_information_&quot; &amp; [Pricelist!E2] &amp; &quot;_&quot; &amp; &quot;SC&quot; &amp; [Technical!I11] &amp; &quot;_&quot; &amp; Format(Date, &quot;ddmmmyy&quot;) &amp; &quot;.xls&quot;, xlExcel8</code>                                      creates new excel document with all the sheets from original. I need it to copy only the sheet number one. Also I want it to delete all the functions from the sheet while creating."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 318, "user_id": 6546590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ceebcf90fc76eabbf3e34f3723bede1?s=128&d=identicon&r=PG&f=1", "display_name": "mrwd", "link": "https://stackoverflow.com/users/6546590/mrwd"}, "edited": false, "score": 0, "creation_date": 1471419981, "post_id": 38989601, "comment_id": 65333666, "body": "these questions where not the part of original post. must read this : <a href=\"http://slash7.com/2006/12/22/vampires/\" rel=\"nofollow noreferrer\">slash7.com/2006/12/22/vampires</a> optional reading : <a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}, {"owner": {"reputation": 318, "user_id": 6546590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ceebcf90fc76eabbf3e34f3723bede1?s=128&d=identicon&r=PG&f=1", "display_name": "mrwd", "link": "https://stackoverflow.com/users/6546590/mrwd"}, "edited": false, "score": 0, "creation_date": 1471422173, "post_id": 38989601, "comment_id": 65334967, "body": "Actually I have asked &quot;I need to save PDF and Excel from Worksheet (1) to this folder with special name&quot;. You can notice that there is mentioned that I need xls to be created from Worksheet number one, not the whole workbook. Anyways thank you for your help but there is no need to send links for reading if you haven&#39;t read the question..."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 318, "user_id": 6546590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ceebcf90fc76eabbf3e34f3723bede1?s=128&d=identicon&r=PG&f=1", "display_name": "mrwd", "link": "https://stackoverflow.com/users/6546590/mrwd"}, "edited": false, "score": 0, "creation_date": 1471422307, "post_id": 38989601, "comment_id": 65335046, "body": "need to save PDF and Excel from Worksheet (1), code  <code>ActiveWorkbook.Sheets(1).Copy</code>         <code>ActiveWorkbook.SaveAs NewPath...</code> whats the issue?? it will create a new workbook  with first sheet. Now in the comment you came up with this agile piece of code... <code>ThisWorkbook.Sheets\u200c\u200b(1).SaveAs NewPath &amp;...</code> out of no where.... hence the link."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 318, "user_id": 6546590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ceebcf90fc76eabbf3e34f3723bede1?s=128&d=identicon&r=PG&f=1", "display_name": "mrwd", "link": "https://stackoverflow.com/users/6546590/mrwd"}, "edited": false, "score": 0, "creation_date": 1471422559, "post_id": 38989601, "comment_id": 65335200, "body": "don&#39;t focus on being condescending, try to be humble and direct."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1471415667, "creation_date": 1471415667, "answer_id": 38989601, "question_id": 38989467, "link": "https://stackoverflow.com/questions/38989467/check-if-folder-exists-and-save-two-sheets-in-there-vba-excel/38989601#38989601", "title": "Check if folder exists and save two sheets in there VBA Excel", "body": "<ol>\n<li>you are missing <code>\\</code> in <code>Application.ThisWorkbook.Path &amp; \"\" &amp; \"Secret_information\"</code> so it should be <code>Application.ThisWorkbook.Path &amp; \"\\\" &amp; \"Secret_information\"</code></li>\n<li>you are missing extension at the end of this line , also format the date, its more readable that way <code>\nActiveWorkbook.SaveAs NewPath &amp; \"\\Secret_information_\" &amp;\n[Pricelist!E2] &amp; \"_\" &amp; \"DD\" &amp; [Material!J8] &amp; \"_\" &amp; Date</code> it should be <code>ActiveWorkbook.SaveAs NewPath &amp; \"\\Secret_information_\" &amp; [Pricelist!E2] &amp; \"_\" &amp; \"DD\" &amp; [Material!J8] &amp; \"_\" &amp; Format(Date,\"ddmmmyy\" )&amp; \".xls\",xlExcel8</code></li>\n</ol>\n\n<p>Add the file format for xls as <code>xlExcel8</code></p>\n"}], "owner": {"reputation": 318, "user_id": 6546590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ceebcf90fc76eabbf3e34f3723bede1?s=128&d=identicon&r=PG&f=1", "display_name": "mrwd", "link": "https://stackoverflow.com/users/6546590/mrwd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 38989601, "answer_count": 1, "score": 1, "last_activity_date": 1471415667, "creation_date": 1471415179, "question_id": 38989467, "link": "https://stackoverflow.com/questions/38989467/check-if-folder-exists-and-save-two-sheets-in-there-vba-excel", "title": "Check if folder exists and save two sheets in there VBA Excel", "body": "<p>I need VBA to check if folder with name \"Secret_information\" already exists. If folder already exists then I need to save PDF and Excel from Worksheet (1) to this folder with special name (see VBA below). If folder does not exists then create new folder in the same direction my opened Excel file is already located. I have made VBA but it doesn't work correctly. Now it doesn't create xls file only pdf. Also this code creates folder to Desktop, I need it to create folder inside folder my opened Excel file is located. How to make it work?</p>\n\n<pre><code>Sub CommercialPart()\n   Dim NewPath As String\n   NewPath = Application.ThisWorkbook.Path &amp; \"\" &amp; \"Secret_information\"\n   If Dir(NewPath, 63) = \"\" Then MkDir NewPath\n\n        ActiveWorkbook.Sheets(1).Select\n        ActiveSheet.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=NewPath &amp; \"\\Secret_information_\" &amp; [Pricelist!E2] &amp; \"_\" &amp; \"SC\" &amp; [Technical!I11] &amp; \"_\" &amp; Date &amp; \".pdf\", _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=No, _\n        OpenAfterPublish:=False\n\n        ActiveWorkbook.Sheets(1).Copy\n        ActiveWorkbook.SaveAs NewPath &amp; \"\\Secret_information_\" &amp; [Pricelist!E2] &amp; \"_\" &amp; \"DD\" &amp; [Material!J8] &amp; \"_\" &amp; Date\n        ActiveWorkbook.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471412605, "post_id": 38988847, "comment_id": 65329972, "body": "Pictures are missing"}, {"owner": {"reputation": 601, "user_id": 6644975, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-oYqlkA6i_dI/AAAAAAAAAAI/AAAAAAAAAKM/GW7Fbgs0GqA/photo.jpg?sz=128", "display_name": "Sean Reyes", "link": "https://stackoverflow.com/users/6644975/sean-reyes"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471412853, "post_id": 38988847, "comment_id": 65330072, "body": "I need at least 10 reputation to post Image :("}, {"owner": {"reputation": 601, "user_id": 6644975, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-oYqlkA6i_dI/AAAAAAAAAAI/AAAAAAAAAKM/GW7Fbgs0GqA/photo.jpg?sz=128", "display_name": "Sean Reyes", "link": "https://stackoverflow.com/users/6644975/sean-reyes"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1471412872, "post_id": 38988847, "comment_id": 65330080, "body": "can you just Click the Image Link please :D"}], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 6644975, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-oYqlkA6i_dI/AAAAAAAAAAI/AAAAAAAAAKM/GW7Fbgs0GqA/photo.jpg?sz=128", "display_name": "Sean Reyes", "link": "https://stackoverflow.com/users/6644975/sean-reyes"}, "edited": false, "score": 0, "creation_date": 1471416415, "post_id": 38989495, "comment_id": 65331689, "body": "Thanks Works Fine :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 3, "last_activity_date": 1471415271, "creation_date": 1471415271, "answer_id": 38989495, "question_id": 38988847, "link": "https://stackoverflow.com/questions/38988847/excel-vba-comparing-2-column/38989495#38989495", "title": "EXCEL VBA COMPARING 2 COLUMN", "body": "<p><strong>No need for VBA</strong></p>\n\n<p>Let's say your worksheet looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/NrjcY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NrjcY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Put this formula in cell <code>C1</code> </p>\n\n<pre><code>=IF(ISERROR(MATCH(A1&amp;\"|\"&amp;B1,$E$1:$E$6&amp;\"|\"&amp;$F$1:$F$6,0)),\"\",A1)\n</code></pre>\n\n<p>and press <kbd>CTRL</kbd> + <kbd>SHIFT</kbd> + <kbd>ENTER</kbd> and drag the formula down.</p>\n\n<p>Put this formula in cell <code>D1</code> and pull the formula down</p>\n\n<pre><code>=IF(C1&lt;&gt;\"\",B1,\"\")\n</code></pre>\n\n<p>This is the end result</p>\n\n<p><a href=\"https://i.stack.imgur.com/7hOQ0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7hOQ0.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Logic</strong>:</p>\n\n<ol>\n<li>We are performing a two-column lookup using the <code>&amp;</code> operator</li>\n<li>We are using \"|\" to prevent any false positives. For example \"Name1N\" Col <code>A</code> and \"ame2\" in Col B which after concatenating would be the same as that for \"Name1\" Col <code>A</code> and \"Name2\"</li>\n<li>In Col <code>D</code> we are just checking if Col <code>C</code> is populated. If it is then simply pull the values from Col <code>B</code></li>\n<li>The first formula is an array formula and hence we are using <kbd>CTRL</kbd> + <kbd>SHIFT</kbd> + <kbd>ENTER</kbd> in lieu of just <kbd>ENTER</kbd></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 601, "user_id": 6644975, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-oYqlkA6i_dI/AAAAAAAAAAI/AAAAAAAAAKM/GW7Fbgs0GqA/photo.jpg?sz=128", "display_name": "Sean Reyes", "link": "https://stackoverflow.com/users/6644975/sean-reyes"}, "edited": false, "score": 0, "creation_date": 1471416698, "post_id": 38989537, "comment_id": 65331858, "body": "This Works Too :) Thankyou"}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": true, "score": 0, "last_activity_date": 1471415444, "creation_date": 1471415444, "answer_id": 38989537, "question_id": 38988847, "link": "https://stackoverflow.com/questions/38988847/excel-vba-comparing-2-column/38989537#38989537", "title": "EXCEL VBA COMPARING 2 COLUMN", "body": "<p>You can try this as well</p>\n\n<pre><code>Sub Find_Matches()\n    Dim list1 As Range\n    Dim list2 As Range\n    Set list1 = Range(\"A1:B6\")\n    Set list2 = Range(\"E1:F6\")\n\n    For Each row1 In list1.Rows\n        For Each row2 In list2.Rows\n            If (row1.Cells(1) = row2.Cells(1) And row1.Cells(2) = row2.Cells(2)) Then\n            row1.Cells(1).Offset(0, 2) = row1.Cells(1)\n            row1.Cells(2).Offset(0, 2) = row1.Cells(2)\n            Exit For\n            End If\n        Next row2\n\n    Next row1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 6644975, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-oYqlkA6i_dI/AAAAAAAAAAI/AAAAAAAAAKM/GW7Fbgs0GqA/photo.jpg?sz=128", "display_name": "Sean Reyes", "link": "https://stackoverflow.com/users/6644975/sean-reyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 38989537, "answer_count": 2, "score": 1, "last_activity_date": 1471415444, "creation_date": 1471412409, "last_edit_date": 1471413344, "question_id": 38988847, "link": "https://stackoverflow.com/questions/38988847/excel-vba-comparing-2-column", "title": "EXCEL VBA COMPARING 2 COLUMN", "body": "<p>[<img src=\"https://i.stack.imgur.com/yEjp8.png\" alt=\"enter image description here\">\nI have 2 list with firstname and Lastname, now I want to know if someone in list1 exist at the list2 (References)</p>\n\n<p>this is the Code that I'm using Right Now but the problem is (Picture3 References)</p>\n\n<pre><code>Sub Find_Matches()\n    Dim CompareRange As Variant, x As Variant, y As Variant\n\n    Set CompareRange = Range(\"E1:F6\")\n\n    For Each x In Selection\n        For Each y In CompareRange\n            If x = y Then x.Offset(0, 1) = x\n        Next y\n    Next x\nEnd Sub\n</code></pre>\n\n<p>I want A result Like (Picture4 References)</p>\n\n<p>where I only Get to those whose Firstname and Lastname are The same</p>\n\n<p>NOTE: At (picture 3 &amp; 4) my code change</p>\n\n<pre><code>  Set CompareRange = Range(\"G2:H7\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2704742, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/o6tmW.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/2704742/danny"}, "edited": false, "score": 0, "creation_date": 1471410421, "post_id": 38988369, "comment_id": 65329232, "body": "I replaced the line Range(&quot;B5:BH323&quot;) with yours. When I click on the button nothing happens."}], "tags": [], "owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "is_accepted": false, "score": 0, "last_activity_date": 1471409790, "creation_date": 1471409790, "answer_id": 38988369, "question_id": 38988284, "link": "https://stackoverflow.com/questions/38988284/excel-vba-button-which-adds-a-new-row-and-copy-formual-from-the-row-above/38988369#38988369", "title": "Excel VBA button which adds a new row and copy formual from the row above", "body": "<p>Use Cells(Rows.Count, \"B\").End(xlUp).Row to find the last row. </p>\n"}], "owner": {"reputation": 89, "user_id": 2704742, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/o6tmW.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/2704742/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471412406, "creation_date": 1471409201, "last_edit_date": 1471409957, "question_id": 38988284, "link": "https://stackoverflow.com/questions/38988284/excel-vba-button-which-adds-a-new-row-and-copy-formual-from-the-row-above", "title": "Excel VBA button which adds a new row and copy formual from the row above", "body": "<p>I am completely new to macros/VBA. All I am trying to do is to create a button which should add new row. I also want to copy formulas to the new row from the row above. My start column is B.</p>\n\n<p>this is a code i copied from somewhere</p>\n\n<pre><code> Private Sub Button1_Click(Optional line As Integer = -1)\n    Dim target As Range\n    Dim cell As Range\n    Dim rowNr As Integer\n\n    Set target = Range(\"B5:BH323\")\n\n    If line &lt;&gt; -1 Then\n        rowNr = line\n    Else\n        rowNr = target.Rows.Count\n    End If\n\n    target.Rows(rowNr + 1).Insert\n    target.Rows(rowNr).Copy target.Rows(rowNr + 1)\n    For Each cell In target.Rows(rowNr + 1).Cells\n        If Left(cell.Formula, 1) &lt;&gt; \"=\" Then cell.Clear\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>this code works well. It inserts a new row with the formulas but in this code insert happens only below the range mentioned in the code, I want the insert to happen after the last row with data. Can some one correct this code please, also the newly inserted doesn't copy the borders.</p>\n\n<p>What I need is is the line which specifies the last row with data and also makes sure that the border format is copied as well</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471410074, "post_id": 38988240, "comment_id": 65329122, "body": "you want to add a loop of all sheets instead of only searching through <code>Sheets(&quot;export3&quot;)</code> ?"}, {"owner": {"reputation": 13, "user_id": 6724594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811d5f75300333308bc008c5438db2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Clarence", "link": "https://stackoverflow.com/users/6724594/clarence"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471410390, "post_id": 38988240, "comment_id": 65329222, "body": "I tried adding a loop by using a counter... kept giving me some errors. Sorry I&#39;m unable to paste those amended codes.. am on phone now"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471410684, "post_id": 38988240, "comment_id": 65329323, "body": "see code below how to loop through the sheet"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6724594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811d5f75300333308bc008c5438db2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Clarence", "link": "https://stackoverflow.com/users/6724594/clarence"}, "edited": false, "score": 0, "creation_date": 1471431286, "post_id": 38988524, "comment_id": 65341009, "body": "Hi Shai Rado , Thanks! it works perfectly fine! Just one final qns - Will it be possible to add in a pop up message indicating the entries in the criteria that are not found in any of the worksheets? How should I go about doing it? Sorry to be asking so much trouble but I am still learning vba and experimenting on my own"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 6724594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811d5f75300333308bc008c5438db2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Clarence", "link": "https://stackoverflow.com/users/6724594/clarence"}, "edited": false, "score": 0, "creation_date": 1471431567, "post_id": 38988524, "comment_id": 65341196, "body": "@Clarence this is no part of your post, and it requires handling in a different method. You should use your modified code in a new post, requesting what you want. In the meantime, please mark as answer :)"}, {"owner": {"reputation": 13, "user_id": 6724594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811d5f75300333308bc008c5438db2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Clarence", "link": "https://stackoverflow.com/users/6724594/clarence"}, "edited": false, "score": 0, "creation_date": 1471435764, "post_id": 38988524, "comment_id": 65344023, "body": "Done :) I have less than 15 rep so it wouldn&#39;t display publicly for some reason :("}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 6724594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811d5f75300333308bc008c5438db2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Clarence", "link": "https://stackoverflow.com/users/6724594/clarence"}, "edited": false, "score": 0, "creation_date": 1471435867, "post_id": 38988524, "comment_id": 65344090, "body": "it&#39;s ok, it did :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1471410631, "creation_date": 1471410631, "answer_id": 38988524, "question_id": 38988240, "link": "https://stackoverflow.com/questions/38988240/vba-deleting-matching-data-and-its-rows-over-multiple-sheets-based-on-a-range/38988524#38988524", "title": "VBA - Deleting matching data and its rows over multiple sheets based on a range of data", "body": "<p>The modified code below will help you to loop through all the Sheets in <code>ThisWorkbook</code> (besides \"<em>Sheet1</em>\" where you have your <strong><em>CriteriaRng</em></strong> Set).</p>\n\n<pre><code>Sub Delete_with_Autofilter_More_Criteria()\n\nDim rng As Range\nDim cell As Range\nDim CriteriaRng As Range\nDim calcmode As Long\nDim sht As Worksheet\n\n\nWith Application\n    calcmode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\nEnd With\n\n'setting criteria\nWith Sheets(\"Sheet1\")\n      Set CriteriaRng = .Range(\"A1\", .Cells(Rows.Count, \"A\").End(xlUp))\nEnd With\n\n' loop through all sheets in this workbook\nFor Each sht In ThisWorkbook.Sheets\n\n    ' don't run this comparison for the original sheet1\n    If sht.Name &lt;&gt; \"Sheet1\" Then\n\n        'Loop through the cells in the Criteria range\n        For Each cell In CriteriaRng\n\n            With sht\n                'Firstly, remove the AutoFilter\n                .AutoFilterMode = False\n\n                'Apply the filter\n                .Range(\"A1:A\" &amp; .Rows.Count).AutoFilter Field:=1, Criteria1:=cell.Value\n\n                With .AutoFilter.Range\n                    Set rng = Nothing\n                    On Error Resume Next\n                    Set rng = .Offset(1, 0).Resize(.Rows.Count - 1, 1) _\n                              .SpecialCells(xlCellTypeVisible)\n                    On Error GoTo 0\n                    If Not rng Is Nothing Then rng.EntireRow.Delete\n                End With\n\n                'Remove the AutoFilter\n                .AutoFilterMode = False\n            End With\n\n        Next cell\n    End If\n\nNext sht\n\nWith Application\n    .ScreenUpdating = True\n    .Calculation = calcmode\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6724594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811d5f75300333308bc008c5438db2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Clarence", "link": "https://stackoverflow.com/users/6724594/clarence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 38988524, "answer_count": 1, "score": 1, "last_activity_date": 1471410868, "creation_date": 1471408935, "last_edit_date": 1531164843, "question_id": 38988240, "link": "https://stackoverflow.com/questions/38988240/vba-deleting-matching-data-and-its-rows-over-multiple-sheets-based-on-a-range", "title": "VBA - Deleting matching data and its rows over multiple sheets based on a range of data", "body": "<p>I am trying to create a excel macro (with the help of google) that searches a set of data, using that as a criteria then search through all of the sheets in my workbook and deleting any rows with matching values in it.</p>\n\n<p>the coding in this sheet only selects just one specific sheet, how could I modify it to have all of the worksheets (except the criteria sheet where I've posted my data) being subjected to the criteria ?</p>\n\n<p>In addition, it seems if the matching value is in cell A1, the row will not be deleted. Have no idea why is this so.</p>\n\n<p>I've tried using a counter or next ws, but couldn't figured out whats the problem. Greatly appreciate any help!</p>\n\n<pre><code>Sub Delete_with_Autofilter_More_Criteria()\n\nDim rng As Range\nDim cell As Range\nDim CriteriaRng As Range\nDim calcmode As Long\n\n\nWith Application\n    calcmode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\nEnd With\n\n'setting criteria\nWith Sheets(\"Sheet1\")        \n      Set CriteriaRng = .Range(\"A1\", .Cells(Rows.Count, \"A\").End(xlUp))\nEnd With\n\n'Loop through the cells in the Criteria range\nFor Each cell In CriteriaRng\n\n    With Sheets(\"export3\")\n\n        'Firstly, remove the AutoFilter\n        .AutoFilterMode = False\n\n        'Apply the filter\n        .Range(\"A1:A\" &amp; .Rows.Count).AutoFilter Field:=1, Criteria1:=cell.Value\n\n        With .AutoFilter.Range\n            Set rng = Nothing\n            On Error Resume Next\n            Set rng = .Offset(1, 0).Resize(.Rows.Count - 1, 1) _\n                      .SpecialCells(xlCellTypeVisible)\n            On Error GoTo 0\n            If Not rng Is Nothing Then rng.EntireRow.Delete                               \n        End With\n\n        'Remove the AutoFilter\n        .AutoFilterMode = False\n    End With\n\nNext cell\n\nWith Application\n    .ScreenUpdating = True\n    .Calculation = calcmode\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1471409296, "post_id": 38988153, "comment_id": 65328898, "body": "Can you give a couple of examples of URLs?"}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1471410028, "post_id": 38988153, "comment_id": 65329106, "body": "Sure  [link]<a href=\"https://www.google.com.au/search?q=+Bathurst+92+Corporation+Ave+Robin+Hill+NSW+2795\" rel=\"nofollow noreferrer\">google.com.au/&hellip;</a>  [link]<a href=\"https://www.google.com.au/search?q=+Priceline+Mascot\" rel=\"nofollow noreferrer\">google.com.au/search?q=+Priceline+Mascot</a>  [link]<a href=\"https://www.google.com.au/search?q=+Null+Test\" rel=\"nofollow noreferrer\">google.com.au/search?q=+Null+Test</a>  Respectively, they are 1. Good but not perfect address, 2. Useless until put through google address 2. Null checker to ensure it can still run if no address is found."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1471410088, "post_id": 38988153, "comment_id": 65329125, "body": "Sorry about the comment links, I&#39;m new at this."}], "answers": [{"tags": [], "owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "is_accepted": false, "score": 0, "last_activity_date": 1471409276, "creation_date": 1471409276, "answer_id": 38988296, "question_id": 38988153, "link": "https://stackoverflow.com/questions/38988153/nested-loop-in-vba-not-working-because-of-different-for-loops/38988296#38988296", "title": "Nested Loop in VBA not working, because of different for loops?", "body": "<p>There seems to be 2 issues with your code. I have not tried, but looking at your code</p>\n\n<ol>\n<li>Range is defined as cell1, cell2. Cell Address is \"A2\", \"A3\" etc. so in your code you might need to do Range(\"A\" &amp; r) to concatenate the row with the column.</li>\n<li>Even after that you will have an issue. When you Navigate to a URL, You need to wait until the document is loaded. You have to either do some event driven code or loop until the document state is ready or something. Otherwise you will not be able to parse and read the contents of the loaded document. </li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471410393, "post_id": 38988315, "comment_id": 65329224, "body": "Yeah it&#39;s not my best work, no excuses other than I&#39;m new at VBA.  I changed from range to value and that got rid of the errors but now it runs and doesn&#39;t change anything. This seems to be what dgorti is talking about where the macro runs but stop before it can grab the addresses I want."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471412171, "post_id": 38988315, "comment_id": 65329838, "body": "Great it&#39;s working better now, it goes automatically through the list but it is giving me duplicates. It gets the first one right, then the 2nd, then the 3rd one is writes what it wrote in the 2nd, then the 4th and 6th is correct but the 7th and 8th is what the 6th produces.  Would I be correct in saying it isn&#39;t finding the latest address and just writing what it did previously so as to continue the loop?  OR it&#39;s coming across one of the different class names and breaking there?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471412978, "post_id": 38988315, "comment_id": 65330126, "body": "its certainly not due to VBA.  read HTML source of each URL and check if the classes fo conatin same value. Most likely yes, as the URLs you supplied are all from google family.  And read this: <a href=\"http://www.skidmore.edu/~pdwyer/e/eoc/help_vampire.htm\" rel=\"nofollow noreferrer\">skidmore.edu/~pdwyer/e/eoc/help_vampire.htm</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1471411532, "last_edit_date": 1471411532, "creation_date": 1471409402, "answer_id": 38988315, "question_id": 38988153, "link": "https://stackoverflow.com/questions/38988153/nested-loop-in-vba-not-working-because-of-different-for-loops/38988315#38988315", "title": "Nested Loop in VBA not working, because of different for loops?", "body": "<p>No offence, but your code (and coding style) is a mine field.</p>\n\n<p>This part <code>Sheets(\"Sheet1\").Range(r, \"A\").Value</code> will throw error 1004, <code>Range</code> cant take two params as Row and Columns, <code>Cells</code> can. Change it to : <code>Sheets(\"Sheet1\").Cells(r, \"A\").Value</code></p>\n\n<p>Second, if <code>Cells(r, \"A\").Value</code> is blank/empty Navigate will throw error 5. Check for a non empty value before navigating.</p>\n\n<p>Same range issue, error 1004 for <code>Range(r, \"C\").Value</code></p>\n\n<p><strong>Not writing address:</strong> It will not write anything in column C because of your ill constructed inner for loop. When a condition is met, you are jumping out of the loop before writing the value in cells.</p>\n\n<p>Here </p>\n\n<pre><code> If Len(dd) &gt; 0 Then Exit For\n      'Gives a confirmation message and writes the result to a cell\n      ws.Cells(r,\"C\").Value = dd\n</code></pre>\n\n<p>if  length of dd is > 0 it will never reach the statement, <code>ws.Cells(r,\"C\").Value = dd</code></p>\n\n<p>Change it to:</p>\n\n<pre><code> If Len(dd) &gt; 0 Then\n        'Gives a confirmation message and writes the result to a cell\n         ws.Cells(r,\"C\").Value= dd\n        Exit For\n      End If\n</code></pre>\n\n<p><strong>Bonus: Learn and start using <code>F8</code></strong></p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471410815, "post_id": 38988483, "comment_id": 65329377, "body": "Wow this was a good answer. I threw in your recommended changes but it doesn&#39;t write the addresses. My guess is it&#39;s not reading the info in time or something.  Is there a way I can post my workbook?"}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471411111, "post_id": 38988483, "comment_id": 65329473, "body": "If you are not seeing the addresses you probably just need to enable your immediate window.  VIEW &gt; Immediate Window  Or press CTRL + G"}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471411234, "post_id": 38988483, "comment_id": 65329511, "body": "To post a workbook you may need to add it google drive and then paste the link.  I am actually relatively new to stackoverflow so Im not sure if just messaging me would be ok or not but if it is you can and I can look at the workbook for you."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471411665, "post_id": 38988483, "comment_id": 65329654, "body": "Ah yes I can see immediate window now. What it&#39;s doing is listing the Unrefined Addresses one by one and then stopping. Whereas in my old code (where it would work only if I specified the cell number) nothing appears."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471411694, "post_id": 38988483, "comment_id": 65329661, "body": "Ah I wish I could post it but I&#39;m at work and our VPN blocks out Google Drive"}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471412108, "post_id": 38988483, "comment_id": 65329809, "body": "I just pasted my updated code.  I think this will work.  If this answer is what you are looking for feel free to press the arrow on the answer (I am trying to get enough reputation points so I can make comments) I am very happy to help.  Let me know if this works."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471412402, "post_id": 38988483, "comment_id": 65329911, "body": "It works but it&#39;s doing the same error with cyboashus code which mean it MUST be my code. I think it&#39;s getting confused when it comes to the classname for loop where it needs to change between classnames."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471413088, "post_id": 38988483, "comment_id": 65330168, "body": "I think I found the issue, I ran it and it opened a bunch of IE windows with a verification wall. Me thinks Google thinks i&#39;m ddosing them and blocking me out"}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471413201, "post_id": 38988483, "comment_id": 65330205, "body": "Google definitely 100% does not like crawling unless you are given permission.  I had to do something like this before but I actually just grabbed all of the text from the results and then parsed it.  Crawling Google could get your IP in the red."}, {"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471413706, "post_id": 38988483, "comment_id": 65330412, "body": "I may have to get permission with crawls, in your experience did you provide a static IP you&#39;d crawl from or do they accept a range of them? (small team)"}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471414012, "post_id": 38988483, "comment_id": 65330522, "body": "I would always use a Dynamic IP at home.  Basically what I have found is that if you are trying to get google result information it may be better to go directly to the source.  For example addresses might be better pulled from UPS and using their API, or some other site for addresses.  With how risky it is to crawl Google I never do it from company IP addresses only home and I run it very very slow.  <code>Application.Wait now() + timevalue(&quot;00:00:10&quot;)</code>  (wait 10 seconds)  Even then though Google can tell if you are automating them.  The best thing is to try and not give them a reason to check."}], "tags": [], "owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "is_accepted": false, "score": 1, "last_activity_date": 1471412028, "last_edit_date": 1471412028, "creation_date": 1471410374, "answer_id": 38988483, "question_id": 38988153, "link": "https://stackoverflow.com/questions/38988153/nested-loop-in-vba-not-working-because-of-different-for-loops/38988483#38988483", "title": "Nested Loop in VBA not working, because of different for loops?", "body": "<p>One issue that will definitely give you an error is how you are using range.</p>\n\n<p>When using range for your code you would need to use the following:</p>\n\n<p><code>IE.navigate Sheets(\"Sheet1\").Range(\"A\" &amp; r).Value</code></p>\n\n<p>Then of course you would need to print out the same way</p>\n\n<p><code>Range(\"C\" &amp; r).Value = dd</code></p>\n\n<p>now a couple of hints that you can place in your code to make it more efficient,</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n  Dim IE As Object, r as integer\n  Dim wb as Workbook, ws as Worksheet\n  Dim dd as String, c as Variant, found as Boolean\n\n  'Create InternetExplorer Object\n  Set IE = CreateObject(\"InternetExplorer.Application\")\n  'create other objects\n  Set wb = ThisWorkbook\n  Set ws = wb.Worksheets(\"Sheet1\")\n\n\n  ' You can uncoment Next line To see form results\n  IE.Visible = False\n\n  'START LOOP\n  ' URL to get data from\n  For r = 2 To 3\n    debug.print ws.Range(\"A\" &amp; r).Value 'see what the url is\n    IE.navigate ws.Range(\"A\" &amp; r).Value\n    Do while IE.ReadyState &lt;&gt; 4: DoEvents: Loop\n    'page loaded.\n    ' Runs loops to look for the value within the classname, if classname alternates it will change the element, if null it will exit\n    found = false\n    For each c in Array(\"vk_sh vk_bk\", \"_Xbe\")\n      On Error Resume Next\n      dd = IE.document.getElementsByClassName(c)(0).innerText\n      On Error GoTo 0\n      If Len(dd) &gt; 0 Then\n        found = true\n      End If\n      If found Then\n        ws.Range(\"C\" &amp; r).Value = dd\n        dd = \"\"  'need to set to nothing or it will retain the value.\n        Exit For\n      End If\n    Next c\n  Next r\n\n  IE.Quit\n\n'Clean up\nSet IE = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>There are definitely more ways to do what you are after but fix up those 2 things.  If you need more help post your workbook.</p>\n\n<p>Thanks</p>\n\n<p>EDIT:  I made some changes to the above code.  It looks like you may have been exiting your loop too quickly.  I was able to get the URLs you provided to work using this.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "edited": false, "score": 0, "creation_date": 1471413631, "post_id": 38988816, "comment_id": 65330378, "body": "Honestly I wish I could mark everyones answer as the correct one since everyone helped so much but yours worked right off the bat and it works independent of the number of addresses in column A"}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 0, "last_activity_date": 1471412289, "creation_date": 1471412289, "answer_id": 38988816, "question_id": 38988153, "link": "https://stackoverflow.com/questions/38988153/nested-loop-in-vba-not-working-because-of-different-for-loops/38988816#38988816", "title": "Nested Loop in VBA not working, because of different for loops?", "body": "<p>Including the other issues raised in the comments, the below worked for me at run time (i.e. not just while going through with F8)</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim IE      As Object\nDim LngRow  As Long\nDim Wksht   As Worksheet\nDim dd      As String\nDim c       As Variant\n\nOn Error Resume Next\n\nSet Wksht = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n        IE.Visible = False\n        'The below will process the all rows in column A\n        For LngRow = 2 To Wksht.Range(\"A\" &amp; Wksht.Rows.Count).End(xlUp).Row\n            If Wksht.Cells(LngRow, 1) &lt;&gt; \"\" Then\n                IE.Navigate Wksht.Cells(LngRow, 1)\n\n                'This loops waits for IE to be ready\n                Do Until (IE.Document.ReadyState = \"complete\") And (Not IE.busy)\n                    DoEvents\n                Loop\n\n                For Each c In Array(\"vk_sh vk_bk\", \"_Xbe\")\n                    dd = \"\"\n                    dd = IE.Document.getElementsByClassName(c)(0).innerText\n                    If Len(dd) &gt; 0 Then\n                        Wksht.Cells(LngRow, 3) = dd\n                        Exit For\n                    End If\n                Next\n\n            End If\n        Next\n        IE.Quit\n    Set IE = Nothing\nSet Wksht = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 995, "favorite_count": 0, "accepted_answer_id": 38988816, "answer_count": 4, "score": 0, "last_activity_date": 1471412289, "creation_date": 1471408308, "last_edit_date": 1471410427, "question_id": 38988153, "link": "https://stackoverflow.com/questions/38988153/nested-loop-in-vba-not-working-because-of-different-for-loops", "title": "Nested Loop in VBA not working, because of different for loops?", "body": "<p>So I thought I had gotten close to this, the code goes through a column of unrefined addresses, generates a google search url in another, and then pulls the address google has an writes it to the 3rd column.</p>\n\n<p>Before I could only get it to work if I specified the cell location, I want it to work by going down every URL in a column and writing the address one by one.</p>\n\n<p>So i thought \"let's put the getElementsByClassName in another loop\"</p>\n\n<p>Needless to say it doesn't work, I get automation error on the IE.Navigate line.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim IE As Object\n\n' Create InternetExplorer Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\n' You can uncoment Next line To see form results\nIE.Visible = False\n\n'START LOOP\n' URL to get data from\nFor r = 2 To 3\n    IE.navigate Sheets(\"Sheet1\").Cells(r, \"A\").Value\n\n    Do While IE.Busy\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n\n    Dim dd As String, c\n    ' Runs loops to look for the value within the classname, if classname alternates it will change the element, if null it will exit.\n        For Each c In Array(\"vk_sh vk_bk\", \"_Xbe\")\n            On Error Resume Next\n            dd = IE.document.getElementsByClassName(c)(0).innerText\n            On Error GoTo 0\n            If Len(dd) &gt; 0 Then Exit For\n        ' Gives a confirmation message and writes the result to a cell\n        Cells(r, \"C\").Value = dd\n        Next\nNext r\n\n' /LOOP\n\n' Show IE\nIE.Visible = False\n\n' Clean up\nSet IE = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Notes:</p>\n\n<p>From 2 to 3 is correct, the list is pretty long so i want to test it out with just 2 addresses first.</p>\n\n<p>Can someone more proficient in VBA tell me where I am going wrong?</p>\n\n<p>UPDATED: Changed range to cells</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1471408841, "post_id": 38988103, "comment_id": 65328782, "body": "The <code>&#39;</code> that you are seeing is probably not part of the cell contents.  For instance, if you write a formula in cell B1 which says <code>=LEN(A1)</code>, you will undoubtedly find that it says there are 3 characters in cell A1 (i.e. <code>017</code>) rather than 4 (which is what you would get if cell A1 actually contains <code>&#39;017</code>).  The <code>&#39;</code> is just telling Excel to treat the field as a text string rather than as a number.  (It actually becomes annoying if you want a cell to contain <code>&#39;abc&#39;</code> because you have to type in <code>&#39;&#39;abc&#39;</code> instead.)"}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1471412936, "post_id": 38988103, "comment_id": 65330115, "body": "@YowE3K  Do u mean that this problem cannot be fixed and it is reasonable ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1471425432, "post_id": 38988103, "comment_id": 65337006, "body": "I have added an &quot;answer&quot; to give a more detailed explanation."}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471413531, "post_id": 38988172, "comment_id": 65330334, "body": "do u mean I have no need to add <code>cells(i,1)=Cstr(combox1.value)</code>"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471413650, "post_id": 38988172, "comment_id": 65330386, "body": "no need. once u set the cell format to text, what ever you put there after that, is just string/text."}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471414352, "post_id": 38988172, "comment_id": 65330684, "body": "not working . Now all codes :S26 ,S34, S23 ,059 ,023 contains <code>&#39;</code> ."}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471414387, "post_id": 38988172, "comment_id": 65330704, "body": "for my code , only those beginning with <code>0</code>  contain <code>&#39;</code>"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1471408447, "creation_date": 1471408447, "answer_id": 38988172, "question_id": 38988103, "link": "https://stackoverflow.com/questions/38988103/how-to-remove-the-for-cstrcombox1-value/38988172#38988172", "title": "How to remove the &#39; for Cstr(combox1.value)", "body": "<p>convert the cell's number format to <code>Text</code> before setting numeric values. </p>\n\n<pre><code>cells(i,1).NumberFormat = \"@\"\ncells(i,1)=combox1.value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471429313, "post_id": 38992411, "comment_id": 65339670, "body": "i tried .it works . But as it clears the original cell format <code>.HorizontalAlignment = xlCenter</code> is added after <code>Cells(i, 1).Clear</code> . Btw , would you explain more why <code>CStr</code> doesn&#39;t work and what is the difference between <code>CStr</code> and your method . thanks"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471462589, "post_id": 38992411, "comment_id": 65361425, "body": "<code>CStr</code> simply converts values of varying types to a string.  So <code>CStr(4.56)</code> would create a string of <code>4.56</code>.  As the result of your operation was a string of <code>017</code>, I can only assume that <code>combox1.Value</code> is already a string of <code>017</code>.  (If combox1.Value was the number 17, <code>CStr(combox1.Value)</code> would be <code>17</code>.)  So I don&#39;t think the use of CStr is anything to do with the issue you were having."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1471425710, "last_edit_date": 1471425710, "creation_date": 1471424947, "answer_id": 38992411, "question_id": 38988103, "link": "https://stackoverflow.com/questions/38988103/how-to-remove-the-for-cstrcombox1-value/38992411#38992411", "title": "How to remove the &#39; for Cstr(combox1.value)", "body": "<p>The <code>'</code> is probably a formatting character, which is a hangover from Lotus 1-2-3 where we used a leading <code>'</code> to signify left-aligned and a leading <code>\"</code> to signify right-aligned.  (I think I remember that correctly.)</p>\n\n<p>If it is just the formatting character (if it is, it won't be included in the character count returned by LEN) then you can safely just ignore it.</p>\n\n<p>If you want to get rid of it for aesthetic reasons, you will need to delete the current contents of the cell, format the cell as General format, then format the cell as Text format, then insert new values into the cell.</p>\n\n<p>Note: You can't just format the cell as Text, delete the contents, then insert a new value.  The <code>'</code> will still appear in that situation.  The step to change it to General format, if it isn't already in that format, is important!  (Maybe setting it to some other non-Text format will work just as well as setting it to General, but I know that General will work.)</p>\n\n<p>Luckily, a <code>.Clear</code> will delete the contents of the cell <strong>and</strong> set the format back to General, so programatically we can do two things at once.</p>\n\n<p>I therefore believe the following code should do what you want:</p>\n\n<pre><code>    Cells(i, 1).Clear\n    Cells(i, 1).NumberFormat = \"@\"\n    Cells(i, 1).Value = combox1.Value\n</code></pre>\n\n<p>The first line is there simply to get rid of the issue that currently exists.  If you were working with a completely new workbook, it wouldn't be needed.</p>\n"}], "owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 38992411, "answer_count": 2, "score": 0, "last_activity_date": 1471425710, "creation_date": 1471407903, "question_id": 38988103, "link": "https://stackoverflow.com/questions/38988103/how-to-remove-the-for-cstrcombox1-value", "title": "How to remove the &#39; for Cstr(combox1.value)", "body": "<p>I use this to change the combox value in string type and paste on cells.</p>\n\n<pre><code>  cells(i,1)=Cstr(combox1.value)\n</code></pre>\n\n<p>On Excel column A ,I have set the datatype as String .</p>\n\n<p>For example , I input <code>017``123</code> <code>098</code> <code>065</code></p>\n\n<p>However , i find that the exact value put on cells(i,1) is <code>'017</code> <code>'098</code> <code>'056</code> <code>123</code> .\nThe code starting with <code>0</code> contains <code>'</code> at the beginning .</p>\n\n<p><strong>* Any way to improve my code without appearing the <code>'</code> on exact cells ,for those codes starting with <code>0</code>    *</strong></p>\n"}, {"tags": ["string", "excel", "cell", "delimiter", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471411272, "post_id": 38988032, "comment_id": 65329528, "body": "Try th code below, and see if it works for you"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471585369, "post_id": 38988032, "comment_id": 65413548, "body": "have you tried the code in the answers you got here ?"}], "answers": [{"tags": [], "owner": {"reputation": 2388, "user_id": 6481438, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gfYh4.png?s=128&g=1", "display_name": "GCSDC", "link": "https://stackoverflow.com/users/6481438/gcsdc"}, "is_accepted": false, "score": 0, "last_activity_date": 1471409066, "last_edit_date": 1495542783, "creation_date": 1471409066, "answer_id": 38988260, "question_id": 38988032, "link": "https://stackoverflow.com/questions/38988032/how-do-i-split-a-cell-with-multiple-delimiters-in-visual-basic/38988260#38988260", "title": "How do I split a cell with multiple delimiters in visual basic?", "body": "<p><code>Split()</code> returns an array of strings, you need to iterate through this array and assign the value of each element to the corresponding cell (take a look at <a href=\"https://stackoverflow.com/a/30175682/6481438\">this answer</a>).</p>\n\n<p>Also, you don't need to select cells to assign values to it, you may use:</p>\n\n<p><code>Cells(Row,Column).Value = X</code></p>\n\n<p>Regarding 2 delimiters, you may do it as described <a href=\"https://stackoverflow.com/a/7680537/6481438\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1471409983, "creation_date": 1471409983, "answer_id": 38988414, "question_id": 38988032, "link": "https://stackoverflow.com/questions/38988032/how-do-i-split-a-cell-with-multiple-delimiters-in-visual-basic/38988414#38988414", "title": "How do I split a cell with multiple delimiters in visual basic?", "body": "<p>Use the <strong><em>Split</em></strong>, I use an array in the middle just to store the split String (in case you will want to use it later), it also saves me the time of the iteration.</p>\n\n<pre><code>Sub Split_toThree()\n\nDim lrow                As Long\nDim LastRow             As Long\nDim SplitArr()          As String\n\n' find last row in Column A (where you keep your full string)\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor lrow = 2 To LastRow\n    SplitArr() = Split(Cells(lrow, \"a\"), \",\")\n    Range(\"C\" &amp; lrow &amp; \":E\" &amp; lrow) = SplitArr()\nNext lrow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 1289303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1cb603b91bb0caff2c7fafeb6dfd61?s=128&d=identicon&r=PG", "display_name": "Thomas Pladson", "link": "https://stackoverflow.com/users/1289303/thomas-pladson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1899, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1471411224, "creation_date": 1471407351, "last_edit_date": 1531161705, "question_id": 38988032, "link": "https://stackoverflow.com/questions/38988032/how-do-i-split-a-cell-with-multiple-delimiters-in-visual-basic", "title": "How do I split a cell with multiple delimiters in visual basic?", "body": "<p>I want to use VBA to split the contents of a cell into three separate parts, such as [city], [state] [zip code] are put into three different columns on the same row while leaving the original cell unchanged. </p>\n\n<p>I had thought that split would work, but unfortunately I have encountered some complicating issues, first split seems to only carry over the what's on the left, leaving behind the rest, second, I don't see how I can incorporate two delimiters into a single split. </p>\n\n<p>Any idea how to surmount these issues?</p>\n\n<pre><code>    Cells(Row1, ColA).Select\n    Location = ActiveCell.Value\n\n    Cells(Row1, ColC) = Split(Location, \",\")\n\n\n    Cells(Row1, ColA).Select\n    Cells(Row1, ColD) = Split(Location, \" \")\n\n    Cells(Row1, ColA).Select\n    Cells(Row1, ColE) = Split(Location, \" \")\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1471405913, "post_id": 38987809, "comment_id": 65328117, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff866906.aspx\" rel=\"nofollow noreferrer\">Attachment.Size Property (Outlook)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1471406054, "creation_date": 1471406054, "answer_id": 38987852, "question_id": 38987809, "link": "https://stackoverflow.com/questions/38987809/checking-the-size-of-the-attachments/38987852#38987852", "title": "Checking the size of the attachments", "body": "<p>Save the message first (<code>MailItem.Save</code> to make sure the size is updated), sum up the values of all <code>Attachment.Size</code> properties. </p>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 2, "last_activity_date": 1471407010, "creation_date": 1471407010, "answer_id": 38987987, "question_id": 38987809, "link": "https://stackoverflow.com/questions/38987809/checking-the-size-of-the-attachments/38987987#38987987", "title": "Checking the size of the attachments", "body": "<p>You can get the size of a file in Bytes with <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278429.aspx\" rel=\"nofollow\">FileLen</a></p>\n\n<pre><code>Dim totalSize As Long\nFor i = 23 To lRow\n     totalSize = totalSize + FileLen( main.Cells(i, \"O\").Value2 )\nNext i\n</code></pre>\n"}], "owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 38987987, "answer_count": 2, "score": 0, "last_activity_date": 1471407010, "creation_date": 1471405706, "question_id": 38987809, "link": "https://stackoverflow.com/questions/38987809/checking-the-size-of-the-attachments", "title": "Checking the size of the attachments", "body": "<p>So I have a column that is for attachments directory only. It starts from <code>O24:O33</code> and its not all the time that all of the fields are filled out for attachments. I have this code that adds the directories in the outlook mail as attachments. </p>\n\n<pre><code>Dim objmail as Object\nDim attach as object\nDim i as integer, lrow as long\n\nlRow = Cells(Rows.count, 15).End(xlUp).Row\n\nSet objMail = objOutlook.CreateItem(0)\nSet attach = objMail.attachments\n\nFor i = 23 To lRow\n      attach.add main.Range(\"O\" &amp; i).Value\nNext i\n</code></pre>\n\n<p>What I want now is to check the total size of the attachments and if it will be greater than <code>10mb</code>, it will prompt the user that he has reached the maximum size of attachments.  Any help? Thanks.</p>\n"}, {"tags": ["vba", "excel", "udf"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1471414595, "post_id": 38989259, "comment_id": 65330806, "body": "btw, I believe all parameters passed into UDF functions are <code>ByVal</code> regardless of what you declare them as; I&#39;ll have to do a little google-fu to confirm this."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1471414360, "creation_date": 1471414360, "answer_id": 38989259, "question_id": 38987689, "link": "https://stackoverflow.com/questions/38987689/udf-for-cell-values-less-than-x-in-a-column-return-all-values-from-first-colum/38989259#38989259", "title": "UDF: For cell values less than x in a column, return all values from first column", "body": "<p>You could a) hard-code the ID column into the function; b) add a parameter to pass the ID column into the function; c) pass the column header name into the function.</p>\n\n<pre><code>Option Explicit\n\nPublic Function MultiCat2A(ByRef rRng As Excel.Range, _\n                           Optional ByVal sDelim As String = \",\") _\n                         As String\n    Dim c As Long, cRng As Range\n\n    'restrict rRng to the .UsedRange\n    Set rRng = Intersect(rRng, rRng.Parent.UsedRange)\n    'set cRng to another column but equal to rRng\n    Set cRng = Intersect(rRng.EntireRow, rRng.Parent.Columns(\"A\"))\n\n    For c = 1 To rRng.Count\n       If rRng(c).Value &lt; 3 Then\n        MultiCat2A = MultiCat2A &amp; sDelim &amp; cRng(c).Text\n        End If\n    Next c\n\n    MultiCat2A = Mid(MultiCat2A, Len(sDelim) + 1)\n    If CBool(Len(sDelim)) Then\n        Do While Right(MultiCat2A, Len(sDelim)) = sDelim\n            MultiCat2A = Left(MultiCat2A, Len(MultiCat2A) - Len(sDelim))\n        Loop\n    End If\nEnd Function\n\nPublic Function MultiCat2B(ByRef cRng As Range, _\n                           ByRef rRng As Excel.Range, _\n                           Optional ByVal sDelim As String = \",\") _\n                         As String\n    Dim c As Long\n\n    'restrict rRng to the .UsedRange\n    Set rRng = Intersect(rRng, rRng.Parent.UsedRange)\n    'resize cRng to the same as rRng\n    Set cRng = cRng(1, 1).Resize(rRng.Rows.Count, rRng.Columns.Count)\n\n    For c = 1 To rRng.Count\n       If rRng(c).Value &lt; 3 Then\n        MultiCat2B = MultiCat2B &amp; sDelim &amp; cRng(c).Text\n        End If\n    Next c\n\n    MultiCat2B = Mid(MultiCat2B, Len(sDelim) + 1)\n    If CBool(Len(sDelim)) Then\n        Do While Right(MultiCat2B, Len(sDelim)) = sDelim\n            MultiCat2B = Left(MultiCat2B, Len(MultiCat2B) - Len(sDelim))\n        Loop\n    End If\nEnd Function\n\nPublic Function MultiCat2C(ByVal sHdr As String, _\n                           ByRef rRng As Excel.Range, _\n                           Optional ByVal sDelim As String = \",\") _\n                         As String\n    Dim c As Long, cRng As Range\n\n    'restrict rRng to the .UsedRange\n    Set rRng = Intersect(rRng, rRng.Parent.UsedRange)\n    'find the column by header label\n    c = Application.Match(sHdr, rRng.Parent.Rows(1), 0)\n    'offset cRng by its column vs rRng's column\n    Set cRng = rRng(1, 1).Offset(0, c - rRng.Column)\n\n    For c = 1 To rRng.Count\n       If rRng(c).Value &lt; 3 Then\n        MultiCat2C = MultiCat2C &amp; sDelim &amp; cRng(c).Text\n        End If\n    Next c\n\n    MultiCat2C = Mid(MultiCat2C, Len(sDelim) + 1)\n    If CBool(Len(sDelim)) Then\n        Do While Right(MultiCat2C, Len(sDelim)) = sDelim\n            MultiCat2C = Left(MultiCat2C, Len(MultiCat2C) - Len(sDelim))\n        Loop\n    End If\nEnd Function\n</code></pre>\n\n<p>In sample image's G2:G5 as,</p>\n\n<pre><code>=MultiCat2A(B2:B4)\n=MultiCat2B($A2:$A4, B2:B4)\n=MultiCat2C(\"ID\", B2:B4)\n=MultiCat2C($A1, B2:B99)\n</code></pre>\n\n<p>Fill right as necessary.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mFIYo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mFIYo.png\" alt=\"concat_again\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 6724200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89056f8321693ffcbf19fcbbc928d7c9?s=128&d=identicon&r=PG&f=1", "display_name": "Debo44", "link": "https://stackoverflow.com/users/6724200/debo44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 38989259, "answer_count": 1, "score": 1, "last_activity_date": 1471415506, "creation_date": 1471404812, "last_edit_date": 1495539865, "question_id": 38987689, "link": "https://stackoverflow.com/questions/38987689/udf-for-cell-values-less-than-x-in-a-column-return-all-values-from-first-colum", "title": "UDF: For cell values less than x in a column, return all values from first column", "body": "<p>For a data set like the following, I'd like to, if the value in Row 1 equals a specified value, return all ID column values in rows where the cell value in the specified column is less than 3. (No values repeat in the ID column or in Row 1 \"headers\".)</p>\n\n<pre><code>ID  | X | Y | Z    \n123 | 1 | 2 | 5    \n456 | 2 | 6 | 4    \n789 | 6 | 1 | 2  \n</code></pre>\n\n<p>e.g., if a column header = \"X\", return value of \"123, 456\". If Y, \"123, 789\". If Z, \"789\". I've found a variation of a <a href=\"https://stackoverflow.com/a/12588613/6724200\" title=\"&#39;multicat formula&#39;\">\"multicat formula\"</a> (in the edit to the linked answer) that comes close to addressing my needs, but I'm having trouble adapting it. </p>\n\n<pre><code>  Public Function MultiCat2( _\n    ByRef rRng As Excel.Range, _\n    Optional ByVal sDelim As String = \"\") _\n         As String\n Dim rCell As Range\n For Each rCell In rRng\n    If rCell.Value &lt; 3 Then\n     MultiCat2 = MultiCat2 &amp; sDelim &amp; rCell.Text\n     End If\n Next rCell\n MultiCat2 = Mid(MultiCat2, Len(sDelim) + 1)  \n End Function\n</code></pre>\n\n<p>If I run the function as is on X, for example, it returns a value of \"1, 2.\" The result needs to always be from the ID column, regardless of the column being evaluated. That part should be simple, but I can't figure out how to do it without Offset, which doesn't help me, because the evaluated column will be variable. </p>\n\n<p>I have the plain English logic I need: \"If value of cell in a1:d1 = X, MultiCat a1:a4 where cell value in [selected column] is &lt;3.\" I can find the column I'd like to perform the evaluation on using the Match function, and I have the code I think I need to concatenate results in a single cell. </p>\n\n<p>I just can't figure out how to incorporate the result of the Match into the function, or how to get the function to concatenate the ID column.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1471402796, "post_id": 38987368, "comment_id": 65327401, "body": "Does <code>A,B,C;E,F,G</code> represent a string that you want to parse into columns and rows?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1471404174, "post_id": 38987568, "comment_id": 65327732, "body": "Very Nice!  I seen that once before but forgot about it.  Kudos"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1471404337, "post_id": 38987568, "comment_id": 65327777, "body": "@Thomas Inzina I just rather not explain how to add reference to MSForms :] BTW the easier way for me is to add form control to any sheet and delete it"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 2, "last_activity_date": 1471403955, "creation_date": 1471403955, "answer_id": 38987568, "question_id": 38987368, "link": "https://stackoverflow.com/questions/38987368/read-from-a-web-page-and-using-two-determiner-for-new-row-and-next-cell-in-vba-e/38987568#38987568", "title": "Read from a web page and using two determiner for new row and next cell in vba excel", "body": "<pre><code>feed = \"A,B,C;E,F,G;....\"\n\nCSV = Replace( feed, \";\", vbNewLine )\nTSV = Replace( CSV , \",\", vbTab )\n\nSet do = CreateObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\") ' this is a late bound MSForms.DataObject\ndo.SetText TSV\ndo.PutInClipboard\n\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1471403990, "creation_date": 1471403990, "answer_id": 38987573, "question_id": 38987368, "link": "https://stackoverflow.com/questions/38987368/read-from-a-web-page-and-using-two-determiner-for-new-row-and-next-cell-in-vba-e/38987573#38987573", "title": "Read from a web page and using two determiner for new row and next cell in vba excel", "body": "<p><a href=\"https://i.stack.imgur.com/3LFuq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3LFuq.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Test()\n    ParseString1 \"A,B,C;D,E,F;G,H,I,J,K,L\"\n    ParseString2 \"A,B,C;D,E,F;G,H,I,J,K,L\"\n\nEnd Sub\n\nSub ParseString1(data As String)\n    Dim clip As MSForms.DataObject\n    Set clip = New MSForms.DataObject\n\n    data = Replace(data, \",\", vbTab)\n    data = Replace(data, \";\", vbCrLf)\n\n    clip.SetText data\n    clip.PutInClipboard\n\n    Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial\n\nEnd Sub\n\nSub ParseString2(data As String)\n    Dim aColumns, aRows\n    Dim x As Long\n    aRows = Split(data, \";\")\n\n    For x = 0 To UBound(aRows)\n        aColumns = Split(aRows(x), \",\")\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(1, UBound(aColumns) + 1) = aColumns\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>You'll need to set a reference to the Microsoft Forms 2.0 Object Library if you use ParseString1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yZqlt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yZqlt.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 372, "user_id": 4957821, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh4.googleusercontent.com/-41bG14MNoYo/AAAAAAAAAAI/AAAAAAAAD3o/DKnWCIseEAA/photo.jpg?sz=128", "display_name": "yousef yegane", "link": "https://stackoverflow.com/users/4957821/yousef-yegane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1471403990, "creation_date": 1471402473, "last_edit_date": 1531164843, "question_id": 38987368, "link": "https://stackoverflow.com/questions/38987368/read-from-a-web-page-and-using-two-determiner-for-new-row-and-next-cell-in-vba-e", "title": "Read from a web page and using two determiner for new row and next cell in vba excel", "body": "<p>I am looking for a way to read from a feed webpage which its structure is something like</p>\n\n<p>A,B,C;E,F,G;....</p>\n\n<p>I want to read this data and put A B  and C in the first row and put E F and G in row 2, and etc.</p>\n\n<p>I was looking for a function in VBA, but most of them are for only one determiner.</p>\n\n<p>I also was thinking of using string functions of VBA, which that would be the last resort! Since I must read a long string and then use a cursor (which  I don't know if it is like c or not!) that probably leads to unstable performance because first I don't know the volume of data, and second I want to use it in a loop.</p>\n\n<p>Could you please help me with the best solution? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1471402194, "post_id": 38987314, "comment_id": 65327244, "body": "You can&#39;t calculate percent done without knowing a) the total number of items you&#39;re going to process (row count in the database) and b) a counter of the number of rows you&#39;ve finished processing. The second is easy - add a variable that you increment on each pass through the loop. The first is possible only if you can determine how many rows there are before you start the loop - can you do that?"}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1471402625, "post_id": 38987314, "comment_id": 65327350, "body": "@Ken White I don&#39;t know the exact row for each report ,as i use <code>End(xlUp).row</code> to finish the final report in new workbook .Also , i don&#39;t know the row that SQL is going to generate , as well as the time spending on producing and writing a new work bar ."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1471402769, "post_id": 38987314, "comment_id": 65327396, "body": "You do not need to use a progressbar per se as @KenWhite mentioned you can&#39;t calculate the percentage. Having said that. There is an alternative. Let me search my project database. I have a sample and If I find it, I will post it. It involves listbox and a userform"}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471403074, "post_id": 38987314, "comment_id": 65327469, "body": "@Siddharth Rout I tried to use a userform that showing &quot;Please wait one minute` But i find that it need to spend some times on loading the new userform . That makes the whole application much loading time ."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1471403098, "post_id": 38987314, "comment_id": 65327480, "body": "If you don&#39;t know those two things, you can&#39;t display a progress bar that shows percent complete. You could display a marquee style progress bar (the one that just goes back and forth with the little green section but doesn&#39;t show how far along you are); you can probably find an example of doing so in VBA via Google."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471403222, "post_id": 38987314, "comment_id": 65327514, "body": "I am almost done..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1471403331, "post_id": 38987314, "comment_id": 65327541, "body": "Have you tried using CopyFromRecordset to get the data into Excel rather than looping through each record?  (e.g. <code>thisworkbook.worksheets(&quot;report&quot;).Range(&quot;A6&quot;).CopyFromRecord&zwnj;&#8203;set rs</code> (Or is it <code>mrs</code>? You seem to have a typo in your code.)  Then it may only take a second or so, and then you won&#39;t need the progress bar."}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1471403717, "post_id": 38987314, "comment_id": 65327626, "body": "@YowE3K i don&#39;t use <code>CopyFromRecords\u200c\u200bet rs</code> because of some reason that i forgot .Then i choose to use <code>.Cells(j, 1) = rs.Fields(0).Value</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1471404365, "post_id": 38987314, "comment_id": 65327785, "body": "I even like the &quot;marquee style progress bar&quot; suggested by @KenWhite. I have edited my post in include a link to show animated images on the form. There are many possibliities if you want ;)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471404610, "post_id": 38987314, "comment_id": 65327839, "body": "If you are feeling adventurous then more samples of progress bar can be found at <a href=\"http://stackoverflow.com/questions/10782394/pop-up-the-excel-statusbar\">Pop up the Excel Statusbar?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1471405175, "post_id": 38987314, "comment_id": 65327965, "body": "<code>CopyFromRecords\u200c\u200bet</code> does flake out sometimes.  Have you tried using<code>GetRows</code>?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1471405728, "post_id": 38987314, "comment_id": 65328076, "body": "Can you share what is in <code>sSQLSting</code> ? You can probably aggregate the data with PivotTable or Excel formulas to make it much faster."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471409826, "post_id": 38987314, "comment_id": 65329039, "body": "willing to put some effort? You can either display a gif during your operation or just change your mouse pointer (cursor) to a animated gif (ani) during the operation, Read this : <a href=\"http://ashuvba.blogspot.com/2014/10/ajax-style-progress-display-in-vba.html\" rel=\"nofollow noreferrer\">ashuvba.blogspot.com/2014/10/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471407897, "post_id": 38987529, "comment_id": 65328553, "body": "i have added this userform and code .Then ,how to combine with my button ? When button1 is clicked, this userform opens .What is the procedures to combine with my button(run those actions)  ?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471408284, "post_id": 38987529, "comment_id": 65328638, "body": "If <code>Private Sub CommandButton3_Click()</code> launches this userform then in the userform&#39;s activate event, put all the code. Also if required, add <code>DoEvents</code> after every <code>ListBox1.Selected(ListBox1.ListCount - 1) = True</code>"}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471416217, "post_id": 38987529, "comment_id": 65331591, "body": "<code>ListBox1.AddItem &quot;I am performing something in a loop...&quot;     ListBox1.Selected(ListBox1.ListCount - 1) = True</code>  Error 424 Need object"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471416594, "post_id": 38987529, "comment_id": 65331802, "body": "No. you are doing it incorrectly. Put  <code>userform.show</code> in <code>CommandButton3_Clic\u200c\u200bk\u200c\u200b()</code> and the commandbutton&#39;s existing code, move it to the above userform&#39;s activate event"}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471419971, "post_id": 38987529, "comment_id": 65333663, "body": "Now ,i have done the following procedures:1 ) create userform 2) put your code on UserForm_Click 3) add only 1 sentence on my clickbutton : <code>userform.show</code> 4) move all my commandbutton&#39;s existing code to userform&#39;s activate event"}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471420152, "post_id": 38987529, "comment_id": 65333799, "body": "Now , when i press the command button , the userform comes out first . However ,the userform has nothing shown inside .As it freezes ,hangs and  shows <code>no responses </code>on the title . After a while , the userform closes automatically and the report comes out . I don&#39;t know it is hardware problem or what"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471420419, "post_id": 38987529, "comment_id": 65333958, "body": "Did you add <code>DoEvents</code> as I mentioned above?"}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471420882, "post_id": 38987529, "comment_id": 65334253, "body": "@ Siddharth Rout Now i add <code>DoEvents</code> after every <code>ListBox1.Selected(L\u200c\u200bistBox1.ListCount - 1) = True</code>   3 in total"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471420932, "post_id": 38987529, "comment_id": 65334285, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/121129/discussion-between-siddharth-rout-and-evabb\">continue this discussion in chat</a>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471428716, "post_id": 38987529, "comment_id": 65339218, "body": "I knew you were doing something wrong :D. I have updated the above post. See the edit"}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1471430038, "post_id": 38987529, "comment_id": 65340195, "body": "thanks bro , i will try the code tmr .One more question .As i have 5 buttons to generate different kind of reports , the codes inside buttons should be different .In this case , should i create 5 more userforms and put those different codes inside respectively ?Any convenient ways?"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1471428694, "last_edit_date": 1471428694, "creation_date": 1471403646, "answer_id": 38987529, "question_id": 38987314, "link": "https://stackoverflow.com/questions/38987314/how-to-combine-my-vba-working-with-a-progress-bar/38987529#38987529", "title": "How to combine my vba working with a progress bar?", "body": "<p>You do not need to use a progress bar per se as you can't calculate the percentage of work done. In such a case, it is better to let the user know of what you(or the code is doing). You could use <code>Application.StatusBar</code> to update but how many of us actually look down there? Also there's nothing more fancy than a form popping up and updating you about the status... You can also use <a href=\"http://www.vbforums.com/showthread.php?555880-Creating-Splash-Screen-in-MS-Office-2003\" rel=\"nofollow noreferrer\">Animated GIFS</a> on the userform if you want. </p>\n\n<blockquote>\n  <p>I tried to use a userform that showing \"Please wait one minute` But i find that it need to spend some times on loading the new userform . That makes the whole application much loading time</p>\n</blockquote>\n\n<p>Ok You never show progress in the <code>UserForm_Initialize()</code> event of the userform. Show the progress when the process actually starts. If required, move everything to <code>UserForm_Activate()</code> or in a click of a <code>Commandbutton</code>. I am using <code>UserForm_Click()</code> for demonstration purpose.</p>\n\n<p>Let's say we have a userform which looks like below with a <code>Frame</code> and Listbox` control.</p>\n\n<p>Put this code in the userform</p>\n\n<pre><code>Private Sub UserForm_Click()\n    ListBox1.AddItem \"I am performing something in a loop...\"\n    ListBox1.Selected(ListBox1.ListCount - 1) = True\n\n    For i = 1 To 10\n        Wait 3\n    Next i\n\n    ListBox1.AddItem \"I am now writing something to the workbook...\"\n    ListBox1.Selected(ListBox1.ListCount - 1) = True\n\n    Range(\"A1\").Value = \"Sid\"\n\n    ListBox1.AddItem \"I am performing something again in a loop...\"\n    ListBox1.Selected(ListBox1.ListCount - 1) = True\n\n    For i = 1 To 10\n        Wait 3\n    Next i\n\n    '\n    '~~&gt; And So on\n    '\nEnd Sub\n\nPrivate Sub Wait(ByVal nSec As Long)\n    nSec = nSec + Timer\n    While nSec &gt; Timer\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n\n<p><strong>Logic</strong>: </p>\n\n<ol>\n<li>Before starting any process, add the description to the listbox. I have added sample processes and descriptions in the above code. Please amend them to suit your needs.</li>\n<li>Notice the line <code>ListBox1.Selected(ListBox1.ListCount - 1) = True</code>? This will ensure that the recent most entry is always selected. This also ensure that the Listbox scrolls to the latest entry if many things are added to the listbox.</li>\n</ol>\n\n<p><strong>In Action</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ElZak.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ElZak.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>You have misunderstood how it works :) </p>\n\n<ol>\n<li>Add a listbox on the form as shown in the image above.</li>\n<li>Delete all code from the userform and replace it with this code</li>\n</ol>\n\n<p>Now run the code.</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    ListBox1.AddItem \"Generating random numbers...\"\n    ListBox1.Selected(ListBox1.ListCount - 1) = True\n    DoEvents\n\n    For i = 1 To 1000\n        For j = 1 To 1000\n            ThisWorkbook.Sheets(\"content\").Cells(i, j) = Rnd\n        Next\n    Next\n\n    ListBox1.AddItem \"Copying and working with Content sheet...\"\n    ListBox1.Selected(ListBox1.ListCount - 1) = True\n    DoEvents\n\n    Row = ThisWorkbook.Sheets(\"content\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Set wb = Workbooks.Add\n\n    ThisWorkbook.Sheets(\"content\").Copy Before:=wb.Sheets(1)\n\n    wb.Sheets(1).Cells(Row, 1) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"A:A\"))\n    wb.Sheets(1).Cells(Row, 2) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"B:B\"))\n    wb.Sheets(1).Cells(Row, 3) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"C:C\"))\n    wb.Sheets(1).Cells(Row, 4) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"D:D\"))\n    wb.Sheets(1).Cells(Row, 5) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"E:E\"))\n    wb.Sheets(1).Cells(Row, 6) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"F:F\"))\n    wb.Sheets(1).Cells(Row, 7) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"G:G\"))\n    wb.Sheets(1).Cells(Row, 8) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"H:H\"))\n    wb.Sheets(1).Cells(Row, 9) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"I:I\"))\n    wb.Sheets(1).Cells(Row, 10) = Application.WorksheetFunction.Sum(wb.Sheets(1).Range(\"K:K\"))\n\n    ListBox1.AddItem \"Saving File...\"\n    ListBox1.Selected(ListBox1.ListCount - 1) = True\n    DoEvents\n\n    strFileName = \"c:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\Desktop\\\" &amp; ThisWorkbook.Sheets(\"content\").Cells(1, 1) &amp; \".xlsx\"\n\n    wb.SaveAs strFileName\n    ThisWorkbook.Sheets(\"content\").Cells.Clear\n\n    ListBox1.AddItem \"Done!\"\n    ListBox1.Selected(ListBox1.ListCount - 1) = True\n    DoEvents\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1067, "favorite_count": 1, "accepted_answer_id": 38987529, "answer_count": 1, "score": 1, "last_activity_date": 1471428694, "creation_date": 1471401927, "last_edit_date": 1495535361, "question_id": 38987314, "link": "https://stackoverflow.com/questions/38987314/how-to-combine-my-vba-working-with-a-progress-bar", "title": "How to combine my vba working with a progress bar?", "body": "<p>I want to reference to this progress bar sample .\n<a href=\"http://spreadsheetpage.com/index.php/tip/displaying_a_progress_indicator/\" rel=\"nofollow noreferrer\">http://spreadsheetpage.com/index.php/tip/displaying_a_progress_indicator/</a></p>\n\n<p>About my vb working ,I m going to generate a report that using ADO in entire worksheet . As the report generation time is too long (1 min) , I want to implement a progress bar during the report generation .Btw  , the report will be produced in a new excel file .</p>\n\n<pre><code> Private Sub CommandButton3_Click()\n\n\n\n    Dim sSQLQry As String\n    Dim ReturnArray\n\n    Dim Conn As New ADODB.Connection\n    Dim mrs As New ADODB.Recordset\n\n    Dim DBPath As String, sconnect As String\n\n\n\n    DBPath = ThisWorkbook.FullName\n\n\n    sconnect = \"Provider=MSDASQL.1;DSN=Excel Files;DBQ=\" &amp; DBPath &amp; \";HDR=Yes';\"\n    Conn.Open sconnect\n\n   sSQLSting = \"...\"\n\n   Set rs = Conn.Execute(sSQLSting)\n\n   j = 6\n\n    Do While Not rs.EOF\nwith thisworkbook.worksheets(\"report\")\n.Cells(j, 1) = rs.Fields(0).Value\n.Cells(j, 3) = rs.Fields(2).Value\n.Cells(j, 4) = rs.Fields(3).Value\n.Cells(j, 7) = rs.Fields(6).Value\nEnd with \n\n\n j = j + 1\n\n  rs.MoveNext\n\nLoop\n\n\nrs.Close\n\nDim wb As Workbook\n    Set wb = Workbooks.Add\n\n    ThisWorkbook.Sheets(\"report\").Copy Before:=wb.Sheets(1)\n\n...copy Sheets(\"report\") to wb ...\n\nstrFileName = \"c:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\Desktop\\\" &amp; ThisWorkbook.Sheets(\"report\").Cells(1, 1) &amp; \".xlsx\"\n'End With\nwb.SaveAs strFileName\n</code></pre>\n\n<p>I read the progress bar codes . It needs to use the loop variable  <code>PctDone = Counter / (RowMax * ColMax)</code>. For my codes , it includes different works- SQL calculation , pasting on worksheets(\"report\") , coping worksheets(\"report\") to new workbook .Hence , I don't know how to fit my code with this progress bar application .</p>\n\n<p>Reference to \n<a href=\"https://stackoverflow.com/questions/5181164/progress-bar-in-vba-excel/12918056#12918056\">Progress bar in VBA Excel</a></p>\n\n<hr>\n\n<p>If it is impossible to implement progress bar in my case , what can i do tho let the user know \"Be patient to wait about 1 min \"? </p>\n"}, {"tags": ["java", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 41460, "user_id": 2310289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PO7Uz.jpg?s=128&g=1", "display_name": "Scary Wombat", "link": "https://stackoverflow.com/users/2310289/scary-wombat"}, "is_accepted": false, "score": 0, "last_activity_date": 1471400057, "creation_date": 1471400057, "answer_id": 38987102, "question_id": 38987037, "link": "https://stackoverflow.com/questions/38987037/how-do-i-extract-vba-variables-and-arrays-using-java/38987102#38987102", "title": "How do I extract VBA variables and arrays using Java?", "body": "<p>You can use POI to something like</p>\n\n<pre><code>    FormulaEvaluator evaluator = wb.getCreationHelper().createFormulaEvaluator();\n\n    evaluator.clearAllCachedResultValues ();\n\n    CellReference cr = new CellReference(\"B5\"); \n    Cell cell = sh.getRow(cr.getRow()).getCell(cr.getCol());\n\n    evaluator.evaluateFormulaCell(cell);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6724249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f2033ff5f4d491b4c7dd600194b2400?s=128&d=identicon&r=PG&f=1", "display_name": "A House", "link": "https://stackoverflow.com/users/6724249/a-house"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507299333, "creation_date": 1471399447, "last_edit_date": 1531164843, "question_id": 38987037, "link": "https://stackoverflow.com/questions/38987037/how-do-i-extract-vba-variables-and-arrays-using-java", "title": "How do I extract VBA variables and arrays using Java?", "body": "<p>Just starting out using Java, but I have a lot of code in VBA. I'm trying to extract some of the variables and arrays created in VBA so I can use them in Java. </p>\n\n<p>I'm using Apache POI, so I can create a new variable or array by drawing it directly from cells in excel. But is there a way directly extract a variable/value set in VBA? </p>\n\n<p>For example in VBA:</p>\n\n<pre><code>DIM variable1 AS LONG\nvariable1 = Worksheets(\"Sheet1\").Cells(1, 1).Value\n</code></pre>\n\n<p>Is there a way of extracting variable1 into Java or will VBA/excel 'forget' what variable1 was too quickly to be useful if it's not put in a cell?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1471400202, "creation_date": 1471400202, "answer_id": 38987117, "question_id": 38986971, "link": "https://stackoverflow.com/questions/38986971/excel-vba-syntax-for-numeric-wildcard-in-autofilter-criteria/38987117#38987117", "title": "Excel VBA syntax for numeric wildcard in AutoFilter Criteria?", "body": "<p>You can try the following workaround, as long as you have a consistant 8 digit structure, you can check if it's inside the value range of 12340000 and 12349999, like in the line below:</p>\n\n<pre><code>ActiveSheet.UsedRange.AutoFilter Field:=1, Criteria1:=\"&gt;=12340000\", Operator:=xlAnd, Criteria2:=\"&lt;=12349999\"\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6724244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78d78bf773bc56cc7613c1a1ed79d40?s=128&d=identicon&r=PG&f=1", "display_name": "leontief", "link": "https://stackoverflow.com/users/6724244/leontief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 38987117, "answer_count": 1, "score": 2, "last_activity_date": 1471437692, "creation_date": 1471398795, "last_edit_date": 1471437692, "question_id": 38986971, "link": "https://stackoverflow.com/questions/38986971/excel-vba-syntax-for-numeric-wildcard-in-autofilter-criteria", "title": "Excel VBA syntax for numeric wildcard in AutoFilter Criteria?", "body": "<p>Example:</p>\n\n<pre><code>ActiveSheet.UsedRange.AutoFilter Field:=1, Criteria1:=12345678\nActiveSheet.UsedRange.AutoFilter Field:=1, Criteria1:=1234 &amp; \"*\"\nActiveSheet.UsedRange.AutoFilter Field:=1, Criteria1:=Array(12345678, 12345679, 12345670, ...)\n</code></pre>\n\n<p>My sample criteria are eight-digit values beginning with 1234. The first line works, but the second and third lines return a blank sheet. I've tried seemingly countless variations of the latter two lines, none of which have come to fruition. Thanks!</p>\n"}, {"tags": ["vba", "ms-word", "office-interop"], "comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1471444500, "post_id": 38986922, "comment_id": 65350887, "body": "I&#39;m a bit confused. If the user adds a new row to the repeating content control, isn&#39;t he/she supposed to also enter the data? Can you explain what data should appear in the newly added row?"}, {"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1471469750, "post_id": 38986922, "comment_id": 65364977, "body": "@DirkVollmar Thanks for the comment, I can see the confusion, I have updated the image, which will hopefully help? Basically the user adds a new table, the a single contentcontrol to the first cell, then selects the entire table row and makes it a repeating control (hence, the first cell repeats). Then they go into the 2nd cell of the first row and add another single contentcontrol (thinking it will automatically become a repeating item) but it doesn&#39;t, not until that design is activated / de-activated."}, {"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1471482325, "post_id": 38986922, "comment_id": 65368571, "body": "PS - I&#39;ve noticed that one way of doing this is to manually toggle <code>ActiveDocument.ToggleFormsDesign</code>, was wondering if it&#39;s the best way?"}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1471502945, "post_id": 38986922, "comment_id": 65374407, "body": "I wasn&#39;t able to repro. For me, the content control added to the second column also gets repeated in the new row. Maybe this is related to the particular document you are having or the particular Word version you are using."}, {"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1471503174, "post_id": 38986922, "comment_id": 65374525, "body": "The repo steps to try... Open a document that has 2 items within a customxmlpart, add a single row table, with two cells. Within the first column, add a child from the first item of the xmlpart, then select the entire row and add that parent item as a repeating content control. Now select a different child from the item and place it as a content control in the 2nd column. The first column should have two completed rows, the second column should only have the first?? I&#39;m using 2016"}], "answers": [{"tags": [], "owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "is_accepted": true, "score": 1, "last_activity_date": 1471587015, "creation_date": 1471587015, "answer_id": 39032171, "question_id": 38986922, "link": "https://stackoverflow.com/questions/38986922/update-or-refresh-word-contentcontrols/39032171#39032171", "title": "Update or refresh Word ContentControls", "body": "<p>For anyone needing the answer to this:</p>\n\n<p>After 3 days, I've decided that the best way to accomplish this task, is by calling the <code>.ToggleFormsDesign</code> method twice.</p>\n\n<p>This will basically \"refresh / update\" the binding on the repeating ContentControl</p>\n\n<pre><code>        With ActiveDocument\n            .ToggleFormsDesign\n            .ToggleFormsDesign\n        End With\n</code></pre>\n\n<p>Calling this method back to back, will have no UI / visual impact (i.e. the user will not notice anything).</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff195394.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">MSDN Link to the Method</a></p>\n"}], "owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 39032171, "answer_count": 1, "score": 1, "last_activity_date": 1594024498, "creation_date": 1471398330, "last_edit_date": 1594024498, "question_id": 38986922, "link": "https://stackoverflow.com/questions/38986922/update-or-refresh-word-contentcontrols", "title": "Update or refresh Word ContentControls", "body": "<p>I have a scenario whereby I need to (programmatically) add <code>ContextControls</code> to a <code>Word</code> table.</p>\n\n<p>My example is when a user adds a <code>ContentControl</code> to a table (first cell) then adds a repeating <code>ContentControl</code> to that row - this is perfect! </p>\n\n<p>If the user then goes to cell 2 of a 2 cell table (to keep things simple) and adds another <code>ContentControl</code> - keeping in mind this row is already a repeating <code>ContentControl</code> and now just has an additional <code>ContentControl</code> added, the data does not repeat.</p>\n\n<p>If I go into my <code>Word</code> ribbon - Developer, then flick design on and off, the data all appears fine again (almost like the repeating <code>ContentControl</code> was updated / refreshed). I'm wondering - is there a way to do this through code?</p>\n\n<p>Something like repeating ContentControl.Update / Refresh / Reload (none of those exist). </p>\n\n<p>Right now - I'll even accept if I can do this through the <code>Word</code> application itself, but I will be converting this to code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZRgW6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZRgW6.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "taxonomy"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "edited": false, "score": 0, "creation_date": 1471444718, "post_id": 38987303, "comment_id": 65351059, "body": "Thank You for your quick response! But this doesn&#39;t take into account different names for subcategories with the same number but a different above category example: (1) (1) (2) [line break] (2) (1) (2) the 1st line has a main category of (1) lets say its clothing and a subcategory of (1) lets say its socks 2nd line has a main category of (2) lets say its electronics and a subcategory of (1) lets say its speakers The subcategories need to be dependent on the categories to the left of them. How do I do this?"}, {"owner": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "edited": false, "score": 0, "creation_date": 1471447212, "post_id": 38987303, "comment_id": 65352850, "body": "the result of cat3 is dependent on cat2, as would cat2 be on cat1"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1471401824, "creation_date": 1471401824, "answer_id": 38987303, "question_id": 38986726, "link": "https://stackoverflow.com/questions/38986726/excel-vba-category-tree-taxonomy-replace-number-w-its-correct-name-subcategory/38987303#38987303", "title": "excel vba category tree taxonomy replace number w/ its correct name. Subcategory is dependent on previous category", "body": "<p>Your trick here will be to create a kind of category name database. An array of arrays would be simplest but if each category has a different number of items then you might want to look at the <code>Collection</code> object.</p>\n\n<p>It'll also be easier if you read the range into an array, convert the cat numbers into names, and then write the same array back to the range.</p>\n\n<p>I don't want to write your whole project for you, but below is a sample to get you started with just three categories:</p>\n\n<pre><code>Public Sub RunMe()\n    Dim cats As Collection\n    Dim entries As Variant\n    Dim rng As Range\n    Dim cat As Variant\n    Dim r As Long, c As Long\n\n    Set cats = AcquireCategories\n\n    'You'll need to write the range defintion to suit your needs\n    With Selection\n        Set rng = .Worksheet.Cells(.Rows(1).Row, \"S\").Resize(.Rows.Count, 6)\n    End With\n    entries = rng.Value2\n\n    'Loop through the entry values to convert to categories\n    For r = 1 To UBound(entries, 1)\n        For c = 1 To UBound(entries, 2)\n            If Not IsEmpty(entries(r, c)) Then\n                cat = Empty\n                On Error Resume Next\n                cat = cats(CStr(c)).item(CStr(entries(r, c)))\n                On Error GoTo 0\n                If Not IsEmpty(cat) Then\n                    entries(r, c) = cat\n                End If\n            End If\n        Next\n    Next\n\n    rng.Value = entries\nEnd Sub\nPrivate Function AcquireCategories() As Collection\n    Dim cat1 As Collection\n    Dim cat2 As Collection\n    Dim cat3 As Collection\n\n    Set AcquireCategories = New Collection\n\n    Set cat1 = New Collection\n    cat1.Add \"AA\", \"1\"\n    cat1.Add \"BB\", \"2\"\n    cat1.Add \"CC\", \"3\"\n    AcquireCategories.Add cat1, \"1\"\n\n    Set cat2 = New Collection\n    cat2.Add \"DDD\", \"1\"\n    cat2.Add \"EEE\", \"2\"\n    cat2.Add \"FFF\", \"3\"\n    AcquireCategories.Add cat2, \"2\"\n\n    Set cat3 = New Collection\n    cat3.Add \"GGGG\", \"1\"\n    cat3.Add \"HHHH\", \"2\"\n    cat3.Add \"IIII\", \"3\"\n    AcquireCategories.Add cat3, \"3\"\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "is_accepted": false, "score": 0, "last_activity_date": 1471464037, "creation_date": 1471464037, "answer_id": 39005284, "question_id": 38986726, "link": "https://stackoverflow.com/questions/38986726/excel-vba-category-tree-taxonomy-replace-number-w-its-correct-name-subcategory/39005284#39005284", "title": "excel vba category tree taxonomy replace number w/ its correct name. Subcategory is dependent on previous category", "body": "<p>I found a solution<Br>\nI combined the categories with a custom function placing a delimiter between them</p>\n\n<pre><code>Public Function combine(WorkRng As Range, Optional Sign As String = \".\") As String\n'Update 20160817\nDim Rng As Range\nDim OutStr As String\nFor Each Rng In WorkRng\n    If Rng.Text &lt;&gt; \",\" Then\n        OutStr = OutStr &amp; Rng.Text &amp; Sign\n    End If\nNext\nOutStr = Replace(OutStr, Sign &amp; Sign &amp; Sign &amp; Sign, Sign, , , vbTextCompare)\nOutStr = Replace(OutStr, Sign &amp; Sign &amp; Sign, Sign, , , vbTextCompare)\nOutStr = Replace(OutStr, Sign &amp; Sign, Sign, , , vbTextCompare)\n\nOutStr = Left(OutStr, Len(OutStr) - 1)\ncombine = OutStr\nEnd Function\n</code></pre>\n\n<p>Then I replaced each category number with its corresponding name (including delimeter)<br>\nOf course, the procedure was too large so I separated the replacements into multiple custom functions</p>\n\n<pre><code>Public Function Categories_1(p_strText As String) As String\nDim strtemp As String\nstrtemp = p_strText\n\nstrtemp = Replace(strtemp, \"|1.1.1|\", \"MainCat|SubCat1|SubCat2\", , , vbTextCompare)\nCategories_1 = strtemp\nEnd Function\nPublic Function Categories_2(p_strText As String) As String\nDim strtemp As String\nstrtemp = p_strText\n\nstrtemp = Replace(strtemp, \"|2.1.1|\", \"MainCat|SubCat1|SubCat2\", , , vbTextCompare)\nCategories_2 = strtemp\nEnd Function\nPublic Function Categories_3(p_strText As String) As String\nDim strtemp As String\nstrtemp = p_strText\n\nstrtemp = Replace(strtemp, \"|3.1.1|\", \"MainCat|SubCat1|SubCat2\", , , vbTextCompare)\nCategories_3 = strtemp\nEnd Function\n</code></pre>\n\n<p><em>ect.. ect..</em>\nThen I called all of these public functions with a seperate function</p>\n\n<pre><code>Public Function Categories(p_strText As String) As String\nDim strtemp As String\nstrtemp = \"|\" &amp; p_strText &amp; \"|\"\nstrtemp = Categories_1(strtemp)\nstrtemp = Categories_2(strtemp)\nstrtemp = Categories_3(strtemp)\nstrtemp = Categories_4(strtemp)\nstrtemp = Categories_5(strtemp)\nIf strtemp = \"||\" Then strtemp = \"\"\nIf Left(strtemp, 1) = \"|\" Then strtemp = Replace(Mid(strtemp, 2, Len(strtemp) - 2), \".\", \"|\")\nCategories = strtemp\nEnd Function\n</code></pre>\n\n<p>Lastly, I seperated the cell based on the specified delimiter in the name \"|\"\n<BR><strong>SOLUTION FOUND!!!</strong> <em>(he says rubbing his aching forhead that just won a fight with a keyboard)</em></p>\n"}], "owner": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1594151733, "creation_date": 1471396494, "last_edit_date": 1594151733, "question_id": 38986726, "link": "https://stackoverflow.com/questions/38986726/excel-vba-category-tree-taxonomy-replace-number-w-its-correct-name-subcategory", "title": "excel vba category tree taxonomy replace number w/ its correct name. Subcategory is dependent on previous category", "body": "<p>I am attempting to build a macro that replaces the category number with the category name. the category 1 # needs to be replaced by its correlating category 1 name. \nThen for the subcategories (<em>categories 2 - 6)</em> need the # replaced with its names. \nA number \"1\" in <strong>category 2</strong> may translate to the name \"Adults\" if <strong>category 1</strong> in the same row is a \"1\".\nHowever, a number \"1\" in <strong>category 2</strong> that has a \"2\" in <strong>category 1</strong> would not translate to the name \"Adults\".\nThere are 6 levels of categories and not all are necessarily filled.\n<em>must be based on the user selection</em>\n-<em>goto ErrHandlr if user has selected more than 6 columns</em>\n-<em>goto ErrHandlr if user has selected entire column</em></p>\n\n<p>Structure example: \n~<em>() indicates contents of cell</em>\n~<em>the example is a selection of S5-X11 (which changes based on need)</em>\n~<em>(category 1, category 2,... category6)</em></p>\n\n<pre><code>(1) (1) (2) (3) (4) ( )\n(1) (2) (1) (4) ( ) ( )\n(1) (1) (1) (4) (5) (1)\n(1) (2) (2) (1) (4) ( )\n(2) (1) (1) (8) ( ) ( )\n(2) (1) (2) (1) (9) ( )\n(5) (1) (3) (1) (1) ( )\n</code></pre>\n\n<p>Desired output Example :</p>\n\n<pre><code>(Name1) (Name1.1) (Name1.1.2) (Name1.1.2.3) (Name1.1.2.3.4) ()\n(Name1) (Name1.2) (Name1.2.1) (Name1.2.1.4) ()              ()\n(Name1) (Name1.1) (Name1.1.1) (Name1.1.1.4) (Name1.1.1.4.5) (Name1.1.1.4.5.1)\n(Name1) (Name1.2) (Name1.2.2) (Name1.2.2.1) (Name1.2.2.1.4) ()\n(Name2) (Name2.1) (Name2.1.1) (Name2.1.1.8) ()              ()\n(Name2) (Name2.1) (Name2.1.2) (Name2.1.2.1) (Name2.1.2.1.9) ()\n(Name5) (Name5.1) (Name5.1.3) (Name5.1.3.1) (Name5.1.3.1.1) ()\n</code></pre>\n\n<p>This is the code I have so far and I cannot seem to get even the first column right</p>\n\n<pre><code> Public Sub CategoryTest()\n      Dim rng As Range\n      Dim row As Range\n      Dim cell As Range\n      Dim Column As Range\n      Dim i                                            As Long\n      Dim j                                            As Long\n      Dim sValue                                       As String\n      Dim lTotal                                       As Long\n\nSet rng = Selection\n\nOn Error GoTo ErrHandlr\n      Application.EnableCancelKey = xlErrorHandler\n      Application.ScreenUpdating = False\n      Application.DisplayAlerts = True\n      lTotal = Selection.Cells.Count\n        Dim bEntireColumn As Boolean\n        Dim bEntireRow As Boolean\n        With Selection\n            bEntireColumn = .Address = .EntireColumn.Address\n            bEntireRow = .Address = .EntireRow.Address\n        End With\n        If bEntireColumn Then GoTo ErrHandlr\n        If bEntireRow Then GoTo ErrHandlr\n\n\nFor Each cell In rng.Column\n\nIf cell.Value = \"\" Then cell.Value = \"\"\nIf cell.Value = \"1\" Then cell.Value = \"Name1\"\nIf cell.Value = \"2\" Then cell.Value = \"Name2\"\nIf cell.Value = \"3\" Then cell.Value = \"Name3\"\nIf cell.Value = \"4\" Then cell.Value = \"Name4\"\nIf cell.Value = \"5\" Then cell.Value = \"Name5\"\nIf cell.Value = \"6\" Then cell.Value = \"Name6\"\nIf cell.Value = \"7\" Then cell.Value = \"Name7\"\nIf cell.Value = \"8\" Then cell.Value = \"Name8\"\nIf cell.Value = \"9\" Then cell.Value = \"Name9\"\nIf cell.Value = \"10\" Then cell.Value = \"Name10\"\nIf cell.Value = \"11\" Then cell.Value = \"Name11\"\n\nNext cell\nGoTo ExitSub\nErrHandlr:\n      MsgBox \"Sorry, something unexpected when wrong.\" &amp; vbNewLine &amp; _\n             \"Make Sure Entire Row Or Column Is Not Selected\", vbCritical\nExitSub:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6724159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb97ec5217fb21d01e64da447c48272?s=128&d=identicon&r=PG&f=1", "display_name": "ragehulk", "link": "https://stackoverflow.com/users/6724159/ragehulk"}, "edited": false, "score": 0, "creation_date": 1471403563, "post_id": 38987130, "comment_id": 65327591, "body": "This is amazing and works perfectly! Thanks!!! I really need to practice my looping more :)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1471400339, "creation_date": 1471400339, "answer_id": 38987130, "question_id": 38986693, "link": "https://stackoverflow.com/questions/38986693/how-to-copy-different-versions-of-the-same-folder-in-excel-vba/38987130#38987130", "title": "How to copy different versions of the same folder in excel vba?", "body": "<pre><code>Dim strDirVersion as Integer\nIf Dir(strDir, vbDirectory) &lt;&gt; \"\" Then\n    strDirVersion = 1\n    Do While Dir(strDir &amp; \"(\" &amp; strDirVersion &amp; \")\", vbDirectory) &lt;&gt; \"\"\n        strDirVersion = strDirVersion + 1\n    Loop\n    strDir = strDir &amp; \"(\" &amp; strDirVersion &amp; \")\"\nEnd If\n</code></pre>\n\n<p>This will leave strDir with either the initial value, or with a suffix of <code>(n)</code> where <code>n</code> is the first integer (starting with <code>1</code>) that can be found for which a directory doesn't already exist.</p>\n\n<p>Note:  If strDir had a value of <code>abc</code> and directories <code>abc</code>, <code>abc(1)</code> and <code>abc(3)</code> already existed, this would return <code>abc(2)</code>, not <code>abc(4)</code> - i.e. it sees that <code>2</code> is available before it notices that <code>3</code> has been used.</p>\n"}], "owner": {"reputation": 43, "user_id": 6724159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb97ec5217fb21d01e64da447c48272?s=128&d=identicon&r=PG&f=1", "display_name": "ragehulk", "link": "https://stackoverflow.com/users/6724159/ragehulk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 38987130, "answer_count": 1, "score": 1, "last_activity_date": 1471401687, "creation_date": 1471396199, "last_edit_date": 1531164843, "question_id": 38986693, "link": "https://stackoverflow.com/questions/38986693/how-to-copy-different-versions-of-the-same-folder-in-excel-vba", "title": "How to copy different versions of the same folder in excel vba?", "body": "<p>What I want to do is to use Excel to make copies of folders after checking them if it exists. But if it exists, instead of deleting the folder and create a new one (I've already figured out how to do this using the kill/Rmdir/Mkdir functions), I would like to create a new one using the same folder name, but with something like (1), (2) at the end of the folder name to differentiate between them. Also, I would like it to be a loop, so as to obtain a later version if previous versions already exists.</p>\n\n<p>Example:\noriginal folder name abc\nfirst copy (in the same directory abc(1))\nsecond copy (in the same directory abc(2))\n=>I want to do a loop to check each version, and then create a new folder if it doesn't already exists.</p>\n\n<pre><code>    On Error Resume Next\n    Kill strDir &amp; \"*.*\"\n    RmDir strDir\n    On Error GoTo 0\n    If Dir(strDir, vbDirectory) = \"\" Then\n    strDir = Destination &amp; \"\\\" \"\n    MkDir strDir\n    End If\n</code></pre>\n\n<p>This is what I currently have, and I'm using</p>\n\n<pre><code>If Dir(strDir, vbDirectory) = \"\" Then\n</code></pre>\n\n<p>to check if the folder already exists.</p>\n\n<p>Any help on how to do a loop check and create a folder with incremental version names? Thanks in advance!</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "is_accepted": false, "score": 0, "last_activity_date": 1471404846, "last_edit_date": 1495542785, "creation_date": 1471404846, "answer_id": 38987692, "question_id": 38986648, "link": "https://stackoverflow.com/questions/38986648/automatic-method-of-leaving-indexed-value-yes-in-microsoft-access/38987692#38987692", "title": "Automatic method of leaving Indexed value = YES in Microsoft Access?", "body": "<p>This does it:\n<a href=\"https://stackoverflow.com/questions/30720777/change-index-settings-access-vba\">Change Index Settings Access VBA</a></p>\n\n<p>Change it to below if duplicate values are required (removing the UNIQUE keyword):\n<code>CREATE INDEX Index1 ON Cars (ID)</code></p>\n"}], "owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512993077, "creation_date": 1471395856, "last_edit_date": 1512993077, "question_id": 38986648, "link": "https://stackoverflow.com/questions/38986648/automatic-method-of-leaving-indexed-value-yes-in-microsoft-access", "title": "Automatic method of leaving Indexed value = YES in Microsoft Access?", "body": "<p>I'm referencing 1 single table as output from multiple query updates. Is there a way to force this table to always have the Indexed value remaining TRUE for specified fields? The issue is because the table's fields get modified after execution of each type of query and I currently have to click and change the Indexed fields to \"Yes\" before executing the next query.</p>\n\n<p>This Indexed property in Microsoft Access helped resolve my issue with processing power for the thread below:\n<a href=\"https://stackoverflow.com/questions/38983582/exclude-certain-records-with-certain-values-sql-select?noredirect=1#comment65322314_38983795\">Exclude Certain Records with Certain Values SQL Select</a></p>\n"}, {"tags": ["html", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "edited": false, "score": 0, "creation_date": 1471439031, "post_id": 38986752, "comment_id": 65346448, "body": "Works like a charm @Ambie. Thanks so much! It is a curious thing, the way you have to explicitly define each object. But if it works it works!"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 1, "last_activity_date": 1471441836, "last_edit_date": 1471441836, "creation_date": 1471396713, "answer_id": 38986752, "question_id": 38986019, "link": "https://stackoverflow.com/questions/38986019/obtain-internet-explorer-window-properties-pageyoffset-in-excel-vba/38986752#38986752", "title": "Obtain Internet Explorer Window properties (pageYOffset) in excel-VBA", "body": "<p>I have to say, I find the objects and properties in the <code>InternetExplorer</code> object really difficult to manage. Perhaps it's overkill but I find it easier to develop with early binding and define each object explicitly - it's the only way I can find to expose the properties.</p>\n\n<p>If I don't do it this way then I get the type of problem that you have encountered. I don't know why the locals window would show the methods and properties but the code throws an error when I try to access them. Perhaps someone more knowledgeable than me could explain it.</p>\n\n<p>In the meantime, perhaps your code would work if you did define each object explicitly, like so:</p>\n\n<pre><code>'References:\n' - Microsoft Internet Controls\n' - Microsoft HTLM Object Library\n\nDim IEWindow As New InternetExplorer\nDim doc As HTMLDocument\nDim wnd As HTMLWindow2\nDim scrollValue As Long\n\nSet IEWindow = New InternetExplorer\n\nIEWindow.Visible = True\nIEWindow.navigate URL:=\"www.somewebsite.com\", TargetFrameName:=\"_parent\"\nDo Until IE.ReadyState = READYSTATE_COMPLETE\n    DoEvents\nLoop\n\nSet doc = IE.Document\nSet wnd = doc.parentWindow\nscrollValue = wnd.pageYOffset\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13100504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GjQr_WzbMCzvqs9wgac6c513kCHx9UfADW8GtkWwQ=k-s128", "display_name": "em pe", "link": "https://stackoverflow.com/users/13100504/em-pe"}, "is_accepted": false, "score": 0, "last_activity_date": 1584806959, "creation_date": 1584806959, "answer_id": 60790100, "question_id": 38986019, "link": "https://stackoverflow.com/questions/38986019/obtain-internet-explorer-window-properties-pageyoffset-in-excel-vba/60790100#60790100", "title": "Obtain Internet Explorer Window properties (pageYOffset) in excel-VBA", "body": "<p>I came up with an idea to use javascript and unused attribute document.body.title</p>\n\n<pre><code>IE.document.parentWindow.execScript \"document.body.title=document.parentWindow.pageYOffset;\"\nscrollValue = 1 * IE.document.body.title\n</code></pre>\n"}], "owner": {"reputation": 130, "user_id": 6723968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33290e00a38c5abc141d258671c142c6?s=128&d=identicon&r=PG&f=1", "display_name": "TheGuyOverThere", "link": "https://stackoverflow.com/users/6723968/theguyoverthere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 38986752, "answer_count": 2, "score": 0, "last_activity_date": 1584806959, "creation_date": 1471390372, "last_edit_date": 1472564244, "question_id": 38986019, "link": "https://stackoverflow.com/questions/38986019/obtain-internet-explorer-window-properties-pageyoffset-in-excel-vba", "title": "Obtain Internet Explorer Window properties (pageYOffset) in excel-VBA", "body": "<p>I'm trying to return the pageYOffset value from an Internet Explorer window. \nIn my Locals window in the VBA Editor I can clearly see the value but when I try to retrieve it with VBA, I get the Run-time error '438': Object doesn't support this property or method.</p>\n\n<p>Here is a simplified version of my code:</p>\n\n<pre><code>Sub getProperty()    \nDim IEWindow As New InternetExplorer\nDim scrollValue as Long\n\nSet IEWindow = New InternetExplorer\nIEWindow.Visible = True\nIEWindow.navigate \"www.somewebsite.com\", TargetFrameName:=\"_parent\"\nSleep 1000\n\n'Scrolls to very bottom of page (approximate)\nIEWindow.document.parentWindow.Scroll 0, 5000\n\n'Retrieves the exact scroll value\nscrollValue = IEWindow.document.parentWindow.pageYOffset\n\nEnd Sub\n</code></pre>\n\n<p>I've scoured the web looking for answers but nothing VBA related seems to show up which makes me think I'm looking in the wrong places.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1471392046, "creation_date": 1471392046, "answer_id": 38986220, "question_id": 38985797, "link": "https://stackoverflow.com/questions/38985797/creating-cases-in-vba-where-string-equals-different-values/38986220#38986220", "title": "Creating cases in VBA where String equals different values", "body": "<pre><code>Dim dd As String, c\n\nfor each c in Array(\"vk_sh vk_bk\", \"_erg\")\n    on error resume next\n    dd = IE.Document.getElementsByClassName(c)(0).innerText\n    on error goto 0\n    If Len(dd) &gt; 0 Then Exit For\nNext \n\n'do something with dd\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6719798, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7fe7b0a006818dc710c24a7d4563b88?s=128&d=identicon&r=PG&f=1", "display_name": "Tummy Tum", "link": "https://stackoverflow.com/users/6719798/tummy-tum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 38986220, "answer_count": 1, "score": 0, "last_activity_date": 1471392046, "creation_date": 1471388886, "question_id": 38985797, "link": "https://stackoverflow.com/questions/38985797/creating-cases-in-vba-where-string-equals-different-values", "title": "Creating cases in VBA where String equals different values", "body": "<p>so my last question was too broad so I will attack each problem individually.</p>\n\n<p>I modified a macro to search for the address on google maps, unfortunately the class in which the address is contained is different between \"vk_sh vk_bk\" and \"_erg\" (or something like that).</p>\n\n<p>Currently it looks up \"vk_sh vk_bk\" using this:</p>\n\n<pre><code>Dim dd As String\ndd = IE.Document.getElementsByClassName(\"vk_sh vk_bk\")(0).innerText\n</code></pre>\n\n<p>If you search a page where the address is not contained in \"vk_sh vk_bk\" it gets stuck and freezes.</p>\n\n<p>What I'd like to write is a case statement where it goes:</p>\n\n<pre><code>if dd = null\nClassname = \"_erg\"\nif dd = null (again)\nbreak operation\n</code></pre>\n\n<p>So basically if it can't find the class I need it should change the Classname I'm looking for, and if it can't find it AGAIN then it breaks the operation so it won't freeze.</p>\n\n<p>Anyone have any ideas on how I could write this? Some other questions say to declare strings and have it inside a loop, others day different.</p>\n"}, {"tags": ["vba", "excel", "error-handling", "keyboard-events"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 2, "creation_date": 1471387445, "post_id": 38985510, "comment_id": 65323896, "body": "For each &quot;part&quot; and also each &quot;loop&quot; you could pack an <code>DoEvents</code>. This would slow down the macro, but you could still interact. Checking for the actual address and stuff like that (would slow down even more), simply kill the execution if it has been changed. Having events which Restart a new calculation should not be affected... you will notice a delay in getting your &quot;info&quot; but should be able to interact with the application like no code is running..."}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1471387693, "post_id": 38985510, "comment_id": 65323972, "body": "Manual says &quot;DoEvents passes control to the operating system. Control is returned after...&quot;. But I don&#39;t want it to be returned, I want it execution of the sub to stop."}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1471388033, "post_id": 38985510, "comment_id": 65324084, "body": "Manual also says &quot;Any time you temporarily yield the processor within an event procedure, make sure the procedure is not executed again from a different part of your code before the first call returns; this could cause unpredictable results. ...&quot; but I feel the code cannot fulfil this as new selection change events will trigger new execution of the sub"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1471388301, "post_id": 38985510, "comment_id": 65324158, "body": "for this reason check the input like &quot;is the selection the same like when the calculation started?&quot; And if not -&gt; <code>End Sub</code>. Depending on the included subs/functions you may go with a global variable and a private variable for each sub/function. Each time a new cycle of the whole process is started, the global variable is set to processor time. Inside the sub/function set the private variable to the global one and if it is not 0, then check if it is equal to it. If not, a new cycle has been started and thus the old can be killed with <code>Exit Sub&#47;Function</code>"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1471388753, "post_id": 38985510, "comment_id": 65324301, "body": "Like after each <code>DoEvents</code> put <code>If globalVar &lt;&gt; privateVar Then Exit Sub</code>. Even if one sub is executed several times, every instance will have their own private variable. As long as new instances are running, the old ones will be at halt, but after finishing the newest one, all other should terminate itself... if you get my point here ;)"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1471388939, "post_id": 38985510, "comment_id": 65324357, "body": "To my eye the cpu-timer may be the best solution, because going from A1 to A2 and back to A1 may kill the A2 calculation after finishing A1. But the second A1 may be finished too. Still, everything depends on the code you have right now... it may be easy or nearly impossible..."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1471389600, "post_id": 38985510, "comment_id": 65324541, "body": "@Dirk Reichel I swear I saw your comment after I posted my answer xD"}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1471425884, "post_id": 38985510, "comment_id": 65337321, "body": "@DirkReichel Great job and so fast! Many thanks! After having run Chris&#39; code I do no longer worry about the cautions in the manual."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1471391154, "post_id": 38985856, "comment_id": 65324883, "body": "Right idea, but doesn&#39;t work, because the counters get updated on the each call so are always equal"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1471391371, "post_id": 38985856, "comment_id": 65324939, "body": "@chris neilsen even if the counter is in a separate module? maybe a cell can be used to store the count instead"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1471389221, "creation_date": 1471389221, "answer_id": 38985856, "question_id": 38985510, "link": "https://stackoverflow.com/questions/38985510/interrupt-macro-to-process-keystrokes-for-smooth-user-experience/38985856#38985856", "title": "Interrupt macro to process keystrokes for smooth user experience", "body": "<p>Not sure if it will work, but maybe something like this</p>\n\n<pre><code>Dim globalCounter As Long ' 0 by defaul\n\nPrivate Sub Appl_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    globalCounter = globalCounter + 1\n    WriteInfoToStatusbar GetInfoAbout(Target)\nEnd Sub\n\nFunction GetInfoAbout(Target As Range)\n    Dim localCounter As Long \n    localCounter = globalCounter \n    ' .. some code\n    DoEvents\n    If localCounter &lt;&gt; globalCounter Then Exit Function\n    ' .. some code\nEnd Function \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1471426021, "post_id": 38986134, "comment_id": 65337406, "body": "Many thanks, works like a charm and explains it all! Maybe just a tiny bit easier to understand if you now if boolean automatically initiates to false and long to 0, i&#39;ll  try to edit that. Thanks again!"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1471391369, "creation_date": 1471391369, "answer_id": 38986134, "question_id": 38985510, "link": "https://stackoverflow.com/questions/38985510/interrupt-macro-to-process-keystrokes-for-smooth-user-experience/38986134#38986134", "title": "Interrupt macro to process keystrokes for smooth user experience", "body": "<p>As Dirk says, you should use <code>DoEvents</code> to allow excel to process user input, <em>and</em> detect if you long running code is interrupted and if so, cancel the interrupted execution, while allowing the most recent call to complete.</p>\n\n<p>Here's an example to demonstrate (coded in <code>ThisWorkbook</code>)</p>\n\n<pre><code>Option Explicit\n\nDim abort As Boolean\nDim CallCount As Long\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    test Target\nEnd Sub\n\n\nSub test(r As Range)\n    Dim i As Long, n As Long, b As Long\n\n    CallCount = CallCount + 1\n    n = 100\n    ' simulate long running code\n    For i = 1 To n\n        DoEvents\n        If abort Then\n            GoTo AbortSub\n        End If\n        Application.StatusBar = CallCount &amp; \" \" &amp; r.Address &amp; \" \" &amp; i\n    Next\nAbortSub:\n    ' Abort all interrupted calls\n    If CallCount &gt; 1 Then\n        abort = True\n    Else\n        abort = False\n    End If\n    CallCount = CallCount - 1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 38986134, "answer_count": 2, "score": 2, "last_activity_date": 1471391369, "creation_date": 1471386754, "last_edit_date": 1495541315, "question_id": 38985510, "link": "https://stackoverflow.com/questions/38985510/interrupt-macro-to-process-keystrokes-for-smooth-user-experience", "title": "Interrupt macro to process keystrokes for smooth user experience", "body": "<p>I'm working on a macro that displays cell info on the statusbar on each selection change within the excel application. <a href=\"https://stackoverflow.com/questions/38740233/find-the-named-ranges-a-given-cell-belongs-to\">It has grown with the addition of new features thanks to help from members in here.</a> So now sometimes the focus sticks to a cell and I cant move on with the arrow keys to nearby cell before the cell info to be displayed has been calculated. But I do want the selection to move on for a smooth user experience. How should I interrupt the calculation?</p>\n\n<p>It goes something like this in a class module: </p>\n\n<pre><code>Private Sub Appl_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim InfoAboutTarget \n    InfoAboutTarget = GetInfoAbout(Target)\n    WriteInfoToStatusbar(InfoAboutTarget)\nEnd Sub\n</code></pre>\n\n<p>Is any of the following two options any good?</p>\n\n<ol>\n<li>Have an application_onkey event raising an error flag with a user-defined error code and an error handler in the above sub that exits on this particular error</li>\n<li>Measure the time elapsed since the above sub started at interesting points in the code and exit after a time large enough to threaten the user experience?</li>\n</ol>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1471394319, "post_id": 38985396, "comment_id": 65325583, "body": "First step to fixing a code issue - identify what line it&#39;s on (I guess the last posted line). Next step for this error is hover over all of your variables and find the one that is &#39;nothing&#39; (in your code it would be both <code>rs</code> and <code>db</code>, but the issue is with <code>db</code>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1471392302, "creation_date": 1471392302, "answer_id": 38986255, "question_id": 38985396, "link": "https://stackoverflow.com/questions/38985396/vba-sql-statement-run-time-error-91/38986255#38986255", "title": "VBA SQL statement run time error 91", "body": "<p>db is not pointing to anything - you need to assign that to something. </p>\n\n<p>E.g. </p>\n\n<pre><code>Set db = CurrentDb()\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6443397, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f43cad6491614b8646b0e9053845786b?s=128&d=identicon&r=PG&f=1", "display_name": "Miryloth", "link": "https://stackoverflow.com/users/6443397/miryloth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471392302, "creation_date": 1471386076, "question_id": 38985396, "link": "https://stackoverflow.com/questions/38985396/vba-sql-statement-run-time-error-91", "title": "VBA SQL statement run time error 91", "body": "<p>I keep getting run time error 91 object variable or with block variable not set. \nI have rs and strQuery as global variables, this is just a snipet of code not the entire thing. Can someone help me out with troubleshooting this?</p>\n\n<pre><code>Dim strQuery\nGlobal db As DAO.Database\nGlobal rs As DAO.Recordset \nstrQuery = \"SELECT courses.[CourseCode] as CODE, \" &amp; _\n           \"courses.[CourseName] as NAME \" &amp; _\n           \"FROM courses;\"\nSet rs = db.OpenRecordset(strQuery) 'error here \n</code></pre>\n"}, {"tags": ["excel", "tabular", "data-cleaning", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1471387308, "post_id": 38985093, "comment_id": 65323861, "body": "I don&#39;t know of any, but maybe some of the downloads on <a href=\"http://www.cpearson.com/Downloads/Downloads.aspx\" rel=\"nofollow noreferrer\">www.cpearson.com</a> (maybe the <code>zipVBALibrary.zip</code> one). I think that Record Macro and changing the generated code would be easier than learning a library. You can get the &quot;regions&quot; with something like <code>UsedRange.SpecialCells(xlCellTypeConstants).Areas</code>"}, {"owner": {"reputation": 1181, "user_id": 1047635, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8d6e0423415429e3652a5cc573a4f935?s=128&d=identicon&r=PG", "display_name": "matt_black", "link": "https://stackoverflow.com/users/1047635/matt-black"}, "edited": false, "score": 0, "creation_date": 1471463101, "post_id": 38985093, "comment_id": 65361700, "body": "If you know the structure of the data in a specific case it is often just as easy to write your own, specific, VBA code. General code that can handle all possible cases is hard, but the specific code to parse a known structure is often pretty easy. except you have to rewrite it for each different case."}, {"owner": {"reputation": 1027, "user_id": 3412660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9006acce12b3b2e15183fc2c0010e2c?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Lysakowski PhD", "link": "https://stackoverflow.com/users/3412660/rich-lysakowski-phd"}, "edited": false, "score": 0, "creation_date": 1471626867, "post_id": 38985093, "comment_id": 65438591, "body": "Thanks to Slai for the pointer.  I have downloaded the Chip Pearson VBALibrary.zip file and I will examine that.  I have used his code before and it is very well done.  I will post back later to let you know my results."}], "owner": {"reputation": 1027, "user_id": 3412660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9006acce12b3b2e15183fc2c0010e2c?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Lysakowski PhD", "link": "https://stackoverflow.com/users/3412660/rich-lysakowski-phd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 762, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1485550595, "creation_date": 1471384478, "last_edit_date": 1531164843, "question_id": 38985093, "link": "https://stackoverflow.com/questions/38985093/excel-vba-open-source-library-and-api-for-handling-and-cleaning-complex-csv-file", "title": "Excel VBA open source library and API for handling and cleaning complex CSV file content?", "body": "<p>Does anyone know where there is an open source API and library specifically for manipulating and cleaning tabular data with complex formatting within Excel worksheets and workbooks?  </p>\n\n<p>I am building an application for parsing, rearranging, and extracting content from Excel CSV files exported from scientific and financial applications.  The goal is to import the cleaned and \"normalized\" CSV files into SQL Server or Oracle databases, or other Excel applications.  Excel's SQL query tools don't deal with the irregular data very well, since source tables in the CSV tables are not \"normalized\" and the sizes, shapes, and content be very irregular or sparse.  </p>\n\n<p>There can be as many as 10-15 table \"regions\" or sections within a single CSV file or Excel worksheet.  Many rows are blank, some cell contents must be parsed and split into new columns.  There are other issues with the data.  </p>\n\n<p>An Excel VBA library and API focused on Tables, Rows, and Columns operations, would be helpful.  Something with operations for named tables, and Regions (sections), Row and Columns, e.g., find, move, copy, paste, add, and delete columns and rows by their header names.  </p>\n\n<p>Then for Tables or Table Objects, to add Index columns, Sort the table, Select, Copy and Move to other worksheets or Sections, Delete, etc.  </p>\n\n<p>It is taking a while to build it myself because of the quirks of VBA programming.  I looked at C# libraries for handling CSV files, but they don't focus on Tables, Rows, Columns, and Worksheet operations for cleaning up and reformatting data.  Most answers I've found here and in Excel web forums deal with entire CSV files, Excel workbooks, or worksheets, but not worksheets with many irregular tables with different row and column lengths in one worksheet.  I don't want to reinvent a wheel (libary) that's been built thousands of times before.  </p>\n\n<p>There are C# libraries, but I want something in Excel VBA.  </p>\n"}, {"tags": ["vba", "excel", "copy"], "comments": [{"owner": {"reputation": 1500, "user_id": 3207478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kUyY1.png?s=128&g=1", "display_name": "gco", "link": "https://stackoverflow.com/users/3207478/gco"}, "edited": false, "score": 0, "creation_date": 1471383707, "post_id": 38984919, "comment_id": 65322590, "body": "this is a recurring task and specific for other use cases. Did research and found only solutions for one sheet."}], "answers": [{"comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1471384690, "post_id": 38985005, "comment_id": 65322983, "body": "This would work exactly the way he&#39;d like if you added a parameter to <code>Sub CopySheets(intSheet as Integer)</code> and then changed the first array element to <code>intSheet</code> from <code>&quot;Sheet_1&quot;</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1471385400, "post_id": 38985005, "comment_id": 65323248, "body": "@dbmitch - thanks for the suggestion - I&#39;ve edited my answer to pass <b>both</b> sheets as parameters.  (It&#39;s probably more intuitive to any subsequent user of gco&#39;s application if they can look at the calling code and see both sheets being mentioned.)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1471385189, "last_edit_date": 1471385189, "creation_date": 1471384075, "answer_id": 38985005, "question_id": 38984919, "link": "https://stackoverflow.com/questions/38984919/copy-two-specific-sheets-into-a-new-workbook/38985005#38985005", "title": "Copy &quot;two specific sheets&quot; into a new workbook", "body": "<p>You can use:</p>\n\n<pre><code>Sub CopySheets(VariableSheetName As String, ConstantSheetName As String)\n    ThisWorkbook.Sheets(Array(VariableSheetName, _\n                              ConstantSheetName)).Copy\n    Application.Dialogs(xlDialogSaveAs).Show\nEnd Sub\n</code></pre>\n\n<p>Note: Copying both sheets at once has the advantage that any references between the sheets won't suddenly become links to the original workbook, which is what could happen if you copy the sheets one after the other.</p>\n\n<p>This subroutine can be called as:</p>\n\n<pre><code>CopySheets \"sheet_1\", \"sheet_constant\"\nCopySheets \"sheet_2\", \"sheet_constant\"\nCopySheets \"sheet_3\", \"sheet_constant\"\n</code></pre>\n\n<p>or in a loop (assuming your sheets do have numbers in them)</p>\n\n<pre><code>For i = 1 To 3\n    CopySheets \"sheet_\" &amp; i, \"sheet_constant\"\nNext\n</code></pre>\n\n<p>or, if you want all sheets copied:</p>\n\n<pre><code>For Each ws in Worksheets\n    If ws.Name &lt;&gt; \"sheet_constant\" Then\n        CopySheets ws.Name, \"sheet_constant\"\n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1471389201, "post_id": 38985635, "comment_id": 65324437, "body": "The use of <code>i</code> in that code will cause problems unless &quot;sheet_constant&quot; is the last sheet processed in the loop.  You can fix it by using <code>ThisWorkbook.Sheets(Array(ws.Name, &quot;sheet_constant&quot;)).Copy</code>.  (You can probably also fix it by moving the <code>i = i + 1</code> after the label, but there is no need for the <code>i</code> anyway, so it is easier to just get rid of it.)"}], "tags": [], "owner": {"reputation": 1500, "user_id": 3207478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kUyY1.png?s=128&g=1", "display_name": "gco", "link": "https://stackoverflow.com/users/3207478/gco"}, "is_accepted": false, "score": 0, "last_activity_date": 1471389868, "last_edit_date": 1471389868, "creation_date": 1471387765, "answer_id": 38985635, "question_id": 38984919, "link": "https://stackoverflow.com/questions/38984919/copy-two-specific-sheets-into-a-new-workbook/38985635#38985635", "title": "Copy &quot;two specific sheets&quot; into a new workbook", "body": "<p>Based on @YowE3K answer, this one is a little more generic and hase autoSave option.</p>\n\n<pre><code>Sub CopySheets()\n    Dim ws As Worksheet\n    ChDir (ThisWorkbook.Path)\n    For Each ws In ActiveWorkbook.Worksheets\n        If ws.Name = \"sheet_constant\" Then GoTo NextIteration\n        ThisWorkbook.Sheets(Array(ws.Name, \"sheet_constant\")).Copy\n        Application.DisplayAlerts = False\n        Application.ScreenUpdating = False\n        ActiveWorkbook.SaveAs Filename:=ws.Name, FileFormat:=xlNormal, CreateBackup:=False\n        ActiveWorkbook.Saved = True\n        ActiveWindow.Close\n        Application.DisplayAlerts = True\n        Application.ScreenUpdating = True\nNextIteration:\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1500, "user_id": 3207478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kUyY1.png?s=128&g=1", "display_name": "gco", "link": "https://stackoverflow.com/users/3207478/gco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 2, "accepted_answer_id": 38985005, "answer_count": 2, "score": 2, "last_activity_date": 1471393008, "creation_date": 1471383645, "last_edit_date": 1531164843, "question_id": 38984919, "link": "https://stackoverflow.com/questions/38984919/copy-two-specific-sheets-into-a-new-workbook", "title": "Copy &quot;two specific sheets&quot; into a new workbook", "body": "<p>When we have a workbook with several sheets </p>\n\n<pre><code>sheet_1, sheet_2, ..., sheet_n, sheet_constant\n</code></pre>\n\n<p>and we like to create n workbooks with pairs of two sheets</p>\n\n<pre><code>workbook 1: sheet_1, sheet_constant\nworkbook 2: sheet_2, sheet_constant\n...\nworkbook n: sheet_n, sheet_constant\n</code></pre>\n\n<p>how can we do this with vba?</p>\n\n<p>I know we can copy one sheet with this</p>\n\n<pre><code>Sub CopySheet()\n  ThisWorkbook.Sheets(\"sheet_1\").Copy\n  Application.Dialogs(xlDialogSaveAs).Show\nEnd Sub\n</code></pre>\n\n<p>And I tried this with no success</p>\n\n<pre><code>Sub CopySheets()\n  ThisWorkbook.Sheets(\"sheet_1\").Copy\n  ThisWorkbook.Sheets(\"sheet_constant\").Copy\n  Application.Dialogs(xlDialogSaveAs).Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 6723128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6462dee717afee4bd380aea0f1534835?s=128&d=identicon&r=PG&f=1", "display_name": "W.Powell", "link": "https://stackoverflow.com/users/6723128/w-powell"}, "is_accepted": false, "score": 0, "last_activity_date": 1471384756, "creation_date": 1471384756, "answer_id": 38985148, "question_id": 38984888, "link": "https://stackoverflow.com/questions/38984888/how-to-hide-all-drawings-in-excel/38985148#38985148", "title": "How to hide all drawings in Excel?", "body": "<p>Found my own answer. Group all your drawings first. Then just hide the visibility as shown.</p>\n\n<pre><code>ActiveSheet.Shapes.Range(Array(\"Group 7\")).Visible = False \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6723128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6462dee717afee4bd380aea0f1534835?s=128&d=identicon&r=PG&f=1", "display_name": "W.Powell", "link": "https://stackoverflow.com/users/6723128/w-powell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471384756, "creation_date": 1471383511, "last_edit_date": 1531164843, "question_id": 38984888, "link": "https://stackoverflow.com/questions/38984888/how-to-hide-all-drawings-in-excel", "title": "How to hide all drawings in Excel?", "body": "<p>I have a button and I want it to be able to hide all shapes with as few lines as possible. I would prefer not to have to hide each drawing individually. Is this possible?</p>\n"}, {"tags": ["excel", "vbscript", "macros", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6284292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0ac315eb2a3e6465474703b83d37ca?s=128&d=identicon&r=PG&f=1", "display_name": "user6284292", "link": "https://stackoverflow.com/users/6284292/user6284292"}, "edited": false, "score": 0, "creation_date": 1471469912, "post_id": 38989397, "comment_id": 65365048, "body": "Worked as expected..Thanks!"}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 11, "user_id": 6284292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0ac315eb2a3e6465474703b83d37ca?s=128&d=identicon&r=PG&f=1", "display_name": "user6284292", "link": "https://stackoverflow.com/users/6284292/user6284292"}, "edited": false, "score": 0, "creation_date": 1471492243, "post_id": 38989397, "comment_id": 65371020, "body": "glad to hear it.  Feel free to upvote the answer so this question can be closed.  Your upvote will allow me to post comments and help more people in the future."}, {"owner": {"reputation": 11, "user_id": 6284292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0ac315eb2a3e6465474703b83d37ca?s=128&d=identicon&r=PG&f=1", "display_name": "user6284292", "link": "https://stackoverflow.com/users/6284292/user6284292"}, "edited": false, "score": 0, "creation_date": 1471556572, "post_id": 38989397, "comment_id": 65406645, "body": "I tried but cn&#39;t do so, as minimum 15 reputation is required to do so and mine is 1."}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 11, "user_id": 6284292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0ac315eb2a3e6465474703b83d37ca?s=128&d=identicon&r=PG&f=1", "display_name": "user6284292", "link": "https://stackoverflow.com/users/6284292/user6284292"}, "edited": false, "score": 0, "creation_date": 1471564845, "post_id": 38989397, "comment_id": 65409018, "body": "oh I didnt even realize that.  Well thank you so much for trying.  Let me know if you have any other questions."}], "tags": [], "owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "is_accepted": false, "score": 0, "last_activity_date": 1471414911, "creation_date": 1471414911, "answer_id": 38989397, "question_id": 38984882, "link": "https://stackoverflow.com/questions/38984882/how-to-provide-range-in-macro-in-excel-in-below-formula/38989397#38989397", "title": "How to provide range in Macro in Excel in below formula", "body": "<p>Placing this into a FOR loop should work.\nPlease see Revised code below.</p>\n\n<pre><code>Sub CheckCnt()\n    Dim rw as Integer\n\nRange(\"C6\").Value = WorksheetFunction.CountA(Range(\"C1:C5\"))\nFor rw = 1 to 5\n    If Range(\"C\" &amp; rw).Value = \"\" Then\n        Range(\"B\" &amp; rw).Value = WorksheetFunction.Round(Range(\"A\" &amp; rw).Value / Range(\"C6\").Value, 2)\n    Else\n        Range(\"B\" &amp; rw).Value = 0\n    End If\nNext rw\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if this works.  Thanks so much!</p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1471425884, "creation_date": 1471425884, "answer_id": 38992717, "question_id": 38984882, "link": "https://stackoverflow.com/questions/38984882/how-to-provide-range-in-macro-in-excel-in-below-formula/38992717#38992717", "title": "How to provide range in Macro in Excel in below formula", "body": "<p>I'm not sure exactly what formula looking to insert so I've placed the ROUND formula in the range B1:B5.  </p>\n\n<p>B1 will be: <code>=ROUND($A1/$C$6,2)</code><br>\nB2 will be: <code>=ROUND($A2/$C$6,2)</code><br>\nand so on...</p>\n\n<p>This code uses the R1C1 notation:</p>\n\n<pre><code>Sub CheckCnt()\n\n    'Be specific about which sheet you want the result in (otherwise it will appear in the selected sheet).\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        With .Range(\"B1:B5\")\n            .FormulaR1C1 = \"=Round(RC1/R6C3,2)\" 'Use a formula with R1C1 notation.\n            .Value = .Value 'Replace the formula with the result of the formula.\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><code>RC1</code> means this row, column 1.  <code>R6C3</code> means row 6, column 3.<br>\n<a href=\"http://www.numeritas.co.uk/2013/09/the-%E2%80%98dark-art%E2%80%99-of-r1c1-notation/\" rel=\"nofollow\">http://www.numeritas.co.uk/2013/09/the-%E2%80%98dark-art%E2%80%99-of-r1c1-notation/</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6284292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0ac315eb2a3e6465474703b83d37ca?s=128&d=identicon&r=PG&f=1", "display_name": "user6284292", "link": "https://stackoverflow.com/users/6284292/user6284292"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1471425884, "creation_date": 1471383492, "last_edit_date": 1531161705, "question_id": 38984882, "link": "https://stackoverflow.com/questions/38984882/how-to-provide-range-in-macro-in-excel-in-below-formula", "title": "How to provide range in Macro in Excel in below formula", "body": "<p>I have to create a formula where say 3 columns are present <code>A</code>, <code>B</code> &amp; <code>C</code> which has values till say serial 5. So now have to check If value in cell say <code>C1</code> is blank then cell <code>B1</code> would be <code>A1/Count(C)</code>. </p>\n\n<p>I am able to perform this for single cell but how can use below formula for range from <code>A1:A5</code>, <code>B1:B5</code> and <code>C1:C5</code></p>\n\n<pre><code>Sub CheckCnt()\n\nRange(\"C6\") = WorksheetFunction.CountA(Range(\"C1:C5\"))\n\nIf Range(\"C1\") = \"\" Then\n    Range(\"B1\") = WorksheetFunction.Round(Range(\"A1\") / Range(\"C6\"), 2)\nElse\nRange(\"B1\") = 0\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "select"], "comments": [{"owner": {"reputation": 3511, "user_id": 3059517, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/VoWnV.jpg?s=128&g=1", "display_name": "markgiaconia", "link": "https://stackoverflow.com/users/3059517/markgiaconia"}, "edited": false, "score": 0, "creation_date": 1471378429, "post_id": 38983582, "comment_id": 65320125, "body": "how many records are in the storeclients table? Do you have an index on the storid column? 30 minutes seems weird with only 40K records."}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "reply_to_user": {"reputation": 3511, "user_id": 3059517, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/VoWnV.jpg?s=128&g=1", "display_name": "markgiaconia", "link": "https://stackoverflow.com/users/3059517/markgiaconia"}, "edited": false, "score": 0, "creation_date": 1471378669, "post_id": 38983582, "comment_id": 65320262, "body": "42,905 records in the StoreClients table. I currently don&#39;t have an index on the StoreID column"}, {"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "edited": false, "score": 0, "creation_date": 1471379755, "post_id": 38983582, "comment_id": 65320758, "body": "for more meaningful feedback I would post your query or at least relevant parts of your query and potentially some example data and desired result.  That link/solution is for a specific case where storeid can have more than 1 clientid and they want to exclude all storeids that have at least 1 clientid = 5.  Is this the same case you are trying to solve or do you simply not want records with clientid = 5?  Also for performance additional information will be needed.  E.g. Looking at your tags this is in Access Database and you are using VBA in Excel to query it?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1471380303, "post_id": 38983582, "comment_id": 65321031, "body": "Even with no index this shouldn&#39;t take that long. I can write VBA to do the same in a minute or two. Maybe even less."}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1471380896, "post_id": 38983582, "comment_id": 65321325, "body": "I am also doing the exact same case where I want to exclude all storeid records that have at least 1 clientid = 5 regardless of their other clientid values (this means that storeid would have duplicate values), which is what I&#39;m also doing. I am using SQL query statements in Microsoft Access. No excel is being used. I&#39;ll remove the excel tag."}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1471381144, "post_id": 38983582, "comment_id": 65321442, "body": "I&#39;ve updated the StoreID column and ClientID column to include Indexed values (with duplicates) but performance is still the same."}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1471381774, "post_id": 38983582, "comment_id": 65321756, "body": "@Kyle, how would the VBA code be written as you proposed?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1471382019, "post_id": 38983582, "comment_id": 65321874, "body": "House the data in Excel, pull it into an array and construct loops."}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1471382268, "post_id": 38983582, "comment_id": 65321980, "body": "Understood, but is there a way to keep this local to Access by using arrays &amp; loops as mentioned and not using Excel?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1471382902, "post_id": 38983582, "comment_id": 65322246, "body": "I&#39;m not sure, as it&#39;s hard to say what is happening. I quit using Access because it was painfully slow over the network at my place of employment. SQL Server will be much faster if that is available (or was for me). I just did a little test in Excel. With 40,000 rows of data and 2 columns (one with random numbers 1 to 10, the other with random numbers 25 to 50) I can populate a list of all values from column 2, where column 1 is not 5, in .0625 seconds."}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1471383083, "post_id": 38983582, "comment_id": 65322310, "body": "Gotcha. in concluding, I&#39;ve Indexed BOTH tables and SAVED the changes and the processing time has SIGNIFICANTLY improved down to less than a second! Indexing made the difference!"}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1471395648, "post_id": 38983582, "comment_id": 65325854, "body": "In following up, I&#39;m referencing 1 table for multiple query update results. Is there a way to force this table to always have the Indexed value remaining TRUE for specified fields? The issue is because the table&#39;s fields get modified after execution of each query and I currently have to click and change the Indexed fields before executing the next query."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1471381713, "post_id": 38983795, "comment_id": 65321726, "body": "Unfortunately, this query causes Access to become Unresponsive and no display of &quot;Running Query&quot; is shown. It appears it causes Access to crash as a final record for the query result is not shown."}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1471384182, "post_id": 38983795, "comment_id": 65322772, "body": "In concluding, I&#39;ve indexed BOTH tables &amp; the columns of interest and SAVED the changes and the processing time has SIGNIFICANTLY improved down to less than a second! Indexing made the difference as you mentioned, but I&#39;m using the same query that I&#39;ve used from the thread here: <code>SELECT DISTINCT sc.StoreId FROM StoreClients sc WHERE NOT EXISTS(     SELECT * FROM StoreClients sc2      WHERE sc2.StoreId = sc.StoreId AND sc2.ClientId = 5)</code>"}, {"owner": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "reply_to_user": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1471422350, "post_id": 38983795, "comment_id": 65335072, "body": "The query you&#39;ve provided (1) is almost identical to the one I&#39;ve posted (2) only adds the distinct clause in projection (3) has a superfluous <code>*</code> in the <code>NOT EXISTS</code> part."}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1480461330, "post_id": 38983795, "comment_id": 68970152, "body": "Unfortunately this isn&#39;t working as my recordset is over 60,000 records. I&#39;ve attempted using INDEXING and so far it hasn&#39;t worked. Is there another solution or perhaps INDEXING isn&#39;t being used correctly? I created an index using &quot;CREATE INDEX&quot;"}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1480543539, "post_id": 38983795, "comment_id": 69011945, "body": "Through another link, here is a solution that appears to work through initial testing with respect to performance / long hang time: [link] (<a href=\"http://stackoverflow.com/questions/40856980/exclusion-condition-for-sql-ms-access-query\" title=\"exclusion condition for sql ms access query\">stackoverflow.com/questions/40856980/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "is_accepted": true, "score": 1, "last_activity_date": 1471378875, "creation_date": 1471378875, "answer_id": 38983795, "question_id": 38983582, "link": "https://stackoverflow.com/questions/38983582/exclude-certain-records-with-certain-values-sql-select/38983795#38983795", "title": "Exclude Certain Records with Certain Values SQL Select", "body": "<p>You could use <code>EXISTS</code>:</p>\n\n<pre><code>SELECT StoreId\nFROM sc\nWHERE NOT EXISTS (\n  SELECT 1\n  FROM StoreClients cl\n  WHERE sc.StoreId = cl.StoreId\n  AND cl.ClientId = 5\n  )\n</code></pre>\n\n<p>Make sure to create an index on <code>StoreId</code> column. Your query could also benefit from an index on <code>ClientId</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "edited": false, "score": 0, "creation_date": 1471379805, "post_id": 38983866, "comment_id": 65320782, "body": "his tags don&#39;t include sql-server they include ms access which this answer wont hold true for."}, {"owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "edited": false, "score": 0, "creation_date": 1471384017, "post_id": 38983866, "comment_id": 65322708, "body": "In concluding, I&#39;ve indexed BOTH tables &amp; the columns of interest and SAVED the changes and the processing time has SIGNIFICANTLY improved down to less than a second! Indexing made the difference as you mentioned, but I&#39;m using the same query that I&#39;ve used from the thread here: <code>SELECT DISTINCT sc.StoreId FROM StoreClients sc WHERE NOT EXISTS(     SELECT * FROM StoreClients sc2      WHERE sc2.StoreId = sc.StoreId AND sc2.ClientId = 5)</code>"}], "tags": [], "owner": {"reputation": 2258, "user_id": 6168519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e37eef36247051d9b713ebd68468b12?s=128&d=identicon&r=PG&f=1", "display_name": "Sparrow", "link": "https://stackoverflow.com/users/6168519/sparrow"}, "is_accepted": false, "score": 1, "last_activity_date": 1471379157, "creation_date": 1471379157, "answer_id": 38983866, "question_id": 38983582, "link": "https://stackoverflow.com/questions/38983582/exclude-certain-records-with-certain-values-sql-select/38983866#38983866", "title": "Exclude Certain Records with Certain Values SQL Select", "body": "<p>40,000 rows isn't too big for SQL server. The other thread is suggesting some good queries too. If I understand correctly, your problem right now is the performance.\nTo improve the performance, you may need to add a new index to your table, or just update the statistics on your table.</p>\n\n<p>If you are running this query in SQL server management studio for testing and performance tuning, make sure that you are selecting \"Include Actual Execution Plan\". This will make the query to take longer to execute, but the execution plan result can help you on where the time is spent.\nIt usually suggests adding some indexes to improve the performance, which is easy to follow. \nIf adding new indexes are not possible, then you have to spend some time reading on how to understand the execution plan's diagram and finding the slow areas.</p>\n"}], "owner": {"reputation": 131, "user_id": 3935099, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/525b5ce0fe7bcf47cb57494de0f81242?s=128&d=identicon&r=PG&f=1", "display_name": "stitch70", "link": "https://stackoverflow.com/users/3935099/stitch70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "accepted_answer_id": 38983795, "answer_count": 2, "score": 0, "last_activity_date": 1474295730, "creation_date": 1471378089, "last_edit_date": 1495541629, "question_id": 38983582, "link": "https://stackoverflow.com/questions/38983582/exclude-certain-records-with-certain-values-sql-select", "title": "Exclude Certain Records with Certain Values SQL Select", "body": "<p>I've used the solution (by AdaTheDev) from the thread below as it relates to the same question:\n<a href=\"https://stackoverflow.com/questions/15389091/how-to-exclude-records-with-certain-values-in-sql-select\">How to exclude records with certain values in sql select</a></p>\n\n<p>But when applying the same query to over 40,000 records, the query takes too long to process (>30mins). Is there another way that's efficient in querying for certain records with certain values (the same question as in the above stackoverflow thread). I've attempted to use this below and still no luck:</p>\n\n<pre><code> SELECT StoreId\nFROM sc\nWHERE StoreId NOT IN (\n  SELECT StoreId\n  FROM StoreClients\n  Where ClientId=5\n);\n</code></pre>\n\n<p>Thanks --</p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1471380496, "post_id": 38983302, "comment_id": 65321126, "body": "I hope you find an answer. I have tried to do this countless times to no avail. You ultimately need to communicate with the Save As dialog box, or other IE controls that I was never able to get to work."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1471380508, "post_id": 38983302, "comment_id": 65321135, "body": "this is almost asked daily.  Use the search bar, upper right hand corner, and search download, internet, vba"}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1471410637, "creation_date": 1471410637, "answer_id": 38988526, "question_id": 38983302, "link": "https://stackoverflow.com/questions/38983302/how-to-download-a-file-from-internet-explorer-using-vba/38988526#38988526", "title": "How to download a file from internet explorer using VBA", "body": "<p>I am using this code to download the file. You need to change the code as per your language settings. Also you can remove some of the declare function lines which are not required for you.</p>\n\n<pre><code>Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n    Declare PtrSafe Function SetWindowText Lib \"user32\" Alias \"SetWindowTextA\" (ByVal hWnd As Long, ByVal lpString As String) As Long\n    Declare PtrSafe Function SetForegroundWindow Lib \"user32\" (ByVal hWnd As Long) As Long\n    Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n    Declare PtrSafe Function SendMessageByString Lib \"user32\" Alias \"SendMessageA\" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As String) As Long\n    Declare PtrSafe Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\n    Declare PtrSafe Function FindWindowEx Lib \"user32\" Alias \"FindWindowExA\" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long\n    Declare PtrSafe Function GetWindowText Lib \"user32\" Alias \"GetWindowTextA\" (ByVal hWnd As Long, ByVal lpString As String, ByVal cch As Long) As Long\n    Declare PtrSafe Function GetWindowTextLength Lib \"user32\" Alias \"GetWindowTextLengthA\" (ByVal hWnd As Long) As Long\n    Declare PtrSafe Function SetFocus Lib \"user32.dll\" (ByVal hWnd As Long) As Integer\n\n    Sub Site()\n        Dim IE As Object\n        Set IE = CreateObject(\"InternetExplorer.application\")\n        With IE\n            .Visible = True\n            .Navigate \"http://asint010/IntegradorProfit/Pages/Relatorios/FluxoSolicitacao.aspx\"\n\n            While .Busy Or .ReadyState &lt;&gt; 4\n                DoEvents\n            Wend\n\n            .document.All(\"ctl00_ContentPlaceHolder1_btnexportar\").Click\n            While .Busy Or .ReadyState &lt;&gt; 4\n                DoEvents\n            Wend\n\n           'here I don't know what to do\n            hpass = IE.hWnd\n            DownloadFile (hpass)\n\n        End With\n    End Sub\n\n    Sub DownloadFile(h As Long)\n        Dim o As IUIAutomation\n        Dim e As IUIAutomationElement\n        Dim iCnd As IUIAutomationCondition\n        Dim Button As IUIAutomationElement\n        Dim InvokePattern As IUIAutomationInvokePattern\n\n        Set o = New CUIAutomation\n        h = FindWindowEx(h, 0, \"Frame Notification Bar\", vbNullString)\n        If h = 0 Then Exit Sub\n\n        Set e = o.ElementFromHandle(ByVal h)\n        Set iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, \"Save\")\n        Set Button = e.FindFirst(TreeScope_Subtree, iCnd)\n        Set InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\n        InvokePattern.Invoke\n\n        Application.Wait (Now + TimeValue(\"0:00:05\"))\n        Set iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, \"Close\")\n        Set Button = e.FindFirst(TreeScope_Subtree, iCnd)\n        Set InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\n        InvokePattern.Invoke\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6723499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74b8ebde55e13061cec3daaa6fbe77a3?s=128&d=identicon&r=PG&f=1", "display_name": "jpferreira95", "link": "https://stackoverflow.com/users/6723499/jpferreira95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9741, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1609383765, "creation_date": 1471376972, "last_edit_date": 1471380749, "question_id": 38983302, "link": "https://stackoverflow.com/questions/38983302/how-to-download-a-file-from-internet-explorer-using-vba", "title": "How to download a file from internet explorer using VBA", "body": "<p>I am trying to download an excel workbook from Internet Explorer 11 and when I click on the link, this pop up message appears:</p>\n\n<p><img src=\"https://i.stack.imgur.com/LOP5O.png\" alt=\"enter image description here\"></p>\n\n<p>I've tried to use sendkeys \"%s\" and it didn't work. I can't use the code to download a file from the internet without using IE because the URL is an intranet site from my company.</p>\n\n<pre><code>Sub Site()\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    With IE\n        .Visible = True\n        .Navigate \"http://asint010/IntegradorProfit/Pages/Relatorios/FluxoSolicitacao.aspx\"\n\n        While .Busy Or .ReadyState &lt;&gt; 4\n            DoEvents\n        Wend\n\n        .document.All(\"ctl00_ContentPlaceHolder1_btnexportar\").Click\n        While .Busy Or .ReadyState &lt;&gt; 4\n            DoEvents\n        Wend\n\n       'here I don't know what to do\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "xlwings"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471378160, "post_id": 38983144, "comment_id": 65320015, "body": "<code>A Shot In the Dark</code> : I don&#39;t work with python. Just went through the docs.  Try changing <code>PYTHONPATH = &quot;D:\\test0.py&quot;</code> to <code>UDF_PATH = &quot;D:\\test0.py&quot;</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471378361, "post_id": 38983144, "comment_id": 65320093, "body": "Also the name of the <code>.xlsm</code> and <code>.py</code> is the same? (test0.xlsm and test0.py)"}, {"owner": {"reputation": 166, "user_id": 5684890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5fd41cf7d37bcfc13709f157526f47?s=128&d=identicon&r=PG&f=1", "display_name": "Bingjie Han", "link": "https://stackoverflow.com/users/5684890/bingjie-han"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471378862, "post_id": 38983144, "comment_id": 65320348, "body": "@ Siddharth Thank you! .xlsm is the excle file, not the python sript. Btw, UDF_PATH would cause: Compile error: Variables not defined"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471379171, "post_id": 38983144, "comment_id": 65320481, "body": "yes i understood that. But both test0.xlsm and test0.py should be in the same directory else you need to specify a path using <code>UDF_PATH</code>. This is what I understood from the docs... <a href=\"http://docs.xlwings.org/en/stable/udfs.html\" rel=\"nofollow noreferrer\">docs.xlwings.org/en/stable/udfs.html</a> Maybe I am reading the wrong thing? Like I said, I do not work with python :P"}, {"owner": {"reputation": 166, "user_id": 5684890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5fd41cf7d37bcfc13709f157526f47?s=128&d=identicon&r=PG&f=1", "display_name": "Bingjie Han", "link": "https://stackoverflow.com/users/5684890/bingjie-han"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471379246, "post_id": 38983144, "comment_id": 65320515, "body": "Yes, I understand. But in Xlwings  VBA module, Function Settings even doesn&#39;t take UDF_PATH as a parameter, I would guess that UDF_PATH might be a mistake, what real in there should be PYTHONPATH."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471379314, "post_id": 38983144, "comment_id": 65320540, "body": "I guess, I should take a step back and let a python expert help you out :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471379433, "post_id": 38983144, "comment_id": 65320612, "body": "BTW, I have subscribed to your question. I have been thinking for quite long to test waters in python but never got a chance and to be honest, I am now curious as to what the answer to your question might be :)"}, {"owner": {"reputation": 166, "user_id": 5684890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5fd41cf7d37bcfc13709f157526f47?s=128&d=identicon&r=PG&f=1", "display_name": "Bingjie Han", "link": "https://stackoverflow.com/users/5684890/bingjie-han"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471379483, "post_id": 38983144, "comment_id": 65320629, "body": "Anyway, thank you for your help!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1471381950, "post_id": 38983144, "comment_id": 65321845, "body": "(Disclaimer: I&#39;ve never used Python)  Is your path <code>D:\\test0.py</code> (i.e. the file is <code>D:\\test0.py\\test0.py</code>), or is the path <code>D:\\ </code>  (i.e. the file is <code>D:\\test0.py</code>)?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1471383632, "post_id": 38983144, "comment_id": 65322560, "body": "@SiddharthRout - I just read the documentation from the same site you were looking at (I looked at <a href=\"http://docs.xlwings.org/en/stable/vba.html\" rel=\"nofollow noreferrer\">docs.xlwings.org/en/stable/vba.html</a> ) and it is certainly confusing - the examples for <code>UDF_MODULES</code> use <code>UDF_PATH</code> instead!  My <b>guess</b> is that it is meant to be <code>UDF_MODULES</code>, with the path being specified by <code>PYTHONPATH</code>."}, {"owner": {"reputation": 166, "user_id": 5684890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5fd41cf7d37bcfc13709f157526f47?s=128&d=identicon&r=PG&f=1", "display_name": "Bingjie Han", "link": "https://stackoverflow.com/users/5684890/bingjie-han"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1471386620, "post_id": 38983144, "comment_id": 65323666, "body": "@YowE3K - sorry, I just noticed, the path is &#39;&#39;D:\\&#39;&#39;, the file is test0.py. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 5684890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5fd41cf7d37bcfc13709f157526f47?s=128&d=identicon&r=PG&f=1", "display_name": "Bingjie Han", "link": "https://stackoverflow.com/users/5684890/bingjie-han"}, "edited": false, "score": 0, "creation_date": 1471387848, "post_id": 38985158, "comment_id": 65324017, "body": "Thank you! I tried    PYTHONPATH = &quot;D:\\&quot; but got a new error: Run-time error &#39;1000&#39;: python process exited before it was possible to create the interface object."}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "reply_to_user": {"reputation": 166, "user_id": 5684890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5fd41cf7d37bcfc13709f157526f47?s=128&d=identicon&r=PG&f=1", "display_name": "Bingjie Han", "link": "https://stackoverflow.com/users/5684890/bingjie-han"}, "edited": false, "score": 0, "creation_date": 1471389867, "post_id": 38985158, "comment_id": 65324599, "body": "Looks like a small bug. Can you try <code>&quot;D:\\\\&quot;</code>"}, {"owner": {"reputation": 309, "user_id": 7179925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05ab5cb1ac0503f0cb56efd8dcb98e1d?s=128&d=identicon&r=PG&f=1", "display_name": "otterdog2000", "link": "https://stackoverflow.com/users/7179925/otterdog2000"}, "edited": false, "score": 0, "creation_date": 1599961430, "post_id": 38985158, "comment_id": 112937019, "body": "This answer does not work for me. I get the same error as the question states."}], "tags": [], "owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "is_accepted": true, "score": 3, "last_activity_date": 1471384790, "creation_date": 1471384790, "answer_id": 38985158, "question_id": 38983144, "link": "https://stackoverflow.com/questions/38983144/how-to-set-pythonpath-udf-modules/38985158#38985158", "title": "How to set PythonPath/ UDF_Modules?", "body": "<p><code>PYTHONPATH</code>, as the name says, is a path, not a file, i.e. you should be using </p>\n\n<pre><code>PYTHONPATH = \"D:\\\"\n</code></pre>\n\n<p><code>xlwings quickstart myproject</code> is still useful because it sets up the Excel file with the VBA module, even if you want to move out the python file later on.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 12484796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b81edfef9641718cf152322eeb6917?s=128&d=identicon&r=PG&f=1", "display_name": "markthebrewer", "link": "https://stackoverflow.com/users/12484796/markthebrewer"}, "is_accepted": false, "score": 0, "last_activity_date": 1575551281, "creation_date": 1575551281, "answer_id": 59195914, "question_id": 38983144, "link": "https://stackoverflow.com/questions/38983144/how-to-set-pythonpath-udf-modules/59195914#59195914", "title": "How to set PythonPath/ UDF_Modules?", "body": "<p>Yes, I'm new to Python / xlwings, but I hadn't realised how precise I needed to be. Had to set the Interpreter to <code>C:\\Anaconda3\\pythonw.exe</code> and PYTHONPATH to <code>C:\\\\Anaconda3</code> and both the UDFs and RunPython VBA calls started working.</p>\n"}], "owner": {"reputation": 166, "user_id": 5684890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5fd41cf7d37bcfc13709f157526f47?s=128&d=identicon&r=PG&f=1", "display_name": "Bingjie Han", "link": "https://stackoverflow.com/users/5684890/bingjie-han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2916, "favorite_count": 2, "accepted_answer_id": 38985158, "answer_count": 2, "score": 1, "last_activity_date": 1578781811, "creation_date": 1471376353, "last_edit_date": 1578781811, "question_id": 38983144, "link": "https://stackoverflow.com/questions/38983144/how-to-set-pythonpath-udf-modules", "title": "How to set PythonPath/ UDF_Modules?", "body": "<p>I have been trying to build my own Excel functions using Xlwings.</p>\n\n<p>Using </p>\n\n<pre><code>$ xlwings quickstart myproject \n</code></pre>\n\n<p>would create a Python script in the same directory as the Excel xlsm file.</p>\n\n<p>I want to put the Python script anywhere I want, like \"D:\\test0.py\", so I did this on VBA Function Settings:</p>\n\n<pre><code>PYTHONPATH = \"D:\\test0.py\"\nUDF_MODULES = \"test0\"\n</code></pre>\n\n<p>Except for these two lines, I didn't change anything in Function Settings. </p>\n\n<p>I got  </p>\n\n<blockquote>\n  <p>ImportError: No module named 'test0'</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/ZAH7m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZAH7m.png\" alt=\"enter image description here\"></a></p>\n\n<p>How do I import module from \"D:\\test0.py\"?    </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 3, "last_activity_date": 1471376274, "last_edit_date": 1471376274, "creation_date": 1471375471, "answer_id": 38982933, "question_id": 38982785, "link": "https://stackoverflow.com/questions/38982785/i-am-unable-to-get-the-proper-syntax-for-my-goal-seek-routine/38982933#38982933", "title": "I am unable to get the proper syntax for my Goal Seek routine", "body": "<p>You are getting <code>Error '1004': Application-defined or object-defined</code> error because the GoalSeek cell <code>Taddr(i)</code> must contain a formula that refers directly or indirectly to the ChangingCell <code>Aaddr(1)</code></p>\n\n<p>I would recommend stepping through your code and checking if</p>\n\n<ol>\n<li><code>Taddr(i)</code> refers to the cell you think it should refer to</li>\n<li>It contains a formula which directly/indirectly refers to <code>ChangingCell</code></li>\n</ol>\n\n<p>Here is a simple way to reproduce the error</p>\n\n<pre><code>Sub Sample()\n    Range(\"A10\").GoalSeek Goal:=100, ChangingCell:=Range(\"A1\")\nEnd Sub\n</code></pre>\n\n<p>Here <code>A10</code> doesn't have any formula.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kroKG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kroKG.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now let's add a formula to <code>A10</code> referring to <code>A1</code> and run the same code</p>\n\n<p><a href=\"https://i.stack.imgur.com/VGFZf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VGFZf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 115, "user_id": 4777541, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/093930d1a4d1f600bf0f9c738ca866bf?s=128&d=identicon&r=PG&f=1", "display_name": "rtemen", "link": "https://stackoverflow.com/users/4777541/rtemen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552591740, "creation_date": 1471374893, "last_edit_date": 1552591740, "question_id": 38982785, "link": "https://stackoverflow.com/questions/38982785/i-am-unable-to-get-the-proper-syntax-for-my-goal-seek-routine", "title": "I am unable to get the proper syntax for my Goal Seek routine", "body": "<p>Here is my routine.  </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    ' Mass Goal Seek\n\n    Dim Taddr, Gaddr, Aaddr As Range\n    Dim currPart As String\n    Dim MaxParts, prt As Integer\n    Dim ARange, TRange, GRange As Range\n    Dim NumEq, i As Long\n\n    MaxParts = 15\n    For prt = 1 To MaxParts\n        currPart = Worksheets(\"Data Entry\").Range(\"Header\")(prt)\n        Worksheets(\"Item Data\").Range(\"prt_2\").Value = prt\n        Set Taddr = ThisWorkbook.Names(\"TRange\").RefersToRange\n        Set Aaddr = ThisWorkbook.Names(\"ARange\").RefersToRange\n        Set Gaddr = ThisWorkbook.Names(\"GRange\").RefersToRange\n\n        If Worksheets(\"Data Entry\").Range(\"Header\")(prt) Like \"Molding***\" Then\n            Exit Sub\n        End If\n\n        NumEq = Aaddr.Rows.Count\n\n        For i = 1 To NumEq\n            'MsgBox (\"The Part Number is: \" &amp; currPart &amp; \" The Value is: \" &amp; Taddr(i).Value)\n\n            If Gaddr(i).Value &lt;&gt; \"\" Then\n                Taddr(i).GoalSeek goal:=Gaddr(i), changingcell:=Aaddr(1)\n                Gaddr(i).Value = \"\"\n            End If\n        Next i\n    Next\nEnd Sub\n</code></pre>\n\n<p>The line with the goal seek always errors and I have tried many different syntax lines.<br>\nIt gives a</p>\n\n<blockquote>\n  <p>Run-time error '1004': Application-defined or object-defined error.</p>\n</blockquote>\n"}]