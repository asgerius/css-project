[{"tags": ["vba", "api", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11833011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a81b0ff19d2d111d835ea44e005b6c7?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/11833011/scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1564122400, "last_edit_date": 1564122400, "creation_date": 1564014266, "answer_id": 57192775, "question_id": 57192601, "link": "https://stackoverflow.com/questions/57192601/how-do-i-bring-a-newly-created-outlook-email-object-to-the-foreground-vba/57192775#57192775", "title": "How do I bring a newly created Outlook email object to the foreground VBA", "body": "<p>I finally got it. After days and days on this. I commented out</p>\n\n<pre><code>Call AttachThreadInput(CurrentForegroundThreadID, NewForegroundThreadID, False)\n</code></pre>\n\n<p>I wondered why that bit of code was there. It didn't make sense. Ohhhhh WOW huge. Oh and in the section where the call is made I used</p>\n\n<pre><code>Call ShowWindow(MyAppHWnd, SW_SHOWNORMAL)\n</code></pre>\n\n<p>I also had to change how it is received from the initial call from the module and present the result in a message box. It looks like so:</p>\n\n<pre><code>'Call FnSetForegroundWindow(strWindowTitleMine) 'This way does not work\nResult = FnSetForegroundWindow(strWindowTitleMine) 'This line is absolutely necessary\n\nIf Result = True Then\n    MsgBox (\"Success\") 'This line is absolutely necessary\nElse\n    MsgBox (\"Not successful\")  'This line is absolutely necessary\nEnd If\n</code></pre>\n\n<p>Full credit to the person that wrote all the code that does the work. You can view it here <a href=\"https://www.everythingaccess.com/tutorials.asp?ID=Bring-an-external-application-window-to-the-foreground\" rel=\"nofollow noreferrer\">EverythingAccess - Bring an external application window to the foreground</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11833011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a81b0ff19d2d111d835ea44e005b6c7?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/11833011/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564122400, "creation_date": 1564012294, "last_edit_date": 1564122122, "question_id": 57192601, "link": "https://stackoverflow.com/questions/57192601/how-do-i-bring-a-newly-created-outlook-email-object-to-the-foreground-vba", "title": "How do I bring a newly created Outlook email object to the foreground VBA", "body": "<p>When I create a new Outlook email object it does not always come to the front. \nNone of them work consistently. They all stop the taskbar from flashing (which indicates that something has happened) but they never consistently bring it to the foreground.</p>\n\n<p>I have tried:</p>\n\n<pre><code>.Display\nVisible = True\nApplication.ActiveWindow etc\n</code></pre>\n\n<p>API calls such as <code>Private Declare Function SetForegroundWindow Lib \"user32\" (ByVal hwnd As Long) As Long with SW_SHOW,, SW_SHOWNORMAL,, SW_MAXIMIZE</code></p>\n\n<p>This is for Access 2016</p>\n\n<pre><code>Call AttachThreadInput(CurrentForegroundThreadID, NewForegroundThreadID, True)\nlngRetVal = SetForegroundWindow(MyAppHWnd)\nCall AttachThreadInput(CurrentForegroundThreadID, NewForegroundThreadID, False)\n\nIf lngRetVal &lt;&gt; 0 Then\n\n    '''Now that the window is active, let's restore it from the taskbar\n    If IsIconic(MyAppHWnd) Then\n        MsgBox (1)\n    Else\n        Call ShowWindow(MyAppHWnd, SW_SHOWNORMAL)\n        MsgBox (2)\n    End If\n</code></pre>\n\n<p>It always runs the <code>Else</code> part of the code, i.e. Message Box 2. I don't receive any error messages from other parts of the code either.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1564013182, "post_id": 57192536, "comment_id": 100894647, "body": "So you are wanting to run <code>MySub_&lt;...&gt;</code> when interacting with these toggle buttons and combo boxes as well? Your first paragraph is nothing but fluff and provides no information, the 2nd one looked promising when you said <i>&quot;Here is the straightforward kind of thing I&#39;m looking for...&quot;</i> but then describes how the code below works and didn&#39;t describe anything about what you actually needed, and the 3rd is your thoughts, outloud. Can you please describe what you are actually needing to happen? See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1564069107, "post_id": 57192536, "comment_id": 100918223, "body": "K. Davis, Let me address your points one by one: &quot;So you are wanting to run MySub_&lt;...&gt; when interacting with these toggle buttons and combo boxes as well?&quot; Not sure what you mean by &quot;as well&quot;, because what would be the point of a control that doesn&#39;t do anything? &quot;Your first paragraph is nothing but fluff and provides no information&quot; It provides a lot of information to the potential answerer: 1) Don&#39;t point me to another SO answer; 2) Advise for a worksheet and not for a form; 3) If it takes you 50 LOC to solve this, it probably isn&#39;t what I&#39;m looking for."}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1564069538, "post_id": 57192536, "comment_id": 100918472, "body": "&quot;didn&#39;t describe anything about what you actually needed&quot; Yes, I absolutely did. The 2nd paragraph states: &quot;but I need it for ToggleButton and ComboBox&quot;. &quot;the 3rd is your thoughts, outloud&quot; I&#39;m providing helpful context around the provided code to explain more precisely what I am trying to accomplish. Thank you for the link, but I think the way I posted my question is straightforward, concise, and helpfully documents the effort I put into resolving things myself."}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "edited": false, "score": 0, "creation_date": 1564068716, "post_id": 57192995, "comment_id": 100918006, "body": "Gro, thanks for your answer. It clears the hurdle of setting btn to the object, but when I add the line <code>btn.OnAction = &quot;MySub&quot;</code>, I get: &quot;Run-time error &#39;1004&#39;: Unable to set the OnAction property of the OLEObject class&quot;."}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "edited": false, "score": 0, "creation_date": 1564071727, "post_id": 57192995, "comment_id": 100919528, "body": "Actually, <code>btn.OnAction</code> makes less sense for a CheckBox than a CommandButton, although I&#39;m not sure how to event-handle the CheckBox or even get its value. None of the OLE properties or actions seem to address either of these needs. What am I missing?"}], "tags": [], "owner": {"reputation": 1325, "user_id": 2292264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e93c8491e067073e4fcd5c33ad1eac8?s=128&d=identicon&r=PG", "display_name": "Gro", "link": "https://stackoverflow.com/users/2292264/gro"}, "is_accepted": false, "score": 1, "last_activity_date": 1564016819, "creation_date": 1564016819, "answer_id": 57192995, "question_id": 57192536, "link": "https://stackoverflow.com/questions/57192536/how-to-assign-a-reference-to-a-dynamically-created-object-using-excel-vba/57192995#57192995", "title": "How to assign a reference to a dynamically created object using Excel VBA", "body": "<p>Activex controls are OLEObjects. I have shown how to add checkbox below.</p>\n\n<pre><code>Sub AddButtons()\n    Dim ws As Worksheet\n    Dim btn As OLEObject\n    Debug.Print (\"Start\")\n    For Each ws In ThisWorkbook.Worksheets\n        Set btn = ws.OLEObjects.Add(ClassType:=\"Forms.CheckBox.1\", Link:=True, _\n        DisplayAsIcon:=False, left:=10, top:=10, width:=20, _\n        height:=20)\n        Debug.Print (ws.Name)\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1564016819, "creation_date": 1564011639, "question_id": 57192536, "link": "https://stackoverflow.com/questions/57192536/how-to-assign-a-reference-to-a-dynamically-created-object-using-excel-vba", "title": "How to assign a reference to a dynamically created object using Excel VBA", "body": "<p>There are some answers to similar questions, but none of them work for me. Most of them are geared towards Forms whereas I am trying to add objects directly onto Excel worksheets. Beyond that, nearly all are incredibly complicated solutions for something that should not be so difficult.</p>\n\n<p>Here is the straightforward kind of thing I'm looking for - but I need it for ToggleButton and ComboBox. The code below works for CommandButton but it seems to have no analog for the other ActiveX object types, so far as I could tell.</p>\n\n<pre><code>Sub AddButtons()\n    Dim ws As Excel.Worksheet\n    Dim btn As Button\n\n    For Each ws In ThisWorkbook.Worksheets\n        Set btn = ws.Buttons.Add(10, 20, 30, 40)\n        Debug.Print ws.Name\n        ' MySub_[worksheet name] will be executed when btn is clicked\n        btn.OnAction = \"MySub_\" &amp; ws.Name\n        btn.Caption = ws.Name\n        ' Set additional btn properties as needed\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>(I'm not actually trying to create an object for each worksheet, but this example shows how one can loop through some construct and tether customized code to the object created within each iteration.)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["mysql", "sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5850953, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-EUbajbqRPxo/AAAAAAAAAAI/AAAAAAAAACQ/tQmCO5l0Y5w/photo.jpg?sz=128", "display_name": "Awais Sheikh", "link": "https://stackoverflow.com/users/5850953/awais-sheikh"}, "edited": false, "score": 0, "creation_date": 1564046643, "post_id": 57192374, "comment_id": 100905406, "body": "Hi, Thanks for your reply but my original question is that I cannot get newly created record from the query mentioned above. This query runs just &quot;after insert&quot; event,"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 23, "user_id": 5850953, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-EUbajbqRPxo/AAAAAAAAAAI/AAAAAAAAACQ/tQmCO5l0Y5w/photo.jpg?sz=128", "display_name": "Awais Sheikh", "link": "https://stackoverflow.com/users/5850953/awais-sheikh"}, "edited": false, "score": 0, "creation_date": 1564051951, "post_id": 57192374, "comment_id": 100908421, "body": "@AwaisSheikh: Show more code! You create records in<code>tblcategories1</code>before and can&#39;t access them in select part of insert query?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1564077651, "post_id": 57192374, "comment_id": 100922095, "body": "Well, your query syntax should have failed regardless. If saving record is issue then edit question to show code related to saving record. I don&#39;t use macros, not even Data Macros. If you are going to use any VBA, why bother with macros?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1564081027, "post_id": 57192374, "comment_id": 100923565, "body": "@June7: OP wants to sync mysql-tables to access-tables on access-table level (data-macros). But of course his sql fails, but he doesn&#39;t notice, because of<code>SetWarings False</code>(Ignorance is bliss;)"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564085327, "post_id": 57192374, "comment_id": 100925332, "body": "Yes, I understand that. Let&#39;s hope OP does now."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1564009991, "creation_date": 1564009991, "answer_id": 57192374, "question_id": 57192143, "link": "https://stackoverflow.com/questions/57192143/ms-access-after-macro-cannot-insert-newly-created-record-in-linked-table/57192374#57192374", "title": "MS access after macro cannot insert newly created record in Linked table", "body": "<p>Don't enclose object names in apostrophes, use brackets [ ].  </p>\n\n<pre><code>SQLQUERY = \"Insert Into tblcategories1 select * from tblcategories where [Category ID] not in (select [Category ID] from tblcategories1) \"\nDoCmd.SetWarnings False\nDoCmd.RunSQL SQLQUERY\nDoCmd.SetWarnings True\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5850953, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-EUbajbqRPxo/AAAAAAAAAAI/AAAAAAAAACQ/tQmCO5l0Y5w/photo.jpg?sz=128", "display_name": "Awais Sheikh", "link": "https://stackoverflow.com/users/5850953/awais-sheikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594635366, "creation_date": 1564008083, "last_edit_date": 1594635366, "question_id": 57192143, "link": "https://stackoverflow.com/questions/57192143/ms-access-after-macro-cannot-insert-newly-created-record-in-linked-table", "title": "MS access after macro cannot insert newly created record in Linked table", "body": "<p>I have two tables in MS access. An access local table and mysql linked table.\nBoth tables have same fields. I have set up after insert macro on access local table to sync linked table through a VBA script.</p>\n\n<p>But the newly created record is not inserted into linked table.\nIt refresh previous records but new record in not inserted into linked table.\nPlease find my VBA function which is called using setlocalvar event afterinsert macro .\nIs there any way to sync linked table with local table in access ?\nThanks</p>\n\n<pre><code>Public Function Synccategory() As String\n  SQLQUERY = \"Insert Into tblcategories1 select * from tblcategories where `Category ID` not in (select `Category ID` from tblcategories1) \"\n  DoCmd.SetWarnings False\n  DoCmd.RunSQL SQLQUERY\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564008590, "post_id": 57192071, "comment_id": 100893823, "body": "<a href=\"https://stackoverflow.com/questions/21165581/vba-looping-through-all-series-within-all-charts\" title=\"vba looping through all series within all charts\">stackoverflow.com/questions/21165581/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/46575647/vba-code-to-change-fill-color-of-series-on-chart\" title=\"vba code to change fill color of series on chart\">stackoverflow.com/questions/46575647/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 4990822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4bq_Jbmb3qY/AAAAAAAAAAI/AAAAAAAAAG0/IU9EJ0sGjDE/photo.jpg?sz=128", "display_name": "HAWK", "link": "https://stackoverflow.com/users/4990822/hawk"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564078091, "post_id": 57192071, "comment_id": 100922284, "body": "Thanks very much Tim -- was able to use those to make this work. Appreciate the direction!"}], "owner": {"reputation": 33, "user_id": 4990822, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4bq_Jbmb3qY/AAAAAAAAAAI/AAAAAAAAAG0/IU9EJ0sGjDE/photo.jpg?sz=128", "display_name": "HAWK", "link": "https://stackoverflow.com/users/4990822/hawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564007469, "creation_date": 1564007469, "question_id": 57192071, "link": "https://stackoverflow.com/questions/57192071/how-to-define-colors-by-series-in-excel-scatter-plot-with-connecting-lines", "title": "How to define colors by series in Excel scatter plot with connecting lines", "body": "<p>I'm creating a scatterplot with data for many countries over a period of 20 years. I already have the graph made, with the points for each country linked with a connecting line to show how each country's outcomes against both variables have evolved over the time period.</p>\n\n<p>However, rather than having a different color for each country (the Excel default), I would like to group the countries to show trends across them -- e.g., all lower-income countries blue, all middle-income orange, and all upper-income green. However, they have to stay as separate series (I can't just stack the data into one column per color), so that the connecting lines stay separate for each country.</p>\n\n<p>How can I loop through all countries in the plot to change the colors according to a defined variable outside of the plot?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1564006585, "post_id": 57191875, "comment_id": 100893337, "body": "You probably should look into <a href=\"https://support.office.com/en-us/article/add-change-or-clear-conditional-formats-8a1cc355-b113-41b7-a483-58460332a1af\" rel=\"nofollow noreferrer\">conditional formatting</a>."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564021195, "post_id": 57191875, "comment_id": 100895950, "body": "As commented by @GSerg, if you use form control check boxes, may link then to two cells say F1 and F2, the formulas to be added for conditional formatting would be like   <code>=AND($F$1=FALSE,G3&gt;100)</code>   <code>=AND($F$1,G3&gt;100)</code>  <code>=AND($F$2=FALSE,G3&lt;0)</code>  <code>=AND($F$2,G3&lt;0) </code>  and apply to Range <code>G3:G.....</code>"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 1297069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9a2d4bc2daaa57e6f65743f4bd1c12?s=128&d=identicon&r=PG", "display_name": "user1297069", "link": "https://stackoverflow.com/users/1297069/user1297069"}, "edited": false, "score": 0, "creation_date": 1564108009, "post_id": 57192771, "comment_id": 100930390, "body": "Works like a charm! Thank you very much for your help."}], "tags": [], "owner": {"reputation": 1325, "user_id": 2292264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e93c8491e067073e4fcd5c33ad1eac8?s=128&d=identicon&r=PG", "display_name": "Gro", "link": "https://stackoverflow.com/users/2292264/gro"}, "is_accepted": true, "score": 1, "last_activity_date": 1564123625, "last_edit_date": 1564123625, "creation_date": 1564014141, "answer_id": 57192771, "question_id": 57191875, "link": "https://stackoverflow.com/questions/57191875/vba-cell-format-that-contain-a-specific-percentage-value/57192771#57192771", "title": "VBA cell format that contain a specific percentage value", "body": "<p>Firstly, check the final value in <strong>rng</strong> variable after your calculation. In general, if you are considering cell A3 to G30 then your range should be <strong>\"A3:G30\"</strong>. Statements <strong>lr = range(\"A\" &amp; Rows.Count).End(xlUp).Row</strong> and <strong>Set rng = range(\"G3:G30\" &amp; lr)</strong> give an impression that cell range are not being formed correctly. However my doubt may just be a false alarm, as your requirement is not fully clear with whatever you have described. </p>\n\n<p>Secondly, for concise code, change the following part of your code to one shown below</p>\n\n<pre><code>Application.ScreenUpdating = False\nIf LessThan0.Value = True Then\n    For Each c In rng\n        If c &lt;= find Then\n          c.Select\n          With Selection.Borders\n           .Color = vbBlue\n           .LineStyle = xlContinuous\n           .Weight = xlThick\n          End With\n        End If\n    Next c\n    Application.ScreenUpdating = True\n    Else\n    For Each c In rng\n        If c &lt;= find Then\n          c.Select\n          With Selection.Borders\n           .Color = vbBlack\n           .LineStyle = xlNone\n           .Weight = xlThin\n          End With\n        End If\n    Next c\nApplication.ScreenUpdating = True\nEnd If\n</code></pre>\n\n<pre><code>Application.ScreenUpdating = False\nFor Each c In rng\n   If c &lt;= find\n     c.Select\n     With Selection.Borders\n       .Color = IIf(LessThan0.Value = True, vbBlue, vbBlack) \n       .LineStyle = IIf(LessThan0.Value = True, xlContinuous, xlNone) \n       .Weight = IIf(LessThan0.Value = True, xlThick, xlThin)  \n     End With\n   End If\nNext c\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>Further, you can merge these two subroutines into one by taking value GreaterThan100.value and LessThan0.value as paraemeters to that single subroutine</p>\n"}], "owner": {"reputation": 53, "user_id": 1297069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9a2d4bc2daaa57e6f65743f4bd1c12?s=128&d=identicon&r=PG", "display_name": "user1297069", "link": "https://stackoverflow.com/users/1297069/user1297069"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 57192771, "answer_count": 1, "score": 0, "last_activity_date": 1564123625, "creation_date": 1564006091, "last_edit_date": 1564006378, "question_id": 57191875, "link": "https://stackoverflow.com/questions/57191875/vba-cell-format-that-contain-a-specific-percentage-value", "title": "VBA cell format that contain a specific percentage value", "body": "<p>I have VBA code that loops through cells to find percentage value and highlight them accordingly on a click of a checkbox.<br>\nI have 2 checkboxes - <code>GreaterThan100</code>, <code>LessThan0</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub GreaterThan100_Click()\n    Dim lr As Long\n    lr = range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Dim c As range\n    Dim rng As range\n    Set rng = range(\"G3:G30\" &amp; lr)\n    Dim find As Long\n    find = 1\n    Application.ScreenUpdating = False\n    If GreaterThan100.Value = True Then\n    For Each c In rng\n        If c &gt;= find Then\n          c.Select\n          With Selection.Borders\n           .Color = vbBlue\n           .LineStyle = xlContinuous\n           .Weight = xlThick\n          End With\n        End If\n    Next c\n    Application.ScreenUpdating = True\n    Else\n    For Each c In rng\n        If c &gt;= find Then\n          c.Select\n          With Selection.Borders\n           .Color = vbBlack\n           .LineStyle = xlNone\n           .Weight = xlThin\n          End With\n        End If\n    Next c\n    Application.ScreenUpdating = True\n    End If\nEnd Sub\n\nPrivate Sub LessThan0_Click()\n    Dim lr As Long\n    lr = range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Dim c As range\n    Dim rng As range\n    Set rng = range(\"G3:G30\" &amp; lr)\n    Dim find As Long\n    find = 0\n    Application.ScreenUpdating = False\n    If LessThan0.Value = True Then\n    For Each c In rng\n        If c &lt;= find Then\n          c.Select\n          With Selection.Borders\n           .Color = vbBlue\n           .LineStyle = xlContinuous\n           .Weight = xlThick\n          End With\n        End If\n    Next c\n    Application.ScreenUpdating = True\n    Else\n    For Each c In rng\n        If c &lt;= find Then\n          c.Select\n          With Selection.Borders\n           .Color = vbBlack\n           .LineStyle = xlNone\n           .Weight = xlThin\n          End With\n        End If\n    Next c\n    Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>Both codes work but <code>LessThan0</code> is taking significantly longer than <code>GreaterThan100</code>. Any suggestions to how to make this run faster? Suggestions on improving both methods would also be helpful!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "edited": false, "score": 0, "creation_date": 1564084363, "post_id": 57199363, "comment_id": 100924939, "body": "Thank you so much, this definitely helps.  Everything works except I can&#39;t get the combo box to populate with the dataRng values.  I&#39;m sure I am doing something wrong but I can&#39;t figure it out.  I&#39;d upload the code but it is on a stand-alone system.  I&#39;ll keep going through to see if I fat-fingered something.  Thanks again!"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "edited": false, "score": 0, "creation_date": 1564130336, "post_id": 57199363, "comment_id": 100937043, "body": "@ARCHER1919 I am not sure I understand the problem. Keep in mind that the combobox in the code above is populated with <code>sourceRng</code> not <code>dataRng</code>. So basically when the combobox is expanded, you will see <code>Preset1</code>, <code>Preset2</code> etc.  as options of the drop down menu. Isn&#39;t that what you need? <code>dataRng</code> is only used as a variable to hold the range where your data is located so that the <code>VLookUp</code> can be performed."}, {"owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "edited": false, "score": 0, "creation_date": 1564157263, "post_id": 57199363, "comment_id": 100951639, "body": "My apologies.  The issue I was having was that the combo box wasn&#39;t populating at all.  It was a typo on  my part.  Looks like I needed better attention to detail.  Thanks again for helping me out with this!"}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 0, "last_activity_date": 1564048998, "creation_date": 1564048998, "answer_id": 57199363, "question_id": 57191833, "link": "https://stackoverflow.com/questions/57191833/how-to-query-data-in-cells-based-off-of-userform-combo-box-selection-and-copy-da/57199363#57199363", "title": "How to query data in cells based off of userform combo box selection and copy data into userform textbox", "body": "<p>I am not sure where exactly you want to store the textbox values so I just store them in the hidden sheet in cells A1, B1, C1. This can be easily changed to fit your needs.</p>\n\n<p>This is how i would do it:</p>\n\n<p>The <code>Userform_Initialize()</code> sub is located in a module and is called by clicking a button located in the sheet where the data is:</p>\n\n<pre><code>Option Explicit\n\nSub Userform_Initialize()\nDim sht As Worksheet\nDim sourceRng As Range\nSet sht = ThisWorkbook.Worksheets(\"Name of the Sheet\") 'where the data is\n\nWith sht\n    Set sourceRng = .Range(.Range(\"A2\"), .Range(\"A\" &amp; .Rows.Count).End(xlUp))\nEnd With\nUserForm1.ComboBox1.List = sourceRng.Value\nLoad UserForm1\nUserForm1.Show\n\nEnd Sub\n</code></pre>\n\n<p>When the button is pressed, the userform appears and the combobox has already been initialized.</p>\n\n<p>The <code>ComboBox1_Change()</code> sub which is located in the userform itself, is triggered when the combobox's value is changed. When this happens, the textboxes are automatically loaded with the corresponding values.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub ComboBox1_Change()\nDim sht As Worksheet\nDim dataRng As Range\nSet sht = ThisWorkbook.Worksheets(\"Name of the Sheet\") 'where the data is\n\nWith sht\n    Set dataRng = .Range(.Range(\"A2\"), .Range(\"D\" &amp; .Rows.Count).End(xlUp))\nEnd With\nTextBox1.Value = Application.WorksheetFunction.VLookup(ComboBox1.Value, dataRng, 2)\nTextBox2.Value = Application.WorksheetFunction.VLookup(ComboBox1.Value, dataRng, 3)\nTextBox3.Value = Application.WorksheetFunction.VLookup(ComboBox1.Value, dataRng, 4)\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bfrRs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bfrRs.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Finally, clicking the save button, will write the value of the textboxes to the hidden worksheet. The <code>SaveButton_Click()</code> sub is also located in the userform.</p>\n\n<pre><code>Private Sub SaveButton_Click()\nDim sht As Worksheet\nDim dataRng As Range\nSet sht = ThisWorkbook.Worksheets(\"Name of hidden Sheet\") 'where the data should be stored\nWith sht\n    .Range(\"A1\").Value = TextBox1.Value\n    .Range(\"B1\").Value = TextBox2.Value\n    .Range(\"C1\").Value = TextBox3.Value\nEnd With\nUnload UserForm1\nUserForm1.Hide\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 57199363, "answer_count": 1, "score": 0, "last_activity_date": 1564048998, "creation_date": 1564005848, "last_edit_date": 1564039222, "question_id": 57191833, "link": "https://stackoverflow.com/questions/57191833/how-to-query-data-in-cells-based-off-of-userform-combo-box-selection-and-copy-da", "title": "How to query data in cells based off of userform combo box selection and copy data into userform textbox", "body": "<p>I'm sure this is a simple question but I'm still very new to this and trying to learn.  Y'all have already helped me immensely.  </p>\n\n<p>I have a sheet within a workbook that stores the data options I enter into userform textboxes.  The idea is that I enter a name into a combo box on the userform and click a \"Save\" button which copies the text from the various text boxes onto a hidden spreadsheet that I can \"load\" later with another button.  </p>\n\n<p>My code to save the textbox data works fine, however I'm having issues getting the combo box to reference the dynamic range (in a column) I created.  Also I am not sure how to write the code to copy the data from the row that the combo box selection is in.</p>\n\n<p>Example: </p>\n\n<p>Name        Datafield1    Datafield2    Datafield3<br>\nPreset1       Purple         10000         Banana </p>\n\n<p>I want my combo box to populate with the dynamic range under name and automaticall copy \"purple\", \"10000, \"Banana\" into textbox 1, 2, and 5</p>\n\n<p>I have gotten combo boxes to populate with static ranges before but I have never tried to get userform testboxes to populate based upon what I select in the combo box </p>\n\n<p>For the dynamic range piece I have a couple of lines of code that make the sheet with the range active and sets the rowsource for the combo box </p>\n\n<p>I'm not sure where to start with referencing the other cells in the combo box selection row</p>\n\n<p>So far I'm not getting any error messages because I can't figure out how to get the dynamic range to work or how to get the textboxes to populate. Thanks in advance for the help, you guys are awesome.</p>\n\n<pre><code>\nPrivate Sub Userform_Initialize() \n\n'Empty preset name combo box \n\npresetname.value = \"\"\n\nWith Sheet6\n   Range(\"A2\", Range(\"A\" &amp; Rows.count).end(xlUp)).name = \"presetnamerange\"\nEnd With \n   Me.presetname.rowsource = \"presetnamerange\"\n\nEnd Sub\n\n\n\n'I have a sub for the combo box but I'm not sure what to put in it\n\nSub presetname_change()\n\nWith Sheet6\n\n'????\n\nEnd With \n\nEnd Sub \n\n\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1564006237, "post_id": 57191828, "comment_id": 100893238, "body": "Did you mean <code>Exit For</code> instead of the <code>Exit Sub</code>?"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564007104, "post_id": 57191828, "comment_id": 100893474, "body": "@GSerg, that made me giggle. Good reminder to <i>always step through thy code...</i> at the first, when you have issues."}, {"owner": {"reputation": 25, "user_id": 9531470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f553627979dce8cbcd6f1d7afdb4e4b?s=128&d=identicon&r=PG&f=1", "display_name": "jashad2", "link": "https://stackoverflow.com/users/9531470/jashad2"}, "edited": false, "score": 0, "creation_date": 1564009252, "post_id": 57191828, "comment_id": 100893958, "body": "That makes sense. I borrowed that snippet from someone else, which is why I referred to it as Frankencode. Does &quot;stepping through the code&quot; just mean carefully reading through it, or is there actually a program you can use?"}, {"owner": {"reputation": 25, "user_id": 9531470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f553627979dce8cbcd6f1d7afdb4e4b?s=128&d=identicon&r=PG&f=1", "display_name": "jashad2", "link": "https://stackoverflow.com/users/9531470/jashad2"}, "edited": false, "score": 0, "creation_date": 1564010521, "post_id": 57191828, "comment_id": 100894180, "body": "Actually, I just tried the edit I suggested and all it did was loop through all the pages a transpose only one column in B2, instead of a column for every matching value"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1564011059, "post_id": 57191828, "comment_id": 100894262, "body": "Use the debugger to step through the code. Set a breakpoint at the start, and then step through the code. See the <i>Debug</i> menu in the VB Editor."}, {"owner": {"reputation": 25, "user_id": 9531470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f553627979dce8cbcd6f1d7afdb4e4b?s=128&d=identicon&r=PG&f=1", "display_name": "jashad2", "link": "https://stackoverflow.com/users/9531470/jashad2"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1564012565, "post_id": 57191828, "comment_id": 100894538, "body": "@Ken White Thanks!"}], "owner": {"reputation": 25, "user_id": 9531470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f553627979dce8cbcd6f1d7afdb4e4b?s=128&d=identicon&r=PG&f=1", "display_name": "jashad2", "link": "https://stackoverflow.com/users/9531470/jashad2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564012503, "creation_date": 1564005838, "last_edit_date": 1564012503, "question_id": 57191828, "link": "https://stackoverflow.com/questions/57191828/nested-for-each-and-if-then-statements-works-but-doesnt-continue-to-next-sheet", "title": "Nested For Each and If Then statements works but doesn&#39;t continue to Next sheet", "body": "<p>Please excuse my novice, Frankenstein VBA coding. I've managed to get this code to work properly on the first qualifying sheet, but then it doesn't continue looping through the rest of the sheets. Here's what I need it to do:</p>\n\n<p>I have a large number of sheets named with ID strings. For each sheet that isn't called \"Raw Data\" or \"Pivot\", I need it to:</p>\n\n<ul>\n<li>search column C on sheet(\"Raw Data\") for values that match the name of the current sheet in the loop</li>\n<li>copy that row and transpose it to a column starting with B2 of the current sheet</li>\n<li>continue to the next matching value and transpose that row on the next column to the right</li>\n<li>when there are no more matching values, move to the next sheet and do it all again</li>\n</ul>\n\n<p>Right now it works for the first sheet and then I get nothing. I don't know if it's because I've set up the nested loops incorrectly, or if it's not searching the values properly (like pasting down a vlookup without locking the references)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub copyrows2()\n    Dim Scol As Range, Cell As Object, rawdata As Worksheet, WS As Worksheet, lc As Long, C As Integer\n\n    Set rawdata = ThisWorkbook.Worksheets(\"Raw Data\")\n    Set Scol = rawdata.Range(\"C2:C2000\") 'Substitute with the range which includes your True/False values\n    C = 2\n\n    For Each WS In ThisWorkbook.Worksheets\n        If WS.Name &lt;&gt; \"Raw Data\" And WS.Name &lt;&gt; \"Pivot\" Then\n            With WS 'cycles through all of the sheets with Franchise ID's as the name\n                For Each Cell In Scol 'should scan the C column on the Raw Data sheet'\n                    If IsEmpty(Cell) Then\n                        Exit Sub\n                    End If\n\n                    If Cell.Value = WS.Name Then 'checks for cells that contain the same Franchise ID as the current sheet in the cycle'\n                        Cell.EntireRow.Copy\n                        WS.Cells(2, C).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n                            xlNone, SkipBlanks:=False, Transpose:=True\n                        C = C + 1\n                    End If\n                Next Cell\n            End With\n        End If\n    Next WS\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>I'm not getting any error messages, the loop just doesn't appear to continue like it's supposed to.</p>\n\n<p>Update: I'm an idiot, @GSerg fixed the looping issue by pointing out that I had Exit Sub in the middle of the code.</p>\n\n<p>Now, on each successive page it's picking up on the column where it left off (instead of starting back over at B2). Do I need to tell it to reset to C=2 after the End If? Like:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Cell.Value = WS.Name Then 'checks for cells that contain the same Franchise ID as the current sheet in the cycle'\n                        Cell.EntireRow.Copy\n                        WS.Cells(2, C).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n                            xlNone, SkipBlanks:=False, Transpose:=True\n                        C = C + 1\n                    End If\n                    C = 2\n                Next Cell\n\nUpdate 2: I think I fixed it. Instead of setting C=2 at the beginning of the macro, or resetting it after that IF statement, I set C=2 at the beginning of the outer loop so that it would reset the value at each sheet:\n\n```vb\nSub copyrows2()\n    Dim Scol As Range, Cell As Object, rawdata As Worksheet, WS As Worksheet, lc As Long, C As Integer\n\n    Set rawdata = ThisWorkbook.Worksheets(\"Raw Data\")\n    Set Scol = rawdata.Range(\"C2:C2000\") 'Substitute with the range which includes your True/False values\n\n    For Each WS In ThisWorkbook.Worksheets\n        If WS.Name &lt;&gt; \"Raw Data\" And WS.Name &lt;&gt; \"Pivot\" Then\n            With WS 'cycles through all of the sheets with Franchise ID's as the name\n            C=2 'This is the fix'\n                For Each Cell In Scol 'should scan the C column on the Raw Data sheet'\n                    If IsEmpty(Cell) Then\n                        Exit Sub\n                    End If\n\n                    If Cell.Value = WS.Name Then 'checks for cells that contain the same Franchise ID as the current sheet in the cycle'\n                        Cell.EntireRow.Copy\n                        WS.Cells(2, C).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n                            xlNone, SkipBlanks:=False, Transpose:=True\n                        C = C + 1\n                    End If\n                Next Cell\n            End With\n        End If\n    Next WS\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1564005662, "post_id": 57191490, "comment_id": 100893086, "body": "Other user&#39;s macro security settings is not something you can have control over. If you were able to control these settings, it would also defeat the purpose of it being an application setting to start with."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7891411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd39dcd0710e0d6a6b013f457ceb832b?s=128&d=identicon&r=PG&f=1", "display_name": "HeelsPlusPlus", "link": "https://stackoverflow.com/users/7891411/heelsplusplus"}, "edited": false, "score": 0, "creation_date": 1564056781, "post_id": 57191603, "comment_id": 100910919, "body": "Well I was wondering if there was a different way to make the functionality"}, {"owner": {"reputation": 1, "user_id": 11832651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6ca93acce8c7ba6dc03bebf57721376?s=128&d=identicon&r=PG&f=1", "display_name": "Sntrada", "link": "https://stackoverflow.com/users/11832651/sntrada"}, "reply_to_user": {"reputation": 11, "user_id": 7891411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd39dcd0710e0d6a6b013f457ceb832b?s=128&d=identicon&r=PG&f=1", "display_name": "HeelsPlusPlus", "link": "https://stackoverflow.com/users/7891411/heelsplusplus"}, "edited": false, "score": 0, "creation_date": 1564076237, "post_id": 57191603, "comment_id": 100921437, "body": "Only way I can think of is if you consider a non VBA option. You can&#39;t force a Macro to run on a machine, unless that machine allows all Macros."}], "tags": [], "owner": {"reputation": 1, "user_id": 11832651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6ca93acce8c7ba6dc03bebf57721376?s=128&d=identicon&r=PG&f=1", "display_name": "Sntrada", "link": "https://stackoverflow.com/users/11832651/sntrada"}, "is_accepted": false, "score": 0, "last_activity_date": 1564004295, "creation_date": 1564004295, "answer_id": 57191603, "question_id": 57191490, "link": "https://stackoverflow.com/questions/57191490/why-does-my-excel-button-macro-work-on-my-computer-but-not-on-another-computer/57191603#57191603", "title": "Why does my excel Button Macro work on my computer but not on another computer", "body": "<p>Usually MS office is defaulted to block macros. Users will have to go into their settings and change their settings to disable macros with notifications. This way when they open the file they will have a pop-up with the option to enable macros on the file you sent.</p>\n\n<p>Macros can be extremely deadly and used as a trojan horse to load viruses to a system, this is why it is best they are disabled with notification. Only macros from a trusted source should be enabled if you receive a notification. I will suggest you create a step-by-step guide for users to instruct them on how to change their settings. </p>\n"}], "owner": {"reputation": 11, "user_id": 7891411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd39dcd0710e0d6a6b013f457ceb832b?s=128&d=identicon&r=PG&f=1", "display_name": "HeelsPlusPlus", "link": "https://stackoverflow.com/users/7891411/heelsplusplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564004461, "creation_date": 1564003643, "last_edit_date": 1564004461, "question_id": 57191490, "link": "https://stackoverflow.com/questions/57191490/why-does-my-excel-button-macro-work-on-my-computer-but-not-on-another-computer", "title": "Why does my excel Button Macro work on my computer but not on another computer", "body": "<p>I have a pivot table with 3 slicers and I wanted to make it easy for anyone to filter with the slicers and with one click, clear all filters, so I created a button using code I found on Microsoft's website below. It works perfectly fine on my computer, but once I open it on my colleagues computer it won't work.</p>\n\n<p>My colleague and I changed his trusted connections/Macros settings and it worked, however this defeats the purpose, as people who get the report are not excel experts and I don't have access or control over their settings</p>\n\n<pre><code>Sub Button3_Click()\n    Dim cache As SlicerCache\n    For Each cache In ActiveWorkbook.SlicerCaches\n    cache.ClearManualFilter\n    Next cache\nEnd Sub\n</code></pre>\n\n<p>The error says</p>\n\n<blockquote>\n  <p><em>Cannot run the macro. The macro may not be available in this workbook or all macros may be disabled.</em></p>\n</blockquote>\n\n<p>Please help</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1564002368, "post_id": 57191200, "comment_id": 100892103, "body": "Just a note, you have some unqualified ranges (e.g. <code>Cells(xRg.Row, xTimeColumn)</code>, <code>Columns(10)</code>, etc..  I&#39;d be sure to add the worksheet that is supposed to be on before it, <code>Worksheets(&quot;SheetName&quot;).Cells(...)</code>."}, {"owner": {"reputation": 13, "user_id": 7947500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f443fcf3f8e79c4f885817eeafb863f?s=128&d=identicon&r=PG&f=1", "display_name": "M G", "link": "https://stackoverflow.com/users/7947500/m-g"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1564077291, "post_id": 57191200, "comment_id": 100921930, "body": "Thanks.  I added it to the two lines were it was missing."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 7947500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f443fcf3f8e79c4f885817eeafb863f?s=128&d=identicon&r=PG&f=1", "display_name": "M G", "link": "https://stackoverflow.com/users/7947500/m-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1564167145, "creation_date": 1564167145, "answer_id": 57225607, "question_id": 57191200, "link": "https://stackoverflow.com/questions/57191200/copy-filtered-rows-from-worksheet-to-the-last-row-of-another-worksheet/57225607#57225607", "title": "Copy filtered rows from worksheet to the last row of another worksheet", "body": "<p>Finally managed to it to work like I wanted.</p>\n\n<p>Here's the code for anyone else this might help.</p>\n\n<p>The first part inserts the date when a cell is modified.</p>\n\n<p>Second part copies to data to the log page</p>\n\n<p>Third part copies the data to the right tab if it meats the specified criteria and deletes the row from the CRM page.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Option Explicit\r\n\r\nPrivate Sub Worksheet_Change(ByVal Target As Range)\r\n    If Not Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0)) Is Nothing Then\r\n        On Error GoTo bm_Safe_Exit\r\n        Application.EnableEvents = False\r\n    End If\r\nDim xCellColumn As Integer\r\nDim xTimeColumn As Integer\r\nDim xRow, xCol As Integer\r\nDim xDPRg, xRg As Range\r\nxCellColumn = 10\r\nxTimeColumn = 11\r\nxRow = Target.Row\r\nxCol = Target.Column\r\n    If Target.Text &lt;&gt; \"\" Then\r\n    If xCol = xCellColumn Then\r\n        Worksheets(\"CRM\").Cells(xRow, xTimeColumn) = Now\r\n        Else\r\n            On Error Resume Next\r\n            Set xDPRg = Target.Dependents\r\n            For Each xRg In xDPRg\r\n                If xRg.Column = xCellColumn Then\r\n                    Worksheets(\"CRM\").Cells(xRg.Row, xTimeColumn) = Now\r\n                End If\r\n        Next\r\n    End If\r\n\r\nDim a As Range\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If CBool(Len(a.Value2)) Then _\r\n        a.EntireRow.Copy _\r\n        Destination:=Sheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\r\n    Next a\r\n    End If\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If Target.Value = \"Closed Won\" Then _\r\n        a.EntireRow.Copy _\r\n        Destination:=Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\r\nNext a\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If Target.Value = \"Closed Won\" Then _\r\n                a.EntireRow.Delete\r\n    Next a\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If Target.Value = \"Closed Lost\" Then _\r\n        a.EntireRow.Copy _\r\n        Destination:=Sheet5.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\r\n    Next a\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If Target.Value = \"Closed Lost\" Then _\r\n                a.EntireRow.Delete\r\n    Next a\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If Target.Value = \"Renewal\" Then _\r\n        a.EntireRow.Copy _\r\n        Destination:=Sheet6.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\r\n    Next a\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If Target.Value = \"Renewal\" Then _\r\n                a.EntireRow.Delete\r\n    Next a\r\n\r\nbm_Safe_Exit:\r\n    Application.EnableEvents = True\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 13, "user_id": 7947500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f443fcf3f8e79c4f885817eeafb863f?s=128&d=identicon&r=PG&f=1", "display_name": "M G", "link": "https://stackoverflow.com/users/7947500/m-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 57225607, "answer_count": 1, "score": 0, "last_activity_date": 1564167145, "creation_date": 1564002132, "last_edit_date": 1564166246, "question_id": 57191200, "link": "https://stackoverflow.com/questions/57191200/copy-filtered-rows-from-worksheet-to-the-last-row-of-another-worksheet", "title": "Copy filtered rows from worksheet to the last row of another worksheet", "body": "<p>I've been working on adapting our excel based sales report into an in-house CRM using macros.</p>\n\n<p>This is the macro I've managed to get to work using code found on this site :</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0)) Is Nothing Then\n        On Error GoTo bm_Safe_Exit\n        Application.EnableEvents = False\n    End If\n            Dim xCellColumn As Integer\n            Dim xTimeColumn As Integer\n            Dim xRow, xCol As Integer\n            Dim xDPRg, xRg As Range\n            xCellColumn = 10\n            xTimeColumn = 11\n            xRow = Target.Row\n            xCol = Target.Column\n                If Target.Text &lt;&gt; \"\" Then\n                If xCol = xCellColumn Then\n                    Cells(xRow, xTimeColumn) = Now\n                Else\n                    On Error Resume Next\n                    Set xDPRg = Target.Dependents\n                        For Each xRg In xDPRg\n                    If xRg.Column = xCellColumn Then\n                    Cells(xRg.Row, xTimeColumn) = Now\n                End If\n                Next\n                End If\n        Dim a As Range\n        For Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\n            If CBool(Len(a.Value2)) Then _\n                a.EntireRow.Copy _\n                    Destination:=Sheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n        Next a\n    End If\nbm_Safe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>This works great for our basic needs but whenever an opportunity closes, we'd like it to be transferred below the existing data to 3 separate worksheets based on the result of the opportunity (Won, Lost, Renewed) and removed from the main CRM sheet (aka cut and not copy).  Those values being some of the choices in column 10, the same row used in my script above.</p>\n\n<p>There's a myriad of different scripts around to accomplish some portion of what I want but I unfortunately couldn't get any script I've tried to work on my file, much less work as intended since our situation involves a few different \"special\" use case (no filters, multiple criterias, existing tables to receive data, etc).</p>\n\n<p>Basically I'm looking to add on to the script above so :</p>\n\n<ul>\n<li><p>all rows are still be copied to the Log sheet (Sheet 3) </p></li>\n<li><p>when an entry matching either Won, Lost or Renewed is selected, that entire row should be cut from the CRM sheet (Sheet 1)</p></li>\n<li><p>That row should be pasted below the existing data in either sheet 2 (won), sheet 5 (lost) and sheet 6 (renewed)</p></li>\n</ul>\n\n<p>Any help or advice would be more than appreciated.</p>\n\n<p>Thanks.</p>\n\n<p>Edit :</p>\n\n<p>I've continued to work on getting this to work and I managed to get it to work.  </p>\n\n<p>But when I cut the row, it also cuts away the formatting of the row including data validation.  Is there any way to cut the data but leave formatting and data validation settings intact ?  Perhaps trough the use of special paste ?</p>\n\n<p>Here's the code I used :</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Option Explicit\r\n\r\nPrivate Sub Worksheet_Change(ByVal Target As Range)\r\n    If Not Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0)) Is Nothing Then\r\n        On Error GoTo bm_Safe_Exit\r\n        Application.EnableEvents = False\r\n    End If\r\nDim xCellColumn As Integer\r\nDim xTimeColumn As Integer\r\nDim xRow, xCol As Integer\r\nDim xDPRg, xRg As Range\r\nxCellColumn = 10\r\nxTimeColumn = 11\r\nxRow = Target.Row\r\nxCol = Target.Column\r\n    If Target.Text &lt;&gt; \"\" Then\r\n    If xCol = xCellColumn Then\r\n        Worksheets(\"CRM\").Cells(xRow, xTimeColumn) = Now\r\n        Else\r\n            On Error Resume Next\r\n            Set xDPRg = Target.Dependents\r\n            For Each xRg In xDPRg\r\n                If xRg.Column = xCellColumn Then\r\n                    Worksheets(\"CRM\").Cells(xRg.Row, xTimeColumn) = Now\r\n                End If\r\n        Next\r\n    End If\r\n\r\nDim a As Range\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If CBool(Len(a.Value2)) Then _\r\n        a.EntireRow.Copy _\r\n        Destination:=Sheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\r\n    Next a\r\n    End If\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If Target.Value = \"Closed Won\" Then _\r\n        a.EntireRow.Cut _\r\n        Destination:=Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\r\n        Sheets(\"CRM\").Rows(10000).EntireRow.Copy\r\n        ActiveCell.EntireRow.Paste\r\n    Next a\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If Target.Value = \"Closed Lost\" Then _\r\n        a.EntireRow.Cut _\r\n        Destination:=Sheet5.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\r\n    Next a\r\nFor Each a In Intersect(Target, Columns(10), Me.UsedRange.Offset(1, 0))\r\n    If Target.Value = \"Renewal\" Then _\r\n        a.EntireRow.Cut _\r\n        Destination:=Sheet6.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\r\n    Next a\r\n\r\nbm_Safe_Exit:\r\n    Application.EnableEvents = True\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1564001914, "post_id": 57191088, "comment_id": 100891951, "body": "Side note: the <code>:</code> (<i>instruction separator</i>) token can be used to chain multiple instructions in the same logical line of code. Not that I&#39;d recommend doing that (especially in <code>If....Then thing1 : thing2</code>, where it&#39;s relatively ambiguous whether <code>thing2</code> runs conditionally or not - definitely prefer <code>If...End If</code> block syntax)"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1564001615, "creation_date": 1564001615, "answer_id": 57191088, "question_id": 57190919, "link": "https://stackoverflow.com/questions/57190919/returning-false-when-using-multiple-then-statements/57191088#57191088", "title": "Returning FALSE when using multiple THEN statements", "body": "<p>Put each command into its own row. The <code>&amp;</code> ampersand is a text concatenation operator. It cannot be used to chain commands.</p>\n\n<pre><code>For Each cell In Range(\"C2:\" &amp; \"C\" &amp; lastRow)\n\n    If cell.Value &lt;&gt; \"C\" And cell.Value &lt;&gt; \"\" Then\n        cell.Offset(0, -2).Value = cell.Offset(0, -2).Value &amp; \", Tran type error\"\n        cell.Interior.ColorIndex = 37\n    End If\n\nNext\n</code></pre>\n\n<p>This way you need to use the <code>End If</code> statement, so don't forget that.</p>\n"}], "owner": {"reputation": 93, "user_id": 11666863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f13589cd21afc761e3b81e6fa294460?s=128&d=identicon&r=PG&f=1", "display_name": "Starbucks", "link": "https://stackoverflow.com/users/11666863/starbucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 57191088, "answer_count": 1, "score": 0, "last_activity_date": 1564001615, "creation_date": 1564000859, "last_edit_date": 1564001448, "question_id": 57190919, "link": "https://stackoverflow.com/questions/57190919/returning-false-when-using-multiple-then-statements", "title": "Returning FALSE when using multiple THEN statements", "body": "<p>I have a macro that has conditional statements in. It works perfectly if I take out the second statement of coloring the cell with the error message. Instead when I add the color to the cell I am returned with a FALSE statement in my column.</p>\n\n<p>It works perfectly here:</p>\n\n<pre><code>Sub trantype()\n\nDim cell As Range\nDim lastRow As Long\nSheets(\"1099-Misc_Form_Template\").Select\nlastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).row\n\nFor Each cell In Range(\"C2:\" &amp; \"C\" &amp; lastRow)\n\n    If cell.Value &lt;&gt; \"C\" And cell.Value &lt;&gt; \"\" Then cell.Offset(0, -2).Value = cell.Offset(0, -2).Value &amp; \", Tran type error\" \n\nNext\nEnd Sub\n</code></pre>\n\n<p>But when I add the second condition I am returned with a FALSE statement:</p>\n\n<pre><code>\nDim cell As Range\nDim lastRow As Long\nSheets(\"1099-Misc_Form_Template\").Select\nlastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).row\n\nFor Each cell In Range(\"C2:\" &amp; \"C\" &amp; lastRow)\n\n    If cell.Value &lt;&gt; \"C\" And cell.Value &lt;&gt; \"\" Then cell.Offset(0, -2).Value = cell.Offset(0, -2).Value &amp; \", Tran type error\" &amp; cell.Interior.ColorIndex = 37\n\nNext\nEnd Sub\n</code></pre>\n\n<p>I would like both conditions to be met, so the error message is printed in the offset cell and the cell with the error in to have color.</p>\n"}, {"tags": ["excel", "vba", "format", "conditional-statements"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1564001699, "creation_date": 1564001699, "answer_id": 57191105, "question_id": 57190787, "link": "https://stackoverflow.com/questions/57190787/conditional-formatting-by-first-couple-of-letters-in-string-vba/57191105#57191105", "title": "Conditional Formatting by first couple of letters in string [VBA]", "body": "<p>From the macro recorder:</p>\n\n<pre><code>Selection.FormatConditions.Delete\nSelection.FormatConditions.Add Type:=xlExpression, _\nFormula1:=\"=LEFT(A1,1)=\"\"V\"\"\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Font\n    .Bold = True\n    .Italic = False\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n</code></pre>\n\n<p>and tidied up:</p>\n\n<pre><code>Dim rng As Range, fc As FormatCondition\n\nSet rng = Selection\n\nrng.FormatConditions.Delete\nWith rng.FormatConditions.Add(Type:=xlExpression, _\n         Formula1:=\"=LEFT(\" &amp; rng.Cells(1).Address(False, False) &amp; \",1)=\"\"V\"\"\")\n    .SetFirstPriority\n    .Font.Bold = True\n    .StopIfTrue = False\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1564066410, "creation_date": 1564066410, "answer_id": 57204876, "question_id": 57190787, "link": "https://stackoverflow.com/questions/57190787/conditional-formatting-by-first-couple-of-letters-in-string-vba/57204876#57204876", "title": "Conditional Formatting by first couple of letters in string [VBA]", "body": "<p>Conditional Formatting is limited to three different formats. With VBA you can overcome this limitation. \nUsing a loop and either <code>InStr</code> or <code>Left</code> to check the first character in each cell, and bold the font in the cells that have an \"A\" in the first character position.</p>\n\n<pre><code>For Each Cel in ThisWorkbook.Sheets(\"Sheet1\").Range(\"L2:EZ5000\")\n    If InStr(1, cel.Value, \"A\") Then cel.Font.Bold = True\n\n    'Or use... If (Left(cel, 1) = \"A\") Then cel.Font.Bold = True\nNext cel\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11832655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-usdcoKEJ-dI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBBc4oqm4TgNo8KMfJmVrv8hohjg/photo.jpg?sz=128", "display_name": "arburrou", "link": "https://stackoverflow.com/users/11832655/arburrou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 57191105, "answer_count": 2, "score": 1, "last_activity_date": 1564066410, "creation_date": 1564000176, "last_edit_date": 1564039209, "question_id": 57190787, "link": "https://stackoverflow.com/questions/57190787/conditional-formatting-by-first-couple-of-letters-in-string-vba", "title": "Conditional Formatting by first couple of letters in string [VBA]", "body": "<p>I'm trying to make the font of some VBA cells bold by applying  <code>.FormatConditions.Add(xlTextString, etc.)</code> to a range. </p>\n\n<p>I'd like to bold cells within this range if the value of the cells within the range start with the letter \"V\"</p>\n\n<p>Below is a portion of the code I'm using. I'm interested in getting from here to a functional result, but I'm not sure where to go from here -- can anyone advise?</p>\n\n<pre><code>With .Range(\"L2:EZ5000\").FormatConditions\n    .Add(xlTextString,)\n\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1564000581, "post_id": 57190728, "comment_id": 100891474, "body": "<code>Application</code> isn&#39;t a keyword (keywords get a bright blue syntax highlighting), it&#39;s a global object - <i>the</i> root object at the top of the host application&#39;s object model. That said I&#39;ve no idea what &quot;<i>the code which I use to get that character position only works within word because I&#39;m using the Application keyword within Excel and not within Word</i>&quot; means. Where are you <code>Set</code>ting the <code>objWord</code> reference? Without <code>Set objWord = New Word.Application</code>, the <code>Set doc = objWord.Application.Documents.Open(...)</code> instruction should blow up with error 91."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1564000750, "post_id": 57190728, "comment_id": 100891530, "body": "<code>ActiveDocument</code> will be <code>Nothing</code> if this code is executed hosted in Excel. You need to <code>Set doc = objWord.ActiveDocument</code> <i>after</i> setting the <code>objWord</code> reference."}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1564000781, "post_id": 57190728, "comment_id": 100891539, "body": "It means that my tocEnd variable becomes equal to 0 after I run the code above, in addition to having instantiated my word application object with this code <code>Set objWord = CreateObject(&quot;Word.Application&quot;)</code>. I don&#39;t get any errors and I do not have a <code>On error resume next</code> line ignoring errors."}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1564001130, "post_id": 57190728, "comment_id": 100891653, "body": "It&#39;s not because of Option Explicit, added it in the code. As I said, there is no error. I simply cannot get to use word&#39;s &quot;global object&quot; as you&#39;ve stated to find the character position after the table of contents"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1564001374, "post_id": 57190728, "comment_id": 100891750, "body": "Thanks for editing, it&#39;s clearer now... although it&#39;s still not making sense how <code>Set doc = objWord.Documents...</code> can work with <code>objWord</code> never being assigned anything in the top snippet)... Note that <code>doc.Application</code> is the very same <code>Application</code> object as <code>doc.TablesOfContents.Application</code> ...there&#39;s only one <code>Application.Selection</code> AFAIK; the selection doesn&#39;t belong to <code>TablesOfContents</code>, it belongs to <code>[Word.]Application</code>/<code>objWord</code>. Lastly, you aren&#39;t assigning <code>tocEnd</code> (it&#39;s not in the Excel/bottom snippet?), so... it&#39;s <code>0</code>."}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1564001698, "post_id": 57190728, "comment_id": 100891861, "body": "Yeah, sorry for the insufficient code (forgot to assign tocEnd) but it&#39;s basically what I get from <code>Debug.Print</code>."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1564027412, "post_id": 57190728, "comment_id": 100896965, "body": "Is there a reason you try to use exactly the same code within Word as within Excel? On the Excel side, I&#39;d use <code>tocEnd = objWord.Selection.End</code>. But even in the Word version I&#39;d simply use <code>Application.Selection.End</code>. If I absolutely had to get the <code>Application</code> object from the document I&#39;d use <code>Document.Parent.Selection</code>."}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1564063482, "post_id": 57190728, "comment_id": 100915033, "body": "So I just realized that the application isn&#39;t actually working. Not only that, <code>doc.tablesofcontents</code> is not always a non-zero value, though you do have a tables of contents, especially when it is a manual one. As a workaround, I&#39;m looping through fields and using if statements to get actual toc fields. Now the issue is that I don&#39;t know how to use a range object other than <code>Selection</code>. See edit"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "is_accepted": true, "score": 1, "last_activity_date": 1564072143, "creation_date": 1564072143, "answer_id": 57206515, "question_id": 57190728, "link": "https://stackoverflow.com/questions/57190728/how-to-force-excel-to-use-another-office-applications-word-application-attr/57206515#57206515", "title": "How to force excel to use another office application&#39;s (word) &quot;application&quot; attributes", "body": "<p>The problem in this case is not to do with using another application's object model.</p>\n\n<p>All that your code is picking up is the location of the beginning and end of the Selection in the Word application. But for example, all that the following line does:</p>\n\n<pre><code>doc.TablesOfContents.Application.Selection.End\n</code></pre>\n\n<p>is to use the Application member of the TablesOfContents object to return a reference to the Word Application. It doesn't tell word to select anything, so the code will just pick up the current Selection (whatever it is) and return the value of its End property. You would get the same result using, e.g. </p>\n\n<pre><code>objWord.Selection.End\n</code></pre>\n\n<p>(bearing in mind Mathieu Guidon's observation that your first code sample does not actually make sense, which suggests that your test code is currently doing something else, e.g. perhaps returning the location of the Selection in a document that is already open).</p>\n\n<p>Further, when you open a document in code, via the object model, the Selection would be at the beginning of the document, so you wouldn't get the result you wanted that way either.</p>\n\n<p>What you really need to do is create the Word app (or use GetObject to get an existing instance), open the document if it isn't open, then look at</p>\n\n<pre><code>doc.TablesOfContents.Count\n</code></pre>\n\n<p>If it's 0, there are no TOCs</p>\n\n<p>If it's >0, then the question is \"what location are you really trying to return?\"</p>\n\n<p>If it's the end of the first ToC, you would need something like</p>\n\n<pre><code>tocEnd = doc.TablesOfContents(1).Range.End\n</code></pre>\n\n<p>If it's the end of the last ToC, you would need something like </p>\n\n<pre><code>tocEnd = doc.TablesOfContents(doc.TablesOfContents.Count).Range.End\n</code></pre>\n\n<p>(I am currently a \"guest\" poster here so do not think I can follow this up!) </p>\n\n<p>In general the other things you need to do when accessing another program's object model are:\n a. always qualify the objects you use unambiguously. Otherwise, for example, VBA may confuse a Word Range and an Excel Range\n b. If you don't make a reference to the relevant object model via Tools->References (which people typically avoid doing when using Late Binding as you are doing, you can't use the named constants from that model. (You don't in your sample code, but I mention it because it's one of the most common problems in this area).</p>\n"}], "owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 57206515, "answer_count": 1, "score": 0, "last_activity_date": 1564072143, "creation_date": 1563999892, "last_edit_date": 1564063526, "question_id": 57190728, "link": "https://stackoverflow.com/questions/57190728/how-to-force-excel-to-use-another-office-applications-word-application-attr", "title": "How to force excel to use another office application&#39;s (word) &quot;application&quot; attributes", "body": "<p>I'm currently trying to get the character position of the paragraph/line right after a table of contents in a word document using VBA within excel. The issue is that the code which I use to get that character position only works within word because I'm using the <code>Application</code> keyword within Excel and not within Word. Is there a way to get that position in excel using VBA?</p>\n\n<p>As I've said, I've already found a way to get the character position in word:</p>\n\n<pre><code>Option Explicit\nSub test()\nDim doc As Document\nSet doc = ActiveDocument\nDim tocEnd As Long\nDim objWord As Word.Application\nDim inputPath As String\n\ninputPath = \"somepath\"\n\nSet doc = objWord.Documents.Open(inputPath)\n\nIf doc.TablesOfContents.Count = 1 Then tocEnd = doc.TablesOfContents.Application.Selection.Range.End Else tocEnd = 0\n\nDebug.Print doc.TablesOfContents.Application.Selection.End\n\nEnd Sub\n</code></pre>\n\n<p>Within excel, I use:</p>\n\n<pre><code>Option Explicit\nSub test()\n\nDim objWord As Object\nDim doc As Object\nDim inputDoc As String\n\ninputDoc = \"someinput\"\n\nSet objWord = CreateObject(\"Word.Application\")\n\nSet doc = objWord.Documents.Open(inputDoc)\n\nDebug.Print doc.TablesOfContents.Application.Selection.End\n\ntocEnd = doc.TablesOfContents.Application.Selection.End\n\ndoc.Close False\n\nEnd Sub\n</code></pre>\n\n<p>Within excel, my tocEnd variable becomes equal to 0. In word, it's the right character position.</p>\n\n<p>Code above not working, here's a workaround. I just don't know how to assign the fld.select range to a range variable, say <code>rng</code>.</p>\n\n<pre><code>Sub test()\n\nDim fld As Field\nDim rng As Range\n\nFor Each fld In ActiveDocument.Fields\n\n    If fld.Type = wdFieldTOC Or fld.Type = wdFieldTOCEntry Or fld.Type = wdFieldHyperlink Then\n        fld.Select\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 876, "user_id": 11754270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8oBTU.png?s=128&g=1", "display_name": "Legxis", "link": "https://stackoverflow.com/users/11754270/legxis"}, "is_accepted": true, "score": 1, "last_activity_date": 1564045337, "creation_date": 1564045337, "answer_id": 57198132, "question_id": 57190723, "link": "https://stackoverflow.com/questions/57190723/for-each-loop-text-from-color-x-to-y/57198132#57198132", "title": "For Each Loop - Text from color X to Y", "body": "<p>oSl is an object, so it needs to be set</p>\n\n<pre><code>Set oSl = ActivePresentation.Slides(2)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11735020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RS29ojJ4ieM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfTkLjWvzeeEqeibybz1HsqoD_P8g/photo.jpg?sz=128", "display_name": "Nicolas Bulgarides", "link": "https://stackoverflow.com/users/11735020/nicolas-bulgarides"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 57198132, "answer_count": 1, "score": 0, "last_activity_date": 1564045337, "creation_date": 1563999849, "question_id": 57190723, "link": "https://stackoverflow.com/questions/57190723/for-each-loop-text-from-color-x-to-y", "title": "For Each Loop - Text from color X to Y", "body": "<p>I'm making a rudimentary game in PPT using VBA for work. One of the components is a personality test with multiple choice questions. The way I have decided to do this is to have the four answers as separate text boxes, default color of black. When any text block is clicked, it will change the text in that textblock to red, and turn all other text blocks to black, so that only 1 text block is ever red at a time. A button at the bottom will determine which textbox has red text, and based off that save a variable in an array that will go into calculating the personality type.</p>\n\n<p>Right now, I'd like a loop statement that runs through a single slide to evaluate the text. Later on i'll modify it to accept a passed-in slide number (So I can use the function on every slide with questions). I'm not even worried about the if statement to decide when to swap color, I can't even get the loop to simply change ALL text (which should be so simple...)</p>\n\n<p>As I see it, the loop needs to:\n1) Check every object in a single pre-determined slide to see if it has text\n2) Change the color of all text to a color entered in the code.</p>\n\n<p>'''\nSub fontChangeWhy()</p>\n\n<pre><code>Dim oSl As Slide\nDim oSh As Shape\n\n\noSl = ActivePresentation.Slides(2)\n\n    For Each oSh In oSl.Shapes\n        If oSh.HasTextFrame Then\n            If oSh.TextFrame.HasText Then\n                oSh.TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0)\n            End If\n        End If\n    Next oSh\n</code></pre>\n\n<p>End Sub\n'''</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1564000163, "post_id": 57190605, "comment_id": 100891293, "body": "I&#39;m not sure we mean the same thing with &quot;header&quot;... In Word, the header is what appears at the top of every page, such as a page number or a date. (And a Footer is the bottom of the page.) Do you mean a <b>Heading</b>? Is it formatted with a built-in Heading style?"}, {"owner": {"reputation": 3, "user_id": 11832597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf0d0b44bde2c76927a28f586bdd6e1?s=128&d=identicon&r=PG&f=1", "display_name": "Arpee", "link": "https://stackoverflow.com/users/11832597/arpee"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1564000350, "post_id": 57190605, "comment_id": 100891372, "body": "Sorry, Yes @Cindy, I mean heading style specifically &quot;Title&quot;"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1564000451, "post_id": 57190605, "comment_id": 100891413, "body": "Arpee, &quot;Title&quot; is not a Heading style, just a &quot;regular&quot; style. Heading styles are Heading 1, Heading 2, etc. There&#39;d be a very simple way to do this if you were using a Heading style..."}, {"owner": {"reputation": 3, "user_id": 11832597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf0d0b44bde2c76927a28f586bdd6e1?s=128&d=identicon&r=PG&f=1", "display_name": "Arpee", "link": "https://stackoverflow.com/users/11832597/arpee"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1564000535, "post_id": 57190605, "comment_id": 100891454, "body": "Thanks for the correction Cindy, let&#39;s say it is &quot;Heading 1&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1564001789, "last_edit_date": 1564001789, "creation_date": 1564001098, "answer_id": 57190970, "question_id": 57190605, "link": "https://stackoverflow.com/questions/57190605/extract-heading-before-body-msword-vba/57190970#57190970", "title": "Extract Heading before Body (MSWord VBA)", "body": "<p>Word has some built-in bookmarks that make it easier to address certain parts of the document. Since they come from the old, Word Basic days, they work with the current selection.</p>\n\n<p>Thus, the code below first selects the spelling error, then the entire <em>heading level</em> in which the spelling error is located. From there, the first paragraph of the heading level (the text formatted with a Heading style) is picked up and assigned to the target cell in the code in the question.</p>\n\n<pre><code>Dim rng as Word.Range\nWith oRow                             \n    .Cells(1).Range.Text = oDoc.SpellingErrors(J).Information(wdActiveEndPageNumber)\n    .Cells(2).Range.Text = oDoc.SpellingErrors(J).Information(wdFirstCharacterLineNumber)\n    .Cells(3).Range.Text = oDoc.SpellingErrors(J)\n    oDoc.SpellingErrors(J).Select \n    Set rng = oDoc.Bookmarks(\"\\HeadingLevel\").Range\n    rng.Collapse wdCollapseStart\n    rng.MoveEnd wdParagraph, 1\n    rng.MoveEnd wdCharacter, -1\n   .Cells(4).Range.Text = rng.Text\n End With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11832597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf0d0b44bde2c76927a28f586bdd6e1?s=128&d=identicon&r=PG&f=1", "display_name": "Arpee", "link": "https://stackoverflow.com/users/11832597/arpee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 57190970, "answer_count": 1, "score": 0, "last_activity_date": 1564001789, "creation_date": 1563999268, "last_edit_date": 1564000583, "question_id": 57190605, "link": "https://stackoverflow.com/questions/57190605/extract-heading-before-body-msword-vba", "title": "Extract Heading before Body (MSWord VBA)", "body": "<p>I am working on a macro that will extract the wrong spelling in a Word file, I was able to search for a macro that can do just that, however I wanted to add a function that can also extract the heading preceding the body text. </p>\n\n<pre><code>With oRow                             \n    .Cells(1).Range.Text = oDoc.SpellingErrors(J).Information(wdActiveEndPageNumber)\n    .Cells(2).Range.Text = oDoc.SpellingErrors(J).Information(wdFirstCharacterLineNumber)\n    .Cells(3).Range.Text = oDoc.SpellingErrors(J)\n    .Cells(4).Range.Text = 'SHOULD CAPTURE THE HEADING                      \n End With\n</code></pre>\n\n<blockquote>\n  <p>*** Slide **** 2 Text</p>\n  \n  <p>Shape: Title 1 >> Text: The quick brown fox jumps over the lazy dog.\n  The quick brown fox jumps over the lazy dog. The quick brown fox jumps\n  over the lazy dog. The quick brown fox jumps over the lazy dog. The\n  quick brown fox jumps over the lazy dog. </p>\n  \n  <p>The quick brown fox jumps over the lazy dog. The quick brown fox jumps\n  over the lazy dog. The quick brownt fox jumps over the lazy dog. The\n  quick brown fox jumps over the lazy dog. The quick brown fox jumps\n  over the lazy dog.</p>\n</blockquote>\n\n<p>In the sample above, my existing macro is already extracting \"brownt\" because it is a wrong spelling. I need to add a line that will also capture \"*** Slide **** 2 Text\" because it is the heading of that paragraph.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1563998948, "post_id": 57190496, "comment_id": 100890879, "body": "Did you try Format: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563999210, "post_id": 57190496, "comment_id": 100890973, "body": "What is your default date format?  mm/dd/yyyy ?"}, {"owner": {"reputation": 15, "user_id": 11832524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc49b7c1204506cf5c47caf87339e18e?s=128&d=identicon&r=PG&f=1", "display_name": "L.Alon", "link": "https://stackoverflow.com/users/11832524/l-alon"}, "edited": false, "score": 0, "creation_date": 1564056231, "post_id": 57190496, "comment_id": 100910623, "body": "I already figure it out with thanks to Ron. My default date format is dd/mm (i&#39;m from Argentina).  I did try a simple Format(Range(&quot;E9&quot;), &quot;dd/mm/yyyy&quot;) and then copying that to another cell, just to see if that would work, and it did, so thanks a lot."}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1564049774, "last_edit_date": 1564049774, "creation_date": 1564004636, "answer_id": 57191645, "question_id": 57190496, "link": "https://stackoverflow.com/questions/57190496/days-and-months-reversing-when-changing-dot-for-slash-with-vba/57191645#57191645", "title": "Days and Months reversing when changing . (dot) for / (slash) with VBA", "body": "<p>From what you write, I am guessing that your dates are being imported as Text strings, and not real dates.  You can confirm this by executing the function <code>ISTEXT(cell_ref)</code> and seeing if it returns <code>TRUE</code> or <code>FALSE</code></p>\n\n<p>If some dates are <strong>real</strong> and others are text, you'll need to correct that earlier in the process -- either in SAP or in the import process.</p>\n\n<p>If you have control over the SAP code, you may be able to export them as real dates, rather than text strings, but I'm not familiar with that process.</p>\n\n<p>However, if they are all text, you can convert them with this macro.</p>\n\n<p>As written, it will convert all dates in column E to your desired format.  It will write the results in the adjacent column so you can compare with the original for debugging purposes, but you can easily change the code to overwrite if you prefer, or even put the results elsewhere.  </p>\n\n<p>The code will clear any contents of column F, so be sure to test this on a copy, not the original.</p>\n\n<p>You can also add error checking if you happen to have dot separated strings in column E that are not dates.</p>\n\n<p><strong>EDIT</strong>: Here is a simpler method than my original code:  <em>This uses the text-to-columns method which can also be used in native excel.</em>  As with the original, you can change from writing the results in the adjacent column to overwriting, in this case by removing the several references to <code>.Offset(0,1)</code>.</p>\n\n<hr>\n\n<pre><code>Option Explicit\nSub convDate()\n    Dim WS As Worksheet, R As Range\n\nSet WS = Worksheets(\"sheet1\")\nWith WS\n    Set R = .Range(.Cells(1, \"E\"), .Cells(.Rows.Count, \"E\").End(xlUp))\nEnd With\n\nWith R 'remove the \"offset(0,1) to overwrite\"\n    .TextToColumns Destination:=.Offset(0, 1), DataType:=xlDelimited, _\n         Tab:=False, semicolon:=False, comma:=False, Space:=False, other:=False, _\n         fieldinfo:=Array(1, xlDMYFormat)\n    .Offset(0, 1).EntireColumn.AutoFit\n    .Offset(0, 1).EntireColumn.NumberFormat = \"dd/mm/yyyy\"\nEnd With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Original Code</strong></p>\n\n<pre><code>Option Explicit\nSub convDates()\n    'assumes dates are a string with format of dd.mm.yyyy\n'declare variables\n  Dim WS As Worksheet, R As Range\n  Dim V As Variant, W As Variant, I As Long\n\nSet WS = Worksheets(\"sheet1\") 'alter to suit\n\n'set the Column E range\n'read column E into array\nWith WS\n    Set R = .Range(.Cells(1, \"E\"), .Cells(.Rows.Count, \"E\").End(xlUp))\n    V = R 'this will be a 1-based 2D array\nEnd With\n\nFor I = 1 To UBound(V, 1)\n    W = Split(V(I, 1), \".\")\n    If UBound(W) = 2 Then _\n        V(I, 1) = DateSerial(W(2), W(1), W(0))\nNext I\n\nWith R.Offset(columnoffset:=1)\n    .EntireColumn.Clear\n    .Value = V\n    .NumberFormat = \"dd/mm/yyyy\"\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/VyLD0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VyLD0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1564030178, "creation_date": 1564030178, "answer_id": 57194519, "question_id": 57190496, "link": "https://stackoverflow.com/questions/57190496/days-and-months-reversing-when-changing-dot-for-slash-with-vba/57194519#57194519", "title": "Days and Months reversing when changing . (dot) for / (slash) with VBA", "body": "<p>Use Excels ability to post to a range in one go then just copy and paste as values and replace the original location:</p>\n\n<pre><code>Sub FixDates()\nColumns(\"F:F\").Insert\nRange(\"E1:E8\").copy 'Doing this and the next line just in case you have headings you want to keep\nRange(\"F1:F8\").Paste\nRange(\"F9:F\" &amp; Range(\"E\" &amp; Rows.Count).End(xlUp).Row).Formula = \"=DATE(RIGHT(E1,4),MID(E1,FIND(\"\".\"\",E1,1)+1,FIND(\"\".\"\",E1,FIND(\"\".\"\",E1,1)+1)-FIND(\"\".\"\",E1,1)-1),LEFT(E1,FIND(\"\".\"\",E1,1)-1))\"\nRange(\"F9:F\" &amp; Range(\"E\" &amp; Rows.Count).End(xlUp).Row).Copy\nRange(\"F9:F\" &amp; Range(\"E\" &amp; Rows.Count).End(xlUp).Row).PasteSpecial xlPasteValues\nColumns(\"E:E\").Delete\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11832524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc49b7c1204506cf5c47caf87339e18e?s=128&d=identicon&r=PG&f=1", "display_name": "L.Alon", "link": "https://stackoverflow.com/users/11832524/l-alon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 57191645, "answer_count": 2, "score": 0, "last_activity_date": 1564049774, "creation_date": 1563998737, "question_id": 57190496, "link": "https://stackoverflow.com/questions/57190496/days-and-months-reversing-when-changing-dot-for-slash-with-vba", "title": "Days and Months reversing when changing . (dot) for / (slash) with VBA", "body": "<p>I'm currently trying to automate the actualization of a report where the new info is downloaded from SAP, the problem arises when i try to change a column with dates with the format dd.mm.yyyy to dd/mm/yyyy/.</p>\n\n<p>I'm not experienced in VBA, what i first try was to record what i would do in Excel, which is to select the whole column and replace (Ctrl+H) . for /\nBut when i run that Macro, the days &lt; 13 are swaped for the months. I also try to code the replacing, but with no avail.</p>\n\n<p>The column with dates is \"E\", and i only copy the informatio (no header).\nThe first thing i tried, recording a macro, returned,</p>\n\n<pre><code>Range(\"E9\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Replace What:=\".\", Replacement:=\"/\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n\n<p>And then what i manually tried to code was,</p>\n\n<pre><code>    Columns(\"E\").Replace What:=\"01.\", Replacement:=\"1/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"02.\", Replacement:=\"2/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"03.\", Replacement:=\"3/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"04.\", Replacement:=\"4/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"05.\", Replacement:=\"5/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"06.\", Replacement:=\"6/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"07.\", Replacement:=\"7/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"08.\", Replacement:=\"8/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"09.\", Replacement:=\"9/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"10.\", Replacement:=\"10/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"11.\", Replacement:=\"11/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"12.\", Replacement:=\"12/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"13.\", Replacement:=\"13/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"14.\", Replacement:=\"14/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"15.\", Replacement:=\"15/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"16.\", Replacement:=\"16/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"17.\", Replacement:=\"17/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"18.\", Replacement:=\"18/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"19.\", Replacement:=\"19/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"20.\", Replacement:=\"20/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"21.\", Replacement:=\"21/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"22.\", Replacement:=\"22/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"23.\", Replacement:=\"23/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"24.\", Replacement:=\"24/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"25.\", Replacement:=\"25/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"26.\", Replacement:=\"26/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"27.\", Replacement:=\"27/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"28.\", Replacement:=\"28/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"29.\", Replacement:=\"29/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"30.\", Replacement:=\"30/\", LookAt:=xlPart, MatchCase:=False\n    Columns(\"E\").Replace What:=\"31.\", Replacement:=\"31/\", LookAt:=xlPart, MatchCase:=False\n</code></pre>\n\n<p>(I know this wouldn't be efficient, but i just want the damn macro to work)</p>\n\n<p>I also tried to change the format of the cell with,</p>\n\n<p>Range(\"E9:E2905\").NumberFormat = \"dd/mm/yyyy\"</p>\n\n<p>What i expect is that when i change the cells to a date format the months and days are not swapped.</p>\n\n<p>If there are more info i can provide please tell me.\nThanks!</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563998920, "post_id": 57190494, "comment_id": 100890869, "body": "And what is the text of the error? No one memorizes the numbers..."}, {"owner": {"reputation": 1, "user_id": 11832580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oBcMHxsNlKk/AAAAAAAAAAI/AAAAAAAAAKM/w_yij6uNEvI/photo.jpg?sz=128", "display_name": "Andy P", "link": "https://stackoverflow.com/users/11832580/andy-p"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563999055, "post_id": 57190494, "comment_id": 100890922, "body": "&quot;Object variable or With block variable not set&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11832580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oBcMHxsNlKk/AAAAAAAAAAI/AAAAAAAAAKM/w_yij6uNEvI/photo.jpg?sz=128", "display_name": "Andy P", "link": "https://stackoverflow.com/users/11832580/andy-p"}, "edited": false, "score": 0, "creation_date": 1564001568, "post_id": 57190709, "comment_id": 100891816, "body": "Now the error is, &quot;Requested object is no available&quot;"}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 1, "creation_date": 1564041638, "post_id": 57190709, "comment_id": 100902559, "body": "AFAIK pdf is not a supported picture type."}, {"owner": {"reputation": 1, "user_id": 11832580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oBcMHxsNlKk/AAAAAAAAAAI/AAAAAAAAAKM/w_yij6uNEvI/photo.jpg?sz=128", "display_name": "Andy P", "link": "https://stackoverflow.com/users/11832580/andy-p"}, "edited": false, "score": 0, "creation_date": 1564055412, "post_id": 57190709, "comment_id": 100910227, "body": "Yes file path was corrected and it didn&#39;t work with JPG and PNG files either"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1564133996, "post_id": 57190709, "comment_id": 100938976, "body": "I&#39;m assuming the error is still on the <code>AddPicture</code> line and not elsewhere? Then the problem comes in narrowing down what object is meant. Try breaking the code down into multiple lines in order to isolate the problem. Example: <code>Dim sec as Word.Section : Set sec = .Sections(1) : Dim hdr as Word.HeaderFooter : Set hdr = sec.Headers(wdHeaderFooterPrimary)</code> and so on."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 2, "last_activity_date": 1563999809, "creation_date": 1563999809, "answer_id": 57190709, "question_id": 57190494, "link": "https://stackoverflow.com/questions/57190494/how-to-add-image-to-header/57190709#57190709", "title": "How to add image to header?", "body": "<p>Although Intellisense offers the objects used in the line of code causing the problem, it doesn't really work. That's because a Header (or Footer) is specific to a document <code>Section</code>. Every document has one section by default. Since the code is creating a new document from the default template, it will have one section.</p>\n\n<p>Then, each section has three possible header types. There can be one for the first page of the section, another for even pages (if the odd/even option is activated) and then there's the \"primary\" header/footer, which is what is generated by default in this scenario.</p>\n\n<p>Therefore, in order to address a header or footer, it's necessary to specify the section and the type of header/footer. The following adds the Shape to the default first section, primary header:</p>\n\n<pre><code>Sub CreateBasicWordReport()\n    Dim wdApp As Word.Application\n    Dim doc as Word.Document\n\n    Set wdApp = New Word.Application\n\n    With wdApp\n        .Visible = True\n        .Activate\n\n        Set doc = .Documents.Add\n        With doc\n           .Sections(1).Headers(wdHeaderFooterPrimary).Shapes.AddPicture _\n             \"C:\\Users\\[user_name]\\Desktop\\AHA Logo 2016.pdf\", True, _\n             False, 100, 75, -1, -1, True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11832580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oBcMHxsNlKk/AAAAAAAAAAI/AAAAAAAAAKM/w_yij6uNEvI/photo.jpg?sz=128", "display_name": "Andy P", "link": "https://stackoverflow.com/users/11832580/andy-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565882400, "creation_date": 1563998729, "last_edit_date": 1565882400, "question_id": 57190494, "link": "https://stackoverflow.com/questions/57190494/how-to-add-image-to-header", "title": "How to add image to header?", "body": "<p>I'm trying to add an image to the header of my VBA generated Word document.</p>\n\n<pre><code>Sub CreateBasicWordReport()\n    Dim wdApp As Word.Application\n\n    Set wdApp = New Word.Application\n\n    With wdApp\n        .Visible = True\n        .Activate\n\n        .Documents.Add\n        With .Selection\n            .HeaderFooter.Shapes.AddPicture _\n             \"C:\\Users\\[user_name]\\Desktop\\AHA Logo 2016.pdf\", True, _\n             False, 100, 75, -1, -1, True\n</code></pre>\n\n<p>The code runs until I get to the last line. Then I get</p>\n\n<blockquote>\n  <p>Runtime error 91:<br>\n  Object variable or With block variable not set</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1563998718, "post_id": 57190464, "comment_id": 100890772, "body": "<code>Cells(nLevel1Position, iColumn + x).Formula = Cells(nLevel1Position, iColumn).Formula</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1563998768, "post_id": 57190464, "comment_id": 100890793, "body": "Do not use <code>.Select</code> or <code>.Activate</code> See: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 475, "user_id": 1290271, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/WZXD4.png?s=128&g=1", "display_name": "Deep in Development", "link": "https://stackoverflow.com/users/1290271/deep-in-development"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1563998990, "post_id": 57190464, "comment_id": 100890893, "body": "I had tried Cells(nLevel1Position, iColumn + x).Formula = Cells(nLevel1Position, iColumn).Formula but the result calculate value is not correct."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1563999122, "post_id": 57190464, "comment_id": 100890945, "body": "If you show more of your code we can help more.  At least show how you set the variables"}, {"owner": {"reputation": 475, "user_id": 1290271, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/WZXD4.png?s=128&g=1", "display_name": "Deep in Development", "link": "https://stackoverflow.com/users/1290271/deep-in-development"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1563999804, "post_id": 57190464, "comment_id": 100891181, "body": "Hi Scott, Please see updated post with more code. many thanks!"}, {"owner": {"reputation": 475, "user_id": 1290271, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/WZXD4.png?s=128&g=1", "display_name": "Deep in Development", "link": "https://stackoverflow.com/users/1290271/deep-in-development"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1564004418, "post_id": 57190464, "comment_id": 100892751, "body": "Hi Scott, the original code copy Cells(11,13).Formula &quot;=SUM(M12:M13)&quot; to Cells(11,14).Formula, Cells(11,14).Formula becomes to &quot;=SUM(N12:N13), Do you know Why?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564061810, "post_id": 57190464, "comment_id": 100913981, "body": "@DeepinDevelopment That is because Excel adjusts formulas automatically (by default). You can stop that by using <code>$</code> like <code>=SUM($M12:$M13)</code> to fix the column or <code>=SUM($M$12:$M$13)</code> to fix column and row."}], "owner": {"reputation": 475, "user_id": 1290271, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/WZXD4.png?s=128&g=1", "display_name": "Deep in Development", "link": "https://stackoverflow.com/users/1290271/deep-in-development"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1564061681, "creation_date": 1563998611, "last_edit_date": 1564061681, "question_id": 57190464, "link": "https://stackoverflow.com/questions/57190464/excel-vba-optimize", "title": "Excel VBA optimize", "body": "<p>I have below Excel VBA code in many places. It need to optimize to improve running speed. I do appreciate your help.</p>\n\n<p>Someone within a loop:</p>\n\n<pre><code>For x = A_OFFSET_MARKETVALUE To A_OFFSET_CURRENT\n    Cells(nLevel1Position, iColumn).Select\n    Selection.Copy\n    Cells(nLevel1Position, iColumn + x).Select\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nNext x\n</code></pre>\n\n<p>For example: the above code copy <code>Cells(11,13).Formula \"=SUM(M12:M13)\"</code> to <code>Cells(11,14).Formula</code>, After copy and <code>xlPasteFormulas</code>  <code>Cells(11,14).Formula</code> becomes <code>\"=SUM(N12:N13)</code> does anybody know why? But the result is expected. So if I use below code to optimized it</p>\n\n<pre><code>Cells(nLevel1Position, iColumn + x).Formula = Cells(nLevel1Position, iColumn).Formula\n</code></pre>\n\n<p>The <code>Cells(11,14).Formula</code> always is <code>\"=SUM(M12:M13)\"</code>. I do not know why? How should I optimized it and also get <code>Cells(11,14).Formula</code> value <code>\"=SUM(N12:N13)\"</code></p>\n\n<p>Someone is not in a loop:</p>\n\n<pre><code>Cells(nLevel1Position, iColumn).Select\nSelection.Copy\nCells(nLevel1Position, iColumn + A_OFFSET_MARKETVALUE).Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>The whole code is below for reference. There are many places need to be optimized. Unfortunately, I am very new to VBA,and my boss required it to be done in a very short time. So anybody can help me will be greate appreciated.\nMany many thanks.</p>\n"}, {"tags": ["excel", "vba", "string"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1564000328, "post_id": 57190361, "comment_id": 100891367, "body": "Why do you have SQL code here? You state Excel and VBA, have you tried VBA code?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11832504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3445c0d5d215fbca6702f5eb05233a1c?s=128&d=identicon&r=PG&f=1", "display_name": "John Marks", "link": "https://stackoverflow.com/users/11832504/john-marks"}, "edited": false, "score": 0, "creation_date": 1564016159, "post_id": 57190967, "comment_id": 100895120, "body": "Thank you, I tried it and I get activex component can&#39;t create object, not sure why it has an issue with the line:   Set TargetColumns = CreateObject(&quot;SCRIPTING.DICTIONARY&quot;)  This is on Excel 2019, I&#39;ll try this on an earlier version tomorrow."}, {"owner": {"reputation": 206, "user_id": 11818994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c050a383af330645586490c295e340d2?s=128&d=identicon&r=PG", "display_name": "Random User", "link": "https://stackoverflow.com/users/11818994/random-user"}, "reply_to_user": {"reputation": 5, "user_id": 11832504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3445c0d5d215fbca6702f5eb05233a1c?s=128&d=identicon&r=PG&f=1", "display_name": "John Marks", "link": "https://stackoverflow.com/users/11832504/john-marks"}, "edited": false, "score": 0, "creation_date": 1564046632, "post_id": 57190967, "comment_id": 100905399, "body": "Are you using windows ? As far as I know, scripting.dictionary is not available on other operating systems."}, {"owner": {"reputation": 206, "user_id": 11818994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c050a383af330645586490c295e340d2?s=128&d=identicon&r=PG", "display_name": "Random User", "link": "https://stackoverflow.com/users/11818994/random-user"}, "reply_to_user": {"reputation": 5, "user_id": 11832504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3445c0d5d215fbca6702f5eb05233a1c?s=128&d=identicon&r=PG&f=1", "display_name": "John Marks", "link": "https://stackoverflow.com/users/11832504/john-marks"}, "edited": false, "score": 0, "creation_date": 1564064410, "post_id": 57190967, "comment_id": 100915563, "body": "I have edited my previous answer with a solution that does not use dictionaries. Be aware though that i assume the headers are restricted to the &quot;X-Y-Z-V-G&quot; values. Don&#39;t forget to edit the Datarange (cells in which you have the data that you want to split over several columns) and FirstWriteBackColumn (First column in which you start to write data)."}, {"owner": {"reputation": 5, "user_id": 11832504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3445c0d5d215fbca6702f5eb05233a1c?s=128&d=identicon&r=PG&f=1", "display_name": "John Marks", "link": "https://stackoverflow.com/users/11832504/john-marks"}, "edited": false, "score": 0, "creation_date": 1564086794, "post_id": 57190967, "comment_id": 100925923, "body": "Wow, your help is seriously beyond appreciated. Your original solution worked like a charm, you were correct, I was doing my testing on a mac and today tried on windows and it worked flawlessly. I seriously really appreciate your help and efforts on this. You are a good human being."}], "tags": [], "owner": {"reputation": 206, "user_id": 11818994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c050a383af330645586490c295e340d2?s=128&d=identicon&r=PG", "display_name": "Random User", "link": "https://stackoverflow.com/users/11818994/random-user"}, "is_accepted": true, "score": 0, "last_activity_date": 1564067648, "last_edit_date": 1564067648, "creation_date": 1564001086, "answer_id": 57190967, "question_id": 57190361, "link": "https://stackoverflow.com/questions/57190361/how-to-separate-a-column-of-cells-with-multiple-values-delimited-into-new-colu/57190967#57190967", "title": "How to separate a column of cells with multiple values (delimited) into new columns and add a header", "body": "<p>Maybe you could try the following code, using dictionaries. It's rather messy, and it could probably be done in simpler way, but it seems to work. Just edit the datarange line.</p>\n\n<pre><code>Option Explicit\nSub DataRange()\n    Dim DataRange As Range\n    Dim DataSheet As Worksheet\n    Dim c As Range\n    Dim DataString As String\n    Dim DataDictionary As Object 'SCRIPTING.DICTIONARY\n    Dim TargetColumns As Object 'SCRIPTING.DICTIONARY\n    Dim TargetColumn As Long\n    Dim Key As String\n    Dim TargetAddress As String\n\n    Dim xlCurrentCalculation As XlCalculation\n    Dim i As Long\n    TargetColumn = 2\n\n    xlCurrentCalculation = Application.Calculation\n    Application.Calculation = xlCalculationManual\n'#############################################################################################\n    Set DataRange = ActiveSheet.Range(\"A2:A21\") 'EDIT THIS LINE WITH ACTUAL DATA ADDRESS\n'#############################################################################################\n    Set DataSheet = DataRange.Parent\n    Set TargetColumns = CreateObject(\"SCRIPTING.DICTIONARY\")\n    For Each c In DataRange\n        DataString = CStr(c)\n        Set DataDictionary = DataStringToDataDictionary(DataString)\n        For i = 0 To DataDictionary.Count - 1\n            Key = DataDictionary.keys()(i)\n            If Not TargetColumns.exists(Key) Then\n                TargetColumns.Add Key, TargetColumn\n                TargetColumn = TargetColumn + 1\n            End If\n            TargetAddress = TargetColumns(Key) &amp; c.Row\n            DataSheet.Cells(c.Row, TargetColumns.Item(Key)) = DataDictionary.items()(i)\n        Next i\n    Next c\n    For i = 0 To TargetColumns.Count - 1\n        DataSheet.Cells(1, TargetColumns.items()(i)) = TargetColumns.keys()(i)\n    Next i\n\n    'Uncomment the following line to delete the column of the data containing the range.\n    'It will create an offset in written data though\n    'DataRange.EntireColumn.Delete\n    Application.Calculate\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\nFunction DataStringToDataDictionary(DataString As String)\n\n    Dim DataArray() As String\n    Dim DataSubArray() As String\n    Dim DataDictionary As Object 'SCRIPTING.DICTIONARY\n    Dim Key As String\n    Dim Value As String\n    Dim i As Long\n\n    DataArray = Split(DataString, \";\")\n    'We ignore first element of the array, as we assume it contains the word \"Data\"\n\n    Set DataDictionary = CreateObject(\"SCRIPTING.DICTIONARY\")\n    For i = 1 To UBound(DataArray)\n        DataSubArray = Split(DataArray(i), \"=\")\n        Key = DataSubArray(0)\n        Value = DataSubArray(1)\n        DataDictionary.Add Key, Value\n    Next i\n\n    Set DataStringToDataDictionary = DataDictionary\n\nEnd Function\n</code></pre>\n\n<p>Edit :</p>\n\n<pre><code>If the previous code does not work, you could also try the following :\n\n\nSub SplittingDataWithoutDictionary()\n    Dim DataRange As Range\n    Dim DataSheet As Worksheet\n    Dim c As Range\n    Dim DataArray() As String\n    Dim DataSubArray() As String\n    Dim HeadersLabels() As Variant\n    Dim i As Long\n    Dim FirstWriteBackColumn As Long\n    Dim Index As Long\n    Dim Value As String\n\n    Dim xlCurrentCalculation As XlCalculation\n\n    xlCurrentCalculation = Application.Calculation\n    Application.Calculation = xlCalculationManual\n\n\n    HeadersLabels = Array(\"X\", \"Y\", \"Z\", \"V\", \"G\")\n\n    Set DataRange = ActiveSheet.Range(\"A2:A20\") 'Edit with the actual range you want to split\n    Set DataSheet = DataRange.Worksheet\n    FirstWriteBackColumn = 2 'Edit with the first column in which you want to write back data\n\n    For Each c In DataRange\n        DataArray = Split(CStr(c), \";\")\n        For i = 1 To UBound(DataArray)\n            DataSubArray = Split(DataArray(i), \"=\")\n            Index = FetchIndexInArray(HeadersLabels, DataSubArray(0))\n            Value = DataSubArray(1)\n            DataSheet.Cells(c.Row, FirstWriteBackColumn + Index) = Value\n        Next i\n    Next c\n    For i = 0 To UBound(HeadersLabels)\n        DataSheet.Cells(1, i + FirstWriteBackColumn) = HeadersLabels(i)\n    Next i\n    'Datarange.entirecolumn.delete\n    Application.Calculation = xlCurrentCalculation\nEnd Sub\n\nFunction FetchIndexInArray(StringArray() As Variant, LookFor As String) As Long\n    Dim i As Long\n\n    For i = LBound(StringArray) To UBound(StringArray)\n        If StringArray(i) = LookFor Then\n            FetchIndexInArray = i\n            Exit Function\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11832504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3445c0d5d215fbca6702f5eb05233a1c?s=128&d=identicon&r=PG&f=1", "display_name": "John Marks", "link": "https://stackoverflow.com/users/11832504/john-marks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57190967, "answer_count": 1, "score": 0, "last_activity_date": 1564067648, "creation_date": 1563998107, "question_id": 57190361, "link": "https://stackoverflow.com/questions/57190361/how-to-separate-a-column-of-cells-with-multiple-values-delimited-into-new-colu", "title": "How to separate a column of cells with multiple values (delimited) into new columns and add a header", "body": "<p>I have a spreadsheet containing a column that has data that looks like this:</p>\n\n<p>Data;X=7.9;Y=9.1;Z=2;V=4;G=8</p>\n\n<p>What I'm trying to do is essentially ignore 'Data;', then create new columns to the right with the associated values, in addition to adding the identifier (X,Y,Z,V or G) as the column header. Then delete the original column where the data string came from.</p>\n\n<p>I have tried to do this with Text to Column, but it puts data in cells like this: X=7.9 etc.. When I wanted 7.9 in the field and so on per row, with the top (header) first cell contains X,Y,Z,V or G.</p>\n\n<p>I suppose I may be able to utilize split text after, but at this point would prefer to do this in vba if possible.</p>\n\n<p>I tried this, but couldn't get it to work with ; instead of |, but I'm not sure if it would add the column header as well, so probably not what I'm looking for.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DECLARE @t table (\n   piped varchar(50)\n)\n\nINSERT INTO @t (piped)\n  VALUES ('pipe|delimited|values')\n       , ('a|b|c');\n\n; WITH x AS (\n  SELECT piped\n       , CharIndex('|', piped) As first_pipe\n  FROM   @t\n)\n, y AS (\n  SELECT piped\n       , first_pipe\n       , CharIndex('|', piped, first_pipe + 1) As second_pipe\n       , SubString(piped, 0, first_pipe) As first_element\n  FROM   x\n)\n, z AS (\n  SELECT piped\n       , first_pipe\n       , second_pipe\n       , first_element\n       , SubString(piped, first_pipe  + 1, second_pipe - first_pipe - 1) As second_element\n       , SubString(piped, second_pipe + 1, Len(piped) - second_pipe) As third_element\n  FROM   y\n)\nSELECT *\nFROM   z\n</code></pre>\n"}, {"tags": ["excel", "vba", "error-handling", "automation"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 2, "creation_date": 1563996679, "post_id": 57190019, "comment_id": 100889919, "body": "On which line is the error?"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1563996931, "post_id": 57190019, "comment_id": 100890030, "body": "I appologize... adding it in now"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1563997312, "post_id": 57190019, "comment_id": 100890181, "body": "@Warcupine its on the .Sheets(x).Delete"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1563997339, "post_id": 57190019, "comment_id": 100890191, "body": "FYI it&#39;s <code>ElseIf</code>, not <code>Else If</code>.  Also, if your workbook doesn&#39;t have a sheet called &quot;Paste&quot;, the first <code>If</code> statement will still run (<code>Indx</code> here is <code>0</code>). I assume that&#39;s correct and what you want...Finally, make sure that your <code>For</code> loop won&#39;t try and delete the single, remaining sheet."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 3, "creation_date": 1563997464, "post_id": 57190019, "comment_id": 100890235, "body": "Consider what happens when <code>Indx = 0</code>."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1563998138, "post_id": 57190019, "comment_id": 100890507, "body": "@BruceWayne, I have sheets titled Value, then &quot;Paste&quot;. My original macro makes several sheets after &quot;Paste&quot;, and I want this macro to delete all those sheets. When I run this current macro, those sheets all delete(not Value or Paste), but this error message still pops up"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1563999429, "post_id": 57190019, "comment_id": 100891051, "body": "@GSerg what happens when that occurs? If I take the elseif part out i still ahve this issue"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1564001921, "post_id": 57190019, "comment_id": 100891952, "body": "Why not then loop through sheets and do like <code>Dim ws as Worksheet &#47; For each ws in Thisworkbook.Worksheets &#47; If ws.Name &lt;&gt; &quot;Paste&quot; and ws.Name &lt;&gt; &quot;Value&quot; Then ws.Delete &#47; Next ws</code>?  (It&#39;s a workaround, as I don&#39;t know why you get that error still...)"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564002228, "post_id": 57190019, "comment_id": 100892058, "body": "Well the elseif part does not handle the 0 value, does it? When 0 it will try to remove all sheets, and there must remain at least one."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1564076154, "post_id": 57190019, "comment_id": 100921390, "body": "@BruceWayne  this works much better. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1564077385, "creation_date": 1564077385, "answer_id": 57207753, "question_id": 57190019, "link": "https://stackoverflow.com/questions/57190019/vba-message-automation-error-element-not-found/57207753#57207753", "title": "VBA message automation error element not found", "body": "<p>Since you know that you want to keep two specific sheets (\"Value\" and \"Paste\"), instead of using the indexes, which can be a little tricky and may not always work depending on the order/added order of them, I suggest instead looking at the name of each worksheet and delete that way (as mentioned in the comments).</p>\n\n<pre><code>Dim ws as Worksheet\n' This next line will suppress the \"Confirm Deleting\" messagebox\n' when you go to delete a worksheet\nApplication.DisplayAlerts = False\nFor each ws in ThisWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Value\" and ws.Name &lt;&gt; \"Paste\" Then\n        ws.Delete\n    End If\nNext ws\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>(This assumes the macro is stored in the workbook you want to delete the sheets from. If it's not, perhaps it's stored in Personal.xlsb, then switch <code>ThisWorkbook</code> to <code>ActiveWorkbook</code> or something more specific.)</p>\n"}], "owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 57207753, "answer_count": 1, "score": 0, "last_activity_date": 1564077385, "creation_date": 1563996553, "last_edit_date": 1563998061, "question_id": 57190019, "link": "https://stackoverflow.com/questions/57190019/vba-message-automation-error-element-not-found", "title": "VBA message automation error element not found", "body": "<p>I have a workbook that uses a macro and makes many sheets. After one sheet, called Paste, I want to be able to delete the sheets that follow once I am done using them. </p>\n\n<p>I found the following code from <a href=\"https://stackoverflow.com/a/53544169/11615632\">https://stackoverflow.com/a/53544169/11615632</a> and slightly modified it to use in my workbook.  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Deleting()\n    Dim Indx As Long\n    Dim x As Long\n\n    With ThisWorkbook\n        On Error Resume Next\n        Indx = .Sheets(\"Paste\").Index\n        On Error GoTo 0\n\n        If Indx &lt;&gt; 1 Then\n            If .Sheets.Count &gt; 2 And Indx &lt; .Sheets.Count Then\n                Application.DisplayAlerts = False\n                For x = .Sheets.Count To Indx + 1 Step -1\n                    .Sheets(x).Delete\n\n                    On Error GoTo 0\n                Next x\n                Application.DisplayAlerts = False\n            End If\n        Elseif Indx = 1 Then\n            Exit Sub\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>However, when I do this it actually <em>works, but</em> I get an error message saying </p>\n\n<blockquote>\n  <p>\"Run-time error '-2147319765':<br>\n     Automation Error<br>\n     Element not found. </p>\n</blockquote>\n\n<p>The error is found on the line <code>.Sheets(x).Delete</code></p>\n"}, {"tags": ["python", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563999070, "post_id": 57189902, "comment_id": 100890931, "body": "See: <a href=\"https://stackoverflow.com/q/1009860/1188513\">stackoverflow.com/q/1009860/1188513</a>"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1563999421, "creation_date": 1563999421, "answer_id": 57190641, "question_id": 57189902, "link": "https://stackoverflow.com/questions/57189902/is-there-a-way-to-reference-the-active-workbook-when-calling-a-python-program-vi/57190641#57190641", "title": "Is there a way to reference the active workbook when calling a python program via vba in excel?", "body": "<p>Pass them as <a href=\"https://stackoverflow.com/a/1009864/1188513\">command-line arguments</a>.</p>\n\n<pre><code>from argparse import ArgumentParser\nimport openpyxl\n\nparser = ArgumentParser()\nparser.add_argument(\"-f\", \"--file\", dest=\"filename\",\n                    help=\"the full path of the Excel workbook to work with\", metavar=\"XLWB\")    \nargs = parser.parse_args()\nwb = openpyxl.load_workbook(args.filename)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 11765363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ffaee7b71f8eab85d195a0783444fc0?s=128&d=identicon&r=PG&f=1", "display_name": "jrwaller", "link": "https://stackoverflow.com/users/11765363/jrwaller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 57190641, "answer_count": 1, "score": 1, "last_activity_date": 1563999421, "creation_date": 1563996133, "question_id": 57189902, "link": "https://stackoverflow.com/questions/57189902/is-there-a-way-to-reference-the-active-workbook-when-calling-a-python-program-vi", "title": "Is there a way to reference the active workbook when calling a python program via vba in excel?", "body": "<p>I am trying to call a python script via a macro in excel. This script needs to reference the excel file it is being called from.</p>\n\n<p>I know that this question offers help regarding how to call the script in vba:\n<a href=\"https://stackoverflow.com/questions/18135551/how-to-call-python-script-on-excel-vba\">How to call python script on excel vba?</a>\nHowever, my python script immediately tries to reference the excel docs path/name. Is there a way to assign a variable to these values? My python code (see below) needs a reference path/doc to pull the correct data from excel.</p>\n\n<pre><code>workbook_path = r'C:\\Users\\jrwaller\\Documents\\Automated Eve'\nworkbook_name = r'PMT Project 13.xlsx' \nimport openpyxl\nwb = openpyxl.load_workbook(fr'{workbook_path}\\{workbook_name}')\n</code></pre>\n\n<p>Where the path and name could be changed from project to project.\nIs there a way to assign the workbook ordering the script to run as wb?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 0, "last_activity_date": 1563999623, "creation_date": 1563999623, "answer_id": 57190686, "question_id": 57189568, "link": "https://stackoverflow.com/questions/57189568/need-to-delete-or-hide-rows-showing-blank-but-have-formulas-in-them/57190686#57190686", "title": "Need to Delete or hide rows showing blank. But have formulas in them", "body": "<p>The code below will delete all rows in the used range of the active sheet without display values, i.e. both rows that contain formulas where the display conditions are not met AND entirely blank rows:</p>\n\n<pre><code>Public Sub DeleteAllEmptyRows()\n\n    Dim LastRowIndex As Integer, RowIndex As Integer\n    Dim UsedRng As Range\n\n    Application.ScreenUpdating = False\n\n    Set UsedRng = ActiveSheet.UsedRange\n    LastRowIndex = UsedRng.Row - 1 + UsedRng.Rows.Count\n\n    For RowIndex = LastRowIndex To 1 Step -1\n        If WorksheetFunction.CountIf(Rows(RowIndex), \"?*\") = 0 Then\n            Rows(RowIndex).Delete\n        End If\n    Next RowIndex\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11819270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92ac1fd20e055286fc206ce1417ea73?s=128&d=identicon&r=PG&f=1", "display_name": "joelouis", "link": "https://stackoverflow.com/users/11819270/joelouis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564038740, "creation_date": 1563994671, "last_edit_date": 1564038740, "question_id": 57189568, "link": "https://stackoverflow.com/questions/57189568/need-to-delete-or-hide-rows-showing-blank-but-have-formulas-in-them", "title": "Need to Delete or hide rows showing blank. But have formulas in them", "body": "<p>Having trouble coming up with a way to remove blank rows after my code runs. The code works great, it compares two sets of data together to show the differences and return the PK and its associated row.  </p>\n\n<p>I have tried multiple delete functions/VBA code but cant seem to find one that does what I want. The Code below delets empty rows, but not rows with formulas. </p>\n\n<pre><code>Public Sub DeleteAllEmptyRows()\n    Dim LastRowIndex As Integer\n    Dim RowIndex As Integer\n    Dim UsedRng As Range\n\n    Set UsedRng = ActiveSheet.UsedRange\n    LastRowIndex = UsedRng.Row - 1 + UsedRng.Rows.Count\n    Application.ScreenUpdating = False\n\n    For RowIndex = LastRowIndex To 1 Step -1\n        If Application.CountA(Rows(RowIndex)) = 0 Then\n            Rows(RowIndex).Delete\n        End If\n    Next RowIndex\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Deleted unnecessary rows to provide formatted rows.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2013"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1563994325, "post_id": 57189417, "comment_id": 100888935, "body": "Is the order always <code>CN,OU,DC</code> and you only want the <code>OU</code>?"}, {"owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1563994398, "post_id": 57189417, "comment_id": 100888964, "body": "@ScottCraner yes"}], "answers": [{"comments": [{"owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "edited": false, "score": 0, "creation_date": 1563995055, "post_id": 57189530, "comment_id": 100889178, "body": "Thank you Scott."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1563994468, "creation_date": 1563994468, "answer_id": 57189530, "question_id": 57189417, "link": "https://stackoverflow.com/questions/57189417/how-to-create-columns-in-excel-2013-using-info-from-another-column-via-vba/57189530#57189530", "title": "How to create columns in Excel 2013 using info from another column via VBA?", "body": "<p>With your data starting in A2, put this in B2:</p>\n\n<pre><code>=TRIM(MID(SUBSTITUTE(MID($A2,FIND(\",OU=\",$A2)+4,FIND(\",DC=\",$A2)-FIND(\",OU=\",$A2)-4),\",OU=\",REPT(\" \",999)),(COLUMN(A:A)-1)*999+1,999))\n</code></pre>\n\n<p>And copy over and down.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ubcf3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ubcf3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1564035540, "accepted_answer_id": 57189530, "answer_count": 1, "score": -2, "last_activity_date": 1564038731, "creation_date": 1563993948, "last_edit_date": 1564038731, "question_id": 57189417, "link": "https://stackoverflow.com/questions/57189417/how-to-create-columns-in-excel-2013-using-info-from-another-column-via-vba", "closed_reason": "Needs more focus", "title": "How to create columns in Excel 2013 using info from another column via VBA?", "body": "<p>I have a column (say <em>MyOriginalColumn</em>) in Excel 2013 including 300+ rows (<em>OriginalData</em> let's say), 3 of them are given as an example below:</p>\n\n<pre><code>CN=myCN1,OU=Workstation,OU=123 (Edmonton),OU=Canada,OU=Company1,OU=Domain Computer,DC=xyz,DC=local\nCN=myCN2,OU=Local Server,OU=Germany,OU=Company2,DC=xyz,DC=local\nCN=myCN3,OU=Disabled,DC=xyz,DC=local\n...\n</code></pre>\n\n<p>We know maximum number of OU value a row has is 5. What I want to do is to add OU columns to excel. The output should be look like:</p>\n\n<pre><code>MyOriginalcolumn    OU1            OU2               OU3       OU4         OU5\nOriginalData        Workstation    123 (Edmonton)    Canada    Company1    Domain Computer\nOriginalData        Local Server   Germany           Company2  \nOriginalData        Disabled \n...\n</code></pre>\n\n<p>I am doing it by reading the data from excel via C#, but I wonder if there is any way to directly perform it in Excel, via an Excel script. </p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "ms-word", "ribbonx"], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1564000009, "post_id": 57189790, "comment_id": 100891246, "body": "This does not address the question asked: &quot;Does anyone know how I can access a specific <b>user-defined tab</b> in the ribbon so I can get access to read properties on a specific control?&quot;"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1564000196, "post_id": 57189790, "comment_id": 100891309, "body": "Some properties can be read by using <code>CommandBars</code> methods. The <code>CommandBars</code> object doesn&#39;t contain ribbon controls. That&#39;s what it states. Do you still think that it didn&#39;t answer the question?"}, {"owner": {"reputation": 315, "user_id": 5919453, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7d51217c2b23c42385baf7e50fc72950?s=128&d=identicon&r=PG&f=1", "display_name": "Steve G.", "link": "https://stackoverflow.com/users/5919453/steve-g"}, "edited": false, "score": 0, "creation_date": 1564438198, "post_id": 57189790, "comment_id": 101023069, "body": "My end goal for this time is to read the icon used for a ribbon control in a user-defined ribbon tab. I want to take that icon and apply it to the FaceId of a context-menu/right-click-menu option. Is that possible in MS Word? I&#39;ve been combing the Internet for any clue on how to do this, but I haven&#39;t found anything that helps. I&#39;ll check the links that @EugeneAstafiev posted above, but in the meantime...."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1564439032, "post_id": 57189790, "comment_id": 101023264, "body": "You must extract the icon or image and use it for your custom UI. The Fluent UI (aka Ribbon UI) doesn&#39;t provide anything for doing such actions at runtime."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": -1, "last_activity_date": 1564000210, "last_edit_date": 1564000210, "creation_date": 1563995628, "answer_id": 57189790, "question_id": 57189381, "link": "https://stackoverflow.com/questions/57189381/how-can-i-access-a-specific-control-in-a-user-created-tab-in-the-ribbon/57189790#57189790", "title": "How can I access a specific control in a user-created tab in the ribbon?", "body": "<p>The <code>CommandBars</code> property returns a <code>CommandBars</code> object that represents the Microsoft Word command bars. Used with the <code>Application</code> object, this property returns the set of built-in and custom command bars available to the application. But it doesn't contain ribbon controls. If you need to perform any action against the command bars controls you may use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/office.commandbars\" rel=\"nofollow noreferrer\">CommandBars</a> methods. For example, you can check whether a particular control is visible or not passing the <code>idMso</code> name of the built-in control:</p>\n\n<pre><code> Application.CommandBars.GetVisibleMso(\"Bold\")\n</code></pre>\n\n<p>The Fluent UI (aka Ribbon UI) in the following series of articles:</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/aa338202(v=office.12)\" rel=\"nofollow noreferrer\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 1 of 3)</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/aa338199(v=office.12)\" rel=\"nofollow noreferrer\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 2 of 3)</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/aa722523(v=office.12)\" rel=\"nofollow noreferrer\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 3 of 3)</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": -1, "last_activity_date": 1563998649, "creation_date": 1563998649, "answer_id": 57190477, "question_id": 57189381, "link": "https://stackoverflow.com/questions/57189381/how-can-i-access-a-specific-control-in-a-user-created-tab-in-the-ribbon/57190477#57190477", "title": "How can I access a specific control in a user-created tab in the ribbon?", "body": "<p>By design, it is not possible to address a user-defined Ribbon control through VBA. The reason for this design decision is that, in the days of toolbars/command bars (pre-Word 2007) too many \"add-ins\" were subverting these so that the Office applications were not working the way people expected them to - and Microsoft usually got the blame for \"buggy software\".</p>\n\n<p>So Ribbon XML is \"sand-boxed\". There are some limited commands in the <code>CommandBars</code> object model that allow checking whether a <em>built-in</em> Ribbon control is visible, or enabled, and allows execution of that control. But this does not extend to custom Ribbon controls - those are \"private\" to the project that defines them.</p>\n\n<p><em>If</em> the \"owner\" of a Ribbon customization consciously enables \"sharing\" of any Ribbon controls (through the use of <code>idQ</code>) it's possible to access them  (using \"callbacks\") through another Ribbon XML solution, running in parallel. But that's the only exception. </p>\n"}], "owner": {"reputation": 315, "user_id": 5919453, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7d51217c2b23c42385baf7e50fc72950?s=128&d=identicon&r=PG&f=1", "display_name": "Steve G.", "link": "https://stackoverflow.com/users/5919453/steve-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564000351, "creation_date": 1563993771, "last_edit_date": 1564000351, "question_id": 57189381, "link": "https://stackoverflow.com/questions/57189381/how-can-i-access-a-specific-control-in-a-user-created-tab-in-the-ribbon", "title": "How can I access a specific control in a user-created tab in the ribbon?", "body": "<p>I'm having trouble accessing a specific button in the MS Word ribbon using VBA. So far, I've got very little as far as code, because no matter where I search and what string I use on Google, the Internet has come up with bupkes. I know that I need to access the ribbon itself using <code>CommandBars(\"Ribbon\")</code>, but when I try to iterate through all the controls in <code>CommandBars(\"Ribbon\")</code>, it has a grand total of one control. What the...? Only one control in the entire ribbon? You're off your rocker, VBA.</p>\n\n<p>I've run this code to get a list of controls:</p>\n\n<pre><code>Dim Counter As Integer\nFor Counter = 1 To CommandBars(\"Ribbon\").Controls.Count\n    Debug.Print CommandBars(\"Ribbon\").Controls(Counter).TooltipText\nNext Counter\n</code></pre>\n\n<p>And, strangely enough, I get only that one control back, and the tooltip text is \"Tas&amp;k Pane.\" (I get this when running the macro from both Word itself and the VBA window.)</p>\n\n<p>Does anyone know how I can access a specific user-defined tab in the ribbon so I can get access to read properties on a specific control?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 4, "creation_date": 1563993907, "post_id": 57189332, "comment_id": 100888779, "body": "Sounds like you are looking for <code>SUMIFS</code>. What have you tried so far?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563994733, "post_id": 57189494, "comment_id": 100889084, "body": "thank you for your comment @Mark S. Just to clarify, this is to be created in VBA? I have 2 other macros that will run in the same instance. <code>Sub MacroAll()     test     CopyUnique End Sub</code>   So would I just add that SumIfs Sub after the CopyUnique Sub?"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563995203, "post_id": 57189494, "comment_id": 100889234, "body": "If you wanted to add this to your VBA you would want to fill in the data range with the vba function that inputs the actual excel function. I&#39;ll add this to my answer and you can mark it as the answer."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563995559, "post_id": 57189494, "comment_id": 100889398, "body": "I added the syntax on how to use VBA to add a formula to your spreadsheet if this answers your question or sufficiently allows you to modify it to suit your specific needs please mark it as such :) Best of luck!"}, {"owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563996741, "post_id": 57189494, "comment_id": 100889954, "body": "Most of it worked but it is not adding up any values, just &quot;0&quot;. My Name field is B, Date is F, and Hours is G. My <code>&quot;=SUMIFS(Sheet1!$F$2:$F$100,Sheet1!$G$2:$G$100,B$2,Sheet1!$B&zwnj;&#8203;$1:$B$100,$A2)&quot;</code> Looks like this. Sorry, I am new to VBA and I apologize for the questions. @Mark S."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563997907, "post_id": 57189494, "comment_id": 100890418, "body": "No problem @DaveNilges, the syntax for the sumifs formula is the following seperated by commas. Sum Range, Criteria Range1, Criteria 1, Criteria Range 2, Criteria 2, etc.)  What this means is make sure that the critera range 1 matches the criteria. So if your name field is B, make sure the corresponding criteria on the sheet you&#39;re summing up in is lined up correctly. Before putting it into VBA put it into the spreadsheet and make sure it calculates that way first, the copy the formula into the VBA to fill in the rest."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563998186, "post_id": 57189494, "comment_id": 100890523, "body": "The first thing I notice is your sumifs has column F as what&#39;s being summed but you said G, so it should be <code>&quot;=SUMIFS(Sheet1!$G$2:$G$100,Sheet1!$B$2:$B$100,B$2,Sheet1!$F&zwnj;&#8203;$1:$F$100,$A2)&quot;</code> This assumes in the new sheet the dates are across the row 1, and the names go down column A. It also assumes your other sheet only has 100 rows, so adjust the range accordingly to fit your data. Alternatively consider using a table format by hitting <code>CTRL + T</code>. This will allow more dynamic coding."}, {"owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563998683, "post_id": 57189494, "comment_id": 100890754, "body": "<code>Sub Add()  Dim RangeFormula As Range Set RangeFormula = Sheets(&quot;Sheet2&quot;).Range([&quot;B2:T5&quot;]) RangeFormula.Formula = &quot;=SUMIFS(Sheet1!$F$2:$F$100,Sheet1!$G$2:$G$100,B$2,Sheet1!$B&zwnj;&#8203;$1:$B$100,$A2)&quot; End Sub</code> This is the whole formula that I have. I will attach an image to the original question of the result I am getting."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563999141, "post_id": 57189494, "comment_id": 100890953, "body": "<code>Sub Add() Dim RangeFormula As Range Set RangeFormula = Sheets(&quot;Sheet2&quot;).Range(&quot;B2:T5&quot;) RangeFormula.Formula = &quot;=SUMIFS(Sheet1!$F$2:$F$100,Sheet1!$G$2:$G$100,B$2,Sheet1!$B&zwnj;&#8203;$1:$B$100,$A2)&quot; End Sub</code> I took out the [], this was just used to denote an input. Sorry that wasn&#39;t clear"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563999232, "post_id": 57189494, "comment_id": 100890982, "body": "But also make sure to adjust the cell ranges which look like A1:A100 to fit your dataset, this can even be $A:$A, but this can weigh down on the system since it will read all the rows even if there isn&#39;t data."}, {"owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563999579, "post_id": 57189494, "comment_id": 100891117, "body": "When you say Cell Ranges are you talking about the $F$2:$F$100 ranges inside the SumIfs formula? should there be absolute cell referencing ($) in there?"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563999692, "post_id": 57189494, "comment_id": 100891151, "body": "Yes I&#39;m referencing to that part of it. The $ should be there, that way as the formula gets moved throughout your sheet the references remain the same."}], "tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1563995515, "last_edit_date": 1563995515, "creation_date": 1563994277, "answer_id": 57189494, "question_id": 57189332, "link": "https://stackoverflow.com/questions/57189332/summing-values-into-new-sheet-for-unique-dates-and-unique-names/57189494#57189494", "title": "Summing values into new sheet for unique dates and unique names", "body": "<p>I can't see the image, but I understand your concept so hopefully you can apply the below to your case and use this as your answer.</p>\n\n<p>Say the data in Sheet1 is columned as Date, Name, &amp; Hours worked for A,B, &amp; C respectively (for only 100 rows), your <code>SUMIFS</code> function in sheet2 should be as follows:</p>\n\n<p><code>=SUMIFS(Sheet1!$C$1:$C$100,Sheet1!$A$1:$A$100,B$2,Sheet1!$B$1:$B$100,$A2)</code></p>\n\n<p>This as you drag it down will hold the first column in sheet2, the names, and the first row in sheet2 the dates, summing up all the hours worked for all the days of the month.</p>\n\n<p>If you use table formatting you can simply this further and the formula will resize with the table since it would use named ranges. I can help you with that as well if you'd like.</p>\n\n<p>To have VBA add this formula to your spreadsheet use the following:</p>\n\n<pre><code>Dim RangeFormula As Range\nSet RangeFormula = Sheet(\"Sheet2\").Range( [input cell range here])\nRangeFormula.Formula =\"=SUMIFS(Sheet1!$C$1:$C$100,Sheet1!$A$1:$A$100,B$2,Sheet1!$B$1:$B$100,$A2)\n</code></pre>\n\n<p>You can change the name from RangeFormula to whatever suits better, you can put the sheet name where Sheet2 is but make sure you put the cell range in the range part with \" surrounding it. To reference this as a table you'll need to use the <code>ListObjects(\"Table Name\")</code></p>\n"}], "owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 57189494, "answer_count": 1, "score": -1, "last_activity_date": 1563998763, "creation_date": 1563993614, "last_edit_date": 1563998763, "question_id": 57189332, "link": "https://stackoverflow.com/questions/57189332/summing-values-into-new-sheet-for-unique-dates-and-unique-names", "title": "Summing values into new sheet for unique dates and unique names", "body": "<p>So here is my scenario, I already have a sub that extracts unique names and unique dates from Sheet 1 into Sheet 2 creating the layout of unique names as rows and dates as headers. In Sheet 1 is the master data. For each day of the month, there are different work shifts for the same person. For example...</p>\n\n<p><a href=\"https://i.stack.imgur.com/Za7KC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Za7KC.png\" alt=\"enter image description here\"></a></p>\n\n<p>D Gray worked 3 different shifts on 6/26 so i need the values in Hours summed and then populated into Sheet 2 under the respective 6/26 date and so on and so forth for the other crew members. The template so far is..</p>\n\n<p><a href=\"https://i.stack.imgur.com/cWbqu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cWbqu.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/3LFGZ.png\" rel=\"nofollow noreferrer\">Result of New Code</a></p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 0, "last_activity_date": 1563995941, "creation_date": 1563995941, "answer_id": 57189851, "question_id": 57189330, "link": "https://stackoverflow.com/questions/57189330/how-do-i-use-vba-to-change-a-powerpoints-embedded-chart-links/57189851#57189851", "title": "How do I use VBA to change a PowerPoint&#39;s embedded chart links?", "body": "<p>Charts are either embedded or linked. Assuming they are linked, the statement needs to look more like this:</p>\n\n<pre><code>pptShape.LinkFormat.SourceFullName = Replace(LCase _\n(pptShape.LinkFormat.SourceFullName), LCase(oldFilePath), newFilePath)\n</code></pre>\n\n<p>Taken from this page that's a whole article on this subject: <a href=\"https://exceloffthegrid.com/edit-links-in-powerpoint-using-vba/\" rel=\"nofollow noreferrer\">Edit links in PowerPoint using VBA</a>. And here's the MS reference page: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.linkformat.sourcefullname\" rel=\"nofollow noreferrer\">LinkFormat.SourceFullName property (PowerPoint)</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11638863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06fffa2ecdcf1a2254ce175510d6a091?s=128&d=identicon&r=PG&f=1", "display_name": "Vance97", "link": "https://stackoverflow.com/users/11638863/vance97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564038724, "creation_date": 1563993609, "last_edit_date": 1564038724, "question_id": 57189330, "link": "https://stackoverflow.com/questions/57189330/how-do-i-use-vba-to-change-a-powerpoints-embedded-chart-links", "title": "How do I use VBA to change a PowerPoint&#39;s embedded chart links?", "body": "<p>I have a PowerPoint template full of embedded charts, and I would like to use VBA to change the charts' links from a template excel file to a client's excel file. I'm running the VBA script from the client's excel file (with the PowerPoint reference library enabled).</p>\n\n<p>In the script I attempt to reassign each PowerPoint chart's Chart.ChartData.Workbook property to the client's workbook.</p>\n\n<pre><code>pptShape.Chart.ChartData.Workbook = ThisWorkbook\n</code></pre>\n\n<p>No error message comes up when I run it, but when I click file->info->edit links, none of the chart links have been changed. How can I resolve this, or what can I do instead? Please don't suggest changing the charts to something other than embedded charts; I have to keep them as embedded charts.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 0, "last_activity_date": 1564062500, "creation_date": 1564062500, "answer_id": 57203527, "question_id": 57189302, "link": "https://stackoverflow.com/questions/57189302/copy-rows-chosen-by-checkbox-to-another-sheet/57203527#57203527", "title": "Copy rows, chosen by checkbox, to another sheet", "body": "<p>For demonstration purposes I will go ahead and assume your data setup looks something like that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2XPGc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2XPGc.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The data is being filtered from your existing code.</p>\n\n<p>I have added the checkboxes that you suggested, one in each row. </p>\n\n<p>For the following code to work, it is important that the checkboxes are <code>Form Controls</code> and not <code>ActiveX controls</code>. </p>\n\n<p>It is also crucial that the <code>Move and size with cells</code> option has been activated for each checkbox. This will \"bind\" in a way the checkbox to the cell you place it in, meaning that when the corresponding row is being filtered out, the checkbox is hidden as well.</p>\n\n<pre><code>Sub copySelected()\nDim shtSource As Worksheet\nDim shtDestination As Worksheet\nDim sourceRng As Range\nDim cb As CheckBox\nSet shtSource = ThisWorkbook.Worksheets(\"Name of Source Worksheet\") 'where the data is\nSet shtDestination = ThisWorkbook.Worksheets(\"Name of Destination Worksheet\") 'where the selected rows should be copied\nFor Each cb In shtSource.CheckBoxes 'loop through all the checkboxes\n    If cb.Value = 1 Then 'if the checkbox has been selected by the user then...\n        shtSource.Range(\"B\" &amp; cb.TopLeftCell.Row, \"D\" &amp; cb.TopLeftCell.Row).Copy '...copy the corresponding range of data...\n        With shtDestination\n            .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues '...and paste it to the first empty row in the destination sheet\n        End With\n    End If\nNext cb\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11832198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794ae90bfbd7113492013026ad7a8b6f?s=128&d=identicon&r=PG&f=1", "display_name": "Khs", "link": "https://stackoverflow.com/users/11832198/khs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57203527, "answer_count": 1, "score": 0, "last_activity_date": 1611561898, "creation_date": 1563993470, "last_edit_date": 1611561898, "question_id": 57189302, "link": "https://stackoverflow.com/questions/57189302/copy-rows-chosen-by-checkbox-to-another-sheet", "title": "Copy rows, chosen by checkbox, to another sheet", "body": "<p>I have a sheet that contains a search engine. After you type your search; a filter generates with the search criteria.</p>\n<p>After having the filtered results; I want the user to select some of the rows to copy to another sheet.<br />\nI am thinking if I there was a checkbox for each row (before the filter); then from the filtered results, the user would check the needed rows.</p>\n<p>This is the search box:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SearchBox()\n    'PURPOSE: Filter Data on User-Determined Column &amp; Text/Numerical value\n    'SOURCE: www.TheSpreadsheetGuru.com\n    \n    Dim myButton As OptionButton\n    Dim SearchString As String\n    Dim ButtonName As String\n    Dim sht As Worksheet\n    Dim myField As Long\n    Dim DataRange As Range\n    Dim mySearch As Variant\n    \n    'Load Sheet into A Variable\n    Set sht = ActiveSheet\n    \n    'Unfilter Data (if necessary)\n    On Error Resume Next\n    sht.ShowAllData\n    On Error GoTo 0\n      \n    'Filtered Data Range (include column heading cells)\n    Set DataRange = sht.Range(&quot;A7:D1000&quot;) 'Cell Range\n    'Set DataRange = sht.ListObjects(&quot;Table 2&quot;).Range 'Table\n    \n    'Retrieve User's Search Input\n     mySearch = sht.Shapes(&quot;UserSearch&quot;).TextFrame.Characters.Text 'Control Form\n    'mySearch = sht.OLEObjects(&quot;UserSearch&quot;).Object.Text 'ActiveX Control\n    'mySearch = sht.Range(&quot;A1&quot;).Value 'Cell Input\n       \n    'Determine if user is searching for number or text\n    If IsNumeric(mySearch) = True Then\n        SearchString = &quot;=&quot; &amp; mySearch\n    Else\n        SearchString = &quot;=*&quot; &amp; mySearch &amp; &quot;*&quot;\n    End If\n        \n   'Loop Through Option Buttons\n    For Each myButton In sht.OptionButtons\n        If myButton.Value = 1 Then\n            ButtonName = myButton.Text\n            Exit For\n        End If\n    Next myButton\n       \n    'Determine Filter Field\n    On Error GoTo HeadingNotFound\n    myField = Application.WorksheetFunction.Match(ButtonName, DataRange.Rows(1), 0)\n    On Error GoTo 0\n       \n    'Filter Data\n    DataRange.AutoFilter _\n      Field:=myField, _\n      Criteria1:=SearchString, _\n      Operator:=xlAnd\n      \n    'Clear Search Field\n    sht.Shapes(&quot;UserSearch&quot;).TextFrame.Characters.Text = &quot;&quot; 'Control Form\n    'sht.OLEObjects(&quot;UserSearch&quot;).Object.Text = &quot;&quot; 'ActiveX Control\n    'sht.Range(&quot;A1&quot;).Value = &quot;&quot; 'Cell Input\n      \n    Exit Sub\n    \n'ERROR HANDLERS\nHeadingNotFound:\n    MsgBox &quot;The column heading [&quot; &amp; ButtonName &amp; &quot;] was not found in cells &quot; &amp; DataRange.Rows(1).Address &amp; &quot;. &quot; &amp; _\n      vbNewLine &amp; &quot;Please check for possible typos.&quot;, vbCritical, &quot;Header Name Not Found!&quot;\n      \nEnd Sub\n</code></pre>\n<p>This is to clear the filter:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ClearFilter()\n    'PURPOSE: Clear all filter rules\n    \n    'Clear filters on ActiveSheet\n    On Error Resume Next\n    ActiveSheet.ShowAllData\n    On Error GoTo 0\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1563994483, "post_id": 57189188, "comment_id": 100888995, "body": "Use an <b>append query</b> for a task like this."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1563995807, "post_id": 57189516, "comment_id": 100889528, "body": "I&#39;ve made some edits to try to clarify what I&#39;m trying to do. Perhaps using Recordset isn&#39;t the right way to go??"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1563995959, "post_id": 57189516, "comment_id": 100889595, "body": "Probably not. Most likely what you want is simple to do with an <code>APPEND</code> query followed by an <code>UPDATE</code> query but you will need to provide table structures, example data and example of expected result for any meaningful help with that."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1563996740, "post_id": 57189516, "comment_id": 100889952, "body": "I&#39;m updating my original post now."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 1, "last_activity_date": 1563994383, "creation_date": 1563994383, "answer_id": 57189516, "question_id": 57189188, "link": "https://stackoverflow.com/questions/57189188/ms-access-copying-recordset-using-vba/57189516#57189516", "title": "MS access copying recordset using vba", "body": "<p>These</p>\n\n<pre><code>DoCmd.RunCommand acCmdSelectRecord\nDoCmd.RunCommand acCmdCopy\nDoCmd.RunCommand acCmdPasteAppend\n</code></pre>\n\n<p>work on the record currently in your form. They don't care about the recordset.</p>\n\n<p>But that is probably not the only problem. I recommend that you change your question or submit a new one to include your table(s) and what exactly you are trying to accomplish with example of desired result, because I am pretty sure that even if the above lines worked as you thought they do, you still wouldn't get the desired result.</p>\n"}, {"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1563995925, "post_id": 57189554, "comment_id": 100889578, "body": "I attempted to use your code but it&#39;s getting hung up on <code>![Field]=rs1.[Field]</code> I get the error &quot;Method or data member not found&quot; If I bypass it then I get an error that I have a loop with no Do command."}, {"owner": {"reputation": 92, "user_id": 10388054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560931c88bc0cfdbee02b24eebcb27ff?s=128&d=identicon&r=PG&f=1", "display_name": "ChadT", "link": "https://stackoverflow.com/users/10388054/chadt"}, "reply_to_user": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1563996820, "post_id": 57189554, "comment_id": 100889983, "body": "are you replacing [Field] with the name of the actual fields in the tables? oh and i wrote it slightly wrong i think its supposed to be <code>![Field]=rs1![Field]</code>"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1563997329, "post_id": 57189554, "comment_id": 100890188, "body": "yes I did replace &quot;Field&quot; with the field it&#39;s supposed to have in this case I used Status as the field. With your update I&#39;m now getting the Loop without Do error..."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1563998776, "post_id": 57189554, "comment_id": 100890796, "body": "I did catch that. but was still getting the error. But re-ordered as you have above and that worked!"}], "tags": [], "owner": {"reputation": 92, "user_id": 10388054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560931c88bc0cfdbee02b24eebcb27ff?s=128&d=identicon&r=PG&f=1", "display_name": "ChadT", "link": "https://stackoverflow.com/users/10388054/chadt"}, "is_accepted": true, "score": 1, "last_activity_date": 1563998038, "last_edit_date": 1563998038, "creation_date": 1563994620, "answer_id": 57189554, "question_id": 57189188, "link": "https://stackoverflow.com/questions/57189188/ms-access-copying-recordset-using-vba/57189554#57189554", "title": "MS access copying recordset using vba", "body": "<p>You dont appear to be doing anything to the Recordset. </p>\n\n<p>these:</p>\n\n<pre><code>DoCmd.RunCommand acCmdSelectRecord\nDoCmd.RunCommand acCmdCopy\nDoCmd.RunCommand acCmdPasteAppend\n</code></pre>\n\n<p>Would only affect the active forms datasheet. Not the Recordset. also they dont move around to do what they do. These three commands would select the record, copy the record, then paste that same record at the end, and repeat.</p>\n\n<p>you could open the source and the destination as recordsets and while you move through the source you add them to the destination as they have the appropriate value\nso something like</p>\n\n<pre><code>Dim rs1 As DAO.Recordset\nDim rs2 As DAO.Recordset\n\nSet rs1 = CurrentDb.OpenRecordset(\"Source\")\nSet rs2 = CurrentDb.OpenRecordset(\"Destination\")\n\nrs1.MoveFirst\n\nIf Not (rs1.EOF And rs1.BOF) And Me.Status = 10 Then\n\nDo Until rs1.EOF = True\n    If(rs1![Field] = 10) Then\n       With rs2\n            .AddNew\n            ![Field]=rs1![Field]\n            .Update\n       End With\n    End If\n    rs1.MoveNext\nLoop\nElse\n    MsgBox (\"Nothing Done\")\n'do nothing\nEnd If\n\n    MsgBox (\"Complete\")\n\nrs1.Close 'Close the recordset\nSet rs1 = Nothing 'Clean up\nrs2.Close 'Close the recordset\nSet rs2 = Nothing 'Clean up\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 4, "last_activity_date": 1563994641, "creation_date": 1563994641, "answer_id": 57189561, "question_id": 57189188, "link": "https://stackoverflow.com/questions/57189188/ms-access-copying-recordset-using-vba/57189561#57189561", "title": "MS access copying recordset using vba", "body": "<p>Why would you not use a simple <code>insert</code> query for this task?</p>\n\n<p>e.g.:</p>\n\n<pre><code>insert into tblTasks\nselect * from tblTasks where tblTasks.status = 10\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 0, "accepted_answer_id": 57189554, "answer_count": 3, "score": 0, "last_activity_date": 1594635377, "creation_date": 1563992938, "last_edit_date": 1594635377, "question_id": 57189188, "link": "https://stackoverflow.com/questions/57189188/ms-access-copying-recordset-using-vba", "title": "MS access copying recordset using vba", "body": "<p>UPDATED:</p>\n\n<p>I'm attempting to setup a form \"Tasks\", where when you click a button it will take all records with a [Status] of 10 and copy them, The previous records would then get marked as [Status] 100. </p>\n\n<p>So what I have is the following \"before\" datasheet view:\n<a href=\"https://i.stack.imgur.com/H2UVk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H2UVk.png\" alt=\"Before Code\"></a></p>\n\n<p>Once you run the code it will look as follows:\n<a href=\"https://i.stack.imgur.com/YwKa2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YwKa2.png\" alt=\"After Code\"></a></p>\n\n<p>So the code will duplicate all records that have a [Status] of 10 (\"In Progress\") mark the old records as [Status] 100 (\"Completed\") and timestamp the [Date Completed] Field. </p>\n\n<p>Hopefully this helps clarify a bit more of what I'm trying to do. </p>\n\n<p>Code is as follows:</p>\n\n<pre><code>Public Sub Duplicate_Click()\nDim rs As DAO.Recordset\n\nSet rs = CurrentDb.OpenRecordset(\"SELECT * FROM tblTasks\")\nrs.MoveFirst\n\nIf Not (rs.EOF And rs.BOF) And Me.Status = 10 Then\n\nDo Until rs.EOF = True\n'Copy/Paste In Process Tasks\n    DoCmd.RunCommand acCmdSelectRecord\n    DoCmd.RunCommand acCmdCopy\n    DoCmd.RunCommand acCmdPasteAppend\n    [Status].Value = 0\n    rs.MoveNext\nLoop\nElse\n    MsgBox (\"Nothing Done\")\n'do nothing\nEnd If\n\n    MsgBox (\"Complete\")\n\nrs.Close 'Close the recordset\nSet rs = Nothing 'Clean up\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1563996211, "creation_date": 1563996211, "answer_id": 57189919, "question_id": 57188906, "link": "https://stackoverflow.com/questions/57188906/found-match-using-for-each-r-in-intersect-and-if-r-item-how-do-i-selec/57189919#57189919", "title": "Found match using &quot;For each r in Intersect...&quot; and if &quot;r = item&quot;; how do I select the next few cells in the row to paste into a different workbook?", "body": "<p>Untested:</p>\n\n<pre><code>Sub lastitem(newbook)\n\n    Dim lw As Long, thirdwb As Workbook, Item\n    Dim shtData As Worksheet, shtOne As Worksheet\n    Dim rngPrevious As Range, colFound As Collection, c\n\n    Set shtOne = newbook.Sheets(\"Sheet1\")\n\n    Set thirdwb = Workbooks.Open( _\n           \"C:\\Users\\userX\\Desktop\\Programing with extra itd step\\Previous_Data\")\n\n    Set shtData = thirdwb.Sheets(\"Data\")\n\n    Item = shtOne.Cells(2, 51).Value\n    'find all matches on Data sheet\n    Set colFound = FindAll(shtData.UsedRange.Columns(1), Item)\n    Debug.Print colFound.Count &amp; \" matches for '\" &amp; Item &amp; \"'\"\n\n    If colFound.Count &gt; 0 Then\n        'Are you expecting &gt;1 matched row? \n        'Code below will need to be adjusted if yes\n        For Each c In colFound\n            lw = shtOne.Cells(Rows.Count, 1).End(xlUp).Row\n            shtOne.Cells(lw + 2, 15).Value = c.EntireRow.Cells(2).Value\n        Next c\n    End If\n\n    thirdwb.Close False 'don't save\n\nEnd Sub\n\n\n'find all occurences of \"val\" in range \"rng\" and return as a Collection\nPublic Function FindAll(rng As Range, val) As Collection\n    Dim rv As New Collection, f As Range\n    Dim addr As String\n\n    Set f = rng.Find(what:=val, after:=rng.Cells(rng.Cells.Count), _\n        LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n    If Not f Is Nothing Then addr = f.Address() 'first cell found\n\n    Do Until f Is Nothing\n        rv.Add f\n        Set f = rng.FindNext(after:=f)\n        If f.Address() = addr Then Exit Do 'exit if we've looped back\n    Loop\n\n    Set FindAll = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11622976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/326520fc5306ed3da56abfb580652d4a?s=128&d=identicon&r=PG&f=1", "display_name": "SlightlyUnsure", "link": "https://stackoverflow.com/users/11622976/slightlyunsure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563996211, "creation_date": 1563991702, "last_edit_date": 1563992170, "question_id": 57188906, "link": "https://stackoverflow.com/questions/57188906/found-match-using-for-each-r-in-intersect-and-if-r-item-how-do-i-selec", "title": "Found match using &quot;For each r in Intersect...&quot; and if &quot;r = item&quot;; how do I select the next few cells in the row to paste into a different workbook?", "body": "<p>I am using these functions to find a match between one workbook and another.  Upon doing so, I need to grab the cells from r's row, and past them at the bottom of my other workbook (Named newbook).  I know this finds a match per a msgbox test.</p>\n\n<p>I have tried using </p>\n\n<pre><code>lw = newbook.sheets(\"Sheet1\").Range(\"a2\").End(xlDown).row \n</code></pre>\n\n<p>and then </p>\n\n<pre><code>newbook.sheets(\"Sheet1\").cells(lw+2, 15).print raw.cells(2) \n</code></pre>\n\n<p>.... however this is yielding an error \"Object doesnt support this property or method\".\n-Please excuse the commented out sections, these were alternative attempts.</p>\n\n<pre><code>Sub lastitem(newbook)\nDim lw As Long\nDim m, raw As Range\nDim rngPrevious As Range\nDim r As Range\nDim myrow As Long\n\nItem = newbook.Sheets(\"Sheet1\").Cells(2, 51).Value\n\nSet rngPrevious = Workbooks.Open(\"C:\\Users\\userX\\Desktop\\Programing \nwith extra itd step\\Previous_Data\").Sheets(\"Data\") _\n.Range(\"A1:I500\")  'adjust to suit\n Set thirdwb = Workbooks(\"Previous_Data.xlsm\")\n\n'm = Application.Match(Item, rngPrevious, 0)\n\n'If Err.Number = 0 Then\n For Each r In Intersect(thirdwb.Sheets(\"Data\").Range(\"a:a\"), \nthirdwb.Sheets(\"Data\").UsedRange)\n\n If r = Item Then\n\n\nSet raw = thirdwb.Rows(r) 'get a reference to the matched row\n\n'lastRow = newbook.Sheets(\"Sheet1\").UsedRange.Rows.Count\n\nIf newbook.Sheets(\"Sheet1\").Range(\"a2\") &lt;&gt; \"\" Then\n\nlw = newbook.Sheets(\"Sheet1\").Range(\"a2\").End(xlDown).Row\nIf lw = \"1048576\" Then\nlw = \"2\"\nEnd If\n\nnewbook.Sheets(\"Sheet1\").Cells(lw + 2, 15).Print raw.Cells(2)\n\nEnd If\n\nEnd If\n\nNext r\n\n   'Set raw = rngPrevious.Rows(m) 'get a reference to the matched row\n\n'lastRow = newbook.Sheets(\"Sheet1\").UsedRange.Rows.Count\n\n'If newbook.Sheets(\"Sheet1\").Range(\"a2\") &lt;&gt; \"\" Then\n\n'lw = newbook.Sheets(\"Sheet1\").Range(\"a2\").End(xlDown).Row\n'If lw = \"1048576\" Then\n'lw = \"2\"\n'End If\n\n'newbook.Sheets(\"Sheet1\").Cells(lw + 2, 15).Print raw.Cells(2)\n\n'End If\n'MsgBox (\"Error\")\n'End If\nrngPrevious.Close\n\nEnd Sub\n</code></pre>\n\n<p>receiving \"Object doesnt support this property or method\" error in the If r = item then statement</p>\n"}, {"tags": ["excel", "vba", "ribbon"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11185212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26cd978d061ff7fbd6a9f6b72c3082e?s=128&d=identicon&r=PG&f=1", "display_name": "Malamare", "link": "https://stackoverflow.com/users/11185212/malamare"}, "edited": false, "score": 0, "creation_date": 1564055324, "post_id": 57190752, "comment_id": 100910176, "body": "Thanks @Eugene but I already tried the Invalidatecontrol method and the result is the same. Something happens but the item deleted from the list remains selected, even if it is no longer in it."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1564000024, "creation_date": 1564000024, "answer_id": 57190752, "question_id": 57188903, "link": "https://stackoverflow.com/questions/57188903/excel-ribbon-dropbox-does-not-refresh-the-list-when-i-delete-items/57190752#57190752", "title": "Excel Ribbon dropBox does not refresh the list when I delete items", "body": "<p>Try to use the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.office.core.iribbonui.invalidatecontrol?view=office-pia\" rel=\"nofollow noreferrer\">InvalidateControl</a> method of the IRibbonUI interface to get the dropdown control to evaluate its properties.</p>\n\n<p>Be aware, some callbacks can be invoked when you try to open the control.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 11185212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26cd978d061ff7fbd6a9f6b72c3082e?s=128&d=identicon&r=PG&f=1", "display_name": "Malamare", "link": "https://stackoverflow.com/users/11185212/malamare"}, "is_accepted": false, "score": 1, "last_activity_date": 1564078284, "last_edit_date": 1564078284, "creation_date": 1564074892, "answer_id": 57207145, "question_id": 57188903, "link": "https://stackoverflow.com/questions/57188903/excel-ribbon-dropbox-does-not-refresh-the-list-when-i-delete-items/57207145#57207145", "title": "Excel Ribbon dropBox does not refresh the list when I delete items", "body": "<p>All done. The first element of dropDown is 0 and not -1, in a Combobox you set -1 to empty the list but not in a dropDown. In <code>Private Sub CommandButton1_Click()</code> substitute -1 for 0.</p>\n\n<pre><code>If SheetToDelete.Name = gstrActualNameSheet Then\n    'we put the first empty element in dropBox\n    glActualIndexSheet = 0 'Before -1\nEnd If\n</code></pre>\n\n<p>Sorry for the question and I hope it suits someone who has a similar problem</p>\n"}], "owner": {"reputation": 19, "user_id": 11185212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26cd978d061ff7fbd6a9f6b72c3082e?s=128&d=identicon&r=PG&f=1", "display_name": "Malamare", "link": "https://stackoverflow.com/users/11185212/malamare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564078284, "creation_date": 1563991698, "last_edit_date": 1564072549, "question_id": 57188903, "link": "https://stackoverflow.com/questions/57188903/excel-ribbon-dropbox-does-not-refresh-the-list-when-i-delete-items", "title": "Excel Ribbon dropBox does not refresh the list when I delete items", "body": "<p>I have a Ribbon dropBox with a list of sheets for the end user work. The list is in column \u201cA\u201d on the Data sheet, and the dropBox makes the sheet we select visible or hides it when we select another. If we select the first element (empty), it hides all.</p>\n\n<p>One of the actions that the user can do is to delete the sheets, but in an orderly manner, and for this I have created a sheet editing form (UserForm1) with a list to select them (ComboBox1) and a button to delete them (CommandButton1). The form is necessary as there are more actions besides deleting.</p>\n\n<p>Everything works fine except if the sheet I delete is currently selected in the Ribbon dropBox. The sheet remains selected even if it is no longer in the dropBox. If we display the list we see that it is gone. If we activate another tab of the Ribbon and return it refreshes and disappears. </p>\n\n<p>Any idea how to get it refreshes well?</p>\n\n<p><a href=\"https://i.stack.imgur.com/WGc1p.jpg\" rel=\"nofollow noreferrer\">This is an image of what happens:</a></p>\n\n<p>To get the code to make it work properly, you must have a sheet called \u201cData\u201d with a list of sheet names from the \u201cA2\u201d range, for example Sheets1, Sheets2, Sheets3, Sheets4 and Sheets5. The sheets must exist to be deleted later, if they don't exist we will have an error.</p>\n\n<p>Also Sheets (\u201cData\u201d). Range (\u201cB1\u201d) = 1 so that our Ribbon is active when opening the book.</p>\n\n<p>Also create a form with (see the image above):</p>\n\n<ul>\n<li>1 Userform (Name: UserForm1) </li>\n<li>1 ComboBox (Name: ComboBox1) </li>\n<li>1 CommandButton (Name: CommandButton1)</li>\n</ul>\n\n<p>Paste this code in it:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub UserForm_Initialize()\n    'Initialize comboBox1 with sheets in _\n    'sheets(\"Data\") column \"A\"\n    Dim LRow As Long\n    LRow = LastRow(Sheets(\"Data\"), 1)\n    Me.ComboBox1.List = Sheets(\"Data\").Range(\"A2:A\" &amp; _\n      LRow).Value2\n    UserForm1.Show vbModeless\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n    Dim SheetToDelete As Worksheet\n    Set SheetToDelete = Sheets(Me.ComboBox1.Text)\n    Application.ScreenUpdating = False\n    Dim LRow As Long\n    LRow = LastRow(Sheets(\"Data\"), 1)\n    'delete actual item from comboBox1\n    Me.ComboBox1.RemoveItem (Me.ComboBox1.ListIndex)\n    Me.ComboBox1.ListIndex = -1\n    'copy new comboBox1 list to sheets(\"Data\") column \"A\"\n    Sheets(\"Data\").Range(\"A1\").EntireColumn.ClearContents\n    Sheets(\"Data\").Range(\"A2:A\" &amp; LRow - 1) = Me.ComboBox1.List\n    'if the sheet we are deleting is selected in\n    'Ribbon dropBox \"rxlstSheetsList\"\n    If SheetToDelete.Name = gstrActualNameSheet Then\n        'we put the first empty element in dropBox\n        glActualIndexSheet = -1\n    End If\n    'We update the Ribbon dropBox and activate it\n    Call RefreshRibbon(\"Activate\")\n    'finally we delete the sheet selected in ComboBox1\n    Application.DisplayAlerts = False\n    SheetToDelete.Visible = xlSheetVisible\n    SheetToDelete.Delete\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>In the \"ThisWorkbook\" module paste this code</p>\n\n<pre><code>Option Explicit\nPrivate Sub Workbook_Open()\n    'At the beginning we hide all sheets in sheets(\"Data\") column \"A\"\n    Sheets(\"Data\").Range(\"B1\") = 1\n    Dim LRow As Long\n    LRow = LastRow(Sheets(\"Data\"), 1)\n    If LRow &gt; 1 Then\n        Dim ActualRow As Long\n        For ActualRow = 2 To LRow\n            If Sheets(Sheets(\"Data\").Range(\"A\" &amp; ActualRow).Text). _\n               Visible = xlSheetVisible Then\n                Sheets(Sheets(\"Data\").Range(\"A\" &amp; ActualRow).Text). _\n                Visible = xlSheetVeryHidden\n            End If\n        Next ActualRow\n    End If\nEnd Sub\n</code></pre>\n\n<p>And finally add a standard Module1 with this code</p>\n\n<pre><code>Option Explicit\nPublic grxIRibbonUI As IRibbonUI\nPublic glActualIndexSheet As Integer\nPublic gstrActualNameSheet As String\n\nPublic Sub rxIRibbonUI_onLoad(ByRef ribbon As IRibbonUI)\n    Set grxIRibbonUI = ribbon\nEnd Sub\n\nPublic Sub rxlstSheetsList_getSelectedItemIndex(ByRef Control _\n  As IRibbonControl, ByRef Index)\n    Index = glActualIndexSheet\nEnd Sub\n\nPublic Sub rxlstSheetsList_Click(ByRef Control As IRibbonControl, _\n  ByVal ID As String, ByVal Index As Integer)\n    'first row is empty to hide activesheet\n    If glActualIndexSheet + 1 &gt; 1 Then\n        gstrActualNameSheet = Sheets(\"Data\").Range(\"A\" &amp; _\n          glActualIndexSheet + 1).Text\n        Sheets(gstrActualNameSheet).Visible = xlSheetVeryHidden\n    End If\n    glActualIndexSheet = Index\n    If Index = 0 Then\n        gstrActualNameSheet = \"\"\n    End If\n    If glActualIndexSheet + 1 &gt; 1 Then\n        gstrActualNameSheet = Sheets(\"Data\").Range(\"A\" &amp; _\n          glActualIndexSheet + 1).Text\n        Sheets(gstrActualNameSheet).Visible = xlSheetVisible\n        Sheets(gstrActualNameSheet).Select\n    End If\n    On Error Resume Next\n    grxIRibbonUI.Invalidate\n    On Error GoTo 0\nEnd Sub\n\nPublic Sub rxshared_getEnabled(ByRef Control As IRibbonControl, _\n  ByRef returnedVal)\n    returnedVal = Sheets(\"Data\").Range(\"B1\")\n    If Sheets(\"Data\").Range(\"B1\") = 1 Then\n        returnedVal = True\n    Else\n        returnedVal = False\n    End If\nEnd Sub\n\nPublic Sub rxlstSheetsList_getItemCount(ByRef Control As IRibbonControl, _\n  ByRef returnedVal)\n    returnedVal = LastRow(Sheets(\"Data\"), 1)\nEnd Sub\n\nPublic Sub rxlstSheetsList_getItemLabel(ByRef Control As IRibbonControl, _\n  ByVal Index As Integer, ByRef returnedVal)\n    returnedVal = Sheets(\"Data\").Range(\"A\" &amp; Index + 1)\nEnd Sub\n\nPublic Sub rxshared_getLabel(ByRef Control As IRibbonControl, _\n  ByRef returnedVal)\n    returnedVal = GiveLabel(Control.ID)\n    grxIRibbonUI.InvalidateControl Control.ID\nEnd Sub\n\nPublic Sub rxbtnEditList_Click(ByRef Control As IRibbonControl)\n    Load UserForm1\nEnd Sub\n\nPublic Sub RefreshRibbon(ByVal strAction_I As String)\n    If strAction_I = \"Activate\" Then\n        Sheets(\"Data\").Range(\"B1\") = 1\n    Else\n        Sheets(\"Data\").Range(\"B1\") = 0\n    End If\n    grxIRibbonUI.Invalidate\nEnd Sub\n\nPublic Function GiveLabel(ByVal sLabel_I As String) As String\n    Select Case sLabel_I\n    Case \"rxtabMyRibbon\"\n        GiveLabel = \"Sheets\"\n    Case \"rxgrp_SheetsDel\"\n        GiveLabel = \"Sheets to delete\"\n    Case \"rxlstSheetsList\"\n        GiveLabel = \"Sheets list\"\n    Case \"rxbtnEditList\"\n        GiveLabel = \"Delete sheet\"\n    End Select\nEnd Function\n\nPublic Function LastRow(ByRef wsSheet_I As Worksheet, ByVal lColumn_I _\n  As Long) As Long\n    Dim LRow As Range\n\n    Set LRow = wsSheet_I.Columns(lColumn_I).Find(What:=\"*\", _\n                 LookIn:=xlFormulas, lookat:= _\n                 xlPart, SearchOrder:=xlByRows, _\n                 SearchDirection:=xlPrevious, MatchCase:=False)\n\n    If Not LRow Is Nothing Then\n        LastRow = LRow.Row\n    Else\n        LastRow = 0\n    End If\nEnd Function\n</code></pre>\n\n<p>The Ribbon XML Code is</p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"\n  onLoad=\"rxIRibbonUI_onLoad\"&gt;\n  &lt;ribbon startFromScratch=\"false\"&gt;\n    &lt;tabs&gt;\n      &lt;tab id=\"rxtabMyRibbon\"\n       getLabel=\"rxshared_getLabel\"\n       insertBeforeMso=\"TabHome\"&gt;\n        &lt;group id=\"rxgrp_SheetsDel\" getLabel=\"rxshared_getLabel\"&gt;\n        &lt;dropDown id=\"rxlstSheetsList\"  \n         getSelectedItemIndex=\"rxlstSheetsList_getSelectedItemIndex\"\n         getLabel=\"rxshared_getLabel\"\n         onAction=\"rxlstSheetsList_Click\"\n         getEnabled=\"rxshared_getEnabled\" \n         getItemCount =\"rxlstSheetsList_getItemCount\"\n         getItemLabel=\"rxlstSheetsList_getItemLabel\"\n        /&gt;\n        &lt;button id=\"rxbtnEditList\"\n           size=\"large\" \n           imageMso=\"FilePrepareMenu\" \n           getLabel=\"rxshared_getLabel\" \n           onAction=\"rxbtnEditList_Click\" \n           getEnabled=\"rxshared_getEnabled\"\n          /&gt;\n        &lt;/group&gt;\n      &lt;/tab&gt;\n    &lt;/tabs&gt;\n  &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "edited": false, "score": 0, "creation_date": 1563991922, "post_id": 57188846, "comment_id": 100887910, "body": "Can you attach the current output and the expected output?"}, {"owner": {"reputation": 93, "user_id": 11666863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f13589cd21afc761e3b81e6fa294460?s=128&d=identicon&r=PG&f=1", "display_name": "Starbucks", "link": "https://stackoverflow.com/users/11666863/starbucks"}, "reply_to_user": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "edited": false, "score": 0, "creation_date": 1563992558, "post_id": 57188846, "comment_id": 100888185, "body": "I have added pictures of them"}], "answers": [{"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 1, "last_activity_date": 1563993977, "last_edit_date": 1563993977, "creation_date": 1563993660, "answer_id": 57189345, "question_id": 57188846, "link": "https://stackoverflow.com/questions/57188846/my-code-is-not-looping-through-each-row-instead-it-is-printing-the-top-row-thro/57189345#57189345", "title": "My code is not looping through each row, instead it is printing the top row through my range", "body": "<p>You aren't incrementing the value of the row for each iteration of cell. You are point at row 2 for each one.</p>\n\n<p>You also shouldn't use Select it is unnecessary just directly reference the sheet object.</p>\n\n<pre><code>Sub print_misc()\n    Dim cell As Range\n    Dim lastRow As Long\n    dim iter as long\n    with Sheets(\"1099-Misc_Form_Template\")\n        lastRow = .Range(\"B\" &amp; Rows.Count).End(xlUp).row\n        iter = 2\n        For Each cell In .Range(\"AB2:\" &amp; \"AB\" &amp; lastRow)\n            cell.Value = .Range(\"B\" &amp; iter) &amp; \"|\" &amp; .Range(\"C\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"D\" &amp; iter) &amp; \"|\" &amp; .Range(\"E\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"F\" &amp; iter) &amp; \"|\" &amp; .Range(\"G\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"H\" &amp; iter) &amp; \"|\" &amp; .Range(\"I\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"J\" &amp; iter) &amp; \"|\" &amp; .Range(\"L\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"M\" &amp; iter) &amp; \"|\" &amp; .Range(\"N\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"O\" &amp; iter) &amp; \"|\" &amp; .Range(\"P\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"Q\" &amp; iter) &amp; \"|\" &amp; .Range(\"R\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"S\" &amp; iter) &amp; \"|\" &amp; .Range(\"U\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"V\" &amp; iter) &amp; \"|\" &amp; .Range(\"W\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"X\" &amp; iter) &amp; \"|\" &amp; .Range(\"Y\" &amp; iter) &amp; \"|\" &amp; _\n            .Range(\"Z\" &amp; iter) &amp; \"|\" &amp; .Range(\"AA\" &amp; iter)\n            iter = iter + 1\n         Next\n     end with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 11666863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f13589cd21afc761e3b81e6fa294460?s=128&d=identicon&r=PG&f=1", "display_name": "Starbucks", "link": "https://stackoverflow.com/users/11666863/starbucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 57189345, "answer_count": 1, "score": 0, "last_activity_date": 1564038693, "creation_date": 1563991444, "last_edit_date": 1564038693, "question_id": 57188846, "link": "https://stackoverflow.com/questions/57188846/my-code-is-not-looping-through-each-row-instead-it-is-printing-the-top-row-thro", "title": "My code is not looping through each row, instead it is printing the top row through my range", "body": "<p>My final goal is to print my cells pipe delimited so in order to do so I am trying to print everything on each row into cell AB on each row. I am trying to loop through each row to do so however I am currently getting the top row of code repeated in all my rows instead of each row individually being printed. </p>\n\n<pre><code>Sub print_misc()\nDim cell As Range\nDim lastRow As Long\nSheets(\"1099-Misc_Form_Template\").Select\nlastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).row\n\nFor Each cell In Range(\"AB2:\" &amp; \"AB\" &amp; lastRow)\ncell.Value = Range(\"B2\") &amp; \"|\" &amp; Range(\"C2\") &amp; \"|\" &amp; Range(\"D2\") &amp; \"|\" &amp; Range(\"E2\") &amp; \"|\" &amp; Range(\"F2\") &amp; \"|\" &amp; Range(\"G2\") &amp; \"|\" &amp; Range(\"H2\") &amp; \"|\" &amp; Range(\"I2\") &amp; \"|\" &amp; Range(\"J2\") &amp; \"|\" &amp; Range(\"L2\") &amp; \"|\" &amp; Range(\"M2\") &amp; \"|\" &amp; Range(\"N2\") &amp; \"|\" &amp; Range(\"O2\") &amp; \"|\" &amp; Range(\"P2\") &amp; \"|\" &amp; Range(\"Q2\") &amp; \"|\" &amp; Range(\"R2\") &amp; \"|\" &amp; Range(\"S2\") &amp; \"|\" &amp; Range(\"U2\") &amp; \"|\" &amp; Range(\"V2\") &amp; \"|\" &amp; Range(\"W2\") &amp; \"|\" &amp; Range(\"X2\") &amp; \"|\" &amp; Range(\"Y2\") &amp; \"|\" &amp; Range(\"Z2\") &amp; \"|\" &amp; Range(\"AA2\")\nNext\nEnd Sub\n</code></pre>\n\n<p>Each cell in AB shows the result of the combined cells in that row (pipe delimited).</p>\n\n<p>Current output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/A49SI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A49SI.png\" alt=\"enter image description here\"></a>\nExpected output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MluhT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MluhT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "vba", "ms-access", "sql-delete"], "answers": [{"comments": [{"owner": {"reputation": 92, "user_id": 10388054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560931c88bc0cfdbee02b24eebcb27ff?s=128&d=identicon&r=PG&f=1", "display_name": "ChadT", "link": "https://stackoverflow.com/users/10388054/chadt"}, "edited": false, "score": 0, "creation_date": 1563991453, "post_id": 57188739, "comment_id": 100887671, "body": "Was just testing an Exists clause. thank you for adding this. whats the difference between putting a <code>Select 1</code> vs <code>Select [field]</code> cause the 1 worked appropriately?"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 92, "user_id": 10388054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560931c88bc0cfdbee02b24eebcb27ff?s=128&d=identicon&r=PG&f=1", "display_name": "ChadT", "link": "https://stackoverflow.com/users/10388054/chadt"}, "edited": false, "score": 0, "creation_date": 1563991604, "post_id": 57188739, "comment_id": 100887749, "body": "<code>select 1</code> is purely used for optimisation, since we only care that the query contains records, we are not interested in the data returned by such records."}, {"owner": {"reputation": 92, "user_id": 10388054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560931c88bc0cfdbee02b24eebcb27ff?s=128&d=identicon&r=PG&f=1", "display_name": "ChadT", "link": "https://stackoverflow.com/users/10388054/chadt"}, "edited": false, "score": 0, "creation_date": 1563991788, "post_id": 57188739, "comment_id": 100887843, "body": "I didnt know that. I&#39;m gonna write that into my cheat sheet. thank you"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1563991018, "creation_date": 1563991018, "answer_id": 57188739, "question_id": 57188654, "link": "https://stackoverflow.com/questions/57188654/ms-access-sql-deleting-record-based-on-external-table/57188739#57188739", "title": "MS Access SQL Deleting record based on external table", "body": "<p>Since a <code>delete</code> query can only delete records from one table at a time, only one dataset can be referenced in the <code>from</code> clause. With your current query, you would need to reference <code>testtable2</code> within the <code>from</code> clause, which would result in an invalid <code>delete</code> query.</p>\n\n<p>As such, you'll instead need to use <code>where exists</code> with a subquery, e.g.:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>delete from testtable1 as t1\nwhere exists \n(\n    select 1 from [Network Location].[Testtable2] t2 \n    where t2.customers = t1.customers and (t2.contract = '2003' or t2.active = 'N')\n)\n</code></pre>\n\n<p>I've also surrounded the <code>or</code> expression with parentheses, as I assume that it is the desired logic to delete records with a matching <code>customers</code> record and either of the other two conditions, rather than deleting <em>any</em> record for which <code>t2.active = 'N'</code> (since <code>and</code> has operator precedence over <code>or</code>).</p>\n"}], "owner": {"reputation": 92, "user_id": 10388054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560931c88bc0cfdbee02b24eebcb27ff?s=128&d=identicon&r=PG&f=1", "display_name": "ChadT", "link": "https://stackoverflow.com/users/10388054/chadt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 57188739, "answer_count": 1, "score": 0, "last_activity_date": 1594635565, "creation_date": 1563990683, "last_edit_date": 1594635565, "question_id": 57188654, "link": "https://stackoverflow.com/questions/57188654/ms-access-sql-deleting-record-based-on-external-table", "title": "MS Access SQL Deleting record based on external table", "body": "<p>I had a similar question regarding selecting records based on an external table (in an unlinked table):\n<a href=\"https://stackoverflow.com/questions/57167374/access-sql-from-in-and-joins/57169149?noredirect=1#comment100852957_57169149\">Access SQL FROM IN and JOINS</a></p>\n\n<p>This time I'm trying to <strong>delete</strong> records in an <em>internal</em> table based on criteria in an <em>external</em> one. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command0_Click()\n    Dim SQLstring As String\n    SQLstring = \"Delete * FROM Testtable1 AS tnf WHERE ([Network Location].[Testtable2].[Customers] = tnf.[Customers]) AND ([Network Location].[Testtable2].[Contract] = '2003') Or ([Network Location].[Testtable2].[Active]='N');\"\n    DoCmd.RunSQL (SQLstring)\nEnd Sub\n</code></pre>\n\n<p>Its telling me that <code>\"</code> is not a valid name and to check if theres invalid characters or punctuation or if its too long. I cant find anything that talks about SQL lengths but i'm pretty sure this isn't too long. </p>\n\n<p>Is there something I'm missing about my SQl statement I've gone through it over and over and I'm not seeing an issue. </p>\n\n<p>Should the <code>WHERE</code> clause have an <code>Exists (Select)</code> clause?</p>\n\n<p>Am I missing something?</p>\n"}, {"tags": ["excel", "vba", "recordset"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1564090323, "post_id": 57195284, "comment_id": 100927082, "body": "I know that, buy I am trying to avoid having to complete transfer so I would like add headers before that so I can keep the stream open."}, {"owner": {"reputation": 101, "user_id": 11280799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZvMNSZWojsE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuzF2ZK7J3fl-ajDYT6mhYyalAQA/mo/photo.jpg?sz=128", "display_name": "Aman", "link": "https://stackoverflow.com/users/11280799/aman"}, "reply_to_user": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1564142125, "post_id": 57195284, "comment_id": 100943323, "body": "Then i did not understand the question, still."}, {"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1564246354, "post_id": 57195284, "comment_id": 100970887, "body": "Do cell formattings get passed over to excel via copyfromrecordset? In this case what I want would not be a good idea. What I wanted is to get column names together with copyfromrecordset."}], "tags": [], "owner": {"reputation": 101, "user_id": 11280799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZvMNSZWojsE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuzF2ZK7J3fl-ajDYT6mhYyalAQA/mo/photo.jpg?sz=128", "display_name": "Aman", "link": "https://stackoverflow.com/users/11280799/aman"}, "is_accepted": false, "score": 1, "last_activity_date": 1615821158, "last_edit_date": 1615821158, "creation_date": 1564034577, "answer_id": 57195284, "question_id": 57188627, "link": "https://stackoverflow.com/questions/57188627/how-can-i-copy-from-recordset-with-headers/57195284#57195284", "title": "How can I copy from recordset with headers?", "body": "<p>I think this might help you have the headers at top. First row will be filled by header names. CopyFromRecordset will fill all the remaning data starting from 2nd row.</p>\n<pre><code>For i = 0 To rs.Fields.Count - 1\n    Cells(1,i+1).Value= rs.Fields(i).Name\nNext\nCells(2,1).CopyFromRecordset rs\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 918, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1615821158, "creation_date": 1563990567, "last_edit_date": 1564038682, "question_id": 57188627, "link": "https://stackoverflow.com/questions/57188627/how-can-i-copy-from-recordset-with-headers", "title": "How can I copy from recordset with headers?", "body": "<p>I am trying to use ActiveCell.CopyFromRecordset on recordset to copy recordset with headers. I am trying to get rid of saving recordset result to variable before putting it into excel.\nIs there a way to inject a row with headers before copy?\nOr can it be done by creating custom class that immitates recordset?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function RecordSet(Optional ByVal QueryString As Variant, Optional ByVal UseLast As Variant = True) As ADODB.RecordSet\n    Dim qstr As String\n    If IsMissing(QueryString) = False Then\n        qstr = QueryString\n    ElseIf Me.SavedQuery &lt;&gt; \"\" And UseLast = True Then\n        qstr = Me.SavedQuery\n    Else\n        qstr = Me.QUERY(UseLast:=UseLast)\n    End If\n    Call Me.Connect\n    sqlrs.Open qstr, sqlcon\n\n    Set RecordSet = sqlrs\n    sqlrs.Close\nEnd Function\n\nDim rs As ADODB.RecordSet\nSet rs = RecordSet\nFor i = 0 To RecordSet.Fields.Count - 1\n    MsgBox rs.Fields(i).Name\nNext\nActiveCell.CopyFromRecordset RecordSet\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1564068656, "creation_date": 1564068656, "answer_id": 57205608, "question_id": 57188585, "link": "https://stackoverflow.com/questions/57188585/using-radio-buttons-vba-in-powerpoint/57205608#57205608", "title": "Using Radio Buttons VBA in PowerPoint", "body": "<p>Use this instead:</p>\n\n<p>ActivePresentation.Slides(1).Shapes(\"radioButton1\").OLEFormat.Object.Value = True</p>\n\n<p>Radio buttons are named OptionButtonX so I'm assuming that you've renamed yours to radioButtonX.</p>\n"}], "owner": {"reputation": 17, "user_id": 11735020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RS29ojJ4ieM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfTkLjWvzeeEqeibybz1HsqoD_P8g/photo.jpg?sz=128", "display_name": "Nicolas Bulgarides", "link": "https://stackoverflow.com/users/11735020/nicolas-bulgarides"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593729588, "creation_date": 1563990394, "last_edit_date": 1593729588, "question_id": 57188585, "link": "https://stackoverflow.com/questions/57188585/using-radio-buttons-vba-in-powerpoint", "title": "Using Radio Buttons VBA in PowerPoint", "body": "<p>I'm making a game inside of PPT for work and I'm trying to get radio buttons to work. I want there to be three radio buttons and, depending on which one is clicked, an \"advance slide\" button will redirect the user to a different slide</p>\n\n<p>Simplying it to a single radio button, it should be (psuedocode)</p>\n\n<pre><code>If radioButtonA.value = true then\nGoToSlide (n)\nEnd If\n</code></pre>\n\n<p>I can't even get it to work with a message box! Just to see that I am correctly pulling the boolean value from the radio button being clicked or not. </p>\n\n<p>I've tried </p>\n\n<pre><code>If (ActivePresentation.Slides(1).Shapes(\"radioButton1\").value = true) then\nMsgBox(\"Plz work\")\nEnd if\n</code></pre>\n\n<p>^^ doesn't do anything</p>\n\n<p>I've also tried</p>\n\n<pre><code>Dim radioBoolean as Boolean\nradioBoolean = ActivePresentation.Slides(1).shapes(\"radioButton1\").value \n\nif radioBoolean = true\nMsgBox(\"Plz work\")\nend if\n</code></pre>\n\n<p>Nothing happens</p>\n"}, {"tags": ["json", "excel", "vba", "scriptcontrol"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563990723, "post_id": 57188565, "comment_id": 100887328, "body": "Are you prepared to use a different json parser?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1563991317, "post_id": 57188565, "comment_id": 100887603, "body": "Would really recommend <i>not</i> using the JScript engine to Eval JSON (though I have used it in answers here previously...) - that can execute arbitrary code on your PC and leaves you vulnerable to thing like creating a new Scripting.FileSystemObject and deleting your files.  JScript executing outside of the browser doesn&#39;t get sandboxed."}, {"owner": {"reputation": 35, "user_id": 1432361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3941d128c8e763df8dc31b6dfd46aaec?s=128&d=identicon&r=PG", "display_name": "davor.geci", "link": "https://stackoverflow.com/users/1432361/davor-geci"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563991694, "post_id": 57188565, "comment_id": 100887793, "body": "@QHarr yes sure"}, {"owner": {"reputation": 35, "user_id": 1432361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3941d128c8e763df8dc31b6dfd46aaec?s=128&d=identicon&r=PG", "display_name": "davor.geci", "link": "https://stackoverflow.com/users/1432361/davor-geci"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563991698, "post_id": 57188565, "comment_id": 100887798, "body": "@Tim Williams no problem to use some other solutions to solve my problem"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 1432361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3941d128c8e763df8dc31b6dfd46aaec?s=128&d=identicon&r=PG", "display_name": "davor.geci", "link": "https://stackoverflow.com/users/1432361/davor-geci"}, "edited": false, "score": 0, "creation_date": 1563991901, "post_id": 57188787, "comment_id": 100887897, "body": "this looks interesting and I will try it out. Is there maybe also some way to use this in vb6? I was looking at that JsonConverter.bas but I don&#39;t think that I could convert it to vb6. But it should work in vba"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 35, "user_id": 1432361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3941d128c8e763df8dc31b6dfd46aaec?s=128&d=identicon&r=PG", "display_name": "davor.geci", "link": "https://stackoverflow.com/users/1432361/davor-geci"}, "edited": false, "score": 1, "creation_date": 1563992102, "post_id": 57188787, "comment_id": 100887988, "body": "It does work in VBA. It won&#39;t work in vb6. With vb6 you could use similar overall logic however."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563992526, "post_id": 57188787, "comment_id": 100888171, "body": "@TimWilliams Many thanks. Will be interesting to have a look at that."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1563991913, "last_edit_date": 1563991913, "creation_date": 1563991205, "answer_id": 57188787, "question_id": 57188565, "link": "https://stackoverflow.com/questions/57188565/reading-a-json-and-looping-in-vba/57188787#57188787", "title": "Reading a JSON and looping in VBA", "body": "<p>I would use <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">jsonconverter.bas</a> to parse the json. After installing the code from that link in a standard module called JsonConverter, go to VBE > Tools > References > Add a reference to Microsoft Scripting Runtime.</p>\n\n<p>Then I would dimension an array to hold the results. I would determine rows from the number of items in the json collection returned and the number of columns from the size of the first item dictionary. Loop the json object, and inner loop the dictionary keys of each dictionary in collection, and populate the array. Write the array out in one go at end.</p>\n\n<p>Below, I am reading in the json string from cell A1 but you would replace that with your json source.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim json As Object, r As Long, c As Long, headers()\n    Dim results(), ws As Worksheet, item As Object, key As Variant\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set json = JsonConverter.ParseJson(ws.[A1].Value)  '&lt;Reading json from cell. Returns collection\n    headers = json.item(1).keys  'each item in collection is a dictionary. Use .keys to get headers for results e.g. ElectronicId\n    ReDim results(1 To json.Count, 1 To UBound(headers) + 1)\n    For Each item In json 'loop json and populate results array\n        r = r + 1: c = 1\n        For Each key In item.keys\n            results(r, c) = item(key)\n            c = c + 1\n        Next\n    Next\n    With ws\n        .Cells(2, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(3, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 1432361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3941d128c8e763df8dc31b6dfd46aaec?s=128&d=identicon&r=PG", "display_name": "davor.geci", "link": "https://stackoverflow.com/users/1432361/davor-geci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 57188787, "answer_count": 1, "score": 0, "last_activity_date": 1564034673, "creation_date": 1563990341, "last_edit_date": 1564034673, "question_id": 57188565, "link": "https://stackoverflow.com/questions/57188565/reading-a-json-and-looping-in-vba", "title": "Reading a JSON and looping in VBA", "body": "<p>I'm getting from the server a JSON string with the statuses of a particular actions. In this case it returns results for 2 actions. \nFor \nID: 551720\nand\nID: 551721</p>\n\n<p>String looks like this:</p>\n\n<pre><code>[{\"ElectronicId\":551720,\"DocumentNr\":\"130/10/15\",\n\"DocumentTypeId\":1,\"DocumentTypeName\":\"eInvoice\",\n\"StatusId\":30,\"StatusName\":\"Sent\",\"RecipientBusinessNumber\":\"0050960000\",\n\"RecipientBusinessUnit\":\"\",\"RecipientBusinessName\":\"Comp d.o.o.\",\n\"Created\":\"2019-07-23T21:21:23.743\",\"Updated\":\"2019-07-23T21:21:24.587\",\n\"Sent\":\"2019-07-23T21:21:24.587\",\"Delivered\":null},\n{\"ElectronicId\":551721,\"DocumentNr\":\"130/10/15\",\n\"DocumentTypeId\":1,\"DocumentTypeName\":\"eInvoice\",\n\"StatusId\":30,\"StatusName\":\"Sent\",\"RecipientBusinessNumber\":\"00509605454\",\n\"RecipientBusinessUnit\":\"\",\"RecipientBusinessName\":\"Comp d.o.o.\",\n\"Created\":\"2019-07-23T21:23:05.887\",\"Updated\":\"2019-07-23T21:23:07.043\",\n\"Sent\":\"2019-07-23T21:23:07.043\",\"Delivered\":null}]\n</code></pre>\n\n<p>Sometimes it returns 1, sometimes 2, or maybe 20 statuses (different \"ElectronicId\")</p>\n\n<p>How could I loop within JSON.\nI have a code that works when I have only 1 response, but it doesn't work when I have more than 1.\nHere is the code for 1 response:</p>\n\n<pre><code>Dim cJS As New clsJasonParser\n\n cJS.InitScriptEngine\n\nresults = \"\"\"\"\"here goes the JSON string\"\"\"\"\"\"\n\n Set JsonObject = cJS.DecodeJsonString(CStr(result))\n\n\n        Debug.Print cJS.GetProperty(JsonObject, \"ElectronicId\")\n        Debug.Print cJS.GetProperty(JsonObject, \"DocumentNr\")\n        Debug.Print cJS.GetProperty(JsonObject, \"DocumentTypeId\")\n        Debug.Print cJS.GetProperty(JsonObject, \"DocumentTypeName\")\n        Debug.Print cJS.GetProperty(JsonObject, \"StatusId\")\n</code></pre>\n\n<p>Here is the code for the clsJasonParser bClass:</p>\n\n<pre><code>Option Explicit\n\nPrivate ScriptEngine As ScriptControl\n\nPublic Sub InitScriptEngine()\n\n    Set ScriptEngine = New ScriptControl\n    ScriptEngine.Language = \"JScript\"\n    ScriptEngine.AddCode \"function getProperty(jsonObj, propertyName) { return jsonObj[propertyName]; } \"\n    ScriptEngine.AddCode \"function getKeys(jsonObj) { var keys = new Array(); for (var i in jsonObj) { keys.push(i); } return keys; } \"\n\nEnd Sub\n\nPublic Function DecodeJsonString(ByVal JsonString As String)\n\n    Set DecodeJsonString = ScriptEngine.Eval(\"(\" + JsonString + \")\")\n\nEnd Function\n\nPublic Function GetProperty(ByVal JsonObject As Object, ByVal propertyName As String) As Variant\n\n    GetProperty = ScriptEngine.Run(\"getProperty\", JsonObject, propertyName)\n\nEnd Function\n\nPublic Function GetObjectProperty(ByVal JsonObject As Object, ByVal propertyName As String) As Object\n\n    Set GetObjectProperty = ScriptEngine.Run(\"getProperty\", JsonObject, propertyName)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1563990149, "post_id": 57188456, "comment_id": 100887085, "body": "How isn&#39;t this working? Also, I would switch <code>ActiveCell</code> to actually be the cell you want the data in.  Also, it should be <code>.Value</code>, not <code>.Formula</code>.  Finally, I think you want <code>last as Range</code> and <code>first as Range</code>, not <code>Variant</code>.  What are you ultimately trying to do, in practice? This <i>might</i> be possible with a Formula if you&#39;re just trying to add some names to cells..."}, {"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 0, "creation_date": 1563990158, "post_id": 57188456, "comment_id": 100887087, "body": "the value of first doesn&#39;t get incremented in the loop. As a result it will never be empty, will it?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1563990408, "post_id": 57188456, "comment_id": 100887197, "body": "To start, <i>is not working for me</i> is not a problem description. In what way <b>specifically</b> is it <b>not working</b>? And concatenating two strings (first &amp; &quot; &quot; &amp; last) results in a value, not a formula. Then, you set <code>first</code> before the loop starts, but never change it inside the loop, so the outer loop should never end (unless the initial <code>first.Value</code> is empty when the loop starts, in which case none of your code would run)."}, {"owner": {"reputation": 63, "user_id": 11775540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98415be18ba92a3759f3570eddd9cf65?s=128&d=identicon&r=PG&f=1", "display_name": "AlmondButterJoy", "link": "https://stackoverflow.com/users/11775540/almondbutterjoy"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1563998734, "post_id": 57188456, "comment_id": 100890779, "body": "@BruceWayne Ultimately (sorry I was vague on the descrip earlier) I am running reports from five different data systems and would like for them to run seamlessly through a cross-check. I have all the connections of imports through VBA and SQL configured, but now formatting the values (like names, ID numbers, etc.) to run Boolean tests is becoming a hassle. I believe I am more fried from the first half so I am running into problems now."}, {"owner": {"reputation": 63, "user_id": 11775540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98415be18ba92a3759f3570eddd9cf65?s=128&d=identicon&r=PG&f=1", "display_name": "AlmondButterJoy", "link": "https://stackoverflow.com/users/11775540/almondbutterjoy"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1563998820, "post_id": 57188456, "comment_id": 100890822, "body": "@BruceWayne In this problem, all I am trying to do is concatenate without typing functions in, so when I hit my with &#39;X&#39; amount of sub processes, it runs without me touching this as I have other core business functions to do then to waste my time validating. In this problem the logic stands below: B11= Bob and C11 = Wilson, in column D11 is where I would like to input this concatenate (join) of cell values. What you stated successfully pulls the first name, but does not pull the last name.  To answer Ken White... &quot;is not working&quot; means I am not getting errors, and it is not working. thnx &lt;3"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1563990794, "creation_date": 1563990794, "answer_id": 57188679, "question_id": 57188456, "link": "https://stackoverflow.com/questions/57188456/combine-first-and-last-name-into-full-name-vba/57188679#57188679", "title": "Combine First and Last name into full name (VBA)", "body": "<p>No need for a loop. The simplest way would be to find the last row in Col B and then enter the formula in Col D in one go. For example</p>\n\n<pre><code>With Worksheets(\"RG0054_Term Validation\")\n    Lrow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n\n    .Columns(4).Insert\n    .Range(\"D10\").Value = \"Employee Name\"\n\n    .Range(\"D11:D\" &amp; Lrow).Formula = \"=B11 &amp; \"\" \"\" &amp; C11\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 11775540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98415be18ba92a3759f3570eddd9cf65?s=128&d=identicon&r=PG&f=1", "display_name": "AlmondButterJoy", "link": "https://stackoverflow.com/users/11775540/almondbutterjoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "accepted_answer_id": 57188679, "answer_count": 1, "score": 0, "last_activity_date": 1563990794, "creation_date": 1563989800, "last_edit_date": 1563990029, "question_id": 57188456, "link": "https://stackoverflow.com/questions/57188456/combine-first-and-last-name-into-full-name-vba", "title": "Combine First and Last name into full name (VBA)", "body": "<p>Long story short, I need pull a first name and last name into one string of text in VBA. This is a part of an automated report so I need it to loop until the next cell is empty. </p>\n\n<p>I can for some reason split a full name into separate text, but combining the two cells is not working for me.</p>\n\n<pre><code>Dim first As Variant, last As Variant, full As string\n\nWith Worksheets(\"RG0054_Term Validation\")\n    .Columns(\"D\").Insert\n    .Range(\"D10\").Value = \"Employee Name\"\n    Set first = .Range(\"B11\")\n    Set last = .Range(\"C11\")\n    full = 0\n\n        Do Until IsEmpty(first.Value)\n        Do Until IsEmpty(last.Value)\n            ActiveCell.Offset(0, full).Formula = first.Value &amp; \" \" &amp; last.Value\n            full = full + 1\n            Set last = last.Offset(0, 1)\n\n        Loop\n\n Set last = .Range(\"C11\")\n Set title = title.Offset(1, 0)\n\n  Loop\n\n  End With\n\n\nEnd Sub\n</code></pre>\n\n<p>turn b11 &amp; c11 = d11 for i to 3000 \nI am guessing I could do a loop first = i to 3000 and last = 1 to 2 .. but I am not sure how to organize this... Also an explanation of the script logic would be great so I can learn the code syntax rather than regurgitate it.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1563993378, "creation_date": 1563993378, "answer_id": 57189279, "question_id": 57188455, "link": "https://stackoverflow.com/questions/57188455/automatically-move-incoming-emails-by-subject-to-sub-folder-in-a-shared-mailbox/57189279#57189279", "title": "Automatically move incoming emails by subject to sub folder in a shared mailbox", "body": "<p>It looks like you are interested in the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.application.newmailex\" rel=\"nofollow noreferrer\">NewMailEx</a> event of the Application class which is fired when a new item is received in the Inbox. The <code>NewMailEx</code> event fires when a new message arrives in the Inbox and before client rule processing occurs. You can use the Entry ID returned in the <code>EntryIDCollection</code> array to call the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.namespace.getitemfromid\" rel=\"nofollow noreferrer\">NameSpace.GetItemFromID</a> method and process the item.</p>\n\n<pre><code>Public WithEvents outApp As Outlook.Application\n\nSub Intialize_Handler()\n    Set outApp = Application\nEnd Sub\n\nPrivate Sub outApp_NewMailEx(ByVal EntryIDCollection As String)\n   Dim mai As Outlook.MailItem\n   Set mai = Application.Session.GetItemFromID(strEntryId)\n\n   MsgBox mai.Subject\n\n   MoveToFolder(mai)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11831923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e4a2221c426ce6a16ab7035eb9329c?s=128&d=identicon&r=PG&f=1", "display_name": "TacticalTurtl", "link": "https://stackoverflow.com/users/11831923/tacticalturtl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1591162540, "creation_date": 1563989793, "last_edit_date": 1591162540, "question_id": 57188455, "link": "https://stackoverflow.com/questions/57188455/automatically-move-incoming-emails-by-subject-to-sub-folder-in-a-shared-mailbox", "title": "Automatically move incoming emails by subject to sub folder in a shared mailbox", "body": "<p>We organize emails within a shared mailbox. There are folders for each area, then a sub folder for each specific location.</p>\n\n<p>I am trying to check the subject line of incoming email to move the email to its proper folder.</p>\n\n<p>The thing to look for in the subject line is similar to \"%%-%%\" the percents being letters. We have over 900 locations and I would like to not have to create 900 rules.</p>\n\n<pre><code>Sub MoveToFolder(Item As Outlook.MailItem)\n\n    Dim Subject As String\n    Subject = Item.Subject\n\n    Dim FolderToMoveTo As Outlook.Folder\n    Set FolderToMoveTo = GetFolder(\"KX-BH\")\n\n    If (CheckSubject(Subject, \"KX-BH\")) Then\n        Item.Move (FolderToMoveTo)\n    End If\n\nEnd Sub\n\n\nFunction CheckSubject(Subject As String, PatternToCheck As String)\n\n    Dim ObjRegExp As RegExp\n    Dim ObjMatch As Match\n\n    Set ObjRegExp = New RegExp\n    ObjRegExp.Pattern = PatternToCheck\n\n    If (ObjRegExp.Text(Subject) = True) Then\n        CheckSubject = True\n    End If\n\nEnd Function\n\n\nFunction GetFolder(ByVal FolderName As String) As Outlook.Folder\n\n    Dim ObjFolder As Outlook.Folder\n    Set ObjFolder = Outlook.Application.Session.GetDefaultFolder(olFolderInbox).Folders(FolderName)\n    Set GetFolder = ObjFolder\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1563989511, "post_id": 57188315, "comment_id": 100886803, "body": "step through your code see what is happening line by line"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1563990353, "post_id": 57188315, "comment_id": 100887166, "body": "Also, why do you keep calling the various <code>Application</code> bits? AFAIK you can put them all in your top/first sub and it&#39;ll apply as it calls the others."}], "answers": [{"comments": [{"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 0, "creation_date": 1563996696, "post_id": 57189983, "comment_id": 100889929, "body": "You also might benefit from marking the subs getting called as <code>Private Sub</code>, that way under the Macro selection in the Developer tab of the ribbon they don&#39;t show up and will remain hidden."}, {"owner": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "edited": false, "score": 0, "creation_date": 1564004813, "post_id": 57189983, "comment_id": 100892854, "body": "Hey @Mark S. I appreciate your response and advice about the subroutines (TurnOffFunctions and TurnOnFunctions). I made the changes you recommended but it still isn&#39;t working for some reason. I checked and none of the 5 calls for the Project_With_Discounts are working. They still work individually though so that and your advice not working has me quite confused. I think it must be something to do with the Project_With_Discounts sub since the 5 subs getting called work by themselves but again, I&#39;m not a seasoned macro user yet. Working on a Macbook definitely has nothing to do with it?"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "edited": false, "score": 0, "creation_date": 1564087367, "post_id": 57189983, "comment_id": 100926127, "body": "I&#39;m unsure if it&#39;s because you&#39;re on mac, but double check to make sure the tab references are valid, meaning the tab names haven&#39;t changed because that&#39;s the only actual reference I can see having an issue. as a refresher the tab names I see which are case sensitive are &quot;THIRD-PARTY&quot; &amp; &quot;SOW&quot;"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "edited": false, "score": 0, "creation_date": 1564163863, "post_id": 57189983, "comment_id": 100954284, "body": "Did you check the tab names and ensure that wasn&#39;t the issue?"}], "tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1563996435, "creation_date": 1563996435, "answer_id": 57189983, "question_id": 57188315, "link": "https://stackoverflow.com/questions/57188315/how-to-call-a-macro-from-a-macro-initiated-in-a-dropdown/57189983#57189983", "title": "How to call a macro from a macro initiated in a dropdown?", "body": "<p>it looks like there was a type-o that called one of the subroutines incorrectly. VBA is very unforgiving to typing error. Try what I have below. </p>\n\n<p>I also added two more subroutines <code>TurnOffFunctions</code> &amp; <code>TurnOnFunctions</code> to avoid redundancies your code had. I do this because it's easier to maintain, easier to call, and you can move it to other subs you have.</p>\n\n<p>I tested the code and it seemed like everything worked fine. So please if this works for you mark it as the answer.</p>\n\n<pre><code>Sub Project_With_Discounts()\nCall TurnOffFunctions\nCall UnhideDiscountColumn\nCall MakeManagementFee10\nCall UnhideTotalDiscount\nCall UnhideTermsAndConditions\nCall HideStepanColumns 'This is the line that had the type error. It was missing the S\nCall TurnOnFunctions\nEnd Sub\n\nSub UnhideDiscountColumn()\nWorksheets(\"THIRD-PARTY\").Range(\"L:L\").EntireColumn.Hidden = False\nEnd Sub\n\nSub MakeManagementFee10()\nSheets(\"THIRD-PARTY\").Range(\"C26\").Value2 = 0.1\nEnd Sub\n\nSub UnhideTotalDiscount()\nWorksheets(\"SOW\").Rows(\"708:708\").EntireRow.Hidden = False\nEnd Sub\n\nSub UnhideTermsAndConditions()\nSheets(\"SOW\").Range(\"726:779\").Rows.Hidden = False\nEnd Sub\n\nSub HideStepanColumns()\nSheets(\"THIRD-PARTY\").Range(\"H:J\").EntireColumn.Hidden = True\nEnd Sub\n\nSub TurnOffFunctions()\n\nApplication.DisplayStatusBar = False\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\n\nEnd Sub\n\nSub TurnOnFunctions()\n\nApplication.DisplayStatusBar = True\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11427989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c721b299a7f656c7af98fa91c1d8d15?s=128&d=identicon&r=PG&f=1", "display_name": "CTEAGUE212", "link": "https://stackoverflow.com/users/11427989/cteague212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1611566545, "creation_date": 1563989218, "last_edit_date": 1611566545, "question_id": 57188315, "link": "https://stackoverflow.com/questions/57188315/how-to-call-a-macro-from-a-macro-initiated-in-a-dropdown", "title": "How to call a macro from a macro initiated in a dropdown?", "body": "<p>I have a dropdown with four options in the first worksheet of my workbook. This workbook is named SOW.</p>\n<p>When any of the options are clicked, a macro is run. Each of these four macros call several other macros. The issue is that some called macros aren't working.</p>\n<p>One macro selected from the dropdown is called <code>Sub Project_With_Discounts()</code>.<br />\nThis macro calls five other macros <code>Sub UnhideDiscountColumn()</code>, <code>Sub MakeManagementFee10()</code>, <code>Sub UnhideTermsAndConditions()</code>, <code>Sub HideStepanColumns ()</code>, and <code>Sub UnhideTotalDiscount()</code>.<br />\nNone of these called macros are working.</p>\n<p>I am working on a Macbook Air.</p>\n<p>I temporarily created a button and assigned each macro to it one at a time. The macros work individually.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Project_With_Discounts()\n    Application.DisplayStatusBar = False\n    Call UnhideDiscountColumn\n    Call MakeManagementFee10\n    Call UnhideTotalDiscount\n    Call UnhideTermsAndConditions\n    Call HideStepanColumn\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.EnableEvents = True\nEnd Sub\n\nSub UnhideDiscountColumn()\n    Application.DisplayStatusBar = False\n    Worksheets(&quot;THIRD-PARTY&quot;).Range(&quot;L:L&quot;).EntireColumn.Hidden = False\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.EnableEvents = True\nEnd Sub\n\nSub MakeManagementFee10()\n    Application.DisplayStatusBar = False\n    Sheets(&quot;THIRD-PARTY&quot;).Range(&quot;C26&quot;).Value2 = 0.1\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.EnableEvents = True\nEnd Sub\n\nSub UnhideTotalDiscount()\n    Application.DisplayStatusBar = False\n    Worksheets(&quot;SOW&quot;).Rows(&quot;708:708&quot;).EntireRow.Hidden = False\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.EnableEvents = True\nEnd Sub\n\nSub UnhideTermsAndConditions()\n    Sheets(&quot;SOW&quot;).Range(&quot;726:779&quot;).Rows.Hidden = False\nEnd Sub\n\nSub HideStepanColumns()\n    Application.DisplayStatusBar = False\n    Sheets(&quot;THIRD-PARTY&quot;).Range(&quot;H:J&quot;).EntireColumn.Hidden = True\n    Application.DisplayStatusBar = True\nEnd Sub\n</code></pre>\n<p>I don't get any error messages.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1563985001, "post_id": 57187167, "comment_id": 100884642, "body": "You could turn off the events before you save the file."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1563986023, "post_id": 57187167, "comment_id": 100885153, "body": "<code>If Environ$(&quot;USERNAME&quot;) = &quot;MSauce&quot; Then Exit Sub</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1563985844, "post_id": 57187328, "comment_id": 100885066, "body": "This works perfectly! Thinking out of the box, is there a way to leverage that input from the msgbox and paste it onto cell &#39;C19&#39;? And exit sub if the str = &#39;MSAUCE&#39;?"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1563986835, "last_edit_date": 1563986835, "creation_date": 1563985079, "answer_id": 57187328, "question_id": 57187167, "link": "https://stackoverflow.com/questions/57187167/override-msgbox-in-excel/57187328#57187328", "title": "Override MsgBox in Excel", "body": "<p>Will something like this work ?</p>\n\n<p>If you Enter <code>MSauce</code> it will save without name, or if you enter any other name it will save and enter that value in <code>C19</code>, else it won't save</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, cancel As Boolean)\n\nDim str As String\n\nstr = Application.Sheets(\"Sheet1\").Range(\"C19\").Value\n\nIf str = \"(INSERT NAME HERE)\" Or str = \"\" Then\n\n    str = InputBox(\"Please input your name\", \"Missing Name\")\n\n        If str = \"MSauce\" Then\n            Exit Sub\n        ElseIf Len(str) &gt; 0 Then\n            Application.Sheets(\"Sheet1\").Range(\"C19\").Value = str\n        Else: cancel = True\n        End If\n\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1563985295, "creation_date": 1563985295, "answer_id": 57187391, "question_id": 57187167, "link": "https://stackoverflow.com/questions/57187167/override-msgbox-in-excel/57187391#57187391", "title": "Override MsgBox in Excel", "body": "<p>If this is only needed to save the file on your computer you could turn off the events just before saving with</p>\n\n<pre><code>Application.EnableEvents=false\n</code></pre>\n\n<p>and turn it on afterward with</p>\n\n<pre><code>Application.EnableEvents=true\n</code></pre>\n\n<p>Another possibilty would be to check on a certain username in the BeforeSave event</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, cancel As Boolean)\n\n    If Not Environ(\"Username\") = \"myself\" Then\n\n        If Application.Sheets(\"Sheet1\").Range(\"C19\").Value = \"(INSERT NAME HERE)\" Or Application.Sheets(\"Sheet1\").Range(\"C19\").Value = \"\" Then\n            cancel = True\n            MsgBox \"Please input your name in cell C19\"\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 57187328, "answer_count": 2, "score": 0, "last_activity_date": 1563987198, "creation_date": 1563984454, "last_edit_date": 1563987198, "question_id": 57187167, "link": "https://stackoverflow.com/questions/57187167/override-msgbox-in-excel", "title": "Override MsgBox in Excel", "body": "<p>I have a form that requires a user to 'Sign' an excel file before saving. Issue is, I can't save the worksheet if that cell is blank, and I don't want to fill out the form with 'fake data' in order to save the file, as this will prevent the user from being alerted in signing the form. </p>\n\n<p>Ideally I would like a msgbox that has some sort of password input from myself that would bypass this validation that would allow me to save the file when cell C19 is blank when I enter the correct password. </p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, cancel As \nBoolean)\n\nIf Application.Sheets(\"Sheet1\").Range(\"C19\").Value = \"(INSERT NAME HERE)\" Or Application.Sheets(\"Sheet1\").Range(\"C19\").Value = \"\" Then\ncancel = True\nMsgBox \"Please input your name in cell C19\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1563986258, "creation_date": 1563986258, "answer_id": 57187643, "question_id": 57187119, "link": "https://stackoverflow.com/questions/57187119/excel-macro-saving-file-to-the-wrong-directory/57187643#57187643", "title": "Excel Macro saving file to the wrong directory", "body": "<p>Your code was unnecessarily complex.</p>\n\n<p><strong>Try this simpler version.</strong></p>\n\n<pre><code>Sub TEST()\n\n    ActiveWorkbook.Save\n        ActiveWorkbook.SaveAs fileName:= _\n        GetNextAvailableName(\"M:\\Excel\\SavedVersions\\TEST.xlsm\")\n\nEnd Sub\n\nFunction GetNextAvailableName(ByVal strPath As String) As String\n\n        Dim i as Interger: i = 0\n\n        Do Until Len(Dir(strPath)) = 0\n            i = i + 1\n            strPath = \"M:\\Excel\\SavedVersions\\TESTrev\" &amp; i &amp; \".xlsm\"\n        Loop\n\n    GetNextAvailableName = strPath\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1563988468, "creation_date": 1563988468, "answer_id": 57188131, "question_id": 57187119, "link": "https://stackoverflow.com/questions/57187119/excel-macro-saving-file-to-the-wrong-directory/57188131#57188131", "title": "Excel Macro saving file to the wrong directory", "body": "<ol>\n<li>Keep your code simple. If your path is constant then might as well define a variable for it so that it can be used whenever and whereever you want. This way if there is any change in the path, you have to make the change at only one place.</li>\n<li>While saving the file, also specify the <code>FileFormat</code> parameter to avoid problems. You might want to read more about it <a href=\"https://www.rondebruin.nl/win/s5/win001.htm\" rel=\"nofollow noreferrer\">HERE</a></li>\n</ol>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>Option Explicit\n\nConst sPath As String = \"M:\\Excel\\SavedVersions\\\"\n\nSub Sample()\n    Dim flName As String\n\n    flName = sPath &amp; GetNextAvailableName()\n\n    ActiveWorkbook.Save\n    ActiveWorkbook.SaveAs Filename:=flName, _\n                          FileFormat:=xlOpenXMLWorkbookMacroEnabled\nEnd Sub\n\nFunction GetNextAvailableName() As String\n    Dim i As Integer: i = 1\n    Dim newFile As String\n\n    newFile = \"TestRev\" &amp; i &amp; \".xlsm\"\n\n    Do Until Dir(sPath &amp; newFile) = \"\"\n        i = i + 1\n        newFile = \"TestRev\" &amp; i &amp; \".xlsm\"\n    Loop\n\n    GetNextAvailableName = newFile\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11831481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96dede5d8d64804a6bd9370c9b0a18c9?s=128&d=identicon&r=PG&f=1", "display_name": "MFreeze", "link": "https://stackoverflow.com/users/11831481/mfreeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563988468, "creation_date": 1563984302, "last_edit_date": 1563985511, "question_id": 57187119, "link": "https://stackoverflow.com/questions/57187119/excel-macro-saving-file-to-the-wrong-directory", "title": "Excel Macro saving file to the wrong directory", "body": "<p>I have looked at quite a lot of similar questions, but none of them seem to work for my specific issue.</p>\n\n<p>I have a macro that saves my file with a new name if it encounters a file with the same name.</p>\n\n<p>What keeps happening is that it saves the original file to the correct folder, but then when it encounters the file name the next time I save it, the instanced file gets saved to the same folder as the template rather than the folder that they should go to.</p>\n\n<p>In the example below, my template file is saved in the \"M:\\Excel\\\" directory.</p>\n\n<p>It saves the first \"TEST\" file into the \"M:\\Excel\\SavedVersions\\\" directory since the file name doesn't exist yet.</p>\n\n<p>Then when I run the macro again to have it automatically save an instanced version (ie - \"TESTrev1\"), it keeps saving the instanced versions to the \"M:\\Excel\\\" directory instead of saving it to the \"SavedVersions\" subfolder.</p>\n\n<p>Not sure what needs to be changed or done differently to get the instanced versions to save to the correct folder.</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p>Thanks in advance! :)</p>\n\n<pre><code>Sub TEST()\n\n    ActiveWorkbook.Save\n        ActiveWorkbook.SaveAs Filename:= _\n        GetNextAvailableName(\"M:\\Excel\\SavedVersions\\TEST.xlsm\")\n\nEnd Sub\n\nFunction GetNextAvailableName(ByVal strPath As String) As String\n\n    With CreateObject(\"Scripting.FileSystemObject\")\n\n        Dim strFolder As String, strBaseName As String, strExt As String, i As Long\n        strFolder = .GetParentFolderName(\"M:\\Excel\\SavedVersions\\\")\n        strBaseName = .GetBaseName(\"TEST\")\n        strExt = .GetExtensionName(\".xlsm\")\n\n        Do While .FileExists(strPath)\n            i = i + 1\n            strPath = .BuildPath(strFolder, strBaseName &amp; \"rev\" &amp; i &amp; \".\" &amp; strExt)\n        Loop\n\n    End With\n\n    GetNextAvailableName = strPath\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1563993722, "post_id": 57187392, "comment_id": 100888713, "body": "Thank you so much @peh . How would i go about sorting these dates ascending??"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "edited": false, "score": 0, "creation_date": 1564033310, "post_id": 57187392, "comment_id": 100898664, "body": "Sort after removing the duplicates but before transposing using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.sort\" rel=\"nofollow noreferrer\">Range.Sort method</a> on <code>TmpRange</code>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1563986145, "last_edit_date": 1563986145, "creation_date": 1563985296, "answer_id": 57187392, "question_id": 57187106, "link": "https://stackoverflow.com/questions/57187106/transposing-column-and-removing-duplicates/57187392#57187392", "title": "Transposing Column and removing duplicates", "body": "<p>The official documentation of the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.removeduplicates\" rel=\"nofollow noreferrer\">Range.RemoveDuplicates method</a> has an example how to use it correctly. </p>\n\n<p>But the issue here is that the method can only remove duplicate <strong>rows</strong> but you try to remove the duplicate columns. So you can use it on a range of mutliple rows like <code>F2:F100</code> but you cannot use it on a range of multiple columns <code>B1:CW1</code>.</p>\n\n<p>So you need to remove the duplicates <strong>before you transpose</strong> in your <code>rngSource</code>. Note that will change your source data.</p>\n\n<pre><code>Sub test()\n    Sheets(\"Sheet1\").Range(\"F2:F100\").RemoveDuplicates Columns:=Array(1), Header:=xlNo\n    CopyTransposed Sheets(\"Sheet1\").Range(\"F2:F100\"), Sheets(\"Sheet2\").Range(\"B1\")\nEnd Sub\n</code></pre>\n\n<p>If you don't want to change your source data then you would need to copy the source into a (temporary) sheet without transposing, remove the dupicates there, and then transpose.</p>\n\n<pre><code>Sub test()\n    'create temporary sheet\n    Dim wsTemp As Worksheet\n    Set wsTemp = ThisWorkbook.Worksheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n\n    On Error GoTo REMOVE_TEMPSHEET 'make sure temp sheet gets removed if something goes wrong\n\n    Dim SourceRange As Range\n    Set SourceRange = Sheets(\"Sheet1\").Range(\"F2:F100\")\n\n    Dim TmpRange As Range\n    Set TmpRange = wsTemp.Range(\"A1\").Resize(SourceRange.Rows.Count, SourceRange.Columns.Count)\n\n    'copy to temporary range\n    TmpRange.Value = SourceRange.Value\n\n    'remove duplicates\n    TmpRange.RemoveDuplicates Columns:=Array(1), Header:=xlNo\n\n    'transpose\n    CopyTransposed TmpRange, Sheets(\"Sheet2\").Range(\"B1\")\n\n    'remove temporary sheet\nREMOVE_TEMPSHEET:\n    Application.DisplayAlerts = False\n    wsTemp.Delete\n    Application.DisplayAlerts = True\n\n    If Err.Number &lt;&gt; 0 Then\n        Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\n    End If\nEnd Sub\n</code></pre>\n\n<p>You might want to use <code>Application.ScreenUpdating = True/False</code> to prevent flickering.</p>\n"}], "owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 57187392, "answer_count": 1, "score": 0, "last_activity_date": 1563986145, "creation_date": 1563984269, "question_id": 57187106, "link": "https://stackoverflow.com/questions/57187106/transposing-column-and-removing-duplicates", "title": "Transposing Column and removing duplicates", "body": "<p>I successfully transposed my desired column from vertical to horizontal on \"sheet2\" of my workbook. My next goal is to remove duplicate dates and sort them ascending. </p>\n\n<pre><code>Sub CopyTransposed(rngSource As Range, rngTargetCell As Range)\nrngTargetCell.Resize(rngSource.Columns.Count, rngSource.Rows.Count).Value = _\n    Application.WorksheetFunction.Transpose(rngSource)\nEnd Sub\n\nSub test()\n\nCopyTransposed Sheets(\"Sheet1\").Range(\"F2:F100\"), \nSheets(\"Sheet2\").Range(\"B1\").RemoveDuplicates\n\n\nEnd Sub\n</code></pre>\n\n<p>I must have the .removeduplicates in the wrong place. Also, where would the ascending dates go in the code?? Thank you so much!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 11770899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a4dd2a41f1a8f2357ad2397ba08ff1?s=128&d=identicon&r=PG&f=1", "display_name": "actuarial.codes", "link": "https://stackoverflow.com/users/11770899/actuarial-codes"}, "edited": false, "score": 0, "creation_date": 1564666279, "post_id": 57186471, "comment_id": 101112627, "body": "anyone other suggestions? i still haven&#39;t been able to fix this error"}], "answers": [{"comments": [{"owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "reply_to_user": {"reputation": 1, "user_id": 11770899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a4dd2a41f1a8f2357ad2397ba08ff1?s=128&d=identicon&r=PG&f=1", "display_name": "actuarial.codes", "link": "https://stackoverflow.com/users/11770899/actuarial-codes"}, "edited": false, "score": 0, "creation_date": 1563983429, "post_id": 57186617, "comment_id": 100883858, "body": "Could it be a case that you already have a button binded to a same &#39;onAction&#39; handler ?"}, {"owner": {"reputation": 1, "user_id": 11770899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a4dd2a41f1a8f2357ad2397ba08ff1?s=128&d=identicon&r=PG&f=1", "display_name": "actuarial.codes", "link": "https://stackoverflow.com/users/11770899/actuarial-codes"}, "edited": false, "score": 0, "creation_date": 1563983544, "post_id": 57186617, "comment_id": 100883914, "body": "no this is the first button im creating in this file. I am creating another one after this with the same code as above but that works fine. the error has something to do with the printworkbook function"}, {"owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "reply_to_user": {"reputation": 1, "user_id": 11770899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a4dd2a41f1a8f2357ad2397ba08ff1?s=128&d=identicon&r=PG&f=1", "display_name": "actuarial.codes", "link": "https://stackoverflow.com/users/11770899/actuarial-codes"}, "edited": false, "score": 0, "creation_date": 1563983652, "post_id": 57186617, "comment_id": 100883972, "body": "Is you file macro enabled? try saving as xlsm."}, {"owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "reply_to_user": {"reputation": 1, "user_id": 11770899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a4dd2a41f1a8f2357ad2397ba08ff1?s=128&d=identicon&r=PG&f=1", "display_name": "actuarial.codes", "link": "https://stackoverflow.com/users/11770899/actuarial-codes"}, "edited": false, "score": 0, "creation_date": 1563984333, "post_id": 57186617, "comment_id": 100884306, "body": "Please try to put the macro in the same file. I see that macro is located at SomeFile.xls and the active file is MyFile.XLS"}], "tags": [], "owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "is_accepted": false, "score": 1, "last_activity_date": 1563982679, "creation_date": 1563982679, "answer_id": 57186617, "question_id": 57186471, "link": "https://stackoverflow.com/questions/57186471/unable-to-set-the-onaction-property-of-the-button-class-error/57186617#57186617", "title": "unable to set the onAction property of the button class error", "body": "<p>Your code assumes that the button is selected after a call to <code>ActiveSheet.Buttons.Add</code> and that the selection succeeded.\nYou should use the return value of the <code>ActiveSheet.Buttons.Add</code> as shown below:</p>\n\n<pre><code>Windows(\"MyFile.XLS\").Activate\n    Sheets(\"Sheet1\").Select\n        Range(\"G12\").Select\n        Set Button = ActiveSheet.Buttons.Add(306, 36.6, 94.8, 21)\n        Button.OnAction = \"'SomeFile.xls'!PrintWorkbook.PrintWorkbook\"\n        Button.Characters.Text = \"Print Workbook\"\n        With Button.Characters(Start:=1, Length:=14).Font\n            .Name = \"Times New Roman\"\n            .FontStyle = \"Bold\"\n            .Size = 10\n        End With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11770899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a4dd2a41f1a8f2357ad2397ba08ff1?s=128&d=identicon&r=PG&f=1", "display_name": "actuarial.codes", "link": "https://stackoverflow.com/users/11770899/actuarial-codes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563982679, "creation_date": 1563982210, "last_edit_date": 1563982603, "question_id": 57186471, "link": "https://stackoverflow.com/questions/57186471/unable-to-set-the-onaction-property-of-the-button-class-error", "title": "unable to set the onAction property of the button class error", "body": "<p>I am trying to assign a function to a button. This seems to work sometimes and sometimes I get the error \"unable to set the onAction property of the button class\" </p>\n\n<pre><code>Windows(\"MyFile.XLS\").Activate\n    Sheets(\"Sheet1\").Select\n    Range(\"G12\").Select\n    ActiveSheet.Buttons.Add(306, 36.6, 94.8, 21).Select\n    Selection.OnAction = \"'SomeFile.xls'!PrintWorkbook.PrintWorkbook\"\n    Selection.Characters.Text = \"Print Workbook\"\n    With Selection.Characters(Start:=1, Length:=14).Font\n        .Name = \"Times New Roman\"\n        .FontStyle = \"Bold\"\n        .Size = 10\n    End With\n</code></pre>\n\n<p>I get the error on this line <code>\"Selection.OnAction = \"'SomeFile.xls'!PrintWorkbook.PrintWorkbook\"\"</code>. Not sure why this only happens sometimes and works other times.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1563982576, "post_id": 57186396, "comment_id": 100883381, "body": "Well, you are looping over more than a million rows, but even then it should not be 40 minutes."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1563982774, "post_id": 57186396, "comment_id": 100883492, "body": "<code>Set SrchRng = Range(&quot;L:L&quot;)</code> to <code>Set SrchRng = Range(&quot;L1:L&quot; &amp; LR)</code> would significantly limit the amount of cells looked at in the loop.  Could go even faster if you take that range as a variant array and loop through it"}, {"owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "edited": false, "score": 0, "creation_date": 1564037806, "post_id": 57186396, "comment_id": 100900548, "body": "Thank you for the above code but still its taking same time"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1563987453, "post_id": 57186656, "comment_id": 100885870, "body": "A loop that runs from <code>1 To 1048576</code> is... not intinite."}, {"owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1564025543, "post_id": 57186656, "comment_id": 100896631, "body": "I said &#39;almost infinite&#39;; it takes a lot of time to finish, I have accidentally done that and sometimes it throws overflow error if you are accumulating the cell values or using a recursive function. In real life, anything that is extremely higher than the required range can be considered infinite for practical purposes."}, {"owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "edited": false, "score": 0, "creation_date": 1564037504, "post_id": 57186656, "comment_id": 100900407, "body": "Thank you for the above code but still its taking same time."}, {"owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "edited": false, "score": 0, "creation_date": 1564039493, "post_id": 57186656, "comment_id": 100901363, "body": "I have tried removing   Application.Calculation = xlCalculationAutomatic its running quicker, its taking long time only for calculation. is there any way to make it fast"}], "tags": [], "owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "is_accepted": false, "score": 2, "last_activity_date": 1563982806, "creation_date": 1563982806, "answer_id": 57186656, "question_id": 57186396, "link": "https://stackoverflow.com/questions/57186396/vba-taking-long-time-while-applying-vlook-up-and-formula/57186656#57186656", "title": "VBA taking long time while applying Vlook up and formula", "body": "<p>Your code here loops through every cell in L:L range, that is almost an infinite loop, as it'll loop through maximum possible number of rows excel can support. Try only using used number of rows to decrese the number of for loop repetition. It'll slow down significantly.</p>\n\n<pre><code>Set SrchRng = Range(\"L1:L\" &amp; Cstr(ActiveSheet.UsedRange.Rows.Count)) ' I Decreased this range\n\nFor Each cel In SrchRng\nIf InStr(1, cel.Value, \"30\") &gt; 0 Then\n    cel.Offset(0, 4).Value = \"Sumitomo\"\nEnd If\nNext cel\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564002429, "post_id": 57186691, "comment_id": 100892125, "body": "All these improvements are correct, but I doubt they are related to the issue. Looping over the 1048576 rows takes less than 2 seconds on a boring office PC."}, {"owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "edited": false, "score": 0, "creation_date": 1564037763, "post_id": 57186691, "comment_id": 100900533, "body": "Thank you for the above code but still its taking same time"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564038293, "post_id": 57186691, "comment_id": 100900761, "body": "There maybe something wrong with the file. Can you share it so that I can have a look ?"}, {"owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "edited": false, "score": 0, "creation_date": 1564039479, "post_id": 57186691, "comment_id": 100901349, "body": "I have tried removing   Application.Calculation = xlCalculationAutomatic its running quicker, its taking long time only for calculation. is there any way to make it fast"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564039628, "post_id": 57186691, "comment_id": 100901430, "body": "But your code already have those lines first to set it as <code>Manual</code> and then in the end to set it as <code>Automatic</code>. So that should not be the case. Does your file have many formulas and links to other files ?"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 3, "last_activity_date": 1563982902, "creation_date": 1563982902, "answer_id": 57186691, "question_id": 57186396, "link": "https://stackoverflow.com/questions/57186396/vba-taking-long-time-while-applying-vlook-up-and-formula/57186691#57186691", "title": "VBA taking long time while applying Vlook up and formula", "body": "<p><strong>Problem:</strong></p>\n\n<ul>\n<li>Use of Select</li>\n<li>Looping over complete Column <code>L:L</code></li>\n</ul>\n\n<p><strong>Note: You are also using the same LR for both sheets.</strong> </p>\n\n<p><strong>Try it now:</strong></p>\n\n<pre><code>Sub Position()\n    Dim LR As Long\n\n    Application.StatusBar = \"Maro is running....\"\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n    LR = Sheets(\"MR\").UsedRange.Rows.Count\n    Sheets(\"MR\").Range(\"A1:C1\").AutoFill Destination:=Sheets(\"MR\").Range(\"A1:C\" &amp; LR)\n\n    Sheets(\"CR\").Range(\"M1:P1\").AutoFill Destination:=Sheets(\"CR\").Range(\"M1:P\" &amp; LR)\n\n    Dim SrchRng As Range, cel As Range\n\n    Set SrchRng = Sheets(\"CR\").Range(\"L1:L\" &amp; Sheets(\"CR\").UsedRange.Rows.Count)\n\n    For Each cel In SrchRng\n        If InStr(1, cel.Value, \"30\") &gt; 0 Then\n            cel.Offset(0, 4).Value = \"Sumitomo\"\n        End If\n    Next cel\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n    Application.StatusBar = False\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 57186691, "answer_count": 2, "score": 0, "last_activity_date": 1563982902, "creation_date": 1563981934, "last_edit_date": 1563982701, "question_id": 57186396, "link": "https://stackoverflow.com/questions/57186396/vba-taking-long-time-while-applying-vlook-up-and-formula", "title": "VBA taking long time while applying Vlook up and formula", "body": "<p>Macro is taking around 30-40 minutes while filling the formulas to all the rows.<br>\nFormulas need to apply around 20,000 rows. All the formulas are available in <code>Range(\"M1:P1\")</code> and <code>Range(\"A1:C1\")</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Position()\n    Dim LR As Long\n\n    Application.StatusBar = \"Maro is running....\"\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n    Sheets(\"MR\").Select\n    LR = ActiveSheet.UsedRange.Rows.Count\n    Range(\"A1:C1\").AutoFill Destination:=Range(\"A1:C\" &amp; LR)\n\n    Sheets(\"CR\").Select\n\n    Range(\"M1:P1\").AutoFill Destination:=Range(\"M1:P\" &amp; LR)\n\n    Dim SrchRng As Range, cel As Range\n\n    Set SrchRng = Range(\"L:L\")\n\n    For Each cel In SrchRng\n        If InStr(1, cel.Value, \"30\") &gt; 0 Then\n            cel.Offset(0, 4).Value = \"Sumitomo\"\n        End If\n    Next cel\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n    Application.StatusBar = False\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Can someone advise why it is taking too much time.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1563983286, "post_id": 57186358, "comment_id": 100883784, "body": "Did you try using chr(130)?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13, "user_id": 11831311, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Igoo7koxG8/AAAAAAAAAAI/AAAAAAAANAc/3nWIUzrbuoc/photo.jpg?sz=128", "display_name": "Douglas Wicker", "link": "https://stackoverflow.com/users/11831311/douglas-wicker"}, "edited": false, "score": 0, "creation_date": 1563987327, "post_id": 57186645, "comment_id": 100885822, "body": "@DouglasWicker it works because when a path includes spaces or special (but legal) characters, it needs to be enclosed in double quotes. To include double quotes in a string literal (itself delimited with double quotes), you must <i>double</i> the double quotes, so <code>foo = &quot;&quot;&quot;&quot;</code> makes <code>foo</code> contain the string value <code>&quot;</code>."}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1563982778, "creation_date": 1563982778, "answer_id": 57186645, "question_id": 57186358, "link": "https://stackoverflow.com/questions/57186358/how-to-use-call-shell-when-there-are-commas-in-a-folder-directory/57186645#57186645", "title": "How to use Call Shell when there are commas in a folder directory?", "body": "<p>I made a folder named <code>Address, Postcode</code> in my Temp Folder and this code worked for me:</p>\n\n<pre><code>Dim FolderDirectory As String\nFolderDirectory = \"C:\\Temp\\Address, Postcode\"\nCall Shell(\"explorer.exe \" &amp; \"\"\"\" &amp; FolderDirectory &amp; \"\"\"\", vbNormalFocus)\n</code></pre>\n\n<p>Hope you can adapt it to your needs</p>\n\n<p>It looks like when there is a comma on it, you need to double quote the path. For this answer, I based on what I read here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3749569/open-folder-which-contains-comma-in-its-path\">Open folder which contains comma in its path</a></p>\n"}], "owner": {"reputation": 13, "user_id": 11831311, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Igoo7koxG8/AAAAAAAAAAI/AAAAAAAANAc/3nWIUzrbuoc/photo.jpg?sz=128", "display_name": "Douglas Wicker", "link": "https://stackoverflow.com/users/11831311/douglas-wicker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 57186645, "answer_count": 1, "score": 1, "last_activity_date": 1563983931, "creation_date": 1563981810, "last_edit_date": 1563983931, "question_id": 57186358, "link": "https://stackoverflow.com/questions/57186358/how-to-use-call-shell-when-there-are-commas-in-a-folder-directory", "title": "How to use Call Shell when there are commas in a folder directory?", "body": "<p>I am trying to use Call Shell to open up windows explorer to a pre-determined directory saved as string.</p>\n\n<p>e.g. <code>FolderDirectory = P:/Address, Postcode</code></p>\n\n<p>Then </p>\n\n<pre><code>Call Shell(\"explorer.exe\" &amp; \" \" * FolderDirectory, vbNormalFocus)\n</code></pre>\n\n<p>It works when there is no comma in the directory but when there is a comma it just opens up the documents directory.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1563982032, "post_id": 57186127, "comment_id": 100883076, "body": "<i>can I use a function to find &quot;V1&quot; and replace with 01?</i> Yes, it&#39;s called <code>Replace</code> <b>but</b> watch out, because if the filename is <code>V10.00</code> it will replace it too! So you need to isolate first the string you want to change. Have you tried starting at the end of the string? Looking at your data example, looks like your filenames always (excluding extension) end with 6 chars, that must be type  <code>Vxx.xx</code> where <code>x</code> is an integer between 0 and 9. Try to get the last 6 chars from each filename and then replace there if needed."}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1563983078, "post_id": 57186127, "comment_id": 100883671, "body": "Thank you for commenting. The convention is SUPPOSED to end uniformly however it seldom is hence why I have been given the task to clean it up. Going forward however it will be cleaned up on a monthly basis but not by me hence trying to automate the function. Also it won&#39;t always be V1 it will always be V and any number from 0-9. I am aware of search/find/replace/substitute however not sure how so say &quot;look for the letter &quot;V&quot; and a number together&quot;..."}, {"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1563986773, "post_id": 57186127, "comment_id": 100885561, "body": "Do you create those filenames yourself, i.e. do you have a chance to modified the format of the naming convention? If so, change the &quot;Vxx.xx&quot; to something clearly identifiable as the start of the version information, e.g. &quot;-Vxx.xx&quot;. That way you can search for &quot;-V&quot; and have a clear indication that that&#39;s where the version numbers start. If that&#39;s not possible, try tackling the string from the end, e.g. strip off the file extension first, then locate the &quot;V&quot; with InStrRev()."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1563987205, "post_id": 57186127, "comment_id": 100885776, "body": "It&#39;s unclear how wrong your file names can get. With the requirement of  <code>namewithoutspacesorspecialcharactersandfirstlettercapitalise&zwnj;&#8203;d</code>, it is easy to ignore the <code>Nov18Accounts</code>, but the fact you have to rename the files to begin with means that you might have the non-lowercase <code>NOV18Accounts</code> which will be replaced to <code>NOV18.00Accounts</code>. In fact, the very example of <code>Nov18Accounts</code> breaks the rules by having additional capitalized letters."}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "reply_to_user": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1563989010, "post_id": 57186127, "comment_id": 100886555, "body": "@HelO&#39;Ween - Thank you for your response. The naming convention is very strict. The tool I am creating, no hyphens allowed other than the 2 in the date. InStrRev() is something I have never heard of or used so will look into that and hopefully that will help solve it!"}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1563989360, "post_id": 57186127, "comment_id": 100886725, "body": "@GSerg - Apologies, perhaps shouldn&#39;t have mentioned the other criteria as date/case sensitivity is something I can handle. It&#39;s just being able to identify the V &amp; [A number] together in a string. If there is a way to code the 5 different variations as cases in VBA code (I am new to VBA but from what I gather this might be a possibility?) e.g. If V&amp;SingleDigit&amp;&quot;.&quot; Then change to V&amp;&quot;0&quot;&amp;SingleDigit&amp;&quot;.&quot; etc. and ignore the 6th in the case of Nov1. Hope I&#39;m making sense and apologies for over-complicating!"}], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1564044574, "post_id": 57189937, "comment_id": 100904225, "body": "Thank you this is brilliant! I should have specified in the question but I did actually want it as a function and that&#39;s what you&#39;ve done. Also, having thought about it, I agree with your suggestion to name as V1.1 to V01.01 so will keep as is!"}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1564044863, "post_id": 57189937, "comment_id": 100904383, "body": "If it&#39;s not too much effort, could a minor amendment be made. There are 2 things I have noticed. 1) If there happens to be a &quot;V#&quot; anywhere in the file name it currently changes it in all areas. I know this is what I asked for but on reflection, is it easy enough to only conduct the search for &quot;V#&quot; on say the last 8 digits before the file extension? 2) Again didn&#39;t mention in the question however there are 2 more variations of &quot;wrong&quot; I would like it to correct - &quot;V.x&quot; and &quot;V.xx&quot;. Is it easy enough to include these? Thank you so much in advance."}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1564054899, "post_id": 57189937, "comment_id": 100909956, "body": "Thank you so much @Gserg. I might be pushing my luck here but final (promise) linked question: once the &quot;Vxx.xx&quot; has been corrected, although it is only searching within the last 8 characters from the file extension can it actually be MOVED so that the &quot;Vxx.xx&quot; will always appear as &quot;Vxx.xx.fileextension&quot;. So &quot;FilenameV01.00sr.ext&quot; becomes &quot;FilenamesrV01.00.ext&quot;? I know this sounds awfully pedantic but with millions of documents on the shared drive, every little bit of automation helps."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1564056122, "post_id": 57189937, "comment_id": 100910569, "body": "@Haris Then you have to guarantee there is an extension (not currently a requirement) and that there is only one V part in the string (currently can be several). If you guarantee that, find the last period position with <code>InStrRev</code>, take out the middle <code>Format() &amp; Format()</code> part, change the trailing <code>Mid$()</code> part to be only up to the period position by providing the third argument, paste the cut out <code>Format() &amp; Format()</code> after that, and add yet another <code>Mid$()</code> with two arguments, just like the original unamended <code>Mid$()</code>, but this time starting at the period position, not at FirstIndex+Length."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 0, "last_activity_date": 1564048798, "last_edit_date": 1564048798, "creation_date": 1563996264, "answer_id": 57189937, "question_id": 57186127, "link": "https://stackoverflow.com/questions/57186127/string-manipulation-how-i-say-to-excel-if-the-letter-v-and-a-number-appear/57189937#57189937", "title": "String Manipulation - How I say to excel &quot;If the letter &quot;v&quot; and a number appear together&quot;?", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Public Function NormalizeVersionNumbers(ByVal s As String) As String\n  NormalizeVersionNumbers = s\n\n  With CreateObject(\"VBScript.RegExp\")  ' New VBScript_RegExp_55.RegExp\n    .IgnoreCase = False\n    .MultiLine = False\n    .Global = True\n    .Pattern = \"V\\.?([0-9]{1,2})(\\.([0-9]{1,2}))?(?=.{0,8}\\.*?$)\"\n\n    With .Execute(s)\n      Dim i As Long\n\n      For i = .Count - 1 To 0 Step -1\n        NormalizeVersionNumbers = Left$(NormalizeVersionNumbers, .Item(i).FirstIndex) &amp; Format$(CLng(.Item(i).SubMatches(0)), \"V00\") &amp; Format$(CLng(.Item(i).SubMatches(2)), \"\\.00\") &amp; Mid$(NormalizeVersionNumbers, .Item(i).FirstIndex + .Item(i).Length + 1)\n      Next\n    End With\n\n  End With\n\nEnd Function\n</code></pre>\n\n<p>It should be noted that it (in my opinion correctly) converts <code>V1.1</code> to <code>V01.01</code> as opposed to <code>V01.10</code>. If that is in fact not desired, do something to that second <code>CLng</code> (such as multiplying it by 10).</p>\n"}, {"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1563997112, "post_id": 57190028, "comment_id": 100890104, "body": "The idea was to <i>&quot;renames the files (if they are incorrect)&quot;</i>, not just report if they are wrong."}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1564043560, "post_id": 57190028, "comment_id": 100903685, "body": "Thank you for your replies people I am working through them. @Malamare just tried your code and that is great for testing whether or not the version number is in the correct format (tested for 60 files and results were correct in every case) however as GSerg has mentioned it does not then go on to correct them which is the required functionality. If this bit could be added it would be great."}, {"owner": {"reputation": 19, "user_id": 11185212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26cd978d061ff7fbd6a9f6b72c3082e?s=128&d=identicon&r=PG&f=1", "display_name": "Malamare", "link": "https://stackoverflow.com/users/11185212/malamare"}, "reply_to_user": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1564054738, "post_id": 57190028, "comment_id": 100909879, "body": "@Haris, have you tried the next answer I sent? I think it corrects the problems using another perspective. In addition, it only searches the last characters of the file name. There are no problems with the &quot;V&quot; in other places in the character string."}, {"owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "edited": false, "score": 0, "creation_date": 1564055237, "post_id": 57190028, "comment_id": 100910130, "body": "@Malamare - Thank you for this I did try and this did also seem to work quite well although didn&#39;t test on a big enough sample given that GSerg&#39;s solution has also worked very well and can use as a function rather than a sub procedure which although not specified, is better suited to my current needs. Very much appreciate your input though and would also tick yours as the answer but can only tick one I&#39;m afraid!"}, {"owner": {"reputation": 19, "user_id": 11185212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26cd978d061ff7fbd6a9f6b72c3082e?s=128&d=identicon&r=PG&f=1", "display_name": "Malamare", "link": "https://stackoverflow.com/users/11185212/malamare"}, "edited": false, "score": 0, "creation_date": 1564130331, "post_id": 57190028, "comment_id": 100937042, "body": "If you have thousands of file names I would not use a function call at a time. It would take a long, long time. Use the code you use put all in a array and review them with the best code in a loop of the array. You can reduce the time by tens or hundreds. Use the function call to check after the user enters the name correctly."}], "tags": [], "owner": {"reputation": 19, "user_id": 11185212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26cd978d061ff7fbd6a9f6b72c3082e?s=128&d=identicon&r=PG&f=1", "display_name": "Malamare", "link": "https://stackoverflow.com/users/11185212/malamare"}, "is_accepted": false, "score": 0, "last_activity_date": 1563996576, "creation_date": 1563996576, "answer_id": 57190028, "question_id": 57186127, "link": "https://stackoverflow.com/questions/57186127/string-manipulation-how-i-say-to-excel-if-the-letter-v-and-a-number-appear/57190028#57190028", "title": "String Manipulation - How I say to excel &quot;If the letter &quot;v&quot; and a number appear together&quot;?", "body": "<p>Use <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/like-operator\" rel=\"nofollow noreferrer\">Like operator</a>. In the column \"A\" of \"Sheet1\" write this 7 rows</p>\n\n<ol>\n<li>V01.00 </li>\n<li>V10</li>\n<li>V1.1</li>\n<li>V10.10</li>\n<li>V01.10</li>\n<li>2019-07-24StackoverflowquestionV01.00.doc</li>\n<li>2019-07-24StackoverflowquestionV1.00.doc</li>\n</ol>\n\n<p>Then add this code to Module1:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    Dim LRow As Long\n    LRow = LastRow(Sheets(\"Sheet1\"), 1)\n    Dim LookArray As Variant\n    LookArray = Sheets(\"Sheet1\").Range(\"A1:A\" &amp; LRow)\n    Dim Item As Long\n    For Item = 1 To UBound(LookArray)\n        If Not LookArray(Item, 1) Like \"*V##.##*\" Then\n            Debug.Print (\"BAD\")\n        Else\n            Debug.Print (\"OK\")\n        End If\n    Next Item\nEnd Sub\n\nPublic Function LastRow(ByRef wsSheet_I As Worksheet, ByVal lColumn_I _\n  As Long) As Long\n    Dim LRow As Range\n    Set LRow = wsSheet_I.Columns(lColumn_I).Find(What:=\"*\", _\n                 LookIn:=xlFormulas, lookat:= _\n                 xlPart, SearchOrder:=xlByRows, _\n                 SearchDirection:=xlPrevious, MatchCase:=False)\n    If Not LRow Is Nothing Then\n        LastRow = LRow.Row\n    Else\n        LastRow = 0\n    End If\nEnd Function\n</code></pre>\n\n<p>Then press Ctrl+G and you will see in Debugg window:</p>\n\n<p>OK</p>\n\n<p>BAD</p>\n\n<p>BAD</p>\n\n<p>OK</p>\n\n<p>OK</p>\n\n<p>OK</p>\n\n<p>BAD</p>\n\n<p>LastRow function returns the last row of a column even if there are empty rows. I prefer to use it instead of other codes like <code>End(xlUp).Row</code> <code>Range.Rows.Count</code> etc.</p>\n\n<p>I use a loop with a range array because it is faster than a range loop</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 11185212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26cd978d061ff7fbd6a9f6b72c3082e?s=128&d=identicon&r=PG&f=1", "display_name": "Malamare", "link": "https://stackoverflow.com/users/11185212/malamare"}, "is_accepted": false, "score": 0, "last_activity_date": 1564005190, "creation_date": 1564005190, "answer_id": 57191730, "question_id": 57186127, "link": "https://stackoverflow.com/questions/57186127/string-manipulation-how-i-say-to-excel-if-the-letter-v-and-a-number-appear/57191730#57191730", "title": "String Manipulation - How I say to excel &quot;If the letter &quot;v&quot; and a number appear together&quot;?", "body": "<p>OK, as GSerg suggests this is the code to rename the files. Only looks for patterns at the end of the file name, after the \"V\" before the extension. Keep in mind that there may be similar patterns along the file name and those must be discarded.</p>\n\n<p>Copy this 6 rows at Sheet1 column A:</p>\n\n<ol>\n<li>2019-07-24StackoverflowquestionV1.doc</li>\n<li>2019-07-24StackoverflowquestionV10.doc</li>\n<li>2019-07-24StackoverflowquestionV1.1.doc</li>\n<li>2019-07-24StackoverflowquestionV10.1.doc</li>\n<li>2019-07-24StackoverflowquestionV1.10.doc</li>\n<li>2019-07-24StackoverflowquestionV01.00.doc</li>\n</ol>\n\n<p>And paste this code in a Module1:</p>\n\n<pre><code>Option Explicit\n\nSub prueba()\n    Dim LRow As Long\n    LRow = LastRow(Sheets(\"Sheet1\"), 1)\n    Dim LookArray As Variant\n    LookArray = Sheets(\"Sheet1\").Range(\"A1:A\" &amp; LRow)\n    Dim Item As Long\n    Dim VersAndExt As String\n    Dim Version As String\n    Dim Extension As String\n    Dim VersionOK As String\n    For Item = 1 To UBound(LookArray)\n        VersAndExt = Right$(LookArray(Item, 1), Len(LookArray(Item, 1)) _\n          - InStrRev(LookArray(Item, 1), \"V\"))\n        Version = Left$(VersAndExt, InStrRev(VersAndExt, \".\") - 1)\n        Extension = Right$(VersAndExt, Len(VersAndExt) _\n          - InStrRev(VersAndExt, \".\") + 1)\n        Select Case Len(Version)\n        Case 1 'V1 error\n            VersionOK = \"V\" &amp; \"0\" &amp; Version &amp; \".00\"\n        Case 2 'V10 error\n            VersionOK = \"V\" &amp; Version &amp; \".00\"\n        Case 3 'V1.1\n            VersionOK = \"V\" &amp; \"0\" &amp; Version &amp; \"0\"\n        Case 4\n            If InStr(Version, \".\") = 3 Then\n                'V10.1\n                VersionOK = \"V\" &amp; Version &amp; \"0\"\n            Else\n                'V1.10\n                VersionOK = \"V\" &amp; \"0\" &amp; Version\n            End If\n        Case 5 'OK version\n            VersionOK = \"V\" &amp; Version\n        End Select\n        LookArray(Item, 1) = Replace(LookArray(Item, 1), \"V\" &amp; _\n          VersAndExt, VersionOK &amp; Extension)\n    Next Item\n    Sheets(\"Sheet1\").Range(\"D1:D\" &amp; LRow) = LookArray\nEnd Sub\n\nPublic Function LastRow(ByRef wsSheet_I As Worksheet, ByVal lColumn_I _\n  As Long) As Long\n    Dim LRow As Range\n    Set LRow = wsSheet_I.Columns(lColumn_I).Find(What:=\"*\", _\n                 LookIn:=xlFormulas, lookat:= _\n                 xlPart, SearchOrder:=xlByRows, _\n                 SearchDirection:=xlPrevious, MatchCase:=False)\n    If Not LRow Is Nothing Then\n        LastRow = LRow.Row\n    Else\n        LastRow = 0\n    End If\nEnd Function\n</code></pre>\n\n<p>You will see in Sheet1 column D this names</p>\n\n<ol>\n<li>2019-07-24StackoverflowquestionV01.00.doc</li>\n<li>2019-07-24StackoverflowquestionV10.00.doc</li>\n<li>2019-07-24StackoverflowquestionV01.10.doc</li>\n<li>2019-07-24StackoverflowquestionV10.10.doc</li>\n<li>2019-07-24StackoverflowquestionV01.10.doc</li>\n<li>2019-07-24StackoverflowquestionV01.00.doc</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1564056764, "creation_date": 1564056764, "answer_id": 57201711, "question_id": 57186127, "link": "https://stackoverflow.com/questions/57186127/string-manipulation-how-i-say-to-excel-if-the-letter-v-and-a-number-appear/57201711#57201711", "title": "String Manipulation - How I say to excel &quot;If the letter &quot;v&quot; and a number appear together&quot;?", "body": "<p>This approach is more basic and easier to understand then the advanced code from @GSerg: It uses <code>InStrRev</code> to identify the first \"V\" from the right(bypasses Nov issue), checks if there is a pattern match for the five possible incorrect user inputs, and if found will copy the cells value to the cell on the right, then using <code>Application.Replace</code> inserts new characters as needed. Comments are provided in the code.  </p>\n\n<pre><code>Sub FixFileName()\nDim charPos As Integer, cel As Range\n\n    For Each cel In Range(\"C6:C12\") 'Loop thru each cell in the range\n        charPos = InStrRev(cel.Value, \"V\") 'Use InStrRev to find the first \"V\" from the right\n\n        'Each if statement will check the characters to the right starting at charPos for a pattern match,\n        'if the cell matches then, the cell value will be copied to the cell to the right\n        'The replace function will select the copied cell and then move to the charater where\n        'you want to insert additional characters in\n        'The first 0 after charPos, inserts characters, not replace any.\n        'Note: If you wanted to replace the character you would use a 1, or a 2 to replce 2 characters\n        'Additional Note: this code will skip all other values in the range that don't match.\n        'If you identify other incorrect user inputs, you can easily add another ElseIf as needed\n\n        If Mid(cel.Value, charPos, 6) Like \"V#.#0.\" Then\n            With cel.Offset(, 1)\n                .Value = cel.Value\n                .Value = Application.Replace(cel.Offset(, 1), charPos + 1, 0, \"0\")\n            End With\n\n        ElseIf Mid(cel.Value, charPos, 6) Like \"V#0.#.\" Then\n            With cel.Offset(, 1)\n                .Value = cel.Value\n                .Value = Application.Replace(cel.Offset(, 1), charPos + 5, 0, \"0\")\n            End With\n\n        ElseIf Mid(cel.Value, charPos, 5) Like \"V#.#.\" Then\n            With cel.Offset(, 1)\n                .Value = cel.Value\n                .Value = Application.Replace(cel.Offset(, 1), charPos + 4, 0, \"0\")\n                .Value = Application.Replace(cel.Offset(, 1), charPos + 1, 0, \"0\")\n            End With\n\n        ElseIf Mid(cel.Value, charPos, 4) Like \"V#0.\" Then\n            With cel.Offset(, 1)\n                .Value = cel.Value\n                .Value = Application.Replace(cel.Offset(, 1), charPos + 4, 0, \"00.\")\n             End With\n\n        ElseIf Mid(cel.Value, charPos, 3) Like \"V#.\" Then\n            With cel.Offset(, 1)\n                .Value = cel.Value\n                .Value = Application.Replace(cel.Offset(, 1), charPos + 3, 0, \"00.\")\n                .Value = Application.Replace(cel.Offset(, 1), charPos + 1, 0, \"0\")\n            End With\n\n        End If\n\n    Next cel\n\nEnd Sub  \n</code></pre>\n"}], "owner": {"reputation": 38, "user_id": 11797065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--yW8F9ElMyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revNsbSOdC2ZCV_EgpeHTFzgB3GSg/photo.jpg?sz=128", "display_name": "Haris", "link": "https://stackoverflow.com/users/11797065/haris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 57189937, "answer_count": 4, "score": 0, "last_activity_date": 1564056764, "creation_date": 1563981079, "last_edit_date": 1563986857, "question_id": 57186127, "link": "https://stackoverflow.com/questions/57186127/string-manipulation-how-i-say-to-excel-if-the-letter-v-and-a-number-appear", "title": "String Manipulation - How I say to excel &quot;If the letter &quot;v&quot; and a number appear together&quot;?", "body": "<p>[Scroll down to the end for the very short version!]</p>\n\n<p>Just to let you know this is my second time I have ever posted on a website forum and also I am brand new to coding but am definitely pick it (albeit extremely slowly!) and really enjoying it.</p>\n\n<p>Background to the problem:</p>\n\n<p>In my organisation there is a requirement to save files in accordance with a particular naming convention, which is as follows:</p>\n\n<pre><code>YYYY-MM-DDFilenamewithoutspacesorspecialcharactersandfirstlettercapitalisedVxx.xx.fileextension\n</code></pre>\n\n<p>Where <code>Vxx.xx</code> represents the version number which MUST be written using 2 digits before the decimal and 2 digits after.</p>\n\n<p>E.g. <code>2019-07-24StackoverflowquestionV01.00.doc</code>.</p>\n\n<p>I have created a macro that loops through all files and folders, returns the current names and renames the files (if they are incorrect) based on user populated alternatives (written in a \"New Name\" column next to the \"Original Name\" column).</p>\n\n<p>The task at hand:</p>\n\n<p>I am trying to automate the population of the \"New Name\" column as much as possible but am stuck on correcting the version number.</p>\n\n<p>I have found that there are essentially 5 different ways to get the version number wrong and have summarised these below along with how they would be correct:</p>\n\n<ul>\n<li>V1 - Should be changed to \"V01.00\"</li>\n<li>V10 - Should be changed to \"V10.00\"</li>\n<li>V1.1 - Should be changed to \"V01.10\"</li>\n<li>V10.1 - Should be changed to \"V10.10\"</li>\n<li>V1.10 - Should be changed to \"V01.10\"</li>\n</ul>\n\n<p>The key find I want from the formula is to be able to identify <code>\"V\" &amp; Number</code> within a text string and where it is found, to amend in accordance with the above.</p>\n\n<p>I also want it to ignore instances of \"Nov1\" as these appear many times e.g. \"Nov18Accounts\" etc.</p>\n\n<p>I am not entirely sure if this can be done on Excel itself or whether the VBE is required hence tagged both of them in the post.</p>\n\n<p>Hope this makes sense.</p>\n\n<p>Thank you.</p>\n\n<hr>\n\n<p>Short Version:</p>\n\n<p>Is it possible to identify <code>\"V\" &amp; Number</code> within a text string to return instances of when they appear together?<br>\nE.g. for \"StackoverflowquestionV1.00.doc\" in an Excel cell, can I use a function to find \"V1\" and replace with 01? The \"V\" will always be the same but the numbers will change.</p>\n\n<p>Thank you in advance for your help.</p>\n"}, {"tags": ["vba", "ms-access", "custom-error-handling"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1563996484, "post_id": 57186085, "comment_id": 100889828, "body": "If you want to add items &#39;on the fly&#39; during data entry, use combobox NotInList event. Common topic and many examples."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1563996622, "post_id": 57186085, "comment_id": 100889886, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49326791/ms-access-combobox-not-taking-a-value-after-requery-shows-value\">MS Access Combobox not taking a value after requery shows value</a>"}, {"owner": {"reputation": 1, "user_id": 11724925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156415490184033/picture?type=large", "display_name": "Kerry Merchant", "link": "https://stackoverflow.com/users/11724925/kerry-merchant"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1563997112, "post_id": 57186085, "comment_id": 100890105, "body": "To clarify, we are using a barcode scanner for entry of data into the control."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1563997214, "post_id": 57186085, "comment_id": 100890139, "body": "Should still be able to use a combobox and NotInList event. If the entered (scanned or typed) value is not item in combobox list, NotInList should trigger. Combobox LimitToList property must be set to Yes."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11724925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156415490184033/picture?type=large", "display_name": "Kerry Merchant", "link": "https://stackoverflow.com/users/11724925/kerry-merchant"}, "edited": false, "score": 0, "creation_date": 1564000530, "post_id": 57190741, "comment_id": 100891450, "body": "I gave this a try and it was no successful. If by &quot;uncommitted&quot; you mean that no ID has been assigned to the row that is untrue as an ID appears in my ID field when I tab to the next field. Also, even after entering the asset and running a requery, I get an error that the database &quot;cannot find a record in table assets with key matching fields assetID. Shouldn&#39;t the requery update the subform?"}, {"owner": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "reply_to_user": {"reputation": 1, "user_id": 11724925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156415490184033/picture?type=large", "display_name": "Kerry Merchant", "link": "https://stackoverflow.com/users/11724925/kerry-merchant"}, "edited": false, "score": 0, "creation_date": 1564061921, "post_id": 57190741, "comment_id": 100914044, "body": "Is your ID an Access AutoNumber? If it is, that shouldn&#39;t matter. In my tests on this with manually inserting a row in a subform, the AutoNumber value will show the next available number, but the row is still not committed to the table yet. Pressing the ESC key (manual equivalent of <code>DoCmd.RunCommand acCmdUndo</code>) rolls back the row and &quot;loses&quot; the AutoNumber value."}], "tags": [], "owner": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "is_accepted": false, "score": 0, "last_activity_date": 1563999947, "creation_date": 1563999947, "answer_id": 57190741, "question_id": 57186085, "link": "https://stackoverflow.com/questions/57186085/use-msgbox-to-open-form-to-new-record-or-delete-record-from-continuous-form-if-t/57190741#57190741", "title": "Use MsgBox to open form to new record or delete record from continuous form if the record does not already exist", "body": "<p>Try <code>DoCmd.RunCommand acCmdUndo</code> rather than <code>DoCmd.SetProperty(...)</code></p>\n\n<p>The form is sitting on an uncommitted, new record that can't be committed. To roll it back, use Undo.</p>\n"}], "owner": {"reputation": 1, "user_id": 11724925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156415490184033/picture?type=large", "display_name": "Kerry Merchant", "link": "https://stackoverflow.com/users/11724925/kerry-merchant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594635475, "creation_date": 1563980964, "last_edit_date": 1594635475, "question_id": 57186085, "link": "https://stackoverflow.com/questions/57186085/use-msgbox-to-open-form-to-new-record-or-delete-record-from-continuous-form-if-t", "title": "Use MsgBox to open form to new record or delete record from continuous form if the record does not already exist", "body": "<p>I have a form with a continuous subform that is used to \"check out\" items. If an item is entered that is not currently in the <code>items</code> table, an error fires. </p>\n\n<p>I would like to create a custom <code>msgbox</code> that will allow the user to select the next action; either open a form to enter the new item (along with a number of details about the item) or to delete the row. </p>\n\n<p>I have been able to fire the <code>msgbox</code> code and successfully open the form to enter a new item, but I cannot get the row to delete from the subform OR use <code>SetProperty</code> to return the value to <code>null</code>.</p>\n\n<p>Here is the current code to launch the <code>MsgBox</code> which is triggered BeforeUpdate, OnError from the control in question.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function MsgBox_NewAsset()\n\n    MsgBoxResult = MsgBox(\"The Asset Number you entered is not in the system. Would you like to enter this as a new asset?\", 4 + vbQuestion, \"New Asset?\")\n\n    If MsgBoxResult = 6 Then\n    DoCmd.SetWarnings False\n    DoCmd.OpenForm \"Asset Details\", , , \"AssetID=0\"\n    DoCmd.SetWarnings True\n\n    Else\n    DoCmd.SetProperty(\"AssetID\",acPropertyValue,\"\")\n    End If\n\nEnd Function\n</code></pre>\n\n<p>When setting the <code>SetProperty</code> command using:</p>\n\n<pre><code>DoCmd.SetProperty(\"AssetID\",acPropertyValue,\"\")\n</code></pre>\n\n<p>I get a compile error:</p>\n\n<blockquote>\n  <p>Expected: =</p>\n</blockquote>\n\n<p>I'm relatively new to VBA, so not entirely sure what this indicates.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563981602, "post_id": 57186003, "comment_id": 100882828, "body": "Did you try setting the number format on the cell?  You can record a macro while doing that - it should give you what you need."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1563983987, "post_id": 57186003, "comment_id": 100884130, "body": "You could either have it insert a string or specify <code>cells().numberformat = &quot;0000&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1563992015, "creation_date": 1563992015, "answer_id": 57188966, "question_id": 57186003, "link": "https://stackoverflow.com/questions/57186003/how-to-keep-a-number-format-after-ive-converted-multiple-strings-to-a-hyperlink/57188966#57188966", "title": "How to keep a number format after I&#39;ve converted multiple strings to a hyperlink", "body": "<p>Prefixing cell content with <code>'</code> will make Excel treat it as text, so you can do this:</p>\n\n<pre><code>TextToDisplay:= \"'\" &amp; Format(PictureNum, \"0000\")\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11671638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38ad9425d4b9ec2ad0e3195498d29ee?s=128&d=identicon&r=PG&f=1", "display_name": "This_is_not_a_test", "link": "https://stackoverflow.com/users/11671638/this-is-not-a-test"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 57188966, "answer_count": 1, "score": 0, "last_activity_date": 1563992015, "creation_date": 1563980723, "question_id": 57186003, "link": "https://stackoverflow.com/questions/57186003/how-to-keep-a-number-format-after-ive-converted-multiple-strings-to-a-hyperlink", "title": "How to keep a number format after I&#39;ve converted multiple strings to a hyperlink", "body": "<p>I want to write a hyperlink to a cell yet format it \"0000\". The code I have come up with so far is as the below.</p>\n\n<pre><code>Dim PictureNum As String\nDim FolderLoc As String\n\nPictureNum = Format(inputwks.Range(\"picturenumcell\").Value, \"0000\")\nFolderLoc = inputwks.Range(\"imagefolderpath\").Value\n\nwith recordwks\n.Hyperlinks.Add anchor:=.Cells(nextRow, PictureCol2), Address:=(FolderLoc &amp; \"\\\" &amp; PictureNum &amp; \".png\"), TextToDisplay:=Format(PictureNum, \"0000\")\nEnd with\n</code></pre>\n\n<p>The .Cells(nextRow, PictureCol2) in the hyperlinks line puts the picture number as a hyperlink into a specific cell in the recordwks worksheet.</p>\n\n<p>For example, if it's picture number 0002.png, the resulting hyperlink text to display ends up just putting it as \"2\" rather than \"0002\"</p>\n\n<p>How do I modify it to make it say \"0002\"?</p>\n\n<p>Many thanks for any help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1563983689, "post_id": 57186816, "comment_id": 100883990, "body": "Hi Mikku - thanks for your help  I&#39;ve put in your code exactly and despite it containing the match upon execution, it still prompts the MsgBox error (it executes everything else as it should, but the prompt appears when it shouldn&#39;t)"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1563983806, "post_id": 57186816, "comment_id": 100884044, "body": "Hi, I have changed the code a Bit. Can you try again. Also, are you sure there are results in the Autofilter ? @Sam"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1563984915, "post_id": 57186816, "comment_id": 100884604, "body": "I\u2019ll be back at my computer in about an hour to check, but regarding your question around if there are results: it does actually show the right results, it\u2019s just it also shows the MsgBox even though it has results"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1563985119, "post_id": 57186816, "comment_id": 100884711, "body": "No worries, just try and let me know. It should work though now."}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1563997649, "post_id": 57186816, "comment_id": 100890312, "body": "Took a little longer until I was able to test it. So when I run your code, if it finds a match it works normally now. If it doesn&#39;t find a match it shows the MsgBox but then it prompts with a Run-time error 6 Overflow - which highlight this line of code <code>If CurrentRow + 1 &gt; FilteredData.Cells.Count Then</code>  but I added a Exit Sub in there and it seemed to resolve the issue, so all is good now."}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1563997713, "post_id": 57186816, "comment_id": 100890336, "body": "One thing I wanted to ask, I&#39;m having this weird issue, I was thinking of posting it here on StackOverflow. The first time I execute this filter it returns the values of the header rather than the data below it. Every other time it executes only the data, without issue. But if I quit Excel and opened it again and executed it, it would show the headers. Any idea how I can avoid this? Thanks for your help by the way!"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564015824, "post_id": 57186816, "comment_id": 100895056, "body": "Probably you should ask another question for that. Including Screeshot of what you are getting. I can suggest that you run your Code using <code>F8</code> and check at every step what is happening. That resolves many issues."}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564056213, "post_id": 57186816, "comment_id": 100910616, "body": "I was trying to think of a workaround. Could there be a line of code that says &quot;if the returned result is [header string] then go to next result&quot; (obviously [header string] is the actual text of the header)"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 1, "creation_date": 1564066092, "post_id": 57186816, "comment_id": 100916586, "body": "Fixed it, thought I&#39;d leave this here in case anyone has a similar issue. <code>Dim header As String</code>, <code>header = &quot;insert header title string&quot;</code>, then inside the if statement where it places the filtered results into the textbook, I also put <code>If ActiveSheet.Shapes(TextboxName).DrawingObject.Text = header Then</code> and then I had it repeat the same sub <code>Call GetNextResult</code>"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564656316, "post_id": 57186816, "comment_id": 101106943, "body": "Mikku, I&#39;m now trying to change the Criteria to look for a a value ending in a variable. So if the last 4 digits of any row in column C matches the 4 digits entered in Textbox10 then it returns the filtered results - do you know if this can be done? Thanks"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564656477, "post_id": 57186816, "comment_id": 101107027, "body": "Hi Sam, please as a new question.@Sam"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564656957, "post_id": 57186816, "comment_id": 101107290, "body": "just posted it @Mikku - <a href=\"https://stackoverflow.com/questions/57307428/excel-vba-advanced-filter-criteria-set-to-any-cell-containing-last-4-digits-en\" title=\"excel vba advanced filter criteria set to any cell containing last 4 digits en\">stackoverflow.com/questions/57307428/&hellip;</a>"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1563983777, "last_edit_date": 1563983777, "creation_date": 1563983306, "answer_id": 57186816, "question_id": 57186001, "link": "https://stackoverflow.com/questions/57186001/excel-vba-advanced-filter-how-to-display-a-msgbox-when-no-match-found/57186816#57186816", "title": "Excel VBA: Advanced Filter, how to display a MsgBox when no match found", "body": "<p><strong>Simple condition like this will work:</strong></p>\n\n<pre><code>If Not DataRange.Columns(1).Rows.SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n\n    MsgBox \"No Results\"\n\nEnd If\n</code></pre>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Public Sub FilterData()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).row\n\n\n    Dim CriteriaRange As Range\n    Set CriteriaRange = ws.Range(\"J2\", \"L3\")\n\n    Dim DataRange As Range\n    Set DataRange = ws.Range(\"A5\", \"I\" &amp; LastRow)\n\n    DataRange.AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=CriteriaRange, Unique:=False\n\n    If Not DataRange.Columns(1).Rows.SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n\n        MsgBox \"No Results\"\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 57186816, "answer_count": 1, "score": 0, "last_activity_date": 1563983777, "creation_date": 1563980721, "last_edit_date": 1563982892, "question_id": 57186001, "link": "https://stackoverflow.com/questions/57186001/excel-vba-advanced-filter-how-to-display-a-msgbox-when-no-match-found", "title": "Excel VBA: Advanced Filter, how to display a MsgBox when no match found", "body": "<p>I have a question around Advanced Filters. I'm trying to figure out how to have a MsgBox Error message when the filter doesn't find a match. </p>\n\n<p>I've put a comment within the first Sub (FilterData) where I thought the error message should go</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Public Sub FilterData()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n\n    Dim CriteriaRange As Range\n    Set CriteriaRange = ws.Range(\"J2\", \"L3\")\n\n    Dim DataRange As Range\n    Set DataRange = ws.Range(\"A5\", \"I\" &amp; LastRow)\n\n'This is where I thought I needed the OnError, but it shows the error message on every execution regardless of whether a match is found or not\n\nOn Error GoTo NoQuickFound\n    DataRange.AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=CriteriaRange, Unique:=False\n\nNoQuickFound:\nMsgBox \"No match\"\n\nEnd Sub\n</code></pre>\n\n<pre><code>Public Sub ShowAll()\n    On Error Resume Next\n    ActiveSheet.ShowAllData\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<pre><code>Public Sub GetNextResult()\n    FilterData\n\n\n\n\n\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim DataRange As Range\n    Set DataRange = ws.Range(\"A5\", \"I\" &amp; LastRow) \n\n    Dim FilteredData As Range\n    Set FilteredData = DataRange.Resize(ColumnSize:=1).SpecialCells(xlCellTypeVisible)\n\n    If CurrentRow + 1 &gt; FilteredData.Cells.Count Then\n        CurrentRow = 1\n    End If\n\n    CurrentRow = CurrentRow + 1\n    Dim i As Long\n    Dim Cell As Variant\n    For Each Cell In FilteredData\n        i = i + 1\n        If i = CurrentRow Then\n            Call ShowAll\n\n            TextboxName = \"Box1\"\n            ActiveSheet.Shapes(TextboxName).DrawingObject.Text = Cell.Offset(0, 2)\n\n            TextboxName2 = \"Box2\"\n            ActiveSheet.Shapes(TextboxName2).DrawingObject.Text = Cell.Offset(0, 3)\n\n\n            Call quick_artwork\n        End If\n    Next Cell\n</code></pre>\n\n<p>It is made up of 3 subs:</p>\n\n<p>FilterData = Actually does the filtering of the results, this is where I expect I need to put the error message if it doesn't find a match</p>\n\n<p>ShowAll = This resets the filtered results so it shows everything</p>\n\n<p>GetNextResult = My spreadsheet doesn't actually show the filtered results, it replaces 2 text boxes with the values from the filter result and changes on every execution</p>\n\n<p>Any ideas? Thanks!</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563981691, "post_id": 57185962, "comment_id": 100882884, "body": "How large are the tables?"}, {"owner": {"reputation": 33, "user_id": 10518717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e11da092d3693904529ec4c7b4a91ae?s=128&d=identicon&r=PG&f=1", "display_name": "Slava S.", "link": "https://stackoverflow.com/users/10518717/slava-s"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1563983953, "post_id": 57185962, "comment_id": 100884114, "body": "@TimWilliams Around 20,000 records in PHOTOS and PHOTOS_CURRENT, around 2,000 in INSCRIPTIONS"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1563984824, "post_id": 57185962, "comment_id": 100884557, "body": "Please provide a fuller code block not line snippets so we can see whole process. Otherwise, remember <a href=\"https://www.google.com/search?q=excel+is+not+a+database\" rel=\"nofollow noreferrer\">excel is not a database</a>, so use an actual one like its sibling <code>ms access</code>, that can index on fields for faster table scans!"}, {"owner": {"reputation": 33, "user_id": 10518717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e11da092d3693904529ec4c7b4a91ae?s=128&d=identicon&r=PG&f=1", "display_name": "Slava S.", "link": "https://stackoverflow.com/users/10518717/slava-s"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1563985430, "post_id": 57185962, "comment_id": 100884872, "body": "@Parfait there is no much sense to add anything else to what I already provided. If any records found by the query they are inserted into the output array and sent back to the calling routine. I know Excel is not a real database, I work in the constraints that the company imposes on me. This Excel has about 20 worksheets and is used as a database, take it or leave it. I did my proposal for improvement to the company, but while they make a correct decision I have to make this piece of code work."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1563985572, "post_id": 57185962, "comment_id": 100884950, "body": "Understood re the database, but can we see if you are running ADO or DAO, OLEDB provider or ODBC driver? Looping through a recordset or exporting with <code>CopyFromRecordset</code>?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1563985965, "post_id": 57185962, "comment_id": 100885121, "body": "Please edit your post with code lines not in hard-to-read comments. It would help to see how <code>objConnection</code> is assigned. Please note the Stackoverflow rules of <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 33, "user_id": 10518717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e11da092d3693904529ec4c7b4a91ae?s=128&d=identicon&r=PG&f=1", "display_name": "Slava S.", "link": "https://stackoverflow.com/users/10518717/slava-s"}, "edited": false, "score": 0, "creation_date": 1563986008, "post_id": 57185962, "comment_id": 100885142, "body": "I will loop through the recordset to fill in the output array. That is definitely not the problem. Right now I have the PHOTOS and PHOTOS_CURRENT table that have exactly same information. The performance issue lies in the query."}, {"owner": {"reputation": 33, "user_id": 10518717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e11da092d3693904529ec4c7b4a91ae?s=128&d=identicon&r=PG&f=1", "display_name": "Slava S.", "link": "https://stackoverflow.com/users/10518717/slava-s"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1563986684, "post_id": 57185962, "comment_id": 100885504, "body": "@Parfait I edited the post."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1563989705, "post_id": 57185962, "comment_id": 100886884, "body": "If you&#39;re running this in a loop it seems like you could create a table out of your <code>NOT EXISTS</code> query and join on it instead of repeating that query for every agent."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10518717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e11da092d3693904529ec4c7b4a91ae?s=128&d=identicon&r=PG&f=1", "display_name": "Slava S.", "link": "https://stackoverflow.com/users/10518717/slava-s"}, "edited": false, "score": 0, "creation_date": 1564147021, "post_id": 57189400, "comment_id": 100946011, "body": "Thank you @Parfait. Your suggestion would help if I had power to change the whole system. Unfortunately, as I said, I am bound to the existing Connect-Select-Disconnect approach which is used by hundreds of queries in this Excel database. The full regression testing is out of question. I&#39;d rather wait for them to approve the move to a real DB and make it work there."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 33, "user_id": 10518717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e11da092d3693904529ec4c7b4a91ae?s=128&d=identicon&r=PG&f=1", "display_name": "Slava S.", "link": "https://stackoverflow.com/users/10518717/slava-s"}, "edited": false, "score": 0, "creation_date": 1564155086, "post_id": 57189400, "comment_id": 100950624, "body": "I do not undestand your comment. All of these solutions can be handled in Excel."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1563993884, "creation_date": 1563993884, "answer_id": 57189400, "question_id": 57185962, "link": "https://stackoverflow.com/questions/57185962/improve-sql-query-in-excel-vba/57189400#57189400", "title": "Improve SQL query in Excel VBA", "body": "<p>Consider the following tips that may help:</p>\n\n<ul>\n<li><p><strong>Explicit JOIN</strong>: Right now you are running the outdated implicit join with a match of IDs in the <code>WHERE</code> clause and not the current standard of the explicit <code>JOIN</code> clause. In most database engines, this should not change performance but anecdotal evidence suggests on specific use cases it can:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT DISTINCT INSCR.MLS_ID \nFROM [INSCRIPTIONS_CURRENT$] INSCR\nINNER JOIN [PHOTOS$] P1 ON INSCR.MLS_ID = P1.MLS_ID \nWHERE INSCR.AGENT_ID = \" &amp; inpAgentId &amp; _\n  AND NOT EXISTS (select 1 from [PHOTOS_CURRENT$] PC1  \n                  where PC1.MLS_ID = P1.MLS_ID and PC1.PHOTO_ID = P1.PHOTO_ID)\n</code></pre></li>\n<li><p><strong>GROUP BY vs DISTINCT</strong>: This is a regular debate in SQL where different database engines process the non-duplicates queries differently. In theory, there should be no difference in performance but anecdotal evidence suggest otherwise. Therefore, consider an equivalent <code>GROUP BY</code> version:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT INSCR.MLS_ID \nFROM [INSCRIPTIONS_CURRENT$] INSCR\nINNER JOIN [PHOTOS$] P1 ON INSCR.MLS_ID = P1.MLS_ID \nWHERE INSCR.AGENT_ID = \" &amp; inpAgentId &amp; _\n  AND NOT EXISTS (select 1 from [PHOTOS_CURRENT$] PC1  \n                  where PC1.MLS_ID = P1.MLS_ID and PC1.PHOTO_ID = P1.PHOTO_ID)\nGROUP BY INSCR.MLS_ID \n</code></pre></li>\n<li><p><strong>DAO Connection</strong>: Since querying workbooks utilizes the JET/ACE SQL Engine, consider DAO as a specific interface that can exploit many advantages of this engine and not ADO a more generalized interface across any data source (Oracle, SQL Server, Postgres, etc.).</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' ADD REFERENCE: Microsoft Office #.# Access Database Engine Object Library\nDim conn As New DAO.DBEngine, db As DAO.Database, qdef As DAO.QueryDef, rst As DAO.Recordset\n\nSet db = conn.OpenDatabase(\"C:\\Path\\To\\Workbook.xls\", False, True, \"Excel 8.0;HDR=Yes;\")\nSet rst = db.OpenRecordset(sqlQuery)\n\n...    \n\nrst.Close: db.Close\nSet rst = Nothing: Set db = Nothing: Set conn = Nothing\n</code></pre></li>\n<li><p><strong>OLEDB (ACE) Connection</strong>: Consider the newer OLEDB provider which should still work with any version of Excel (.xls or .xlsx, .xlsb, .xlsm). Check available providers with this <a href=\"https://stackoverflow.com/a/57167973/1422451\">PowerShell script</a>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>objConnection.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" ...\n\nobjConnection.Open \"Provider=Microsoft.ACE.OLEDB.16.0;\" ...\n</code></pre></li>\n<li><p><strong>ODBC Connection</strong>: Connecting interfaces can pose different performance of query execution where anecdotal evidence differs from theory. Therefore, consider replacing the OLEDB provider for ODBC driver connection:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' DRIVER VERSION\nobjConnection.Open \"DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" _\n                       &amp; \"DBQ=C:\\Path\\To\\Excel.xls;\"\n\n' DSN VERSION\nobjConnection.Open \"DSN=Excel Files;DBQ=C:\\Path\\To\\Excel.xls;\"\n</code></pre></li>\n<li><p><strong>Cursor/Lock Types</strong>: Experiment with the <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/cursortypeenum?view=sql-server-2017\" rel=\"nofollow noreferrer\">cursor types</a> as performance can vary such as <code>adOpenForwardOnly</code>vs <code>adOpenStatic</code> and even <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/locktypeenum?view=sql-server-2017\" rel=\"nofollow noreferrer\">LockType</a> with <code>adLockOptimistic</code> vs <code>adLockReadOnly</code>.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 10518717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e11da092d3693904529ec4c7b4a91ae?s=128&d=identicon&r=PG&f=1", "display_name": "Slava S.", "link": "https://stackoverflow.com/users/10518717/slava-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1564147422, "creation_date": 1564147422, "answer_id": 57220999, "question_id": 57185962, "link": "https://stackoverflow.com/questions/57185962/improve-sql-query-in-excel-vba/57220999#57220999", "title": "Improve SQL query in Excel VBA", "body": "<p>Thanks @TimWilliams, your comment was most helpful in solving this problem.\nWhat I ended up doing is writing a separate routine that, during feed load,  creates a table of all photos that were changed like this:</p>\n\n<pre><code>sqlQuery = \"INSERT INTO [PHOTO_UPDATES$] SELECT P1.* \" &amp; _\n                \"FROM [PHOTOS$] P1 LEFT JOIN [PHOTOS_CURRENT$] PC1 \" &amp; _\n                \"ON P1.MLS_ID = PC1.MLS_ID AND P1.PHOTO_ID = PC1.PHOTO_ID WHERE PC1.PHOTO_ID is NULL\"\n</code></pre>\n\n<p>Then, when creating the worklist per agent, the following is done:</p>\n\n<pre><code>sqlQuery = \"SELECT DISTINCT INSCR.MLS_ID \" &amp; _\n                \"FROM [PHOTO_UPDATES$] PU1 , [INSCRIPTIONS_CURRENT$] INSCR \" &amp; _\n                \"WHERE INSCR.AGENT_ID = \" &amp; inpAgentId &amp; \" \" &amp; _\n                \"AND PU1.MLS_ID = INSCR.MLS_ID \"\n</code></pre>\n\n<p>Both routines take less than 1 second to run.</p>\n"}], "owner": {"reputation": 33, "user_id": 10518717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e11da092d3693904529ec4c7b4a91ae?s=128&d=identicon&r=PG&f=1", "display_name": "Slava S.", "link": "https://stackoverflow.com/users/10518717/slava-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1564147422, "creation_date": 1563980569, "last_edit_date": 1563986941, "question_id": 57185962, "link": "https://stackoverflow.com/questions/57185962/improve-sql-query-in-excel-vba", "title": "Improve SQL query in Excel VBA", "body": "<p>I have 3 tables in the Excel workbook that I access with SQL.<br>\nThere is Inscriptions table that holds the <code>AGENT_ID</code> and <code>MLS_ID</code>, <code>PHOTOS</code> table that holds all the photos that came in recent feed for <code>MLS_ID</code>, and <code>PHOTOS_CURRENT</code> that holds all the photos that are currently in the system for <code>MLS_ID</code>.<br>\nThe goal is to find if there are photos in the new feed that are not in the system currently.</p>\n\n<p>I tried to query using <code>NOT EXISTS</code> and <code>NOT IN</code> approach. Both take too long to run (sometimes 2 minutes per <code>AGENT_ID</code>).</p>\n\n<p><code>NOT EXISTS</code> approach:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>sqlQuery = \"SELECT DISTINCT INSCR.MLS_ID FROM [INSCRIPTIONS_CURRENT$] INSCR, [PHOTOS$] P1 \" &amp; _\n                \"WHERE INSCR.AGENT_ID = \" &amp; inpAgentId &amp; _\n                \" AND INSCR.MLS_ID = P1.MLS_ID AND NOT exists (select 1 from [PHOTOS_CURRENT$] PC1 where PC1.MLS_ID = P1.MLS_ID and PC1.PHOTO_ID = P1.PHOTO_ID)\"\n</code></pre>\n\n<p><code>NOT IN</code> approach:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>sqlQuery = \"SELECT DISTINCT INSCR.MLS_ID FROM [INSCRIPTIONS_CURRENT$] INSCR, [PHOTOS$] P1 \" &amp; _\n                \"WHERE INSCR.AGENT_ID = \" &amp; inpAgentId &amp; _\n                \" AND INSCR.MLS_ID = P1.MLS_ID AND INSCR.MLS_ID NOT IN (select MLS_ID from [PHOTOS_CURRENT$] PC1 where PC1.MLS_ID = P1.MLS_ID and PC1.PHOTO_ID = P1.PHOTO_ID)\"\n</code></pre>\n\n<p>DB connection is done as follows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Connect()\n\n    Set objConnection = CreateObject(\"ADODB.Connection\")\n    objConnection.CommandTimeout = 120\n\nEnd Sub\n</code></pre>\n\n<p>The query is sent to the procedure for processing as follows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function select_query(sqlQuery As String) As ADODB.Recordset\n\n    Dim objRecordset As ADODB.Recordset\n\n    Const adOpenStatic = 3\n    Const adLockOptimistic = 3\n    Const adCmdText = &amp;H1\n\n    Set objRecordset = CreateObject(\"ADODB.Recordset\")\n\n    objConnection.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n    \"Data Source=\" &amp; ThisWorkbook.FullName &amp; _\n    \";Extended Properties=\"\"Excel 8.0;HDR=Yes;IMEX=1\"\";\"\n\n    objRecordset.Open sqlQuery, objConnection, adOpenStatic, adLockOptimistic, \n    adCmdText\n\n    Set select_query = objRecordset\n\nEnd Function\n</code></pre>\n\n<p>Any suggestions to improve the performance?</p>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "answers": [{"tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": false, "score": 0, "last_activity_date": 1563981492, "creation_date": 1563981492, "answer_id": 57186270, "question_id": 57185864, "link": "https://stackoverflow.com/questions/57185864/cell-interior-color-formatting-based-on-other-cells-value-and-interior-color-in/57186270#57186270", "title": "Cell Interior Color formatting based on other cells&#39; value AND interior color in row", "body": "<p>When using interior cell colours you have two options in VBA. First <code>.Interior.Color</code>, second <code>Interior.ColorIndex</code>. </p>\n\n<p>Now important to note that if you are wanting to check if a cell is a certain colour you are going to need a uniform approach such that all your users use exactly the same colour. For example, using the default dark green option in Excel.</p>\n\n<p>Color: <code>Debug.Print ActiveCell.Interior.Color</code> returns <code>5287936</code> in the immediate window. \nColorIndex: <code>Debug.Print ActiveCell.Interior.ColorIndex</code> returns <code>14</code> in the immediate window. </p>\n\n<p>If we are to use this information we can then simply code an if statement to read:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Sheets(\"Sheet1\").Range(\"C1\").Interior.ColorIndex = 14 And Sheets(\"Sheet1\").Range(\"C1\").Text = \"X\" Then\n    Sheets(\"Sheet1\").Range(\"A1\").Interior.ColorIndex = 14\nEnd If\n</code></pre>\n\n<p>Again, to reiterate, the colours used will need to be uniform for you to pick them up with your VBA. Additionally you now write a simple double <code>For</code> loop to complete your task with colours and text as your verification's to colour Column A.</p>\n"}], "owner": {"reputation": 1, "user_id": 11830539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f48758f7b3cbcd4affb9ac79b4f5ecd?s=128&d=identicon&r=PG&f=1", "display_name": "JonM", "link": "https://stackoverflow.com/users/11830539/jonm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 467, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1601313309, "creation_date": 1563980252, "question_id": 57185864, "link": "https://stackoverflow.com/questions/57185864/cell-interior-color-formatting-based-on-other-cells-value-and-interior-color-in", "title": "Cell Interior Color formatting based on other cells&#39; value AND interior color in row", "body": "<p>I am trying to make an existing large spreadsheet easier to read for a variety of end users. I cannot share the actual spreadsheet, but have made this example page to show what I am trying to do.</p>\n\n<p><a href=\"https://ibb.co/VY3c8c8\" rel=\"nofollow noreferrer\">https://ibb.co/VY3c8c8</a></p>\n\n<p>I want to edit the background color of each cell in column A based on the value and color of the cells in that row on the other end of the spreadsheet. For example, if every cell in C1:G1 that value = X or O and is colored green, set A1 fill to green.</p>\n\n<p>I feel like I am missing a simple, key piece of information, but have not had any luck finding what it may be.</p>\n\n<p>I have tried a wide variety of conditional formatting, but believe that to be impossible since you can't pull Interior.Color into the formula.</p>\n\n<p>I have tried a wide variety of vba, with varying level of success, but haven't found anything that completely works. Here are a couple resources I've had some luck using: </p>\n\n<p><a href=\"https://www.bluepecantraining.com/portfolio/excel-vba-macro-to-apply-conditional-formatting-based-on-value/\" rel=\"nofollow noreferrer\">https://www.bluepecantraining.com/portfolio/excel-vba-macro-to-apply-conditional-formatting-based-on-value/</a></p>\n\n<p><a href=\"https://social.technet.microsoft.com/Forums/en-US/2fffa4d8-bbba-473b-9346-5fce8f0728a8/using-vba-to-change-a-cell-colour-based-on-the-information-in-a-different-cell-excel-2010?forum=excel\" rel=\"nofollow noreferrer\">https://social.technet.microsoft.com/Forums/en-US/2fffa4d8-bbba-473b-9346-5fce8f0728a8/using-vba-to-change-a-cell-colour-based-on-the-information-in-a-different-cell-excel-2010?forum=excel</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/39062358/vba-checking-cell-interior-color\">VBA checking cell interior color</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/44336135/finding-cells-with-certain-interior-color\">Finding cells with certain interior color</a></p>\n\n<p>At this point, my coding attempts are so jumbled, I do not have any meaningful code attempts readily available for pasting here.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11064007, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PQdPdszkhPQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPza3KHbCucvaZ3svCRXGDHoBYkaw/mo/photo.jpg?sz=128", "display_name": "Sorin Ionescu", "link": "https://stackoverflow.com/users/11064007/sorin-ionescu"}, "edited": false, "score": 0, "creation_date": 1563981699, "post_id": 57186269, "comment_id": 100882891, "body": "Hi Eugene, thank you for your help. I am having trouble understanding what your code does. If I copy these blocks into vba outlook and run them, what will happen when a new meeting comes in from a client?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1563981490, "creation_date": 1563981490, "answer_id": 57186269, "question_id": 57185805, "link": "https://stackoverflow.com/questions/57185805/is-there-a-way-through-vba-to-force-outlook-reminders-on-all-incoming-meetings/57186269#57186269", "title": "Is there a way through VBA, to force outlook reminders on all incoming meetings?", "body": "<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.reminder.isvisible\" rel=\"nofollow noreferrer\">IsVisible</a> method of the <code>Reminder</code> class returns a Boolean that determines if the reminder is currently visible. Outlook determines the return value of this property based on the state of the current reminder. All active reminders are visible. If <code>IsVisible</code> is <code>True</code>, the reminder is visible.</p>\n\n<pre><code>Sub DismissReminders()  \n 'Dismisses any active reminders.  \n Dim objRems As Outlook.Reminders  \n Dim objRem As Outlook.Reminder  \n Dim i As Integer  \n\n Set objRems = Application.Reminders  \n For i = objRems.Count To 1 Step -1  \n  If objRems(i).IsVisible = True Then  \n   objRems(i).Dismiss  \n  End If  \n Next  \n\n Set olApp = Nothing  \n Set objRems = Nothing  \n Set objRem = Nothing  \nEnd Sub\n</code></pre>\n\n<p>There is no methods or properties to bring reminders back. The best what you can do is to re-create an appointment item with a reminder set anew:</p>\n\n<pre><code>Sub AddAppt()  \n 'Adds a new appointment and reminder to the reminders collection  \n Dim objApt As AppointmentItem   \n Set objApt = Application.CreateItem(olAppointmentItem)  \n objApt.ReminderSet = True  \n objApt.Subject = \"Tuesday's meeting\"  \n objApt.Save  \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11064007, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PQdPdszkhPQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPza3KHbCucvaZ3svCRXGDHoBYkaw/mo/photo.jpg?sz=128", "display_name": "Sorin Ionescu", "link": "https://stackoverflow.com/users/11064007/sorin-ionescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1591162555, "creation_date": 1563980094, "last_edit_date": 1591162555, "question_id": 57185805, "link": "https://stackoverflow.com/questions/57185805/is-there-a-way-through-vba-to-force-outlook-reminders-on-all-incoming-meetings", "title": "Is there a way through VBA, to force outlook reminders on all incoming meetings?", "body": "<p>All my reminders get turned off randomly. Would there be a way to force them on through VBA?</p>\n\n<p>I followed every troubleshooting procedure from 2010 to 2019. All the options in Outlook do not change anything.</p>\n\n<p>I am expecting that when I get a meeting, reminders appear. The little icon next to meetings show no reminder unless I set one myself.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "edited": false, "score": 0, "creation_date": 1564037918, "post_id": 57187177, "comment_id": 100900603, "body": "Hello Mikku. This line of code <code>With wb2.Sheets(1)         Set rngToCopy = .Range(&quot;A:U&quot;, .Cells(.Rows.Count, &quot;A&quot;).End(xlUp))     End With      Wb1.Sheets(2).Range(&quot;A5&quot;).Resize(rngToCopy.Rows.Count).Value = rngToCopy.Value</code> does not work at all. It doesn&#39;t even highlight the range I want to copy. It seems that it&#39;s being ignored as per code <code>If Not wb2 Is Nothing Then</code>"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "edited": false, "score": 0, "creation_date": 1564038177, "post_id": 57187177, "comment_id": 100900714, "body": "Yes, I forgot to change the line <code>Set wb2 = wB</code>, now I did. Try again"}, {"owner": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "edited": false, "score": 0, "creation_date": 1564038958, "post_id": 57187177, "comment_id": 100901088, "body": "I changed the code and it now debugs at <code>Wb1.Sheets(2).Range(&quot;A5&quot;).Resize(rngToCopy.Rows.Count).Value = rngToCopy.Value</code> <i>Run-time error &#39;1004&#39;: Application-defined or object defined error</i>. It also shows that the <code>.Range(&quot;A:U&quot;, .Cells(.Rows.Count, &quot;A&quot;).End(xlUp))</code> is not being highlighted to copy."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "edited": false, "score": 0, "creation_date": 1564039213, "post_id": 57187177, "comment_id": 100901211, "body": "Yes, there are other issues in your code rather than the ones mentioned in Question. Anyways, i have tried to fix this one also. Run the answer again"}, {"owner": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "edited": false, "score": 0, "creation_date": 1564123496, "post_id": 57187177, "comment_id": 100934000, "body": "Hi Mikku. I was able to run the copy paste code now. Using this code <code>With wb2.Sheets(1)         Set rngToCopy = .Range(&quot;A1:U50&quot;, .Cells(.Rows.Count, &quot;A&quot;).End(xlUp))         rngToCopy.Copy     End With          For Each wb2 In Application.Workbooks         wb2.Activate     Next          Wb1.Sheets(&quot;Data Dump&quot;).Range(&quot;A6&quot;).PasteSpecial Paste:=xlPasteValues</code> However it only runs in debug mode. It seems I&#39;m missing a few codes after the send keys(Last send key function opens the downloaded file) so that it will follow up with that action. Can you help me?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "edited": false, "score": 0, "creation_date": 1564123919, "post_id": 57187177, "comment_id": 100934206, "body": "Probably you should ask a new question for that. :) All the best with your code."}, {"owner": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "edited": false, "score": 0, "creation_date": 1564127057, "post_id": 57187177, "comment_id": 100935580, "body": "I actually did. Lol. No one has replied yet. Thanks btw!"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1564039173, "last_edit_date": 1564039173, "creation_date": 1563984477, "answer_id": 57187177, "question_id": 57185675, "link": "https://stackoverflow.com/questions/57185675/copy-pasting-opened-sheet-file-to-current-workbook/57187177#57187177", "title": "Copy Pasting Opened Sheet File to Current Workbook", "body": "<p><strong>Problem:</strong></p>\n\n<p>You are using thisworkbook everytime. Should be different books. One that is found and other the workbook you want to copy data into.</p>\n\n<p><strong>Change the Part After SendKeys with:</strong></p>\n\n<pre><code>Dim Wb1 As Workbook, wb2 As Workbook, wB As Workbook\nDim rngToCopy As Range\n\nSet Wb1 = ThisWorkbook\n\nFor Each wB In Application.Workbooks\n    If Left(wB.Name, 14) = \"RealTime\" Then\n       Set wb2 = wB\n       Exit For\n   End If\nNext\n\nIf Not wb2 Is Nothing Then\n\n    With wb2.Sheets(1)\n        Set rngToCopy = .Range(\"A1:U\", .Cells(.Rows.Count, \"A\").End(xlUp).row)\n    End With\n\n    Wb1.Sheets(2).Range(\"A5\").Resize(rngToCopy.Rows.Count).Value = rngToCopy.Value\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564039173, "creation_date": 1563979699, "question_id": 57185675, "link": "https://stackoverflow.com/questions/57185675/copy-pasting-opened-sheet-file-to-current-workbook", "title": "Copy Pasting Opened Sheet File to Current Workbook", "body": "<p>I was just finished automating my report (open ie, navigate ie, extract data, and open downloaded data). I'm now in the process of copy pasting the extracted file to the current workbook. The issues are the </p>\n\n<ul>\n<li>downloaded workbook have different numbers at the end of its name<br>\nevery  </li>\n<li>download first tab or sheet is not named \"Sheet 1</li>\n</ul>\n\n<p>After the last sendKey command, the downloaded file will open.</p>\n\n<p>Every file has one name identifier which is \"RealTime\" For the file name and tab. </p>\n\n<p>Commented scripts are not working</p>\n\n<pre><code>Sub Get_RawFile()\n'\n'\n'\n    Dim IE As New InternetExplorer\n    Dim HTMLDoc As HTMLDocument\n    Dim HTMLselect As HTMLSelectElement\n\n    With IE\n        .Visible = True\n        .Navigate (\"-------------------------\")\n\n    While IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\n\n    Set HTMLDoc = IE.document\n    HTMLDoc.all.UserName.Value = Sheets(\"Data Dump\").Range(\"A1\").Value\n    HTMLDoc.all.Password.Value = Sheets(\"Data Dump\").Range(\"B1\").Value\n    HTMLDoc.getElementById(\"login-btn\").Click\n\n    While IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n\n    Set objButton = HTMLDoc.getElementById(\"s2id_ddlReportType\")\n    Set HTMLselect = HTMLDoc.getElementById(\"ddlReportType\")\n    objButton.Focus\n    HTMLselect.Value = \"2\"\n\n    Set HTMLselectZone = HTMLDoc.getElementById(\"ddlTimezone\")\n    HTMLselectZone.Value = \"PST8PDT\"\n\n    Set subgroups = HTMLDoc.getElementById(\"s2id_ddlSubgroups\")\n    subgroups.Click\n    Set subgroups2 = HTMLDoc.getElementById(\"ddlSubgroups\")\n    subgroups2.Value = \"1456_17\"\n\n    HTMLDoc.getElementById(\"dtStartDate\").Value = Format(Sheets(\"Attendance\").Range(\"B6\").Value, \"yyyy-mm-dd\")\n    HTMLDoc.getElementById(\"dtEndDate\").Value = Format(Sheets(\"Attendance\").Range(\"X6\").Value, \"yyyy-mm-dd\")\n\n    HTMLDoc.getElementById(\"btnGetReport\").Focus\n    HTMLDoc.getElementById(\"btnGetReport\").Click\n    Application.Wait (Now + TimeValue(\"0:00:10\"))\n\n    HTMLDoc.getElementById(\"btnDowloadReport\").Click\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n    Application.SendKeys \"{LEFT}\"\n    Application.SendKeys \"{ENTER}\"\n    Application.Wait (Now + TimeValue(\"0:00:02\"))\n    Application.SendKeys \"{ENTER}\"\n    Application.Wait (Now + TimeValue(\"0:00:02\"))\n    Application.SendKeys \"{DOWN}\"\n    Application.Wait (Now + TimeValue(\"0:00:02\"))\n    Application.SendKeys \"{ENTER}\"\n\n    Dim Wb1 As Workbook, wb2 As Workbook, wB As Workbook\n    Dim rngToCopy As Range\n\n    For Each wB In Application.Workbooks\n        If Left(wB.Name, 14) = \"RealTime\" Then\n           Set Wb1 = ThisWorkbook\n           Exit For\n       End If\n    Next\n\n    'If Not Wb1 Is Nothing Then\n    '    Set wb2 = ThisWorkbook\n\n    '   With Wb1.Sheets(1)\n    '        Set rngToCopy = .Range(\"A:U\", .Cells(.Rows.Count, \"A\").End(xlUp))\n    '    End With\n    '   wb2.Sheets(2).Range(\"A5\").Resize(rngToCopy.Rows.Count).Value = rngToCopy.Value\n    'End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1563979617, "post_id": 57185616, "comment_id": 100881711, "body": "Without seeing the code we cannot help.  Please <a href=\"https://stackoverflow.com/posts/57185616/edit\">edit</a> the post to include the code."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564060663, "post_id": 57185616, "comment_id": 100913294, "body": "@Chadon Iegran, please can I have some feedbacks on my <a href=\"https://stackoverflow.com/a/57185759/11167163\">Answer</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9259045"}, "edited": false, "score": 0, "creation_date": 1564148482, "post_id": 57185759, "comment_id": 100946770, "body": "It&#39;s not working. When I click on my process button, the &#39;&#39;assignation&#39;&#39; page always go to last sheet"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564148555, "post_id": 57185759, "comment_id": 100946807, "body": "@chadonlegran Did you paste it into <b>ThisWorkbook</b> ? not in a MODULE"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9259045"}, "edited": false, "score": 0, "creation_date": 1564148779, "post_id": 57185759, "comment_id": 100946927, "body": "Yes, exactly like you said !"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564148834, "post_id": 57185759, "comment_id": 100946959, "body": "@chadonlegran now close your workbook and re open it ;)"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564148926, "post_id": 57185759, "comment_id": 100947024, "body": "@chadonlegran this should replace the sheet in the right place"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564149586, "post_id": 57185759, "comment_id": 100947372, "body": "@chadonlegran if it does the job tell me we will just need to add something"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1569488882, "post_id": 57185759, "comment_id": 102616172, "body": "@chadonlegran If your issue is fixed, may I ask you to accept this answer ?"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1563979955, "creation_date": 1563979955, "answer_id": 57185759, "question_id": 57185616, "link": "https://stackoverflow.com/questions/57185616/how-to-stop-my-excel-sheets-from-changing-places-whenever-vba-is-used/57185759#57185759", "title": "How to stop my excel sheets from changing places whenever vba is used?", "body": "<p>Do <strong>Alt + F11</strong> go to <strong>ThisWorkbook</strong> from the left <strong>Project Explorer</strong> pane, double click it to open the Module then <strong>paste</strong> this. This code will lock your sheet <strong>assignation</strong> where you placed it.</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\nIf Application.ActiveSheet.Index &lt;&gt; Application.Sheets(\"assignation\").Index Then\n    Application.Sheets(\"assignation\").Move Before:=Application.Sheets(Application.ActiveSheet.Index)\n    Application.Sheets(\"assignation\").Activate\n    Sh.Activate\nEnd If\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>save and close this code, now, when you click any of your worksheet tab, this specific worksheet will be always at the front of your clicked sheet tab</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9259045"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563980693, "creation_date": 1563979466, "last_edit_date": 1563980693, "question_id": 57185616, "link": "https://stackoverflow.com/questions/57185616/how-to-stop-my-excel-sheets-from-changing-places-whenever-vba-is-used", "title": "How to stop my excel sheets from changing places whenever vba is used?", "body": "<p>I have some VBA codage in my excel file that refresh with new information a page called ''assgination'' whenever I click the control button.</p>\n\n<p>My sheet ''assignation'' should always stay in 4th position, but whenever it's refreshed, it goes to the last position.</p>\n\n<p>how to stop making it move?</p>\n"}, {"tags": ["excel", "vba", "selenium", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 450, "user_id": 9150392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUfDH.jpg?s=128&g=1", "display_name": "IPolnik", "link": "https://stackoverflow.com/users/9150392/ipolnik"}, "edited": false, "score": 0, "creation_date": 1563980060, "post_id": 57185596, "comment_id": 100881956, "body": "What error message do u see, when its failing?"}, {"owner": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "reply_to_user": {"reputation": 450, "user_id": 9150392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUfDH.jpg?s=128&g=1", "display_name": "IPolnik", "link": "https://stackoverflow.com/users/9150392/ipolnik"}, "edited": false, "score": 0, "creation_date": 1563980384, "post_id": 57185596, "comment_id": 100882153, "body": "@IPolnik I am getting the NoSuchElementError saying &quot;Element not found for css=&quot;#username&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "edited": false, "score": 0, "creation_date": 1563980884, "post_id": 57185911, "comment_id": 100882434, "body": "Thank you for the image and the explanation, I would have never figured that out by myself O:-)"}], "tags": [], "owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "is_accepted": false, "score": 2, "last_activity_date": 1563980403, "creation_date": 1563980403, "answer_id": 57185911, "question_id": 57185596, "link": "https://stackoverflow.com/questions/57185596/why-does-sendkeys-not-work-on-input-field-after-website-update-excel-vba-sele/57185911#57185911", "title": "Why does Sendkeys not work on input field after website update? - Excel VBA Selenium", "body": "<p>The target element is in iframe so you have to switch to iframe before interacting with the target element.</p>\n\n<p><a href=\"https://i.stack.imgur.com/foZcy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/foZcy.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "edited": false, "score": 0, "creation_date": 1563980845, "post_id": 57185997, "comment_id": 100882413, "body": "Thank you very much for also showing me how it is done!"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1564046924, "post_id": 57185997, "comment_id": 100905549, "body": "@KunduK Why I got error at this line <code>driver.SwitchToFrame.FindElementById (&quot;central-login-iframe&quot;)</code> .. but works fine when change to <code>driver.SwitchToFrame &quot;central-login-iframe&quot;</code>?"}, {"owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1564047616, "post_id": 57185997, "comment_id": 100905918, "body": "@YasserKhalil : I think it is been deprecated.Earlier it used to work.However change it  <code>driver.SwitchToFrame &quot;central-login-iframe&quot;</code> selenium keep doing changes method and parameters and deprecate some method."}], "tags": [], "owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "is_accepted": true, "score": 3, "last_activity_date": 1563980708, "creation_date": 1563980708, "answer_id": 57185997, "question_id": 57185596, "link": "https://stackoverflow.com/questions/57185596/why-does-sendkeys-not-work-on-input-field-after-website-update-excel-vba-sele/57185997#57185997", "title": "Why does Sendkeys not work on input field after website update? - Excel VBA Selenium", "body": "<p>There is an <code>iframe</code> .You need to switch to <code>iframe</code> to access the element.</p>\n\n<pre><code>Public Sub Login()\n\n    Set driver = New Selenium.ChromeDriver\n\n    driver.Get \"https://partner.spreadshirt.de/login\"\n    driver.SwitchToFrame.FindElementById(\"central-login-iframe\")\n    driver.FindElementByCss(\"#username\").SendKeys (\"username\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 10498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eabe7ab1bea35d40277c8c37865bcfa4?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/10498998/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1564007231, "creation_date": 1564007231, "answer_id": 57192036, "question_id": 57185596, "link": "https://stackoverflow.com/questions/57185596/why-does-sendkeys-not-work-on-input-field-after-website-update-excel-vba-sele/57192036#57192036", "title": "Why does Sendkeys not work on input field after website update? - Excel VBA Selenium", "body": "<pre><code>Public Sub Logindsfsdfsdfsdf()\n\n    Set driver = New Selenium.ChromeDriver\n\n    driver.Get \"https://partner.spreadshirt.de/login\"\n    driver.SwitchToFrame \"central-login-iframe\" ' .FindElementById(\"central-login-iframe\")\n    driver.FindElementByCss(\"#username\").SendKeys (\"username\")\n    driver.FindElementById(\"password\").SendKeys \"password\"\n    driver.FindElementById(\"login-submit\").Click\n    Stop\nStop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 57185997, "answer_count": 3, "score": 0, "last_activity_date": 1564007231, "creation_date": 1563979419, "last_edit_date": 1563989363, "question_id": 57185596, "link": "https://stackoverflow.com/questions/57185596/why-does-sendkeys-not-work-on-input-field-after-website-update-excel-vba-sele", "title": "Why does Sendkeys not work on input field after website update? - Excel VBA Selenium", "body": "<p>I have written a short script to log me in to the following page automaticaly, however last week it stopped to work and I cannot figure out why.</p>\n\n<p>This is the url:\n<a href=\"https://partner.spreadshirt.de/login\" rel=\"nofollow noreferrer\">https://partner.spreadshirt.de/login</a></p>\n\n<p>II am using Excel Vba with the selenium and the chromewebdriver. I taught myself how to write code in VBA so I don't know if I am describing everything in a proper way. \nI assume it has to be with the autofocus attribute or the nonvalidate, but I might also be wrong</p>\n\n<p>I tried every variation of addressing via css (\"input#username\", \"#loginForm #username\"), what else can I try?</p>\n\n<p>I also tried looking for a solution on stackoverflow, but if you don't know what to look for it is a little bit difficult, if you could point me in the right direction or explain why my approach didn't work I am always happy to learn!</p>\n\n<pre><code>Public Sub Login()\n\n    Set driver = New Selenium.ChromeDriver\n\n    driver.Get \"https://partner.spreadshirt.de/login\"\n\n    driver.FindElementByCss(\"#username\").SendKeys (\"username\")\n\nEnd Sub\n</code></pre>\n\n<p>I want a quick way to login so I don't have to do it manually. It was working in the past, but in the last update they changed the Css ID and apparently something else I am not able to figure out :-)</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 0, "creation_date": 1563999509, "post_id": 57185555, "comment_id": 100891081, "body": "If you had code it would be more helpful to understand your goal. So you want to create a button that you click after you input your variables which then calculates the mass of an object in another cell? At face value that just sounds like that cell should have the formula to mass unless I&#39;m misunderstanding something."}], "answers": [{"tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 0, "last_activity_date": 1564038008, "creation_date": 1564038008, "answer_id": 57196056, "question_id": 57185555, "link": "https://stackoverflow.com/questions/57185555/how-do-i-cause-an-excel-cell-to-update-from-within-a-vba-module/57196056#57196056", "title": "How do I cause an excel cell to update from within a vba module?", "body": "<p>add the following instruction at the begin of all functions that you want to be reevaluated after entering a new value to your worksheet</p>\n\n<pre><code>application.volatile\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 11573583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TEQu3.png?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/11573583/nicholas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564038008, "creation_date": 1563979276, "last_edit_date": 1563981549, "question_id": 57185555, "link": "https://stackoverflow.com/questions/57185555/how-do-i-cause-an-excel-cell-to-update-from-within-a-vba-module", "title": "How do I cause an excel cell to update from within a vba module?", "body": "<p>I am still fairly new to VBA coding and for a while I have been having the same issue. In my code I am constantly jumping around an issue where I have a function or sub that performs a task or series of tasks which change any number of variables/values. I also have a number of excel cells that contain functions which retrieve single values - like \"<code>=Get_Density(B1,B2)</code>\" - where B1 and B2 might be mass and volume. </p>\n\n<p>Most of my cells update whenever I change a value on my sheet that pertains to one of the variables within a function. For example if I change cell B1 this will automatically call the <code>Get_Density()</code> function to run, which automatically updates the cell.</p>\n\n<p>What I want is when I have a function that has no input parameters or 'if statements' to control when a cell updates - like \"<code>Get_Density()</code>\" - with no parameters... How can I initiate my function externally. </p>\n\n<p>This is just an example, but it is similar to what I am trying to achieve - lets say my values were to come from a userform that's opened from a button on an excel sheet. Lets also say I can input two values - mass and volume. Once I enter two values I click a button which says \"Done\" and then the program calculates the value for density and sets it equal to a variable in a separate module. Now how do I instantiate the cell which retrieves the value either on a button press or when the user form closes? </p>\n\n<p>I have tried directly setting my cells from within VBA to the value that I want. My only problem with this is that if the position of where I want the value changes then I have to change every instance of it on my code. I have also tried checking for conditions within excel, but this only works for specific instances.</p>\n\n<p>I can show code if needed, but I was hoping there was a method or function within VBA and excel that would achieve what I am looking for. I don't really have code that needs fixing.</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563978962, "post_id": 57185356, "comment_id": 100881311, "body": "Note that <code>Dim i, j As Integer</code> will declare <code>j</code> as <code>Integer</code> but <code>i</code> as <code>Variant</code> in VBA you need to declare a type for <b>every</b> variable <code>Dim i As Long, j As Long</code>. But actually here you can remove it, because both variables are not used at all."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1563979138, "post_id": 57185356, "comment_id": 100881421, "body": "Can you post the code for the function that calls <code>CreateEmail</code>?"}, {"owner": {"reputation": 188, "user_id": 8984969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46843e26387a144852531ad474c8d14a?s=128&d=identicon&r=PG&f=1", "display_name": "li rachel", "link": "https://stackoverflow.com/users/8984969/li-rachel"}, "edited": false, "score": 0, "creation_date": 1564089033, "post_id": 57185356, "comment_id": 100926694, "body": "Thank you Peh! i just removed dim i, j in the code, :) They are used for another piece of code that i&#39;ve identified and isolated with the issue!"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1563980037, "creation_date": 1563980037, "answer_id": 57185784, "question_id": 57185356, "link": "https://stackoverflow.com/questions/57185356/vba-send-email-in-outlook-2016-efficiency-worsened/57185784#57185784", "title": "VBA send email in outlook 2016 efficiency worsened?", "body": "<p>Of course, in the code each time you create a new Outlook <code>Application</code> instance. You can optimize the codebase by extracting such pieces into separate methods (outer) that may call the <code>CreateEmail</code> multiple times only for creating items.</p>\n\n<pre><code>Dim olapp As Outlook.Application\nSet olapp = New Outlook.Application\n\nFunction CreateEmail(app as Outlook.Application, ToSend As String, ccs As String) As Integer\n    Dim olemail As Outlook.MailItem\n    Dim OutlookTemplate As String\n    OutlookTemplate = \"TemplatePath.oft\"\n    Dim recipientCheck As Outlook.recipient\n\n    Set olemail = olapp.CreateItemFromTemplate(OutlookTemplate)  \n    With olemail          \n        .HTMLBody =\"Body String\"\n        .SentOnBehalfOfName = \"sender email address\"\n        .Subject = \"subject string\"\n        .To = ToSend\n        .CC = ccs\n        .Attachments.Add \"attachment.pdf\" ' pdf size is 200k\n\n        'this is a check for tosend email addresses, \n        'already tried remove this piece of code, no significant improvement there\n        Dim recipient As Variant\n        Dim i, j As Integer\n        For Each recipient In .recipients\n            recipient.Resolve\n        Next\n\n        .Save\n    End With\n\n    CreateEmail = 1\nEnd Function\n</code></pre>\n\n<p>You may also find the following articles helpful:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/02/outlook-create-send-message/\" rel=\"nofollow noreferrer\">How To: Create and send an Outlook message programmatically</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/08/26/outlook-create-show-message-programmatically/\" rel=\"nofollow noreferrer\">How to create and show a new Outlook mail item programmatically: C#, VB.NET</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/08/31/outlook-create-message-based-on-template/\" rel=\"nofollow noreferrer\">How To: Create a new Outlook message based on a template</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/08/outlook-fill-recipients-programmatically/\" rel=\"nofollow noreferrer\">How To: Fill TO,CC and BCC fields in Outlook programmatically</a></li>\n</ul>\n"}], "owner": {"reputation": 188, "user_id": 8984969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46843e26387a144852531ad474c8d14a?s=128&d=identicon&r=PG&f=1", "display_name": "li rachel", "link": "https://stackoverflow.com/users/8984969/li-rachel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1563980037, "creation_date": 1563978666, "last_edit_date": 1563978835, "question_id": 57185356, "link": "https://stackoverflow.com/questions/57185356/vba-send-email-in-outlook-2016-efficiency-worsened", "title": "VBA send email in outlook 2016 efficiency worsened?", "body": "<p>There is a simple piece of standard VBA code that I use to send emails by looking through a list and generating around 2000 email to the draft folder.  In my old version of excel &amp; outlook 2012, it took only around 20 min or less to generate all.  But after migrated to versions of 2016, the same piece of code take up to 4 hour.  Is there any way to speed it up? Thanks! </p>\n\n<pre><code>Function CreateEmail(ToSend As String, ccs As String) As Integer\n    Dim olapp As Outlook.Application\n    Dim olemail As Outlook.MailItem\n    Dim OutlookTemplate As String\n    OutlookTemplate = \"TemplatePath.oft\"\n\n    Set olapp = New Outlook.Application\n    Set olemail = olapp.CreateItemFromTemplate(OutlookTemplate)  \n\n    Dim recipientCheck As Outlook.recipient\n\n\n    With olemail          \n        .HTMLBody =\"Body String\"\n        .SentOnBehalfOfName = \"sender email address\"\n        .Subject = \"subject string\"\n        .To = ToSend\n        .CC = ccs\n        .Attachments.Add \"attachment.pdf\" ' pdf size is 200k\n\n        'this is a check for tosend email addresses, \n        'already tried remove this piece of code, no significant improvement there\n        Dim recipient As Variant\n        Dim i, j As Integer\n        For Each recipient In .recipients\n            recipient.Resolve\n        Next\n\n        .Save\n    End With\n\n    CreateEmail = 1\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1564012257, "post_id": 57185301, "comment_id": 100894477, "body": "Set myNameSpace before Set TopPublicFolder"}, {"owner": {"reputation": 11, "user_id": 10187256, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m3Gn0co9gOg/AAAAAAAAAAI/AAAAAAAAAQY/NPl_b9mWm4g/photo.jpg?sz=128", "display_name": "Mateusz D\u0105bkowski", "link": "https://stackoverflow.com/users/10187256/mateusz-d%c4%85bkowski"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1564036544, "post_id": 57185301, "comment_id": 100899976, "body": "Your suggestion with the mistake spotted by Eugene, fixed it for me thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10187256, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m3Gn0co9gOg/AAAAAAAAAAI/AAAAAAAAAQY/NPl_b9mWm4g/photo.jpg?sz=128", "display_name": "Mateusz D\u0105bkowski", "link": "https://stackoverflow.com/users/10187256/mateusz-d%c4%85bkowski"}, "edited": false, "score": 0, "creation_date": 1563983055, "post_id": 57185673, "comment_id": 100883651, "body": "Thanks for spotting the mistake. though i am still getting an error and when I press debug it highlights the  Set TopPublicFolder = myNameSpace.GetDefaultFolder(olPublicFoldersAllPublicFolders&zwnj;&#8203;)"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1564133279, "last_edit_date": 1564133279, "creation_date": 1563979693, "answer_id": 57185673, "question_id": 57185301, "link": "https://stackoverflow.com/questions/57185301/how-to-specify-non-default-public-folders/57185673#57185673", "title": "How to specify non-default public folders", "body": "<p>There is no <code>myContactsFolder</code> object declared in the code:</p>\n\n<pre><code>Sub CopyFolder()\nDim myNameSpace As Outlook.NameSpace\nDim myInboxFolder As Outlook.Folder\nDim myToBeCopiedFolder As Outlook.Folder\nDim myNewFolder As Outlook.Folder\nDim TopPublicFolder As Object\n\nSet myNameSpace = Application.GetNamespace(\"MAPI\")\nSet TopPublicFolder = myNameSpace.GetDefaultFolder(olPublicFoldersAllPublicFolders)\nSet myNameSpace = Application.GetNamespace(\"MAPI\")\nSet myInboxFolder = TopPublicFolder.Folders(\"Office emails\")\nSet myToBeCopiedFolder = Application.ActiveExplorer.CurrentFolder\nSet myNewFolder = myToBeCopiedFolder.CopyTo(myInboxFolder)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10187256, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m3Gn0co9gOg/AAAAAAAAAAI/AAAAAAAAAQY/NPl_b9mWm4g/photo.jpg?sz=128", "display_name": "Mateusz D\u0105bkowski", "link": "https://stackoverflow.com/users/10187256/mateusz-d%c4%85bkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 57185673, "answer_count": 1, "score": 0, "last_activity_date": 1564133279, "creation_date": 1563978473, "last_edit_date": 1563982715, "question_id": 57185301, "link": "https://stackoverflow.com/questions/57185301/how-to-specify-non-default-public-folders", "title": "How to specify non-default public folders", "body": "<p>I want to create a macro, that allows for copying currently selected folder into a public (shared) folder. </p>\n\n<pre><code>Sub CopyFolder()\n    Dim myNameSpace As Outlook.NameSpace\n    Dim myInboxFolder As Outlook.Folder\n    Dim myToBeCopiedFolder As Outlook.Folder\n    Dim myNewFolder As Outlook.Folder\n    Dim TopPublicFolder As Object\n\n    Set TopPublicFolder = myNameSpace.GetDefaultFolder(olPublicFoldersAllPublicFolders)\n    Set myNameSpace = Application.GetNamespace(\"MAPI\")\n    Set myInboxFolder = TopPublicFolder.Folders(\"Office emails\")\n    Set myToBeCopiedFolder = Application.ActiveExplorer.CurrentFolder\n    Set myNewFolder = myContactsFolder.CopyTo(myInboxFolder)\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/c3lMr.png\" alt=\"How my public folders look\"></p>\n\n<p>Currently, I am getting run-time error 91, and to be honest, no idea why.</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563979142, "post_id": 57185293, "comment_id": 100881425, "body": "Your code seems working for me please check your sheet name <b>App 4 Input</b> and <b>Grazing Group Manure Calculator</b> maybe you did a <b>typo</b>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563979332, "post_id": 57185293, "comment_id": 100881544, "body": "@Dorian Did you &quot;enter =ManageLists() in a worksheet cell&quot; as described?"}], "answers": [{"tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": true, "score": 0, "last_activity_date": 1563979013, "last_edit_date": 1563979013, "creation_date": 1563978668, "answer_id": 57185358, "question_id": 57185293, "link": "https://stackoverflow.com/questions/57185293/vba-range-methods-not-working-from-function-call/57185358#57185358", "title": "VBA Range methods not working from function call", "body": "<p>You can't use a UDF in that fashion. Taken from <a href=\"http://www.cpearson.com/excel/writingfunctionsinvba.aspx\" rel=\"nofollow noreferrer\">Chip Pearson's</a> excellent website:</p>\n\n<blockquote>\n  <p>A User Defined Function (or UDF) is a Function procedure that typically (but not necessarily) accepts some inputs and returns a result. A UDF can only return a value to the cell(s) whence it was called -- it must not modify the contents or formatting of any cell and must not modify the operating environment of Excel. If you attempt to change anything, the function will terminate immediately and return a #VALUE error to the calling cell.</p>\n</blockquote>\n\n<hr>\n\n<p>It seems that you want to execute your function everytime a value changes on a worksheet, and so you should use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\"><code>Worksheet_Change</code></a> event of your <code>App 4 Input</code> worksheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'if a value in column 1 (A:A) changes\n    If Target.Column = 1 Then\n        Call RemoveDuplicateValues\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10465486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac085b3aed9c1fa27de75a97ef12f7d3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie White", "link": "https://stackoverflow.com/users/10465486/charlie-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "closed_date": 1563979269, "accepted_answer_id": 57185358, "answer_count": 1, "score": 1, "last_activity_date": 1563979140, "creation_date": 1563978443, "last_edit_date": 1563979140, "question_id": 57185293, "link": "https://stackoverflow.com/questions/57185293/vba-range-methods-not-working-from-function-call", "closed_reason": "Duplicate", "title": "VBA Range methods not working from function call", "body": "<p>I am trying to develop a custom VBA function that manipulates ranges, namely to remove duplicate values from a list and place the list of unique values in a specific column of the worksheet. The reason I am using a custom function call is that I would like the unique values list to update anytime a new entry is made the original list.</p>\n\n<p>I can get the code to work when I run it manually as a subroutine (e.g., running just the <code>Sub RemoveDuplicateValues()</code> segment below). However, when it is called from the custom function through the workbook (e.g., by entering <code>=ManageLists()</code> in a worksheet cell), the code exits without doing anything at the first instance of trying to use one of the Range methods, namely at the line <code>NewList.Value2 = OriginalList.Value2</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function ManageLists() As Double\n    Call RemoveDuplicateValues\nEnd Function\n\nSub RemoveDuplicateValues()\n    Dim OriginalList, NewList As Range\n\n    Set OriginalList = Worksheets(\"App 4 Input\").Range(\"A4:A503\")\n    Set NewList = Worksheets(\"Grazing Group Manure Calculator\").Range(\"CG4:CG503\")\n\n    NewList.Value2 = OriginalList.Value2\n\n    NewList.RemoveDuplicates Columns:=Array(1)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 2, "creation_date": 1563977959, "post_id": 57185071, "comment_id": 100880642, "body": "what is lastrowEmp? it seems like a typo"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 4, "creation_date": 1563977975, "post_id": 57185071, "comment_id": 100880653, "body": "Your Macro is Running, but it skips the For Loop. Run it using <code>F8</code> ...you will see for yourself because of the Variable <code>lastrowEmp</code>, it doesn&#39;t have any value."}, {"owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 5, "creation_date": 1563978011, "post_id": 57185071, "comment_id": 100880677, "body": "i&#39;d recommend using option explicit at top of code"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1563979334, "post_id": 57185071, "comment_id": 100881547, "body": "I get the VtC&#39;s, but this is a <i>great</i> object lesson on <code>Option Explicit</code> and is very valuable for <code>VBA</code> new programmers. Hope it stays open. (Unless it&#39;s closed as a dupe of one of the myriad of other &quot;you&#39;ve got a typo in your variable name, use <code>Option Explicit</code>&quot; questions...)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563979526, "post_id": 57185071, "comment_id": 100881660, "body": "FWIW Rubberduck&#39;s (a VBIDE add-in open-source project I manage) <a href=\"http://rubberduckvba.com/Inspections/Details/UndeclaredVariable\" rel=\"nofollow noreferrer\">UndeclaredVariable</a> and <a href=\"http://rubberduckvba.com/Inspections/Details/OptionExplicit\" rel=\"nofollow noreferrer\">Option Explicit</a> inspections would have spawned inspection results here, pointing exactly where the problem is."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 6, "last_activity_date": 1563978080, "creation_date": 1563978080, "answer_id": 57185161, "question_id": 57185071, "link": "https://stackoverflow.com/questions/57185071/module-wont-run-in-excel-vba-editor/57185161#57185161", "title": "Module won&#39;t run in Excel VBA editor", "body": "<p><strong>Use this:</strong></p>\n\n<pre><code>For rownum = 1 To lastrow\n</code></pre>\n\n<p><strong>Instead of:</strong> </p>\n\n<pre><code>For rownum = 1 To lastrowEmp\n</code></pre>\n\n<p>Also, it's wise to use <code>Option Explicit</code> before any subject, to avoid these mistakes.</p>\n\n<p>Your code is running, but as there is no value in <code>lastrowEmp</code> the For Loop is skipped.</p>\n"}], "owner": {"reputation": 21, "user_id": 11830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84fd094aa6addeee5341bbfbd273b2e0?s=128&d=identicon&r=PG&f=1", "display_name": "stackoverflow213312", "link": "https://stackoverflow.com/users/11830598/stackoverflow213312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1563989465, "answer_count": 1, "score": 0, "last_activity_date": 1563978431, "creation_date": 1563977795, "last_edit_date": 1563978431, "question_id": 57185071, "link": "https://stackoverflow.com/questions/57185071/module-wont-run-in-excel-vba-editor", "closed_reason": "Not suitable for this site", "title": "Module won&#39;t run in Excel VBA editor", "body": "<p>I am trying to run a program in excel's Visual Studio editor but when I click the green run button nothing happens and the module doesn't run. However, with other modules it is running fine. I am not sure what the issue is.</p>\n\n<p>I have already tried restarting excel and copying the code to another file and module that work but the same issue occurs. </p>\n\n<p>This is the code:</p>\n\n<pre><code>Sub Balance()\n    Dim rownum As Long\n    Dim colnum As Long\n    Dim startrow As Long\n    Dim lastrow As Long\n\n    rownum = 1\n    colnum = 1\n    lastrow = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A65536\").End(xlUp).Row\n\n    With ThisWorkbook.Sheets(\"Sheet1\").Range(\"a1:a\" &amp; lastrow)\n        For rownum = 1 To lastrowEmp\n            Do\n                If .Cells(rownum, 1).Value = \"Employee Group Totals\" Then\n                    startrow = rownum\n                End If\n\n                rownum = rownum + 1\n                If (rownum &gt; lastrow) Then Exit For\n            Loop Until .Cells(rownum, 1).Value = \"Net pay\"\n\n            endrow = rownum\n            rownum = rownum + 1\n\n            ThisWorkbook.Sheets(\"Sheet1\").Range(startrow &amp; \":\" &amp; \n      endrow).EntireRow.Copy\n\n            ThisWorkbook.Sheets(\"Sheet2\").Select\n            Range(\"A1\").Select\n            ActiveSheet.Paste\n        Next rownum\n    End With    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11830784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I7uaf9t5FYg/AAAAAAAAAAI/AAAAAAAAAH4/ZtxDyebhZuk/photo.jpg?sz=128", "display_name": "Punter", "link": "https://stackoverflow.com/users/11830784/punter"}, "edited": false, "score": 0, "creation_date": 1564001910, "post_id": 57188851, "comment_id": 100891948, "body": "Thanks Cindy, that makes sense.  Does it only happen in specific situations (e.g. changing the .AutoUpdate property)?  Just using <code>.Fields.Update</code>, or  <code>Replace(.Code.Text...)</code> doesn&#39;t seem to have the same effect."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 13, "user_id": 11830784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I7uaf9t5FYg/AAAAAAAAAAI/AAAAAAAAAH4/ZtxDyebhZuk/photo.jpg?sz=128", "display_name": "Punter", "link": "https://stackoverflow.com/users/11830784/punter"}, "edited": false, "score": 0, "creation_date": 1564139668, "post_id": 57188851, "comment_id": 100942050, "body": "I really don&#39;t know, in detail @Punter. This is just something I&#39;ve picked up over the years in discussions with MS technicians with similar issues (such as what happens when content controls update)."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1563991452, "creation_date": 1563991452, "answer_id": 57188851, "question_id": 57184882, "link": "https://stackoverflow.com/questions/57184882/ms-word-updating-links-why-does-changing-a-linkformat-property-reset-field-ind/57188851#57188851", "title": "MS Word updating links: Why does changing a .LinkFormat property reset field Index", "body": "<p>Behind the scenes, what's happening is that Word <em>recreates</em> the content and the field. The orginal linked content is removed and new content inserted. So that essentially destroys the field and recreates it. A user won't notice this, but VBA does.</p>\n\n<p>When dealing with a loop situation that uses an index and the looped items are being removed, it's therefore customary to loop <em>backwards</em> (from the end of the document to the beginning). Which cannot be done with For...Each.</p>\n"}], "owner": {"reputation": 13, "user_id": 11830784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-I7uaf9t5FYg/AAAAAAAAAAI/AAAAAAAAAH4/ZtxDyebhZuk/photo.jpg?sz=128", "display_name": "Punter", "link": "https://stackoverflow.com/users/11830784/punter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57188851, "answer_count": 1, "score": 1, "last_activity_date": 1563991482, "creation_date": 1563977169, "last_edit_date": 1563991482, "question_id": 57184882, "link": "https://stackoverflow.com/questions/57184882/ms-word-updating-links-why-does-changing-a-linkformat-property-reset-field-ind", "title": "MS Word updating links: Why does changing a .LinkFormat property reset field Index", "body": "<p>I hope my first post will be OK and not offend (I've tried to follow the guide and done a lot of searching).</p>\n\n<p>I've modified the below code from Greg Maxey (<a href=\"https://gregmaxey.com/word_tip_pages/word_fields.html\" rel=\"nofollow noreferrer\">https://gregmaxey.com/word_tip_pages/word_fields.html</a>) to update links in my Word document to an Excel workbook.  It seems to be the most used code for this purpose.  The reason I changed his code was to try to do away with the need to have a counter variable like i, and using a <code>For i = 1 to .Fields.Count Then... Next i</code> structure.</p>\n\n<p>When I run it as is, it gets stuck in a loop only updating the first field in the Word document.  To see this, I put in the <code>Debug.Print wrdField.Index</code> line.  It repeatedly outputs 1, so it is not moving to the <code>Next wrdField</code> as I expect (the code actually just used <code>Next</code>, but it's the same result if I use <code>Next wrdField</code>).</p>\n\n<p>When I comment out <code>.AutoUpdate = False</code>, it works properly:</p>\n\n<pre><code>Public Sub UpdateExternalLinksToCurrentFolder()\n\nDim wrdDocument As Word.Document\nDim wrdField As Word.Field\nDim strCurrentLinkedWorkbookPath, strNewLinkedWorkbookPath As String\nDim strCurrentLinkedWorkbookName, strNewLinkedWorkbookName As String\nDim strCurrentLinkedWorkbookFullName, strNewLinkedWorkbookFullName As String\nDim strThisDocumentPath As String\n\n'On Error GoTo ErrorHandler_UpdateExternalLinksToCurrentFolder\n\nApplication.ScreenUpdating = False\n\nSet wrdDocument = ActiveDocument\nstrThisDocumentPath = wrdDocument.Path &amp; Application.PathSeparator\nstrNewLinkedWorkbookPath = strThisDocumentPath\n\n\nWith wrdDocument\n    For Each wrdField In .Fields\n       With wrdField\n            If .Type = wdFieldLink Then\n                With .LinkFormat\n\n                     Debug.Print wrdField.Index\n\n                     strCurrentLinkedWorkbookPath = .SourcePath &amp; Application.PathSeparator\n                     strCurrentLinkedWorkbookName = .SourceName\n                     strNewLinkedWorkbookName = strCurrentLinkedWorkbookName\n                     strNewLinkedWorkbookFullName = strNewLinkedWorkbookPath &amp; strNewLinkedWorkbookName\n                    .AutoUpdate = False\n                End With\n            .Code.Text = VBA.Replace(.Code.Text, Replace(strCurrentLinkedWorkbookPath, \"\\\", \"\\\\\"), Replace(strNewLinkedWorkbookPath, \"\\\", \"\\\\\"))\n            End If\n        End With\n    Next\nEnd With\n\n\nSet wrdDocument = Nothing\nApplication.ScreenUpdating = True\n\nExit Sub\n</code></pre>\n\n<p>Can anyone tell my why it's behaving this way?  When I set <code>.AutoUpdate = False</code>, am I changing something about the link field or doing something to the Word document that causes the .wrdField.Index to reset to 1?  I can't find anything online documenting this behavior and it's driving me nuts.</p>\n"}, {"tags": ["excel", "vba", "escaping", "filepath"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563977347, "post_id": 57184788, "comment_id": 100880281, "body": "Double the quotes. <code>&quot;&quot;</code> in the string literal when you want <code>&quot;</code> in the string path."}, {"owner": {"reputation": 17, "user_id": 11589585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d043a2d56cd344a65545377a799ca2af?s=128&d=identicon&r=PG&f=1", "display_name": "terrahawk80", "link": "https://stackoverflow.com/users/11589585/terrahawk80"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1563977448, "post_id": 57184788, "comment_id": 100880340, "body": "thanks, I have tried that too but doesn&#39;t seem to work when adding double quotes around the <code>firstFilePath</code> and <code>secondFilePath</code> strings ?"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11589585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d043a2d56cd344a65545377a799ca2af?s=128&d=identicon&r=PG&f=1", "display_name": "terrahawk80", "link": "https://stackoverflow.com/users/11589585/terrahawk80"}, "edited": false, "score": 0, "creation_date": 1563977882, "post_id": 57185004, "comment_id": 100880590, "body": "doesn&#39;t seem to work for me, that doesn&#39;t write out the log file either for some reason."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 17, "user_id": 11589585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d043a2d56cd344a65545377a799ca2af?s=128&d=identicon&r=PG&f=1", "display_name": "terrahawk80", "link": "https://stackoverflow.com/users/11589585/terrahawk80"}, "edited": false, "score": 0, "creation_date": 1563978065, "post_id": 57185004, "comment_id": 100880708, "body": "You may have to wrap the whole command in quote marks as well - try with my update (just edited)"}, {"owner": {"reputation": 17, "user_id": 11589585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d043a2d56cd344a65545377a799ca2af?s=128&d=identicon&r=PG&f=1", "display_name": "terrahawk80", "link": "https://stackoverflow.com/users/11589585/terrahawk80"}, "edited": false, "score": 1, "creation_date": 1563978294, "post_id": 57185004, "comment_id": 100880839, "body": "dude, that&#39;s awesome and working like a treat now :) thanks so much for quick reply."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1563978047, "last_edit_date": 1563978047, "creation_date": 1563977556, "answer_id": 57185004, "question_id": 57184788, "link": "https://stackoverflow.com/questions/57184788/using-wsh-run-in-vba-with-spaces-in-filepath/57185004#57185004", "title": "Using &#39;wsh.Run&#39; in VBA with spaces in filepath", "body": "<p>Use this for your <code>cmd1</code> line</p>\n\n<pre><code>cmd1 = \"\"\"\"\"\" &amp; firstFilePath &amp; \"\"\" -s:\"\"\" &amp; strFilePath &amp; \"\"\" -xsl:\"\"\" &amp; secondFilePath &amp; \"\"\" -o:\"\"\" &amp; outfile &amp; \".csv\"\" &gt; \"\"\" &amp; logfile &amp; \"\"\" 2&gt;&amp;1\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11589585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d043a2d56cd344a65545377a799ca2af?s=128&d=identicon&r=PG&f=1", "display_name": "terrahawk80", "link": "https://stackoverflow.com/users/11589585/terrahawk80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57185004, "answer_count": 1, "score": 0, "last_activity_date": 1563978047, "creation_date": 1563976922, "question_id": 57184788, "link": "https://stackoverflow.com/questions/57184788/using-wsh-run-in-vba-with-spaces-in-filepath", "title": "Using &#39;wsh.Run&#39; in VBA with spaces in filepath", "body": "<p>I am having trouble with using the WSH.run command and escaping the spaces in the filepath - it works fine without spaces! I have tried using double, triple and quadruple quotation marks around each parameter/filepath but it does not like the filepath when the cmd shell is called from the VBA script. This is the script without any escaping:</p>\n\n<pre><code>Dim strFilePath As String\nDim xslFilePath As String\nDim RetVal\n\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\n\nfirstFilePath = \"C:\\Program Files\\myprogram.exe\"\nsecondFilePath = \"C:\\Program Files\\stylesheet.xsl\"\n\nstrfilepath = \"D:\\outputfiles\\out.xls\"\noutpath = Mid(strFilePath, InStrRev(strFilePath, \"\\\") + 1)\noutfile = Left(strFilePath, InStrRev(strFilePath, \".\") - 1)\nlogfile = outfile &amp; \"_errors.log\"\n\ncmd1 = firstFilePath &amp; \" -s:\" &amp; strFilePath &amp; \" -xsl:\" &amp; secondFilePath &amp; \" -o:\" &amp; outfile &amp; \".csv &gt; \" &amp; logfile &amp; \" 2&gt;&amp;1\"\n\nwsh.Run \"cmd /c /s\" &amp; cmd1, 2, True\n</code></pre>\n\n<p>When I run the following via the command-line with the escaped filepaths the command completes successfully, so I am not sure why this is not working in Excel when it is called with the same escaping applied?</p>\n\n<pre><code>\"C:\\Program Files\\myprogram.exe\" -s:\"D:\\outputfiles\\out.xls\" -xsl:\"C:\\Program Files\\stylesheet.xsl\" -o:\"D:\\outputfiles\\out.csv\" &gt; \"D:\\outputfiles\\out_errors.log\" 2&gt;&amp;1\n</code></pre>\n\n<p>Any advice or help appreciated.</p>\n"}, {"tags": ["excel", "vba", "wait"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1563978310, "post_id": 57184753, "comment_id": 100880854, "body": "What do you mean when you say that Excel freezes? Does the macro actually stop executing? It sounds like the macro is just running normally, and adding a <code>wait</code> forces the macro to slow down and use less system resources. Excel &#39;freezing&#39; doesn&#39;t necessarily mean anything bad is happening, it just means it&#39;s busy doing something. Whether or not that something is what you actually want it to do is another question."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1563978429, "post_id": 57184753, "comment_id": 100880932, "body": "@JoshEller It acts like it&#39;s in an infinite loop, so I have to close the application.  I understand that it works well, however, I would just like to not have to use a <code>wait</code>."}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1563978637, "post_id": 57184753, "comment_id": 100881099, "body": "What is your code meant to do? Do you intend it to be an infinite loop?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1563978915, "post_id": 57184753, "comment_id": 100881279, "body": "No, I intend for it to run just as it does with the <code>wait</code>, but without needing the <code>wait</code>"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563976824, "creation_date": 1563976824, "question_id": 57184753, "link": "https://stackoverflow.com/questions/57184753/excel-freezes-without-use-of-wait", "title": "Excel freezes without use of Wait", "body": "<p>When I run my code, it freezes, however it will work when I insert <code>Application.Wait (Now + TimeValue(\"0:00:02\"))</code>, it works perfectly.  I am just wondering why it does that.  This is the first time something like this has happened.  Any help would be appreciated.  Thanks!</p>\n\n<pre><code>Public Sub Run()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Call Import\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Import()\n    Dim fd As FileDialog\n    Dim FileChosen As Integer\n    Dim FileName As String\n    Dim tempWB As Workbook\n\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    fd.InitialFileName = \"X:\\Dump Report for Loans\"\n    fd.InitialView = msoFileDialogViewList\n    fd.AllowMultiSelect = True\n\n    FileChosen = fd.Show\n    If FileChosen = -1 Then\n        Call Sort\n        Application.Wait (Now + TimeValue(\"0:00:02\")) 'Heres where it trips\n        Call Save_As\n    Else:\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Sort()\n    Dim fd As FileDialog\n    Dim tempWB As Workbook\n    Dim i As Integer\n\n    Dim rwCnt As Long\n    Dim rngSrt As Range\n    Dim shRwCnt As Long\n\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    For i = 1 To fd.SelectedItems.Count\n\n        Set tempWB = Workbooks.Open(fd.SelectedItems(i))\n\n        With tempWB.Worksheets(1)\n\n            rwCnt = .Cells(Rows.Count, 1).End(xlUp).Row\n            If .Range(\"A1\") &lt;&gt; \"* as of *\" Then\n                If .Cells(rwCnt - 1, 1).NumberFormat = \"mmm d, yyyy\" Then\n                    .Range(\"A1\") = .Range(\"A1\").Value &amp; \" as of \" &amp; .Cells(rwCnt - 1, 1)\n                    .Rows(rwCnt - 1 &amp; \":\" &amp; rwCnt).Delete shift:=xlShiftUp\n                    rwCnt = rwCnt - 2\n                End If\n            End If\n\n            Set rngSrt = .Range(\"A2:AR\" &amp; rwCnt)\n\n            With .Sort\n                .SortFields.Clear\n                .SortFields.Add Key:=Range(\"E2:E\" &amp; rwCnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n                .SetRange rngSrt\n                .Header = xlYes\n                .MatchCase = False\n                .Orientation = xlTopToBottom\n                .SortMethod = xlPinYin\n                .Apply\n            End With\n\n            .Columns(\"F:F\").Insert shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\n            For x = rwCnt To 4 Step -1\n                .Cells(x, 6).Value2 = (.Cells(x, 5).Value2 - .Cells(x - 1, 5).Value2)\n            Next x\n\n            For Z = rwCnt To 3 Step -1\n                If .Cells(Z, 6).Value = 0 Then\n                    .Rows(Z).Delete shift:=xlShiftUp\n                End If\n            Next Z\n\n            .Columns(\"F:F\").Delete\n\n            .Columns(\"A:AR\").AutoFit\n\n            Organize fd, tempWB, i, rwCnt\n            Summary fd, tempWB, i\n\n        End With\n    Next i\n\n    tempWB.Worksheets(2).Activate\n    tempWB.Worksheets(1).Visible = xlSheetHidden      \nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Organize(fd As FileDialog, tempWB As Workbook, i As Integer, rwCnt As Long)\n    Dim rngSrt As Range\n    Dim shRwCnt As Long\n\n        With tempWB.Worksheets(1)\n\n            rwCnt = .Cells(Rows.Count, 1).End(xlUp).Row\n            .Range(\"A1\") = .Range(\"A1\").Value &amp; \" as of \" &amp; .Cells(rwCnt - 1, 1)\n            .Rows(rwCnt - 1 &amp; \":\" &amp; rwCnt).Delete shift:=xlShiftUp\n            rwCnt = rwCnt - 2\n\n            Set rngSrt = .Range(\"A2:AR\" &amp; rwCnt)\n\n            With .Sort\n                .SortFields.Clear\n                .SortFields.Add Key:=Range(\"AR2:AR\" &amp; rwCnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n                .SortFields.Add Key:=Range(\"E2:E\" &amp; rwCnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n                .SetRange rngSrt\n                .Header = xlYes\n                .MatchCase = False\n                .Orientation = xlTopToBottom\n                .SortMethod = xlPinYin\n                .Apply\n            End With\n\n            For x = rwCnt To 3 Step -1\n                If .Cells(x, 5).Value = .Cells(x - 1, 5).Value Then\n                    .Rows(x).Delete shift:=xlShiftUp\n                End If\n            Next x\n\n            rwCnt = .Cells(Rows.Count, 1).End(xlUp).Row\n\n            For y = 3 To rwCnt\n                Dim WsDest As Worksheet\n                Set WsDest = Nothing\n                On Error Resume Next 'try to find the worksheet\n                Set WsDest = Worksheets(Left$(.Cells(y, 44).Value, 31)) 'worksheet names are limited to 31 characters\n                On Error GoTo 0 're-activate error reporting\n\n                If WsDest Is Nothing Then 'if ws does not exist\n                    'add this sheet name it and copy/paste\n                    Set WsDest = Worksheets.Add(, Worksheets(Sheets.Count))\n                    WsDest.Name = Left$(.Cells(y, 44).Value, 31) 'worksheet names are limited to 31 characters\n\n                    .Range(\"A1:AR2\").Copy\n                    WsDest.Cells(1, 1).PasteSpecial Paste:=xlPasteAllUsingSourceTheme, _\n                        Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    .Rows(y).Copy\n                    WsDest.Cells(3, 1).PasteSpecial Paste:=xlPasteAllUsingSourceTheme, _\n                        Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    WsDest.Tab.ColorIndex = 3\n                    WsDest.Columns(\"A:AR\").AutoFit\n                Else\n                    'find last used row and copy/paste\n                    shRwCnt = WsDest.Cells(WsDest.Rows.Count, 1).End(xlUp).Row\n\n                    .Rows(y).Copy\n                    WsDest.Cells(shRwCnt + 1, 1).PasteSpecial Paste:=xlPasteAllUsingSourceTheme, _\n                        Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    WsDest.Columns(\"A:AR\").AutoFit\n                End If\n\n            Next y\n\n            .Columns(\"A:AR\").AutoFit\n\n        End With\n\n    tempWB.Worksheets(1).Activate      \nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Summary(fd As FileDialog, tempWB As Workbook, i As Integer)\n    Dim x As Integer\n    Dim wb As Workbook: Set wb = tempWB\n    Dim strName As String: strName = \"Summary\"\n    Dim ws As Worksheet\n    Set ws = wb.Sheets.Add(Type:=xlWorksheet, after:=wb.Worksheets(1))\n    Dim rwCnt As Long\n    Dim PCsht As Worksheet\n\n    With ws\n        .Name = strName\n\n        For x = 3 To Sheets.Count\n            Set PCsht = tempWB.Worksheets(x)\n            rwCnt = PCsht.Cells(Rows.Count, 1).End(xlUp).Row\n            .Cells(x, 1) = PCsht.Name\n            .Cells(x, 2) = WorksheetFunction.Sum(Range(PCsht.Cells(3, 11), PCsht.Cells(rwCnt, 11)))\n        Next x\n\n        .Cells(2, 1) = \"Purpose Code\"\n        .Cells(2, 2) = \"Net Active Principle Balance\"\n        .Cells(Sheets.Count + 1, 1) = \"TOTAL\"\n        .Cells(Sheets.Count + 1, 2) = WorksheetFunction.Sum(Range(ws.Cells(3, 2), ws.Cells(Sheets.Count, 2)))\n        .Columns(\"A:B\").AutoFit\n        .Range(.Cells(3, 2), Cells(Sheets.Count + 1, 2)).NumberFormat = \"$#,##0.00\"\n\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Save_As()\n    Dim bFileSaveAs As Boolean\n    bFileSaveAs = Application.Dialogs(xlDialogSaveAs).Show\n    If Not bFileSaveAs Then MsgBox \"User cancelled\", vbCritical\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563976597, "post_id": 57184377, "comment_id": 100879760, "body": "What is the column&#39;s name which contain currency and what is the column&#39;s names which contains text ?"}, {"owner": {"reputation": 23, "user_id": 11830695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48dc156bc2e7e88dca89cd3461a51da7?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/11830695/mat"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563977040, "post_id": 57184377, "comment_id": 100880058, "body": "The column with currency is column T and the Column with text is column N and I am looking to only match the first four letters in column N. Sorry about the confusion"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563977680, "post_id": 57184377, "comment_id": 100880463, "body": "Hope my <a href=\"https://stackoverflow.com/a/57184972/11167163\">Answer</a>  is working as excepted, do not hesitate to give me feedbacks so i can improve my <a href=\"https://stackoverflow.com/a/57184972/11167163\">Answer</a>"}], "owner": {"reputation": 23, "user_id": 11830695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48dc156bc2e7e88dca89cd3461a51da7?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/11830695/mat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1569503224, "creation_date": 1563975715, "last_edit_date": 1563976194, "question_id": 57184377, "link": "https://stackoverflow.com/questions/57184377/extracting-duplicates-from-two-columns", "title": "Extracting Duplicates from two columns", "body": "<p>I want to find duplicates in two separate columns and extract only those that have duplicates in both of these columns to another worksheet. I want to compare these columns to themselves and find duplicates within the same column. Any advice about how to go about this. \nOne column contains currency and another contains text. I added apicture for clarification,but this is is what I have tried so far:</p>\n\n<pre><code>Sub match()\nDim wstSource As Worksheet, _\n    wstOutput As Worksheet\nDim rngMyData As Range, _\n    helperRng As Range\n\nSet wstSource = Worksheets(\"Sheet1\")\nSet wstOutput = Worksheets(\"Sheet2\")\n\nWith wstSource\n    Set rngMyData = .Range(\"A1:AC\" &amp; .Range(\"T\" &amp; .Rows.Count) &amp; .Range(Left(\"N\", 4) &amp; .Rows.Count).End(xlUp).Row)\nEnd With\nSet helperRng = rngMyData.Offset(, rngMyData.Columns.Count + 1).Resize(, 1)\n\nWith helperRng\n    .FormulaR1C1 = \"=if(countif(C20,RC20)&gt;1,\"\"\"\",1)\"\n    .Value = .Value\n    .SpecialCells(xlCellTypeBlanks).EntireRow.Copy Destination:=wstOutput.Cells(2, 1)\n    .ClearContents\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IA0ip.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IA0ip.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563975859, "post_id": 57184202, "comment_id": 100879269, "body": "i don&#39;t think you even Need those Lines. Can&#39;t you remove them ?"}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563976196, "post_id": 57184202, "comment_id": 100879495, "body": "I know I can remove <code>Application.Visible = False</code> and sleep well but it just looks more cool when Excel is not visible and all these operations with Visible and password protection are happening in the background."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1563977983, "post_id": 57184202, "comment_id": 100880658, "body": "Instead of hiding the app, why not turn off screen updating?"}], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563978878, "post_id": 57185317, "comment_id": 100881258, "body": "Good one! Is there any possibility to disable completely built-in dialog so user will see only this one? Now after this one comes built-in dialog box."}, {"owner": {"reputation": 51668, "user_id": 306651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea09548513a626ee8166f6be61118354?s=128&d=identicon&r=PG", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/306651/hans-olsson"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563980015, "post_id": 57185317, "comment_id": 100881929, "body": "@user7202022 If there aren&#39;t any unsaved changes I don&#39;t think the built in dialog should pop up, so the <code>ActiveWorkbook.Close savechanges:=answer = vbYes</code> line is supposed to make sure that any changes are saved or abandoned before it gets to the built in one. Is it possible that your code is changing the workbook in some way after that line? It worked for me in a very basic test."}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563980931, "post_id": 57185317, "comment_id": 100882467, "body": "I have added application.displayalerts command. Build in dialog is popping up when I press cancel. If I use Yes or No, then everything is fine."}, {"owner": {"reputation": 51668, "user_id": 306651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea09548513a626ee8166f6be61118354?s=128&d=identicon&r=PG", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/306651/hans-olsson"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563981688, "post_id": 57185317, "comment_id": 100882882, "body": "@user7202022 Did you keep the bit about setting Cancel to true if it&#39;s cancelled?  The line: <code>Cancel = True</code> Otherwise I&#39;m not sure I&#39;m afraid"}], "tags": [], "owner": {"reputation": 51668, "user_id": 306651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea09548513a626ee8166f6be61118354?s=128&d=identicon&r=PG", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/306651/hans-olsson"}, "is_accepted": true, "score": 1, "last_activity_date": 1563978559, "creation_date": 1563978559, "answer_id": 57185317, "question_id": 57184202, "link": "https://stackoverflow.com/questions/57184202/closing-workbook-catch-cancel-event/57185317#57185317", "title": "Closing workbook, catch Cancel event", "body": "<p>Instead of relying on the built-in dialog, try using your own. That way you have more control of what happens and when.</p>\n\n<p>So maybe something like:</p>\n\n<pre><code>Dim closing As Boolean\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    If Not closing Then\n        answer = MsgBox(\"Save data?\", vbYesNoCancel + vbQuestion, \"Save data?\")\n\n        If answer = vbYes Or answer = vbNo Then\n            closing = True\n            ' your code here\n            ActiveWorkbook.Close savechanges:=answer = vbYes\n        Else\n            Cancel = True\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57185317, "answer_count": 1, "score": 0, "last_activity_date": 1564039785, "creation_date": 1563975222, "last_edit_date": 1564039785, "question_id": 57184202, "link": "https://stackoverflow.com/questions/57184202/closing-workbook-catch-cancel-event", "title": "Closing workbook, catch Cancel event", "body": "<p>I have code for <code>Workbook_BeforeClose</code> event. I like how it works now but I have just noticed a problem with <code>Application.Visible = False</code>. When I click Yes, it saves Workbook, when I click No, it does nothing, but when I click Cancel it already done <code>Application.Visible = False</code> and I can't see Excel application. How to fix that? </p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\nOn Error Resume Next\n\n        Application.Visible = False\n\n        Application.DisplayFormulaBar = True\n        ActiveWindow.DisplayHeadings = True\n        ActiveWindow.DisplayGridlines = True\n\n        ThisWorkbook.Unprotect Password:=\"123456\"\n\n        ActiveWorkbook.Sheets(\"Start\").Visible = True\n\n        ThisWorkbook.Worksheets(\"Start\").Activate\n\n        ThisWorkbook.Protect Password:=\"123456\", Structure:=True, Windows:=False\n\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "oauth-2.0", "xmlhttprequest"], "comments": [{"owner": {"reputation": 4945, "user_id": 1891133, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/DHTbb.png?s=128&g=1", "display_name": "Max", "link": "https://stackoverflow.com/users/1891133/max"}, "edited": false, "score": 0, "creation_date": 1563976890, "post_id": 57184168, "comment_id": 100879962, "body": "Can you add more details ? <i>I need to get an access token from the api</i> Witch api ? Do you have the app registered ? I think you do not know the oAuth2 protocol. I suggest you to read <a href=\"https://oauth.net/2/\" rel=\"nofollow noreferrer\">oAuth documentation</a>"}, {"owner": {"reputation": 1, "user_id": 11809471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a6a5cc336f698eed38898a15a12bc66?s=128&d=identicon&r=PG&f=1", "display_name": "NoahPW", "link": "https://stackoverflow.com/users/11809471/noahpw"}, "reply_to_user": {"reputation": 4945, "user_id": 1891133, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/DHTbb.png?s=128&g=1", "display_name": "Max", "link": "https://stackoverflow.com/users/1891133/max"}, "edited": false, "score": 0, "creation_date": 1563998209, "post_id": 57184168, "comment_id": 100890540, "body": "@Max I do know the oauth2.0 protocol. The API  is very clearly listed within the code as &#39;<a href=\"https://api.channeladvisor.com\" rel=\"nofollow noreferrer\">api.channeladvisor.com</a>&#39; My issue seems to be this. I am trying to run this code in excel VBA. Having done testing in Postman before, I can say that it normally pops up with a window that requires you to log in to channeladvisors website. This is not something that happens in VBA, and so instead my returned output is the <i>error: invalid client</i>"}], "owner": {"reputation": 1, "user_id": 11809471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a6a5cc336f698eed38898a15a12bc66?s=128&d=identicon&r=PG&f=1", "display_name": "NoahPW", "link": "https://stackoverflow.com/users/11809471/noahpw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563976465, "creation_date": 1563975107, "last_edit_date": 1563976465, "question_id": 57184168, "link": "https://stackoverflow.com/questions/57184168/how-to-get-around-logging-in-when-sending-http-request", "title": "How to get around logging in when sending HTTP Request", "body": "<p>I need to get an access token from the <code>api</code>, however when going to retrieve it using the <code>http</code> request, I continue getting an </p>\n\n<blockquote>\n  <p>\"error: bad client\". </p>\n</blockquote>\n\n<p>I have nailed this down to it being used to having a login window popping up and the user logging in to authenticate themselves. My filemma is that I am not exactly sure how to make that happen.</p>\n\n<p>I have tried to send the username and password as  variables for the login page to read, but that has not worked. I have also tried to make vba open up internet explorer and login before sending the request. Neither of these has worked out very well.</p>\n\n<pre><code>Sub grabNewAccessToken()\nDim xmlhttp As Object\nSet xmlhttp = CreateObject(\"MSXML2.ServerXMLHTTP.6.0\")\n\n\nDim accessToken As String\n\nURL1 = \"https://api.channeladvisor.com/oauth2/token\"\n\nxmlhttp.Open \"POST\", URL1, False\n\nxmlhttp.setRequestHeader \"access_type\", \"offline\"\nxmlhttp.setRequestHeader \"Authorization\", \"Basic [client secret]\"\nxmlhttp.setRequestHeader \"Content-Type\", \"application/x-www-form- urlencoded\"\nxmlhttp.setRequestHeader \"Body\", \"grant_type=refresh_token&amp;refresh_token=xxxxxx\"\nxmlhttp.send\n\naccessToken = xmlhttp.responseText\nWorksheets(\"Sheet3\").Range(\"A1\").Value = accessToken\nEnd Sub\n</code></pre>\n\n<p>The best case scenario is that it returns an access token from my API to a cell in the worksheet. What is currently happening is me receiving</p>\n\n<blockquote>\n  <p>\"error: invalid client\"</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1563974930, "post_id": 57183893, "comment_id": 100878752, "body": "Without creating a file to test, this looks like it should work. Does it not currently?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1564148088, "post_id": 57183893, "comment_id": 100946550, "body": "may as well pop it into the &quot;answer&quot; box below :)"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10613419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc3a091b8f0685b4817ac6752653acb5?s=128&d=identicon&r=PG", "display_name": "Dinc Kirikci", "link": "https://stackoverflow.com/users/10613419/dinc-kirikci"}, "is_accepted": true, "score": 0, "last_activity_date": 1570005113, "creation_date": 1570005113, "answer_id": 58197946, "question_id": 57183893, "link": "https://stackoverflow.com/questions/57183893/how-to-import-a-bas-file-into-excel-by-using-vbs/58197946#58197946", "title": "How to import a .bas file into excel by using .vbs", "body": "<p>I found it! I'm sharing this, because someone may get help from it:\nobjExcel.VBE.ActiveVBProject.VBComponents.Import \"C:\\Users...\\Desktop\\ModuleName\\ModuleName.bas\"</p>\n"}], "owner": {"reputation": 11, "user_id": 10613419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc3a091b8f0685b4817ac6752653acb5?s=128&d=identicon&r=PG", "display_name": "Dinc Kirikci", "link": "https://stackoverflow.com/users/10613419/dinc-kirikci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 58197946, "answer_count": 1, "score": 0, "last_activity_date": 1570005113, "creation_date": 1563974229, "last_edit_date": 1563974748, "question_id": 57183893, "link": "https://stackoverflow.com/questions/57183893/how-to-import-a-bas-file-into-excel-by-using-vbs", "title": "How to import a .bas file into excel by using .vbs", "body": "<p>What I'd like to do is:</p>\n\n<ul>\n<li><p>By using a .vbs file opening an excel file</p></li>\n<li><p>importing a .bas file to that file (automatically, by using code)</p></li>\n<li><p>run the particular sub that I wrote in that .bas file (VGEL is the name of the sub)</p></li>\n<li><p>Close the excel file</p></li>\n</ul>\n\n<p>All the processes must be done by using the code. I share the code of .vbs file. Can anyone help me about it? Please....</p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\n\nSet book = objExcel.Workbooks.Open(\"C:\\Users\\ali.kirikci\\Desktop\\Cross Rate\\CrossRate.xlsm\",TRUE)\n\nobjExcel.Application.Run \"'C:\\Users\\ali.kirikci\\Desktop\\Cross Rate\\CrossRate.xlsm'!Module12.VGEL\"\n\nobjExcel.DisplayAlerts = False\n\nobjExcel.Application.Quit\n\nSet objExcel = Nothing\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563974481, "post_id": 57183772, "comment_id": 100878494, "body": "According to the Link, it says the Shape should be <b>FreeForm Drawing</b>, is that true in your case ? I tried it, and the code works on a freeform drawing. But not on any other shape."}, {"owner": {"reputation": 318, "user_id": 4062978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoS6v.jpg?s=128&g=1", "display_name": "Argut", "link": "https://stackoverflow.com/users/4062978/argut"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564040289, "post_id": 57183772, "comment_id": 100901790, "body": "@Mikku, sure, it is a FreeForm.  Otherwise the Code would not be working in PowerPoint and Excel, as you (and I) noticed already."}, {"owner": {"reputation": 318, "user_id": 4062978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoS6v.jpg?s=128&g=1", "display_name": "Argut", "link": "https://stackoverflow.com/users/4062978/argut"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564040415, "post_id": 57183772, "comment_id": 100901862, "body": "@Mikku, could you please provide the conditions under which the Code worked for you?  I mean primarily the MS Word version and language"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564040515, "post_id": 57183772, "comment_id": 100901915, "body": "I am using Office 365"}, {"owner": {"reputation": 318, "user_id": 4062978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoS6v.jpg?s=128&g=1", "display_name": "Argut", "link": "https://stackoverflow.com/users/4062978/argut"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564040777, "post_id": 57183772, "comment_id": 100902047, "body": "Impressing!  This means that the problem is fixed in online MS Word version.  I wonder whether it is fixed on modern desktop versions like 2016 and 2019"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564040954, "post_id": 57183772, "comment_id": 100902151, "body": "No I am using Desktop version only. But it is Office 365, doesn&#39;t say if it is 2016 or 19. Should be the latest one"}], "owner": {"reputation": 318, "user_id": 4062978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eoS6v.jpg?s=128&g=1", "display_name": "Argut", "link": "https://stackoverflow.com/users/4062978/argut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563973815, "creation_date": 1563973815, "question_id": 57183772, "link": "https://stackoverflow.com/questions/57183772/points-property-of-shapenode-fails-in-ms-word", "title": "Points property of ShapeNode fails in MS Word", "body": "<p>The Code below implements the example presented in the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.shapenode.points\" rel=\"nofollow noreferrer\">Microsoft ShapeNode.Points property (Word) article</a>:</p>\n\n<pre><code>Sub Test()\nDim PointsArray\nDim myDocument As Document\nDim currXvalue As Single\nDim currYvalue As Single\n\n    Set myDocument = ActiveDocument\n    With myDocument.Shapes(3).Nodes\n        PointsArray = .Item(2).Points\n        currXvalue = PointsArray(1, 1)\n        currYvalue = PointsArray(1, 2)\n        .SetPosition 2, currXvalue + 200, currYvalue + 300\n    End With\nEnd Sub\n</code></pre>\n\n<p>Execution of the line 3 generates the RTE 13 (Type Mismatch).  According to the Watch panel,</p>\n\n<ul>\n<li>the type of the Points property is the array of Single (which is\ncorrect)</li>\n<li>the type of the <code>myDocument.Shapes(3).Nodes.Item(2).Points</code>\nexpression is Integer</li>\n</ul>\n\n<p>See the screenshot below:\n<a href=\"https://i.stack.imgur.com/xjrRi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xjrRi.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Verified on MS Word 2007.  <a href=\"https://stackoverflow.com/questions/52197069/ms-word-shapenode-coordinates-cannot-obtain\">A problem of this kind</a> exists for Word 2010.  However, it was verified that the problem does not exist for MS PowerPoint 2007 and MS Excel 2007.  </p>\n\n<p>Seems to be an error in the Word object model.  Can you please suggest a workaround?</p>\n"}, {"tags": ["excel", "vba", "listobject"], "comments": [{"owner": {"reputation": 431, "user_id": 9476917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5NET.jpg?s=128&g=1", "display_name": "Maeaex1", "link": "https://stackoverflow.com/users/9476917/maeaex1"}, "edited": false, "score": 2, "creation_date": 1563973739, "post_id": 57183657, "comment_id": 100878083, "body": "This is due to the fact that you name it like a cell range in your worksheet. E.g. &quot;BAB002&quot; refers to cell BAB2 in a sheet."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 431, "user_id": 9476917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5NET.jpg?s=128&g=1", "display_name": "Maeaex1", "link": "https://stackoverflow.com/users/9476917/maeaex1"}, "edited": false, "score": 0, "creation_date": 1563973837, "post_id": 57183657, "comment_id": 100878143, "body": "Yes, as @Maeaex1 said. The Names Conflict with other Cell Names in the Sheet. That&#39;s why you can&#39;t name it."}, {"owner": {"reputation": 138, "user_id": 9385654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3ade2e3dd447cc75d45e327206c02d?s=128&d=identicon&r=PG&f=1", "display_name": "Sane_or_not", "link": "https://stackoverflow.com/users/9385654/sane-or-not"}, "edited": false, "score": 0, "creation_date": 1563973906, "post_id": 57183657, "comment_id": 100878181, "body": "so it ignores multiple zeros in referencing?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563973959, "post_id": 57183657, "comment_id": 100878211, "body": "Yes.. To try put the name in the Cell Reference ( Left Top corner of Worksheet), it will take you to the Cell"}, {"owner": {"reputation": 138, "user_id": 9385654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3ade2e3dd447cc75d45e327206c02d?s=128&d=identicon&r=PG&f=1", "display_name": "Sane_or_not", "link": "https://stackoverflow.com/users/9385654/sane-or-not"}, "edited": false, "score": 0, "creation_date": 1563974055, "post_id": 57183657, "comment_id": 100878262, "body": "Thank you! That was the problem."}], "answers": [{"tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1564519208, "last_edit_date": 1564519208, "creation_date": 1563979630, "answer_id": 57185658, "question_id": 57183657, "link": "https://stackoverflow.com/questions/57183657/vba-listobject-inconsistent-naming-rules-when-using-a-macro-puts-underscores-at/57185658#57185658", "title": "VBA ListObject inconsistent naming rules when using a macro (puts underscores at endings)", "body": "<p>The conclusion based on what Mikku &amp; Maeaex1 said, the table name is named in a convention that makes vba reference a cell \"BAB001\" due to ignoring the \"00\" within the name string.</p>\n\n<p>Solution: change naming convention that is not consistent with Excel's cell naming convention, such as starting the table name string with an underscore \" _ \" which will also give the added benefit of when you reference it within excel when you start and type \"=_\" a list of all your tables and named range will appear instead of other functions that start with the same letters.</p>\n"}], "owner": {"reputation": 138, "user_id": 9385654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3ade2e3dd447cc75d45e327206c02d?s=128&d=identicon&r=PG&f=1", "display_name": "Sane_or_not", "link": "https://stackoverflow.com/users/9385654/sane-or-not"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 57185658, "answer_count": 1, "score": 0, "last_activity_date": 1564519208, "creation_date": 1563973457, "question_id": 57183657, "link": "https://stackoverflow.com/questions/57183657/vba-listobject-inconsistent-naming-rules-when-using-a-macro-puts-underscores-at", "title": "VBA ListObject inconsistent naming rules when using a macro (puts underscores at endings)", "body": "<p>You can name your table \"my000\" but you can't name it \"my001\". You also can't name it \"bab002\", \"lal0101\" or anything similar.</p>\n\n<p>When using macros to create and rename tables I noticed that sometimes it puts underscore at the end of the table name (like myt001) with no valid reason. Excel prompts that a name should not be in conflict with existing name, start with number or include space or not allowed character. The names that I try  seem completely correct, by Excel changes them to for instance to \"my001_\", disrupting other parts of my spreadsheet.</p>\n\n<p>To reproduce: open blank Excel, create an empty table with Insert -> table then try to name it \"ba001\" or something similar. When trying to do the same with vba, it puts underscore at the end (\"ba001_\"), having no reason to do this.</p>\n\n<p>I expect vba to give the (supposedly) correct names to ListObjects. Instead it puts underscores at the endings in unexpected situations.</p>\n"}, {"tags": ["excel", "vba", "image"], "comments": [{"owner": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "edited": false, "score": 0, "creation_date": 1563972183, "post_id": 57183191, "comment_id": 100877157, "body": "When you try accessing the path <code>\\\\IPADDRESS\\folder\\fototest\\</code> in your PC, through the windows file browser, are you successful? Can you create a file there manually?"}, {"owner": {"reputation": 103, "user_id": 10101506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce7a73ed22604b5cbf592a136cabdd?s=128&d=identicon&r=PG&f=1", "display_name": "Francesco Bordignon", "link": "https://stackoverflow.com/users/10101506/francesco-bordignon"}, "reply_to_user": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "edited": false, "score": 0, "creation_date": 1563972459, "post_id": 57183191, "comment_id": 100877333, "body": "@KobyDouek no I can&#39;t access the path either through the file browser"}, {"owner": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "edited": false, "score": 1, "creation_date": 1563972526, "post_id": 57183191, "comment_id": 100877373, "body": "Then there&#39;s your problem right there. It&#39;s a permissions issue."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1563972553, "post_id": 57183191, "comment_id": 100877391, "body": "I was leaning towards an improperly formatted path, but yes, make it work in File Explorer first!"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 10101506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce7a73ed22604b5cbf592a136cabdd?s=128&d=identicon&r=PG&f=1", "display_name": "Francesco Bordignon", "link": "https://stackoverflow.com/users/10101506/francesco-bordignon"}, "edited": false, "score": 0, "creation_date": 1563972862, "post_id": 57183391, "comment_id": 100877552, "body": "How can I get the permissions to the folder?"}, {"owner": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "reply_to_user": {"reputation": 103, "user_id": 10101506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce7a73ed22604b5cbf592a136cabdd?s=128&d=identicon&r=PG&f=1", "display_name": "Francesco Bordignon", "link": "https://stackoverflow.com/users/10101506/francesco-bordignon"}, "edited": false, "score": 0, "creation_date": 1563972897, "post_id": 57183391, "comment_id": 100877569, "body": "@FrancescoBordignon You need to ask an administrator or the folder owner to grant your user full permissions."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1563972900, "post_id": 57183391, "comment_id": 100877570, "body": "Why would he need <code>write</code> and <code>execute</code> permission? Just <code>read</code> would be fine. How do you know it&#39;s a permission issue in the first place?"}, {"owner": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "reply_to_user": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 1, "creation_date": 1563972935, "post_id": 57183391, "comment_id": 100877594, "body": "@FreeSoftwareServers He&#39;s trying to <b>save</b> an image to this folder."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 1, "creation_date": 1563972974, "post_id": 57183391, "comment_id": 100877615, "body": "Fair enough! I thought he was loading it into the WB from the location, not saving it to the locaton"}], "tags": [], "owner": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "is_accepted": false, "score": 0, "last_activity_date": 1563972658, "creation_date": 1563972658, "answer_id": 57183391, "question_id": 57183191, "link": "https://stackoverflow.com/questions/57183191/how-to-insert-an-image-in-an-imagebox-through-path-on-a-server/57183391#57183391", "title": "How to insert an image in an imagebox through path on a server", "body": "<p>Your VBA crashes because of lack of permissions to the target directory. In order to use your <code>SavePicture</code> procedure, first you need <code>read write execute</code> permissions in the remote target directory, and to make sure you have access to this server if it's in a different domain.</p>\n"}], "owner": {"reputation": 103, "user_id": 10101506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce7a73ed22604b5cbf592a136cabdd?s=128&d=identicon&r=PG&f=1", "display_name": "Francesco Bordignon", "link": "https://stackoverflow.com/users/10101506/francesco-bordignon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563972658, "creation_date": 1563972018, "question_id": 57183191, "link": "https://stackoverflow.com/questions/57183191/how-to-insert-an-image-in-an-imagebox-through-path-on-a-server", "title": "How to insert an image in an imagebox through path on a server", "body": "<p>Hi I'm using thus code to load an image into an image box:</p>\n\n<pre><code>Dim ws As Worksheet, fname As String\nDim p As Object\n\n\n'~~&gt; Adding a temp sheet\nSet ws = ThisWorkbook.Sheets.Add\n\n'~~&gt; Insert the picture in the newly created worksheet\nfname = \"\\\\IPADDRESS\\folder\\fototest\\image.jpg\"\nSavePicture img.Picture, fname\nDoEvents\nSet p = ws.Pictures.Insert(fname)\n</code></pre>\n\n<p>the problem is that the image is located on a server that I reach through IP address and excel crashes because it can't reach the address.\nHow can I fix?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1563972027, "post_id": 57183110, "comment_id": 100877050, "body": "Your last code is using a formula on P2 then paste it&#39;s values to the whole column, is that your goal?"}, {"owner": {"reputation": 13, "user_id": 5793699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0cd91929b08ffe8f0d38b46f2ef88d?s=128&d=identicon&r=PG&f=1", "display_name": "Seb KB2", "link": "https://stackoverflow.com/users/5793699/seb-kb2"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1563972149, "post_id": 57183110, "comment_id": 100877136, "body": "Hi, Yes, correct. It uses a formula on P2, which is a table so it populates it until the end of the table (so the whole column), and I am attempting to paste this column to the same column, but as values. The column varies in length. Sorry if my explanation is not the best!"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1563972245, "post_id": 57183110, "comment_id": 100877202, "body": "You could just use <code>Sheets(&quot;Cancelations Temp&quot;).Range(&quot;P:P&quot;).Value = Sheets(&quot;Cancelations Temp&quot;).Range(&quot;P:P&quot;).Value</code> this will turn the whole column into values. I&#39;d suggest to also reference the workbook besides the worksheet. You can use <code>Worksheet</code> and <code>Workbook</code> variables."}, {"owner": {"reputation": 13, "user_id": 5793699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0cd91929b08ffe8f0d38b46f2ef88d?s=128&d=identicon&r=PG&f=1", "display_name": "Seb KB2", "link": "https://stackoverflow.com/users/5793699/seb-kb2"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1563972430, "post_id": 57183110, "comment_id": 100877315, "body": "Wouldn&#39;t that select the whole column and make my table infinite? I am going to attempt this now. Edit: You are completely correct, I do not know why I did not try this initially... I feel stupid! It keeps my table size the same, and only copies the values within the range. Thank you very much! I should have attempted the simple way first, didnt even think of it!"}, {"owner": {"reputation": 13, "user_id": 5793699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0cd91929b08ffe8f0d38b46f2ef88d?s=128&d=identicon&r=PG&f=1", "display_name": "Seb KB2", "link": "https://stackoverflow.com/users/5793699/seb-kb2"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1563972555, "post_id": 57183110, "comment_id": 100877393, "body": "Thanks again Damian, much appreciated, super fast response!!!! And sorry for the formatting issues! (And I will be adding references to the workbook also)"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1563972559, "post_id": 57183110, "comment_id": 100877398, "body": "There are better ways.. but this is fast and reliable. You could set a range by calculating the last row on your table and then do the same only within that range."}, {"owner": {"reputation": 13, "user_id": 5793699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0cd91929b08ffe8f0d38b46f2ef88d?s=128&d=identicon&r=PG&f=1", "display_name": "Seb KB2", "link": "https://stackoverflow.com/users/5793699/seb-kb2"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1563972765, "post_id": 57183110, "comment_id": 100877515, "body": "Yes, I was thinking of going that route if I didnt find another way (It&#39;s silly, but I hate calculating last rows, and setting range via variables), but your suggestion is ideal, I don&#39;t know why I assumed it would mess up table ranges. You learn something new everyday (And I feel a little dumb when it is such a simple thing!) Thanks Again!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5793699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0cd91929b08ffe8f0d38b46f2ef88d?s=128&d=identicon&r=PG&f=1", "display_name": "Seb KB2", "link": "https://stackoverflow.com/users/5793699/seb-kb2"}, "edited": false, "score": 0, "creation_date": 1563973155, "post_id": 57183504, "comment_id": 100877729, "body": "Amazing, Thank you so much, I might as well code it in properly now that I have the method, so two things learnt today! Thanks again Damian, amazing help!"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 1, "last_activity_date": 1563972985, "creation_date": 1563972985, "answer_id": 57183504, "question_id": 57183110, "link": "https://stackoverflow.com/questions/57183110/using-range-end-without-using-select/57183504#57183504", "title": "Using Range.End without using .select", "body": "<p>Here you go, to only turn the range you need:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim LastRow As Long\n\n    With ThisWorkbook.Sheets(\"Cancelations Temp\") 'using this you avoid the need to reference it again between the With\n        .Range(\"P2\").FormulaR1C1 = _\n            \"=IFERROR(IF(VLOOKUP([@[Policy Number]],Temp_Cancelations,6,FALSE)=\"\"MTC\"\",\"\"Canceled\"\",IF(VLOOKUP([@[Policy Number]],Temp_Cancelations,6,FALSE)=\"\"MTR\"\",\"\"Reinstated\"\",\"\"Not Canceled\"\")),\"\"\"\")\"\n        LastRow = .Cells(.Rows.Count, \"P\").End(xlUp).Row 'easy way to calculate the last row\n        .Range(\"P2\", .Cells(LastRow, \"P\")).Value = .Range(\"P2\", .Cells(LastRow, \"P\")).Value\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I'm assuming the workbook you are working is the one holding the code, hence the <code>ThisWorkbook</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5793699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0cd91929b08ffe8f0d38b46f2ef88d?s=128&d=identicon&r=PG&f=1", "display_name": "Seb KB2", "link": "https://stackoverflow.com/users/5793699/seb-kb2"}, "edited": false, "score": 0, "creation_date": 1563973448, "post_id": 57183523, "comment_id": 100877904, "body": "Thanks Gary&#39;s Student! Much appreciated, just as Damian mentioned above, I was resigning myself to not do it via a variable and calculating last row, but I just have to not be lazy and do it, much nicer. And not using copy / paste is defenitely less resource intensive, thanks!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1563973037, "creation_date": 1563973037, "answer_id": 57183523, "question_id": 57183110, "link": "https://stackoverflow.com/questions/57183110/using-range-end-without-using-select/57183523#57183523", "title": "Using Range.End without using .select", "body": "<p>This uses your suggested approach:</p>\n\n<pre><code>Sub KopyPaste()\n    Dim N As Long, rng As Range\n    With Sheets(\"Cancelations Temp\")\n        N = .Cells(Rows.Count, \"P\").End(xlUp).Row\n        Set rng = .Range(\"P2:P\" &amp; N)\n        rng.Copy\n        rng.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    End With\nEnd Sub\n</code></pre>\n\n<p>As an alternative to <code>Copy / PasteSpecial</code>:</p>\n\n<pre><code>Sub KopyPaste()\n    Dim N As Long, rng As Range\n    With Sheets(\"Cancelations Temp\")\n        N = .Cells(Rows.Count, \"P\").End(xlUp).Row\n        Set rng = .Range(\"P2:P\" &amp; N)\n        rng.Value = rng.Value\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5793699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0cd91929b08ffe8f0d38b46f2ef88d?s=128&d=identicon&r=PG&f=1", "display_name": "Seb KB2", "link": "https://stackoverflow.com/users/5793699/seb-kb2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 57183523, "answer_count": 2, "score": 0, "last_activity_date": 1563973037, "creation_date": 1563971755, "last_edit_date": 1563971861, "question_id": 57183110, "link": "https://stackoverflow.com/questions/57183110/using-range-end-without-using-select", "title": "Using Range.End without using .select", "body": "<p>I do not know if this is possible, but I hereby call upon you VBA masters for some help.</p>\n\n<p>To summarize: I am appending a formula to a table via VBA, which populates the entire column, and then attempting to copy and paste values to the same column,(It varies in size, hence why the .End(XlDown) (Ideally without using select as it slows the VBA down))</p>\n\n<p>I have no issue using:</p>\n\n<pre><code>Sheets(\"Cancelations Temp\").Range(\"P2\", Range(\"P2\").End(xlDown)).Copy\nSheets(\"Cancelations Temp\").Range(\"P2\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n\n<p>But, by using this, I need to have the sheet (\"Cancelations Temp\") selected, if it is not, I get an application-defined error.</p>\n\n<p>Is there a way for me to basically achieve this (copying a column that changes sizes on each run of the macro), without using a select method?</p>\n\n<p>I supposed I could see where the range end each time, define it as a variable (Say Var), and then do it via: </p>\n\n<pre><code>Sheets(\"SheetName\").Range(\"P2:Var\").Copy\nSheets(\"SheetName\").Range(\"P2\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n\n<p>I hope I haven't messed up the formating... I probably have though, will try and fix once I see how it came out</p>\n\n<p>This is my current code:</p>\n\n<pre><code>Sheets(\"Cancelations Temp\").Range(\"P2\").FormulaR1C1 = _\n        \"=IFERROR(IF(VLOOKUP([@[Policy Number]],Temp_Cancelations,6,FALSE)=\"\"MTC\"\",\"\"Canceled\"\",IF(VLOOKUP([@[Policy Number]],Temp_Cancelations,6,FALSE)=\"\"MTR\"\",\"\"Reinstated\"\",\"\"Not Canceled\"\")),\"\"\"\")\"\n    'Sheets(\"Cancelations Temp\").Select\n    Sheets(\"Cancelations Temp\").Range(\"P2\", Range(\"P2\").End(xlDown)).Copy\n    Sheets(\"Cancelations Temp\").Range(\"P2\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n</code></pre>\n\n<p>When run within the Sheet mentioned, I get no issues and all is correct.\nWhen I run it from the main page (Where the user would run the macro from), I get an application or object defined error. When I run it with the Select method (Commented in the code above), it runs fine, but goes to the sheet in question.</p>\n\n<p>Thanks in advance, I have searched around for this, but no resolution was found.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "is_accepted": false, "score": 1, "last_activity_date": 1563973807, "last_edit_date": 1563973807, "creation_date": 1563971596, "answer_id": 57183061, "question_id": 57182888, "link": "https://stackoverflow.com/questions/57182888/hiding-multiple-objects-using-ms-access-vba-code/57183061#57183061", "title": "Hiding multiple objects using MS Access VBA code", "body": "<p><code>And</code> is logical operator. You don't need to use it here</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub gender_Click()\n    If gender.Value = \"other\" Then\n        Me.X.Visible = True \n        Me.Y.Visible = True\n        Me.X.Visible = True\n    Else\n        Me.X.Visible = False \n        Me.Y.Visible = False \n        Me.X.Visible = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>Or If you want one to set property at single line</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub gender_Click()\n    If gender.Value = \"other\" Then\n        Me.X.Visible = True : Me.Y.Visible = True : Me.X.Visible = True\n    Else\n        Me.X.Visible = False : Me.Y.Visible = False : Me.X.Visible = False\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 10771120, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U8-EdVy-84Y/AAAAAAAAAAI/AAAAAAAACpQ/pmbnCFfG6hQ/photo.jpg?sz=128", "display_name": "Kiran Chapidi", "link": "https://stackoverflow.com/users/10771120/kiran-chapidi"}, "edited": false, "score": 0, "creation_date": 1563972234, "post_id": 57183111, "comment_id": 100877197, "body": "Thank you so much Sam, the code without If works perfect. Thank you so much."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 3, "last_activity_date": 1563971760, "creation_date": 1563971760, "answer_id": 57183111, "question_id": 57182888, "link": "https://stackoverflow.com/questions/57182888/hiding-multiple-objects-using-ms-access-vba-code/57183111#57183111", "title": "Hiding multiple objects using MS Access VBA code", "body": "<p>This line</p>\n\n<pre><code>Me.X.Visible = True And Me.Y.Visible = True And Me.X.Visible = True\n</code></pre>\n\n<p>does not do what I think you think it does. Everything to right of the equals sign is evaluated before it is applied to the Visible parameter. This means that if  all these are true, the result is true:</p>\n\n<pre><code>True\n    And\nMe.Y.Visible = True \n    And \nMe.X.Visible = True\n</code></pre>\n\n<p>Instead you can do like this:</p>\n\n<pre><code>Me.X.Visible = True\nMe.Y.Visible = True\nMe.X.Visible = True\n</code></pre>\n\n<p>or even </p>\n\n<pre><code>Me.X.Visible = (gender.Value = \"other\")\nMe.Y.Visible = (gender.Value = \"other\")\nMe.X.Visible = (gender.Value = \"other\")\n</code></pre>\n\n<p>in which case you won't need an <code>If</code> at all</p>\n"}], "owner": {"reputation": 61, "user_id": 10771120, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-U8-EdVy-84Y/AAAAAAAAAAI/AAAAAAAACpQ/pmbnCFfG6hQ/photo.jpg?sz=128", "display_name": "Kiran Chapidi", "link": "https://stackoverflow.com/users/10771120/kiran-chapidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 57183111, "answer_count": 2, "score": 0, "last_activity_date": 1594635464, "creation_date": 1563971075, "last_edit_date": 1594635464, "question_id": 57182888, "link": "https://stackoverflow.com/questions/57182888/hiding-multiple-objects-using-ms-access-vba-code", "title": "Hiding multiple objects using MS Access VBA code", "body": "<p>Can someone please help me with the VBA code. I am very new to MS Access. How to make multiple fileds invisible/hide using VBA code?</p>\n\n<p>I am working on creating MS Acceess form. I have a requirement, 3 fields needs to be hidden if a condition is selected from a filed. If example: I have a column gender with values (Male, female and other). If I select other from the gender field three other fields lets say (X, Y and Y) need to go invisible. I am unable to hide all three fileds at a time. Below is the code I am using. Can someone please help me with this.</p>\n\n<pre><code>Private Sub gender_Click()\nIf gender.Value = \"other\" Then\nMe.X.Visible = True And Me.Y.Visible = True And Me.X.Visible = True\nElse\nMe.X.Visible = False And Me.Y.Visible = False And Me.X.Visible = False\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1563971683, "post_id": 57182771, "comment_id": 100876831, "body": "Hi Arthur, what I do to get the code is use the macro recorder, do what I need to and then fit it to my needs. Thought I guess you need to change this: <code>.IconSet = ActiveWorkbook.IconSets(xl5Arrows)</code> some <code>xl5TrafficLights</code> or whatever, you&#39;ll find it yourself by doing the macro record."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1563972015, "post_id": 57182771, "comment_id": 100877044, "body": "There is no <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.office.interop.excel.xliconset?view=excel-pia\" rel=\"nofollow noreferrer\"><code>xl5TrafficLights</code></a> unfortunately."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1563972155, "post_id": 57182771, "comment_id": 100877139, "body": "True that, just checked and you can only have 4 (<code>xl4TrafficLights</code>)"}, {"owner": {"reputation": 43, "user_id": 11791132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be74fd39bc59786899508c42a50bef45?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/11791132/arthur"}, "edited": false, "score": 0, "creation_date": 1563972391, "post_id": 57182771, "comment_id": 100877295, "body": "Thank you for the answer. Unfortunately, vba doesn&#39;t recognize <code>xl5trafficlights</code>. That&#39;s why I used <code>xl5Arrows</code> to have 5 conditions."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11791132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be74fd39bc59786899508c42a50bef45?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/11791132/arthur"}, "edited": false, "score": 1, "creation_date": 1563976524, "post_id": 57183607, "comment_id": 100879717, "body": "With <code>xl3trafficlights</code> you are forced to use either <code>xlGreatEqual</code> or <code>xlGreater</code>. So yes I agree that it should be 1. value &gt;1.15 2. value &gt; 1.06 3. value &gt;0.95 4. value &gt; 0.85 5. other value  As with conditions, the first condition is with other values, I do <code>ReverseOrder</code>"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 43, "user_id": 11791132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be74fd39bc59786899508c42a50bef45?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/11791132/arthur"}, "edited": false, "score": 0, "creation_date": 1563976767, "post_id": 57183607, "comment_id": 100879886, "body": "Is the Syntax <code>xlGreatEqual</code> or <code>xlGreaterEqual</code>? I&#39;d like to make the adjustment"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 43, "user_id": 11791132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be74fd39bc59786899508c42a50bef45?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/11791132/arthur"}, "edited": false, "score": 0, "creation_date": 1563977905, "post_id": 57183607, "comment_id": 100880608, "body": "Thanks, @Arthur. I&#39;ll keep it as is then."}], "tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1564131408, "last_edit_date": 1564131408, "creation_date": 1563973318, "answer_id": 57183607, "question_id": 57182771, "link": "https://stackoverflow.com/questions/57182771/how-to-customize-icons-for-conditions/57183607#57183607", "title": "How to customize icons for conditions", "body": "<p>However with the iconsets, I don't believe there is a format for 5 traffic light, only xl3TrafficLights1, xl4TrafficLights or xl3TrafficLights2. <a href=\"https://www.bluepecantraining.com/portfolio/excel-vba-apply-icon-set-conditional-formatting-with-vba-macro/\" rel=\"nofollow noreferrer\">You can read those here</a></p>\n\n<p>Additionally, the component setting your criteria, based on what you said should be <code>.Operator = xlLess</code> or <code>.Operator =xlGreaterEqual</code></p>\n\n<ol>\n<li>value &lt; 0.85 (xlLess)</li>\n<li>value &lt; 0.95 (xlLess)</li>\n<li>value &lt; 1.06 (xlLess)</li>\n<li>value &lt; 1.15 (xlLess)</li>\n<li>value >=1.15 (xlGreaterEqual)</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 11791132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be74fd39bc59786899508c42a50bef45?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/11791132/arthur"}, "edited": false, "score": 0, "creation_date": 1563985442, "post_id": 57187252, "comment_id": 100884883, "body": "Thank you for the answer, I will try it tomorrow."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 2, "last_activity_date": 1563984785, "creation_date": 1563984785, "answer_id": 57187252, "question_id": 57182771, "link": "https://stackoverflow.com/questions/57182771/how-to-customize-icons-for-conditions/57187252#57187252", "title": "How to customize icons for conditions", "body": "<p>As <a href=\"https://stackoverflow.com/a/57183607/9290986\">Mark S. mentioned</a>, there is no default <code>xl5trafficlights</code> in the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.office.interop.excel.xliconset?view=excel-pia\" rel=\"nofollow noreferrer\"><code>xlIconSet</code> enum</a></p>\n\n<p>However, you are currently setting the <code>.Type</code>, <code>.Value</code> and <code>.Operator</code> of your IconCriteria - just makes sure to <em>also</em> set the <code>.Icon</code> at the same time.  This will set the <code>IconSetCriteria</code> to <code>xlCustomSet</code>.</p>\n\n<p>This is an <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.office.interop.excel.xlicon?view=excel-pia\" rel=\"nofollow noreferrer\"><code>xlIcon</code></a> - the \"circle\" ones, for you to build your 5 traffic-light set from are as follows:</p>\n\n<pre><code>xlIconBlackCircleWithBorder\nxlIconGrayCircle\nxlIconGreenCircle\nxlIconRedCircleWithBorder\nxlIconPinkCircle\nxlIconYellowCircle\nxlIconGreenCheckSymbol\nxlIconRedCrossSymbol\nxlIconYellowExclamationSymbol\nxlIconWhiteCircleAllWhiteQuarters\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>    With .IconCriteria(1)\n        .Icon = xlIconWhiteCircleAllWhiteQuarters\n    End With\n    With .IconCriteria(2)\n        .Icon = xlIconGreenCircle\n        .Type = xlConditionValueNumber\n        .Value = 0.85\n        .Operator = xlGreater\n    End With\n    With .IconCriteria(3)\n        .Icon = xlIconYellowCircle\n        .Type = xlConditionValueNumber\n        .Value = 0.95\n        .Operator = xlGreater\n    End With\n    With .IconCriteria(4)\n        .Icon = xlIconRedCircleWithBorder\n        .Type = xlConditionValueNumber\n        .Value = 1.05\n        .Operator = xlGreater\n    End With\n    With .IconCriteria(5)\n        .Icon = xlIconBlackCircleWithBorder\n        .Type = xlConditionValueNumber\n        .Value = 1.15\n        .Operator = xlGreater\n    End With\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11791132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be74fd39bc59786899508c42a50bef45?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/11791132/arthur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 57187252, "answer_count": 2, "score": 2, "last_activity_date": 1564131408, "creation_date": 1563970691, "last_edit_date": 1563971778, "question_id": 57182771, "link": "https://stackoverflow.com/questions/57182771/how-to-customize-icons-for-conditions", "title": "How to customize icons for conditions", "body": "<p>I would like to customize the icons criteria. I need 5 conditions. I used IconSetCondition. </p>\n\n<p>Conditions are:</p>\n\n<ol>\n<li>value &lt; 0.85</li>\n<li>value &lt; 0.95</li>\n<li>value &lt; 1.06</li>\n<li>value &lt; 1.15</li>\n<li>value >=1.15</li>\n</ol>\n\n<p>I would like to use 3Traffic lights in this way:</p>\n\n<ol>\n<li>value &lt; 0.85 --> \"red traffic light\"</li>\n<li>value &lt; 0.95 --> \"orange traffic light\"</li>\n<li>value &lt; 1.06 --> \"green traffic light\"</li>\n<li>value &lt; 1.15 --> \"orange traffic light\"</li>\n<li>value >=1.15 --> \"red traffic light\"</li>\n</ol>\n\n<p>I voluntary used xl5Arrows to get the 5 conditions.</p>\n\n<pre><code>Set r = Range(Cells(3, 6), Cells(nbtopics + 2, 6))\nWith r\n    With .FormatConditions\n        .Delete\n        .AddIconSetCondition\n    End With\n    With .FormatConditions(1)\n        .SetFirstPriority\n        .ReverseOrder = False\n        .ShowIconOnly = False\n        .IconSet = ActiveWorkbook.IconSets(xl5Arrows)\n        With .IconCriteria(2)\n            .Type = xlConditionValueNumber\n            .Value = 0.85\n            .Operator = xlGreater\n        End With\n        With .IconCriteria(3)\n            .Type = xlConditionValueNumber\n            .Value = 0.95\n            .Operator = xlGreater\n        End With\n        With .IconCriteria(4)\n            .Type = xlConditionValueNumber\n            .Value = 1.05\n            .Operator = xlGreater\n        End With\n        With .IconCriteria(5)\n            .Type = xlConditionValueNumber\n            .Value = 1.15\n            .Operator = xlGreater\n        End With\n    End With\nEnd With\n</code></pre>\n\n<p>This code works, however I would like <code>Traffic lights</code> instead of <code>xl5Arrows</code>.</p>\n\n<p>Thank you very much for your help. If you need further details, don't hesitate to comment.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1563970698, "post_id": 57182695, "comment_id": 100876214, "body": "You mean you need to add the value to the existing value of the same range like that <code>Range(&quot;J89&quot;).Value = Range(&quot;J89&quot;).Value+1</code>"}, {"owner": {"reputation": 13, "user_id": 11009634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213379692263643/picture?type=large", "display_name": "Julius Anttila", "link": "https://stackoverflow.com/users/11009634/julius-anttila"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1564034025, "post_id": 57182695, "comment_id": 100898924, "body": "I want to make dim all product1, 2, 3, 4, 5, 6 ranges first and after that, I want to add values. I have 7 times this kind of code and I want to make it simpler."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1564035286, "post_id": 57182695, "comment_id": 100899420, "body": "Will you name the range for example &quot;J89&quot; with a named range in your worksheet (Product1) ...? &gt;&gt; so in this case you have 7 named ranges..?"}], "answers": [{"tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": false, "score": 0, "last_activity_date": 1564035641, "creation_date": 1564035641, "answer_id": 57195502, "question_id": 57182695, "link": "https://stackoverflow.com/questions/57182695/how-to-make-autofill-with-range-and-value/57195502#57195502", "title": "How to make autofill with range and value?", "body": "<p>Do you mean something like that</p>\n\n<pre><code>Sub Test()\nDim e\nFor Each e In Array(\"J89\", \"J90\", \"J93\", \"J123\", \"J124\", \"J134\")\n    Sheets(\"Gears\").Range(e) = 1\nNext e\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11009634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213379692263643/picture?type=large", "display_name": "Julius Anttila", "link": "https://stackoverflow.com/users/11009634/julius-anttila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564035641, "creation_date": 1563970471, "last_edit_date": 1563971756, "question_id": 57182695, "link": "https://stackoverflow.com/questions/57182695/how-to-make-autofill-with-range-and-value", "title": "How to make autofill with range and value?", "body": "<p>I'm making excels to calculate offers. We have a different kind of \"packages\" where you have different products. I'm trying to make a button which adds numbers in front of every product we need to offer \"full package\"</p>\n\n<p>I'm updating these products in every month and adding rows so its really big work to update all \"ranges\". If I add one row its all gone because everything is +1.</p>\n\n<p>Can I dim somehow these products like...</p>\n\n<pre><code>Dim Product1 range (J91)\n\nProduct1.value = 1\n</code></pre>\n\n<p>and it adds to number 1 to range witch I dim earlier.</p>\n\n<p>In the future when I need to update I just change from one place all the ranges.</p>\n\n<p>I have like 7 product packages so it is frustrating</p>\n\n<pre><code>Sub Package1_3P_4G()\n\n\nApplication.ScreenUpdating = False\n Sheets(\"Gears\").Select\nRange(\"J74:J200\").ClearContents\n\n\nRange(\"J89\").Value = 1 ' Add 1 pc Product1\nRange(\"J90\").Value = 1 ' Add 1 pc Product2\nRange(\"J93\").Value = 1 ' Add 1 pc Product3\nRange(\"J123\").Value = 2 ' Add 2 pc Product4\nRange(\"J124\").Value = 1 ' Add 1 pc Product5\nRange(\"J134\").Value = 1 ' Add 1 pcProduct6\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "automation", "webautomation"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1563971027, "post_id": 57182619, "comment_id": 100876391, "body": "Is your <code>If hrf.innerText = &quot;Login&quot;</code> ever true? Is it <code>&quot;Login&quot;</code> as opposed to e.g. <code>&quot;   Login&quot;</code>?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1563973184, "post_id": 57182619, "comment_id": 100877757, "body": "Is the index of the anchor element known and constant? Have you tried reaching it using <code>ie.document.getElementsByTagName(&quot;a&quot;)(index)</code>, where <code>index=0,1...,n</code>?"}, {"owner": {"reputation": 237, "user_id": 11510566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otB1u3k6NRM/AAAAAAAAAAI/AAAAAAAAAA4/c9kr55k_34w/photo.jpg?sz=128", "display_name": "Love Coding", "link": "https://stackoverflow.com/users/11510566/love-coding"}, "edited": false, "score": 0, "creation_date": 1563975220, "post_id": 57182619, "comment_id": 100878902, "body": "yes I also tried that, and yes the code was able to find the element using the innertext"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1563985928, "creation_date": 1563985928, "answer_id": 57187563, "question_id": 57182619, "link": "https://stackoverflow.com/questions/57182619/vba-ie-how-to-click-a-button-with-mouseevetns-mouseover-and-mouseleave/57187563#57187563", "title": "VBA IE How to click a button with MouseEvetns &#39;mouseover&#39; and &#39;mouseleave&#39;", "body": "<p>Why not use the <code>data-qtip</code> attribute and its value? Obviously use this as basis for <code>.FireEvent</code> or <code>.dispatchEvent</code> as required. No looping required.</p>\n\n<pre><code>ie.document.querySelector(\"[data-qtip=Login]\").click\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 11510566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otB1u3k6NRM/AAAAAAAAAAI/AAAAAAAAAA4/c9kr55k_34w/photo.jpg?sz=128", "display_name": "Love Coding", "link": "https://stackoverflow.com/users/11510566/love-coding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 753, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563985928, "creation_date": 1563970235, "last_edit_date": 1563970914, "question_id": 57182619, "link": "https://stackoverflow.com/questions/57182619/vba-ie-how-to-click-a-button-with-mouseevetns-mouseover-and-mouseleave", "title": "VBA IE How to click a button with MouseEvetns &#39;mouseover&#39; and &#39;mouseleave&#39;", "body": "<p>I am having challenges automating a website with elements that requires a <code>click</code> action. Example of those elements are search icons, link and buttons. One thing similar to these elements when I inspect them is that they have an EventListener 'mouseenter' and 'mouseover' and also I noticed that they have an attribute <code>hidefocus=\"on\"</code> and <code>unselectable=\"on\"</code> which I thinking a property that block me on controlling these elements. Below is a sample source code which is for the button Login, the main element is <code>&lt;a&gt;</code> and the events are attached to it and there is a children <code>&lt;span&gt;</code> element with no event listener.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;a tabindex=\"0\" class=\"x-btn-default-small\" id=\"button-1028\" role=\"button\" aria-disabled=\"false\" aria-hidden=\"false\" hidefocus=\"on\" unselectable=\"on\" data-componentid=\"button-2018\" data-qtip=\"Login\"&gt;\n\n&lt;span class=\"x-btn-icon\" id=\"button-1028-btnIconEl\" role=\"presentation\" data-ref=\"btnIconEl\" unselectable=\"on\" qa=\"btnIcon-loginButton\"&gt;Login&lt;span&gt;\n</code></pre>\n\n<p>The <code>id</code> of this button is dynamically changing so I cannot rely on that attribute, so I am using the <code>innerText</code> property instead. Below are the codes I already tried that did not work.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim hrf As HTMLAnchorElement\n\n'1st\nFor Each hrf In ie.document.getElementsByTagName(\"a\")\n    If hrf.innerText = \"Login\" Then\n        hrf.Click: Exit For\n    End If\nNext hrf\n\n'2nd\nFor Each hrf In ie.document.getElementsByTagName(\"a\")\n    If hrf.innerText = \"Login\" Then\n        hrf.FireEvent \"onmouseover\"\n        hrf.FireEvent \"onmousedown\"\n        hrf.FireEvent \"onmouseup\"\n        Exit For\n    End If\nNext hrf\n\n'3rd\nFor Each hrf In ie.document.getElementsByTagName(\"a\")\n    If hrf.innerText = \"Login\" Then\n        hrf.FireEvent \"onclick\"\n        hrf.FireEvent \"onmouseenter\"\n        hrf.FireEvent \"onmouseleave\"\n        Exit For\n    End If\nNext hrf\n\n'4th - dispatch event\nSet evt = ie.document.createEvent(\"HTMLEvents\") 'also tried \"MouseEvents\"\nevt.initEvent \"onclick\", True, True 'also tried \"onmouseenter\", \"mouseenter\", \"click\", true, false/ false, false/false, true\nFor Each hrf In ie.document.getElementsByTagName(\"a\")\n    If hrf.innerText = \"Login\" Then\n        hrf.dispatchEvent evt\n        Exit For\n    End If\nNext hrf\n</code></pre>\n\n<p>I also tried using the span element but still it's not working. Hope you can help me.</p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1563969585, "post_id": 57182062, "comment_id": 100875568, "body": "When you download a file from Internet, you are making a <code>GET</code> http request for a resource. Check out <a href=\"https://stackoverflow.com/a/17877390/3111149\">this answer</a> to see how to set it up in VBA. As for your request, open your website on Google Chrome, Developer Tools, go into the Network tab and click on the button to download the file: you will see what is the request you send."}, {"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "edited": false, "score": 0, "creation_date": 1563981723, "post_id": 57182062, "comment_id": 100882907, "body": "You could refer to <a href=\"https://stackoverflow.com/questions/32145437/controlling-ie11-do-you-want-to-open-save-dialogue-window-buttons-in-vba/32152712#32152712\">this thread</a> and try to use &quot;Application.SendKeys &quot;%{S}&quot;&quot; to click the save button. Besides, you can also check <a href=\"https://stackoverflow.com/questions/31489801/ie11-frame-notification-bar-save-button/49695810#49695810\">this thread</a> to handle the download prompt."}], "owner": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563969590, "creation_date": 1563968392, "last_edit_date": 1563969590, "question_id": 57182062, "link": "https://stackoverflow.com/questions/57182062/saving-file-after-navigating-web-page-in-ie-macro", "title": "Saving File after navigating Web Page in IE Macro", "body": "<p>Hello I'm trying to automate the downloading part of my report automation. I was able to get the raw data and all via navigation but i'm now stuck in downloading it as my IE is older version. A pop out of \"Open\", \"Save\",\"Cancel\". I can't post the website since it's a client web tool.</p>\n\n<p>Commented part is what I've tried so far.</p>\n\n<pre><code>Sub Get_RawFile()\n'\n'\n'\n    Dim IE As New InternetExplorer\n    Dim HTMLDoc As HTMLDocument\n    Dim HTMLselect As HTMLSelectElement\n    'Dim saveInFolder As String, saveAsFilename As String\n    'saveInFolder = \"C:\"\n    'saveAsFilename = \"test_\" &amp; Format(Sheets(\"Attendance\").Range(\"X6\").Value, \"yyyymmdd\")\n\n    With IE\n        .Visible = True\n        .Navigate (\"---------------------\")\n\n    While IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\n\n    Set HTMLDoc = IE.document\n    HTMLDoc.all.UserName.Value = Sheets(\"Data Dump\").Range(\"A1\").Value\n    HTMLDoc.all.Password.Value = Sheets(\"Data Dump\").Range(\"B1\").Value\n    HTMLDoc.getElementById(\"login-btn\").Click\n\n    While IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n\n    Set objButton = HTMLDoc.getElementById(\"s2id_ddlReportType\")\n    Set HTMLselect = HTMLDoc.getElementById(\"ddlReportType\")\n    objButton.Focus\n    HTMLselect.Value = \"2\"\n\n    Set HTMLselectZone = HTMLDoc.getElementById(\"ddlTimezone\")\n    HTMLselectZone.Value = \"PST8PDT\"\n\n    Set subgroups = HTMLDoc.getElementById(\"s2id_ddlSubgroups\")\n    subgroups.Click\n    Set subgroups2 = HTMLDoc.getElementById(\"ddlSubgroups\")\n    subgroups2.Value = \"1456_17\"\n\n    HTMLDoc.getElementById(\"dtStartDate\").Value = Format(Sheets(\"Attendance\").Range(\"B6\").Value, \"yyyy-mm-dd\")\n    HTMLDoc.getElementById(\"dtEndDate\").Value = Format(Sheets(\"Attendance\").Range(\"X6\").Value, \"yyyy-mm-dd\")\n\n    HTMLDoc.getElementById(\"btnGetReport\").Focus\n    HTMLDoc.getElementById(\"btnGetReport\").Click\n    Application.Wait (Now + TimeValue(\"0:00:10\"))\n\n    HTMLDoc.getElementById(\"btnDowloadReport\").Click 'Download report button\n\n    'saveInFolder, saveAsFilename\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "countif"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1563967642, "post_id": 57181768, "comment_id": 100874515, "body": "You are aware that you are using <code>Range</code> and <code>Cells</code> in a worksheet formula? Are you not looking to use <code>Application.WorksheetFunction.CountIf</code>? Or are you trying to populate a cell with a formula?"}, {"owner": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1563967884, "post_id": 57181768, "comment_id": 100874651, "body": "to  populate a cell with a formula."}, {"owner": {"reputation": 431, "user_id": 9476917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5NET.jpg?s=128&g=1", "display_name": "Maeaex1", "link": "https://stackoverflow.com/users/9476917/maeaex1"}, "edited": false, "score": 1, "creation_date": 1563967974, "post_id": 57181768, "comment_id": 100874706, "body": "please check this <a href=\"https://stackoverflow.com/questions/52671561/insert-formula-in-one-cell-using-vba?rq=1\">link</a>. This should help."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "edited": false, "score": 1, "creation_date": 1563968900, "post_id": 57182046, "comment_id": 100875227, "body": "yup, that did the trick. and so simple. and i see where i made the error, won&#39;t happen again."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "edited": false, "score": 0, "creation_date": 1564003148, "post_id": 57182046, "comment_id": 100892354, "body": "Glad it helped @DanM, please accept as answer. Much appreciated"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1563968351, "creation_date": 1563968351, "answer_id": 57182046, "question_id": 57181768, "link": "https://stackoverflow.com/questions/57181768/trying-to-use-countif-in-a-formula/57182046#57182046", "title": "Trying to use Countif in a formula", "body": "<p>So based on your response in the comments section I think you are looking to use:</p>\n\n<pre><code>Sub PutFormulaInCell()\n\nDim a As Long\na = 5\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n    .Cells(a, 1).Formula = \"=Countif(G\" &amp; a &amp; \":U\" &amp; a &amp; \",\" &amp; \"\"\"a\"\")\"\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Right now you have mixed up VBA and Excel syntax's resulting in a 1004 error.</p>\n"}], "owner": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563968351, "creation_date": 1563967404, "question_id": 57181768, "link": "https://stackoverflow.com/questions/57181768/trying-to-use-countif-in-a-formula", "title": "Trying to use Countif in a formula", "body": "<p>How to use countif in a formula</p>\n\n<p>I did some research on google and other forums but did not find a solution. it's not a syntax error so it's not my double quotes that is the issue. the error is run time 1004, application defined or object defined error.</p>\n\n<pre><code>Cells(a, 1).Formula = \"=Countif(Range(cells(\" &amp; a &amp; \",7),cells(\" &amp; a &amp; \",21))),\"\"a\"\"\"\n</code></pre>\n\n<p>In the first case, a is 5, so i want it to scan columns g through u in row 5, count any occurrences of the letter 'a'</p>\n\n<p>Expected a number counting all the occurences of \"a\" in a row, instead im getting a 1004 error</p>\n\n<p>just a note to the moderators, on my last post, i was demoted i guess for asking a dumb question. how can i get that fixed as the thread is closed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1563967023, "post_id": 57181553, "comment_id": 100874190, "body": "a) In which line does the error occur? b)  I highly recommend to use meaningful variable names. Single letter variable names is a very bad choice. Also probably every programmer will consider <code>i</code> as a counter, this is very confusing."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 2, "creation_date": 1563968329, "post_id": 57181553, "comment_id": 100874904, "body": "Variable <code>i</code> &amp; <code>e</code> are not declare!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11829921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H6dOBSH1Hcg/AAAAAAAAAAI/AAAAAAAAEnU/zaQRBOR6AGo/photo.jpg?sz=128", "display_name": "Rupesh Nair", "link": "https://stackoverflow.com/users/11829921/rupesh-nair"}, "edited": false, "score": 0, "creation_date": 1564117471, "post_id": 57182220, "comment_id": 100932185, "body": "Sorry buddy..still getting the same error at    If i.Range(&quot;Y&quot; &amp; j) = &quot;High&quot; Or i.Range(&quot;Y&quot; &amp; j) = &quot;Very High&quot; Then"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1563968974, "creation_date": 1563968974, "answer_id": 57182220, "question_id": 57181553, "link": "https://stackoverflow.com/questions/57181553/type-mismatch-error-in-while-using-if-and-range-code/57182220#57182220", "title": "Type mismatch error in while using IF and Range code", "body": "<p>You could try:</p>\n\n<pre><code>Sub Copy()\n\n    ActiveSheet.Unprotect Password:=\"123\"\n\n    Dim i As Worksheet, e As Worksheet\n    Dim j As Long, d As Long\n\n    j = 5\n    d = 4\n\n    With ThisWorkbook\n        Set i = .Worksheets(\"Risk Assessment\")\n        Set e = .Worksheets(\"High &amp; V High Risk Assessment\")\n    End With\n\n    Do Until IsEmpty(i.Range(\"Y\" &amp; j))\n\n        If i.Range(\"Y\" &amp; j) = \"High\" Or i.Range(\"Y\" &amp; j) = \"Very High\" Then\n\n            i.Rows(j).EntireRow.Copy e.Rows(d)\n\n            d = d + 1\n\n        End If\n\n        j = j + 1\n\n    Loop\n\n    ActiveSheet.Protect Password:=\"123\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11829921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-H6dOBSH1Hcg/AAAAAAAAAAI/AAAAAAAAEnU/zaQRBOR6AGo/photo.jpg?sz=128", "display_name": "Rupesh Nair", "link": "https://stackoverflow.com/users/11829921/rupesh-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563968974, "creation_date": 1563966690, "last_edit_date": 1563966837, "question_id": 57181553, "link": "https://stackoverflow.com/questions/57181553/type-mismatch-error-in-while-using-if-and-range-code", "title": "Type mismatch error in while using IF and Range code", "body": "<p>Getting a type mismatch error while executing the code.\nHere basically i want to copy the rows if the criteria of High or Very High is getting satisfied.</p>\n\n<pre><code>Sub Copy()\n    ActiveSheet.Unprotect Password:=\"123\"\n\n    Set i = Sheets(\"Risk Assessment\")\n    Set e = Sheets(\"High &amp; V High Risk Assessment\")\n    Dim d\n    Dim j As Integer\n    d = 4\n    j = 5\n\n    Do Until IsEmpty(i.Range(\"Y\" &amp; j))\n        If i.Range(\"Y\" &amp; j) = \"High\" Or i.Range(\"Y\" &amp; j) = \"Very High\" Then\n            d = d + 1\n            e.Rows(d).Value = i.Rows(j).Value\n        End If\n\n        j = j + 1\n    Loop\n\n    ActiveSheet.Protect Password:=\"123\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "edited": false, "score": 0, "creation_date": 1563966930, "post_id": 57181301, "comment_id": 100874141, "body": "Have you tried to insert a breakpoint and checking by either writing <code>stop</code> where you want to debug or adding a red dot in the left side of your VBA code and moving line by line with <code>F8</code> in order to see how your code moves after the error fires? These debugging features should be the first check when something doesn&#39;t execute as expected."}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "reply_to_user": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "edited": false, "score": 0, "creation_date": 1563967184, "post_id": 57181301, "comment_id": 100874260, "body": "Thanks Oliver - let me try that. I&#39;m not very familiar with the VBA editor. If you see my edit, I also need to see how to inspect properties &amp; objects to see what type they are."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1563967358, "post_id": 57181301, "comment_id": 100874354, "body": "<i>&quot;the move fails&quot;</i> - Please include the exact error message."}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1563968142, "post_id": 57181301, "comment_id": 100874797, "body": "@Tomalak - Err.number is -2147352567, Err.Description is &quot;Cannot move the item&quot;, but I think it&#39;s down to my &#39;incidents&#39; variable being a regex &#39;Match&#39; object and not the &#39;value&#39; property from that object..."}], "answers": [{"comments": [{"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 1, "creation_date": 1563969822, "post_id": 57182121, "comment_id": 100875702, "body": "Side note <code>Debug.Print</code> is way less annoying than <code>MsgBox</code>"}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1563970743, "post_id": 57182121, "comment_id": 100876241, "body": "Thanks Tomalak - still new to VBA. If there are any other obvious improvement to my code, then happy to have them pointed out. Still a bit vague on when I need <code>Dim</code> (for explicitly setting the type of a variable?) and <code>Set</code>"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 1, "creation_date": 1563971230, "post_id": 57182121, "comment_id": 100876530, "body": "<code>Dim</code> is for declaring a variable. The <code>Set</code> and the (entirely optional) <code>Let</code> keywords are for assigning a value to a variable. <a href=\"https://stackoverflow.com/q/349613/18771\">Also see</a>. Go to your VBA IDE Optinons and enable &quot;Require Variable Declaration&quot; and disable &quot;Auto Syntax Check&quot;. Add <code>Option Explicit</code> as the first line to all the modules that do not already have it. Thank me later. ;)"}], "tags": [], "owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "is_accepted": false, "score": 1, "last_activity_date": 1563968615, "creation_date": 1563968615, "answer_id": 57182121, "question_id": 57181301, "link": "https://stackoverflow.com/questions/57181301/unable-to-move-email-to-pre-existing-folder-with-vba-move-to-new-folder-works/57182121#57182121", "title": "Unable to move email to pre-existing folder with VBA. Move to new folder works", "body": "<p>The answer appears to be changing the calling code to :</p>\n\n<pre><code>For Each Match In irMatches\n  Call addToCategory(Match, email)\n  Call AddIncidentFolder(Match.Value, email)\nNext\n</code></pre>\n\n<p>whilst the older code to assign the email category is happy being passed a match object, as is the <code>Folders.Add</code> method, switching to that folder doesn't work when passed a match object and required the .value property of the match.</p>\n\n<p>The complete code is now (without all that annoying debugging MsgBox stuff)):</p>\n\n<pre><code>Sub AddIncidentFolder(incident, ByRef email As Outlook.mailItem)\n\n incidentDir = \"Incidents\"\n\n Dim myNameSpace As Outlook.NameSpace\n\n Set myNameSpace = Application.GetNamespace(\"MAPI\")\n Set inbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n\n Set incidents = inbox.Folders.item(incidentDir)\n\nOn Error GoTo addSubFailed\n Set incidentSubFolder = incidents.Folders.Add(incident)\n\n On Error GoTo MoveError\n email.Move incidentSubFolder\n\n Exit Sub\n\naddSubFailed:\n Set incidentSubFolder = incidents.Folders(incident)\n Resume Next\n\nMoveError:\nMsgBox \"Move of email failed\"\n MsgBox \"Error number: \" &amp; Err.Number _\n            &amp; \" \" &amp; Err.Description\nResume Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1610363667, "creation_date": 1563965859, "last_edit_date": 1610363667, "question_id": 57181301, "link": "https://stackoverflow.com/questions/57181301/unable-to-move-email-to-pre-existing-folder-with-vba-move-to-new-folder-works", "title": "Unable to move email to pre-existing folder with VBA. Move to new folder works", "body": "<p>I'm trying to move an email in my Outlook 2010 inbox to a sub-folder of a folder (called &quot;Indidents&quot;).</p>\n<p>The move is being performed by a VBA routine which is passed a sub-folder name (a problem incident reference) and a reference to the email.</p>\n<p>If the sub-folder does not exists, it is to be created.</p>\n<p><strong>The move works if I have to create the folder, but if the sub-folder already exists then the move fails.</strong></p>\n<p>Here is my code:</p>\n<pre><code>Sub AddIncidentFolder(incident, ByRef email As Outlook.mailItem)\n\n incidentDir = &quot;Incidents&quot;\n\n Dim myNameSpace As Outlook.NameSpace\n Dim inbox As Outlook.Folder\n ' Dim incidents As Outlook.Folder\n Dim incidentSubFolder As Outlook.Folder\n \n Set myNameSpace = Application.GetNamespace(&quot;MAPI&quot;)\n Set inbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n  \n MsgBox &quot;Selecting &quot; &amp; incidentDir &amp; &quot; folder&quot;\n Set incidents = inbox.Folders.item(incidentDir)\n\n MsgBox &quot;Selecting &quot; &amp; incident &amp; &quot; sub-folder&quot;\n \nOn Error GoTo addSubFailed\n Set incidentSubFolder = incidents.Folders.Add(incident)\n MsgBox &quot;Incident sub-folder set to &quot; &amp; incidentSubFolder\n \n On Error GoTo MoveError\n email.Move incidentSubFolder\n \n Exit Sub\n\naddSubFailed:\n MsgBox &quot;Error Creating 'Incident' folder &quot; &amp; incident\n MsgBox &quot;Error number: &quot; &amp; Err.Number _\n            &amp; &quot; &quot; &amp; Err.Description\n Set incidentSubFolder = incidents.Folders.item(incident)\n  MsgBox &quot;folder add result was &quot; &amp; incidentSubFolder\n Resume Next\n \nMoveError:\nMsgBox &quot;Move of email failed&quot;\nResume Next\n  \nEnd Sub\n</code></pre>\n<p>So the idea is that if the 'Add Folder' fails then I assume it exists so I just select the folder in <code>addSubFailed</code>.</p>\n<p>The first 2 MsgBox statements in <code>addSubFailed</code> fire, but the third one doesn't, so I assume that the 'Set' for the sub-folder is causing a further error.</p>\n<p>I'm pretty new to VBA but OK with objects, properties etc. The code came from other SO answers and MS docs and I can't see anything obviously wrong.</p>\n<p><strong>EDIT</strong> The 'incident' variable which I thought was a string is actually a Regex match object, from this calling code:</p>\n<pre><code>For Each Match In irMatches\n  'MsgBox &quot;Match is &quot; &amp; Match &amp; &quot;, value is &quot; &amp; Match.Value\n  Call addToCategory(Match, email)\n  Call AddIncidentFolder(Match, email)\nNext\n</code></pre>\n<p>If I change the <code>addSubFailed</code> routine to:</p>\n<pre><code>addSubFailed:\n MsgBox &quot;Error Creating 'Incident' folder &quot; &amp; incident\n MsgBox &quot;Error number: &quot; &amp; Err.Number _\n            &amp; &quot; &quot; &amp; Err.Description\n MsgBox &quot;Incident is &quot; &amp; incident\n 'Set incidentSubFolder = incidents.Folders(incident)\n  Set incidentSubFolder = incidents.Folders(&quot;INC000001509771&quot;)\n  MsgBox &quot;folder is &quot; &amp; incidentSubFolder\n Resume Next\n</code></pre>\n<p>then it works, so I have a type-mismatch I think. Adding `As String' to the 'incident' parm gives me a type mis-match run-time error.</p>\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["excel", "vba", "split"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11829663, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QNMt5-ghV6k/AAAAAAAAAAI/AAAAAAAAAAo/EkZk_mVuU28/photo.jpg?sz=128", "display_name": "Pawel G", "link": "https://stackoverflow.com/users/11829663/pawel-g"}, "edited": false, "score": 0, "creation_date": 1563969779, "post_id": 57181225, "comment_id": 100875673, "body": "Thanks for fast response this is exactly what I was looking for. Problem solved :)"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 37, "user_id": 11829663, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QNMt5-ghV6k/AAAAAAAAAAI/AAAAAAAAAAo/EkZk_mVuU28/photo.jpg?sz=128", "display_name": "Pawel G", "link": "https://stackoverflow.com/users/11829663/pawel-g"}, "edited": false, "score": 0, "creation_date": 1563970333, "post_id": 57181225, "comment_id": 100876002, "body": "@PawelG if it worked, don&#39;t forget to accept the answer so the question will be closed."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1563965576, "creation_date": 1563965576, "answer_id": 57181225, "question_id": 57180929, "link": "https://stackoverflow.com/questions/57180929/vba-excel-extract-email-body-multiple-lines-into-excel-cells/57181225#57181225", "title": "VBA, Excel extract email body multiple lines into excel cells", "body": "<p>If I understand it well, you know that the description you're looking for is contained between the string <code>Issue description:</code> and sometimes the string <code>Nav error No.:</code> which may or may not be there. </p>\n\n<p>If that's always the case, then you can simply extract your description by splitting the whole mail body by the string <code>Issue description:</code>, then taking the part 1 and splitting by the string <code>Nav error No.:</code>, and getting the element <code>0</code>.</p>\n\n<p>Basically that would be: </p>\n\n<pre><code>IssueDescription = Split(Split(olItem.Body, \"Issue description: \")(1), \"Nav error No.:\")(0)\n</code></pre>\n\n<p>The variable <code>IssueDescription</code> now contains the whole description, whether it is on one line or multiple lines. If you want to print it in a single cell (hence you don't want the line breaks), you can just replace them with a space: </p>\n\n<pre><code>IssueDescription = Replace(IssueDescription, vbCrLf, \" \")\nws.Range(\"I\" &amp; rCount).Value = IssueDescription\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 11829663, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QNMt5-ghV6k/AAAAAAAAAAI/AAAAAAAAAAo/EkZk_mVuU28/photo.jpg?sz=128", "display_name": "Pawel G", "link": "https://stackoverflow.com/users/11829663/pawel-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 57181225, "answer_count": 1, "score": 0, "last_activity_date": 1563965576, "creation_date": 1563964674, "last_edit_date": 1563964845, "question_id": 57180929, "link": "https://stackoverflow.com/questions/57180929/vba-excel-extract-email-body-multiple-lines-into-excel-cells", "title": "VBA, Excel extract email body multiple lines into excel cells", "body": "<p>I have button that extracts emails body into excel columns(code below),\nMy problem is that \"Issue description:\" sometimes is more than one line and then next column where \"Nav error No:\" should be, is next line from the issue description.</p>\n\n<p>Here is sample of emails the this inbox will receive:</p>\n\n<pre><code>Platform: Nav \nDepartment: HR \nSite: Thailand \nProcess: Test \nArea: Purchase Orders \nIssue description: This is only test \nNav error No.: Error test \n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>For Each olItem In olItems\n    rCount = rCount + 1\n    ws.Range(\"A\" &amp; rCount).Value = olItem.ReceivedTime\n    ws.Range(\"B\" &amp; rCount).Value = olItem.SenderName\n    ws.Range(\"C\" &amp; rCount).Value = olItem.Subject\n\n    arrayLines = Split(olItem.Body, vbCrLf)\n    ws.Range(\"D\" &amp; rCount).Value = Split(arrayLines(0), \": \")(1)  '&lt;--- Platform\n    ws.Range(\"E\" &amp; rCount).Value = Split(arrayLines(1), \": \")(1)  '&lt;--- Department\n    ws.Range(\"F\" &amp; rCount).Value = Split(arrayLines(2), \": \")(1)  '&lt;--- Site\n    ws.Range(\"G\" &amp; rCount).Value = Split(arrayLines(3), \": \")(1)  '&lt;--- Process\n    ws.Range(\"H\" &amp; rCount).Value = Split(arrayLines(4), \": \")(1)  '&lt;--- Area\n    ws.Range(\"I\" &amp; rCount).Value = Split(arrayLines(5), \": \")(1)  '&lt;--- Issue description\n\n    If arrayLines(6) = \"\" Then\n        ws.Range(\"J\" &amp; rCount).Value = \"N/A\"  '&lt;--- Nav error empty\n    Else\n        ws.Range(\"J\" &amp; rCount).Value = Split(arrayLines(6), \": \")(1)  '&lt;--- Nav error message\n    End If\n\nNext olItem\n</code></pre>\n\n<p>I wanted to add to array full length of issue description before moving onto the next column which is nav error.</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1563966725, "post_id": 57180915, "comment_id": 100874041, "body": "Check <a href=\"https://support.office.com/en-us/article/fit-to-one-page-f3015be3-e007-4762-90a7-19ebc8052511?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">Fit to one page</a>. Actually, you can even record a macro to do this and adapt it to your needs."}], "answers": [{"tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1563982496, "creation_date": 1563982496, "answer_id": 57186563, "question_id": 57180915, "link": "https://stackoverflow.com/questions/57180915/how-do-i-fit-my-data-to-one-sheet-when-exporting-to-pdf-in-vba/57186563#57186563", "title": "How do I fit my data to one sheet when exporting to pdf in vba?", "body": "<p>Could you try and see if this works? Also see if setting your print areas properly helps, if not modify that part of the code to <code>True</code></p>\n\n<pre><code>Sub printdispatchsheet()\n\nWith Sheets(\"DispatchSheet\")\n    .PageSetup.Orientation = xlLandscape\n    .PageSetup.Zoom = False\n    .FitToPagesWide = 1\n    .FitToPagesTall = 1\nEnd With\n\nSheets(\"DispatchSheet\").Range(\"A1:J48\").ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=\"c:\\Users\\name\\Desktop\\DispatchSheet.pdf\", _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=True\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11641610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beOUs.png?s=128&g=1", "display_name": "Angie", "link": "https://stackoverflow.com/users/11641610/angie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 57186563, "answer_count": 1, "score": 0, "last_activity_date": 1563982496, "creation_date": 1563964621, "question_id": 57180915, "link": "https://stackoverflow.com/questions/57180915/how-do-i-fit-my-data-to-one-sheet-when-exporting-to-pdf-in-vba", "title": "How do I fit my data to one sheet when exporting to pdf in vba?", "body": "<p>I am trying to export a specific range on one of my excel sheets to pdf. It cuts off a small part at the bottom and puts it on the next page. My question is : How do I change my code below to allow for a \"fit to one page\" option and how do I make the orientation landscape? </p>\n\n<pre><code>Sub printdispatchsheet()\nSheets(\"DispatchSheet\").Range(\"A1:J48\").ExportAsFixedFormat \nType:=xlTypePDF, fileName:= _\n\"c:\\Users\\name\\Desktop\\DispatchSheet.pdf\", Quality:= _\nxlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=True, _\nOpenAfterPublish:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563962973, "post_id": 57180404, "comment_id": 100871844, "body": "Doesn&#39;t this code work ?"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1563963631, "post_id": 57180404, "comment_id": 100872214, "body": "@Walter-moolman: Please tell us what is wrong with the code you have"}, {"owner": {"reputation": 1, "user_id": 11828488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2fb08fa5e828bc266d219ff30e6390?s=128&d=identicon&r=PG&f=1", "display_name": "Walter Moolman", "link": "https://stackoverflow.com/users/11828488/walter-moolman"}, "edited": false, "score": 0, "creation_date": 1563963637, "post_id": 57180404, "comment_id": 100872219, "body": "I am unable to link it to the clear button on user form to be able test.... I know a little bit of coding but struggle with this"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563964522, "post_id": 57180404, "comment_id": 100872774, "body": "@WalterMoolman Whats the name of your button ? ( Properties then check name row)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1563964832, "post_id": 57180404, "comment_id": 100872958, "body": "Walter, double-click the button on the User Form in its &quot;design mode&quot;. That will generate a click event for the button. Then you can add your code, or call the procedure you have from within the &quot;click&quot; procedure."}], "owner": {"reputation": 1, "user_id": 11828488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2fb08fa5e828bc266d219ff30e6390?s=128&d=identicon&r=PG&f=1", "display_name": "Walter Moolman", "link": "https://stackoverflow.com/users/11828488/walter-moolman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563964843, "creation_date": 1563962904, "last_edit_date": 1563964843, "question_id": 57180404, "link": "https://stackoverflow.com/questions/57180404/how-to-use-a-button-on-a-user-form-to-clear-contents-of-content-control-boxes", "title": "How to use a button on a User Form to clear contents of content control boxes", "body": "<p>I am need to clear information from a content control box and not delete the content control box itself when i press clear button on user form.</p>\n\n<p>I am unable to link my code (below) to the clear button on user form to be able test.... </p>\n\n<pre><code>Private Sub DeleteCCByTag_Alternative(ccTag As String)    \n    Dim cc As ContentControl\n    Set cc = ThisDocument.SelectContentControlsByTag(ccTag).Item(1)\n\n    With cc\n\n        .LockContentControl = False\n        .LockContents = False\n\n        .Range.Delete               'to delete CC content\n\n        .Delete (False)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ghostscript"], "comments": [{"owner": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "edited": false, "score": 0, "creation_date": 1563967249, "post_id": 57180324, "comment_id": 100874299, "body": "This seems likely to be fixable by adding extra <code>&quot;</code> arround your file name. Basically changing  <code>-o &quot; &amp; file &amp; &quot;_MONTAGGIO&quot; &amp; &quot;.pdf&quot;</code> to <code>-o &quot;&quot;&quot; &amp; file &amp; &quot;_MONTAGGIO&quot; &amp; &quot;.pdf&quot;&quot;&quot;</code>."}, {"owner": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "edited": false, "score": 0, "creation_date": 1563970439, "post_id": 57180324, "comment_id": 100876073, "body": "My pleasure. :-)"}], "owner": {"reputation": 1, "user_id": 11786104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5b566fcec9fae78d06a62eca30373a?s=128&d=identicon&r=PG&f=1", "display_name": "DannyGi", "link": "https://stackoverflow.com/users/11786104/dannygi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563966367, "creation_date": 1563962662, "last_edit_date": 1563966367, "question_id": 57180324, "link": "https://stackoverflow.com/questions/57180324/crop-multiple-pdf-in-a-folder-using-ghostscript", "title": "Crop multiple pdf in a folder using ghostscript", "body": "<p>I have write a macro that crop single pdf in ghostscript. It work</p>\n\n<pre><code>Sub Ghostcrop()\nDim fname As String\n\n    fname = Application.GetOpenFilename(filefilter:= _\n    \"PDF Files(*.pdf),*.pdf\", Title:=\"Seleziona PDF\")\n\n\n    RetVal = Shell(\"gswin32c.exe -o \" &amp; fname &amp; \"_MONTAGGIO\" &amp; \".pdf\" &amp; \" -sDEVICE=pdfwrite -dFirstPage=1 -dLastPage=1 -dDEVICEWIDTHPOINTS=1200 -dDEVICEHEIGHTPOINTS=850 -dFIXEDMEDIA -f \" &amp; fname, 0)\n\nEnd Sub\n</code></pre>\n\n<p>but when i try to run this script on ALL file in a choose folder, it run smootly but don't do nothing.</p>\n\n<pre><code>Sub LoopCrop()\n    Dim MyObj As Object, MySource As Object, file As Variant\n    Dim xDFileDlg As FileDialog\n\nSet xDFileDlg = Application.FileDialog(msoFileDialogFolderPicker)\n    xDFileDlg.Title = \"Scegliere la cartella di destinazione:\"\n    If xDFileDlg.Show &lt;&gt; -1 Then Exit Sub\n\n    file = Dir(xDFileDlg.SelectedItems.item(1) &amp; \"\\*.pdf\")\n    While (file &lt;&gt; \"\")\n        RetVal = Shell(\"gswin32c.exe -o \" &amp; file &amp; \"_MONTAGGIO\" &amp; \".pdf\" &amp; \" -sDEVICE=pdfwrite -dFirstPage=1 -dLastPage=1 -dDEVICEWIDTHPOINTS=1200 -dDEVICEHEIGHTPOINTS=850 -dFIXEDMEDIA -f \" &amp; file, 0)\n        file = Dir()\n    Wend\nEnd Sub\n</code></pre>\n\n<p>NO errors, no stopping. Someone can help?</p>\n\n<p>edit: the error is a space in path. How i can convert long path in short path?</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1563971836, "post_id": 57180291, "comment_id": 100876928, "body": "It is very strange that this code cause that error. What is happened if the same user presses button twice ?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1564235685, "post_id": 57180291, "comment_id": 100968177, "body": "Your code looks fine.  I&#39;m not sure you can make an update like this is several people are sharing the Access file.  Can you try it when no one has the file open except you?  That should work.  Also, on network drives I have seen very weird things.  At one firm where I worked, I used code that worked totally fine, but that same code didn&#39;t work at a different firm.  I&#39;m guessing it has to do with the way the network is configured, but I couldn&#39;t actually prove it."}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 6570713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SrIS2.jpg?s=128&g=1", "display_name": "Alvaro CC", "link": "https://stackoverflow.com/users/6570713/alvaro-cc"}, "is_accepted": false, "score": -1, "last_activity_date": 1563965207, "creation_date": 1563965207, "answer_id": 57181103, "question_id": 57180291, "link": "https://stackoverflow.com/questions/57180291/vba-multiple-users-to-update-same-table-in-a-shared-ms-access-database-using-dao/57181103#57181103", "title": "VBA multiple users to update same table in a shared MS-Access database using DAO", "body": "<p>Well , this is not probably the most elegant solution </p>\n\n<p>but you may create a field in a table , and ask for it before working with the table </p>\n\n<p>something like this :</p>\n\n<pre><code>Set LockedStatus= oDB.OpenRecordset(\"mycontroltable\")\nif LockedStatus(\"lockedSuppiers\")=False then \n  oDB.Execute\"update mycontroltable set lockedSuppiers=true\"\n\nSet oRS = oDB.OpenRecordset(\"tblSuppliers\")\n\n    For i = 2 To oSelect.Rows.Count 'skip label row\n        oRS.AddNew\n        For j = 1 To oSelect.Columns.Count 'Field(0) is Auto#\n            oRS.Fields(j) = oSelect.Cells(i, j)\n        ........\n\n         ......\n\n     oDB.Execute\"update mycontroltable set lockedSuppiers=false\"\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1563996650, "creation_date": 1563996650, "answer_id": 57190044, "question_id": 57180291, "link": "https://stackoverflow.com/questions/57180291/vba-multiple-users-to-update-same-table-in-a-shared-ms-access-database-using-dao/57190044#57190044", "title": "VBA multiple users to update same table in a shared MS-Access database using DAO", "body": "<p>You need some type of flag to tell if anyone is updating the table or not. Examples of what this flag can be:</p>\n\n<ul>\n<li>An Excel file cell (that is probably the easiest in your case; if multiple excel files are used, just link to the one cell)</li>\n<li>A field in an Access table (even a table with a single field and a single record dedicated just for that)</li>\n<li>A (text) file in your shared drive (the flag can be the content of the file or even whether the file exists or not)</li>\n</ul>\n\n<p>Then your update process would be:</p>\n\n<pre><code>- Check the flag, if set, loop until flag is cleared\n- Set the flag\n- Update the table\n- Clear the flag\n</code></pre>\n\n<p>You will probably also need some way for the users (or just you) to clear the flag manually, in case something else goes wrong while updating the table and the flag gets stuck raised.</p>\n"}], "owner": {"reputation": 81, "user_id": 7095552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc9a111db37d9b6ba48db91eb58664b?s=128&d=identicon&r=PG&f=1", "display_name": "K-Laboratory", "link": "https://stackoverflow.com/users/7095552/k-laboratory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 520, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563996650, "creation_date": 1563962544, "last_edit_date": 1563970217, "question_id": 57180291, "link": "https://stackoverflow.com/questions/57180291/vba-multiple-users-to-update-same-table-in-a-shared-ms-access-database-using-dao", "title": "VBA multiple users to update same table in a shared MS-Access database using DAO", "body": "<p>Excel crashes, VBA raises Error 3218 \u201cCould Not Update\u201d Record Locking Errors when multiple users try to update same table in a shared MS-Access database using DAO.</p>\n\n<p>I have a special configuration like this: a MS-Access database located in shared network folder, multiple user connect to update that database using VBA DAO build on Excel file. The VBA code in each Excel file is the same. The problem happens when there are 2 users click on update button at the same time. User Excel file turn hanging, or showing error 3218 \"Could not update\".</p>\n\n<pre><code>Sub ExportToAccess()\n    Dim oSelect As Range, i As Long, j As Integer, sPath As String\n    'tblSuppliers.Active\n    Set oSelect = Application.InputBox(\"Range\", , Range(\"A1\").CurrentRegion.Address, , , , , 8)\n\n    Dim oDAO As DAO.DBEngine, oDB As DAO.Database, oRS As DAO.Recordset\n    sPath = \"\\\\sharedfolder\\Database.accdb\"\n\n    Set oDAO = New DAO.DBEngine\n    Set oDB = oDAO.OpenDatabase(sPath)\n    Set oRS = oDB.OpenRecordset(\"tblSuppliers\")\n\n    For i = 2 To oSelect.Rows.Count 'skip label row\n        oRS.AddNew\n        For j = 1 To oSelect.Columns.Count 'Field(0) is Auto#\n            oRS.Fields(j) = oSelect.Cells(i, j)\n\n        Next j\n        oRS.Update\n    Next i\n    oDB.Close\n    MsgBox (\"Updated Done!\")\n\nEnd Sub\n</code></pre>\n\n<p>I know my configuration is not good for database application, however I have to stick with this for a while. Could you please advise any solutions to avoid error when multiple users update Access database in this case ? Is there a way to detect if database is being updating by others and script to wait until that process to finish first. Any technical solution for this issue is welcome!\nThank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 1, "creation_date": 1563962944, "post_id": 57180222, "comment_id": 100871822, "body": "Welcome to SO. What you are trying to do is fairly easy and there&#39;s a ton of examples in here. You will need to work with the <code>Microsoft HTML Object Library</code> and use the <code>HTMLDocument</code> and <code>HTMLAnchorElement</code> objects as well as methods like <code>.getElementsByTagName()</code>. That&#39;s a good starting point for you to start researching."}, {"owner": {"reputation": 1, "user_id": 9756364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T31V4P8YCA4/AAAAAAAAAAI/AAAAAAAAHDo/OipgkpdDUL0/photo.jpg?sz=128", "display_name": "Hung Lam Vu Ngo", "link": "https://stackoverflow.com/users/9756364/hung-lam-vu-ngo"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1564028436, "post_id": 57180222, "comment_id": 100897201, "body": "is it more simple if I change HTML to text file ( .txt extension) ? with that, is it easier to read text file line by line or read in particular line number ?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1564036048, "post_id": 57180222, "comment_id": 100899738, "body": "No. HTML is easier. Try researching the stuff I mentioned in the comment above. When and if you come up with a more specific question, you can post a new question showcasing your efforts and asking for targeted help. Keep in mind that SO is not a free coding service. Cheers."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1564235843, "creation_date": 1564235843, "answer_id": 57232794, "question_id": 57180222, "link": "https://stackoverflow.com/questions/57180222/vba-code-to-get-data-from-local-html-file/57232794#57232794", "title": "VBA Code to Get data from local HTML file", "body": "<p>If you want to import multiple images into separate rows in Excel you can use the either of the techniques below.</p>\n\n<p>Technique #1:</p>\n\n<pre><code>Sub InsertPics()\nDim fPath As String, fName As String\nDim r As Range, rng As Range\n\nApplication.ScreenUpdating = False\nfPath = \"C:\\Users\\Public\\Pictures\\Sample Pictures\\\"\nSet rng = Range(\"A1:A\" &amp; Cells(Rows.Count, 1).End(xlUp).Row)\ni = 1\n\nFor Each r In rng\n    fName = Dir(fPath)\n    Do While fName &lt;&gt; \"\"\n        If fName = r.Value Then\n            With ActiveSheet.Pictures.Insert(fPath &amp; fName)\n                .ShapeRange.LockAspectRatio = msoTrue\n                Set px = .ShapeRange\n                If .ShapeRange.Width &gt; Rows(i).Columns(2).Width Then .ShapeRange.Width = Columns(2).Width\n                    With Cells(i, 2)\n                        px.Top = .Top\n                        px.Left = .Left\n                        .RowHeight = px.Height\n                    End With\n            End With\n        End If\n        fName = Dir\n    Loop\n    i = i + 1\nNext r\nApplication.ScreenUpdating = True\nEnd Sub\n\n' Note: you need the file extension, such as ',jpg', or whatever you are using, so you can match on that.\n</code></pre>\n\n<p>Technique #2:</p>\n\n<pre><code>Sub Insert()\n\n    Dim strFolder As String\n    Dim strFileName As String\n    Dim objPic As Picture\n    Dim rngCell As Range\n\n    strFolder = \"C:\\Users\\Public\\Pictures\\Sample Pictures\\\" 'change the path accordingly\n    If Right(strFolder, 1) &lt;&gt; \"\\\" Then\n        strFolder = strFolder &amp; \"\\\"\n    End If\n\n    Set rngCell = Range(\"E1\") 'starting cell\n\n    strFileName = Dir(strFolder &amp; \"*.jpg\", vbNormal) 'filter for .png files\n\n    Do While Len(strFileName) &gt; 0\n        Set objPic = ActiveSheet.Pictures.Insert(strFolder &amp; strFileName)\n        With objPic\n            .Left = rngCell.Left\n            .Top = rngCell.Top\n            .Height = rngCell.RowHeight\n            .Placement = xlMoveAndSize\n        End With\n        Set rngCell = rngCell.Offset(1, 0)\n        strFileName = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9756364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T31V4P8YCA4/AAAAAAAAAAI/AAAAAAAAHDo/OipgkpdDUL0/photo.jpg?sz=128", "display_name": "Hung Lam Vu Ngo", "link": "https://stackoverflow.com/users/9756364/hung-lam-vu-ngo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564235843, "creation_date": 1563962357, "last_edit_date": 1563964301, "question_id": 57180222, "link": "https://stackoverflow.com/questions/57180222/vba-code-to-get-data-from-local-html-file", "title": "VBA Code to Get data from local HTML file", "body": "<p>I am very basic in VBA for excel and working on a job like copy data from a HTML file which is containing repeated structure (a module) as image. Each module, I want to get the data then copy it to each excel row. Please see the image for better understanding my intention.\n<a href=\"https://i.stack.imgur.com/5OXUC.jpg\" rel=\"nofollow noreferrer\">click for image</a>\nAny idea of coding or codes would be highly appreciated.</p>\n\n<p>Thank you.\nHung Lam</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563961207, "post_id": 57179773, "comment_id": 100870819, "body": "what do you mean by toggle between two macros ?"}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1563963023, "creation_date": 1563963023, "answer_id": 57180437, "question_id": 57179773, "link": "https://stackoverflow.com/questions/57179773/toggling-between-filtering-blank-and-filled-cells-in-a-table-using-vba/57180437#57180437", "title": "Toggling between filtering blank and filled cells in a table using VBA", "body": "<p>The base for toggling is to find out what the current value is, and pick the other. If it already is defined, then it would look something like this:</p>\n\n<pre><code>If lo.AutoFilter.Filters(iCol).Criteria1 = \"&lt;&gt;\" Then\n    lo.Range.AutoFilter Field:=iCol, Criteria1:=\"=\"\nElse\n    lo.Range.AutoFilter Field:=iCol, Criteria1:=\"&lt;&gt;\"\nEnd If\n</code></pre>\n\n<p>This is enough if it already is defined. If it isn't, then you would have to add some extra checks:</p>\n\n<pre><code>Sub ToggleFilter()\n    Dim lo As ListObject\n    Dim iCol As Long\n\n    Set lo = ActiveSheet.ListObjects(1)\n    iCol = lo.ListColumns(\"Completed\").Index\n\n    On Error GoTo EH_ToggleFilter\n\n    If lo.AutoFilter.Filters(iCol).Criteria1 = \"&lt;&gt;\" Then\n        lo.Range.AutoFilter Field:=iCol, Criteria1:=\"=\"\n    Else\n        lo.Range.AutoFilter Field:=iCol, Criteria1:=\"&lt;&gt;\"\n    End If\n\n    Exit Sub\n\nEH_ToggleFilter:\n    lo.Range.AutoFilter Field:=iCol, Criteria1:=\"=\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5470687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b682b5653ed86306bb0e94c54eec68?s=128&d=identicon&r=PG&f=1", "display_name": "Flippin Pippin", "link": "https://stackoverflow.com/users/5470687/flippin-pippin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 57180437, "answer_count": 1, "score": 0, "last_activity_date": 1563975323, "creation_date": 1563960989, "last_edit_date": 1563975323, "question_id": 57179773, "link": "https://stackoverflow.com/questions/57179773/toggling-between-filtering-blank-and-filled-cells-in-a-table-using-vba", "title": "Toggling between filtering blank and filled cells in a table using VBA", "body": "<p>Im fairly new to VBA and Im working on a set of filter macros for a table of customers.</p>\n\n<p>Im currently using two macros: one to filter out blank cells in a column and the other to filter out filled cells in said column. It works but I want to incorporate it into a single macro to toggle between two filter criteria and I was wondering whether it was possible to do it without using variables.\nIm trying to keep it as simple as possible.</p>\n\n<p>Heres what Im currently using:</p>\n\n<pre><code>Sub FilterEmpty()\n\nDim lo As ListObject\nDim iCol As Long\n\n  Set lo = ActiveSheet.ListObjects(1)\n    iCol = lo.ListColumns(\"Completed\").Index\n      lo.Range.AutoFilter Field:=iCol, Criteria1:=\"&lt;&gt;\" \n'replace &lt;&gt; with = for filled \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "answers": [{"tags": [], "owner": {"reputation": 1569, "user_id": 8945026, "user_type": "registered", "profile_image": "https://graph.facebook.com/1874498662590388/picture?type=large", "display_name": "Olivier Depriester", "link": "https://stackoverflow.com/users/8945026/olivier-depriester"}, "is_accepted": true, "score": 0, "last_activity_date": 1563961464, "creation_date": 1563961464, "answer_id": 57179928, "question_id": 57179748, "link": "https://stackoverflow.com/questions/57179748/navigating-date-picker-in-ie-using-vba/57179928#57179928", "title": "Navigating Date Picker in IE using VBA", "body": "<p>In Excel, dates are stored as a decimal value.\nI guess your HTML expects a string so try to format : </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>HTMLDoc.getElementById(\"dtStartDate\").Value = Format(Sheets(\"Attendance\").Range(\"B6\").Value, \"yyyy-mm-dd\")\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4343895, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620301266/picture?type=large", "display_name": "Hervie", "link": "https://stackoverflow.com/users/4343895/hervie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 57179928, "answer_count": 1, "score": 1, "last_activity_date": 1563961464, "creation_date": 1563960925, "last_edit_date": 1563961243, "question_id": 57179748, "link": "https://stackoverflow.com/questions/57179748/navigating-date-picker-in-ie-using-vba", "title": "Navigating Date Picker in IE using VBA", "body": "<p>I'm trying to automate a report of mine and I can't seem to find the right code for entering the start and end date of my reports. I can't post the link since it's a client web based tool.</p>\n\n<p>I have tried setting up the date via getElementByID and it changes the date but it doesn't extract the data (no data at all). When I don't input any date codes at all, it extracts the data for today with no issues.</p>\n\n<p>I think I need to set up the dates via it's date picker to fully extract the data. I hope someone can walk me through that process.</p>\n\n<p>Commented codes are what I've tried so far and attached pics are for the HTML Files.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SA8OH.png\" rel=\"nofollow noreferrer\">Start End Date</a>\n<a href=\"https://i.stack.imgur.com/WYsMH.png\" rel=\"nofollow noreferrer\">Date Picker Start Date</a></p>\n\n<pre><code>Sub Get_RawFile()\n    '\n    '\n    '\n    Dim IE As New InternetExplorer\n    Dim HTMLDoc As HTMLDocument\n    Dim HTMLselect As HTMLSelectElement\n\n    With IE\n        .Visible = True\n        .Navigate (\"--------------------------\")\n\n    While IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\n\n    Set HTMLDoc = IE.document\n    HTMLDoc.all.UserName.Value = Sheets(\"Data Dump\").Range(\"A1\").Value\n    HTMLDoc.all.Password.Value = Sheets(\"Data Dump\").Range(\"B1\").Value\n    HTMLDoc.getElementById(\"login-btn\").Click\n\n    While IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n\n    Set objButton = HTMLDoc.getElementById(\"s2id_ddlReportType\")\n    Set HTMLselect = HTMLDoc.getElementById(\"ddlReportType\")\n    objButton.Focus\n    HTMLselect.Value = \"1\"\n\n    Set HTMLselectZone = HTMLDoc.getElementById(\"ddlTimezone\")\n    HTMLselectZone.Value = Sheets(\"Data Dump\").Range(\"B9\").Value\n\n    Set subgroups = HTMLDoc.getElementById(\"s2id_ddlSubgroups\")\n    subgroups.Click\n    Set subgroups2 = HTMLDoc.getElementById(\"ddlSubgroups\")\n    subgroups2.Value = \"1456_17\"\n\n    'HTMLDoc.getElementById(\"dtStartDate\").Value = Sheets(\"Attendance\").Range(\"B6\").Value\n    'HTMLDoc.getElementById(\"dtStartDate\").Click\n\n    'HTMLDoc.getElementById(\"dtEndDate\").Value = Sheets(\"Attendance\").Range(\"X6\").Value\n    'HTMLDoc.getElementById(\"dtEndDate\").Click\n\n\n       HTMLDoc.getElementById(\"btnGetReport\").Click\n       Application.Wait (Now + TimeValue(\"0:00:10\"))\n\n       HTMLDoc.getElementById(\"btnDowloadReport\").Click\n\n       End With\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 2, "last_activity_date": 1563960468, "creation_date": 1563960468, "answer_id": 57179595, "question_id": 57179119, "link": "https://stackoverflow.com/questions/57179119/subscript-out-of-range-at-debug-print-arri-1/57179595#57179595", "title": "Subscript out of range at: Debug.Print arr(i, 1)", "body": "<p>Your line <code>arr = Array(.Keys, .items)</code> is creating an array of arrays and not an array of those items.</p>\n\n<p>i.e. <code>Array(Array(1,2,3), Array(4,5,6))</code></p>\n\n<p>To loop through this you would need to do something like</p>\n\n<pre><code>For i = LBound(arr, 1) To UBound(arr, 1)\n    For j = LBound(arr(i)) to UBound(arr(i))\n        Debug.Print arr(i)(j)\n    Next j\nNext i\n</code></pre>\n\n<p>To avoid doing this and loop through as you're currently you could add to your array as you add to your dictionary</p>\n"}], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 57179595, "answer_count": 1, "score": 0, "last_activity_date": 1563960468, "creation_date": 1563959017, "last_edit_date": 1563959342, "question_id": 57179119, "link": "https://stackoverflow.com/questions/57179119/subscript-out-of-range-at-debug-print-arri-1", "title": "Subscript out of range at: Debug.Print arr(i, 1)", "body": "<p>I am trying to iterate through an array using:-</p>\n\n<pre><code>For i = LBound(arr, 1) To UBound(arr, 1)\n    Debug.Print arr(i, 1)\nNext i\n</code></pre>\n\n<p>but receive a Subscript out of range error at <code>Debug.Print arr(i, 1)</code> which I do not understand. The code works fine if I take out the above lines.</p>\n\n<pre><code>Sub Summarise()\n    Dim dict\n    Dim i As Long\n    Dim arr() As Variant\n    Dim n As Long\n    Dim ws As Worksheet\n    Dim ws2 As Worksheet\n\n    Set ws2 = Worksheets(\"Plan\")\n    Set ws = Worksheets(\"Data\")\n    dict = ws.[A1].CurrentRegion.Value\n    With CreateObject(\"Scripting.Dictionary\")\n        For i = 1 To UBound(dict, 1)\n            .Item(dict(i, 1)) = .Item(dict(i, 1)) + dict(i, 5)\n        Next\n        arr = Array(.Keys, .items)\n        n = .Count\n    End With\n\n    For i = LBound(arr, 1) To UBound(arr, 1)\n        Debug.Print arr(i, 1)\n    Next i\n\n    ws2.[A1].CurrentRegion.ClearContents\n    ws2.[A1].Resize(n, 2).Value = Application.Transpose(arr)   \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1563958985, "post_id": 57179091, "comment_id": 100869663, "body": "+= doesn&#39;t exist in VBA need to do something like this: <code>Workbooks(&quot;StockList.xlsx&quot;).Worksheets(&quot;Sheet1&quot;).Range(&quot;C1&quot;)&zwnj;&#8203;.Value = Workbooks(&quot;StockList.xlsx&quot;).Worksheets(&quot;Sheet1&quot;).Range(&quot;C1&quot;)&zwnj;&#8203;.Value + itemA</code>"}, {"owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 0, "creation_date": 1568391981, "post_id": 57179091, "comment_id": 102272087, "body": "Please do not edit your question with the answer. If you would like to leave the full solution, please write an answer to your own question. And be very clear that you are copying someone&#39;s answer into yours."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11828949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7a0c5975799c36491a26718908bf98?s=128&d=identicon&r=PG&f=1", "display_name": "OptimusFridge", "link": "https://stackoverflow.com/users/11828949/optimusfridge"}, "edited": false, "score": 0, "creation_date": 1563960332, "post_id": 57179352, "comment_id": 100870361, "body": "Thank you this looks very helpful! I don&#39;t have time to try it now but will get back to you soon. With this code do you not have to explicitly open the StockList.xlsx with Workbooks.Open as you are editing the file?"}, {"owner": {"reputation": 1569, "user_id": 8945026, "user_type": "registered", "profile_image": "https://graph.facebook.com/1874498662590388/picture?type=large", "display_name": "Olivier Depriester", "link": "https://stackoverflow.com/users/8945026/olivier-depriester"}, "reply_to_user": {"reputation": 3, "user_id": 11828949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7a0c5975799c36491a26718908bf98?s=128&d=identicon&r=PG&f=1", "display_name": "OptimusFridge", "link": "https://stackoverflow.com/users/11828949/optimusfridge"}, "edited": false, "score": 0, "creation_date": 1563960505, "post_id": 57179352, "comment_id": 100870437, "body": "Yes you can : <code>Set wbStockList = Workbooks.Open(&quot;C:\\Path\\To\\My\\File\\StockList.xlsx&quot;)</code>"}, {"owner": {"reputation": 3, "user_id": 11828949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7a0c5975799c36491a26718908bf98?s=128&d=identicon&r=PG&f=1", "display_name": "OptimusFridge", "link": "https://stackoverflow.com/users/11828949/optimusfridge"}, "edited": false, "score": 0, "creation_date": 1564050012, "post_id": 57179352, "comment_id": 100907315, "body": "Looks like your suggestion would work perfectly, but <code>mySheet.Range(&quot;C1&quot;).Value = mySheet.Range(&quot;C1&quot;).Value + itemA</code> fails, with a type mismatch error. The issue is itemA is an integer but C1 is a boolean. It contains <code>0</code>, which is formatted as a number but the code keeps seeing it as a boolean <code>True</code>. I could add code to store it and convert it into 0 but I&#39;d have to do that MANY times with many items. Can I not tell it the 0 is a number..."}, {"owner": {"reputation": 1569, "user_id": 8945026, "user_type": "registered", "profile_image": "https://graph.facebook.com/1874498662590388/picture?type=large", "display_name": "Olivier Depriester", "link": "https://stackoverflow.com/users/8945026/olivier-depriester"}, "reply_to_user": {"reputation": 3, "user_id": 11828949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7a0c5975799c36491a26718908bf98?s=128&d=identicon&r=PG&f=1", "display_name": "OptimusFridge", "link": "https://stackoverflow.com/users/11828949/optimusfridge"}, "edited": false, "score": 0, "creation_date": 1564051200, "post_id": 57179352, "comment_id": 100908009, "body": "Weird : I thought to be a boolean your cell should contain the string value <code>TRUE</code> or <code>FALSE</code> (actually it depends on your Office language, mine is French so the key values are <code>VRAI</code> and <code>FAUX</code>). And VBA can add a boolean and an integer without cast error. Are you sure C1 is not the cell that contains your column title &quot;Allocated&quot; ?"}, {"owner": {"reputation": 3, "user_id": 11828949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7a0c5975799c36491a26718908bf98?s=128&d=identicon&r=PG&f=1", "display_name": "OptimusFridge", "link": "https://stackoverflow.com/users/11828949/optimusfridge"}, "edited": false, "score": 0, "creation_date": 1564053060, "post_id": 57179352, "comment_id": 100909015, "body": "OKay that was the issue, but just as a curious side note, I was printing the variables to a msgbox in the debug process and weirdly enough all my column headers (Namely &#39;Item&#39;, &#39;Stock&#39;, &#39;Allocated&#39; and &#39;Free&#39;) had values &#39;True&#39; in the script. I might have a few other queries in bound but thank you a lot for your help."}], "tags": [], "owner": {"reputation": 1569, "user_id": 8945026, "user_type": "registered", "profile_image": "https://graph.facebook.com/1874498662590388/picture?type=large", "display_name": "Olivier Depriester", "link": "https://stackoverflow.com/users/8945026/olivier-depriester"}, "is_accepted": false, "score": 0, "last_activity_date": 1563959781, "creation_date": 1563959781, "answer_id": 57179352, "question_id": 57179091, "link": "https://stackoverflow.com/questions/57179091/how-to-update-not-replace-data-in-one-workbook-from-another/57179352#57179352", "title": "How to update, not replace, data in one workbook from another?", "body": "<p>I agree with @Marco Getrost but you could make your code easier by using the Workbook, Worksheet and Range data types :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim myWorkbook as Workbook\nDim mySheet as Worksheet\nDim myCell as Range\n' Get a workbook - \nSet myWorkbook = Workbooks(\"StockList.xlsx\")\n' Get a worksheet \nSet mySheet = myWorkbook.Worksheets(\"Sheet1\")\n' Both lines below are equivalent\nSet myCell = mySheet.Cells(1, 3)\nSet myCell = mySheet.Range(\"C1\")\n' Increase the value of your cell\nmyCell.Value = myCell.Value + itemA\n</code></pre>\n\n<p>Of course this is useful if you reuse these variables in your code. I am not saying here that typing 10 lines is easier than 1 :)</p>\n"}], "owner": {"reputation": 3, "user_id": 11828949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a7a0c5975799c36491a26718908bf98?s=128&d=identicon&r=PG&f=1", "display_name": "OptimusFridge", "link": "https://stackoverflow.com/users/11828949/optimusfridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568482113, "creation_date": 1563958917, "last_edit_date": 1568482113, "question_id": 57179091, "link": "https://stackoverflow.com/questions/57179091/how-to-update-not-replace-data-in-one-workbook-from-another", "title": "How to update, not replace, data in one workbook from another?", "body": "<p>I have a workbook called StockList, containing a list of items, their stock count and their allocation count.</p>\n\n<p>I have multiple 'jobs', each with its own Excel workbook for keeping data and producing documents etc.</p>\n\n<p>Each job's workbook will have the items needed and how many of those items.</p>\n\n<p>I want to have an 'allocation' and 'close' tool for each job's workbook, where the items in that job's workbook get added to the allocation cell for that item in the StockList.</p>\n\n<p>Here is the desired effect,</p>\n\n<hr>\n\n<p><strong>ExampleJobWorkbook</strong></p>\n\n<p>Item    QTY<br>\nItemA    4<br>\nItemB    4<br>\nItemC    5<br>\nItemD    5</p>\n\n<p>(ALLOCATE BUTTON)\n(CLOSE BUTTON)</p>\n\n<hr>\n\n<p><strong>StockList</strong></p>\n\n<p>Item   Qty  Allocated<br>\nItemA  50   0<br>\nItemB  50   4<br>\nItemC  50   4<br>\nItemD  50   0</p>\n\n<p>When Allocate is clicked in the Job workbook above, the Stocklist becomes</p>\n\n<p>Item   Qty  Allocated<br>\nItemA  50   4<br>\nItemB  50   8<br>\nItemC  50   9<br>\nItemD  50   5</p>\n\n<p>At some point after allocation the job will be closed with the close button, then the StockList reads</p>\n\n<p>Item   Qty  Allocated<br>\nItemA  46   0<br>\nItemB  46   4<br>\nItemC  45   4<br>\nItemD  45   0</p>\n\n<p>I have made activex buttons and written scripts to select the data I need and then open the StockList. I had hoped to use the += operator below but it won't compile.</p>\n\n<pre><code>Workbooks(\"StockList.xlsx\").Worksheets(\"Sheet1\").Range(\"C1\").Value += itemA\n</code></pre>\n\n<p>I can't just change the value as it needs to ADD to the value already on the stocklist (multiple jobs at once).</p>\n\n<p>I'm also looking for a way to find the specific items required by a job in the StockList and then updating their cells accordingly. Right now I am just mapping each item in the job workbook to the stocklist, but there are many items in the stocklist and not all are used by a job!</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563959313, "post_id": 57178925, "comment_id": 100869833, "body": "Try <code>.PasteSpecial Link:=False, DataType:=wdPasteOLEObject</code> instead of <code>.PasteAndFormat Type:=wdChart</code>"}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563959746, "post_id": 57178925, "comment_id": 100870044, "body": "It changes appearance and size of chart. Also I need series data when I edit it, but no link to original file."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563960040, "post_id": 57178925, "comment_id": 100870201, "body": "Use <code>DataType:=26</code> for that"}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563960748, "post_id": 57178925, "comment_id": 100870572, "body": "If I use .PasteSpecial Link:=False, DataType:=wdPasteShape it does not resize chart, however if I press edit data on chart in word, it is accessing original excel file, that word user will not have."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563960819, "post_id": 57178925, "comment_id": 100870614, "body": "It&#39;s hard to understand what you want like this. Can you share screenshots of what you are looking for ? Also, I asked you to use <code>DataType:=26</code>"}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563961690, "post_id": 57178925, "comment_id": 100871078, "body": "it is like this <a href=\"https://failiem.lv/u/dapzyu5w\" rel=\"nofollow noreferrer\">failiem.lv/u/dapzyu5w</a>"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563961884, "post_id": 57178925, "comment_id": 100871200, "body": "You can paste it as Image if you don&#39;t want data to be connected. There is no option where you can transfer data as well to Word."}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563961971, "post_id": 57178925, "comment_id": 100871254, "body": "There is, as I have document like this <a href=\"https://failiem.lv/u/6ehyuqaf\" rel=\"nofollow noreferrer\">failiem.lv/u/6ehyuqaf</a> . I&#39;m trying to replicate it. See difference?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563962265, "post_id": 57178925, "comment_id": 100871426, "body": "Which option do  you choose manually when you paste this chart ?"}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563963653, "post_id": 57178925, "comment_id": 100872233, "body": "Have no idea, I got it from coworker as example. It is in word file, word file can be sent around without linking data to excel file. And data for that chart is in word file, when you click on edit chart."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563963930, "post_id": 57178925, "comment_id": 100872403, "body": "Actually, that appears when you manually insert a chart n Word. It have it&#39;s own Excel Spreadsheet with data. Try it yourself once, add a chart in Word."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563964175, "post_id": 57178925, "comment_id": 100872566, "body": "You can try and copy the Data from Excel and insert new chart in Word for this."}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563964469, "post_id": 57178925, "comment_id": 100872743, "body": "Hmm yes I want to recreate it but with macro. Better would be to copy chart, because I want to keep formatting, and then somehow break link with excel, and store data in word for that chart."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1563962018, "last_edit_date": 1563962018, "creation_date": 1563960113, "answer_id": 57179456, "question_id": 57178925, "link": "https://stackoverflow.com/questions/57178925/how-to-copy-chart-from-excel-to-word-and-embed-chart-data-in-word-file/57179456#57179456", "title": "How to copy chart from excel to word and embed chart data in word file", "body": "<p><strong>Change:</strong></p>\n\n<p><code>.PasteAndFormat Type:=wdChart</code></p>\n\n<p><strong>With:</strong></p>\n\n<p><code>.PasteSpecial Link:=False, DataType:=26</code> </p>\n\n<p>That should paste the Object correctly with Data and Without Link</p>\n\n<p>You can Try with <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.wdpastedatatype\" rel=\"nofollow noreferrer\">these</a> different datatypes if this one is not what you need.</p>\n"}, {"tags": [], "owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "is_accepted": false, "score": 0, "last_activity_date": 1564731716, "creation_date": 1564731716, "answer_id": 57321948, "question_id": 57178925, "link": "https://stackoverflow.com/questions/57178925/how-to-copy-chart-from-excel-to-word-and-embed-chart-data-in-word-file/57321948#57321948", "title": "How to copy chart from excel to word and embed chart data in word file", "body": "<p>To reader in future: I was unable to find easy copy/paste solution to copy chart form excel to word. So I created this monstrosity. It creates chart in word, copies data for chart form excel file and embeds data in word file. Loads chart settings from excel files cells for ease of changing chart appearance. Resulting word document is independent and with chart data, and can be sent to anyone.</p>\n\n<pre><code>Sub GenerateReport()\nDim Wapp As Object\n    'Launches word application\n    Set Wapp = CreateObject(\"Word.Application\")\n    Wapp.Visible = True\n    Wapp.Activate\n...\n   Call CreateChart(Wapp)\nEnd Sub\n\n'Procedure, that creates chart in Word\nSub CreateChart(Wapp As Object)    \nDim Ch4y As Word.InlineShape\nDim EmChData As Excel.Worksheet\nDim SrDataSh As Excel.Worksheet\nDim FomtCh As Excel.ChartObject\nDim DbWidth As Double\nDim DbHeight As Double\nDim DbIndentCh As Double\nDim DbLineWeight As Double\nDim DbDegrees As Double\nDim DbChLeHeight As Double\nDim DbChLeWidth As Double\nDim DbChLeLeft As Double\nDim DbChLeTop As Double\nDim LnChType As Long\nDim LnXLabelSpace As Long\nDim LnYMayorUnit As Long\nDim LnYMinimumScale As Long\nDim LnChBorder As Long\nDim LnChFontSize As Long\nDim BoLegend As Boolean\nDim BoTitle As Boolean\nDim In1 As Integer\nDim In2 As Integer\nDim In3 As Integer\nDim In4 As Integer\nDim In5 As Integer\nDim In6 As Integer\nDim In7 As Integer\nDim In8 As Integer\nDim In9 As Integer\nDim StChFont As String\n    'Creates new chart in word\n    Set Ch4y = Wapp.ActiveDocument.InlineShapes.AddChart2\n    'Embed data in chart, to make it independent form excel\n    'Creates reference to place where data will be stored\n    Set EmChData = Ch4y.Chart.ChartData.Workbook.Worksheets(1)\n    'Creates reference to source data sheet\n    Set SrDataSh = Excel.ThisWorkbook.Sheets(\"DOC\")\n    'Loads data from Excel sheet for customizability\n    DbWidth = SrDataSh.Range(\"A159\").Value '490\n    DbHeight = SrDataSh.Range(\"A160\").Value '180\n    DbIndentCh = SrDataSh.Range(\"A161\").Value '0\n    LnChType = SrDataSh.Range(\"A162\").Value '4\n    BoLegend = SrDataSh.Range(\"A163\").Value 'True\n    BoTitle = SrDataSh.Range(\"A164\").Value 'False\n    In1 = SrDataSh.Range(\"A166\").Value '139\n    In2 = SrDataSh.Range(\"A167\").Value '231\n    In3 = SrDataSh.Range(\"A168\").Value '246\n    In4 = SrDataSh.Range(\"A170\").Value '0\n    In5 = SrDataSh.Range(\"A171\").Value '133\n    In6 = SrDataSh.Range(\"A172\").Value '155\n    DbLineWeight = SrDataSh.Range(\"A173\").Value '1.75\n    DbDegrees = SrDataSh.Range(\"A174\").Value '90\n    LnXLabelSpace = SrDataSh.Range(\"A175\").Value '1\n    LnYMayorUnit = SrDataSh.Range(\"A176\").Value '10\n    LnYMinimumScale = SrDataSh.Range(\"A177\").Value '70\n    LnChBorder = SrDataSh.Range(\"A178\").Value '-4142\n    StChFont = SrDataSh.Range(\"A179\").Value 'Open Sans\n    LnChFontSize = SrDataSh.Range(\"A180\").Value '9\n    In7 = SrDataSh.Range(\"A182\").Value '151\n    In8 = SrDataSh.Range(\"A183\").Value '151\n    In9 = SrDataSh.Range(\"A184\").Value '151\n    DbChLeHeight = SrDataSh.Range(\"A185\").Value '18\n    DbChLeWidth = SrDataSh.Range(\"A186\").Value '200\n    DbChLeLeft = SrDataSh.Range(\"A187\").Value '140\n    DbChLeTop = SrDataSh.Range(\"A188\").Value '155\n    'Clears range\n    EmChData.Range(\"A1:XFD1048576\").Clear\n    'Copy data\n    EmChData.Range(\"A1:C49\").Value = SrDataSh.Range(\"B109:D157\").Value\n    'Set Source data\n    Ch4y.Chart.SetSourceData Source:=\"'Sheet1'!$A$1:$C$49\", PlotBy:=xlColumns\n    'Create reference to excel chart\n    Set FomtCh = ThisWorkbook.Sheets(\"Doc\").ChartObjects(1)\n    With Wapp\n        With .Selection\n            'This line change position of chart that will be created to left or to right\n            .ParagraphFormat.LeftIndent = DbIndentCh\n        End With\n    End With\n    'Creates needed formating\n    With Ch4y\n        'Set size for chart\n        .Width = DbWidth\n        .Height = DbHeight\n        With .Chart\n            'Sets chart type\n            .ChartType = LnChType\n            'Sets chart legend to visible/unvisable\n            .HasLegend = BoLegend\n            'Sets chart title visible/unvisable\n            .HasTitle = BoTitle\n            'Sets color back to original for data series lines (for some reason it is not pasted in previous line)\n            .SeriesCollection(1).Format.Line.ForeColor.RGB = RGB(In1, In2, In3)\n            .SeriesCollection(2).Format.Line.ForeColor.RGB = RGB(In4, In5, In6)\n            'Sets line thicknes\n            .SeriesCollection(1).Format.Line.Weight = DbLineWeight\n            .SeriesCollection(2).Format.Line.Weight = DbLineWeight\n            'Works with x-axis\n            With .Axes(xlCategory)\n                'Sets orientation of x axis labels\n                .TickLabels.Orientation = DbDegrees\n                'Force to show all month under x-axis\n                .TickLabelSpacing = LnXLabelSpace\n            End With\n            'Works with y-axis\n            With .Axes(xlValue)\n                'Sets unit size for y-axis\n                .MajorUnit = LnYMayorUnit\n                'Sets value on y-axis from where values will start (Changes y=0 to value specified)\n                .MinimumScale = LnYMinimumScale\n            End With\n            With .ChartArea\n                'Sets border to none\n                .Border.LineStyle = LnChBorder\n                'Sets font\n                .Format.TextFrame2.TextRange.Font.Name = StChFont\n                'Sets font size\n                .Format.TextFrame2.TextRange.Font.Size = LnChFontSize\n                'Sets chart font color\n                .Font.Color = RGB(In7, In8, In9)\n            End With\n            'Checks if Legend for chart is enabled\n            If .HasLegend = True Then\n                With .Legend\n                    'Sets height of legend\n                    .Height = DbChLeHeight\n                    'Sets width of legend\n                    .Width = DbChLeWidth\n                    'Sets distance from left side of chart\n                    .Left = DbChLeLeft\n                    'Sets distance from top side of chart\n                    .Top = DbChLeTop\n                End With\n            End If\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564731716, "creation_date": 1563958376, "last_edit_date": 1564312428, "question_id": 57178925, "link": "https://stackoverflow.com/questions/57178925/how-to-copy-chart-from-excel-to-word-and-embed-chart-data-in-word-file", "title": "How to copy chart from excel to word and embed chart data in word file", "body": "<p>I have excel with data that I'm writing in word, it is open and I try to copy chart from excel to word, without linking it, so that any other user can open it without static link to original excel file.</p>\n\n<pre><code>Sub Make4Segment(Wapp As Object)\nDim Sheet As Excel.Worksheet\nDim MyChart As ChartObject\n   Set Sheet = Excel.ThisWorkbook.Sheets(\"DOC\")\n   Set MyChart = Excel.ThisWorkbook.Sheets(\"DOC\").ChartObjects(\"C1\")\n   MyChart.Chart.ChartArea.Copy\n   With Wapp.Application.Selection.Range\n       .PasteAndFormat Type:=wdChart\n    End With\nEnd sub\n</code></pre>\n\n<p>I'm getting error 4605 on paste line.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563958573, "post_id": 57178766, "comment_id": 100869436, "body": "Did you try to set type as <b>Long</b> @Andrea Giordano ?"}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563959235, "post_id": 57178766, "comment_id": 100869787, "body": "If I try to do: Dim valTMP as Long and then valTMP = val.value I obtain a Type incompatible error on it"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1563959590, "post_id": 57178766, "comment_id": 100869975, "body": "Shouldn&#39;t this <code>.Range(&quot;D2&quot;, .Range(&quot;D&quot; &amp; Rows.Count).End(xlUp))</code> be this: <code>.Range(&quot;D2&quot;, .Range(&quot;D&quot; &amp; Rows.Count).End(xlUp).Row)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1563966136, "post_id": 57179291, "comment_id": 100873712, "body": "Then (some of) your values are not numbers. Try with some extended test - see edited answer, please."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1563966139, "last_edit_date": 1563966139, "creation_date": 1563959549, "answer_id": 57179291, "question_id": 57178766, "link": "https://stackoverflow.com/questions/57178766/vba-type-mismatch-for-a-division-between-double/57179291#57179291", "title": "vba type mismatch for a division between double", "body": "<p>Try with <em>Val</em>:</p>\n\n<pre><code>coeffsVal.value = Val(reqVal.value) / Val(val.value)\n\ncoeffsVal.value = IIf(IsNumeric(reqVal.value) And IsNumeric(val.value), Val(\"\" &amp; reqVal.value)/IIf(Val(\"0\" &amp; val.value) &lt;&gt; 0, Val(\"0\" &amp; val.value), 1), 0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "is_accepted": true, "score": 0, "last_activity_date": 1563960425, "creation_date": 1563960425, "answer_id": 57179577, "question_id": 57178766, "link": "https://stackoverflow.com/questions/57178766/vba-type-mismatch-for-a-division-between-double/57179577#57179577", "title": "vba type mismatch for a division between double", "body": "<p>Eventually, the problem seemed related to the fact that 1.000 is not parsed like a number, while 1,000 does.</p>\n\n<p>So, before the calculation, I have replaced the dot with a comma and it worked.</p>\n"}], "owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 57179577, "answer_count": 2, "score": -1, "last_activity_date": 1563966139, "creation_date": 1563957809, "last_edit_date": 1563959324, "question_id": 57178766, "link": "https://stackoverflow.com/questions/57178766/vba-type-mismatch-for-a-division-between-double", "title": "vba type mismatch for a division between double", "body": "<p>I want to perform a division between two double numbers in cell formatted as text (like 3.000) (excel 2010, VBA 7.0 version 1628).</p>\n\n<p>The code:</p>\n\n<pre><code>Dim coeffsVal As Range\nDim val As Range\nDim reqVal As Range\nDim parameter As Range\n\n            With ActiveSheet\n                For Each reqVal In .Range(\"D2\", .Range(\"D\" &amp; Rows.Count).End(xlUp))\n\n                    Set coeffsVal = reqVal.Offset(, -1)\n                    Set val = reqVal.Offset(, -2)\n                    Set parameter = reqVal.Offset(, -3)                        \n\n                    coeffsVal.value = reqVal.value / val.value \n                        End If\n</code></pre>\n\n<p>All the ranges you see actually refer to single cells, and the values are well fetched.\nI don't know why when I try to perform</p>\n\n<pre><code>                        coeffsVal.value = reqVal.value / val.value \n</code></pre>\n\n<p>It returns me a type mismatch error.\nI have also tried with </p>\n\n<pre><code>coeffsVal.value = CDec(reqVal.value) / CDec(val.value)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>coeffsVal.value = CDbl(reqVal.value) / CDbl(val.value)\n</code></pre>\n\n<p>with same result.\nI tried to spy the value of the vars and I have:</p>\n\n<pre><code>&gt; val: 1.000 (written as text I suppose) \n&gt; reqVal: 3 (no matter if I insert it as 3 or 3.000)\n</code></pre>\n\n<p>I tried also to set or not reqVal as a NumberFormat= \"0.000\", with same unsuccess.</p>\n\n<p>Moreover, I tried the same exact code on another pc (Excel 2010 VBA 7.0 version 1640) and works nicely.\nUn update of the excel version is not viable.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "is_accepted": true, "score": 0, "last_activity_date": 1563959089, "creation_date": 1563959089, "answer_id": 57179142, "question_id": 57178727, "link": "https://stackoverflow.com/questions/57178727/moving-the-cursor-after-the-inserted-word/57179142#57179142", "title": "Moving the cursor after the inserted word", "body": "<p>Nvm, I solved it by adding this piece of code after the with statement</p>\n\n<pre><code>Selection.Move wdCharacter, Len(insertedText)\n</code></pre>\n\n<p>Thanks nonetheless!</p>\n"}], "owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 57179142, "answer_count": 1, "score": 0, "last_activity_date": 1563961064, "creation_date": 1563957689, "last_edit_date": 1563961064, "question_id": 57178727, "link": "https://stackoverflow.com/questions/57178727/moving-the-cursor-after-the-inserted-word", "title": "Moving the cursor after the inserted word", "body": "<p>In my VBA macro I am inserting some text in to the active document.\nAfter the insertion the cursor is not behind the inserted word as It would be if you manually typed it in but before the inserted word. How do I move it?</p>\n\n<pre><code>Dim insertedText As String\ninsertedText = \"test\"\n\nWith ActiveDocument\n    .Range.InsertAfter insertedText\n    'move the cursor behind insertedText\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563956238, "post_id": 57178272, "comment_id": 100868170, "body": "Are your column&#39;s 1 Cells set as date ?"}, {"owner": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1563956352, "post_id": 57178272, "comment_id": 100868217, "body": "No I cannot, I have also the numbers of Vendors thats why I use Format() in code"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1563956520, "post_id": 57178272, "comment_id": 100868310, "body": "The <b>earliest</b> date of these three dates <code>07.03.2001</code>, <code>30.01.2004</code> and <code>28.12.1999</code> actually is <code>28.12.1999</code> not  <code>30.01.2004</code>"}, {"owner": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "edited": false, "score": 0, "creation_date": 1563956748, "post_id": 57178272, "comment_id": 100868440, "body": "Earliest from today I meant"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1563956958, "post_id": 57178272, "comment_id": 100868559, "body": "You probably mean the <b>latest</b>. You should <a href=\"https://stackoverflow.com/posts/57178272/edit\">edit</a> your question to clarify that. Latest date is the greatest not the smallest so <code>28.12.1999  &lt;  07.03.2001  &lt;  30.01.2004</code>"}, {"owner": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "edited": false, "score": 0, "creation_date": 1563957031, "post_id": 57178272, "comment_id": 100868596, "body": "okay thanks, so I have tried with  Format but it doesn&quot;t select the right date"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563957148, "post_id": 57178272, "comment_id": 100868654, "body": "because if you use <code>Format()</code> it returns a string and you cannot calculate with strings like <code>D1 &lt; D2</code>. You need to use the numerical date for that. <code>Dim D1 As Date, D2 As Date, \u2026</code> and don&#39;t use <code>Format()</code>."}, {"owner": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "edited": false, "score": 0, "creation_date": 1563957957, "post_id": 57178272, "comment_id": 100869093, "body": "Do you mean this ? It triggers an error &quot;waiting end of instruction&quot; D1 As Date = FL1.Cells(NoLig + 1, 1).Value"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "edited": false, "score": 0, "creation_date": 1563958244, "post_id": 57178832, "comment_id": 100869239, "body": "Thanks, but the output is not what expected :  ``` 20563|\t20563 / 28.12.1999|\t20540 / 20540|\t20540 / 23.10.2000|\t0 / 28.12.1999|\t20558 / 20558|\t20558 / 07.03.2001|\t0 / 28.12.1999|\t0 / 30.01.2004|\t20559```"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "edited": false, "score": 0, "creation_date": 1563958290, "post_id": 57178832, "comment_id": 100869265, "body": "@Dng Format the column B as date!"}, {"owner": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "edited": false, "score": 0, "creation_date": 1563958385, "post_id": 57178832, "comment_id": 100869325, "body": "I mean I have vendors instead of dates <code>20563\t18&#47;04&#47;1956 28.12.1999\t26&#47;03&#47;1956 20540\t26&#47;03&#47;1956 23.10.2000\t00&#47;01&#47;1900 28.12.1999\t13&#47;04&#47;1956 20558\t13&#47;04&#47;1956 07.03.2001\t00&#47;01&#47;1900 28.12.1999\t00&#47;01&#47;1900 30.01.2004\t14&#47;04&#47;1956 </code> My initial dates remain with dd.mm.yyyy in Standard format because I cannot format the column without formating vendors also which i dont want"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "edited": false, "score": 0, "creation_date": 1563958859, "post_id": 57178832, "comment_id": 100869582, "body": "@Dng So are you saying your &quot;dates&quot; are no actual date values but strings?"}, {"owner": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "edited": false, "score": 0, "creation_date": 1563958950, "post_id": 57178832, "comment_id": 100869640, "body": "Yes they are, same as Vendors, that&#39;s why I tried to Format them"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1563959946, "last_edit_date": 1563959946, "creation_date": 1563958035, "answer_id": 57178832, "question_id": 57178272, "link": "https://stackoverflow.com/questions/57178272/vba-macro-compare-dates-to-take-the-earliest/57178832#57178832", "title": "VBA Macro Compare dates to take the earliest", "body": "<p>Have a look at this. It loops through all data in column A and for all non-dates it checks the following 3 cells to find the latest date.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FindLatestDate()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Feuil1\")\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim iRow As Long, jRow As Long\n    For iRow = 1 To LastRow\n        If Not IsDate(ws.Cells(iRow, \"A\").Value) Then 'current is number not a date\n            'check how many dates we have below\n            For jRow = iRow + 1 To iRow + 3 'max 3 dates\n                If Not IsDate(ws.Cells(jRow, \"A\").Value) Then\n                    Exit For\n                End If\n            Next jRow\n\n            'output\n            ws.Cells(iRow, \"B\").Value = Application.Max(ws.Range(ws.Cells(iRow + 1, \"A\"), ws.Cells(jRow - 1, \"A\")))\n            iRow = jRow - 1 'jump to next non-date\n        End If\n    Next iRow\nEnd Sub\n</code></pre>\n\n<p>Format the column B as date and the output will be (depending on your desired date format)</p>\n\n<p><a href=\"https://i.stack.imgur.com/PDB7a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PDB7a.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Edit according comments:</p>\n\n<p>You can run the following to convert your data into real dates before finding the latest date.</p>\n\n<pre><code>Public Sub ConvertIntoRealDates()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Feuil1\")\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim iRow As Long, DateOfString As Variant\n    For iRow = 1 To LastRow\n        DateOfString = GetDateOfString(ws.Cells(iRow, \"A\").Value)\n        If Not IsError(DateOfString) Then\n            ws.Cells(iRow, \"A\").Value = DateOfString\n        End If\n    Next iRow\nEnd Sub\n\n'convert string `dd.mm.yyyy` into a real date otherwise return error\nPrivate Function GetDateOfString(ByVal Value As String) As Variant\n    Dim DateArr As Variant\n    DateArr = Split(Value, \".\")\n\n    If UBound(DateArr) = 2 Then 'is a date\n        GetDateOfString = DateSerial(DateArr(2), DateArr(1), DateArr(0))\n    Else\n        GetDateOfString = CVErr(xlErrValue)\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "is_accepted": false, "score": 0, "last_activity_date": 1563969195, "last_edit_date": 1563969195, "creation_date": 1563961593, "answer_id": 57179969, "question_id": 57178272, "link": "https://stackoverflow.com/questions/57178272/vba-macro-compare-dates-to-take-the-earliest/57179969#57179969", "title": "VBA Macro Compare dates to take the earliest", "body": "<p>SOLVED (for more than 3 dates!!). Thanks for the trick @P\u1d07\u029c</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub douzemois()\nDim FL1 As Worksheet, Cell As Range, NoCol As Integer\nDim NoLig As Long, DerLig As Long, Var As Variant\n    Set FL1 = Worksheets(\"Feuil1\")\n    NoCol = 1\n\n    For NoLig = 1 To 41711\n        Var = FL1.Cells(NoLig, NoCol)\n        'len var &lt;&gt; 10 is vendor\n        If Len(FL1.Cells(NoLig, NoCol)) &lt;&gt; 10 Then\n            'one date only\n            If Len(FL1.Cells(NoLig + 2, NoCol)) &lt;&gt; 10 Then\n                FL1.Cells(NoLig, NoCol + 1) = FL1.Cells(NoLig, NoCol)\n                FL1.Cells(NoLig, NoCol + 2) = GetDateOfString(FL1.Cells(NoLig + 1, NoCol))\n            'more than one date\n            ElseIf Len(FL1.Cells(NoLig + 2, NoCol)) = 10 Then\n                maxtempdate = GetDateOfString(FL1.Cells(NoLig + 1, NoCol))\n                For i = 1 To 400\n                    If Len(FL1.Cells(NoLig + i, NoCol)) &lt;&gt; 10 Then\n                        FL1.Cells(NoLig, NoCol + 1) = FL1.Cells(NoLig, NoCol)\n                        FL1.Cells(NoLig, NoCol + 2) = maxtempdate\n                        i = 400\n                    ElseIf GetDateOfString(FL1.Cells(NoLig + i, NoCol)) &gt; maxtempdate Then\n                        maxtempdate = GetDateOfString(FL1.Cells(NoLig + i, NoCol))\n                    End If\n                Next\n            End If\n        End If\n    Next\n    Set FL1 = Nothing\nEnd Sub\n\nPrivate Function GetDateOfString(ByVal Value As String) As Variant\n    Dim DateArr As Variant\n    DateArr = Split(Value, \".\")\n\n    If UBound(DateArr) = 2 Then 'is a date\n        GetDateOfString = DateSerial(DateArr(2), DateArr(1), DateArr(0))\n    Else\n        GetDateOfString = CVErr(xlErrValue)\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11775522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SOcZZoV_ZOE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbbwiv0HeJIN9RoLkhbe-sHIcb3Q/photo.jpg?sz=128", "display_name": "Dng", "link": "https://stackoverflow.com/users/11775522/dng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 57178832, "answer_count": 2, "score": 0, "last_activity_date": 1563969195, "creation_date": 1563956092, "last_edit_date": 1563959877, "question_id": 57178272, "link": "https://stackoverflow.com/questions/57178272/vba-macro-compare-dates-to-take-the-earliest", "title": "VBA Macro Compare dates to take the earliest", "body": "<p>I have list of vendors with dates of creation below, I can have up to 3 dates but I need the earliest one from today (so the latest since begin of times lol). \"dates\" are no actual date values but strings, like Vendors number, thats why I try to Format them.</p>\n\n<p>First I tried to put colors to identify it but it doesnt work... I cannot compare dates: how to do?</p>\n\n<p>I have used this but it seems to not work properly...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>D1 = Format(FL1.Cells(NoLig + 1, 1).Value, \"dd.mm.yy\")\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub douzemois()\nDim FL1 As Worksheet, Cell As Range, NoCol As Integer\nDim NoLig As Long, DerLig As Long, Var As Variant\n    Set FL1 = Worksheets(\"Feuil1\")\n    NoCol = 1\n\n    For NoLig = 1 To 8\n        Var = FL1.Cells(NoLig, NoCol)\n        'len var &lt;&gt; 10 is vendor\n        If Len(FL1.Cells(NoLig, NoCol)) &lt;&gt; 10 Then\n            'one date only\n            If Len(FL1.Cells(NoLig + 2, NoCol)) &lt;&gt; 10 Then\n                FL1.Cells(NoLig, NoCol + 1) = FL1.Cells(NoLig, NoCol)\n                FL1.Cells(NoLig, NoCol + 2) = FL1.Cells(NoLig + 1, NoCol)\n            'mote than one date\n            ElseIf Len(FL1.Cells(NoLig + 2, NoCol)) = 10 Then\n                D1 = Format(FL1.Cells(NoLig + 1, 1).Value, \"dd.mm.yy\")\n                'two dates only\n                If Len(FL1.Cells(NoLig + 3, NoCol)) &lt;&gt; 10 Then\n                    If D1 &lt; Format(FL1.Cells(NoLig + 2, 1).Value, \"dd.mm.yy\") Then\n                        FL1.Cells(NoLig + 2, 1).Font.Color = vbRed\n                    Else\n                        FL1.Cells(NoLig + 1, 1).Font.Color = vbRed\n                    End If\n                'three dates\n                Else\n                    D2 = Format(FL1.Cells(NoLig + 2, 1).Value, \"dd.mm.yy\")\n                    D3 = Format(FL1.Cells(NoLig + 3, 1).Value, \"dd.mm.yy\")\n\n                    If D1 &lt; D2 Then\n                        If D2 &lt; D3 Then\n                            FL1.Cells(NoLig + 3, 1).Font.Color = vbRed\n                        Else\n                            FL1.Cells(NoLig + 2, 1).Font.Color = vbRed\n                        End If\n                    Else\n                        If D1 &lt; D3 Then\n                            FL1.Cells(NoLig + 3, 1).Font.Color = vbRed\n                        End If\n                    End If\n                End If\n            End If\n        End If\n    Next\n    Set FL1 = Nothing\nEnd Sub\n</code></pre>\n\n<p>Feuil1 is</p>\n\n<pre><code>20563\n21.04.1999\n20540\n23.10.2000\n25.02.1999\n20558\n07.03.2001\n30.01.2004\n28.12.1999\n</code></pre>\n\n<p>Result is</p>\n\n<blockquote>\n  <p>21.04.1999 ; 25.02.1999 ; 28.12.1999</p>\n</blockquote>\n\n<p>Result must be</p>\n\n<blockquote>\n  <p>21.04.1999 ; 23.10.2000 ; 30.01.2004</p>\n</blockquote>\n\n<p>I will then format the result like this</p>\n\n<pre><code>Col1  | Col2\n20563 | 21.04.1999\n20540 | 23.10.2000\n20558 | 30.01.2004\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11828748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebbc870700fab5c13a7c19f9b455550c?s=128&d=identicon&r=PG&f=1", "display_name": "destrovel", "link": "https://stackoverflow.com/users/11828748/destrovel"}, "edited": false, "score": 0, "creation_date": 1563974430, "post_id": 57178306, "comment_id": 100878462, "body": "Works like a charm! This already helped me to change the entire thing to be able to change everybody&#39;s project planning for single days to a specific item; useful for giving people a Christmas break :)  Next job: Be able to input a range which will be changed for specific people, checking if they have planned things already. But let&#39;s hope I can do that myself. Again, many thanks!"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1563956667, "last_edit_date": 1563956667, "creation_date": 1563956268, "answer_id": 57178306, "question_id": 57178163, "link": "https://stackoverflow.com/questions/57178163/modify-each-row-matching-several-criteria/57178306#57178306", "title": "Modify each row matching several criteria", "body": "<p><strong>Problem:</strong></p>\n\n<ul>\n<li>If should have been inside For Loop</li>\n<li>Date should be entered as Number, to be sure <code>24-12-2019</code> is recognized as <code>43823</code> by Excel</li>\n<li>Loop was being run on all the Rows, it should have been on Active Rows in the sheet</li>\n</ul>\n\n<p><strong>Use:</strong></p>\n\n<pre><code>Sub AddHoliday()\n\nDim i As Long\n\nWith Sheets(\"2019-2020\")\n\n    For i = 1 To .Cells(.Rows.Count, \"A\").End(xlUp).row\n\n        If .Cells(i, 1).Value = 43823 Then ' 24-12-2019\n           .Cells(i, 1).Font.Color = vbRed\n        End If\n\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11828748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebbc870700fab5c13a7c19f9b455550c?s=128&d=identicon&r=PG&f=1", "display_name": "destrovel", "link": "https://stackoverflow.com/users/11828748/destrovel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 57178306, "answer_count": 1, "score": 1, "last_activity_date": 1585074667, "creation_date": 1563955685, "last_edit_date": 1585074667, "question_id": 57178163, "link": "https://stackoverflow.com/questions/57178163/modify-each-row-matching-several-criteria", "title": "Modify each row matching several criteria", "body": "<p>I'm designing a staffing schedule for projects.</p>\n\n<p>Staff members are assigned on day-to-day basis to different projects. For planning purposes, we want both a \"staff per project\"-view as well as a \"project per staff\"-view.</p>\n\n<p>This led me to create a dataset consisting of one entry for each day/staffmember combination. With a dozen-or-so staff members and 365 days, this is a lengthy list to manually modify.</p>\n\n<p><strong>Basically, this is the database:</strong>\n<a href=\"https://i.stack.imgur.com/ALqxq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ALqxq.png\" alt=\"enter image description here\"></a></p>\n\n<p>The real thing is some 5000 lines. Changing anything a big CTRL+F party.<br>\nErgo; a macro to add staff planning.</p>\n\n<p>On a different sheet, I built a simple form for data-entry.<br>\nPeople select a staff member, enter a project name, beginning date, and ending date. The macro is then supposed to find the row (s) matching the staff member and the selected date range, and change the project in the dataset to whatever is given as input.</p>\n\n<p>I built the dataset, and begun working on code to locate the correct lines. I figured first making some code to set everybody's 24th of December to \"Christmas\" would be easiest.<br>\nTo make things easier on myself, I figured coloring it red would be best.</p>\n\n<pre><code>Sub AddHoliday()\n\nDim i As Long\n\nFor i = 1 To Sheets(\"2019-2020\").Rows.Count\n\nNext i\n\nIf Sheets(\"2019-2020\").Cells(i, 1).Value = \"24-12-2019\" Then\n    Sheets(\"2019-2020\").Cells(i, 1).Font.Color = vbRed\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I expected to see every date equal to 24th of December to turn red, but I get the following error:</p>\n\n<blockquote>\n<pre><code>error 1004: Object-defined error.\n</code></pre>\n</blockquote>\n\n<p>On the first line of the IF-statement.</p>\n"}, {"tags": ["sql", "excel", "vba", "odbc"], "owner": {"reputation": 11, "user_id": 11828773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EhmdVvR7lGU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3repS0rUs8nSrswNl3zxUr4Vo3eYMA/photo.jpg?sz=128", "display_name": "Boxcar", "link": "https://stackoverflow.com/users/11828773/boxcar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563959790, "creation_date": 1563955480, "last_edit_date": 1563959790, "question_id": 57178095, "link": "https://stackoverflow.com/questions/57178095/multiply-parameter-from-query-in-excel-odbc", "title": "Multiply parameter from query in Excel (ODBC)", "body": "<p>Using in Excel: Get Data>Other sources>Microsoft Query I had a table getting data from our company ERP system (ODBC).</p>\n\n<p>I have a table in Excel and then I click in Excel: Data>Queries&amp;Connections>Properies>Connection Properties>Definition and in \"Command text\" i put this simple SQL command:</p>\n\n<pre><code>SELECT F4111.ILLITM, F4111.ILTRQT/1000,  F4111.ILTRUM, F4111.ILDGL, F4111.ILGLPT, F4111.ILDCT, F4111.ILUNCS, F4111.ILPAID, F4111.ILDOC, F4111.ILMCU\nFROM RBGDC0P2.UREEUPBD.F4111 F4111\nWHERE (F4111.ILLITM IN ('XXXXXXX', 'YYYYYYY')) AND (F4111.ILDCT LIKE '%AA%')\n</code></pre>\n\n<p><code>XXXXXXX</code> and <code>YYYYYYY</code> are my input codes, which I need some data for them. 'F4111' is a table, <code>ILLITM</code> is my column from ERP database.</p>\n\n<p>I can put <code>?</code> to open a parameter and connect in to particular cell in Excel, and then I can simply change this cell in excel and refresh a table a have output for different input codes.</p>\n\n<p>My question is: I want to have more parameters, like I put in excel column with 100 input codes and I need output for them by refreshing my table query. I can do it for one or few inputs by putting '?', but how can I do it for more? </p>\n"}, {"tags": ["vba", "ms-word", "footnotes"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1565365922, "post_id": 57177573, "comment_id": 101344964, "body": "James, it would help others on the site if you would mark the contribution as an Answer, since, based on your comment, it did solve the problem...? If there is no positive action, eventually this Q&amp;A will disappear. That would be a shame since the issue you discovered could be a very real problem for others, as well."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8520002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c52ee345621005e4146d911f9c3e932?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/8520002/james"}, "edited": false, "score": 0, "creation_date": 1563976857, "post_id": 57179530, "comment_id": 100879940, "body": "Thank you very much! I&#39;m now using an alternative such as you suggest."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 23, "user_id": 8520002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c52ee345621005e4146d911f9c3e932?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/8520002/james"}, "edited": false, "score": 0, "creation_date": 1563990966, "post_id": 57179530, "comment_id": 100887452, "body": "Since you&#39;re relatively new to Stack Overflow: remember to mark any contribution that answers a question as &quot;the&quot; answer by clicking the checkmark next to it. That tells everyone the question is taken care of and lets people who may be searching for the same information that the contribution did help."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1563960297, "creation_date": 1563960297, "answer_id": 57179530, "question_id": 57177573, "link": "https://stackoverflow.com/questions/57177573/selection-footnotes-count-versus-for-each-footnote-in-selection-footnotes/57179530#57179530", "title": "&#39;selection.footnotes.count&#39; versus &#39;for each footnote in selection.footnotes&#39;", "body": "<p>I can reproduce what you describe, with the <code>Range</code> as well as the <code>Selection</code> object. I don't know \"why\"; it makes no sense as far as the object model goes. Sometimes, weird things happen with <code>Selection</code>, but that it also happens with <code>Range</code>...</p>\n\n<p>I'd class it as a bug, but I don't have any confirmation to that effect from Microsoft. </p>\n\n<p>This works, though</p>\n\n<pre><code>For ftCounter = 1 To rng.Footnotes.Count\n    Set ft = rng.Footnotes(ftCounter)\n    'Debug.Print ft.Range.Text\nNext\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8520002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c52ee345621005e4146d911f9c3e932?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/8520002/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 57179530, "answer_count": 1, "score": 2, "last_activity_date": 1563960297, "creation_date": 1563953700, "last_edit_date": 1563954176, "question_id": 57177573, "link": "https://stackoverflow.com/questions/57177573/selection-footnotes-count-versus-for-each-footnote-in-selection-footnotes", "title": "&#39;selection.footnotes.count&#39; versus &#39;for each footnote in selection.footnotes&#39;", "body": "<p>I want to make some modification to the footnotes in a selected portion of a MS Word document. I would like to use a 'for each footnote in selection.footnotes', but this does not work. It returns all the footnotes in the document. I do not understand why, because if I run a 'selection.footnotes.count' this returns only the footnotes in the selected portion, which is what I want. \nSee this code, which can be used for testing the problem. </p>\n\n<p>For example: type a number of lines in Word, insert some footnotes in each line, select one of the lines and run this code to see the difference.\nDoes anyone know what is wrong with my use of the <strong>For each footnote ...</strong>' statement?</p>\n\n<pre><code>For Each Footnote In Selection.Footnotes\n    i = i + 1\nNext Footnote\nMsgBox \"\u2022 For ... Next: \" &amp; i &amp; Chr(13) &amp; _\n\"\u2022 Count: \" &amp; Selection.Footnotes.Count, vbOKOnly, \"Number of footnotes in selection, counted using:\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1563954807, "post_id": 57177175, "comment_id": 100867450, "body": "Try the <code>LARGE</code> function.  Take a look at <a href=\"https://support.office.com/en-us/article/LARGE-function-3AF0AF19-1190-42BB-BB8B-01672EC00A64\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4480738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05c184fae89449a0959706191a3a6c7c?s=128&d=identicon&r=PG&f=1", "display_name": "nam24", "link": "https://stackoverflow.com/users/4480738/nam24"}, "edited": false, "score": 0, "creation_date": 1563985359, "post_id": 57177401, "comment_id": 100884832, "body": "I used a pivot table to get out the report this month, but it was cumbersome. I haven&#39;t had a chance to check yours, but Peh&#39;s solution works great. The only thing is handling ties."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1563957082, "last_edit_date": 1563957082, "creation_date": 1563953101, "answer_id": 57177401, "question_id": 57177175, "link": "https://stackoverflow.com/questions/57177175/find-the-top-3-text-occurrences-by-count-with-multiple-criteria/57177401#57177401", "title": "Find the Top 3 Text Occurrences by Count with Multiple Criteria", "body": "<p>My first goto was a pivot table, but soon realized that wasn't an option. @Peh his solution should be the way to go due to efficiency for sure.</p>\n\n<p>Just wanted to state a way with just one formula:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pBGuL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pBGuL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Formula in <code>F4</code>:</p>\n\n<pre><code>=INDEX($C$1:$C$31,IFERROR(MODE(IF((COUNTIF($E4:E4,$C$1:$C$31)=0)*($A$1:$A$31=$E4)*($B$1:$B$31=$E$1)=1,MATCH($C$1:$C$31,$C$1:$C$31,0))),MAX(IF((COUNTIF($E4:E4,$C$1:$C$31)=0)*($A$1:$A$31=$E4)*($B$1:$B$31=$E$1)=1,MATCH($C$1:$C$31,$C$1:$C$31,0)))))\n</code></pre>\n\n<p>Enter as array through <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd></p>\n\n<p>Drag down and right</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4480738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05c184fae89449a0959706191a3a6c7c?s=128&d=identicon&r=PG&f=1", "display_name": "nam24", "link": "https://stackoverflow.com/users/4480738/nam24"}, "edited": false, "score": 0, "creation_date": 1563985220, "post_id": 57178022, "comment_id": 100884763, "body": "Thank you! This works great. Is there a way to handle ties as well? For example, in the LA market, if the primary vendor is both Vend1 and Vend3, is there a way to list both in the cell?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 41, "user_id": 4480738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05c184fae89449a0959706191a3a6c7c?s=128&d=identicon&r=PG&f=1", "display_name": "nam24", "link": "https://stackoverflow.com/users/4480738/nam24"}, "edited": false, "score": 0, "creation_date": 1563985648, "post_id": 57178022, "comment_id": 100884982, "body": "@nam24 no, it will list the <code>Vend1</code> as primary and the <code>Vend3</code> as secondary if both have the same number."}, {"owner": {"reputation": 41, "user_id": 4480738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05c184fae89449a0959706191a3a6c7c?s=128&d=identicon&r=PG&f=1", "display_name": "nam24", "link": "https://stackoverflow.com/users/4480738/nam24"}, "edited": false, "score": 0, "creation_date": 1564079008, "post_id": 57178022, "comment_id": 100922696, "body": "@Peh I upvoted it. The ties are acting wonky, but I haven&#39;t had a chance to dig into those scenarios yet."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1563956223, "last_edit_date": 1563956223, "creation_date": 1563955245, "answer_id": 57178022, "question_id": 57177175, "link": "https://stackoverflow.com/questions/57177175/find-the-top-3-text-occurrences-by-count-with-multiple-criteria/57178022#57178022", "title": "Find the Top 3 Text Occurrences by Count with Multiple Criteria", "body": "<p>Imagine the following worksheet and data</p>\n\n<p><a href=\"https://i.stack.imgur.com/7Hi31.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Hi31.png\" alt=\"enter image description here\"></a></p>\n\n<p>Use this formula in the <code>Helper</code> column (D2 and pull down)</p>\n\n<pre><code>=IF(COUNTIFS($A$1:A2,A2,$B$1:B2,B2,$C$1:C2,C2)=1,COUNTIFS(A:A,A:A,B:B,B:B,C:C,C:C),\"\")\n</code></pre>\n\n<p>And this formula in H3 (add as array formula <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>)</p>\n\n<pre><code>=INDEX($C:$C,MATCH(LARGE(IF($A:$A=$G3,IF($B:$B=$G$1,$D:$D)),H$1),IF($A:$A=$G3,IF($B:$B=$G$1,$D:$D)),0))\n</code></pre>\n\n<p>and copy to right and down.</p>\n"}], "owner": {"reputation": 41, "user_id": 4480738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05c184fae89449a0959706191a3a6c7c?s=128&d=identicon&r=PG&f=1", "display_name": "nam24", "link": "https://stackoverflow.com/users/4480738/nam24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57178022, "answer_count": 2, "score": 0, "last_activity_date": 1563957082, "creation_date": 1563952299, "last_edit_date": 1563952559, "question_id": 57177175, "link": "https://stackoverflow.com/questions/57177175/find-the-top-3-text-occurrences-by-count-with-multiple-criteria", "title": "Find the Top 3 Text Occurrences by Count with Multiple Criteria", "body": "<p>I am trying to find the top 3 used vendors (by count) per city and type of service provided. I can get the most used vendor, but the second and third most are escaping me. A brief example of the data looks as follows:</p>\n\n<pre><code>A       B        C\nCity  Type     Vendor\nLA    Clean    Vend1\nLA    Clean    Vend2\nLA    Clean    Vend4\nLA    Paint    Vend3\nLA    Paint    Vend3\nLA    Clean    Vend4\nLA    Clean    Vend1\nLA    Clean    Vend1\nLA    Clean    Vend2\nLA    Clean    Vend1\n....\n</code></pre>\n\n<p>I change the type of service at the top of the sheet so my expected output would look something like this:</p>\n\n<pre><code>A       B       C       D\nClean\n\nCity  Primary  Second  Third\nLA    Vend1    Vend2   Vend4\nSF\nNY\n...\n</code></pre>\n\n<p>Here's my formula to return the most used (primary) vendor:</p>\n\n<pre><code>{=INDEX(Sheet2!$C$2:$C$15,MODE(IF($A4&amp;$A$1=Sheet2!$A$2:$A$15&amp;Sheet2!$B$2:$B$15,\nMATCH(Sheet2!$C$2:$C$15,Sheet2!$C$2:$C$15,0))))}\n</code></pre>\n\n<p>How can I get the second and third most used? I'm open to formulas or vba. Thanks!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1563952680, "post_id": 57176993, "comment_id": 100866386, "body": "Yes you can loop through the Body of the Email and find the String using VBA. <a href=\"https://stackoverflow.com/questions/31265985/loop-though-body-only-of-an-email\">Might Give you an Start</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1563970561, "post_id": 57176993, "comment_id": 100876142, "body": "Try to find what is between the : and vbNewLine.  <a href=\"https://stackoverflow.com/questions/31717844/find-carriage-return-in-a-mail-body\" title=\"find carriage return in a mail body\">stackoverflow.com/questions/31717844/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/20001670/vba-outlook-body-string-search\" title=\"vba outlook body string search\">stackoverflow.com/questions/20001670/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1563997050, "creation_date": 1563997050, "answer_id": 57190135, "question_id": 57176993, "link": "https://stackoverflow.com/questions/57176993/search-for-the-absence-of-text-in-email-body/57190135#57190135", "title": "Search for the absence of text in email body", "body": "<blockquote>\n  <p>Is there a way that a VBA can use to find out how many emails doesn't have the Ticket# and Status.</p>\n</blockquote>\n\n<p>The Outlook object model provides the <code>Find</code>/<code>FindNext</code> and <code>Restrict</code> methods of the <code>Items</code> class. You can read more about these methods in the following articles:</p>\n\n<p><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/20/outlook-find-findnext-retrieve-mail/\" rel=\"nofollow noreferrer\">How To: Use Find and FindNext methods to retrieve Outlook mail items from a folder (C#, VB.NET)</a></p>\n\n<p><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/23/outlook-restrict-method-retrieve-mail/\" rel=\"nofollow noreferrer\">How To: Use Restrict method to retrieve Outlook mail items from a folder</a></p>\n\n<p>Also, you may find the <a href=\"http://msdn.microsoft.com/en-us/library/bb219884.aspx\" rel=\"nofollow noreferrer\">AdvancedSearch</a> method of the <code>Application</code> class helpful. </p>\n\n<p>The key benefits of using the <code>AdvancedSearch</code> method in Outlook are:</p>\n\n<ul>\n<li>The search is performed in another thread. You don\u2019t need to run another thread manually since the <code>AdvancedSearch</code> method runs it automatically in the background.</li>\n<li>Possibility to search for any item types: mail, appointment, calendar, notes etc. in any location, i.e. beyond the scope of a certain folder. The <code>Restrict</code> and <code>Find</code>/<code>FindNext</code> methods can be applied to a particular <code>Items</code> collection (see the <code>Items</code> property of the <code>Folder</code> class in Outlook).</li>\n<li>Full support for DASL queries (custom properties can be used for searching too). You can read more about this in the <a href=\"http://msdn.microsoft.com/en-us/library/bb208216%28v=office.12%29\" rel=\"nofollow noreferrer\">Filtering</a> article in MSDN. To improve the search performance, Instant Search keywords can be used if Instant Search is enabled for the store (see the <code>IsInstantSearchEnabled</code> property of the <code>Store</code> class).</li>\n<li>You can stop the search process at any moment using the <code>Stop</code> method of the <code>Search</code> class.</li>\n</ul>\n\n<p>Read more about this method in the <a href=\"https://www.add-in-express.com/creating-addins-blog/2012/05/31/outlook-search-csharp-vbnet/\" rel=\"nofollow noreferrer\">Advanced search in Outlook programmatically: C#, VB.NET</a> article. </p>\n"}], "owner": {"reputation": 113, "user_id": 3770648, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e04de2a3fc5e293a7422df1721e65de?s=128&d=identicon&r=PG&f=1", "display_name": "rocky09", "link": "https://stackoverflow.com/users/3770648/rocky09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1599655266, "creation_date": 1563951564, "last_edit_date": 1599655266, "question_id": 57176993, "link": "https://stackoverflow.com/questions/57176993/search-for-the-absence-of-text-in-email-body", "title": "Search for the absence of text in email body", "body": "<p>Everyday, I receives nearly 100+ emails which contain the following.</p>\n<pre><code>CRM Status: Open\nCRM Interaction Number: XXXXX\n</code></pre>\n<p>On some emails Status and Number are missing.<br />\nExample:</p>\n<pre><code>CRM Status: \nCRM Interaction Number: \n</code></pre>\n<p>I need to look manually and categorize as &quot;Not Ticketed&quot;.</p>\n<p>Is there a way to find how many emails don't have the Ticket# and Status.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563952047, "post_id": 57176913, "comment_id": 100866081, "body": "You should read about what a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ifthenelse-statement\" rel=\"nofollow noreferrer\">ElseIf</a> statement is."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1563952101, "post_id": 57176913, "comment_id": 100866116, "body": "You should use <code>Split(variable, &quot;:&quot;)(0)</code> , that will give you your answer straight. No need for If or Else or Simple <code>Sheet1.Range(&quot;Row&quot;).Row</code>"}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 11709287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w2fV_JQhXF4/AAAAAAAAAAI/AAAAAAAAV_o/ByQFYQe94LU/photo.jpg?sz=128", "display_name": "Horst", "link": "https://stackoverflow.com/users/11709287/horst"}, "edited": false, "score": 0, "creation_date": 1563952375, "post_id": 57177133, "comment_id": 100866249, "body": "Very efficient. I broke my neck with a select case code (deleted it, cause it wouldn&#39;t work). Sometimes it&#39;s plain simple."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563952420, "post_id": 57177133, "comment_id": 100866269, "body": "I was Writing this in an Answer. :) ... Simple as That."}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1563953384, "post_id": 57177133, "comment_id": 100866736, "body": "When I run the code Sheet1.Range(&quot;Row&quot;).Row I get error Invalid Use of Property for .row"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1563953531, "post_id": 57177133, "comment_id": 100866802, "body": "@Michi are you sure a named range <code>&quot;Row&quot;</code> does exist in <code>Sheet1</code>? Test it with <code>Sheet1.Range(&quot;4:6&quot;).Row</code> and you will see it works. \u2022 If your issue persists please tell the output of <code>Debug.Print Sheet1.Range(&quot;Row&quot;).Address</code>."}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1563954108, "post_id": 57177133, "comment_id": 100867087, "body": "If use Sheet1.Range(&quot;4:6&quot;).Row I still get the same error. Debug.Print for Sheet1.Range(&quot;4:6&quot;).Row gives me $4:$6 and Debug.Print for Sheet1.Range(&quot;Row&quot;) gives me $4:$4 so all this seems correct. I even restarted my computer but the problem persists. I will try at a different PC later and see if it works there."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1563954642, "post_id": 57177133, "comment_id": 100867379, "body": "@Michi That is strange I tested the code and it works properly. Test in a new workbook."}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1563986466, "post_id": 57177133, "comment_id": 100885398, "body": "After I restarted my PC again it is working now with RowNumber = Sheet1.Range(&quot;Row&quot;).Row. Thanks a lot for your help."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1563952184, "creation_date": 1563952184, "answer_id": 57177133, "question_id": 57176913, "link": "https://stackoverflow.com/questions/57176913/extract-first-row-numbers-of-row-adress-using-vba/57177133#57177133", "title": "Extract first row numbers of row adress using VBA", "body": "<p>This returns the row number</p>\n\n<pre><code>Sheet1.Range(\"Row\").Row\n</code></pre>\n\n<p>If <code>Range(\"Row\")</code> is eg <code>\"4:6\"</code> then </p>\n\n<pre><code>Sheet1.Range(\"Row\").Row 'returns 4\nSheet1.Range(\"Row\").Row + Sheet1.Range(\"Row\").Rows.Count - 1 'returns 6\n</code></pre>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 57177133, "answer_count": 1, "score": 1, "last_activity_date": 1563952184, "creation_date": 1563951282, "last_edit_date": 1563951966, "question_id": 57176913, "link": "https://stackoverflow.com/questions/57176913/extract-first-row-numbers-of-row-adress-using-vba", "title": "Extract first row numbers of row adress using VBA", "body": "<p>I have an empty Excel spreadsheet in which I defined a variable <code>Row</code> in the <code>name manager</code>. <br>\nThis variable currently refers to <code>3:3</code> but can switch any time. <br> \nTherefore, it could also be <code>105:105</code> or <code>5000:5000</code> or any other number possible.</p>\n\n<p>Now I use the following VBA to extract the <strong>first numbers</strong> of the <strong>row adress</strong>:</p>\n\n<pre><code>Sub Extract_Row_Adress()\n    If Len(Sheet1.Range(\"Row\").Address(RowAbsolute:=False, ColumnAbsolute:=False)) &lt;= 3 Then\n        RowNumber = Mid(Sheet1.Range(\"Row\").Address(RowAbsolute:=False, ColumnAbsolute:=False), 1, 1)\n    Else\n        If Len(Sheet1.Range(\"Row\").Address(RowAbsolute:=False, ColumnAbsolute:=False)) &lt;= 5 Then\n            RowNumber = Mid(Sheet1.Range(\"Row\").Address(RowAbsolute:=False, ColumnAbsolute:=False), 1, 2)\n        Else\n            If Len(Sheet1.Range(\"Row\").Address(RowAbsolute:=False, ColumnAbsolute:=False)) &lt;= 7 Then\n                RowNumber = Mid(Sheet1.Range(\"Row\").Address(RowAbsolute:=False, ColumnAbsolute:=False), 1, 3)\n            Else\n                If Len(Sheet1.Range(\"Row\").Address(RowAbsolute:=False, ColumnAbsolute:=False)) &lt;= 9 Then\n                    RowNumber = Mid(Sheet1.Range(\"Row\").Address(RowAbsolute:=False, ColumnAbsolute:=False), 1, 4)\n                Else\n                End If\n            End If\n        End If\n    End If\n\n    Sheet1.Range(\"A5\").Value = RowNumber\nEnd Sub\n</code></pre>\n\n<p>All this works fine so far.</p>\n\n<hr>\n\n<p>As you can see in the VBA I need to use several <code>IF statements</code> because the first numbers of the <strong>row adress</strong> can vary in their number of digits. According to this I have to adjust the lengths of the <code>Mid</code> function with <code>( 1, 1) ( 1, 2) ( 1, 3) ( 1, 4)</code> and so on.</p>\n\n<p>I am wondering if there is a better way to do this without having all this <code>If statements</code> running?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1563950239, "post_id": 57176641, "comment_id": 100865181, "body": "You cannot format a string in a variable. That is not possible, you can only format it in a cell."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1563950324, "post_id": 57176641, "comment_id": 100865227, "body": "Thanks. Guess we can close this question then"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1563950554, "post_id": 57176641, "comment_id": 100865327, "body": "@P\u1d07\u029c thanks for the link. I tried all sorts of searching but never search for that specific search text. This will work nicely. Cheers!"}], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1563950346, "answer_count": 0, "score": 0, "last_activity_date": 1563950279, "creation_date": 1563950081, "last_edit_date": 1563950279, "question_id": 57176641, "link": "https://stackoverflow.com/questions/57176641/how-to-bold-a-string-within-a-string-and-variables", "closed_reason": "Duplicate", "title": "How to bold a string within a string and variables", "body": "<p><strong>Code</strong></p>\n\n<p>Below is my Function:</p>\n\n<pre><code>Function InitialHeading(Optional ByVal Accrual As String, Optional ByVal Status As String, Optional ByVal Description As String, Optional ByVal RecipientAccount As String, Optional ByVal RecipientName As String, Optional ByVal AgreeType As String, Optional ByVal DateFrom As String, Optional ByVal DateTo As String) As String\n\n    InitialHeading = \"Accrual: \" &amp; Accrual &amp; \"    Agreement Status: \" &amp; Status &amp; \"    Date: \" &amp; DateFrom &amp; \" - \" &amp; DateTo &amp; \"    Description: \" &amp; Description &amp; \"    Rebate Recipient Details: Account - \" &amp; RecipientAccount &amp; \"    Name - \" &amp; RecipientName\n\nEnd Function\n</code></pre>\n\n<p><strong>Problem</strong></p>\n\n<p>I want all the non variables to be bold. I want variables Accrual &amp; Status font colour red.</p>\n\n<p><strong>Research</strong></p>\n\n<p>I have done multiple sarches but the best I can get is setting the entire string ie. <code>InitialHeading</code> ALL bold or ALL red.</p>\n\n<p><strong>Output</strong></p>\n\n<p>In the below output the variable <code>Status = \"Open\"</code> and thus the word <code>Open</code> needs to be font = red:</p>\n\n<p><strong>Accrual:</strong> 123456    <strong>Agreement Status:</strong> Open      etc etc etc</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1563950436, "post_id": 57176477, "comment_id": 100865280, "body": "You should test your code by checking the contents of your variables, f.i. by using message boxes. Assuming you did define variables as your code doesn&#39;t tell."}, {"owner": {"reputation": 145, "user_id": 11732705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e908ca82b9b25f7e9f48760a250d05f9?s=128&d=identicon&r=PG&f=1", "display_name": "Vernon007", "link": "https://stackoverflow.com/users/11732705/vernon007"}, "edited": false, "score": 0, "creation_date": 1563953099, "post_id": 57176477, "comment_id": 100866600, "body": "Step into the code to see if something is being missed."}], "owner": {"reputation": 482, "user_id": 1383668, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/1033032585/picture?type=large", "display_name": "Dan Nick", "link": "https://stackoverflow.com/users/1383668/dan-nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594635390, "creation_date": 1563949397, "last_edit_date": 1594635390, "question_id": 57176477, "link": "https://stackoverflow.com/questions/57176477/import-csv-files-in-multiple-access-tables", "title": "Import CSV Files in Multiple Access Tables", "body": "<p>I have csv files in a folder that look like this:</p>\n\n<pre><code>BAS09012018_1.csv\nBAS09012018_2.csv\nBAS09012018_3.csv\nBAS09012018_4.csv\nBAS09012018_5.csv\n</code></pre>\n\n<p>I want to import them into 5 different Access Tables based on title (\"BAS\") and Number (1,2 3, etc)</p>\n\n<p>Here is the code I have. When I run it no data is transferred. The Import Specification is correct because I was able to import the csv file manually. </p>\n\n<pre><code>HasFieldNames = False\n\ndir_List = \"C:\\Users\\LVWis\\dump\\UnzippedFiles\\\"\nDirectory = Dir(Dir_List)\n\n    If Len(Directory) &gt; 0 Then\n\n    Do\n    FileName = \"C:\\Users\\LVWis\\dump\\UnzippedFiles\\\" &amp; Directory\n    endFileName = Right(Trim(FileName), 5)\n    beginFileName = Left(Trim(FileName), 3)\n\n    If endFileName = \"1.csv\" And beginFileName = \"BAS\" Then\n    strTable = \"BAS_1\"\n    DoCmd.TransferText acImportDelim, \"BAS_1a\", strTable, FileName, HasFieldNames\n    strPathFile = Dir()\n\n    ElseIf endFileName = \"2.csv\" And beginFileName = \"BAS\" Then\n    strTable = \"BAS_2\"\n    DoCmd.TransferText acImportDelim, \"BAS_2a\", strTable, FileName, HasFieldNames\n    strPathFile = Dir()\n\n    ElseIf endFileName = \"3.csv\" And beginFileName = \"BAS\" Then\n    strTable = \"BAS_3\"\n    DoCmd.TransferText acImportDelim, \"BAS_3a\", strTable, FileName, HasFieldNames\n    strPathFile = Dir()\n\n    ElseIf endFileName = \"4.csv\" And beginFileName = \"BAS\" Then\n    strTable = \"BAS_4\"\n    DoCmd.TransferText acImportDelim, \"BAS_4a\", strTable, FileName, HasFieldNames\n    strPathFile = Dir()\n\n    ElseIf endFileName = \"5.csv\" And beginFileName = \"BAS\" Then\n    strTable = \"BAS_5\"\n    DoCmd.TransferText acImportDelim, \"BAS_5a\", strTable, FileName, HasFieldNames\n    strPathFile = Dir()\n\n    End If\n\n    Directory = Dir\n    Loop Until Len(Directory) = 0\n\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563950767, "post_id": 57176304, "comment_id": 100865426, "body": "Use <code>Range(nm).Value = &quot;&quot;</code> , that ways your Named Range won&#39;t go anywhere. Use the code <a href=\"https://stackoverflow.com/a/57176447/5720144\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563949618, "post_id": 57176439, "comment_id": 100864918, "body": "I don&#39;t think they should delete the Named Range. Do you know any reason why that should be the case ?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563950080, "post_id": 57176439, "comment_id": 100865113, "body": "I tried to set the values of Named Ranges to <code>&quot;&quot;</code> , but the Named Ranges are intact after that. They are not deleted from Name Manager"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563950582, "post_id": 57176439, "comment_id": 100865335, "body": "See in my Answer, name stays the same. i ran the code 3 times."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1563950683, "post_id": 57176439, "comment_id": 100865384, "body": "I think it is because the way we are setting it&#39;s value."}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563951240, "post_id": 57176439, "comment_id": 100865654, "body": "<code>nm.Value = 0</code> this works but then I have all flooded with (0) zeros in my Excel application"}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563951763, "post_id": 57176439, "comment_id": 100865941, "body": "Thank you! You saved couple of days a year in my life by this code."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1563951833, "post_id": 57176439, "comment_id": 100865980, "body": "@user7202022, I&#39;ll write a cheque to your boss ;). Glad it helped."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1563951516, "last_edit_date": 1563951516, "creation_date": 1563949250, "answer_id": 57176439, "question_id": 57176304, "link": "https://stackoverflow.com/questions/57176304/search-for-names-in-name-manager-and-set-values/57176439#57176439", "title": "Search for names in name manager and set values", "body": "<p>Very close :)</p>\n\n<pre><code>Sub NamedRange_Loop()\n\nDim nm As Name\n\n'Loop through each named range in workbook\n  For Each nm In ThisWorkbook.Names\n    If InStr(1, nm.Name, \"MFiles_\") Then\n       nm.RefersTo = \"=\"\"\"\"\" 'nm.Value = \"=\"\"\"\"\" does the same thing\n    End If\n  Next nm\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 1, "last_activity_date": 1563950553, "last_edit_date": 1563950553, "creation_date": 1563949284, "answer_id": 57176447, "question_id": 57176304, "link": "https://stackoverflow.com/questions/57176304/search-for-names-in-name-manager-and-set-values/57176447#57176447", "title": "Search for names in name manager and set values", "body": "<p><strong>Something Like this:</strong></p>\n\n<pre><code>Sub NamedRange_Loop()\n\nDim nm As Name\n\n  For Each nm In ThisWorkbook.Names\n\n       If Left(nm.Name, 7) = \"MFiles_\" Then\n\n         Range(nm).Value = \"\"\n\n       End If\n\n  Next nm\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>If you will use <code>nm.Value = \"\"</code> it will delete the Named Ranges. But if you use <code>Range(nm).Value = \"\"</code> it will retain the Named Ranges as it is.</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/3rOoj.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3rOoj.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 57176439, "answer_count": 2, "score": 1, "last_activity_date": 1563951516, "creation_date": 1563948619, "last_edit_date": 1563950988, "question_id": 57176304, "link": "https://stackoverflow.com/questions/57176304/search-for-names-in-name-manager-and-set-values", "title": "Search for names in name manager and set values", "body": "<p>I have a lot of named ranges. They all are like <code>MFiles_PG9317B4DE414D4DE3A781648B8F8B5C2Fn1_ID</code>. Common thing to all of them is that they all start with <code>MFiles_</code>. Time to times I need to set their values to <code>\"\"</code>. Clicking each one and setting value manually is one of a job. I would like to do it by code. I guess I have to loop through all of them, search for names starting with <code>MFiles_</code> and set their value to <code>\"\"</code>. How to do that?</p>\n\n<p>Note! Named ranges should stay as they are, only values should be set to <code>\"\"</code>. So <code>MFiles_PG9317B4DE414D4DE3A781648B8F8B5C2Fn1_ID</code> with value (for example) <code>=78324</code> after code run should be <code>\"\"</code> but name should stay untouched <code>MFiles_PG9317B4DE414D4DE3A781648B8F8B5C2Fn1_ID</code>. Also all the others begging with <code>MFiles_</code></p>\n\n<pre><code>Sub NamedRange_Loop()\n\nDim nm As Name\n\n'Loop through each named range in workbook\n  For Each nm In ThisWorkbook.Names\n    If nm = MFiles_ Then\n       Name.Value =\"\"\n    End If\n  Next nm\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Mikku's solution gives:\n<a href=\"https://i.stack.imgur.com/Ho39I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ho39I.png\" alt=\"enter image description here\"></a></p>\n"}]