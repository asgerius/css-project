[{"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "is_accepted": false, "score": 0, "last_activity_date": 1545264138, "creation_date": 1545264138, "answer_id": 53860797, "question_id": 53860724, "link": "https://stackoverflow.com/questions/53860724/cant-add-a-second-user-button-programatically/53860797#53860797", "title": "Can&#39;t Add a Second User Button Programatically", "body": "<p>Code below will add a button on the 3 first worksheets of your active workbook.</p>\n\n<pre><code>Option Explicit\n\nSub button_maker()\nDim Bt0 As Button\nDim Wb0 As Workbook: Set Wb0 = ActiveWorkbook\nDim i As Integer\n\nFor i = 1 To 3\n    Set Bt0 = Wb0.Sheets(i).Buttons.Add(27, 30, 100, 20)\n    Bt0.OnAction = \"\"\n    Bt0.Caption = \"Input Sales\"\n    'Bt0.Name = \"\" if you want to name it for future reference\nNext i\n\nEnd Sub  \n</code></pre>\n\n<p>I'm not sure what your goal is exactly but you can play with this code and adapt it to your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1545267321, "creation_date": 1545267321, "answer_id": 53861135, "question_id": 53860724, "link": "https://stackoverflow.com/questions/53860724/cant-add-a-second-user-button-programatically/53861135#53861135", "title": "Can&#39;t Add a Second User Button Programatically", "body": "<p>Try</p>\n\n<pre><code>Sub test()\n    button_maker ThisWorkbook, Sheets(1)\n    button_maker ThisWorkbook, Sheets(2)\nEnd Sub\nSub button_maker(wb As Workbook, Ws As Worksheet)\nDim r As Range\nDim Bt As Shape\n\n    Set Bt = Ws.Shapes.AddFormControl(xlButtonControl, 27, 30, 100, 20)\n    With Bt\n        .OnAction = \"'\" &amp; wb.Name &amp; \"'\" &amp; \"!\" &amp; \"Button9_click\"\n        .TextFrame.Characters.Text = \"Input Sales\"\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10735868, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pBzXK3hYNIA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i5xoOvv0gocZSgAyfU1JgUOPtO7g/mo/photo.jpg?sz=128", "display_name": "MACROCHAMP", "link": "https://stackoverflow.com/users/10735868/macrochamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1578547882, "creation_date": 1545263441, "last_edit_date": 1578547882, "question_id": 53860724, "link": "https://stackoverflow.com/questions/53860724/cant-add-a-second-user-button-programatically", "title": "Can&#39;t Add a Second User Button Programatically", "body": "<p>I'm trying to programatically add multiple buttons to multiple worksheets, but it's only working for one of the sheets (\"Sheet1\"). Below is my code, I'm wondering if there's anything else that I can do which will enable me to add buttons to Sheet2 and any others. Thanks!</p>\n\n<pre><code>Sub button_maker(wb As Workbook)\nDim r As Range\nSet r = Selection\n    Worksheets(\"Sheet1\").Buttons.Add(27, 30, 100, 20).Select\n    With Selection\n        .OnAction = \"'\" &amp; wb.Name &amp; \"'\" &amp; \"!\" &amp; \"Button9_click\"\n        .Characters.Text = \"Input Sales\"\n    End With\nr.Select\n\nEnd Sub\n\n\nSub button_maker2(wb As Workbook)\n\nDim d As Range\nSet d = Selection\n    wb.Worksheets(\"Sheet2\").Buttons.Add(1065, 1, 60, 20).Select\n    With Selection\n        .Characters.Text = \"Input Sales\"\n        .OnAction = \"'\" &amp; wb.Name &amp; \"'\" &amp; \"!\" &amp; \"Button9_click\"\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "edited": false, "score": 0, "creation_date": 1545261193, "post_id": 53860333, "comment_id": 94568867, "body": "Thank you the Application.Transpose worked. I&#39;ll definitely use the Resize() in the future. 2 Questions answered for the price of 1. What a great site. ;-)"}], "tags": [], "owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "is_accepted": true, "score": 3, "last_activity_date": 1545260961, "last_edit_date": 1545260961, "creation_date": 1545260384, "answer_id": 53860333, "question_id": 53860281, "link": "https://stackoverflow.com/questions/53860281/how-do-i-populate-a-column-from-an-array/53860333#53860333", "title": "How do I populate a column from an array?", "body": "<p>You're looking for a transpose method:</p>\n\n<pre><code>Sub CreateFormulaDataSheet()\n    Dim currentWs As Worksheet\n    Dim formWs As Worksheet\n    Dim titles As String\n    Dim valuesArr As Variant\n\n    If Not SheetExists(\"FormulaData\") Then\n    'create new sheet\n    Set currentWs = ActiveWorkbook.ActiveSheet\n    With ActiveWorkbook\n        Set formWs = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n        formWs.Name = \"FormulaData\"\n\n        formWs.Activate\n\n        'populate with default values\n        valuesArr = Array(1, 3, 6)\n\n        Range(\"A4\").Resize(UBound(valuesArr) + 1, 1).Value = Application.Transpose(valuesArr)\n\n    End With\n    End If\nEnd Sub  \n</code></pre>\n\n<p>To keep it simple, imagine that 1 dimention arrays are stored horizontaly. So same as for data on a worksheet, if you want to assign it to a vertical range, you have to transpose it first.</p>\n\n<p>Second thing I used is the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.resize\" rel=\"nofollow noreferrer\">Resize()</a> method which will conveniently extant your destination range according to your array size.</p>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1545261330, "creation_date": 1545261330, "answer_id": 53860473, "question_id": 53860281, "link": "https://stackoverflow.com/questions/53860281/how-do-i-populate-a-column-from-an-array/53860473#53860473", "title": "How do I populate a column from an array?", "body": "<p>In cases <code>Transpose</code> is a limitation, populate a 2D array ahead and directly dump on sheet.</p>\n\n<pre><code>Sub test()\n\n  ReDim valuesArr(0 To 2, 0 To 0)\n\n  valuesArr(0, 0) = 1\n  valuesArr(1, 0) = 3\n  valuesArr(2, 0) = 6\n\n  Range(\"A4:A\" &amp; UBound(valuesArr, 1) + 4) = valuesArr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 53860333, "answer_count": 2, "score": 2, "last_activity_date": 1579080938, "creation_date": 1545260032, "last_edit_date": 1579080938, "question_id": 53860281, "link": "https://stackoverflow.com/questions/53860281/how-do-i-populate-a-column-from-an-array", "title": "How do I populate a column from an array?", "body": "<p>Using Excel VBA I'm trying to populate a small set of the cells in my newly created worksheet. When I use the following code:</p>\n\n<pre><code>Sub CreateFormulaDataSheet()\n    Dim currentWs As Worksheet\n    Dim formWs As Worksheet\n    Dim titles As String\n    Dim valuesArr As Variant\n\n    If Not SheetExists(\"FormulaData\") Then\n    'create new sheet\n    Set currentWs = ActiveWorkbook.ActiveSheet\n    With ActiveWorkbook\n        Set formWs = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n        formWs.Name = \"FormulaData\"\n\n        formWs.Activate\n\n        'populate with default values\n        valuesArr = Array(1, 3, 6)\n\n        Range(Cells(4, 1), Cells(6, 1)).Value = valuesArr\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>What I get is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1s3cE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1s3cE.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I want is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RTzo1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RTzo1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Why is the Range function only populating the first element in the array?</p>\n\n<p>I know this is only a few cells to update so I could easily set the value of each one individually, but I want to understand why the code I have doesn't work and what the solution is so that next time when I have 50 cells to update, I won't have to have 50 individual cell assignments. ;-)</p>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "edited": false, "score": 0, "creation_date": 1545262598, "post_id": 53860103, "comment_id": 94569229, "body": "Sorry, but I can&#39;t understand you need set or get property ?"}, {"owner": {"reputation": 59, "user_id": 3396278, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005607130649/picture?type=large", "display_name": "James", "link": "https://stackoverflow.com/users/3396278/james"}, "reply_to_user": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "edited": false, "score": 0, "creation_date": 1545315321, "post_id": 53860103, "comment_id": 94587788, "body": "I have a shape (e.g. Hexagon) that has defined shape data that i added to shape. I want to add, update specific shape data values. So i want the shape data  Prop.Object  to have a value e.g. &quot;Text&quot; which is updated via the macro."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 3396278, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005607130649/picture?type=large", "display_name": "James", "link": "https://stackoverflow.com/users/3396278/james"}, "edited": false, "score": 0, "creation_date": 1545314448, "post_id": 53861890, "comment_id": 94587286, "body": "I get a runtime error, #NAME? when i try this. I also tried vsoCell.Formula(&quot;Value&quot;) =&quot;Text&quot; and get a readonly error."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 1, "last_activity_date": 1545336024, "last_edit_date": 1545336024, "creation_date": 1545274984, "answer_id": 53861890, "question_id": 53860103, "link": "https://stackoverflow.com/questions/53860103/how-to-set-the-value-of-a-shapes-data/53861890#53861890", "title": "How to set the value of a shapes data", "body": "<p>Shape data is held in the ShapeSheet. You can access a ShapeSheet Cell to put information in, or you can access a ShapeSheet Cell to get information out.</p>\n\n<p><code>Set vsoCell = shpObject.Cells(\"Prop.Object\")</code> - this assumes you have the appropriate property (row) called \"Object\" in your ShapeSheet. You also have \"User.\" Cells to work with. </p>\n\n<p>Now you can simply use your object <code>vsoCell</code> to fill with information (e.g. <code>vsoCell.Formula = \"Scratch.X1\"</code>) - you may require double quoting to put a literal string in, instead of a formula.</p>\n\n<p>Take a generic shape, add some shape data, and then open the shapesheet to see how this is stored. This will give you some ideas about what names to call and how to manipulate this data. The ShapeSheet is a very powerful part of the Visio model, and once you learn how to manage it you can do some really good stuff.</p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 3396278, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005607130649/picture?type=large", "display_name": "James", "link": "https://stackoverflow.com/users/3396278/james"}, "is_accepted": false, "score": 0, "last_activity_date": 1545317308, "creation_date": 1545317308, "answer_id": 53870933, "question_id": 53860103, "link": "https://stackoverflow.com/questions/53860103/how-to-set-the-value-of-a-shapes-data/53870933#53870933", "title": "How to set the value of a shapes data", "body": "<p>Ok figured out that i needed to add the double quotes. </p>\n\n<pre><code>   vsoCell.Formula = \"\"\"\" &amp; cellString &amp; \"\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 3396278, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005607130649/picture?type=large", "display_name": "James", "link": "https://stackoverflow.com/users/3396278/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1750, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545336024, "creation_date": 1545258846, "last_edit_date": 1545315848, "question_id": 53860103, "link": "https://stackoverflow.com/questions/53860103/how-to-set-the-value-of-a-shapes-data", "title": "How to set the value of a shapes data", "body": "<p>Visio VBA Macro: I wish to set the value of a shapes shape data after the shape has been dropped onto the page by the program. I created a hex shape with 5 defined data shape strings. </p>\n\n<p>I have tried searching for answers but have found no clear instructions on how to do this</p>\n\n<pre><code>   Dim strConnection As String\nDim strCommand As String\nDim strOfficePath As String\nDim cellString As String\nDim vsoDataRecordset As Visio.DataRecordset\nDim vsoCell As Visio.Cell\n\nstrOfficePath = Visio.Application.Path\n\nstrConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" _\n                   &amp; \"User ID=Admin;\" _\n                   &amp; \"Data Source=svs2.XLSX;\" _\n                   &amp; \"Mode=Read;\" _\n                   &amp; \"Extended Properties=\"\"HDR=YES;IMEX=1;MaxScanRows=0;Excel 12.0;\"\";\" _\n                   &amp; \"Jet OLEDB:Engine Type=34;\"\n\nstrCommand = \"SELECT * FROM [BaseTemplate$]\"\n\nSet vsoDataRecordset = ActiveDocument.DataRecordsets.Add(strConnection, strCommand, 0, \"Data\")\n\nMsgBox \"Connected Up:\" &amp; vsoDataRecordset.DataColumns(1)\n\n'Get the row IDs of all the rows in the data recordset\nlngRowIDs = vsoDataRecordset.GetDataRowIDs(\"\")\n\n\n'Iterate through all the records in the data recordset.\nFor lngRow = LBound(lngRowIDs) + 1 To UBound(lngRowIDs) + 1\n\n    varRowData = vsoDataRecordset.GetRowData(lngRow)\n    'varRowData = vsoDataReco\n\n\n    'Drop Shape onto page\n    Set shpObject = pagThisPage.Drop(Application.Documents(\"microservices V2.VSS\").Masters(\"Microservice\"), 0#, 0#)\n\n    'Update Shapes Text\n    shpObject.Text = varRowData(0)\n\n    'Get cell that i want to update\n    Set vsoCell = shpObject.Cells(\"Prop.Object\")\n\n    'Copy data i want to apply to shape to string\n    cellString = varRowData(0)\n\n    vsoCell.Formula = cellString\n\n\n    'get shape data value to print out\n    dt = shpObject.Cells(\"Prop.Object\").ResultStr(\"\")\n\n    MsgBox \"---\" &amp; dt &amp; \":\" &amp; vsoCell.Formula\n\nNext lngRow\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545257914, "post_id": 53859795, "comment_id": 94567823, "body": "What&#39;s the  value of <code>maxRow</code>/<code>currentSID</code> when the error occurs?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1545258733, "post_id": 53859795, "comment_id": 94568114, "body": "Did you rename something (such as a worksheet code module)  to <code>Replace</code> ?"}, {"owner": {"reputation": 491, "user_id": 6515164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b69ead9bbbe78614bba7cee52d027fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Maksim", "link": "https://stackoverflow.com/users/6515164/maksim"}, "edited": false, "score": 0, "creation_date": 1545259292, "post_id": 53859795, "comment_id": 94568307, "body": "is <code>sh</code> really a sheet with a first colum containing &quot;t#&quot; strings ?"}], "owner": {"reputation": 1, "user_id": 10813221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c9de69ea4e2fd5ae9067020dd459b7d?s=128&d=identicon&r=PG&f=1", "display_name": "R. Patton", "link": "https://stackoverflow.com/users/10813221/r-patton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1578547909, "creation_date": 1545257147, "last_edit_date": 1578547909, "question_id": 53859795, "link": "https://stackoverflow.com/questions/53859795/replace-function-gives-object-doesnt-support-property-or-method", "title": "Replace function gives object doesn&#39;t support property or method", "body": "<p>This VBA script has been working just fine until today when this line\n    repStr = Replace(currentSID, \"t#\", \"SID_\")</p>\n\n<p>The Replace function shows \nAll parameters are Strings.  currentSID = \"t#3520\"</p>\n\n<pre><code>Sub AddSID(sh As Worksheet)\n    Dim r As Long\n    Dim c As Long\n    Dim currentSID As String\n    Dim maxRow As Long\n    Dim repStr As String\n\n    maxRow = sh.Cells(2000, 1).End(xlUp).Row\n    For r = maxRow To 2 Step -1\n        currentSID = sh.Cells(r, 1).Value\n        repStr = Replace(currentSID, \"t#\", \"SID_\")\n        sh.Cells(r, 1).Value = repStr\n        currentSID = sh.Cells(r, 1).Value\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1545257040, "post_id": 53859740, "comment_id": 94567476, "body": "You want to use a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\"><code>Worksheet Change()</code></a> event."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1545268388, "post_id": 53859740, "comment_id": 94570478, "body": "Use the second sheet&#39;s <code>Worksheet_Activate</code> event to check the first sheet for images and copy over any found.  Does the second sheet contain any other images?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1545268412, "post_id": 53859740, "comment_id": 94570481, "body": "@BruceWayne - pasting an image won&#39;t trigger that event."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1545271371, "post_id": 53859740, "comment_id": 94571074, "body": "@TimWilliams oh, I didn&#39;t realize that!"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1545279247, "last_edit_date": 1545279247, "creation_date": 1545268870, "answer_id": 53861304, "question_id": 53859740, "link": "https://stackoverflow.com/questions/53859740/automatically-paste-an-image-in-2nd-worksheet-when-pasted-in-1st/53861304#53861304", "title": "Automatically paste an image in 2nd worksheet when pasted in 1st", "body": "<p>You could use the second sheet's <code>Worksheet_Activate</code> event to check the first sheet for images and copy over any found. </p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\n    Dim shp As Shape, n As Long\n\n    Application.ScreenUpdating = False\n    Do While Me.Shapes.Count &gt; 0\n        Me.Shapes(1).Delete\n    Loop\n\n    n = 1\n    For Each shp In Sheets(\"Sheet1\").Shapes\n        shp.Copy\n        Me.Paste\n        With Me.Shapes(n)\n            .Left = shp.Left\n            .Top = shp.Top\n        End With\n        n = n + 1\n    Next shp\n    Me.Range(\"A1\").Select\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Whether or not this would be suitable would depend on your exact use case.</p>\n\n<p>Note - this could be irritating if your users have something in the clipboard they'd like to paste...</p>\n"}], "owner": {"reputation": 1, "user_id": 10813209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54bd8e844d0a84aa1a3d7ce560a3a4ba?s=128&d=identicon&r=PG&f=1", "display_name": "John Lindner", "link": "https://stackoverflow.com/users/10813209/john-lindner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1545279247, "creation_date": 1545256854, "last_edit_date": 1545257055, "question_id": 53859740, "link": "https://stackoverflow.com/questions/53859740/automatically-paste-an-image-in-2nd-worksheet-when-pasted-in-1st", "title": "Automatically paste an image in 2nd worksheet when pasted in 1st", "body": "<p>I would like a user to paste an image into a worksheet and automatically have it pasted to a second worksheet.  I have found some VB code that gets me close, but can't figure out how to finish it.  The image will change from user to user, but I'd like the action to occur as soon as the user pastes the image into E4.</p>\n\n<p>I found this code, which helps, but its is not automatic.</p>\n\n<pre><code>Sub InsertLogo2()\n    Dim strPath As String\n    Dim shtSheet As Worksheet\n\n    strPath = \"C:\\GraphicFolder\\PictureName.bmp\"\n\n    For Each shtSheet In Worksheets\n        shtSheet.Activate\n        Range(\"A1\").Select\n        ActiveSheet.Pictures.Insert (strPath)\n    Next shtSheet\n    Set shtSheet = Nothing\nEnd Sub\n</code></pre>\n\n<p>I'm new to VBA, so really struggling with this.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545257837, "post_id": 53859735, "comment_id": 94567794, "body": "First, check that <code>MyRowNumber</code> returns the number you&#39;re expecting. If it does, there might be hidden characters, trailing spaces etc."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545257897, "post_id": 53859735, "comment_id": 94567818, "body": "You could add a LEN formula to your sheet to check."}, {"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545258052, "post_id": 53859735, "comment_id": 94567870, "body": "MyRowNumber returns the right number. That&#39;s what I&#39;m thinking. There must be something hidden."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1545258161, "post_id": 53859735, "comment_id": 94567913, "body": "And add a Trim to your code."}, {"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545418811, "post_id": 53859735, "comment_id": 94626107, "body": "Thanks.have updated my question"}], "answers": [{"comments": [{"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "edited": false, "score": 0, "creation_date": 1545413273, "post_id": 53860507, "comment_id": 94624075, "body": "When you posted &#39;Paste here, what exactly do I need to paste? I pasted: CopyMe.EntireRow.Copy Destination:=Sheets(&quot;Sheet3&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Offset(1) but it didn&#39;t copy anything to sheet3"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1545493571, "last_edit_date": 1545493571, "creation_date": 1545261569, "answer_id": 53860507, "question_id": 53859735, "link": "https://stackoverflow.com/questions/53859735/copying-rows-to-a-wksheet-based-on-the-value-in-a-specific-column-isnt-applying/53860507#53860507", "title": "Copying rows to a wksheet based on the value in a specific column isn&#39;t applying to my whole spreadsheet", "body": "<p>You can try something like this. The below code attempts to copy everything at once instead of having many instances of copy/paste. The two tests are seeing if the trimmed value has a character length of 8 OR if the trimmed value has a character length of 9 but the last character is the apostrophe. If either of these criteria are met, we will add that cell to a <code>Union</code>. </p>\n\n<p>Once the code has looped through all rows, it will copy the entire union at all once </p>\n\n<pre><code>Option Explicit\n\nSub shooter()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\") '&lt;-- Update\nDim LR As Long, i As Long, Add As Boolean, CopyMe As Range\nDim x As Range\n\nLR = ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row\n\nFor Each x In ws.Range(\"B2:B\" &amp; LR)\n  Add = False\n\n    If Len(Trim(x)) = 8 Then\n        Add = True\n    ElseIf Len(Trim(x)) = 9 And Right(Trim(x), 1) = \"'\" Then\n        Add = True\n    End If\n\n    If Add Then\n        If Not CopyMe Is Nothing Then\n            Set CopyMe = Union(CopyMe, x)\n        Else\n            Set CopyMe = x\n        End If\n    End If\n\nNext x\n\nIf Not CopyMe Is Nothing Then\n    CopyMe.EntireRow.Copy Destination:=Sheets(2).Range(\u201cA1\u201d)\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "edited": false, "score": 0, "creation_date": 1545418952, "post_id": 53860635, "comment_id": 94626163, "body": "Thanks. It did not copy anything. I&#39;ve updated my question."}, {"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "edited": false, "score": 0, "creation_date": 1545422132, "post_id": 53860635, "comment_id": 94627208, "body": "Thanks.You&#39;ve just edited something and it works fine. What have you changed?"}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "reply_to_user": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "edited": false, "score": 0, "creation_date": 1545422671, "post_id": 53860635, "comment_id": 94627425, "body": "I changed Sheets(&quot;Sheet2&quot;) to Sheets(2) because I was guessing your sheet name might be different, hence the reason it wasn&#39;t working."}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "reply_to_user": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "edited": false, "score": 0, "creation_date": 1545423820, "post_id": 53860635, "comment_id": 94627838, "body": "Thank you for marking it as the answer. I would suggest using urdearboy&#39;s answer as it is almost instantaneous, and much faster than mine."}, {"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "edited": false, "score": 0, "creation_date": 1545424105, "post_id": 53860635, "comment_id": 94627926, "body": "s2 is not defined in his answer"}], "tags": [], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "is_accepted": true, "score": 1, "last_activity_date": 1545419455, "last_edit_date": 1545419455, "creation_date": 1545262614, "answer_id": 53860635, "question_id": 53859735, "link": "https://stackoverflow.com/questions/53859735/copying-rows-to-a-wksheet-based-on-the-value-in-a-specific-column-isnt-applying/53860635#53860635", "title": "Copying rows to a wksheet based on the value in a specific column isn&#39;t applying to my whole spreadsheet", "body": "<p>I'm sure there is a better way to do the copy/paste, which is where your issue is, but the below works.</p>\n\n<pre><code>Sub aims()\nDim i As Long\nDim vLastRow As Long\nDim s2 As Long\n\n'find last row in sheet, or you could change to find last row in specified column\n'Example: Cells = Columns(column number or letter), Cells(1, 1) = Cells(1, column number)\nvLastRow = Cells.Find(what:=\"*\", after:=Cells(1, 1), searchorder:=xlByRows, searchdirection:=xlPrevious).Row\ns2 = 1\n\nApplication.ScreenUpdating = False\n\nFor i = 1 To vLastRow\n    If Trim(Len(CStr(Cells(i, 2)))) = 8 Then\n        Rows(i).EntireRow.Copy Destination:=Sheets(2).Range(Cells(s2, 1).Address)\n        s2 = s2 + 1\n    End If\nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 53860635, "answer_count": 2, "score": 0, "last_activity_date": 1578547936, "creation_date": 1545256830, "last_edit_date": 1578547936, "question_id": 53859735, "link": "https://stackoverflow.com/questions/53859735/copying-rows-to-a-wksheet-based-on-the-value-in-a-specific-column-isnt-applying", "title": "Copying rows to a wksheet based on the value in a specific column isn&#39;t applying to my whole spreadsheet", "body": "<p>I'm looping over values in Column B of the current worksheet. If the value's length is 8 characters, copy the WHOLE row to another sheet. \nIt is kind of working, but I'm missing around a hundred rows that should have been copied.</p>\n\n<p>I guess it's to do with the format of the cell values in Column B. There are some that are just Text headers which will definitely not meet the criteria. The ones that it should copy are all in this format (Column B):</p>\n\n<pre><code>6008571X\n60088242\n....\n</code></pre>\n\n<p>The rows I'm interested in have 8 characters in Column B. The problem is that some of them might be formatted as numbers some as text (or perhaps preceded by ').</p>\n\n<pre><code>Sub aims()\n    Dim i As Long\n    'Get the address of the first non blank cell in Row B from the bottom\n    MyFirstBlankAddress = Range(\"B1048576\").End(xlUp).Offset(1, 0).Address\n    'Extract the number from the address to get the row number\n    MyRowNumber = Split(MyFirstBlankAddress, \"$\")(2)\n\n    For i = 1 To MyRowNumber\n        With Range(\"B\" &amp; i)\n            If Len(.Value) = 8 Then .EntireRow.Copy Destination:=Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        End With\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I was expecting 410 rows copied, while only 276 got copied. </p>\n\n<p>EDIT: I have been reading your answers/suggestions and testing stuff. I've found out that the problem lies elsewhere. My original code identifies the rows in a correct way, it's something to do with copying.</p>\n\n<p>If I change my code to just highlight the matching rows, it matches all the right rows:</p>\n\n<pre><code>If Len(.Value) = 8 Then .EntireRow.Interior.Color = 5296274\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545254617, "post_id": 53859270, "comment_id": 94566519, "body": "No errors, just does not change the subject."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1545254657, "post_id": 53859270, "comment_id": 94566533, "body": "Have you tested that the code is actually running?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1545254729, "post_id": 53859270, "comment_id": 94566554, "body": "You need to test <code>If Len(Item.Subject) &gt; 11 Then</code>"}, {"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "edited": false, "score": 0, "creation_date": 1545254741, "post_id": 53859270, "comment_id": 94566559, "body": "Yes. And if I change it to = &quot;Test&quot; it works fine. Do I need a. value at the end? Does it work like vba for excel?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1545254837, "post_id": 53859270, "comment_id": 94566600, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39134335/updating-email-subject-in-outlook-vba\">Updating email subject in Outlook VBA</a>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1545262369, "post_id": 53859270, "comment_id": 94569168, "body": "There is nothing wrong with you code, how are you calling/running the code?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545266030, "post_id": 53859270, "comment_id": 94570014, "body": "where does the message come from?"}, {"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1545324190, "post_id": 53859270, "comment_id": 94592706, "body": "@0m3r I am calling the code with an Outlook rule &quot;Run a Script&quot;."}, {"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545324194, "post_id": 53859270, "comment_id": 94592707, "body": "@Dmitry Streblechenko The email comes from multiple users, but will always use the same email template."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545325003, "post_id": 53859270, "comment_id": 94593144, "body": "Does the code actually run?"}, {"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545327356, "post_id": 53859270, "comment_id": 94594252, "body": "@Dmitry Streblechenko Yes it does - If I change the equals to, to &quot;Test&quot; it will change just fine. But switching it back to <code>Right(Item.Subject, 11)</code> does nothing."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545337531, "post_id": 53859270, "comment_id": 94598339, "body": "Have you tried to add a line like MsgBox Item.Subject &amp; vbCrLf &amp; Right(Item.Subject, 11)"}, {"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545339475, "post_id": 53859270, "comment_id": 94599074, "body": "@DmitryStreblechenko - The msgbox prompted fine, but it still has the original subject line in it."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545339607, "post_id": 53859270, "comment_id": 94599119, "body": "But did the second line of the prompt show the expected 11 chars long value?"}, {"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545341514, "post_id": 53859270, "comment_id": 94599936, "body": "@Dmitry Streblechenko I went to test and verfiy, now I cant even get a msgbox to prompt.... I&#39;m lost."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545409300, "post_id": 53859270, "comment_id": 94622434, "body": "So that manes your script is not running. Or that execution does not get to that line."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1545451094, "post_id": 53859270, "comment_id": 94632314, "body": "Delete your rule and re-create it again"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "edited": false, "score": 0, "creation_date": 1545255286, "post_id": 53859416, "comment_id": 94566793, "body": "I wish I understood all of that. I am decently new to VBA and I have never used it in Outlook. That still does not work. Could it be the way my rule is set up? Could that prevent it?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "edited": false, "score": 0, "creation_date": 1545328049, "post_id": 53859416, "comment_id": 94594546, "body": "Sorry, I added explanations. I also added some debug lines so you can see when your code ran. Just open the &quot;Immediate Window&quot; <code>CTRL+G</code> and you will see the debug messages when the code runs."}, {"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "edited": false, "score": 0, "creation_date": 1545328117, "post_id": 53859416, "comment_id": 94594568, "body": "Thank you so much. That is awesome info."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1545337442, "post_id": 53859416, "comment_id": 94598306, "body": "Absolutely not - to change any property, displaying the item is not necessary. As long as you call Save."}, {"owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "edited": false, "score": 0, "creation_date": 1545339341, "post_id": 53859416, "comment_id": 94599008, "body": "@HackSlash - This is getting closer! The email opens, subject changes, but the window does not close. Also, the Subject in the Reading Pane does not change. For the window now closing, could I add <code>MailItem.Close</code> after <code>Item.Save</code>?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1545342587, "post_id": 53859416, "comment_id": 94600343, "body": "I added <code>Item.Close</code>. Try that."}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1545342569, "last_edit_date": 1545342569, "creation_date": 1545254987, "answer_id": 53859416, "question_id": 53859270, "link": "https://stackoverflow.com/questions/53859270/vba-for-outlook-change-subject-line-using-right/53859416#53859416", "title": "VBA for Outlook - Change Subject Line using Right", "body": "<p>I found another SO thread that says you can't modify the subject of a message without opening it first. We can use ActiveInspector to get a handle on the Item after we display it. Then we can change it, save it, and close it. I added a check to see if the subject is actually longer than 11 characters before we attempt to truncate it.</p>\n\n<p>Try this:</p>\n\n<pre><code>Public Sub ChangeSubjectForward(ByRef Item As Outlook.MailItem)\n    Debug.Print Now                              '  This shows you when the code runs\n    If Len(Item.Subject) &gt; 11 Then\n        Debug.Print \"Subject is too long. Trimming...\" '  This shows that we tried to truncate.\n\n        Item.Display                             'Force the pop-up\n\n        Dim thisInspector As Inspector\n        Set thisInspector = Application.ActiveInspector\n\n        Set Item = thisInspector.CurrentItem     ' Get the handle from the Inspector\n        Item.Subject = Right$(Item.Subject, 11)\n        Item.Save\n        Item.Close\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1545272900, "creation_date": 1545272900, "answer_id": 53861671, "question_id": 53859270, "link": "https://stackoverflow.com/questions/53859270/vba-for-outlook-change-subject-line-using-right/53861671#53861671", "title": "VBA for Outlook - Change Subject Line using Right", "body": "<p>You could create a <a href=\"https://www.slipstick.com/outlook/rules/outlooks-rules-and-alerts-run-a-script/\" rel=\"nofollow noreferrer\">macro rule</a> then run the below code:</p>\n\n<pre><code>Sub save_to_dir_test1(mymail As MailItem)\nDim strID As String\nDim objMail As Outlook.MailItem\n\nstrID = mymail.EntryID\nSet objMail = Application.Session.GetItemFromID(strID)\nobjMail.Subject = Right(m.Subject, 11)\nobjMail.Save\nSet objMail = Nothing\nEnd Sub\n</code></pre>\n\n<p>For more information, please refer to this link:</p>\n\n<p><a href=\"https://www.slipstick.com/outlook/rules/run-script-rule-change-subject-message/\" rel=\"nofollow noreferrer\">Run a Script Rule: Change Subject then Forward Message</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/14020905/getting-the-incoming-email-in-outlook-via-vba\">Getting the incoming email in outlook via VBA</a></p>\n"}], "owner": {"reputation": 11, "user_id": 10813124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4fb8718ec0e319f9d9c6d9e890f354?s=128&d=identicon&r=PG&f=1", "display_name": "sbradley4554", "link": "https://stackoverflow.com/users/10813124/sbradley4554"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1291, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1592699799, "creation_date": 1545254387, "last_edit_date": 1592699799, "question_id": 53859270, "link": "https://stackoverflow.com/questions/53859270/vba-for-outlook-change-subject-line-using-right", "title": "VBA for Outlook - Change Subject Line using Right", "body": "<p>I am trying to change incoming emails subject line to only the last 11 characters of the subject line. When I use <code>Item.Subject = Right(Item.Subject,11)</code> it does not work. </p>\n\n<p>Can someone assist?</p>\n\n<p>Full code. </p>\n\n<pre><code>Sub ChangeSubjectForward(Item As Outlook.MailItem)\nItem.Subject = Right(Item.Subject, 11) \nItem.Save\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23, "user_id": 8727171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb9ce5ae520ac8024fe24a8ee3555898?s=128&d=identicon&r=PG&f=1", "display_name": "mfergus9", "link": "https://stackoverflow.com/users/8727171/mfergus9"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545332545, "post_id": 53858993, "comment_id": 94596446, "body": "I responded yesterday to an answer in the previous thread with the array printing method and informed the poster that his code solved the issue.  Now that I learned how to print the array, I want to have two columns printed (solved by previous thread), one with the chapter headings (solved) and one with the data between chapter headings (this question).  Feel free to remove excess code, the question should be focused on selection logic for the data between &#39;bolded&#39; headings."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545333280, "post_id": 53858993, "comment_id": 94596716, "body": "If an answer solved the issue, please click the checkmark next to that answer. That will mark it as such, which will help others as well as those who answer recognize it. After you have 15 &quot;reputation points&quot; you&#39;ll also be able to upvote all contributions (both questions and answers) on the site you consider useful, which also helps others recognize quality."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8727171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb9ce5ae520ac8024fe24a8ee3555898?s=128&d=identicon&r=PG&f=1", "display_name": "mfergus9", "link": "https://stackoverflow.com/users/8727171/mfergus9"}, "edited": false, "score": 0, "creation_date": 1545261918, "post_id": 53859313, "comment_id": 94569051, "body": "Thank you for your response!  The format I received the document in does not have the chapters as headings, and there are a little under 1400 chapters in the document. Though there are 20 sections that the chapters fall under which are marked as headings in word&#39;s navigation panel.  Maybe there is something in style that denotes these chapters as a child object of the heading?  I don&#39;t know but I&#39;m googling right now."}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1545254572, "creation_date": 1545254572, "answer_id": 53859313, "question_id": 53858993, "link": "https://stackoverflow.com/questions/53858993/store-all-information-between-bold-sentences-as-array-elements-word-vba/53859313#53859313", "title": "Store all information between bold sentences as array elements, Word VBA", "body": "<p>If you use the \"Headings\" feature of Word you can use those. Either \"Heading 1\" or \"Heading 2\" are objects that denote chapters and are already used by Word to build the table of contents.</p>\n\n<p>This example uses \"Heading 1\" but you could use any other built-in Style:</p>\n\n<pre><code>Sub SelectData()\n    Dim Doc As Word.Document\n    Set Doc = ActiveDocument\n\n    Dim findRange As Range\n    Set findRange = Doc.Range\n\n    findRange.Find.Style = \"Heading 1\"\n\n    Dim startCopyRange As Long\n    Dim endCopyRange As Long\n    Do While findRange.Find.Execute() = True\n        startCopyRange = findRange.End + 1\n        endCopyRange = -1\n\n        Dim myParagraph As Paragraph\n        Set myParagraph = findRange.Paragraphs(1).Next\n\n        Do While Not myParagraph Is Nothing\n            myParagraph.Range.Select 'Debug only\n\n            If InStr(myParagraph.Style, \"Heading\") &gt; 0 Then\n                endCopyRange = myParagraph.Range.Start - 0\n            End If\n\n            If myParagraph.Next Is Nothing Then\n                endCopyRange = myParagraph.Range.End - 0\n            End If\n\n            If endCopyRange &lt;&gt; -1 Then\n                Doc.Range(startCopyRange, endCopyRange).Select  'Debug only\n                DoEvents\n                Exit Do\n            End If\n\n            Set myParagraph = myParagraph.Next\n            DoEvents\n        Loop\n    Loop\nEnd Sub\n</code></pre>\n\n<p>SOURCE:\n<a href=\"https://stackoverflow.com/questions/47735843/finding-heading-of-chapters-in-word-file-and-copying-individual-paragraphs-to-ne\">Finding heading of chapters in word file and copying individual paragraphs to new word file with VBA</a></p>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1545259904, "creation_date": 1545259904, "answer_id": 53860260, "question_id": 53858993, "link": "https://stackoverflow.com/questions/53858993/store-all-information-between-bold-sentences-as-array-elements-word-vba/53860260#53860260", "title": "Store all information between bold sentences as array elements, Word VBA", "body": "<p>Try something based on:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nDim ArrTxt, i As Long\nWith ActiveDocument\n  With .Range\n    With .Find\n      .ClearFormatting\n      .Replacement.ClearFormatting\n      .Text = \"\"\n      .Replacement.Text = \"\u00a7\"\n      .Format = True\n      .Font.Bold = True\n      .Forward = True\n      .Wrap = wdFindContinue\n      .Execute Replace:=wdReplaceAll\n    End With\n    ArrTxt = Split(.Text, \"\u00a7\")\n  End With\n  .Undo 1\nEnd With\nApplication.ScreenUpdating = True\nFor i = 1 To UBound(ArrTxt)\n  MsgBox ArrTxt(i)\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": true, "score": 1, "last_activity_date": 1545263203, "creation_date": 1545263203, "answer_id": 53860704, "question_id": 53858993, "link": "https://stackoverflow.com/questions/53858993/store-all-information-between-bold-sentences-as-array-elements-word-vba/53860704#53860704", "title": "Store all information between bold sentences as array elements, Word VBA", "body": "<p>The code below relies on your statement that only headings are bolded.  If there is any text that is not bolded before the first heading then you will need to add code to skip over this text unbolded text.  I originally wrote this using a Type to define the Chapter but VBA kept giving me cryptic error messages so I reverted to an array.</p>\n\n<p>The collection returned should contain arrays where index(1) is the heading text, and index(2) is the body text.  The code was written with option explicit and raises no inspection issues with Rubberduck.</p>\n\n<pre><code>Option Explicit\n\nSub testCompileChapters()\n\nDim ChapterCollection As Collection\n\n    Set ChapterCollection = New Collection\n\n    Set ChapterCollection = CompileChapters(ActiveDocument.Content)\n    MsgBox \"There are \" &amp; ChapterCollection.Count &amp; \" Chapters in your document\", vbOK\n    Debug.Print ChapterCollection.Item(1)(1).Text\n    Debug.Print ChapterCollection.Item(1)(2).Text\nEnd Sub\n\nPublic Function CompileChapters(ByRef this_range As Word.Range) As Collection\n\nDim my_chapter(1 To 2)  As Word.Range\nDim my_chapters         As Collection\nDim my_para             As Word.Paragraph\nDim my_range_start      As Long\nDim my_bold             As Long\n\n    With this_range.Paragraphs(1).Range\n\n        my_range_start = .Start\n        my_bold = .Font.Bold\n\n    End With\n\n    Set my_chapters = New Collection\n\n    For Each my_para In this_range.Paragraphs\n\n        my_para.Range.Select\n\n        If my_bold &lt;&gt; my_para.Range.Font.Bold Then\n\n            With ActiveDocument.Range(Start:=my_range_start, End:=my_para.Range.Previous(unit:=wdParagraph).End)\n\n                If my_bold = -1 Then\n\n                    Set my_chapter(1) = .Duplicate\n\n                Else\n\n                    Set my_chapter(2) = .Duplicate\n                    my_chapters.Add Item:=my_chapter\n\n                End If\n\n                my_bold = Not my_bold\n                my_range_start = my_para.Range.Start\n\n            End With\n\n        End If\n\n    Next\n\n    Set my_chapter(2) = _\n        ActiveDocument.Range( _\n            Start:=my_range_start, _\n            End:=ActiveDocument.Range.Paragraphs.Last.Range.End)\n\n    my_chapters.Add Item:=my_chapter\n    Set CompileChapters = my_chapters\n\nEnd Function\n</code></pre>\n\n<p>The code above checked out OK on a the 6 chapter document below.</p>\n\n<p><strong>This is bold text 1</strong><br>\nThis is not bold text1<br>\nThis is not bold text<br>\nThis is not bold text<br>\n<strong>This is bold text 2</strong><br>\nThis is not bold text2<br>\nThis is not bold text<br>\nThis is not bold text<br>\n<strong>This is bold text 3</strong><br>\nThis is not bold text3<br>\nThis is not bold text<br>\nThis is not bold text<br>\nThis is not bold text<br>\nThis is not bold text<br>\n<strong>This is bold text 4</strong><br>\nThis is not bold text4<br>\nThis is not bold text<br>\nThis is not bold text<br>\n<strong>This is bold text 5</strong><br>\nThis is not bold text5<br>\nThis is not bold text<br>\nThis is not bold text<br>\n<strong>This is bold text 6</strong><br>\nThis is not bold text6<br>\nThis is not bold text<br>\nThis is not bold text  </p>\n"}], "owner": {"reputation": 23, "user_id": 8727171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb9ce5ae520ac8024fe24a8ee3555898?s=128&d=identicon&r=PG&f=1", "display_name": "mfergus9", "link": "https://stackoverflow.com/users/8727171/mfergus9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 53860704, "answer_count": 3, "score": 0, "last_activity_date": 1545263203, "creation_date": 1545252718, "last_edit_date": 1545256008, "question_id": 53858993, "link": "https://stackoverflow.com/questions/53858993/store-all-information-between-bold-sentences-as-array-elements-word-vba", "title": "Store all information between bold sentences as array elements, Word VBA", "body": "<p>I am a VBA novice and I am trying to create an array from a 400 page word document in VBA made of chapter content.  Each element of the array should contain all of the paragraphs following a bolded chapter title until the next chapter title.  It may be better phrased as the information between chapter titles.  </p>\n\n<p>The chapter title is a sentence which is always bolded (and the only portion of the document which is bolded).  The information following the chapter description may have multiple paragraphs and bulleted information but also may be completely empty in a few cases. In a case with empty chapter content, I would like a blank entry of some kind stored.</p>\n\n<p>I've managed to make an array that has every  paragraph as an array element.  However, since there are sometimes multiple paragraphs and bulleted sections per chapter the amount of elements in the array is greater than the amount of chapters.  The array also stores the chapter titles as their own element (I figured out how to remove titles from the array with like comparisons though).  I am a bit lost after researching this subject for several hours today.</p>\n\n<p>What would be a method to store all of the information between 'bolded chapter headings' as an element in an array?  </p>\n\n<p>Many thanks for your help!</p>\n\n<pre><code>    Sub addUnderlinedWordsToArray()\n    On Error GoTo errhand:\n    Dim myWords()       As String\n    Dim i               As Long\n    Dim myDoc           As Document: Set myDoc = ActiveDocument ' Change as needed\n    Dim aRange          As Range: Set aRange = myDoc.Content\n    Dim sRanges         As StoryRanges: Set sRanges = myDoc.StoryRanges\n    Dim ArrayCounter    As Long: ArrayCounter = 0 ' counter for items added to the array\n    Dim Sentence        As Range\n    Dim Paragraph       As Range\n\n    Dim w               As Variant\n    Dim myDescs()       As String\n    Dim x               As Variant\n\n    Application.ScreenUpdating = False\n    ReDim myWords(aRange.Words.Count) ' set a array as large as the\n                                      ' number of words in the doc\n\n    For Each Paragraph In ActiveDocument.StoryRanges\n        For Each w In ActiveDocument.Paragraphs\n                  myWords(ArrayCounter) = w\n                 ArrayCounter = ArrayCounter + 1\n        Next\n    Next\n\n\n\nOn Error GoTo 0\n\n    Set myDoc = Nothing\n    Set aRange = Nothing\n    Set sRanges = Nothing\n\n\n    Set Ex0 = New Excel.Application\n    Set Wb0 = Ex0.Workbooks.Add\n    Ex0.Visible = True\n\n    Wb0.Sheets(1).Range(\"A1\").Resize(UBound(myWords) + 1, 1) = WorksheetFunction.Transpose(myWords)\n\n    Application.ScreenUpdating = True\n\n    Debug.Print UBound(myWords())\n\n    Exit Sub\n\nerrhand:\n    Application.ScreenUpdating = True\n    MsgBox \"An unexpected error has occurred.\" _\n         &amp; vbCrLf &amp; \"Please note and report the following information.\" _\n         &amp; vbCrLf &amp; \"Subroutine Name: addUnderlinedWordsToArray\" _\n         &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n         &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n         , vbCritical, \"Error!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": -1, "last_activity_date": 1545259978, "creation_date": 1545259978, "answer_id": 53860271, "question_id": 53858555, "link": "https://stackoverflow.com/questions/53858555/substitute-text-on-active-cell/53860271#53860271", "title": "Substitute text on active cell", "body": "<pre><code>Option Explicit\nSub SubstituteTotal()\n\n    Dim rng As Range, cll As Range\n\n    Set rng = Selection\n\n    For Each cll In rng\n        cll.Value = WorksheetFunction.Substitute(cll.Value, \"Sum Total\", \"Sum\")\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1545260469, "creation_date": 1545260469, "answer_id": 53860349, "question_id": 53858555, "link": "https://stackoverflow.com/questions/53858555/substitute-text-on-active-cell/53860349#53860349", "title": "Substitute text on active cell", "body": "<p>Try this:</p>\n\n<pre><code>With ActiveCell\n    .Value2 = Worksheetfunction.Substitute(.Value2, \"Total\", \"\")\nEnd With\n</code></pre>\n\n<p>If you want to get the value of the active cell or currently selected cell, use <code>ActiveCell</code>.<br>\nI used <code>With</code> clause to explicitly call it, but it can be written like this too.</p>\n\n<pre><code>ActiveCell.Value2 = Worksheetfunction.Substitute(ActiveCell.Value2, \"Total\", \"\")\n</code></pre>\n\n<p>This works as well, but implicit.</p>\n\n<pre><code>ActiveCell = Worksheetfunction.Substitute(ActiveCell, \"Total\", \"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1545294582, "creation_date": 1545294582, "answer_id": 53864926, "question_id": 53858555, "link": "https://stackoverflow.com/questions/53858555/substitute-text-on-active-cell/53864926#53864926", "title": "Substitute text on active cell", "body": "<h1>Substitute vs Replace</h1>\n\n<p>Your corrected line of code:</p>\n\n<pre><code>Sub SubstituteActiveCell()\n</code></pre>\n\n<blockquote>\n<pre><code>  ActiveCell = WorksheetFunction.Substitute(ActiveCell, \" Total\", \"\")\n</code></pre>\n</blockquote>\n\n<pre><code>End Sub\n</code></pre>\n\n<p>where you have forgotten the space before the Total. To avoid this, it is often better to substitute or replace what was given.</p>\n\n<p>VBA has a similar function called Replace:</p>\n\n<pre><code>Sub ReplaceActiveCell()\n</code></pre>\n\n<blockquote>\n<pre><code>  ActiveCell.Replace \"sum Total\", \"sum\"\n</code></pre>\n</blockquote>\n\n<pre><code>End Sub\n</code></pre>\n\n<p>which should be preferable.</p>\n"}], "owner": {"reputation": 11, "user_id": 10798072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5264fedd405529ca7fd81919bdbbf6?s=128&d=identicon&r=PG&f=1", "display_name": "Lu&#237;s Jervell", "link": "https://stackoverflow.com/users/10798072/lu%c3%ads-jervell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1578547968, "creation_date": 1545250519, "last_edit_date": 1578547968, "question_id": 53858555, "link": "https://stackoverflow.com/questions/53858555/substitute-text-on-active-cell", "title": "Substitute text on active cell", "body": "<p>I would like to substitute text in active cell. From \"sum Total\" to \"sum\".</p>\n\n<p>My code is:</p>\n\n<pre><code>Sub Macro2_substitute()    \n  cell = WorksheetFunction.Substitute(cell, \"Total\", \"\")   \nEnd Sub\n</code></pre>\n\n<p>It doesn't work. Help would be appreciated.</p>\n"}, {"tags": ["vba", "ms-access", "textbox"], "comments": [{"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1545253461, "post_id": 53858295, "comment_id": 94566049, "body": "Why reinvent the wheel? Why not contribute to existing open source chat products like: <a href=\"https://about.riot.im/\" rel=\"nofollow noreferrer\">about.riot.im</a> or <a href=\"https://rocket.chat/\" rel=\"nofollow noreferrer\">rocket.chat</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": true, "score": 1, "last_activity_date": 1545253313, "creation_date": 1545253313, "answer_id": 53859092, "question_id": 53858295, "link": "https://stackoverflow.com/questions/53858295/how-to-make-textbox-already-scrolled-down-at-all-times/53859092#53859092", "title": "How to make TextBox already scrolled-down at all times?", "body": "<p>The answer is:</p>\n\n<pre><code>txtBox.selstart = len(txtBox.Value)\n</code></pre>\n\n<p>But where would you call this from? You say at all times even when not focused but to do that you would need a VBA macro running all the time: looking for new messages, adding new messages, and scrolling the box. Access was not designed to work this way.</p>\n\n<p>Access is not a good application to make the front end for a chat room. You can use Access for the back-end: storing the messages, users, and timestamps in tables. I would recommend you use VB.NET to make the front end. VB.NET is multi-threaded so the front end would have the message checking thread adding new messages to the text box while the UI thread can push new messages to the DB where it will be picked up by the new message event and show up in the textbox.</p>\n"}], "owner": {"reputation": 13, "user_id": 10812918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124b5f1f9894bd66f5e722a74c7e0882?s=128&d=identicon&r=PG&f=1", "display_name": "Sedo", "link": "https://stackoverflow.com/users/10812918/sedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 53859092, "answer_count": 1, "score": 0, "last_activity_date": 1545253313, "creation_date": 1545249156, "last_edit_date": 1545249938, "question_id": 53858295, "link": "https://stackoverflow.com/questions/53858295/how-to-make-textbox-already-scrolled-down-at-all-times", "title": "How to make TextBox already scrolled-down at all times?", "body": "<p>I'm builing a chatroom in an Access form.</p>\n\n<p>I set up a large <code>TextBox</code> control in the form, to contain all the chat messages. </p>\n\n<p>I need to make it scroll down at all times, even when it isn't focused. </p>\n\n<p>How can I do this? </p>\n"}, {"tags": ["excel", "vba", "path"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "edited": false, "score": 0, "creation_date": 1545250181, "post_id": 53858322, "comment_id": 94564720, "body": "thanks for your response! I has worked. I thought I tried that. I appreciate your help!"}], "tags": [], "owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "is_accepted": true, "score": 2, "last_activity_date": 1545249302, "creation_date": 1545249302, "answer_id": 53858322, "question_id": 53858273, "link": "https://stackoverflow.com/questions/53858273/open-windows-explorer-using-excel-vba-referencing-path-and-a-cell-formula/53858322#53858322", "title": "Open Windows Explorer using Excel VBA referencing path and a cell formula", "body": "<p>You need to refer to</p>\n\n<pre><code>\"ActiveSheet.Range(N1).Value\"\n</code></pre>\n\n<p>as</p>\n\n<pre><code>ActiveSheet.Range(\"N1\").Value\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 53858322, "answer_count": 1, "score": 0, "last_activity_date": 1578548009, "creation_date": 1545249057, "last_edit_date": 1578548009, "question_id": 53858273, "link": "https://stackoverflow.com/questions/53858273/open-windows-explorer-using-excel-vba-referencing-path-and-a-cell-formula", "title": "Open Windows Explorer using Excel VBA referencing path and a cell formula", "body": "<p>I'm having problems opening a folder designated by a path and a cell</p>\n\n<pre><code>Private Sub cmd_OPEN_FOLDER_Click()\n\n    Dim d As String\n    Dim FolderPath As String\n    Dim FinalFolder As String\n\n    FolderPath = \"C:\\Users\\USER1\\Desktop\\ExampleFolder1\\ExampleFolder2\\\"\n\n    FinalFolder = \"ActiveSheet.Range(N1).Value\" &amp; \"\\\"\n\n    Call Shell(\"explorer.exe \"\"\" &amp; FolderPath &amp; FinalFolder &amp; \"\", vbNormalFocus)\n\nEnd Sub\n</code></pre>\n\n<p>If I omit,</p>\n\n<pre><code>FinalFolder = \"ActiveSheet.Range(N1).Value\" &amp; \"\\\"\n</code></pre>\n\n<p>and change,</p>\n\n<pre><code>Call Shell(\"explorer.exe \"\"\" &amp; FolderPath &amp; FinalFolder &amp; \"\", vbNormalFocus)\n</code></pre>\n\n<p>to,</p>\n\n<pre><code>Call Shell(\"explorer.exe \"\"\" &amp; FolderPath &amp; \"\", vbNormalFocus)\n</code></pre>\n\n<p>it works. But if I add 'FinalFolder'. It opens MyDocuments folder. I guess its a default when something isn't working?</p>\n\n<p>Cell N1 has a formula which references another cell on a different sheet. The Formula is \"=LISTS!A4\". This sheet is hidden.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10812743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c201b627f4f31c5b8b72cf6b22326df?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/10812743/matt"}, "edited": false, "score": 0, "creation_date": 1545254955, "post_id": 53858477, "comment_id": 94566645, "body": "Hi - thank you for the help. It seems like it doesn&#39;t entirely work.  For &#39;9 - USA Arch \t9&#39;\tthe values becomes &#39;USA\tArch\t16.02885441&#39;. Though it should be 101.4423625.  It seems like it is instead multiplying by the &quot;France&quot; location instead of &quot;USA&quot;"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 0, "last_activity_date": 1545255138, "last_edit_date": 1545255138, "creation_date": 1545250120, "answer_id": 53858477, "question_id": 53858145, "link": "https://stackoverflow.com/questions/53858145/increasing-decreasing-values-with-limited-information/53858477#53858477", "title": "Increasing/Decreasing values with limited information", "body": "<p>Replace the <code>N/A</code> with nothing then in that column Find &amp; Select, Go To Special..., Blanks:</p>\n\n<pre><code>=, Down, *, .85, Ctrl+Enter\n</code></pre>\n\n<p>Then replace the <code>0</code>s and repeat with</p>\n\n<pre><code>=, Up, *, 1.15, Ctrl+Enter\n</code></pre>\n\n<p>In this order <code>66.7</code> becomes <code>63.75</code> but reverse the sequence for the latter value - and where groups change and you have a blank row first put something in the relevant cell.</p>\n"}], "owner": {"reputation": 15, "user_id": 10812743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c201b627f4f31c5b8b72cf6b22326df?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/10812743/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 53858477, "answer_count": 1, "score": 1, "last_activity_date": 1578548037, "creation_date": 1545248467, "last_edit_date": 1578548037, "question_id": 53858145, "link": "https://stackoverflow.com/questions/53858145/increasing-decreasing-values-with-limited-information", "title": "Increasing/Decreasing values with limited information", "body": "<p>We have data like below and I am trying to calculate the N/A's by using current information. The N/A's should either be increasing by 15% or decreasing by 15%. Please see the below image for clarity.\nNote:\nColumn grade is a just column \"Level + Location + Family\" Combined\n'Location', 'Family', 'Mid', and 'Level' are the variables.</p>\n\n<p>Before:\n<a href=\"https://i.imgur.com/zNPNGcx.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/zNPNGcx.png</a></p>\n\n<p>After: (I did not edit the \"Before\" data, but rather placed them on the side for easier comparison)</p>\n\n<p><a href=\"https://i.imgur.com/nPkpA0I.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/nPkpA0I.png</a></p>\n\n<p>BEFORE:</p>\n\n<pre><code>Grade   Level   Location    Family  Mid\n1 - USA Arch    1   USA Arch    N/A\n2 - USA Arch    2   USA Arch    N/A\n3 - USA Arch    3   USA Arch    N/A\n4 - USA Arch    4   USA Arch    50\n5 - USA Arch    5   USA Arch    58\n6 - USA Arch    6   USA Arch    N/A\n7 - USA Arch    7   USA Arch    75\n8 - USA Arch    8   USA Arch    88\n9 - USA Arch    9   USA Arch    N/A\n10 - USA Arch   10  USA Arch    N/A\n11 - USA Arch   11  USA Arch    N/A\n12 - USA Arch   12  USA Arch    N/A\n\n1 - France Art  1   France  Art     N/A\n2 - France Art  2   France  Art     N/A\n3 - France Art  3   France  Art     N/A\n4 - France Art  4   France  Art     50\n5 - France Art  5   France  Art     55\n6 - France Art  6   France  Art     N/A\n7 - France Art  7   France  Art     N/A\n8 - France Art  8   France  Art     N/A\n9 - France Art  9   France  Art     N/A\n10 - France Art     10  France  Art     N/A\n11 - France Art     11  France  Art     N/A\n12 - France Art     12  France  Art     N/A\n</code></pre>\n\n<p>AFTER:</p>\n\n<pre><code>Grade   Level   Location    Family  Mid Need (Mid column with the needed values)    Notes\n1 - USA Arch    1   USA Arch    N/A 30.70625    Decrease by 15% from F3\n2 - USA Arch    2   USA Arch    N/A 36.125  Decrease by 15% from F4\n3 - USA Arch    3   USA Arch    N/A 42.5    Decrease by 15% from F5\n4 - USA Arch    4   USA Arch    50  50  Does not change\n5 - USA Arch    5   USA Arch    58  58  Does not change\n6 - USA Arch    6   USA Arch    N/A 66.7    Increase 15% from F6\n7 - USA Arch    7   USA Arch    75  75  Does not change\n8 - USA Arch    8   USA Arch    88  88  Does not change\n9 - USA Arch    9   USA Arch    N/A 101.4423625 Increase 15% from F9\n10 - USA Arch   10  USA Arch    N/A 116.6587169 Increase 15% from F10\n11 - USA Arch   11  USA Arch    N/A 134.1575244 Increase 15% from F11\n12 - USA Arch   12  USA Arch    N/A 154.2811531 Increase 15% from F12\n\n1 - France Art  1   France  Art     N/A 30.70625    Decrease by 15% from F16\n2 - France Art  2   France  Art     N/A 36.125  Decrease by 15% from F17\n3 - France Art  3   France  Art     N/A 42.5    Decrease by 15% from F18\n4 - France Art  4   France  Art     50  50  Does not change\n5 - France Art  5   France  Art     55  55  Does not change\n6 - France Art  6   France  Art     N/A 63.25   Increase 15% from  F19\n7 - France Art  7   France  Art     N/A 72.7375 Increase 15% from  F20\n8 - France Art  8   France  Art     N/A 83.648125   Increase 15% from  F21\n9 - France Art  9   France  Art     N/A 96.19534375 Increase 15% from  F22\n10 - France Art     10  France  Art     N/A 110.6246453 Increase 15% from  F23\n11 - France Art     11  France  Art     N/A 127.2183421 Increase 15% from  F24\n12 - France Art     12  France  Art     N/A 146.3010934 Increase 15% from  F25\n</code></pre>\n\n<p>Sorry for the formatting issue. Not sure how to fix this. It also won't let me post the picture so I included the link below.</p>\n\n<p>I tried a few nested if statements, but wasn't successful. </p>\n\n<p><a href=\"https://i.imgur.com/zNPNGcx.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/zNPNGcx.png</a></p>\n\n<p><a href=\"https://i.imgur.com/nPkpA0I.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/nPkpA0I.png</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1545250570, "creation_date": 1545250570, "answer_id": 53858564, "question_id": 53858018, "link": "https://stackoverflow.com/questions/53858018/vba-code-summing-values-in-a-single-cell-of-a-row-and-add-with-another-cell-w/53858564#53858564", "title": "VBA code, summing values in a single cell, of a row, and add with another cell with range of numbers in it", "body": "<p>Untested. If I have understood correctly, the cells are delimited by new line character.</p>\n\n<p>So maybe something like:</p>\n\n<pre><code>Option explicit\n\nPrivate Sub SplitAndTotal()\n\n' Change name of sheet as necessary\nWith thisworkbook.worksheets(\"Sheet1\")\n.range(\"V1\").value2 = SplitIntoNumbersAndSum(.range(\"S1\").value2) + _\nSplitIntoNumbersAndSum(.range(\"T1\").value2) + _\nSplitIntoNumbersAndSum(.range(\"U1\").value2)\nEnd with\n\nEnd sub\n\nPrivate Function SplitIntoNumbersAndSum(byval valueToSplit as variant, optional byval delimiter as string = vbnewline) as double\n\nDim Total as double\n\nDim arrayOfValues as variant\narrayOfValues = split(valueToSplit, delimiter, -1, vbbinarycompare)\n\nDim index as long\nFor index = lbound(arrayOfValues) to ubound (arrayOfValues)\nIf isnumeric(arrayOfValues(index)) then\nTotal = total + cdbl(arrayOfValues(index))\nEnd if\n\nNext index\n\nSplitIntoNumbersAndSum = Total\n\nEnd function\n</code></pre>\n\n<p>Sorry for bad formatting and indentation, not on a desktop.</p>\n\n<p>If the function constantly returns a zero, try checking/changing the <code>delimiter</code>.</p>\n\n<p>You might also want to try calling the function as a UDF directly from the worksheet itself (though you may need to put the function's code in a separate module), as opposed to calling it through a dedicated macro/procedure.</p>\n"}, {"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1545259528, "creation_date": 1545259528, "answer_id": 53860214, "question_id": 53858018, "link": "https://stackoverflow.com/questions/53858018/vba-code-summing-values-in-a-single-cell-of-a-row-and-add-with-another-cell-w/53860214#53860214", "title": "VBA code, summing values in a single cell, of a row, and add with another cell with range of numbers in it", "body": "<p>Consider using non-VBA solution by using <a href=\"https://www.myonlinetraininghub.com/excel-factor-12-secret-evaluate-function\" rel=\"nofollow noreferrer\"><code>EVALUATE</code></a>\n function:</p>\n\n<p><a href=\"https://i.stack.imgur.com/u9QXO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u9QXO.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/UrNUp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UrNUp.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1545264083, "creation_date": 1545264083, "answer_id": 53860786, "question_id": 53858018, "link": "https://stackoverflow.com/questions/53858018/vba-code-summing-values-in-a-single-cell-of-a-row-and-add-with-another-cell-w/53860786#53860786", "title": "VBA code, summing values in a single cell, of a row, and add with another cell with range of numbers in it", "body": "<p>No need for vba, this formula will do it:</p>\n\n<pre><code>=SUMPRODUCT(--TRIM(MID(SUBSTITUTE(A1,CHAR(10),REPT(\" \",99)),(ROW($A$1:INDEX($A:$A,LEN(A1)-LEN(SUBSTITUTE(A1,CHAR(10),\"\"))+1))-1)*99+1,99)))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/VLjqz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VLjqz.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10812838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRkVGjpgNIs/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jEGtkUJ_t6jrD9T3BWS6LuZGik0g/mo/photo.jpg?sz=128", "display_name": "DanielTee1", "link": "https://stackoverflow.com/users/10812838/danieltee1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1579131328, "creation_date": 1545247859, "last_edit_date": 1579131328, "question_id": 53858018, "link": "https://stackoverflow.com/questions/53858018/vba-code-summing-values-in-a-single-cell-of-a-row-and-add-with-another-cell-w", "title": "VBA code, summing values in a single cell, of a row, and add with another cell with range of numbers in it", "body": "<pre><code>Cell: S1 = 0.50   Cell T1 = 1.00   Cell U1 = 0.02\n           0.50             0.05             0.63\n           0.50             0.25             0.89\n</code></pre>\n\n<p>Ran a formula out to the right to find the \".\" symbol and the extract the data using the Mid Formula. But some cells can have 12 vaules in them, and some with only 1. I would like the formula to find the total number of Values in the cell, and total the amount.</p>\n\n<p>I have no code</p>\n\n<p>Results should sum the total amount in the cell, and sum together the amounts with the other column and create a 4th column with the total.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1545248687, "post_id": 53858007, "comment_id": 94564094, "body": "&#39;Application.Calculation = xlAutomatic&#39; at the end?"}, {"owner": {"reputation": 1, "user_id": 10812835, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XvuneIQ7q70/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goYo34DTDUJf-EnPemoetZCEiSrw/mo/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10812835/james"}, "edited": false, "score": 0, "creation_date": 1545252133, "post_id": 53858007, "comment_id": 94565496, "body": "That works! Thanks. If the number of iterations is big (say over 5,000), this takes a while to run.  Is there a way using arrays which will speed it up?"}, {"owner": {"reputation": 1, "user_id": 10812835, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XvuneIQ7q70/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goYo34DTDUJf-EnPemoetZCEiSrw/mo/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10812835/james"}, "edited": false, "score": 0, "creation_date": 1545253782, "post_id": 53858007, "comment_id": 94566194, "body": "It&#39;s just RAND(). In reality it will pull from a formula on another page which uses a random number generator. But this will do as a test."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545258403, "post_id": 53858007, "comment_id": 94567989, "body": "See the edit. It&#39;s a lot faster, because it only reads from the sheet once and writes to the sheet once."}, {"owner": {"reputation": 1, "user_id": 10812835, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XvuneIQ7q70/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goYo34DTDUJf-EnPemoetZCEiSrw/mo/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10812835/james"}, "edited": false, "score": 0, "creation_date": 1545264408, "post_id": 53858007, "comment_id": 94569671, "body": "That&#39;s the ticket. Just what I was looking for. Thanks!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 2, "last_activity_date": 1545258341, "last_edit_date": 1545258341, "creation_date": 1545247829, "answer_id": 53858007, "question_id": 53857960, "link": "https://stackoverflow.com/questions/53857960/excel-vba-copy-paste-rows/53858007#53858007", "title": "Excel VBA - copy/paste rows", "body": "<p><code>DataInput</code> never changes because <code>DataInput = Range(\"DataInput\").Value</code> is <em>outside</em> the loop, so the same values will get pasted over and over.</p>\n\n<p>Move it inside and it will update with each iteration.</p>\n\n<pre><code>Sub MyRange()\n    Dim DataInput As Variant\n    Dim NumberOfSims As Long, i As Long\n\n    Application.Calculation = xlManual\n    NumberOfSims = 10\n\n    For i = 1 To NumberOfSims\n        DataInput = Range(\"DataInput\").Value\n        Range(Cells(1 + i, \"A\"), Cells(1 + i, \"G\")).Value = DataInput\n        Application.Calculate\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>You can avoid using an array altogether and just transfer the value:</p>\n\n<pre><code>For i = 1 To NumberOfSims\n    Range(Cells(1 + i, \"A\"), Cells(1 + i, \"G\")).Value = Range(\"DataInput\").Value\n    Application.Calculate\nNext i\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Instead of continually re-calcing and rereading from the sheet, you could read the formulas into an array, <code>Evaluate</code> them and then write back to the the sheet all at once.</p>\n\n<p>Perhaps something like this:</p>\n\n<pre><code>Sub MyRange()\n    Dim NumberOfSims As Long, NumberOfCols As Long\n\n    NumberOfSims = 5000\n    NumberOfCols = Range(\"DataInput\").Columns.Count\n\n    Dim InputFormulas() As Variant\n    InputFormulas = Range(\"DataInput\").Formula\n\n    Dim OutputValues() As Variant\n    ReDim OutputValues(1 To NumberOfSims, 1 To NumberOfCols)\n\n    Dim R As Long, C As Long\n\n    For R = 1 To UBound(OutputValues, 1)\n        For C = 1 To UBound(OutputValues, 2)\n            OutputValues(R, C) = Application.Evaluate(InputFormulas(1, C))\n        Next C\n    Next R\n\n    Range(\"A2\").Resize(UBound(OutputValues, 1), UBound(OutputValues, 2)).Value = OutputValues\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10812835, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XvuneIQ7q70/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goYo34DTDUJf-EnPemoetZCEiSrw/mo/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10812835/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579168841, "creation_date": 1545247578, "last_edit_date": 1579168841, "question_id": 53857960, "link": "https://stackoverflow.com/questions/53857960/excel-vba-copy-paste-rows", "title": "Excel VBA - copy/paste rows", "body": "<p>I am looking to read in a range consisting of a single row on cells <code>A1:G1</code> into an array with 10 rows and then output the results on the same sheet in cells <code>A2:G11</code>. The data in the input row changes as it is based on formulas containing random numbers.  I'm told that the fastest way to do this is with an array. Not sure how to do that. So far I have the code shown below. This doesn't work because it won't recalculate the input data before it pastes it into the output cells so it keeps pasting the same values over and over. What is the best way to tackle this? </p>\n\n<pre><code>Sub MyRange()\nDim DataInput As Variant\nDim NumberOfSims As Long, i As Long\n\nApplication.Calculation = xlManual\nNumberOfSims = 10\n\nDataInput = Range(\"DataInput\").Value\n\nFor i = 1 To NumberOfSims\n    Range(Cells(1 + i, \"A\"), Cells(1 + i, \"g\")).Value = DataInput\n    Application.Calculate\nNext i\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba", "powerbi"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1545248818, "post_id": 53857478, "comment_id": 94564166, "body": "Why do you need to open the Power BI file in the first place? Power BI can refresh the queries when the PBIX file is opened by the owner. That&#39;s what it does. Refresh data from different sources. What&#39;s the point of opening the file with code?"}, {"owner": {"reputation": 1, "user_id": 10773230, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156890148199176/picture?type=large", "display_name": "Rafael Venturini", "link": "https://stackoverflow.com/users/10773230/rafael-venturini"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1545249031, "post_id": 53857478, "comment_id": 94564259, "body": "My Idea was to run this part of the code in order to open the pbix file so that I can hit the refresh button in power BI. Without this I would have to find the pbix file, open it manually and then perform the refresh. I just want to save time."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1545249229, "post_id": 53857478, "comment_id": 94564344, "body": "Surely, if you can find the file with code, you can find it in Explorer? How about a shortcut on your desktop or in the Quick access panel?"}, {"owner": {"reputation": 1, "user_id": 10773230, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156890148199176/picture?type=large", "display_name": "Rafael Venturini", "link": "https://stackoverflow.com/users/10773230/rafael-venturini"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1545354903, "post_id": 53857478, "comment_id": 94603377, "body": "As I said, I want to save time. The complete code is running SAP transactions to extract information and make it available to my power BI dashboards in this pbix file. I takes time to do that, and I wanted the code already to open the pbix file when it&#39;s done extracting the info, because I don&#39;t intend to watch the whole extraction process to know that I can start power BI (it takes a considerable time to open power BI)."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10773230, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156890148199176/picture?type=large", "display_name": "Rafael Venturini", "link": "https://stackoverflow.com/users/10773230/rafael-venturini"}, "is_accepted": true, "score": 0, "last_activity_date": 1545407706, "creation_date": 1545407706, "answer_id": 53887604, "question_id": 53857478, "link": "https://stackoverflow.com/questions/53857478/error-opening-a-power-bi-desktop-file-using-vba/53887604#53887604", "title": "Error opening a power bi desktop file using VBA", "body": "<p>I found another way to open files in VBA that worked. I found it in: <a href=\"https://stackoverflow.com/questions/18921168/how-can-excel-vba-open-file-using-default-application\">How can Excel VBA open file using default application</a></p>\n\n<p>See below the solution:</p>\n\n<pre><code>Dim Shex As Object\nSet Shex = CreateObject(\"Shell.Application\")\ntgtfile = \"filepath\"\nShex.Open (tgtfile)\n</code></pre>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 1, "user_id": 10773230, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156890148199176/picture?type=large", "display_name": "Rafael Venturini", "link": "https://stackoverflow.com/users/10773230/rafael-venturini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "accepted_answer_id": 53887604, "answer_count": 1, "score": -1, "last_activity_date": 1545407706, "creation_date": 1545245344, "question_id": 53857478, "link": "https://stackoverflow.com/questions/53857478/error-opening-a-power-bi-desktop-file-using-vba", "title": "Error opening a power bi desktop file using VBA", "body": "<p>I'm trying to open a pbix file through a VBA code after updating an excel database. I used the following commands in VBA:</p>\n\n<pre><code>MyFile = \"filepath\"\nCmd = \"RunDLL32.EXE shell32.dll,ShellExec_RunDLL \"\nShell (Cmd &amp; MyFile)\n</code></pre>\n\n<p>When I execute the code and Power BI initiates, an error message saying \"Ribbon view has not been initialized\" appears, and the software doesn't work properly. In order to have it working I need to close it and then open it manually.</p>\n\n<p>Do you have any idea why I'm having this error? Is it the method I'm using to open the file? Do you know another way to do it?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 10811597, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DNmmDBroo0Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iGKKEU3AHku1p__dAut7mh3RFDxA/mo/photo.jpg?sz=128", "display_name": "Kevin Swartz", "link": "https://stackoverflow.com/users/10811597/kevin-swartz"}, "edited": false, "score": 0, "creation_date": 1545318961, "post_id": 53861832, "comment_id": 94589881, "body": "Thank you Alina. My issue is not with the release or the lack of updating when I don&#39;t release. The issue is regarding overwriting the Exceptions because the Parent has been modified. For example, if I modify the StartTime of the AppointmentItem.Parent of an appointment with 20 recurrences and 2 exceptions, the modified appointment ends up with 20 recurrences at the new time and the exceptions no longer exist.  Can I prevent them from being overwritten or capture their info to recreate the exceptions after modifying the Parent?"}], "tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1545274535, "creation_date": 1545274535, "answer_id": 53861832, "question_id": 53856306, "link": "https://stackoverflow.com/questions/53856306/how-do-i-keep-recurring-appointmentitem-exceptions-when-modifying-the-parent/53861832#53861832", "title": "How do I &quot;keep&quot; recurring AppointmentItem exceptions when modifying the .Parent?", "body": "<p>When you work with recurring appointment items, you should release any prior references, obtain new references to the recurring appointment item before you access or modify the item, and release these references as soon as you are finished and have saved the changes. </p>\n\n<p>This practice applies to the recurring AppointmentItem object, and any Exception or RecurrencePattern object. To release a reference in Visual Basic for Applications (VBA) or Visual Basic, set that existing object to Nothing. In C#, explicitly release the memory for that object.</p>\n\n<p>For more information, please refer to this link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/31298414/outlook-recurrencepattern-exceptions-count-not-updated-after-occurrence-modified\">Outlook RecurrencePattern.Exceptions.Count NOT updated after occurrence modified or deleted</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/36524084/outlook-vsto-save-appointmentitem-parent?rq=1\">Outlook VSTO - Save AppointmentItem Parent</a></p>\n"}], "owner": {"reputation": 99, "user_id": 10811597, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DNmmDBroo0Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iGKKEU3AHku1p__dAut7mh3RFDxA/mo/photo.jpg?sz=128", "display_name": "Kevin Swartz", "link": "https://stackoverflow.com/users/10811597/kevin-swartz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567670590, "creation_date": 1545240081, "question_id": 53856306, "link": "https://stackoverflow.com/questions/53856306/how-do-i-keep-recurring-appointmentitem-exceptions-when-modifying-the-parent", "title": "How do I &quot;keep&quot; recurring AppointmentItem exceptions when modifying the .Parent?", "body": "<p>This is my first post!</p>\n\n<p>I regularly receive appointments that are just for reference (not something I'm going to). They clutter my calendar hiding the actual appointments I need to participate in. </p>\n\n<p>I wrote some code to change a recurring appointment to all day. It appends the start and end times to the subject so I can still reference it.  </p>\n\n<pre><code>Public Sub MakeSeriesAllDay()\n\nDim oAppt As AppointmentItem\nDim oApptParent As AppointmentItem\n\n'Get the selected appointment\nSet oAppt = Outlook.Application.ActiveExplorer.Selection.Item(1)\n\n'Get the selected appointment's parent (series)\nSet oApptParent = oAppt.Parent\n\n'Append the appointment time into the parent subject (series)\noApptParent.Subject = oApptParent.Subject &amp; \", \" &amp; Format(oApptParent.Start, \"h:mm AM/PM\") &amp; \"-\" &amp; Format(oApptParent.End, \"h:mm AM/PM\")\noApptParent.Save\n\n'Change the appointment to start at midnight and be all day\noApptParent.GetRecurrencePattern.StartTime = #12:00:00 AM#\noApptParent.GetRecurrencePattern.Duration = 1440\noApptParent.Save\n\nSet oAppt = Nothing\nSet oApptParent = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>It works great! The issue is, any exceptions are overwritten when modifying the AppointmentItem.Parent. How do I keep the exceptions? Or better yet, after changing the parent, how do I create new exceptions to reflect the old exceptions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1545244058, "post_id": 53856276, "comment_id": 94562106, "body": "<code>Selection.EntireRow.Cut</code> will copy whatever is selected - you aren&#39;t changing that within the loop...   Your best approach would be to stop using select/activate and work directly with the ranges - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>  Also remove that <code>On Error Resume Next</code> as it will just hide any problems and you wouldn&#39;t know there was an issue"}, {"owner": {"reputation": 57, "user_id": 9128715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b719a266033b0f351e464e905f7d9c58?s=128&d=identicon&r=PG&f=1", "display_name": "FloridaRick", "link": "https://stackoverflow.com/users/9128715/floridarick"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1545246782, "post_id": 53856276, "comment_id": 94563323, "body": "I removed the word Selection and got rid of the On Error statement.  Now, I get a Run Time Error 424-Object required message and it highlights the line that now says EntireRow.Cut.  I am at a loss."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 9128715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b719a266033b0f351e464e905f7d9c58?s=128&d=identicon&r=PG&f=1", "display_name": "FloridaRick", "link": "https://stackoverflow.com/users/9128715/floridarick"}, "edited": false, "score": 0, "creation_date": 1545335341, "post_id": 53858605, "comment_id": 94597541, "body": "Tim, first allow me to say that I love all of the changes you have made!  Unfortunately, it still doesn&#39;t work.  It seems to ignore the command:"}, {"owner": {"reputation": 57, "user_id": 9128715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b719a266033b0f351e464e905f7d9c58?s=128&d=identicon&r=PG&f=1", "display_name": "FloridaRick", "link": "https://stackoverflow.com/users/9128715/floridarick"}, "edited": false, "score": 0, "creation_date": 1545336018, "post_id": 53858605, "comment_id": 94597773, "body": "The command: If wsOM.Cells(i, 10) = wsCD.Cells(j, 1) Then seems to be ignores.  The macro moves the first 8 lines and leaves the last 2 lines in the sample workbook.  It should be moving the last 3 lines.  Is there any way I can send a sample workbook to you?  If not, do you have any other suggestions?  I am by no means a programmer, but everything you wrote seems logical and I would think it would work.  Thank you so much for reviewing and helping me with this!"}, {"owner": {"reputation": 57, "user_id": 9128715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b719a266033b0f351e464e905f7d9c58?s=128&d=identicon&r=PG&f=1", "display_name": "FloridaRick", "link": "https://stackoverflow.com/users/9128715/floridarick"}, "edited": false, "score": 0, "creation_date": 1545399371, "post_id": 53858605, "comment_id": 94617838, "body": "Thank you!  You may remove it now."}, {"owner": {"reputation": 57, "user_id": 9128715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b719a266033b0f351e464e905f7d9c58?s=128&d=identicon&r=PG&f=1", "display_name": "FloridaRick", "link": "https://stackoverflow.com/users/9128715/floridarick"}, "edited": false, "score": 0, "creation_date": 1545420341, "post_id": 53858605, "comment_id": 94626613, "body": "Thank you!  I tried it on a year&#39;s worth of data (over 12,000 lines) and it took less than 2 seconds to pull out everything perfectly!  I can&#39;t thank you enough!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1545415922, "last_edit_date": 1545415922, "creation_date": 1545250835, "answer_id": 53858605, "question_id": 53856276, "link": "https://stackoverflow.com/questions/53856276/how-to-match-information-in-two-dynamic-tables/53858605#53858605", "title": "How to match information in two dynamic tables", "body": "<p><strong>EDIT -</strong> updated and tested on your sample workbook.</p>\n\n<p>It's easier to batch up moving any rows until you're done comparing and filtering.</p>\n\n<pre><code>Sub Candace()\n\n    Dim i As Long\n    Dim r As Long\n    Dim UsdRws As Long\n\n    Dim sourceCol As Integer, rowCount As Integer, currentRow As Integer\n    Dim currentRowValue As String, lastrowCD As Long, lastrowOM As Long\n    Dim lastrow As Long, wsCD As Worksheet, wsOM As Worksheet, j As Long\n    Dim rngOp As Range, n As Long, rngOp2 As Range, rw As Range\n\n    Set wsCD = ActiveWorkbook.Worksheets(\"Capital-Data\")\n    Set wsOM = ActiveWorkbook.Worksheets(\"O&amp;M-Data\")\n\n    lastrowCD = wsCD.Cells(Rows.Count, 1).End(xlUp).Row\n    lastrowOM = wsOM.Cells(Rows.Count, 1).End(xlUp).Row\n\n    With wsCD.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=wsCD.Range(\"E:E\"), SortOn:=xlSortOnValues, _\n                        Order:=xlAscending, DataOption:=xlSortNormal\n        .SetRange wsCD.Range(\"A1\").CurrentRegion\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    UsdRws = wsCD.Range(\"A1\").CurrentRegion.Rows.Count\n    For i = UsdRws To 2 Step -1\n        If wsCD.Range(\"E\" &amp; i).Value Like \"ITS####\" Then\n            Build rngOp, wsCD.Rows(i) 'collecting a range to move....\n\n            'find and collect matches on O&amp;M sheet\n            For j = 2 To (lastrowOM - 1)\n               If wsOM.Cells(j, 10) = wsCD.Range(\"A\" &amp; i) Then\n                   Build rngOp2, wsOM.Rows(j)\n               End If\n            Next\n        End If\n    Next i\n\n    If Not rngOp Is Nothing Then\n        rngOp.Copy wsCD.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(2)\n        rngOp.Delete\n    End If\n\n    'move matched rows on OM sheet\n    If Not rngOp2 Is Nothing Then\n        rngOp2.Copy wsOM.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(2)\n        rngOp2.Delete\n    End If\n\nEnd Sub\n\n'utility Sub for building a range\nSub Build(ByRef rngTot As Range, ByRef rngAdd As Range)\n    If rngTot Is Nothing Then\n        Set rngTot = rngAdd\n    Else\n        Set rngTot = Application.Union(rngTot, rngAdd)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9128715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b719a266033b0f351e464e905f7d9c58?s=128&d=identicon&r=PG&f=1", "display_name": "FloridaRick", "link": "https://stackoverflow.com/users/9128715/floridarick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53858605, "answer_count": 1, "score": 1, "last_activity_date": 1579130354, "creation_date": 1545239981, "last_edit_date": 1579130354, "question_id": 53856276, "link": "https://stackoverflow.com/questions/53856276/how-to-match-information-in-two-dynamic-tables", "title": "How to match information in two dynamic tables", "body": "<p>I have two reports.  One is Item Numbers which have been removed from Inventory.  The other is Projects that have received items from Inventory.  These two reports always have the same total dollar amount.  The only columns with matching information is column A in the sheet entitled \"Capital-Data\" and column J in the sheet entitled \"O&amp;M-Data\".  Please note that the actual worksheets contain thousands of lines and are dynamic.  Also, the worksheets do NOT have the same number of lines.</p>\n\n<p>On the \"Capital-Data\" worksheet, any Item Numbers that begin with \"ITS\" must be removed from the table and listed BELOW the table.</p>\n\n<p>On the \"O&amp;M-Data\" table, any item in column J that matches column A of the items listed BELOW the table in the first worksheet must also be removed from the \"O&amp;M-Data\" table and pasted below that table.</p>\n\n<p>Here is the code I have copied/written:</p>\n\n<pre><code>Sub Candace()\n'\n' Candace Macro\n\nDim i As Long\nDim r As Long\nDim UsdRws As Long\nDim UsdRws2 As Long\nDim sourceCol As Integer, rowCount As Integer, currentRow As Integer\nDim currentRowValue As String\nSheets(\"Capital-Data\").Select\nDim lastrow As Long\nlastrowsheet1 = Worksheets(\"Capital-Data\").Cells(Rows.Count, 1).End(xlUp).Row\nlastrowsheet2 = Worksheets(\"O&amp;M-Data\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    Selection.CurrentRegion.Select\n    ActiveWorkbook.Worksheets(\"Capital-Data\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Capital-Data\").Sort.SortFields.Add Key:=Range(\"E:E\") _\n        , sorton:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Capital-Data\").Sort\n        .SetRange Range(\"a1\").CurrentRegion\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Application.ScreenUpdating = False\n\n    UsdRws = Range(\"A1\").CurrentRegion.Rows.Count\n\n    For i = UsdRws To 2 Step -1\n        If Range(\"E\" &amp; i).Value Like \"ITS####\" Then\n        Rows(i).EntireRow.Cut\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n        ActiveSheet.Paste\n        End If\n        Next i\n        On Error Resume Next\n\n\n\n    sourceCol = 1\n    rowCount = Cells(Rows.Count, sourceCol).End(xlUp).Row\n\n    'for every row, find the first blank cell and select it\n    For currentRow = rowCount To 2 Step -1\n        currentRowValue = Cells(currentRow, sourceCol).Value\n        If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\n            Rows(currentRow).EntireRow.Delete\n        End If\n    Next\n\n\n        Range(\"a1\").End(xlDown).Offset(1).EntireRow.Insert\n        Range(\"a1\").Select\n        Selection.End(xlDown).Select\n        Selection.End(xlDown).Select\n        Selection.CurrentRegion.Select\n\n\n        Sheets(\"O&amp;M-Data\").Select\n        Range(\"J2\").Select\n\n'Works great to this point\n\n    For i = 2 To (lastrowsheet1 - 1)\n     For j = 2 To (lastrowsheet2 - 1)\n        If Worksheets(\"O&amp;M-Data\").Cells(i, 10) = Worksheets(\"Capital-Data\").Cells(j, 1) Then\n        Selection.EntireRow.Cut\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n        ActiveSheet.Paste\n        End If\n     Next\n    Next\n    For currentRow = rowCount To 2 Step -1\n        currentRowValue = Cells(currentRow, sourceCol).Value\n        If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\n            Rows(currentRow).EntireRow.Delete\n        End If\n    Next\n      Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>It all works except for the last section.  When it gets to that, it simply copies the first row of the \"O&amp;M-Data\" worksheet below the table, deletes the blank rows, and then inserts a blank row below the total.  It seems to be completely ignoring the command to match it to the \"Capital-Data\" table.</p>\n\n<p>I have two small sample tables that I can provide if someone can tell me how to attach them to this post.  I think it would be much easier if you could see the data.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1545245641, "creation_date": 1545245641, "answer_id": 53857547, "question_id": 53856262, "link": "https://stackoverflow.com/questions/53856262/save-a-copy-of-database-then-email-it-to-a-shared-email-box/53857547#53857547", "title": "Save a copy of Database then email it to a shared email box", "body": "<p>It's just the filename, so it could be just passing the value from your script:</p>\n\n<pre><code>oEmail.Attachments.Add newPath &amp; \"\\xxx Database Update v.1.6_be_\" &amp; CurrentDate &amp; \".accdb\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1545250012, "last_edit_date": 1545250012, "creation_date": 1545249260, "answer_id": 53858313, "question_id": 53856262, "link": "https://stackoverflow.com/questions/53856262/save-a-copy-of-database-then-email-it-to-a-shared-email-box/53858313#53858313", "title": "Save a copy of Database then email it to a shared email box", "body": "<p>If you want to just automatically send after the backup, make the email code a Sub that can be called in Backup button click procedure. </p>\n\n<pre><code>Sub SendEmail(strFile As String)\n...\noEmail.Attachments.Add strFile\n...\nEnd Sub\n</code></pre>\n\n<p>Then calling the sub at end of the Backup button click:</p>\n\n<p><code>SendEmail(newPath &amp; \"\\xxx Database Update v.1.6_be_\" &amp; CurrentDate &amp; \".accdb\")</code></p>\n\n<p>Many email systems reject emails with Access file as an attachment because of malicious code risk. However, a zipped Access file should pass security. Example code:</p>\n\n<pre><code>Dim strZip As String\nstrZip = CurrentProject.Path &amp; \"\\Construction.zip\"\n'create empty zip folder\n'found this on web, no idea what the Print line does but if it isn't there, this won't work\nOpen strZip For Output As #1\nPrint #1, \"PK\" &amp; Chr$(5) &amp; Chr$(6) &amp; String(18, 0)\nClose #1\n'copy file into zip folder\nDim objApp As Object\nSet objApp = CreateObject(\"Shell.Application\")\n'variable for source file doesn't seem to work in this line\n'also double parens not in original example code but won't work without\nobjApp.NameSpace((strZip)).CopyHere CurrentProject.Path &amp; \"\\Construction.accdb\"\n</code></pre>\n\n<p>As noted in code comment, issue is passing source file via variable. Sorry, I never needed to solve. </p>\n\n<p>Creating zip file code could be in the email procedure and then attach the zip file:</p>\n\n<p><code>oEmail.Attachments.Add strZip</code></p>\n\n<p>Then at the end of email procedure, can delete the zip file:<br>\n<code>Kill strZip</code></p>\n"}], "owner": {"reputation": 1, "user_id": 10451927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b349c5f5f9ab4603ceccc9abbb42240a?s=128&d=identicon&r=PG&f=1", "display_name": "thekudos", "link": "https://stackoverflow.com/users/10451927/thekudos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545252139, "creation_date": 1545239926, "last_edit_date": 1545252139, "question_id": 53856262, "link": "https://stackoverflow.com/questions/53856262/save-a-copy-of-database-then-email-it-to-a-shared-email-box", "title": "Save a copy of Database then email it to a shared email box", "body": "<p>I have a script that saves a backup database (with a date stamp) to a shared drive.</p>\n\n<pre><code>Private Sub Command0_Click()\n\n    Dim fs As Object Dim oldPath As String, newPath As String \n    Dim CurrentDate As String\n\n    CurrentDate = Format(Now, \"MMDDYY\")\n    oldPath = \"\\\\xxx\\xxx Database\" 'Folder file is located in \n    'newPath = \"\\\\xxx\\xxx\\FINANCE\\USERS\\xxx\\xxx Operations\\xxx\\xxx\\\" 'Folder to copy file to \n    newPath = \"C:\\Users\\xxx\\Documents\\xxx\\xxx\" 'Folder to copy file to\n\n    Set fs = CreateObject(\"Scripting.FileSystemObject\") \n    fs.CopyFile oldPath &amp; \"\\\" &amp; \"xxx Database Update v.1.6_be.accdb\", newPath &amp; \"\\\" _\n    &amp; \"xxx Database Update v.1.6_be_\" &amp; CurrentDate &amp; \".accdb\"\n\n    Set fs = Nothing\n\n    MsgBox \"Database Backed up\", , \"Backup Complete\" \n\nEnd Sub\n</code></pre>\n\n<p>This worked fine. </p>\n\n<p>However I have now been asked to also send the database to a shared inbox email address. </p>\n\n<pre><code>Private Sub btnbrowse_click()\n\n    Dim filediag As FileDialog\n    Dim file As Variant\n\n    Set filediag = FileDialog(msofiledialogfilepicker)\n\n    filediag.allowmultiselect = False\n    If filediag.show Then\n        For Each file In filediag.selecteditems\n        Me.txtattachment = file\n        Next\n    End If\nEnd Sub\n\nPrivate Sub btnSend_Click()\n\n    Dim oApp As New Outlook.Application\n    Dim oEmail As Outlook.MailItem\n\n    Set oEmail = oApp.CreateItem(olMailItem)\n\n    oEmail.To = Me.txtto\n    oEmail.Subject = Me.txtsubject\n    oEmail.Body = Me.txtbody\n    If Len(Me.txtattachment) &gt; 0 Then\n        oEmail.Attachments.Add Me.txtattachment.Value\n    End If\n    With oEmail\n        If Not IsNull(.To) And Not IsNull(.Subject) And Not IsNull(.Body) Then\n            .Send\n            MsgBox \"Email Sent!\"\n        Else\n            MsgBox \"Please fill out the required fields.\"\n        End If\n    End With       \nEnd Sub\n</code></pre>\n\n<p>Please can somebody help me link the two scripts so that instead of using the FileDialog to choose the email attachment, I can use the path in the first query to select the attachment and the script will run both the save file and the email file commands at the same time.</p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1545240040, "post_id": 53856080, "comment_id": 94560328, "body": "<code>buttonControl.Opject</code> - Opject? That looks like a typo to me - but I don&#39;t think you even need <code>Object</code> in there either."}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545240168, "post_id": 53856080, "comment_id": 94560397, "body": "@dwirony I&#39;m at a loss. What are you recommending?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1545240217, "post_id": 53856080, "comment_id": 94560414, "body": "Is that not a typo of <code>Object</code>?"}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545240386, "post_id": 53856080, "comment_id": 94560496, "body": "Oh! You&#39;re correct but that doesn&#39;t seam to be the problem. the problem seams to be on or just after this line      Set buttonControl = _     ActiveSheet.OLEObjects.Add(ClassType:=&quot;Forms.CommandButton.1&zwnj;&#8203;&quot;, _         Link:=False, _         DisplayAsIcon:=False, _         Left:=1464, Top:=310, Width:=107.25, Height:=30)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545240466, "post_id": 53856080, "comment_id": 94560548, "body": "What line is highlighted when the error occurs? And like I said, my guess is that you don&#39;t need <code>.Object</code> in there - just <code>With buttonControl</code>. <code>.Caption</code> is a property of <code>CommandButton</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1545240713, "post_id": 53856442, "comment_id": 94560670, "body": "Ahh. So then would his next line still just be <code>With buttonControl</code>?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1545240786, "post_id": 53856442, "comment_id": 94560708, "body": "Ah I almost had it!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1545240846, "last_edit_date": 1545240846, "creation_date": 1545240601, "answer_id": 53856442, "question_id": 53856080, "link": "https://stackoverflow.com/questions/53856080/how-to-create-and-set-a-activex-control-commandbutton-as-a-variable-excel-vba/53856442#53856442", "title": "How to create and set a ActiveX Control CommandButton as a variable Excel VBA", "body": "<p><code>OLEObjects.Add</code> creates an <code>OLEObject</code> and adds it to the <code>OLEObjects</code> collection; the object returned by the <code>Add</code> function is <code>OLEObject</code>, not <code>MSForm.CommandButton</code>. That's the underlying type of <code>OLEObject.Object</code> - so, set your <code>buttonControl</code> to the <code>.Object</code> property of the returned object:</p>\n\n<pre><code>Set buttonControl = _\n    ActiveSheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", _\n    Link:=False, _\n    DisplayAsIcon:=False, _\n    Left:=1464, Top:=310, Width:=107.25, Height:=30).Object\n</code></pre>\n\n<p>The button is created in the correct place, because the <code>Add</code> function works and returns - what's failing with a type mismatch is the assignment of the returned <code>OLEObject</code> into a <code>CommandButton</code> variable, immediately after that operation.</p>\n\n<p>The subsequent <code>With</code> block can then be just <code>With buttonControl</code>.</p>\n"}], "owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 908, "favorite_count": 1, "accepted_answer_id": 53856442, "answer_count": 1, "score": 4, "last_activity_date": 1579253074, "creation_date": 1545239283, "last_edit_date": 1579253074, "question_id": 53856080, "link": "https://stackoverflow.com/questions/53856080/how-to-create-and-set-a-activex-control-commandbutton-as-a-variable-excel-vba", "title": "How to create and set a ActiveX Control CommandButton as a variable Excel VBA", "body": "<p>I am trying to Create a New ActiveX Control CommandButton with Excel VBA. I have a loop VBA which has worked in the past, theFile1.1.xlsm has the master list of the workbooks. I need to add a CommandButton to ~3200 workbooks, so I will be using the Do-Loop macro. Here is the Loop code for reference.</p>\n\n<pre><code>Sub Macro2() \n\nApplication.ScreenUpdating = False\n\nDim sFile As String\nDim wb As Workbook\nDim FileName1 As String\nDim FileName2 As String\nDim wksSource As Worksheet\nConst scWkbSourceName As String = \"theFILE 1.1.xlsm\"\n\nSet wkbSource = Workbooks(scWkbSourceName)\nSet wksSource = wkbSource.Sheets(\"Sheet1\") ' Replace 'Sheet1' w/ sheet name of SourceSheet\n\nConst wsOriginalBook As String = \"theFILE 1.1.xlsm\"\nConst sPath As String = \"E:\\ExampleFolder\\\"\n\nSourceRow = 5\n\nDo While Cells(SourceRow, \"D\").Value &lt;&gt; \"\"\n\n    Sheets(\"Sheet1\").Select\n\n    FileName1 = wksSource.Range(\"A\" &amp; SourceRow).Value\n    FileName2 = wksSource.Range(\"K\" &amp; SourceRow).Value\n\n    sFile = sPath &amp; FileName1 &amp; \"\\\" &amp; FileName2 &amp; \".xlsm\"\n\n    Set wb = Workbooks.Open(sFile)\n\n        ''insert code for loop operation\n\n    '''CLOSE WORKBOOK W/O BEFORE SAVE\n    Application.EnableEvents = False\n    ActiveWorkbook.Save\n    ActiveWorkbook.Close\n    Application.EnableEvents = True\n\nSourceRow = SourceRow + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I would like to have the button set as a Variable (i think), so I can edit the formatting/properties and hopefully add a macro to the button later.</p>\n\n<pre><code>    Dim buttonControl As MSForms.CommandButton\n\n    Set buttonControl = _\n        ActiveSheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", _\n        Link:=False, _\n        DisplayAsIcon:=False, _\n        Left:=1464, Top:=310, Width:=107.25, Height:=30)\n\n    With buttonControl.Opject\n        .Caption = \"OPEN FOLDER\"\n        .Name = \"cmd_OPEN_FOLDER\"\n\n    End With\n</code></pre>\n\n<p>I have a 'Run-time error 13: Type Mismatch' error. I am unsure why, because a 'CommandButton1' is created in the correct place.</p>\n"}, {"tags": ["excel", "vba", "gps"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11323340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd4f9fe6060d0180e9074877e29b5175?s=128&d=identicon&r=PG", "display_name": "Zeb Pike", "link": "https://stackoverflow.com/users/11323340/zeb-pike"}, "is_accepted": false, "score": 1, "last_activity_date": 1554616475, "last_edit_date": 1554616475, "creation_date": 1554610898, "answer_id": 55555593, "question_id": 53856034, "link": "https://stackoverflow.com/questions/53856034/extracting-gps-info-from-exifcrashes-excel-when-retrieving-gpslongitudedecimal/55555593#55555593", "title": "Extracting GPS info from EXIFcrashes Excel when retrieving GPSLongitudeDecimal", "body": "<p>I had the exact same problem as yours:<br>\nOn 32bit versions of Office, the GPSExifReader worked fine. On 64bit versions, it froze when retrieving the <code>LongitudeDecimal</code> property (latitude and everything else worked fine).</p>\n\n<p>I solved my problem by using another of Wayne Phillips' <a href=\"https://www.everythingaccess.com/tutorials.asp?ID=Accessing-detailed-file-information-provided-by-the-Operating-System\" rel=\"nofollow noreferrer\">excellent tools &amp; tutorials</a>. The VBA modules downloadable from that link drag effortlessly into Excel and the tutorial makes it easy to write a macro that returns latitude <em>and</em> longitude.</p>\n"}], "owner": {"reputation": 13, "user_id": 10811469, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gFFEvKn3VnM/AAAAAAAAAAI/AAAAAAAAADo/HYQFQeV9zmI/photo.jpg?sz=128", "display_name": "Eduardo Ventura", "link": "https://stackoverflow.com/users/10811469/eduardo-ventura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1554688558, "creation_date": 1545239136, "last_edit_date": 1554688558, "question_id": 53856034, "link": "https://stackoverflow.com/questions/53856034/extracting-gps-info-from-exifcrashes-excel-when-retrieving-gpslongitudedecimal", "title": "Extracting GPS info from EXIFcrashes Excel when retrieving GPSLongitudeDecimal", "body": "<p>I found a way to retrieve GPS information from the EXIF at  <a href=\"https://www.everythingaccess.com/tutorials.asp?ID=Extracting-GPS-data-from-JPEG-files\" rel=\"nofollow noreferrer\">https://www.everythingaccess.com/tutorials.asp?ID=Extracting-GPS-data-from-JPEG-files</a>.</p>\n\n<p>You can download the original Access files from <a href=\"https://www.everythingaccess.com/downloads/GPSExifReader.zip\" rel=\"nofollow noreferrer\">https://www.everythingaccess.com/downloads/GPSExifReader.zip</a></p>\n\n<p>I imported these VBA for Access Class Modules into Excel. I can retrieve all the GPS information <strong>EXCEPT</strong> the Decimal GPS Longitude.</p>\n\n<p>As I understand this, the coder (Wayne Phillips) is executing code in the machine's memory to create a virtual COM object from the images, thus exposing the EXIF properties.</p>\n\n<p>Everything runs, except the <code>Call VCOMObject.AssignVar(GPSLongitudeDecimal, VCOMObject.GPSLongitudeDecimal)</code> which is in the <code>Property Get GPSLongitudeDecimal() As Variant</code> procedure.</p>\n\n<p>It crashes my Excel 2013 then restarts it. Tried commenting out the offending Call and works on every Property Get procedure. It's just the Longitude one that crashes without any apparent error being raised.</p>\n\n<p>Thought it might be something weird on that longitude exif parameter so I tried with different jpegs, and with different jpegs from different cameras and the same thing happens.</p>\n\n<p>Since this is an intricate piece of Class Modules voodoo, I'm providing a link to my Excel file (<a href=\"https://yiqyyh.s.cld.pt\" rel=\"nofollow noreferrer\">https://yiqyyh.s.cld.pt</a>) just click \"Download\" on the left hand side of the webpage. The Rar file also has three test images with GPS information on their EXIF.</p>\n\n<p>The easier way to test is by running the <code>UserForm1</code> UserForm and clicking <code>CommanButton1</code>. This will open a browse window to choose an image. If the textbox gets populated, then nothing bad happened, but if it crashes that's my problem.</p>\n\n<p><em>EDIT: I tried another machine and Excel 2013 crashed.</em></p>\n\n<p><em>EDIT2: The other machine is in my work network. I tried running this on my home PC, also running Excel 2013, and <strong>IT WORKED</strong>. I need to run this at work.</em></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1545238311, "post_id": 53855696, "comment_id": 94559406, "body": "First, add <code>Option Explicit</code> and declare all variables - you&#39;re missing <code>row_num</code>, <code>cell</code> and  <code>Col2Rng</code>."}, {"owner": {"reputation": 105, "user_id": 7525022, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cee7eb726b443a4c824ca3beb1a21885?s=128&d=identicon&r=PG&f=1", "display_name": "Pvelez_3", "link": "https://stackoverflow.com/users/7525022/pvelez-3"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545238769, "post_id": 53855696, "comment_id": 94559647, "body": "I did that and now I get error &quot; Object variable or With block variable not set&quot; on line &#39;cell = Sheets(&quot;Sheet1&quot;).Range(&quot;A&quot; &amp; row_num)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545238807, "post_id": 53855696, "comment_id": 94559668, "body": "Yes because you need the word <code>Set</code> before an object variable: <code>Set cell = ...</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545239610, "post_id": 53855696, "comment_id": 94560072, "body": "Also why not just filter?"}, {"owner": {"reputation": 105, "user_id": 7525022, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cee7eb726b443a4c824ca3beb1a21885?s=128&d=identicon&r=PG&f=1", "display_name": "Pvelez_3", "link": "https://stackoverflow.com/users/7525022/pvelez-3"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545239630, "post_id": 53855696, "comment_id": 94560088, "body": "Ok I understand that. I&#39;m now getting an error to the way I&#39;m attempting to set the range to Col2Rng stating that it is a Type mismatch. I&#39;m not sure how exactly I would go about assigning it correctly"}, {"owner": {"reputation": 105, "user_id": 7525022, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cee7eb726b443a4c824ca3beb1a21885?s=128&d=identicon&r=PG&f=1", "display_name": "Pvelez_3", "link": "https://stackoverflow.com/users/7525022/pvelez-3"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545239722, "post_id": 53855696, "comment_id": 94560150, "body": "The task as a whole eliminated the possibility of filtering the way excel does."}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1545248048, "post_id": 53855696, "comment_id": 94563837, "body": "@Pvelez_3 Col2Rng is a range but an address is a string"}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1545240146, "post_id": 53856251, "comment_id": 94560382, "body": "And instead of using Range(&quot;A:A&quot;), I would find the last cell with data in the column using whatever technique you prefer...so you don&#39;t put the entirety of column A in memory."}, {"owner": {"reputation": 105, "user_id": 7525022, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cee7eb726b443a4c824ca3beb1a21885?s=128&d=identicon&r=PG&f=1", "display_name": "Pvelez_3", "link": "https://stackoverflow.com/users/7525022/pvelez-3"}, "edited": false, "score": 0, "creation_date": 1545240351, "post_id": 53856251, "comment_id": 94560477, "body": "foundCellCol1.Select throws a &quot;Object variable or With block variable not set&quot; error"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 105, "user_id": 7525022, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cee7eb726b443a4c824ca3beb1a21885?s=128&d=identicon&r=PG&f=1", "display_name": "Pvelez_3", "link": "https://stackoverflow.com/users/7525022/pvelez-3"}, "edited": false, "score": 0, "creation_date": 1545240484, "post_id": 53856251, "comment_id": 94560553, "body": "I&#39;m not seeing that error. I have &quot;test1&quot; through &quot;test8&quot; in cells A1-A8. If I enter &quot;test4&quot; as the search term, cell A4 gets selected without an error."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 105, "user_id": 7525022, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cee7eb726b443a4c824ca3beb1a21885?s=128&d=identicon&r=PG&f=1", "display_name": "Pvelez_3", "link": "https://stackoverflow.com/users/7525022/pvelez-3"}, "edited": false, "score": 0, "creation_date": 1545240569, "post_id": 53856251, "comment_id": 94560597, "body": "You may have to wrap your code with an If statement for the case when the term you&#39;re searching for isn&#39;t present in the range."}, {"owner": {"reputation": 105, "user_id": 7525022, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cee7eb726b443a4c824ca3beb1a21885?s=128&d=identicon&r=PG&f=1", "display_name": "Pvelez_3", "link": "https://stackoverflow.com/users/7525022/pvelez-3"}, "edited": false, "score": 0, "creation_date": 1545240665, "post_id": 53856251, "comment_id": 94560648, "body": "Column A looks more like Xy_Db_001 with the &quot;Xy&quot; changing to different strings. I&#39;m looking to select all the rows in the column that contain &quot;Xy&quot; regardless of case sensitivity."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 105, "user_id": 7525022, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cee7eb726b443a4c824ca3beb1a21885?s=128&d=identicon&r=PG&f=1", "display_name": "Pvelez_3", "link": "https://stackoverflow.com/users/7525022/pvelez-3"}, "edited": false, "score": 0, "creation_date": 1545242837, "post_id": 53856251, "comment_id": 94561607, "body": "Again, you&#39;ll need to add a condition for when your string isn&#39;t found in the first run...that is if foundCellCol1 is Nothing on the first attempt then put a message saying so (or whatever you want to do...Exit Sub, End...whatever you want to do)"}], "tags": [], "owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "is_accepted": false, "score": 0, "last_activity_date": 1545242574, "last_edit_date": 1545242574, "creation_date": 1545239900, "answer_id": 53856251, "question_id": 53855696, "link": "https://stackoverflow.com/questions/53855696/how-to-select-the-cells-in-a-column-that-have-a-specific-text-in-their-value/53856251#53856251", "title": "How to select the cells in a column that have a specific text in their value", "body": "<p>This should serve as the basis for what you're trying to do</p>\n\n<pre><code>Sub FindingColumn()\n    Dim Col1Rng As Range, Column1Search As String, foundCellCol1 As Range\n    Set Col1Rng = ActiveSheet.Range(\"A:A\")\n    Column1Search = InputBox(\"Col 1 Criteria: \")\n    Set foundCellCol1 = Col1Rng.Find(What:=Column1Search)\n    If Not foundCellCol1 Is Nothing Then foundCellCol1.Select Else: MsgBox \"Search term not found!\"\nEnd Sub\n</code></pre>\n\n<p>Can you generate a list in another location of all of the items that match?</p>\n\n<pre><code>Option Explicit\nSub FindingColumn()\n    Dim Col1Rng As Range, Column1Search As String, foundCellCol1 As Range, lastRow As Long, lastFoundRow As Long\n    lastRow = Range(\"A100000\").End(xlUp).Row\n    Set Col1Rng = ActiveSheet.Range(\"A1:A\" &amp; lastRow)\n    Column1Search = InputBox(\"Col 1 Criteria: \")\n    Set foundCellCol1 = Col1Rng.Find(What:=\"*\" &amp; Column1Search &amp; \"*\")\n    While Not foundCellCol1 Is Nothing\n        If Not foundCellCol1 Is Nothing Then\n            Range(\"B\" &amp; Range(\"B100000\").End(xlUp).Row + 1) = foundCellCol1.Value\n            Set Col1Rng = ActiveSheet.Range(\"A\" &amp; foundCellCol1.Row &amp; \":A\" &amp; lastRow)\n            lastFoundRow = foundCellCol1.Row\n            Set foundCellCol1 = Col1Rng.Find(What:=\"*\" &amp; Column1Search &amp; \"*\")\n            If foundCellCol1.Row = lastFoundRow Then Set foundCellCol1 = Nothing\n        End If\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 7525022, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cee7eb726b443a4c824ca3beb1a21885?s=128&d=identicon&r=PG&f=1", "display_name": "Pvelez_3", "link": "https://stackoverflow.com/users/7525022/pvelez-3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579186001, "creation_date": 1545238017, "last_edit_date": 1579186001, "question_id": 53855696, "link": "https://stackoverflow.com/questions/53855696/how-to-select-the-cells-in-a-column-that-have-a-specific-text-in-their-value", "title": "How to select the cells in a column that have a specific text in their value", "body": "<p>I'm trying to get the cells that contain match the certain text criteria I search for.</p>\n\n<p>I keep getting the error</p>\n\n<blockquote>\n  <p>Run-Time error 424 Object required</p>\n</blockquote>\n\n<p>on line 12</p>\n\n<pre><code>cell = Sheets(\"Sheet1\").Range(\"A\" &amp; row_num)\n</code></pre>\n\n<p>and I'm not sure why?</p>\n\n<p>Any and all help with this would be greatly appreciated!</p>\n\n<pre><code>Option Compare Text\n\nSub FindingColumn()\nDim Col1Rng As Range, Col3Rng As Range\nDim Column1Search As String, Column2Search As String, Column3Search As \nString\nrow_num = 0\n\nColumn1Search = InputBox(\"Col 1 Criteria: \")\n\nDo\nDoEvents\nrow_num = row_num + 1\ncell = Sheets(\"Sheet1\").Range(\"A\" &amp; row_num)\n    If Col2Rng = Empty And InStr(cell, Column1Search) Then\n        Col2Rng = cell.Address(0, 0)\n    ElseIf InStr(cell, Column1Search) Then\n        Col2Rng = Col2Rng &amp; \",\" &amp; cell.Address(0, 0)\n\n    End If\nLoop Until cell = \"\"\n\nRange(Col2Rng).Select\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1545237706, "post_id": 53855554, "comment_id": 94559049, "body": "Have you tried benchmarking your code to find the hotspots?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1545238238, "post_id": 53855554, "comment_id": 94559361, "body": "I bet it&#39;s all the sheet calculations. Maybe if all the calculating was done by VBA instead of in the sheet, the code could run faster. There may also be a better way to find the optimum values you are looking for (impossible to say without knowing what your sheet is calculating) but that may be better asked at the <a href=\"https://math.stackexchange.com/\">Math Stack Exchange</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1545239831, "post_id": 53855554, "comment_id": 94560211, "body": "Moreover, you&#39;re recalculating <code>ActiveSheet</code>, but nothing says <code>x</code> and <code>y</code> are on <i>that</i> sheet - all these recalcs might actually have exactly zero effect. You don&#39;t <i>normally</i> need to recalculate an entire worksheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1545240769, "post_id": 53855554, "comment_id": 94560701, "body": "How many iterations are your loops typically performing?  You might try making your initial step larger, then decrease the step and revisit the tipping point."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1545244085, "post_id": 53855554, "comment_id": 94562119, "body": "Hijack the Calculation function for the Worksheet.  So you control what is happening / updating."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 10816095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f0948e68e7f310649c50b1d1280f609?s=128&d=identicon&r=PG&f=1", "display_name": "Nnn", "link": "https://stackoverflow.com/users/10816095/nnn"}, "is_accepted": false, "score": 0, "last_activity_date": 1545313980, "creation_date": 1545313980, "answer_id": 53870056, "question_id": 53855554, "link": "https://stackoverflow.com/questions/53855554/how-can-make-my-code-to-take-less-time-to-process/53870056#53870056", "title": "How can make my code to take less time to process?", "body": "<p>Without changing your code, you can try turning off screen updating</p>\n\n<pre><code>    Sub maximise(ByRef x As Range, ByRef y As Range)\n\nApplication.ScreenUpdating = False\n\nDim ypos1 As Double, ypos2 As Double, yneg1 As Double, yneg2 As Double\nDim xpos As Double, xneg As Double\n\nx = 0.01\nypos1 = y.Value2\nypos2 = ypos1\n\nActiveSheet.Calculate\n\nDo While ypos2 - ypos1 &gt;= 0\n   ypos1 = y.Value2\n   xpos = x.Value2\n   x.Value2 = x.Value2 + 0.01\n   ActiveSheet.Calculate\n   ypos2 = y.Value2\nLoop\n\nActiveSheet.Calculate\n\nx = -0.01\nyneg1 = y.Value2\nyneg2 = yneg1\n\nActiveSheet.Calculate\n\nDo While yneg2 - yneg1 &gt;= 0\n   yneg1 = y.Value2\n   xneg = x.Value2\n   x.Value2 = x.Value2 - 0.01\n   ActiveSheet.Calculate\n   yneg2 = y.Value2\nLoop\n\nActiveSheet.Calculate\n\nIf ypos1 &gt; yneg1 Then\n    x.Value2 = xpos\nElse\n    x.Value2 = xneg\nEnd If\n\nActiveSheet.Calculate\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10812151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba3a17ad765108296cc9e58659647cd?s=128&d=identicon&r=PG&f=1", "display_name": "Rsdl", "link": "https://stackoverflow.com/users/10812151/rsdl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545314260, "creation_date": 1545237495, "last_edit_date": 1545314260, "question_id": 53855554, "link": "https://stackoverflow.com/questions/53855554/how-can-make-my-code-to-take-less-time-to-process", "title": "How can make my code to take less time to process?", "body": "<p>Basically I have the following vba code that I apply on 5000+ rows and it takes quite a while and I wanted to know if there was any way to make it run a little bit faster.\nI'm basically trying to optimize the values for x and y and running them on every single rows.</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>Sub maximise(ByRef x As Range, ByRef y As Range)\n\n    Dim ypos1 As Double, ypos2 As Double, yneg1 As Double, yneg2 As Double\n    Dim xpos As Double, xneg As Double\n\n    x = 0.01\n    ypos1 = y.Value2\n    ypos2 = ypos1\n\n    ActiveSheet.Calculate\n\n    Do While ypos2 - ypos1 &gt;= 0\n        ypos1 = y.Value2\n        xpos = x.Value2\n        x.Value2 = x.Value2 + 0.01\n        ActiveSheet.Calculate\n        ypos2 = y.Value2\n    Loop\n\n    ActiveSheet.Calculate\n\n    x = -0.01\n    yneg1 = y.Value2\n    yneg2 = yneg1\n\n    ActiveSheet.Calculate\n\n    Do While yneg2 - yneg1 &gt;= 0\n        yneg1 = y.Value2\n        xneg = x.Value2\n        x.Value2 = x.Value2 - 0.01\n        ActiveSheet.Calculate\n        yneg2 = y.Value2\n    Loop\n\n    ActiveSheet.Calculate\n\n    If ypos1 &gt; yneg1 Then\n        x.Value2 = xpos\n    Else\n        x.Value2 = xneg\n    End If\n\n    ActiveSheet.Calculate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "where-clause", "listobject"], "comments": [{"owner": {"reputation": 5572, "user_id": 3375670, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dftd9.jpg?s=128&g=1", "display_name": "Robert Kock", "link": "https://stackoverflow.com/users/3375670/robert-kock"}, "edited": false, "score": 0, "creation_date": 1545237389, "post_id": 53855368, "comment_id": 94558868, "body": "Are you sure about the <code>*</code> in the like-clause? Maybe you meant <code>%</code>"}, {"owner": {"reputation": 5572, "user_id": 3375670, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dftd9.jpg?s=128&g=1", "display_name": "Robert Kock", "link": "https://stackoverflow.com/users/3375670/robert-kock"}, "edited": false, "score": 0, "creation_date": 1545237545, "post_id": 53855368, "comment_id": 94558956, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5166907/why-does-a-like-query-in-access-not-return-any-records\">Why does a LIKE query in Access not return any records?</a>"}, {"owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "reply_to_user": {"reputation": 5572, "user_id": 3375670, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dftd9.jpg?s=128&g=1", "display_name": "Robert Kock", "link": "https://stackoverflow.com/users/3375670/robert-kock"}, "edited": false, "score": 0, "creation_date": 1545237642, "post_id": 53855368, "comment_id": 94559016, "body": "Yes. I even submit it in SQL Access query section and it&#39;s OK. But, I&#39;ll try now."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "edited": false, "score": 0, "creation_date": 1545237877, "post_id": 53855566, "comment_id": 94559150, "body": "It&#39;s OK for the solution."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "edited": false, "score": 0, "creation_date": 1545238032, "post_id": 53855566, "comment_id": 94559237, "body": "Great to hear. Curious, did you try the saved query approach?"}, {"owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "edited": false, "score": 0, "creation_date": 1545239062, "post_id": 53855566, "comment_id": 94559796, "body": "You&#39;re right @Parfait and I know that approach. However, I need to specify different criteria as date limits and other items from tables dynamically. So, saved queries seem inappropriate for me. Unless you have any tips."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "edited": false, "score": 1, "creation_date": 1545242762, "post_id": 53855566, "comment_id": 94561575, "body": "Consider <a href=\"https://stackoverflow.com/a/10353908/1422451\">parameterized queries</a> then where you keep the underlying structure but change values only: <code>SELECT * FROM mySavedQuery WHERE myDateCol BETWEEN ? AND ?</code>"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1545237884, "last_edit_date": 1545237884, "creation_date": 1545237565, "answer_id": 53855566, "question_id": 53855368, "link": "https://stackoverflow.com/questions/53855368/excel-vba-with-sql-no-row-returned-when-where-clause-specified/53855566#53855566", "title": "Excel VBA with SQL : No row returned when Where clause specified", "body": "<p>The <code>LIKE</code> wildcard behaves differently when running queries between the MS Access GUI (frontend) and any ODBC/OLDEB connection to MS Access (backend).  See differences between ANSI-89 and ANSI-92 in <a href=\"https://support.office.com/en-us/article/use-wildcards-in-queries-and-parameters-in-access-ec057a45-78b1-4d16-8c20-242cde582e0b\" rel=\"nofollow noreferrer\">MSDN docs</a>.</p>\n\n<p>For ODBC/OLEDB connections as you are doing in Excel, <code>LIKE</code> requires the ANSI-92 wildcard with <code>%</code>:</p>\n\n<pre><code>vSQL = vSQL &amp; \" Where OLIN.fk_cOHEAkey Like 'T180%' \"\n</code></pre>\n\n<p>Alternatively, to be compatiable in both use <code>ALIKE</code> (ANSI-Like) in GUI and ODBC/OLEDB:</p>\n\n<pre><code>vSQL = vSQL &amp; \" Where OLIN.fk_cOHEAkey ALike 'T180%' \"\n</code></pre>\n\n<hr>\n\n<p>Even better, save the query in MS Access (which is more efficient as the engine caches stats and the best execution plan):</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT OLIN.fk_cCUST as CustomerKey, \n       SUM(nOLINselTota) AS ResultSumV\nFROM (OLIN INNER JOIN TYOR ON OLIN.fk_cTYOR = TYOR.cTYOR) \nINNER Join MTYP On TYOR.fk_cMTYP = MTYP.cMTYP\nWHERE OLIN.fk_cOHEAkey LIKE 'T180*'\nGROUP BY OLIN.fk_cCUST\n</code></pre>\n\n<p>Then, reference its name in Excel (avoiding VBA concatenation):</p>\n\n<pre><code>vSQL = \"SELECT * FROM mySavedQuery\"\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 53855566, "answer_count": 1, "score": 1, "last_activity_date": 1579253089, "creation_date": 1545236832, "last_edit_date": 1579253089, "question_id": 53855368, "link": "https://stackoverflow.com/questions/53855368/excel-vba-with-sql-no-row-returned-when-where-clause-specified", "title": "Excel VBA with SQL : No row returned when Where clause specified", "body": "<p>Here below an excerpt of my codes.</p>\n\n<p>This is the SQL command :</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>   vSQL = \"SELECT OLIN.fk_cCUST as CustomerKey, Sum(nOLINselTota) AS ResultSumV \"\n   vSQL = vSQL &amp; \" FROM (OLIN Inner Join TYOR on OLIN.fk_cTYOR = TYOR.cTYOR) INNER Join MTYP On TYOR.fk_cMTYP = MTYP.cMTYP \"\n   vSQL = vSQL &amp; \" Where OLIN.fk_cOHEAkey Like 'T180*' \"\n   vSQL = vSQL &amp; \" GROUP BY OLIN.fk_cCUST \"\n   vSQL = vSQL &amp; \";\"\n</code></pre>\n\n<p>Where the database located :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>   vDataSRC = \"C:\\_projCuTOPs\\bdd\\GSF_dataWHouse.accdb\"\n</code></pre>\n\n<p>The variable containing the string connection to the DB :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>   vArrSRC = \"OLEDB;Provider=Microsoft.ACE.OLEDB.12.0;Password=\"\"\"\";User ID=Admin;\"\n   vArrSRC = vArrSRC &amp; \"Data Source= \" &amp; vDataSRC &amp; \";\"\n   vArrSRC = vArrSRC &amp; \"Mode=Share Deny Write;Extended Properties=\"\"\"\";Jet OLEDB:System database=\"\"\"\";Jet OLEDB:Registry Path=\"\"\"\";Jet OLEDB:Database Password=\"\"\"\";\"\n   vArrSRC = vArrSRC &amp; \"Jet OLEDB:Engine Type=6;Jet OLEDB:Database Locking Mode=0;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB:Global Bulk Transactions=1;\"\n   vArrSRC = vArrSRC &amp; \"Jet OLEDB:New Database Password=\"\"\"\";Jet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on Compact=False;\"\n   vArrSRC = vArrSRC &amp; \"Jet OLEDB:Compact Without Replica Repair=False;Jet OLEDB:SFP=False;Jet OLEDB:Support Complex Data=False;Jet OLEDB:Bypass UserInfo Validation=False;\"\n   vArrSRC = vArrSRC &amp; \"Jet OLEDB:Limited DB Caching=False;Jet OLEDB:Bypass ChoiceField Validation=False\"\n</code></pre>\n\n<p>The wrkSheet for the result :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>  ActiveWorkbook.Sheets.Add After:=Worksheets(Worksheets.Count)\n  ActiveWorkbook.Sheets(Worksheets.Count).Name = \"RawDatas\"\n</code></pre>\n\n<p>This command Adding QueryTable as a ListObject returns ZERO occurrence because of Where Clause whereas the SQL is OK.</p>\n\n<p>If the Where Clause is removed, it works but I need to add restrictions on Rows.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With ActiveSheet.ListObjects.Add(SourceType:=xlSrcExternal, Source:=vArrSRC, Destination:=Range(\"$A$1\")).QueryTable\n  '&gt;&gt;\n  .CommandType = xlCmdSql\n  .CommandText = vSQL\n  .RowNumbers = False\n  .FillAdjacentFormulas = False\n  .PreserveFormatting = True\n  .RefreshOnFileOpen = False\n  .BackgroundQuery = True\n  .RefreshStyle = xlInsertDeleteCells\n  .SavePassword = False\n  .SaveData = True\n  .AdjustColumnWidth = True\n  .RefreshPeriod = 0\n  .PreserveColumnInfo = True\n  '**\n  .SourceDataFile = vDataSRC\n  '**\n  .ListObject.DisplayName = \"tbl_SQL_SumTYOR\"\n  .Refresh BackgroundQuery:=False\n  '&gt;&gt;\nEnd With\n</code></pre>\n\n<p>What's wrong ? I absolutely need to use Where clause.</p>\n"}, {"tags": [".net", "vba", "64-bit", "office365", "activex"], "comments": [{"owner": {"reputation": 21, "user_id": 5378632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/962ac02571990a1aa83576d4be4e65ae?s=128&d=identicon&r=PG&f=1", "display_name": "gougoul", "link": "https://stackoverflow.com/users/5378632/gougoul"}, "edited": false, "score": 0, "creation_date": 1545236812, "post_id": 53855297, "comment_id": 94558547, "body": "maybe to make it clear, we register the dll using regasm, and use it by adding a reference (the component is found) in VBA. However when attempting to use it\u2026 it fails !"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1545237573, "post_id": 53855297, "comment_id": 94558971, "body": "Just to clarify, the Office 365 is a desktop install? If not, consider porting the code to TypeScript / Office-JS."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1545239768, "post_id": 53855297, "comment_id": 94560172, "body": "Granting that there are reasons blocking you from considering Office-JS, there isn&#39;t enough information to help you with the question as-is. For one thing, we need to see the code you&#39;re using in both the C# dll and the VBA to read that string in order to provide assistance in what is going wrong. There are several reasons why it might not work even though you apparently were able to register the DLL."}, {"owner": {"reputation": 21, "user_id": 5378632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/962ac02571990a1aa83576d4be4e65ae?s=128&d=identicon&r=PG&f=1", "display_name": "gougoul", "link": "https://stackoverflow.com/users/5378632/gougoul"}, "edited": false, "score": 0, "creation_date": 1545244628, "post_id": 53855297, "comment_id": 94562365, "body": "Ok, I added roughly the code.  For the DLL, I Checked the COM stuff in the project properties. I honestly don&#39;t know If anything else is required. Maybe I&#39;ll try this one out <a href=\"https://stackoverflow.com/questions/6340041/using-a-c-sharp-dll-inside-excel-vba\">link</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5378632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/962ac02571990a1aa83576d4be4e65ae?s=128&d=identicon&r=PG&f=1", "display_name": "gougoul", "link": "https://stackoverflow.com/users/5378632/gougoul"}, "is_accepted": false, "score": 0, "last_activity_date": 1545330253, "creation_date": 1545330253, "answer_id": 53874148, "question_id": 53855297, "link": "https://stackoverflow.com/questions/53855297/using-a-managed-dll-c-with-office-365-excel/53874148#53874148", "title": "using a managed DLL (C#) with Office 365 (Excel)", "body": "<p>Ok simply put, and as mentioned, the DLL used to work in Excel 2010...</p>\n\n<p>So this wasn't the issue.\nSo it was all down to using regasm in 64 bit\u2026</p>\n\n<p>Fixed it.</p>\n\n<p>Thanks for your comments anyway.</p>\n"}], "owner": {"reputation": 21, "user_id": 5378632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/962ac02571990a1aa83576d4be4e65ae?s=128&d=identicon&r=PG&f=1", "display_name": "gougoul", "link": "https://stackoverflow.com/users/5378632/gougoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545330253, "creation_date": 1545236577, "last_edit_date": 1545311744, "question_id": 53855297, "link": "https://stackoverflow.com/questions/53855297/using-a-managed-dll-c-with-office-365-excel", "title": "using a managed DLL (C#) with Office 365 (Excel)", "body": "<p>someone recently decided to move all Excel 2010 to Office 365... 64 bits Recently they realized that there were some ActiveX, legacy DLLs (written in vb6 !!) that were used in VBA.\nOf course they won't run in Office 365, so we are trying to migrate them to .NET 4.5.\nWe did a small sample dll in C# (returning a string). It works fine with Excel 2010, doesn't in 365. (Error 429).\nNow the question(s) are :\n1. Should it work / is possible to make it work ?\n2. If so how ?\n3. If not, what is proper way of doing it (preferably without dumping the VBA code) ?</p>\n\n<p>Ok, the code in vba is very simple</p>\n\n<p>like </p>\n\n<pre><code>Dim x as New Element365.Connection\nDim s as String\ns = x.get_String\nMsgBox s\n\nand the code in c# just as well...(The dll's name/namespace is Element365)\n\npublic class Connection {\n\npublic Connection() {\n}\n\npublic String get_String() {\nreturn \"This is a Test\"\n}\n}\n</code></pre>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1545240580, "post_id": 53855231, "comment_id": 94560604, "body": "Assign the selection range to a word.range. Then use the range.duplicate method to pass copies of the range as required."}, {"owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1545306375, "post_id": 53855231, "comment_id": 94583085, "body": "Would you give me a dummy example so that i can understand where i am doing things wrong."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545329037, "post_id": 53855231, "comment_id": 94594997, "body": "The picture isn&#39;t worth very much. Posting code in a picture is not within the site&#39;s rules - code (and error messages) should always be plain text. It would help a lot if you would post a sample of text you want to manipulate, another sample of what the result should be, and a sample of what the code you currently have actually does. Also describe what all the macros do - either in the problem description or using comments in the macros. The question is really not very clear."}, {"owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545329325, "post_id": 53855231, "comment_id": 94595111, "body": "Well i am trying my best to follow the site rules i am new here and people need to understand the concept so i have to upload the picture, second when i edit the code number of lines increased.. But from now on i am going to avoid the unnecessary details. Thank you for your corporation."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545324925, "post_id": 53869096, "comment_id": 94593092, "body": "Some how i mange to run the code and code work as i needed but not on the selected selection. The macro run on the all the non selected words as well ?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545325319, "post_id": 53869096, "comment_id": 94593303, "body": "It is your code.  All I have done is replace Selection with localrange .What did you mean when you wrote it originally.  If you intended to left align paragraphs then the line should be localrange.paragraphs.paragraphformat.alignment=wdalignparag&zwnj;&#8203;raphright.  I&#39;d suggest you put Option Explicit at the top of your module."}, {"owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545326450, "post_id": 53869096, "comment_id": 94593827, "body": "Oh great it worked but now one other issued appeared now align macro run on the non selected words, and when forth call is running the last selected value remains the same."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545326910, "post_id": 53869096, "comment_id": 94594053, "body": "In which case you need to provide  an explanation of what you are trying to achieve.  Additionally it might be helpful if you provide examples of your document showing how it appears before and how you wish it to appear afterwards."}, {"owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545328480, "post_id": 53869096, "comment_id": 94594736, "body": "See the above attached picture plz."}, {"owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545328585, "post_id": 53869096, "comment_id": 94594791, "body": "i want to reverse the selected words then remove the commas and then reverse the same selected words again. This is what i am trying  to achieve."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545329520, "post_id": 53869096, "comment_id": 94595192, "body": "Thanks for the image.  Its now clear what you want and also why there are issues.  When you select a range of cells in a table the number of cells in Selection.Cells.Count and Selection.Range.Count don&#39;t match.  Selection.Range.Cells gives all the cells starting at the first in the selection, then counting left across each row in the table (including cells outside the selection) until the last cell in the selection is reached.  This is a very frustrating difference between selection and selection.range (and hence why SelectedRange is causing your macros to behave incorrectly."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545329850, "post_id": 53869096, "comment_id": 94595316, "body": "Select a range of cells in your table and then print the results of selection.cells.count and selection.range.cells.count. In the short term it means that you have to go back and use Selection BUT you use the selectedrange to reset the selection in each macro.  So rather than Set localrange = SelectedRange.Duplicate, change to SelectedRange.Select to reset the selection and change the use of selectedrange back to selection e.g. localrange.Find.ClearFormatting to Selection.Find.Clearformatting etc.  I&#39;ll update the code for tomorrow as I&#39;m stuck in meetings for the rest of today."}, {"owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "edited": false, "score": 0, "creation_date": 1545334111, "post_id": 53869096, "comment_id": 94597051, "body": "Waiting for your updated response. Thanks for your time and help in advance."}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": true, "score": 1, "last_activity_date": 1545395694, "last_edit_date": 1545395694, "creation_date": 1545310213, "answer_id": 53869096, "question_id": 53855231, "link": "https://stackoverflow.com/questions/53855231/how-can-i-pass-copy-the-same-selection-so-that-i-can-run-the-multiple-macros-o/53869096#53869096", "title": "How can i pass/copy the same selection?? So that i can run the multiple macros on same selection with single click.?", "body": "<p>I amended your code to show you what I mean.  I added the SelectedRange variable.  Selected range uses duplicate to make a copy of the selection range.  SelectedRange is set as a global variable for the purposes of your code. localRange is used in your macros where we make a copy of SelectedRange. </p>\n\n<p>Edit 2018-12-20: Minor updates to the code to add option explicit, add missing declarations, make SelectedRange global and to replace the mysterious LtlPara with code to left align paragraphs</p>\n\n<p>Edit 2018-12-21: revised code to reestablish selection and an explanation of why this is necessary.</p>\n\n<p>The OP is selecting a range of cells in a table and then iterating over the cells to do a couple of transformations on the string in each cell.  Typically we would not use selection for all of these operations, instead we would set a word range and work with the word range.  In this specific case this runs into a problem because there is a difference between Selection and a word range when applied to a table.  The difference is that Selection.Cells.Count gives the number of of cells in the selection but selection.Range.Cells.count gives the number of cells in the table starting with the first cell in Selection.range, counting each cell in the table from left to right, row by row, until the last cell in the selection is reached.  This is why cells not in the selection are being processed when using a word range rather than the selection.</p>\n\n<p>We can overcome this oddity by preserving the selection range in a word range and then restoring the selection using SelectedRange.Select for each sub that needs to work on the Selection.</p>\n\n<pre><code>Option Explicit\nPublic SelectedRange  As Word.Range\n\nPrivate Sub CommandButton1_Click()\n\nDim cl As Word.Cell\nDim Rng As Word.Range\nDim i As Long\nDim iRng As Word.Range\nDim oWord As Word.Range\n\n    SelectedRange.Select\n    If Selection.Information(wdWithInTable) = True Then\n\n\n        For Each cl In Selection.Cells\n            Set Rng = cl.Range\n            Rng.MoveEnd Word.WdUnits.wdCharacter, Count:=-1\n            For i = 1 To Rng.Words.Count\n                Set iRng = Rng.Words(i)\n                'rng.Select\n\n                Set oWord = iRng\n                Do While oWord.Characters.Last.Text = \" \"\n                    Call oWord.MoveEnd(WdUnits.wdCharacter, -1)\n                Loop\n                Debug.Print \"'\" &amp; oWord.Text &amp; \"'\"\n                oWord.Text = StrReverse(oWord.Text)\n\n                Debug.Print Selection.Text\n\n            Next i\n        Next cl\n    End If\n\nEnd Sub\nSub Align()\nDim localrange As Word.Range\n\n    'Set localrange = SelectedRange.Duplicate\n    SelectedRange.Select\n    'Selection.RtlPara\n    Selection.Paragraphs.Alignment = wdAlignParagraphLeft\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    Set SelectedRange = Selection.Range.Duplicate 'make a copy of the selection range\n    Align\n    CommandButton1_Click\n    Comma_Remove\n    CommandButton1_Click\n\nEnd Sub\n\nSub Comma_Remove()\n\n    SelectedRange.Select\n\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = \",\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchKashida = False\n        .MatchDiacritics = False\n        .MatchAlefHamza = False\n        .MatchControl = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9065500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0NeX.jpg?s=128&g=1", "display_name": "M Ahad", "link": "https://stackoverflow.com/users/9065500/m-ahad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53869096, "answer_count": 1, "score": 0, "last_activity_date": 1545395694, "creation_date": 1545236309, "last_edit_date": 1545328819, "question_id": 53855231, "link": "https://stackoverflow.com/questions/53855231/how-can-i-pass-copy-the-same-selection-so-that-i-can-run-the-multiple-macros-o", "title": "How can i pass/copy the same selection?? So that i can run the multiple macros on same selection with single click.?", "body": "<p>I have to run the three macros with single click, when i call the first macro the selected word got reversed but the selection got lost and i think the selection got  deselected due to the change of the word(in reversed), but i need the selection to run the other macros on the same selection.</p>\n\n<pre><code>Dim oWord As Range\n\nIf Selection.Information(wdWithInTable) = True Then\n    For Each cl In Selection.Cells\n        Set rng = cl.Range\n        rng.MoveEnd Word.WdUnits.wdCharacter, Count:=-1\n        For i = 1 To rng.Words.Count\n            Set iRng = rng.Words(i)\n            'rng.Select\n\n            Set oWord = iRng\n            Do While oWord.Characters.Last.Text = \" \"\n                Call oWord.MoveEnd(WdUnits.wdCharacter, -1)\n            Loop\n            Debug.Print \"'\" &amp; oWord.Text &amp; \"'\"\n            oWord.Text = StrReverse(oWord.Text)\n\n            Debug.Print Selection.Text\n\n        Next i\n    Next cl\nEnd If\n\nEnd Sub\nSub Align()\n\n'Selection.RtlPara\n Selection.LtrPara\n\n End Sub\n\n Private Sub CommandButton2_Click()\n\n Call Align\n Call CommandButton1_Click\n Call Comma_Remove\n Call CommandButton1_Click\n\n End Sub\n\n Sub Comma_Remove()\n\n\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nWith Selection.Find\n    .Text = \",\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchKashida = False\n    .MatchDiacritics = False\n    .MatchAlefHamza = False\n    .MatchControl = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\nEnd Sub\n</code></pre>\n\n<p>This picture illustrates the issues i received after changes to the code</p>\n\n<p><a href=\"https://i.stack.imgur.com/s5CUE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s5CUE.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1545236457, "post_id": 53855168, "comment_id": 94558320, "body": "How are you putting this into the Email - if you&#39;re updating the <code>.HTMLBody</code> directly, then <code>&lt;b&gt;Bold Text Here&lt;&#47;b&gt;</code> is simple enough.  If you&#39;re converting a sheet/range to HTML and copying across then look at formatting <code>Range.Characters([Start],[Length])</code> instead"}, {"owner": {"reputation": 1, "user_id": 10812077, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BiLIiGoBrkU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKTlBMbXJW21Ra0GtO8YFxbW5skQ/mo/photo.jpg?sz=128", "display_name": "Aaron Desmedt", "link": "https://stackoverflow.com/users/10812077/aaron-desmedt"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1545293393, "post_id": 53855168, "comment_id": 94576705, "body": "Something like this ? objTable.cell(1, 2).Range.Characters(1,23).Font.Bold = True ? The code is directly put in outlook as objSignatureObject. Thanks for the help already but doesn`t make anything bold for me"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1545295124, "post_id": 53855168, "comment_id": 94577384, "body": "<code>objTable.Cells(1,2).Characters(1,23).Font.Bold = True</code> should make the first 23 characters bold.  <code>objTable.Cells(1,2).Range.Characters(1,23).Font.Bold = True</code> should throw an &quot;Argument not Optional&quot; error.  And trying to track the code you&#39;ve cribbed (more of the code is required to make this a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) you&#39;re actually working with a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.emailsignature\" rel=\"nofollow noreferrer\"><code>Word.EmailSignature</code> object</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1545310124, "creation_date": 1545310124, "answer_id": 53869074, "question_id": 53855168, "link": "https://stackoverflow.com/questions/53855168/making-a-specific-part-of-table-bold/53869074#53869074", "title": "Making a specific part of table bold", "body": "<p>Try:</p>\n\n<pre><code>With objTable.Cell(1, 2).Range\n  .Text = strFirstName &amp; \" \" &amp; strLastName &amp; \" | \" &amp; strTitle &amp; Chr(11) &amp; _\n  strDepartment &amp; Chr(11) &amp; Chr(11) &amp; _\n  strAdress &amp; \", \" &amp; strPostal &amp; \" \" &amp; strCity &amp; Chr(11) &amp; _\n  \"T\" &amp; \" \" &amp; strPhone &amp; strTelefoon &amp; Chr(11) &amp; _\n  \"E \" &amp; strEmail\n  .End = .Start + InStr(.Text, \" | \") - 1\n  .Font.Bold = True\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1545511566, "post_id": 53883553, "comment_id": 94643777, "body": "@Aaron_Desmedt Using selections is both unnecessary and inefficient. The code I posted is way more efficient and is also much less likely to produce screen flicker."}], "tags": [], "owner": {"reputation": 1, "user_id": 10812077, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BiLIiGoBrkU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKTlBMbXJW21Ra0GtO8YFxbW5skQ/mo/photo.jpg?sz=128", "display_name": "Aaron Desmedt", "link": "https://stackoverflow.com/users/10812077/aaron-desmedt"}, "is_accepted": false, "score": 0, "last_activity_date": 1545389732, "creation_date": 1545389732, "answer_id": 53883553, "question_id": 53855168, "link": "https://stackoverflow.com/questions/53855168/making-a-specific-part-of-table-bold/53883553#53883553", "title": "Making a specific part of table bold", "body": "<p>Thanks for all the answers!</p>\n\n<p>I fixed it by going with .select</p>\n\n<pre><code>objTable.Cell(1,2).select\nobjSelection.Font.Name = \"Calibri Light\"\nobjSelection.Font.Size = \"11\"\nobjSelection.Font.Color = RGB(23,68,153)\nIf strFirstName &lt;&gt; \"\" Then\n            objSelection.Font.Bold = True\n            objSelection.TypeText strFirstName &amp; \" \" &amp; strLastName\n            objSelection.Font.Bold = False\nEnd If\nIf strTitle &lt;&gt; \"\" Then\n    ObjSelection.TypeText \" | \" &amp; strTitle \nEnd If\nObjSelection.TypeText (Chr(11))\nObjSelection.TypeText strDepartment \nObjSelection.TypeText (Chr(11))\nIf strFirstName &lt;&gt; \"\" Then\n            objSelection.Font.size = 5\n            objSelection.TypeText \" \"\n            objSelection.Font.size = 11\nEnd If\nObjSelection.TypeText (Chr(11))\nObjSelection.TypeText strAdress &amp; \", \" &amp; strPostal &amp;  \" \" &amp; strCity\nObjSelection.TypeText (Chr(11))\nIf strPhone &lt;&gt; \"\" Then\n            objSelection.Font.Bold = True\n            objSelection.TypeText \"T \" \n            objSelection.Font.Bold = False\nEnd If\nObjSelection.TypeText strPhone \nIf strGSM &lt;&gt; \"\" Then\n            objSelection.TypeText \" | \" \n            objSelection.Font.Bold = True\n            objSelection.TypeText \" G \" \n            objSelection.Font.Bold = False\nEnd If\nObjSelection.TypeText strTelefoon \nObjSelection.TypeText (Chr(11))\nIf strEmail &lt;&gt; \"\" Then\n            objSelection.Font.Bold = True\n            objSelection.TypeText \"E \" \n            objSelection.Font.Bold = False\n            objSelection.TypeText strEmail\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10812077, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BiLIiGoBrkU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKTlBMbXJW21Ra0GtO8YFxbW5skQ/mo/photo.jpg?sz=128", "display_name": "Aaron Desmedt", "link": "https://stackoverflow.com/users/10812077/aaron-desmedt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545856210, "creation_date": 1545236082, "last_edit_date": 1545856210, "question_id": 53855168, "link": "https://stackoverflow.com/questions/53855168/making-a-specific-part-of-table-bold", "title": "Making a specific part of table bold", "body": "<p>Im altering the code of a Script that is used to automatically paste an outlook signature based on AD. Now im having some problems with making the formatting work</p>\n\n<p>I have one cell that contains most of the usefull information but i need the firstname and Lastname to be bold. And the other info on the same lines and below it to follow the format info that was given above it</p>\n\n<p>I tried seperating the code in different cells but the formatting goes all wrong then</p>\n\n<pre><code>objTable.Cell(1, 2).Range.Text = strFirstName &amp; \" \" &amp; strLastName &amp; \" | \" &amp; strTitle &amp; Chr(11) &amp; strDepartment &amp; Chr (11) &amp; Chr(11) &amp; strAdress &amp; \", \" &amp; strPostal &amp;  \" \" &amp; strCity &amp; Chr (11) &amp; \"T\" &amp;  \" \" &amp; strPhone &amp; strTelefoon &amp; Chr (11) &amp; \"E \" &amp; strEmail\n</code></pre>\n\n<p>strFirstName and strLastName should be in bold</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545321262, "post_id": 53855101, "comment_id": 94591190, "body": "Your combining late and early binding there - <code>Dim fso As FileSystemObject</code> and <code>Dim d As Drive</code> are early binding, while <code>Set fso = CreateObject(&quot;Scripting.Filesystemobject&quot;)</code> is late binding.  Change <code>fso</code> &amp; <code>d</code> to <code>Object</code> data types and remove the reference you&#39;ve set to the <code>Microsoft Scripting Runtime</code>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5692997, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/AagZU.jpg?s=128&g=1", "display_name": "Rohit Singh", "link": "https://stackoverflow.com/users/5692997/rohit-singh"}, "edited": false, "score": 0, "creation_date": 1545317740, "post_id": 53855544, "comment_id": 94589207, "body": "actually I need window drive not network drive but this code is really useful I have change the code, now result is fine. but I have another problem I need selected drive file in another listbox when i select any drive from combobox."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 33, "user_id": 5692997, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/AagZU.jpg?s=128&g=1", "display_name": "Rohit Singh", "link": "https://stackoverflow.com/users/5692997/rohit-singh"}, "edited": false, "score": 0, "creation_date": 1545318208, "post_id": 53855544, "comment_id": 94589472, "body": "Could you edit your question with the code you have and screenshots of what you mean by  <i>selected drive file in another listbox when i select any drive from combobox</i>."}, {"owner": {"reputation": 33, "user_id": 5692997, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/AagZU.jpg?s=128&g=1", "display_name": "Rohit Singh", "link": "https://stackoverflow.com/users/5692997/rohit-singh"}, "edited": false, "score": 0, "creation_date": 1545320948, "post_id": 53855544, "comment_id": 94591013, "body": "I have edited my question for your reference. please have look and guide me. also I have attached screenshot of my requirement."}, {"owner": {"reputation": 33, "user_id": 5692997, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/AagZU.jpg?s=128&g=1", "display_name": "Rohit Singh", "link": "https://stackoverflow.com/users/5692997/rohit-singh"}, "edited": false, "score": 0, "creation_date": 1545322578, "post_id": 53855544, "comment_id": 94591900, "body": "you can see in attachment that I am able to get drive name in combobox, but now I want, when I select any drive from combobox the drive folder/subfulder shoul be show in listbox. please find the attached image."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1545237465, "creation_date": 1545237465, "answer_id": 53855544, "question_id": 53855101, "link": "https://stackoverflow.com/questions/53855101/how-to-get-all-window-drive-list-in-combobox-or-any-other-control/53855544#53855544", "title": "How to get all window drive list in combobox or any other control", "body": "<p>This will print <strike>all</strike> network drives out to the immediate window, so you just have to change the <code>Debug.Print</code> bit to add it to your combobox.    </p>\n\n<pre><code>Sub All_Drives()\n\n    Dim oNtwrk As Object\n    Dim oDrvs As Object\n    Dim x As Long\n\n    Set oNtwrk = CreateObject(\"WScript.Network\")\n    Set oDrvs = oNtwrk.EnumNetworkDrives\n\n    For x = 0 To oDrvs.Count - 1 'Step 2 'Might need step 2... can't remember.\n        Debug.Print oDrvs.Item(x)\n    Next x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5692997, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/AagZU.jpg?s=128&g=1", "display_name": "Rohit Singh", "link": "https://stackoverflow.com/users/5692997/rohit-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593676621, "creation_date": 1545235883, "last_edit_date": 1593676621, "question_id": 53855101, "link": "https://stackoverflow.com/questions/53855101/how-to-get-all-window-drive-list-in-combobox-or-any-other-control", "title": "How to get all window drive list in combobox or any other control", "body": "<p>Hi i am working on homework task and want to populated all window drive list in combobox. and when I select the drive name from cambox then the folder/subfolder should be listed down in a Listbox.</p>\n\n<p>I have populated the drive name in combobox here is my code:\n<img src=\"https://i.stack.imgur.com/Il9od.png\" alt=\"Screen shoot\"></p>\n\n<pre><code>Private Sub Form_Load()\n   Dim fso As FileSystemObject\n   Dim d As Drive\n   Dim dName As String\n   Dim k As String\n   Dim g As String\n   Set fso = CreateObject(\"Scripting.Filesystemobject\")\n       For Each d In fso.Drives\n           k = d.DriveLetter\n           dName = dName &amp; \",\" &amp; d\n        Next d\n            g = Mid(dName, 2, Len(dName))\n            cboDrive.RowSource = g\n        End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1545235917, "post_id": 53854927, "comment_id": 94558005, "body": "You&#39;re late-binding Word here; <code>wdWebView</code> has no meaning unless you&#39;ve referenced the Word type library... in which case late-binding serves little purpose other than making your life much harder than it needs to be."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1545235969, "post_id": 53854927, "comment_id": 94558027, "body": "<code>ActiveWindow</code> is in the scope of the current host application, i.e. <code>Excel.Application.ActiveWindow</code> - if you want the Word window, you need to work off the <code>objWord</code> object."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1607695181, "last_edit_date": 1607695181, "creation_date": 1545236374, "answer_id": 53855247, "question_id": 53854927, "link": "https://stackoverflow.com/questions/53854927/altering-word-view-from-excel-vba/53855247#53855247", "title": "Altering Word view from Excel VBA", "body": "<p>As mentioned in the comments, you're mixing late-binding and early-binding, and also need to reference the Word instance.</p>\n<p>An early-binding approach might be (add a reference to the <em>Microsoft Word xx.0 Object Library</em> under <em>Tools</em> &gt; <em>References</em>).</p>\n<pre><code>Sub MyWord()\n    Dim wordApp As New Word.Application\n    Dim myDoc As Word.Document\n    \n    wordApp.Visible = True\n    Set myDoc = wordApp.Documents.Add\n    wordApp.ActiveWindow.View.Type = wdWebView\nEnd Sub\n</code></pre>\n<p>If you want to late-bind, note from the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.wdviewtype\" rel=\"nofollow noreferrer\"><code>WdViewType</code></a> enum docs that <code>wdWebView</code> corresponds to the value 6.</p>\n<pre><code>Sub MyWord()\n    Const wdWebView As Long = 6\n    Dim objWord As Object\n    Dim objDoc As Object\n    \n    Set objWord = CreateObject(&quot;Word.Application&quot;)\n    objWord.Visible = True\n    \n    Set objDoc = objWord.Documents.Add\n    objWord.ActiveWindow.View.Type = wdWebView\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1545260422, "creation_date": 1545260422, "answer_id": 53860339, "question_id": 53854927, "link": "https://stackoverflow.com/questions/53854927/altering-word-view-from-excel-vba/53860339#53860339", "title": "Altering Word view from Excel VBA", "body": "<p>You <em>don't</em> have to use early binding to use wdWebView. Instead, you could use:</p>\n\n<pre><code>Dim objWord As Object, objDoc As Object\nConst wdWebView As Long = 6\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc = objWord.Documents.Add\nobjWord.ActiveWindow.View.Type = wdWebView\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10811999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QbH6H_nX3RA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hPFqc8tCetQ0EtEiiPNT8PoI6Dbg/mo/photo.jpg?sz=128", "display_name": "plee", "link": "https://stackoverflow.com/users/10811999/plee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1614685607, "creation_date": 1545235156, "last_edit_date": 1614685607, "question_id": 53854927, "link": "https://stackoverflow.com/questions/53854927/altering-word-view-from-excel-vba", "title": "Altering Word view from Excel VBA", "body": "<p>I'd like to change the view in Word from my Excel macro (which creates the Word document).</p>\n<p>I'd like to execute: <code>ActiveWindow.View.Type = wdWebView</code></p>\n<p>In my Excel macro, I have:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Dim objWord\nDim objDoc    \nSet objWord = CreateObject(&quot;Word.Application&quot;)\nSet objDoc = objWord.Documents.Add\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545233628, "post_id": 53854410, "comment_id": 94556449, "body": "<i>.SetRange Range(&quot;A:CU&quot;, Selection.End(xlDown))</i>  would be my first guess.  help us understand by defining your ranges in the question, etc."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545235331, "post_id": 53854410, "comment_id": 94557660, "body": "With line break you mean an empty row? Could you give as the &#39;coordinates&#39; of the two ranges e.g. A1:CU100 and A102:CU200? Then we could provide the solution much easier. I would say that Range(&quot;A:CU&quot;, Selection.End(xlDown)) selects the.whole columns but we don&#39;t know what the first 3 selections select!?"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1545236629, "post_id": 53854410, "comment_id": 94558444, "body": "This is sorta the heart of the issue I have. I am using a line break or a row of blank cells to separate the two sections I&#39;m trying to sort. The second section is separated by a row of blank cells and I need to sort by column E from A to CU columns. The problem is that the second section doesn&#39;t have a set row it could be row 60 or row 100."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1545238541, "post_id": 53855508, "comment_id": 94559533, "body": "This is almost perfect! it&#39;s grabbing my top 2 rows though (which are my header) and plopping them in the break. But otherwise this works perfectly!!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10808941"}, "reply_to_user": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1545238711, "post_id": 53855508, "comment_id": 94559624, "body": "I&#39;ve added two lines of code to hide/unhide the first two rows as well."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10808941"}, "is_accepted": true, "score": 2, "last_activity_date": 1545238656, "last_edit_date": 1545238656, "creation_date": 1545237343, "answer_id": 53855508, "question_id": 53854410, "link": "https://stackoverflow.com/questions/53854410/sorting-from-a-dynamic-row/53855508#53855508", "title": "Sorting from a dynamic row", "body": "<p>If the 'line breaks' are blank rows, hide them and you can cycle through the Range.Areas of Range.SpecialCells(xlCellTypeVisible).</p>\n\n<pre><code>Option Explicit\n\nSub sortAreas()\n\n    Dim a As Long\n\n    With Worksheets(\"sheet10\")\n\n        .range(\"1:2\").entirerow.hidden = true\n        .Columns(\"E\").SpecialCells(xlCellTypeBlanks).EntireRow.Hidden = True\n\n        With Intersect(.Range(\"A:CU\"), .UsedRange).SpecialCells(xlCellTypeVisible)\n\n            For a = 1 To .Areas.Count\n\n                With .Areas(a)\n\n                    .Cells.Sort Key1:=.Columns(5), Order1:=xlAscending, DataOption1:=xlSortTextAsNumbers, _\n                                Orientation:=xlTopToBottom, Header:=xlNo\n\n                End With\n            Next a\n\n        End With\n\n        .Columns(\"E\").SpecialCells(xlCellTypeBlanks).EntireRow.Hidden = False\n        .range(\"1:2\").entirerow.hidden = false\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53855508, "answer_count": 1, "score": 0, "last_activity_date": 1579183735, "creation_date": 1545233446, "last_edit_date": 1579183735, "question_id": 53854410, "link": "https://stackoverflow.com/questions/53854410/sorting-from-a-dynamic-row", "title": "Sorting from a dynamic row", "body": "<p>I'm working on sorting two sections of a spreadsheet the top works fine the bottom half I'm having a problem with since the row changes based on the data. Here is what I have, the problem is it ends up sorting the entire (both) sections (which are separated by a line break). Any help in the right direction would be greatly appreciated.</p>\n\n<p>Edit for Clarification:\nwhat I have is a spreadsheet that has two sections. The top section which can be a variable/dynamic range. IE it could be 30 rows or 300 rows. The second half of the spreadsheet which is separated by a line insert (blank row of cells) I need to sort and am having the issue. The problem is getting the sort to recognize the cells from A (variable/dynamic) row to CU. Hopefully that helps explain things a little better but just let me know if more clarification is needed. </p>\n\n<pre><code> Sub test()\n\n Dim lrow As Long\n\n lrow = Selection.End(xlDown).Row\n\nSelection.End(xlDown).Select\nRange(Selection, Selection.End(xlDown)).Select\nActiveWorkbook.Worksheets(\"Inseason Columns\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Inseason Columns\").Sort.SortFields.Add Key:=Range( _\n    \"E\" &amp; lrow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortTextAsNumbers\nWith ActiveWorkbook.Worksheets(\"Inseason Columns\").Sort\n    .SetRange Range(\"A:CU\", Selection.End(xlDown))\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545233727, "post_id": 53854280, "comment_id": 94556496, "body": "Are the lists named ranges?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1545233789, "post_id": 53854280, "comment_id": 94556544, "body": "If yes, try <code>(&quot;MyList&quot; &amp; i, &quot;,&quot;)</code> (adding quotes around <code>MyList</code>"}, {"owner": {"reputation": 53, "user_id": 10283722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc3f3620c52d7567cde20fd4747f204?s=128&d=identicon&r=PG&f=1", "display_name": "MarkHav", "link": "https://stackoverflow.com/users/10283722/markhav"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1545316447, "post_id": 53854280, "comment_id": 94588441, "body": "@cybernetic.nomad i get a type mismatch when doing this, same as before"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1545319375, "post_id": 53854280, "comment_id": 94590087, "body": "I&#39;m assuming that the &quot;named lists&quot; are actually named ranges, assuming that&#39;s the case, try <code>Formula1:=&quot;=MyList&quot; &amp; i</code>"}], "owner": {"reputation": 53, "user_id": 10283722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc3f3620c52d7567cde20fd4747f204?s=128&d=identicon&r=PG&f=1", "display_name": "MarkHav", "link": "https://stackoverflow.com/users/10283722/markhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1545233234, "creation_date": 1545233019, "last_edit_date": 1545233234, "question_id": 53854280, "link": "https://stackoverflow.com/questions/53854280/vba-displaying-certain-list-as-dropdown-depending-on-result", "title": "vba displaying certain list as dropdown depending on result", "body": "<p>I want to make it so that a dropdown list is created, the list becoming a dropdown depends on the result of an <code>IF</code> statement. Each list is called \"MyList\" followed by a number (MyList2, MyList9 etc.) I am using he following code to determine which list should be used and to create the dropdown:</p>\n\n<pre><code>For i = 3 To 31\n        If customer = ThisWorkbook.Sheets(\"lists1\").Range(\"B\" &amp; i).Value Then\n            With ThisWorkbook.Sheets(\"Off-Site_Expendicture\").Range(\"CusLoc\").Validation\n                .Delete\n                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n                    Operator:=xlBetween, Formula1:=Join(MyList &amp; i, \",\")\n            End With\n        End If\nNext i\n</code></pre>\n\n<p>I believe that this doesn't work due to the fact you can't use (MyList &amp; i) I have tried all I can think to get it work but can't find a way. Everything works fine except the 'with' statement.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "edited": false, "score": 0, "creation_date": 1545236365, "post_id": 53854485, "comment_id": 94558256, "body": "Thank you, that works for the problem number (1)! :) Now I would like to solve problem number (2), do you have any idea about that one?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "edited": false, "score": 1, "creation_date": 1545236478, "post_id": 53854485, "comment_id": 94558337, "body": "I don&#39;t think filenames can contain the <code>|</code> character."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "edited": false, "score": 0, "creation_date": 1545236706, "post_id": 53854485, "comment_id": 94558475, "body": "Great, easy fix, glad to help!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1545233675, "creation_date": 1545233675, "answer_id": 53854485, "question_id": 53854245, "link": "https://stackoverflow.com/questions/53854245/save-email-draft-in-msg-format-with-saveas/53854485#53854485", "title": "Save email draft in .msg format with .SaveAs", "body": "<p>I think you want <code>3</code> instead of <code>5</code>.</p>\n\n<p>From the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.olsaveastype\" rel=\"nofollow noreferrer\"><code>olSaveAsType</code></a> enumeration:</p>\n\n<ul>\n<li><code>3</code> corresponds to <em>Outlook message format</em> (.msg)</li>\n<li><code>5</code> corresponds to <em>HTML format</em> (.html)</li>\n</ul>\n\n<p>Alternately, you could just drop the file type. From the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.saveas\" rel=\"nofollow noreferrer\"><code>MailItem.SaveAs</code></a> documentation,</p>\n\n<blockquote>\n  <p>If the file type is not specified, the MSG format (.msg) is used.</p>\n</blockquote>\n"}], "owner": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 53854485, "answer_count": 1, "score": 0, "last_activity_date": 1592700506, "creation_date": 1545232895, "last_edit_date": 1592700506, "question_id": 53854245, "link": "https://stackoverflow.com/questions/53854245/save-email-draft-in-msg-format-with-saveas", "title": "Save email draft in .msg format with .SaveAs", "body": "<p>I am using a VBA code to write an email in Outlook with the information from a PowerPoint file and saving it as a draft, in the format \".msg\". </p>\n\n<pre><code>With OutMail                    \n    .To = name_email                                     \n    'Add file likethis                    \n    .Attachments.Add (\"C:... \" &amp; numb_slide &amp; \".pptx\")                    \n    .Subject = \"... \" &amp; date_c &amp; \" | Open Tasks \" &amp; name_project &amp; \" | Feedback ... \" &amp; dead_line_date &amp; \",...\"                    \n    .Body = StrBody                                    \n    '.SaveAs \"C:... \" &amp; CStr(date_c) &amp; \" | ... \" &amp; CStr(name_project) &amp; \".msg\", 5                    \n    .SaveAs \"C:...\" &amp; numb_slide &amp; \".msg\", 5                    \n    '.Display Or use .Send                \nEnd With\n</code></pre>\n\n<p>I have <strong>two problems:</strong> </p>\n\n<p><strong>1)</strong> When I save the file using: </p>\n\n<pre><code>.SaveAs \"C:...\" &amp; numb_slide &amp; \".msg\", 5\n</code></pre>\n\n<p>The program does not give me an error but I cannot open the draft that was saved, the error states: <a href=\"https://i.stack.imgur.com/cUAF5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cUAF5.png\" alt=\"error when trying to open the draft\"></a></p>\n\n<p>If I create a normal email and save it as a draft, I can open it later.</p>\n\n<p><strong>2)</strong> If I change the way I save the file, like: </p>\n\n<pre><code>.SaveAs \"C:... \" &amp; CStr(date_c) &amp; \" | ... \" &amp; CStr(name_project) &amp; \".msg\", 5 \n</code></pre>\n\n<p>Or </p>\n\n<pre><code>.SaveAs \"C:... \" &amp; date_c &amp; \" | Open Tasks \" &amp; name_project &amp; \".msg\", 5 \n</code></pre>\n\n<p>It gives me the following error before finishing the task: </p>\n\n<p><a href=\"https://i.stack.imgur.com/2JJrh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2JJrh.png\" alt=\"enter image description here\"></a></p>\n\n<p>The variables I am writing in the name are strings, but I also tried to write them using <code>CStr()</code> to check if it would make any difference, <em>and it does not!</em></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1545232699, "post_id": 53854149, "comment_id": 94555800, "body": "Perhaps consider the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/instr-function\" rel=\"nofollow noreferrer\"><code>InStr</code></a> function."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545233159, "post_id": 53854149, "comment_id": 94556116, "body": "To add to @BigBens comment - <code>Right(filename,&lt;result of Instr function&gt;+1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1545236309, "post_id": 53854973, "comment_id": 94558221, "body": "I edited it to work, but it&#39;s running through and not actually making any folders, odd. Well, your answer at least got it to identify the string I want to label each folder with. thanks!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1545238400, "post_id": 53854973, "comment_id": 94559450, "body": "<code>Name</code> doesn&#39;t create a new folder, were you expecting it to?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1545238602, "post_id": 53854973, "comment_id": 94559566, "body": "yeah, would I need to switch that to a <code>MkDir</code>?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1545239248, "post_id": 53854973, "comment_id": 94559889, "body": "You&#39;d have to <code>MkDir</code> first yeah, and then <code>Name</code> to move the file"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 4, "last_activity_date": 1545235369, "creation_date": 1545235369, "answer_id": 53854973, "question_id": 53854149, "link": "https://stackoverflow.com/questions/53854149/look-for-the-first-in-a-filename-string/53854973#53854973", "title": "Look for the first &quot;_&quot; in a filename string", "body": "<ol>\n<li>If the file extension is <code>.xlsx</code>, then change <code>fileName = Dir(sourceFolder &amp; \"*.xls\")</code> to <code>fileName = Dir(sourceFolder &amp; \"*.xlsx\")</code>. </li>\n<li>Consider the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/instr-function\" rel=\"nofollow noreferrer\"><code>InStr</code></a> function, which \"returns a Variant (Long) specifying the position of the first occurrence of one string within another.\"\n\n<ul>\n<li>As is, <code>destinationFolder = Left(fileName, InStrRev(fileName, \".\") - 1)</code> finds everything to the left of the last period. </li>\n<li>So if you want to the destination folder to be <code>Manager Name</code>, then perhaps <code>destinationFolder = Left$(fileName, InStr(fileName, \"_\") - 1)</code></li>\n<li>Note that this can be made more robust to handle the possibility of no <code>_</code> in the file name, or the file name beginning with <code>_</code>, with an initial <code>If InStr(fileName, \"_\") &gt; 1)</code>.</li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 53854973, "answer_count": 1, "score": 0, "last_activity_date": 1545350787, "creation_date": 1545232592, "last_edit_date": 1545350787, "question_id": 53854149, "link": "https://stackoverflow.com/questions/53854149/look-for-the-first-in-a-filename-string", "title": "Look for the first &quot;_&quot; in a filename string", "body": "<p>I want to loop through a directory and group files by the filenames up until the first <code>_</code> in the filename. </p>\n\n<p>Files are structured by </p>\n\n<blockquote>\n  <p>Manager Name_Employee Name_Assessment.xlsx</p>\n</blockquote>\n\n<p>I want this to group together strings up until the first underscore. I can't designate a character length because managers have different names. </p>\n\n<p>I'm thinking changing the <code>If Right(filename,4)</code> statement should do what I want, but I can't specify a character limit. </p>\n\n<pre><code>Public Sub Move_Files()\n\nDim sourceFolder As String, fileName As String\nDim destinationFolder As String, foundDestinationFolder As String\nDim missingFolders As String\n\nsourceFolder = \"C:\\Assessment\\\"\nIf Right(sourceFolder, 1) &lt;&gt; \"\\\" Then sourceFolder = sourceFolder &amp; \"\\\"\n\n'Loop through *.xls files in source folder\n\nmissingFolders = \"\"\nfileName = Dir(sourceFolder &amp; \"*.xls\")\nWhile fileName &lt;&gt; vbNullString\n    **If Right(fileName, 4) = \".xlsx\" Then**\n        destinationFolder = Left(fileName, InStrRev(fileName, \".\") - 1)\n        foundDestinationFolder = Find_Subfolder(sourceFolder, destinationFolder)\n        If foundDestinationFolder &lt;&gt; \"\" Then\n            Name sourceFolder &amp; fileName As foundDestinationFolder &amp; fileName\n        Else\n            missingFolders = missingFolders &amp; vbCrLf &amp; destinationFolder\n        End If\n    End If\n    fileName = Dir\nWend\n\nIf missingFolders = \"\" Then\n    MsgBox \"All subfolders exist.  All files moved to their respective destination folder\"\nElse\n    MsgBox \"The following subfolders don't exist:\" &amp; vbCrLf &amp; _\n            missingFolders\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>After it identifies all that fit within that manager's name, I want to group only those manager's employee files into a folder with their name up until the first <code>_</code>.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 360, "user_id": 3368499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b423054f8db73de88e1c7643354f96b?s=128&d=identicon&r=PG&f=1", "display_name": "sten", "link": "https://stackoverflow.com/users/3368499/sten"}, "edited": false, "score": 0, "creation_date": 1545233082, "post_id": 53854202, "comment_id": 94556064, "body": "This will skip rows as the delete will move all the data up one reference. ie. you delete row 1, row 2 moves into row 1 but now you delete row 2, which holds the data that was in row 3... row 2 (now in row 1 is skipped)"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 360, "user_id": 3368499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b423054f8db73de88e1c7643354f96b?s=128&d=identicon&r=PG&f=1", "display_name": "sten", "link": "https://stackoverflow.com/users/3368499/sten"}, "edited": false, "score": 1, "creation_date": 1545236659, "post_id": 53854202, "comment_id": 94558458, "body": "@sten your are absolutely right, when clock is ticking mistakes happen. i correct the code using &quot;For each loop&quot; starting from the end."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1545236457, "last_edit_date": 1545236457, "creation_date": 1545232766, "answer_id": 53854202, "question_id": 53854093, "link": "https://stackoverflow.com/questions/53854093/removing-full-rows-when-only-cells-are-highlighted/53854202#53854202", "title": "Removing full rows when only cells are highlighted", "body": "<p>Change range and try:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim i As Long\n    Dim rng As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Set rng = .Range(\"A10:D20\")\n\n        For i = rng.Row + rng.Rows.Count - 1 To rng.Row Step -1\n           Rows(i).EntireRow.Delete\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 360, "user_id": 3368499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b423054f8db73de88e1c7643354f96b?s=128&d=identicon&r=PG&f=1", "display_name": "sten", "link": "https://stackoverflow.com/users/3368499/sten"}, "is_accepted": false, "score": 1, "last_activity_date": 1545233000, "creation_date": 1545233000, "answer_id": 53854274, "question_id": 53854093, "link": "https://stackoverflow.com/questions/53854093/removing-full-rows-when-only-cells-are-highlighted/53854274#53854274", "title": "Removing full rows when only cells are highlighted", "body": "<p>It is sufficient to use the default selector.</p>\n\n<pre><code>Selection.EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10194008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51dada257a13c622a5d241331a8774d1?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/10194008/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1545293840, "creation_date": 1545232384, "last_edit_date": 1545293840, "question_id": 53854093, "link": "https://stackoverflow.com/questions/53854093/removing-full-rows-when-only-cells-are-highlighted", "title": "Removing full rows when only cells are highlighted", "body": "<p>I've selected let say a box of 4 cells.</p>\n\n<p>How to remove full rows of that box of selected cells?</p>\n"}, {"tags": ["excel", "vba", "excel-2013"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1545230473, "post_id": 53853434, "comment_id": 94554412, "body": "Are you possibly looking for the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.activate(even)\" rel=\"nofollow noreferrer\">Workbook Activate</a> event?"}, {"owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545231682, "post_id": 53853434, "comment_id": 94555173, "body": "I&#39;d seen that and I don&#39;t think it&#39;s what I need.  That is telling the workbook to become active.  What I want is to do something once the active state is attained.  This state would be attained by the user actively clicking in this workbook."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545232061, "post_id": 53853434, "comment_id": 94555406, "body": "@Satkin2 That is not what it is, that is an <i>event</i>, which occurs whenever the workbook becomes active."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1545232076, "post_id": 53853434, "comment_id": 94555413, "body": "There&#39;s a difference between <code>Workbook.Activate</code> and the event mentioned. The <i>event</i> &quot;occurs when a workbook, worksheet, chart sheet, or embedded chart is activated.&quot;"}, {"owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "edited": false, "score": 0, "creation_date": 1545232773, "post_id": 53853434, "comment_id": 94555860, "body": "I see I misunderstood it.  Using the answer below has sorted it.  Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "edited": false, "score": 0, "creation_date": 1545232722, "post_id": 53854004, "comment_id": 94555825, "body": "Perfect, I wasn&#39;t aware of this.  Thank you."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 9, "last_activity_date": 1545232485, "last_edit_date": 1545232485, "creation_date": 1545232084, "answer_id": 53854004, "question_id": 53853434, "link": "https://stackoverflow.com/questions/53853434/perform-action-upon-workbook-being-reactivated/53854004#53854004", "title": "Perform action upon workbook being reactivated", "body": "<p>A <code>Worksheet</code> module such as, say, <code>Sheet1</code>, is a special type of class module that inherits members of the <code>Worksheet</code> class, and lets you readily handle events defined for a <code>Worksheet</code> object. At run-time, that <code>Sheet1</code> module represents a very specific <em>instance</em> of the <code>Worksheet</code> class - so any event handlers you implement in that module, are only ever invoked for events fired from <em>that</em> object.</p>\n\n<p>Thus, a <code>Worksheet_Activate</code> handler in the code-behind of <code>Sheet1</code> will only ever run when the <code>Sheet1</code> object fires its <code>Activate</code> event.</p>\n\n<p>If you don't care for any specific or particular worksheet, then you need to handle events at a different level: the <code>ThisWorkbook</code> module is a special type of class module that inherits the members of the <code>Workbook</code> class, and lets you readily handle events defined for a <code>Workbook</code> object. This workbook object always represents <em>the specific workbook that hosts the VBA project you're in</em>, and no other workbook.</p>\n\n<p>A <code>Workbook</code> object fires a <code>SheetActivate</code> event whenever <em>any sheet</em> (be it a <code>Worksheet</code>, a <code>Chart</code> sheet, or any other type of sheet) is activated - you get the activated sheet through the <code>Sh</code> parameter of the corresponding handler.</p>\n\n<p>A <code>Workbook</code> object also fires its own <code>Activate</code> event whenever it becomes the <code>ActiveWorkbook</code>.</p>\n\n<p>Looks like you want to handle a <code>Workbook</code> event. Experiment with the handlers you can get in the <code>ThisWorkbook</code> module, see what best fits your requirements.</p>\n\n<p>Select <code>Workbook</code> from the combobox at the top-left of the code pane in <code>ThisWorkbook</code>, then select an event from the right-hand side combobox, to get the VBE to automatically generate an event handler prototype with the correct signature:</p>\n\n<p><img src=\"https://i.stack.imgur.com/3B46n.png\" alt=\"ThisWorkbook code pane dropdowns\"></p>\n\n<p>If you need to handle <code>Application</code>-wide events, things get a little bit more involved, but the crux of it is that you need to have a class module (could be <code>ThisWorkbook</code>) that declares a <code>WithEvents</code> variable:</p>\n\n<pre><code>Private WithEvents App As Excel.Application\n</code></pre>\n\n<p>And now the top-left dropdown will list <code>App</code>, and when that's selected the top-right dropdown will let you pick an <code>Excel.Application</code> event to handle... provided that you <code>Set</code> this <code>App</code> object variable to a valid <code>Excel.Application</code> reference, say, in the <code>Workbook_Open</code> handler:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Set App = Me.Application\nEnd Sub\n</code></pre>\n\n<p>Now you can handle an event that's fired when <em>any</em> workbook is activated, for example.</p>\n"}], "owner": {"reputation": 191, "user_id": 1319354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22d74815527948914c7be146f337398c?s=128&d=identicon&r=PG", "display_name": "Satkin2", "link": "https://stackoverflow.com/users/1319354/satkin2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "accepted_answer_id": 53854004, "answer_count": 1, "score": 3, "last_activity_date": 1579186162, "creation_date": 1545230129, "last_edit_date": 1579186162, "question_id": 53853434, "link": "https://stackoverflow.com/questions/53853434/perform-action-upon-workbook-being-reactivated", "title": "Perform action upon workbook being reactivated", "body": "<p>I've got a workbook which has buttons which open other workbooks through VBA.</p>\n\n<p>My understanding is that this initial workbook (lets call it the Hub workbook), is both ThisWorkbook and ActiveWorkbook when I'm in it.</p>\n\n<p>Upon opening another workbook through one of the buttons, the newly opened workbook becomes ActiveWorkbook.</p>\n\n<p>When I click back on to Hub, it becomes ActiveWorkbook once again.</p>\n\n<p>I'd like to perform an action, only when Hub regains the status of being the active workbook.</p>\n\n<p>I've tried doing this by performing an action on the worksheet, but this doesn't perform if it's the only sheet and I just click back on it from another workbook.  It does if I have two worksheets for example and click back to this worksheet.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n MsgBox \"Worksheet Reactivated\"\nEnd Sub\n</code></pre>\n\n<p>I can't seem to get it working as I require, but I'm sure there must be some way of doing this.</p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "visual-studio", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10811017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1S6lET9iXU8/AAAAAAAAAAI/AAAAAAAAHuk/yfEjiY24LEg/photo.jpg?sz=128", "display_name": "Kevin Valerio", "link": "https://stackoverflow.com/users/10811017/kevin-valerio"}, "edited": false, "score": 0, "creation_date": 1545234613, "post_id": 53853586, "comment_id": 94557160, "body": "I added the code but it will still bug once about every 10-15 runs. It now highlights the;  .Value = Now   line of code"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1545230598, "creation_date": 1545230598, "answer_id": 53853586, "question_id": 53853326, "link": "https://stackoverflow.com/questions/53853326/runtime-50290-error-when-trying-to-enter-time-value-in-a-range/53853586#53853586", "title": "Runtime 50290 error When trying to enter Time value in a Range", "body": "<p>Try the below and provide feeback:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    With Sheets(\"RPRT\").Range(\"C5\").Offset(TargetRow - 1, 3)\n        .Value = Now 'Here check if the right cell get the right value\n        .NumberFormat = \"[$-x-systime]h:mm:ss AM/PM\"\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10811017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1S6lET9iXU8/AAAAAAAAAAI/AAAAAAAAHuk/yfEjiY24LEg/photo.jpg?sz=128", "display_name": "Kevin Valerio", "link": "https://stackoverflow.com/users/10811017/kevin-valerio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545307365, "creation_date": 1545229792, "last_edit_date": 1545307365, "question_id": 53853326, "link": "https://stackoverflow.com/questions/53853326/runtime-50290-error-when-trying-to-enter-time-value-in-a-range", "title": "Runtime 50290 error When trying to enter Time value in a Range", "body": "<p>I am building a userform to track the time it takes to do something and compare that to how long it should have taken.</p>\n\n<p>My code runs most of the time but once in a while I will encounter a Runtime 50290 error when trying to enter a time value in a range.</p>\n\n<pre><code>Dim TargetRow As Integer\nTargetRow = Sheets(\"Engine\").Range(\"B3\").Value + 1 'engine B3 is current amount of entries in form  \n\nDim TargetRow2 As Integer\n    TargetRow2 = Sheets(\"Engine\").Range(\"I3\").Value + 1\n\ntxt_Material1.Value = Sheets(\"RPRT\").Range(\"C5\").Offset(TargetRow - 1, 0).Value\ntxt_Hose1.Value = Sheets(\"RPRT\").Range(\"C5\").Offset(TargetRow - 1, 1).Value\ntxt_Quantity1.Value = Sheets(\"RPRT\").Range(\"C5\").Offset(TargetRow - 1, 2).Value\n\n'Runtime 50290 error occurs at line of code below\nSheets(\"RPRT\").Range(\"C5\").Offset(TargetRow - 1, 3).Value = \"'\" &amp; Format(Now, \"hh:mm:ss\")\n\nlbl_PlanTime = Format(Sheets(\"RPRT\").Range(\"C5\").Offset(TargetRow - 1, 6).Value, \"hh:mm:ss\")\nlbl_Timer = \"00:00:00\"\ntimer = True\n\nDo While timer 'allows the timer to start counting\n    Application.Wait (Now + #12:00:01 AM#)\n    DoEvents\n    lbl_Timer = Format(DateAdd(\"s\", 1, lbl_Timer), \"hh:mm:ss\")\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1545233877, "post_id": 53853050, "comment_id": 94556623, "body": "The Answer in this discussion should help. Read the description about using Find on cell-by-cell basis in the table. <a href=\"https://stackoverflow.com/questions/51925805/vba-how-to-start-a-selection-halfway-through-the-text-in-a-table/51932924#51932924\" title=\"vba how to start a selection halfway through the text in a table\">stackoverflow.com/questions/51925805/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "is_accepted": true, "score": 0, "last_activity_date": 1545394427, "last_edit_date": 1545394427, "creation_date": 1545300842, "answer_id": 53866569, "question_id": 53853050, "link": "https://stackoverflow.com/questions/53853050/how-to-find-a-word-in-a-document-from-the-current-selection-onwards/53866569#53866569", "title": "How to find a word in a document from the current selection onwards", "body": "<p>By searching the whole document (or specified range) and storing the locations of each instance in an array, you can then compare those locations to the current selection and select the instance after the current selection.</p>\n\n<pre><code>Function search()\n\nDim list() As String\nDim Wrd As String\nDim k As Integer\nDim Nfound As Boolean\n\nDim Def As String\nDim location() As String\n\n'Search document and get locations of each instance of a word\n\nWrd = \"ABC\" 'Get next word from list\nDef = \"Alphabet\"\nk = 1\n\nDim DocRng\nSet DocRng = ActiveDocument.Content 'search whole document\n\nWith DocRng.find\n     .Text = Wrd\n     .MatchCase = True\n\n    Do While .Execute 'For each entry found, store start and end to array\n        ReDim Preserve location(2, k)\n        location(1, k) = DocRng.Start\n        location(2, k) = DocRng.End\n        k = k + 1\n    Loop\n\nEnd With\n\n'Compare the found locations against the current selection and select the first instance after current selection\n\nNfound = True 'Set as not found until it is found\n\n    j = Selection.End 'mark current cursor location\n\n    For k = 1 To UBound(location, 2)\n        If location(1, k) &gt; j + Len(Def) Then '+ Len(Def) accounts for changes to text\n            ActiveDocument.Range(Start:=location(1, k), End:=location(2, k)).Select\n            Nfound = False\n            Exit For\n        End If\n    Next\n\n    If Nfound Then 'if not found got to first instance found\n        k = 1\n        ActiveDocument.Range(Start:=location(1, k), End:=location(2, k)).Select\n    End If\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "edited": false, "score": 0, "creation_date": 1545320215, "post_id": 53869596, "comment_id": 94590593, "body": "Thanks, but the userform I&#39;m currently using has 5 buttons (may end up with more), and I&#39;m also running it modeless to let the user manually edit it in place. Which as far as I know can&#39;t be done with a message box."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "edited": false, "score": 0, "creation_date": 1545346100, "post_id": 53869596, "comment_id": 94601495, "body": "@Kagekiba Did you try it? In any event, you could modify the code so all the inputs &amp; responses are done from the userform. What I posted is a &#39;proof of concept&#39;, not a complete solution - especially as you haven&#39;t supplied anywhere enough detail for that."}, {"owner": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "edited": false, "score": 0, "creation_date": 1545388775, "post_id": 53869596, "comment_id": 94613044, "body": "I did try it, including with a userform instead of a message box, but it won&#39;t let me run it modeless (which I forgot to mention in the question before) without running all the way through to the last instance. The code works great for what it does, but I was after a way to find the next instance after the current selection and doesn&#39;t require for it to be run all the way through. My code is currently around 2000 lines over half of which is runs on the found word, so I had to simplfy it a lot to be able to post it but it is a lot simpler for my code to run this section inside the userform."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "edited": false, "score": 0, "creation_date": 1545434222, "post_id": 53869596, "comment_id": 94630392, "body": "@Kagekiba There is nothing about the concept behind the code I posted that prevents its use in a modeless userform; you just need to design the userform appropriately and replace the input box &amp; message box references in the code I posted with the relevant userform control references."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 1, "last_activity_date": 1545312086, "creation_date": 1545312086, "answer_id": 53869596, "question_id": 53853050, "link": "https://stackoverflow.com/questions/53853050/how-to-find-a-word-in-a-document-from-the-current-selection-onwards/53869596#53869596", "title": "How to find a word in a document from the current selection onwards", "body": "<p>You can run other code within a Find/Replace loop, using code like:</p>\n\n<pre><code>Sub Demo()\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = InputBox(\"What is the Text to Find\")\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchCase = True\n    .MatchWholeWord = True\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .Execute\n  End With\n  Do While .Find.Found\n    .Select\n    Select Case MsgBox(\"Replace this one?\", vbYesNoCancel)\n      Case vbCancel: Exit Sub\n      Case vbYes: .Text = InputBox(\"Replacement text\")\n      Case Else\n    End Select\n    .Collapse wdCollapseEnd\n    .Find.Execute\n  Loop\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Such code is unaffected by tables.</p>\n"}], "owner": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 53866569, "answer_count": 2, "score": 0, "last_activity_date": 1545394427, "creation_date": 1545228739, "last_edit_date": 1545387955, "question_id": 53853050, "link": "https://stackoverflow.com/questions/53853050/how-to-find-a-word-in-a-document-from-the-current-selection-onwards", "title": "How to find a word in a document from the current selection onwards", "body": "<p>I have an extract of code that searches for a word in a document from the current selection to the end. The intention of this is so the next time it's run it will find the next instance and so on. </p>\n\n<p>It works fine until it finds a word within a table, at which point it won't find anything after that entry. I need to be able to find words in tables as well as text. It also runs as a function in a userform (running modeless), waiting for user input then providing different words, looping and performing actions depending on user input. So I don't believe I can run my other code within the find section (although I'm happy to be corrected).</p>\n\n<pre><code>Sub test1()\n\nDim list() As String\nDim wrd As String\nDim mrk As Integer\n\nwrd = \"ABC\" 'Get next word from list\n\n'set range to search as from current selection (previously found) to end of document\nDim DocRng\nSet DocRng = ActiveDocument.Range(Start:=Selection.End, End:=ActiveDocument.Content.End)\n\nmrk = Selection.End 'Mark end of previously found instance (current selection)\n\nWith DocRng.Find 'Find next instance of word and select it\n     .Text = wrd\n     .MatchCase = True\n     .Forward = True\n     .Execute\n     DocRng.Select\nEnd With\n\nIf Selection.End = mrk Then 'If selection hasn't changed inform user and go to start of document\n    MsgBox (\"Reached end of document.\")\n    Selection.GoTo What:=wdGoToLine, Which:=wdGoToAbsolute, Count:=0\nEnd If\n\ntmp = Selection.Text 'Save currently selected text\n\nEnd Sub\n</code></pre>\n\n<p>How do I get it to find entries past the table?</p>\n"}, {"tags": [".net", "vba", "vb.net", "dll", "activex"], "comments": [{"owner": {"reputation": 2362, "user_id": 2016162, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/yLfkw.jpg?s=128&g=1", "display_name": "Popo", "link": "https://stackoverflow.com/users/2016162/popo"}, "edited": false, "score": 0, "creation_date": 1545268456, "post_id": 53852966, "comment_id": 94570490, "body": "if the application referencing the dll is a lower version of .net that would be an issue. not sure if that is your case or not."}, {"owner": {"reputation": 80, "user_id": 10803269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be9c91ef9fc014cb4418e1209607922e?s=128&d=identicon&r=PG&f=1", "display_name": "Orion DeYoe", "link": "https://stackoverflow.com/users/10803269/orion-deyoe"}, "reply_to_user": {"reputation": 2362, "user_id": 2016162, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/yLfkw.jpg?s=128&g=1", "display_name": "Popo", "link": "https://stackoverflow.com/users/2016162/popo"}, "edited": false, "score": 0, "creation_date": 1545318972, "post_id": 53852966, "comment_id": 94589886, "body": "The application referencing the DLL is a VBA macro in CorelDRAW 2017."}, {"owner": {"reputation": 91, "user_id": 8646060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba9b021d38283607f4b5757d36bbcaa?s=128&d=identicon&r=PG", "display_name": "Michael Gordon", "link": "https://stackoverflow.com/users/8646060/michael-gordon"}, "edited": false, "score": 0, "creation_date": 1570760819, "post_id": 53852966, "comment_id": 103024308, "body": "I&#39;m experiencing this same problem, has anyone found a solution to this?"}, {"owner": {"reputation": 80, "user_id": 10803269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be9c91ef9fc014cb4418e1209607922e?s=128&d=identicon&r=PG&f=1", "display_name": "Orion DeYoe", "link": "https://stackoverflow.com/users/10803269/orion-deyoe"}, "reply_to_user": {"reputation": 91, "user_id": 8646060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba9b021d38283607f4b5757d36bbcaa?s=128&d=identicon&r=PG", "display_name": "Michael Gordon", "link": "https://stackoverflow.com/users/8646060/michael-gordon"}, "edited": false, "score": 0, "creation_date": 1570849511, "post_id": 53852966, "comment_id": 103055606, "body": "@MichaelGordon I never got an answer to this question.  I ended up having to pursue a completely different approach to my application."}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 8646060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba9b021d38283607f4b5757d36bbcaa?s=128&d=identicon&r=PG", "display_name": "Michael Gordon", "link": "https://stackoverflow.com/users/8646060/michael-gordon"}, "is_accepted": false, "score": 1, "last_activity_date": 1571028060, "creation_date": 1571028060, "answer_id": 58370192, "question_id": 53852966, "link": "https://stackoverflow.com/questions/53852966/vb-net-dll-activex-component-cant-create-object/58370192#58370192", "title": "VB.NET DLL &quot;ActiveX component can&#39;t create object&quot;", "body": "<p>Not sure if my problem is the same as your problem but this is how I fixed my problem:</p>\n\n<p>I think the key issue with what I was doing is I was registering the dll with:</p>\n\n<p>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe</p>\n\n<p>When I should have been registering it with:</p>\n\n<p>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\RegAsm.exe</p>\n\n<p>Other than that I followed this StackOverflow Q/A:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2724387/excel-2010-64-bit-cant-create-net-object\">Excel 2010 64 bit can&#39;t create .net object</a></p>\n"}], "owner": {"reputation": 80, "user_id": 10803269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be9c91ef9fc014cb4418e1209607922e?s=128&d=identicon&r=PG&f=1", "display_name": "Orion DeYoe", "link": "https://stackoverflow.com/users/10803269/orion-deyoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571028060, "creation_date": 1545228477, "question_id": 53852966, "link": "https://stackoverflow.com/questions/53852966/vb-net-dll-activex-component-cant-create-object", "title": "VB.NET DLL &quot;ActiveX component can&#39;t create object&quot;", "body": "<p>I am attempting to create a DLL in VB.NET using Visual Studio 2017.  The DLL will be used in VBA in another application.  The VB.NET project is a .NET Framework Class Library project.</p>\n\n<p>I've added the *.TLB file as a reference in VBA.  I'm only trying to create and use one method in the class library.  I'm calling it in VBA using something similar to the following:</p>\n\n<pre><code>Sub MySub()\n    Dim TestObj As MyProjectName.MyClassName\n    Set TestObj = New MyProjectName.MyClassName\n    Call TestObj.MyMethodName(Argument)\nEnd Sub\n</code></pre>\n\n<p>The code always throws Runtime Error 429 \"ActiveX component can't create object\" on the following line (from the example above):</p>\n\n<pre><code>Set TestObj = New MyProjectName.MyClassName\n</code></pre>\n\n<p>This question has been asked before, however most of them are quite old (~10 years) and none of the solutions offered made any difference.  I keep finding references to REGASM.EXE.  It is my understanding that Visual Studio handles this automatically and that calling this manually isn't necessary when the \"Project>Properties>Compile>Register for COM interop\" checkbox is checked.</p>\n\n<p>I have followed these instructions to the letter:  <a href=\"https://smallbusiness.chron.com/use-net-class-library-excel-vba-40349.html\" rel=\"nofollow noreferrer\">https://smallbusiness.chron.com/use-net-class-library-excel-vba-40349.html</a></p>\n\n<p>In addition I tried creating a COM class instead per the answer to the following question:  <a href=\"https://stackoverflow.com/questions/38534316/activex-component-cant-create-object-when-using-net-class-in-vba\">ActiveX component can&#39;t create object when using .net class in vba</a></p>\n\n<p>I've tried at least half a dozen different iterations of this and they all give Runtime Error 429 \"ActiveX component can't create object\".  Is there something I'm missing here?  Could it be a version issue somehow?  My VS project is targeting .NET Framework 4.7.2.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545228380, "post_id": 53852860, "comment_id": 94553201, "body": "Have you stepped through the code or inserted a breakpoint to try to see what&#39;s going on?"}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545228992, "post_id": 53852860, "comment_id": 94553569, "body": "I did originally; however, Monday night there was a power outage here, and since then, it has not been working.  Since I am a complete novice in VBA, I am wondering if maybe there is an issue with the placement of the <code>next</code> for the first <code>For</code> statement.  Edit for mor info: When my computer came back up, I had to reset it, and I rewrote this rule by copying and pasting my code from a previous question, and implementing a solution given to me on that question.  I had to modify the fix a little bit because it kept telling me <code>subscript out of range</code> for the <code>JobCity=varAddress(1)</code> line."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545229552, "post_id": 53852860, "comment_id": 94553875, "body": "What is the value of <code>sFileName</code> for these attachments? Looks like it will be the same."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545230023, "post_id": 53852860, "comment_id": 94554151, "body": "Your <i>office area</i> part of the code could be written using a <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/select-case-statement\" rel=\"nofollow noreferrer\">Select....Case</a> statement which would make it easier to read and add to."}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545230281, "post_id": 53852860, "comment_id": 94554303, "body": "@SJR Added more details to help answer. @DarrenBartrup-Cook I will look into that in the future, but for now, I am going to stick with what I have just because I know how <code>if</code> statements work; thank you for the info!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545230410, "post_id": 53852860, "comment_id": 94554379, "body": "I <i>think</i> this is a missing <code>Option Explicit</code> problem.   Your attachments are <code>itm.Attachments</code> but you <code>Set myitem = myfolder.Items(i)</code> and <code>itm</code> isn&#39;t defined anywhere.  Without <code>Option Explicit</code> it just creates the variable as needed - with <code>Option Explicit</code> it would&#39;ve shouted &quot;where&#39;s that variable come from?&quot;  <b>Scratch that maybe</b> - it&#39;s passed as an argument."}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545230918, "post_id": 53852860, "comment_id": 94554720, "body": "@DarrenBartrup-Cook would that be the case for the code here:    <a href=\"https://stackoverflow.com/questions/24244636/vba-outlook-rename-attachments-and-save-to-folder\" title=\"vba outlook rename attachments and save to folder\">stackoverflow.com/questions/24244636/&hellip;</a>    that is where I got this code, and I just adapted it to fit my needs."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545231058, "post_id": 53852860, "comment_id": 94554808, "body": "No, I can&#39;t see a problem with that code."}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545232055, "post_id": 53852860, "comment_id": 94555399, "body": "Ok, that confuses me more then since I&#39;m not sure how using <code>itm</code> in my code the same way it&#39;s used in that code causes an issue in mine, but not the other.  Both have <code>itm As Outlook.MailItem</code> and then have <code>For Each objAtt In itm.Attachments</code>.  Can you explain how it causes a problem in mine and not in the one I adapted?  I&#39;m guessing my limited knowledge doesn&#39;t allow me to understand how my adapting that code changed what needed to be done."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545232587, "post_id": 53852860, "comment_id": 94555713, "body": "I&#39;ll try - <code>itm</code> is an email that is passed to the <code>SaveEagleView</code> procedure.  I&#39;m guessing it&#39;s passed as part of a <code>ItemAdd</code> event (a procedure watching certain folders for any emails to be added to it).  You also have <code>myitem</code> which appears to pull each email from the currently selected folder.  You seem to pull <code>JobCity</code> from the <code>myitem</code> emails.  The attachments are taken from <code>itm</code>.  I guess I don&#39;t see where the two emails match up - one that is passed to the procedure, and the one(s) taken from the selected folder."}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545233956, "post_id": 53852860, "comment_id": 94556688, "body": "If I&#39;m understanding what you&#39;re saying, a fix would be for me to find a way to rewrite my <code>For</code> statements so both the JobCity and attachments are pulling from the same email"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545234547, "post_id": 53852860, "comment_id": 94557111, "body": "I think so - hard to tell without seeing the emails.  I take it the attachments and address text are in the same email (in which case yes - pull both from same email).  How is <code>itm</code> passed to the procedure?  Also - if use @Darren in your text I&#39;ll get a notification when you comment back. :)"}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545235073, "post_id": 53852860, "comment_id": 94557476, "body": "@DarrenBartrup-Cook Yes, the address text and the attachment are in the same email.  I have a rule setup to recognize when these emails come in, move it to the appropriate folder for that vendor, print the email body (this will be the next step in this process is to save the email body, but it&#39;s more important to save the attachments at this juncture), and then it runs this macro to rename and save the attachment.  Eventually this macro will send an email to notify the person who needs to upload the attachments to our CRM that there is a new one.  Hopefully this answers how <code>itm</code> is passed."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545239604, "post_id": 53855259, "comment_id": 94560068, "body": "Thank you! This does not seem to be working entirely.  It doesn&#39;t save the items.  It creates the folder path; however, nothing is getting saved.  I did add the Orlando one to the <code>select case</code> because there are other cities that will fall under that area office.  The <code>JobArea = JobCity</code> is meant as a catch for any cities that have not yet been assigned to an area office."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545240023, "post_id": 53855259, "comment_id": 94560311, "body": "Check this line:  <code>objAtt.SaveAsFile Save_Folder &amp; sFileName &amp; &quot;.pdf&quot;</code>.  Also in the <code>Locals</code> window (<code>View</code> ~ <code>Locals</code>) check that the <code>objAtt</code> variable is actually holding a reference to a PDF file.  In the <code>Immediate</code> window type <code>?Save_Folder &amp; sFileName &amp; &quot;.pdf&quot;</code> and check that it returns a valid file path &amp; name."}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545241740, "post_id": 53855259, "comment_id": 94561138, "body": "Typing <code>?Save_Folder &amp; sFileName &amp; &quot;.pdf&quot;</code> only returns <code>.pdf</code> Nothing shows in the <code>Locals</code> window."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545263012, "post_id": 53855259, "comment_id": 94569346, "body": "Sorry, I should&#39;ve said put a breakpoint on that line by clicking in the left border. The code will pause there, then do it"}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545317594, "post_id": 53855259, "comment_id": 94589119, "body": "When I press <code>F5</code> to run it, it just brings up the Macros box with none of my macros listed.  Also, after doing the breakpoint, it still only returns <code>.pdf</code> and nothing shows in the Locals window."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545318066, "post_id": 53855259, "comment_id": 94589412, "body": "<code>F5</code> won&#39;t run it as it needs to have <code>itm</code> sent to it.  In Outlook I generally find it easier to actually fire the event by sending an email.  Did the breakpoint definitely go in - the line of code should have been highlighted with a dark red (brown?) colour when you click in the border, when executed the code will stop on that line which will then be highlighted in yellow - <a href=\"https://www.thespreadsheetguru.com/blog/2014/4/8/debugging-vba-code-adding-breakpoints\" rel=\"nofollow noreferrer\">Debugging VBA Code: Adding Breakpoints</a>"}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545319329, "post_id": 53855259, "comment_id": 94590054, "body": "Ok, when an email comes in and runs the script, I get a <code>Run-time error 5</code> <code>Invalid procedure call or argument</code> and it highlights <code>If itm.Attachments  &gt; 0 Then</code>and <code>objAtt</code> value is <code>Nothing</code> in the <code>Locals</code> window."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545319791, "post_id": 53855259, "comment_id": 94590343, "body": "That sounds like <code>itm</code> isn&#39;t an email so it&#39;s can&#39;t find the attachment.  Could you post (in your original question) the code that calls the <code>SaveEagleView</code> procedure."}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545320199, "post_id": 53855259, "comment_id": 94590590, "body": "I&#39;m not sure I understand what you&#39;re asking for, the <code>SaveEagleView</code> procedure is run as part of a <code>run script</code> in a rule I have created.  If you&#39;d like, I can post the rule conditions that filter out the emails the rule applies to and what the rule does."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545320966, "post_id": 53855259, "comment_id": 94591023, "body": "Yes please - I&#39;ve not run a script from a rule before.  I usually add a rule to move an email to a particular folder and then use an event to watch that folder.  Could you post the script it runs as well?"}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545321638, "post_id": 53855259, "comment_id": 94591388, "body": "Ok, I added that info, hopefully it will help."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545323344, "post_id": 53855259, "comment_id": 94592276, "body": "Now I&#39;m really confused.  In rules when I select <i>run a script</i> the only procedures it will let me choose from are ones that have no arguments to pass - so I could select the <code>Sub Test1()</code> procedure, but not <code>Sub Test(itm As MailItem)</code> procedure.  How did you get it to allow <code>SaveEagleView</code>?"}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1545329600, "post_id": 53855259, "comment_id": 94595224, "body": "I&#39;m not entirely sure.  I don&#39;t remember, but I think what I did was wrote what I thought would work, and then when it didn&#39;t I edited the macro while it was still saved to the rule."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1545383321, "last_edit_date": 1545383321, "creation_date": 1545236444, "answer_id": 53855259, "question_id": 53852860, "link": "https://stackoverflow.com/questions/53852860/macro-saves-same-file-with-different-names-instead-of-each-file/53855259#53855259", "title": "Macro saves same file with different names instead of each file", "body": "<p>I haven't tested this code, it's a cut-down version so all it's doing is saving the file, and I'm assuming the email is being passed to the procedure correctly.  </p>\n\n<p>The first problem I can see is if an email contains more than one PDF attachment - it will save both in the same folder with same name (so the first will get overwritten).</p>\n\n<pre><code>Sub SaveEagleView(itm As MailItem)\n\n    Const SAVE_PATH As String = \"C:\\Users\\admin\\OneDrive\\Documents\\EagleView\\\"\n\n    Dim msgText As String\n    Dim delimitedMessage As String\n    Dim varAddress As Variant\n    Dim sFileName As String\n    Dim JobCity As String\n    Dim JobArea As String\n    Dim objAtt As Attachment\n    Dim NextFriday As String\n    Dim Save_Folder As String\n\n    NextFriday = Format(Date + 8 - Weekday(Date, vbFriday), \"yyyy-mm-dd\")\n\n    msgText = itm.Body\n    delimitedMessage = Right$(msgText, Len(msgText) - InStr(1, msgText, \"Address: \") - 8)\n    varAddress = Split(delimitedMessage, \",\")\n    sFileName = varAddress(0)\n    JobCity = Trim(varAddress(1)) 'TRIM does both LTRIM &amp; RTRIM.\n\n    Select Case JobCity\n        Case \"Panama City\", \"Mexico Beach\", \"Panama City Beach\", \"Lynn Haven\", \"Port Saint Joe\"\n            JobArea = \"Panama\"\n        Case \"Daytona Beach\", \"Port Orange\", \"Deltona\", \"Ormand Beach\", \"Deland\"\n            JobArea = \"Daytona\"\n        Case \"Jacksonville\", \"Jacksonville Beach\"\n            JobArea = \"Jacksonville\"\n        Case Else\n            JobArea = JobCity 'Orlando would fall in here to.\n    End Select\n\n    Save_Folder = SAVE_PATH &amp; NextFriday &amp; \"\\\" &amp; JobArea &amp; \"\\\"\n    If Len(Dir(Save_Folder)) = 0 Then\n        MkDir Save_Folder\n    End If\n\n    If itm.Attachments &gt; 0 Then\n        For Each objAtt In itm.Attachments\n            If GetExt(objAtt.FileName) = \"PDF\" Then\n                objAtt.SaveAsFile Save_Folder &amp; sFileName &amp; \".pdf\"\n            End If\n        Next objAtt\n    End If\n\nEnd Sub\n\nPublic Function GetExt(FileName As String) As String\n    Dim oFSO As Object\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    GetExt = oFSO.GetExtensionName(FileName)\n    Set oFSO = Nothing\nEnd Function  \n</code></pre>\n\n<p><strong>Also very important -</strong> </p>\n\n<ul>\n<li>Select <code>Tools</code> ~ <code>Options</code>  </li>\n<li>In the <code>Editor</code> tab check <code>Require Variable Declaration</code>.  </li>\n</ul>\n\n<p>This will place <code>Option Explicit</code> at the top of each new module and force you to declare each variable before use.  </p>\n\n<p>You had 6 non-declared variables in your code.  Misspelling a variable would cause a new one to be created and the old one to retain an old or no value - causing mayhem further down the line possibly with no error message.  </p>\n\n<p><strong>Edit:</strong><br>\nI'm not sure how you're getting the script to run with a rule as it has an argument passed to it.<br>\nThe way I would do it is to watch a folder and run the script whenever an email is moved to that folder (either manually moved or by a rule).  </p>\n\n<p>Add this code to <code>ThisOutlookSession</code> and it will call the <code>SaveEagleView</code> procedure, passing it the email that was moved to the folder.<br>\nYou may have to change <code>MailItem</code> in the <code>SaveEagleView</code> procedure name to <code>Object</code>.<br>\nThe first line must be at the very top of the module - before any procedures.</p>\n\n<pre><code>Dim WithEvents EagleView As Items\n\nPrivate Sub Application_Startup()\n\n    Dim ns As Outlook.NameSpace\n\n    Set ns = Application.GetNamespace(\"MAPI\")\n\n    'Rename to correct account/folder.\n    With ns.Folders.Item(\"EagleView\").Folders.Item(\"Inbox\")\n        Set EagleView = .Folders.Item(\"EagleView\").Items\n    End With\n\nEnd Sub\n\nPrivate Sub EagleView_ItemAdd(ByVal Item As Object)\n    SaveEagleView Item\nEnd Sub\n\nPrivate Sub Application_Quit()\n\n    Set EagleView = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545383321, "creation_date": 1545228166, "last_edit_date": 1545321560, "question_id": 53852860, "link": "https://stackoverflow.com/questions/53852860/macro-saves-same-file-with-different-names-instead-of-each-file", "title": "Macro saves same file with different names instead of each file", "body": "<p>So, I have a macro that creates a directory, renames the attachment and saves it running on a rule as messages come into outlook.  The problem is if 3 emails come in with addresses of </p>\n\n<blockquote>\n  <p>123 main st, city 1<br>\n  456 main st, city 2<br>\n  789 main st city 3</p>\n</blockquote>\n\n<p>It will save them in the appropriate folders, and it will name the file appropriately based on the address, but when you go into the files, all of them have the same information, so it is saving the attachment for the address of <code>456 main st</code> as all 3 file names.</p>\n\n<p>Here is my code: </p>\n\n<pre><code>Private Function CreateDir(FldrPath As String)\n    Dim Elm As Variant\n    Dim CheckPath As String\n\n    CheckPath = \"\"\n    For Each Elm In Split(FldrPath, \"\\\")\n        CheckPath = CheckPath &amp; Elm &amp; \"\\\"\n\n        If Len(Dir(CheckPath, vbDirectory)) = 0 Then\n            MkDir CheckPath\n            Debug.Print CheckPath &amp; \" Folder Created\"\n        End If\n\n        Debug.Print CheckPath &amp; \" Folder Exist\"\n    Next\nEnd Function\n\nSub SaveEagleView(itm As Outlook.MailItem)\n    Dim strSubject As String, strExt As String\n    Dim objAtt As Outlook.Attachment\n    Dim saveFolder As String\n    Dim NextFriday As Date\n    Dim sFileName As String\n    Dim varAddress As Variant\n    Dim City As Variant\n    Dim fdObj As Object\n    Dim JobArea As String\n    Dim JobCity As Variant\n    Dim myPath As String\n    Dim myFinalPath As String\n    Dim objMsg As MailItem\n    Dim sFileExt As String\n\n    Set objMsg = Application.CreateItem(olMailItem)\n\n    Dim enviro As String\n    NextFriday = Date + 8 - Weekday(Date, vbFriday)\n    Set myfolder = Outlook.ActiveExplorer.CurrentFolder\n    Set fdObj = CreateObject(\"Scripting.FileSystemObject\")\n\n    'Loop through emails in folder\n    For i = 1 To myfolder.Items.Count\n        Set myitem = myfolder.Items(i)\n        msgtext = myitem.Body\n\n        'Search for Specific Text\n        delimitedMessage = Right$(msgtext, Len(msgtext) - InStr(1, msgtext, \"Address: \") - 8)\n        varAddress = Split(delimitedMessage, \",\")\n\n        'Assign the job address from email to variable\n        sFileName = varAddress(0)\n        JobCity = RTrim(LTrim(varAddress(1)))\n\n\n        'Define office area based on job city\n\n        If JobCity = \"Panama City\" Or JobCity = \"Mexico Beach\" Or JobCity = \"Panama City Beach\" Or JobCity = \"Lynn Haven\" Or JobCity = \"Port Saint Joe\" Then\n            JobArea = \"Panama\"\n        ElseIf JobCity = \"Daytona Beach\" Or JobCity = \"Port Orange\" Or JobCity = \"Deltona\" Or JobCity = \"Ormond Beach\" Or JobCity = \"Deland\" Then\n            JobArea = \"Daytona\"\n        ElseIf JobCity = \"Orlando\" Then\n            JobArea = \"Orlando\"\n        ElseIf JobCity = \"Jacksonville\" Or JobCity = \"Jacksonville Beach\" Then\n            JobArea = \"Jacksonville\"\n        Else\n            JobArea = JobCity\n        End If\n\n        For Each objAtt In itm.Attachments\n            saveFolder = \"C:\\Users\\admin\\OneDrive\\Documents\\EagleView\\\" &amp; Format$(NextFriday, \"yyyy-mm-dd\") &amp; \"\\\" &amp; JobArea &amp; \"\\\"\n\n            CreateDir saveFolder\n            If Right(objAtt.FileName, 3) = \"PDF\" Then\n                sFileExt = \".pdf\"\n                File = saveFolder &amp; sFileName &amp; sFileExt\n                objAtt.SaveAsFile File\n            End If\n\n            '            With objMsg\n            '               .To = \"Careers@Email.com\"\n            '              .CC = \"CustomerService@Email.com\"\n            '             .Subject = \"New EagleView Needs Uploaded\"\n            '            .BodyFormat = olFormatPlain\n            '           .Body = \"A new EagleView has been received for the \" &amp; JobArea &amp; \" office. The file name is \" &amp; sFileName &amp; \" and needs to be uploaded. Thanks!\"\n            '          .Send\n            '     End With\n\n            '    Set objMsg = Nothing\n\n        Next\n    Next\n\n    Set objAtt = Nothing\nEnd Sub\n</code></pre>\n\n<p>The code to create the email is commented out because it's not working, but I'd rather make sure the file saving is working correctly before moving forward with trying to get that working.</p>\n\n<p>Thanks for all your help in advance!</p>\n\n<p>Edited to provide more info:</p>\n\n<p>So, the emails will have this in the body:</p>\n\n<blockquote>\n  <p>\u2022 Address: 123 main St, City, State 12345-1234</p>\n</blockquote>\n\n<p>The way the code is written should, and seems to, it should loop through the emails the rule applies to, and extract the street address and apply that value to the <code>sFileName</code>, and this part works properly as it loops through, and gets the correct file name for each email that comes through; however, it is just applying that name to the same file over and over again.</p>\n\n<p>The rule that runs says</p>\n\n<blockquote>\n  <p>Apply this rule after the message arrives<br>\n     from admin@email.com<br>\n     and with EagleView in the subject<br>\n     and with $ in the body<br>\n     and on this computer only<br>\n  move it to<br>\n  and run <code>Project1.SaveEagleView</code></p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "crop", "powerpoint", "shapes"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9288152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f7a2bbb1ad6b159a4bd734f5c0bbc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Bandita", "link": "https://stackoverflow.com/users/9288152/bandita"}, "edited": false, "score": 0, "creation_date": 1547035841, "post_id": 53888225, "comment_id": 95051766, "body": "Thanks for confirming what I have been suspecting after a few hours of browsing the internet for such a problem. Though I was under the impression that only the zoom factor of the sheet, on which the original object sits, is causing the problem. Is there some clean way of having the zoom factor set to not change? Because I believe the change of the objects happens even if the users don&#39;t change the zoom factor in Excel before running the code."}], "tags": [], "owner": {"reputation": 437, "user_id": 9175363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bcd92ae3d11917a924113334a96b73?s=128&d=identicon&r=PG", "display_name": "areed1192", "link": "https://stackoverflow.com/users/9175363/areed1192"}, "is_accepted": false, "score": 0, "last_activity_date": 1545410646, "creation_date": 1545410646, "answer_id": 53888225, "question_id": 53852415, "link": "https://stackoverflow.com/questions/53852415/vba-crops-shapes-oleobjects-and-charts-involuntarily/53888225#53888225", "title": "VBA crops shapes (OLEobjects and Charts) involuntarily", "body": "<p>I had this problem before and from what I learned it appears when you change the zoom factor on your Excel workbook. When you paste the object and link it, the zoom factor that it was at is carried over with the link. If you change the zoom factor in your Excel workbook, so you go from 100% to 150%, it will carry over the new zoom factor when you update the link.</p>\n\n<p><strong><em>The only real solution is to make sure that people don't change the zoom factor on the Excel workbook.</em></strong></p>\n"}], "owner": {"reputation": 1, "user_id": 9288152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f7a2bbb1ad6b159a4bd734f5c0bbc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Bandita", "link": "https://stackoverflow.com/users/9288152/bandita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545410646, "creation_date": 1545226588, "question_id": 53852415, "link": "https://stackoverflow.com/questions/53852415/vba-crops-shapes-oleobjects-and-charts-involuntarily", "title": "VBA crops shapes (OLEobjects and Charts) involuntarily", "body": "<p>I have been experiencing the following problem.</p>\n\n<p>I use a VBA to update Powerpoint deck with user-selected information. Users choose selected data, refresh the appropriate tables/graphs and these are then updated in the Powerpoint. Some of the users are experiencing an issue, where the deck is updated, but the OLEobjects (charts, Excel tables) are cropped.</p>\n\n<p>I have been using the following code to store the size and positions of the updated shapes. It works for majority of users, but in a few cases it seems like the program is resizing the objects, but stores them in predefined placeholders, so they are positioned correctly on the slides, but are cropped (like they are zoomed by about 10 to 20 percent).</p>\n\n<p>Any help here is appreciated.</p>\n\n<pre><code> For Each aSlide In pptPresentation.Slides\n        For Each aShape In aSlide.Shapes\n            With aShape\n                .LockAspectRatio = msoTrue\n                .Tags.Add Name:=\"L\", Value:=CStr(.Left)\n                .Tags.Add Name:=\"T\", Value:=CStr(.Top)\n                .Tags.Add Name:=\"H\", Value:=CStr(.Height)\n                .Tags.Add Name:=\"W\", Value:=CStr(.Width)\n            End With\n        Next\n    Next        \n\n'Update slides in PowerPoint Presentation with new content\nFor Each aSlide In pptPresentation.Slides\n    For Each aShape In aSlide.Shapes\n        If (aShape.Type = msoLinkedOLEObject) Or (aShape.Type = msoChart) Then\n                aShape.LinkFormat.Update\n        End If\n    Next\nNext\n\npptPresentation.UpdateLinks\n\nFor Each aSlide In pptPresentation.Slides\n        For Each aShape In aSlide.Shapes\n            With aShape\n                ' skip untagged shapes:\n                sTest = .Tags(\"L\") &amp; .Tags(\"T\") &amp; .Tags(\"H\") &amp; .Tags(\"W\")\n                If Len(sTest) &gt; 0 Then\n                    .Left = CSng(.Tags(\"L\"))\n                    .Top = CSng(.Tags(\"T\"))\n                    .Height = CSng(.Tags(\"H\"))\n                    .Width = CSng(.Tags(\"W\"))\n                End If\n            End With\n        Next\n    Next\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1545226382, "post_id": 53852192, "comment_id": 94551966, "body": "Please provide your past and current code - as text, not a cropped picture."}, {"owner": {"reputation": 316, "user_id": 7867996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2132a521f8ecad66732476b7b6fdcd9b?s=128&d=identicon&r=PG&f=1", "display_name": "thesystem", "link": "https://stackoverflow.com/users/7867996/thesystem"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1545226621, "post_id": 53852192, "comment_id": 94552120, "body": "@Gustav Added code to bottom of post. I remind you once again that the code worked perfectly before an employee made changes to the database table, which indicates that the code is not the problem. Highligted line is where error happens."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1545226684, "post_id": 53852192, "comment_id": 94552161, "body": "Well, then provide the changes of the table schema."}, {"owner": {"reputation": 316, "user_id": 7867996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2132a521f8ecad66732476b7b6fdcd9b?s=128&d=identicon&r=PG&f=1", "display_name": "thesystem", "link": "https://stackoverflow.com/users/7867996/thesystem"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1545226828, "post_id": 53852192, "comment_id": 94552250, "body": "@Gustav The co-worker didn&#39;t document changes and made several.  Code worked perfectly before changes were made. As mentioned in bottom of my post, I am asking if updating the database (changing names, deleting columns etc.) can trigger this error."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1545229034, "post_id": 53852192, "comment_id": 94553589, "body": "What can we know? We don&#39;t even have the current schema. Seems like your co-worker needs some education and - most important - owe you a large beer."}, {"owner": {"reputation": 316, "user_id": 7867996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2132a521f8ecad66732476b7b6fdcd9b?s=128&d=identicon&r=PG&f=1", "display_name": "thesystem", "link": "https://stackoverflow.com/users/7867996/thesystem"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1545229166, "post_id": 53852192, "comment_id": 94553662, "body": "@Gustav Yeah, I figured it was a really long shot and a pretty much impossible question to answer without more insights. I guess I was fishing for hints on how error 2580 is normally triggered, e.g. whether it can be caused by changing the tables/columns or if it is more likely triggered because <code>subAvoidPrivatList</code> has been deleted or something. Thanks for looking a bit into it at least, and I agree with you on that last part about beer ;-)"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1545229745, "post_id": 53852192, "comment_id": 94553974, "body": "One thing I would try is to put a stop on the line ME.subAvoidPrivatList.Form.RecordSource = SQL, step into the code, and then start typing a new line of code above it starting with &quot;Me.&quot; A drop-down list will appear after you type the period which may help you determine whether or not subAvoidPrivatList has been deleted."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1545230058, "post_id": 53852192, "comment_id": 94554180, "body": "Also, in your VBE do you see anything related to AvoidPrivatList in your list of Access Class Objects in the project pane. Put a stop at the beginning of it so you can stop the code from automatically running through it."}, {"owner": {"reputation": 316, "user_id": 7867996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2132a521f8ecad66732476b7b6fdcd9b?s=128&d=identicon&r=PG&f=1", "display_name": "thesystem", "link": "https://stackoverflow.com/users/7867996/thesystem"}, "reply_to_user": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1545234354, "post_id": 53852192, "comment_id": 94556970, "body": "@MBB70 Thank you for the suggestions, I am in transportation at the moment and will follow up at next chance by my computer"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1545490907, "post_id": 53852192, "comment_id": 94639005, "body": "Paste your SQL into a new query, this will get you better error messages. <a href=\"http://stackoverflow.com/a/1099570/3820271\">How to debug dynamic SQL in VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 7867996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2132a521f8ecad66732476b7b6fdcd9b?s=128&d=identicon&r=PG&f=1", "display_name": "thesystem", "link": "https://stackoverflow.com/users/7867996/thesystem"}, "edited": false, "score": 0, "creation_date": 1545234371, "post_id": 53854267, "comment_id": 94556985, "body": "Thank you for the suggestions, I am in transportation at the moment and will follow up at next chance by my computer"}], "tags": [], "owner": {"reputation": 5995, "user_id": 283895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/526z2.png?s=128&g=1", "display_name": "tgolisch", "link": "https://stackoverflow.com/users/283895/tgolisch"}, "is_accepted": true, "score": 1, "last_activity_date": 1545232979, "creation_date": 1545232979, "answer_id": 53854267, "question_id": 53852192, "link": "https://stackoverflow.com/questions/53852192/error-on-access-database-after-changes-were-made/53854267#53854267", "title": "Error on Access database after changes were made", "body": "<p>The error is happening because your SQL statement doesn't match the structure of your table.  To solve this, you will either need to fix the SQL or try to figure out how to put <code>tabel1</code> back the way it was.</p>\n\n<p>To fix the SQL, make sure to ONLY use columns which are (currently) in <code>tabel1</code> (after the recent changes). Of course, this might break other stuff in your MS Access forms or reports.</p>\n\n<p>Fixing the table is much more difficult, but possible if you have enough determination. Start by looking at which columns are being used in your query, but are missing in the table.  You will need to guess at what type they used to be.  Add those into your table. Expect some trial and error, of course.</p>\n\n<p>From the query that you've posted, I would expect <code>tabel1</code> to contain (at least) the following columns: </p>\n\n<pre><code>Id,\narea, \n[are systemname],  //possibly you misspelled this column in your SELECT clause\n[area systemname], //this is probably the correct spelling\n[charge name],\navoid,\n//and you omitted the other columns, but you get the idea\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "is_accepted": false, "score": 1, "last_activity_date": 1545490083, "creation_date": 1545490083, "answer_id": 53896620, "question_id": 53852192, "link": "https://stackoverflow.com/questions/53852192/error-on-access-database-after-changes-were-made/53896620#53896620", "title": "Error on Access database after changes were made", "body": "<p>okay so \" a co-worker changed the name of some tables (possibly added/deleted columns too etc.),\" \u2026.this is the worst possible idea I have every seen.  Tables are the foundation of the structure and changing the foundation after the structure is built is a promise of many headaches.</p>\n\n<p>the advice you've been already given of updating your queries to meet the new table structure is correct....though there can still be a lot of problems above the query in the presentation level (forms/reports) which will throw errors until they get adapted as well.</p>\n\n<p>depending on the quantity of changes you might seriously consider returning to the version before the coworker did the damage....</p>\n"}], "owner": {"reputation": 316, "user_id": 7867996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2132a521f8ecad66732476b7b6fdcd9b?s=128&d=identicon&r=PG&f=1", "display_name": "thesystem", "link": "https://stackoverflow.com/users/7867996/thesystem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 53854267, "answer_count": 2, "score": -1, "last_activity_date": 1545490083, "creation_date": 1545225878, "last_edit_date": 1545227322, "question_id": 53852192, "link": "https://stackoverflow.com/questions/53852192/error-on-access-database-after-changes-were-made", "title": "Error on Access database after changes were made", "body": "<p>I know this is a long shot, but I really need help and I am new to Microsoft Access and working on some legacy code and I can't figure out what the problem is.</p>\n\n<p>As with every other Access db, I have some tables, columns, queries, reports etc.</p>\n\n<p>After a co-worker changed the name of some tables (possibly added/deleted columns too etc.), this code stopped working. It's a simple SQL statement, that queries against <code>tabel1</code> and inserts the information in a form. Notice the database worked perfectly before the person changing it.</p>\n\n<p><strong>Code that doesn't Work anymore and highlight of where the error happens:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/kgqOJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kgqOJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>(I have added the code in bottom, but leaving the picture to highlight where the error occurs) </p>\n\n<p><strong>Error im receiving:</strong></p>\n\n<p>Run-time error '2580': Record Source does not exist</p>\n\n<p><em>Question: If record source does not exist, what is it that actually dont exist?</em></p>\n\n<hr>\n\n<p><strong>My thoughts on the error</strong> </p>\n\n<p>My SQL obviously exists, so I assume that <code>subAvoidPrivatList</code> is the problem? <strong>Is this a list I can access in design/layout view?</strong> (would like to take your guesses on it, since I can find the list anywhere) Or what would your guess be?  Or can the error be triggered, because some of the tables/columns doesn't exist anymore?</p>\n\n<p>Any help appreciated</p>\n\n<p><strong>EDIT: Added code-version of picture above</strong></p>\n\n<pre><code>Dim SQL As String\n\nSQL = \"SELECT tabel1.area, tabel1.[are systemname], tabel1.[charge name] // +15 columns that im gonna leave out for brevity\n    &amp; \"FROM tabel1 \" _\n    &amp; \"WHERE [charge name] LIKE '*\" &amp; Me.txtKeywords &amp; \"*' \" _\n    &amp; \" AND [avoid] = '\" &amp; Me.avoidcheck &amp; \"' \" _\n    &amp; \" AND [area systemname] LIKE '*\" &amp; Me.test1 &amp; \"*' \" _\n    &amp; \" AND [area] LIKE '*\" &amp; Me.resub &amp; \"*' \" _\n    &amp; \"ORDER BY tabel1.[Id] \"\n\nMe.subAvoidPrivatList.Form.RecordSource = SQL\nMe.subAvoidPrivatList.Form.Requery\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "edited": false, "score": 0, "creation_date": 1545226235, "post_id": 53852166, "comment_id": 94551867, "body": "Does it throw an error?"}, {"owner": {"reputation": 1664, "user_id": 1238105, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/kRalq.jpg?s=128&g=1", "display_name": "L&#233;a Massiot", "link": "https://stackoverflow.com/users/1238105/l%c3%a9a-massiot"}, "reply_to_user": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "edited": false, "score": 0, "creation_date": 1545295535, "post_id": 53852166, "comment_id": 94577575, "body": "Hi. No, it doesn&#39;t throw an error. The program stops at MARK2. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1545228263, "last_edit_date": 1545228263, "creation_date": 1545226784, "answer_id": 53852470, "question_id": 53852166, "link": "https://stackoverflow.com/questions/53852166/vba-fill-empty-cells-in-a-range-with-a-zero/53852470#53852470", "title": "VBA Fill empty cells in a range with a zero", "body": "<p>Loops are not necessary.<br><br>Since you are not returning a value from the function, use a <strong>Sub</strong> instead and have the function tell you if any cells were changed:</p>\n\n<pre><code>Sub MAIN()\n    Dim r As Range\n    Set r = Selection\n    x = FillEmptyCellWith0(r)\n    MsgBox x\nEnd Sub\n\nPublic Function FillEmptyCellWith0(r As Range) As String\n    Dim re As Range\n    On Error Resume Next\n        Set re = r.Cells.SpecialCells(xlCellTypeBlanks)\n    On Error GoTo 0\n    If re Is Nothing Then\n        FillEmptyCellWith0 = \"Nothng changed\"\n        Exit Function\n    End If\n    re.Value = 0\n    FillEmptyCellWith0 = \"done\"\nEnd Function\n</code></pre>\n\n<p>The code above tells you if there were any empties to change to zeros.</p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1545227002, "creation_date": 1545227002, "answer_id": 53852539, "question_id": 53852166, "link": "https://stackoverflow.com/questions/53852166/vba-fill-empty-cells-in-a-range-with-a-zero/53852539#53852539", "title": "VBA Fill empty cells in a range with a zero", "body": "<p>You should use built in functionality instead</p>\n\n<pre><code>Sub FillZero()\n    Dim rg As Range\n\n    Set rg = Range(\"A1:B4\")\n\n    rg.Replace What:=\"\", Replacement:=\"0\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1664, "user_id": 1238105, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/kRalq.jpg?s=128&g=1", "display_name": "L&#233;a Massiot", "link": "https://stackoverflow.com/users/1238105/l%c3%a9a-massiot"}, "edited": false, "score": 0, "creation_date": 1545241196, "post_id": 53852641, "comment_id": 94560884, "body": "Hi. Cell.Value = &quot;0&quot; makes the program stop with no error. Help."}, {"owner": {"reputation": 1664, "user_id": 1238105, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/kRalq.jpg?s=128&g=1", "display_name": "L&#233;a Massiot", "link": "https://stackoverflow.com/users/1238105/l%c3%a9a-massiot"}, "edited": false, "score": 0, "creation_date": 1545295153, "post_id": 53852641, "comment_id": 94577398, "body": "Hi. No, the program stops and nothing is written to the cell(s). Thanks."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 2, "last_activity_date": 1545227388, "creation_date": 1545227388, "answer_id": 53852641, "question_id": 53852166, "link": "https://stackoverflow.com/questions/53852166/vba-fill-empty-cells-in-a-range-with-a-zero/53852641#53852641", "title": "VBA Fill empty cells in a range with a zero", "body": "<p>Modify with the appropriate range and try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim rng As Range, Cell As Range\n\n    'Set your range\n    Set rng = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:B5\")\n\n    For Each Cell In rng\n\n        If IsEmpty(Cell) Then\n            Cell.Value = \"0\"\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 2, "last_activity_date": 1578679183, "last_edit_date": 1578679183, "creation_date": 1545241909, "answer_id": 53856721, "question_id": 53852166, "link": "https://stackoverflow.com/questions/53852166/vba-fill-empty-cells-in-a-range-with-a-zero/53856721#53856721", "title": "VBA Fill empty cells in a range with a zero", "body": "<p>There are a number of ways to do this:</p>\n\n<pre><code>Sub Fill0s1()\n    Dim rng As Range: Set rng = Range(\"G5:I7\")\n    Dim Cell As Range\n\n    For Each Cell In rng\n        Cell.value = IIf(IsEmpty(Cell), \"0\", Cell.value)\n    Next\nEnd Sub\n\nSub Fill0s2()\n    Dim rng As Range: Set rng = Range(\"G5:I7\")\n    Dim Cell As Range\n\n    For Each Cell In rng.SpecialCells(xlCellTypeBlanks)\n        Cell.value = \"0\"\n    Next\nEnd Sub\n\nSub Fill0s3()\n    Dim rng As Range: Set rng = Range(\"G5:I7\")\n    With rng.SpecialCells(xlCellTypeBlanks)\n        .Value = \"0\"\n    End With\nEnd Sub\n\nSub Fill0s4()\n    Dim rng As Range: Set rng = Range(\"G5:I7\")\n    rng.Replace What:=\"\", Replacement:=\"0\", LookAt:=xlWhole\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1545269728, "creation_date": 1545269728, "answer_id": 53861392, "question_id": 53852166, "link": "https://stackoverflow.com/questions/53852166/vba-fill-empty-cells-in-a-range-with-a-zero/53861392#53861392", "title": "VBA Fill empty cells in a range with a zero", "body": "<p>Try</p>\n\n<pre><code>Sub test()\n    FillEmptyCellWith0 Range(\"a1: c10\")\nEnd Sub\n\nSub FillEmptyCellWith0(rngDb As Range)\n    Dim vDB As Variant\n    Dim r As Long, c As Integer\n    Dim i As Long, j As Integer\n\n    vDB = rngDb\n    r = UBound(vDB, 1)\n    c = UBound(vDB, 2)\n\n    For i = 1 To r\n        For j = 1 To c\n            If IsEmpty(vDB(i, j)) Then\n                vDB(i, j) = 0\n            End If\n        Next j\n    Next i\n    rngDb = vDB\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1664, "user_id": 1238105, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/kRalq.jpg?s=128&g=1", "display_name": "L&#233;a Massiot", "link": "https://stackoverflow.com/users/1238105/l%c3%a9a-massiot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1579253110, "creation_date": 1545225781, "last_edit_date": 1579253110, "question_id": 53852166, "link": "https://stackoverflow.com/questions/53852166/vba-fill-empty-cells-in-a-range-with-a-zero", "title": "VBA Fill empty cells in a range with a zero", "body": "<p>In VBA, I want to fill empty cells in a range with a zero (0)</p>\n\n<p>Below if my function:</p>\n\n<pre><code>Function FillEmptyCellWith0(r As Range)\nDim n_rangeWidth As Integer\nDim n_rangeHeight As Integer\nDim n_i As Integer\nDim n_j As Integer\nDim n_value As Integer\n\nn_rangeWidth = r.Columns.Count\nn_rangeHeight = r.Rows.Count\n\nMsgBox \"Range width = \" &amp; n_rangeWidth\nMsgBox \"Range height = \" &amp; n_rangeHeight\n\nFor n_j = 1 To n_rangeWidth\n  For n_i = 1 To n_rangeHeight\n    n_value = r.Cells(n_j, n_i).value\n    MsgBox \"Cell (\" &amp; n_j &amp; \", \" &amp; n_i &amp; \") = \" &amp; n_value &lt;----- MARK1\n\n    If IsEmpty(r.Cells(n_j, n_i)) Then\n        MsgBox \"Empty cell\"\n        r.Cells(n_j, n_i).value = \"0\" &lt;----- MARK2\n    End If\n  Next n_i\nNext n_j\n</code></pre>\n\n<p>With the following table:</p>\n\n<pre><code>------+-------\n|   1 |      |\n------+-------\n|     |     3|\n------+-------\n</code></pre>\n\n<p>I have two empty cells that I want to fill in with a zero in (1, 2) and (2, 1).</p>\n\n<p>I call the function like this: <code>FillEmptyCellWith0(A1:B2)</code></p>\n\n<p>When I reach \"MARK1\", at the second turn of the loop, it displays: </p>\n\n<pre><code>Cell (1, 2) = 0\nEmpty cell\n</code></pre>\n\n<p>and then stops.</p>\n\n<p>When I trace the code I can see it stops at MARK2.</p>\n\n<p>Do you see why?</p>\n\n<p>Can you tell me how to assign a zero value (0) to these empty cells?</p>\n\n<p>EDIT 1</p>\n\n<p>Apparently, I cannot do that.</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel</a></p>\n"}, {"tags": ["excel", "vba", "merge", "cell"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10808941"}, "is_accepted": false, "score": 0, "last_activity_date": 1545226857, "creation_date": 1545226857, "answer_id": 53852494, "question_id": 53851975, "link": "https://stackoverflow.com/questions/53851975/vba-insert-merged-row-in-between-gaps-in-data/53852494#53852494", "title": "VBA - Insert Merged Row in between gaps in data", "body": "<p>When inserting or deleting rows, work from the bottom up. Some simple offsets and resizing should be sufficient to insert the three rows, merge the cells and transfer the values.</p>\n\n<pre><code>Option Explicit\n\nSub insertDept3()\n\n    Dim i As Long\n\n    With Worksheets(\"sheet10\")\n        For i = .Cells(.Rows.Count, \"E\").End(xlUp).Row - 1 To 1 Step -1\n            If .Cells(i, \"E\").Value &lt;&gt; .Cells(i + 1, \"E\").Value Or i = 1 Then\n                .Cells(i + 1, \"A\").Resize(3, 5).Insert shift:=xlDown\n                .Cells(i + 2, \"A\").Resize(1, 5).Merge\n                .Cells(i + 2, \"A\") = .Cells(i + 4, \"E\").Value\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I will leave the cell alignment and font formatting to you.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1545230109, "creation_date": 1545230109, "answer_id": 53853426, "question_id": 53851975, "link": "https://stackoverflow.com/questions/53851975/vba-insert-merged-row-in-between-gaps-in-data/53853426#53853426", "title": "VBA - Insert Merged Row in between gaps in data", "body": "<p>The below code loop column E, import three lines when the value change, merger Column A to column E , import and format value in the middle line.</p>\n\n<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim i As Long, Lastrow As Long\n    Dim Department  As String, NextDepartment As String\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Lastrow = .Cells(.Rows.Count, \"E\").End(xlUp).Row\n\n        For i = Lastrow To 2 Step -1\n            Department = .Range(\"E\" &amp; i).Value\n            NextDepartment = .Range(\"E\" &amp; i).Offset(-1, 0).Value\n            If Department &lt;&gt; NextDepartment Then\n                .Rows(i).EntireRow.Resize(3).Insert\n                .Range(\"A\" &amp; i + 1 &amp; \":E\" &amp; i + 1).Merge\n                With .Range(\"A\" &amp; i + 1)\n                    .Value = Department\n                    .Font.Bold = True\n                    .HorizontalAlignment = xlLeft\n                    .VerticalAlignment = xlCenter\n                End With\n            End If\n        Next i\n\n    End With\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RhIBK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RhIBK.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 4200136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8018e9758c49dabfcd4884b846f6be34?s=128&d=identicon&r=PG&f=1", "display_name": "Will Murray", "link": "https://stackoverflow.com/users/4200136/will-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1579253149, "creation_date": 1545225046, "last_edit_date": 1579253149, "question_id": 53851975, "link": "https://stackoverflow.com/questions/53851975/vba-insert-merged-row-in-between-gaps-in-data", "title": "VBA - Insert Merged Row in between gaps in data", "body": "<p>I currently have a macro that inserts 3 rows when the value in Column E changes (Course Department). In the 3 rows I am trying to merge the middle row and add the department into this row. I can't work out how to get it to merge, any help would be appreciated.</p>\n\n<pre><code>With Range(\"e\" &amp; myHeader + 2, Range(\"e\" &amp; Rows.Count).End(xlUp)).Offset(, 1)\n.Formula = _\n\"=if(and(r[-1]c[-1]&lt;&gt;\"\"\"\",rc[-1]&lt;&gt;\"\"\"\",r[-1]c[-1]&lt;&gt;rc[-1]),\" &amp; _\n\"if(r[-1]c=1,\"\"a\"\",1),\"\"\"\")\"\n.Value = .Value\nOn Error Resume Next\nFor i = 1 To 3\n    .SpecialCells(2, 1).EntireRow.Insert\n    .SpecialCells(2, 2).EntireRow.Insert\nNext\n</code></pre>\n\n<p>This is how it is currently:\n<img src=\"https://i.stack.imgur.com/ZKqEO.jpg\" alt=\"This is how it is currently\"></p>\n\n<p>This is what I would like to have:\n<img src=\"https://i.stack.imgur.com/bsGug.jpg\" alt=\"This is what I would like to have\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1545223923, "post_id": 53851611, "comment_id": 94550573, "body": "Doubles quotes which are inside of a string literal need to be escaped. Use <code>&quot;&quot;</code> rather than simply <code>&quot;</code>, so <code>&quot;=indirect($a$1&amp;&quot;&quot;!&quot;&quot;&amp;&quot;&quot;A2:b6&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1545224043, "post_id": 53851611, "comment_id": 94550645, "body": "getting an application error on same line now.     Range(&quot;A2:B6&quot;).Formula = &quot;=INDIRECT(Sheet1!$B$1&amp;!&amp;&quot;&quot;A2:I10000&quot;&quot;)&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "is_accepted": false, "score": 1, "last_activity_date": 1545225634, "last_edit_date": 1545225634, "creation_date": 1545224225, "answer_id": 53851750, "question_id": 53851611, "link": "https://stackoverflow.com/questions/53851611/how-to-make-formula-into-vba-statement/53851750#53851750", "title": "how to make formula into vba statement", "body": "<p>so here is the fix, needed some more quotes</p>\n\n<pre><code>.Range(\"A2:B6\").Formula = \"=INDIRECT(Sheet1!$B$1&amp;\"\"!\"\"&amp;\"\"A2:I10000\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545225634, "creation_date": 1545223663, "question_id": 53851611, "link": "https://stackoverflow.com/questions/53851611/how-to-make-formula-into-vba-statement", "title": "how to make formula into vba statement", "body": "<p>i have the following formula:</p>\n\n<pre><code>=indirect($a$1&amp;\"!\"&amp;\"A2:b6\")\n</code></pre>\n\n<p>but when i code this as a formula, the line fails, how do i fix this?</p>\n\n<pre><code>.Range(\"A2:B6\").Formula = \"=INDIRECT(Sheet1!$B$1&amp;!&amp;\"A2:b6\")\"\n</code></pre>\n"}, {"tags": ["c#", "vba", "ms-access", "clipboard"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1545223916, "post_id": 53851564, "comment_id": 94550567, "body": "The clipboard formats used by Office are undocumented*. Asking for general help understanding them is way too broad for Stack Overflow. <i>(* = some formats are somewhat documented, but not the ones used by Access)</i>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1545224092, "post_id": 53851564, "comment_id": 94550678, "body": "It would be easier and more straightforward to use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.application.createcontrol\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "edited": false, "score": 0, "creation_date": 1545224183, "post_id": 53851564, "comment_id": 94550738, "body": "which formats are documented?"}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1545224270, "post_id": 53851564, "comment_id": 94550794, "body": "@Andre: Thats great. I did not know that this is an option. Ill check that out."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1545224545, "post_id": 53851564, "comment_id": 94550962, "body": "@Gener4tor Loads, see <a href=\"https://msdn.microsoft.com/en-us/library/gg548604(v=office.12).aspx\" rel=\"nofollow noreferrer\">the Office standards</a>. Though for Access, the only real documented format is AXL, which is used by <i>Application.TransferText</i> and macro&#39;s. If you want to programatically create forms, I&#39;d look at the <a href=\"https://msdn.microsoft.com/en-us/library/dd927584(v=office.12).aspx\" rel=\"nofollow noreferrer\">MS-AXL documentation</a>."}], "owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545223502, "creation_date": 1545223502, "question_id": 53851564, "link": "https://stackoverflow.com/questions/53851564/create-clipboard-data-for-use-in-access-vbe", "title": "Create clipboard data for use in Access-Vbe", "body": "<p>In ms-access its possible to copy&amp;paste controls from the design-view of one form to another form. This is a thing I want to (ab)use.</p>\n\n<p>I want to create a C# programm which simulates this.</p>\n\n<p>The use case is the following:</p>\n\n<ul>\n<li>Enter some Information in the C#-program</li>\n<li>click a Button in the c# Program => the clipboard-data is createDR</li>\n<li>paste it into a form-design-view in ms-access => The controls are pasted into the form; They got the names, sizes and so on which are determined by the information entered before</li>\n</ul>\n\n<p>As a first test I </p>\n\n<p>So I copied a textfield (Named \"BU_NAME\", read the clipboard and stored it into a file called: \"ClipboardData TextField BU_NAME.txt\"</p>\n\n<p>With this code its possible to copy the Input of the file onto the clipboard so afterwards I can paste the Textfield BU_NAME into access.</p>\n\n<pre><code>MemoryStream ms = new MemoryStream();\nusing (FileStream file = new FileStream(\"ClipboardData TextField BU_NAME.txt\", FileMode.Open, FileAccess.Read))\n    file.CopyTo(ms);\n\nClipboard.SetData(\"Form Item v12\", ms);\n</code></pre>\n\n<p>This seems to work.</p>\n\n<p>As a first test for manipulation I tried to change the name of the textfield with a Hex-Editor. This works as long as I do not change the length of the Name. </p>\n\n<p>So before I start a big project to find out how the clipboard format used by ms-access (\"Form Item v12\") works:</p>\n\n<ul>\n<li>Is there any documentation for this format?</li>\n<li>Any tipps which help me to figure out how the format is defined?</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1545224087, "post_id": 53851487, "comment_id": 94550673, "body": "Just use <code>Range.Row</code> and <code>Range.Column</code>?  (e.g. <code>cb.BottomRightCell.Row</code>)"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1545224371, "post_id": 53851487, "comment_id": 94550868, "body": "@Chronocidal IDK how did I miss that. Many thanks friend."}], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 1, "last_activity_date": 1545224580, "creation_date": 1545224580, "answer_id": 53851852, "question_id": 53851487, "link": "https://stackoverflow.com/questions/53851487/manipulate-range-adress-value-with-vba/53851852#53851852", "title": "Manipulate Range.Adress value with VBA", "body": "<p>Just use <code>Range.Row</code> and <code>Range.Column</code>? (e.g. <code>cb.BottomRightCell.Row</code>)</p>\n\n<pre><code>If cb.ControlFormat.Value = xlOn Then\n    ThisWorkbook.Sheets(3).Cells(i, 1).Value = \"X\"\n    ThisWorkbook.Sheets(3).Cells(i, 2).Value = cb.Name\n    ThisWorkbook.Sheets(3).Cells(i, 3).Value = cb.BottomRightCell.Address(, , xlR1C1)\n    'ThisWorkbook.Sheets(3).Cells(i, 4).Value = Split(ThisWorkbook.Sheets(3).Cells(i, 3), \"C\") 'Nope!\n    ThisWorkbook.Sheets(3).Cells(i, 4).Value = cb.BottomRightCell.Row ' Tada!\n</code></pre>\n\n<p><em>(Promoted from an \"is there a reason you're not using this?\" Comment to a full answer, so that the question can be flagged as answered - apparently the reason was \"Oops\")</em></p>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 53851852, "answer_count": 1, "score": 0, "last_activity_date": 1579253163, "creation_date": 1545223212, "last_edit_date": 1579253163, "question_id": 53851487, "link": "https://stackoverflow.com/questions/53851487/manipulate-range-adress-value-with-vba", "title": "Manipulate Range.Adress value with VBA", "body": "<p><strong>Scenario:</strong> I am working with a code that (alongside other things) gets me the location of the checkboxes in a worksheet in a xlR1C1 format. </p>\n\n<p><strong>Objective:</strong> Since I have to manipulate this value to perform other operations, I am trying to get that address into a usable pair of values (row and column) that I can use. </p>\n\n<p><strong>What I already tried:</strong> Somewhat in a convoluted way, I was able to read the addresses as string and do multiple operations to extract both numbers (with split, left and so on). </p>\n\n<p><strong>Question:</strong> Is there a better / more efficient way to perform this operation?</p>\n\n<p><strong>Code:</strong> Gets the checkbox location, and gets the first value (row number) from the address:</p>\n\n<pre><code>Sub getControlValues() \n\n    Dim cb As Shape\n    Dim i As Long\n\n    i = 1\n\n    'Loop through Form Checkboxes\n    For Each cb In ThisWorkbook.Sheets(1).Shapes\n        If cb.Type = msoFormControl Then\n            If cb.FormControlType = xlCheckBox Then\n                If cb.ControlFormat.Value = xlOn Then\n                    ThisWorkbook.Sheets(3).Cells(i, 1).Value = \"X\"\n                    ThisWorkbook.Sheets(3).Cells(i, 2).Value = cb.Name\n                    ThisWorkbook.Sheets(3).Cells(i, 3).Value = cb.BottomRightCell.Address(, , xlR1C1)\n                    ThisWorkbook.Sheets(3).Cells(i, 4).Value = Split(ThisWorkbook.Sheets(3).Cells(i, 3), \"C\")\n                    'ThisWorkbook.Sheets(3).Cells(i, 4).Value = cb.Type\n                ElseIf cb.ControlFormat.Value = xlOff Then\n                    ThisWorkbook.Sheets(3).Cells(i, 1).Value = \"\"\n                    ThisWorkbook.Sheets(3).Cells(i, 2).Value = cb.Name\n                    ThisWorkbook.Sheets(3).Cells(i, 3).Value = cb.BottomRightCell.Address(, , xlR1C1)\n                    ThisWorkbook.Sheets(3).Cells(i, 4).Value = Split(ThisWorkbook.Sheets(3).Cells(i, 3), \"C\")\n                End If\n            i = i + 1\n            End If\n        End If\n    Next cb\n\nEnd Sub\n</code></pre>\n\n<p><strong>Obs:</strong> I know how to do this procedure easily within the sheet and can also use the macro recorder to do that, but my objective is to find a better solution for this.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 0, "creation_date": 1545282350, "post_id": 53851211, "comment_id": 94573170, "body": "Thank you for the solution, for VBA we have to double up the double quotes something like <code>.Range(&quot;Cell&quot;).Formula = &quot;=IF(COUNTIFS(A:A,A2,B:B,B2)=1,&quot;&quot;Single&quot;&quot;,&quot;&quot;Multiple&quot;&quot;)&quot;</code>"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1545222209, "creation_date": 1545222209, "answer_id": 53851211, "question_id": 53851080, "link": "https://stackoverflow.com/questions/53851080/filter-and-groupby-vba/53851211#53851211", "title": "Filter and groupby VBA", "body": "<blockquote>\n  <p>a totally different solution</p>\n</blockquote>\n\n<p>Assuming <code>date</code> is in A1, parse <code>Product</code> at the space and in D2 and copied down:</p>\n\n<pre><code> =IF(COUNTIFS(A:A,A2,B:B,B2)=1,\"Single\",\"Multiple\")\n</code></pre>\n"}], "owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 53851211, "answer_count": 1, "score": 1, "last_activity_date": 1579253173, "creation_date": 1545221735, "last_edit_date": 1579253173, "question_id": 53851080, "link": "https://stackoverflow.com/questions/53851080/filter-and-groupby-vba", "title": "Filter and groupby VBA", "body": "<p>I have a data which looks like:</p>\n\n<pre><code>date          Product    Result\n31-12-2017    abc 1234 \n21-01-2018    def 1234\n31-12-2017    abc 5678\n21-01-2018    xyz 5678\n</code></pre>\n\n<p>I want to filter each date and count the number of appearances of the first string in <code>Product</code> , eg: for <code>date</code>  <code>31-12-2017</code> , the string <code>abc</code> repeats twice . My expected output would put a column stating if the appearances are single or multiple. Example below:</p>\n\n<pre><code>date          Product    Result\n31-12-2017    abc 1234   Multiple\n21-01-2018    def 1234   Single\n31-12-2017    abc 5678   Multiple\n21-01-2018    xyz 5678   Single\n</code></pre>\n\n<p>below is what I have achieved so far by referencing SO:</p>\n\n<pre><code>Sub Filter_count()\nDim item As Variant\nWith ThisWorkbook.Sheets(\"Sheet1\")\n\n    lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    uniquesArray = .Range(\"A2:A\" &amp; lastrow)\n\n        For Each item In uniquesArray\n            ActiveSheet.Range(\"$A:$A\").AutoFilter Field:=1, Criteria1:=item\n\n            'Do Something\n\n\n        Next\n</code></pre>\n\n<p>I am able to filter by date , but unsure how to proceed further. I am okay for a totally different solution too. :)</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 3, "creation_date": 1545218848, "post_id": 53850198, "comment_id": 94547915, "body": "You create HTMLdoc then read from it, but it has no contents &amp; is empty.  The error is likely because frame is Nothing.  You need to assign the downloaded HTML text to the document, something like HTMLdoc.body.innerHTML = htmlText"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1545219057, "post_id": 53850198, "comment_id": 94548020, "body": "yep, you are right, I hovered over <code>frame</code> and is <code>= nothing</code>. How and where do I incorporate <code>HTMLdoc.body.innerHTML = htmlText</code> into the code?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1545220805, "post_id": 53850198, "comment_id": 94548932, "body": "I used <code>HTMLdoc.Body.innerText = IE.responseText</code> after <code>Set HTMLdoc = New HTMLDocument</code> and debug.print outputs the page"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545224828, "post_id": 53850198, "comment_id": 94551103, "body": "That link doesn&#39;t work in the browser for me.  It looks internal."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1545250342, "post_id": 53850198, "comment_id": 94564785, "body": "Hi @qharr yes its internal.. i will test shortly and revert back"}], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1545265538, "post_id": 53852012, "comment_id": 94569897, "body": "errors at <code>html.Body.innerHTML = sresponse</code> <code>Run-time error &#39;601&#39; Application-defined or object-defined error</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1545298367, "post_id": 53852012, "comment_id": 94579034, "body": "Have you examined sresponse?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1545352744, "post_id": 53852012, "comment_id": 94602964, "body": "<code>Debug.Print sresponse</code> produces some text.. has &lt;html&gt; some text &lt;/html&gt;"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1548386902, "post_id": 53852012, "comment_id": 95531643, "body": "Apologise for the late &#39;tick&#39; The issue I was having is that CRM and my upgraded SAP are not compatible and thus this code wasn&#39;t working. After understanding this and testing the above it works. Thanks for th help and again sorry for the delay."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1545225211, "creation_date": 1545225211, "answer_id": 53852012, "question_id": 53850198, "link": "https://stackoverflow.com/questions/53850198/converting-excel-vba-from-internetexplorermedium-to-msxml2-xmlhttp60/53852012#53852012", "title": "converting Excel VBA from InternetExplorerMedium to MSXML2.XMLHTTP60", "body": "<p>You can remove the while wend loop. Read the XMLHTTP response into an html document object. I usually decode en route.</p>\n\n<pre><code>Dim sresponse As String, html As HTMLDocument, myUrl\nmyUrl = \"abc.com\"\n\nWith CreateObject(\"MSXML2.XMLHTTP\")\n    .Open \"GET\", myUrl, False\n    .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n    .send\n   sresponse = StrConv(.responseBody, vbUnicode)\nEnd With\n\nSet html = New HTMLDocument\nhtml.body.innerHTML = sresponse\n</code></pre>\n\n<p>Then test the contents to see if frame present and contains info.</p>\n"}], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 53852012, "answer_count": 1, "score": 0, "last_activity_date": 1545225355, "creation_date": 1545218525, "last_edit_date": 1545225355, "question_id": 53850198, "link": "https://stackoverflow.com/questions/53850198/converting-excel-vba-from-internetexplorermedium-to-msxml2-xmlhttp60", "title": "converting Excel VBA from InternetExplorerMedium to MSXML2.XMLHTTP60", "body": "<p>I created a macro using <code>InternetExplorerMedium</code> however due to IE being unstable and throwing errors ad hoc I want to change this to use <code>MSXML2.XMLHTTP60</code></p>\n\n<p>I have been successful in changing the specific parts of code thus far however I have come across a part where I am struggling. This part of code however I am getting an error <code>runtime error 91</code> at:</p>\n\n<pre><code>Set HTMLdoc = frame.contentDocument ' &lt;----- error debug here\n</code></pre>\n\n<p>How do I overcome this?</p>\n\n<p>Snippets of code below relating to this query:</p>\n\n<pre><code>Sub TPMRebatePayment()\n\n\n    Dim IE As New MSXML2.XMLHTTP60\n    Dim HTMLdoc As MSHTML.HTMLDocument\n    Dim frame As HTMLFrameElement\n    Dim myurl As String\n\n\n&lt;snip code&gt;\n\n    'Opens IE\n\n    myurl = \"http://crmprdas02.aunz.lncorp.net:8011/sap(bD1lbiZjPTEwMCZkPW1pbg==)/bc/bsp/sap/crm_bsp_frame/entrypoint.do?appl=crmd_stlmt_rb&amp;version=0&amp;blview=znfl_stl&amp;crm_bsp_restore=false\"\n    IE.Open \"GET\", myurl, False\n    IE.Send\n\n\n    While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n\n    'Loops thru entering payments\n    LastRow = SourceShtTPM.Range(\"A\" &amp; Rows.Count).End(xlUp).Row    'Recalc last row as data has been entered\n\n    For iRow = 3 To LastRow\n        If SourceShtTPM.Range(\"A\" &amp; iRow) &lt;&gt; \"\" Then\n            Set HTMLdoc = New HTMLDocument\n            Set frame = HTMLdoc.getElementsByName(\"crmA\")(0)\n\n            ''' This is where the error occurs                \n            Set HTMLdoc = frame.contentDocument\n\n            HTMLdoc.getElementById(\"SREQ1_SR__simpleSearch__as_button\").Click   'Click Search Button\n            While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n\n            HTMLdoc.getElementById(\"SREQ1_SR__advancedSearch_advancedSearch_REBATE_NO\").Value = SourceShtTPM.Range(\"A\" &amp; iRow).Value    'Enter Accrual into Rebate No. Field\n            HTMLdoc.getElementById(\"SREQ1_SR__advancedSearch__sm_go\").Click\n            While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n\n            HTMLdoc.getElementById(\"SRES2_BUT_GOTO\").Click      'Click Go To Button\n            While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n            HTMLdoc.getElementById(\"EDIT_DETAILS\").Click        'Then Details to enter the payment page\n            While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n\n            AccBal = HTMLdoc.getElementById(\"MULT3_DETL31_MULT3_DETL31ES_ZZACCRUED_SC\").Value       'Scrapes accrual balance\n\n            If AccBal &lt;&gt; 0 Then\n                If Right(AccBal, 1) = \"-\" Then                                                          'Converts to number\n                    SourceShtTPM.Range(\"E\" &amp; iRow).Value = \"-\" &amp; Left(AccBal, Len(AccBal) - 1)\n                    Else: SourceShtTPM.Range(\"E\" &amp; iRow).Value = \"-\" &amp; AccBal\n                End If\n\n                If SourceShtTPM.Range(\"H\" &amp; iRow).Value &gt; 0 Then       'Confirms if enough money to pay\n                    HTMLdoc.getElementById(\"MULT3_DETL31_MULT3_DETL31ES_ZZAMOUNT\").Value = Round(SourceShtTPM.Range(\"H\" &amp; iRow).Value, 2)   'Enters \"Amount to be Paid\"\n                    HTMLdoc.getElementById(\"MULT3_DETL31_MULT3_DETL31ES_ZZCLAIMNO_SC\").Value = SourceShtCLM.Range(\"A2\").Value       'Enters claim no.\n                    HTMLdoc.getElementById(\"MULT3_MEDL32_BUT_ZST_CPY_RT\").Click     'Click button to distribute\n                    While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n                    HTMLdoc.getElementById(\"ZCR_COPY_TO_SKU_RATE\").Click            'distributes to sku\n                    While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n                    HTMLdoc.getElementById(\"MULT3_MEDL32_BUT_ZSTL_COPY\").Click      'Click button to distribute\n                    While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n                    HTMLdoc.getElementById(\"ZCR_COPY_TO_SKU_AMNT\").Click            'distributes to sku\n                    While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n                    HTMLdoc.getElementById(\"MULT3_MEDL32_ZSTL_PART_SETTLE\").Click   'Clicks Pay Claim\n                    While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n                    'The line below will save the rebate payment.\n                    'DO NOT CHANGE UNLESS CODE IS 100%\n                    'HTMLdoc.getElementById(\"MULT3_MEDL32_ZCR_STLMT_SAVE\").Click    'Clicks Save\n                    'While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n\n                    SourceShtTPM.Range(\"C\" &amp; iRow) = Split(IE.document.getElementsByName(\"crmA\")(0).contentDocument.getElementById(\"APLG0_lnk\").innerText, Chr$(32))(3)\n\n                    'Col \"Y\" = entered commentary\n                    SourceShtTPM.Range(\"D\" &amp; iRow).Value = \"Claim Paid\"\n                Else\n                    'Col \"Y\" = payment amount to enter\n                    SourceShtTPM.Range(\"D\" &amp; iRow).Value = \"Not Paid\"\n                End If\n            Else\n                SourceShtTPM.Range(\"D\" &amp; iRow).Value = \"No money in accrual\"\n            End If\n\n        IE.navigate \"http://crmprdas02.aunz.lncorp.net:8011/sap(bD1lbiZjPTEwMCZkPW1pbg==)/bc/bsp/sap/crm_bsp_frame/entrypoint.do?appl=crmd_stlmt_rb&amp;version=0&amp;blview=znfl_stl&amp;crm_bsp_restore=false\"\n        While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend\n        Set HTMLdoc = Nothing\n\n        End If\n\n    Next iRow\n\n\n   IE.Quit\n\n   &lt;snip code&gt;\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "graph", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1549564947, "creation_date": 1549564947, "answer_id": 54580175, "question_id": 53849972, "link": "https://stackoverflow.com/questions/53849972/hide-add-legend-to-graph-with-conditions/54580175#54580175", "title": "Hide/add legend to graph with conditions", "body": "<p>You can use VBA to realize this.</p>\n\n<p>in Excel 2013 onward model\nyou can use Chart.FullSeriesCollection to select your series and toggle its Isfiltered properties</p>\n\n<p>Like</p>\n\n<pre><code>If.....Then\n   ChartObjects(\"xxxx\").Chart.FullSeriesCollection(2).IsFiltered = True\nElse\n   ChartObjects(\"xxxx\").Chart.FullSeriesCollection(2).IsFiltered = False\nEnd if\n</code></pre>\n\n<p>If you are using old excel, like excel 2007, excel 2010.. you should only use Chart.legend.legendEntries(2).Delete to get rid of the legend. if you wanna toggle it back, you should use chart.hasLegend = false, Chart.hasLegend = true to make it back</p>\n"}], "owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579253197, "creation_date": 1545217635, "last_edit_date": 1579253197, "question_id": 53849972, "link": "https://stackoverflow.com/questions/53849972/hide-add-legend-to-graph-with-conditions", "title": "Hide/add legend to graph with conditions", "body": "<p>I have 2 columns of data for my chart, but the second one is optional (with an IF formula).</p>\n\n<p>I want the legend to only show the relevant series.</p>\n\n<p>Because the legend is visible even if there is no data for the second column, I wrote this in the cell for the series name:</p>\n\n<pre><code>=IF(\u2026\u2026\u2026\u2026;\"blabla\";\"\")\n</code></pre>\n\n<p>Now the legend has no label and only the (yellow dashed) line appears:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hcdhk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hcdhk.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I hide both the label and the line in this legend if the series has no data?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545220584, "post_id": 53849965, "comment_id": 94548795, "body": "Please take a moment to read in the site&#39;s <a href=\"https://stackoverflow.com/help\">help center</a> about how to effectively ask questions on Stack Overflow. A question should contain <i>complete</i> relevant information, including the code you already have as a starting point. You can use the <a href=\"https://stackoverflow.com/posts/53849965/edit\">edit</a> link under the question to add more information."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1545223961, "post_id": 53849965, "comment_id": 94550600, "body": "You need to iterate the fields collection and test each field for it being a a reference type."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1545230483, "post_id": 53849965, "comment_id": 94554423, "body": "When you find a field of referernce type you also need to check the code of the field because not all reference fields are cross references. Spacifically for cross references you need to check if the code text contains the string &quot;_Ref&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10810662, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_AJp5kwn80Q/AAAAAAAAAAI/AAAAAAAAANI/NftDPngbMGQ/photo.jpg?sz=128", "display_name": "Jay Postones", "link": "https://stackoverflow.com/users/10810662/jay-postones"}, "edited": false, "score": 0, "creation_date": 1546674950, "post_id": 53860395, "comment_id": 94934820, "body": "This works brilliantly - thank you. The issue I encounter with this solution however is that each time I run the macro, it adds parentheses each time, so I end up with some cross references with multiple brackets either side.   Is there a way to find and replace cross references with more than one set of parentheses?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 1, "user_id": 10810662, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_AJp5kwn80Q/AAAAAAAAAAI/AAAAAAAAANI/NftDPngbMGQ/photo.jpg?sz=128", "display_name": "Jay Postones", "link": "https://stackoverflow.com/users/10810662/jay-postones"}, "edited": false, "score": 0, "creation_date": 1546685782, "post_id": 53860395, "comment_id": 94936973, "body": "Perhaps you should leave that process until you&#39;ve completed your other editing. Alternatively, you could select the range you want to process (i.e. one that doesn&#39;t already have the parentheses) before running the Find/Replace. If neither of those options suits, you&#39;ll need two extra Find/Replace, to replace paired opening/closing parentheses with single opening/closing parentheses."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1545260820, "creation_date": 1545260820, "answer_id": 53860395, "question_id": 53849965, "link": "https://stackoverflow.com/questions/53849965/add-parentheses-to-cross-references/53860395#53860395", "title": "Add parentheses to cross references", "body": "<p>You can do this with a simple Find/Replace! Press Alt-F9, then use:</p>\n\n<pre><code>Find = ^d REF\nReplace = (^&amp;)\n</code></pre>\n\n<p>and press Alt-F9 again when you're done.</p>\n"}], "owner": {"reputation": 1, "user_id": 10810662, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_AJp5kwn80Q/AAAAAAAAAAI/AAAAAAAAANI/NftDPngbMGQ/photo.jpg?sz=128", "display_name": "Jay Postones", "link": "https://stackoverflow.com/users/10810662/jay-postones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1545260820, "creation_date": 1545217612, "last_edit_date": 1545220471, "question_id": 53849965, "link": "https://stackoverflow.com/questions/53849965/add-parentheses-to-cross-references", "title": "Add parentheses to cross references", "body": "<p>I'd like to add parentheses to all cross references in my Word document. I've created a macro that defines the style of the text, but I'd like this macro to also add \"(\" before and \")\" after every cross reference automatically.</p>\n\n<p>I've tried to do this in find and replace but can't seem to find a way.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "outlook", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "edited": false, "score": 0, "creation_date": 1545291369, "post_id": 53853893, "comment_id": 94575907, "body": "Thank you for your answer, I am getting a &quot;Compile error&quot; which says &quot;User-defined type is not defined&quot; pointing to the part of the code <code>Dim oLookApp As Outlook.Application</code>. Do you have any idea about what should be the problem? :)"}, {"owner": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "edited": false, "score": 0, "creation_date": 1545307536, "post_id": 53853893, "comment_id": 94583652, "body": "<b>Update:</b> I&#39;ve tried again and used the Outlook library in VBA, now I do not have an error, but the code only opens the e-mail in Outlook, it does not insert the Table1, even when I modified the code according the the file template location."}, {"owner": {"reputation": 437, "user_id": 9175363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bcd92ae3d11917a924113334a96b73?s=128&d=identicon&r=PG", "display_name": "areed1192", "link": "https://stackoverflow.com/users/9175363/areed1192"}, "reply_to_user": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "edited": false, "score": 1, "creation_date": 1545317582, "post_id": 53853893, "comment_id": 94589109, "body": "Hey Gabriel, I made some changes to the code. Give it a try and let me know if it works. I was more explicit in where I wanted to paste and rearranged some of the code so that it is now part of the &quot;with block&quot;."}, {"owner": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "edited": false, "score": 0, "creation_date": 1545382911, "post_id": 53853893, "comment_id": 94610261, "body": "I&#39;ve tried the code and modified according to the task I need to do. It is all working great! Thank you. I just modified your answer by defining the variable <code>PPTShape</code> as <code>PowerPoint Shape</code> and now it is all good. Have a great day!"}], "tags": [], "owner": {"reputation": 437, "user_id": 9175363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bcd92ae3d11917a924113334a96b73?s=128&d=identicon&r=PG", "display_name": "areed1192", "link": "https://stackoverflow.com/users/9175363/areed1192"}, "is_accepted": true, "score": 1, "last_activity_date": 1545389842, "last_edit_date": 1545389842, "creation_date": 1545231670, "answer_id": 53853893, "question_id": 53849170, "link": "https://stackoverflow.com/questions/53849170/copy-powerpoint-native-table-to-the-body-of-an-outlook-email/53853893#53853893", "title": "Copy PowerPoint native table to the body of an Outlook Email", "body": "<p>Here is a basic example that will take a PowerPoint Table and copy it over to an outlook email using early binding.</p>\n\n<p>Keep in mind this can be volatile at times, in other words, the information doesn't actually make it to the clipboard but this can be dealt with by pausing the application for a few seconds. Also, this will work if Outlook is ALREADY OPEN.</p>\n\n<pre><code>Sub ExportToOutlook()\n\n'Declare PowerPoint Variables\n Dim PPTShape As PowerPoint.Shape\n\n'Declare Outlook Variables\n Dim oLookApp As Outlook.Application\n Dim oLookItm As Outlook.MailItem\n\n    'Create a reference to the table you want to copy, &amp; select it.\n    Set PPTShape = ActivePresentation.Slides(1).Shapes(\"Table 1\")\n        PPTShape.Select\n\n        On Error Resume Next\n\n        'Test if Outlook is Open\n        Set oLookApp = GetObject(, \"Outlook.Application\")\n\n            'If the Application isn't open it will return a 429 error\n            If Err.Number = 429 Then\n\n              'If it is not open then clear the error and create a new instance of Outlook\n               Err.Clear\n               Set oLookApp = New Outlook.Application\n\n            End If\n\n        'Create a mail item in outlook.\n        Set oLookItm = oLookApp.CreateItem(olMailItem)\n\n        'Copy the table\n        PPTShape.Copy\n\n        'Create the Outlook item\n         With oLookItm\n\n             'Pass through the necessary info\n             .To = \"Someone\"\n             .Subject = \"Test\"\n             .Display\n\n             'Get the word editor\n              Set oLookInsp = .GetInspector\n              Set oWdEditor = oLookInsp.WordEditor\n\n             'Define the content area\n              Set oWdContent = oWdEditor.Content\n              oWdContent.InsertParagraphBefore\n\n             'Define the range where we want to paste.\n              Set oWdRng = oWdEditor.Paragraphs(1).Range\n\n             'Paste the object.\n              oWdRng.Paste\n\n    End With\n\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 53853893, "answer_count": 1, "score": 1, "last_activity_date": 1545389842, "creation_date": 1545215046, "last_edit_date": 1545344825, "question_id": 53849170, "link": "https://stackoverflow.com/questions/53849170/copy-powerpoint-native-table-to-the-body-of-an-outlook-email", "title": "Copy PowerPoint native table to the body of an Outlook Email", "body": "<p>I cannot provide all the code. It is from an internal project of my company.</p>\n\n<p>I created VBA code to take elements from an Excel list and save it in a PowerPoint native table (dimensions: 7 rows, 6 columns, name: Table1), which is already created inside of the PowerPoint template file. The code only fills it with the correct data in the correct cells.</p>\n\n<pre><code>'Example of how I access the native table in PowerPoint        \nSet oPPTShape = oPPTFile.Slides(SlideNum).Shapes(\"Table1\")\n\n'I can get data from a cell by using, for example: \noPPTShape.Table.Cell(2, 1).Shape.TextFrame.TextRange.Text\n'But I cannot select a range from this PowerPoint table\n</code></pre>\n\n<p>I would like to extract this native table from PowerPoint and paste it in an Outlook email's body. I read that maybe I can do this by using <code>.HTMLBody = StrBody &amp; RangetoHTML(rng)</code>, inside of the OutMail as described below:</p>\n\n<pre><code>With OutMail                    \n\n  .To = name_email                                       \n  'Add file                    \n  .Attachments.Add (\"C:... .pptx\")                    \n  .Subject = \"Data\"                    \n  .Body = StrBody                    \n  .HTMLBody = StrBody &amp; RangetoHTML(rng)                    \n  .SaveAs \"C:... .msg\", 5                    \n  .Display  'Or use .Send          \n\nEnd With\n</code></pre>\n\n<p>Where <code>rng</code> is the Range that will be copied from the Table1 inside of the email's body. </p>\n\n<p>Until now I can use the data from PowerPoint Table1 with the code below and I was trying to use the same method to insert the Table1 in the email's body. </p>\n\n<pre><code>Dim strNewPresPath As String    \nstrNewPresPath = \"C:\\... .pptx\"    \n\nSet oPPTApp = CreateObject(\"PowerPoint.Application\")    \noPPTApp.Visible = msoTrue   \n\nSet oPPTFile = oPPTApp.Presentations.Open(strNewPresPath)    \nSlideNum = 1    \n\nSheets(\"Open Tasks\").Activate  \n\nDim myStr As String    \nmyStr = \"Open\"\n\nDo        \n  oPPTFile.Slides(SlideNum).Select          \n  'Select PowerPoint shape with the name Table1        \n  Set oPPTShape = oPPTFile.Slides(SlideNum).Shapes(\"Table1\")\n.\n.\n.\n</code></pre>\n\n<p><em>My question is:</em> </p>\n\n<p>Is there another way to copy and paste this Table1 from PowerPoint to the email's body with VBA code?</p>\n\n<p>It can be as an Image/Picture from the Table or even not in the same exact format that it is in PowerPoint, because until now I am sending it as an attachment file and I believe it is easier to read when the Table is visible under the text written in the email.</p>\n"}, {"tags": ["excel", "vba", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545214933, "post_id": 53848989, "comment_id": 94545796, "body": "sounds maybe you can use Like with wildcards or Instr"}, {"owner": {"reputation": 3, "user_id": 3014192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e04ff18a1b3e34dffd613c0abd9777?s=128&d=identicon&r=PG&f=1", "display_name": "user3014192", "link": "https://stackoverflow.com/users/3014192/user3014192"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545218928, "post_id": 53848989, "comment_id": 94547955, "body": "I&#39;ve seen a few tutorials which suggest using Like but I&#39;m not too sure of how to incorporate it with a With statement unfortunately"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545225728, "post_id": 53848989, "comment_id": 94551581, "body": "Can you use like to set it in a variable and then use With variable ? Error handle appropriately."}, {"owner": {"reputation": 3, "user_id": 3014192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e04ff18a1b3e34dffd613c0abd9777?s=128&d=identicon&r=PG&f=1", "display_name": "user3014192", "link": "https://stackoverflow.com/users/3014192/user3014192"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545227574, "post_id": 53848989, "comment_id": 94552709, "body": "Could you provide a small example of how to implement this?  I&#39;m still quite the amateur when it comes to VBA at the moment"}], "owner": {"reputation": 3, "user_id": 3014192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e04ff18a1b3e34dffd613c0abd9777?s=128&d=identicon&r=PG&f=1", "display_name": "user3014192", "link": "https://stackoverflow.com/users/3014192/user3014192"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545215720, "creation_date": 1545214452, "last_edit_date": 1545215720, "question_id": 53848989, "link": "https://stackoverflow.com/questions/53848989/is-it-possible-to-declare-a-does-not-contain-partial-match-with-a-with-statement", "title": "Is it possible to declare a does not contain partial match with a With statement in VBA", "body": "<p>I'm trying to attach a simple macro to a command button that will manipulate the report filter on a pivot table.  I'm still quite new to VBA so I manually filtered the pivot table and recorded the macro.</p>\n\n<p>A Sample of the recorded macro;</p>\n\n<pre><code>Sub Macro1()\n\nActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Attribute1Value\"). _\n    CurrentPage = \"(All)\"\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Attribute1Value\")\n    .PivotItems(\"blank - no bc category value\").Visible = False\n    .PivotItems(\"boys | boys/accessories\").Visible = False\n    .PivotItems(\"boys | boys/accessories | girls | girls/accessories\").Visible _\n    = False\n    .PivotItems(\"boys | boys/baby-boy\").Visible = False\n</code></pre>\n\n<p>This goes on and on for the thousands of different store category values I have.</p>\n\n<p>So here's the code I've put together;</p>\n\n<pre><code>Private Sub testbutton1_Click()\n\nActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Attribute1Value\"). _\n    CurrentPage = \"(All)\"\n\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Attribute1Value\")\n    .PivotItems(\"beauty\").Visible = False\n\n\n\nEnd With\n\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Attribute1Value\"). _\n    EnableMultiplePageItems = True\n\n\nEnd Sub\n</code></pre>\n\n<p>It works, but only with exact matches and at the moment it does the opposite of what I need it to do (only displays Inventory Numbers which don't have the value \"Beauty\" as it's store category, I need it to display everything that contains \"Beauty\" or \"Beaut\" etc. as a lot of the store category values are dual-categorised e.g. \" Beauty | Womens/Accessories\" ).  Changing it to (\"beauty\").Visible = True does nothing.</p>\n\n<p>Any and all advice will be hugely appreciated.</p>\n\n<p>Many Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1545213299, "post_id": 53848515, "comment_id": 94544797, "body": "The error occurs with that first bit of code?  It has <code>End Sub</code> at the end, but nothing at the start - <code>Sub MyProcedure()</code> so it is outside the confines of a procedure (which must start with <code>Sub ProcedureName()</code> and end with <code>End Sub</code>) so it&#39;s outside of a procedure, which is invalid...."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1545213789, "post_id": 53848515, "comment_id": 94545090, "body": "Also <code>n&#248;gletal = Range(&quot;B2&quot;, &quot;B16&quot;)</code> won&#39;t work.  This is trying to reference two cells and put the value of both into a string variable?  And this <code>Worksheets(&quot;Ark2&quot;).Range(&quot;B2&quot;, &quot;B16&quot;).</code> doesn&#39;t seem to be doing anything.  Should it be <code>&quot;B2:B16&quot;</code>, but then what is it there for?  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range(object)\" rel=\"nofollow noreferrer\">Range object</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6932188"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545213858, "post_id": 53848515, "comment_id": 94545131, "body": "Thanks guys that all worked out for me !!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545213945, "post_id": 53848515, "comment_id": 94545187, "body": "It did?  Could you show us what you changed - at the moment the second block of  code doesn&#39;t look like it should work."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6932188"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545213969, "post_id": 53848515, "comment_id": 94545216, "body": "@DarrenBartrup-Cook when i try it, it says run-time error`13&#180; type mismatch?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1545214293, "post_id": 53848515, "comment_id": 94545408, "body": "Also would be worth you reading <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?r=SearchResults&amp;s=1|268.7045\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1545214418, "post_id": 53848515, "comment_id": 94545469, "body": "You haven&#39;t said which line errors, but it&#39;s probably down to Darren&#39;s second comment."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545214460, "post_id": 53848515, "comment_id": 94545501, "body": "Mine says <code>Syntax Error</code> because of the last line.  If I remove that line completely I get <code>Type Mismatch</code> on <code>n&#248;gletal = Range(&quot;B2&quot;, &quot;B16&quot;)</code>, the same error will also occur for the following line.  Are you just trying to move (rather than copy) the data from <code>Ark2!C2:C16</code> to <code>Ark1!B2:B16</code> - no other conditions apart from that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6932188"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545214493, "post_id": 53848515, "comment_id": 94545528, "body": "sorry @SJR , the line error is currently at line 4 &quot;n&#248;gletal = Range(&quot;B2:B16&quot;)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545214611, "post_id": 53848515, "comment_id": 94545593, "body": "Sorry - thinking of rolling back your updates. As you update your question with the corrected code the question vanishes so people with the same problem won&#39;t find the answer...."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6932188"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545214624, "post_id": 53848515, "comment_id": 94545601, "body": "@DarrenBartrup-Cook i am trying to copy data from Ark2 over to Ark1. yes that is also where i am now, with the error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6932188"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545215421, "post_id": 53848515, "comment_id": 94546055, "body": "@DarrenBartrup-Cook  , it works if i only do for (&quot;B2&quot;), but as soon as i try (&quot;B2:B16&quot;) it comes up with mismatch"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545216830, "post_id": 53848515, "comment_id": 94546845, "body": "You can copy data from <code>C2:C16</code> to <code>B2:B16</code> using either <code>ThisWorkbook.Worksheets(&quot;Ark1&quot;).Range(&quot;B2:B16&quot;).Value = ThisWorkbook.Worksheets(&quot;Ark2&quot;).Range(&quot;C2:C16&quot;).Value</code> if it&#39;s just values you&#39;re after, or if you want formula/formatting as well then you can use <code>ThisWorkbook.Worksheets(&quot;Ark2&quot;).Range(&quot;C2:C16&quot;).Copy Destination:=ThisWorkbook.Worksheets(&quot;Ark1&quot;).Range(&quot;B2:B16&quot;)</code>&zwnj;&#8203;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6932188"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545219520, "post_id": 53848515, "comment_id": 94548250, "body": "@DarrenBartrup-Cook you are my angle! thank you!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545219742, "post_id": 53848515, "comment_id": 94548345, "body": "I didn&#39;t want to add it as an answer as it doesn&#39;t answer the actual question (you&#39;re trying to set a range to a string variable), but it resolves the problem.  The answer to the question is to define <code>n&#248;gletal</code> as a range:  <code>Dim n&#248;gletal As Range: Set n&#248;gletal = Range(&quot;B2:B16&quot;)</code> which would get rid of the type mismatch error, but not make the code work."}], "owner": {"user_type": "does_not_exist", "display_name": "user6932188"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545214662, "creation_date": 1545212939, "last_edit_date": 1545214662, "question_id": 53848515, "link": "https://stackoverflow.com/questions/53848515/run-time-error13%c2%b4-type-mismatch-moving-data-from-one-sheet-to-another", "title": "run-time error`13&#180; type mismatch, moving data from one sheet to another", "body": "<p>The error is: </p>\n\n<blockquote>\n  <p>error: Invalid Outside Procedure</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre><code>Sub MyProcedure()\na = Worksheets(\"ark1\").Cells(Rows.Count, 1).End(xlUp).Row\n\nMsgBox (a)\n\nEnd Sub\n</code></pre>\n\n<p>my first sheet is called Ark2 and my updated sheet is called Ark1. my first row i wanted to move, is a string and called \"n\u00f8gletal\", my other column is called \u00e5r and it is integers. i wanted to move all date within cell\u00b4s ranging from c2 to c16 and b2 to b16, to the other sheet.</p>\n\n<p>i am now getting the error on line 4        \" n\u00f8gletal = Range(\"B2:B16\")\"</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim n\u00f8gletal As String, \u00e5r As Integer\n    Worksheets(\"Ark2\").Select\n    n\u00f8gletal = Range(\"B2:B16\")\n    \u00e5r = Range(\"C2:C16\")\n    Worksheets(\"Ark1\").Select\n    Worksheets(\"Ark1\").Range(\"A4\").Select\n    If Worksheets(\"Ark1\").Range(\"A4\").Offset(1, 0) &lt;&gt; \"\" Then\n    Worksheets(\"Ark1\").Range(\"A4\").End(xlDown).Select\n    End If\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.Value = n\u00f8gletal\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = \u00e5r\n    Worksheets(\"Ark2\").Select\n    Worksheets(\"Ark2\").Range(\"B2\", \"B16\").Select\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "edited": false, "score": 0, "creation_date": 1545213635, "post_id": 53848492, "comment_id": 94544994, "body": "Are you having problems copying and pasting? If so what error at you getting at what line."}, {"owner": {"reputation": 15, "user_id": 10753947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LVwhyrsldtk/AAAAAAAAAAI/AAAAAAAAJr4/XU947Cbu67U/photo.jpg?sz=128", "display_name": "Gary Tang", "link": "https://stackoverflow.com/users/10753947/gary-tang"}, "reply_to_user": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "edited": false, "score": 0, "creation_date": 1545282573, "post_id": 53848492, "comment_id": 94573235, "body": "It will run into this error &quot;Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": true, "score": 1, "last_activity_date": 1545216256, "last_edit_date": 1545216256, "creation_date": 1545214272, "answer_id": 53848933, "question_id": 53848492, "link": "https://stackoverflow.com/questions/53848492/vba-copying-a-range-and-pasting-to-another-worksheet/53848933#53848933", "title": "VBA Copying a Range and pasting to another worksheet", "body": "<p>Please replace with the below:</p>\n\n<pre><code>Dim rn As Range, rn1 As Range, sh As Worksheet, sh1 As Worksheet\n\n\nSet sh = Sheet2\nSet sh1 = Sheet3\n\nWith sh\n\nSet rn = .Range(.Cells(i, 2), .Cells(i, c))\nSet rn1 = sh1.Cells(i, 2)\n\n\nrn.Copy rn1\n\nEnd With\n</code></pre>\n\n<p>if c it is not a variable please replace with \"c\"</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 10753947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LVwhyrsldtk/AAAAAAAAAAI/AAAAAAAAJr4/XU947Cbu67U/photo.jpg?sz=128", "display_name": "Gary Tang", "link": "https://stackoverflow.com/users/10753947/gary-tang"}, "edited": false, "score": 0, "creation_date": 1545277182, "post_id": 53849818, "comment_id": 94572181, "body": "Hi I tried your code, but it will run into this error &quot;Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed&quot;"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1545217162, "creation_date": 1545217162, "answer_id": 53849818, "question_id": 53848492, "link": "https://stackoverflow.com/questions/53848492/vba-copying-a-range-and-pasting-to-another-worksheet/53849818#53849818", "title": "VBA Copying a Range and pasting to another worksheet", "body": "<p>Try this:  </p>\n\n<pre><code>Sheet2.Range(Cells(i, 2), Cells(i, c)).Copy destination:=Sheet3.Cells(i, 2)\n</code></pre>\n\n<p>If you do it in 2 steps, you might need to <code>.Resize</code> the target range in order to match the size of the source range.</p>\n"}], "owner": {"reputation": 15, "user_id": 10753947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LVwhyrsldtk/AAAAAAAAAAI/AAAAAAAAJr4/XU947Cbu67U/photo.jpg?sz=128", "display_name": "Gary Tang", "link": "https://stackoverflow.com/users/10753947/gary-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 53848933, "answer_count": 2, "score": 0, "last_activity_date": 1545217162, "creation_date": 1545212860, "question_id": 53848492, "link": "https://stackoverflow.com/questions/53848492/vba-copying-a-range-and-pasting-to-another-worksheet", "title": "VBA Copying a Range and pasting to another worksheet", "body": "<p>I'm trying to copy a range from a cell to the end of another cell in the same row.\nI have the following code in an if loop.</p>\n\n<pre><code>Sheet2.Range(Cells(i, 2), Cells(i, c)).Copy\nSheet3.Cells(i, 2).Paste\n</code></pre>\n\n<p>Sheet2 and Sheet 3 are structured in the same way thus I'm using the same variables for the row.</p>\n\n<p>On top of that, how do I paste cells to the next empty cell of that particular row of the loop?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545227945, "post_id": 53851353, "comment_id": 94552951, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.hpagebreaks\" rel=\"nofollow noreferrer\">HPageBreaks</a> is a collection so you can step through it using a <code>For...Each</code> loop. While trying to test that I also found that If you add a page break that does not intersect the print area, then the newly-added <code>HPageBreak</code> object will not appear in the <code>HPageBreaks</code> collection for the print area. - my testing was failing because the count was 0. So might need <code>.PageSetup.PrintArea = nmAddress</code> before the loop and then could use: <code>Dim pb As HPageBreak:For Each pb In .HPageBreaks:j=j+1:Next pb</code>."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1545222763, "creation_date": 1545222763, "answer_id": 53851353, "question_id": 53848434, "link": "https://stackoverflow.com/questions/53848434/vba-excel-is-it-possible-to-count-horizontal-page-breaks-in-a-named-range/53851353#53851353", "title": "VBA Excel: Is it possible to count horizontal page breaks in a named range?", "body": "<h1>PB Hell</h1>\n\n<p>I suggest you study first this code for one named range, then you will easily create a loop for all of them.</p>\n\n<pre><code>Sub PageBr()\n\n  Const cStrName As String = \"HPBr\"\n  Const cStrRange As String = \"B50:B250\"\n  Dim nmAddress As String\n  Dim i As Integer\n  Dim j As Integer\n\n  With Sheet1\n\n    ' Define a name (Refers to ThisWorkbook (.Parent)).\n    .Parent.Names.Add cStrName, .Range(\"B50:B250\")\n    nmAddress = .Parent.Names(cStrName).RefersToRange.Address\n\n    ' Add horizontal pagebreaks.\n    With .HPageBreaks\n      .Add Before:=.Parent.Range(\"A59\")\n      .Add Before:=.Parent.Range(\"B159\")\n      .Add Before:=.Parent.Range(\"A248\")\n      .Add Before:=.Parent.Range(\"D269\")\n    End With\n\n    ' Range version\n    For i = 1 To .HPageBreaks.Count\n      If Not Intersect(.Range(.HPageBreaks(i).Location.Address) _\n          .Resize(, .Columns.Count), .Range(nmAddress)) Is Nothing Then\n        j = j + 1\n      End If\n    Next\n    Debug.Print \"The named range '\" &amp; cStrName &amp; \"' contains \" &amp; j _\n        &amp; \" horizontal pagebreaks.\"\n\n    ' Row version\n    Dim pbRow As Long\n    Dim nmRow1 As Long\n    Dim nmRow2 As Long\n\n    nmRow1 = .Range(nmAddress).Row\n    nmRow2 = .Range(nmAddress).Rows.Count + .Range(nmAddress).Row - 1\n\n    j = 0\n    For i = 1 To .HPageBreaks.Count\n      pbRow = .Range(.HPageBreaks(i).Location.Address).Row\n      If pbRow &gt;= nmRow1 And pbRow &lt;= nmRow2 - 1 Then\n        j = j + 1\n      End If\n    Next\n    Debug.Print \"The named range '\" &amp; cStrName &amp; \"' contains \" &amp; j _\n        &amp; \" horizontal pagebreaks.\"\n\n  End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 1, "last_activity_date": 1545223499, "creation_date": 1545223499, "answer_id": 53851560, "question_id": 53848434, "link": "https://stackoverflow.com/questions/53848434/vba-excel-is-it-possible-to-count-horizontal-page-breaks-in-a-named-range/53851560#53851560", "title": "VBA Excel: Is it possible to count horizontal page breaks in a named range?", "body": "<p>Welcome to SO. May simply scan named ranges and then rows of the range for already existing page breaks. But I am afraid it is  slow process and may take long time in file with many long named ranges. may please modify it according to your requirement. </p>\n\n<pre><code>Sub test()\nDim Rw As Range\nDim RngStr As String, Nm As Name\n\n    For Each Nm In ThisWorkbook.Names\n    RngStr = Nm.Name\n        For Each Rw In Range(RngStr).Rows\n            If Rw.PageBreak &lt;&gt; xlNone Then\n            Debug.Print RngStr &amp; \" on \" &amp; Range(RngStr).Address(, , , True) &amp; \" has a Pagebreak at Row \" &amp; Rw.Row\n            End If\n        Next Rw\n    Next Nm\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545230991, "post_id": 53853135, "comment_id": 94554764, "body": "Could you explain the difference between HPBr (2 horizontal page breaks), and Sheet1!HPBr (3 horizontal page breaks)? I&#39;m using your function on my workbook and I have only this one name."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545231166, "post_id": 53853135, "comment_id": 94554871, "body": "Erm, probably my second to last paragraph explains that (does the address for HPBr cross 3 breaks when applied on a different sheet?)  I&#39;ll take another look at the code."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545231541, "post_id": 53853135, "comment_id": 94555091, "body": "Is definitely saying <code>Sheet1!HPBr</code> and not <code>Sheet1!Print_Area</code>? (that&#39;s what I got with HPBr covering <code>Sheet1!B44:E56</code> so it crossed one H Page Break)."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1545231700, "post_id": 53853135, "comment_id": 94555186, "body": "Sorry, my mistake. I added manully a HPB Name before. Sorry. Works like a charm."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1545229078, "creation_date": 1545229078, "answer_id": 53853135, "question_id": 53848434, "link": "https://stackoverflow.com/questions/53848434/vba-excel-is-it-possible-to-count-horizontal-page-breaks-in-a-named-range/53853135#53853135", "title": "VBA Excel: Is it possible to count horizontal page breaks in a named range?", "body": "<p>Carrying on from my comment on @VBasic2008 answer, and blatantly pinching his <code>Intersect</code> idea I found this works:   </p>\n\n<pre><code>Sub CountBreaks()\n\n    Dim nr As Name\n    Dim Hpb As HPageBreak\n    Dim Vpb As VPageBreak\n    Dim h As Long, v As Long\n\n    'May need some method to look at a select number of named ranges.\n    For Each nr In ThisWorkbook.Names\n\n        For Each Hpb In nr.RefersToRange.Parent.HPageBreaks\n            If Not Intersect(Range(Hpb.Location.Address).EntireRow, _\n                             Range(nr.RefersToRange.Address)) Is Nothing Then\n                h = h + 1\n            End If\n        Next Hpb\n\n        For Each Vpb In nr.RefersToRange.Parent.VPageBreaks\n            If Not Intersect(Range(Vpb.Location.Address).EntireColumn, _\n                             Range(nr.RefersToRange.Address)) Is Nothing Then\n                v = v + 1\n            End If\n        Next Vpb\n\n        MsgBox nr.Name &amp; \" has: \" &amp; vbCr &amp; _\n            h &amp; \" horizontal page breaks.\" &amp; vbCr &amp; _\n            v &amp; \" vertical page breaks.\", vbOKOnly + vbInformation\n\n        h = 0\n        v = 0\n\n    Next nr\n\nEnd Sub\n</code></pre>\n\n<p>I hope I've got the sheet qualifications correct - i.e. I think <code>Range(Hpb.Location.Address)</code> refers to the correct sheet as well.  </p>\n\n<p>The <code>.PageSetup.PrintArea = nmAddress</code> in the comment wasn't needed - was just having problems because my sheet didn't have any data on it.</p>\n"}], "owner": {"reputation": 11, "user_id": 10810186, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157898741619989/picture?type=large", "display_name": "Lasse F&#230;rch", "link": "https://stackoverflow.com/users/10810186/lasse-f%c3%a6rch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1545315116, "creation_date": 1545212634, "last_edit_date": 1545315116, "question_id": 53848434, "link": "https://stackoverflow.com/questions/53848434/vba-excel-is-it-possible-to-count-horizontal-page-breaks-in-a-named-range", "title": "VBA Excel: Is it possible to count horizontal page breaks in a named range?", "body": "<p>I have a lot of automatically generated reports, each consisting 24 named ranges.</p>\n\n<p>Each named range can't be broken by a horizontal page break.</p>\n\n<p>My idea was to loop through all named ranges and count the page breaks within.</p>\n\n<p>But I can't find a way to count page breaks within a named range.</p>\n\n<p>Does anybody know if it is possible at all?</p>\n\n<p>EDIT: Thanks for the suggestions. Hopefully i can find the time to test it before Christmas, otherwise i will come back and answer in January.</p>\n"}, {"tags": ["sql", "excel", "vba", "aggregation", "adodb"], "comments": [{"owner": {"reputation": 333, "user_id": 7078827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3081c6d0cdd072a5061a201ba4d75306?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233;", "link": "https://stackoverflow.com/users/7078827/andr%c3%a9"}, "edited": false, "score": 0, "creation_date": 1545214156, "post_id": 53848318, "comment_id": 94545336, "body": "Please give some more information. In which way you execute your query?"}, {"owner": {"reputation": 327, "user_id": 10012449, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uXjRbiOGMic/AAAAAAAAAAI/AAAAAAAACI8/XoP8BFLlqFw/photo.jpg?sz=128", "display_name": "Michal Palko", "link": "https://stackoverflow.com/users/10012449/michal-palko"}, "reply_to_user": {"reputation": 333, "user_id": 7078827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3081c6d0cdd072a5061a201ba4d75306?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233;", "link": "https://stackoverflow.com/users/7078827/andr%c3%a9"}, "edited": false, "score": 0, "creation_date": 1545215223, "post_id": 53848318, "comment_id": 94545954, "body": "I extended my question. I use recordset open and copyfromrecordset to destination."}], "owner": {"reputation": 327, "user_id": 10012449, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uXjRbiOGMic/AAAAAAAAAAI/AAAAAAAACI8/XoP8BFLlqFw/photo.jpg?sz=128", "display_name": "Michal Palko", "link": "https://stackoverflow.com/users/10012449/michal-palko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545239548, "creation_date": 1545212256, "last_edit_date": 1545239548, "question_id": 53848318, "link": "https://stackoverflow.com/questions/53848318/vba-sql-aggregate-memo-field", "title": "VBA SQL Aggregate memo field", "body": "<p>I have query from Excel file that retrieves key and description (memo field).</p>\n\n<p>Source: </p>\n\n<pre><code>key  | description\nk1     long variable text (memo) maybe up to 1000 char\nk2     long variable text (memo) maybe up to 1000 char\nk3     long variable text (memo) maybe up to 1000 char\nk1     shorter than k1 text (memo) maybe up to 1000 char\nk2             \nk1     could be also empty\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>KEY    DESCRIPTION\nk1     long variable text (memo) maybe up to 1000 char\nk2     long variable text (memo) maybe up to 1000 char\nk3     long variable text (memo) maybe up to 1000 char\n</code></pre>\n\n<p>My code is </p>\n\n<pre><code>SELECT \n    key as KEY, \n    IIF(Count(description) = 1, MAX(description), COUNT(description)) AS DESCRIPTION \nFROM Source \nGROUP BY key\n</code></pre>\n\n<p>But Excel returns an error that it cannot aggregate a memo field. </p>\n\n<p>Is there some elegant solution? </p>\n\n<p>I use ADOdb with Provider=Microsoft.ACE.OLEDB.12.0</p>\n\n<pre><code>Sub getRs(strSQL As String)\nDim strConn As String\nDim i As Integer\n\nstrConn = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n        \"Extended Properties=Excel 12.0;\"\n\nSet Rs = CreateObject(\"ADODB.Recordset\")\nRs.Open strSQL, strConn\n\nEnd Sub\n</code></pre>\n\n<p>Connecting to other workbook looks like  (I do not think it is issue)</p>\n\n<pre><code>    \"SELECT --Look above-- FROM [Sheet1$] \" &amp; _\n    \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Src2.xlsb' \" &amp; _\n    \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;']\"\n</code></pre>\n\n<p>Now I try to \"cut\" description by LEN and IIF function:</p>\n\n<pre><code>  SELECT \n    [key] as [KEY], \n    IIF(Count([description]) = 1, \n         IIF(LEN([description])&gt;255, \n            '[CUT]' &amp; MAX(LEFT([description],240)), \n            COUNT([description])), \n         IIF(LEN([description])&gt;255, \n            '[[CUT]' &amp; MAX(LEFT([description],240)) &amp; ']', \n            '[' &amp; COUNT([description]) &amp; ']' )) AS [DESCRIPTION]\n   FROM Source \n   GROUP BY [key]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bp458.png\" rel=\"nofollow noreferrer\">but now I have this error message</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1545213879, "post_id": 53848186, "comment_id": 94545140, "body": "It&#39;s always much quicker to do the heavy lifting in arrays and only write back to the sheet once done."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10808941"}, "is_accepted": false, "score": 1, "last_activity_date": 1545217414, "last_edit_date": 1545217414, "creation_date": 1545214818, "answer_id": 53849109, "question_id": 53848186, "link": "https://stackoverflow.com/questions/53848186/split-copy-move-cell-contents-to-pre-specified-corresponding-columns/53849109#53849109", "title": "Split/Copy/Move cell contents to pre-specified/corresponding columns", "body": "<p>You will need a loop to walk through while you split the cell contents. Looping through an array is faster than looping through the worksheet. After splitting, populate a target array with matching columns before putting the target array values into the worksheet.</p>\n\n<pre><code>Option Explicit\n\nSub InsertOptions()\n\n    Dim i As Long, j As Long, mx As Long, dlm As String\n    Dim hdrs As Variant, opts As Variant, vals As Variant, tmp As Variant, m As Variant\n\n    dlm = \" | \"   'column A delimiter; might be \" | \"\n    mx = 15       'maximum number of options\n\n    With Worksheets(\"sheet9\")\n\n        'create an independent array of header labels\n        ReDim hdrs(1 To 1, 1 To mx)\n        For i = LBound(hdrs, 2) To UBound(hdrs, 2)\n            hdrs(1, i) = \"Option \" &amp; i\n        Next i\n\n        'collect the delimited options from column A\n        opts = Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp)).Value2\n\n        'make room for all options in expanded form\n        ReDim vals(LBound(opts, 1) To UBound(opts, 1), _\n                   LBound(hdrs, 2) To UBound(hdrs, 2))\n\n        'loop through delimited options, split them and look for matches in hdrs\n        For i = LBound(opts, 1) To UBound(opts, 1)\n            tmp = Split(opts(i, 1), dlm)\n            For j = LBound(tmp) To UBound(tmp)\n                m = Application.Match(tmp(j), hdrs, 0)\n                If Not IsError(m) Then\n                    vals(i, m) = tmp(j)\n                End If\n            Next j\n        Next i\n\n        'insert ten new columns\n        .Cells(1, \"B\").Resize(1, UBound(hdrs, 2)).EntireColumn.Insert\n\n        'put arrays into new columns\n        With .Cells(1, \"B\").Resize(1, UBound(hdrs, 2)).EntireColumn\n            .ColumnWidth = 9\n            .Cells(1, 1).Resize(UBound(hdrs, 1), UBound(hdrs, 2)) = hdrs\n            .Cells(2, 1).Resize(UBound(vals, 1), UBound(vals, 2)) = vals\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10810058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tLmIoG94x5M/AAAAAAAAAAI/AAAAAAAABkg/SZ5YsT-tHq4/photo.jpg?sz=128", "display_name": "Adwaith Kuttikkatt", "link": "https://stackoverflow.com/users/10810058/adwaith-kuttikkatt"}, "edited": false, "score": 0, "creation_date": 1545234970, "post_id": 53850058, "comment_id": 94557403, "body": "Thanks a lot :)  I tried it on a heavier dataset and is definitely faster than my solution."}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 1, "last_activity_date": 1545218697, "last_edit_date": 1545218697, "creation_date": 1545217974, "answer_id": 53850058, "question_id": 53848186, "link": "https://stackoverflow.com/questions/53848186/split-copy-move-cell-contents-to-pre-specified-corresponding-columns/53850058#53850058", "title": "Split/Copy/Move cell contents to pre-specified/corresponding columns", "body": "<p>Variant using <code>System.Collections.ArrayList</code> and <code>Scripting.Dictionary</code>, I guess that should be faster than your solution)</p>\n\n<pre><code>Sub test()\n    Dim data As Range, cl As Range, i&amp;, x As Variant\n    Dim arrList As Object, Dic As Object\n    Set arrList = CreateObject(\"System.Collections.ArrayList\")\n    Set Dic = CreateObject(\"Scripting.Dictionary\")\n    Set data = Range([A2], Cells(Rows.Count, \"A\").End(xlUp))\n\n    'get unique values from split\n    For Each cl In data\n        For Each x In Split(cl, \"|\"): x = Trim(x)\n            If Not Dic.exists(x) Then\n                Dic.Add x, Nothing\n                arrList.Add x\n            End If\n    Next x, cl\n\n    Dic.RemoveAll        'clear dictionary\n\n    arrList.Sort         'sort values\n    If sortorder = xlDescending Then\n        arrList.Reverse\n    End If\n\n    'add headers\n    i = 2\n    For Each x In arrList\n        Cells(1, i).Value2 = x\n        Dic.Add x, i: i = i + 1\n    Next x\n    'split values against headers\n    For Each cl In data\n        For Each x In Split(cl, \"|\"): x = Trim(x)\n            Cells(cl.Row, Dic(x)).Value2 = x\n    Next x, cl\nEnd Sub\n</code></pre>\n\n<p><strong>test here</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/GyjHU.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GyjHU.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 10810058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tLmIoG94x5M/AAAAAAAAAAI/AAAAAAAABkg/SZ5YsT-tHq4/photo.jpg?sz=128", "display_name": "Adwaith Kuttikkatt", "link": "https://stackoverflow.com/users/10810058/adwaith-kuttikkatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 53850058, "answer_count": 2, "score": 0, "last_activity_date": 1545242993, "creation_date": 1545211829, "last_edit_date": 1545239928, "question_id": 53848186, "link": "https://stackoverflow.com/questions/53848186/split-copy-move-cell-contents-to-pre-specified-corresponding-columns", "title": "Split/Copy/Move cell contents to pre-specified/corresponding columns", "body": "<p>I have the following situation. In an Excel worksheet, I have a column which contains values that are separated by \"|\". \ne.g. </p>\n\n<pre><code>Option Column\nOption 1 | Option 3\nOption 4 | Option 7\nOption 2 | Option 3 | Option 6\n</code></pre>\n\n<p>I want to </p>\n\n<pre><code>1. Insert 10 columns to the right, name them \"Option 1\", \"Option 2\", \"Option 3\" ..... \"Option 10\"\n2. In each cell of the first column, if \"Option x\" exists, split/copy/move to the column named \"Option x\" (Where x can be 1, 2 .... 10)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/D5XbT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D5XbT.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the code that I use currently to achieve it: </p>\n\n<pre><code>   Sub Insert_10_columns()\n    Columns(\"B:K\").Insert Shift:=xlToRight, _\n      CopyOrigin:=xlFormatFromLeftOrAbove\n    For i = 2 To 11\n    ActiveSheet.Cells(1, i).Value = \"Option \" &amp; i - 1\n    Next i\nEnd Sub\n\nSub Look_For_Text()\n    Dim LastRow As Long\n    LastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 2 To LastRow + 1\n        For k = 1 To 10\n            If InStr(1, (Cells(i, 1).Value), \"Option \" &amp; k) &gt; 0 Then\n            ActiveSheet.Cells(i, k + 1).Value = \"Option \" &amp; k\n            End If\n        Next k\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I was just wondering if loops are the best way to go about it, especially because when I start using it, I would be operating on 20,000+ rows and 15+ columns.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1545262428, "post_id": 53848162, "comment_id": 94569182, "body": "Can you share/post your current code?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1545262946, "post_id": 53848162, "comment_id": 94569326, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.subject\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1545284561, "last_edit_date": 1545284561, "creation_date": 1545275945, "answer_id": 53861980, "question_id": 53848162, "link": "https://stackoverflow.com/questions/53848162/outlook-vba-how-can-i-add-suffix-on-mail-subject-before-forward-reply-or-repl/53861980#53861980", "title": "Outlook vba - How can i add suffix on mail subject before forward, reply or replay to all?", "body": "<p>You could <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Outlook.MailItem.Reply(method)\" rel=\"nofollow noreferrer\">reply</a> or <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Outlook.MailItem.ReplyAll(even)\" rel=\"nofollow noreferrer\">replyAl</a>l an email and add suffix to subject using the below code:</p>\n\n<pre><code>Option Explicit\nSub ReplyMSG()\n    Dim olItem As Outlook.MailItem\n    Dim olReply As MailItem ' Reply\n    Dim olRecip As Recipient ' Add Recipient\n\n    For Each olItem In Application.ActiveExplorer.Selection\nSet olReply = olItem.ReplyAll\nolReplay.Subject = = olItem.Subject &amp; \u201csuffix\u201d\n    Set olRecip = olReply.Recipients.Add(\"Email Address Here\") ' Recipient Address\n        olRecip.Type = olCC\n            olReply.HTMLBody = \"Hello, Thank you. \" &amp; vbCrLf &amp; olReply.HTMLBody\n        olReply.Display\n\n        'olReply.Send\n    Next olItem\nEnd Sub\n</code></pre>\n\n<p>Reference from:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/31817632/outlook-reply-or-replyall-to-an-email\">Outlook Reply or ReplyAll to an Email</a></p>\n\n<p>If you want to forward an email and add suffix to subject, please refer to the below code:</p>\n\n<pre><code>Sub ForwardEmail(item As Outlook.MailItem)\n  Dim oMail As MailItem    \n\n  On Error GoTo Release\n\n  If item.Class = olMail Then\n     Set oMail = item.Forward\n     oMail.Subject = oMail.Subject &amp; \u201csuffix\u201d\n     oMail.HTMLBody = \"Have a nice day.\" &amp; vbCrLf &amp; oMail.HTMLBody\n     oMail.Recipients.Add \"email address here\"\n\n     oMail.Save\n     oMail.Send\n  End If\n Release:\n  Set oMail = Nothing\n  Set oExplorer = Nothing\nEnd Sub\n</code></pre>\n\n<p>Reference from:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28840066/forward-email-with-its-attachment-in-outlook-2010\">Forward Email with its attachment in Outlook 2010</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10805235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68451f85ceff25e60a4b3b644af1e347?s=128&d=identicon&r=PG", "display_name": "Crashoverridee2002", "link": "https://stackoverflow.com/users/10805235/crashoverridee2002"}, "is_accepted": false, "score": 0, "last_activity_date": 1545300431, "creation_date": 1545300431, "answer_id": 53866434, "question_id": 53848162, "link": "https://stackoverflow.com/questions/53848162/outlook-vba-how-can-i-add-suffix-on-mail-subject-before-forward-reply-or-repl/53866434#53866434", "title": "Outlook vba - How can i add suffix on mail subject before forward, reply or replay to all?", "body": "<p>Properly going to be hard, because depending on your hierarchy location you would only have a set number of rights and i do not think VB Macro would be allowed i know in many organizations here in Denmark VB Macros is a no no.</p>\n\n<p>But you can create a Macro in the background where you grep Current mail and then alter the subject and then set it to when you press CTRL + R as you normally do when you reply but it might conflict so be careful because you might not want it on all emails. that you reply to.</p>\n"}], "owner": {"reputation": 1, "user_id": 10810170, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8akESvNkobI/AAAAAAAAAAI/AAAAAAAAAKI/6BUEPciDVN0/photo.jpg?sz=128", "display_name": "Corrado", "link": "https://stackoverflow.com/users/10810170/corrado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592700518, "creation_date": 1545211711, "last_edit_date": 1592700518, "question_id": 53848162, "link": "https://stackoverflow.com/questions/53848162/outlook-vba-how-can-i-add-suffix-on-mail-subject-before-forward-reply-or-repl", "title": "Outlook vba - How can i add suffix on mail subject before forward, reply or replay to all?", "body": "<p>I need to forward or reply to a mail, then add suffix on subject, and send it.\nthanks in advance</p>\n"}, {"tags": ["excel", "vba", "spreadsheet"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 10671405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O2K4g.png?s=128&g=1", "display_name": "Minhaj Javed", "link": "https://stackoverflow.com/users/10671405/minhaj-javed"}, "edited": false, "score": 0, "creation_date": 1545214578, "post_id": 53848792, "comment_id": 94545576, "body": "Thanks for the reply but what I want is in Sheet1 there are 5 columns and I want to check column C, D and E at same time for duplication if found then copy both duplicated rows to Sheet2"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 333, "user_id": 10671405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O2K4g.png?s=128&g=1", "display_name": "Minhaj Javed", "link": "https://stackoverflow.com/users/10671405/minhaj-javed"}, "edited": false, "score": 0, "creation_date": 1545214771, "post_id": 53848792, "comment_id": 94545702, "body": "So, what are asking for is combine Col 3 value &amp; Col 4 value &amp; Col 5 value together as one string and check for duplicates?"}, {"owner": {"reputation": 333, "user_id": 10671405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O2K4g.png?s=128&g=1", "display_name": "Minhaj Javed", "link": "https://stackoverflow.com/users/10671405/minhaj-javed"}, "edited": false, "score": 0, "creation_date": 1545219463, "post_id": 53848792, "comment_id": 94548209, "body": "the excel went on not responding even waiting for about 30 minutes"}, {"owner": {"reputation": 333, "user_id": 10671405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O2K4g.png?s=128&g=1", "display_name": "Minhaj Javed", "link": "https://stackoverflow.com/users/10671405/minhaj-javed"}, "edited": false, "score": 0, "creation_date": 1545220500, "post_id": 53848792, "comment_id": 94548751, "body": "I tried to run on 1000 records and it works fine. Thanks for your solution"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1545215634, "last_edit_date": 1545215634, "creation_date": 1545213791, "answer_id": 53848792, "question_id": 53848155, "link": "https://stackoverflow.com/questions/53848155/find-duplicated-data-in-multiple-cells-and-copy-all-to-other-excel-sheet/53848792#53848792", "title": "Find Duplicated data in multiple cells and copy all to other excel sheet", "body": "<p>@Emm Jay could you please be more specific? I m not sure what are you asking for, but the below code may help you to get an overall idea.</p>\n\n<p>Let's say that Sheet 1 contains our data &amp; duplicate rows will copy on Sheet 2.</p>\n\n<p>Sheet 1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/N75CL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N75CL.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet 2 - Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Un2Yk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Un2Yk.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nSub Duplicates()\n\n    Dim LastrowS1 As Long, LastrowS2 As Long, i As Long, j As Long\n    Dim CombineStrI As String, CombineStrJ As String\n\n    LastrowS1 = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 2 To LastrowS1\n\n        CombineStrI = Sheet1.Range(\"C\" &amp; i).Value &amp; \"_\" &amp; Sheet1.Range(\"D\" &amp; i).Value &amp; \"_\" &amp; Sheet1.Range(\"E\" &amp; i).Value\n\n        For j = 2 To LastrowS1\n\n            CombineStrJ = Sheet1.Range(\"C\" &amp; j).Value &amp; \"_\" &amp; Sheet1.Range(\"D\" &amp; j).Value &amp; \"_\" &amp; Sheet1.Range(\"E\" &amp; j).Value\n\n            If j &lt;&gt; i Then\n\n                If CombineStrI = CombineStrJ Then\n                    Sheet1.Rows(i).Copy\n                    LastrowS2 = Sheet2.Cells(Sheet2.Rows.Count, \"A\").End(xlUp).Row\n                    Sheet2.Range(\"A\" &amp; LastrowS2 + 1).PasteSpecial\n                End If\n\n            End If\n\n        Next j\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 10671405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O2K4g.png?s=128&g=1", "display_name": "Minhaj Javed", "link": "https://stackoverflow.com/users/10671405/minhaj-javed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53848792, "answer_count": 1, "score": 1, "last_activity_date": 1579253213, "creation_date": 1545211691, "last_edit_date": 1579253213, "question_id": 53848155, "link": "https://stackoverflow.com/questions/53848155/find-duplicated-data-in-multiple-cells-and-copy-all-to-other-excel-sheet", "title": "Find Duplicated data in multiple cells and copy all to other excel sheet", "body": "<p>I have excel sheet with around 40k records and 5 columns. I want to search duplicates in column 3, 4, 5 and copy whole row in new sheet.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "string-length", "multiple-conditions"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9650953, "user_type": "registered", "profile_image": "https://graph.facebook.com/2064593543555601/picture?type=large", "display_name": "Xalion", "link": "https://stackoverflow.com/users/9650953/xalion"}, "edited": false, "score": 0, "creation_date": 1545212248, "post_id": 53847914, "comment_id": 94544165, "body": "Erik, thank you! I really appreciate your help again, I&#39;m always learning something new. First I tried to find a working solution, knowing that it may not be optimal. However, you actually gave me both: a working solution and a more optimal one. I will test it shortly and accept your answer then!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 4, "last_activity_date": 1545210816, "creation_date": 1545210816, "answer_id": 53847914, "question_id": 53847776, "link": "https://stackoverflow.com/questions/53847776/ms-access-sql-inner-join-two-conditions-and-len-function/53847914#53847914", "title": "MS Access - SQL Inner Join two conditions and Len-Function", "body": "<p>Avoid using complex joins in update queries! Since the entire recordset needs to be updateable, Access tends to have problems with it.</p>\n\n<p>Instead, use a <code>WHERE</code> clause:</p>\n\n<pre><code>UPDATE ReiseMaster\nINNER JOIN ReiseMaster_Import\nON(ReiseMaster.[Attachment Indicator] &lt;&gt; ReiseMaster_Import.[Attachment Indicator])\nSET ReiseMaster.[Attachment Indicator]  = Date() - 1\nWHERE  LEN(ReiseMaster.[Attachment Indicator]) &lt;= 1\n</code></pre>\n\n<p>Also, Access uses brackets to escape spaces in column names.</p>\n\n<p>Note that if you're not using any information from the joined table, and just use it to select records, you should use an <code>Exists</code> clause instead:</p>\n\n<pre><code>UPDATE ReiseMaster\nSET ReiseMaster.[Attachment Indicator]  = Date() - 1\nWHERE EXISTS(SELECT 1 FROM ReiseMaster_Import WHERE ReiseMaster.[Attachment Indicator] &lt;&gt; ReiseMaster_Import.[Attachment Indicator])\nAND LEN(ReiseMaster.[Attachment Indicator]) &lt;= 1\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9650953, "user_type": "registered", "profile_image": "https://graph.facebook.com/2064593543555601/picture?type=large", "display_name": "Xalion", "link": "https://stackoverflow.com/users/9650953/xalion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 53847914, "answer_count": 1, "score": 1, "last_activity_date": 1545210816, "creation_date": 1545210259, "question_id": 53847776, "link": "https://stackoverflow.com/questions/53847776/ms-access-sql-inner-join-two-conditions-and-len-function", "title": "MS Access - SQL Inner Join two conditions and Len-Function", "body": "<p>I have a database with a table which I use as master and which is being updated and extended on a daily basis by a table with the same layout. Before I update almost the whole master with daily data, I want to test if the values from a specific column changed during the daily update. Usually this column only contains Null or an \"X\". </p>\n\n<p>As a prototype I only compared the specific column of Table A and Table B and if there is a difference, set a value with more than one characters into the column (here yesterday's date). </p>\n\n<p>This is the code which worked as a prototype:</p>\n\n<pre><code>UPDATE ReiseMaster\nINNER JOIN Update_Import\nON(ReiseMaster.Col3 &lt;&gt; Update_Import.Col3 \nSET ReiseMaster.Col3  = Date() - 1\n</code></pre>\n\n<p>Now, the column contains Null, \"X\" or a date in the master. For the next update I now have to make sure that this previously updated column values which are containing a date as a string will be excluded (otherwise ReiseMaster.Col3 &lt;> Update_Import.Col3 will always be true for them in the future and the date will always be updated which is not intended to happen).</p>\n\n<p>My approach was to exclude all datasets from the master table where the length of the values in the column is longer than 1.</p>\n\n<p>Now here is my problem: </p>\n\n<p>Running the SQL code makes MS Access <strong>not responding</strong> anymore, the whole program crashes. Can somebody advise me what could be wrong with the following code?</p>\n\n<pre><code>UPDATE ReiseMaster\nINNER JOIN ReiseMaster_Import\nON(ReiseMaster.`Attachment Indicator` &lt;&gt; ReiseMaster_Import.`Attachment Indicator` AND LEN(ReiseMaster.`Attachment Indicator`) &lt;= 1)\nSET ReiseMaster.`Attachment Indicator`  = Date() - 1\n</code></pre>\n\n<p><strong>Additional info:</strong> I use Access VBA to run a code and during that also the SQL-statements which are being saved in a string. About the reason I add a date once I observe a change, I want to use the dates as a reference when the value has been changed for the first time to do further analysis with them in a later stage.</p>\n"}, {"tags": ["arrays", "vba", "ms-word"], "comments": [{"owner": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "edited": false, "score": 0, "creation_date": 1545210898, "post_id": 53847661, "comment_id": 94543359, "body": "Do you ReDim <code>rngIAM_Code</code> and <code>rngIAM_Title</code> at any point?"}, {"owner": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "edited": false, "score": 2, "creation_date": 1545211521, "post_id": 53847661, "comment_id": 94543692, "body": "Further i think the error you&#39;re getting is because you are assigning a variant array to a array. If you change <code>Dim rngIAM_Code() as range</code> to <code>Dim rngIAM_Code as variant</code> i think you should be good. Be aware that this is a variant array."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1545211905, "post_id": 53847661, "comment_id": 94543941, "body": "<code>foundRanges()</code> and <code>i</code> are initialized as variants. See: <a href=\"https://stackoverflow.com/a/28238732/To\">stackoverflow.com/a/28238732/To</a> properly declare them use <code>Dim i as Integer, dim foundCount As Integer</code>, or use <code>Dim i as Long, dim foundCount As Long</code> directly as VBA will store Integer to Long anyway (internally) <a href=\"https://stackoverflow.com/a/26409520/\">stackoverflow.com/a/26409520</a>"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 1, "creation_date": 1545212205, "post_id": 53847661, "comment_id": 94544139, "body": "On another note, maybe use a <code>Collection</code> to store your ranges, this avoids the re-dimming and you can get the count by using <code>aCollection.Count</code>. You can then also just run <code>for each aSomething in aCollection</code> to loop through every stored object."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 2, "last_activity_date": 1545214732, "creation_date": 1545214732, "answer_id": 53849083, "question_id": 53847661, "link": "https://stackoverflow.com/questions/53847661/sometimes-cant-assign-to-array-and-sometimes-can/53849083#53849083", "title": "Sometimes can&#39;t assign to array and sometimes can", "body": "<p>The following works for me.</p>\n\n<p>In this code, every object variable is explicitly assigned a type. In VBA, <em>every</em> variable must be typed, else it's assigned the type <code>Variant</code> by default. In the following declaration line, for example, <code>foundRanges()</code> is of type <code>Variant</code> because it's not followed by <code>As</code> with a data type. The same with <code>i</code> in the next line of code in the question.</p>\n\n<pre><code>Dim foundRanges(), rngSearch As Range\n</code></pre>\n\n<p>And since the arrays in the calling procedure are of type <code>Range</code> the function should return the same type.</p>\n\n<p>I also took the liberty of passing the <code>Document</code> object to the function as, conceivably, some day the document in question might not be <code>ActiveDocument</code> but a <code>Document</code> object assigned using <code>Documents.Open</code> or <code>Documents.Add</code>. If this is not desired it can be changed back, but not relying on <code>ActiveDocument</code> is more reliable...</p>\n\n<p>Additionally, I added the <code>Wrap</code> parameter to <code>Find.Execute</code> - it's always a good idea to specify that when executing Find in a loop to prevent the search from starting again at the beginning of the document (wdFindContinue).</p>\n\n<pre><code>Sub testRangesInArrays()\n    Dim rngIAM_Code() As Range\n    Dim rngIAM_Title() As Range\n\n    rngIAM_Code = findRanges(\"You\", ActiveDocument)\n    rngIAM_Title = findRanges(\"change\", ActiveDocument)\nEnd Sub\n\nFunction findRanges(keyword As String, doc As Word.Document) As Range()\n    Dim foundRanges() As Range, rngSearch As Range\n    Dim i As Integer, foundCount As Integer\n\n    i = 0\n    foundCount = 0\n    ReDim foundRanges(0)\n\n    Set rngSearch = doc.content\n    Do While rngSearch.Find.Execute(findText:=keyword, MatchWholeWord:=True, _\n                       Forward:=True, wrap:=wdFindStop) = True\n        Set foundRanges(i) = rngSearch.Duplicate\n        ReDim Preserve foundRanges(UBound(foundRanges) + 1)\n        i = i + 1\n        rngSearch.Collapse Direction:=wdCollapseEnd\n    Loop\n\n    findRanges = foundRanges\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545220696, "post_id": 53849861, "comment_id": 94548858, "body": "&quot;I also removed the underscores since they indicate a function of an implemented Interface and may cause problems later down the line.&quot; not really, not in VBA. In VBA that would only be a person convention - the programming language doesn&#39;t care."}, {"owner": {"reputation": 47, "user_id": 10743427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531a3f36ae3e81c98621ae918be871c2?s=128&d=identicon&r=PG", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439", "link": "https://stackoverflow.com/users/10743427/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9"}, "edited": false, "score": 0, "creation_date": 1545223147, "post_id": 53849861, "comment_id": 94550149, "body": "Thanks! I merged your approaches and it works just fine"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 47, "user_id": 10743427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531a3f36ae3e81c98621ae918be871c2?s=128&d=identicon&r=PG", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439", "link": "https://stackoverflow.com/users/10743427/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9"}, "edited": false, "score": 0, "creation_date": 1545223526, "post_id": 53849861, "comment_id": 94550344, "body": "@\u0421\u0435\u0440\u0433\u0435\u0439 If you found more than one &quot;Answer&quot; useful you should be able to upvote (click the up arrow) any contribution(s) you did not mark as &quot;The Answer&quot; (with the checkmark). That&#39;s the more reliable way to signal to others that information was useful - comments tend to get deleted... You should be able to upvote any contribution on the site (questions and answers) that you consider helpful. Once you&#39;ve gotten more reputation points (125) you can also downvote those contributions you consider destructive."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545226098, "post_id": 53849861, "comment_id": 94551793, "body": "@CindyMeister true, the problem only comes up if you use an underscore in the name of a function inside an Interface. But it (IMO) improves the readability of the code."}], "tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": false, "score": 1, "last_activity_date": 1545226436, "last_edit_date": 1545226436, "creation_date": 1545217282, "answer_id": 53849861, "question_id": 53847661, "link": "https://stackoverflow.com/questions/53847661/sometimes-cant-assign-to-array-and-sometimes-can/53849861#53849861", "title": "Sometimes can&#39;t assign to array and sometimes can", "body": "<p>Here is an alternative based on a Collection instead of an Array:<br>\nI used also included Cindys Input regarding passing the document and adding wrap.<br>\nI don't exactly know what the you use the return value for, but in general a collection is a bit more flexible than an Array.<br>\nI also removed the underscores since they <strike>indicate a function of an implemented Interface and may cause problems later down the line.</strike> are used when implementing an <code>Interface</code> (improves readability).<br>\nAs explained <a href=\"https://gregmaxey.com/word_tip_pages/words_fickle_vba_find_property.html\" rel=\"nofollow noreferrer\">here</a> you can use wrap or collapse to prevent a continuous Loop.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim rngIAMCode As Collection\n    Dim rngIAMTitle As Collection\n\n    Set rngIAMCode = findRanges(\"IAM_Code\", ActiveDocument)\n    Set rngIAMTitle = findRanges(\"IAM_Title\", ActiveDocument)\n\n    Debug.Print \"Code found : \" &amp; rngIAMCode.Count &amp; \" Times.\"\n    Debug.Print \"Title found : \" &amp; rngIAMTitle.Count &amp; \" Times.\"\n\nEnd Sub\n\n\n\nFunction findRanges(ByVal keyword As String, doc As Document) As Collection\n\n    Set findRanges = New Collection\n    Dim rngSearch As Range\n\n    Set rngSearch = doc.Content\n    With rngSearch.Find\n        .Text = keyword\n        .MatchWholeWord = True\n        .Forward = True\n        .Wrap = wdFindStop\n\n        While .Execute\n            findRanges.Add rngSearch.Duplicate\n            rngSearch.Collapse Direction:=wdCollapseEnd\n        Wend\n\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10743427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531a3f36ae3e81c98621ae918be871c2?s=128&d=identicon&r=PG", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439", "link": "https://stackoverflow.com/users/10743427/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 53849083, "answer_count": 2, "score": 2, "last_activity_date": 1545226436, "creation_date": 1545209816, "last_edit_date": 1545214745, "question_id": 53847661, "link": "https://stackoverflow.com/questions/53847661/sometimes-cant-assign-to-array-and-sometimes-can", "title": "Sometimes can&#39;t assign to array and sometimes can", "body": "<p>I have the next code:</p>\n\n<pre><code>Function findRanges(keyword) As Variant()\n\nDim foundRanges(), rngSearch As Range\nDim i, foundCount As Integer\n\ni = 0\nfoundCount = 0\nReDim foundRanges(0)\n\nSet rngSearch = ActiveDocument.Range\n    Do While rngSearch.Find.Execute(FindText:=keyword, MatchWholeWord:=True, Forward:=True) = True\n        Set foundRanges(i) = rngSearch.Duplicate\n        i = i + 1\n        ReDim Preserve foundRanges(UBound(foundRanges) + 1)\n        rngSearch.Collapse Direction:=wdCollapseEnd\n\n    Loop\n\nReDim Preserve foundRanges(UBound(foundRanges) - 1)\n\nfindRanges = foundRanges\n\nEnd Function\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>Sub test()\nDim rngIAM_Code() As Range\n...\nDim rngIAM_Title() As Range\n\nrngIAM_Code = findRanges(\"IAM_Code\")\n...\nrngIAM_Title = findRanges(\"IAM_Title\")\n\n\nEnd Sub\n</code></pre>\n\n<p>What is very confuding is that sometimes the compiler says \"Can't assign to array\" and sometimes it works fine. For example, when I only try to search one value and populate one array, the code works. When I try to populate both array, there is an error \"Can't assign to an array\". I can then switch lines of code like this:</p>\n\n<pre><code>rngIAM_Title = findRanges(\"IAM_Title\")\n...\nrngIAM_Code = findRanges(\"IAM_Code\")\n</code></pre>\n\n<p>And then the error happens with another array. The error can happen anywhere: on the first line, in the middle, or in the end, but it is consistent as long as I don't move lines. And again, if I leave only one-two lines of code with arrays in sub \"test\"everything works fine.</p>\n"}, {"tags": ["excel", "vba", "dll", "rust", "stdcall"], "comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1545208775, "post_id": 53847369, "comment_id": 94542261, "body": "Are you sure that your bit-ness is correct, e.g. 64-Bit excel and 64-Bit rust toolchain target?"}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "reply_to_user": {"reputation": 15864, "user_id": 1870153, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/juCKe.png?s=128&g=1", "display_name": "ljedrz", "link": "https://stackoverflow.com/users/1870153/ljedrz"}, "edited": false, "score": 0, "creation_date": 1545209143, "post_id": 53847369, "comment_id": 94542427, "body": "@ljedrz I think <code>cdylib</code> would be even more correct ^^ <a href=\"https://doc.rust-lang.org/reference/linkage.html\" rel=\"nofollow noreferrer\">doc.rust-lang.org/reference/linkage.html</a>"}, {"owner": {"reputation": 124, "user_id": 10792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be8f3e8c6d471f9114038f20a72006b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Soikkeli", "link": "https://stackoverflow.com/users/10792244/a-soikkeli"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1545211211, "post_id": 53847369, "comment_id": 94543522, "body": "Fixed the type to dylib (have tried dylib, lib, cdylib, staticlib...). Sorry, but this is exactly what I was talking about in the end. My post represents the latest thing I have tried. There are just so many moving parts in this equation that we have to draw multidimensional matrix to represent all the possible combinations I should try. Replicating the situation on other computer is not hard since no dependencies is needed or anything."}, {"owner": {"reputation": 124, "user_id": 10792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be8f3e8c6d471f9114038f20a72006b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Soikkeli", "link": "https://stackoverflow.com/users/10792244/a-soikkeli"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 1, "creation_date": 1545211675, "post_id": 53847369, "comment_id": 94543780, "body": "And @hellow: yes, I&#39;m using stable-x86_64-pc-windows-msvc."}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 2, "creation_date": 1545212682, "post_id": 53847369, "comment_id": 94544415, "body": "I have to say: <i>&quot;Works for me&quot;</i> if I use <code>cdylib</code> and the correct target... There is something wrong with your setup. Please triple check that the path is correct (use a simpler one, e.g. <code>D:\\lib.dll</code>) and use <code>rustc --crate-type=cdylib --target=x86_64-pc-windows-msvc</code> (and verify that you are running a 64-bit Excel by looking at the task manager!)"}, {"owner": {"reputation": 124, "user_id": 10792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be8f3e8c6d471f9114038f20a72006b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Soikkeli", "link": "https://stackoverflow.com/users/10792244/a-soikkeli"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1545217383, "post_id": 53847369, "comment_id": 94547178, "body": "Thanks @hellow for confirmation, now I know where to look. This was very helpful."}, {"owner": {"reputation": 124, "user_id": 10792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be8f3e8c6d471f9114038f20a72006b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Soikkeli", "link": "https://stackoverflow.com/users/10792244/a-soikkeli"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1545219926, "post_id": 53847369, "comment_id": 94548447, "body": "@hellow I could kiss your legs. When I tried to explicitly use --target flag, rustc was telling me that &quot;target may not be installed&quot; even though it was there and it was default as well. Then I saw that I had Rust Nightly installed in Settings-&gt;Apps&amp;Features. I was wondering if that was messing my setup somehow and uninstalled that. Now everything works like a charm when using cdylib. Couldn&#39;t be happier to finally see this working!"}, {"owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "edited": false, "score": 0, "creation_date": 1591691133, "post_id": 53847369, "comment_id": 110143731, "body": "Excel will tell you that the &quot;path is not found&quot; under several circumstances, including ones where the path is totally fine. I generally find that using Windows Event Logs, or a tool like procmon, to debug Excel is more efficient in those situations."}], "answers": [{"comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 3, "creation_date": 1545224137, "post_id": 53850612, "comment_id": 94550710, "body": "I don&#39;t get what do mean by &quot;settings -&gt; Apps &amp; features&quot;. There is no such option neither in rust, nor in rustup. I think you are using some kind of gui, but it doesn&#39;t have anything to do with rust itself.."}, {"owner": {"reputation": 124, "user_id": 10792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be8f3e8c6d471f9114038f20a72006b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Soikkeli", "link": "https://stackoverflow.com/users/10792244/a-soikkeli"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1545311799, "post_id": 53850612, "comment_id": 94585764, "body": "Ok, I edited the answer a bit to be more explicit. I had some kind of manually installed Rust Nightly package in Apps &amp; features and thus I had two separate installations (one via rustup + manual App). I can&#39;t recall in what point did I install that, but uninstalling that solved the problem. Did this explain the problem?"}, {"owner": {"reputation": 124, "user_id": 10792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be8f3e8c6d471f9114038f20a72006b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Soikkeli", "link": "https://stackoverflow.com/users/10792244/a-soikkeli"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 1, "creation_date": 1545312880, "post_id": 53850612, "comment_id": 94586414, "body": "I must have used some old installers from time before rustup. For example from here you can still find links to Rust 1.0 Windows installers that still work: <a href=\"https://doc.rust-lang.org/1.0.0/book/installing-rust.html\" rel=\"nofollow noreferrer\">doc.rust-lang.org/1.0.0/book/installing-rust.html</a>"}], "tags": [], "owner": {"reputation": 124, "user_id": 10792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be8f3e8c6d471f9114038f20a72006b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Soikkeli", "link": "https://stackoverflow.com/users/10792244/a-soikkeli"}, "is_accepted": true, "score": 1, "last_activity_date": 1545311520, "last_edit_date": 1545311520, "creation_date": 1545220182, "answer_id": 53850612, "question_id": 53847369, "link": "https://stackoverflow.com/questions/53847369/calling-functions-from-rust-dll-with-excel-vba/53850612#53850612", "title": "Calling functions from Rust DLL with Excel VBA", "body": "<p>I had Rust some old explicitly installed Nightly in Settings -> Apps &amp; features (of Windows 10), which was messing my setup somehow. After uninstalling Nightly, everything works.</p>\n"}], "owner": {"reputation": 124, "user_id": 10792244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be8f3e8c6d471f9114038f20a72006b?s=128&d=identicon&r=PG&f=1", "display_name": "A. Soikkeli", "link": "https://stackoverflow.com/users/10792244/a-soikkeli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 0, "accepted_answer_id": 53850612, "answer_count": 1, "score": 3, "last_activity_date": 1545311520, "creation_date": 1545208637, "last_edit_date": 1545220108, "question_id": 53847369, "link": "https://stackoverflow.com/questions/53847369/calling-functions-from-rust-dll-with-excel-vba", "title": "Calling functions from Rust DLL with Excel VBA", "body": "<p>I'm trying to create a Rust DLL and call those functions from 64bit Excel (Windows 10 and Office 365).</p>\n\n<p>Currently my lib.rs looks like this:</p>\n\n<pre><code>#[no_mangle]\npub extern \"stdcall\" fn square(x: f64) -&gt; f64 {\n    {x * x}\n}\n</code></pre>\n\n<p>I'm compiling with command:</p>\n\n<pre><code>rustc --crate-type=cdylib lib.rs\n</code></pre>\n\n<p>My VBA code looks like this:</p>\n\n<pre><code>Private Declare PtrSafe Function square Lib \"C:\\Users\\user\\rust\\excelfunctions\\src\\lib.dll\" (ByVal x As Double) As Double\n\nSub testsquare()\n    MsgBox square(10)\nEnd Sub\n</code></pre>\n\n<p>Excel is \"helping\" me to debug this by giving always the same error:</p>\n\n<pre><code>Run-time error '48':\n\nFile not found. C:\\Users\\user\\rust\\excelfunctions\\src\\lib.dll\n</code></pre>\n\n<p>I've obviously checked that the file is there and I can see the function with DLL Export Viewer. If I replace the file with C library, I can make the function work. I've managed to make this work with Haskell as well, so I know Excel is talking with the outside world, it's just not saying anything more specific when giving the error message.</p>\n\n<p>I've spent a lot of time with this and tried all possible combinations I could come up with. I would highly appreciate if the person who answers this would first double check that the proposed solution really works in his/her machine, so we don't end up with a very long ping pong of questions and \"no\" answers (been there already). It's just not possible to list here all the possible variations I have already tried.</p>\n\n<p>EDIT: I had Rust Nightly installed in Settings -> Apps &amp; features, which was messing my setup somehow. After uninstalling Nightly, everything works!</p>\n"}, {"tags": ["excel", "vba", "export-to-excel"], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1547120992, "post_id": 53848889, "comment_id": 95087343, "body": "Hi there, sorry for the late response. Not quiet, so far the &quot;B&quot; file is missing so i cant select the file that contains the macros. Maybe this description is a little bit easier:   Select a file Z, copy the whole file (so that all macros are copied as well), delete all Worksheets from it but one (SheetX).   Copy sheetY from my current File A and paste it into sheetX.  Save the Copy of File Z as File Z_1.   Right now i save my sheetY from my current file into a new one but I need the macros from File Z in it."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 1, "last_activity_date": 1545214128, "creation_date": 1545214128, "answer_id": 53848889, "question_id": 53846995, "link": "https://stackoverflow.com/questions/53846995/export-into-a-copied-file/53848889#53848889", "title": "Export into a copied file", "body": "<p>Either I`m missing something in your question, or... Isn't this <code>StandardPfad</code> enough?</p>\n\n<p>It needs a bit more error handling if the user cancel's the selection, but that's your <code>X = Path the user just selected in the save file dialog</code></p>\n\n<pre><code>' displays the save file dialog\nStandardPfad = Application.GetSaveAsFilename(FileFilter:= _\n    \"Exceldateien (*.xlsx), *.xlsx\", Title:=\"Vorlagen Datei ausw\u00e4hlen\", _\n    InitialFileName:=\"\")\n\nNeueDatei.SaveCopyAs Filename:=StandardPfad\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 53848889, "answer_count": 1, "score": 0, "last_activity_date": 1579253230, "creation_date": 1545207066, "last_edit_date": 1579253230, "question_id": 53846995, "link": "https://stackoverflow.com/questions/53846995/export-into-a-copied-file", "title": "Export into a copied file", "body": "<p>I will first tell you what I want to do, maybe that makes finding a solution easier. I want to export a file (after changing it) into a file that uses macro buttons etc on it's own. The problem is I cant delete said file.</p>\n\n<p>My current solution is as follows: I use a \"open file\" Dialog so the user tells me the Excel that should be used as a template. VBA then should copy this file (the destination is once again given by a save file dialog) and then delete the used range in the new file and copy the values in this new file.</p>\n\n<p>So there are 3 files Involved. </p>\n\n<ul>\n<li>A: Current file with changed data and the macro I am doing right now.</li>\n<li>B: Template File with macros.</li>\n<li>C: New File that should be created with the macros from B and the\nData from A</li>\n</ul>\n\n<p>So far I have this code that opens B and and copies it (i guess) it. My primary issue is how do I access the newly created file now. I assume I can somehow store it as a variable. Something like <code>X = Path the user just selected in the save file dialog</code>?\nThe deleting and inserting Data afterwards should be rather simple I guess/hope.</p>\n\n<p>I hope you guys can help me and thanks a lot in advance :)</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Dim StandardPfad As String\nDim ExportBlatt As Worksheet\nDim NeueDatei As Workbook\n\n\nStandardPfad = \"C:\\XYZ\"\n\n'   ExportBlatt = Worksheets(\"Blatt1\")\n\nSet NeueDatei = Workbooks.Add\nThisWorkbook.Sheets(\"Blatt1\").Copy Before:=NeueDatei.Sheets(1)\nApplication.DisplayAlerts = False\nSheets(2).Delete\nApplication.DisplayAlerts = True\n\n' displays the save file dialog\nStandardPfad = Application.GetSaveAsFilename(FileFilter:= _\n        \"Exceldateien (*.xlsx), *.xlsx\", Title:=\"Vorlagen Datei ausw\u00e4hlen\", _\n        InitialFileName:=\"\")\n\nNeueDatei.SaveCopyAs Filename:=\"C:\\Test\\CopyBook.xls\" 'Hier Speicherort angeben\n\nNeueDatei.Close savechanges:=False\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 7276729, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bcd01aceb92f1a8dcb4dcbdc833998bd?s=128&d=identicon&r=PG&f=1", "display_name": "Adnan", "link": "https://stackoverflow.com/users/7276729/adnan"}, "edited": false, "score": 0, "creation_date": 1545207508, "post_id": 53846877, "comment_id": 94541675, "body": "This was just for understanding, I will Save just UserID and LoginDate. Thanks for quick answer."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1545207580, "last_edit_date": 1545207580, "creation_date": 1545206549, "answer_id": 53846877, "question_id": 53846744, "link": "https://stackoverflow.com/questions/53846744/date-stamp-with-insert-query-in-ms-access/53846877#53846877", "title": "Date Stamp with INSERT query in MS Access", "body": "<p>Can't tack on Now() after strSQL2 because that puts it after the FROM and WHERE clauses. Put it into strSQL2 statement. The SQL engine can evaluate Now() function. Can use a single apostrophe in place of double quotes as delimiter character.</p>\n\n<pre><code>strSQL2 = \"SELECT UserID, FirstName, LastName, UserName, Now() AS CD FROM tbl_login WHERE Username = '\" &amp; Me.txt_username &amp; \"' AND Password = '\" &amp; Me.txt_password &amp; \"'\"\n\nstrSQL3 = \"INSERT INTO LoginHistory (UserID, FirstName, LastName, UserName, LoginDate)\" &amp; strSQL2\n\nCurrentDb.Execute strSQL3\n</code></pre>\n\n<p>Why even duplicate UserName, FirstName, LastName into LoginHistory? Just save UserID and Now().</p>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1545207899, "creation_date": 1545207899, "answer_id": 53847184, "question_id": 53846744, "link": "https://stackoverflow.com/questions/53846744/date-stamp-with-insert-query-in-ms-access/53847184#53847184", "title": "Date Stamp with INSERT query in MS Access", "body": "<p>I would rather add <code>Now()</code> as a default value for your LoginDate field. This way you won't have to take care about that in any query.<br>\nI think it's always better to implement such thinks at the lowest level: the table definition, in this case.</p>\n"}], "owner": {"reputation": 138, "user_id": 7276729, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bcd01aceb92f1a8dcb4dcbdc833998bd?s=128&d=identicon&r=PG&f=1", "display_name": "Adnan", "link": "https://stackoverflow.com/users/7276729/adnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 53846877, "answer_count": 2, "score": 0, "last_activity_date": 1545207899, "creation_date": 1545205932, "last_edit_date": 1545206213, "question_id": 53846744, "link": "https://stackoverflow.com/questions/53846744/date-stamp-with-insert-query-in-ms-access", "title": "Date Stamp with INSERT query in MS Access", "body": "<p>I am inserting data from table <code>tbl_login</code> to table <code>LoginHistory</code> with date stamp. But I am confused to add Date Stamp with query string.</p>\n\n<p>My Code is:</p>\n\n<pre><code>strSQL2 = \"SELECT UserID, FirstName, LastName, UserName FROM tbl_login WHERE Username = \"\"\" &amp; Me.txt_username.Value &amp; \"\"\" AND Password = \"\"\" &amp; Me.txt_password.Value &amp; \"\"\"\"\n\nstrSQL3 = \"INSERT INTO LoginHistory (UserID, FirstName, LastName, UserName, LoginDate)\" &amp; strSQL2 &amp; Now()\n\nCurrentDb.Execute strSQL3\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 261, "user_id": 7634135, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02a8e232898c11cbc32a93ea8f55520e?s=128&d=identicon&r=PG&f=1", "display_name": "lcc", "link": "https://stackoverflow.com/users/7634135/lcc"}, "edited": false, "score": 0, "creation_date": 1545206741, "post_id": 53846593, "comment_id": 94541356, "body": "Can you display the sample of your excel sheet?"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 10711720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd78c8a2a55ec52e0aca62217e044cb?s=128&d=identicon&r=PG&f=1", "display_name": "ROCA", "link": "https://stackoverflow.com/users/10711720/roca"}, "is_accepted": false, "score": 0, "last_activity_date": 1545224399, "creation_date": 1545224399, "answer_id": 53851797, "question_id": 53846593, "link": "https://stackoverflow.com/questions/53846593/insert-signature-after-the-pasted-body-in-outlook-mail-using-excel-vba/53851797#53851797", "title": "Insert signature after the pasted body in Outlook mail using Excel VBA", "body": "<p>Create the Signature in a new sheet in Excel and have it added to email body, same as you did for body contente, this is better to customized signature.</p>\n\n<p>Else you can use this idea:</p>\n\n<pre><code>if  Not (Account  Is  Nothing)  Then\n   set Signature = Account.NewMessageSignature\n   if  Not (Signature  Is  Nothing)  Then\n    Signature.ApplyTo Msg,  false   'apply at the bottom\n   End If\nEnd If\n</code></pre>\n\n<p>From this post:\n<a href=\"https://stackoverflow.com/questions/8994116/how-to-add-default-signature-in-outlook\">How to add default signature in Outlook</a></p>\n"}], "owner": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 597, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552686789, "creation_date": 1545205217, "last_edit_date": 1552686789, "question_id": 53846593, "link": "https://stackoverflow.com/questions/53846593/insert-signature-after-the-pasted-body-in-outlook-mail-using-excel-vba", "title": "Insert signature after the pasted body in Outlook mail using Excel VBA", "body": "<p>I am using the code below to create an email from Excel: </p>\n\n<pre><code>Sub TEST()\n\nDim outlook As Object\nDim newEmail As Object\n\nSet outlook = CreateObject(\"Outlook.Application\")\nSet newEmail = outlook.CreateItem(0)\n\nWith newEmail\n    .To = Sheet1.Range(\"L2\").Text\n    .Subject = Sheet1.Range(\"E1\").Text\n\n    ' .Body = \"\" &amp; vbNewLine &amp; signature\n    .Display\n\n    Dim xInspect As Object\n    Dim pageEditor As Object\n\n    Set xInspect = newEmail.GetInspector\n    Set pageEditor = xInspect.WordEditor\n\n    Sheet1.Range(\"B4:L37\").Copy\n\n    pageEditor.Application.Selection.Start = Len(.Body)\n    pageEditor.Application.Selection.End = pageEditor.Application.Selection.Start\n    pageEditor.Application.Selection.Paste\n\n    Set pageEditor = Nothing\n    Set xInspect = Nothing\nEnd With\n\nSet newEmail = Nothing\nSet outlook = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>My signature will automatically appear before the text body.</p>\n\n<p>Is there a way to insert my signature afterwards?</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "is_accepted": false, "score": 1, "last_activity_date": 1545205232, "creation_date": 1545205232, "answer_id": 53846598, "question_id": 53846380, "link": "https://stackoverflow.com/questions/53846380/how-to-count-the-delay-of-loading-a-url-and-restart-loading-next-url-in-row-usin/53846598#53846598", "title": "How to count the delay of loading a url and restart loading next URL in row using VBA", "body": "<p>I would advise you to change your check for if the page has loaded. In my code it times how long it has taken to load exits the loop after 10 seconds. </p>\n\n<p>I have added a boolean that changes to false if more than 10 seconds has passed. This is later used in the if statement to check if the rest of the code should be run. </p>\n\n<pre><code>t = Timer\nbooLoaded = true\n\nDo While ie.Busy Or ie.ReadyState &lt; 4\n\n  DoEvents\n\n  If Timer - t &gt; 10 Then\n    booLoaded = false\n    Exit Do\n    t = \"\"\n  end if\n\nloop\n\nt = timer\n\nif booload = true then\n   Do\n   DoEvents\n'... rest of the do loop here\nend if\n\nnext i\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1545209809, "post_id": 53847258, "comment_id": 94542762, "body": "I am testing it on <a href=\"https://www.wavemotion.gr/el/shop/wireless-audio/go2-portable-bluetooth-speaker-ipx7-waterproof-7\" rel=\"nofollow noreferrer\">wavemotion.gr/el/shop/wireless-audio/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545209847, "post_id": 53847258, "comment_id": 94542786, "body": "thanks for sharing. I guess you can give my code a go and if problems let me know and I will have a play."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1545210196, "post_id": 53847258, "comment_id": 94543009, "body": "Now we speak it is on the 4th row of total 28 the link on which is now is <a href=\"https://www.wavemotion.gr/el/shop/smartphone-accessories/itap-magnetic-air-vent-car-mount\" rel=\"nofollow noreferrer\">wavemotion.gr/el/shop/smartphone-accessories/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545211040, "post_id": 53847258, "comment_id": 94543432, "body": "Did you test with the above?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1545211327, "post_id": 53847258, "comment_id": 94543585, "body": "Yes it is working but now, the highlight of row is very fast and it is not quite obvious if a row is not readable for a reason( large image files) does it go to next row?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545211409, "post_id": 53847258, "comment_id": 94543627, "body": "yes it should continue to next url. Try it with two urls to see. You can add a print statement to check the urls being processed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1545211849, "post_id": 53847258, "comment_id": 94543902, "body": "Is there a reason that we check for availability is nothing and not the link itself?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545211892, "post_id": 53847258, "comment_id": 94543935, "body": "yes.. so you can exit early the loop and later so you only execute the necessary lines of code."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1545209073, "last_edit_date": 1545209073, "creation_date": 1545208220, "answer_id": 53847258, "question_id": 53846380, "link": "https://stackoverflow.com/questions/53846380/how-to-count-the-delay-of-loading-a-url-and-restart-loading-next-url-in-row-usin/53847258#53847258", "title": "How to count the delay of loading a url and restart loading next URL in row using VBA", "body": "<p>I would extend the Const as that is where the wait time is supposed to be determined. Then re-organise your code so you can exit earlier if you are able to set your target element. Have a test for Is Nothing on Set element and only execute next lines (related to that url) if Not Is Nothing.</p>\n\n<p>I am a little uncomfortable about the structure of navigate within the loop and would like to test if you have any urls you know hang. As I have now added setting the element and navigating into the same block you might want to add another second or two to the Const.</p>\n\n<pre><code>Option Explicit   \nPublic Sub test()\n    Const MAX_WAIT_SEC As Long = 10\n    'other code\n    Set wks = wb.Sheets(\"wavemotion\")\n    LastRow = wks.Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    ie.Visible = True\n\n    For i = 2 To LastRow\n\n        mylink = wks.Cells(i, 2).Value        \n        t = Timer\n        Do\n            DoEvents          \n            ie.Navigate2 mylink\n\n            While ie.Busy Or ie.readyState &lt; 4: DoEvents: Wend\n\n            On Error Resume Next\n            Set availability = ie.document.querySelector(\".stock.in-stock \")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While availability Is Nothing\n\n        If Not availability Is Nothing Then\n\n            wks.Range(Cells(i, 1), Cells(i, 5)).Interior.ColorIndex = 38\n            Set product_sku = ie.document.querySelector(\".single-product__sku\")\n            wks.Cells(i, \"A\").Value = product_sku.innerText\n            Set price = ie.document.querySelector(\".price .woocommerce-Price-amount\")\n            wks.Cells(i, \"E\").Value = price.innerText\n            wks.Cells(i, \"D\").Value = availability.innerText\n            Set product_name = ie.document.querySelector(\".single-product__title\")\n            wks.Cells(i, \"C\").Value = product_name.innerText\n            Set product_color = ie.document.querySelector(\".single-product__colors__label \")\n            wks.Cells(i, \"G\").Value = product_color.innerText\n            wks.Range(Cells(i, 1), Cells(i, 5)).Interior.ColorIndex = 0\n            Set price = Nothing: Set availability = Nothing '.... etc\n        End If\n    Next i\n\n    ie.Quit\n    Set ie = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53847258, "answer_count": 2, "score": 1, "last_activity_date": 1579253242, "creation_date": 1545204169, "last_edit_date": 1579253242, "question_id": 53846380, "link": "https://stackoverflow.com/questions/53846380/how-to-count-the-delay-of-loading-a-url-and-restart-loading-next-url-in-row-usin", "title": "How to count the delay of loading a url and restart loading next URL in row using VBA", "body": "<p>I have a list of 50 URL links in Excel column. I extract my data but there is a case that a URL do a timeout, I think because the webpage has high definition photos. This is the one of the links</p>\n\n<p><a href=\"https://www.wavemotion.gr/el/shop/smartphone-accessories/itap-magnetic-air-vent-car-mount\" rel=\"nofollow noreferrer\">https://www.wavemotion.gr/el/shop/smartphone-accessories/itap-magnetic-air-vent-car-mount</a></p>\n\n<p>How can I go to next URL if the delay of loading is above 10 seconds? I have the following so far</p>\n\n<pre><code>'Set Worksheet\nSet wks = wb.Sheets(\"wavemotion\")\n'Limit rows\nlastrow = wks.Cells(Rows.Count, \"B\").End(xlUp).Row\n'Set IE display\nie.Visible = True\n\n\nFor i = 2 To lastrow\n\nmylink = wks.Cells(i, 2).Value\n\nie.Navigate mylink\n\nConst MAX_WAIT_SEC As Long = 5\n\n\nWhile ie.Busy Or ie.ReadyState &lt; 4: DoEvents: Wend\nt = Timer\nDo\n    DoEvents\n    On Error Resume Next\n'change row color           \n    wks.Range(Cells(i, 1), Cells(i, 5)).Interior.ColorIndex = 38\n\n    Set product_sku = ie.Document.querySelector(\".single-product__sku\")\n    wks.Cells(i, \"A\").Value = product_sku.innerText\n\n    Set price = ie.Document.querySelector(\".price .woocommerce-Price-amount\")\n    wks.Cells(i, \"E\").Value = price.innerText\n\n    Set availability = ie.Document.querySelector(\".stock.in-stock \")\n    Set availability = ie.Document.querySelector(\".stock.out-of-stock \")\n    Set availability = ie.Document.querySelector(\".stock.out-of-stock \")\n\n    wks.Cells(i, \"D\").Value = availability.innerText\n\n    Set product_name = ie.Document.querySelector(\".single-product__title\")\n    wks.Cells(i, \"C\").Value = product_name.innerText\n\n    'Set product_color = ie.Document.querySelector(\".single-product__colors__label \")\n    'wks.Cells(i, \"G\").Value = product_color.innerText\n\n\n    If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n    On Error GoTo 0\nLoop\nIf price Is Nothing Then Exit Sub\n\nwks.Range(Cells(i, 1), Cells(i, 5)).Interior.ColorIndex = 0\n\nNext i\n\nie.Quit\nSet ie = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1545259184, "post_id": 53849124, "comment_id": 94568271, "body": "Populating in names do not work, let me reiterate your assumptions 1. TextBox for Name is just the TextBox 13 thats why I want to populate first row to TextBox 13 then save then second row to TextBox 13 then save again.... 2. Names are can be found in range G114:H132 as the cells are merged. Maybe the LastRow on your code that I cannot edit can solve. 3. There is only 1 blank per name. Current code is: <code>LastRow = sh1.Range(&quot;G&quot; &amp; sh1.Range(&quot;G114:H132&quot;).Rows.Count).End(xlUp).Row</code> <code>ppPres.Slides(1).Shapes(&quot;TextBox 13&quot;).TextEffect.Text = sh1.Range(&quot;G&quot; &amp; I).Value</code>"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1545266393, "post_id": 53849124, "comment_id": 94570090, "body": "I think by now you can make the code work by making modification according to your requirement. If G132 is the last row, simply <code>Last Row=132</code> will suffice. Anyway if want to resolve the LastRow, then may use <code>LastRow = sh1.Range(&quot;G&quot; &amp; sh1.Range(&quot;G:G&quot;).Rows.Count).End(xlUp).Row</code>"}, {"owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1545276269, "post_id": 53849124, "comment_id": 94572005, "body": "The code able to get the 1st name and save as pdf but on the second name, the code stop and having an error on this line <code>ppPres.Slides(1).Shapes(&quot;TextBox 20&quot;).TextEffect.Text = sh1.Range(&quot;G&quot; &amp; I).Value</code>"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1545279396, "post_id": 53849124, "comment_id": 94572583, "body": "Please share Error no and massage. Moreover keep <code>ppPres.Close</code> and  <code>ppApp.Quit</code> out of the loop. It is closing PowerPoint appliction after 1st loop."}, {"owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1545282299, "post_id": 53849124, "comment_id": 94573153, "body": "After I take Close and Quit out of the loop. It works perfectly fine, I tried 3 names already. Thanks !! <i>Cheers</i>"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 0, "last_activity_date": 1545214878, "creation_date": 1545214878, "answer_id": 53849124, "question_id": 53845518, "link": "https://stackoverflow.com/questions/53845518/excel-to-ppt-with-do-until/53849124#53849124", "title": "Excel to PPT with Do Until", "body": "<p>There are multiple issues in the code and question is not clear on multiple issues.\nHowever assuming </p>\n\n<ol>\n<li><p>TextBox's numbers (for the Names) on the slide 1 is in sequence, starting from \"TextBox 13\". The TextBox names may be modified from format-selection pane. </p></li>\n<li><p>Names are found in column J of excel sheet Automation starting from row 114.</p></li>\n<li><p>There may be multiple blank rows between two names. </p></li>\n</ol>\n\n<p>The modified code is tried and working on the assumptions</p>\n\n<pre><code>Set ppApp = CreateObject(\"PowerPoint.Application\")\nppApp.Visible = True\nSet ppPres = ppApp.Presentations.Open(fpath)\nppPres.Slides(1).Shapes(\"TextBox 2\").TextEffect.Text = sh1.Range(\"J111\").Value 'do not need to loop\n\nDim I As Long, LastRow As Long, TbNo As Long\n'last excel rows of the names may be ascertained by or directly defined \nLastRow = sh1.Range(\"J\" &amp; sh1.Range(\"J:J\").Rows.Count).End(xlUp).Row\n\nI = 114\nTbNo = 13\nDo While I &lt;= LastRow\n    If sh1.Range(\"J\" &amp; I).Value &lt;&gt; \"\" Then\n    ppPres.Slides(1).Shapes(\"TextBox \" &amp; TbNo).TextEffect.Text = sh1.Range(\"J\" &amp; I).Value 'name that need to loop\n    TbNo = TbNo + 1\n    'save to pdf code will be added here\n    End If\nI = I + 1\nLoop\n</code></pre>\n\n<p>Hope it will be useful.</p>\n"}], "owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53849124, "answer_count": 1, "score": 0, "last_activity_date": 1579253260, "creation_date": 1545200054, "last_edit_date": 1579253260, "question_id": 53845518, "link": "https://stackoverflow.com/questions/53845518/excel-to-ppt-with-do-until", "title": "Excel to PPT with Do Until", "body": "<p><img src=\"https://i.stack.imgur.com/U2OMP.png\" alt=\"\"></p>\n\n<p>I am doing a macro that will input the NAME into PPT textbox then save as pdf. So how do I loop, or do until my code.</p>\n\n<p>What I want is to continuosly create a new certificate based on my sheet range. The problem is I have blank rows a total of 10 input cell and 9 blank cell because its 1 cell apart. And how do I loop only this code <code>ppPres.Slides(1).Shapes(\"TextBox 13\").TextEffect.Text = sh1.Range(\"114\").Text</code> \nLike if I input 7 names, it will generate 7 pdf with 7 different names on it\nUpdated Code:</p>\n\n<pre><code>Dim fpath As String\nDim ppApp As PowerPoint.Application\nDim ppPres As PowerPoint.Presentation\nDim sh1 As Worksheet\nDim sh2 As Worksheet\nSet sh1 = ThisWorkbook.Worksheets(\"Automation\")\nSet sh2 = ThisWorkbook.Worksheets(\"Links\")\nfpath = \"C:\\Mondee\\01_Automation\\Project - Automated Letters\\Thank You Award_AUNZ.pptx\"\nSet ppApp = CreateObject(\"PowerPoint.Application\")\nppApp.Visible = True\nSet ppPres = ppApp.Presentations.Open(fpath)\nppPres.Slides(1).Shapes(\"TextBox 21\").TextEffect.Text = sh1.Range(\"J111\").Value 'do not need to loop\nDim I As Long, LastRow As Long, TbNo As Long\nLastRow = 132\nI = 114\nDo While I &lt;= LastRow\n    If sh1.Range(\"G\" &amp; I).Value &lt;&gt; \"\" Then\n    ppPres.Slides(1).Shapes(\"TextBox 20\").TextEffect.Text = sh1.Range(\"G\" &amp; I).Value 'name that need to loop\n    sPath = \"C:\\Mondee\\01_Automation\\Project - Automated Letters\\\"\n    sName = sh1.Range(\"G\" &amp; I).Value &amp; \".pdf\"\n    ppPres.ExportAsFixedFormat sPath &amp; sName, ppFixedFormatTypePDF\n    ppPres.Close\n    ppApp.Quit\n    End If\nI = I + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545200060, "post_id": 53844851, "comment_id": 94538588, "body": "please explain what is meant by &quot;goes havoc&quot;."}, {"owner": {"reputation": 11, "user_id": 10809153, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HYVxvcge7jc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gug4xii9NT0Qi6J_MVMcXeAAihxg/mo/photo.jpg?sz=128", "display_name": "Vasco", "link": "https://stackoverflow.com/users/10809153/vasco"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545209901, "post_id": 53844851, "comment_id": 94542818, "body": "Essentially the found text is copied to another area of the document. But it appears when there are no findings in a chapter it repeats to write old text (e.g. previous one). I could explain it (e.g. writes again the variables still containing the old content) but it does that multiple times. Later one is the part I do not understand and cannot identify a pattern (why it writes it ~30 times even yet there are only 10 chapters)."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10809153, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HYVxvcge7jc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gug4xii9NT0Qi6J_MVMcXeAAihxg/mo/photo.jpg?sz=128", "display_name": "Vasco", "link": "https://stackoverflow.com/users/10809153/vasco"}, "is_accepted": false, "score": 1, "last_activity_date": 1545211432, "creation_date": 1545211432, "answer_id": 53848094, "question_id": 53844851, "link": "https://stackoverflow.com/questions/53844851/word-vba-finding-red-font-and-give-chapter-name/53848094#53848094", "title": "Word VBA: finding red font and give chapter name", "body": "<p>As usual: less is more.\nI managed to solve it by removing a bit of clutter and search the whole document and just limit the action to the section where I want it to happen. </p>\n\n<p>Below is my revised code which works like a charm</p>\n\n<pre><code>Sub find_red_text()\n\nDim rng As Range\nDim endrange As Integer\nDim session As Range\n\nendrange = 0 ' will be written with the end of the range (count of characters) to see if the range has changed or remain the same\n\nSelection.HomeKey Unit:=wdStory ' go to the beginning of the document!\nSet rng = ActiveDocument.Range(Start:=0, End:=0)\n\nWith rng.Find\n    .Text = \"\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop 'wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchKashida = False\n    .MatchDiacritics = False\n    .MatchAlefHamza = False\n    .MatchControl = False\n    .MatchByte = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .Font.Color = wdColorRed '255\n    Do While .Execute\n        If rng.Information(wdEndOfRangeColumnNumber) = 2 Then 'only consider second column which is the findings!\n            Set session = rng.GoTo(What:=wdGoToHeading, Which:=wdGoToPrevious)\n            session.Expand Unit:=wdParagraph\n            If (endrange = rng.End) Then 'no change in the end of the range, therefore we have finished the search!\n                Exit Do\n            Else ' keep going and push the endrange value out\n                endrange = rng.End\n            End If\n            msgbox (rng.text &amp; \" in \" &amp; session.text)\n        End If\n    Loop\nEnd With\nEnd Sub\n</code></pre>\n\n<p><strong>Main changes needed:</strong></p>\n\n<p>1) I tried a different approach \nfrom: select a chapter and search within \nto: search the whole document and filter findings based on chapter</p>\n\n<p>2) the havoc happened because I reached the end of the document with the search. The end position of my search result never changed anymore. Therefore I track the end of the range and if it's not increasing anymore I stop the search/loop. </p>\n\n<p>Now working like a charm :) </p>\n"}], "owner": {"reputation": 11, "user_id": 10809153, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HYVxvcge7jc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gug4xii9NT0Qi6J_MVMcXeAAihxg/mo/photo.jpg?sz=128", "display_name": "Vasco", "link": "https://stackoverflow.com/users/10809153/vasco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582953902, "creation_date": 1545195698, "last_edit_date": 1582953902, "question_id": 53844851, "link": "https://stackoverflow.com/questions/53844851/word-vba-finding-red-font-and-give-chapter-name", "title": "Word VBA: finding red font and give chapter name", "body": "<p>I like to search in a part of my document and state the last heading. My document has following structure:</p>\n\n<ol>\n<li><p>Chapter 1</p></li>\n<li><p>Chapter 2</p>\n\n<p><strong>2.1 sub chapter 1</strong></p>\n\n<pre><code>  Table with data\n</code></pre>\n\n<p><strong>2.2 sub chapter 2</strong></p>\n\n<pre><code>  Table with data\n</code></pre>\n\n<p><strong>2.n sub chapter n</strong></p>\n\n<pre><code>  Table with data\n</code></pre></li>\n<li><p>Chapter 3</p></li>\n</ol>\n\n<p>What I like to do is find all red text in one of the tables and find out in which chapter (second level) this is stated.</p>\n\n<p>I tried to define a range for each second level chapter and perform a find within the range. For whatever reason my search is not limited by the range but expands to the end of the document. Therefore any finding of red text in a later chapter will be mistakenly assigned to the first sub chapter. </p>\n\n<p>I also read that limiting the search to a range is kind of buggy (not possible?) due to the dynamic range (frankly something I still don't fully understand). Therefore another approach I could imagine is to search the whole document and just find out the last header before the finding. I just don't know how to approach this. </p>\n\n<p>I would really like a pointer. I keep on reading the same forum posts on this topic but can not get it to work as needed.</p>\n\n<p>Below what I have so far.</p>\n\n<p><strong>Issues:</strong></p>\n\n<ul>\n<li>the first search goes through all sub chapters but the header is still on sub chapter 1</li>\n<li>if there is no red text in a sub chapter the script goes havoc (not quite sure yet what actually happens)</li>\n</ul>\n\n<p>my code so far:</p>\n\n<pre><code>Sub find_red_text()\n\nDim chapter As Range\nDim heading As Range\nDim session As String\nDim counter As Integer\n\nSelection.HomeKey Unit:=wdStory ' go to the beginning of the document!\nSet heading = ActiveDocument.Range(Start:=0, End:=0)\ncounter = 0 ' represent level1 headings\nDo   ' Loop through headings\n    Dim current As Long\n    current = heading.Start\n    Set heading = heading.GoTo(What:=wdGoToHeading, Which:=wdGoToNext)\n    If heading.Start = current Then\n        ' We haven't moved because there are no more headings\n        Exit Do\n    End If\n    If heading.Paragraphs(1).OutlineLevel = wdOutlineLevel1 Then\n        counter = counter + 1 ' count the level 1 headers\n        heading.Expand Unit:=wdParagraph\n    End If\n    If (heading.Paragraphs(1).OutlineLevel = wdOutlineLevel2) And (counter = 2) Then ' special attention to the sub chapter in chapter 2\n        heading.Expand Unit:=wdParagraph\n        session = heading.Text\n        Set chapter = heading.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n        With chapter.Find\n            .Text = \"\"\n            .Replacement.Text = \"\"\n            .Forward = True\n            .Wrap = wdFindStop\n            .Format = True\n            .MatchCase = False\n            .MatchWholeWord = False\n            .MatchKashida = False\n            .MatchDiacritics = False\n            .MatchAlefHamza = False\n            .MatchControl = False\n            .MatchByte = False\n            .MatchWildcards = False\n            .MatchSoundsLike = False\n            .MatchAllWordForms = False\n            .Font.Color = wdColorRed\n            Do While .Execute\n                chapter.Select ' just for debug purpose\n                MsgBox (chapter.Text &amp; \" in \" &amp; heading)\n            Loop\n        End With\n    End If\nLoop\nEnd Sub\n</code></pre>\n\n<p>Anyone could help me out here? I'm staring at this for some time, go nuts by reading the same \"solutions\" out there but it just don't do what I need it to do...</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10411989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13415a5c5def176fc6656a5b73dfd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nilusha M.", "link": "https://stackoverflow.com/users/10411989/nilusha-m"}, "edited": false, "score": 0, "creation_date": 1545212206, "post_id": 53846453, "comment_id": 94544141, "body": "Actually what I need is to keep both files in the target folder when same filename exists like when we copy manually windows asks to keep both files in the directory.Is it possible to be done via vba macro??"}, {"owner": {"reputation": 57, "user_id": 10411989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13415a5c5def176fc6656a5b73dfd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nilusha M.", "link": "https://stackoverflow.com/users/10411989/nilusha-m"}, "edited": false, "score": 0, "creation_date": 1545229485, "post_id": 53846453, "comment_id": 94553834, "body": "I would really appreciate your assistance but unfortunately there were some files which name change according to the time and remaining parts of the file name is same.it seems to me In a situation like that opening a message box would not be the best solution.isnt it?"}, {"owner": {"reputation": 333, "user_id": 7078827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3081c6d0cdd072a5061a201ba4d75306?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233;", "link": "https://stackoverflow.com/users/7078827/andr%c3%a9"}, "reply_to_user": {"reputation": 57, "user_id": 10411989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13415a5c5def176fc6656a5b73dfd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nilusha M.", "link": "https://stackoverflow.com/users/10411989/nilusha-m"}, "edited": false, "score": 0, "creation_date": 1545229758, "post_id": 53846453, "comment_id": 94553985, "body": "So if it is no option for you to use a message box then use the other method. Check if the file exists and if so generate another name."}], "tags": [], "owner": {"reputation": 333, "user_id": 7078827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3081c6d0cdd072a5061a201ba4d75306?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233;", "link": "https://stackoverflow.com/users/7078827/andr%c3%a9"}, "is_accepted": false, "score": 1, "last_activity_date": 1545212836, "last_edit_date": 1545212836, "creation_date": 1545204513, "answer_id": 53846453, "question_id": 53844351, "link": "https://stackoverflow.com/questions/53844351/how-to-avoid-overwrite-and-keep-both-files-in-the-folder-via-excel-macro/53846453#53846453", "title": "How to avoid overwrite and keep both files in the folder via excel macro", "body": "<p>If you want to keep both files then check if it exists and rename it before copy.\nFor check if it exists you can use the following snippet. </p>\n\n<pre><code>Dim fso As New FileSystemObject\nDim filepath As String\nfilepath = \"yourfilepath\"\n\nWhile fso.FileExists(filepath)\n'rename it\nWend\n</code></pre>\n\n<p>For using the <code>FileSystemObject</code> you have to set a reference on <code>Windwos Script Host Object Model</code></p>\n\n<p><strong>EDIT</strong>: To answer your comment:\nYou can check if exists and then open a message box:</p>\n\n<pre><code>If MsgBox(\"Override\", vbYesNo) = vbYes Then\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10411989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13415a5c5def176fc6656a5b73dfd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nilusha M.", "link": "https://stackoverflow.com/users/10411989/nilusha-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579253451, "creation_date": 1545191655, "last_edit_date": 1579253451, "question_id": 53844351, "link": "https://stackoverflow.com/questions/53844351/how-to-avoid-overwrite-and-keep-both-files-in-the-folder-via-excel-macro", "title": "How to avoid overwrite and keep both files in the folder via excel macro", "body": "<p>I created a code to copy file by the partial names which are included in the active workbook and when it is done that cell will be colored.</p>\n\n<p>I used \"Boolean\" option to overwrite the files before but <strong>now I need to keep both files in the Target Folder if same file with same name exists in the Target Folder.</strong> How do I solve this?</p>\n\n<pre><code>Sub Copy_by_keyword()\n    Dim sSrcFolder As String\n    Dim sTgtFolder As String\n    Dim sFilename As String\n    Dim c As Range\n    Dim rPatterns As Range\n    Dim bBad As Boolean\n\n    sSrcFolder = (\"C:\\Personal\\Reports\")\n    sTgtFolder = (\"D:\\VBA\\Trade\\\")\n\n    Set rPatterns = ActiveSheet.Range(\"M10:M100\").SpecialCells(xlConstants)\n    For Each c In rPatterns\n        sFilename = Dir(sSrcFolder &amp; \"*\" &amp; c.Text &amp; \"*\")\n        If sFilename = \"\" Then\n            c.Interior.ColorIndex = 4\n            bBad = False  'I tried to use this as False but nothing happens'\n        Else\n            While sFilename &lt;&gt; \"\"\n                FileCopy sSrcFolder &amp; sFilename, sTgtFolder &amp; sFilename\n                sFilename = Dir()\n                c.Interior.ColorIndex = 6\n            Wend\n        End If\n    Next c\n    If bBad Then MsgBox \"Files not found\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1545362298, "post_id": 53844144, "comment_id": 94604644, "body": "hi, i tried using your suggested code but I&#39;m getting an error that an object is needed....I&#39;m not sure what to do."}, {"owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "edited": false, "score": 0, "creation_date": 1545374849, "post_id": 53844144, "comment_id": 94607481, "body": "No worries, managed to resolve it. Had to make it sht2.cells instead. it works beautifully"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1545189896, "creation_date": 1545189896, "answer_id": 53844144, "question_id": 53844118, "link": "https://stackoverflow.com/questions/53844118/how-to-modify-code-to-keep-destination-cell-formatting/53844144#53844144", "title": "How to modify code to keep destination cell formatting", "body": "<p>Just do a value transfer, no need for <code>Copy</code>.</p>\n\n<p>Note that <code>sht1</code> is actually a <code>Variant</code> if you do not specifically declare it <code>As Worksheet</code>.</p>\n\n<pre><code>Dim sht1 As Worksheet, sht2 As Worksheet\n\nSet sht1 = Worksheets(\"Sheet1\")\nSet sht2 = Worksheets(\"Table\")\n\nWith sh2\n    .Cells(.Rows.Count, 1).End(xlUp).Offset(1).Value = sh1.Range(\"K10\").Value\n    .Cells(.Rows.Count, 2).End(xlUp).Offset(1).Value = sh1.Range(\"G15\").Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10773651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aBYM6El6veM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTd-lo6SX4Bm1iwXxPoiYHc0lOSQ/mo/photo.jpg?sz=128", "display_name": "hans smith", "link": "https://stackoverflow.com/users/10773651/hans-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 53844144, "answer_count": 1, "score": 0, "last_activity_date": 1545189896, "creation_date": 1545189661, "last_edit_date": 1545189726, "question_id": 53844118, "link": "https://stackoverflow.com/questions/53844118/how-to-modify-code-to-keep-destination-cell-formatting", "title": "How to modify code to keep destination cell formatting", "body": "<p>I recently came into usage of the code below:</p>\n\n<pre><code>Dim sht1, sht2 As Worksheet\n\nSet sht1 = Worksheets(\"Sheet1\")\nSet sht2 = Worksheets(\"Table\")\n\nsht1.Range(\"K10\").Copy sht2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\nsht1.Range(\"G15\").Copy sht2.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0)\n\nEnd Sub\n</code></pre>\n\n<p>I was hoping if the community could advise how to modify it to allow the destination cell to keep its formatting.</p>\n\n<p>Any help would be greatly appreciated. Thank you in advance.</p>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1545193623, "post_id": 53843955, "comment_id": 94536882, "body": "What does &quot;looks like there is no unique index created&quot; mean? What are you looking at? Do you mean you don&#39;t see a key in SQL Server Management Studio?"}], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 10661104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b469f4c23b63bf3bae19f45ddb9a5e?s=128&d=identicon&r=PG&f=1", "display_name": "namko", "link": "https://stackoverflow.com/users/10661104/namko"}, "edited": false, "score": 0, "creation_date": 1545216093, "post_id": 53845167, "comment_id": 94546441, "body": "There are 2 things in here I do not understand:  1)When we create a new primary key in Access linked &quot;base tables&quot; those changes are reflected in the SQL server but why is ONLY the client \u201cinformed\u201d that the column is a PK in the case of views 2) You are right. I did want the view to be updatable. Why is it that If you don\u2019t tell access what column to use for the PK, then the view will be read only?"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 517, "user_id": 10661104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b469f4c23b63bf3bae19f45ddb9a5e?s=128&d=identicon&r=PG&f=1", "display_name": "namko", "link": "https://stackoverflow.com/users/10661104/namko"}, "edited": false, "score": 1, "creation_date": 1545242266, "post_id": 53845167, "comment_id": 94561369, "body": "You NEVER have to create the PK when linking to a table, only when linking to a view. Linked tables ALWAYS use and get the PK from SQL server. So you NEVER have to set the PK for a linked table. However, a view can have \u201cmany\u201d tables and thus \u201cmany\u201d PK from each table in that view. Access needs a PK to update a view and ALSO a linked table. If you don\u2019t have a PK, then the table is read only on the Access side. So even for a linked table, it will often be read only without a PK. As a general rule for most databases a means to fetch the one row, and then update requires a PK."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 3, "last_activity_date": 1545197817, "creation_date": 1545197817, "answer_id": 53845167, "question_id": 53843955, "link": "https://stackoverflow.com/questions/53843955/unique-index-does-not-appear-in-sql-server/53845167#53845167", "title": "Unique index does not appear in SQL Server", "body": "<p>What you see is correct.</p>\n\n<p>That \u201cindex\u201d creating is ONLY for the Access client. It does NOT create an index on the server side.</p>\n\n<p>Keep in mind that you do NOT want to use an \u201cindexed\u201d view in SQL in 99% of cases.</p>\n\n<p>SQL server will utilize ALL and ANY existing indexes that exist on the server side. Again: you do NOT need to index a view if the base table has the appropriate indexing. </p>\n\n<p>When you execute that command, then ONLY the client is \u201cinformed\u201d that the column is in fact a PK. In ANY and all other cases, use of the index command does ZERO of use for Access, and does ZERO of use on sql server side.</p>\n\n<p>And for your given example, you do not need that index command UNLESS you want the view to be updatable.</p>\n\n<p>When you use the Access interface to link to a SQL view, then Access will prompt you for the PK column. So you ONLY need that \u201cindex\u201d command if you create the liked table with VBA code. When you create a linked table with Access code, then it does NOT prompt you for the PK. And without a PK defined, then Access will treat that view as read only.</p>\n\n<p>So the ONLY case you need to execute that command is if the liked table was created with code as opposed to the Access interface.</p>\n\n<p>Your example of the command does NOT I fact show up on the server side, and is ONLY to tell Access (client side) which column to use as the PK.</p>\n\n<p>Any indexing you setup on sql server in the \u201cbase\u201d tables will ALWAYS be used by the view. You can certainly index a view on sql server, but ONLY if you going to index some data that is not already indexed in the base table, or you have a massive data set, and you want to create a view on that massive data set with an index for performance reasons. Unless that view is somehow special limiting the data from the base tables on sql server, then such indexing is of no use, and as noted, SQL server will ALWAYS use indexing from the base table(s) for that viewed (even when the view has no indexes).</p>\n\n<p>I suspect that the view in question comes from a base table on SQL server, and if that base table has index (such as on the PK), then the view does not need nor require an index.</p>\n\n<p>In your example, the create index command ONLY serves to tell access what column is to be used for the PK. If you don\u2019t tell access what column to use for the PK, then the view will be read only.</p>\n\n<p>So if you bring up that view in the sql server design tools, then the PK of the table(s) involved DOES show. A view on sql server does NOT have the concept of a PK. Since the view does not have a PK (it uses the ones from the base table), then Access cannot guess or know or tell what column is to be used as the PK. (sql server knows, but Access does not). So in these cases, then you have to execute your index command, or use the Access interface which will prompt you for the PK column when you create the link to the view.</p>\n\n<p>So that index command is not sent to sql server \u2013 it ONLY use is to \u201ctell\u201d or \u201cinform\u201d Access client side what column is to be used as the PK column \u2013 nothing more, nothing less.</p>\n\n<p>I should also point out that while you can create indexes for views on sql server, you still cannot define a PK in the view. So even if you did create an index on the sql view, creating of such index(s) still does not allow you to define a PK.</p>\n"}], "owner": {"reputation": 517, "user_id": 10661104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b469f4c23b63bf3bae19f45ddb9a5e?s=128&d=identicon&r=PG&f=1", "display_name": "namko", "link": "https://stackoverflow.com/users/10661104/namko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 53845167, "answer_count": 1, "score": 1, "last_activity_date": 1545197817, "creation_date": 1545188160, "last_edit_date": 1545197246, "question_id": 53843955, "link": "https://stackoverflow.com/questions/53843955/unique-index-does-not-appear-in-sql-server", "title": "Unique index does not appear in SQL Server", "body": "<p>I have views in SQL Server that I have linked to Access as tables. When I create unique index on the views for example like this:</p>\n\n<pre><code>  CurrentProject.connection.Execute \"CREATE UNIQUE INDEX PK ON viewTable (BookID);\"\n</code></pre>\n\n<p>I can see that the linked table which is actually a view in SQL Server has primary key symbol next to it. However, if I go to the view in SQL Server, even though the field ID and InfoID are there it looks like there is no unique index created.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545188378, "post_id": 53843932, "comment_id": 94535852, "body": "What are <code>barcodes</code> and <code>skucodes</code>? Seems like there&#39;s code missing here. Also first two lines should be within a <code>With...End With</code> block."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10808941"}, "is_accepted": false, "score": 0, "last_activity_date": 1545190674, "last_edit_date": 1545190674, "creation_date": 1545188868, "answer_id": 53844033, "question_id": 53843932, "link": "https://stackoverflow.com/questions/53843932/error-when-using-vba-for-index-match-formula-with-cell-address/53844033#53844033", "title": "Error when using vba for index match formula with cell address", "body": "<p>You aren't using the With ... End With block correctly. Note the <code>.</code> which allow .Range and .Cells to inherit the parent worksheet.</p>\n\n<pre><code>With ThisWorkbook.Worksheets(2)\n\n    Dim skumaestro As Range\n    Set skumaestro = .Range(.Cells(lasthandlerow, 13), .Cells(lastskurow, 13))\n\nEnd With\n</code></pre>\n\n<p>Your formula uses xlA1 addresses to try and construct a FormulaR1C1 formula. There is no defined parent worksheet. <em>barcodes</em> and <em>skucodes</em> are undefined. You aren't using <em>start</em> to cycle through anything.</p>\n\n<p>I think you want something like,</p>\n\n<pre><code>For start = 1 To count\n\n     with Range(\"C\" &amp; Rows.count).End(xlUp).Offset(1)   'what parent worksheet?\n\n         .FormulaR1C1 = \"=INDEX(\" &amp; barcodes.Address(True, True, \n      xlR1C1, True) &amp; \",MATCH(\" &amp; skumaestro(start).Address(False, True, xlR1C1, \n      False) &amp; \",\" &amp; skucodes.Address(True, True, xlR1C1, True) &amp; \",0))\"\n\n         .Value = .Value2 \n\n    end with\n\nNext start\n</code></pre>\n\n<p>You aren't using an external address for <em>skumaestro</em> in the formula so it can reasonably be assumed that the formula was intended for the same worksheet used above.</p>\n\n<pre><code>Dim skumaestro As Range, addr1 as string, addr2 as string\n\nWith ThisWorkbook.Worksheets(2)\n\n    Set skumaestro = .Range(.Cells(lasthandlerow, 13), .Cells(lastskurow, 13))\n    addr1 = barcodes.Address(True, True, xlR1C1, external:=True)\n    addr2 = skucodes.Address(True, True, xlR1C1, external:=True)\n\n     with .Range(\"C\" &amp; Rows.count).End(xlUp).Offset(1).resize(count, 1)\n\n         .FormulaR1C1 = \"=INDEX(\" &amp; addr1 &amp; \",MATCH(\" &amp; skumaestro(1).Address(False, True, xlR1C1, False) &amp; \",\" &amp; addr2 &amp; \",0))\"\n         .Value = .Value2 \n\n    end with\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10484907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3KPuW.png?s=128&g=1", "display_name": "Darck28", "link": "https://stackoverflow.com/users/10484907/darck28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579253467, "creation_date": 1545188003, "last_edit_date": 1579253467, "question_id": 53843932, "link": "https://stackoverflow.com/questions/53843932/error-when-using-vba-for-index-match-formula-with-cell-address", "title": "Error when using vba for index match formula with cell address", "body": "<p>Excel keeps throwing me:</p>\n\n<blockquote>\n  <p>Run-time error 1004: Application-defined or object-defined error </p>\n</blockquote>\n\n<p>every time I try to run the below code. I'm not really sure what I'm doing wrong (would really appreciate any advice).</p>\n\n<p>Is it a problem in the way I am defining the <code>skumaestro</code> range?</p>\n\n<p>Thanks</p>\n\n<pre><code>Sub getskus ()\nlastskurow = .Cells(.Rows.count, \"M\").End(xlUp).Row\nlasthandlerow = .Cells(.Rows.count, \"B\").End(xlUp).Row\n\n\nWith ThisWorkbook.Worksheets(2)\n\n    Dim skumaestro As Range\n    Set skumaestro = Range(Cells(lasthandlerow, 13), Cells(lastskurow, 13))\n\nEnd With\nFor start = 1 To count\n\n     Range(\"C\" &amp; Rows.count).End(xlUp).Offset(1).Select\n     ActiveCell.FormulaR1C1 = \"=INDEX(\" &amp; barcodes.Address(True, True, \n      xlA1, True) &amp; \",MATCH(\" &amp; skumaestro(1).Address(False, True, xlA1, \n      False) &amp; \",\" &amp; skucodes.Address(True, True, xlA1, True) &amp; \",0))\"\n\n     ActiveCell.Value2 = ActiveCell.Value2 \n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1545187667, "post_id": 53843786, "comment_id": 94535696, "body": "Use the debugger and step through the code. Look at what&#39;s happening when you are fetching the <i>total</i> portion of the page."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545209275, "post_id": 53843786, "comment_id": 94542508, "body": "As usual &lt;sigh&gt; I can&#39;t view imgur images - just black screen. Do you have actual urls we can test with please? You can use the snippet tool via <a href=\"https://stackoverflow.com/posts/53843786/edit\">edit</a> for inserting HTML."}, {"owner": {"reputation": 11, "user_id": 10778642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6e3e8b19763edb78096a0b1d218dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "petepedropetey", "link": "https://stackoverflow.com/users/10778642/petepedropetey"}, "edited": false, "score": 0, "creation_date": 1545230718, "post_id": 53843786, "comment_id": 94554586, "body": "I&#39;d like to post the url but sadly outside of our worknetwork the links will not connect. That is one thing causing this to be even more of a challenge"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545236357, "post_id": 53843786, "comment_id": 94558252, "body": "Did you try my answer below?"}, {"owner": {"reputation": 11, "user_id": 10778642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6e3e8b19763edb78096a0b1d218dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "petepedropetey", "link": "https://stackoverflow.com/users/10778642/petepedropetey"}, "edited": false, "score": 0, "creation_date": 1545239303, "post_id": 53843786, "comment_id": 94559912, "body": "Sorry, not sure how to use your answer/code and implement that into my file. I am pretty new to excel still and this code was found in another file that someone else made I just made some adjustments to the url link to work with parameters. I did however fix the spacing issue a different way. I&#39;ll add it into my question edit"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1545374670, "last_edit_date": 1545374670, "creation_date": 1545210799, "answer_id": 53847910, "question_id": 53843786, "link": "https://stackoverflow.com/questions/53843786/excel-vba-web-scrape-column-spacing-issue-total-line-is-not-in-the-correct-spot/53847910#53847910", "title": "Excel VBA Web Scrape column spacing issue. Total line is not in the correct spot", "body": "<p>I would use the clipboard to copy across the formatting. I am reading your html from file (edited that part out now) whereas you would extract data from <code>ie.document</code> - outline shown below.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim html As HTMLDocument, tables As Object, i As Long, clipboard As Object\n    Dim ws As Worksheet, tablesDescriptions As Object\n    Dim ie As InternetExplorer, url As String\n    url = \"yourURL\"\n    Set ie = New InternetExplorer 'InternetExplorerMedium\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    ie.Visible = True\n    ie.Navigate2 url\n    While ie.Busy Or ie.readyState &lt; 4: DoEvents: Wend\n    Set html = ie.document\n    Set tables = html.querySelectorAll(\"#secondaryProductivityList table\")\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    Set tablesDescriptions = html.querySelectorAll(\"#secondaryProductivityList h3\")\n    ws.Cells.UnMerge\n\n    For i = 0 To tables.Length - 1 Step 2\n        clipboard.SetText tables.item(i).outerHTML\n        clipboard.PutInClipboard\n        ws.Cells(LastRow(ws) + 2, 1) = tablesDescriptions.item(IIf(i = 0, 0, i / 2)).innerText\n        ws.Cells(LastRow(ws) + 1, 1).PasteSpecial\n    Next\n    ie.Quit\nEnd Sub\n\nPublic Function LastRow(ByVal sh As Worksheet) As Long\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Output:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/7YA2O.png\" width=\"300\"></p>\n"}], "owner": {"reputation": 11, "user_id": 10778642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6e3e8b19763edb78096a0b1d218dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "petepedropetey", "link": "https://stackoverflow.com/users/10778642/petepedropetey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579253276, "creation_date": 1545186830, "last_edit_date": 1579253276, "question_id": 53843786, "link": "https://stackoverflow.com/questions/53843786/excel-vba-web-scrape-column-spacing-issue-total-line-is-not-in-the-correct-spot", "title": "Excel VBA Web Scrape column spacing issue. Total line is not in the correct spot", "body": "<p>[Edit:, inserted html code properly] [edit 2, fixed spacing issue]</p>\n\n<p>spacing issue has been fixed. I copied this line found higher up in the code. </p>\n\n<p>Only thing I would like to do now is have the numbers in the row for totals be bolded, but not sure if that can be singled out in the code. If it can't I'm fine leaving it alone. I just would like that to stand out among the individual employee info.</p>\n\n<pre><code>If TD.getAttribute(\"colspan\") Then\n                Column = Column + TD.getAttribute(\"colspan\")\n</code></pre>\n\n<p>and placed that into this section lower in the code</p>\n\n<pre><code>            Set TDs = TR.getElementsByTagName(\"td\")\n            For Each TD In TDs\n                Worksheet.Cells(Row, Column).Value = TD.innerText\n                If TD.getAttribute(\"colspan\") Then\n                    Column = Column + TD.getAttribute(\"colspan\")\n\n                Else\n\n                Column = Column + 1\n                End If\n</code></pre>\n\n<p>Updated code is now </p>\n\n<pre><code>Sub DownloadPPAProcessData0700()\nDim Browser As InternetExplorer\nDim Document As HTMLDocument\nDim Table As IHTMLElement\nDim Tables As IHTMLElementCollection\nDim Div As IHTMLElement\nDim Divs As IHTMLElementCollection\nDim H3 As IHTMLElement\nDim TR As IHTMLElement\nDim TRs  As IHTMLElementCollection\nDim TD As IHTMLElement\nDim TDs  As IHTMLElementCollection\nDim Row As Integer\nDim Column As Integer\n\nDim Worksheet As Worksheet\n\nDim NodeType As String\nDim Warehouse As String\nDim ProcessId As String\nDim PrimaryAttribute As String\nDim SecondaryAttribute As String\n\nSet Worksheet = ThisWorkbook.Worksheets(\"0700\")\n\nApplication.ScreenUpdating = True\nDim SD As Date\nDim ED As Date\nDim STS As Integer\nDim ETS As Integer\nDim STE As Integer\nDim ETE As Integer\nSD = Worksheets(\"Variables\").Range(\"A2\").Value\nED = Worksheets(\"Variables\").Range(\"A2\").Value\nSTS = Worksheets(\"Variables\").Range(\"B2\").Value\nETS = Worksheets(\"Variables\").Range(\"C2\").Value\nSTE = Worksheets(\"Variables\").Range(\"D2\").Value\nETE = Worksheets(\"Variables\").Range(\"D2\").Value\nApplication.ScreenUpdating = True\n\nNodeType = Worksheet.Cells(2, 1).Value\nWarehouse = Worksheet.Cells(2, 2).Value\nProcessId = Worksheet.Cells(2, 3).Value\nPrimaryAttribute = Worksheet.Cells(2, 4).Value\nSecondaryAttribute = Worksheet.Cells(2, 5).Value\n\nRow = 1\nColumn = 1\n\nSheets(\"0700\").Activate\nSheets(\"0700\").Select\nApplication.ScreenUpdating = True\nWith ActiveSheet\nSet Browser = New InternetExplorerMedium\nBrowser.Navigate \"https://fclm-portal.amazon.com/ppa/inspect/process?&amp;processId=100114&amp;warehouseId=BFI4&amp;primaryAttribute=PICKING_PROCESS_PATH&amp;secondaryAttribute=GL_CODE&amp;maxIntradayDays=1&amp;spanType=Intraday&amp;startDateIntraday=\" &amp; Year(SD) &amp; \"%2F\" &amp; Month(SD) &amp; \"%2F\" &amp; Day(SD) &amp; \"&amp;startHourIntraday=\" &amp; (STS) &amp; \"&amp;startMinuteIntraday=\" &amp; (STE) &amp; \"&amp;endDateIntraday=\" &amp; Year(ED) &amp; \"%2F\" &amp; Month(ED) &amp; \"%2F\" &amp; Day(ED) &amp; \"&amp;endHourIntraday=\" &amp; (ETS) &amp; \"&amp;endMinuteIntraday=\" &amp; (ETE)\n\n'Wait for page to load\nDo While Browser.Busy Or Browser.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nLoop\n\n'Scan the document\nSet Document = Browser.Document\nSet Divs = Document.getElementById(\"secondaryProductivityList\").getElementsByTagName(\"div\")\n    For Each Div In Divs\n     Set H3 = Div.getElementsByTagName(\"h3\")(0)\n\n    If Not Div.className = \"floatHeader\" And Not H3 Is Nothing Then\n        Worksheet.Cells(Row, 1).Value = H3.innerText\n        Worksheet.Cells(Row, 1).Font.Bold = True\n        Row = Row + 1\n\n        Set Tables = Div.getElementsByTagName(\"table\")\n        Set Table = Tables(0)\n        Set TRs = Table.getElementsByTagName(\"tr\")\n        For Each TR In TRs\n            Column = 1\n            Set TDs = TR.getElementsByTagName(\"th\")\n            For Each TD In TDs\n                Worksheet.Cells(Row, Column).Value = TD.innerText\n                Worksheet.Cells(Row, Column).Font.Bold = True\n                If TD.getAttribute(\"colspan\") Then\n                    Column = Column + TD.getAttribute(\"colspan\")\n                Else\n                    Column = Column + 1\n                End If\n                Next\n\n            Set TDs = TR.getElementsByTagName(\"td\")\n            For Each TD In TDs\n                Worksheet.Cells(Row, Column).Value = TD.innerText\n                If TD.getAttribute(\"colspan\") Then\n                    Column = Column + TD.getAttribute(\"colspan\")\n\n                Else\n\n                Column = Column + 1\n                End If\n\n\n                Next\n        Row = Row + 1\n        Next\n    End If\n\n Row = Row + 1\n Next\n Browser.Quit\n Application.ScreenUpdating = True\n End With\n Range(\"A1:Z50\").Columns.AutoFit\n End Sub\n</code></pre>\n\n<p>I am trying to work on a web scrape file, the webpage changes depending on the time of day you want to get info for. but for now I will just post how the code for 1 hour is set up. </p>\n\n<p>This does copy the correct tables from the webpage but the problem I am having is that at the end of each table there should be a total Line, that should match up spacing wise with the other numbers. the word \"total\" on the webpage takes up 3 column, spaces and then the rest of the numbers will follow after and line up with the \"units\" column.</p>\n\n<p>when the macro pulls data, it is placing the total line in the left most cell, and the number data right after it. causing the whole line to be off by two cells.</p>\n\n<p>Including 2 links to images of what the web page looks like and what the excel file spits out </p>\n\n<p><a href=\"https://imgur.com/a/uVwUC8j\" rel=\"nofollow noreferrer\">https://imgur.com/a/uVwUC8j</a></p>\n\n<p><a href=\"https://imgur.com/a/Jjjnyd1\" rel=\"nofollow noreferrer\">https://imgur.com/a/Jjjnyd1</a></p>\n\n<p>here is the code</p>\n\n<pre><code>Sub DownloadPPAProcessData0700()\nDim Browser As InternetExplorer\nDim Document As HTMLDocument\nDim Table As IHTMLElement\nDim Tables As IHTMLElementCollection\nDim Div As IHTMLElement\nDim Divs As IHTMLElementCollection\nDim H3 As IHTMLElement\nDim TR As IHTMLElement\nDim TRs  As IHTMLElementCollection\nDim TD As IHTMLElement\nDim TDs  As IHTMLElementCollection\nDim Row As Integer\nDim Column As Integer\n\nDim Worksheet As Worksheet\n\n\n\nSet Worksheet = ThisWorkbook.Worksheets(\"0700\")\n\nApplication.ScreenUpdating = False\nDim SD As Date\nDim ED As Date\nDim STS As Integer\nDim ETS As Integer\nDim STE As Integer\nDim ETE As Integer\nSD = Worksheets(\"Variables\").Range(\"A2\").Value\nED = Worksheets(\"Variables\").Range(\"A2\").Value\nSTS = Worksheets(\"Variables\").Range(\"B2\").Value\nETS = Worksheets(\"Variables\").Range(\"C2\").Value\nSTE = Worksheets(\"Variables\").Range(\"D2\").Value\nETE = Worksheets(\"Variables\").Range(\"D2\").Value\nApplication.ScreenUpdating = False\n\n\nRow = 1\nColumn = 1\n\nSheets(\"0700\").Activate\nSheets(\"0700\").Select\nWith ActiveSheet\nSet Browser = New InternetExplorerMedium\nBrowser.Navigate \"https://fclm.com/ppa/inspect/process?&amp;processId=100114&amp;warehouseId=...&amp;primaryAttribute=PICKING_PROCESS_PATH&amp;secondaryAttribute=GL_CODE&amp;maxIntradayDays=1&amp;spanType=Intraday&amp;startDateIntraday=\" &amp; Year(SD) &amp; \"%2F\" &amp; Month(SD) &amp; \"%2F\" &amp; Day(SD) &amp; \"&amp;startHourIntraday=\" &amp; (STS) &amp; \"&amp;startMinuteIntraday=\" &amp; (STE) &amp; \"&amp;endDateIntraday=\" &amp; Year(ED) &amp; \"%2F\" &amp; Month(ED) &amp; \"%2F\" &amp; Day(ED) &amp; \"&amp;endHourIntraday=\" &amp; (ETS) &amp; \"&amp;endMinuteIntraday=\" &amp; (ETE)\n\n'Wait for page to load\nDo While Browser.Busy Or Browser.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nLoop\n\n'Scan the document\nSet Document = Browser.Document\nSet Divs = Document.getElementById(\"secondaryProductivityList\").getElementsByTagName(\"div\")\nFor Each Div In Divs\n    Set H3 = Div.getElementsByTagName(\"h3\")(0)\n\n    If Not Div.className = \"floatHeader\" And Not H3 Is Nothing Then\n        Worksheet.Cells(Row, 1).Value = H3.innerText\n        Row = Row + 1\n\n        Set Tables = Div.getElementsByTagName(\"table\")\n        Set Table = Tables(0)\n        Set TRs = Table.getElementsByTagName(\"tr\")\n        For Each TR In TRs\n            Column = 1\n            Set TDs = TR.getElementsByTagName(\"th\")\n            For Each TD In TDs\n                Worksheet.Cells(Row, Column).Value = TD.innerText\n                Worksheet.Cells(Row, Column).Font.Bold = True\n                If TD.getAttribute(\"colspan\") Then\n                    Column = Column + TD.getAttribute(\"colspan\")\n                Else\n                    Column = Column + 1\n                End If\n                Next\n\n            Set TDs = TR.getElementsByTagName(\"td\")\n            For Each TD In TDs\n                Worksheet.Cells(Row, Column).Value = TD.innerText\n                Column = Column + 1\n                Next\n\n        Row = Row + 1\n        Next\n    End If\nRow = Row + 1\nNext\n\nBrowser.Quit\nEnd With\nRange(\"A1:Z50\").Columns.AutoFit\nEnd Sub\n</code></pre>\n\n<p>This is the inspect code for the whole bottom tables I am trying to copy from.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div id=\"secondaryProductivityList\"&gt;\r\n  &lt;div&gt;\r\n    &lt;h3&gt;PICKING_PROCESS_PATH: PPFRACSDESTROY&lt;/h3&gt;\r\n    &lt;table class=\"table table-striped table-bordered table-hover table-condensed\"&gt;\r\n      &lt;thead&gt;\r\n        &lt;tr&gt;\r\n          &lt;th colspan=\"3\" class=\"header\"&gt;&lt;/th&gt;\r\n          &lt;th colspan=\"7\" class=\"header\"&gt;UNKNOWN&lt;/th&gt;\r\n        &lt;/tr&gt;\r\n        &lt;tr&gt;\r\n          &lt;th class=\"header\"&gt;Employee&amp;nbsp;Id&lt;/th&gt;\r\n          &lt;th class=\"header\"&gt;Employee&amp;nbsp;Name&lt;/th&gt;\r\n          &lt;th class=\"header\"&gt;Manager&amp;nbsp;Name&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Units&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Quantity&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Hours (Direct)&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Hours (Inferred)&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Hours (Total)&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;UPH&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;QPH&lt;/th&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/thead&gt;\r\n      &lt;tbody&gt;\r\n        &lt;tr&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"100244269\"&gt;100244269&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"100244269\"&gt;Llarenas, Brandon&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101151204\"&gt;Jackson, Michelle M&lt;/td&gt;\r\n          &lt;td&gt;503&lt;/td&gt;\r\n          &lt;td&gt;503&lt;/td&gt;\r\n          &lt;td&gt;0.92&lt;/td&gt;\r\n          &lt;td&gt;0&lt;/td&gt;\r\n          &lt;td&gt;0.92&lt;/td&gt;\r\n          &lt;td&gt;545.75&lt;/td&gt;\r\n          &lt;td&gt;545.75&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n        &lt;tr&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101157611\"&gt;101157611&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101157611\"&gt;Swearingen, Caitlin&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101151204\"&gt;Jackson, Michelle M&lt;/td&gt;\r\n          &lt;td&gt;539&lt;/td&gt;\r\n          &lt;td&gt;539&lt;/td&gt;\r\n          &lt;td&gt;0.99&lt;/td&gt;\r\n          &lt;td&gt;0&lt;/td&gt;\r\n          &lt;td&gt;0.99&lt;/td&gt;\r\n          &lt;td&gt;543.38&lt;/td&gt;\r\n          &lt;td&gt;543.38&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/tbody&gt;\r\n      &lt;tfoot&gt;\r\n        &lt;tr&gt;\r\n          &lt;td colspan=\"3\" class=\"totalLineItem\"&gt;Total:&lt;/td&gt;\r\n          &lt;td&gt;1,042&lt;/td&gt;\r\n          &lt;td&gt;1,042&lt;/td&gt;\r\n          &lt;td&gt;1.91&lt;/td&gt;\r\n          &lt;td&gt;0&lt;/td&gt;\r\n          &lt;td&gt;1.91&lt;/td&gt;\r\n          &lt;td&gt;544.52&lt;/td&gt;\r\n          &lt;td&gt;544.52&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/tfoot&gt;\r\n    &lt;/table&gt;\r\n    &lt;div class=\"floatHeader\" style=\"display:none\"&gt;\r\n      &lt;table class=\"table table-striped table-bordered table-hover table-condensed\" style=\"width: 1170px;\"&gt;\r\n        &lt;thead&gt;\r\n          &lt;tr&gt;\r\n            &lt;th colspan=\"3\" class=\"header\" style=\"width: 459.233px;\"&gt;&lt;/th&gt;\r\n            &lt;th colspan=\"7\" class=\"header\" style=\"width: 688.233px;\"&gt;UNKNOWN&lt;/th&gt;\r\n          &lt;/tr&gt;\r\n          &lt;tr&gt;\r\n            &lt;th class=\"header\" style=\"width: 110.233px;\"&gt;Employee&amp;nbsp;Id&lt;/th&gt;\r\n            &lt;th class=\"header\" style=\"width: 160.233px;\"&gt;Employee&amp;nbsp;Name&lt;/th&gt;\r\n            &lt;th class=\"header\" style=\"width: 167.233px;\"&gt;Manager&amp;nbsp;Name&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 49.2333px;\"&gt;Units&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 77.2333px;\"&gt;Quantity&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 124.233px;\"&gt;Hours (Direct)&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 141.233px;\"&gt;Hours (Inferred)&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 115.233px;\"&gt;Hours (Total)&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 59.2333px;\"&gt;UPH&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 59.2333px;\"&gt;QPH&lt;/th&gt;\r\n          &lt;/tr&gt;\r\n        &lt;/thead&gt;\r\n      &lt;/table&gt;\r\n    &lt;/div&gt;\r\n  &lt;/div&gt;\r\n  &lt;div&gt;\r\n    &lt;h3&gt;PICKING_PROCESS_PATH: PPFRACSDESTROYHZMT&lt;/h3&gt;\r\n    &lt;table class=\"table table-striped table-bordered table-hover table-condensed\"&gt;\r\n      &lt;thead&gt;\r\n        &lt;tr&gt;\r\n          &lt;th colspan=\"3\" class=\"header\"&gt;&lt;/th&gt;\r\n          &lt;th colspan=\"7\" class=\"header\"&gt;UNKNOWN&lt;/th&gt;\r\n        &lt;/tr&gt;\r\n        &lt;tr&gt;\r\n          &lt;th class=\"header\"&gt;Employee&amp;nbsp;Id&lt;/th&gt;\r\n          &lt;th class=\"header\"&gt;Employee&amp;nbsp;Name&lt;/th&gt;\r\n          &lt;th class=\"header\"&gt;Manager&amp;nbsp;Name&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Units&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Quantity&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Hours (Direct)&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Hours (Inferred)&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Hours (Total)&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;UPH&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;QPH&lt;/th&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/thead&gt;\r\n      &lt;tbody&gt;\r\n        &lt;tr&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"100244269\"&gt;100244269&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"100244269\"&gt;Llarenas, Brandon&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101151204\"&gt;Jackson, Michelle M&lt;/td&gt;\r\n          &lt;td&gt;22&lt;/td&gt;\r\n          &lt;td&gt;22&lt;/td&gt;\r\n          &lt;td&gt;0.08&lt;/td&gt;\r\n          &lt;td&gt;0&lt;/td&gt;\r\n          &lt;td&gt;0.08&lt;/td&gt;\r\n          &lt;td&gt;280.85&lt;/td&gt;\r\n          &lt;td&gt;280.85&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n        &lt;tr&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101157611\"&gt;101157611&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101157611\"&gt;Swearingen, Caitlin&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101151204\"&gt;Jackson, Michelle M&lt;/td&gt;\r\n          &lt;td&gt;5&lt;/td&gt;\r\n          &lt;td&gt;5&lt;/td&gt;\r\n          &lt;td&gt;0.01&lt;/td&gt;\r\n          &lt;td&gt;0&lt;/td&gt;\r\n          &lt;td&gt;0.01&lt;/td&gt;\r\n          &lt;td&gt;620.69&lt;/td&gt;\r\n          &lt;td&gt;620.69&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/tbody&gt;\r\n      &lt;tfoot&gt;\r\n        &lt;tr&gt;\r\n          &lt;td colspan=\"3\" class=\"totalLineItem\"&gt;Total:&lt;/td&gt;\r\n          &lt;td&gt;27&lt;/td&gt;\r\n          &lt;td&gt;27&lt;/td&gt;\r\n          &lt;td&gt;0.09&lt;/td&gt;\r\n          &lt;td&gt;0&lt;/td&gt;\r\n          &lt;td&gt;0.09&lt;/td&gt;\r\n          &lt;td&gt;312.54&lt;/td&gt;\r\n          &lt;td&gt;312.54&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/tfoot&gt;\r\n    &lt;/table&gt;\r\n    &lt;div class=\"floatHeader\" style=\"display:none\"&gt;\r\n      &lt;table class=\"table table-striped table-bordered table-hover table-condensed\" style=\"width: 1170px;\"&gt;\r\n        &lt;thead&gt;\r\n          &lt;tr&gt;\r\n            &lt;th colspan=\"3\" class=\"header\" style=\"width: 459.233px;\"&gt;&lt;/th&gt;\r\n            &lt;th colspan=\"7\" class=\"header\" style=\"width: 688.233px;\"&gt;UNKNOWN&lt;/th&gt;\r\n          &lt;/tr&gt;\r\n          &lt;tr&gt;\r\n            &lt;th class=\"header\" style=\"width: 110.233px;\"&gt;Employee&amp;nbsp;Id&lt;/th&gt;\r\n            &lt;th class=\"header\" style=\"width: 160.233px;\"&gt;Employee&amp;nbsp;Name&lt;/th&gt;\r\n            &lt;th class=\"header\" style=\"width: 167.233px;\"&gt;Manager&amp;nbsp;Name&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 49.2333px;\"&gt;Units&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 77.2333px;\"&gt;Quantity&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 124.233px;\"&gt;Hours (Direct)&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 141.233px;\"&gt;Hours (Inferred)&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 115.233px;\"&gt;Hours (Total)&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 59.2333px;\"&gt;UPH&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 59.2333px;\"&gt;QPH&lt;/th&gt;\r\n          &lt;/tr&gt;\r\n        &lt;/thead&gt;\r\n      &lt;/table&gt;\r\n    &lt;/div&gt;\r\n  &lt;/div&gt;\r\n  &lt;div&gt;\r\n    &lt;h3&gt;PICKING_PROCESS_PATH: PPFRACSLTL&lt;/h3&gt;\r\n    &lt;table class=\"table table-striped table-bordered table-hover table-condensed\"&gt;\r\n      &lt;thead&gt;\r\n        &lt;tr&gt;\r\n          &lt;th colspan=\"3\" class=\"header\"&gt;&lt;/th&gt;\r\n          &lt;th colspan=\"7\" class=\"header\"&gt;UNKNOWN&lt;/th&gt;\r\n        &lt;/tr&gt;\r\n        &lt;tr&gt;\r\n          &lt;th class=\"header\"&gt;Employee&amp;nbsp;Id&lt;/th&gt;\r\n          &lt;th class=\"header\"&gt;Employee&amp;nbsp;Name&lt;/th&gt;\r\n          &lt;th class=\"header\"&gt;Manager&amp;nbsp;Name&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Units&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Quantity&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Hours (Direct)&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Hours (Inferred)&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;Hours (Total)&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;UPH&lt;/th&gt;\r\n          &lt;th class=\"{sorter: 'thousands'} header\"&gt;QPH&lt;/th&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/thead&gt;\r\n      &lt;tbody&gt;\r\n        &lt;tr&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101158899\"&gt;101158899&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101158899\"&gt;Cimafranca, Lorna&lt;/td&gt;\r\n          &lt;td class=\"employeeInspect\" id=\"101151204\"&gt;Jackson, Michelle M&lt;/td&gt;\r\n          &lt;td&gt;1&lt;/td&gt;\r\n          &lt;td&gt;57&lt;/td&gt;\r\n          &lt;td&gt;0.80&lt;/td&gt;\r\n          &lt;td&gt;0.20&lt;/td&gt;\r\n          &lt;td&gt;1&lt;/td&gt;\r\n          &lt;td&gt;1&lt;/td&gt;\r\n          &lt;td&gt;57&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/tbody&gt;\r\n      &lt;tfoot&gt;\r\n        &lt;tr&gt;\r\n          &lt;td colspan=\"3\" class=\"totalLineItem\"&gt;Total:&lt;/td&gt;\r\n          &lt;td&gt;1&lt;/td&gt;\r\n          &lt;td&gt;57&lt;/td&gt;\r\n          &lt;td&gt;0.80&lt;/td&gt;\r\n          &lt;td&gt;0.20&lt;/td&gt;\r\n          &lt;td&gt;1&lt;/td&gt;\r\n          &lt;td&gt;1&lt;/td&gt;\r\n          &lt;td&gt;57&lt;/td&gt;\r\n        &lt;/tr&gt;\r\n      &lt;/tfoot&gt;\r\n    &lt;/table&gt;\r\n    &lt;div class=\"floatHeader\" style=\"display:none\"&gt;\r\n      &lt;table class=\"table table-striped table-bordered table-hover table-condensed\" style=\"width: 1170px;\"&gt;\r\n        &lt;thead&gt;\r\n          &lt;tr&gt;\r\n            &lt;th colspan=\"3\" class=\"header\" style=\"width: 468.233px;\"&gt;&lt;/th&gt;\r\n            &lt;th colspan=\"7\" class=\"header\" style=\"width: 679.233px;\"&gt;UNKNOWN&lt;/th&gt;\r\n          &lt;/tr&gt;\r\n          &lt;tr&gt;\r\n            &lt;th class=\"header\" style=\"width: 115.233px;\"&gt;Employee&amp;nbsp;Id&lt;/th&gt;\r\n            &lt;th class=\"header\" style=\"width: 159.233px;\"&gt;Employee&amp;nbsp;Name&lt;/th&gt;\r\n            &lt;th class=\"header\" style=\"width: 173.233px;\"&gt;Manager&amp;nbsp;Name&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 51.2333px;\"&gt;Units&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 80.2333px;\"&gt;Quantity&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 129.233px;\"&gt;Hours (Direct)&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 146.233px;\"&gt;Hours (Inferred)&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 119.233px;\"&gt;Hours (Total)&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 43.2333px;\"&gt;UPH&lt;/th&gt;\r\n            &lt;th class=\"{sorter: 'thousands'} header\" style=\"width: 44.2333px;\"&gt;QPH&lt;/th&gt;\r\n          &lt;/tr&gt;\r\n        &lt;/thead&gt;\r\n      &lt;/table&gt;\r\n    &lt;/div&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1545189164, "post_id": 53843601, "comment_id": 94536009, "body": "If the function does what you say it does AND the fields contain what you think they contain, then the SQL looks reasonable so there should be no problem.  If it does not work, then you need to <b>inspect each part separately</b>.  This is a debugging exercise for which you have not provided enough information to be useful here.  There are so many ways to debug this that it is almost not worth listing the possibilities: use the VBA immediate window; execute a query without a WHERE clause, but with individual expressions in the SELECT list so that you can see the values; etc."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1545189260, "post_id": 53843601, "comment_id": 94536030, "body": "Although it may not be the only cause of problems, you should consider NULL values.  How does <code>OnlyDigits()</code> handle NULL values?"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1545189724, "post_id": 53843601, "comment_id": 94536113, "body": "If the error says &quot;typed incorrectly&quot;, that is the key... check the datatypes of all function parameters of <code>OnlyDigits()</code>.  Check the data type of the <code>JobNumber</code> control on the form.  It is likely a variant that contains a string value or Null.  Check the data type of the jobnumber field.  Is this field nullable?  Are all of these data types compatible?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545191977, "post_id": 53843601, "comment_id": 94536549, "body": "I count 10 parens in the WHERE statement. As far as I can see they do match. Edit question to post the OnlyDigits() function. I would not use WHERE clause in query. Instead of dynamic parameterized query, I would use WHERE argument of DoCmd.OpenForm or if form already open, set Filter and FilterOn properties."}, {"owner": {"reputation": 43, "user_id": 5614010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6227c0b5ed1ed58ae2068cc82e89333f?s=128&d=identicon&r=PG&f=1", "display_name": "Mel Forsyth", "link": "https://stackoverflow.com/users/5614010/mel-forsyth"}, "edited": false, "score": 0, "creation_date": 1545610384, "post_id": 53843601, "comment_id": 94660842, "body": "I have added the onlydigits function above so you can see how NULLs are treated etc.   The resulting format in my query is text and I have tried the answer below but I get a type mismatch error."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5614010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6227c0b5ed1ed58ae2068cc82e89333f?s=128&d=identicon&r=PG&f=1", "display_name": "Mel Forsyth", "link": "https://stackoverflow.com/users/5614010/mel-forsyth"}, "edited": false, "score": 0, "creation_date": 1545610482, "post_id": 53847468, "comment_id": 94660852, "body": "I have tried this in my query but get a type mismatch error.  The query shows the JobNumberDigits as a text field.  Do I need to change the result from the onlydigits function to something other than a string?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 43, "user_id": 5614010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6227c0b5ed1ed58ae2068cc82e89333f?s=128&d=identicon&r=PG&f=1", "display_name": "Mel Forsyth", "link": "https://stackoverflow.com/users/5614010/mel-forsyth"}, "edited": false, "score": 0, "creation_date": 1545644691, "post_id": 53847468, "comment_id": 94667305, "body": "Perhaps your JobNumber contains Null values. Seee edited answer, please."}, {"owner": {"reputation": 43, "user_id": 5614010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6227c0b5ed1ed58ae2068cc82e89333f?s=128&d=identicon&r=PG&f=1", "display_name": "Mel Forsyth", "link": "https://stackoverflow.com/users/5614010/mel-forsyth"}, "edited": false, "score": 0, "creation_date": 1546068813, "post_id": 53847468, "comment_id": 94772871, "body": "Perfect. Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1545644642, "last_edit_date": 1545644642, "creation_date": 1545209073, "answer_id": 53847468, "question_id": 53843601, "link": "https://stackoverflow.com/questions/53843601/onlydigits-function-in-criteria/53847468#53847468", "title": "OnlyDigits Function in Criteria", "body": "<p>Try specifying the parameter to free Access from guessing:</p>\n\n<pre><code>PARAMETERS \n    [Forms]![tblDelivery]![JobNumber] Text;\nSELECT \n    OnlyDigits(JobNumber) AS JobNumberDigits, \n    tbldelivery.DelDateDoors, \n    tbldelivery.Lag, \n    tbldelivery.ProductionDate, \n    tbldelivery.OrderNumber, \n    tbldelivery.JobNumber\nFROM \n    tbldelivery\nWHERE \n    OnlyDigits(JobNumber)=OnlyDigits([Forms]![tblDelivery]![JobNumber]);\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>WHERE \n    OnlyDigits(CStr(Nz(JobNumber, 0)))=OnlyDigits([Forms]![tblDelivery]![JobNumber]);\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5614010, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6227c0b5ed1ed58ae2068cc82e89333f?s=128&d=identicon&r=PG&f=1", "display_name": "Mel Forsyth", "link": "https://stackoverflow.com/users/5614010/mel-forsyth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 53847468, "answer_count": 1, "score": -1, "last_activity_date": 1545644642, "creation_date": 1545185153, "last_edit_date": 1545610294, "question_id": 53843601, "link": "https://stackoverflow.com/questions/53843601/onlydigits-function-in-criteria", "title": "OnlyDigits Function in Criteria", "body": "<p>My database has a job number field that consists of year+month/serialnumber+type.  There can be multiple jobs with the same job number:</p>\n\n<p>201812/6Door<br>\n201812/6Stair<br>\n201812/6Wardrobe</p>\n\n<p>When the user wants to change the date of any/all of these records I want all 201812/6 jobs to show in a form.</p>\n\n<p>I have successfully used the OnlyDigits function below to pull only numbers from the text field: OnlyDigits(JobNumber) = 2018126.  But I can't figure out how to filter the form to show all jobs containing 2018126.</p>\n\n<p>I have tried using this query but get an error saying expression typed incorrectly or is too complex. </p>\n\n<pre><code>SELECT onlydigits(jobnumber) AS JobNumberDigits, tbldelivery.DelDateDoors, tbldelivery.Lag, tbldelivery.ProductionDate, tbldelivery.OrderNumber, tbldelivery.JobNumber\nFROM tbldelivery\nWHERE (((onlydigits(jobnumber))=OnlyDigits([Forms]![tblDelivery]![JobNumber])));\n</code></pre>\n\n<p>I also tried using a where expression in Docmd.OpenForm but that didn't work either.  Can anyone suggest how I use this function to filter?</p>\n\n<pre><code>Public Function OnlyDigits(ByVal pInput As String) As String\n    Static objRegExp As Object\n\n    If objRegExp Is Nothing Then\n        Set objRegExp = CreateObject(\"VBScript.RegExp\")\n        With objRegExp\n            .Global = True\n            .Pattern = \"[^\\d]\"\n        End With\n    End If\n    OnlyDigits = objRegExp.Replace(pInput, vbNullString)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "multidimensional-array", "listbox-control"], "comments": [{"owner": {"reputation": 1, "user_id": 10775106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd1a7d837b0db751ddfd4028421c3860?s=128&d=identicon&r=PG&f=1", "display_name": "BelfraGadisco", "link": "https://stackoverflow.com/users/10775106/belfragadisco"}, "edited": false, "score": 0, "creation_date": 1545181096, "post_id": 53843157, "comment_id": 94534473, "body": "I tried the advise of L42 to check the code line by line but i still can&#39;t find the where i was wrong."}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1545243229, "post_id": 53843157, "comment_id": 94561762, "body": "ListBox stars at 1"}], "owner": {"reputation": 1, "user_id": 10775106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd1a7d837b0db751ddfd4028421c3860?s=128&d=identicon&r=PG&f=1", "display_name": "BelfraGadisco", "link": "https://stackoverflow.com/users/10775106/belfragadisco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1579253298, "creation_date": 1545180656, "last_edit_date": 1579253298, "question_id": 53843157, "link": "https://stackoverflow.com/questions/53843157/listbox-control-first-row-disappears", "title": "ListBox Control: First Row Disappears", "body": "<p>REPOST from my question yesterday.\nComplete code below:\nI think the problem is at    .Column = MyArray where I send the values into the Listbox thru    .column instead of    .additem. But i can't figure out how to    .additem an    array. </p>\n\n<pre><code>Option Explicit\nDim MyArray As Variant\nDim n As Integer\n\nPrivate Sub UserForm_initialize()\nn = 0\nEnd Sub\n\nPrivate Sub FBcv_aDD_Click()\nReDim MyArray(4, n)\nDim i As Long\n'============================================\nIf ListBox_FB.ListIndex = True Then\n    MyArray(0, n) = \"Cavity Fixing Block\"\n    MyArray(1, n) = FBcv_L.Value &amp; \" x \" &amp; FBcv_W.Value &amp; \" x \" &amp; FBcv_T.Value\n    If FBcv_Qty &lt;= 1 Then\n        MyArray(2, n) = FBcv_Qty.Value &amp; \"pc.\"\n    ElseIf FBcv_Qty &gt; 1 Then\n        MyArray(2, n) = FBcv_Qty.Value &amp; \"pcs.\"\n    End If\n    MyArray(3, n) = FBmat.Value\n    MyArray(4, n) = FBcv_uPRICE.Value\nn = n + 1\nEnd If\n'============================================\nWith ListBox_FB\n    For i = 0 To ListBox_FB.ListCount - 1\n        If ListBox_FB.ListIndex = False Then\n            .AddItem ListBox_FB.List(i, 0)\n            ListBox_FB.List(ListBox_FB.ListCount - 1, 1) = ListBox_FB.List(i, 1)\n            ListBox_FB.List(ListBox_FB.ListCount - 1, 2) = ListBox_FB.List(i, 2)\n            ListBox_FB.List(ListBox_FB.ListCount - 1, 3) = ListBox_FB.List(i, 3)\n            ListBox_FB.List(ListBox_FB.ListCount - 1, 4) = ListBox_FB.List(i, 4)\n        End If\n    Next i\n    .ColumnCount = 5\n    .TextAlign = 1\n    .Column = MyArray\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Sorry I had to repost this, i messed up with my first question.</p>\n\n<p>Can anyone help me sort this out?\nAny help is highly appreciated. Thanks in advanCce.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1545181554, "post_id": 53842848, "comment_id": 94534562, "body": "Would help a lot to show all of the relevant code here, including populating the various variables in use.  You have a lot jammed into that one line of code, and you&#39;d find it easier to debug if you declare some worksheet variables and use those in place of the inlined <code>workbooks(x).worksheets(y)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10808609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa65d70f870f94eed9908a3bb7a2ede?s=128&d=identicon&r=PG&f=1", "display_name": "siskl01", "link": "https://stackoverflow.com/users/10808609/siskl01"}, "edited": false, "score": 0, "creation_date": 1545243635, "post_id": 53842919, "comment_id": 94561940, "body": "Awesome, thank you. So the issue was that I did not know the name of  the sheet and it would change per workbook. So I had to add in Activesheet.name and then reference that. The quotations where missing as I was trying to make sure that the first sheet was referenced. Forgot that it wouldn&#39;t know which sheet."}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": false, "score": 1, "last_activity_date": 1545179222, "last_edit_date": 1545179222, "creation_date": 1545178612, "answer_id": 53842919, "question_id": 53842848, "link": "https://stackoverflow.com/questions/53842848/vba-excel-value-shows-as-integer-while-is-text/53842919#53842919", "title": "VBA Excel Value shows as integer while is text", "body": "<p>Unless you have declared and initialized somewhere else a variable named Sheet1, of an integer type or of the string type, you're missing the double quotes around <code>Sheet1</code>. The same goes for <code>ThisBook</code>.</p>\n\n<p>There's probably a worksheet whose CodeName property is Sheet1 in the workbook where your code resides; the Worksheets() collection expects either an integer index or string identifier, not a Worksheet type, hence the type mismatch error.</p>\n\n<p>If, by using <code>Workbooks(ThisBook)</code>, you are trying to refer to the workbook where the code resides, just use <code>ThisWorkbook</code> instead.</p>\n\n<p>The final line would then be:</p>\n\n<pre><code>Vlook = Application.VLookup(Workbooks(CSVName).Worksheets(\"Sheet1\").Range(\"A1\").Value, ThisWorkbook.Worksheets(\"Macro\").Range(\"N1:N50\").Value, 1, False)\n</code></pre>\n\n<p>If, from the VBE's Properties window, you assign a proper (Name) value to your \"Macro\" worksheet, such as e.g. MacroWs, you will be able to refer to it directly by this name in your code, provided the code executes within the workbook hosting the worksheet. Then you could go:</p>\n\n<pre><code>Vlook = Application.VLookup(Workbooks(CSVName).Worksheets(\"Sheet1\").Range(\"A1\").Value, MacroWs.Range(\"N1:N50\").Value, 1, False)\n</code></pre>\n\n<p>... and your code would be impervious to the possible renaming of the \"Macro\" worksheet to something else.</p>\n"}], "owner": {"reputation": 1, "user_id": 10808609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa65d70f870f94eed9908a3bb7a2ede?s=128&d=identicon&r=PG&f=1", "display_name": "siskl01", "link": "https://stackoverflow.com/users/10808609/siskl01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579253479, "creation_date": 1545177857, "last_edit_date": 1579253479, "question_id": 53842848, "link": "https://stackoverflow.com/questions/53842848/vba-excel-value-shows-as-integer-while-is-text", "title": "VBA Excel Value shows as integer while is text", "body": "<p>I am attempting to do a Vlookup in VBA, and I am getting a</p>\n\n<blockquote>\n  <p>type mismatch Error 13. </p>\n</blockquote>\n\n<p>The code is Below:</p>\n\n<pre><code>Dim CSVName As String\nDim ThisBook As String\nDim Vlook As Variant\n\nVlook = Application.VLookup(Workbooks(CSVName).Worksheets(Sheet1).Range(\"A1\").Value, Workbooks(ThisBook).Worksheets(\"Macro\").Range(\"N1:N50\").Value, 1, False)\n</code></pre>\n\n<p>When I apply the CSVName Value to the watches window it comes up with Type (Variant/Int) When the file in questions has text in it The cell contains (\"BALANCING_SEGMENT\"). Which I cannot figure out. What am I missing here? The purpose of this is to check the value in CSVName against the list and return a 1 if its in the list and not if its not, then process an if statement.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["arrays", "excel", "vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "is_accepted": true, "score": 1, "last_activity_date": 1545177598, "creation_date": 1545177598, "answer_id": 53842818, "question_id": 53842527, "link": "https://stackoverflow.com/questions/53842527/using-vba-print-an-array-made-in-word-to-excel/53842818#53842818", "title": "Using VBA, print an array made in Word to Excel", "body": "<p>This is tested and working fine :</p>\n\n<pre><code>Option Explicit\n\nSub addUnderlinedWordsToArray()\n\n    Dim myWords()       As String\n    Dim i               As Long\n    Dim myDoc           As Document: Set myDoc = ActiveDocument ' Change as needed\n    Dim aRange          As Range: Set aRange = myDoc.Content\n    Dim sRanges         As StoryRanges: Set sRanges = myDoc.StoryRanges\n    Dim ArrayCounter    As Long: ArrayCounter = 0 ' counter for items added to the array\n    Dim Sentence        As Range\n    Dim w               As Variant\n    Dim Ex0             As Excel.Application\n    Dim Wb0             As Workbook\n\n    Application.ScreenUpdating = False\n\n    On Error GoTo errhand:\n    For Each Sentence In ActiveDocument.StoryRanges\n        For Each w In ActiveDocument.Sentences\n            If w.Font.Underline &lt;&gt; wdUnderlineNone Then\n                ReDim Preserve myWords(ArrayCounter)\n                myWords(ArrayCounter) = w\n                ArrayCounter = ArrayCounter + 1\n            End If\n        Next\n    Next\n    On Error GoTo 0\n\n    Set myDoc = Nothing\n    Set aRange = Nothing\n    Set sRanges = Nothing\n\n\n    Set Ex0 = New Excel.Application\n    Set Wb0 = Ex0.workbooks.Add\n    Ex0.Visible = True\n\n    Wb0.Sheets(1).Range(\"A1\").Resize(UBound(myWords) + 1, 1) = WorksheetFunction.Transpose(myWords)\n\n    Application.ScreenUpdating = True\n\n    Debug.Print UBound(myWords())\n\n    Exit Sub\n\nerrhand:\n    Application.ScreenUpdating = True\n    MsgBox \"An unexpected error has occurred.\" _\n         &amp; vbCrLf &amp; \"Please note and report the following information.\" _\n         &amp; vbCrLf &amp; \"Subroutine Name: addUnderlinedWordsToArray\" _\n         &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n         &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n         , vbCritical, \"Error!\"\nEnd Sub\n</code></pre>\n\n<p>Make sure to have the <code>Microsoft Excel 14.0 Object Library</code> ticked in <code>Tools/References</code></p>\n"}, {"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 2, "last_activity_date": 1545179950, "last_edit_date": 1545179950, "creation_date": 1545178025, "answer_id": 53842865, "question_id": 53842527, "link": "https://stackoverflow.com/questions/53842527/using-vba-print-an-array-made-in-word-to-excel/53842865#53842865", "title": "Using VBA, print an array made in Word to Excel", "body": "<p>I prefer to use Late Binding over adding an external reference to Excel.  This will allow the code to work properly no mater what version of Office is installed.</p>\n\n<pre><code>Sub addUnderlinedWordsToArray()\n    On Error GoTo errhand:\n    Dim myWords() As String\n    Dim i As Long\n    Dim myDoc As Document: Set myDoc = ActiveDocument    ' Change as needed\n    Dim aRange As Range: Set aRange = myDoc.Content\n    Dim sRanges As StoryRanges: Set sRanges = myDoc.StoryRanges\n    Dim ArrayCounter As Long: ArrayCounter = 0        ' counter for items added to the array\n    Dim Sentence As Range\n    Dim w As Variant\n\n    Application.ScreenUpdating = False\n    ReDim myWords(aRange.Words.Count)                 ' set a array as large as the\n    ' number of words in the doc\n\n    For Each Sentence In ActiveDocument.StoryRanges\n        For Each w In ActiveDocument.Sentences\n            If w.Font.Underline &lt;&gt; wdUnderlineNone Then\n                myWords(ArrayCounter) = w\n                ArrayCounter = ArrayCounter + 1\n            End If\n        Next\n    Next\n\n    ReDim Preserve myWords(ArrayCounter - 1)\n    AddWordsToExcel myWords\n    Set myDoc = Nothing\n    Set aRange = Nothing\n    Set sRange = Nothing\n    Application.ScreenUpdating = True\n    Exit Sub\n\nerrhand:\n    Application.ScreenUpdating = True\n    MsgBox \"An unexpected error has occurred.\" _\n           &amp; vbCrLf &amp; \"Please note and report the following information.\" _\n           &amp; vbCrLf &amp; \"Subroutine Name: addUnderlinedWordsToArray\" _\n           &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n           &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n           , vbCritical, \"Error!\"\nEnd Sub\n\nSub AddWordsToExcel(myWords() As String)\n    Dim xlApp As Object\n    Set xlApp = CreateObject(\"Excel.Application\")\n\n    Dim wb As Object\n    Set wb = xlApp.Workbooks.Add\n    wb.Worksheets(1).Range(\"A1\").Resize(UBound(myWords) + 1).Value = xlApp.Transpose(myWords)\n    xlApp.Visible = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8424493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be7549c923053a57708115b743d6ebb3?s=128&d=identicon&r=PG&f=1", "display_name": "Randino", "link": "https://stackoverflow.com/users/8424493/randino"}, "is_accepted": false, "score": -2, "last_activity_date": 1545178735, "last_edit_date": 1545178735, "creation_date": 1545178222, "answer_id": 53842889, "question_id": 53842527, "link": "https://stackoverflow.com/questions/53842527/using-vba-print-an-array-made-in-word-to-excel/53842889#53842889", "title": "Using VBA, print an array made in Word to Excel", "body": "<p>The general answer is to use <code>Range (\"A1\") =  myWords(ArrayCounter)</code>\nYou would need to step through the array while simultaneously moving to the next cell.</p>\n\n<p>You could also use <code>Range (\"A1:B3\") = myWords</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1545231037, "post_id": 53846398, "comment_id": 94554796, "body": "I take pleasure in reading your helpful and instructive descriptions +1)"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1545204235, "creation_date": 1545204235, "answer_id": 53846398, "question_id": 53842527, "link": "https://stackoverflow.com/questions/53842527/using-vba-print-an-array-made-in-word-to-excel/53846398#53846398", "title": "Using VBA, print an array made in Word to Excel", "body": "<p>The code provided in the question has some problems, which I've tried to correct as per the problem description.</p>\n\n<ol>\n<li>The code declares a number of object variables, assigning them in the same line as the declaration, but these objects are never used. In order to improve code readability and make these objects \"obvious\" I've moved the instantiations to new lines.</li>\n<li>The sample code below then substitutes these objects for the <code>ActiveDocument...</code> objects used in the original code, where these objects are intended to be used. This makes the code more readabile and more efficient.</li>\n<li>The use of <code>StoryRanges</code> is questionable in the context of the code. <code>StoryRanges</code> are not the same as <code>Sentences</code>. On the assumption that the use of <code>StoryRanges</code> was a misunderstanding or typo, I've changed the code to use <code>Sentences</code>. If <code>StoryRanges</code> is meant, the code can loop through them, but certain structural changes would be required. (<code>StoryRanges</code> enables code to access all parts of a document such as TextBoxes, Headers, Footers, Endnotes - instead of just the main body of the document.)</li>\n<li>It makes no sense to loop sentences while sizing the array to the number of <em>words</em> in the document. This has been changed to the number of sentences, which will require less memory.</li>\n<li>Only the text, not the entire sentence <code>Range</code> should be added to the array since Excel can't do anything with a <code>Word.Range</code> except accept its text. This will require less memory.</li>\n<li>On the assumption that not every sentence in the document is underlined, it's not necessary to maintain an array with empty members, so after the loop the array is resized to contain only those that have been populated. (<code>ReDim Preserve myWords(ArrayCounter - 1)</code>). This will avoid writing \"empty\" content to the Excel worksheet.</li>\n<li><p>The code to write to Excel is in a separate procedure, making it re-usable for other arrays that might need to be transferred to Excel. The code has been written as late-binding, making it independent of requiring a reference to the Excel library. If early-binding (with a reference) is desired, those declarations are commented out in-line.</p></li>\n<li><p>The writing to Excel only occurs if the array contains members. If <code>ArrayCounter</code> has never been incremented, the call to the other procedure is not performed.</p></li>\n<li><p>The Excel objects are set to <code>Nothing</code> at the end of that procedure.</p></li>\n</ol>\n\n<p>Note: The code posted in the question and used here picks up any sentence that <em>contains</em> an underline.</p>\n\n<p>Sample code:</p>\n\n<pre><code>Sub addUnderlinedWordsToArray()\n    On Error GoTo errhand:\n\n    Dim myWords()       As String\n    Dim i               As Long\n    Dim myDoc           As Document\n    Dim aRange          As Range\n    Dim sRanges         As Sentences\n    Dim ArrayCounter    As Long ' counter for items added to the array\n    Dim Sentence        As Range\n    Dim w               As Variant\n\n    Application.ScreenUpdating = False\n    Set myDoc = ActiveDocument ' Change as needed\n    Set aRange = myDoc.content\n    Set sRanges = myDoc.Sentences\n    ArrayCounter = 0\n    ReDim myWords(aRange.Sentences.Count - 1) ' set a array as large as the\n                                      ' number of sentences in the doc\n\n    For Each Sentence In sRanges\n        If Sentence.Font.Underline &lt;&gt; wdUnderlineNone Then\n            myWords(ArrayCounter) = Sentence.text\n            ArrayCounter = ArrayCounter + 1\n        End If\n    Next\n\n    If ArrayCounter &gt; 0 Then\n        ReDim Preserve myWords(ArrayCounter - 1)\n        WriteToExcel myWords\n    End If\n\n    Set myDoc = Nothing\n    Set aRange = Nothing\n    Set sRanges = Nothing\n    Application.ScreenUpdating = True\n    Exit Sub\n\n    errhand:\n    Application.ScreenUpdating = True\n    MsgBox \"An unexpected error has occurred.\" _\n         &amp; vbCrLf &amp; \"Please note and report the following information.\" _\n         &amp; vbCrLf &amp; \"Subroutine Name: addUnderlinedWordsToArray\" _\n         &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n         &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n         , vbCritical, \"Error!\"\nEnd Sub\n\nSub WriteToExcel(a As Variant)\n    Dim appExcel As Object   'Excel.Application\n    Dim wb As Object         ' Excel.Workbook\n    Dim r As Object          ' Excel.Range\n    Dim i As Long\n\n    Set appExcel = CreateObject(\"Excel.Application\")\n    appExcel.Visible = True\n    appExcel.UserControl = True\n    Set wb = appExcel.Workbooks.Add\n    Set r = wb.Worksheets(1).Range(\"A1\")\n    r.Resize(UBound(myWords) + 1).Value = xlApp.Transpose(myWords)\n\n    Set r = Nothing\n    Set wb = Nothing\n    Set appExcel = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8727171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb9ce5ae520ac8024fe24a8ee3555898?s=128&d=identicon&r=PG&f=1", "display_name": "mfergus9", "link": "https://stackoverflow.com/users/8727171/mfergus9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 53842818, "answer_count": 4, "score": 1, "last_activity_date": 1545204250, "creation_date": 1545175265, "last_edit_date": 1545204250, "question_id": 53842527, "link": "https://stackoverflow.com/questions/53842527/using-vba-print-an-array-made-in-word-to-excel", "title": "Using VBA, print an array made in Word to Excel", "body": "<p>I am a VBA novice and I am trying to print an array that I was able to make (basically copying from another post) in VBA today.  I placed a break into the script and inspected the array in the locals page to see that the array captures what I want (and some extra data that I will filter out).  I spent the day reading about printing arrays on stack overflow and other sites and I ended up a bit lost.  My goal is to export the array as a table in excel.</p>\n\n<p>The script looks for underlined sentences in a 400 page word document and places them into the array.  All that's really necessary for printing is the underlined sentences, so maybe an array wasn't the best approach?  How can I export the array 'myWords' to a fresh excel document or one that I designate?</p>\n\n<p>Many thanks for your help!</p>\n\n<pre><code>Sub addUnderlinedWordsToArray()\nOn Error GoTo errhand:\n    Dim myWords()       As String\n    Dim i               As Long\n    Dim myDoc           As Document: Set myDoc = ActiveDocument ' Change as needed\n    Dim aRange          As Range: Set aRange = myDoc.Content\n    Dim sRanges         As StoryRanges: Set sRanges = myDoc.StoryRanges\n    Dim ArrayCounter    As Long: ArrayCounter = 0 ' counter for items added to the array\n    Dim Sentence        As Range\n    Dim w               As Variant\n\n    Application.ScreenUpdating = False\n    ReDim myWords(aRange.Words.Count) ' set a array as large as the\n                                      ' number of words in the doc\n\n    For Each Sentence In ActiveDocument.StoryRanges\n        For Each w In ActiveDocument.Sentences\n\n            If w.Font.Underline &lt;&gt; wdUnderlineNone Then\n                myWords(ArrayCounter) = w\n                ArrayCounter = ArrayCounter + 1\n            End If\n        Next\n    Next\nSet myDoc = Nothing\n    Set aRange = Nothing\n    Set sRange = Nothing\n    Application.ScreenUpdating = True\n    Exit Sub\n\nerrhand:\n    Application.ScreenUpdating = True\n    MsgBox \"An unexpected error has occurred.\" _\n         &amp; vbCrLf &amp; \"Please note and report the following information.\" _\n         &amp; vbCrLf &amp; \"Subroutine Name: addUnderlinedWordsToArray\" _\n         &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n         &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n         , vbCritical, \"Error!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545177028, "post_id": 53842430, "comment_id": 94533595, "body": "I just use <code>CurrentDb.Execute</code>. AFAIK, Access doesn&#39;t care if the table is local or linked as long as it finds the name in tables collection."}], "answers": [{"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 2, "last_activity_date": 1545198928, "creation_date": 1545198928, "answer_id": 53845340, "question_id": 53842430, "link": "https://stackoverflow.com/questions/53842430/currentproject-connection-execute-in-local-tables-vs-linked-tables/53845340#53845340", "title": "currentproject.connection.execute in local tables vs linked tables", "body": "<p>Well if the table is linked, then Access actually looks at each table, and pulls that information each time.</p>\n\n<p>If you want to see the actual connection used, then in the debug window do this:</p>\n\n<p>? currentdb.TableDefs(\"local table\").Connection</p>\n\n<pre><code>&lt;blank returned&gt;\n</code></pre>\n\n<p>Or</p>\n\n<p>? currentdb.TableDefs(\"some linked table\").connection</p>\n\n<pre><code>ODBC;Description=My cool conneciton;DRIVER=SQL Server;\nSERVER=localhost\\SQLEXPRESS;\nUID=AlbertKallal;Trusted_Connection=Yes;\nAPP=Microsoft Office 2010;DATABASE=test3\n</code></pre>\n\n<p>You are most free to currentconnetion, even if you have \u201cseveral\u201d different Access back ends, or linked tables to sql server.</p>\n\n<p>I guess I could state and suggest that Access really eventually uses the information in the table link to resolve the sql, not the CurrentProject.Connection. </p>\n\n<p>currentProject.Connection will \u201cresolve\u201d and tell access where the table is \u2013 including linked tables. But once access grabs and touches the linked table based on CurrentProject.Connection, it then uses the information in the linked table.</p>\n\n<p>This setup thus allows you to use any local table, or linked table as if it was just a plane jane regular table from Access point of view.\nSo </p>\n\n<p>step one: CurrentProject.Connection (where is the table, or the link)</p>\n\n<p>step two: Get information from that table def - either local, or linked</p>\n\n<p>step three: do the sql dirty work.</p>\n"}], "owner": {"reputation": 517, "user_id": 10661104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b469f4c23b63bf3bae19f45ddb9a5e?s=128&d=identicon&r=PG&f=1", "display_name": "namko", "link": "https://stackoverflow.com/users/10661104/namko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 53845340, "answer_count": 1, "score": 1, "last_activity_date": 1545198928, "creation_date": 1545174569, "question_id": 53842430, "link": "https://stackoverflow.com/questions/53842430/currentproject-connection-execute-in-local-tables-vs-linked-tables", "title": "currentproject.connection.execute in local tables vs linked tables", "body": "<p>When we use currentproject.execute code like this:</p>\n\n<pre><code>CurrentProject.connection.Execute \"INSERT INTO Books (Name, Type) VALUES ('Book Name', 'STRING');\"\n</code></pre>\n\n<p>To manipulate both local and linked tables. During both case if I debug.print currentproject.connection, I get the same string which looks like this:</p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=C:\\Users\\David\\Desktop\\Comp - Copy.mdb;Mode=Share Deny None;Extended Properties=\"\";Jet OLEDB:System database=C:\\Users\\David\\AppData\\Roaming\\Microsoft\\Access\\System3.mdw;Jet OLEDB:Registry Path=Software\\Microsoft\\Office\\16.0\\Access\\Access Connectivity Engine;Jet OLEDB:Database Password=\"\";Jet OLEDB:Engine Type=5;Jet OLEDB:Database Locking Mode=1;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB:Global Bulk Transactions=1;Jet OLEDB:New Database Password=\"\";Jet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on Compact=False;Jet OLEDB:Compact Without Replica Repair=False;Jet OLEDB:SFP=False;Jet OLEDB:Support Complex Data=True;Jet OLEDB:Bypass UserInfo Validation=False;Jet OLEDB:Limited DB Caching=False;Jet OLEDB:Bypass ChoiceField Validation=False\n</code></pre>\n\n<p>Since the connection string is same for both cases how does Jet Engine determine which one is local table and which one is linked?</p>\n"}, {"tags": ["vba", "ms-access", "syntax-error"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1545190360, "post_id": 53842147, "comment_id": 94536231, "body": "Beside the special character <code>?</code> in column name, how does that query even run with unquoted or non-concatenated names in <code>VALUES</code>?: <i>Id_Cliente</i>, <i>E_Cliente</i>, <i>Sexo</i>, <i>Data_Nascimento</i>. MS Access should be raising errors about these unknown values."}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 1, "last_activity_date": 1545174308, "creation_date": 1545174308, "answer_id": 53842392, "question_id": 53842147, "link": "https://stackoverflow.com/questions/53842147/access-vba-cant-find-the-syntax-error-in-insert-into/53842392#53842392", "title": "Access Vba can&#39;t find the Syntax error in Insert Into", "body": "<p>Field names with spaces and special characters need to be bracketed. <code>Data Nascimento</code> should be changed to <code>[Data Nascimento]</code>.</p>\n\n<blockquote>\n<pre><code>DoCmd.RunSQL \"INSERT INTO Cliente (Id_Cliente, Primeiro_Nome, Ultimo_Nome, NIF, Cliente?, Sexo, Contacto, Endereco, Localidade, [Data Nascimento], Email) VALUES (Id_Cliente,'\" &amp; Primeiro_Nome &amp; \"', '\" &amp; Ultimo_Nome &amp; \"', '\" &amp; NIF &amp; \"', E_Cliente, Sexo, '\" &amp; Contacto &amp; \"', '\" &amp; Endereco &amp; \"', '\" &amp; Localidade &amp; \"', Data_Nascimento, '\" &amp; Email &amp; \"')\"\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 15, "user_id": 10798508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/583edacb5245bad0b96c7cad876a84eb?s=128&d=identicon&r=PG&f=1", "display_name": "ana", "link": "https://stackoverflow.com/users/10798508/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545174308, "creation_date": 1545172667, "question_id": 53842147, "link": "https://stackoverflow.com/questions/53842147/access-vba-cant-find-the-syntax-error-in-insert-into", "title": "Access Vba can&#39;t find the Syntax error in Insert Into", "body": "<p>I'm writing the following VBA code for a button in an Access form. I want the information inserted by the user to add a new record to a specific table, the table Cliente.</p>\n\n<pre><code>Private Sub novo_cliente_Click()\n\nDim Id_Cliente As Integer\nDim Primeiro_Nome As String\nDim Ultimo_Nome As String\nDim NIF As String\nDim E_Cliente As String\nDim Sexo As String\nDim Contacto As String\nDim Endereco As String\nDim Localidade As String\nDim Data_Nascimento As Date\nDim Email As String\n\nId_Cliente = Me.Id_Cliente.Value\n\nPrimeiro_Nome = Nz(Me.Primeiro_Nome.Value, Empty)\nUltimo_Nome = Nz(Me.Ultimo_Nome.Value, Empty)\nNIF = Nz(Me.NIF.Value, Empty)\nE_Cliente = Nz(Me.E_Cliente.Value, Empty)\nSexo = Nz(Me.Sexo.Value, Empty)\nContacto = Nz(Me.Contacto.Value, Empty)\nEndereco = Nz(Me.Endereco.Value, Empty)\nLocalidade = Nz(Me.Localidade.Value, Empty)\nData_Nascimento = Nz(Me.Data_Nascimento.Value, Empty)\nEmail = Nz(Me.Email.Value, Empty)\n\n'If IdCliente, NIF e e_Cliente empty\n\nIf IsNull(Me.Id_Cliente.Value) = True Or IsNull(Me.NIF.Value) = True Or IsNull(Me.E_Cliente.Value) = True Then\n    MsgBox \"Please insert data in the required fields\", vbExclamation, \"Warning\"\nElse\n    DoCmd.RunSQL \"INSERT INTO Cliente (Id_Cliente, Primeiro_Nome, Ultimo_Nome, NIF, Cliente?, Sexo, Contacto, Endereco, Localidade, Data Nascimento, Email) VALUES (Id_Cliente,'\" &amp; Primeiro_Nome &amp; \"', '\" &amp; Ultimo_Nome &amp; \"', '\" &amp; NIF &amp; \"', E_Cliente, Sexo, '\" &amp; Contacto &amp; \"', '\" &amp; Endereco &amp; \"', '\" &amp; Localidade &amp; \"', Data_Nascimento, '\" &amp; Email &amp; \"')\"\n\n    Me.Id_Cliente.Value = Empty\n    Me.Primeiro_Nome.Value = Empty\n    Me.Ultimo_Nome.Value = Empty\n    Me.NIF.Value = Empty\n    Me.E_Cliente.Value = Empty\n    Me.Sexo.Value = Empty\n    Me.Contacto.Value = Empty\n    Me.Endereco.Value = Empty\n    Me.Localidade.Value = Empty\n    Me.Data_Nascimento.Value = Empty\n    Me.Email.Value = Empty\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Right now, I'm getting a syntax error in INSERT INTO statement, but I cannot find the error. Is it in \"Cliente?\" ? Thank you.</p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1545171308, "post_id": 53841528, "comment_id": 94531980, "body": "<a href=\"http://www.oaltd.co.uk/excel/\" rel=\"nofollow noreferrer\">Stephen Bullen&#39;s Excel Page</a> PastePicture function creates an image file from the clipboard without using the charts."}], "answers": [{"tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": true, "score": 3, "last_activity_date": 1545196508, "creation_date": 1545196508, "answer_id": 53844969, "question_id": 53841528, "link": "https://stackoverflow.com/questions/53841528/paste-method-of-chart-object-not-working-as-expected-in-excel-2016/53844969#53844969", "title": "Paste method of Chart object not working as expected in Excel 2016", "body": "<p>Ran into similar problems after updating my Excel version. This is how I solved it:</p>\n\n<pre><code>Dim pChart As Chart    'will serve as a temporary container for your pic\n\nrng.CopyPicture xlScreen, xlPicture    'using the rng you use in your code here\nSet pChrt = Charts.Add\nActiveChart.ChartArea.Clear\nWith pChrt\n    .ChartArea.Parent.Select    'new for Excel 2016\n    .Paste\n    .Export Filename:=TempPicFile, Filtername:=\"PNG\"    'TempPicFile is what you defined in your code, so path + file name\n    .Delete\nEnd With\n</code></pre>\n\n<p>You can then use the PNG and paste it as you do, asigning a width/height to it.\nAdditionally, I would set <code>Application.DisplayAlerts = False</code>at the beginning of a sub and set it back to <code>True</code>just at the end - quicker and less hassle.</p>\n"}, {"comments": [{"owner": {"reputation": 1397, "user_id": 1667991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be327998cef772b9cab4e6c586b192f1?s=128&d=identicon&r=PG", "display_name": "wolmi", "link": "https://stackoverflow.com/users/1667991/wolmi"}, "edited": false, "score": 1, "creation_date": 1564671284, "post_id": 57311553, "comment_id": 101115818, "body": "Please try to edit your answer and be more clear on what you are explaining using examples and sharing links to the documentation if proceeds."}], "tags": [], "owner": {"reputation": 11, "user_id": 11869871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc6f1e3755f71b327857286ac8d2a5d?s=128&d=identicon&r=PG", "display_name": "Mario", "link": "https://stackoverflow.com/users/11869871/mario"}, "is_accepted": false, "score": 0, "last_activity_date": 1564670532, "creation_date": 1564670532, "answer_id": 57311553, "question_id": 53841528, "link": "https://stackoverflow.com/questions/53841528/paste-method-of-chart-object-not-working-as-expected-in-excel-2016/57311553#57311553", "title": "Paste method of Chart object not working as expected in Excel 2016", "body": "<p>Also works with:</p>\n\n<p>Dim Ch As ChartObject</p>\n\n<p>'adding </p>\n\n<p>Ch.Chart.Parent.Select</p>\n\n<p>'then </p>\n\n<p>Ch.Chart.Paste</p>\n\n<p>'because Microsoft....</p>\n"}], "owner": {"reputation": 37, "user_id": 8599843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1de3fe1790d8576483922c1605d49d5?s=128&d=identicon&r=PG&f=1", "display_name": "Loveburner", "link": "https://stackoverflow.com/users/8599843/loveburner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 53844969, "answer_count": 2, "score": 1, "last_activity_date": 1564670532, "creation_date": 1545169392, "last_edit_date": 1545234993, "question_id": 53841528, "link": "https://stackoverflow.com/questions/53841528/paste-method-of-chart-object-not-working-as-expected-in-excel-2016", "title": "Paste method of Chart object not working as expected in Excel 2016", "body": "<p>I have a code, recently updated to Excel 2016 that has shown some strange malfunctions. After quite a lot of debugging, I found that one of the errors were caused by Excel failing to handle a image correctly.</p>\n\n<p>The code below has a simple purpose, to copy a used part of a worksheet to an image, and then insert that image as a comment in a worksheet.</p>\n\n<p>However, in order for the function to work properly in Excel 2016, I need to repeat the paste operation several times as you can see in the code.</p>\n\n<p>The workaround is functional, but I believe that some degree of understanding of why is needed, and I would also prefer a more clean solution.</p>\n\n<pre><code>Public Sub CopySheetToComment(ReferenceSheet As Worksheet, Target As Range)\n\nDim rng As Range\nDim Sh As Shape\n\nDim pWidth As Single\nDim PHeight As Single\nDim cmt As Comment\n\nDim TempPicFile As String\nApplication.ScreenUpdating = True\n\n' Path temporary file\nTempPicFile = Environ(\"temp\") &amp; \"\\img.png\"\n\n' Define and copy relevant area\nSet rng = ReferenceSheet.UsedRange\nrng.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\npWidth = rng.Width\nPHeight = rng.Height\n\n' Paste copied image to chart and then export to file\nDim C As Object\nSet C = ReferenceSheet.Parent.Charts.add\nDim Ch As ChartObject\nSet Ch = C.ChartObjects.add(Left:=rng.Left, Top:=rng.Top, Width:=rng.Width, Height:=rng.Height)\n\n' Ugly solution that is working in Excel 2016....\nCh.Chart.Paste\nDoEvents\nCh.Chart.Paste\nDoEvents\nCh.Chart.Paste\nCh.Chart.Export TempPicFile\n\n\n' Remove chart object\nDim Alerts As Boolean\nAlerts = Application.DisplayAlerts\nApplication.DisplayAlerts = False\nC.Delete\nApplication.DisplayAlerts = Alerts\n\n' Remove old comment\nOn Error Resume Next\nTarget.Comment.Delete\nOn Error GoTo 0\n\nApplication.ScreenUpdating = True\n' Add comment\nSet cmt = Target.AddComment\nTarget.Comment.Visible = True\n\n' Infoga bild till kommentar\nWith cmt.Shape\n    .Fill.UserPicture TempPicFile\n    .Width = pWidth * 1.33333\n    .Height = PHeight * 1.33333\nEnd With\n'Target.Comment.visible = False\n\nEnd Sub\n</code></pre>\n\n<p>And to call it, this example works:</p>\n\n<pre><code>Sub test()\n\nDim ws As Worksheet\nSet ws = ActiveWorkbook.Worksheets(\"blad2\")\nCopySheetToComment ws, Range(\"D8\")\n\nEnd Sub\n</code></pre>\n\n<p>Theories on why this works but not DoEvents, or suggestions for proper code is requested.</p>\n"}, {"tags": ["excel", "vba", "compare"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1545166123, "post_id": 53840736, "comment_id": 94530045, "body": "Are you only comparing <code>Range(&quot;A5:A10&quot;)</code> for all 80 worksheets?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1545166543, "post_id": 53840736, "comment_id": 94530212, "body": "You want to <a href=\"https://stackoverflow.com/questions/20422356/loop-through-excel-sheets\">loop through the worksheets</a> of one workbook and compare each one with its counterpart in the other workbook"}, {"owner": {"reputation": 13, "user_id": 7426919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f68cf09b01dd549cc6e20527a72eb93?s=128&d=identicon&r=PG&f=1", "display_name": "sm1", "link": "https://stackoverflow.com/users/7426919/sm1"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1545167391, "post_id": 53840736, "comment_id": 94530476, "body": "@TinMan Yes, same range for every sheet in both workbooks"}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 1, "last_activity_date": 1545167718, "creation_date": 1545167718, "answer_id": 53841175, "question_id": 53840736, "link": "https://stackoverflow.com/questions/53840736/comparing-two-workbooks-with-80-sheets-each/53841175#53841175", "title": "Comparing two workbooks with 80 sheets each", "body": "<p>You need to iterate through the Worksheets of one of the workbooks and use the worksheet names to set worksheet variable for the second workbook.</p>\n\n<pre><code>Sub CompareWorksheets()\n\n    Dim wbPROD As Workbook, wbUAT As Workbook, wbSummary As Workbook\n    Dim wsPROD As Worksheet, wsUAT As Worksheet, wsSummary As Worksheet\n    Dim arrPROD As Variant, arrUAT As Variant\n    Dim strRangeToCheck As String\n    Dim iRow As Long, iCol As Long\n\n    Set wbSummary = ThisWorkbook                      'this is where results of comparison will be documented\n    Set wsSummary = wbkc.Sheets(\"Summary\")\n    Set wbPROD = Workbooks.Open(Filename:=\"C:\\Users\\Desktop\\dashboard1.xlsx\")    'PROD\n    Set wbUAT = Workbooks.Open(Filename:=\"C:\\Users\\Desktop\\dashboard2.xlsx\")    'UAT\n\n    strRangeToCheck = (\"A5:A10\")\n\n    erow = 6                                          'starting row to document summary results\n\n    For Each wsPROD In wbPROD.Worksheets\n        Set wsUAT = wbUAT.Worksheets(wsPROD.Name)\n        arrPROD = wsPROD.Range(strRangeToCheck).Value\n        arrUAT = wsUAT.Range(strRangeToCheck).Value\n\n        For iRow = LBound(arrPROD, 1) To UBound(arrPROD, 1)\n            For iCol = LBound(arrPROD, 2) To UBound(arrPROD, 2)\n\n                If arrPROD(iRow, iCol) = arrUAT(iRow, iCol) Then\n                    wsPROD.Cells(iRow, iCol).Interior.ColorIndex = xlNone\n                    wsUAT.Cells(iRow, iCol).Interior.ColorIndex = xlNone\n                Else\n                    wsPROD.Cells(iRow, iCol).Interior.ColorIndex = 22\n                    wsUAT.Cells(iRow, iCol).Interior.ColorIndex = 22\n\n                    wbkc.Activate\n                    erow = erow + 1\n                    With wsSummary\n                        .Cells(erow, 2) = iRow\n                        .Cells(erow, 3) = iCol\n                        .Cells(erow, 4) = wsPROD.Cells(iRow, iCol)\n                        .Cells(erow, 5) = wsUAT.Cells(iRow, iCol)\n                    End With\n                End If\n            Next\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1545168616, "creation_date": 1545168616, "answer_id": 53841375, "question_id": 53840736, "link": "https://stackoverflow.com/questions/53840736/comparing-two-workbooks-with-80-sheets-each/53841375#53841375", "title": "Comparing two workbooks with 80 sheets each", "body": "<pre><code>Start with\n  Option Explicit  ' to force you to declare for each variable\n\nAdd code to delete prior errors\n  Dim wbkc As Workbook, LastRow as Long, nRow as Long\n  wbkc.Sheets(\"Summary\").UsedRange 'Refresh UsedRange\n  LastRow = wbkc.Sheets(\"Summary\").UsedRange.Rows(wbkc.Sheets(\"Summary\").UsedRange.Rows.Count).Row\n  For nRow = LastRow to eRow + 1 step -1\n    wbkc.Sheets(\"Summary\").Rows(nRow).Delete\n  Next nRow\n\nBasically, google \"excel vba for each sheet\" and look at the first one \n  https://stackoverflow.com/questions/21918166/excel-vba-for-each-worksheet-loop\nto get the driving code (ignoring resizingColumns) and create CompareCells. \n\n  Sub forEachWs()\n    Dim ws As Worksheet\n    For Each ws In ActiveWorkbook.Worksheets\n        Call CompareCells(ws)\n    Next\n  End Sub\n  Sub CompareCells(ws as Worksheet)\n  End Sub\n\nFinally, Add your code inside of CompareCells\nGiving  (PLEASE test this code, since we do not have wbka or wbkb excel files)\n\n\nOption Explicit  ' to force you to declare for each variable\n\n' define output -- this is where results of comparison will be documented\nDim wbkc As Workbook, eRow as long, LastRow as Long, nRow as Long\nSet wbkc = ThisWorkbook  \neRow = 6 'starting row to document summary results\nwbkc.Sheets(\"Summary\").UsedRange 'Refresh UsedRange\nLastRow = wbkc.Sheets(\"Summary\").UsedRange.Rows(wbkc.Sheets(\"Summary\").UsedRange.Rows.Count).Row\nFor nRow = LastRow to eRow + 1 step -1\n    wbkc.Sheets(\"Summary\").Rows(nRow).Delete  ' delete prior errors\nNext nRow\n\n\n' define inputs -- \nDim wbka As Workbook, wbkb As Workbook\nSet wbka = Workbooks.Open(Filename:=\"C:\\Users\\Desktop\\dashboard1.xlsx\")  'PROD\nSet wbkb = Workbooks.Open(Filename:=\"C:\\Users\\Desktop\\dashboard2.xlsx\") 'UAT\n\n' step thru each sheet\nDim ws As Worksheet\nFor Each ws In wbka.Worksheets\n    '\n    Dim varSheetA As Worksheet, varSheetB As Worksheet\n    Dim varSheetAr As Variant, varSheetBr As Variant\n    Dim strRangeToCheck As String\n\n    Set varSheetA = wbka.Worksheets(ws.Name)\n    Set varSheetB = wbkb.Worksheets(ws.Name)\n    strRangeToCheck = (\"A5:A10\")\n\n    varSheetAr = varSheetA.Range(strRangeToCheck).Value\n    varSheetBr = varSheetB.Range(strRangeToCheck).Value\n\n    ' step thru each cell\n    Dim iRow As Long, iCol As Long\n    For iRow = LBound(varSheetAr, 1) To UBound(varSheetAr, 1)\n    For iCol = LBound(varSheetAr, 2) To UBound(varSheetAr, 2)\n\n            If varSheetAr(iRow, iCol) = varSheetBr(iRow, iCol) Then\n              varSheetA.Cells(iRow, iCol).Interior.ColorIndex = xlNone\n              varSheetB.Cells(iRow, iCol).Interior.ColorIndex = xlNone\n            Else\n              varSheetA.Cells(iRow, iCol).Interior.ColorIndex = 22\n              varSheetB.Cells(iRow, iCol).Interior.ColorIndex = 22\n\n                wbkc.Activate\n                    erow = erow + 1\n\n                        wbkc.Sheets(\"Summary\").Cells(erow, 1) = ws.Name  'ADDed\n                        wbkc.Sheets(\"Summary\").Cells(erow, 2) = iRow\n                        wbkc.Sheets(\"Summary\").Cells(erow, 3) = iCol\n                        wbkc.Sheets(\"Summary\").Cells(erow, 4) = varSheetA.Cells(iRow, iCol)\n                        wbkc.Sheets(\"Summary\").Cells(erow, 5) = varSheetB.Cells(iRow, iCol)\n\n            End If\n        Next iCol\n    Next iRow\n\n\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7426919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f68cf09b01dd549cc6e20527a72eb93?s=128&d=identicon&r=PG&f=1", "display_name": "sm1", "link": "https://stackoverflow.com/users/7426919/sm1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 53841175, "answer_count": 2, "score": 1, "last_activity_date": 1545168616, "creation_date": 1545165682, "question_id": 53840736, "link": "https://stackoverflow.com/questions/53840736/comparing-two-workbooks-with-80-sheets-each", "title": "Comparing two workbooks with 80 sheets each", "body": "<p>I am trying to write a script that will compare two workbooks that each have 80 sheets. The sheet names will match in both workbooks (one workbook is a prod copy, one is a copy from a UAT environment. All data should be same). I was able to run a script that will compare the sheet I specify, but I'm having difficulty trying to figure out how to write it to compare each sheet.</p>\n\n<pre><code>Sub CompareWorksheets()\n\nDim varSheetA As Worksheet\nDim varSheetB As Worksheet\nDim varSheetAr As Variant\nDim varSheetBr As Variant\nDim strRangeToCheck As String\nDim iRow As Long\nDim iCol As Long\nDim wbkc As Workbook\n\n\nSet wbkc = ThisWorkbook  'this is where results of comparison will be documented\nSet wbka = Workbooks.Open(Filename:=\"C:\\Users\\Desktop\\dashboard1.xlsx\")  'PROD\nSet wbkb = Workbooks.Open(Filename:=\"C:\\Users\\Desktop\\dashboard2.xlsx\") 'UAT\n\n            Set varSheetA = wbka.Worksheets(\"Members\")\n            Set varSheetB = wbkb.Worksheets(\"Members\")\n            strRangeToCheck = (\"A5:A10\")\n\n            varSheetAr = varSheetA.Range(strRangeToCheck).Value\n            varSheetBr = varSheetB.Range(strRangeToCheck).Value\n\n   erow = 6 'starting row to document summary results\n\n    For iRow = LBound(varSheetAr, 1) To UBound(varSheetAr, 1)\n    For iCol = LBound(varSheetAr, 2) To UBound(varSheetAr, 2)\n\n            If varSheetAr(iRow, iCol) = varSheetBr(iRow, iCol) Then\n              varSheetA.Cells(iRow, iCol).Interior.ColorIndex = xlNone\n              varSheetB.Cells(iRow, iCol).Interior.ColorIndex = xlNone\n            Else\n              varSheetA.Cells(iRow, iCol).Interior.ColorIndex = 22\n              varSheetB.Cells(iRow, iCol).Interior.ColorIndex = 22\n\n                wbkc.Activate\n                    erow = erow + 1\n                        wbkc.Sheets(\"Summary\").Cells(erow, 2) = iRow\n                        wbkc.Sheets(\"Summary\").Cells(erow, 3) = iCol\n                        wbkc.Sheets(\"Summary\").Cells(erow, 4) = varSheetA.Cells(iRow, iCol)\n                        wbkc.Sheets(\"Summary\").Cells(erow, 5) = varSheetB.Cells(iRow, iCol)\n\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "do-while"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1545175097, "post_id": 53840345, "comment_id": 94533119, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/185451/discussion-on-question-by-seth-excel-vba-code-stopping-while-looping-through-fil\">moved to chat</a>."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1545175650, "post_id": 53840345, "comment_id": 94533261, "body": "Your using a password breaking code. One would assume it is just for using on it&#39;s own. Besides, the code was created 15 yrs ago, I&#39;m sure things have changed since then."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7775322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07da68c816c5ef0f3e024861484aa32c?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7775322/seth"}, "edited": false, "score": 0, "creation_date": 1545164748, "post_id": 53840497, "comment_id": 94529408, "body": "I have commented out the line &quot;On Error Resume Next&quot; and am still not getting an error message. When I call the Sub AllInternalPasswords it still runs. But for some reason when I run the wb.close line it just stops my code"}, {"owner": {"reputation": 69, "user_id": 7775322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07da68c816c5ef0f3e024861484aa32c?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7775322/seth"}, "edited": false, "score": 0, "creation_date": 1545164917, "post_id": 53840497, "comment_id": 94529491, "body": "I get the same result when using wb.save before wb.close. Code stops running as soon as I execute wb.save"}], "tags": [], "owner": {"reputation": 55, "user_id": 10786621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f803df3f3fb80ffbbc53719a9db8d36f?s=128&d=identicon&r=PG&f=1", "display_name": "JCalvano", "link": "https://stackoverflow.com/users/10786621/jcalvano"}, "is_accepted": false, "score": 0, "last_activity_date": 1545164600, "creation_date": 1545164600, "answer_id": 53840497, "question_id": 53840345, "link": "https://stackoverflow.com/questions/53840345/code-stopping-while-looping-through-files-on-workbook-close/53840497#53840497", "title": "Code Stopping While Looping through files on workbook.close", "body": "<p><strong>For Error Checking:</strong> <br></p>\n\n<p>Try Saving the Workbook before Saving</p>\n\n<pre><code>Application.DisplayAlerts  = False\n     wb.Save\n     wb.Close True\nApplication.DisplayAlerts  = True\n</code></pre>\n\n<hr>\n\n<p><strong>For Error Checking:</strong> <br> <br>\nTry setting your Error Trapping to \"Break on All Errors\". (In the VBA Editor: Tools > Options> General > Break on All Errors) <br></p>\n\n<p>Your \"On Error Resume Next\" is hiding the error</p>\n"}], "owner": {"reputation": 69, "user_id": 7775322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07da68c816c5ef0f3e024861484aa32c?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7775322/seth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1545293857, "creation_date": 1545163851, "last_edit_date": 1545293857, "question_id": 53840345, "link": "https://stackoverflow.com/questions/53840345/code-stopping-while-looping-through-files-on-workbook-close", "title": "Code Stopping While Looping through files on workbook.close", "body": "<p>I am trying to loop through Excel files, open them, run some code that breaks passwords then closes the workbook and moves to the next.</p>\n\n<p>My code works on most of my files. I am having trouble with files that have macros in them. (That is the only thing I can see that differentiates these files from the others.)</p>\n\n<p>I have noticed that with the problem files when I open them my wb variable is set to nothing. It still opens the file and my code continues to run but when I execute the line wb.close my code just stops. No error message but it doesn't finish the loop it is in.</p>\n\n<p>Not sure if there is a way to attach a file that works and one that doesn't but I can if someone can explain how to do this.</p>\n\n<p>When I open a file that doesn't cause this problem, in the locals window when I expand the variable wb, it has other attributes. On the problem files when I expand the wb variable it just says: no variables</p>\n\n<p>When I open one of these files without using VBA I get a warning that it contains a possible security concern and that macros have been disabled. I think that is where my problem is coming from however I thought I as handling this with <code>Application.AutomationSecurity = msoAutomationSecurityForceDisable</code>.</p>\n\n<p>I have updated my code to the following but it has not solved the problem of stopping the code on wb.close</p>\n\n<pre><code>Do While fileName &lt;&gt; vbNullString\n\n    Set wb = Workbooks.Open(fileName:=directory &amp; fileName, _\n                            UpdateLinks:=0, _\n                            IgnoreReadOnlyRecommended:=True, _\n                            Notify:=False, _\n                            CorruptLoad:=xlNormalLoad)\n    If Err.Number = 0 And Not wb Is Nothing Then\n        On Error GoTo 0\n        Call AllInternalPasswords\n        wb.Close True\n        fileName = Dir()\n    Else\n        Err.Clear\n        On Error GoTo 0\n    End If\nLoop\n</code></pre>\n\n<hr>\n\n<pre><code>Sub TestPasswordLoop()\n\nDim directory As String, fileName As String, i As Variant, wb As Workbook\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nDim security As MsoAutomationSecurity\nsecurity = Application.AutomationSecurity\nApplication.AutomationSecurity = msoAutomationSecurityForceDisable\n\ndirectory = \"C:\\Users\\seth\\Desktop\\Files for Testing\\\"\nfileName = Dir(directory &amp; \"*.xl??\")\n\ni = 0\nDo While fileName &lt;&gt; vbNullString\n    On Error Resume Next\n    'Set wb = Workbooks.Open(fileName:=directory &amp; fileName)\n    Set wb = Workbooks.Open(fileName:=directory &amp; fileName, _\n                            UpdateLinks:=0, _\n                            IgnoreReadOnlyRecommended:=True, _\n                            Notify:=False, _\n                            CorruptLoad:=xlNormalLoad)\n\n    Call AllInternalPasswords 'this code is below\n    wb.Close True\n    i = i + 1\n    Application.StatusBar = \"Files Completed:  \" &amp; i\n    fileName = Dir()\nLoop\n\nApplication.AutomationSecurity = security\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nMsgBox \"Complete\"\n\nEnd Sub\n\nPublic Sub AllInternalPasswords()\n    ' Breaks worksheet and workbook structure passwords. Bob McCormick\n    '  probably originator of base code algorithm modified for coverage\n    '  of workbook structure / windows passwords and for multiple passwords\n    '\n    ' Norman Harker and JE McGimpsey 27-Dec-2002 (Version 1.1)\n    ' Modified 2003-Apr-04 by JEM: All msgs to constants, and\n    '   eliminate one Exit Sub (Version 1.1.1)\n    ' Reveals hashed passwords NOT original passwords\n\n    Application.DisplayAlerts = False\n    'Application.ScreenUpdating = False\n\n    Const DBLSPACE As String = vbNewLine &amp; vbNewLine\n    Const AUTHORS As String = DBLSPACE &amp; vbNewLine &amp; _\n            \"Adapted from Bob McCormick base code by\" &amp; _\n            \"Norman Harker and JE McGimpsey\"\n    Const HEADER As String = \"AllInternalPasswords User Message\"\n    Const VERSION As String = DBLSPACE &amp; \"Version 1.1.1 2003-Apr-04\"\n    Const REPBACK As String = DBLSPACE &amp; \"Please report failure \" &amp; _\n            \"to the microsoft.public.excel.programming newsgroup.\"\n    Const ALLCLEAR As String = DBLSPACE &amp; \"The workbook should \" &amp; _\n            \"now be free of all password protection, so make sure you:\" &amp; _\n            DBLSPACE &amp; \"SAVE IT NOW!\" &amp; DBLSPACE &amp; \"and also\" &amp; _\n            DBLSPACE &amp; \"BACKUP!, BACKUP!!, BACKUP!!!\" &amp; _\n            DBLSPACE &amp; \"Also, remember that the password was \" &amp; _\n            \"put there for a reason. Don't stuff up crucial formulas \" &amp; _\n            \"or data.\" &amp; DBLSPACE &amp; \"Access and use of some data \" &amp; _\n            \"may be an offense. If in doubt, don't.\"\n    Const MSGNOPWORDS1 As String = \"There were no passwords on \" &amp; _\n            \"sheets, or workbook structure or windows.\" &amp; AUTHORS &amp; VERSION\n    Const MSGNOPWORDS2 As String = \"There was no protection to \" &amp; _\n            \"workbook structure or windows.\" &amp; DBLSPACE &amp; _\n            \"Proceeding to unprotect sheets.\" &amp; AUTHORS &amp; VERSION\n    Const MSGTAKETIME As String = \"After pressing OK button this \" &amp; _\n            \"will take some time.\" &amp; DBLSPACE &amp; \"Amount of time \" &amp; _\n            \"depends on how many different passwords, the \" &amp; _\n            \"passwords, and your computer's specification.\" &amp; DBLSPACE &amp; _\n            \"Just be patient! Make me a coffee!\" &amp; AUTHORS &amp; VERSION\n    Const MSGPWORDFOUND1 As String = \"You had a Worksheet \" &amp; _\n            \"Structure or Windows Password set.\" &amp; DBLSPACE &amp; _\n            \"The password found was: \" &amp; DBLSPACE &amp; \"$$\" &amp; DBLSPACE &amp; _\n            \"Note it down for potential future use in other workbooks by \" &amp; _\n            \"the same person who set this password.\" &amp; DBLSPACE &amp; _\n            \"Now to check and clear other passwords.\" &amp; AUTHORS &amp; VERSION\n    Const MSGPWORDFOUND2 As String = \"You had a Worksheet \" &amp; _\n            \"password set.\" &amp; DBLSPACE &amp; \"The password found was: \" &amp; _\n            DBLSPACE &amp; \"$$\" &amp; DBLSPACE &amp; \"Note it down for potential \" &amp; _\n            \"future use in other workbooks by same person who \" &amp; _\n            \"set this password.\" &amp; DBLSPACE &amp; \"Now to check and clear \" &amp; _\n            \"other passwords.\" &amp; AUTHORS &amp; VERSION\n    Const MSGONLYONE As String = \"Only structure / windows \" &amp; _\n             \"protected with the password that was just found.\" &amp; _\n             ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK\n    Dim w1 As Worksheet, w2 As Worksheet\n    Dim i As Integer, j As Integer, k As Integer, l As Integer\n    Dim m As Integer, n As Integer, i1 As Integer, i2 As Integer\n    Dim i3 As Integer, i4 As Integer, i5 As Integer, i6 As Integer\n    Dim PWord1 As String\n    Dim ShTag As Boolean, WinTag As Boolean\n\n    Application.ScreenUpdating = False\n    With ActiveWorkbook\n        WinTag = .ProtectStructure Or .ProtectWindows\n    End With\n    ShTag = False\n    For Each w1 In Worksheets\n            ShTag = ShTag Or w1.ProtectContents\n    Next w1\n    If Not ShTag And Not WinTag Then\n        'MsgBox MSGNOPWORDS1, vbInformation, HEADER\n        Exit Sub\n    End If\n    'MsgBox MSGTAKETIME, vbInformation, HEADER\n    If Not WinTag Then\n        'MsgBox MSGNOPWORDS2, vbInformation, HEADER\n    Else\n      On Error Resume Next\n      Do      'dummy do loop\n        For i = 65 To 66: For j = 65 To 66: For k = 65 To 66\n        For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66\n        For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66\n        For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126\n        With ActiveWorkbook\n          .Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _\n             Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; _\n             Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)\n          If .ProtectStructure = False And _\n          .ProtectWindows = False Then\n              PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _\n                Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _\n                Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)\n              'MsgBox Application.Substitute(MSGPWORDFOUND1, _\n                    \"$$\", PWord1), vbInformation, HEADER\n              Exit Do  'Bypass all for...nexts\n          End If\n        End With\n        Next: Next: Next: Next: Next: Next\n        Next: Next: Next: Next: Next: Next\n      Loop Until True\n      On Error GoTo 0\n    End If\n    If WinTag And Not ShTag Then\n      'MsgBox MSGONLYONE, vbInformation, HEADER\n      Exit Sub\n    End If\n    On Error Resume Next\n    For Each w1 In Worksheets\n      'Attempt clearance with PWord1\n      w1.Unprotect PWord1\n    Next w1\n    On Error GoTo 0\n    ShTag = False\n    For Each w1 In Worksheets\n      'Checks for all clear ShTag triggered to 1 if not.\n      ShTag = ShTag Or w1.ProtectContents\n    Next w1\n    If ShTag Then\n        For Each w1 In Worksheets\n          With w1\n            If .ProtectContents Then\n              On Error Resume Next\n              Do      'Dummy do loop\n                For i = 65 To 66: For j = 65 To 66: For k = 65 To 66\n                For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66\n                For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66\n                For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126\n                .Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _\n                  Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _\n                  Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)\n                If Not .ProtectContents Then\n                  PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _\n                    Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _\n                    Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)\n                  'MsgBox Application.Substitute(MSGPWORDFOUND2, _\n                        \"$$\", PWord1), vbInformation, HEADER\n                  'leverage finding Pword by trying on other sheets\n                  For Each w2 In Worksheets\n                    w2.Unprotect PWord1\n                  Next w2\n                  Exit Do  'Bypass all for...nexts\n                End If\n                Next: Next: Next: Next: Next: Next\n                Next: Next: Next: Next: Next: Next\n              Loop Until True\n              On Error GoTo 0\n            End If\n          End With\n        Next w1\n    End If\n    'MsgBox ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK, vbInformation, HEADER\n\n    'Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10768418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b4916370cc639cd12cc2e198f8f038?s=128&d=identicon&r=PG&f=1", "display_name": "kcoenen9", "link": "https://stackoverflow.com/users/10768418/kcoenen9"}, "edited": false, "score": 0, "creation_date": 1545169901, "post_id": 53841058, "comment_id": 94531415, "body": "Ahh, I see. This solved it, thank you. However I now ran into another problem. It narrates the next slide&#39;s notes before actually changing to that slide, should I use the SlideShowNextSlide event instead? PS, I did give this an upvote but my reputation is too low to show it."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 15, "user_id": 10768418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b4916370cc639cd12cc2e198f8f038?s=128&d=identicon&r=PG&f=1", "display_name": "kcoenen9", "link": "https://stackoverflow.com/users/10768418/kcoenen9"}, "edited": false, "score": 0, "creation_date": 1545178595, "post_id": 53841058, "comment_id": 94533962, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.application.slideshownextslide\" rel=\"nofollow noreferrer\">SlideShowNextSlide</a> would have the same behavior. From the documentation: &quot;occurs immediately before the transition to the next slide.&quot;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 15, "user_id": 10768418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b4916370cc639cd12cc2e198f8f038?s=128&d=identicon&r=PG&f=1", "display_name": "kcoenen9", "link": "https://stackoverflow.com/users/10768418/kcoenen9"}, "edited": false, "score": 0, "creation_date": 1545180112, "post_id": 53841058, "comment_id": 94534264, "body": "It&#39;s not much of a workaround, but you could change this to a regular subroutine and assign it to an action button on the slide itself."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1545178267, "last_edit_date": 1545178267, "creation_date": 1545167170, "answer_id": 53841058, "question_id": 53840063, "link": "https://stackoverflow.com/questions/53840063/onslideshowpagechange-not-running-in-presentation/53841058#53841058", "title": "OnSlideShowPageChange not running in presentation", "body": "<p>To get the current slide index, you can use the following:</p>\n\n<ol>\n<li>In <em>Slide View</em> mode: <code>ActiveWindow.View.Slide.SlideIndex</code></li>\n<li>In <em>Slide Show</em> mode: <code>ActivePresentation.SlideShowWindow.View.Slide.SlideIndex</code></li>\n</ol>\n\n<p>For this to work in presentation mode, change</p>\n\n<pre><code>intSlide = ActiveWindow.Selection.SlideRange.SlideIndex\n</code></pre>\n\n<p>to </p>\n\n<pre><code>intSlide = ActivePresentation.SlideShowWindow.View.Slide.SlideIndex\n</code></pre>\n\n<p><em>Note that this throws an error if not in presentation mode.</em> </p>\n\n<p><strong>EDIT</strong>: In simplified form, you could also do this:</p>\n\n<pre><code>Sub OnSlideShowPageChange(ByVal Wn As SlideShowWindow)\n\n    SpeakThis Wn.View.Slide.NotesPage.Shapes.Placeholders(2).TextFrame.TextRange.text\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 10768418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b4916370cc639cd12cc2e198f8f038?s=128&d=identicon&r=PG&f=1", "display_name": "kcoenen9", "link": "https://stackoverflow.com/users/10768418/kcoenen9"}, "edited": false, "score": 0, "creation_date": 1546271555, "post_id": 53870090, "comment_id": 94815911, "body": "This worked nicely. Thank you. I upvoted, but again, my rep is too low to show this. However, I didn&#39;t mark this as the answer since the original question was answered above, and this answers a secondary question."}], "tags": [], "owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "is_accepted": false, "score": 0, "last_activity_date": 1545314889, "last_edit_date": 1545314889, "creation_date": 1545314158, "answer_id": 53870090, "question_id": 53840063, "link": "https://stackoverflow.com/questions/53840063/onslideshowpagechange-not-running-in-presentation/53870090#53870090", "title": "OnSlideShowPageChange not running in presentation", "body": "<p>Here I introduce MY work-around which can meet what you want.</p>\n\n<p>Actually, you can <strong>save</strong> above TTS sound into an .wav file \nwhich can be inserted and played on entering each slide.\nSince you want to play some narration sound on each slide,\nI suggest you to convert all the notes into .wav files and insert them as normal audio effects.</p>\n\n<p>To automate the process, I wrote some code.</p>\n\n<p><strong>First, to save each note in an .wav file</strong> (given the slide index)</p>\n\n<pre><code>'save the slide's note in a .wav file\n'You need to add reference to 'Microsoft Speech Object Library' (*required*)\nFunction SaveTTSWav(idx As Long)\n    Const SAFT48kHz16BitStereo = 39\n    Const SSFMCreateForWrite = 3\n    Dim oSpeaker As New SpeechLib.SpVoice\n    Dim oStream As New SpeechLib.SpFileStream\n\n    oStream.Format.Type = SAFT48kHz16BitStereo\n    'filename to save: ex) note1.wav\n    oStream.Open ActivePresentation.Path &amp; \"\\note\" &amp; idx &amp; \".wav\", SSFMCreateForWrite, False\n    oSpeaker.Volume = 100   '%\n    oSpeaker.Rate = 1       '1x speed\n    oSpeaker.SynchronousSpeakTimeout = 1\n    oSpeaker.AlertBoundary = SVEWordBoundary\n    Set oSpeaker.AudioOutputStream = oStream\n\n    oSpeaker.Speak ActivePresentation.Slides(idx).NotesPage.Shapes.Placeholders(2).TextFrame.TextRange.text, SVSFNLPSpeakPunc\n    oStream.Close\nEnd Function\n</code></pre>\n\n<p><strong>Then, Insert the 'note(X).wav' files in each slide and add animation effects to them</strong>:</p>\n\n<pre><code>'insert the .wav and make it play automatically\nFunction AddTTSMedia(idx As Long)\n    Dim sld As Slide\n    Dim shp As Shape\n    Dim eft As Effect\n\n    Dim wavfile As String\n\n    wavfile = ActivePresentation.Path &amp; \"\\note\" &amp; idx &amp; \".wav\"\n    If Len(Dir(wavfile)) = 0 Then Exit Function\n    Set sld = ActivePresentation.Slides(idx)\n    Set shp = sld.Shapes.AddMediaObject2(wavfile, False, True, 0, 0, 20, 20)\n    'shp.Name = Mid(wavfile, InStrRev(wavfile, \"\\\") + 1) '.wav filename\n    Set eft = sld.TimeLine.MainSequence.AddEffect(shp, msoAnimEffectMediaPlay, , msoAnimTriggerWithPrevious)\n    eft.MoveTo 1    'make it the first effect\n    With eft.EffectInformation.PlaySettings 'shp.AnimationSettings.PlaySettings\n        .HideWhileNotPlaying = True\n        .PauseAnimation = False\n        .PlayOnEntry = True\n        .StopAfterSlides = 1\n    End With\n    'Kill wavfile\nEnd Function\n</code></pre>\n\n<p><strong>Finally, make it happen on every slide:</strong></p>\n\n<pre><code>Sub Add_TTS_Notes()\n    Dim sld As Slide\n\n    'Remove previously inserted note sounds\n    RemoveNoteWav\n\n    For Each sld In ActivePresentation.Slides\n        'save the note to an .wav file\n        SaveTTSWav sld.SlideIndex\n        'add the .wav file onto the slide\n        AddTTSMedia sld.SlideIndex\n    Next sld\n    'ActivePresentation.Save\nEnd Sub\n</code></pre>\n\n<p><strong>In addition</strong>, if you want to cancel and remove all note sounds from your presentation,\nyou can run the following code manually:</p>\n\n<pre><code>'remove all .wav media(s) in each slide\nSub RemoveNoteWav()\n    Dim sld As Slide\n    Dim i As Long\n    For Each sld In ActivePresentation.Slides\n        For i = sld.Shapes.Count To 1 Step -1\n            If sld.Shapes(i).Name Like \"note*.wav\" Then sld.Shapes(i).Delete\n        Next i\n    Next sld\nEnd Sub\n</code></pre>\n\n<p>All you have to do is to copy all codes above onto your PPT's VBE editor and to run the main macro named \"Add_TTS_Notes\". It'll take some time to save some TTS sound files.</p>\n\n<p>It will save the notes on all slides in .wav files, insert them on their slides and make them play automatically on each slide. After the job, you can remove VBA codes and save your ppt file as a .pptx or .ppsx which is more handy than a .pptm file since it doesn't require any security agreement.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8930845, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N4LmkybMMg8/AAAAAAAAAAI/AAAAAAAAA2k/dNsy5jHGs1I/photo.jpg?sz=128", "display_name": "Jay Casee", "link": "https://stackoverflow.com/users/8930845/jay-casee"}, "edited": false, "score": 0, "creation_date": 1583657642, "post_id": 60574332, "comment_id": 107185578, "body": "The each first line is commented (deactivated) by &#39; character from Konanh&#39;s code."}], "tags": [], "owner": {"reputation": 13, "user_id": 8930845, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N4LmkybMMg8/AAAAAAAAAAI/AAAAAAAAA2k/dNsy5jHGs1I/photo.jpg?sz=128", "display_name": "Jay Casee", "link": "https://stackoverflow.com/users/8930845/jay-casee"}, "is_accepted": false, "score": 0, "last_activity_date": 1583657497, "last_edit_date": 1592644375, "creation_date": 1583554675, "answer_id": 60574332, "question_id": 53840063, "link": "https://stackoverflow.com/questions/53840063/onslideshowpagechange-not-running-in-presentation/60574332#60574332", "title": "OnSlideShowPageChange not running in presentation", "body": "<p>I'm using PowerPoint 2016, and in my case, I've needed to modify Konahn's codes as below in SaveTTSWav function.</p>\n<blockquote>\n<p>'Dim oSpeaker As New SpeechLib.SpVoice</p>\n<p>Dim oSpeaker As Object Set</p>\n<p>oSpeaker = CreateObject(&quot;SAPI.Spvoice&quot;)</p>\n</blockquote>\n<p>&amp;</p>\n<blockquote>\n<p>'Dim oStream As New SpeechLib.SpFileStream</p>\n<p>Dim oStream As Object Set</p>\n<p>oStream = CreateObject(&quot;SAPI.SpFileStream&quot;)</p>\n</blockquote>\n"}], "owner": {"reputation": 15, "user_id": 10768418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b4916370cc639cd12cc2e198f8f038?s=128&d=identicon&r=PG&f=1", "display_name": "kcoenen9", "link": "https://stackoverflow.com/users/10768418/kcoenen9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1414, "favorite_count": 0, "accepted_answer_id": 53841058, "answer_count": 3, "score": 1, "last_activity_date": 1583657497, "creation_date": 1545162558, "question_id": 53840063, "link": "https://stackoverflow.com/questions/53840063/onslideshowpagechange-not-running-in-presentation", "title": "OnSlideShowPageChange not running in presentation", "body": "<p>I have been tasked with building an automated powerpoint to show new employees during onboarding. I decided to use the text-to-speech function of PPT to narrate the show. I came to the realization that this would require code, so I searched and found some code to use. When I start it within VBA, it runs. However, when in presentation mode, it doesn't fire the code. After hours of searching, I can't seem to find what I've done wrong. Any help is greatly appreciated. </p>\n\n<pre><code>Function SpeakThis(myPhrase As String)\nDim oSpeaker As New SpeechLib.SpVoice\n\n'Set speech properties\noSpeaker.Volume = 100 ' percent\noSpeaker.Rate = 0.1 ' multiplier\noSpeaker.SynchronousSpeakTimeout = 1\noSpeaker.AlertBoundary = SVEWordBoundary\n\nIf Not myPhrase = \"\" Then oSpeaker.Speak myPhrase, SVSFDefault\nEnd Function\n\nSub OnSlideShowPageChange()\nDim text As String\nDim intSlide As Integer\nintSlide = ActiveWindow.Selection.SlideRange.SlideIndex\n\ntext = ActivePresentation.Slides(intSlide).NotesPage.Shapes.Placeholders(2).TextFrame.TextRange.text\nSpeakThis text\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "events", "onchange", "worksheet"], "comments": [{"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1545162638, "post_id": 53839904, "comment_id": 94528462, "body": "Welcome to Stack Overflow.   Please refrain from using links to code, and rather inline the code in the question itself."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545162871, "post_id": 53839904, "comment_id": 94528554, "body": "Maybe see <a href=\"https://stackoverflow.com/a/52121718/9245853\">this answer</a> for an approach using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetchange\" rel=\"nofollow noreferrer\">Workbook.SheetChange</a> event."}, {"owner": {"reputation": 81, "user_id": 10807836, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m86T8-EH_fw/AAAAAAAAAAI/AAAAAAAAEBQ/0Ee1ttZlVL4/photo.jpg?sz=128", "display_name": "Carter Bayer", "link": "https://stackoverflow.com/users/10807836/carter-bayer"}, "reply_to_user": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1610474186, "post_id": 53839904, "comment_id": 116142968, "body": "Thanks @HardcoreHenry for the feedback."}, {"owner": {"reputation": 81, "user_id": 10807836, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m86T8-EH_fw/AAAAAAAAAAI/AAAAAAAAEBQ/0Ee1ttZlVL4/photo.jpg?sz=128", "display_name": "Carter Bayer", "link": "https://stackoverflow.com/users/10807836/carter-bayer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1610474208, "post_id": 53839904, "comment_id": 116142979, "body": "Thanks @BigBen. That was very helpful"}], "answers": [{"comments": [{"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1610555586, "post_id": 53860541, "comment_id": 116172935, "body": "I edited your post by formatting the code segment. For future reference, you can do it by selecting the code block and hitting the <code>{}</code> button in the post editor."}, {"owner": {"reputation": 81, "user_id": 10807836, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m86T8-EH_fw/AAAAAAAAAAI/AAAAAAAAEBQ/0Ee1ttZlVL4/photo.jpg?sz=128", "display_name": "Carter Bayer", "link": "https://stackoverflow.com/users/10807836/carter-bayer"}, "reply_to_user": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1610556109, "post_id": 53860541, "comment_id": 116173206, "body": "Thanks, @TomBrunberg"}], "tags": [], "owner": {"reputation": 81, "user_id": 10807836, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m86T8-EH_fw/AAAAAAAAAAI/AAAAAAAAEBQ/0Ee1ttZlVL4/photo.jpg?sz=128", "display_name": "Carter Bayer", "link": "https://stackoverflow.com/users/10807836/carter-bayer"}, "is_accepted": false, "score": 0, "last_activity_date": 1610555478, "last_edit_date": 1610555478, "creation_date": 1545261814, "answer_id": 53860541, "question_id": 53839904, "link": "https://stackoverflow.com/questions/53839904/multiple-worksheet-change-events-multiple-dropdowns/53860541#53860541", "title": "Multiple Worksheet Change Events: Multiple Dropdowns", "body": "<p>Sorry if this question was elementary -- I am new to VBA.</p>\n<p>Using the example from the <a href=\"https://answers.microsoft.com/en-us/office/forum/office_2010-excel/use-two-drop-down-menus-to-control-each-other/21354e76-c8ab-4116-aff7-1916cd44b532\" rel=\"nofollow noreferrer\">Original VBA code referenced</a>, if you were looking to apply this rule to 2 sets of drop downs (4 total), instead of 1 set - you would duplicate the snippet from &quot;If Not Intersect(...&quot; to &quot;..End if&quot; and then update the reference to the 2nd set of cells.</p>\n<p>EXAMPLE:</p>\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim targetSheet As Worksheet\n\nIf Not Intersect(Target, Range(&quot;A1&quot;)) Is Nothing Then ' watch only cell A1\n    Set targetSheet = ActiveWorkbook.Worksheets(&quot;Sheet2&quot;) ' define the sheet to copy to\n    On Error Resume Next\n    Application.EnableEvents = False\n    targetSheet.Range(&quot;B1&quot;) = Target.Value ' copy to cell B1 on the target sheet\n    Application.EnableEvents = True\nEnd If\n\nIf Not Intersect(Target, Range(&quot;A2&quot;)) Is Nothing Then ' watch only cell A1\n    Set targetSheet = ActiveWorkbook.Worksheets(&quot;Sheet2&quot;) ' define the sheet to copy to\n    On Error Resume Next\n    Application.EnableEvents = False\n    targetSheet.Range(&quot;B2&quot;) = Target.Value ' copy to cell B1 on the target sheet\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n<p>You would then repeat for the other worksheet.</p>\n"}], "owner": {"reputation": 81, "user_id": 10807836, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m86T8-EH_fw/AAAAAAAAAAI/AAAAAAAAEBQ/0Ee1ttZlVL4/photo.jpg?sz=128", "display_name": "Carter Bayer", "link": "https://stackoverflow.com/users/10807836/carter-bayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1610555478, "creation_date": 1545161730, "last_edit_date": 1545162953, "question_id": 53839904, "link": "https://stackoverflow.com/questions/53839904/multiple-worksheet-change-events-multiple-dropdowns", "title": "Multiple Worksheet Change Events: Multiple Dropdowns", "body": "<p>I am trying to create a workbook where if I change a dropdown on 1 sheet, it automatically updates that same dropdown on a second sheet. These dropdowns will represent different scenarios and my purpose in creating this is to allow the end-user the ability to change the scenario dropdown from any sheet, rather than just one.</p>\n\n<p>I used this reference to create a VBA for changing 1 dropdown -<a href=\"https://answers.microsoft.com/en-us/office/forum/office_2010-excel/use-two-drop-down-menus-to-control-each-other/21354e76-c8ab-4116-aff7-1916cd44b532\" rel=\"nofollow noreferrer\">Original VBA code referenced</a> - and it worked correctly (<a href=\"https://1drv.ms/x/s!AmcGUE_vrclQ7TJf86wLLGH833FZ\" rel=\"nofollow noreferrer\">See example workbook to download</a>). However, now I want to add the other 2 dropdowns so that if any changes are made to them it updates accordingly.</p>\n\n<p>I'm also open to other solutions if you know of something better.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1545161711, "post_id": 53839812, "comment_id": 94528064, "body": "See <a href=\"https://stackoverflow.com/q/43640609/4088852\">Save attachment from an email in to a folder that changes every month</a>. For the record, you &quot;code&quot; or &quot;write&quot; VBA as opposed to &quot;personalize&quot; it."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1545161913, "post_id": 53839812, "comment_id": 94528144, "body": "Are you trying to save it on today&#39;s date?"}, {"owner": {"reputation": 21, "user_id": 10592378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc5648b1519666b78749a3265fdf7c27?s=128&d=identicon&r=PG&f=1", "display_name": "farahm", "link": "https://stackoverflow.com/users/10592378/farahm"}, "edited": false, "score": 0, "creation_date": 1545163273, "post_id": 53839812, "comment_id": 94528745, "body": "No, I&#39;m just trying to save it a generic file name &quot;New Members&quot; and have it replace the file with the previous day&#39;s data. So everyday it would just replace. Would this be an issue? Will it always prompt you to clarify whether you wanted to replace the existing file? Because if so, I&#39;m okay with saving it as &quot;New Members MM-DD-YYYY&quot;"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1545231306, "post_id": 53839812, "comment_id": 94554967, "body": "&quot;I also need it to overwrite the previous day&#39;s file because these email attachments have the same name each day.&quot; is the usual behaviour. Is DisplayName the same each time?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10592378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc5648b1519666b78749a3265fdf7c27?s=128&d=identicon&r=PG&f=1", "display_name": "farahm", "link": "https://stackoverflow.com/users/10592378/farahm"}, "edited": false, "score": 0, "creation_date": 1545164311, "post_id": 53840329, "comment_id": 94529211, "body": "Thank you so much! I&#39;d really prefer to overwrite the file but I can definitely cater to this format... I appreciate it!"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1545163752, "creation_date": 1545163752, "answer_id": 53840329, "question_id": 53839812, "link": "https://stackoverflow.com/questions/53839812/how-to-automatically-save-an-attachment-with-overwrite/53840329#53840329", "title": "How to automatically save an attachment, with overwrite?", "body": "<p><em>Try using <a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/User-Interface-Help/date-function\" rel=\"nofollow noreferrer\">Date function</a> Which Returns a Variant (Date) containing the current system date. MSDN</em></p>\n\n<p>Example</p>\n\n<p><strong><code>oAttachment.SaveAsFile sSaveFolder &amp; \"New Members\" &amp; \" \" &amp; Format(Date - 1, \"MM-DD-YYYY\")</code></strong></p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 2, "last_activity_date": 1547233558, "last_edit_date": 1547233558, "creation_date": 1545171005, "answer_id": 53841824, "question_id": 53839812, "link": "https://stackoverflow.com/questions/53839812/how-to-automatically-save-an-attachment-with-overwrite/53841824#53841824", "title": "How to automatically save an attachment, with overwrite?", "body": "<p>I do this on my server, I receive an email each night that has an Excel file attached, that auto forwards to my server where this outlook code saves off the attachment. Note there is a clause in there to make sure the file comes from me and to make sure it's an Excel file:</p>\n\n<pre><code>Private WithEvents olItems As Outlook.Items\n\nPrivate Sub Application_Startup()\nDim objNS As Outlook.NameSpace\nSet objNS = GetNamespace(\"MAPI\")\nSet olItems = objNS.GetDefaultFolder(olFolderInbox).Items\nSet objNS = Nothing\nEnd Sub\n\nPrivate Sub olItems_ItemAdd(ByVal Item As Object)\n    Dim NewMail As Outlook.MailItem\n    Dim Atts As Attachments\n    Dim Att As Attachment\n    Dim strPath As String\n    Dim strName As String\n\n    If Item.Class = olMail Then\n       Set NewMail = Item\n    End If\n    strPath = \"C:\\Reporting Archive\\Sales Files\\\"\n    If NewMail.Sender = \"Dan Donoghue\" Then\n\n       Set Atts = Item.Attachments\n\n       If Atts.Count &gt; 0 Then\n          For Each Att In Atts\n              If InStr(LCase(Att.FileName), \".xls\") &gt; 0 Then Att.SaveAsFile strPath &amp; Att.FileName\n          Next\n       End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>It goes in <code>ThisOutlookSession</code> in the VBE, once you have put it in close and reopen outlook and it will work.</p>\n\n<p>To save over the top I would recommend you delete the existing file first (you can use the <code>kill</code> command for this then simply save the new one).</p>\n\n<p>You would do that by replacing this:</p>\n\n<pre><code>If InStr(LCase(Att.FileName), \".xls\") &gt; 0 Then Att.SaveAsFile strPath &amp; Att.FileName\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>If InStr(LCase(Att.FileName), \".xls\") &gt; 0 Then\n    Kill strPath &amp; Att.FileName\n    Att.SaveAsFile strPath &amp; Att.FileName\nEnd If\n</code></pre>\n\n<p>in my code</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1545796647, "creation_date": 1545796647, "answer_id": 53927270, "question_id": 53839812, "link": "https://stackoverflow.com/questions/53839812/how-to-automatically-save-an-attachment-with-overwrite/53927270#53927270", "title": "How to automatically save an attachment, with overwrite?", "body": "<p>You can setup a rule that triggers this job in any frequency you want (you probably don't want the rule to run in seconds, but more like 1x per day, overnight, etc.)</p>\n\n<pre><code>Public Sub SaveAttachmentsToDisk(MItem As Outlook.MailItem)\nDim oAttachment As Outlook.Attachment\nDim sSaveFolder As String\nsSaveFolder = \"C:\\Users\\DT168\\Documents\\outlook-attachments\\\"\nFor Each oAttachment In MItem.Attachments\noAttachment.SaveAsFile sSaveFolder &amp; oAttachment.DisplayName\nNext\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.extendoffice.com/documents/outlook/3747-outlook-auto-download-save-attachments-to-folder.html#a1\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/outlook/3747-outlook-auto-download-save-attachments-to-folder.html#a1</a></p>\n"}], "owner": {"reputation": 21, "user_id": 10592378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc5648b1519666b78749a3265fdf7c27?s=128&d=identicon&r=PG&f=1", "display_name": "farahm", "link": "https://stackoverflow.com/users/10592378/farahm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10585, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1592700625, "creation_date": 1545161285, "last_edit_date": 1592700625, "question_id": 53839812, "link": "https://stackoverflow.com/questions/53839812/how-to-automatically-save-an-attachment-with-overwrite", "title": "How to automatically save an attachment, with overwrite?", "body": "<p>I'm trying to extract an Excel report from an Outlook email, and save it in a folder called \"OLAttachments\" in my Documents folder. </p>\n\n<p>I also need it to overwrite the previous day's file. These email attachments have the same name each day. </p>\n\n<p>This is what I have so far. Each time the email comes through, it saves a new file, whereas I would like to overwrite the existing file.</p>\n\n<pre><code>Public Sub SaveAttachmentsToDisk(MItem As Outlook.MailItem)\nDim oAttachment As Outlook.Attachment\nDim sSaveFolder As String\nsSaveFolder = \"C:\\Users\\fmustapha\\Documents\\Outlook Attachments\"\nFor Each oAttachment In MItem.Attachments\n    oAttachment.SaveAsFile sSaveFolder &amp; oAttachment.DisplayName\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1545160481, "post_id": 53839511, "comment_id": 94527529, "body": "Cells is of type Range, for which default property is item that takes (variant type ) row and column index. When you are providing integral type as the parameter, excel is trying to convert it to integer or may be long to get a valid index (can&#39;t  say for sure) and as there are no issues in conversion, it works fine.  clng(5.604) or cint(5.604) is 6."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1545160874, "creation_date": 1545160874, "answer_id": 53839726, "question_id": 53839511, "link": "https://stackoverflow.com/questions/53839511/how-is-it-that-the-cells-property-accepts-decimal-values/53839726#53839726", "title": "How is it that the Cells() property accepts decimal values?", "body": "<p>The <code>Range.Cells</code> property is parameterless.</p>\n\n<p><img src=\"https://i.stack.imgur.com/zeKLE.png\" alt=\"Property Cells As Range / read-only / member of Excel.Range\"></p>\n\n<p>This means <code>Cells(foo, bar)</code> is an implicit default member call which resolves to something like this (assuming the code is written in a standard module):</p>\n\n<pre><code> ActiveSheet.Cells.[_Default](foo, bar)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/oZMcP.png\" alt=\"hidden Range._Default property\"></p>\n\n<p>If the default member is invoked without parameters, what you get is a member call to the range's <code>Value</code>.</p>\n\n<p>If the default member is invoked <em>with</em> parameters, what you get is a member call to the range's <code>Item</code> property:</p>\n\n<p><img src=\"https://i.stack.imgur.com/ZDy1G.png\" alt=\"range.item property\"></p>\n\n<p>The <code>RowIndex</code> and <code>ColumnIndex</code> parameters are <code>Variant</code>, so you can give it \"D\" for a column and it understands you want the 4th. Or you can give it any integer value and it'll work with that.</p>\n\n<p>So why is it happy to work with a decimal value? Because it's forgiving, that's all: it makes the implicit narrowing type conversion from <code>Double</code> to <code>Long</code>, and merrily takes <code>5.604</code> and makes that <code>6</code>.</p>\n"}], "owner": {"reputation": 982, "user_id": 4163743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b53688d0bbc845af7c7e7907ba0013c?s=128&d=identicon&r=PG&f=1", "display_name": "PBeezy", "link": "https://stackoverflow.com/users/4163743/pbeezy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53839726, "answer_count": 1, "score": 3, "last_activity_date": 1579253310, "creation_date": 1545159764, "last_edit_date": 1579253310, "question_id": 53839511, "link": "https://stackoverflow.com/questions/53839511/how-is-it-that-the-cells-property-accepts-decimal-values", "title": "How is it that the Cells() property accepts decimal values?", "body": "<p>If I execute the following code</p>\n\n<pre><code>Cells(3.0004, 5.604).Interior.ColorIndex = 1\n</code></pre>\n\n<p>it will color the cell at Row 3, Column 6 (F3) black. It does so without complaining and appears to silently round the values. How and why?</p>\n"}, {"tags": ["excel", "vba", "sendkeys"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1545159885, "post_id": 53839257, "comment_id": 94527279, "body": "&quot;ASDF&quot; needs to match the window you&#39;re looking for. If the app was updated and instead of &quot;ASDF&quot; it now says &quot;ASDF 2.0&quot;, likely your code needs to update that."}, {"owner": {"reputation": 73, "user_id": 4080275, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b2aa482e32ecdfe20163e8a48caae2a7?s=128&d=identicon&r=PG&f=1", "display_name": "tim", "link": "https://stackoverflow.com/users/4080275/tim"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1545172224, "post_id": 53839257, "comment_id": 94532248, "body": "It matches correctly. I only changed it to that to hide the program name. It actually pops the window in front and seems like the appActivate works. It just doesn&#39;t type any of the sendkeys. Before AppActivate would bring the window to the front and the typing cursor will blink at password. Now it brings it to the front but does not have a cursor in any of the boxes to type in."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1545172727, "post_id": 53839257, "comment_id": 94532389, "body": "I&#39;d try using Win32 API calls instead of <code>Application.SendKeys</code>. <a href=\"https://stackoverflow.com/a/13897489/1188513\">This</a> should help."}], "owner": {"reputation": 73, "user_id": 4080275, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b2aa482e32ecdfe20163e8a48caae2a7?s=128&d=identicon&r=PG&f=1", "display_name": "tim", "link": "https://stackoverflow.com/users/4080275/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1579253336, "creation_date": 1545158561, "last_edit_date": 1579253336, "question_id": 53839257, "link": "https://stackoverflow.com/questions/53839257/appactivate-not-sending-keys-or-truly-activating", "title": "AppActivate not sending keys or truly activating", "body": "<p>I have an Appactivate VBA script to open a program and then send keys to login. It worked flawlessly for years and since the program got update it does not seem to work anymore. The issue is the appactivate actually pulls the window up but it does not send any keys. The password section does not show the blinking cursor until I actually click on the window with my mouse. Is their another way to activate the window/program? The code is below.</p>\n\n<pre><code>Sub LOGIN()\n\nShell (\"C:\\ASD\\ASDF.exe\")\n\n Dim PASS As String\n\n\n PASS = Range(\"D11\")\n\n    AppActivate (\"ASDF\")\n    'THIS IS WHERE IT STOPS. THE WINDOW POPS UP. THE CODE DOES NOT ERROR ITS JUST DOESN'T SEND ANY KEYS AFTER THIS BECAUSE I THINK THE WINDOW IS TRULY NOT ACTIVE.\n    Application.SendKeys \"+{TAB 4}\"\n    Application.SendKeys \"FACILITY NAME\"\n    Application.Wait (Now + TimeSerial(0, 0, 1))\n    Application.SendKeys \"{TAB 4}\"\n    Application.SendKeys PASS\n    Application.SendKeys vbCrLf\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1545157867, "post_id": 53838991, "comment_id": 94526371, "body": "You can do this with a custom filter with <code>contains</code>"}], "answers": [{"tags": [], "owner": {"reputation": 586, "user_id": 9149934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ff11850461a5d4b495f04c3b895010?s=128&d=identicon&r=PG&f=1", "display_name": "earthling", "link": "https://stackoverflow.com/users/9149934/earthling"}, "is_accepted": false, "score": 1, "last_activity_date": 1545158899, "last_edit_date": 1545158899, "creation_date": 1545158313, "answer_id": 53839204, "question_id": 53838991, "link": "https://stackoverflow.com/questions/53838991/write-a-macro-for-searching-string-value-in-column-b-and-get-the-column-a-value/53839204#53839204", "title": "Write a macro for searching string value in Column B and get the Column A value of multiple rows", "body": "<p>if you want a separate list, you can do it like that: </p>\n\n<pre><code>dim i as integer\ndim lastrow as integer\nlastrow = 1\ndo until cells(i,1).value = \"\" 'loop to the end of the column\n    if instr(1,cells(i,2).value,\"not\")&gt;0 then\n        cells(lastrow,3).value = cells(i,1).value 'create list an adjacent column\n        lastrow = lastrow + 1 \n    end if\n    i = i + 1\nloop\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10218076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149a8d3be612078480965ad8894cff9d?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevabalan", "link": "https://stackoverflow.com/users/10218076/jeevabalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1545159694, "answer_count": 1, "score": -2, "last_activity_date": 1579253327, "creation_date": 1545157416, "last_edit_date": 1579253327, "question_id": 53838991, "link": "https://stackoverflow.com/questions/53838991/write-a-macro-for-searching-string-value-in-column-b-and-get-the-column-a-value", "closed_reason": "Needs more focus", "title": "Write a macro for searching string value in Column B and get the Column A value of multiple rows", "body": "<p>below table i need get list of all the column A value from the column B with string as \"not\"</p>\n\n<p>can someone help me to write macro for this.</p>\n\n<pre><code>ColumnA   ColumnB\nA           this a A value\nB           not available\nC           this is C value\nD           not found\nE           this is E value\n\noutput:\nB\nD\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": false, "score": 0, "last_activity_date": 1545188735, "creation_date": 1545188735, "answer_id": 53844018, "question_id": 53838451, "link": "https://stackoverflow.com/questions/53838451/syntax-for-mentioning-slidelayout-instead-of-slide-number/53844018#53844018", "title": "Syntax for mentioning SlideLayout instead of Slide Number", "body": "<p>Taking the link that BigBen references and making a working example ... </p>\n\n<pre><code>Option Explicit\n\nPublic Sub ModifyLayoutText()\n    Dim vIndex As Integer\n    vIndex = getLayoutIndexByName(\"Title Slide\")\n    If vIndex &gt; 0 Then\n        With ActivePresentation.Designs(1).SlideMaster.CustomLayouts.Item(vIndex)\n            .Shapes.Item(\"Title 1\").TextFrame2.TextRange.Text = \"Simple Alt Text\"\n        End With\n    End If\nEnd Sub\n\nFunction getLayoutIndexByName(xName As String) As Integer\n    ' Code from https://stackoverflow.com/questions/9147643/how-to-apply-particular-layout-in-powerpoint-using-vba\n    Dim vCounter As Integer\n    With ActivePresentation.Designs(1).SlideMaster.CustomLayouts\n        For vCounter = 1 To .Count\n            If .Item(vCounter).Name = xName Then\n                getLayoutIndexByName = vCounter\n                Exit Function\n            End If\n        Next\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 568, "user_id": 4630650, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/799739480117365/picture?type=large", "display_name": "Bhavesh Shaha", "link": "https://stackoverflow.com/users/4630650/bhavesh-shaha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "closed_date": 1545197415, "answer_count": 1, "score": 1, "last_activity_date": 1545188735, "creation_date": 1545155075, "question_id": 53838451, "link": "https://stackoverflow.com/questions/53838451/syntax-for-mentioning-slidelayout-instead-of-slide-number", "closed_reason": "Duplicate", "title": "Syntax for mentioning SlideLayout instead of Slide Number", "body": "<p>I used to use the following code:</p>\n\n<pre><code>ActivePresentation.Slides(3).Shapes(\"Name\").TextFrame.TextRange.Text = TBN.Value\n</code></pre>\n\n<p>But I want to change the Shapes(\"Name\") which is present inside a SlideLayout. How do I do that?</p>\n\n<pre><code>ActivePresentation.SlideLayout26.Shapes(\"Name\").TextFrame.TextRange.Text = TBN.Value\n</code></pre>\n\n<p>The above code hasn't worked.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1545154523, "post_id": 53838128, "comment_id": 94524748, "body": "I&#39;ve created something similar myself and the approach I followed was to give each user a group, and then on their opening the workbook catch their userid, and enable or disable the necessary ranges for their &quot;access level&quot; based on that.  I&#39;d recommend something like that."}, {"owner": {"reputation": 91, "user_id": 7740340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TVhWQyup_zA/AAAAAAAAAAI/AAAAAAAAAFA/dQWfAZA6Ydg/photo.jpg?sz=128", "display_name": "net", "link": "https://stackoverflow.com/users/7740340/net"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1545155259, "post_id": 53838128, "comment_id": 94525169, "body": "@ dave, Meaning wont need to have a specific sheet for &#39;list of users&#39;  right? but what about the code amendment how to do it ? can u share it or mail me ze template u have.. pls"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1545155614, "post_id": 53838128, "comment_id": 94525343, "body": "Look into <code>Range.Locked</code> and <code>Worksheet.Protection</code>, no need to reinvent the wheel here, that&#39;s already a feature of Excel."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1545157616, "post_id": 53838128, "comment_id": 94526260, "body": "@Dave that is easily defeated security theater though."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1545158284, "post_id": 53838128, "comment_id": 94526531, "body": "Are your users on an Active Directory domain? If so then you can query AD and use the Windows Authentication to identify the user, and have AD manage the security groups. Unfortunately this is way too broad to be answerable here: you need to research and experiment a bit."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1545215725, "post_id": 53838128, "comment_id": 94546240, "body": "@MathieuGuindon Yep it is, but for my purposes it was sufficient - OPs mileage may vary on that!"}], "owner": {"reputation": 91, "user_id": 7740340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TVhWQyup_zA/AAAAAAAAAAI/AAAAAAAAAFA/dQWfAZA6Ydg/photo.jpg?sz=128", "display_name": "net", "link": "https://stackoverflow.com/users/7740340/net"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545153828, "creation_date": 1545153726, "last_edit_date": 1545153828, "question_id": 53838128, "link": "https://stackoverflow.com/questions/53838128/how-to-make-some-cells-read-only-and-some-cells-read-write-in-spreadsheets", "title": "How to make some cells read-only and some cells read-write in spreadsheets?", "body": "<p>In a spreadsheet, for the cells A to G that I fill data with, I want the cells to be read-write for users (UserA, UserB) other cells i.e. cells H to J should be read-only.\nFor user C and user D, cells H to J, will be read-write but cells A to G read-only.\nWith error message that \"You not allowed to access this cells\"</p>\n\n<p>I will have a sheet 'list of users' in the workbook to contain all users and their cells range to amend.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range) \n    If Not Intersect(Target, Range(\"A1:G10\")) Is Nothing Then \n        Target.Offset(0, 1).Select \n        MsgBox \"you not allowed to access this cells\" \n    End If \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545155518, "post_id": 53838019, "comment_id": 94525299, "body": "You will only be able to alter <code>rngDelete</code> once. After that you will get an error. Once <code>rngDelete</code> is <code>Set</code>, it will be treated like a constant. After you unmerge the range, it is now something new, not <code>rngDelete</code>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545155596, "post_id": 53838019, "comment_id": 94525332, "body": "Notice that this will unmerge and then error out on <code>EntireColumn.Delete</code>. If you cut out the merge, this will execute <code>EntireColumn.Delete</code> and then error out on <code>EntireRow.Delete</code>. In summary, once you modify <code>rngDelete</code> like this, you can no longer simply refer to <code>rngDelete</code>"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1545157547, "post_id": 53838019, "comment_id": 94526222, "body": "just get rid of EntireColumn.delete and you are golden."}, {"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "edited": false, "score": 0, "creation_date": 1545158506, "post_id": 53838019, "comment_id": 94526642, "body": "Thanks. Works fine."}], "owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1579253356, "creation_date": 1545153244, "last_edit_date": 1579253356, "question_id": 53838019, "link": "https://stackoverflow.com/questions/53838019/excel-vba-remove-unmerged-rows", "title": "Excel VBA - remove unmerged rows", "body": "<p>Having asked a question about deleting rows with merged cells, I've got the answer below. It generated an error: Runtime error 1004: Cannot use that command on overlapping selections.</p>\n\n<p>It was suggested that I should unmerge delete columns and unmerge cells and that I should start a new questions for that.  I've added the commands to delete columns and unmerge cells below. The unmerging works fine but then I get the same 1004 error again.</p>\n\n<pre><code>Sub DeleteRows()\n\n    Dim x           As Range\n    Dim rngDelete   As Range\n\n    For Each x In ActiveSheet.UsedRange\n        If x.MergeCells Then\n            If rngDelete Is Nothing Then\n                Set rngDelete = x\n            Else\n                Set rngDelete = Union(rngDelete, x)\n            End If\n\n        End If\n    Next\n\n    If Not rngDelete Is Nothing Then\n        rngDelete.UnMerge\n        rngDelete.EntireColumn.Delete\n        rngDelete.EntireRow.Delete\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "concatenation"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1545152393, "post_id": 53837746, "comment_id": 94523693, "body": "Would another way to state your problem be - For each ID, you want to return all the unique <code>Area</code> values that exist for it?"}, {"owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1545152851, "post_id": 53837746, "comment_id": 94523942, "body": "Yes, but only for the &quot;Master&quot; IDs, not for the ones that start with numbers."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545157630, "post_id": 53838096, "comment_id": 94526263, "body": "I&#39;m noticing that some of the ones that have duplicate values will show up in column J as &quot;X,&quot; for example instead of just &quot;X&quot; - is there any way to fix that? Thank you!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545158065, "post_id": 53838096, "comment_id": 94526442, "body": "@VictoriaG - Can you edit your OP with more examples? I changed the areas to <code>X &#47; X &#47; Z</code> for <code>789</code>, and get <code>Z, X</code>.  I can&#39;t reproduce the <code>X,</code>"}, {"owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545162265, "post_id": 53838096, "comment_id": 94528313, "body": "apologies, it actually is not when it is a duplicate but rather when there is only one value. In your example above, it would occur if J8 was X and J9 and J10 were blank, then it would show X, in J7."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545166666, "post_id": 53838096, "comment_id": 94530257, "body": "@VictoriaG - Hm, I can&#39;t seem to replicate the issue.  Do the empty cells have spaces in them, or are they indeed empty?"}, {"owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545317927, "post_id": 53838096, "comment_id": 94589330, "body": "They are empty, except for the formula I was using to populate them (seen above). I am trying to use VBA to enter the get_areas function into the blank cells, but it doesn&#39;t seem to be working that way. Might you have any insight? Sub emptycells() Range(&quot;J2:J&quot; &amp; Cells.SpecialCells(11).row).Offset(1, -1).SpecialCells(4).Value = &quot;=get_areas($C2)&quot; End Sub"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545319819, "post_id": 53838096, "comment_id": 94590361, "body": "@VictoriaG - That sounds like a new question :)"}, {"owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545335429, "post_id": 53838096, "comment_id": 94597579, "body": "It seems like the issue might be with this part of the function when I attempt to use it in VBA areas = Trim(Left(areas, Len(areas) - 2)). I started a new thread here. :) <a href=\"https://stackoverflow.com/questions/53873304/enter-user-defined-function-into-column-using-vba\" title=\"enter user defined function into column using vba\">stackoverflow.com/questions/53873304/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545411292, "post_id": 53838096, "comment_id": 94623324, "body": "is there a way to make this a sub instead of a function? And have it only go into cells in column J that start with &quot;Master&quot; in column A? :)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1545153579, "creation_date": 1545153579, "answer_id": 53838096, "question_id": 53837746, "link": "https://stackoverflow.com/questions/53837746/vba-comma-separated-look-up/53838096#53838096", "title": "VBA Comma Separated Look-Up", "body": "<p>You can use this UDF.  Since you're looking for a <em>formula</em>, put this in the blank cells in Column J.</p>\n\n<pre><code>=get_areas(C2)\n</code></pre>\n\n<p>Then add this in to a Workbook Module:</p>\n\n<pre><code>Function get_areas(ID As String) As String\nDim rng As Range, cel As Range\n\nSet rng = Range(\"A2:A\" &amp; Cells(rows.count,1).End(xlUp).Row)\n\nDim areas As String\nFor Each cel In rng\n    If IsNumeric(Left(cel, 1)) And cel.Offset(0, 2) = ID Then\n        If InStr(1, areas, cel.Offset(0, 9)) = 0 Then\n            areas = cel.Offset(0, 9) &amp; \", \" &amp; areas\n        End If\n    End If\nNext cel\n\nareas = Trim(Left(areas, Len(areas) - 2))\nget_areas = areas\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bT4sW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bT4sW.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 53838096, "answer_count": 1, "score": 1, "last_activity_date": 1545153579, "creation_date": 1545152128, "last_edit_date": 1545152309, "question_id": 53837746, "link": "https://stackoverflow.com/questions/53837746/vba-comma-separated-look-up", "title": "VBA Comma Separated Look-Up", "body": "<p>I'm looking to either use a formula or VBA to lookup values in column J associated with the same ID number and put them into any starting with \"Master\" in Column A separated by commas. </p>\n\n<p>In the example below, I would like cell J2 to return \n\"D, G, R, N\" and if there ere any duplicates to only have them listed once. The values in column J are currently looking up values from another list using the formula :</p>\n\n<pre><code>=IFERROR(IF(ISNUMBER(MATCH(M2,Sheet1!$J:$J,0)),\"N\", \nIF(ISNUMBER(MATCH(M2,Sheet1!$K:$K,0)),\"D\", \nIF(ISNUMBER(MATCH(M2,Sheet1!$L:$L,0)),\"R\", \nIF(ISNUMBER(MATCH(M2,Sheet1!$M:$M,0)),\"G\", \nIF(ISNUMBER(MATCH(M2,Sheet1!$N:$N,0)),\"F\",\"\"))))), \"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/sSvy0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sSvy0.jpg\" alt=\"Master Image\"></a></p>\n"}, {"tags": ["excel", "vba", "loops", "match"], "comments": [{"owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "edited": false, "score": 1, "creation_date": 1545151979, "post_id": 53837642, "comment_id": 94523433, "body": "You could just put it all in a pivot table and remove the need for any VBA."}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "reply_to_user": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "edited": false, "score": 0, "creation_date": 1545152063, "post_id": 53837642, "comment_id": 94523484, "body": "i have to use vba unfortunately as this expands in the future. just trying to figure out how :)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545152137, "post_id": 53837642, "comment_id": 94523528, "body": "If it must be VBA, I would go with an array"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1545152155, "post_id": 53837642, "comment_id": 94523539, "body": "FYI, those <code>Item</code>are implicit. Everybody writes <code>wbmacro.Worksheets(&quot;Data&quot;)</code>."}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1545152375, "post_id": 53837642, "comment_id": 94523682, "body": "how would i go about doing this with an array?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545153425, "post_id": 53837642, "comment_id": 94524236, "body": "Paste whole range from WB2 into array1. Using advanced filter, copy unique values from WB2 to WB1 (1st column). Paste unique into array2. Forget about WB2, everything you need is in arrays. Then a little dancing (hours) to create array3, which is then pasted into WB1."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1545153907, "post_id": 53837642, "comment_id": 94524475, "body": "I would approach this differently.  Making a list of unique student numbers and working through that list one by one your data.  Building one student at a time.  I might be able to help you on this later."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545154428, "post_id": 53837642, "comment_id": 94524695, "body": "@VBAWARD Does it matter what order the question numbers are? Will there always be an answer for every question? Is there a chance there could be the same student ID twice but with a different date completed?"}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1545155038, "post_id": 53837642, "comment_id": 94525048, "body": "the order of the questions doesn&#39;t really matter. the &quot;DATA&quot; sheet has them ordered sequentially, thats all. thats why i&#39;m trying to get the cell to match the column heading in case the source sheet (shee1) has it out of order. there will always be an answer for every question. and there will not be a different date completed."}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545155160, "post_id": 53837642, "comment_id": 94525116, "body": "@VBasic2008. that sounds complicated lol. im still pretty new to VBA and figuring my way out :) any material you could send my way that i could use as a reference?"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 1, "creation_date": 1545157375, "post_id": 53838625, "comment_id": 94526156, "body": "fantastic! it works beautifully. you sir, are a gentleman and a scholar."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 2, "last_activity_date": 1545155796, "creation_date": 1545155796, "answer_id": 53838625, "question_id": 53837642, "link": "https://stackoverflow.com/questions/53837642/vba-code-to-match-cell-value-to-column-heading-and-return-cell-value-in-a-loop/53838625#53838625", "title": "VBA code to match cell value to column heading and return cell value in a loop", "body": "<p>Not the prettiest, but this should get the job done... This also makes some assumptions, like there aren't multiple completed dates for the same student ID (needed clarification) - also assumes that every student goes through the same question #s (1, 2, 3, etc.).</p>\n\n<pre><code>Option Explicit\nSub Test()\n\nDim sht As Worksheet, sht2 As Worksheet\nDim i As Long, k As Long\nDim lastrow As Long, lastcol, foundrow As Long, foundcol As Long\n\nSet sht = Workbooks(\"Testfile1.xlsm\").Worksheets(\"Sheet1\")\nSet sht2 = Workbooks(\"Testfile2.xlsm\").Worksheets(\"Sheet1\")\nlastrow = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row\n\nsht2.Cells.ClearContents\nsht2.Cells(1, 1).Value = \"Student ID\"\nsht2.Cells(1, 2).Value = \"Date completed\"\nsht2.Cells(1, 3).Value = \"Question # 1\"\nk = 2\n\nFor i = 2 To lastrow\n    If Application.CountIf(sht2.Range(\"A:A\"), sht.Cells(i, 1).Value) = 0 Then\n        sht2.Cells(k, 1).Value = sht.Cells(i, 1).Value\n        sht2.Cells(k, 2).Value = sht.Cells(i, 2).Value\n\n        lastcol = sht2.Cells(1, sht2.Columns.Count).End(xlToLeft).Column\n\n        sht2.Cells(k, 3).Value = sht.Cells(i, 4).Value\n        k = k + 1\n    Else\n        foundrow = sht2.Range(\"A:A\").Find(What:=sht.Cells(i, 1).Value).Row\n\n        On Error Resume Next\n        foundcol = sht2.Range(\"1:1\").Find(What:=\"Question # \" &amp; sht.Cells(i, 3).Value).Column\n        On Error GoTo 0\n\n        If foundcol = 0 Then\n            lastcol = sht2.Cells(1, sht2.Columns.Count).End(xlToLeft).Column\n            sht2.Cells(1, lastcol + 1).Value = \"Question # \" &amp; sht.Cells(i, 3).Value\n            sht2.Cells(foundrow, lastcol + 1).Value = sht.Cells(i, 4).Value\n        Else\n            sht2.Cells(foundrow, foundcol).Value = sht.Cells(i, 4).Value\n        End If\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/uj1Sj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uj1Sj.png\" alt=\"img1\"></a></p>\n"}], "owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 53838625, "answer_count": 1, "score": 0, "last_activity_date": 1545159611, "creation_date": 1545151769, "last_edit_date": 1545159611, "question_id": 53837642, "link": "https://stackoverflow.com/questions/53837642/vba-code-to-match-cell-value-to-column-heading-and-return-cell-value-in-a-loop", "title": "VBA code to match cell value to column heading and return cell value in a loop", "body": "<p>I've been trying to piece this together but have been unsuccessful so far. </p>\n\n<p>Workbook2, with sheet name \"Sheet1\" has the data which needs to be pulled into Workbook1, with sheet name \"DATA\".</p>\n\n<p>Workbook 2:</p>\n\n<pre><code>Student ID    Date completed   Question#  Score\n101            12/10/2018        1         0\n101            12/10/2018        2         5\n101            12/10/2018        3         10\n101            12/10/2018        4         0\n102            12/05/2018        1         10\n102            12/05/2018        2         0\n</code></pre>\n\n<p>Workbook 1:</p>\n\n<pre><code>Student ID  Date Completed  Question1  2   3   4\n101         12/10/2018       0         5   10  0\n102         12/05/2018       10        0\n</code></pre>\n\n<p>What I'm trying to do is get the code to loop through the column with the Question # (in \"Sheet1\" Workbook 2), and if the student numbers match, and if the question number in Workbook 2 matches the column heading in Sheet \"DATA\" (Workbook 1) then return the student number, date completed and most importantly, the score value under the matching column heading.</p>\n\n<p>The code I've been trying to use is below. Any suggestions would be welcome:</p>\n\n<pre><code>Public Sub grabqdata()\n\n\nDim wbmacro As Workbook\nDim wblean As Workbook\n\nSet wbmacro = Workbooks.Item(\"MacroFile.xlsm\")\nSet wblean = Workbooks.Item(\"Workbook2.xlsx\")\n\nDim wsmacro As Worksheet\nDim wslean As Worksheet\n\nSet wsmacro = wbmacro.Worksheets.Item(\"Data\")\nSet wslean = wblean.Worksheets.Item(\"Sheet1\")\n\nDim leanrange As Range\nSet leanrange = wslean.Range(\"A2:A150000\")\n\nDim headerrange As Range\nSet headerrange = wsmacro.Range(\"A1:G1\")\n\nDim qrange As Range\nSet qrange = wslean.Range(\"D2:D150000\")\n\nDim macrorange As Range\nSet macrorange = wsmacro.Range(\"A:A\")\n\nDim lastrow As Long\n\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nDim colm As Long\ncolm = WorksheetFunction.Match(wsmacro, Range(\"A1:G1\"), 0)\n\n\nDim cell As Range\n\n\ni = 1\n\n\nFor Each cell In leanrange\n\n    If leanrange.Range(\"A2\") = macrorange.Range(\"a2\") Then\n\n\n        wsmacro.Range(\"C2\").Offset(i, 0) = wslean.Range(\"D2\").Offset(i, 0)\n\n\n        i = i + 1\n    End If\n\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>Column C is where the first Q# is (so Q1 or \"1\"). </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "sapui5"], "comments": [{"owner": {"reputation": 6851, "user_id": 502613, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22d0c3731d77922fc5742aab55606c59?s=128&d=identicon&r=PG", "display_name": "Jorg", "link": "https://stackoverflow.com/users/502613/jorg"}, "edited": false, "score": 0, "creation_date": 1545174107, "post_id": 53837261, "comment_id": 94532832, "body": "sapui5 is a javascript framework. are you extracting this from a website somehow or from an RFC call"}], "answers": [{"tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": false, "score": 1, "last_activity_date": 1545225220, "last_edit_date": 1545225220, "creation_date": 1545217222, "answer_id": 53849842, "question_id": 53837261, "link": "https://stackoverflow.com/questions/53837261/extracting-data-with-selectitem-vba-sap/53849842#53849842", "title": "Extracting Data with .selectitem VBA-SAP", "body": "<p>In similar cases, I proceeded as follows:</p>\n\n<pre><code>myRow  = right(space(10) &amp; cstr(i) , 11) \nmyText = session.findById(\"wnd[0]/usr/cntlCONTAINER/shellcont/shell/shellcont[1]/shell[1]\").getItemText(myRow ,\"C         35\")\n</code></pre>\n\n<p>Regards,\nScriptMan</p>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571230507, "creation_date": 1545150326, "last_edit_date": 1571230507, "question_id": 53837261, "link": "https://stackoverflow.com/questions/53837261/extracting-data-with-selectitem-vba-sap", "title": "Extracting Data with .selectitem VBA-SAP", "body": "<p>I am trying to extract the text from a topdown analysis in SAP using VBA. I basically need to move down the column, evaluate if the extracted text contains a certain character string, then extract the cell adjacent to it.</p>\n\n<p><strong>First:</strong> Does anyone know how to change this line of code (the script for that specific cell) so that I can extract its text to a variable rather than just select it? </p>\n\n<p><strong>Second:</strong> Does anyone know how to make this line variable using <code>i</code> as the variable? </p>\n\n<pre><code>session.findById(\"wnd[0]/usr/cntlCONTAINER/shellcont/shell/shellcont[1]/shell[1]\").selectItem \"          5\", \"C         35\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1545149108, "post_id": 53836796, "comment_id": 94521781, "body": "That drop down is just a &quot;Sorted&quot; list of the range. take the range, sort it and use the first cell."}, {"owner": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1545149226, "post_id": 53836796, "comment_id": 94521855, "body": "Is there no quicker way?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1545152407, "post_id": 53836796, "comment_id": 94523700, "body": "what about <code>Criteria1:=Range(&quot;F2&quot;).Value</code> ?"}, {"owner": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "edited": false, "score": 0, "creation_date": 1545164803, "post_id": 53836796, "comment_id": 94529435, "body": "but F2 may not be in the filtered list..."}], "answers": [{"comments": [{"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "edited": false, "score": 0, "creation_date": 1545396822, "post_id": 53848376, "comment_id": 94616657, "body": "did you try my last answer?"}, {"owner": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "edited": false, "score": 0, "creation_date": 1545408597, "post_id": 53848376, "comment_id": 94622147, "body": "Thank you for you input, but I took another approach by cyboashu."}, {"owner": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "edited": false, "score": 0, "creation_date": 1545516836, "post_id": 53848376, "comment_id": 94644818, "body": "Nikolaos, thanks for your effort but it filters by the first item in column E for ALL the data range and not the <i>original</i> filtered data."}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "edited": false, "score": 0, "creation_date": 1545561019, "post_id": 53848376, "comment_id": 94650565, "body": "you want to filter only the column E?"}, {"owner": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "edited": false, "score": 0, "creation_date": 1545594799, "post_id": 53848376, "comment_id": 94657881, "body": "I have some data that is already filtered by column A, I want to then filter by column A and by the 1st item in column E. Hope this makes some sense..."}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "edited": false, "score": 0, "creation_date": 1546443288, "post_id": 53848376, "comment_id": 94854676, "body": "just add in the sub calculate, before &quot;.Range(&quot;$A$1:$Y$840&quot;).AutoFilter Field:=5, Criteria1:= _         rn.Item(2)&quot; an autofilter rule with field:=1"}], "tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": false, "score": 0, "last_activity_date": 1545299558, "last_edit_date": 1545299558, "creation_date": 1545212474, "answer_id": 53848376, "question_id": 53836796, "link": "https://stackoverflow.com/questions/53836796/select-1st-item-in-autofilter-list/53848376#53848376", "title": "Select 1st item in Autofilter List", "body": "<p>Please try the below:</p>\n\n<pre><code>Option Explicit\n\n\nSub calculate()\n\nDim rn As Range, sh As Worksheet, sh1 As Worksheet\n\n\nSheetCreate\nCopyRange\n\n\n\nSet sh = Sheet1 ' the sheet where the data you want to filter are.\nSet sh1 = Sheets(\"help to sort\")\n\n\n\nWith sh\n\nSet rn = sh1.Range(\"A:A\")\n\nIf .AutoFilterMode = True Then .AutoFilterMode = False\n\n.Range(\"$A$1:$Y$840\").AutoFilter Field:=5, Criteria1:= _\n        rn.Item(2)\n\nEnd With\n\nEnd Sub\n\n\nSub SheetCreate()\n\nDim sh As Worksheet, sh1 As Worksheet\n\nFor Each sh1 In ActiveWorkbook.Worksheets\n\nIf sh1.Name = \"help to sort\" Then Exit Sub\n\nNext\n\nSet sh = ActiveWorkbook.Sheets.Add\n\nsh.Name = \"help to sort\"\n\nEnd Sub\n\n\nSub CopyRange()\n\nDim rn As Range, rn1 As Range,sh As Worksheet, sh1 As Worksheet\n\nSet sh = Sheet1 ' the sheet where the data you want to filter are.\nSet sh1 = Sheets(\"help to sort\")\n\nWith sh\n\nIf sh1.Range(\"A2\") &lt;&gt; \"\" Then Exit Sub\n\nSet rn = .Range(\"E:E\")\nSet rn1 = sh1.Range(\"A:A\")\n\nrn.Copy rn1\n\nrn1.Sort key1:=sh1.Range(\"A2\"), order1:=xlAscending, Header:=xlYes\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>if you like you can change the order1 to xldescending</p>\n"}], "owner": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545299558, "creation_date": 1545148724, "question_id": 53836796, "link": "https://stackoverflow.com/questions/53836796/select-1st-item-in-autofilter-list", "title": "Select 1st item in Autofilter List", "body": "<p>Using VBA how do I code to select the first item in the autofilter list?</p>\n\n<p>Currently I have the below</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$Y$840\").AutoFilter Field:=5, Criteria1:= _\n    \"October\"\n</code></pre>\n\n<p>But I want to change the \"October\" to the 1st item in the dropdown list.</p>\n\n<p>Regards</p>\n\n<p>Jim</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545148069, "post_id": 53836523, "comment_id": 94521162, "body": "Well the first obvious step is to not double space your code"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545148107, "post_id": 53836523, "comment_id": 94521190, "body": "Then you can declare a work sheet variable to replace the repetitive <code>With Block</code>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1545149255, "post_id": 53836523, "comment_id": 94521871, "body": "You can also use this for each paste line:<code>.Range (&quot;J&quot; &amp; .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row + 1)</code>"}, {"owner": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "edited": false, "score": 0, "creation_date": 1545150544, "post_id": 53836523, "comment_id": 94522593, "body": "I tried that line, Davesexcel, but it doesn&#39;t work without With which I&#39;d like to get away from like Urdearboy mentioned, I found a WS variable to try. This works, but I feel these lines could be condensed further, especially the date. Can any of these ranges for the dates be like B1, C4, D9  etc etc? I edited my code above."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545151189, "post_id": 53836523, "comment_id": 94522982, "body": "Sounds like a job for <a href=\"https://codereview.stackexchange.com/\">Code Review</a>.  SO is for code problems."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545152695, "post_id": 53836523, "comment_id": 94523860, "body": "There&#39;s nothing wrong with <code>With..End With</code> lines - although you could&#39;ve placed one at the top and end it at the bottom of the code.  Everything inbetween is referencing the same sheet."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 2, "last_activity_date": 1545150695, "creation_date": 1545150695, "answer_id": 53837364, "question_id": 53836523, "link": "https://stackoverflow.com/questions/53836523/need-help-shortening-this-excel-2013-macro/53837364#53837364", "title": "Need help shortening this excel 2013 macro", "body": "<p>Here are some things for you to look at...</p>\n\n<ol>\n<li><strong>ALWAYS</strong> use <code>Option Explicit</code>. See <a href=\"https://riptutorial.com/excel-vba/example/3554/always-use--option-explicit-\" rel=\"nofollow noreferrer\">here</a> for an explanation.</li>\n<li>When you're performing an action such as copying data, it's extremely helpful to be very clear in defining the source and destination of the data. This includes defining which <code>Workbook</code> the data is going to. You'll thank me later for building this habit now. </li>\n</ol>\n\n<p>As an example:</p>\n\n<pre><code>Dim srcWB As Workbook\nDim dstWB As Workbook\nSet srcWB = ThisWorkbook\nSet dstWB = ThisWorkbook\n\nDim srcWS As Worksheet\nDim dstWS As Worksheet\nSet srcWS = srcWB.Sheets(\"Sheet1\") ' &lt;--- you didn't specify this in your code\nSet dstWS = dstWB.Sheets(\"Buyer Trend Metrics\")\n</code></pre>\n\n<ol start=\"3\">\n<li>When you're performing the same (or very similar) actions over and over, it's the perfect situation to create a separate function that will perform the action for you. When you break out this section of code, it's called \"functional isolation\". This means that if you have a problem to fix, you only have to fix it in one place instead of finding all the different spots in your code that do the same thing.</li>\n</ol>\n\n<p>In your case, you are performing a copy from one range of cells to another range of cells. So breaking that out into a separate routine looks like this:</p>\n\n<pre><code>Private Sub CopyMyData(ByRef fromData As Range, ByRef toData As Range)\n    Dim lastrow As Long\n    With toData.Parent\n        lastrow = .Cells(.Rows.Count, toData.Column).End(xlUp).Row\n    End With\n\n    fromData.Copy\n    toData.Cells(lastrow).PasteSpecial Paste:=xlPasteValues\nEnd Sub\n</code></pre>\n\n<p>Notice here how I'm using variable names that describe what the code does (<code>fromData</code> and <code>toData</code>). This makes it clear what's happening.</p>\n\n<p>Put it all together and your code will look something like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub StartCopying()\n    Dim srcWB As Workbook\n    Dim dstWB As Workbook\n    Set srcWB = ThisWorkbook\n    Set dstWB = ThisWorkbook\n\n    Dim srcWS As Worksheet\n    Dim dstWS As Worksheet\n    Set srcWS = srcWB.Sheets(\"Sheet1\") ' &lt;--- you didn't specify this in your code\n    Set dstWS = dstWB.Sheets(\"Buyer Trend Metrics\")\n\n    CopyMyData fromData:=srcWS.Range(\"B58\"), toData:=dstWS.Range(\"J:J\")\n\n    CopyMyData fromData:=srcWS.Range(\"B61:H61\"), toData:=dstWS.Range(\"K:K\")\n\n    CopyMyData fromData:=srcWS.Range(\"B58\"), toData:=dstWS.Range(\"S:S\")\n\n    CopyMyData fromData:=srcWS.Range(\"B61:H62\"), toData:=dstWS.Range(\"T:T\")\nEnd Sub\n\nPrivate Sub CopyMyData(ByRef fromData As Range, ByRef toData As Range)\n    Dim lastrow As Long\n    With toData.Parent\n        lastrow = .Cells(.Rows.Count, toData.Column).End(xlUp).Row\n    End With\n\n    fromData.Copy\n    toData.Cells(lastrow).PasteSpecial Paste:=xlPasteValues\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1545151603, "last_edit_date": 1545151603, "creation_date": 1545150986, "answer_id": 53837451, "question_id": 53836523, "link": "https://stackoverflow.com/questions/53836523/need-help-shortening-this-excel-2013-macro/53837451#53837451", "title": "Need help shortening this excel 2013 macro", "body": "<ol>\n<li>Do not double space <strong>every single line</strong>. You should use these as strategic separators, not the standard. <em>This isn't MLA.</em></li>\n<li>Use a worksheet variable to quickly refer to your sheets (<code>ws</code> refers to the sheet that has the cells to be copied and <code>ds</code> (destination sheet) refers to the sheet where the cells are to be pasted</li>\n<li>You can use a value transfer instead of a copy/paste which does not require multiple lines as well</li>\n</ol>\n\n<p>In general, when shortening code, you want to look for repetitiveness. I can see that you are constantly copying the value from <code>Range(\"B58\")</code> so you can also shorten this. You have comments saying you want the value to just be today so you can just do something like</p>\n\n<p><code>ds.Range(\"?\") = Today</code> <em>Repeat as needed</em></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub LastRowDtData()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim ds As Worksheet: Set ds = ThisWorkbook.Sheets(\"Buyer Trend Metrics\")\nDim LR As Long\n\nLR = ds.Range(\"J\" &amp; ds.Rows.Count).End(xlUp).Offset(1)\nds.Range(\"J\" &amp; LR).Value = ws.Range(\"B58\").Value\n\nLR = ds.Range(\"K\" &amp; ds.Rows.Count).End(xlUp).Offset(1)\nds.Range(\"K\" &amp; LR).Resize(1, 7).Value = ws.Range(\"B61:H61\")\n\nLR = ds.Range(\"S\" &amp; ds.Rows.Count).End(xlUp).Offset(1)\nds.Range(\"S\" &amp; LR).Value = ws.Range(\"B58\").Value\n\n\n'Repeat for below ranges\n'------------------\nRange(\"B62:H62\").Copy\nRange(\"B58\").Copy\nRange(\"B63:H63\").Copy\nRange(\"B58\").Copy\nRange(\"B64:H64\").Copy\nRange(\"B58\").Copy\nRange(\"B65:H65\").Copy\nRange(\"B58\").Copy\nRange(\"B66:H66\").Copy\nRange(\"B58\").Copy\nRange(\"B67:H67\").Copy\nRange(\"B58\").Copy\nRange(\"B68:H68\").Copy\nRange(\"B58\").Copy\nRange(\"B69:H69\").Copy\nRange(\"B58\").Copy\nRange(\"B70:H70\").Copy\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545152898, "post_id": 53837827, "comment_id": 94523970, "body": "Just noticed in your pre-edited code that there&#39;s two sheets.  Copying from one and pasting to the other?  Just prefix the <code>PasteSpecial</code> line with a reference to the sheet you&#39;re pasting to (same with <code>lLastRow</code>)."}, {"owner": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "edited": false, "score": 0, "creation_date": 1545154041, "post_id": 53837827, "comment_id": 94524534, "body": "I like this script, but I need it to paste each row onto the bottom row of the column. Each employee has different numbers of rows like  Date | Col 1 | Col 2 | Col 3 | etc etc. So each day i do this, it makes another row under the headers, so I need help there. I don&#39;t think it changes anything but this is all on 1 sheet."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "edited": false, "score": 0, "creation_date": 1545154226, "post_id": 53837827, "comment_id": 94524611, "body": "Comment out the first <code>lLastRow</code> line and uncomment the second - it will then find the last row for each section."}, {"owner": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "edited": false, "score": 1, "creation_date": 1545154796, "post_id": 53837827, "comment_id": 94524903, "body": "Awesome, it works great! This one also seems like the easiest to update should I have to move things around."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1545153210, "last_edit_date": 1545153210, "creation_date": 1545152438, "answer_id": 53837827, "question_id": 53836523, "link": "https://stackoverflow.com/questions/53836523/need-help-shortening-this-excel-2013-macro/53837827#53837827", "title": "Need help shortening this excel 2013 macro", "body": "<p>There's a pattern to how you're copying/pasting.</p>\n\n<p>Copying every row, pasting to every 9th column after column 10.  </p>\n\n<p>I've added two lines for finding the last row - either find it once and paste everything to that row, of find it before you copy each time.  Uncomment whichever you prefer.  </p>\n\n<p>This will copy <code>B61:H61</code> to <code>K:P</code> on the last row (with date in <code>J</code>), then <code>B62:H62</code> to <code>T:Z</code> with the date in <code>R</code>.  </p>\n\n<p>The date will also appear correctly formatted rather than as a number.</p>\n\n<pre><code>Public Sub WhateverYouWantToCallIt()\n\n    Dim x As Long, y As Long\n    Dim lLastRow As Long\n\n    With ThisWorkbook.Worksheets(\"Buyer Trend Metrics\")\n\n        'This will set the same last row for each copy.\n        lLastRow = .Cells(.Rows.Count, 10).End(xlUp).Row + 1\n\n        y = 10\n        For x = 61 To 70\n\n            'This will set the last row on each set of data.\n            'lLastRow = .Cells(.Rows.Count, y).End(xlUp).Row + 1\n\n            .Cells(lLastRow, y) = Date\n\n            .Range(.Cells(lLastRow, y + 1), .Cells(lLastRow, y + 7)) = _\n                .Range(.Cells(x, 2), .Cells(x, 8)).Value\n\n            '-OR-\n            '.Range(.Cells(x, 2), .Cells(x, 8)).Copy\n            '.Cells(lLastRow, y + 1).PasteSpecial Paste:=xlPasteValues\n\n            y = y + 9\n        Next x\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 53837827, "answer_count": 3, "score": 0, "last_activity_date": 1579253368, "creation_date": 1545147845, "last_edit_date": 1579253368, "question_id": 53836523, "link": "https://stackoverflow.com/questions/53836523/need-help-shortening-this-excel-2013-macro", "title": "Need help shortening this excel 2013 macro", "body": "<p>This isn't complex by far but I'm only a novice at excel macros. I've found online and edited this for my use but I know it's so long. The single ranges all refer to the same cell which is just the value of <code>=today()</code>. I know that can be integrated, I just don't know how. The rest copies a row and pastes it over at the bottom of specific rows, one for each employee. I'm sure there are even better ways to do this since the rows being copied are only there for this code and isn't the main data source. But one step at a time. Lol</p>\n\n<pre><code>Sub LastRowDtDataTEST()\nDim wb As Workbook\nDim ws As Worksheet\nDim LastRow As Long\nSet wb = ActiveWorkbook\nSet ws = ThisWorkbook.Sheets(\"Buyer Trend Metrics\")\nws.Select\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"J\").End(xlUp).Row\nRange(\"J\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B61:H61\").Copy\nLastRow = Cells(Rows.Count, \"K\").End(xlUp).Row ' get last row with data in column \"K\"\nRange(\"K\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues ' paste values\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"S\").End(xlUp).Row\nRange(\"S\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B62:H62\").Copy\nLastRow = Cells(Rows.Count, \"T\").End(xlUp).Row\nRange(\"T\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"AB\").End(xlUp).Row\nRange(\"AB\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B63:H63\").Copy\nLastRow = Cells(Rows.Count, \"AC\").End(xlUp).Row\nRange(\"AC\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"AK\").End(xlUp).Row\nRange(\"AK\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B64:H64\").Copy\nLastRow = Cells(Rows.Count, \"AL\").End(xlUp).Row\nRange(\"AL\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"AT\").End(xlUp).Row\nRange(\"AT\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B65:H65\").Copy\nLastRow = Cells(Rows.Count, \"AU\").End(xlUp).Row\nRange(\"AU\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"BC\").End(xlUp).Row\nRange(\"BC\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B66:H66\").Copy\nLastRow = Cells(Rows.Count, \"BD\").End(xlUp).Row\nRange(\"BD\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"BL\").End(xlUp).Row\nRange(\"BL\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B67:H67\").Copy\nLastRow = Cells(Rows.Count, \"BM\").End(xlUp).Row\nRange(\"BM\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"BU\").End(xlUp).Row\nRange(\"BU\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B68:H68\").Copy\nLastRow = Cells(Rows.Count, \"BV\").End(xlUp).Row\nRange(\"BV\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"CD\").End(xlUp).Row\nRange(\"CD\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B69:H69\").Copy\nLastRow = Cells(Rows.Count, \"CE\").End(xlUp).Row\nRange(\"CE\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B58\").Copy  ' Copies the value of =Today() from a cell. Would be easier to just integrate today's date instead.\nLastRow = Cells(Rows.Count, \"CM\").End(xlUp).Row\nRange(\"CM\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nRange(\"B70:H70\").Copy\nLastRow = Cells(Rows.Count, \"CN\").End(xlUp).Row\nRange(\"CN\" &amp; LastRow + 1).PasteSpecial Paste:=xlPasteValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1545147616, "post_id": 53836405, "comment_id": 94520889, "body": "&quot;I cannot figure out...&quot; What steps have you taken and what have you discovered?"}, {"owner": {"reputation": 11, "user_id": 10806775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b09eb7a159c5ebc3389034a8300368?s=128&d=identicon&r=PG&f=1", "display_name": "J B", "link": "https://stackoverflow.com/users/10806775/j-b"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1545156317, "post_id": 53836405, "comment_id": 94525666, "body": "I have tried using the below, after the &quot;export activesheet as PDF block&quot;      With ActiveSheet         .ExportAsFixedFormat Type:=xlOpenXMLWorkbook, Filename:=PdfFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False   End With"}, {"owner": {"reputation": 11, "user_id": 10806775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b09eb7a159c5ebc3389034a8300368?s=128&d=identicon&r=PG&f=1", "display_name": "J B", "link": "https://stackoverflow.com/users/10806775/j-b"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1545156617, "post_id": 53836405, "comment_id": 94525817, "body": "I could get it to work using .Attachments.Add (file path) - putting this immediately after the .Attachments.Add PdfFile under prepare e-mail&quot;. This won&#39;t work because the file will be sent out to 3 different people and I&#39;m not sure they will have it on their desktop. If I tell them all to put it on their desktop is there a way to make it work?"}, {"owner": {"reputation": 11, "user_id": 10806775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b09eb7a159c5ebc3389034a8300368?s=128&d=identicon&r=PG&f=1", "display_name": "J B", "link": "https://stackoverflow.com/users/10806775/j-b"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1545156944, "post_id": 53836405, "comment_id": 94525970, "body": "I tried this after the &quot;Prepare email&quot; section. ThisWorkbook.Save source_file = ThisWorkbook.FullName myMail.Attachments.Add source_file"}, {"owner": {"reputation": 11, "user_id": 10806775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b09eb7a159c5ebc3389034a8300368?s=128&d=identicon&r=PG&f=1", "display_name": "J B", "link": "https://stackoverflow.com/users/10806775/j-b"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1545164679, "post_id": 53836405, "comment_id": 94529377, "body": "It also looks like you can&#39;t use a wildcard character in VBA for file path, is that correct? I was trying to create the attachment by adding .Attachments.Add (&quot;C:\\Users\\%USERNAME%\\Desktop\\FileName.xlsm&quot;). It seems like this would be the easiest way, if there is in fact a way to have it automatically insert the username of the person whose computer the file is on."}, {"owner": {"reputation": 11, "user_id": 10806775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b09eb7a159c5ebc3389034a8300368?s=128&d=identicon&r=PG&f=1", "display_name": "J B", "link": "https://stackoverflow.com/users/10806775/j-b"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1545169789, "post_id": 53836405, "comment_id": 94531380, "body": "I added in a command to save the file, so it will attach an Excel file with all of the updates. Additionally, I got it to attach to the email with  .Attachments.Add (&quot;C:\\Users\\&quot; &amp; Environ(&quot;Username&quot;) &amp; &quot;\\Desktop\\FileName.xlsm&quot;). Is there any way to get it to change the name to where it will input the Date in the file name. The PDF file does that."}, {"owner": {"reputation": 11, "user_id": 10806775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b09eb7a159c5ebc3389034a8300368?s=128&d=identicon&r=PG&f=1", "display_name": "J B", "link": "https://stackoverflow.com/users/10806775/j-b"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1545169882, "post_id": 53836405, "comment_id": 94531410, "body": "Also, is there a way to export/attach only the active worksheet instead of the entire Workbook?"}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 3, "last_activity_date": 1545200220, "creation_date": 1545200220, "answer_id": 53845550, "question_id": 53836405, "link": "https://stackoverflow.com/questions/53836405/vba-to-send-excel-worksheet-as-pdf-and-excel-file/53845550#53845550", "title": "VBA to send Excel Worksheet as PDF and Excel file", "body": "<p>You could save a worksheet as pdf file and email it as an attachment using the below code:</p>\n\n<pre><code>Sub Saveaspdfandsend()\nDim xSht As Worksheet\nDim xFileDlg As FileDialog\nDim xFolder As String\nDim xYesorNo As Integer\nDim xOutlookObj As Object\nDim xEmailObj As Object\nDim xUsedRng As Range\n\nSet xSht = ActiveSheet\nSet xFileDlg = Application.FileDialog(msoFileDialogFolderPicker)\n\nIf xFileDlg.Show = True Then\n   xFolder = xFileDlg.SelectedItems(1)\nElse\n   MsgBox \"You must specify a folder to save the PDF into.\" &amp; vbCrLf &amp; vbCrLf &amp; \"Press OK to exit this macro.\", vbCritical, \"Must Specify Destination Folder\"\n   Exit Sub\nEnd If\nxFolder = xFolder + \"\\\" + xSht.Name + \".pdf\"\n\n'Check if file already exist\nIf Len(Dir(xFolder)) &gt; 0 Then\n    xYesorNo = MsgBox(xFolder &amp; \" already exists.\" &amp; vbCrLf &amp; vbCrLf &amp; \"Do you want to overwrite it?\", _\n                      vbYesNo + vbQuestion, \"File Exists\")\n    On Error Resume Next\n    If xYesorNo = vbYes Then\n        Kill xFolder\n    Else\n        MsgBox \"if you don't overwrite the existing PDF, I can't continue.\" _\n                    &amp; vbCrLf &amp; vbCrLf &amp; \"Press OK to exit this macro.\", vbCritical, \"Exiting Macro\"\n        Exit Sub\n    End If\n    If Err.Number &lt;&gt; 0 Then\n        MsgBox \"Unable to delete existing file.  Please make sure the file is not open or write protected.\" _\n                    &amp; vbCrLf &amp; vbCrLf &amp; \"Press OK to exit this macro.\", vbCritical, \"Unable to Delete File\"\n        Exit Sub\n    End If\nEnd If\n\nSet xUsedRng = xSht.UsedRange\nIf Application.WorksheetFunction.CountA(xUsedRng.Cells) &lt;&gt; 0 Then\n    'Save as PDF file\n    xSht.ExportAsFixedFormat Type:=xlTypePDF, Filename:=xFolder, Quality:=xlQualityStandard\n\n    'Create Outlook email\n    Set xOutlookObj = CreateObject(\"Outlook.Application\")\n    Set xEmailObj = xOutlookObj.CreateItem(0)\n    With xEmailObj\n        .Display\n        .To = \"\"\n        .CC = \"\"\n        .Subject = xSht.Name + \".pdf\"\n        .Attachments.Add xFolder\n        If DisplayEmail = False Then\n            '.Send\n        End If\n    End With\nElse\n  MsgBox \"The active worksheet cannot be blank\"\n  Exit Sub\nEnd If\nEnd Sub\n</code></pre>\n\n<p>For more information, please refer to this link:</p>\n\n<p><a href=\"https://www.extendoffice.com/documents/excel/4412-excel-save-as-pdf-and-email.html\" rel=\"nofollow noreferrer\">How To Save A Worksheet As PDF File And Email It As An Attachment Through Outlook?</a></p>\n\n<p>If you want to attach the current worksheet as an excel file into the email as an attachment, please refer to the below code:</p>\n\n<pre><code>Option Explicit \n\nSub EmailandSaveCellValue() \n\n     'Variable declaration\n    Dim oApp As Object, _ \n    oMail As Object, _ \n    WB As Workbook, _ \n    FileName As String, MailSub As String, MailTxt As String \n\n     '*************************************************  ********\n     'Set email details; Comment out if not required\n    Const MailTo = \"some1@someone.com\" \n    Const MailCC = \"some2@someone.com\" \n    Const MailBCC = \"some3@someone.com\" \n    MailSub = \"Please review \" &amp; Range(\"Subject\") \n    MailTxt = \"I have attached \" &amp; Range(\"Subject\") \n     '*************************************************  ********\n\n     'Turns off screen updating\n    Application.ScreenUpdating = False \n\n     'Makes a copy of the active sheet and save it to\n     'a temporary file\n    ActiveSheet.Copy \n    Set WB = ActiveWorkbook \n    FileName = Range(\"Subject\") &amp; \" Text.xls\" \n    On Error Resume Next \n    Kill \"C:\\\" &amp; FileName \n    On Error Goto 0 \n    WB.SaveAs FileName:=\"C:\\\" &amp; FileName \n\n     'Creates and shows the outlook mail item\n    Set oApp = CreateObject(\"Outlook.Application\") \n    Set oMail = oApp.CreateItem(0) \n    With oMail \n        .To = MailTo \n        .Cc = MailCC \n        .Bcc = MailBCC \n        .Subject = MailSub \n        .Body = MailTxt \n        .Attachments.Add WB.FullName \n        .Display \n    End With \n\n     'Deletes the temporary file\n    WB.ChangeFileAccess Mode:=xlReadOnly \n    Kill WB.FullName \n    WB.Close SaveChanges:=False \n\n     'Restores screen updating and release Outlook\n    Application.ScreenUpdating = True \n    Set oMail = Nothing \n    Set oApp = Nothing \nEnd Sub\n</code></pre>\n\n<p>For more information, please refer to this link:</p>\n\n<p><a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=350\" rel=\"nofollow noreferrer\">Send Excel sheet as email attachment using worksheet data.</a></p>\n"}], "owner": {"reputation": 11, "user_id": 10806775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b09eb7a159c5ebc3389034a8300368?s=128&d=identicon&r=PG&f=1", "display_name": "J B", "link": "https://stackoverflow.com/users/10806775/j-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545200220, "creation_date": 1545147439, "question_id": 53836405, "link": "https://stackoverflow.com/questions/53836405/vba-to-send-excel-worksheet-as-pdf-and-excel-file", "title": "VBA to send Excel Worksheet as PDF and Excel file", "body": "<p>I found some coding to send my worksheet in an email as a pdf (I forgot what website it was on, so thank you if you created it on here!). I have been asked if I can include an excel version of the file in the email, along with the current pdf file (some people need it to copy and paste into other reports). Below is my current VBA. I cannot figure out how to also attach the current Worksheet as an excel file into the email as an attachment.</p>\n\n<p>Thanks for any help!</p>\n\n<pre><code>Sub AttachActiveSheetPDF()\n  Dim IsCreated As Boolean\n  Dim i As Long\n  Dim PdfFile As String, Title As String\n  Dim OutlApp As Object\n\n  ' Not sure for what the Title is\n  Title = Range(\"A1\")\n\n  ' Define PDF filename\n  PdfFile = ActiveWorkbook.FullName\n  i = InStrRev(PdfFile, \".\")\n  If i &gt; 1 Then PdfFile = Left(PdfFile, i - 1)\n  PdfFile = Format(Now(), \"MM-dd-yyyy\") &amp; \" File Name\" &amp; \".pdf\"\n\n  ' Export activesheet as PDF\n  With ActiveSheet\n    .PageSetup.PaperSize = xlPaperLegal\n    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=PdfFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n  End With\n\n  ' Use already open Outlook if possible\n  On Error Resume Next\n  Set OutlApp = GetObject(, \"Outlook.Application\")\n  If Err Then\n    Set OutlApp = CreateObject(\"Outlook.Application\")\n    IsCreated = True\n  End If\n  OutlApp.Visible = True\n  On Error GoTo 0\n\n  ' Prepare e-mail with PDF attachment\n  With OutlApp.CreateItem(0)\n\n' Prepare e-mail\n.Subject = \"Email Name \" &amp; Format(Now(), \"MM-dd-yyyy\")\n.To = \"xxx\" ' &lt;-- Put email of the recipient here\n.CC = \"\" ' &lt;-- Put email of 'copy to' recipient here\n.Body = \"All,\" &amp; vbLf &amp; vbLf _\n      &amp; \"xxx.\" &amp; vbLf &amp; vbLf _\n      &amp; \"Regards,\" &amp; vbLf _\n      &amp; Application.UserName &amp; vbLf &amp; vbLf\n.Attachments.Add PdfFile\n\n' Try to send\nOn Error Resume Next\n.Send\nApplication.Visible = True\nIf Err Then\n  MsgBox \"E-mail was not sent\", vbExclamation\nElse\n  MsgBox \"E-mail successfully sent\", vbInformation\nEnd If\nOn Error GoTo 0\n\n  End With\n\n  ' Delete PDF file\n  Kill PdfFile\n\n  ' Release the memory of object variable\n  Set OutlApp = Nothing\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1545147385, "post_id": 53836361, "comment_id": 94520760, "body": "The deletion should not occur for the ActiveCell, you need to make use of x to delete the row."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1545147711, "post_id": 53836361, "comment_id": 94520933, "body": "Also, when you delete you should start the loop backwards. From the end to the beginning."}], "answers": [{"comments": [{"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1545148386, "post_id": 53836602, "comment_id": 94521363, "body": "Excellent solution.  Better than mine."}, {"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "edited": false, "score": 0, "creation_date": 1545149788, "post_id": 53836602, "comment_id": 94522135, "body": "Thanks. I&#39;ve got an error: Runtime error 1004: Cannot use that command on overlapping selections. Any Idea what the problem might be?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1545150040, "post_id": 53836602, "comment_id": 94522276, "body": "you have criss-cross merging. Row and Columns Overlap. e.g. C6:D6 are merged and also K1:K10 are merged, you will get that error.. Get rid of cols first and then rows."}, {"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "edited": false, "score": 0, "creation_date": 1545150096, "post_id": 53836602, "comment_id": 94522310, "body": "Thanks. So shall I do rngDelete.EntireColumn.Delete first?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1545150150, "post_id": 53836602, "comment_id": 94522343, "body": "try it... don&#39;t be scared :) see what happens... either  it will work or you will learn something new. :)"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1545150311, "post_id": 53836602, "comment_id": 94522449, "body": "Ok. so in case of overlaps, you first to unmerge before you can alter the structure. Ask a new question. some one will help."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 7, "last_activity_date": 1566445913, "last_edit_date": 1566445913, "creation_date": 1545148066, "answer_id": 53836602, "question_id": 53836361, "link": "https://stackoverflow.com/questions/53836361/delete-rows-with-merged-cells/53836602#53836602", "title": "Delete rows with merged cells", "body": "<p>Find out all merged cell ranges, club them and delete in one go.</p>\n\n<hr>\n\n<pre><code>Sub DeleteRows()\n    Dim x As Range\n    Dim rngDelete As Range\n    For Each x In ActiveSheet.UsedRange\n        If x.MergeCells Then\n            If rngDelete Is Nothing Then\n                Set rngDelete = x\n            Else\n                Set rngDelete = Union(rngDelete, x)\n            End If\n        End If\n    Next\n    If Not rngDelete Is Nothing Then\n        rngDelete.EntireRow.Delete\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10798192"}, "is_accepted": false, "score": 1, "last_activity_date": 1545148188, "creation_date": 1545148188, "answer_id": 53836638, "question_id": 53836361, "link": "https://stackoverflow.com/questions/53836361/delete-rows-with-merged-cells/53836638#53836638", "title": "Delete rows with merged cells", "body": "<p>When deleting rows, always delete from the bottom up or a) you risk deleting the next cell you want to examine and b) you risk skipping over a row that comes up to take the place of a deleted row.</p>\n\n<pre><code>Sub DeleteRows()\n    Dim r as long, c as long\n\n    with ActiveSheet.UsedRange\n        'work backwards through the rows\n        For r = .rows.count to 1 step -1\n            'work forwards through the columns\n            For c = 1 to .columns.count\n                If .cells(r, c).MergeCells Then\n                    'once a merged cell is found, delete then go immediately to the next row\n                    .cells(r, c).EntireRow.Delete\n                    exit for\n                End If\n            next c\n        Next r\n    end with\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1545154732, "creation_date": 1545154732, "answer_id": 53838371, "question_id": 53836361, "link": "https://stackoverflow.com/questions/53836361/delete-rows-with-merged-cells/53838371#53838371", "title": "Delete rows with merged cells", "body": "<p>A quick way to do this is to find all the merged cells then delete them in one go: a good way to do this is to use a range.find using a cells 'format' as merged then combine the found ranges</p>\n\n<blockquote>\n  <p>The following code loops through merged ranges and creates a union then selects the entire rows</p>\n</blockquote>\n\n<pre><code>Sub SelectMerge()\n    Dim rng As Range, rngUnion As Range, Test As Range\n    Dim ws As Worksheet: Set ws = ActiveSheet\n\n    With Application.FindFormat\n        .Clear\n        .MergeCells = True\n    End With\n\n    With ws.UsedRange\n        Set rng = .Find(\"\", SearchFormat:=True)\n        Do\n            If Not rngUnion Is Nothing Then Set rngUnion = Application.Union(rng, rngUnion)\n            If rngUnion Is Nothing Then Set rngUnion = rng\n            If rng Is Nothing Then Exit Do\n            Set rng = .Find(\"\", After:=rng, SearchFormat:=True)\n        Loop While Application.Intersect(rng, rngUnion) Is Nothing\n    End With\n    If Not rngUnion Is Nothing Then rngUnion.EntireRow.Select 'rngUnion.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "accepted_answer_id": 53836602, "answer_count": 3, "score": 0, "last_activity_date": 1569084578, "creation_date": 1545147210, "last_edit_date": 1569084578, "question_id": 53836361, "link": "https://stackoverflow.com/questions/53836361/delete-rows-with-merged-cells", "title": "Delete rows with merged cells", "body": "<p>I found a procedure to highlight merged cells in an active sheet:</p>\n\n<p>I tried a <code>ActiveCell.EntireRow.Delete</code> statement to delete the row that is currently iterated over.</p>\n\n<pre><code>Sub DeleteRows()\n    Dim x As Range\n    For Each x In ActiveSheet.UsedRange\n        If x.MergeCells Then\n            x.Interior.ColorIndex = 8\n            ActiveCell.EntireRow.Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>I don't care about highlighting the merged cells. The goal is to delete any row that has a merged cell.</p>\n"}, {"tags": ["excel", "vba", "pasting"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1545144722, "post_id": 53835586, "comment_id": 94519211, "body": "Please read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?r=SearchResults&amp;s=1|268.2975\">how to avoid select</a>."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1545144866, "post_id": 53835586, "comment_id": 94519293, "body": "You need to use last row +1, there are multiple examples, just do a search for &quot;excel vba last row&quot;"}, {"owner": {"reputation": 7, "user_id": 10682123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7319dd07934ae3d34051f0ac573f32f2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/10682123/phil"}, "edited": false, "score": 0, "creation_date": 1545145164, "post_id": 53835586, "comment_id": 94519459, "body": "Thanks guys, I&#39;ll do some more research. Thanks for the link, SJR,"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1545146540, "post_id": 53835586, "comment_id": 94520291, "body": "You should start here: <a href=\"https://www.youtube.com//watch?v=c8reU-H1PKQ&amp;index=5&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a>"}, {"owner": {"reputation": 7, "user_id": 10682123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7319dd07934ae3d34051f0ac573f32f2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/10682123/phil"}, "edited": false, "score": 0, "creation_date": 1545238017, "post_id": 53835586, "comment_id": 94559227, "body": "Appreciate it, TinMan, thank you."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10682123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7319dd07934ae3d34051f0ac573f32f2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/10682123/phil"}, "edited": false, "score": 0, "creation_date": 1545146715, "post_id": 53835865, "comment_id": 94520380, "body": "Thanks Darren, works a treat! Thanks for taking the time."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1545145501, "creation_date": 1545145501, "answer_id": 53835865, "question_id": 53835586, "link": "https://stackoverflow.com/questions/53835586/macro-pasting-on-next-available-row/53835865#53835865", "title": "Macro pasting on next available row", "body": "<p>Is it always <code>B24:AQ24</code> that you're copying?  </p>\n\n<p>This will copy the range and paste onto the next blank row (based on data in column B) in \n<code>Sheet2</code> of <code>Sales - 2018.xlsx</code>.  </p>\n\n<p>It's a single line of code with a line continuation ( <code>_</code> ) at the end of the first line. </p>\n\n<pre><code>Public Sub Paste()\n\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"B24:AQ24\").Copy _\n        Workbooks(\"Sales - 2018.xlsx\").Worksheets(\"Sheet2\").Cells(Rows.Count, 2).End(xlUp).Offset(1)\n\nEnd Sub\n</code></pre>\n\n<p>To begin on row 3 just add a heading into cell <code>B2</code>.  </p>\n\n<p><code>ThisWorkbook</code> refers to the workbook containing the code.<br>\nYou may want to change this to <code>Workbooks(\"Invoice Company B Limited Partnership.xlsx\")</code> (which doesn't contain any code as it's <code>xlsx</code> rather than <code>xlsm</code>.)</p>\n"}], "owner": {"reputation": 7, "user_id": 10682123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7319dd07934ae3d34051f0ac573f32f2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/10682123/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579253379, "creation_date": 1545144543, "last_edit_date": 1579253379, "question_id": 53835586, "link": "https://stackoverflow.com/questions/53835586/macro-pasting-on-next-available-row", "title": "Macro pasting on next available row", "body": "<p>I have a macro copying data from one spreadsheet and I want to paste it to the next available row in a master spreadsheet. However, it is pasting over the last row that I populated. \nCurrently on row 620, I want it to paste on row 621 and then next time I run macro, row 622 and so on</p>\n\n<p>In 2019, I will begin at row 3 on new spreadsheet.</p>\n\n<pre><code>Sub Paste()\n'\n' Paste Macro\n'\n\n'\n    Range(\"B24:AQ24\").Select\n    Selection.copy\n    Windows(\"Sales  - 2018.xlsx\").Activate\n    ActiveWindow.SmallScroll Down:=3\n    Range(\"B620\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        True, Transpose:=False\n    Windows( _\n        \"Invoice Company B Limited Partnership.xlsx\" _\n        ).Activate\nEnd Sub\n</code></pre>\n\n<p>Not sure how to define next available row in the code. </p>\n\n<p>Thanks for reading.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10798192"}, "edited": false, "score": 2, "creation_date": 1545143310, "post_id": 53835037, "comment_id": 94518369, "body": "It is likely happening because you are looping through all shapes and one of the shapes is not a control. <i>&#39;Note If the shape isn&#39;t a control, the ControlFormat property fails.&#39;</i>"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1545143593, "post_id": 53835037, "comment_id": 94518533, "body": "@user10798192 Most probably. Is there any other way to retrieve the value of the shape directly?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1545143902, "post_id": 53835037, "comment_id": 94518690, "body": "Are you just interested in the Checkboxes?"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1545143993, "post_id": 53835037, "comment_id": 94518747, "body": "@TinMan My sheet has checkboxes shapes only, but some are Form and some are ActiveX."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545144319, "post_id": 53835037, "comment_id": 94518948, "body": "It might be better to use <code>Sheets(&quot;Sheet1&quot;)</code> to reference the correct sheet by tab name.  <code>Sheets(1)</code> references the first sheet in tab order which can be rearranged by the user (so can the tab name).... maybe better to use the sheet codename - <code>...In Sheet1.Shapes</code>.  The codename is the sheet name <i>not</i> in brackets in the VBE."}], "answers": [{"comments": [{"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1545144420, "post_id": 53835460, "comment_id": 94519006, "body": "Thanks for the answer. Problem is, this will only read the Checkboxes that are from Form Control, and it will ignore the ones from ActiveX."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1545144986, "post_id": 53835460, "comment_id": 94519345, "body": "@DGMS89 Use <code>Shape.Type</code> to get the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/office.msoshapetype\" rel=\"nofollow noreferrer\">MsoShapeType</a> first: <code>msoFormControl</code> for a Form Control, or <code>msoOLEControlObject</code> for an OLE Control Object."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1545145271, "post_id": 53835460, "comment_id": 94519507, "body": "@Chronocidal I did that to get both, but from there, there is the same error when trying to retrieve the value."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1545149787, "post_id": 53835460, "comment_id": 94522131, "body": "@DGMS89 Only a Shape of Type <code>msoFormControl</code> will have a <code>ControlFormat</code>.  For a Shape of <code>msoOLEControlObject</code>, the best I can do is <code>s.Parent.OLEObjects(s.Name).Object.Value</code> - can anyone refine that further?"}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 1, "last_activity_date": 1545144162, "creation_date": 1545144162, "answer_id": 53835460, "question_id": 53835037, "link": "https://stackoverflow.com/questions/53835037/active-error-438-when-retrieving-shape-value-with-vba/53835460#53835460", "title": "Active error 438 when retrieving shape value with VBA", "body": "<p>I think what you are looking for is the <code>FormControlType</code> property. I played around with your example and using intellisense found that property. Looking at the MS description they had the following example:</p>\n\n<pre><code>For Each s In Worksheets(1).Shapes\n    If s.Type = msoFormControl Then\n        If s.FormControlType = xlCheckBox Then _\n            s.ControlFormat.Value = False\n    End If\nNext\n</code></pre>\n\n<p>As noted by other commentors, the error that pops up is due to the code encountering shape objects which do not have the properties you are asking for. Then an error is produced.</p>\n"}, {"comments": [{"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1545145307, "post_id": 53835652, "comment_id": 94519524, "body": "Thanks for the answer. This does it for the ActiveX, but then it leaves out the Form Control. I am trying to do both at the same time."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 2, "last_activity_date": 1545146382, "last_edit_date": 1545146382, "creation_date": 1545144763, "answer_id": 53835652, "question_id": 53835037, "link": "https://stackoverflow.com/questions/53835037/active-error-438-when-retrieving-shape-value-with-vba/53835652#53835652", "title": "Active error 438 when retrieving shape value with VBA", "body": "<p>Excel wraps each ActiveX object in an OLEObject control, which is then wrapped in a Shape object.</p>\n\n<p>When iterating over the <code>Worksheets().Shapes</code> you will need to reference the <code>Shape..Object.Object.Value</code></p>\n\n<blockquote>\n<pre><code>ThisWorkbook.Sheets(4).Cells(i, 1).Value = cb.OLEFormat.Object.Object.Value\n</code></pre>\n</blockquote>\n\n<p>It would be more direct to loop over the <code>Worksheets().OLEObjects</code> collection.</p>\n\n<pre><code>Sub CheckboxLoop17_OLEObjects()\n    Dim ctrl As OLEObject\n    Dim i As Long\n\n    i = 1\n\n    'Loop through Checkboxes\n    For Each ctrl In ThisWorkbook.Sheets(1).OLEObjects\n        ThisWorkbook.Sheets(4).Cells(i, 1).Value = ctrl.Object.Value\n        ThisWorkbook.Sheets(4).Cells(i, 2).Value = ctrl.Name\n        ThisWorkbook.Sheets(4).Cells(i, 3).Value = ctrl.BottomRightCell.Address\n        ThisWorkbook.Sheets(4).Cells(i, 4).Value = ctrl.progID\n        i = i + 1\n    Next\nEnd Sub\n</code></pre>\n\n<p>If you have both Form and ActiveX controls then you will need to test what type you are working with.</p>\n\n<pre><code>Sub MixedFormsAndActiveX()\n    Dim sh As Shape\n    Dim i As Long\n    For Each sh In ThisWorkbook.Sheets(1).Shapes\n        i = i + 1\n        With ThisWorkbook.Sheets(4)\n            If sh.Type = msoOLEControlObject Then\n                .Cells(i, 1).Value = sh.OLEFormat.Object.Object.Value\n                .Cells(i, 4).Value = \"ActiveX Control: \" &amp; TypeName(sh.OLEFormat.Object.Object)\n            ElseIf sh.Type = msoFormControl Then\n                .Cells(i, 1).Value = sh.ControlFormat.Value\n                .Cells(i, 4).Value = \"Forms Control: \" &amp; TypeName(sh.ControlFormat)\n            End If\n            .Cells(i, 2).Value = sh.Name\n            .Cells(i, 3).Value = sh.BottomRightCell.Address\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1545150171, "post_id": 53836659, "comment_id": 94522351, "body": "Ooh, <code>Shape.OLEFormat.Object.Object.Value</code> - I&#39;ve never realised you needed that second <code>.Object</code>, and have always resorted to <code>Worksheet.OLEObjects(Shape.Name).Object.Value</code> instead.  So much code I can tidy up now &gt;_&lt;&#39;"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 4, "last_activity_date": 1545148261, "creation_date": 1545148261, "answer_id": 53836659, "question_id": 53835037, "link": "https://stackoverflow.com/questions/53835037/active-error-438-when-retrieving-shape-value-with-vba/53836659#53836659", "title": "Active error 438 when retrieving shape value with VBA", "body": "<p>Try</p>\n\n<pre><code>Sub CheckboxLoop17()\n\n    Dim cb As Shape\n    Dim i As Long\n    Dim s As String\n    Dim Ws As Worksheet, shpWs As Worksheet\n\n    Set shpWs = ThisWorkbook.Sheets(1)\n    Set Ws = ThisWorkbook.Sheets(4)\n    i = 1\n\n    'Loop through Checkboxes\n    With Ws\n      For Each cb In shpWs.Shapes\n\n        If cb.Type = msoFormControl Then\n            If cb.FormControlType = xlCheckBox Then\n                .Cells(i, 1).Value = cb.ControlFormat.Value\n                .Cells(i, 2).Value = cb.Name\n                .Cells(i, 3).Value = cb.BottomRightCell.Address\n                .Cells(i, 4).Value = cb.Type\n            End If\n        ElseIf cb.Type = 12 Then\n            s = cb.OLEFormat.progID\n            If s = \"Forms.CheckBox.1\" Then\n                .Cells(i, 1).Value = cb.OLEFormat.Object.Object.Value\n                .Cells(i, 2).Value = cb.Name\n                .Cells(i, 3).Value = cb.BottomRightCell.Address\n                .Cells(i, 4).Value = cb.Type\n            End If\n        End If\n        i = i + 1\n      Next cb\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 53836659, "answer_count": 3, "score": 0, "last_activity_date": 1579253490, "creation_date": 1545142750, "last_edit_date": 1579253490, "question_id": 53835037, "link": "https://stackoverflow.com/questions/53835037/active-error-438-when-retrieving-shape-value-with-vba", "title": "Active error 438 when retrieving shape value with VBA", "body": "<p>This question is a follow up to my 2 previous questions (<a href=\"https://stackoverflow.com/questions/53834046/retrieving-name-and-location-of-specific-shapes-from-worksheet-with-vba\">Retrieving name and location of specific Shapes from worksheet with VBA</a> and <a href=\"https://stackoverflow.com/questions/53830793/retrieving-information-of-oleobjects-from-workbook-with-vba\">Retrieving information of OLEObjects from Workbook with VBA</a>)</p>\n\n<p><strong>Scenario:</strong> I am trying to retrieve data from worksheet, including raw data and shapes (mostly checkboxes). I am using the following code to retrieve the checkboxes:</p>\n\n<pre><code>Sub CheckboxLoop17()\n\nDim cb As Shape\nDim i As Long\n\ni = 1\n\n'Loop through Checkboxes\n  For Each cb In ThisWorkbook.Sheets(1).Shapes\n    ThisWorkbook.Sheets(4).Cells(i, 1).Value = cb.ControlFormat.Value\n    ThisWorkbook.Sheets(4).Cells(i, 2).Value = cb.Name\n    ThisWorkbook.Sheets(4).Cells(i, 3).Value = cb.BottomRightCell.Address\n    ThisWorkbook.Sheets(4).Cells(i, 4).Value = cb.Type\n    i = i + 1\n  Next cb\n\nEnd Sub\n</code></pre>\n\n<p>When run, the code yields the Active error 438 in the line:</p>\n\n<pre><code>ThisWorkbook.Sheets(4).Cells(i, 1).Value = cb.ControlFormat.Value\n</code></pre>\n\n<p>Where I want to get any type of value representation from the checkbox (true/false, yes/no, 1/0...)</p>\n\n<p><strong>Question:</strong> Why is this error happening? How to fix this?</p>\n"}, {"tags": ["c#", "excel", "vba", "macos", "class-library"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1545143226, "post_id": 53834845, "comment_id": 94518319, "body": "There are a very large number of duplicates for this question.  Hard to pick the &quot;best&quot; when there are no happy answers.  Probably this one: <a href=\"https://stackoverflow.com/questions/41172984/office-excel-com-interop-on-mac-osx-using-net-core\" title=\"office excel com interop on mac osx using net core\">stackoverflow.com/questions/41172984/&hellip;</a>"}, {"owner": {"reputation": 378, "user_id": 10281603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9daa01ff0947be6d24ce1feee1d8130b?s=128&d=identicon&r=PG&f=1", "display_name": "Adas", "link": "https://stackoverflow.com/users/10281603/adas"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1545222906, "post_id": 53834845, "comment_id": 94550026, "body": "So this is not possible in any way even if I used another framework other than .net? @HansPassant"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1545223154, "post_id": 53834845, "comment_id": 94550152, "body": "You will not get a happy answer, no matter how often asking the question seems useful to you."}], "owner": {"reputation": 378, "user_id": 10281603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9daa01ff0947be6d24ce1feee1d8130b?s=128&d=identicon&r=PG&f=1", "display_name": "Adas", "link": "https://stackoverflow.com/users/10281603/adas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545142096, "creation_date": 1545142096, "question_id": 53834845, "link": "https://stackoverflow.com/questions/53834845/is-it-possible-to-create-a-excel-com-visible-class-library-to-use-in-mac-osx", "title": "Is it possible to create a Excel-COM visible class library to use in MAC OSX?", "body": "<p>I created this COM Visible DLL using c# that can be referenced from Excel VBA on Windows.</p>\n\n<p>Some users in our office also use excel on their MAC OS and they usually open up the same file from our shared directory to run the code. Is it possible to create a class library for Excel on MAC that is COM visible? </p>\n\n<p>If possible what is the best way to implement this?</p>\n"}]