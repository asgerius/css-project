[{"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427930703, "post_id": 29402407, "comment_id": 46980577, "body": "Measuring pixels is more than a little subjective in that results can vary and Excel row heights and column widths are no exception. Have you seen the following: <a href=\"http://tinyurl.com/nglfq5c\" rel=\"nofollow noreferrer\">Description of how column widths are determined in Excel</a>."}], "answers": [{"tags": [], "owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "is_accepted": false, "score": 2, "last_activity_date": 1427930634, "creation_date": 1427930634, "answer_id": 29402563, "question_id": 29402407, "link": "https://stackoverflow.com/questions/29402407/how-to-set-excel-column-widths-to-a-certain-number-of-pixels/29402563#29402563", "title": "How to set Excel column widths to a certain number of pixels?", "body": "<p>I'm sorry to tell you, but in my experience, you can't. Column width is measured in points, and whilst you can - in theory - convert points to pixels, Excel won't listen very precisely when you assign them. They also seem to vary somewhat from monitor to monitor. Basically, points are fractions of inches, pixels are dots on the screen. Windows has a notion (right or wrong) of how many pixels there are to a point given a particular output device.</p>\n\n<p>You <em>can</em> write a function that tweaks column width, but usually the approach has to be</p>\n\n<ul>\n<li>Find the smallest contextual value that excel is willing to increment a column width by (say, store the original value, then assign <code>.ColumnWidth = dblOriginal + 0.01</code>. Check if columnwidth has changed - if it has, you just made a 1-pixel adjustment. If it hasn't, you need a bigger number than 0.01.</li>\n<li>Find a final column width in pixels that you want, and repeat this first step until you've incremented the column width that many times.</li>\n<li>Check the result, and see if it looks OK.</li>\n</ul>\n\n<p>Word of warning: this is horrible, slow, and not good code, and if they've fixed column widths in versions of Excel after 2010, then you might be lucky and just be able to use a pixels-to-points function, convert and assign. There are some around, just in my experience they didn't give me consistent results on different screens on the same machine. Really weird that one.</p>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 5833148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ba5777afcd043e425324d2e69585d3e?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ertl", "link": "https://stackoverflow.com/users/5833148/thomas-ertl"}, "is_accepted": false, "score": 1, "last_activity_date": 1462633679, "last_edit_date": 1462633679, "creation_date": 1462616364, "answer_id": 37087279, "question_id": 29402407, "link": "https://stackoverflow.com/questions/29402407/how-to-set-excel-column-widths-to-a-certain-number-of-pixels/37087279#37087279", "title": "How to set Excel column widths to a certain number of pixels?", "body": "<p><code>.ColumnWidth</code> does not depend on theme font selection, but pixel width does: <a href=\"https://support.microsoft.com/en-us/kb/214123\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/214123</a></p>\n\n<pre><code>'pixel width of column A\nDebug.Print (Columns(\"A\").Width / 72) * ThisWorkbook.WebOptions.PixelsPerInch\n</code></pre>\n\n<p>After some reading and thinking, my solution:</p>\n\n<pre><code>Sub setColumnWidth(rColumnWidth As Range, iPixelWidth As Integer)\n    ' set column width by pixels\n\n    ' check status ScreenUpdating\n    Dim bScreenUpdatingState As Boolean\n    bScreenUpdatingState = Application.ScreenUpdating\n    ' set status ScreenUpdating\n    If bScreenUpdatingState = True Then Application.ScreenUpdating = False\n\n    Dim iPointsPerInch As Byte\n    iPointsPerInch = 72\n\n    Dim iPixelsPerInch As Byte\n    iPixelsPerInch = ThisWorkbook.WebOptions.PixelsPerInch\n\n    ' check 2 column widths: get iPointDelta\n    Dim rColumn As Range\n    Set rColumn = rColumnWidth.EntireColumn\n    rColumn.ColumnWidth = 1\n    Dim iPoint_1 As Single\n    iPoint_1 = rColumn.Width\n    rColumn.ColumnWidth = 2\n    Dim iPoint_2 As Single\n    iPoint_2 = rColumn.Width\n    Dim iPointDelta As Single\n    iPointDelta = iPoint_2 - iPoint_1\n\n    ' set column width to iPixelWidth\n    Dim iPoint_New As Single\n    iPoint_New = iPixelWidth / iPixelsPerInch * iPointsPerInch\n    Dim iChar_New As Single\n    iChar_New = (iPoint_New - (iPointDelta - 1.5)) / iPointDelta\n    rColumn.ColumnWidth = iChar_New\n\n    ' reset status ScreenUpdating\n    If bScreenUpdatingState = True Then Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>To run the sub <code>setColumnWidth</code>:</p>\n\n<pre><code>Sub call_setColumnWidth()\n    Dim r As Range\n    Set r = ActiveSheet.Range(\"C1\")\n    setColumnWidth r, 70\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9369, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1462633679, "creation_date": 1427929789, "last_edit_date": 1531161705, "question_id": 29402407, "link": "https://stackoverflow.com/questions/29402407/how-to-set-excel-column-widths-to-a-certain-number-of-pixels", "title": "How to set Excel column widths to a certain number of pixels?", "body": "<p>I have the following data set on a worksheet:</p>\n\n<pre><code>SheetName|ColumnIndex|Pixels\n---------+-----------+------\nabc      |1          |50\nabc      |2          |150\ndef      |1          |125\n</code></pre>\n\n<p>For each sheet, I'd like to set the column width to the appropriate number of pixels, using something like:</p>\n\n<pre><code>Sub setColumn (sheetName As string, columnIndex As long, pixels As long)\n    width=getWidthInCharacters(pixels)\n    ThisWorkbook.Sheets(sheetName).Cells(1, columnIndex).EntireColumn.ColumnWidth = width\nEnd Sub\n</code></pre>\n\n<p>I haven't been able to figure out how to write the <code>getWidthInCharacters()</code> function.  How do I convert pixels to characters, or possibly set <code>.ColumnWidth</code> to pixels directly?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427929842, "post_id": 29402144, "comment_id": 46980272, "body": "It seems likely that the problem is within <code>GetOpenFilename</code>. Put <code>Debug.Print inputFile</code> immediately after the assignment (e.g. <code>inputFile = GetOpenFilename</code>) and check the Immediate window (Ctrl+G) after the crash to see what is being reported."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427930272, "post_id": 29402144, "comment_id": 46980426, "body": "Have you tried <code>inputFile = Application.GetOpenFilename</code>  ?"}, {"owner": {"reputation": 115, "user_id": 4276332, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1252422897/picture?type=large", "display_name": "Angie Li", "link": "https://stackoverflow.com/users/4276332/angie-li"}, "edited": false, "score": 0, "creation_date": 1427930561, "post_id": 29402144, "comment_id": 46980535, "body": "The Immediate window doesn&#39;t show anything when I try this &quot;Sub Macro1() Dim inputFile As String, inputWb As Workbook     Dim lastRow As Long, row As Long, n As Long     Dim newCSV As Workbook  inputFile = GetOpenFilename Debug.Print inputFile  End Sub &quot;"}, {"owner": {"reputation": 115, "user_id": 4276332, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1252422897/picture?type=large", "display_name": "Angie Li", "link": "https://stackoverflow.com/users/4276332/angie-li"}, "edited": false, "score": 0, "creation_date": 1427930766, "post_id": 29402144, "comment_id": 46980594, "body": "Then I tried &quot;inputFile = Application.GetOpenFilename&quot;, it opens up finder to look for file. If I select my file, it shows error &quot;Open object failed&quot; and still highlight &quot;Set inputWb = Workbooks.Open(inputFile)&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427931220, "post_id": 29402144, "comment_id": 46980746, "body": "I&#39;m not trying to pass the buck when I say I suspect that by now you have corrupt temp files in your `%TEMP% folder. Restart the computer, tap the Windows key and type %TEMP% then hit enter. Delete everything you can from that folder. Some files may be in use but after a reboot you should be able to get an corrupt Excel temp images out of it."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4276332, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1252422897/picture?type=large", "display_name": "Angie Li", "link": "https://stackoverflow.com/users/4276332/angie-li"}, "edited": false, "score": 0, "creation_date": 1427930925, "post_id": 29402562, "comment_id": 46980647, "body": "I don&#39;t know if my path is wrong or what, &quot;/Users/annlll/Downloads/Workbook5.xlsx&quot; says could not be found."}, {"owner": {"reputation": 115, "user_id": 4276332, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1252422897/picture?type=large", "display_name": "Angie Li", "link": "https://stackoverflow.com/users/4276332/angie-li"}, "edited": false, "score": 0, "creation_date": 1427931443, "post_id": 29402562, "comment_id": 46980799, "body": "Alright, path problem is ok, but it ask me to open the file, but it&#39;s already open. If I say yes, then it opens again and my macro disappears, if I say no, it&#39;s still same error &quot;Open object failed&quot;"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1427930625, "creation_date": 1427930625, "answer_id": 29402562, "question_id": 29402144, "link": "https://stackoverflow.com/questions/29402144/split-every-5000-rows-with-header-into-multiple-new-sheets/29402562#29402562", "title": "Split every 5000 rows with header into multiple new sheets", "body": "<p>I suggest you skip the GetOpenFilename option and go for the other one - be specific in this format:  </p>\n\n<pre><code>\"C:\\Path\\To\\ABCDE.xlsx\"  \n</code></pre>\n\n<p>as detailed by John_w on <a href=\"http://www.mrexcel.com/forum/excel-questions/798404-macro-split-excel-file-multiple-csv-files-every-5000-lines.html\" rel=\"nofollow\">MrExcel.com</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7232150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcupK.gif?s=128&g=1", "display_name": "Scott Reilly", "link": "https://stackoverflow.com/users/7232150/scott-reilly"}, "is_accepted": false, "score": 0, "last_activity_date": 1480526644, "last_edit_date": 1480526644, "creation_date": 1480525665, "answer_id": 40894193, "question_id": 29402144, "link": "https://stackoverflow.com/questions/29402144/split-every-5000-rows-with-header-into-multiple-new-sheets/40894193#40894193", "title": "Split every 5000 rows with header into multiple new sheets", "body": "<p>just change it to ActiveWorkbook\nunless your planning on running it for a different workbook then the one your using.</p>\n\n<pre><code>Sub Macro1()\nDim inputFile As String, inputWb As Workbook\n    Dim lastRow As Long, row As Long, n As Long\n    Dim newCSV As Workbook\n\nWith ActiveWorkbook.Worksheets(1)\n    lastRow = .Cells(Rows.Count, \"A\").End(xlUp).row\n\n    Set newCSV = Workbooks.Add\n\n    n = 0\n    For row = 2 To lastRow Step 5000\n        n = n + 1\n        .Rows(1).EntireRow.Copy newCSV.Worksheets(1).Range(\"A1\")\n        .Rows(row &amp; \":\" &amp; row + 5000 - 1).EntireRow.Copy newCSV.Worksheets(1).Range(\"A2\")\n\n        'Save in same folder as input workbook with .xlsx replaced by (n).csv\n        newCSV.SaveAs Filename:=n &amp; \".csv\", FileFormat:=xlCSV, CreateBackup:=False\n    Next\nEnd With\n\nnewCSV.Close saveChanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>your problem is in the</p>\n\n<p>inputFile = GetOpenFilename</p>\n\n<p>Set inputWb = Workbooks.Open(inputFile)</p>\n\n<p>your not telling it what the getopenfilename is</p>\n\n<p>and there is no need to reopen </p>\n\n<p>use the ACtiveWorkbook </p>\n"}], "owner": {"reputation": 115, "user_id": 4276332, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1252422897/picture?type=large", "display_name": "Angie Li", "link": "https://stackoverflow.com/users/4276332/angie-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3909, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1596544653, "creation_date": 1427928347, "last_edit_date": 1427929303, "question_id": 29402144, "link": "https://stackoverflow.com/questions/29402144/split-every-5000-rows-with-header-into-multiple-new-sheets", "title": "Split every 5000 rows with header into multiple new sheets", "body": "<p>I was trying to use macro to split my spreadsheet into multiple new files for every 5000 rows and keep the header. I tried this code, but got error message \"<img src=\"https://i.stack.imgur.com/gy7Gx.png\" alt=\"enter image description here\"></p>\n\n<p>Code:</p>\n\n<pre><code> Sub Macro1()\nDim inputFile As String, inputWb As Workbook\n    Dim lastRow As Long, row As Long, n As Long\n    Dim newCSV As Workbook\n\ninputFile = GetOpenFilename\n\nSet inputWb = Workbooks.Open(inputFile)\n\nWith inputWb.Worksheets(1)\n    lastRow = .Cells(Rows.Count, \"A\").End(xlUp).row\n\n    Set newCSV = Workbooks.Add\n\n    n = 0\n    For row = 2 To lastRow Step 5000\n        n = n + 1\n        .Rows(1).EntireRow.Copy newCSV.Worksheets(1).Range(\"A1\")\n        .Rows(row &amp; \":\" &amp; row + 5000 - 1).EntireRow.Copy newCSV.Worksheets(1).Range(\"A2\")\n\n        'Save in same folder as input workbook with .xlsx replaced by (n).csv\n        newCSV.SaveAs Filename:=Replace(inputWb.FullName, \".xlsx\", \"(\" &amp; n &amp; \").csv\"), FileFormat:=xlCSV, CreateBackup:=False\n    Next\nEnd With\n\nnewCSV.Close saveChanges:=False\n    inputWb.Close saveChanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>Error highlighted from here according to \"Debug\":</p>\n\n<pre><code>Set inputWb = Workbooks.Open(inputFile)\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter"], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 2052624, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/14d2b168ced9abb2914c58d5ddaf29a5?s=128&d=identicon&r=PG", "display_name": "iontom", "link": "https://stackoverflow.com/users/2052624/iontom"}, "is_accepted": false, "score": 1, "last_activity_date": 1427989766, "creation_date": 1427989766, "answer_id": 29417169, "question_id": 29401677, "link": "https://stackoverflow.com/questions/29401677/how-do-i-set-data-table-filter-equal-to-pivot-table-filter/29417169#29417169", "title": "How do I set data table filter equal to pivot table filter", "body": "<p>Alright, this wasn't easy to find but the solution is pretty elegant:</p>\n\n<pre><code>With ActiveWorkbook\n    For Each oSi In OD_am.SlicerItems\n        On Error Resume Next\n        If OP_am.SlicerItems(oSi.Value).Selected &lt;&gt; OD_am.SlicerItems(oSi.Value).Selected Then\n            OD_am.SlicerItems(oSi.Value).Selected = OP_am.SlicerItems(oSi.Value).Selected\n        End If\n    Next\nEnd With\n</code></pre>\n\n<p>Pretty much a For loop comparing SlicerItems line by line. No need to explicitely name each part. I was worried that a slicer for  apivot table and for a normal table wouldn't communicate right - but it works!</p>\n\n<p>Thanks to references from this:\n<a href=\"http://www.jkp-ads.com/articles/slicers04.asp\" rel=\"nofollow\">http://www.jkp-ads.com/articles/slicers04.asp</a></p>\n"}], "owner": {"reputation": 423, "user_id": 2052624, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/14d2b168ced9abb2914c58d5ddaf29a5?s=128&d=identicon&r=PG", "display_name": "iontom", "link": "https://stackoverflow.com/users/2052624/iontom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525289464, "creation_date": 1427925921, "last_edit_date": 1427927441, "question_id": 29401677, "link": "https://stackoverflow.com/questions/29401677/how-do-i-set-data-table-filter-equal-to-pivot-table-filter", "title": "How do I set data table filter equal to pivot table filter", "body": "<p>I have two tables - one with raw data - the other is a pivot table. I need to be able to link the values, sometimes multiple values of the Data Table and the Pivot Table. Both have slicers and those slicers need to match.</p>\n\n<p>However, slicers are explicit in defining which values are True or False - I was hoping to use the filter function instead. Something like this:</p>\n\n<pre><code>Worksheets(\"Opportunity Details\").ListObjects(\"RawData\").Range.AutoFilter Field:=9, Criteria1:= _\n   Worksheets(\"PIVOTDATE\").PivotTables(\"OppPivot2\").PivotFields(\"Record Manager\").Range\n</code></pre>\n\n<p>Obviously this syntax doesn't work - I'm hoping there's some easy way to just set one equal to the other though.</p>\n"}, {"tags": ["excel", "vba", "loops", "variables"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1427923655, "post_id": 29401085, "comment_id": 46977990, "body": "It&#39;s not at all obvious that it doesn&#39;t work like this. What do you mean by &quot;It doesn&#39;t work&quot;? Do you get an error? If so, which line raises the error and what does the error message say? If no error, please describe how the observed results diverge from what you expect."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427923764, "post_id": 29401085, "comment_id": 46978040, "body": "You may want to do simply : <code>Destination:=querySheet.Cells(5, 1))</code> because adding each qt will automatically insert the column."}, {"owner": {"reputation": 23, "user_id": 4725249, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42683bc87bf0755f2ffa6492134f3f48?s=128&d=identicon&r=PG&f=1", "display_name": "StefanW", "link": "https://stackoverflow.com/users/4725249/stefanw"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427924210, "post_id": 29401085, "comment_id": 46978218, "body": "Thanks for your reply! VBA does not disply an error message, but the result that I get is just &quot;.cbt,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A&quot;. Before, when I just had one constant value for symb, I got something like &quot;CK15.cbt,376.25,&quot;3/31/2015&quot;,&quot;2:09pm&quot;,-18.25,394.00,398.50,3&zwnj;&#8203;75.75,302825&quot;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427924550, "post_id": 29401085, "comment_id": 46978341, "body": "There&#39;s something wrong with your URL string. When I enter that URL manually in my browser (Chrome) it downloads a CSV file which displays just the N/A as before. You&#39;re missing something in that string, which is causing the tables to return N/A values."}, {"owner": {"reputation": 23, "user_id": 4725249, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42683bc87bf0755f2ffa6492134f3f48?s=128&d=identicon&r=PG&f=1", "display_name": "StefanW", "link": "https://stackoverflow.com/users/4725249/stefanw"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427924916, "post_id": 29401085, "comment_id": 46978472, "body": "Yes, you are right! I adjusted that (I forgot a letter in the spreadsheet cells), and now the download works again. The problem that remains is that I only get the value from the last loop. Looks like the current loop overwrites the loop from before. Do you have an idea how to handle that?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427924956, "post_id": 29401085, "comment_id": 46978487, "body": "See my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4725249, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42683bc87bf0755f2ffa6492134f3f48?s=128&d=identicon&r=PG&f=1", "display_name": "StefanW", "link": "https://stackoverflow.com/users/4725249/stefanw"}, "edited": false, "score": 0, "creation_date": 1428442731, "post_id": 29401390, "comment_id": 47161781, "body": "Thanks! Is there a possibility that the querytable is not completed from right to left but from left to right? Right now it seems like every new cell pushes the value from the loop before to the right. That means, the value from the last loop is in A5, whereas the value from the first (out of 6 loops) is found in F5."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 23, "user_id": 4725249, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42683bc87bf0755f2ffa6492134f3f48?s=128&d=identicon&r=PG&f=1", "display_name": "StefanW", "link": "https://stackoverflow.com/users/4725249/stefanw"}, "edited": false, "score": 0, "creation_date": 1428443523, "post_id": 29401390, "comment_id": 47162144, "body": "Adding the QT will insert to existing data, which is why you&#39;re seeing what you&#39;re seeing. Without going back and trying the code again, try maybe: <code>Destination:=querySheet.Cells(5, i)</code>.  That should put the first one in Column 1, the second in Column 2, etc."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1427925011, "last_edit_date": 1427925011, "creation_date": 1427924644, "answer_id": 29401390, "question_id": 29401085, "link": "https://stackoverflow.com/questions/29401085/variable-that-contains-different-value-for-each-loop/29401390#29401390", "title": "Variable that contains different value for each loop", "body": "<p>There's something worng with your Connection String.  When I get rid of the <code>.cbt</code> in the URL string, it works. Or, you may have forgotten to include some letters, so debug it in your browser and get the Connection string correct and it should work.</p>\n\n<p>You may also want to modify the destination, like so, and refresh the table:</p>\n\n<pre><code>Set qt = querySheet.QueryTables.Add( _\nConnection:=\"URL;\" &amp; \"http://download.finance.yahoo.com/d/quotes.csv?s=\" &amp; Symb &amp; \"&amp;f=sl1d1t1c1ohgv&amp;e=.csv\", _\n    Destination:=querySheet.Cells(5, 1))\n    qt.Refresh\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4742412, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e2fd32c568551f14f97483aeecc56e14?s=128&d=identicon&r=PG", "display_name": "TT.", "link": "https://stackoverflow.com/users/4742412/tt"}, "is_accepted": false, "score": 0, "last_activity_date": 1427976841, "creation_date": 1427976841, "answer_id": 29412714, "question_id": 29401085, "link": "https://stackoverflow.com/questions/29401085/variable-that-contains-different-value-for-each-loop/29412714#29412714", "title": "Variable that contains different value for each loop", "body": "<p>you could use an array like this </p>\n\n<pre><code>    symb(1 to 10) as String\n    for i=1 to 10 \n        symb(i)=cells(i,1)\n    next i\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4725249, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42683bc87bf0755f2ffa6492134f3f48?s=128&d=identicon&r=PG&f=1", "display_name": "StefanW", "link": "https://stackoverflow.com/users/4725249/stefanw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 29401390, "answer_count": 2, "score": 0, "last_activity_date": 1427976841, "creation_date": 1427923345, "last_edit_date": 1427923766, "question_id": 29401085, "link": "https://stackoverflow.com/questions/29401085/variable-that-contains-different-value-for-each-loop", "title": "Variable that contains different value for each loop", "body": "<p>I would like to download prices from the internet. The concept works, when I define <code>symb</code> as a constant value (e.g. K15). But now, I want to download data from different links, where the part <code>symb</code> changes according to the value of the cells G13 to G22 in my spreadsheet. (In other words, I want to go through each row from G13 to G22 - each containing a different value for <code>symb</code> - and download the data from the respective link).</p>\n\n<p>I tried that with a simple loop, defining the variable <code>symb</code> in each one of the loops: </p>\n\n<pre><code>For i = 1 To 10\n\n    Symb = Worksheets(\"Futures\").Range(\"G12\").Offset(i, 0).Value\n\nSet qt = querysheet.QueryTables.Add( _\nConnection:=\"URL;\" &amp; \"http://download.finance.yahoo.com/d/quotes.csv?s=\" &amp; Symb &amp; \".cbt&amp;f=sl1d1t1c1ohgv&amp;e=.csv\", _\n    Destination:=querysheet.Cells(5 + i, 1))\n\nNext i\n</code></pre>\n\n<p>Obviously, it doesn't work like this. I assume that it is not possible to define a variable within the loop, is it? Can somebody give me a hint how I can make that work?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427922718, "post_id": 29400655, "comment_id": 46977574, "body": "I suspect that formula is not returning what you expect it to return. If you put that offset formula into a worksheet, it probably will return an error."}], "answers": [{"comments": [{"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 0, "creation_date": 1427923893, "post_id": 29400999, "comment_id": 46978092, "body": "<code>Set rngVs = Names(&quot;PenLineSelected&quot;).RefersToRange</code> This works! And thank you so much for the illustration! Just curious, what&#39;s the difference between the two methods of referencing ranges?"}, {"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 0, "creation_date": 1427924373, "post_id": 29400999, "comment_id": 46978285, "body": "oops, it works in debug mode, but when I tried to run the procedure, it returns an application-defined or object-defined error..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 0, "creation_date": 1427924939, "post_id": 29400999, "comment_id": 46978479, "body": "The assignment <code>Set rngVs = Name(...</code> raises the error? Or some other line raises the error?"}, {"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 1, "creation_date": 1427925853, "post_id": 29400999, "comment_id": 46978877, "body": "Oh, I found out it&#39;s something wrong with the range reference, thanks a lot!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1427923019, "creation_date": 1427923019, "answer_id": 29400999, "question_id": 29400655, "link": "https://stackoverflow.com/questions/29400655/method-range-of-object-global-failed-error-when-referencing-named-ranges/29400999#29400999", "title": "Method &#39;Range&#39; of object &#39;_Global&#39; failed error when referencing Named Ranges", "body": "<p>You may want to try:</p>\n\n<pre><code>Set rngVs = Names(\"PenLineSelected\").RefersToRange\n</code></pre>\n\n<p>If that still fails, then one likely cause of error: </p>\n\n<p>You have <code>-2</code> for the <code>cols</code> argument in your Offset function. If the <code>Address</code> function returns an address in columns A or B, this will raise a <code>#REF!</code> error.</p>\n\n<p>I put each part of the formula in its own cell just to see where it is failing.  Observe that a match in the 3rd column of C90:S90 will not cause an error:</p>\n\n<p><img src=\"https://i.stack.imgur.com/70wuk.png\" alt=\"enter image description here\"></p>\n\n<p>But if I change the search term to \"World\" (which will be found in column B), the Offset function will fail.</p>\n\n<p><img src=\"https://i.stack.imgur.com/MHw9K.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "accepted_answer_id": 29400999, "answer_count": 1, "score": 0, "last_activity_date": 1427923019, "creation_date": 1427921798, "question_id": 29400655, "link": "https://stackoverflow.com/questions/29400655/method-range-of-object-global-failed-error-when-referencing-named-ranges", "title": "Method &#39;Range&#39; of object &#39;_Global&#39; failed error when referencing Named Ranges", "body": "<p>I got a Method 'Range' of object '_Global' failed error when I'm trying to reference a workbook scope Named Range. I've referenced other Named ranges with the same code, and they all work fine. Only this particular range throws an error.</p>\n\n<p>The function for the named range is this</p>\n\n<p><code>=OFFSET(INDIRECT(ADDRESS(91,MATCH(Calculation!$G$89,Calculation!$C$90:$S$90,0),,,\"Calculation\")),,-2,1,5)</code></p>\n\n<p>I couldn't figure out what's the issue with this, could anyone help me out please? Thanks!</p>\n\n<p>This is the line that throws the error</p>\n\n<pre><code>Set rngVs = Range(\"'CAR Dashboard.xlsm'!PenLineSelected1Y\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1427922624, "post_id": 29400435, "comment_id": 46977524, "body": "Your cursory search is correct. Excel is not multi-threaded. While you can run concurrent <i>instances</i> of Excel, and each can run their own macros <i>separately</i>, what most people mean is that they want two or more threads to execute concurrently, in a single instance of the application, which is not possible."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1427927503, "post_id": 29400435, "comment_id": 46979477, "body": "Since excel does multi-threaded worksheet calculations, if you have two cells calling different (or the same) VBA function as a custom function would it still run single threaded? See <a href=\"https://msdn.microsoft.com/en-us/library/office/bb687899.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/bb687899.aspx</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1427935812, "post_id": 29400435, "comment_id": 46981895, "body": "@ja72 the answer is about <a href=\"https://msdn.microsoft.com/en-us/library/office/bb687899.aspx#xl2007xllsdk_threadsafe\" rel=\"nofollow noreferrer\">halfway down the page</a> you linked to: <i>No</i>. UDFs (whether in VBA, XLAM, or COM) are not thread-safe."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1427936063, "post_id": 29400435, "comment_id": 46981956, "body": "I knew there was a catch."}, {"owner": {"reputation": 135, "user_id": 4739921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc618e1d9340c04576d521df49f9963?s=128&d=identicon&r=PG", "display_name": "Andy Tam", "link": "https://stackoverflow.com/users/4739921/andy-tam"}, "edited": false, "score": 0, "creation_date": 1428283120, "post_id": 29400435, "comment_id": 47091318, "body": "Can I assume that one instance of Excel will not interfere with another instance of Excel?  Thanks!"}], "owner": {"reputation": 135, "user_id": 4739921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc618e1d9340c04576d521df49f9963?s=128&d=identicon&r=PG", "display_name": "Andy Tam", "link": "https://stackoverflow.com/users/4739921/andy-tam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1531, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1427923483, "creation_date": 1427921020, "last_edit_date": 1427923483, "question_id": 29400435, "link": "https://stackoverflow.com/questions/29400435/running-multiple-excel-macros-at-the-same-time", "title": "Running Multiple Excel Macros At the Same Time", "body": "<p>A cursory search on the web says that it is not possible.\nWhat I did was to open two Excel windows, running a macro in each one.\nIt seems to work, albeit they were not running as quickly.\nPerhaps the two windows were sharing resources...\nI'm fine with the slower speed, as long as each macro was running accurately. Can someone kindly confirm if running multiple macros in separate windows can be a problem?</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 360, "user_id": 3659875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d98f099cfc2bd6caa05978347c4f9c0d?s=128&d=identicon&r=PG", "display_name": "Madgui", "link": "https://stackoverflow.com/users/3659875/madgui"}, "is_accepted": false, "score": 1, "last_activity_date": 1427970675, "creation_date": 1427970675, "answer_id": 29410718, "question_id": 29400308, "link": "https://stackoverflow.com/questions/29400308/how-to-use-for-loop-to-populate-items-in-combo-box-using-visual-basic/29410718#29410718", "title": "How to use for loop to populate items in combo box using Visual Basic", "body": "<p>What Combobox are you talking about ?\nPerhaps this can help you ?</p>\n\n<pre><code>Const SEP As String = \",\"\nDim iIndex As Integer\nDim sList As String\n\nsList = 18\nFor iIndex = 19 To 100\n    sList = sList &amp; SEP &amp; iIndex\nNext\n\nCall Excel.ActiveCell.Validation.Add( _\n    Type:=Excel.XlDVType.xlValidateList, _\n    Formula1:=sList)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "edited": false, "score": 0, "creation_date": 1450311293, "post_id": 34320073, "comment_id": 56390828, "body": "Um, &quot;variable&quot; is not a valid built-in VBA type, and <code>Variant</code>s don&#39;t come as collections unless you set them to. This won&#39;t compile."}], "tags": [], "owner": {"reputation": 1, "user_id": 5688136, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a902b5c5276f694c1cb9b369e26dcd47?s=128&d=identicon&r=PG", "display_name": "muhammadhammad", "link": "https://stackoverflow.com/users/5688136/muhammadhammad"}, "is_accepted": false, "score": -2, "last_activity_date": 1450304512, "last_edit_date": 1450304512, "creation_date": 1450292658, "answer_id": 34320073, "question_id": 29400308, "link": "https://stackoverflow.com/questions/29400308/how-to-use-for-loop-to-populate-items-in-combo-box-using-visual-basic/34320073#34320073", "title": "How to use for loop to populate items in combo box using Visual Basic", "body": "<pre><code>dim n as integer\ndim new as variable\n\nfor n=18 to 100\n  new.additem n\nnext n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4739918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb44cee995616ae889ec476b9eebc6c0?s=128&d=identicon&r=PG&f=1", "display_name": "Abe Hindi", "link": "https://stackoverflow.com/users/4739918/abe-hindi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1409, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1450304512, "creation_date": 1427920630, "question_id": 29400308, "link": "https://stackoverflow.com/questions/29400308/how-to-use-for-loop-to-populate-items-in-combo-box-using-visual-basic", "title": "How to use for loop to populate items in combo box using Visual Basic", "body": "<p>I need a for loop to populate consecutive values 18 - 100 in a combo box using visual basic. Thanks!</p>\n"}, {"tags": ["excel", "vba", "dao", "adodb"], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 1308367, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ccc9e3fbc87fcb34e048149b88d208?s=128&d=identicon&r=PG", "display_name": "Rick Henderson", "link": "https://stackoverflow.com/users/1308367/rick-henderson"}, "edited": false, "score": 0, "creation_date": 1428352090, "post_id": 29425675, "comment_id": 47118706, "body": "Great information Rgo. I&#39;ll wait to see if I get more answers before selecting yours if you don&#39;t mind. I realize that my coding is probably &quot;old school&quot;. Will work on that."}, {"owner": {"reputation": 306, "user_id": 1308367, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ccc9e3fbc87fcb34e048149b88d208?s=128&d=identicon&r=PG", "display_name": "Rick Henderson", "link": "https://stackoverflow.com/users/1308367/rick-henderson"}, "edited": false, "score": 0, "creation_date": 1429235435, "post_id": 29425675, "comment_id": 47514763, "body": "I will however mention that I&#39;m not trying to pull Excel files into Access, I&#39;m trying to go the other way. So your answer doesn&#39;t really help."}], "tags": [], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "is_accepted": false, "score": 1, "last_activity_date": 1428030558, "creation_date": 1428030558, "answer_id": 29425675, "question_id": 29400020, "link": "https://stackoverflow.com/questions/29400020/though-deprecated-is-dao-still-used-for-automation-of-access-databases-from-exc/29425675#29425675", "title": "Though deprecated, is DAO still used for automation of Access databases from Excel?", "body": "<p>The simplest way to work with excel tables is to link them in Access either manually or via the TransferSpreadsheet function in VBA. If you use a generic naming standard for the file names and tab names in Excel, you will not have to relink, rather you can replace the Excel file and the Access link will read the new file unless the layout has changed.</p>\n\n<p>Once linked you can use the query-by-example tool to write your queries which also can be written into code (i.e. either embedded in the VBA [old school and not a best practice] or saved in an Access table then looked up and assigned to a variable for use with the CurrentDb.Execute strSQL, dbFailOnError command.</p>\n\n<p>I suggest manually linking the first go round so you can manually define the individual column types vs. letting Access mess it up. </p>\n\n<p>If you cannot use generic names and have to pick the file via a browse dialog, you can get a file browse function via Google to allow you to programatically link the file. (or you can rename it to a generic name which works even better)</p>\n\n<p>So DAO vs. ADODB is moot from an Access perspective. I supported 50 databases with 70,000+ lines of code and dozens of Excel source files the past 4 years and never had to ponder the question.</p>\n"}, {"comments": [{"owner": {"reputation": 306, "user_id": 1308367, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ccc9e3fbc87fcb34e048149b88d208?s=128&d=identicon&r=PG", "display_name": "Rick Henderson", "link": "https://stackoverflow.com/users/1308367/rick-henderson"}, "edited": false, "score": 0, "creation_date": 1444270681, "post_id": 32498402, "comment_id": 53835717, "body": "I agree Zev. I haven&#39;t gone back to it yet but I think I&#39;ll have to open a hidden Access instance."}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1441878361, "creation_date": 1441878361, "answer_id": 32498402, "question_id": 29400020, "link": "https://stackoverflow.com/questions/29400020/though-deprecated-is-dao-still-used-for-automation-of-access-databases-from-exc/32498402#32498402", "title": "Though deprecated, is DAO still used for automation of Access databases from Excel?", "body": "<p>Microsoft originally deprecated DAO in favor of ADO, but recently renamed DAO to Microsoft Access Engine (ACE) and is now pushing it as the preferred data access technology for Automation-supported environments (VBA, WSH etc.)</p>\n\n<p>In general, in your scenario I don't think it makes much of a difference which one you use. I suggest you read through <a href=\"http://www.utteraccess.com/wiki/index.php/Choosing_between_DAO_and_ADO\" rel=\"nofollow\">this</a>.</p>\n\n<p>I don't think it's possible to read table/query/field information via SQL. However, this can be done either with the DAO.TableDefs and DAO.QueryDefs collection, or the ADO.OpenSchema method.</p>\n\n<p>RE: forms/reports - I don't know if it's possible to read form/report information via DAO or ADO even without SQL, as it is actually part of the UI objects, and not the data; unless we're talking about reading/parsing the system tables. You may have to open the database in a hidden Access instance and read the forms/reports that way.</p>\n"}], "owner": {"reputation": 306, "user_id": 1308367, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ccc9e3fbc87fcb34e048149b88d208?s=128&d=identicon&r=PG", "display_name": "Rick Henderson", "link": "https://stackoverflow.com/users/1308367/rick-henderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441878361, "creation_date": 1427919704, "question_id": 29400020, "link": "https://stackoverflow.com/questions/29400020/though-deprecated-is-dao-still-used-for-automation-of-access-databases-from-exc", "title": "Though deprecated, is DAO still used for automation of Access databases from Excel?", "body": "<p>I'm trying to wrap my head around it. I've checked other questions and nothing seems to be too similar. </p>\n\n<p>The Office 2013 development centre contains extensive DAO examples and states it is one of the easiest ways to work with an Access file (does not require an Access window) but DAO is a deprecated technology. (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff834801.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff834801.aspx</a>) </p>\n\n<p>I'm trying to write an Excel Add-in (eventual end point) that will grade Access assignments in .accdb format.</p>\n\n<p>I'm can't just use ADODB to perform SQL queries to extract data, unless SQL can also do the following:</p>\n\n<ul>\n<li>check a specified report has a specified title</li>\n<li>check that specified tables, queries, forms, and reports exist</li>\n<li>check specific fields in a table exist</li>\n<li>check that specific fields have been set as the Primary Key</li>\n</ul>\n\n<p>I also need to check that certain values exist in a table, but those I can solve with SQL.</p>\n\n<p>So should I be using DAO or stick with ADODB? Remember, I'm using Excel, not programming in Access VBA.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1427920467, "post_id": 29400092, "comment_id": 46976365, "body": "What does male_count and female_count have in them"}, {"owner": {"reputation": 169, "user_id": 3637776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab40be5b629cd7739574a20c39287e?s=128&d=identicon&r=PG", "display_name": "Economist", "link": "https://stackoverflow.com/users/3637776/economist"}, "reply_to_user": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1427920674, "post_id": 29400092, "comment_id": 46976468, "body": "The number of male and female entries respectively, including the header."}], "tags": [], "owner": {"reputation": 169, "user_id": 3637776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab40be5b629cd7739574a20c39287e?s=128&d=identicon&r=PG", "display_name": "Economist", "link": "https://stackoverflow.com/users/3637776/economist"}, "is_accepted": false, "score": 0, "last_activity_date": 1427919978, "creation_date": 1427919978, "answer_id": 29400092, "question_id": 29399886, "link": "https://stackoverflow.com/questions/29399886/calculating-range-referencing-a-different-column/29400092#29400092", "title": "Calculating Range referencing a different column", "body": "<p>You should be able to modify this to make it work:</p>\n\n<pre><code>male_count = Application.WorksheetFunction.CountA(Worksheets(\"Sheet A\").Range(\"A1:A100\"))\nfemale_count = Application.WorksheetFunction.CountA(Worksheets(\"Sheet A\").Range(\"B1:B100\"))\n\nWorksheets(\"Sheet A\").Range(\"A1\").Copy\nWorksheets(\"code output\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\nWorksheets(\"Sheet A\").Range(\"A2:A\" &amp; male_count).Copy\nWorksheets(\"code output\").Range(\"B1\").PasteSpecial Paste:=xlPasteValues\n\nWorksheets(\"Sheet A\").Range(\"B1\").Copy\nWorksheets(\"code output\").Range(\"A\" &amp; male_count).PasteSpecial Paste:=xlPasteValues\n\nWorksheets(\"Sheet A\").Range(\"B2:B\" &amp; female_count).Copy\nWorksheets(\"code output\").Range(\"B\" &amp; male_count).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 110, "user_id": 4695744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-ZWK1GNVm3VE/AAAAAAAAAAI/AAAAAAAAIzA/W3kd_AxFWMQ/photo.jpg?sz=128", "display_name": "Anurag Singh", "link": "https://stackoverflow.com/users/4695744/anurag-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1427944987, "creation_date": 1427944987, "answer_id": 29404475, "question_id": 29399886, "link": "https://stackoverflow.com/questions/29399886/calculating-range-referencing-a-different-column/29404475#29404475", "title": "Calculating Range referencing a different column", "body": "<pre><code>   Sub Test()\n   Dim wb As Workbook\n   Set wb = ThisWorkbook\n   Dim ws As Worksheet\n   Set ws1 = wb.Sheets(\"Sheet1\") 'Rename Sheet1 to your sheet where source data is\n   Set ws2 = wb.Sheets(\"Sheet2\") 'Rename Sheet2 to your sheet where you want output\n   ws1.Activate\n   LastRow1 = Range(\"A\" &amp; Rows.Count).End(xlUp).Row 'Change Column Letter to where you have Male names\n   LastRow2 = Range(\"B\" &amp; Rows.Count).End(xlUp).Row 'Change Column Letter to where you have Femal names\n   Set MaleRng = ws1.Range(Cells(2, 1), Cells(LastRow1, 1))\n   Set FemaleRng = ws1.Range(Cells(2, 2), Cells(LastRow2, 2))\n   i = 1\n   For Each Male In MaleRng\n    ws2.Cells(i, 1) = \"Male\"\n    ws2.Cells(i, 2) = Male.Value\n    i = i + 1\n   Next\n   ws2.Activate\n   i = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n   j = i + 1\n   For Each Female In FemaleRng\n    ws2.Cells(j, 1) = \"Female\"\n    ws2.Cells(j, 2) = Female.Value\n    j = j + 1\n   Next\n\n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1427944987, "creation_date": 1427919129, "question_id": 29399886, "link": "https://stackoverflow.com/questions/29399886/calculating-range-referencing-a-different-column", "title": "Calculating Range referencing a different column", "body": "<pre><code>A.Range(A2 &amp; Lrow).Copy B.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 1)\nA.Cells(1,1).Copy B.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n</code></pre>\n\n<p>This is the code which copies the First heading and its corresponding Column</p>\n\n<pre><code>    Sheet A                                  Code Output\n\n  Male   Female                        Male      Mike        \n  Mike    Rose                         Female    John   \n  John    Kat                                    Bob\n  Bob     Lisa                                   Rose \n                                                 Kat\n                                                 Lisa\n                            Expected output\n\n                Male   Mike                    Male   Mike\n                       John                    Male   John\n                       Bob             OR      Male   Bob  \n                Female Rose                    Female Rose \n                       Kat                     Female Kat\n                       Lisa                    Female Lisa\n</code></pre>\n\n<p>Let me explain:  When I use the normal code that I use everytime for copy paste, I get <strong>Male and Female</strong> in <strong>consecutive Rows</strong> which is wrong as <strong>Female</strong> should start from <strong>Rose</strong> . I see that the only problem can be that the range I am using to offset the first column is found by going up, so compiler will go up till 2nd row in first while I want it to go till the last value in column B. Is any of this output possible ? </p>\n\n<pre><code>  B.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n</code></pre>\n\n<p>This is what I need to change I think But need help. Thanks.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 2706, "user_id": 4230650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xfm2v.jpg?s=128&g=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/4230650/marcel"}, "edited": false, "score": 0, "creation_date": 1427918181, "post_id": 29399604, "comment_id": 46975160, "body": "give us a screenshot of your data organization plz. and your own attempt in solving it;"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427918249, "post_id": 29399604, "comment_id": 46975197, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>"}, {"owner": {"reputation": 756, "user_id": 2551782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e8848dc22f8c2627708c435ae812dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Alo", "link": "https://stackoverflow.com/users/2551782/alo"}, "edited": false, "score": 1, "creation_date": 1427920789, "post_id": 29399604, "comment_id": 46976527, "body": "Can&#39;t screenshot my data, because is work stuff. However, I edited my question to give an example of what I&#39;m trying to do. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 756, "user_id": 2551782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e8848dc22f8c2627708c435ae812dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Alo", "link": "https://stackoverflow.com/users/2551782/alo"}, "edited": false, "score": 0, "creation_date": 1427920686, "post_id": 29399825, "comment_id": 46976476, "body": "Thank you. I don&#39;t think that&#39;s applicable to what I&#39;m trying to do though. I edited my question to include an example and be more specific about what I am trying to do. Thanks again!"}], "tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1427918846, "creation_date": 1427918846, "answer_id": 29399825, "question_id": 29399604, "link": "https://stackoverflow.com/questions/29399604/how-to-copy-to-cells-from-a-range-if-the-columns-to-the-right-match/29399825#29399825", "title": "How to copy to cells from a range if the columns to the right match?", "body": "<p>Assuming the new spreadsheet is called \"New\" and the old is called \"Old,\"  and assuming that the names appear in column A of each spreadsheet, starting in row 1, then use this formula in column B of the new spreadsheet:</p>\n\n<p>=iferror(vlookup(New!A1,Old!$A:$A,1,false),\"?????\")</p>\n\n<p>So your spreadsheet looks like this:</p>\n\n<pre><code>      A             B\n1    Coke         =iferror(vlookup(New!A1,Old!$A:$A,1,false),\"?????\")\n2    Pepsi        =iferror(vlookup(New!A2,Old!$A:$A,1,false),\"?????\")\n3    Sprite       =iferror(vlookup(New!A3,Old!$A:$A,1,false),\"?????\")\n4    asdfvasdl    =iferror(vlookup(New!A4,Old!$A:$A,1,false),\"?????\")\n5    Dr. Pepper   =iferror(vlookup(New!A5,Old!$A:$A,1,false),\"?????\")\n</code></pre>\n\n<p>and it should display like this:</p>\n\n<pre><code>      A             B\n1    Coke         Coke         \n2    Pepsi        Pepsi        \n3    Sprite       Sprite       \n4    asdfvasdl    ???????\n5    Dr. Pepper   Dr. Pepper   \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 756, "user_id": 2551782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e8848dc22f8c2627708c435ae812dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Alo", "link": "https://stackoverflow.com/users/2551782/alo"}, "edited": false, "score": 0, "creation_date": 1427921361, "post_id": 29400424, "comment_id": 46976884, "body": "Thanks. Please would you mind explaining a bit what this formula does?"}, {"owner": {"reputation": 756, "user_id": 2551782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e8848dc22f8c2627708c435ae812dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Alo", "link": "https://stackoverflow.com/users/2551782/alo"}, "edited": false, "score": 1, "creation_date": 1427922494, "post_id": 29400424, "comment_id": 46977459, "body": "Great thank you! I think I was confused because of the part ..Match(C2, ... Because I think it should be B2 instead. I changed it and it worked. Thanks!"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 0, "last_activity_date": 1427921728, "last_edit_date": 1427921728, "creation_date": 1427920980, "answer_id": 29400424, "question_id": 29399604, "link": "https://stackoverflow.com/questions/29399604/how-to-copy-to-cells-from-a-range-if-the-columns-to-the-right-match/29400424#29400424", "title": "How to copy to cells from a range if the columns to the right match?", "body": "<p>Assuming <code>ID</code> is in A1 on both sheets and that the <code>xx</code> indicate IDs to be replaced, please add a new ColumnA in Sheet 2 and in A2 there:  </p>\n\n<pre><code>=IF(ISNUMBER(B2),B2,INDEX(Sheet1!A:A,MATCH(C2,Sheet1!B:B,0)))  \n</code></pre>\n\n<p>copied down to suit.</p>\n\n<p>The first part <code>ISNUMBER(B2)</code> tests for a numeric ID in the data set that is a mixture of sound and corrupt. If that <em>is</em> a number <em>and</em> corrupt there may be no way to identify the corruption from the information provided.</p>\n\n<p>So if that test is passed accept the value from the corrupted sheet (ie B2).</p>\n\n<p>If however the test fails, then find the relevant <code>Name</code>'s location (for Row2 the relevant name is <code>Dog</code>) in the incomplete sheet (ie Row4) and use INDEX to lookup the value associated with <code>Dog</code> (to its left) in the incomplete sheet.  </p>\n"}], "owner": {"reputation": 756, "user_id": 2551782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e8848dc22f8c2627708c435ae812dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Alo", "link": "https://stackoverflow.com/users/2551782/alo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 29400424, "answer_count": 2, "score": 0, "last_activity_date": 1427921728, "creation_date": 1427918007, "last_edit_date": 1427920594, "question_id": 29399604, "link": "https://stackoverflow.com/questions/29399604/how-to-copy-to-cells-from-a-range-if-the-columns-to-the-right-match", "title": "How to copy to cells from a range if the columns to the right match?", "body": "<p>I looked for a solution for this using VLOOKUP and programmatically and I couldn't find it. I hope you guys can help.</p>\n\n<p>I have two spreadsheets with same headers and similar data. One is complete the other is not. The first column (lets call it \"ID\") of the completed spreadsheet messed up.</p>\n\n<p>I want to copy the values from the \"ID\" column of the incomplete version to the new version based on if the cell to the right of each (lets call it \"Names\") matches. </p>\n\n<p>To clarify, the algorithm or formula has to look through the column \"Names\" of the OLD (incomplete) version and if it finds a match in the NEW version, copy it to its left.</p>\n\n<p>I cannot just sort alphabetically and copy and paste, because the completed worksheet has some duplicates that may be needed.</p>\n\n<pre><code>EDIT: EXAMPLE OF MY DATA:\nSheet1                                    Sheet 2\nID      NAME                     ID           Name        Age       \n112     John                   156           Dog         11\n113     Bob                    1xx           Bob         15    \n156     Dog                    1xx           Bob         16 \n                               1xx           John        18\n</code></pre>\n\n<p>Since the ID is messed up (because the ID I work with got messed up when exporting from Google Fusion Tables) I need to copy to the NEW file the \"Ids\" from the OLD version. This is just a simple example, I have over 200 000 rows of data.</p>\n"}, {"tags": ["vba", "ms-word", "bookmarks"], "answers": [{"tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1452261559, "creation_date": 1452261559, "answer_id": 34678819, "question_id": 29399446, "link": "https://stackoverflow.com/questions/29399446/vba-to-delete-bookmark-when-criteria-not-met-in-word-document/34678819#34678819", "title": "VBA to delete bookmark when Criteria not met in word document", "body": "<p>I know this is an old post, but this should get you what you need:</p>\n\n<pre><code>Option Explicit\n\nSub ManageBookmarks()\n\nDim wdApp   As Object\nDim wdDoc   As Object\nDim wdName  As String\nDim wdTemp  As Object\nDim ws      As Worksheet\nDim LastRow As Long\nDim i       As Long\n\nSet ws = ActiveSheet\nwdName = \"C:\\Test.docx\" 'Your file path here\n\nOn Error Resume Next\nSet wdApp = GetObject(, \"Word.Application\")\n\nIf wdApp Is Nothing Then\n    On Error GoTo 0\n    Set wdApp = CreateObject(\"Word.Application\")\n    Set wdDoc = wdApp.Documents.Open(wdName)\n    wdApp.Visible = True\nElse\n    On Error GoTo 0\n    For Each wdTemp In wdApp.Documents\n        If StrComp(wdTemp.FullName, wdName, vbTextCompare) = 0 Then\n            Set wdDoc = wdTemp\n            Exit For\n        End If\n    Next wdTemp\n    If wdDoc Is Nothing Then\n        Set wdDoc = wdApp.Documents.Open(wdName)\n    End If\nEnd If\n\nWith ws\n    LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    For i = 1 To LastRow\n        If .Cells(i, 1).Value = 1 Then\n            If wdDoc.Bookmarks.Exists(\"sai\" &amp; i) = True Then\n                wdDoc.Bookmarks(\"sai\" &amp; i).Delete\n            End If\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This code assumes that your list of zeros and ones are in column A starting in row 1.</p>\n\n<p>Put this code in your Excel file, set your worksheet to what you want, add your file name for <code>wdName</code> and you should be all set.</p>\n"}], "owner": {"reputation": 15, "user_id": 4253339, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1641393239/picture?type=large", "display_name": "Dave Johnson", "link": "https://stackoverflow.com/users/4253339/dave-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452261559, "creation_date": 1427917484, "last_edit_date": 1452012412, "question_id": 29399446, "link": "https://stackoverflow.com/questions/29399446/vba-to-delete-bookmark-when-criteria-not-met-in-word-document", "title": "VBA to delete bookmark when Criteria not met in word document", "body": "<p>I have a Word document where I have bookmarked lines of text - say 10 lines each. I have 6 of these texts lines on different pages of the word document, so I have a total of 6 bookmarks in the entire Word document. Now given certain criteria in Excel, say if Coulmn A1:A6 have:</p>\n\n<pre><code>0,1,1,1,0,1\n</code></pre>\n\n<p>Where IF cell A1 is 0 delete first bookmark named sai1, sai1.delete, If cell A2 is 1 dont delete bookmark named sai2 , if cell A3 is 1 dont delete, but if 0 delete and so on and so forth; essentially what i want is a loop to do this for 100+ some bookmarks given 100+ criteria in excel, it might be more. I could not find an easier way beside if-else statement. I will really appreciate the help.\nhere is my code so far:</p>\n\n<pre><code>Set wtb1 = wdd.Bookmarks(\"D043\").Range\nSet wtb2 = wdd.Bookmarks(\"D044\").Range\nSet wtb3 = wdd.Bookmarks(\"D018\").Range\nSet wtb4 = wdd.Bookmarks(\"D046\").Range\nIf Sheets(\"CPA\").Cells(426, 7).Value = 0 Then\n         wtb1.Delete\n         ElseIf Sheets(\"CPA\").Cells(427, 7).Value = 0 Then\n               wtb2.Delete\n         ElseIf Sheets(\"CPA\").Cells(428, 7).Value = 0 Then\n               wtb3.Delete\n         ElseIf Sheets(\"CPA\").Cells(429, 7).Value = 0 Then\n               wtb4.Delete\nEnd If\n</code></pre>\n\n<p>Is there a For loop method to tackle this? I also tried doing this:</p>\n\n<pre><code> For k = 426 To 429\n If Sheets(\"CPA\").Cells(k, 7).Value = 0 Then\n\n     'Sheets(\"CPA\").Cells(i, 10) = Sheets(\"CPA\").Cells(i, 9).Value\n     Value1 = Sheets(\"CPA\").Cells(426, 9).Value\n     Value1(i).Text.Delete\n     i = i + 1\n     End If\n Next\n</code></pre>\n"}, {"tags": ["vba", "excel", "worksheet"], "comments": [{"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1427926132, "post_id": 29399443, "comment_id": 46978983, "body": "Have you tried any code that we can help you on it? - Please add your tries to your question."}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "reply_to_user": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1427982751, "post_id": 29399443, "comment_id": 47001833, "body": "@shA.t: I have a code I am about to share with you, I am unable to read the names of the columns and then copy data accordingly. I have been able to figure out copy data in the next empty cell."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427982985, "post_id": 29413134, "comment_id": 47001980, "body": "I really appreciate the help, but just like previous user if you would have asked if I had a code, you would not have to be so disappointed in my style of asking questions. I am sorry but I am new to the website and I appreciate you calling me out, and I will make sure I add my code right away when I ask the question so you don&#39;t perceive me wrong. Thanks!"}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427988345, "post_id": 29413134, "comment_id": 47005445, "body": "this is a great solution you have provided, I have made the changes as per the needs and also understood what you did and why. But I am getting stuck at one spot. Where you define the constants and I can number the columns according to their placement on the sheet, I would like to be able to read the column header name and then select and copy data. I tried to define the &quot;Const&quot; as String instead of Long, and mentioned the name of column header, it seem to not work. Is there another way where I can make that kind of functionality work, because the placement of columns keep changing."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427993443, "post_id": 29413134, "comment_id": 47008492, "body": "@AnkitShah.  New function added that should meet your needs.  I have more complicated variations if necessary."}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1428346794, "post_id": 29413134, "comment_id": 47116148, "body": "I am still working on the solution that you have provided, I am not sure if I am doing something wrong, because after the adjustments as suggested, I still cannot make it run and provide me the answer I am looking for. It does not return an error, it runs, but does not do anything on the sheets. I have found a way around to be able to make a pivot table in a sheet and select only certain columns, set it is a tabular form and copy it from there. But of course it is not the most efficient and now I am curious as to why I cannot make this work. Thanks for all the pointers, still working :)"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1428356685, "post_id": 29413134, "comment_id": 47121055, "body": "@AnkitShah  If you look at my profile you will find an email address.  If you email me a workbook, I will look at it."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 0, "last_activity_date": 1427993390, "last_edit_date": 1427993390, "creation_date": 1427978107, "answer_id": 29413134, "question_id": 29399443, "link": "https://stackoverflow.com/questions/29399443/copy-data-from-one-sheet-to-another-same-workbook-with-same-column-names-not/29413134#29413134", "title": "Copy data from one sheet to another (same workbook) with same column names (not necessarily same order)", "body": "<p>This is not a good question for Stack Overflow.  This site is for programmers to help one another develop.  Your question reads as: \u201cI want a macro to do this.  Write it for me.\u201d  Not a popular style of question.</p>\n\n<p>Top right of this page you will find a Help button.  You will find lots of good, but general, advice behind it.  In this answer I will try to give more specific advice.</p>\n\n<p>You must learn the basics of VBA.  You could have answered this question yourself with very little knowledge.  A few hours spent on study will quickly be repaid.  Search the web for \u201cExcel VBA tutorial\u201d.  There are many to choose from.  Try a few and complete the one that is closest to your learning style.  I prefer books.  I visited a good library; reviewed their Excel VBA Primers; borrowed the most promising to try at home before buying the one I considered to be best as a permanent reference book.</p>\n\n<p>This site is not a good place to ask design questions.  You need to break your requirement down its little steps.  There are lots questions and answers here that address the individual steps of your total requirement but, as far as I know, not one that matches your complete requirement.</p>\n\n<p>You can often create a simple design just by thinking through how you would solve this problem manually:</p>\n\n<ol>\n<li>Find the last used cell in column Data of worksheet Master.  Call the cell below the last used cell: Target.</li>\n<li>Find the last used cell in column Data of worksheet Data.</li>\n<li>Select from the first data cell down to the last cell.</li>\n<li>Copy the selection to cell Target.</li>\n<li>Repeat the above steps for column Data1.</li>\n</ol>\n\n<p>There are VBA statements that are the equivalent of steps 1 to 4.  You can select and copy as separate steps in VBA but this is not good practice; there is a VBA statement that combines them which is faster and neater.</p>\n\n<p>There are several VBA statements that allow you to repeat (loop) blocks of code with different parameters to achieve slightly different effects.</p>\n\n<p>Doesn\u2019t that look easier already?  Instead of a vague description, we have a series of easy steps.  I would expect any tutorial to explain how to perform these steps within the first few pages.  In my code I use a few techniques that may not be at the beginning of a tutorial.  I explain why I use them.  For extra information, search for \u201cExcel VBA function array\u201d or \u201cExcel VBA constants\u201d or similar.  Come back with questions if necessary but the more you can discover for yourself, the faster you will develop.</p>\n\n<p>Welcome to the joys of programming.</p>\n\n<pre><code>Option Explicit\n\n  ' * I have a system of naming my variabls that I have used for years. I can\n  '   look at macros I wrote years ago and immediately know what all the\n  '   variables. I am not asking you to like my system but to develop your own\n  '   system.\n  ' * My naming system using a sequence of words that get more and precise\n  '   until I have a unique name.  The first word what the variable is being\n  '   used for. \"Col\" means its associated with columns of a worksheet or a\n  '   two-dimensional array. If I have multiple worksheets and/or arrays, the\n  '   next word identifies whch worksheet or array.  If I have multiple\n  '   columns, the next word identifies which column.\n  ' * Constants make code easier to read and easiest to maintain. Instead of a\n  '   literal, such as 2, you have a meaningful name, ColDataData.  Columns\n  '   can be identified by code or number: A=1, B=2, C=3 and so on. I have used\n  '   numbers which I normally find more convenient although I could have used\n  '   codes here.\n\n  Const ColDataData As Long = 2\n  Const ColDataData1 As Long = 4\n  Const ColMasterData As Long = 1\n  Const ColMasterData1 As Long = 2\n  Const RowDataFirstData As Long = 2  ' Adjust according to how many header\n                                      ' rows you have in worksheet \"Data\"\n\nSub AddToMasterColumn()\n\n  Dim ColDataCrnt As Long\n  Dim ColMasterCrnt As Long\n  Dim ColsData() As Variant\n  Dim ColsMaster() As Variant\n  Dim InxCols As Long\n  Dim Rng As Range\n  Dim RowDataLast As Long\n  Dim RowMasterTgt As Long\n  Dim WshtData As Worksheet\n  Dim WshtMaster As Worksheet\n\n  ' * Processing for your two sets of columns is the same so we can use a loop\n  '   with parameters so says which pair of columns each loop is to handle.\n  ' * Array() is a convenient way to load an array although the array must be\n  '   variant.  Since I am loading different data types (String and Long) to\n  '   the same array, this is required anyway.\n  ' * These two arrays MUST have the same number of elements.\n  ColsData = Array(ColDataData, ColDataData1)\n  ColsMaster = Array(ColMasterData, ColMasterData1)\n\n  ' Debug.Assert is a convenient way of testing for program errors during\n  ' development. If UBound(ColsData) and UBound(ColsMaster) are not equal,\n  ' execution will stop here.\n  Debug.Assert UBound(ColsData) = UBound(ColsMaster)\n\n  ' I could have used Worksheets(\"Data\") where ever I use WshtData below.\n  ' Using WshtData is slightly faster and, in my view, neater. If you change\n  ' names of one of the worksheets, one change here will fix the macro.\n  Set WshtData = Worksheets(\"Data\")\n  Set WshtMaster = Worksheets(\"MasterData\")\n\n  For InxCols = LBound(ColsData) To UBound(ColsData)\n\n    With WshtMaster\n      ' Get the destination column in worksheet Master for the current loop\n      ColMasterCrnt = ColsMaster(InxCols)\n      ' Find the last used row in ColMasterCrnt and add one to it to get the target cell\n      RowMasterTgt = .Cells(Rows.Count, ColMasterCrnt).End(xlUp).Row + 1\n    End With\n\n    With WshtData\n      ' Get the source column in worksheet data for the current loop\n      ColDataCrnt = ColsData(InxCols)\n      ' Find the last used row in ColDataCrnt\n      RowDataLast = .Cells(Rows.Count, ColDataCrnt).End(xlUp).Row\n      ' Specify the range to be copied\n      Set Rng = .Range(.Cells(RowDataFirstData, ColDataCrnt), .Cells(RowDataLast, ColDataCrnt))\n    End With\n\n    ' Copy data\n    Rng.Copy Destination:=WshtMaster.Cells(RowMasterTgt, ColMasterCrnt)\n\n  Next\n\nEnd Sub\n</code></pre>\n\n<p><strong>Additon in response to extra requirement</strong></p>\n\n<p>I believe <code>Function FindColumnByName()</code> does all that you require.  I have more complicated variations which I can provide if necessary.  For example I have a variation that searches for multi-row headings.  But let us start simple.</p>\n\n<p>You will need to delete:</p>\n\n<pre><code>Const ColDataData As Long = 2\nConst ColDataData1 As Long = 4\nConst ColMasterData As Long = 1\nConst ColMasterData1 As Long = 2\n</code></pre>\n\n<p>and add at the top of AddToMasterColumn:</p>\n\n<pre><code>Dim ColDataData As Long:\nDim ColDataData1 As Long\nDim ColMasterData As Long\nDim ColMasterData1 As Long\n</code></pre>\n\n<p>and add after WshtData and and WshtMaster are set:</p>\n\n<pre><code>ColDataData = FindColumnByName(WshtData, \u201cData\u201d)\nColDataData1 = FindColumnByName(WshtData, \u201cData1\u201d)\nColMasterData = FindColumnByName(WshtMaster, \u201cData\u201d)\nColMasterData1 = FindColumnByName(WshtMaster, \u201cData2\u201d)\n</code></pre>\n\n<p>The test routine <code>TestFCBN</code> shows techniques that might be useful or might be confusing at this stage of your development.  Have a quick look but ignore it until later if it you have any difficulty understanding it.  With my test worksheets it outputs:</p>\n\n<pre><code>Column 2 of worksheet Data is named Data\nColumn 4 of worksheet Data is named Data1\nThere is no column named X in worksheet Data\nColumn 1 of worksheet MasterData is named Data\nColumn 2 of worksheet MasterData is named Data1 \n</code></pre>\n\n<p>New code:</p>\n\n<pre><code>Sub TestFCBN()\n\n  Dim ColName As String\n  Dim ColTgt As Long\n  Dim InxTV As Long\n  Dim TestValues As Variant\n  Dim WshtName As String\n\n  TestValues = Array(\"Data\", \"Data\", \"Data\", \"Data1\", \"Data\", \"X\", _\n                     \"MasterData\", \"Data\", \"MasterData\", \"Data1\")\n  ' There must be an even number of values in TestValues.  The first of each\n  ' pair is the name of a worksheet, the second the name of a column in that\n  ' worksheet.\n\n  For InxTV = LBound(TestValues) To UBound(TestValues) Step 2\n\n    WshtName = TestValues(InxTV)\n    ColName = TestValues(InxTV + 1)\n    ColTgt = FindColumnByName(Worksheets(WshtName), ColName)\n    If ColTgt = 0 Then\n      Debug.Print \"There is no column named \" &amp; ColName &amp; \" in worksheet \" &amp; WshtName\n    Else\n      Debug.Print \"Column \" &amp; ColTgt &amp; \" of worksheet \" &amp; WshtName &amp; _\n                  \" is named \" &amp; ColName\n    End If\n\n  Next\n\nEnd Sub\nFunction FindColumnByName(Wsht As Worksheet, ColName As String) As Long\n\n  ' This function scans row 1 for a cell with a value of ColName.\n  ' If found, it returns the number of that column.\n  ' If not found, it returns 0\n\n  Dim ColCrnt As Long\n  Dim ColLast As Long\n\n  With Wsht\n    ColLast = .Cells(1, Columns.Count).End(xlToLeft).Column\n    For ColCrnt = 1 To ColLast\n      If .Cells(1, ColCrnt).Value = ColName Then\n        FindColumnByName = ColCrnt\n        Exit Function\n      End If\n    Next\n  End With\n\n  FindColumnByName = 0\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2717, "favorite_count": 1, "accepted_answer_id": 29413134, "answer_count": 1, "score": 1, "last_activity_date": 1427993390, "creation_date": 1427917477, "last_edit_date": 1531164843, "question_id": 29399443, "link": "https://stackoverflow.com/questions/29399443/copy-data-from-one-sheet-to-another-same-workbook-with-same-column-names-not", "title": "Copy data from one sheet to another (same workbook) with same column names (not necessarily same order)", "body": "<p>I have two columns <code>Data</code> and <code>Data1</code>, on worksheet named \"<code>Data</code>\". I have same column names on sheet named \"<code>MasterData</code>\". I want to read the stuff on \"<code>Data</code>\" worksheet and copy to \"<code>MasterData</code>\" based on the column names (<code>Data</code> &amp; <code>Data1</code>). Also, let's say I have 10 data points that I copied over to \"<code>MasterData</code>\", next time I want to keep that data there, but copy new data from sheet \"<code>Data</code>\" to \"<code>MasterData</code>\", by checking for the 1st empty cell (which in this case would be Cell Number 11) in specific column. This would need to go on as \"<code>MasterData</code>\" would store all the historical data.</p>\n\n<pre><code>Sub CopyDatatoMasterData2()\n\n    Range(\"A2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Range(\"A\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n\n    Range(\"B2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"B\").End(xlUp).Row\n    Range(\"B\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n\n    Range(\"C2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"C\").End(xlUp).Row\n    Range(\"C\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"D2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"D\").End(xlUp).Row\n    Range(\"D\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Range(\"E2\").Select\n    Sheets(\"Data\").Select\n    Range(\"E2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"E\").End(xlUp).Row\n    Range(\"E\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Range(\"F2\").Select\n    Sheets(\"Data\").Select\n\n    Range(Selection, Selection.End(xlDown)).Select\n\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"F\").End(xlUp).Row\n    Range(\"F\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"G2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"G\").End(xlUp).Row\n    Range(\"G\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n\n    Range(\"H2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"H\").End(xlUp).Row\n    Range(\"H\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n\n    Range(\"I2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"I\").End(xlUp).Row\n    Range(\"I\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"J2\").Select\n\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"J\").End(xlUp).Row\n    Range(\"J\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"K2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"K\").End(xlUp).Row\n    Range(\"K\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"L2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"L\").End(xlUp).Row\n    Range(\"L\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"M2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"M\").End(xlUp).Row\n    Range(\"M\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"N2:N3\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"N\").End(xlUp).Row\n    Range(\"N\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"O2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"O\").End(xlUp).Row\n    Range(\"O\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"P2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"P\").End(xlUp).Row\n    Range(\"P\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n    Sheets(\"Data\").Select\n    Range(\"Q2:Q3\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"MasterData\").Select\n\n    lMaxRows = Cells(Rows.Count, \"Q\").End(xlUp).Row\n    Range(\"Q\" &amp; lMaxRows + 1).Select\n\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427916968, "post_id": 29399205, "comment_id": 46974465, "body": "Great question, and interesting research to back it up! Unfortunately, I have a feeling it will be closed as OT.  :("}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427917384, "post_id": 29399205, "comment_id": 46974674, "body": "what is OT? I hope it&#39;s not closed, I really need an answer to this. I&#39;ve looked all over the web."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427917569, "post_id": 29399205, "comment_id": 46974795, "body": "OT = Off topic. Since it&#39;s not related to programming or code, some may vote to close it. I&#39;d be fascinated to find you why this is, too."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1427917625, "post_id": 29399205, "comment_id": 46974830, "body": "<code>xlsm</code> is a zip archive. Rename to <code>test.zip</code>, open with an archive browser and see what&#39;s taking the space."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1427917814, "post_id": 29399205, "comment_id": 46974933, "body": "@FreeMan well <i>On Topic</i> is also &quot;OT&quot; ;)"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427917969, "post_id": 29399205, "comment_id": 46975023, "body": "@FreeMan, I am looking for VBA to reduce file size of WB Object. The only way this could ever be done is programmatically."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1427918160, "post_id": 29399205, "comment_id": 46975142, "body": "@Mat&#39;sMug OP is <i>Occupation Pottery</i>, but most people consider it <i>Original Poster</i>... :P"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1427918195, "post_id": 29399205, "comment_id": 46975164, "body": "@GSerg I can see it&#39;s a bunch of xml stuff like theme1.xml styles.xml etc. Is there some VBA to get rid of this stuff?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1427918510, "post_id": 29399205, "comment_id": 46975325, "body": "@JohnsonJason <a href=\"https://msdn.microsoft.com/en-us/library/aa982683(v=office.12).aspx#Office2007ManipulatingXMLDocs_manipulating\" rel=\"nofollow noreferrer\">Here&#39;s how</a> you do it properly. No, it&#39;s not VBA. I guess you can remove unused styles manually from the XMLs if they are what takes most space."}], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1427919678, "post_id": 29399866, "comment_id": 46975959, "body": "Here is the before and after LipoSuction2 MYWORKBOOK Ver0.34 test.xlsm      368,718 Bytes Wb Object     360,282 Bytes AFTER: MYWORKBOOK Ver0.34 test.xlsm      368,718 Bytes Wb Object     360,281 Bytes"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 1, "creation_date": 1427919774, "post_id": 29399866, "comment_id": 46976005, "body": "I think it knocked off about 1KB but I still have a totally empty workbook with only 1 sheet and this thing is 368KB. Any other ideas?  What is the WB Object? How can I kill it??"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1427920045, "post_id": 29399866, "comment_id": 46976161, "body": "I would definitely rename it to a zip file and crack it open to see what the individual files have in them compared to an empty book, if you do this, please post back, I am extremely keen to know the answer :)."}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 1, "creation_date": 1427920953, "post_id": 29399866, "comment_id": 46976648, "body": "looks like it&#39;s mostly coming from vbaProject.bin (inside an &quot;xl&quot; folder) but I haven&#39;t added any more text or anything. So I am not sure what makes it grow simply by deleting all the sheets. It&#39;s storing something in there, history or a log or something. I want it deleted!!!"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1427921690, "post_id": 29399866, "comment_id": 46977076, "body": "Excel is horrible at cleaning up after itself, I think this may be another example of it :). Perhaps when you delete a sheet the space is not cleared out from the sheet object. Thanks for posting the info back :)"}, {"owner": {"reputation": 418, "user_id": 4645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/228705acd43eb2c65b8ee34bf81a3a8c?s=128&d=identicon&r=PG&f=1", "display_name": "hpf", "link": "https://stackoverflow.com/users/4645385/hpf"}, "edited": false, "score": 1, "creation_date": 1427948306, "post_id": 29399866, "comment_id": 46984672, "body": "Isn&#39;t vbaProject.bin just the macros in the workbook?  I assume the macro you posted in your question is stored in ThisWorkbook. If so, that might be what&#39;s taking up the room.  Delete the macro and see if it helps?"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1427949500, "post_id": 29399866, "comment_id": 46984959, "body": "Also houses the sheet level macros which i believe may be what is not being freed up when the sheets are deleted."}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 418, "user_id": 4645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/228705acd43eb2c65b8ee34bf81a3a8c?s=128&d=identicon&r=PG&f=1", "display_name": "hpf", "link": "https://stackoverflow.com/users/4645385/hpf"}, "edited": false, "score": 0, "creation_date": 1427985140, "post_id": 29399866, "comment_id": 47003339, "body": "@hpf There is something extra being packed into the vbaProject.bin file. For example I deleted EVERY sheet and EVERY macro/module yet still have 60KB packed into that single file. 60KB of what?? That file seems to grow with each use of the file. I want in there, and I want to clean it out. Any ideas?"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 1, "creation_date": 1427994752, "post_id": 29399866, "comment_id": 47009180, "body": "IF this helps anyone I found this <a href=\"http://www.appspro.com/Utilities/CodeCleaner.htm\" rel=\"nofollow noreferrer\">appspro.com/Utilities/CodeCleaner.htm</a> I am not sure what its doing but it seems to strip down some of the the vbaProject.bin file but I tested on my no macro(blank) 66KB file and it didn&#39;t clean it back down to a fresh 17 Kb. I think it only cleans the actual VBA code part and not whatever other junk is getting stuffed into the vbaProject.bin file. It&#39;s a start though."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1427919024, "creation_date": 1427919024, "answer_id": 29399866, "question_id": 29399205, "link": "https://stackoverflow.com/questions/29399205/what-goes-into-the-excel-workbook-object-that-increases-file-size/29399866#29399866", "title": "What goes into the Excel Workbook object that increases file size?", "body": "<p>For file reduction I use code but in your case I don't see that it will help based on what you have posted. I would be very keen to see the contents of the zip file per GSergs suggestion.</p>\n\n<p>Here is my file reduction code if you want to try it but like I said, I don't see that it will get it as small as you are hoping but it's worth a try:</p>\n\n<pre><code>Sub LipoSuction2()\n'Written by Daniel Donoghue 18/8/2009\n'The purpose of this code is to offer an alternative to the original Liposuction code written by JBeaucaire for the MrExcel forums www.mrexcel.com\nDim ws As Worksheet\nDim CurrentSheet As String\nDim OldSheet As String\nDim Col As Long\nDim r As Long\nDim BottomrRow As Long\nDim EndCol As Long\n'Begin addition 6/4/2010 for request: http://www.mrexcel.com/forum/showthread.php?p=2269274#post2269274\nDim Pic As Object\n'End Addition 6/4/2010 for request: http://www.mrexcel.com/forum/showthread.php?p=2269274#post2269274\nFor Each ws In Worksheets\n    ws.Activate\n    'Put the sheets in a variable to make it easy to go back and forth\n    CurrentSheet = ws.Name\n    'Rename the sheet to its name with TRMFAT at the end\n    OldSheet = CurrentSheet &amp; \"TRMFAT\"\n    ws.Name = OldSheet\n    'Add a new sheet and call it the original sheets name\n    Sheets.Add\n    ActiveSheet.Name = CurrentSheet\n    Sheets(OldSheet).Activate\n    'Find the bottom cell of data on each column and find the further row\n    For Col = 1 To Columns.Count 'Find the REAL bottom row\n        If Cells(Rows.Count, Col).End(xlUp).Row &gt; BottomRow Then\n            BottomRow = Cells(Rows.Count, Col).End(xlUp).Row\n        End If\n    Next\n    'Find the end cell of data on each row that has data and find the furthest one\n    For r = 1 To BottomRow 'Find the REAL most right column\n        If Cells(r, Columns.Count).End(xlToLeft).Column &gt; EndCol Then\n            EndCol = Cells(r, Columns.Count).End(xlToLeft).Column\n        End If\n    Next\n    'Copy the REAL set of data\n    Range(Cells(1, 1), Cells(BottomRow, EndCol)).Copy\n    Sheets(CurrentSheet).Activate\n    'Paste everything\n    Range(\"A1\").PasteSpecial xlPasteAll\n    'Paste Column Widths\n    Range(\"A1\").PasteSpecial xlPasteColumnWidths\n    'Begin addition 6/4/2010 for request: http://www.mrexcel.com/forum/showthread.php?p=2269274#post2269274\n    Sheets(OldSheet).Activate\n    For Each Pic In ActiveSheet.Pictures\n        Pic.Copy\n        Sheets(CurrentSheet).Paste\n        Sheets(CurrentSheet).Pictures(Pic.Index).Top = Pic.Top\n        Sheets(CurrentSheet).Pictures(Pic.Index).Left = Pic.Left\n    Next\n    Sheets(CurrentSheet).Activate\n    'End Addition 6/4/2010 for request: http://www.mrexcel.com/forum/showthread.php?p=2269274#post2269274\n    'Reset the variable for the next sheet\n    BottomRow = 0\n    EndCol = 0\nNext\n'Excel will automatically replace the sheet references for you on your formulas, the below part puts them back\n'This is done with a simple reaplce, replacing TRMFAT with nothing\nFor Each ws In Worksheets\n    ws.Activate\n    Cells.Replace \"TRMFAT\", \"\"\nNext\n'Poll through the sheets and delete the original bloated sheets\nFor Each ws In Worksheets\n    If Not Len(Replace(ws.Name, \"TRMFAT\", \"\")) = Len(ws.Name) Then\n        Application.DisplayAlerts = False\n        ws.Delete\n        Application.DisplayAlerts = True\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12061153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ae7b0e33a8d8b10cf1df8652ca5565f?s=128&d=identicon&r=PG&f=1", "display_name": "scriptkiddie", "link": "https://stackoverflow.com/users/12061153/scriptkiddie"}, "is_accepted": false, "score": 0, "last_activity_date": 1568343124, "creation_date": 1568343124, "answer_id": 57916739, "question_id": 29399205, "link": "https://stackoverflow.com/questions/29399205/what-goes-into-the-excel-workbook-object-that-increases-file-size/57916739#57916739", "title": "What goes into the Excel Workbook object that increases file size?", "body": "<p>I found some excel workbooks that had imported too much data resulting in worksheets with over 16k columns &amp; 65k rows - Couldn't operate - found a way to delete columns &amp; rows - trick was to start at the end, work backwards &amp; save along the way. reduced filesize from 3mb to 125k.. Code below - read, test, and use at your own risks...</p>\n\n<pre><code>Function delsht()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.CutCopyMode = False\n\nSheet3.AutoFilterMode = False\nDoEvents\nDebug.Print Sheet3.UsedRange.Address\n  '  c = psht.UsedRange.Columns(psht.UsedRange.Columns.Count).Column\n  '  For i = c To 1500 Step -500\n  '          psht.Range(Columns(i), Columns(i - 500)).Delete\n  '          DoEvents\n  '          ActiveWorkbook.Save\n  '          Debug.Print i, Time()\n  '  Next i\nr = Sheet3.UsedRange.Rows(Sheet3.UsedRange.Rows.Count).Row\nFor i = r To 2000 Step -500\n        Sheet3.Range(Rows(i), Rows(i - 500)).Delete\n        DoEvents\n        ActiveWorkbook.Save\n        Debug.Print i, Time()\nNext i\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nDebug.Print \"done.\"\nEnd Function\nFunction bloatfinder()\nDim sht As Worksheet\nFor Each sht In Application.ActiveWorkbook.Sheets\nDebug.Print sht.Name, sht.UsedRange.Address,\nc = sht.UsedRange.Columns(sht.UsedRange.Columns.Count).Column\nr = sht.UsedRange.Rows(sht.UsedRange.Rows.Count).Row\nDebug.Print \"  Rows:\", r, \"Cols:\", c\nNext\nSet sht = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1506, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1568343124, "creation_date": 1427916542, "last_edit_date": 1427917246, "question_id": 29399205, "link": "https://stackoverflow.com/questions/29399205/what-goes-into-the-excel-workbook-object-that-increases-file-size", "title": "What goes into the Excel Workbook object that increases file size?", "body": "<p>I am trying to reduce the file size of an Excel workbook I am using. I already know about unused rows being an issue and unnecessary images etc. The mystery is why there is a secret part of excel that only seems to grow? </p>\n\n<p>I can discover the total size of my entire document with</p>\n\n<pre><code>    Sub workbook_objectsize()\n    With CreateObject(\"Scripting.FileSystemObject\")\n          Set wb = ActiveWorkbook\n          WBObjectSize = .GetFile(wb.fullname).Size\n          MsgBox (Format(WBObjectSize, \"#,##0\") &amp; \" Bytes\")\n    End With\n    End Sub\n</code></pre>\n\n<p>and I can discover the size by sheet and the WB Object using </p>\n\n<pre><code>      Sub GetSheetSizes()\n      ' ZVI:2012-05-18 Excel VBA File Size by Worksheet in File\n      ' CAR:2014-10-07 Enhanced to take hidden and very hidden sheets into account\n\n        Dim a() As Variant\n        Dim Bytes As Double\n        Dim i As Long\n        Dim fileNameTmp As String\n        Dim wb As Workbook\n        Dim visState As Integer\n\n        Set wb = ActiveWorkbook\n        ReDim a(0 To wb.Sheets.Count, 1 To 2)\n\n        ' Turn off screen updating\n        Application.ScreenUpdating = False\n        On Error GoTo exit_\n\n        ' Put names into a(,1) and sizes into a(,2)\n        With CreateObject(\"Scripting.FileSystemObject\")\n          ' Build the temporary file name\n          Err.Clear\n          fileNameTmp = .GetSpecialFolder(2) &amp; \"\\\" &amp; wb.Name &amp; \".TMP\"\n          ' Put workbook's name and size into a(0,)\n          a(0, 1) = wb.Name\n          a(0, 2) = .GetFile(wb.fullname).Size\n          ' Put each sheet name and its size into a(i,)\n          For i = 1 To wb.Sheets.Count\n            visState = wb.Sheets(i).Visible\n            wb.Sheets(i).Visible = -1 ' Show sheet long enough to copy it\n            DoEvents\n            wb.Sheets(i).Copy\n\n            ActiveWorkbook.SaveCopyAs fileNameTmp\n\n            wb.Sheets(i).Visible = visState\n            a(i, 1) = wb.Sheets(i).Name\n            a(i, 2) = .GetFile(fileNameTmp).Size\n            Bytes = Bytes + a(i, 2)\n            ActiveWorkbook.Close False\n          Next\n          Kill fileNameTmp\n        End With\n\n        ' Show workbook's name &amp; size\n        Debug.Print a(0, 1), Format(a(0, 2), \"#,##0\") &amp; \" Bytes\"\n\n        ' Show workbook object's  size\n        Debug.Print \"Wb Object\", Format(a(0, 2) - Bytes, \"#,##0\") &amp; \" Bytes\"\n\n        ' Show each sheet name and its size\n        For i = 1 To UBound(a)\n          Debug.Print a(i, 1), Format(a(i, 2), \"#,##0\") &amp; \" Bytes\"\n        Next\n\n      exit_:\n\n        ' Restore screen updating\n      Application.ScreenUpdating = True\n\n    ' Show the reason of error if happened\n       If Err Then MsgBox Err.Description, vbCritical, \"Error\"\n\n\n    End Sub\n</code></pre>\n\n<p>Here is the exercise. I have MYWORKBOOK</p>\n\n<p><strong>step 1.</strong> check total file size and file size by sheet + wb object</p>\n\n<pre><code>      MYWORKBOOK Ver0.34 test.xlsm      932,450 Bytes Total\n      Wb Object     201,679 Bytes\n      Home          312,904 Bytes\n      NISI_DETAIL   40,815 Bytes\n      DATABASE      49,186 Bytes\n      Settings      13,690 Bytes\n      NISI_LIST     27,484 Bytes\n      PleaseWait    21,232 Bytes\n      success       22,077 Bytes\n      Brands        34,721 Bytes\n      USER_LIST     26,819 Bytes\n      QUERY_LIST    37,880 Bytes\n      CAT_MAN_TOOLS 88,406 Bytes\n      Sheet1        9,997 Bytes\n      PROMO_LIST    45,560 Bytes\n</code></pre>\n\n<p><strong>step 2.</strong> DELETE ALL SHEETS leaving only a new blank sheet1 and check again</p>\n\n<pre><code>      MYWORKBOOK Ver0.34 test .xlsm     370,052 Bytes\n      Wb Object     361,589 Bytes\n      Sheet1        8,463 Bytes\n</code></pre>\n\n<p>Yes file size was reduced but thats because I deleted every sheet. However, this mysterious Wb Object actually got larger. What the hell??? nothing but a single blank sheet and a 370Kb file?????\nBTW running this same test on a new workbook yeilds a Wb Object size of 0 Bytes.</p>\n\n<p><strong>TL;DR: What on earth is the Wb Object in the example above? Why does it keep growing? How can I reduce it back down to 0 Bytes?</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1427915550, "post_id": 29398850, "comment_id": 46973711, "body": "Can you let us know which line you get the error on?"}, {"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1427916146, "post_id": 29398850, "comment_id": 46974001, "body": "Hi, sorry about the confusion. This is the line I got error, <code>ActiveChart.FullSeriesCollection(33).Name = &quot;=Calculation!$B$91&quot;</code>, I also updated this in the post. Thanks"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1427916415, "post_id": 29398850, "comment_id": 46974142, "body": "This may be a shot in the dark, but what if you go with...<code>ActiveChart.FullSeriesCollection(33).Name = Worksheets(&quot;Calculation&quot;).Range(&quot;B91&quot;)</code>"}, {"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1427916710, "post_id": 29398850, "comment_id": 46974337, "body": "it still throws the same error...I tried both <code>Worksheets(&quot;Calculation&quot;).Range(&quot;B91&quot;)</code> and <code>Worksheets(&quot;Calculation&quot;).Range(&quot;B91&quot;).Value</code>"}, {"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1427918414, "post_id": 29398850, "comment_id": 46975277, "body": "I figured out the error is because when it runs the <code>.setsourcedata </code> line draws columns and rows in the opposite. The code works after I added <code>ActiveChart.PlotBy = xlRows</code>"}], "owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1322, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1427921254, "creation_date": 1427915336, "last_edit_date": 1427921254, "question_id": 29398850, "link": "https://stackoverflow.com/questions/29398850/add-new-series-invalid-parameter-error", "title": "Add new series invalid parameter error", "body": "<p>I'm trying to make a chart and add new series to it. I recorded a macro and then adapted from it. It was working at the beginning, but then I tried to add new data to the source and it start throwing invalid parameter error. Could anyone tell me what's wrong with it? Thanks!</p>\n\n<p>The line throws error is as below\n<code>ActiveChart.FullSeriesCollection(33).Name = \"=Calculation!$B$91\"</code></p>\n\n<pre><code>Sub AllYear() 'Select Data Range for all Charts when selecting All Period\n\nDim lastColumn As Long\nDim rngV As Range\nDim rngH As Range\nDim rngC As Range\nDim rngX As Range\n\n\n    With Sheets(\"QoQ Summary\")\n            lastColumn = .Cells(5, 5).End(xlToRight).Column\n\n            Set rngV = .Range(.Cells(4, 5), .Cells(36, lastColumn))\n            Set rngH = rngV.Offset(38, 0)\n            Set rngC = rngH.Offset(38, 0)\n            Set rngX = rngC.Offset(38, 0)\n            Debug.Print rngV.Address, rngH.Address, rngC.Address, rngX.Address\n    End With\n\n\n    'Video\n    Sheets(\"Dashboard\").ChartObjects(\"Chart 27\").Activate\n    ActiveChart.SetSourceData Source:=rngV\n\n    ActiveChart.SeriesCollection.NewSeries\n    ActiveChart.FullSeriesCollection(33).Name = \"=Calculation!$B$91\"\n    ActiveChart.FullSeriesCollection(33).Values = \"=Calculation!$C$91:$H$91\"\n\n    ActiveChart.SeriesCollection.NewSeries\n    ActiveChart.FullSeriesCollection(34).Name = \"=Calculation!$B$92\"\n    ActiveChart.FullSeriesCollection(34).Values = \"=Calculation!$C$92:$h$92\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 2, "last_activity_date": 1427915301, "creation_date": 1427915301, "answer_id": 29398840, "question_id": 29398682, "link": "https://stackoverflow.com/questions/29398682/copy-offset-method-not-working/29398840#29398840", "title": "Copy-offset method not working", "body": "<p>Try with these edits. I think you just need to be more careful about qualifying worksheets when you are working across multiple. For instance <code>Cell()</code> will call on the active worksheet, <code>.Cells()</code> will call on the workbook qualified in you <code>With</code> statement.</p>\n\n<pre><code>Sub BSRange()\nSet ws1 = ThisWorkbook.Worksheets(\"Balance\")\nSet ws2 = ThisWorkbook.Worksheets(\"Summary\")\nSet ws3 = ThisWorkbook.Worksheets(\"Cash\")\nDim Lastcol As Long\nDim Lastrow As Long\nDim colname As String\nLastcol = ws1.Cells(1, ws1.Columns.Count).End(xlToLeft).Column\n\nFor i = 2 To Lastcol\n\nWith ws1\ncolname = Split(.Cells(, i).Address, \"$\")(1)\nLastrow = .Cells(.Rows.Count, colname).End(xlUp).Row\nEnd With\n\nWith ws3\n.Range(.Cells(4, i), .Cells(Lastrow, i)).Copy ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Offset(1, 1)\nEnd With\n\nWith ws1\n.Range(.Cells(4, i), .Cells(Lastrow, i)).Copy ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Offset(1, 0)\nEnd With\n\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 29398840, "answer_count": 1, "score": 0, "last_activity_date": 1427915301, "creation_date": 1427914735, "last_edit_date": 1427915223, "question_id": 29398682, "link": "https://stackoverflow.com/questions/29398682/copy-offset-method-not-working", "title": "Copy-offset method not working", "body": "<pre><code>Sub BSRange()\n\nSet ws1 = ThisWorkbook.Worksheets(\"Balance\")\nSet ws2 = ThisWorkbook.Worksheets(\"Summary\")\nSet ws3 = ThisWorkbook.Worksheets(\"Cash\")\nDim Lastcol As Long\nDim Lastrow As Long\nDim colname As String\nLastcol = ws1.Cells(1, ws1.Columns.Count).End(xlToLeft).Column\n\nFor i = 2 To Lastcol\n\n  With ws1\n    colname = Split(Cells(, i).Address, \"$\")(1)\n    Lastrow = .Cells(.Rows.Count, colname).End(xlUp).Row\n  End With\n\n  With ws3\n    Range(Cells(4, i), Cells(Lastrow, i)).Copy ws2.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 1)\n  End With\n\n  With ws1\n    Range(Cells(4, i), Cells(Lastrow, i)).Copy ws2.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n  End With\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>The data does not copy and the compiler shows no error in the code. Also,  when I try to get rid of <code>With</code> in the <code>For</code> loop, using <code>SheetName</code> in the prefix, then it gives me an error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1427913672, "post_id": 29398340, "comment_id": 46972651, "body": "Be glad to help if you can post what you have so far"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427913696, "post_id": 29398340, "comment_id": 46972667, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>. This isn&#39;t a code writing service, give it a shot, use the macro recorder to get some basics then come back with a specific issue if you get stuck."}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1427914292, "post_id": 29398340, "comment_id": 46972991, "body": "It won&#39;t let me add the code, length is too long"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 2, "creation_date": 1427914821, "post_id": 29398340, "comment_id": 46973299, "body": "@user3860954 Don&#39;t add it as a comment, <a href=\"http://stackoverflow.com/posts/29398340/edit\">edit</a> the code into your question"}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1427916863, "post_id": 29398340, "comment_id": 46974414, "body": "Please see the code now"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427917154, "post_id": 29398340, "comment_id": 46974565, "body": "instead of <code>wb.Worksheets(2).Delete</code> you want to present a list of worksheets to the user, then delete the one he chooses?"}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1427917380, "post_id": 29398340, "comment_id": 46974672, "body": "Freeman I want user to enter list of tab names one or more that he like to delete, sheet2 could be named Rawdata, so for example in 10 excel sheets user want to delete all the tabs that named Rawdata, and newsheet"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1427922774, "post_id": 29400105, "comment_id": 46977598, "body": "WebMan I am getting error : Object doesn&#39;t support for  &quot;For Each sht In wb &quot;   line"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1427971963, "post_id": 29400105, "comment_id": 46995300, "body": "<code>For each sht in wb.sheets</code> --- my bad."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1427979337, "post_id": 29400105, "comment_id": 46999667, "body": "You&#39;re welcome, I hope so to. If you accept an answer (either, since they&#39;re nearly identical), that will help people find good solutions."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1427971997, "last_edit_date": 1427971997, "creation_date": 1427920018, "answer_id": 29400105, "question_id": 29398340, "link": "https://stackoverflow.com/questions/29398340/macro-go-to-a-folder-and-delete-sheets-entered-by-user-in-all-xls-sheets/29400105#29400105", "title": "Macro go to a folder and delete sheets entered by user in all XLS sheets", "body": "<p>Add these variables (or similar) to the top of your code.</p>\n\n<pre><code>Dim DelSheet as string\nDim sht as worksheet\n</code></pre>\n\n<p>Get the sheet name - this is an example, you can get it from the user however you want</p>\n\n<pre><code>DelSheet = InputBox(Prompt:=\"Enter the name of the sheet to delete\")\n</code></pre>\n\n<p>Modify this portion of your code, above. Leave the rest as is, since it seems to be working ok.</p>\n\n<pre><code>Do While myFile &lt;&gt; \"\"\n  'Set variable equal to opened workbook\n  Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n  'this loop isn't particularly efficient, but it prevents attempting\n  'deletion of the sheet if that sheet doesn't exist in the wb\n  'you could wrap the code in an \"On Error...\" block instead\n  for each sht in wb.sheets\n    if sht.name = DelSheet then\n      wb.Worksheets(DelSheet).Delete\n    endif\n  next\n\n  'Save and Close Workbook\n  wb.Close SaveChanges:=True\n\n'Get next file name\n  myFile = Dir\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427976237, "post_id": 29412042, "comment_id": 46997771, "body": "<code>Application.DisplayAlerts = False</code> is a great idea"}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": false, "score": 1, "last_activity_date": 1427974733, "creation_date": 1427974733, "answer_id": 29412042, "question_id": 29398340, "link": "https://stackoverflow.com/questions/29398340/macro-go-to-a-folder-and-delete-sheets-entered-by-user-in-all-xls-sheets/29412042#29412042", "title": "Macro go to a folder and delete sheets entered by user in all XLS sheets", "body": "<p>FreeMan's answer one step further (with multiple sheets to be deleted).  </p>\n\n<h2>New variables</h2>\n\n<pre><code>Dim DelSheets() As String 'array\nDim intDelSheetCount As Integer\nDim DelSht As Variant\n</code></pre>\n\n<h2>New loop for user promt</h2>\n\n<pre><code>'ask user multiple times, which sheets he wants to delete\nDo\nReDim Preserve DelSheets(intDelSheetCount)\nDelSheets(intDelSheetCount) = InputBox(Prompt:=\"Enter the name of the sheet to delete\")\nintMsgBoxAnswer = MsgBox(\"Do you want to type more sheets to be deleted?\", vbYesNo)\nintDelSheetCount = intDelSheetCount + 1\nLoop While intMsgBoxAnswer = 6 'while the answer is YES\n</code></pre>\n\n<h2>Deletion loop</h2>\n\n<pre><code>  For Each sht In wb.Sheets\n    For Each DelSht In DelSheets\n        If sht.Name = DelSht Then\n          DelSht.Delete\n        End If\n    Next DelSht\n  Next\n</code></pre>\n\n<h2>Additional settings</h2>\n\n<p>To get rid of the Excel popup question, if you are super sure if you want to delete the sheet, you can use <code>Application.DisplayAlerts = False</code> at the beginning of the sub.</p>\n"}], "owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1847, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1427974733, "creation_date": 1427913584, "last_edit_date": 1531161705, "question_id": 29398340, "link": "https://stackoverflow.com/questions/29398340/macro-go-to-a-folder-and-delete-sheets-entered-by-user-in-all-xls-sheets", "title": "Macro go to a folder and delete sheets entered by user in all XLS sheets", "body": "<p>Here is my working code, I just want user to prompt for tab name, so that user can pick which tab to delete:</p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\n\n'PURPOSE: To loop through all Excel files in a user specified folder and perform a set task on them\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xls\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n      Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    'Change First Worksheet's Background Fill Blue\n      'wb.Worksheets(1).Range(\"A1:Z1\").Interior.Color = RGB(51, 98, 174)\n      wb.Worksheets(2).Delete\n\n    'Save and Close Workbook\n      wb.Close SaveChanges:=True\n\n    'Get next file name\n      myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1427912231, "post_id": 29397832, "comment_id": 46971883, "body": "What does <code>Get_Rows_Generic</code> do?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1427912277, "post_id": 29397832, "comment_id": 46971902, "body": "And <code>find_last_column</code>"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1427912827, "post_id": 29397832, "comment_id": 46972181, "body": "Also, for fun, <code>dim</code> your <code>x</code> and <code>y</code> variables each on their own line and run it again. When you smash them into the same line only one will be properly typed, the other will be a variant. I don&#39;t think it would effect the code here, but since the function return type isn&#39;t declared, it may."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427913531, "post_id": 29397832, "comment_id": 46972564, "body": "My guess is that you need to clear the <code>.Find</code> in your <code>find_last_column</code> function.  Try putting <code>ws.cells.find (&quot;*&quot;)</code> before the <code>End Function</code>.  If that works, I will post an answer with explanation."}, {"owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427914844, "post_id": 29397832, "comment_id": 46973313, "body": "@DavidZemens Thanks, but it didn&#39;t work.  Still same problem."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427914965, "post_id": 29397832, "comment_id": 46973388, "body": "OK. Then that&#39;s not it. Anyways, I ran your code and I get the same results eaach time I run it (IOW: I cannot replicate the discrepancy you have). You should <i>step through your code</i> and examine the values in the Locals window, or set a Watch on certain variables to see <i>when</i> they&#39;re diverging, then that will assist in identifying a root cause (and resolution)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427915003, "post_id": 29397832, "comment_id": 46973411, "body": "Before you do that, though, you may want to close Excel and re-start. See if the discrepancy persists. Sometimes funky things happen to workbook, and restarting Excel (or rebooting) may resolve it."}, {"owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427923872, "post_id": 29397832, "comment_id": 46978084, "body": "@DavidZemens I restarted the whole machine (mac) and the issue still persists.  It&#39;s very, very odd.  that function works for many other parts of the code.  When, however, I copy the text of one particular function call, it doesn&#39;t work.  damnedest thing I&#39;ve ever seen (in my very limited programming career)."}], "owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1427912872, "creation_date": 1427911888, "last_edit_date": 1531164843, "question_id": 29397832, "link": "https://stackoverflow.com/questions/29397832/how-can-the-same-function-with-the-same-parameters-yield-different-answers-in-ex", "title": "how can the same function with the same parameters yield different answers in excel vba?", "body": "<p>The following code:</p>\n\n<pre><code>Sub testingstuff()\n    Dim x, y As Long       \n     x = Find_lastest_day_events(\"flurry_an_output.csv\", \"User_Session\", 4)\n     y = Find_lastest_day_events(\"flurry_an_output.csv\", \"User_Session\", 4)\n    Debug.Print \"x is \" &amp; x\n    Debug.Print \"y is \" &amp; y\nEnd Sub\n</code></pre>\n\n<p>Yields the following output in the Immediate Window:</p>\n\n<pre><code>x is 121\ny is 0\n</code></pre>\n\n<p>How on earth is that possible???</p>\n\n<p>Here is the function:</p>\n\n<pre><code>Function Find_lastest_day_events(sheet_name As String, event_name As String, event_col As Integer)\n\n    '   find the range of the last full day in a column and count the number of events for the last day\n    '   use '*' in event name to just count events in range\n    Dim rows1 As Long\n    rows1 = Get_Rows_Generic(sheet_name, 1) ' total rows in sheet\n    Dim col1 As Integer\n    col1 = Range(find_last_column(sheet_name)).column ' last column number [uses address first]\n\n    Dim last_cell As Range\n    Dim full_range As Range\n    With Worksheets(sheet_name)\n        Set last_cell = .Range(.Cells(rows1, col1), .Cells(rows1, col1)) ' sets last_cell to the last cell in the sheet\n        Set full_range = .Range(.Cells(1, col1), .Cells(rows1, col1)) ' whole last column as range\n    End With\n\n    Dim todays_date As Long\n    todays_date = Date\n\n    Dim search_date As Long\n    search_date = todays_date - 1 \n\n    Dim first_position As Long\n    first_position = WorksheetFunction.Match(search_date, full_range, 0) \n\n    Dim last_position As Long\n    last_position = WorksheetFunction.Match(search_date, full_range, 1) \n\n    Dim event_range As Range\n    With Worksheets(sheet_name)\n        Set event_range = .Range(.Cells(first_position, event_col), .Cells(last_position, event_col)) ' set the range to be searched\n    End With\n\n    Dim event_count As Integer\n    event_count = WorksheetFunction.CountIf(event_range, event_name) '  count the numbe rof events\n\n    Find_lastest_day_events = event_count\nEnd Function\n</code></pre>\n\n<p>** added based on comments **</p>\n\n<pre><code>Function Get_Rows_Generic(work_sheet_get As String, column_num As Integer)\n    Dim ws As Worksheet:             Set ws = Worksheets(work_sheet_get)\n    Dim rows_count As Long:                 rows_count = ws.Cells(rows.Count, column_num).End(xlUp).Row\n    Get_Rows_Generic = rows_count\nEnd Function\n\n\nFunction find_last_column(ws_name As String)\n    Dim ws As Worksheet\n    Dim rng1 As Range\n    Set ws = Worksheets(ws_name)\n    Set rng1 = ws.rows(1).Find(\"*\", ws.[a1], xlFormulas, , xlByColumns, xlPrevious)\n    find_last_column = rng1.Address  ' returns the address of the first cell in the last column used as a string\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "events"], "comments": [{"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1427911745, "post_id": 29397731, "comment_id": 46971586, "body": "did you try the deleting the data validation and then stepping through code?"}, {"owner": {"reputation": 1, "user_id": 4739401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5624e418f17718c3eac18b3dc4077f99?s=128&d=identicon&r=PG&f=1", "display_name": "Dat ManCoo", "link": "https://stackoverflow.com/users/4739401/dat-mancoo"}, "reply_to_user": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1427980139, "post_id": 29397731, "comment_id": 47000198, "body": "Yes. Did not make any difference."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4739401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5624e418f17718c3eac18b3dc4077f99?s=128&d=identicon&r=PG&f=1", "display_name": "Dat ManCoo", "link": "https://stackoverflow.com/users/4739401/dat-mancoo"}, "edited": false, "score": 0, "creation_date": 1427979610, "post_id": 29397814, "comment_id": 46999867, "body": "So the question then becomes, why are two events being triggered when EnableEvents = False? Are there two events that are buffered and executes after the first one is finished? And how do I resolve this? One other thing of note: as a temporary workaround I implemented a flag in a different worksheet so I could detect the refire and exit the sub (chagrin) before any code was executed. Oddly enough changing the flag&#39;s value in the worksheet solved the refire (and of course the code to evaluate the flag was never engaged)."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "reply_to_user": {"reputation": 1, "user_id": 4739401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5624e418f17718c3eac18b3dc4077f99?s=128&d=identicon&r=PG&f=1", "display_name": "Dat ManCoo", "link": "https://stackoverflow.com/users/4739401/dat-mancoo"}, "edited": false, "score": 0, "creation_date": 1427980325, "post_id": 29397814, "comment_id": 47000313, "body": "@DatManCoo cut happens before your sheet change, and paste happens after. Why don&#39;t you use the event at the end for your code? Does xl provide a built in event procedure for paste destination?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1427989134, "post_id": 29397814, "comment_id": 47005973, "body": "In the event raised by the Cut part of the operation the range <code>Source</code> will have no content, so can you not just ignore that event?"}, {"owner": {"reputation": 1, "user_id": 4739401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5624e418f17718c3eac18b3dc4077f99?s=128&d=identicon&r=PG&f=1", "display_name": "Dat ManCoo", "link": "https://stackoverflow.com/users/4739401/dat-mancoo"}, "edited": false, "score": 0, "creation_date": 1428058300, "post_id": 29397814, "comment_id": 47030986, "body": "Update1: My previous comment about my attempt at a workaround by using a flag in a worksheet DID NOT inadvertently solve the problem - it was late in the day when I implemented the workaround and I did not have time to test thoroughly. Further testing the next day revealed my erroneous initial conclusion."}, {"owner": {"reputation": 1, "user_id": 4739401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5624e418f17718c3eac18b3dc4077f99?s=128&d=identicon&r=PG&f=1", "display_name": "Dat ManCoo", "link": "https://stackoverflow.com/users/4739401/dat-mancoo"}, "edited": false, "score": 0, "creation_date": 1428058442, "post_id": 29397814, "comment_id": 47031050, "body": "Update2: I now see why there are two events to deal with when a cut and paste operation is performed. This seems to be a poor approach on Microsoft&#39;s part but hey, who am I to judge...I am sure the developers had their reasons."}, {"owner": {"reputation": 1, "user_id": 4739401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5624e418f17718c3eac18b3dc4077f99?s=128&d=identicon&r=PG&f=1", "display_name": "Dat ManCoo", "link": "https://stackoverflow.com/users/4739401/dat-mancoo"}, "edited": false, "score": 0, "creation_date": 1428058955, "post_id": 29397814, "comment_id": 47031282, "body": "whytheq...as per my Update2, these events fire simultaneously and there is no event that captures either specifically - you have to use a more general event such as Workbook_SheetChange or Worksheet_Change. Once the first event finishes the second one begins."}, {"owner": {"reputation": 1, "user_id": 4739401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5624e418f17718c3eac18b3dc4077f99?s=128&d=identicon&r=PG&f=1", "display_name": "Dat ManCoo", "link": "https://stackoverflow.com/users/4739401/dat-mancoo"}, "edited": false, "score": 0, "creation_date": 1428059957, "post_id": 29397814, "comment_id": 47031749, "body": "whytheq...when I said these events fire simultaneously, what I mean is that they are trapped simultaneously fire in succession so you can&#39;t intercept them."}, {"owner": {"reputation": 1, "user_id": 4739401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5624e418f17718c3eac18b3dc4077f99?s=128&d=identicon&r=PG&f=1", "display_name": "Dat ManCoo", "link": "https://stackoverflow.com/users/4739401/dat-mancoo"}, "edited": false, "score": 0, "creation_date": 1428060112, "post_id": 29397814, "comment_id": 47031824, "body": "TimW...it may be Monday before I get a chance to look at checking out your suggestion."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1427911818, "creation_date": 1427911818, "answer_id": 29397814, "question_id": 29397731, "link": "https://stackoverflow.com/questions/29397731/excel-2007-vba-event-refires-after-the-same-event-procedure-ends/29397814#29397814", "title": "Excel 2007 VBA: Event refires after the same event procedure ends", "body": "<p>Try this and you can see that the first event fired is from the range which was cut, and the second is from the paste destination.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Source As Range)\n\n    Application.EnableEvents = False\n\n    Debug.Print Sh.Name, Source.Address()\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4739401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5624e418f17718c3eac18b3dc4077f99?s=128&d=identicon&r=PG&f=1", "display_name": "Dat ManCoo", "link": "https://stackoverflow.com/users/4739401/dat-mancoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427911864, "creation_date": 1427911541, "last_edit_date": 1427911864, "question_id": 29397731, "link": "https://stackoverflow.com/questions/29397731/excel-2007-vba-event-refires-after-the-same-event-procedure-ends", "title": "Excel 2007 VBA: Event refires after the same event procedure ends", "body": "<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Source As Range)\n    Application.EnableEvents = False\n\n    ' Some code\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>The \"some code\" is used to trap when a user has pasted some value in some cell. If the paste came after a copy operation then the procedures works correctly. If the paste value came after a cut operation then after execution reaches End Sub the procedures starts again and I cannot determine what change is occuring to cause the refire.</p>\n\n<p>The source and destination cells are formatted with Data Validation.</p>\n"}, {"tags": ["excel", "vba", "break"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 2, "creation_date": 1427912073, "post_id": 29397469, "comment_id": 46971806, "body": "Please try <code>Application.EnableCancelKey = xlDisabled</code>"}, {"owner": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1427917295, "post_id": 29397469, "comment_id": 46974627, "body": "Hi user3964075! Thank you for your reply! Will try as u suggested and come back to you with the result!"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "edited": false, "score": 0, "creation_date": 1427917460, "post_id": 29397967, "comment_id": 46974723, "body": "Hi David Zemens! Thanks for your suggestion, but i think that the EnableCancelKey might be a better option, because i didn&#39;t hide the spreadsheets with data and want to restrict the access to it if the password is not entered. As i know, if the userform will be opened, it will not be possible to switch from it to spreadshees."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "edited": false, "score": 0, "creation_date": 1427918806, "post_id": 29397967, "comment_id": 46975489, "body": "The cancel key option is dangerous, though...  There are other ways to do this. What behavior are you actually trying to prevent?"}, {"owner": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "edited": false, "score": 0, "creation_date": 1427919424, "post_id": 29397967, "comment_id": 46975824, "body": "I&#39;ve updated the original post with the code i&#39;m using. So lets say that i have an excel database, for which i want to restrict the access after a certain date, and the only way to have that access is to enter the right password. To prevent password guessing/bruteforcing, the user will have only 3 attempts, after which the file will be removed completely. If the password is correct, the macro will clear itself and the file will become accessible. I do believe that password-protecting the macro is essential, as you mentioned, and will do it after i finalise the code."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "edited": false, "score": 0, "creation_date": 1427919505, "post_id": 29397967, "comment_id": 46975858, "body": "I can break any  password protected Excel file in ONE attempt.  So can anyone with access to google and a hex editor like Notepad++."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "edited": false, "score": 0, "creation_date": 1427919631, "post_id": 29397967, "comment_id": 46975936, "body": "If you&#39;re really trying to make the application &quot;secure&quot;, then Excel passwords will never be a good solution to that. If you&#39;re simply trying to prevent the average user from breaking the file, or messing up the data, etc., then passwords will work. But they will not prevent a savvy user from accessing the file or the VBProject."}, {"owner": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "edited": false, "score": 0, "creation_date": 1427919663, "post_id": 29397967, "comment_id": 46975950, "body": "That sounds pretty awsome, any chance you can share that knowledge? :) Regarding the level of the user&#39;s knowledge - most probably it will be less than/average. For sure no hacking skills or anything like that :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "edited": false, "score": 0, "creation_date": 1427919897, "post_id": 29397967, "comment_id": 46976074, "body": "It&#39;s readily available on Google. As a matter of ettiquette (I believe it is frowned upon here), I don&#39;t share this on Stack Overflow, other than to warn people against thinking that an Excel &quot;passwords&quot; is a legitimate security measure, because it&#39;s not."}, {"owner": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "edited": false, "score": 1, "creation_date": 1427920582, "post_id": 29397967, "comment_id": 46976434, "body": "Found it. Really interesting approach, will try it out. Re the original issue, will try it out with pass-protected VBA. Need to rebuild the file again, because it self-destructed in the process of testing (forgot that i was working with the original file, not the copy). Luckily i&#39;ve saved the code in Evernote ^____^"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1427921420, "last_edit_date": 1427921420, "creation_date": 1427912366, "answer_id": 29397967, "question_id": 29397469, "link": "https://stackoverflow.com/questions/29397469/prevent-the-macro-break-for-pass-protected-self-destructing-file/29397967#29397967", "title": "Prevent the macro break for pass-protected self-destructing file", "body": "<p>You could simply password-protect the VBA project. That will avoid the need to worry about playing with the <code>Application</code>-level settings for <code>EnableCancelKey</code>.</p>\n\n<p>While the user may be able to \"break\" with the cancel key, they will not be able to view the code without supplying the proper password for the VBA project.</p>\n\n<p>With the VBAProject <em>protected</em>, the user can \"break\" execution of the code, the user should not be able to enter \"break mode\", and the Excel application will not be interactive (so the user will <em>not</em> be able to access the worksheets).  At this point, the User Form will be frozen on the screen and the application unresponsive.  The user then has two options that I can see:</p>\n\n<ol>\n<li>If they know the <em>name</em> of the userform, they could conceivably <code>Unload UserForm1</code> from the Immediate window in the VBE. So, you should pick some name for the UserForm which they will not likely guess.  If they do this, they will be able to access the file itself, but if you give the UF a secure name, they'll never guess it correctly.</li>\n<li>Otherwise, they're SOL, unless they <kbd>Ctrl</kbd>+<kbd>Alt</kbd><kbd>Del</kbd>, and kill the Excel application procdess.</li>\n</ol>\n\n<p><strong>NOTE:</strong> Excel passwords, whether on the worksheets or the VBAProject (or both) can be cracked by anyone intent on doing so, and are only a good measure to prevent inadvertent corruption or manipulation of the data.</p>\n"}], "owner": {"reputation": 71, "user_id": 3511116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0044cd2f97961896f6a42d2ef79753a7?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_2", "link": "https://stackoverflow.com/users/3511116/echo-2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1462, "favorite_count": 0, "accepted_answer_id": 29397967, "answer_count": 1, "score": 0, "last_activity_date": 1427921420, "creation_date": 1427910585, "last_edit_date": 1427921326, "question_id": 29397469, "link": "https://stackoverflow.com/questions/29397469/prevent-the-macro-break-for-pass-protected-self-destructing-file", "title": "Prevent the macro break for pass-protected self-destructing file", "body": "<p>I've decided to create a pass-protected file which will self-destruct after three wrong password entries. The macro runs with the file open (UserForm with pass entry field pops up) but the weak point is that Ctrl-Break allows to stop the macro and get access to the code. </p>\n\n<p>Is there any way to disable/prevent Break option in a particular workbook (via VBA, preferably)? </p>\n\n<p>If you are interested, I can provide the macro upon request.</p>\n\n<p>UPD: Here's the macro i'm using (Date based).</p>\n\n<pre><code>Private Sub Workbook_Open()\n    If Date &gt; Cdate(\"30/03/2015\") Then\n        WARNING.Show\n    End If\nEnd Sub\n</code></pre>\n\n<p>This part of code is assigned to \"Ok\" and \"Cancel\" buttons of the UserForm \"WARNING\".</p>\n\n<pre><code>Public i As Integer\nPublic b As Integer\n\nSub setib()\n    i = 2 - b\n    b = b + 0\nEnd Sub\n\nPrivate Sub CnclBtn_Click()\n    WARNING.Hide\n    With ThisWorkbook\n        .Saved = True\n        .Close False\n    End With\nEnd Sub\n\nPrivate Sub OKBtn_Click()\n    Call setib\n\n    Dim Pass As String: Pass = \"*your pass*\"\n    Dim PassInput As String: PassInput = WARNING.PassField.Text\n\n    If PassInput = Pass Then\n        MsgBox \"Password is correct\"\n        GoTo Safe:\n    Else\n        If b &lt; 2 Then\n            MsgBox \"Password is incorrect. \" &amp; i &amp; \" attempts left.\"\n        Else\n            MsgBox \"No More attempts\"\n        End If\n        If b = 2 Then\n            WARNING.Hide\n            GoTo Destroy:\n        Else\n            WARNING.PassField.Value = vbNullString\n            WARNING.PassField.SetFocus\n            b = b + 1\n            GoTo EndSub:\n        End If\n    End If\n\nSafe:\n    ActiveWorkbook.VBProject.VBComponents(\"ThisWorkbook\").CodeModule.DeleteLines 1, _\n    ActiveWorkbook.VBProject.VBComponents(\"ThisWorkbook\").CodeModule.CountOfLines\n    WARNING.Hide\nGoTo EndSub:\n\nDestroy:\n    With ThisWorkbook\n        .Saved = True\n        .ChangeFileAccess xlReadOnly\n        Kill .FullName\n        .Close False\n    End With\n\nEndSub:\n    Sheet1.Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1429999831, "post_id": 29397359, "comment_id": 47867508, "body": "did my answer, or anyone else&#39;s, address your question correctly?"}, {"owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "reply_to_user": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1430171071, "post_id": 29397359, "comment_id": 47935657, "body": "hi whytheeq, not yet unfortunately.  i tried tpkaplan&#39;s method but i did not get it to work."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1427911430, "creation_date": 1427911430, "answer_id": 29397702, "question_id": 29397359, "link": "https://stackoverflow.com/questions/29397359/sorting-multiple-sheets-code-clean-up/29397702#29397702", "title": "Sorting multiple sheets - code clean up", "body": "<p>Since you are using \"with\" you can combine those into one bigger with statement:</p>\n\n<pre><code>With ActiveWorkbook.Worksheets(\"ABC\").sort\n    .SortFields.Clear\n    .SortFields.Add Key:=Range(\"A1\"), _\n    SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n    xlSortTextAsNumbers\n    .SetRange Range(\"A2:K187\")\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>Also, you can remove the .header, .matchcase, .orientation, .sortmethod if you don't need to sort by those.</p>\n"}, {"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": false, "score": 0, "last_activity_date": 1427912402, "last_edit_date": 1427912402, "creation_date": 1427912083, "answer_id": 29397882, "question_id": 29397359, "link": "https://stackoverflow.com/questions/29397359/sorting-multiple-sheets-code-clean-up/29397882#29397882", "title": "Sorting multiple sheets - code clean up", "body": "<p>I like to fully qualify all objects e.g. <code>ActiveWorkbook</code> becomes <code>Excel.ActiveWorkbook</code>. This is a personal choice.</p>\n\n<p>Also I like to avoid <code>Active...</code> objects so if this code only needs to act on the workbook where the code is stored then switch to <code>ThisWorkbook</code></p>\n\n<pre><code>With Excel.ThisWorkbook.Worksheets(\"ABC\").sort\n    .SortFields.Clear\n    .SortFields.Add _\n       Key:=Range(\"A1\"), _\n       SortOn:=Excel.xlSortOnValues, _\n       Order:=Excel.xlDescending, _\n       DataOption:= Excel.xlSortTextAsNumbers\n    .SetRange Range(\"A2:K187\")\n    .Header = Excel.xlNo\n    .MatchCase = False\n    .Orientation = Excel.xlTopToBottom\n    .SortMethod = Excel.xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>If it needs to act on a separate workbook then use an object variable. For example if the target columns are in a book called <code>foo.xlsx</code> (that we assume is open)</p>\n\n<pre><code>Dim myFooBk As Excel.workbook\nSet myFooBk  = Excel.workbooks(\"foo.xlsx\")\n\nWith myFooBk.Worksheets(\"ABC\").sort\n    .SortFields.Clear\n    .SortFields.Add _\n       Key:=Range(\"A1\"), _\n       SortOn:=Excel.xlSortOnValues, _\n       Order:=Excel.xlDescending, _\n       DataOption:= Excel.xlSortTextAsNumbers\n    .SetRange Range(\"A2:K187\")\n    .Header = Excel.xlNo\n    .MatchCase = False\n    .Orientation = Excel.xlTopToBottom\n    .SortMethod = Excel.xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>Also the <code>with</code> could be altered slightly by moving the <code>.Sort</code> inside the clause:</p>\n\n<pre><code>Dim myFooBk As Excel.workbook\nSet myFooBk  = Excel.workbooks(\"foo.xlsx\")\n\nWith myFooBk.Worksheets(\"ABC\")\n    .sort.SortFields.Clear\n    .sort.SortFields.Add _\n       Key:= .Range(\"A1\"), _  '&lt;&lt;more specific now as `.` infront of Range\n       SortOn:=Excel.xlSortOnValues, _\n       Order:=Excel.xlDescending, _\n       DataOption:= Excel.xlSortTextAsNumbers\n    .sort.SetRange .Range(\"A2:K187\") '&lt;&lt;more specific now as `.` infront of Range\n    .sort.Header = Excel.xlNo\n    .sort.MatchCase = False\n    .sort.Orientation = Excel.xlTopToBottom\n    .sort.SortMethod = Excel.xlPinYin\n    .sort.Apply\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1427912167, "creation_date": 1427912167, "answer_id": 29397904, "question_id": 29397359, "link": "https://stackoverflow.com/questions/29397359/sorting-multiple-sheets-code-clean-up/29397904#29397904", "title": "Sorting multiple sheets - code clean up", "body": "<pre><code>call sortingcolumns ActiveWorkbook.worksheets(\"ABC\"), 2, 187\ncall sortingcolumns ActiveWorkbook.worksheets(\"XYZ\"), 2, 179\n\nSub sortingcolumns(sht as Worksheet, First as Integer, Last as Integer)\n\nWith sht.sort\n  .sortfields.clear\n  .sortfields.add Key:=Range(\"A1\"), SortOn:=xlSortOnValues, Order:=xlDescending, _\n      DataOption:=xlSortTextAsNumbers\n  .setrange = sht.range(\"A\" &amp; First &amp; \":K\" &amp; Last)\n  .Header = xlNo\n  .MatchCase = False\n  .Orientation = xlTopToBottom\n  .SortMethod = xlPinYin\n  .Apply\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>You could modify it to provide the first and last columns, as well, then you have a nice utility function that can sort any range for you just by passing the appropriate parameters.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1427914052, "post_id": 29397995, "comment_id": 46972860, "body": "This didn&#39;t work.  Run-time error &#39;1004&#39;: The sort reference is not valid.  Make sure that it&#39;s within the data you want to sort, and the first Sort By box isn&#39;t the same or blank."}], "tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1427912484, "creation_date": 1427912484, "answer_id": 29397995, "question_id": 29397359, "link": "https://stackoverflow.com/questions/29397359/sorting-multiple-sheets-code-clean-up/29397995#29397995", "title": "Sorting multiple sheets - code clean up", "body": "<p>Yes, you can shorten it substantially:</p>\n\n<pre><code>Sub sortingcolumns()\n    Worksheets(\"ABC\").Range(\"A2:K187\").sort key1:=Range(\"A1\"), Order1:=xlDescending\n    Worksheets(\"XYZ\").Range(\"A2:J179\").sort key1:=Range(\"A1\"), Order1:=xlDescending\nEnd sub\n</code></pre>\n\n<p>I made the following changes:</p>\n\n<ol>\n<li><p>I used the (old) <code>range.sort</code> construct instead of the (newer) <code>worksheet.sort</code>.  With the old construct, you simply identify the range to sort and then apply the .sort method with the appropriate arguments.  The newer one is also more flexible but also more complicated to use.  </p></li>\n<li><p>The only arguments you need are <code>key1</code> and <code>Order1</code>.  If you wanted to sort ascending, you could also eliminate the <code>order1</code> argument; then you'd have just one argument.  </p></li>\n</ol>\n\n<p>If you don't specify an argument, Excel will use the default.  All of the arguments in your snippet are the default arguments for the sort method.  Therefore you don't need to specify them.</p>\n"}], "owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1427912484, "creation_date": 1427910165, "question_id": 29397359, "link": "https://stackoverflow.com/questions/29397359/sorting-multiple-sheets-code-clean-up", "title": "Sorting multiple sheets - code clean up", "body": "<p>Looking for some guidance on sorting columns across multiple sheets.</p>\n\n<p>I have 2 data sets (tab1: ABC and tab2: XYZ).\nI'm trying to sort both sheets (range column A to column J) by column A in descending order.</p>\n\n<p>This is what I have so far... it is recorded.  I would very much like to clean up my code and also look for better ways to approach sorting by columns.  Any help/tips would be appreciated.</p>\n\n<pre><code>Sub sortingcolumns()\n\nApplication.Goto Reference:=\"ABC!A1\"\nActiveWorkbook.Worksheets(\"ABC\").sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"ABC\").sort.SortFields.Add Key:=Range(\"A1\"), _\n    SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n    xlSortTextAsNumbers\nWith ActiveWorkbook.Worksheets(\"ABC\").sort\n    .SetRange Range(\"A2:K187\")\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\n\n\nApplication.Goto Reference:=\"XYZ!RC\"\nActiveWorkbook.Worksheets(\"XYZ\").sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"XYZ\").sort.SortFields.Add Key:=Range(\"A1\"), _\n    SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n    xlSortTextAsNumbers\nWith ActiveWorkbook.Worksheets(\"XYZ\").sort\n    .SetRange Range(\"A2:J179\")\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427908775, "post_id": 29396647, "comment_id": 46969993, "body": "Edit your post to include what you&#39;ve tried. Someone might be able to help you tweak that."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4739199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0f248380c87bd0a228c742f148969a?s=128&d=identicon&r=PG&f=1", "display_name": "BenG", "link": "https://stackoverflow.com/users/4739199/beng"}, "edited": false, "score": 0, "creation_date": 1427926812, "post_id": 29398327, "comment_id": 46979232, "body": "Hi user3578951,  Your code worked great! Thank you for your input!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 4739199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0f248380c87bd0a228c742f148969a?s=128&d=identicon&r=PG&f=1", "display_name": "BenG", "link": "https://stackoverflow.com/users/4739199/beng"}, "edited": false, "score": 0, "creation_date": 1427983110, "post_id": 29398327, "comment_id": 47002064, "body": "You&#39;re welcome! If you&#39;re new to VBA, a great way to learn is to go through the code step by step - open the VBA editor (ALT + F11) and go to the macro, then hit F8 to go line by line.  Just move the windows around so you can see the VBA and Excel Sheet at the same time, and you&#39;ll see what each line does."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1427983409, "last_edit_date": 1495535052, "creation_date": 1427913547, "answer_id": 29398327, "question_id": 29396647, "link": "https://stackoverflow.com/questions/29396647/return-headers-if-column-contains-certain-string/29398327#29398327", "title": "Return headers if column contains certain string", "body": "<p>Since you have data in A:O, I am assuming that column Q is blank.  In Column Q, make a list of the unique values (so in your example, Q1 is \"CNN\", Q2 is \"Complex\" and Q3 is \"Forbes\".  You can use the \"remove duplicates\" to get a list of unique URLs).  This code will loop through the used range from Column A to O (from row 2 to the last used row) and then put the \"answer\" in column R.</p>\n\n<pre><code>Sub test()\nDim headerRange As Range, uniqueName As String, i As Integer, totalNames As Integer, lastHeadCol As Integer, lastRow As Integer, cel As Range\nDim replaceString As String\n\nlastRow = UsedRange.Rows.Count ' Find the last used row\nlastHeadCol = Cells(1, 1).End(xlToRight).Column 'find the last column\ntotalNames = Cells(1, 17).End(xlDown).Row 'find out how many unique names there are\nFor i = 1 To totalNames\n    uniqueName = Cells(i, 17).Value 'Get the unique name to check for in each column\n    replaceString = uniqueName  'Start off the \"answer\" with the unique name\n    For Each cel In Range(Cells(2, 1), Cells(lastRow, lastHeadCol)) ' for each cell in the range, starting at A2\n        If cel.Value = uniqueName Then 'If that cell's value IS the unique name then\n            replaceString = replaceString &amp; \" \" &amp; Cells(1, cel.Column).Value 'add that name to the string\n            Cells(i, 17).Offset(0, 1).Value = replaceString ' update the \"answer\"\n        End If\n    Next cel\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>There may be issues - such as let's say your block of URLs ends at row 90, but you have unrelated data in row 99, it's going to set the range to go down to 99 - if this is the case, you can change the \"lastRow\" to </p>\n\n<pre><code>lastRow = cells(1,1).End(xldown).Row\n</code></pre>\n\n<p>Does this help?</p>\n\n<p>Edit: If, in the future, you have code that ends in a column other than O, you can replace the \"17\"s in that code above with \"lastHeadCol + 2\".  VBA will get the last used column with a header (say Column E, which is the 5th column) and then add the URLs and such in column G (7th column, aka 5 + 2).  That is technically a better way to do the code, since it relies less on something \"hard-coded\" (aka <a href=\"https://stackoverflow.com/questions/47882/what-is-a-magic-number-and-why-is-it-bad\">\"magic numbers\"</a>).</p>\n"}, {"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1427923338, "post_id": 29401000, "comment_id": 46977851, "body": "I see you&#39;re looking for a function that returns the URLs too but I&#39;ve been having a bad case of TL;DR. You&#39;ll have to figure that one out for yourself."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1427923567, "post_id": 29401000, "comment_id": 46977951, "body": "P.S. Since it replaces with empty strings in lieu of null string and then replaces the separators it doesn&#39;t return null, empty or &quot;,&quot; headers. My bad."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1427924946, "post_id": 29401000, "comment_id": 46978482, "body": "Also, mixed up the strings compared.  &#175;_(\u30c4)_/&#175;"}, {"owner": {"reputation": 3, "user_id": 4739199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0f248380c87bd0a228c742f148969a?s=128&d=identicon&r=PG&f=1", "display_name": "BenG", "link": "https://stackoverflow.com/users/4739199/beng"}, "edited": false, "score": 1, "creation_date": 1427926890, "post_id": 29401000, "comment_id": 46979263, "body": "Hey user3819867,  I went with the other answer because it was more approachable to my novice skill level with VBA. When I get 15 rep I&#39;ll come back and upvote you, and thank you for your help!"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1427925311, "last_edit_date": 1495541910, "creation_date": 1427923024, "answer_id": 29401000, "question_id": 29396647, "link": "https://stackoverflow.com/questions/29396647/return-headers-if-column-contains-certain-string/29401000#29401000", "title": "Return headers if column contains certain string", "body": "<p>I made a VBA function  that is supposed to do just this. Based on my other <a href=\"https://stackoverflow.com/a/29267243/3819867\">function</a> of similar nature. Not elegant but does the job.  </p>\n\n<pre><code>Public Function FINDHEADERWHERESUBSTRINGFITS(Target As Range, Condition As String)\nDim rng As Range\nNumCols = Target.Columns.Count 'counts how many header values we can choose of\nDim Headers() 'defines separate arrays for headers and values (turned out to be obsolete, see variable x)\n    ReDim Headers(1 To NumCols)\nDim ValuesArr()\n    ReDim ValuesArr(1 To NumCols)\n\nHeaderRow = Target.Row 'row in which headers are located\nLastRow = HeaderRow + Target.Rows.Count - 1 'last row with values\nFirstColumn = Target.Column 'first column with values\nLastColumn = FirstColumn + Target.Columns.Count - 1 'last column with values\n\nFor k = FirstColumn To LastColumn 'for each column\n    i = i + 1 'set array position\n\n    For Each rng In Range(Cells(HeaderRow, k), Cells(LastRow, k)) 'for each value\n        If rng.Row &lt;&gt; HeaderRow Then 'I mean value, not header\n            If InStr(Condition, CStr(rng.Value2)) &gt; 0 Then Headers(i) = Cells(HeaderRow, k).Value2 'if it's a substring of the condition then set the corresponding header\n        End If\n    Next\nNext\nFINDHEADERWHERESUBSTRINGFITS = Replace(Replace(Join(Headers, \",\"), \",,\", \",\"), \",,\", \",\")\nEnd Function\n</code></pre>\n\n<p>Back, with more commas* than ever before, the ultimate URL finder**.<br>\n*sorry dude, you dun' said formatting was irrelevant<br>\n**restrictions apply, see comments  </p>\n\n<pre><code>Public Function FINDHEADERWHERESUBSTRINGFITS(Target As Range, Condition As String)\nDim rng As Range\n\nHeaderRow = Target.Row 'row in which headers are located\nLastRow = HeaderRow + Target.Rows.Count - 1 'last row with values\nFirstColumn = Target.Column 'first column with values\nLastColumn = FirstColumn + Target.Columns.Count - 1 'last column with values\n\nNumCols = Target.Columns.Count 'counts how many header values we can choose of\nNumCells = Target.Cells.Count - (LastColumn - FirstColumn + 1) 'counts how many URLs we can choose of\n\nDim Headers() 'defines separate arrays for headers and values\n    ReDim Headers(1 To NumCols)\nDim ValuesArr()\n    ReDim ValuesArr(1 To NumCells)\nFor k = FirstColumn To LastColumn 'for each column\n    i = i + 1 'set array position\n    For Each rng In Range(Cells(HeaderRow + 1, k), Cells(LastRow, k)) 'for each value\n        If rng.Row &lt;&gt; HeaderRow Then 'I mean value, not header\n            If InStr(CStr(rng.Value2), Condition) &gt; 0 Then\n            Headers(i) = Cells(HeaderRow, k).Value2 'if it's a substring of the condition then set the corresponding header\n            j = j + 1 'increases the array position counter by one (not to overwrite the previous entry)\n            ValuesArr(j) = CStr(rng.Value2) 'inserts URL to array position\n            End If\n        End If\n    Next\nNext\n\nFINDHEADERWHERESUBSTRINGFITS = Replace(Replace(Join(Headers, \",\"), \",,\", \",\"), \",,\", \",\") &amp; \"; \" &amp; Replace(Replace(Join(ValuesArr, \",\"), \",,\", \",\"), \",,\", \",\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4739199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0f248380c87bd0a228c742f148969a?s=128&d=identicon&r=PG&f=1", "display_name": "BenG", "link": "https://stackoverflow.com/users/4739199/beng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 0, "accepted_answer_id": 29398327, "answer_count": 2, "score": 0, "last_activity_date": 1427983409, "creation_date": 1427907743, "last_edit_date": 1531161705, "question_id": 29396647, "link": "https://stackoverflow.com/questions/29396647/return-headers-if-column-contains-certain-string", "title": "Return headers if column contains certain string", "body": "<p>I have a sheet called Input. The top row, A1:O1 contains the parent, and the rows underneath (of varying length) contains URLs. Some of the URLs are shared between the parents, and I want to return a list of URLs, and what their parents are. I have tried concatenate(if(index(match but the formula becomes too large. Similar questions I've seen are all looking for just one output, usually a number. I am open to VBA solutions, but have very very minimal understanding to create my own code. </p>\n\n<p>Example:<br>\n<strong>News --- Celebrity ---- Finance</strong><br>\nCNN------Complex --------Forbes<br>\nForbes---CNN<br></p>\n\n<p>I want to return CNN News Celebrity, Forbes New Finance, Complex Celebrity. I don't mind how this output is formatted.</p>\n"}, {"tags": ["c++", "vba", "excel", "vbe"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1427906726, "post_id": 29396251, "comment_id": 46968976, "body": "Surely that&#39;s just a formatting choice of the UI?"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 3, "creation_date": 1427908141, "post_id": 29396251, "comment_id": 46969701, "body": "The short answer is declare as Double instead. You say CDbl is returning the correct value, but it&#39;s not. This SO post may be helpful: <a href=\"http://stackoverflow.com/a/18504731\">stackoverflow.com/a/18504731</a>"}], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 1, "last_activity_date": 1428446287, "creation_date": 1428446287, "answer_id": 29502588, "question_id": 29396251, "link": "https://stackoverflow.com/questions/29396251/vba-debugger-precision/29502588#29502588", "title": "VBA debugger precision", "body": "<p>VBA variables of type \"single\" are stored as \"32-bit hardware implementation of IEEE 754[-]1985 [sic].\" [see: <a href=\"https://msdn.microsoft.com/en-us/library/ee177324.aspx]\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ee177324.aspx]</a>.  </p>\n\n<p>What this means in English is, \"single\" precision numbers are converted to binary then truncated to fit in a 4 byte (32-bit) sequence.  The exact process is very well described in Wikipedia under <a href=\"http://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Single-precision_floating-point_format</a> .  The upshot is that all single precision numbers are expressed as </p>\n\n<pre><code>(1) a 23 bit \"fraction\" between 0 and 1, *times*\n(2) an 8-bit exponent which represents a multiplier between 2^(-127) and 2^128, *times*\n(3) one more bit for positive or negative.  \n</code></pre>\n\n<p>The process of converting numbers to binary and back causes two types of rounding errors:</p>\n\n<p>(1) Significant Digits -- as you have noticed, there is a limit on significant digits.  A 22 bit integer can only have 8,388,607 unique values. Stated another way, no number can be expressed with greater than +/- 0.000012% precision.  Reaching back to high school science, you may recall that that is another way of saying you cannot count on more than six significant digits (well, decimal digits, at least ... of course you have 22 significant binary digits).  So any representation of a number with more than six significant digits will get rounded off.  However, it won't get rounded off to the nearest decimal digit ... it will get rounded off to the nearest binary digit.  This often causes some unexpected results (like yours).  </p>\n\n<p>(2) Binary conversion -- The other type of error is even more pernicious.  There are some numbers with significantly less than six (decimal) digits that will get rounded off.  For example, 1/5 in decimal is 0.2000000.  It never gets \"rounded off.\"  But the same number in binary is 0.00110011001100110011.... repeating forever. (That sequence is equivalent to 1/8 + 1/16 + 1/16*(1/8+1/16) + 1/256*(1/8+1/16) ... )  If you used an arbitrary number of binary digits to represent 0.20, then converted it back to decimal, you will NEVER get exactly 0.20.  For example, if you used eight bits, you would have 0.00110011 in binary which is:</p>\n\n<pre><code>  0.12500000\n  0.06250000\n  0.00781250\n+ 0.00390625\n------------\n  0.19921875\n</code></pre>\n\n<p>No matter how many binary digits you use, you will never get exactly 0.20, because 0.20 cannot be expressed as the sum of powers of two.</p>\n\n<p>That in a nutshell explains what's going on.  When you assign 876.34497 to \"test,\" it gets converted internally to:</p>\n\n<pre><code>1 10001000 0110110001011000010011\n     136       5,969,427\n</code></pre>\n\n<p>Which is (+1) * 2^(136-127) * (5,969,427)/(2^23)  </p>\n\n<p>Excel is automatically truncating the display of your single-precision number to show only six significant digits, because it knows that the seventh digit might be wrong.  I can't tell you what the number is exactly because my excel doesn't display enough significant digits!  But you get the point.</p>\n\n<p>When you coerce the value into double precision, it uses the entire binary string and then adds another 4 bytes worth of zeroes to the end.  It now allows you to display twice as many significant figures because it is double precision, but as you can see, the conversion from 8 decimal digits to 23 binary digits and then appending another long string of zeros has introduced some errors.  Not really errors, if you understand what it's doing; just artifacts.  After all, it's doing exactly what you told it to do ... you just didn't know what you were telling it to do!</p>\n"}], "owner": {"reputation": 2855, "user_id": 1169578, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b841b107ba53d8a3b16d23b2dbced449?s=128&d=identicon&r=PG", "display_name": "user17753", "link": "https://stackoverflow.com/users/1169578/user17753"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1428446287, "creation_date": 1427906396, "last_edit_date": 1427908295, "question_id": 29396251, "link": "https://stackoverflow.com/questions/29396251/vba-debugger-precision", "title": "VBA debugger precision", "body": "<p>I had a <code>single</code> which I believe the C++ equivalent is <code>float</code> in VBA in an Excel workbook module.  Anyways, the value I originally assigned (876.34497) is rounded off to 876.345 in the Immediate Window, and Watch, and hover tooltip when I set a breakpoint on the VBA.  However, if I pass this <code>Single</code> to a C++ DLL C++ reports it as the original value 876.34497.</p>\n\n<p>So, is it actually stored in memory as the original value? Is this some limitation of the debugger?  Unsure what is going on here.  Makes it difficult to test if what I'm passing is what I'm getting on the C++ side.</p>\n\n<p><img src=\"https://i.stack.imgur.com/nztln.png\" alt=\"enter image description here\"></p>\n\n<p>I tried:</p>\n\n<pre><code>?CStr(test)\n876.345\n?CDbl(test)\n 876.344970703125 \n?CSng(test)\n 876.345 \n</code></pre>\n\n<p>VBA isn't very straightforward, so at some level it must be stored as 876.34497 in memory.  Otherwise, I don't think <code>CDbl</code> would be correct like it is.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 2651, "user_id": 4059942, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2bmaq.jpg?s=128&g=1", "display_name": "Saagar Elias Jacky", "link": "https://stackoverflow.com/users/4059942/saagar-elias-jacky"}, "is_accepted": false, "score": 0, "last_activity_date": 1427906267, "creation_date": 1427906267, "answer_id": 29396220, "question_id": 29396018, "link": "https://stackoverflow.com/questions/29396018/vba-combobox-not-displaying-values/29396220#29396220", "title": "VBA ComboBox not displaying values", "body": "<p>The Event you selected to add items to the ComboBox will only be fired if there is a change in the ComboBox. You need to enter this piece of code to add new items to the ComboBox in another event which is fired before you want to use the ComboBox.</p>\n\n<p>Most cases, it is done at the Form_Load event, so that you have the items available inside the ComboBox by the time the Form is loaded completely.</p>\n\n<p>Try the below</p>\n\n<pre><code>Private Sub Form_Load()\n     ComboBoxT.AddItem \"apple\"\n     ComboBoxT.AddItem \"orange\"\n     ComboBoxT.AddItem \"banana\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 4275519, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6a5bb986243430d8004972849d2a759a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4275519/mark-smith"}, "edited": false, "score": 0, "creation_date": 1427907100, "post_id": 29396354, "comment_id": 46969155, "body": "That did it. Thank you."}], "tags": [], "owner": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "is_accepted": true, "score": 0, "last_activity_date": 1427906757, "creation_date": 1427906757, "answer_id": 29396354, "question_id": 29396018, "link": "https://stackoverflow.com/questions/29396018/vba-combobox-not-displaying-values/29396354#29396354", "title": "VBA ComboBox not displaying values", "body": "<p>Like Saagar said, they way that the code is currently written, it will only add the items into your combobox if there is a change in the combobox. The code that I would use would look like this:</p>\n\n<pre><code>Private Sub UserFormName_Activate()\n   ComboBoxT.AddItem \"apple\"\n   ComboBoxT.AddItem \"orange\"\n   ComboBoxT.AddItem \"banana\"\nend sub\n</code></pre>\n\n<p>The easiest way to achieve this is in the user form creator, double click on the userform frame. This should show the code you would be working with, then from the top dropdown bars (the first one might say either \"UserForm\" or \"General\") you can select \"Userform\" in the first one and \"Activate\" in the second one. That should give you a good place to start, and the items you wanted added to the ComboBox should be right there, ready to go. Hope this helps :)</p>\n"}], "owner": {"reputation": 49, "user_id": 4275519, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6a5bb986243430d8004972849d2a759a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4275519/mark-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4839, "favorite_count": 0, "closed_date": 1492456751, "accepted_answer_id": 29396354, "answer_count": 2, "score": -1, "last_activity_date": 1427906757, "creation_date": 1427905588, "question_id": 29396018, "link": "https://stackoverflow.com/questions/29396018/vba-combobox-not-displaying-values", "closed_reason": "Duplicate", "title": "VBA ComboBox not displaying values", "body": "<p>Trying to use the ComoboBox with VBA and it only displays 1 empty row when you click on the down arrow. I have never used ComboBox before and am still a beginner to VBA.</p>\n\n<pre><code>Private Sub ComboBoxT_Change()\n     ComboBoxT.AddItem \"apple\"\n     ComboBoxT.AddItem \"orange\"\n     ComboBoxT.AddItem \"banana\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": true, "score": 1, "last_activity_date": 1428553738, "creation_date": 1428553738, "answer_id": 29529788, "question_id": 29395961, "link": "https://stackoverflow.com/questions/29395961/array-collection-not-inserting-values-into-cbo-on-custom-userform/29529788#29529788", "title": "Array/Collection not inserting values into cbo on custom userform", "body": "<p>The code above requires the UserForm_Activate event, which is where the combobox is populated:</p>\n\n<pre><code>Private Sub UserForm_Activate()\nWith Me.cboOwner\n    .List = mChoiceList()\n    .ListIndex = 0\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 2, "accepted_answer_id": 29529788, "answer_count": 1, "score": 1, "last_activity_date": 1428559826, "creation_date": 1427905424, "last_edit_date": 1428559826, "question_id": 29395961, "link": "https://stackoverflow.com/questions/29395961/array-collection-not-inserting-values-into-cbo-on-custom-userform", "title": "Array/Collection not inserting values into cbo on custom userform", "body": "<p>I have read an article by Doug Glancy about creating a flexible chooser form. Utilizing his code and some previous worked code I was trying to dynamically read a list of strings, insert them into a collection and pass the collection as values to be chosen from in a custom combo box. Although, the do not show up in the combo box when I have the correct spreadsheet open. Below is the code I wrote. </p>\n\n<p>Doug Glancy's Article: <a href=\"http://yoursumbuddy.com/a-flexible-vba-chooser-form/\" rel=\"nofollow\">http://yoursumbuddy.com/a-flexible-vba-chooser-form/</a></p>\n\n<p>This is the code used in the module:</p>\n\n<pre><code>'==========================================================================================================================\n'Filename: modVulnerabilityReport\n'Description: A module to contain the functions to analyze a list of vulnerabilities outputted from the Vulnerability\n'             Remediation Asset Manager (VRAM) for a systems at a site. Utilizing built-in worksheet functions, this output\n'             will be a calculation of the number of vulnerabilities per category which will be displayed in a message box.\n'Concept taken from: Doug Glancy\n'Originally written by: Doug Glancy, Zack Barresse\n'Modified by: Troy Pilewski\n'Date: 2015-03-31\n'==========================================================================================================================\nOption Explicit\n\nFunction GetChoiceFromChooserForm(strChoices() As String, strCaption As String) As String\n'==========================================================================================================================\n'Description: Function to populate the combo box on the userform and return the answer\n'Originally written by: Doug Glancy\n'Modified by: Troy Pilewski\n'Date: 2015-03-31\n'==========================================================================================================================\n\n'Declare local variables\nDim ufChooser As frmChooser\nDim strChoicesToPass() As String\n\nReDim strChoicesToPass(LBound(strChoices) To UBound(strChoices))\nstrChoicesToPass() = strChoices()\n\n'Initializes a new userform of frmChooser\nSet ufChooser = New frmChooser\n\nWith ufChooser\n    .Caption = strCaption\n    .ChoiceList = strChoicesToPass\n    .Show\n    If .ClosedWithOk Then\n        GetChoiceFromChooserForm = .ChoiceValue\n    End If\n    Unload ufChooser\nEnd With\n\nEnd Function\n\nSub ShowTotalVulnerabilties()\n'==========================================================================================================================\n'Description: Procedure to calculate the sum total of vulnerabilities per asset for each category based on owner selection\n'Originally written by: Troy Pilewski\n'Date: 2015-03-31\n'==========================================================================================================================\n\n'Declare local variables\nDim wsData As Worksheet\nDim rngData As Range, rngWhole As Range, colOwner As Range, ColCategory As Range, colSummary As Range\nDim strOwner As String\nDim lngOwner As Long, lngCategory As Long, lngSummary As Long\nDim lngLastRow As Long, lngOwnerRow As Long\nDim lngCountCategoryI As Long, lngCountCategoryII As Long, lngCountCategoryIII As Long, lngCountCategoryIV As Long\nDim vntOwners() As Variant, Owners As Collection, strOwnerNames() As String, i As Long\n\n'Sets the Datasheet as the active worksheet\nIf ActiveSheet Is Nothing Then\n    Exit Sub\nEnd If\n\nSet wsData = ActiveSheet\n\n'Turn off application events to speed up code\nCall TOGGLEEVENTS(False)\n\n'Determine the last row with values\nlngLastRow = wsData.Range(\"A:J\").Find( _\n    What:=\"*\", _\n    After:=wsData.Range(\"A1\"), _\n    LookAt:=xlByRows, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlPrevious _\n).Row\n\n'Set the working ranges\nSet rngWhole = wsData.Range(\"A2:J\" &amp; lngLastRow)\nSet rngData = wsData.Range(\"A3:J\" &amp; lngLastRow)\n\n'Determines column numbers for criteria columns\nlngOwner = wsData.Range(\"A:J\").Find( _\n    What:=\"Owner\", _\n    After:=wsData.Range(\"A1\"), _\n    LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, _\n    SearchDirection:=xlNext _\n).Column\nlngCategory = wsData.Range(\"A:J\").Find( _\n    What:=\"CAT\", _\n    After:=wsData.Range(\"A1\"), _\n    LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, _\n    SearchDirection:=xlNext _\n).Column\nlngSummary = wsData.Range(\"A:J\").Find( _\n    What:=\"Not Compliant\", _\n    After:=wsData.Range(\"A1\"), _\n    LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, _\n    SearchDirection:=xlNext _\n).Column\n\n'Creates and adds each owner to a collection\nvntOwners = wsData.Range(\"A3:A\" &amp; lngLastRow).value\nSet Owners = New Collection\n\n'Loop through the array of all Owner values (duplicates will be in this list)\nFor lngOwnerRow = LBound(vntOwners, 1) To UBound(vntOwners, 1)\n\n    'Check the first unique value of a Owner\n    If KEYISINCOLLECTION(Owners, CStr(vntOwners(lngOwnerRow, 1))) = False Then\n\n        'Add the first unique Owner to the collection\n        Owners.Add CStr(vntOwners(lngOwnerRow, 1)), CStr(vntOwners(lngOwnerRow, 1))\n\n    End If\nNext lngOwnerRow\n\n'Converts collection to a string\nWith Owners\n    ReDim strOwnerNames(.Count) As String\n    For i = 1 To .Count\n        strOwnerNames(i) = .Item(i)\n    Next i\nEnd With\n\n'Assigns column number to variable\nWith rngWhole\n    Set colOwner = .Columns(lngOwner)\n    Set ColCategory = .Columns(lngCategory)\n    Set colSummary = .Columns(lngSummary)\n\n    'Prompts user to select an vulnerability owner\n    strOwner = GetChoiceFromChooserForm(strOwnerNames, \"Owner Selection\")\n\n    'Validates that an owner was selected\n    If strOwner = vbNullString Then\n        Exit Sub\n    End If\n\n    'Calculate sum of vulnerabilities for Owner and Category\n    lngCountCategoryI = WorksheetFunction.SumIfs(colSummary, colOwner, strOwner, ColCategory, \"I\")\n    lngCountCategoryII = WorksheetFunction.SumIfs(colSummary, colOwner, strOwner, ColCategory, \"II\")\n    lngCountCategoryIII = WorksheetFunction.SumIfs(colSummary, colOwner, strOwner, ColCategory, \"III\")\n    lngCountCategoryIV = WorksheetFunction.SumIfs(colSummary, colOwner, strOwner, ColCategory, \"IV\")\n\n    'Displays message box with results\n    MsgBox Title:=\"Vulnerability Totals\", _\n        Prompt:=\"The total number of \" &amp; strOwner &amp; \" vulnerabilities for each category are:\" &amp; vbCrLf &amp; _\n            \"Category I  : \" &amp; lngCountCategoryI &amp; vbCrLf &amp; _\n            \"Category II : \" &amp; lngCountCategoryII &amp; vbCrLf &amp; _\n            \"Category III: \" &amp; lngCountCategoryIII &amp; vbCrLf &amp; _\n            \"Category IV : \" &amp; lngCountCategoryIV\nEnd With\nEnd Sub\n\nSub TOGGLEEVENTS(blnState As Boolean)\n'==========================================================================================================================\n'Description: Toggles the application events for a boolean state\n'Originally written by: Zack Barresse\n'Date: 2014-09-15\n'==========================================================================================================================\n\n\n    Application.DisplayAlerts = blnState\n    Application.EnableEvents = blnState\n    Application.ScreenUpdating = blnState\n    If blnState Then Application.CutCopyMode = False\n    If blnState Then Application.StatusBar = False\nEnd Sub\n\nPublic Function KEYISINCOLLECTION(CollTemp As Collection, KeyToCheck As String) As Boolean\n'==========================================================================================================================\n'Description: Validates the selection is not already in the collection\n'Originally written by: Zack Barresse\n'Date: 2014-09-15\n'==========================================================================================================================\n\n    On Error Resume Next\n    KEYISINCOLLECTION = CBool(Not IsEmpty(CollTemp(KeyToCheck)))\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>This is the code used in the userform:</p>\n\n<pre><code>'==========================================================================================================================\n'Description: Properties and procedure to run the userform\n'Originally written by: Doug Glancy\n'Modified by: Troy Pilewski\n'Date: 2015-03-31\n'==========================================================================================================================\nOption Explicit\n\n'Declare modules level variables\nPrivate mblnClosedWithOk As Boolean\nPrivate mChoiceList() As String\n\nPrivate Sub cmdOk_Click()\n'Turns on the boolean bit if the user clicks OK button\nmblnClosedWithOk = True\n\n'Hides the userform\nMe.Hide\nEnd Sub\n\nPublic Property Get ClosedWithOk() As Boolean\n'Sets the property with the boolean bit of the procedure cmdOk_Click()\n    ClosedWithOk = mblnClosedWithOk\nEnd Property\n\nPrivate Sub cmdCancel_Click()\n'Turns off the boolean bit if the user clicks the Cancel button\nmblnClosedWithOk = False\n\n'Hides the userform\nMe.Hide\nEnd Sub\n\nPublic Property Get ChoiceValue() As String\n'Assigns the selected value in owner drop-down\nChoiceValue = Me.cboOwner.Value\nEnd Property\n\nPublic Property Let ChoiceList(PassedList() As String)\n'Set values to select from in the combo box\nmChoiceList() = PassedList()\nEnd Property\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 1, "user_id": 4739039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c672fe94f8a2c0c9cb6cbeb24a263c9f?s=128&d=identicon&r=PG&f=1", "display_name": "user4739039", "link": "https://stackoverflow.com/users/4739039/user4739039"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427914636, "post_id": 29395846, "comment_id": 46973195, "body": "I&#39;m using VBA to generate the data. I don&#39;t mind if the chart is formatted using VBA or through the regular excel interface."}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 2, "last_activity_date": 1428008970, "creation_date": 1428008970, "answer_id": 29422515, "question_id": 29395846, "link": "https://stackoverflow.com/questions/29395846/excel-bar-chart-same-color-and-legend-entry-for-same-names/29422515#29422515", "title": "Excel Bar Chart - Same Color and Legend Entry for Same Names", "body": "<p>The state name is stored as the Series Name.  There is a series for each stack in the Chart.  It is possible to iterate through series and style them based on the Series Name.  It is also possible to remove entries from the Legend using the LegendEntries object.</p>\n\n<p>Combining these into a loop, you can update the series color if it matches a title and then remove the item from the Legend if it is not one of the first two Series.  This assumes that \"running\" and \"stopped\" alternate at the start and are the entries to keep in the Legend.  If this is not the case, you could do more logic to spot the entries to keep.</p>\n\n<pre><code>Sub style_chart()\n\n    Dim cht As Chart\n    Dim ser As Series\n\n    'uses the active chart... assume it is selected\n    Set cht = ActiveChart\n\n    With cht\n        'reset legend so that it matches series\n        .HasLegend = False\n        .HasLegend = True\n\n        'iterate backwards to delete\n        For i = .SeriesCollection.Count To 1 Step -1\n            Set ser = .SeriesCollection(i)\n\n            'set series colors based on name\n            If ser.Name = \"running\" Then\n                ser.Format.Fill.ForeColor.RGB = RGB(0, 176, 80)\n            ElseIf ser.Name = \"stopped\" Then\n                ser.Format.Fill.ForeColor.RGB = RGB(255, 0, 0)\n            End If\n\n            'delete the legend entry if after first 2\n            If i &gt; 2 Then\n                .Legend.LegendEntries(i).Delete\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<h1>Before</h1>\n\n<p><img src=\"https://i.stack.imgur.com/SQn83.png\" alt=\"before\"></p>\n\n<h1>After</h1>\n\n<p><img src=\"https://i.stack.imgur.com/iCoBV.png\" alt=\"after\"></p>\n"}], "owner": {"reputation": 1, "user_id": 4739039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c672fe94f8a2c0c9cb6cbeb24a263c9f?s=128&d=identicon&r=PG&f=1", "display_name": "user4739039", "link": "https://stackoverflow.com/users/4739039/user4739039"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2434, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428008970, "creation_date": 1427905146, "question_id": 29395846, "link": "https://stackoverflow.com/questions/29395846/excel-bar-chart-same-color-and-legend-entry-for-same-names", "title": "Excel Bar Chart - Same Color and Legend Entry for Same Names", "body": "<p>I would like to chart the states of a machine over a period of time. For example it may be \"running\" for 2 hours and then \"stopped\" for 1 hour, and there may be several times each state occurs. Using a stacked bar chart I'd like to display the state and the amount of time it stays in the state.\nI'm finding that excel is assigning a new color and legend entry to each new state instance even if that state has already occurred.<br>\nHow can I make same-named states within a chart have the same color (e.g. every time \"running\" is displayed it has the same color and a single legend entry)? Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1427905205, "post_id": 29395763, "comment_id": 46968024, "body": "<code>Range(&quot;A4&quot; &amp; Lastrow)</code>  do you mean <code>Range(&quot;A4:A&quot; &amp; Lastrow)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "edited": false, "score": 0, "creation_date": 1427905502, "post_id": 29395852, "comment_id": 46968205, "body": "ws.Range(Cells(4, i) &amp; Lastrow).Copy  ws1.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Offset(1, 0)   . This Doesn&#39;t work"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "edited": false, "score": 0, "creation_date": 1427905723, "post_id": 29395852, "comment_id": 46968362, "body": "Nope, wouldn&#39;t expect it to. It&#39;s not what I put in my answer, either. If you&#39;re going to use it that way, you need Range(**Cells**(), **Cells**()). You need to specify both the top-left and bottom-right corner of your range by using a <code>Cells()</code> reference for each. Tacking <code>&amp; Lastrow</code> in there will likely just throw an error."}, {"owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "edited": false, "score": 0, "creation_date": 1427911705, "post_id": 29395852, "comment_id": 46971565, "body": "Sorry but I have one more thing to ask. Why does ws.Range using this fromat does not work while without it works, means it considers active sheet."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "edited": false, "score": 0, "creation_date": 1427912650, "post_id": 29395852, "comment_id": 46972097, "body": "@Jain, I&#39;ve added an example that&#39;s right out of a worksheet that I&#39;m currently developing. It works just fine like that as a reference. If you&#39;re still having issues with it, you should probably open a new question with your current code and a very specific description of what&#39;s not working."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1427912528, "last_edit_date": 1427912528, "creation_date": 1427905164, "answer_id": 29395852, "question_id": 29395763, "link": "https://stackoverflow.com/questions/29395763/writing-range-in-excel/29395852#29395852", "title": "Writing Range in excel.", "body": "<pre><code>Dim ws as Worksheet\nDim Row as integer\nDim Col as integer\nRow = 4\nCol = 1\nRange(Cells(Row, Col), cells(LastRow, Col))\nws.Range(Cells(Row, Col), Cells(LastRow, Col))\n</code></pre>\n"}], "owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 29395852, "answer_count": 1, "score": 0, "last_activity_date": 1427912528, "creation_date": 1427904867, "question_id": 29395763, "link": "https://stackoverflow.com/questions/29395763/writing-range-in-excel", "title": "Writing Range in excel.", "body": "<pre><code>colname = Split(Cells(, i).Address, \"$\")(1)\nLastrow = .Cells(.Rows.Count, colname).End(xlUp).Row\nws.(\"?\" &amp; Lastrow).Copy ws1.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n</code></pre>\n\n<p><strong>i</strong> is a number, which is converted to column name. I need a range starting from number 4 for eg if i =1, I need <strong>Range(\"A4\" &amp; Lastrow)</strong>. I have lastrow and I can get A , but how do I make it A4</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1427904574, "creation_date": 1427904574, "answer_id": 29395669, "question_id": 29395567, "link": "https://stackoverflow.com/questions/29395567/found-a-reference-to-local-error-but-no-definition-of-what-it-is/29395669#29395669", "title": "Found a reference to &quot;Local&quot; Error but no definition of what it is", "body": "<p><a href=\"http://windowssecrets.com/forums/showthread.php/106356-On-Local-Error-%28Access-2000-VBA%29\" rel=\"nofollow\">HansV from Windows Secrets</a>:  </p>\n\n<blockquote>\n  <p><code>On Local Error</code> is a remnant from older versions of BASIC (before Visual Basic for Applications). In current versions it acts the same as <code>On Error</code> and there is no particular reason to use it any more.</p>\n</blockquote>\n"}], "owner": {"reputation": 135, "user_id": 4220727, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NMmWd.jpg?s=128&g=1", "display_name": "CarloC", "link": "https://stackoverflow.com/users/4220727/carloc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 29395669, "answer_count": 1, "score": 1, "last_activity_date": 1427904574, "creation_date": 1427904197, "last_edit_date": 1427904387, "question_id": 29395567, "link": "https://stackoverflow.com/questions/29395567/found-a-reference-to-local-error-but-no-definition-of-what-it-is", "title": "Found a reference to &quot;Local&quot; Error but no definition of what it is", "body": "<p>I found a reference to <code>On Local Error GoTo Class_Initialize_Err</code> in an MS <a href=\"http://support.microsoft.com/en-us/kb/198465\" rel=\"nofollow\">article</a>. When I add the <code>Local</code> keyword to my Excel VBA code, the compiler accepts it. However, I cannot find any reference to this keyword either in the Help documentation nor on the web.  </p>\n\n<p>Does anyone know what <code>Local</code> refers to and/or what it does?</p>\n"}, {"tags": ["excel", "vba", "do-loops"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4437978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PoOTCg-Yo3I/AAAAAAAAAAI/AAAAAAAACXc/BhdyZn_WrDo/photo.jpg?sz=128", "display_name": "Ashty Rekani", "link": "https://stackoverflow.com/users/4437978/ashty-rekani"}, "edited": false, "score": 0, "creation_date": 1427907780, "post_id": 29395768, "comment_id": 46969521, "body": "I&#39;m quite new to VBA so I wouldn&#39;t be sure how to do this. I&#39;d like to avoid rewriting a large portion of this code if possible. Thank you"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1427904885, "creation_date": 1427904885, "answer_id": 29395768, "question_id": 29395447, "link": "https://stackoverflow.com/questions/29395447/how-can-i-limit-the-number-of-loops-in-a-do-while-loop/29395768#29395768", "title": "How can I limit the number of loops in a Do While loop?", "body": "<p>You might try Do Until. eg:  </p>\n\n<pre><code>Do Until IsEmpty(Cells(iRow, 1)) \n    ' Store the current cell value in the dCellValues array\n    dCellValues(iRow) = Cells(iRow, 1).Value\n    iRow = iRow + 1 \nLoop  \n</code></pre>\n\n<p>Code from <a href=\"http://www.excelfunctions.net/VBA-Loops.html\" rel=\"nofollow\">ExcelFunctions.net</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4437978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PoOTCg-Yo3I/AAAAAAAAAAI/AAAAAAAACXc/BhdyZn_WrDo/photo.jpg?sz=128", "display_name": "Ashty Rekani", "link": "https://stackoverflow.com/users/4437978/ashty-rekani"}, "edited": false, "score": 0, "creation_date": 1427906915, "post_id": 29396121, "comment_id": 46969069, "body": "I feel like its so close, the problems is now it doesn&#39;t go into the if at all."}, {"owner": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "reply_to_user": {"reputation": 13, "user_id": 4437978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PoOTCg-Yo3I/AAAAAAAAAAI/AAAAAAAACXc/BhdyZn_WrDo/photo.jpg?sz=128", "display_name": "Ashty Rekani", "link": "https://stackoverflow.com/users/4437978/ashty-rekani"}, "edited": false, "score": 0, "creation_date": 1427907070, "post_id": 29396121, "comment_id": 46969142, "body": "was it going to the if before? Also, forgot to mention this in my answer, but you may want to change &#39;Exit Function&#39; to &#39;Exit Do&#39; so it doesn&#39;t skip that last bit you have outside of the loop."}, {"owner": {"reputation": 13, "user_id": 4437978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PoOTCg-Yo3I/AAAAAAAAAAI/AAAAAAAACXc/BhdyZn_WrDo/photo.jpg?sz=128", "display_name": "Ashty Rekani", "link": "https://stackoverflow.com/users/4437978/ashty-rekani"}, "edited": false, "score": 0, "creation_date": 1427907358, "post_id": 29396121, "comment_id": 46969282, "body": "yes it was, if row.row &gt;1 because its searching through rows from the bottom, once it gets to one it should stop. But it never gets there! I need it to exit function because that means it has found a match. This function is being called elsewhere and uses row to find the row number of the most recent occurrence of a certain label1, label2, label3."}, {"owner": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "reply_to_user": {"reputation": 13, "user_id": 4437978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PoOTCg-Yo3I/AAAAAAAAAAI/AAAAAAAACXc/BhdyZn_WrDo/photo.jpg?sz=128", "display_name": "Ashty Rekani", "link": "https://stackoverflow.com/users/4437978/ashty-rekani"}, "edited": false, "score": 0, "creation_date": 1427908132, "post_id": 29396121, "comment_id": 46969693, "body": "So, what it looks like is happening to me is that the value of <code>row.row</code> never reaches 1 because it&#39;s value is based on <code>.find</code>. If the object that it is looking for is not in the first row, then the code begins in it&#39;s infinite loop. You could put a condition in your original code that will check to see if the value of the previous  <code>LastCellRowNumber</code> is the same as the new one and then exiting the loop if that is the case."}, {"owner": {"reputation": 13, "user_id": 4437978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PoOTCg-Yo3I/AAAAAAAAAAI/AAAAAAAACXc/BhdyZn_WrDo/photo.jpg?sz=128", "display_name": "Ashty Rekani", "link": "https://stackoverflow.com/users/4437978/ashty-rekani"}, "edited": false, "score": 0, "creation_date": 1427908428, "post_id": 29396121, "comment_id": 46969827, "body": "yes, that&#39;s exactly what&#39;s happening. Any suggestions as to how I&#39;d accomplish this?"}, {"owner": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "reply_to_user": {"reputation": 13, "user_id": 4437978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PoOTCg-Yo3I/AAAAAAAAAAI/AAAAAAAACXc/BhdyZn_WrDo/photo.jpg?sz=128", "display_name": "Ashty Rekani", "link": "https://stackoverflow.com/users/4437978/ashty-rekani"}, "edited": false, "score": 0, "creation_date": 1427909284, "post_id": 29396121, "comment_id": 46970255, "body": "Please ignore that previous comment. I edited my answer. Try putting that in your loop where you change the value of <code>LastCellRowNumber</code> (I used 2 temp variable to see if the past 3 instances are the same)."}], "tags": [], "owner": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "is_accepted": true, "score": 0, "last_activity_date": 1427909139, "last_edit_date": 1427909139, "creation_date": 1427905955, "answer_id": 29396121, "question_id": 29395447, "link": "https://stackoverflow.com/questions/29395447/how-can-i-limit-the-number-of-loops-in-a-do-while-loop/29396121#29396121", "title": "How can I limit the number of loops in a Do While loop?", "body": "<p>You could add an 'AND' piece to your 'Do While' loop with a counter inside the loop that will indicate when you have reached the end of data in your spreadsheet. </p>\n\n<p>Something like:</p>\n\n<pre><code>dim counter as integer    \nDo While row.row &gt; 1 and counter &gt; worksheetfunction.counta(sheet7.range(\"A:A\")\n\n    If (Sheet7.Cells(row.row, 2).Text = Label2) And (Sheet7.Cells(row.row, 3).Text = Label3) Then\n        Most_Recent_Deployment = row.row\n        Exit Function\n    End If\n    LastCellRowNumber = row.row\n    Set row = Sheet7.Range(\"A:A\").Find(Label1, LookIn:=xlValues, After:=Cells(LastCellRowNumber, \"A\"), SearchDirection:=xlPrevious)\n    coutner=counter+1\n\nLoop\n</code></pre>\n\n<p>I mean, yes, it's a bit basic, but I think think that it will do the job you're looking for without having to change your code too much. Hope it helps.   </p>\n\n<p>Edit:</p>\n\n<pre><code>LastCellRowNumber=row.row\ntemp2=temp1\ntemp1=LastCellRowNumber\n\nSet row = Sheet7.Range(\"A:A\").Find(Label1, LookIn:=xlValues, After:=Cells(LastCellRowNumber, \"A\"), SearchDirection:=xlPrevious)\n\nif row.row=temp1 and temp1=temp2 then\n    exit do\nend if\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4437978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PoOTCg-Yo3I/AAAAAAAAAAI/AAAAAAAACXc/BhdyZn_WrDo/photo.jpg?sz=128", "display_name": "Ashty Rekani", "link": "https://stackoverflow.com/users/4437978/ashty-rekani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2286, "favorite_count": 0, "accepted_answer_id": 29396121, "answer_count": 2, "score": 1, "last_activity_date": 1427909139, "creation_date": 1427903859, "last_edit_date": 1427904198, "question_id": 29395447, "link": "https://stackoverflow.com/questions/29395447/how-can-i-limit-the-number-of-loops-in-a-do-while-loop", "title": "How can I limit the number of loops in a Do While loop?", "body": "<p>So I've written a function that that uses text-box inputs to search for corresponding values in another sheet. The problem is if it doesn't find a match it goes into an infinite loop. Can I limit the loops so it doesn't crash?\nIf there is another solution rather than limiting loops, I'm all ears.\nHere's what I'm working with: </p>\n\n<pre><code>Function Most_Recent_Deployment(Label1 As String, Label2 As String, Label3 As String) As Long\n    Dim all_rows As Range\n    Dim row As Range\n    Dim LastCell As Range\n    Dim LastCellRowNumber As Long\n    Set LastCell = Sheet7.Cells(Sheet7.Rows.Count, \"A\").End(xlDown).End(xlUp)\n    LastCellRowNumber = LastCell.row + 1\n    Set row = Sheet7.Range(\"A:A\").Find(Label1, LookIn:=xlValues, After:=Cells(LastCellRowNumber, \"A\"), SearchDirection:=xlPrevious)\n    Do While row.row &gt; 1\n\n        If (Sheet7.Cells(row.row, 2).Text = Label2) And (Sheet7.Cells(row.row, 3).Text = Label3) Then\n            Most_Recent_Deployment = row.row\n            Exit Function\n        End If\n        LastCellRowNumber = row.row\n        Set row = Sheet7.Range(\"A:A\").Find(Label1, LookIn:=xlValues, After:=Cells(LastCellRowNumber, \"A\"), SearchDirection:=xlPrevious)\n\n    Loop\n    Most_Recent_Deployment = 0\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "onchange", "vba"], "comments": [{"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 1, "creation_date": 1427929912, "post_id": 29395303, "comment_id": 46980296, "body": "Have you walked through this code with a debugger? Which line does it choke on? If you haven&#39;t already, I&#39;d strongly suggest whacking a breakpoint on the first line of the function and then stepping through the code line-by-line to understand what is breaking it. It&#39;ll also tell you if it&#39;s even this code that&#39;s breaking it - if thee breakpoint never trips (but excel still crashes), it could be something else entirely."}, {"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 1, "creation_date": 1427929971, "post_id": 29395303, "comment_id": 46980313, "body": "First thought, though: what is <code>AdvFilter_Output</code>? And do you assign a named range to a rowsource like that? I&#39;d have expected RowSource to take a Range..."}, {"owner": {"reputation": 125, "user_id": 4611124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc03cde299ece51be0b81348e2a48553?s=128&d=identicon&r=PG&f=1", "display_name": "keyboardmouse", "link": "https://stackoverflow.com/users/4611124/keyboardmouse"}, "reply_to_user": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 0, "creation_date": 1427991932, "post_id": 29395303, "comment_id": 47007706, "body": "@tobriand Thanks for your response. AdvFilter_Output is a dynamic named range that holds the output data of an advanced filter. It populates a listbox automatically when the user fills in the 1st combo box as a visual aid to show users what options are already present in the records for the category they selected. AdvFilter_Output also becomes the rowsource for the 2nd combo box based on what the user selects in the 1st combo box. Could you clarify your second question about the named range and rowsource?"}, {"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 1, "creation_date": 1427998788, "post_id": 29395303, "comment_id": 47011374, "body": "Usually when I assign to fields for things like <code>RowSource</code>s (for instance in defining names), I find that if I&#39;m not careful, it ends up assigning a string instead of the entity I want it to, which obviously doesn&#39;t work. I&#39;m basically wondering if something like that is happening. If that&#39;s the case, changing it for <code>&quot;=AdvFilter_Output&quot;</code> might do the job (it&#39;ll explicitly realise you mean the name then)."}, {"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 1, "creation_date": 1427998873, "post_id": 29395303, "comment_id": 47011413, "body": "Other thought, now you said Dynamic Named Range, is Scope. It&#39;s conceivable that it&#39;s a worksheet scoped name but it&#39;s looking to the workbook or vice versa. Would be bizarre for that to make it crash Excel, though..."}, {"owner": {"reputation": 125, "user_id": 4611124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc03cde299ece51be0b81348e2a48553?s=128&d=identicon&r=PG&f=1", "display_name": "keyboardmouse", "link": "https://stackoverflow.com/users/4611124/keyboardmouse"}, "reply_to_user": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 0, "creation_date": 1428000313, "post_id": 29395303, "comment_id": 47012167, "body": "@tobriand I am not sure the issue is with the dynamic named range, as it is correctly populating the secondary combo box with the appropriate values in the drop-down list, so that must mean it is finding the range OK. The scope of the dynamic named range is set to workbook -- I did [previously have that issue on some other ones, where it was set to only worksheet, but all are workbook currently. The problem comes in when the user tries to manually type in a value. I will follow your suggestion to debug it line by line and see if it spits out anything."}], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 0, "creation_date": 1428010544, "post_id": 29422159, "comment_id": 47017212, "body": "Glad to hear you got it sorted! Auto-completion always struck me as a little lightweight in Excel; sounds like it&#39;s another of those useful-until-it-isn&#39;t features. The order of execution must be change --&gt; your-event --&gt; their event then, I imagine. I can see why that makes logical sense, but really highlights the shortcomings of VBA in handling native errors, doesn&#39;t it?"}], "tags": [], "owner": {"reputation": 125, "user_id": 4611124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc03cde299ece51be0b81348e2a48553?s=128&d=identicon&r=PG&f=1", "display_name": "keyboardmouse", "link": "https://stackoverflow.com/users/4611124/keyboardmouse"}, "is_accepted": false, "score": 0, "last_activity_date": 1428007592, "creation_date": 1428007592, "answer_id": 29422159, "question_id": 29395303, "link": "https://stackoverflow.com/questions/29395303/excel-has-stopped-working-when-using-vba-macro-with-on-change-event/29422159#29422159", "title": "&quot;Excel has stopped working&quot; when using VBA macro with on change event", "body": "<p>Figured it out, thanks to being able to bounce off some ideas with Tobriand and run through some possible problems.  <strong>The problem ended up being conflicting rowsource between the two events, as a result of an inappropriate <code>else</code> clause within Option2.</strong></p>\n\n<p><code>Private Sub Option2_Change()</code> was setting the <code>Rowsource</code> for the second combo box as blank on <code>change</code>, preventing the ability to type in anything. The <code>match entry</code> property was set to False, but I assume the removal of the rowsource for combobox 2 caused the <code>match entry complete</code> property to freak out when a user typed in something and it didn't find a match. <strong>I removed the <code>else</code> portion from the Option2 event and it seems to work now.</strong></p>\n"}], "owner": {"reputation": 125, "user_id": 4611124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc03cde299ece51be0b81348e2a48553?s=128&d=identicon&r=PG&f=1", "display_name": "keyboardmouse", "link": "https://stackoverflow.com/users/4611124/keyboardmouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3697, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1428007592, "creation_date": 1427903425, "last_edit_date": 1531161705, "question_id": 29395303, "link": "https://stackoverflow.com/questions/29395303/excel-has-stopped-working-when-using-vba-macro-with-on-change-event", "title": "&quot;Excel has stopped working&quot; when using VBA macro with on change event", "body": "<p>I am experiencing a consistent \"Excel has stopped working\" error. I have a user form that populates a combo box with dependent drop-down options based on what the user selects in the 1st combo box.  </p>\n\n<p>The error is <strong>consistently</strong> created for <strong>ANY</strong> of my on-change event subs when the user types into the 2nd combo box a letter that corresponds with an existing value that should be in the 2nd box. If the user selects an option from the drop-down list, it does not occur -- only when the user types in the 1st letter of a matching value.</p>\n\n<p>Example: If 1st combo box is \"Fruit\", 2nd combo options might be \"Apple\", \"Orange\", etc.  If the user types in \"A\" or \"O\" in the 2nd box (because it matches corresponding values), it crashes Excel.  Why does it not simply \"fill in\" the matching value like it does on the 1st combo box?</p>\n\n<p>Error handling is in place, but it never throws this error in code, only \"excel has stopped working\", then crash.</p>\n\n<p><strong>Do I need to use enable/disable worksheet events within the macros? If so, please offer a suggestion of how to implement and explanation of how it works.</strong>  I have solved previous On Change problems by simply converting them to a click button, but I'd rather learn how to better implement On Change events without errors.</p>\n\n<p>Thank you!  Here is some example code that I think is associated with the Excel crash:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Private Sub Option1_Change()\r\n\r\nOn Error GoTo Option1_Change_Error\r\n'Set cell H4 as value entered in Opt1 (adv. filter criteria)\r\nSheet6.Range(\"H4\").Value = Me.Option1.Value\r\n'Run macro AdvFilter which sets criteria for dependent drop-down box\r\nAdvFilter\r\n   Me.Option2.Value = \"\"\r\n'Set row source as output of adv filter\r\nMe.Option2.RowSource = \"AdvFilter_Output\"\r\n'Set list box content\r\n'If no adv.filter output, then blank listbox\r\nIf Sheet2.Range(\"BZ3\").Value = \"\" Then\r\n    Me.lstOptions.RowSource = \"\"\r\nElse\r\n    Me.lstOptions.RowSource = \"AdvFilter_Output\"\r\nEnd If\r\nExit Sub\r\n\r\nOption1_Change_Error:\r\nMsgBox \"An error has occurred.  \" _\r\n    &amp; vbCrLf &amp; \"\" _\r\n    &amp; vbCrLf &amp; \"\" _\r\n    &amp; \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure Option1_Change_Error of Form frmOptions\"\r\nEnd Sub\r\n\r\n\r\n\r\n\r\nPrivate Sub Option2_Change()\r\n\r\nOn Error GoTo Option2_Change_Error\r\nIf Me.Option1 = \"\" And Me.Option2 &lt;&gt; \"\" Then\r\n    MsgBox \"Select a the category first to see the corresponding options that exist.\"\r\n    Exit Sub\r\n    Else\r\n    Me.Option2.RowSource = \"\"\r\nEnd If\r\nExit Sub\r\n\r\nOption2_Change_Error:\r\nMsgBox \"An error has occurred.  \" _\r\n    &amp; vbCrLf &amp; \"\" _\r\n    &amp; vbCrLf &amp; \"\" _\r\n    &amp; \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure Option2_Change_Error of Form frmOptions\"\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 4702192, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c69f33652d168838a62107b3fe9c734f?s=128&d=identicon&r=PG&f=1", "display_name": "werwq", "link": "https://stackoverflow.com/users/4702192/werwq"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427903361, "post_id": 29395087, "comment_id": 46966814, "body": "Dear, Thanks) I want to pick up the Value(Number and Text) in the intersection of the column B and the Value of A3 in the column A..."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1427903536, "post_id": 29395087, "comment_id": 46966925, "body": "Then you want a <code>=vlookup()</code> not <code>=sumproduct()</code>"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427903546, "post_id": 29395087, "comment_id": 46966930, "body": "pnuts&#39; question still stands: <code>10 * 15</code> has a valid answer that &#39;Sumproduct()&#39; can generate, but what kind of answer do you expect from <code>edb25 * 252jq</code>? Excel doesn&#39;t do math on text."}, {"owner": {"reputation": 13, "user_id": 4702192, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c69f33652d168838a62107b3fe9c734f?s=128&d=identicon&r=PG&f=1", "display_name": "werwq", "link": "https://stackoverflow.com/users/4702192/werwq"}, "edited": false, "score": 0, "creation_date": 1427904229, "post_id": 29395087, "comment_id": 46967397, "body": "Ok Thanks I will try vlookup)) If I have 20 in A5 I wan the value of B5..))Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 2635143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94adfabac995bdc7dfa214e14a7836c3?s=128&d=identicon&r=PG", "display_name": "tpkaplan", "link": "https://stackoverflow.com/users/2635143/tpkaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1427906119, "creation_date": 1427906119, "answer_id": 29396175, "question_id": 29395087, "link": "https://stackoverflow.com/questions/29395087/sumproduct-doesnt-return-me-text-and-number-only-number/29396175#29396175", "title": "SumProduct, doesn&#39;t return me text and number. (Only Number)", "body": "<p>I think you are saying that some of the values in column B are expressed as text, not as a number, probably because they were imported from another source.</p>\n\n<p>if that is the case: First, convert column B into numbers, Then, use sumproduct.</p>\n\n<p>For example, FIRST convert text to values:\nin C3 you would enter </p>\n\n<pre><code>=value(b3)\n</code></pre>\n\n<p>Then copy that down to from C3 to C34.  </p>\n\n<p>Then </p>\n\n<pre><code>=SOMMEPROD(('Sheet1'!A3:A34=Sheet1!A3)*('Sheet1'!C3:C34))\n</code></pre>\n\n<p>should have the desired effect.</p>\n\n<p>Note that you sometime get #N/A errors with the \"value\" function, for example if there are unexpected spaces.  To be safe, rather than using value alone, try this:</p>\n\n<pre><code>= iferror(value(B3),0)\n</code></pre>\n\n<p>or to be more creative you can try:</p>\n\n<pre><code>= iferror(value(substitute(B3,\" \",\"\")),0)  ' deletes all spaces\n= iferror(value(substitute(substitute(b3,char(160),\"\"),\" \",\"\")),0)  \n'deletes all spaces and \"nonbreaking spaces\" copied from a web page\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "is_accepted": false, "score": 0, "last_activity_date": 1427929527, "last_edit_date": 1427929527, "creation_date": 1427927083, "answer_id": 29401943, "question_id": 29395087, "link": "https://stackoverflow.com/questions/29395087/sumproduct-doesnt-return-me-text-and-number-only-number/29401943#29401943", "title": "SumProduct, doesn&#39;t return me text and number. (Only Number)", "body": "<p>It depends on what you're trying to use SumProduct for. There's two main reasons this function shows up. Those are:</p>\n\n<ul>\n<li>To sum the product of two ranges.</li>\n<li>To sum a range of numbers that meet multiple criteria. This relies on that <code>True = 1</code> and <code>False = 0</code> so when want to find the combined weight of blue dogs in some cells, your formula might look like <code>=SUMPRODUCT(1*($A$1:$A$50 = \"Blue\"), 1*($B$1:$B$50 = \"Dog\"), $C$1:$C$50)</code>. Note the <code>1*</code> which guarantees the formula will know how to multiply the results. After all, <code>True</code> and <code>False</code> don't multiply. Their binary representations (1 and 0) though, do.</li>\n</ul>\n\n<p>NB though that people also sometimes remember it as a lookup formula because of the second use, and therefore expect to be able to get text back. Such approaches are an easy misunderstanding to end up with, but really there you want to use an <code>INDEX(&lt;Result Array&gt;,MATCH(1,INDEX(1 * (FIRST CONDITION) * (SECOND CONDITION) * (AND SO ON),,),0)</code>. This approach basically gives you an array formula without CTRL-SHIFT-ENTER (it's not faster, but because the condition is in an index formula, it works), and your conditions can be arbitrary (the same way as for sumproduct). But it'll give you the FIRST result, not the sum of all of them.</p>\n\n<p>Hope that helps.</p>\n\n<p>Edit: Crossed my mind, you might be expecting <code>A1</code> to contain <code>Erp</code> and <code>B1</code> to contain <code>54</code>, and in <code>C1</code> you want <code>Erp54</code>. This doesn't even need a function - just the <code>&amp;</code> operator, which joins two strings together - so in <code>C1</code>, you'd just put <code>=A1 &amp; B1</code>. And you're done.</p>\n"}], "owner": {"reputation": 13, "user_id": 4702192, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c69f33652d168838a62107b3fe9c734f?s=128&d=identicon&r=PG&f=1", "display_name": "werwq", "link": "https://stackoverflow.com/users/4702192/werwq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 664, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1427929527, "creation_date": 1427902801, "last_edit_date": 1531161705, "question_id": 29395087, "link": "https://stackoverflow.com/questions/29395087/sumproduct-doesnt-return-me-text-and-number-only-number", "title": "SumProduct, doesn&#39;t return me text and number. (Only Number)", "body": "<p>At first thanks to answer)) (It's important for me :p )</p>\n\n<p>I have a number in A3.</p>\n\n<p>When there is this number in column A (Sheet1), per exemple A7 then it will take the value of the cell B7. </p>\n\n<pre><code> =SOMMEPROD(('Sheet1'!A3:A34=Sheet1!A3)*('Sheet1'!B3:B34))\n</code></pre>\n\n<p>I use SOMMEPROD, it's working but only with number, and sometimes I have text and number in my cell (column B).</p>\n\n<p>I already changed the format of the cell but doesn't work.</p>\n\n<p>Thanks a lot)))</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "is_accepted": false, "score": 0, "last_activity_date": 1427903105, "creation_date": 1427903105, "answer_id": 29395197, "question_id": 29394844, "link": "https://stackoverflow.com/questions/29394844/show-hide-columns-based-on-input-value/29395197#29395197", "title": "Show/hide columns based on input value", "body": "<p>No quite sure if this is what you are looking for but you should try this. </p>\n\n<pre><code>If InputValue = 1 then\nSheets(ShArray(i)).Columns(\"A:C\").EntireColumn.Hidden = false\nelseif InputValue = 2 then \n'...\nelseif InputValue = 3 then \n\nEnd if \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4349561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3fa13b8d37eb670b2471bdafc713497?s=128&d=identicon&r=PG&f=1", "display_name": "QestEver2015", "link": "https://stackoverflow.com/users/4349561/qestever2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 662, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427903105, "creation_date": 1427902046, "last_edit_date": 1427902348, "question_id": 29394844, "link": "https://stackoverflow.com/questions/29394844/show-hide-columns-based-on-input-value", "title": "Show/hide columns based on input value", "body": "<p>I have one input sheet \"Sheet I\", Input cell: C3, the input value will be integer, such as 1, 2, 3... .\nThe output sheets are \"Out 1\", \"Out 2\", \"Out 3\", ...\"Out 10\". Some output sheets contain the content from A2 to G36, while others contain the information from A2 to H36 or T36. Ideally, I would like to see columns (starting from column C) conditionally based on the value in $C$3 in sheet I. Here is the logic: </p>\n\n<ul>\n<li>If Input Value = 1, show Column A, Column B and Column C</li>\n<li>If Input Value = 2, show Column A, Column B and Column D</li>\n<li>If Input Value = 6, show Column A, Column B and Column H</li>\n<li>.....</li>\n</ul>\n\n<p>Right now I have this VBA, but the input value in this code is set static number. Can anyone advise how should I change the code in order to make it work? </p>\n\n<pre><code>Private Sub Workbook_SheetCalculate(ByVal Sh As Object)\nDim ShArray\nDim i\nDim MyRange, c As Range\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nShArray = Array(\"Out 1\", \"Out 2\", \"Out 3\", \"Out 4\", \"Out 5\",.. \"Out 10\")\nFor i = LBound(ShArray) To UBound(ShArray)\n    Set MyRange = Sheets(ShArray(i)).Range(\"A:T\")\n    For Each c In MyRange\n        Sheets(ShArray(i)).Rows(c.Column).Hidden = c.Value = \"??\"\n    Next c\nNext i\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "find"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4738643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47eb3873e3942794809481bd4e5a5d69?s=128&d=identicon&r=PG&f=1", "display_name": "LauMuaL", "link": "https://stackoverflow.com/users/4738643/laumual"}, "edited": false, "score": 0, "creation_date": 1427966743, "post_id": 29395297, "comment_id": 46992252, "body": "It it almost right i believe ! Thanks. However, I paste a formula in cell S11--&gt; ( Range(&quot;S11&quot;).Select     ActiveCell.FormulaR1C1 = _         &quot;=IF(RC[-9]=1,&quot;&quot;&quot;&quot;,INDEX(&#39;Source samenwerken&#39;!R1C13:R60000C13,MATCH(RC[-16],&#39;Source samenwerken&#39;!R1C4:R60000C4,0)+COUNTIF(&#39;Source samenwerken&#39;!R1C4:R60000C4,RC[-16])-1))&quot;   ). I want that formula in every cell that contains [&#246;], corresponding with the row number the [&#246;] is in. for that I can easilly copy and paste cell S11, But How can I use the Cell S11 as &quot;PasteValue&quot; ?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 13, "user_id": 4738643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47eb3873e3942794809481bd4e5a5d69?s=128&d=identicon&r=PG&f=1", "display_name": "LauMuaL", "link": "https://stackoverflow.com/users/4738643/laumual"}, "edited": false, "score": 0, "creation_date": 1427972194, "post_id": 29395297, "comment_id": 46995429, "body": "<code>set rng = cells.find()</code> will find a cell with &quot;[&#246;]&quot;. <code>rng.value = PasteValue</code> will put &quot;PasteValue&quot; in that cell. Since you&#39;re pasting in a formula, you need to change that to <code>rng.formula = PasteValue</code>. You need to set &quot;PasteValue&quot; to whatever it is that you need to have pasted in."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 0, "last_activity_date": 1427903415, "creation_date": 1427903415, "answer_id": 29395297, "question_id": 29394265, "link": "https://stackoverflow.com/questions/29394265/find-a-cell-with-specific-text-multiple-occurences-and-past-active-cell-in-all/29395297#29395297", "title": "find a cell with specific text, multiple occurences, and past active cell in all cells containing specific text", "body": "<p>Your request is a little vague, but I believe this will get you started</p>\n\n<pre><code>Dim PasteValue as string 'this is what you're pasting in\nDim WS as Worksheet\nDim FirstCell as string\nDim rng as range\n\nPasteValue = 'do something here to get your value\n\nset rng = Cells.Find(What:=\"[\u00f6]\", LookIn:=xlFormulas, LookAt:= xlPart, _\n    SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, _\n    SearchFormat:=False)\nwhile not rng is nothing    'make sure you found something\n  if len(FirstCell) = 0 then\n     firstcell = rng.address    'save this spot off so we don't keep looping\n  end if\n  rng.value = PasteValue\n  'now find the next one\n  set rng = Cells.Find(What:=\"[\u00f6]\", LookIn:=xlFormulas, LookAt:= xlPart, _\n      SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, _\n      SearchFormat:=False)\n  if rng.address = FirstCell then  'back at the first cell\n    set rng = nothing              'so get out of the loop\n  endif\nend while\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 4738643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47eb3873e3942794809481bd4e5a5d69?s=128&d=identicon&r=PG&f=1", "display_name": "LauMuaL", "link": "https://stackoverflow.com/users/4738643/laumual"}, "is_accepted": false, "score": 0, "last_activity_date": 1428668468, "creation_date": 1428668468, "answer_id": 29561311, "question_id": 29394265, "link": "https://stackoverflow.com/questions/29394265/find-a-cell-with-specific-text-multiple-occurences-and-past-active-cell-in-all/29561311#29561311", "title": "find a cell with specific text, multiple occurences, and past active cell in all cells containing specific text", "body": "<p>Thanks for the code above, it helped a lot. </p>\n\n<p>This is the final code, in case anyone needs it. The  </p>\n\n<pre><code>If rng Is Nothing Then Exit Do\nLoop While rng.Address &lt;&gt; strFirstAddress\n</code></pre>\n\n<p>is particulary usefull. </p>\n\n<pre><code>Sub Fill_VCNC()\nDim formula_\u00f6 As String \nDim rng As Range\nDim strFirstAddress As String  \n\nWith Range(\"S:S\")\n     Set rng = Cells.Find(What:=\"[\u00f6]\", LookIn:=xlValues, LookAt:=xlPart, _\nSearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, _\nSearchFormat:=False)\n     If Not rng Is Nothing Then\n         strFirstAddress = rng.Address\n         Do\n            rng.formula = formula_\u00f6\n            .NumberFormat = \"0.00\"\n            Set rng = .FindNext(rng)\n            If rng Is Nothing Then Exit Do\n         Loop While rng.Address &lt;&gt; strFirstAddress\n    End If\n End With\nEnd Sub\n</code></pre>\n\n<p>( source : <a href=\"https://social.msdn.microsoft.com/Forums/en-US/958fca4e-b19d-4b50-8235-e05adc7f25d5/loop-through-a-range-until-value-not-found?forum=exceldev\" rel=\"nofollow\">https://social.msdn.microsoft.com/Forums/en-US/958fca4e-b19d-4b50-8235-e05adc7f25d5/loop-through-a-range-until-value-not-found?forum=exceldev</a>)</p>\n"}], "owner": {"reputation": 13, "user_id": 4738643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47eb3873e3942794809481bd4e5a5d69?s=128&d=identicon&r=PG&f=1", "display_name": "LauMuaL", "link": "https://stackoverflow.com/users/4738643/laumual"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1325, "favorite_count": 0, "accepted_answer_id": 29395297, "answer_count": 2, "score": 1, "last_activity_date": 1428668468, "creation_date": 1427900519, "question_id": 29394265, "link": "https://stackoverflow.com/questions/29394265/find-a-cell-with-specific-text-multiple-occurences-and-past-active-cell-in-all", "title": "find a cell with specific text, multiple occurences, and past active cell in all cells containing specific text", "body": "<p>I am currently working on a report, originating in Infoview (SAP business Objects)</p>\n\n<p>This is a report that provides valuable information on a weekly basis, to enhance awareness of current shop performance. </p>\n\n<p>Like the tile of the post might show i want to find a cell with specific text. It has multiple occurrences, and I want to past a previously selected cell in all of those instances.</p>\n\n<p>I can reach the same result by Ctrl-F, \"Search all\" ( for the \"specific text\") and than Paste (the previously selected cell)\n ( <a href=\"http://www.extendoffice.com/documents/excel/816-excel-select-cells-with-specific-text.html\" rel=\"nofollow\">http://www.extendoffice.com/documents/excel/816-excel-select-cells-with-specific-text.html</a>) \nBut i would like to automate this. </p>\n\n<p>I want to use:</p>\n\n<pre><code>    Cells.Find(What:=\"[\u00f6]\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=False).Activate\n</code></pre>\n\n<p>and </p>\n\n<pre><code>      Cells.FindNext(After:=ActiveCell).Activate\n</code></pre>\n\n<p>But I can't incorporate the two in one macro that gives me the result i describes above. </p>\n\n<p>The previously selected cell contains a formula, containing index(match) and a reference to a cell on the same row as the \"specific text\". \n In my opinion this way of doing stuff saves me a lot of trouble with dynamic cell references ect. </p>\n\n<p>I hope you can help</p>\n"}, {"tags": ["javascript", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 184244, "user_id": 14104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/otetW.jpg?s=128&g=1", "display_name": "epascarello", "link": "https://stackoverflow.com/users/14104/epascarello"}, "edited": false, "score": 0, "creation_date": 1427899197, "post_id": 29393661, "comment_id": 46964030, "body": "Why would it be the name?"}, {"owner": {"reputation": 13, "user_id": 4166832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2c1305bd1ddc84a8ca0ef22d37e87?s=128&d=identicon&r=PG&f=1", "display_name": "Jay777", "link": "https://stackoverflow.com/users/4166832/jay777"}, "reply_to_user": {"reputation": 184244, "user_id": 14104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/otetW.jpg?s=128&g=1", "display_name": "epascarello", "link": "https://stackoverflow.com/users/14104/epascarello"}, "edited": false, "score": 0, "creation_date": 1427899339, "post_id": 29393661, "comment_id": 46964158, "body": "When the name of the object is tried it puts it in single quotes and then exits out of the function."}, {"owner": {"reputation": 184244, "user_id": 14104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/otetW.jpg?s=128&g=1", "display_name": "epascarello", "link": "https://stackoverflow.com/users/14104/epascarello"}, "edited": false, "score": 0, "creation_date": 1427899610, "post_id": 29393661, "comment_id": 46964370, "body": "I am not sure what your problem is. If <code>this</code> is poinitng to the correct Html element, what is the problem? If you need the name it would just be referencing it.  <code>function functiondostuff (att, htmlObj, prop) { console.log(htmlObj.name); }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4166832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2c1305bd1ddc84a8ca0ef22d37e87?s=128&d=identicon&r=PG&f=1", "display_name": "Jay777", "link": "https://stackoverflow.com/users/4166832/jay777"}, "edited": false, "score": 0, "creation_date": 1427900818, "post_id": 29394319, "comment_id": 46965237, "body": "Tomalak, thank you for the suggestion!  Ill give this a try today and let you know if it worked."}, {"owner": {"reputation": 13, "user_id": 4166832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2c1305bd1ddc84a8ca0ef22d37e87?s=128&d=identicon&r=PG&f=1", "display_name": "Jay777", "link": "https://stackoverflow.com/users/4166832/jay777"}, "edited": false, "score": 0, "creation_date": 1427913337, "post_id": 29394319, "comment_id": 46972445, "body": "Still having issues getting this to work, trying the above sets &#39;this&#39; as function(attr) { this.init(attr); this.tag=tag } when using a loop to get the elementbytaname."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "reply_to_user": {"reputation": 13, "user_id": 4166832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2c1305bd1ddc84a8ca0ef22d37e87?s=128&d=identicon&r=PG&f=1", "display_name": "Jay777", "link": "https://stackoverflow.com/users/4166832/jay777"}, "edited": false, "score": 0, "creation_date": 1427932095, "post_id": 29394319, "comment_id": 46980968, "body": "I can&#39;t say what the error is without seeing the full code and knowing your full intent. But... Open that website in a browser. Open the browser&#39;s console. Write JS code that calls <code>functiondostuff()</code> with the right arguments. <i>That&#39;s</i> the exact code that you need to run through <code>execScript()</code> in VBA."}, {"owner": {"reputation": 13, "user_id": 4166832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2c1305bd1ddc84a8ca0ef22d37e87?s=128&d=identicon&r=PG&f=1", "display_name": "Jay777", "link": "https://stackoverflow.com/users/4166832/jay777"}, "edited": false, "score": 0, "creation_date": 1427993849, "post_id": 29394319, "comment_id": 47008725, "body": "Hi Tomalak, thank you for the additional info.  Stepping through the browser javascript it shows this as <code>[object DispHTMLInputElement]</code> when you press enter and <code>[function(attr) { this.init(attr); this.tag=tag }] </code> when I use the array."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "reply_to_user": {"reputation": 13, "user_id": 4166832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2c1305bd1ddc84a8ca0ef22d37e87?s=128&d=identicon&r=PG&f=1", "display_name": "Jay777", "link": "https://stackoverflow.com/users/4166832/jay777"}, "edited": false, "score": 0, "creation_date": 1427994705, "post_id": 29394319, "comment_id": 47009155, "body": "I have no idea what you mean, and without seeing the full code I never will. However, I cannot tell you any more than I have told you,  really."}], "tags": [], "owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "is_accepted": true, "score": 0, "last_activity_date": 1427900649, "creation_date": 1427900649, "answer_id": 29394319, "question_id": 29393661, "link": "https://stackoverflow.com/questions/29393661/vba-ie-call-a-javascript-containing-this-keyword/29394319#29394319", "title": "VBA IE call a javascript containing &#39;this&#39; keyword", "body": "<p>Key point is context. If you have this HTML</p>\n\n<pre><code>&lt;input onclick=\"functiondostuff('hdnAttribute',this,'Key')\"&gt;\n</code></pre>\n\n<p>then the browser can infer context from the user interaction and set <code>this</code> for you correctly.</p>\n\n<p>From within VBA that's a slightly different matter and you have to define context manually.</p>\n\n<p>How about this:</p>\n\n<pre><code>Dim js As Variant\n\njs = Array( _\n    \"var input = document.getElementById('yourElementsId');\", _\n    \"functiondostuff('hdnAttribute',input,'Key');\" _\n)\n\nCall IE.Document.parentWindow.execScript(Join(js, vbNewLine))\n</code></pre>\n\n<p>This way you get to define context yourself.</p>\n\n<p><code>document.getElementById</code> was just for the sake of the example. If your element has no ID, use any other method (like DOM traversal, <code>document.querySelectorAll</code>, <code>document.getElementsByTagName</code> + a loop, ...) to get a reference to the desired element.</p>\n"}], "owner": {"reputation": 13, "user_id": 4166832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2c1305bd1ddc84a8ca0ef22d37e87?s=128&d=identicon&r=PG&f=1", "display_name": "Jay777", "link": "https://stackoverflow.com/users/4166832/jay777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "accepted_answer_id": 29394319, "answer_count": 1, "score": 0, "last_activity_date": 1427989183, "creation_date": 1427898971, "last_edit_date": 1427989183, "question_id": 29393661, "link": "https://stackoverflow.com/questions/29393661/vba-ie-call-a-javascript-containing-this-keyword", "title": "VBA IE call a javascript containing &#39;this&#39; keyword", "body": "<p>I am attempting to call a javascript function on a webpage that contains the 'this' keyword which is referring to the <code>&lt;input&gt;</code> textbox on the webpage.  The function looks like this: </p>\n\n<pre><code>functiondostuff('hdnAttribute',this,'Key')\n</code></pre>\n\n<p>Using </p>\n\n<pre><code>js = \"functiondostuff('hdnAttribute',this,'Key')\"\nCall IE.Document.parentWindow.execScript(js)\n</code></pre>\n\n<p>doesn't throw an error but does not produce the results of the function since <code>this</code> cannot be identified.  </p>\n\n<p>Stepping through the website <code>this = [object DispHTMLInputElement]</code> instead of the element name while the function is running.  Anyone have any ideas?</p>\n\n<p>Good Morning,</p>\n\n<p>Adding more to this issue.  There seems to be two problems, 1st is setting the window.event, functiondostuff begins with: <code>if (window.event &amp;&amp; window.event.keyCode == 13)</code>, when the function is called it exits out immediately due to the event being null.  Is there a way to pass the event as 13 to the website?  The second issue is submitting the \"this\" HTMLInputObject.  </p>\n\n<p>Does anyone know a method to fire the 'onkeypress' event?  I am at the point of trying sendkeys to avoid calling the function but have not been able to get them to work with IE.  Thanks for any suggestions!  </p>\n"}, {"tags": ["vba", "offset", "countif"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4736616, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153709415094942/picture?type=large", "display_name": "Ali Statham Lecoultre", "link": "https://stackoverflow.com/users/4736616/ali-statham-lecoultre"}, "edited": false, "score": 0, "creation_date": 1427996232, "post_id": 29395321, "comment_id": 47010023, "body": "Thank you for your help ! But It says : Run time error 1004 , Unable to get the Match Property of the worksheetfunction class."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 1, "user_id": 4736616, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153709415094942/picture?type=large", "display_name": "Ali Statham Lecoultre", "link": "https://stackoverflow.com/users/4736616/ali-statham-lecoultre"}, "edited": false, "score": 0, "creation_date": 1428000295, "post_id": 29395321, "comment_id": 47012158, "body": "It means <code>Valid_type.Value</code> cannot be found in the <code>sec_type</code> range."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 1, "last_activity_date": 1427903479, "creation_date": 1427903479, "answer_id": 29395321, "question_id": 29393559, "link": "https://stackoverflow.com/questions/29393559/offset-match-with-a-variable-vba/29395321#29395321", "title": "Offset + match with a variable vba", "body": "<p><code>new_range = [OFFSET(...)]</code> is a syntactic sugar for this:</p>\n\n<pre><code>new_range.Value = Application.Evaluate(\"[OFFSET(...)]\")\n</code></pre>\n\n<p>so yes, your variable name is understood as a literal string, which is then understood as a range name, and you don't have a range of that name.</p>\n\n<p>If you are using VBA, then do it in the VBA way:</p>\n\n<pre><code>new_range.Value = Market_value_range.Offset(Application.WorksheetFunction.Match(Valid_type.Value, sec_type, 0) - 1, 0).Resize(Application.WorksheetFunction.CountIf(sec_type, Valid_type.Value), 1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4736616, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153709415094942/picture?type=large", "display_name": "Ali Statham Lecoultre", "link": "https://stackoverflow.com/users/4736616/ali-statham-lecoultre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427903479, "creation_date": 1427898689, "last_edit_date": 1427901002, "question_id": 29393559, "link": "https://stackoverflow.com/questions/29393559/offset-match-with-a-variable-vba", "title": "Offset + match with a variable vba", "body": "<p>I'm trying to use a variable in an <code>offset()</code> and <code>match()</code> function. But it doesn't work.</p>\n\n<pre><code>For Each Valid_type In Valid_sec_type_range\n\n'test = Valid_sec_type_range.Cells(1, Valid_type_index).Value\n'test1 = Chr(34) &amp; Valid_type &amp; Chr(34)\n\nnew_range = [OFFSET(Market_value_range,MATCH(Valid_type,sec_type,0)-1,0,COUNTIF(sec_type,Valid_type),1)]\n</code></pre>\n\n<p>and when I use this it works, it seems that the function match and offset do not recognize <code>Valid_type</code> as a string.</p>\n\n<pre><code>For Each Valid_type In Valid_sec_type_range\n\n'test = Valid_sec_type_range.Cells(1, Valid_type_index).Value\n'test1 = Chr(34) &amp; Valid_type &amp; Chr(34)\n\nnew_range = [OFFSET(Market_value_range,MATCH(\"Asset Backed\",sec_type,0)-1,0,COUNTIF(sec_type,\"Asset Backed\"),1)]\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "change-password"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4707046, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rc22jBIw_wc/AAAAAAAAAAI/AAAAAAAAADk/aJOIwr2MFhk/photo.jpg?sz=128", "display_name": "Pierre-Alexandre Jamot", "link": "https://stackoverflow.com/users/4707046/pierre-alexandre-jamot"}, "is_accepted": false, "score": 0, "last_activity_date": 1429174083, "creation_date": 1429174083, "answer_id": 29669680, "question_id": 29393304, "link": "https://stackoverflow.com/questions/29393304/reset-password-subform/29669680#29669680", "title": "Reset password subform", "body": "<p>I finally found out the answer. I am posting it here in case some others are meetings the same issue.</p>\n\n<p>My code was not working because it did not take into account the fact that he was in a subform.</p>\n\n<p>Final working code:</p>\n\n<pre><code>'------------------------------------------------------------\n' Reset Password\n'\n'------------------------------------------------------------\nPublic Function Resetpassword()\n'On Error GoTo Macro1_Err\nDim frm As Form\nSet frm = Screen.ActiveForm\n\n\n        If DLookup(\"[Password]\", \"[User login]\", \"[Username]='\" &amp; frm.navigationsubform.Form![Textlogin].Value &amp; \"'\") = frm.navigationsubform.Form!Textpass.Value Then\n            If frm.navigationsubform.Form!Textnewpass.Value = frm.navigationsubform.Form!Textnewpassconfirmation.Value Then\n\n             strsql = \"UPDATE [User login]\" _\n            &amp; \"SET [User login].[Password] ='\" &amp; frm.navigationsubform.Form![Textnewpass] _\n            &amp; \"' WHERE ((([User login].[Username])='\" &amp; frm.navigationsubform.Form![Textlogin] &amp; \"'));\"\n\n\n            DoCmd.RunSQL strsql\n\n\n            Beep\n                MsgBox \"Your password has been effective. Thanks!\", vbOKOnly, \"Success\"\n            Exit Function\n            Else\n                Beep\n                MsgBox \"You must confirm you new password.\", vbOKOnly, \"\"\n            End If\n        Else\n            Beep\n            MsgBox \"You might have enter an invalid password, please retry.\", vbOKOnly, \"\"\n        End If\n\n\n\n'Macro1_Exit:\n    'Exit Function\n\n'Macro1_Err:\n    'MsgBox Error$\n    'Resume Macro1_Exit\n\nEnd Function\n</code></pre>\n\n<p>Regards,</p>\n"}], "owner": {"reputation": 1, "user_id": 4707046, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rc22jBIw_wc/AAAAAAAAAAI/AAAAAAAAADk/aJOIwr2MFhk/photo.jpg?sz=128", "display_name": "Pierre-Alexandre Jamot", "link": "https://stackoverflow.com/users/4707046/pierre-alexandre-jamot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 548, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644961, "creation_date": 1427898058, "last_edit_date": 1594644961, "question_id": 29393304, "link": "https://stackoverflow.com/questions/29393304/reset-password-subform", "title": "Reset password subform", "body": "<p>I come to you today to ask some advise about a coding in which I still have issues. It was working at the beginning as it was in a normal form, but then I decided to adapt it to the real situation where it would actually to base its analytics on subform elements.</p>\n\n<p>Would you mind taking a look at it and tell what is wrong ?</p>\n\n<p>thanks a lot for your help:</p>\n\n<pre><code> Public Function Resetpassword()\n'On Error GoTo Macro1_Err\nDim frm As Form\nSet frm = Screen.ActiveForm\n\n\n        If DLookup(\"[User login]![Password]\", \"[User login]\", \"[User login]![Username]= [Textlogin]\") = frm.Forms.navigationsubform.Textpass.Value Then\n            If frm.Forms.navigationsubform.Textnewpass.Value = frm.Forms.navigationsubform.Textnewpassconfirmation.Value Then\n\n            strsql = \"UPDATE [User login]\" _\n            &amp; \"SET [User login].[Password] =\" &amp; frm.Forms.navigationsubform.[Textnewpass].Value _\n            &amp; \"WHERE ((([User login].[Username])=\" &amp; frm.Forms.navigationsubform.[Textlogin].Value &amp; \"));\"\n\n\n            DoCmd.RunSQL strsql\n\n\n            Beep\n                MsgBox \"Your password has been effective. Thanks!\", vbOKOnly, \"Success\"\n            Exit Function\n            Else\n                Beep\n                MsgBox \"You must confirm you new password.\", vbOKOnly, \"\"\n            End If\n        Else\n            Beep\n            MsgBox \"You might have enter an invalid password, please retry.\", vbOKOnly, \"\"\n        End If\n\n\n\n'Macro1_Exit:\n    'Exit Function\n\n'Macro1_Err:\n    'MsgBox Error$\n    'Resume Macro1_Exit\n\nEnd Function\n</code></pre>\n\n<p>I am getting the 2465 error : 'Application defined or object defined error\"</p>\n\n<p>Best regards,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1427897703, "post_id": 29393069, "comment_id": 46962927, "body": "Add the line <code>wb.Close</code> after the <code>Application.GetOpenFilename()</code>  in the <code>ErrHand</code> otherwise as soon as the error is found it is skipping the code that would have otherwise closed the file"}, {"owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "reply_to_user": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1427897948, "post_id": 29393069, "comment_id": 46963106, "body": "@izzymo That would close the file immediately. I want the file to go to Label1 first and then close."}, {"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1427898090, "post_id": 29393069, "comment_id": 46963225, "body": "I guess the right answer is provided by @Jeeped does that work"}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 2, "last_activity_date": 1427898427, "creation_date": 1427898427, "answer_id": 29393440, "question_id": 29393069, "link": "https://stackoverflow.com/questions/29393069/putting-labels-and-error-handler-in-the-right-place/29393440#29393440", "title": "Putting Labels and Error Handler in the right place", "body": "<p>In addition to Jeeped's excellent suggestion:</p>\n\n<pre><code>Sub test()\n\nOn Error GoTo ErrHand:\nFor i =1 to 100\n  Filename=Dir()\n  set Folder= Workbooks.open(Folder &amp; Filename)\n  'Label1:\n  Code   \n  Code \n  folder.Close  'based on using 'folder', above\nnext\n\nexit sub 'if you don't do this, code execution will go right into your error handler\n\nErrHand:\nif err.Number = &lt;something&gt;\n  Application.GetOpenFilename()\n  'GoTo Label1\n  Resume Next 'this is a simpler version, and doesn't require a label and another GoTo\n              'skips the line of code that errored, continues with the next line\nelseif err.number = &lt;something else&gt;\n   '...\n   Resume 'allows you to retry the same statement after making some changes\nendif\n\n'Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 29393440, "answer_count": 1, "score": 0, "last_activity_date": 1427898427, "creation_date": 1427897485, "last_edit_date": 1427898078, "question_id": 29393069, "link": "https://stackoverflow.com/questions/29393069/putting-labels-and-error-handler-in-the-right-place", "title": "Putting Labels and Error Handler in the right place", "body": "<p>I am using an error handler in Vba and want to use in Error Handler in my code as suggested by many experts over here.</p>\n\n<pre><code>Sub test()\n\nFor i =1 to 100\n\nOn Error GoTo ErrHand:\nFilename=Dir()\nFolder=\nWorkbooks.open(Folder &amp; Filename)\n\nLabel1:\nCode   \nCode \nClose the file\n\nErrHand:\nApplication.GetOpenFilename()\nGoTo Label1\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I am finding difficulties in running the code in a normal way. I try to pen a file and if it fails, I call Error Handler and throw a prompt to select a file and then I close the file and do the same thing for next files. One difficulty I am facing is that the opened file never closes. Thanks in advance. </p>\n"}, {"tags": ["excel", "vba", "filter", "criteria"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4663493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06a0d93d3080e48a50ad369b74f574f?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Henrique Andrade da Sil", "link": "https://stackoverflow.com/users/4663493/arthur-henrique-andrade-da-sil"}, "edited": false, "score": 0, "creation_date": 1427906139, "post_id": 29394528, "comment_id": 46968614, "body": "Still not working for me either... In that case, it had stopped before If structure and when I took it off, returns error on object definition"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 11, "user_id": 4663493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06a0d93d3080e48a50ad369b74f574f?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Henrique Andrade da Sil", "link": "https://stackoverflow.com/users/4663493/arthur-henrique-andrade-da-sil"}, "edited": false, "score": 0, "creation_date": 1427911923, "post_id": 29394528, "comment_id": 46971717, "body": "If I disable the Autofilter on my worksheet (unclicking the Filter icon on the Data ribbon), then try to run my code above, I also get an Error 91 - Object variable or With block variable not set on the &quot;numFilters = ...&quot; line. So I added a check like this <code>If Not ActiveSheet.AutoFilterMode Then Exit Sub End If</code> (see updated code snippet above)"}, {"owner": {"reputation": 11, "user_id": 4663493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06a0d93d3080e48a50ad369b74f574f?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Henrique Andrade da Sil", "link": "https://stackoverflow.com/users/4663493/arthur-henrique-andrade-da-sil"}, "edited": false, "score": 0, "creation_date": 1427915196, "post_id": 29394528, "comment_id": 46973529, "body": "It seems to do not understand what iFilt is.. when the structure If ActiveSheet.AutoFilter.Filters.Item(iFilt).On Then is tested, it directly goes to end if; without if test, the same object error is returned @PeterT"}, {"owner": {"reputation": 11, "user_id": 4663493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06a0d93d3080e48a50ad369b74f574f?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Henrique Andrade da Sil", "link": "https://stackoverflow.com/users/4663493/arthur-henrique-andrade-da-sil"}, "edited": false, "score": 0, "creation_date": 1427915399, "post_id": 29394528, "comment_id": 46973633, "body": "I cant find a way the code assume 4 as column D filter"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 11, "user_id": 4663493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06a0d93d3080e48a50ad369b74f574f?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Henrique Andrade da Sil", "link": "https://stackoverflow.com/users/4663493/arthur-henrique-andrade-da-sil"}, "edited": false, "score": 0, "creation_date": 1427922047, "post_id": 29394528, "comment_id": 46977256, "body": "I used <code>iFilt=4</code> from your original code snippit. You can loop to test each of the active autofilters to see which one is enabled and then loop within that autofilter for the criteria. Please see the updated code above."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 11, "user_id": 4663493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06a0d93d3080e48a50ad369b74f574f?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Henrique Andrade da Sil", "link": "https://stackoverflow.com/users/4663493/arthur-henrique-andrade-da-sil"}, "edited": false, "score": 0, "creation_date": 1427922595, "post_id": 29394528, "comment_id": 46977510, "body": "If you&#39;re still getting the object error, my guess is that AutoFilter is not turned on for the worksheet. If it is turned on, then I&#39;m less sure what the problem is because that&#39;s the only way I can get my code to generate the object error."}, {"owner": {"reputation": 11, "user_id": 4663493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06a0d93d3080e48a50ad369b74f574f?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Henrique Andrade da Sil", "link": "https://stackoverflow.com/users/4663493/arthur-henrique-andrade-da-sil"}, "edited": false, "score": 0, "creation_date": 1428002273, "post_id": 29394528, "comment_id": 47013214, "body": "When i add a second filter criteria at column P, the same object definition error appears. why is that? @PeterT"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 11, "user_id": 4663493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06a0d93d3080e48a50ad369b74f574f?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Henrique Andrade da Sil", "link": "https://stackoverflow.com/users/4663493/arthur-henrique-andrade-da-sil"}, "edited": false, "score": 0, "creation_date": 1428003573, "post_id": 29394528, "comment_id": 47013886, "body": "The only way I could get my code to fail was to select only a single criteria in any column -- in this case the call to <code>.Criteria1</code> gives a simple string instead of an array of strings. I modified the code above again to show my check to avoid this. I can select multiple columns of filters now and get debug output to show all of them."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1428003616, "last_edit_date": 1428003616, "creation_date": 1427901234, "answer_id": 29394528, "question_id": 29393006, "link": "https://stackoverflow.com/questions/29393006/loop-through-filter-criteria/29394528#29394528", "title": "Loop through filter criteria", "body": "<p>This worked for me</p>\n\n<pre><code>Sub WhatFilters()\n    Dim iFilt As Integer\n    Dim i, j As Integer\n    Dim numFilters As Integer\n    Dim crit1 As Variant\n\n    If Not ActiveSheet.AutoFilterMode Then\n        Debug.Print \"Please enable AutoFilter for the active worksheet\"\n        Exit Sub\n    End If\n\n    numFilters = ActiveSheet.AutoFilter.Filters.Count\n    Debug.Print \"Sheet(\" &amp; ActiveSheet.Name &amp; \") has \" &amp; numFilters &amp; \" filters.\"\n\n    For i = 1 To numFilters\n        If ActiveSheet.AutoFilter.Filters.Item(i).On Then\n            crit1 = ActiveSheet.AutoFilter.Filters.Item(i).Criteria1\n            If IsArray(crit1) Then\n                '--- multiple criteria are selected in this column\n                For j = 1 To UBound(crit1)\n                    Debug.Print \"crit1(\" &amp; i &amp; \") is '\" &amp; crit1(j) &amp; \"'\"\n                Next j\n            Else\n                '--- only a single criteria is selected in this column\n                Debug.Print \"crit1(\" &amp; i &amp; \") is '\" &amp; crit1 &amp; \"'\"\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 116, "user_id": 6494858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KAxGo.jpg?s=128&g=1", "display_name": "BigElittles", "link": "https://stackoverflow.com/users/6494858/bigelittles"}, "edited": false, "score": 0, "creation_date": 1506450629, "post_id": 41273387, "comment_id": 79824206, "body": "I know this is old, but this code Is amazing. Thank you! A flexible work or art, thank you for saving me some valuable time!"}], "tags": [], "owner": {"reputation": 91, "user_id": 4889633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847a2f9f9d56690143f77131f183c4fe?s=128&d=identicon&r=PG&f=1", "display_name": "christodorov", "link": "https://stackoverflow.com/users/4889633/christodorov"}, "is_accepted": false, "score": 2, "last_activity_date": 1482361352, "creation_date": 1482361352, "answer_id": 41273387, "question_id": 29393006, "link": "https://stackoverflow.com/questions/29393006/loop-through-filter-criteria/41273387#41273387", "title": "Loop through filter criteria", "body": "<p>I realize this was asked a while ago but I havent seen anything that I consider copy-paste ready. here is what I came up with. It should work for unlimited criteria. It does create a single new sheet called \"temp\" that can be deleted once finished. </p>\n\n<pre><code>Dim currentCell As Long\nDim numOfValues As Long\n\nSub filterNextResult()\n\n' copy and move the data from the data sheet, column A (can be changed if needed) to a new sheet called \"temp\"\n\n\n' check to make sure there is at least 1 data point in column A on the temp sheet\nIf currentCell = 0 Then\nApplication.ScreenUpdating = False\nCall createNewTemp\nApplication.ScreenUpdating = True\nEnd If\n\n' find the total number of unique data points we will be filtering by in column A of the temp sheet\nIf numOfAccounts = 0 Then\nApplication.ScreenUpdating = False\nCall findNumOfValues\nApplication.ScreenUpdating = True\nEnd If\n\n\nWith Sheet1.UsedRange\n\n.AutoFilter 1, Worksheets(\"temp\").Range(\"A\" &amp; currentCell).Value\ncurrentCell = currentCell + 1\n' check to make sure we havent reached the end of clumn A. if so exit the sub\nIf numOfValues + 1 = currentCell Then\n    MsgBox (\"This was the last value to filter by\")\n    Exit Sub\nEnd If\nEnd With\n\n\n\nEnd Sub\n\n'sub that will look for the number of values on the temp sheet column a\nPrivate Sub findNumOfValues()\n' count the number of non empty cells and assign that value (less 1 for the title in our case) to the numOfValues\nnumOfValues = Worksheets(\"temp\").Range(\"A:A\").Cells.SpecialCells(xlCellTypeConstants).Count\n\nEnd Sub\n\nPrivate Sub createNewTemp()\n\nSheet1.Range(\"A:A\").Copy\nActiveWorkbook.Sheets.Add.Name = \"temp\"\n\n' remove duplicates\nWorksheets(\"temp\").Range(\"A1\").Select\nWith ActiveWorkbook.ActiveSheet\n    .Paste\n    .Range(\"A:A\").RemoveDuplicates Columns:=Array(1), Header:=xlYes\nEnd With\n\n' check to make sure there are vlaues in the temp sheet\nIf Worksheets(\"temp\").Range(\"A2\").Value = \"\" Then\n    MsgBox \"There are no filter values\"\n    End\nElse\n    currentCell = 2\nEnd If\n\nSheet1.Activate\nSheet1.Range(\"A1\").Select\nSelection.AutoFilter\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4663493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06a0d93d3080e48a50ad369b74f574f?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Henrique Andrade da Sil", "link": "https://stackoverflow.com/users/4663493/arthur-henrique-andrade-da-sil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13653, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482361352, "creation_date": 1427897298, "last_edit_date": 1427906286, "question_id": 29393006, "link": "https://stackoverflow.com/questions/29393006/loop-through-filter-criteria", "title": "Loop through filter criteria", "body": "<p>I've been trying to figure this out but no progress...</p>\n\n<p>I have a filter (COLUMN D) and I'm trying to create a loop to each criteria (I got at least 1000 criterias) on my filter. \nEx: For each criteria on filter (column D), I'll run a range copy...</p>\n\n<p>That code isnt working at all:</p>\n\n<pre><code>Sub WhatFilters()\n    Dim iFilt As Integer\n    iFilt = 4\n    Dim iFiltCrit As Integer\n    Dim numFilters As Integer\n    Dim crit1 As Variant\n\n\n    ActiveSheet.Range(\"$A$1:$AA$4635\").AutoFilter Field:=16, Criteria1:= _\n            \"Waiting\"\n\n    numFilters = ActiveSheet.AutoFilter.Filters.Count\n    Debug.Print \"Sheet(\" &amp; ActiveSheet.Name &amp; \") has \" &amp; numFilters &amp; \" filters.\"\n    If ActiveSheet.AutoFilter.Filters.Item(iFilt).On Then\n        crit1 = ActiveSheet.AutoFilter.Filters.Item(iFilt).Criteria1\n        For iFiltCrit = 1 To UBound(crit1)\n            Debug.Print \"crit1(\" &amp; iFiltCrit &amp; \") is '\" &amp; crit1(iFiltCrit)\n\n            'Copy everything\n\n        Next iFiltCrit\n    End If\nEnd Sub\n</code></pre>\n\n<p>My mistake seems to be identifying my filter column... </p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427896586, "post_id": 29392621, "comment_id": 46962152, "body": "If you are not specifying both upper and lower case in your RegEx pattern mask but wish to catch a case-insensitive result, shouldn&#39;t <code>.IgnoreCase = False</code> be <code>.IgnoreCase = True</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1427897135, "post_id": 29392621, "comment_id": 46962542, "body": "Relevant: <a href=\"http://stackoverflow.com/q/201323/1188513\">stackoverflow.com/q/201323/1188513</a>"}, {"owner": {"reputation": 65, "user_id": 1002647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b92f972e24af254b24db28aee4d022d1?s=128&d=identicon&r=PG", "display_name": "Sam Hearn", "link": "https://stackoverflow.com/users/1002647/sam-hearn"}, "edited": false, "score": 0, "creation_date": 1427897139, "post_id": 29392621, "comment_id": 46962547, "body": "What you&#39;re saying makes sense, but changing <code>.IgnoreCase = False</code> has no effect on the results."}, {"owner": {"reputation": 65, "user_id": 1002647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b92f972e24af254b24db28aee4d022d1?s=128&d=identicon&r=PG", "display_name": "Sam Hearn", "link": "https://stackoverflow.com/users/1002647/sam-hearn"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427957554, "post_id": 29392621, "comment_id": 46987847, "body": "@pnuts I&#39;ve changed the <code>.IgnoreCase</code> to true in my code. I&#39;ve noted that this is actually <b>working</b> but backwards! The code extracts everything except the email. How do we make the code work in reverse?"}], "answers": [{"tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": false, "score": -1, "last_activity_date": 1427897058, "last_edit_date": 1427897058, "creation_date": 1427896733, "answer_id": 29392780, "question_id": 29392621, "link": "https://stackoverflow.com/questions/29392621/regex-to-extract-email/29392780#29392780", "title": "RegEx to extract email", "body": "<p>Try the below pattern</p>\n\n<pre><code>strPattern  = \"^([a-zA-Z0-9_\\-\\.]+)@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,3})$\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 1002647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b92f972e24af254b24db28aee4d022d1?s=128&d=identicon&r=PG", "display_name": "Sam Hearn", "link": "https://stackoverflow.com/users/1002647/sam-hearn"}, "edited": false, "score": 0, "creation_date": 1427897516, "post_id": 29392974, "comment_id": 46962801, "body": "I was thinking along this line, but in essence this only copies the value of the cell. It&#39;s not extracting the address"}], "tags": [], "owner": {"reputation": 11, "user_id": 4738530, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qNOCoM4Xv2s/AAAAAAAAAAI/AAAAAAAABaM/RSxCPRSWr1E/photo.jpg?sz=128", "display_name": "Pablo Ontiveros", "link": "https://stackoverflow.com/users/4738530/pablo-ontiveros"}, "is_accepted": false, "score": 1, "last_activity_date": 1427897234, "creation_date": 1427897234, "answer_id": 29392974, "question_id": 29392621, "link": "https://stackoverflow.com/questions/29392621/regex-to-extract-email/29392974#29392974", "title": "RegEx to extract email", "body": "<p>You can change the line </p>\n\n<pre><code> simpleCellRegex = regEx.Replace(strInput, strReplace)\n</code></pre>\n\n<p>To </p>\n\n<pre><code> simpleCellRegex = strInput\n</code></pre>\n\n<p>Because you are not making any replacement</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 1002647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b92f972e24af254b24db28aee4d022d1?s=128&d=identicon&r=PG", "display_name": "Sam Hearn", "link": "https://stackoverflow.com/users/1002647/sam-hearn"}, "edited": false, "score": 0, "creation_date": 1427962368, "post_id": 29393548, "comment_id": 46990073, "body": "Thank you @Marcin Wesel this should be working, but I get a #VALUE! error in my cells for the correctly matched emails. Is a formatting issue perhaps?"}, {"owner": {"reputation": 65, "user_id": 1002647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b92f972e24af254b24db28aee4d022d1?s=128&d=identicon&r=PG", "display_name": "Sam Hearn", "link": "https://stackoverflow.com/users/1002647/sam-hearn"}, "edited": false, "score": 0, "creation_date": 1427963359, "post_id": 29393548, "comment_id": 46990540, "body": "Figured out that it was looking for the second instance of a match with your code. Changed <code>matches(1).Value</code> to <code>matches(0).Value</code>"}], "tags": [], "owner": {"reputation": 94, "user_id": 4738594, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yoyzNgoNOlE/AAAAAAAAAAI/AAAAAAAAAHA/-SYtkPEz7d8/photo.jpg?sz=128", "display_name": "Marcin Wesel", "link": "https://stackoverflow.com/users/4738594/marcin-wesel"}, "is_accepted": true, "score": 1, "last_activity_date": 1427898654, "creation_date": 1427898654, "answer_id": 29393548, "question_id": 29392621, "link": "https://stackoverflow.com/questions/29392621/regex-to-extract-email/29393548#29393548", "title": "RegEx to extract email", "body": "<p>When You return strInput You just get the same string as the input.\nYou need to return Value that has been found using RegExp.</p>\n\n<p>Try</p>\n\n<pre><code>Set matches = regEx.Execute(strInput)\nsimpleCellRegex = matches(1).Value\n</code></pre>\n\n<p>Instead of</p>\n\n<pre><code>simpleCellRegex = regEx.Replace(strInput, strReplace)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5673870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2840b2b43f7a9cef329027f7eb0e3620?s=128&d=identicon&r=PG&f=1", "display_name": "Angu  Ransom", "link": "https://stackoverflow.com/users/5673870/angu-ransom"}, "is_accepted": false, "score": 0, "last_activity_date": 1449989038, "creation_date": 1449989038, "answer_id": 34248658, "question_id": 29392621, "link": "https://stackoverflow.com/questions/29392621/regex-to-extract-email/34248658#34248658", "title": "RegEx to extract email", "body": "<p>The easiest way to do this is by installing  the software called KUtool. After installing, highlight the content you want to extract emails==>Click ku tools at the top middle==>click on text==>extract emails. \nYou can also use the following code.(ALT+F1==>INSERT MODULE)</p>\n\n<pre><code>Function ExtractEmailFun(extractStr As String) As String\n'Update 20130829\nDim CharList As String\nOn Error Resume Next\nCheckStr = \"[A-Za-z0-9._-]\"\nOutStr = \"\"\nIndex = 1\nDo While True\n    Index1 = VBA.InStr(Index, extractStr, \"@\")\n    getStr = \"\"\n    If Index1 &gt; 0 Then\n        For p = Index1 - 1 To 1 Step -1\n            If Mid(extractStr, p, 1) Like CheckStr Then\n                getStr = Mid(extractStr, p, 1) &amp; getStr\n            Else\n                Exit For\n            End If\n        Next\n        getStr = getStr &amp; \"@\"\n        For p = Index1 + 1 To Len(extractStr)\n            If Mid(extractStr, p, 1) Like CheckStr Then\n                getStr = getStr &amp; Mid(extractStr, p, 1)\n            Else\n                Exit For\n            End If\n        Next\n        Index = Index1 + 1\n        If OutStr = \"\" Then\n            OutStr = getStr\n        Else\n            OutStr = OutStr &amp; Chr(10) &amp; getStr\n        End If\n    Else\n        Exit Do\n    End Ifenter code here\nLoop\nExtractEmailFun = OutStr\nEnd Function\n</code></pre>\n\n<p>You can also go the code way\nOpen excell, click on ALT +F1, Click on insert Module and paste this code</p>\n\n<p>Click save and enter the formula(Column=ExtractEmailFun(A1)) in a blank cell. press enter and your emails will be extracted. Hope this will help</p>\n"}], "owner": {"reputation": 65, "user_id": 1002647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b92f972e24af254b24db28aee4d022d1?s=128&d=identicon&r=PG", "display_name": "Sam Hearn", "link": "https://stackoverflow.com/users/1002647/sam-hearn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4377, "favorite_count": 1, "accepted_answer_id": 29393548, "answer_count": 4, "score": 3, "last_activity_date": 1587134815, "creation_date": 1427896319, "last_edit_date": 1587134815, "question_id": 29392621, "link": "https://stackoverflow.com/questions/29392621/regex-to-extract-email", "title": "RegEx to extract email", "body": "<p>I need to extract only the email from a spreadsheet in Excel. I've found some example VBA code here at this StackOverflow <strong><a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">link</a></strong>, courtesy of <a href=\"https://stackoverflow.com/users/2521004/portland-runner\">Portland Runner</a>.</p>\n\n<p>I created an Excel module and it seems to be working fine, except it only returns the first uppercase character of the address into the cell and it's ignoring the email.</p>\n\n<p>For example:</p>\n\n<pre><code>Text                                    | Result\n----------------------------------------|------------------------------\nMy email address is address@gmail.com   | My email address is  \nYes  Address@gmail.com                  | Yes  A\n</code></pre>\n\n<p>Below is the code I'm using:</p>\n\n<pre><code>Function simpleCellRegex(Myrange As Range) As String\n    Dim regEx As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim strReplace As String\n    Dim strOutput As String\n\n\n    strPattern = \"[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\"\n\n    If strPattern &lt;&gt; \"\" Then\n        strInput = Myrange.Value\n        strReplace = \"\"\n\n        With regEx\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = strPattern\n        End With\n\n        If regEx.test(strInput) Then\n            simpleCellRegex = regEx.Replace(strInput, strReplace)\n        Else\n            simpleCellRegex = \"Not matched\"\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>I do not have enough experience with VBA to really diagnose what might be happening here, hopefully someone will be able to spot what I'm doing wrong.</p>\n\n<h1>Working Code</h1>\n\n<pre><code>Function simpleCellRegex(Myrange As Range) As String\nDim regEx As New RegExp\nDim strPattern As String\nDim strInput As String\nDim strReplace As String\nDim strOutput As String\n\n\nstrPattern = \"[A-Za-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-zA-Z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\"\n\nIf strPattern &lt;&gt; \"\" Then\n    strInput = Myrange.Value\n    strReplace = \"\"\n\n    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = True\n        .Pattern = strPattern\n    End With\n\n    If regEx.Test(strInput) Then\n        Set matches = regEx.Execute(strInput)\n        simpleCellRegex = matches(0).Value\n    Else\n        simpleCellRegex = \"Not matched\"\n    End If\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "timestamp"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 1, "creation_date": 1427896018, "post_id": 29392165, "comment_id": 46961770, "body": "You might consider <a href=\"https://developers.google.com/maps/documentation/timezone/\" rel=\"nofollow noreferrer\">The Google Time Zone API</a>"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1427896447, "post_id": 29392165, "comment_id": 46962052, "body": "Perhaps a medium-sized user-defined function?"}, {"owner": {"reputation": 1, "user_id": 4249614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mQh5wFhN-ak/AAAAAAAAAAI/AAAAAAAABTU/oWtkIAlny7M/photo.jpg?sz=128", "display_name": "anil kumar gutlapalli", "link": "https://stackoverflow.com/users/4249614/anil-kumar-gutlapalli"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427896495, "post_id": 29392165, "comment_id": 46962082, "body": "@pnuts Thanks a lot. It worked. But it is not a permanent solution for me as I cannot ask the end users to keep changing the system clock."}, {"owner": {"reputation": 1, "user_id": 4249614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mQh5wFhN-ak/AAAAAAAAAAI/AAAAAAAABTU/oWtkIAlny7M/photo.jpg?sz=128", "display_name": "anil kumar gutlapalli", "link": "https://stackoverflow.com/users/4249614/anil-kumar-gutlapalli"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1427896637, "post_id": 29392165, "comment_id": 46962184, "body": "@PortlandRunner I am sorry, I am new to VBA and have no idea how to use an API in VBA. Started looking for it. Thanks for the comment."}, {"owner": {"reputation": 1, "user_id": 4249614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mQh5wFhN-ak/AAAAAAAAAAI/AAAAAAAABTU/oWtkIAlny7M/photo.jpg?sz=128", "display_name": "anil kumar gutlapalli", "link": "https://stackoverflow.com/users/4249614/anil-kumar-gutlapalli"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1427896706, "post_id": 29392165, "comment_id": 46962243, "body": "@Jean-Fran&#231;oisCorbett That would be my probable solution if I cannot get any better solution from the experts here..Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4249614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mQh5wFhN-ak/AAAAAAAAAAI/AAAAAAAABTU/oWtkIAlny7M/photo.jpg?sz=128", "display_name": "anil kumar gutlapalli", "link": "https://stackoverflow.com/users/4249614/anil-kumar-gutlapalli"}, "edited": false, "score": 1, "creation_date": 1427897796, "post_id": 29392900, "comment_id": 46962996, "body": "Thanks a lot for your answer. As I mentioned in my question, I was able to get this done but the problem is with daylight saving. India does not have daylight saving whereas Mexico has.. I would have to change this code every 6 months once to change the offset difference."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 1, "user_id": 4249614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mQh5wFhN-ak/AAAAAAAAAAI/AAAAAAAABTU/oWtkIAlny7M/photo.jpg?sz=128", "display_name": "anil kumar gutlapalli", "link": "https://stackoverflow.com/users/4249614/anil-kumar-gutlapalli"}, "edited": false, "score": 0, "creation_date": 1427905549, "post_id": 29392900, "comment_id": 46968249, "body": "You could look up the DST On and DST Off dates, then have the code adjust the offset based on the date. That way you don&#39;t have to update it, just let it run &amp; tell the folks in MX to let you know if they change their DST dates."}, {"owner": {"reputation": 1, "user_id": 4249614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mQh5wFhN-ak/AAAAAAAAAAI/AAAAAAAABTU/oWtkIAlny7M/photo.jpg?sz=128", "display_name": "anil kumar gutlapalli", "link": "https://stackoverflow.com/users/4249614/anil-kumar-gutlapalli"}, "edited": false, "score": 0, "creation_date": 1427983756, "post_id": 29392900, "comment_id": 47002456, "body": "Thanks for the leads. I got the solution in cpearson website. <a href=\"http://www.cpearson.com/excel/TimeZoneAndDaylightTime.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/TimeZoneAndDaylightTime.aspx</a>"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 1, "user_id": 4249614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mQh5wFhN-ak/AAAAAAAAAAI/AAAAAAAABTU/oWtkIAlny7M/photo.jpg?sz=128", "display_name": "anil kumar gutlapalli", "link": "https://stackoverflow.com/users/4249614/anil-kumar-gutlapalli"}, "edited": false, "score": 0, "creation_date": 1427984673, "post_id": 29392900, "comment_id": 47003031, "body": "Glad that helped, and thanks for posting that back, I&#39;ve got that bookmarked now, myself!"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1427897054, "creation_date": 1427897054, "answer_id": 29392900, "question_id": 29392165, "link": "https://stackoverflow.com/questions/29392165/how-to-get-timestamp-of-a-remote-country-in-vba/29392900#29392900", "title": "How to get timestamp of a remote country in VBA?", "body": "<p>Know your time zone offset &amp; your client's time zone offset, then use that to calculate the difference</p>\n\n<pre><code>Dim IndiaTZ as single  \nDim MexicoTZ as single\nDim MyTime as date\nDim UTC as date\nDim MexicoTime as date\n\nIndiaTZ = 5.5\nMexicoTZ = -4\n'note this assumes that they're in Eastern time, \n'Mexico also covers Central, Mountain &amp; Pacific at -5, -6 &amp; -7. \n'You'll need to figure out which one you need.\n\nMyTime = Now\n'need to invert the offset to get from India to UTC\nUTC = datediff(\"h\", mytime, IndiaTZ * -1)\n'need to invert the offset to get from UTC to Mexico\nMexicoTime = Datediff(\"h\", UTC, MexicoTZ * -1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4249614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mQh5wFhN-ak/AAAAAAAAAAI/AAAAAAAABTU/oWtkIAlny7M/photo.jpg?sz=128", "display_name": "anil kumar gutlapalli", "link": "https://stackoverflow.com/users/4249614/anil-kumar-gutlapalli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1427897054, "creation_date": 1427895082, "question_id": 29392165, "link": "https://stackoverflow.com/questions/29392165/how-to-get-timestamp-of-a-remote-country-in-vba", "title": "How to get timestamp of a remote country in VBA?", "body": "<p>I want to get timestamp of a different country in VBA. Is there any direct function or way to get it? For example, I am in India working for Mexico and I want to do certain task based on Mexican Time. I was able to get it by splitting the timestamp and manipulating it but could not consider daylight saving in it. Is there any simple solution than writing a big user-defined function?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8095, "user_id": 250725, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/T5rng.jpg?s=128&g=1", "display_name": "psubsee2003", "link": "https://stackoverflow.com/users/250725/psubsee2003"}, "edited": false, "score": 4, "creation_date": 1427893954, "post_id": 29391717, "comment_id": 46960488, "body": "Let&#39;s back up a step.  Why do you need to select any cells to begin with?  In most applications using VBA and Excel there is absolutely no reason to select anything (and often makes your life more complicated).  Try explaining what you are actually trying to do with the cells you are selecting and there might be a better way."}, {"owner": {"reputation": 1, "user_id": 4738289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92125000edcc9396c22670af0f5d76b?s=128&d=identicon&r=PG&f=1", "display_name": "Avinash Khushalani", "link": "https://stackoverflow.com/users/4738289/avinash-khushalani"}, "reply_to_user": {"reputation": 8095, "user_id": 250725, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/T5rng.jpg?s=128&g=1", "display_name": "psubsee2003", "link": "https://stackoverflow.com/users/250725/psubsee2003"}, "edited": false, "score": 0, "creation_date": 1427894950, "post_id": 29391717, "comment_id": 46961128, "body": "The actual scenario is I am building a macro for managers. They will fill the project requirement and the selected sheets containing data will at one go will be emailed to the solutions team."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1428009503, "post_id": 29391717, "comment_id": 47016762, "body": "Specify what you&#39;re intending to have done. It may be better to apply the formatting to everything and have the hide criteria in the <i>Formula1</i> property of the conditional formatting. This way if the data changes, the set of instructions will fire again without any macro being run. If you want your colors to stay static until the next macro runs or being changed manually, you may run the set of instructions with something along the lines of &quot;For Each rng In ActiveSheet.Range(&quot;C1:D50&quot;).SpecialCells(xlCellTypeVisible)&quot;&zwnj;&#8203;. You can still be right with your ways but it looks wrong to us."}], "answers": [{"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": -1, "last_activity_date": 1428009003, "last_edit_date": 1428009003, "creation_date": 1427926682, "answer_id": 29401846, "question_id": 29391717, "link": "https://stackoverflow.com/questions/29391717/conditional-formatting-select-only-visible-cells/29401846#29401846", "title": "Conditional formatting, select only visible cells", "body": "<p>You're headed the right way, see my sniplet below:  </p>\n\n<pre><code>Sub ert()\n\nDim rng As Range\nFor Each rng In ActiveSheet.Range(\"C1:D50\").SpecialCells(xlCellTypeVisible)\n    rng.Select\n    With Selection\n        .FormatConditions.Add Type:=xlExpression, Formula1:=\"=TRUE\" 'replace with your formula\n        .FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n        .FormatConditions(1).StopIfTrue = False\n        .FormatConditions(1).Interior.Color = 49407 'give it a touch of orange\n    End With\nNext\n\nEnd Sub\n</code></pre>\n\n<p>P.S. Noone tell him, gotta love the 1st of April. Will come back tomorrow.<br>\nEdit, back with more heat: let me highlight the <strong>.Select</strong> method emulates you selecting a <em>range</em> then the <strong>Selection.</strong> refers to the <em>range</em> selected. The <em>Select</em> in your code wastes resource and can cause errors (e.g. something cannot be selected so the <em>macro halts</em>, a selectionchange event <em>triggers</em> etc.) and looks <em>lousy</em>. For the above reasons (esp. lousiness) you don't select, you just define the range and then run the script for given range. This way you can save seconds of runtime while looking cool. The snipplet below is the cool variation of your sub-sub.  </p>\n\n<pre><code>Sub ert()\n    With ActiveSheet.Range(\"C1:D50\").SpecialCells(xlCellTypeVisible)\n        .FormatConditions.Add Type:=xlExpression, Formula1:=\"=TRUE\" 'replace with your formula\n        .FormatConditions(.FormatConditions.Count).SetFirstPriority\n        .FormatConditions(1).StopIfTrue = False\n        .FormatConditions(1).Interior.Color = 49407 'give it a touch of orange\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4738289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92125000edcc9396c22670af0f5d76b?s=128&d=identicon&r=PG&f=1", "display_name": "Avinash Khushalani", "link": "https://stackoverflow.com/users/4738289/avinash-khushalani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 771, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428009003, "creation_date": 1427893767, "last_edit_date": 1531164843, "question_id": 29391717, "link": "https://stackoverflow.com/questions/29391717/conditional-formatting-select-only-visible-cells", "title": "Conditional formatting, select only visible cells", "body": "<p>I have written code to select specific sheets and on button click email the data of all selected sheets. Now in one sheet there is conditional formatting applied on the dropdown list.</p>\n\n<p>So the requirement is when dropdown option 1 is chosen, then below two cells are not visible. Secondly when dropdown option 2 is selected then all cells are visible.</p>\n\n<p>With my code everything gets selected.</p>\n\n<p>I tried this code :</p>\n\n<pre><code>overallrange = ActiveSheet.Range(\"C1:D50\").SpecialCells(xlCellTypeVisible).Select \n</code></pre>\n\n<p>Can someone advice better ways to do this....</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427893259, "post_id": 29391341, "comment_id": 46960029, "body": "Looks like you have Unicode 8236 &amp; 8237 in there. Are the rogue characters restricted to these or are they all over the place."}, {"owner": {"reputation": 121, "user_id": 1199459, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d53d4de537b98c6b4a0596c56e9fdaa2?s=128&d=identicon&r=PG", "display_name": "James R", "link": "https://stackoverflow.com/users/1199459/james-r"}, "edited": false, "score": 0, "creation_date": 1427893686, "post_id": 29391341, "comment_id": 46960332, "body": "As far as I can tell they&#39;re just in that particular column, but there&#39;s possibly thousands of cells similar to that in there"}, {"owner": {"reputation": 121, "user_id": 1199459, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d53d4de537b98c6b4a0596c56e9fdaa2?s=128&d=identicon&r=PG", "display_name": "James R", "link": "https://stackoverflow.com/users/1199459/james-r"}, "reply_to_user": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "edited": false, "score": 0, "creation_date": 1427893740, "post_id": 29391341, "comment_id": 46960373, "body": "@Donkey Kong - I&#39;m just looking to remove those characters to stop the invalid procedure call, surely a wildcard in replace wouldn&#39;t remove them? Or am I missing something?"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 1199459, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d53d4de537b98c6b4a0596c56e9fdaa2?s=128&d=identicon&r=PG", "display_name": "James R", "link": "https://stackoverflow.com/users/1199459/james-r"}, "edited": false, "score": 0, "creation_date": 1427897908, "post_id": 29391847, "comment_id": 46963079, "body": "Thanks a lot, that did it, I&#39;ve managed to get rid of them all now."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1427894134, "creation_date": 1427894134, "answer_id": 29391847, "question_id": 29391341, "link": "https://stackoverflow.com/questions/29391341/excel-file-contains-invalid-hidden-characters-that-cant-be-removed/29391847#29391847", "title": "Excel file contains invalid hidden characters that can&#39;t be removed", "body": "<p>This VBA macro could be run on its own or in conjunction with the <code>ClearFormatting</code> macro. It did strip out the rogue unichars from the sample.</p>\n\n<pre><code>Sub strip_Rogue_Unichars()\n    Dim uc As Long\n    With Cells(11, 1).CurrentRegion\n        For uc = 8000 To 8390\n            .Replace what:=ChrW(uc), replacement:=vbNullString, lookat:=xlPart\n            DoEvents\n        Next uc\n    End With\nEnd Sub\n</code></pre>\n\n<p>There's probably a better way to do this and being able to restrict the scope of the Unicode characters to search and replace would obviously speed things up. Turning off <code>.EnableEvents</code>, <code>.ScreenUpdating</code>, etc would likewise help. I believe the calculation was already at manual. I intentionally left a <code>DoEvents</code> in the loop as my first run was several thousand different unichars.</p>\n"}], "owner": {"reputation": 121, "user_id": 1199459, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d53d4de537b98c6b4a0596c56e9fdaa2?s=128&d=identicon&r=PG", "display_name": "James R", "link": "https://stackoverflow.com/users/1199459/james-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "accepted_answer_id": 29391847, "answer_count": 1, "score": 0, "last_activity_date": 1427894134, "creation_date": 1427892719, "question_id": 29391341, "link": "https://stackoverflow.com/questions/29391341/excel-file-contains-invalid-hidden-characters-that-cant-be-removed", "title": "Excel file contains invalid hidden characters that can&#39;t be removed", "body": "<p>I have a peculiar problem with hidden characters in an Excel spreadsheet which uses VBA to create a text file. I've attached a link to a test version of the file, and I'll explain as best I can the issue.</p>\n\n<p>The file creates a plain txt file that can be used to feed data into a System we use. It works well normally, however we've been supplied approximately 15,000 rows of data, and at random points throughout there are hidden characters.</p>\n\n<p>In the test file, there's 1 row and it's cell B11 that has hidden characters at the beginning and end of the value. If you put your cursor at the end of it, and press the backspace key, it will look as if nothing has happened, but actually you've just deleted one of the characters.</p>\n\n<p>As far as Excel is concerned, those hidden characters are question marks, but they're not, as text stream would parse those, but it doesn't, and instead throws up an invalid procedure call error.</p>\n\n<p>I've tried using Excel's CLEAN formula, I've tried the VBA equivalent, tried using 'Replace', but nothing seems to recognise those characters. Excel is convinced they're just question marks, even an ASCII character call gives me the same answer (63), but replace doesn't replace them as question marks, it just omits them!</p>\n\n<p>Any help on this, even if it's just a formula I could apply would be appreciated. In the interests of data protection the data in the file is fake by the way, it's nobody's real NI number.</p>\n\n<p><a href=\"https://www.dropbox.com/s/5rlba663iqsxgus/SO%20test.xlsm?dl=0\" rel=\"nofollow\">The excel file with vba code is here</a></p>\n"}, {"tags": ["sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427892868, "post_id": 29391219, "comment_id": 46959760, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>. Show us what you&#39;ve got, and we&#39;ll help fix it. Not likely you&#39;ll get someone to do it for you."}, {"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427893379, "post_id": 29391219, "comment_id": 46960134, "body": "@ FreeMan, thanks for the reply. Just changed a bit. that may helpful  you to understand. Thanks"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427893692, "post_id": 29391219, "comment_id": 46960337, "body": "What code have you generated? Where are you getting errors in it? Again, probably won&#39;t be anyone here willing to write your code for you, but will be willing to help fix a specific issue."}], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 4737518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a103b051b000eae18aee5d80e73860c8?s=128&d=identicon&r=PG&f=1", "display_name": "Gino", "link": "https://stackoverflow.com/users/4737518/gino"}, "is_accepted": false, "score": -1, "last_activity_date": 1427893682, "creation_date": 1427893682, "answer_id": 29391688, "question_id": 29391219, "link": "https://stackoverflow.com/questions/29391219/conditional-formatting-for-background-color-using-vba/29391688#29391688", "title": "conditional formatting for background color using VBA?", "body": "<p>Found this that may help you:<br>\n<a href=\"https://technet.microsoft.com/en-us/library/ee692862.aspx\" rel=\"nofollow\">https://technet.microsoft.com/en-us/library/ee692862.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428359595, "post_id": 29476316, "comment_id": 47122116, "body": "Hi @Byron Wall, In <i>**For Each cell In Range(&quot;D2:D5&quot;)</i>. How can I set Range D5 value to max, because I really don&#39;t know how many rows will come in result. Thanks"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428360273, "post_id": 29476316, "comment_id": 47122362, "body": "There are probably better resources that address how to get the last value of a range for various cases.  Common patterns include: Range.End(xlDown), Range.SpecialCells(xlCellTypeLastCell), Intersect(Range.EntireColumn, Sheet.UsedRange).  The easiest if you are sure you will have more than 2 rows and there are no breaks is <code>For Each cell In Range(Range(&quot;D2&quot;), Range(&quot;D2&quot;).End(xlDown))</code>.  The .End function mimics hitting CTRL+&lt;ARROW&gt; on the keyboard in a given direction (e.g. Down).  Here is a popular SO thread: <a href=\"http://stackoverflow.com/questions/71180/\">stackoverflow.com/questions/71180</a>."}, {"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1428361213, "post_id": 29476316, "comment_id": 47122696, "body": "Hi @Byron Wall, Thanks for explanation."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1428341576, "creation_date": 1428341576, "answer_id": 29476316, "question_id": 29391219, "link": "https://stackoverflow.com/questions/29391219/conditional-formatting-for-background-color-using-vba/29476316#29476316", "title": "conditional formatting for background color using VBA?", "body": "<p>Changing the background color of a cell is simple.  Determining what color to change it to is the key step here.  If you know that those 4 colors are the only options, I would just pound out the cases and set the colors.  If you find this growing to more colors, you may want to define them in a Dictionary and do a lookup instead of the SELECT-CASE construction.</p>\n\n<p>This simple code would work with your example.  You will want to define the Range better (probably not \"D2:D5\") based on your real application and tweak the colors.</p>\n\n<pre><code>Sub ColorWithText()\n\n    Dim cell As Range\n\n    For Each cell In Range(\"D2:D5\")\n        Select Case UCase(cell.Value)\n            Case \"RED\"\n                cell.Interior.Color = RGB(255, 0, 0)\n            Case \"AMBER\"\n                cell.Interior.Color = RGB(255, 191, 0)\n            Case \"GREEN\"\n                cell.Interior.Color = RGB(0, 255, 0)\n            Case \"WHITE\"\n                cell.Interior.Color = RGB(255, 255, 255)\n        End Select\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>Here is a picture of my Excel instance after the code runs.\n<img src=\"https://i.stack.imgur.com/BNyEa.png\" alt=\"image with colors applied\"></p>\n"}], "owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1760, "favorite_count": 0, "accepted_answer_id": 29476316, "answer_count": 2, "score": 0, "last_activity_date": 1428341576, "creation_date": 1427892365, "last_edit_date": 1531164843, "question_id": 29391219, "link": "https://stackoverflow.com/questions/29391219/conditional-formatting-for-background-color-using-vba", "title": "conditional formatting for background color using VBA?", "body": "<p>I got VBA code to populate some T-SQL query data in an Excel file. In that data, one column contains values of Red, Amber, Green and N/A. Now I want background Color for according to those values (Red, Amber, Green and White). How can I do this in VBA?</p>\n\n<p><strong>Edited:</strong> I need Like this:</p>\n\n<pre><code>id firstname lastname complaint\n1  paul      nixon    RED\n2  John      nathon   RED\n3  sera      teag     AMBER\n4  CLARE     walker   GREEN\n</code></pre>\n\n<p>Now I want background color for column 'complaint' according to cell value, like if cell value RED I want that background color also RED etc.. in VBA code.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4729221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715e64ae8d722d30602285b26d7f2581?s=128&d=identicon&r=PG&f=1", "display_name": "Danulik Dan", "link": "https://stackoverflow.com/users/4729221/danulik-dan"}, "edited": false, "score": 0, "creation_date": 1429011749, "post_id": 29391635, "comment_id": 47395878, "body": "Great- thank you very much. On top Ihave replaced vlookup by index&amp;match and it is faster"}, {"owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "reply_to_user": {"reputation": 1, "user_id": 4729221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715e64ae8d722d30602285b26d7f2581?s=128&d=identicon&r=PG&f=1", "display_name": "Danulik Dan", "link": "https://stackoverflow.com/users/4729221/danulik-dan"}, "edited": false, "score": 0, "creation_date": 1429201998, "post_id": 29391635, "comment_id": 47498766, "body": "Please remember to vote/approve the answer for the benefit of future readers."}], "tags": [], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "is_accepted": false, "score": 0, "last_activity_date": 1427893499, "creation_date": 1427893499, "answer_id": 29391635, "question_id": 29390850, "link": "https://stackoverflow.com/questions/29390850/vba-vlookup-code-in-different-sheet/29391635#29391635", "title": "VBA vlookup code in different sheet", "body": "<p>If you are going to code the solution it would be better if you dimension the worksheets as such:</p>\n\n<pre><code>Dim sWS as worksheet   'Source worksheet\ndim tWS as worksheet   'Target worksheet\ndim aCell as range\n\nwith thisworkbook\n  set sws = .sheets(\"Data\")\n  set tws = .sheets(\"Sheet1\")\nend with\n\nfor each acell in sws.range(\"A3:A50\")\n  with tws\n     .cells(Dept_Row, Dept_Clm1).value = application....\n     'also check out the offset function for fetching values in cells to the left or right of the cell you are looping down through.\n  end with\nnext acell\n</code></pre>\n\n<p>Alternatively, check out the Match, Index and Indirect formulas on how to transfer data from one worksheet to another. The three functions are more efficient and accurate than vLookup, especially if you are transferring three cells from one worksheet to another. </p>\n"}], "owner": {"reputation": 1, "user_id": 4729221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715e64ae8d722d30602285b26d7f2581?s=128&d=identicon&r=PG&f=1", "display_name": "Danulik Dan", "link": "https://stackoverflow.com/users/4729221/danulik-dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1104, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1427893499, "creation_date": 1427891237, "question_id": 29390850, "link": "https://stackoverflow.com/questions/29390850/vba-vlookup-code-in-different-sheet", "title": "VBA vlookup code in different sheet", "body": "<p>I am new to VBA.\nI have 2 sheets under my excel: \"Data\", \"Sheet1\".Data sheet is amended every day.\nI would like to use vlookup VBA macro to rows added to column A in Sheet1. However my code doesn't give me any results (it works if I run macro under same sheet where data are). Thank you</p>\n\n<pre><code>Private Sub CommandButton21_Click()\nOn Error Resume Next\nSheet1.Range(\"B3:D500\").Clear\nDim Dept_Row As Long\nDim Dept_Clm As Long\nTable1 = Sheet1.Range(\"A3:A50\")\nTable2 = Data.Range(\"A3:H24\")\nDept_Row = Sheet1.Range(\"B3\").Row\nDept_Clm1 = Sheet1.Range(\"B3\").Column\nDept_Clm2 = Sheet1.Range(\"C3\").Column\nDept_Clm3 = Sheet1.Range(\"D3\").Column\nFor Each cl In Table1\n  Sheet1.Cells(Dept_Row, Dept_Clm1) = Application.WorksheetFunction.VLookup(cl, Table2, 6, False)\n  Sheet1.Cells(Dept_Row, Dept_Clm2) = Application.WorksheetFunction.VLookup(cl, Table2, 7, False)\n  Sheet1.Cells(Dept_Row, Dept_Clm3) = Application.WorksheetFunction.VLookup(cl, Table2, 8, False)    \n  Dept_Row = Dept_Row + 1\nNext cl\nMsgBox \"Done\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel", "hebrew"], "answers": [{"comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1427891852, "post_id": 29390933, "comment_id": 46959108, "body": "I updated the answer. BTW, you should watch out for word boundaries, in VBA, you can always rely on anchors (<code>^</code> and <code>$</code>) and also on word boundaries (<code>\\b</code>). Also, please visit <a href=\"http://www.regular-expressions.info/vb.html\" rel=\"nofollow noreferrer\">regular-expressions.info/vb.html</a> and <a href=\"http://www.regular-expressions.info/vbscript.html\" rel=\"nofollow noreferrer\">regular-expressions.info/vbscript.html</a> for more details on VBA regexes."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1427891606, "last_edit_date": 1427891606, "creation_date": 1427891464, "answer_id": 29390933, "question_id": 29390824, "link": "https://stackoverflow.com/questions/29390824/how-to-create-a-regex-for-non-english-letters-with-vbas-regex-5-5/29390933#29390933", "title": "how to create a regex for non-english letters with vba&#39;s regex 5.5", "body": "<p>You can create your own character class, and use it in your code:</p>\n\n<pre><code>Dim hw As String\nhw = \"[\u05d0\u05d1\u05d2\u05d3\u05d4\u05d5\u05d6\u05d7\u05d8\u05d9\u05db\u05dc\u05de\u05e0\u05e1\u05e2\u05e4\u05e6\u05e7\u05e8\u05e9\u05ea\u05dd\u05df\u05e3\u05e5]+\"\nregEx.Pattern = \"^\" + hw + \"$\" ' to match an isolated Hebrew word\n</code></pre>\n\n<p>or </p>\n\n<pre><code>regEx.Pattern = hw + \" \" + hw ' to match two Hebrew words separated with a space\n</code></pre>\n\n<p>However, you cannot \"name\" it to address like <code>\\hw</code>.</p>\n"}], "owner": {"reputation": 1280, "user_id": 1716131, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d64185406d74353f4349a0855b608834?s=128&d=identicon&r=PG", "display_name": "Avishay Cohen", "link": "https://stackoverflow.com/users/1716131/avishay-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 29390933, "answer_count": 1, "score": 0, "last_activity_date": 1427891606, "creation_date": 1427891182, "last_edit_date": 1531164843, "question_id": 29390824, "link": "https://stackoverflow.com/questions/29390824/how-to-create-a-regex-for-non-english-letters-with-vbas-regex-5-5", "title": "how to create a regex for non-english letters with vba&#39;s regex 5.5", "body": "<p>I'm working with VBA, and started using the RegEX library, for finding numerals and/or english text I had no problem so far, but now i need to use it on text fields that contain a mix of numbers and hebrew letters (addresses that has several possible formats).</p>\n\n<p>I have managed to use it in a \"dumb\" way, i can find literals and some short patterns (such as, finding any combination that means a postal box - a two letter combined with any non-letter non number between them), but I can't use something like <code>\\w</code> for english - and that would make my life a whole lot better.</p>\n\n<p>is there anyway to create \"custom\" regular expressions and save them as variables? for example i would like to make this (a regEx for a single hebrew word):</p>\n\n<pre><code>regEx.Pattern = \"(\u05d0|\u05d1|\u05d2|\u05d3|\u05d4|\u05d5|\u05d6|\u05d7|\u05d8|\u05d9|\u05db|\u05dc|\u05de|\u05e0|\u05e1|\u05e2|\u05e4|\u05e6|\u05e7|\u05e8|\u05e9|\u05ea|\u05dd|\u05df|\u05e3|\u05e5)+\"\n</code></pre>\n\n<p>and save it as <code>\\\u05de</code> for instance or even a <code>\\hw</code> (short for hebrew word), as i need to make several types of patterns and several possible formats to recognize, and it will save me a lot of frustration (as already the IDE don't have the best interactions with hebrew letters).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 5, "creation_date": 1427891586, "post_id": 29390797, "comment_id": 46958940, "body": "Is there a reason you need this? If you use <code>LBound</code> and <code>UBound</code> it doesn&#39;t matter which setting is used."}, {"owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1427891929, "post_id": 29390797, "comment_id": 46959158, "body": "You may define an array and look if <code>LBound</code> is <code>0</code> or <code>1</code>. But if the` option base`  is determined by coder, why same person need to find it. Search the <code>Option Base</code> statement in the code to find it."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1427893102, "post_id": 29390797, "comment_id": 46959930, "body": "Downvoter/Close voter. It would be nice if you left a comment explaining what you find so unclear. Looks pretty clear to me."}], "answers": [{"comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 1, "creation_date": 1427893960, "post_id": 29391457, "comment_id": 46960495, "body": "Isn&#39;t it easier to just create an array and check its <code>LBound</code>?"}, {"owner": {"reputation": 2289, "user_id": 470014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-Vp8vKkWxtwE/AAAAAAAAAAI/AAAAAAAAENo/ZP9OI9J-5t0/photo.jpg?sz=128", "display_name": "Caltor", "link": "https://stackoverflow.com/users/470014/caltor"}, "edited": false, "score": 0, "creation_date": 1427894006, "post_id": 29391457, "comment_id": 46960532, "body": "Awesome answer and I expect one could easily modify this to work with other <code>Option</code>s and maybe even create the hallowed Option() function for which I seek. @jonsharpe is right it was a somewhat academic question but I am glad you found it interesting too. It&#39;s a beast of a routine though and scrolling to the top of the module (yes I know about Ctrl+Home) doesn&#39;t seem like such a bad idea after all. ;)"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1427894046, "post_id": 29391457, "comment_id": 46960556, "body": "Yeah. Sure it is @jonrsharpe, but that&#39;s not what OP asked."}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 1, "creation_date": 1427894127, "post_id": 29391457, "comment_id": 46960618, "body": "@RubberDuck strictly, they asked for <i>&quot;any easy way to find out what the current setting is&quot;</i>! But this is a thorough answer nonetheless."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1427894224, "post_id": 29391457, "comment_id": 46960687, "body": "Thanks @jonrsharpe. The VBIDE is an area of interest for me."}, {"owner": {"reputation": 2289, "user_id": 470014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-Vp8vKkWxtwE/AAAAAAAAAAI/AAAAAAAAENo/ZP9OI9J-5t0/photo.jpg?sz=128", "display_name": "Caltor", "link": "https://stackoverflow.com/users/470014/caltor"}, "edited": false, "score": 0, "creation_date": 1427894396, "post_id": 29391457, "comment_id": 46960797, "body": "@RubberDuck Thanks. Looks like you actually have a practical application for this."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1427894676, "post_id": 29391457, "comment_id": 46960956, "body": "Well technically the Rubberduck inspection <i>does</i> find <code>Option Base 1</code> - only the quick fix for removing it isn&#39;t implemented for the reasons described in the GitHub issue you linked to ;)"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 2289, "user_id": 470014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-Vp8vKkWxtwE/AAAAAAAAAAI/AAAAAAAAENo/ZP9OI9J-5t0/photo.jpg?sz=128", "display_name": "Caltor", "link": "https://stackoverflow.com/users/470014/caltor"}, "edited": false, "score": 0, "creation_date": 1427906126, "post_id": 29391457, "comment_id": 46968608, "body": "No @Caltor. It wasn&#39;t. I didn&#39;t realize the feature was implemented, so I updated my answer."}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": true, "score": 8, "last_activity_date": 1427895964, "last_edit_date": 1592644375, "creation_date": 1427893049, "answer_id": 29391457, "question_id": 29390797, "link": "https://stackoverflow.com/questions/29390797/how-to-programmatically-determine-current-setting-for-option-base-in-vba/29391457#29391457", "title": "How to programmatically determine current setting for Option Base in VBA", "body": "<p>While I agree with @jonsharpe that if you're using <code>Lbound(arr)</code> and <code>Ubound(arr)</code>, you don't need to know this at runtime, but I think it's an interesting question.</p>\n<p>First, an example of properly looping through an array.</p>\n<pre><code>For i = LBound(arr) To Ubound(arr)\n    ' do something\nNext\n</code></pre>\n<hr />\n<p>Now, in order to do <em>exactly</em> what you asked, you'll need to access use the <code>VBIDE</code> library. Otherwise known as the &quot;Microsoft Visual Basic for Applications Extensibility&quot; library. It provides access to the IDE and the code with-in it. You can use it to discover if <code>Option Base 1</code> has been declared. I don't recommend trying to do it at runtime though. This would be more useful as a kind of static code analysis during development.</p>\n<p>First, you'll need to <a href=\"https://stackoverflow.com/a/26515446/3198973\">add a reference to the library</a> and <a href=\"https://stackoverflow.com/a/23738721/3198973\">grant the code access to itself</a>. Once you've done that, the following code should do what you would like.</p>\n<pre><code>Public Sub FindOptionBase1Declarations()\n    \n    Dim startLine As Long\n    startLine = 1\n    \n    Dim startCol As Long\n    startCol = 1\n    \n    Dim endLine As Long\n    endLine = 1 ' 1 represents the last line of the module\n    \n    Dim endCol As Long\n    endCol = 1 ' like endLine, 1 designates the last Col\n    \n    Dim module As CodeModule\n    Dim component As VBComponent\n    For Each component In Application.VBE.ActiveVBProject.VBComponents ' substitute with any VBProject you like\n        Set module = component.CodeModule\n        \n        If module.Find(&quot;Option Base 1&quot;, startLine, startCol, endLine, endCol, WholeWord:=True, MatchCase:=True, PatternSearch:=False) Then\n            \n            Debug.Print &quot;Option Base 1 turned on in module &quot; &amp; component.Name\n            \n            ' variables are passed by ref, so they tell us the exact location of the statement\n            Debug.Print &quot;StartLine: &quot; &amp; startLine\n            Debug.Print &quot;EndLine: &quot; &amp; endLine\n            Debug.Print &quot;StartCol: &quot; &amp; startCol\n            Debug.Print &quot;EndCol: &quot; &amp; endCol\n            \n            ' this also means we have to reset them before we look in the next module\n            startLine = 1\n            startCol = 1\n            endLine = 1\n            endCol = 1\n        End If\n        \n    Next \n    \nEnd Sub\n</code></pre>\n<p>See the <a href=\"https://msdn.microsoft.com/en-us/library/aa443952(v=vs.60).aspx\" rel=\"nofollow noreferrer\">CodeModule.Find documentation</a> for more information.</p>\n<hr />\n<p>If using an add-in is an option, @Mat'sMug and I's open source project <a href=\"http://www.rubberduck-vba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a> has a <a href=\"https://github.com/retailcoder/Rubberduck/wiki/Code-Inspections\" rel=\"nofollow noreferrer\">Code Inspection</a> that will show you all instances of this throughout the active project.</p>\n<p><img src=\"https://i.stack.imgur.com/uhfMk.png\" alt=\"Option Base 1 Code Inspection\" /></p>\n<p><a href=\"https://github.com/retailcoder/Rubberduck/wiki/OptionBaseInspection\" rel=\"nofollow noreferrer\">See this for more information on that particular inspection</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1427906209, "post_id": 29396145, "comment_id": 46968663, "body": "Nice solution. I wonder if you could one line this successfully in the immediate window."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1427906297, "post_id": 29396145, "comment_id": 46968714, "body": "@RubberDuck sure just change it to a function and return the <code>LBound</code> instead of printing it and you can use it in the Immediate no problem."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1427906335, "post_id": 29396145, "comment_id": 46968739, "body": "@RubberDuck -  I don&#39;t know what context that would run in (if you ran it completely in the Immediate window) - might be unreliable since you can have different Base settings in each code module."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1427906404, "post_id": 29396145, "comment_id": 46968784, "body": "Maybe... It&#39;s worth noting that Option Base is at the module level, so this function will return the value for the module it&#39;s defined in, not where it&#39;s called from."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1427906448, "post_id": 29396145, "comment_id": 46968816, "body": "Lol. Yes. I&#39;m lagging. My thoughts exactly."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1427906055, "creation_date": 1427906055, "answer_id": 29396145, "question_id": 29390797, "link": "https://stackoverflow.com/questions/29390797/how-to-programmatically-determine-current-setting-for-option-base-in-vba/29396145#29396145", "title": "How to programmatically determine current setting for Option Base in VBA", "body": "<pre><code>Function GetBaseOption() As Long\n\n    Dim arr\n\n    arr = Array(\"a\")\n    GetBaseOption = LBound(arr)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1567000876, "creation_date": 1567000876, "answer_id": 57694242, "question_id": 29390797, "link": "https://stackoverflow.com/questions/29390797/how-to-programmatically-determine-current-setting-for-option-base-in-vba/57694242#57694242", "title": "How to programmatically determine current setting for Option Base in VBA", "body": "<h2>Simply use:</h2>\n\n<pre><code>LBound(Array())\n</code></pre>\n\n<p>...to return the current <strong><a href=\"https://docs.microsoft.com/office/vba/language/reference/user-interface-help/option-base-statement\" rel=\"nofollow noreferrer\"><code>Option Base</code></a></strong> setting.</p>\n\n<hr>\n\n<h2>Or, as a function:</h2>\n\n<pre><code>Function optionBase() As Byte\n  optionBase = LBound(Array())\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2289, "user_id": 470014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-Vp8vKkWxtwE/AAAAAAAAAAI/AAAAAAAAENo/ZP9OI9J-5t0/photo.jpg?sz=128", "display_name": "Caltor", "link": "https://stackoverflow.com/users/470014/caltor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1607, "favorite_count": 1, "accepted_answer_id": 29391457, "answer_count": 3, "score": 8, "last_activity_date": 1567000876, "creation_date": 1427891121, "last_edit_date": 1427892500, "question_id": 29390797, "link": "https://stackoverflow.com/questions/29390797/how-to-programmatically-determine-current-setting-for-option-base-in-vba", "title": "How to programmatically determine current setting for Option Base in VBA", "body": "<p>How can I programmatically determine the current setting for <code>Option Base</code> in VBA? The <code>Option Base</code> can be set to <code>0</code> or <code>1</code>, and this determines whether array indices start at <code>0</code> or <code>1</code> (see <a href=\"https://msdn.microsoft.com/en-us/library/aa266179%28v=vs.60%29.aspx\">MSDN</a>).</p>\n\n<p>However, I can't see any easy way to find out what the current setting is. I was hoping there might be an <code>Option()</code> function that I could pass a parameter to, something like:</p>\n\n<pre><code>Debug.Print Option(\"Base\")\n</code></pre>\n\n<p>and it would tell me, but it doesn't seem to be there.  </p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427891084, "post_id": 29390673, "comment_id": 46958595, "body": "What color should it be if there is an error in the cell?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 2, "creation_date": 1427891293, "post_id": 29390673, "comment_id": 46958745, "body": "Don&#39;t. No. <code>On Error Resume Next</code> simply <b><i>swallows</i></b> errors. You need to figure out how to <i>avoid</i> the error to begin with.  On another note, it seems you could accomplish this with <a href=\"http://www.excel-easy.com/data-analysis/conditional-formatting.html\" rel=\"nofollow noreferrer\">Conditional Formatting</a>."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1427891348, "post_id": 29390673, "comment_id": 46958777, "body": "You also might want to read through some of <a href=\"http://stackoverflow.com/questions/tagged/error-handling+vba?sort=votes&amp;pageSize=50\">these questions</a>."}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 9, "last_activity_date": 1427891503, "last_edit_date": 1525816098, "creation_date": 1427891503, "answer_id": 29390944, "question_id": 29390673, "link": "https://stackoverflow.com/questions/29390673/error-handling-in-vba-on-error-resume-next/29390944#29390944", "title": "Error handling in VBA - on error resume next", "body": "<p>It depends on what you want to do.</p>\n\n<ul>\n<li><code>On Error Resume Next</code> will ignore the fact that the error occurred. This is a great way to get your code to execute to completion, but <em>will just about guarantee that it <strong>won't</strong> do what you want</em>.</li>\n<li><code>On Error Goto 0</code> is the default response. It will pop up the error message that VBA is generating</li>\n<li><code>On Error Goto &lt;label&gt;</code> will cause your code to jump to a specified label when an error occurs and allows you to take an appropriate action based on the error code.</li>\n</ul>\n\n<p>The last option, <code>On Error Goto &lt;label&gt;</code> is usually the most useful, and you'll want to do some digging on how to best use it for your application.</p>\n\n<p><a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"noreferrer\">This site</a> is where I got the details above from, and is usually the first results that comes from <a href=\"https://www.google.com/search?q=excel+vba+on+error&amp;ie=utf-8&amp;oe=utf-8\" rel=\"noreferrer\">Googling for \"excel vba on error\"</a>. I've used that reference myself a number of times.</p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1427891697, "post_id": 29390963, "comment_id": 46959017, "body": "As @Freeman said a few seconds before I posted - and Chip Pearsons site is probably where I got the above code from in the first place all those years ago."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 4, "last_activity_date": 1427891578, "creation_date": 1427891578, "answer_id": 29390963, "question_id": 29390673, "link": "https://stackoverflow.com/questions/29390673/error-handling-in-vba-on-error-resume-next/29390963#29390963", "title": "Error handling in VBA - on error resume next", "body": "<p>I generally try to avoid On Error Resume Next as it will try to continue no matter what the error (there are some cases where it's useful though).</p>\n\n<p>The code below passes all errors out of the procedure where they can be handled on a case by case basis.</p>\n\n<pre><code>Sub test1()\n\n    Dim n As Double\n\n    On Error GoTo ERROR_HANDLER\n\n        n = 1 / 0  ' cause an error\n\n    On Error GoTo 0\n    Exit Sub\n\nERROR_HANDLER:\n    Select Case Err.Number\n        Case 11 'Division by zero\n            n = 1\n            Err.Clear\n            Resume Next\n        Case 13 'Type mismatch\n\n        Case Else\n            'Unhandled errors.\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure test1.\"\n            Err.Clear\n\n    End Select\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "edited": false, "score": 0, "creation_date": 1532528828, "post_id": 29391071, "comment_id": 90011575, "body": "I am using this solution to help my error catching code if a Vlookup cant find anything and I get the error &quot;Expected Array&quot;. do you have to use the <code>.Cells(row, col)</code> format?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "edited": false, "score": 0, "creation_date": 1532529322, "post_id": 29391071, "comment_id": 90011937, "body": "If you are using worksheetfunction.vlookup or application.worksheetfunction.vlookup then switch to application.vlookup. The IsError or a variant will catch no match errors."}, {"owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "edited": false, "score": 0, "creation_date": 1532530041, "post_id": 29391071, "comment_id": 90012465, "body": "I am using the Vlookup within the spreadsheet. The VBA code pastes the lookup value into a cell, then stores all the return values as variables as well. I did it this way to avoid looping through 60,000 lines looking for the lookup value."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "edited": false, "score": 0, "creation_date": 1532530304, "post_id": 29391071, "comment_id": 90012640, "body": "This may be too involved to be resolved in comments. Please post a new question with all the details."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 7, "last_activity_date": 1427891936, "creation_date": 1427891936, "answer_id": 29391071, "question_id": 29390673, "link": "https://stackoverflow.com/questions/29390673/error-handling-in-vba-on-error-resume-next/29391071#29391071", "title": "Error handling in VBA - on error resume next", "body": "<p>I have interpreted your requirement as to how to handle common worksheet errors when looping through a range of cells and examining the values. If you attempt to look at a cell that contains an error (e.g. #N/A, #DIV/0!, #VALUE!, etc) you will get something like:</p>\n\n<pre><code>Runtime error '13':\nType mismatch.\n</code></pre>\n\n<p>These can be caught with VBA's <a href=\"https://msdn.microsoft.com/en-us/library/s55kc30t\" rel=\"noreferrer\">IsError function</a>.</p>\n\n<pre><code>Dim rw As Long\n\nWith ThisWorkbook.Sheets(TsSh)\n    For rw = StRw To LsRw\n        If IsError(.Cells(rw, 1)) Then\n            .Cells(rw, 1).Interior.ColorIndex = 10\n        ElseIf Not CBool(Len(.Cells(rw, 1).Value2)) Then\n            .Cells(rw, 1).Interior.ColorIndex = 46\n        End If\n    Next rw\nEnd With\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/L2AyS.png\" alt=\"IsError against worksheet errors/values\"></p>\n\n<p>In the above, I am catching the cells with an error and coloring them green. Note that I am examining them for errors <em>before</em> I check for a zero length.</p>\n"}], "owner": {"reputation": 43, "user_id": 4733887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c0c0261660b0c67ac562e7d47a2e35?s=128&d=identicon&r=PG&f=1", "display_name": "Csaba Nov&#225;ky", "link": "https://stackoverflow.com/users/4733887/csaba-nov%c3%a1ky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23525, "favorite_count": 0, "accepted_answer_id": 29391071, "answer_count": 3, "score": 4, "last_activity_date": 1520346586, "creation_date": 1427890761, "last_edit_date": 1520346586, "question_id": 29390673, "link": "https://stackoverflow.com/questions/29390673/error-handling-in-vba-on-error-resume-next", "title": "Error handling in VBA - on error resume next", "body": "<p>I have the following code:</p>\n\n<pre><code>ErrNr = 0\nFor Rw = StRw To LsRw 'ToDo speed up with fromrow torow\n    If Len(ThisWorkbook.Sheets(TsSh).Cells(Rw, TsCl)) = 0 Then\n        ThisWorkbook.Sheets(TsSh).Cells(Rw, TsCl).Interior.ColorIndex = 46\n        ErrNr = ErrNr + 1\n    End If\nNext\n</code></pre>\n\n<p>My problem is if there is an error on the page, my code is not running after that. I think the solution should be with:</p>\n\n<pre><code>On Error Resume Next\nN = 1 / 0    ' cause an error\nIf Err.Number &lt;&gt; 0 Then \n    N = 1\nEnd If\n</code></pre>\n\n<p>But I don't know how to use this code.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427887479, "post_id": 29389231, "comment_id": 46956317, "body": "Is it possible that he can press &quot;Debug&quot; after the error pops up? And see what line is causing an error?"}, {"owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427887612, "post_id": 29389231, "comment_id": 46956402, "body": "@BranislavKoll&#225;r No :("}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427888194, "post_id": 29389231, "comment_id": 46956770, "body": "The <i>&quot; &#39;Path to the document on MY computer&#39; &quot;</i> can be interpreted as <i>&quot; &#39;Path to the document on Joakim M computer&#39; &quot;</i>?"}, {"owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427888467, "post_id": 29389231, "comment_id": 46956938, "body": "@BranislavKoll&#225;r Yes :)"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1427888817, "post_id": 29389231, "comment_id": 46957169, "body": "Are you being serious?"}, {"owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1427888987, "post_id": 29389231, "comment_id": 46957272, "body": "@user3819867 What&#39;s not to be serious about?"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1427889063, "post_id": 29389231, "comment_id": 46957324, "body": "Does given user have access to your folder?"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1427889175, "post_id": 29389231, "comment_id": 46957391, "body": "I have faced a similar issue though when I tried to run a macro written in MS <i>Excel 2010</i> on a PC with <i>Excel 2007</i>."}, {"owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1427889290, "post_id": 29389231, "comment_id": 46957451, "body": "@user3819867 I am not sharing the document. I am sending the document to him via mail. My macro is in no way depending on my computer&#39;s folders. Or shouldn&#39;t be anyhow. That is why I am so confused about the error message."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1427889531, "post_id": 29389231, "comment_id": 46957588, "body": "I don&#39;t have 2013 to test on, but can you browse the properties of <code>.FileDialog</code> to see if there&#39;s a Default Directory property that you could set? It could be that the default directory is somehow &#39;stuck&#39; on a path on <i>your</i> machine, and if you set it to something like <code>%My Documents%</code> in your code, it may resolve that at run-time and pick up your coworker&#39;s <code>MyDocuments</code> instead of trying to access yours."}, {"owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427889615, "post_id": 29389231, "comment_id": 46957638, "body": "@FreeMan I will try it out! Thanks!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1427889654, "post_id": 29389231, "comment_id": 46957661, "body": "In re: my comment above, try setting <code>.InitialFileName</code> &quot;Set or returns a String representing the <i>path</i> or file name that is initially displayed in a file dialog box.&quot;. Took me a minute to find it in the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff863983.aspx\" rel=\"nofollow noreferrer\">MS Docs</a>"}, {"owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "edited": false, "score": 1, "creation_date": 1427889942, "post_id": 29389231, "comment_id": 46957836, "body": "I am setting InitialFileName :("}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 1, "creation_date": 1427891134, "post_id": 29389231, "comment_id": 46958634, "body": "This error can be non-macro issue. Do you have some data links (normal Excel feature, Data - connections) in the workbook? Some formulas using specified paths, some other connections to tables? <a href=\"http://docs.deltadna.com/dd-content/uploads/2014/08/connections.jpg\" rel=\"nofollow noreferrer\">Ilustration of what I mean</a>"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427891374, "post_id": 29389231, "comment_id": 46958806, "body": "Btw, there is no such thing as <b>Macro enabled Excel document</b>. The macro security settings are application dependent (each user has his own). So if your collegue wants to use the macro, he needs to allow it (either by clicking one time popup &quot;Enable content&quot; or something like that on every workbook opening, or the application settings). But I&#39;m sure you have this covered."}, {"owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 1, "creation_date": 1427891680, "post_id": 29389231, "comment_id": 46959002, "body": "@BranislavKoll&#225;r The correct name should be Excel macro-enabled workbook (see my attached image). Sorry about that."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427892024, "post_id": 29389231, "comment_id": 46959227, "body": "Ou, that was a bit stupid from my side. I forgot that the xlsm files are defined like that. <i>Me, Nooob</i>. But please, see my preceding comment, about the non-macro issue. What do you think about that?"}, {"owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427892404, "post_id": 29389231, "comment_id": 46959465, "body": "@BranislavKoll&#225;r Looking into it. And I will probably be placed in the Noob-compartment myself..."}, {"owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 1, "creation_date": 1427892713, "post_id": 29389231, "comment_id": 46959652, "body": "@BranislavKoll&#225;r Calling the same macro from a button inside the sheet fixed (avoided is the correct word) the problem."}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "is_accepted": false, "score": 0, "last_activity_date": 1428032094, "creation_date": 1428032094, "answer_id": 29425835, "question_id": 29389231, "link": "https://stackoverflow.com/questions/29389231/shared-excel-macro-enabled-workbook-excel-cannot-access-the-file-issue/29425835#29425835", "title": "Shared Excel macro enabled workbook - Excel cannot access the file issue", "body": "<p>Send the code for them to insert into a macro to run it and see if they get the same error. It ran fine for me (except that I define my variables).</p>\n\n<p>It could be that their copy of Excel is not set up to trust VBA. (Under Settings.)</p>\n"}], "owner": {"reputation": 1683, "user_id": 1223609, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lzYx1.jpg?s=128&g=1", "display_name": "Joakim M", "link": "https://stackoverflow.com/users/1223609/joakim-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1362, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428032094, "creation_date": 1427886569, "last_edit_date": 1427896269, "question_id": 29389231, "link": "https://stackoverflow.com/questions/29389231/shared-excel-macro-enabled-workbook-excel-cannot-access-the-file-issue", "title": "Shared Excel macro enabled workbook - Excel cannot access the file issue", "body": "<p><strong>What I want to do.</strong> </p>\n\n<p>Send my Macro enabled Excel document to my colleagues with a working macro that opens a save file dialog and then generates this csv.</p>\n\n<p><strong>What have I done?</strong></p>\n\n<p>I have made a VBA-macro in Excel 2013 and it works fine on my machine. However, when I send this Macro enabled excel-sheet to my colleague he gets:</p>\n\n<p>Microsoft Office Excel cannot access the file 'Path to the document on MY computer'. There are several possible reasons:</p>\n\n<ul>\n<li>The file name or path does not exist.</li>\n<li>The file is being used by another program.</li>\n<li>The workbook you are trying to save has the same name as a currently open workbook</li>\n</ul>\n\n<p>My Source:</p>\n\n<pre><code>Sub Convert2CSV()\n    Dim fileName As String\n    fileName = \"OrderSedel_\" &amp; Format(Now, \"yyyy-mm-dd hh mm\") &amp; \".csv\"\n\n    With Application.FileDialog(msoFileDialogSaveAs)\n            .Title = \"xxx\"\n            .AllowMultiSelect = False\n            .InitialFileName = fileName\n            .FilterIndex = 15\n            result = .Show\n            If (result &lt;&gt; 0) Then\n                ' create file\n                fileName = Trim(.SelectedItems.Item(1))\n                fnum = FreeFile\n                Open fileName For Output As fnum\n\n\n                ' Write the csv data from form record set\n                For i = 7 To ActiveSheet.UsedRange.Rows.Count\n                    If ( _\n                        (Not Trim(Cells(i, 1).Value &amp; vbNullString) = vbNullString Or _\n                        Not Trim(Cells(i, 3).Value &amp; vbNullString) = vbNullString) And _\n                        Not Trim(Cells(i, 9).Value &amp; vbNullString) = vbNullString) Then\n                            'Check EAN (Trim). If No EAN get Bolist ArtNum\n                            If (Trim(Cells(i, 3).Value &amp; vbNullString) = vbNullString) Then\n                                Print #fnum, Cells(i, 1).Value &amp; \";\" &amp; Cells(i, 9).Value\n                                Else\n                                Print #fnum, Cells(i, 3).Value &amp; \";\" &amp; Cells(i, 9).Value\n                                End If\n                    End If\n                Next i\n\n\n\n            ' close file\n            Close #fnum\n            End If\n      End With\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/BGSWV.png\" alt=\"Screenshot of file xlsm\"></p>\n"}, {"tags": ["ms-access", "sql-server-2008-r2", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1427888944, "post_id": 29388885, "comment_id": 46957249, "body": "should the schema name be prefixed before the function name ie. dbo.fn_validate_user"}, {"owner": {"reputation": 63, "user_id": 4737658, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6d241c7a4fb7e84e38acda5d476fadfb?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4737658/kunal"}, "reply_to_user": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1427890643, "post_id": 29388885, "comment_id": 46958312, "body": "I tried with and without schema name but it does not help. I also tried adding the DB name on top of schema name without any success"}], "answers": [{"tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1427892300, "creation_date": 1427892300, "answer_id": 29391198, "question_id": 29388885, "link": "https://stackoverflow.com/questions/29388885/calling-a-udf-sql-server-from-vb-access-undefined-function-function-name-in/29391198#29391198", "title": "Calling a UDF (Sql server) from VB Access &quot;Undefined function &lt;function name&gt; in expression&quot;", "body": "<p>When you run a standard query in Access it is first processed by the Access Database Engine, even if that query refers to ODBC linked tables. Access can recognize <em>Access</em> user-defined functions (created with VBA) but it is not aware of SQL Server user-defined functions.</p>\n\n<p>In order to use a SQL Server user-defined function you need to use a pass-through query. As the name suggests, it bypasses the Access Database Engine and sends the query directly to the remote database (via ODBC). The VBA code to do that would look something like this:</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Dim db As DAO.Database, qdf As DAO.QueryDef, recset As DAO.Recordset\nDim sSQL As String, PasswordValid As Boolean\nSet db = CurrentDb\nsSQL = \"SELECT fn_validate_user(\" &amp; gb_UserId &amp; \",'\" &amp; Hash(Me.txt_Password + cbo_User) &amp; \"') AS PasswordValid\"\nSet qdf = db.CreateQueryDef(\"\")\n' get .Connect property from existing ODBC linked table\nqdf.Connect = db.TableDefs(\"TBL_User_Login\").Connect\nqdf.ReturnsRecords = True\nqdf.SQL = sSQL\nSet recset = qdf.OpenRecordset(dbOpenSnapshot)\nPasswordValid = recset.Fields(\"PasswordValid\").Value\nrecset.Close\nSet recset = Nothing\nSet qdf = Nothing\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4737658, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6d241c7a4fb7e84e38acda5d476fadfb?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4737658/kunal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 29391198, "answer_count": 1, "score": 2, "last_activity_date": 1594645094, "creation_date": 1427885400, "last_edit_date": 1594645094, "question_id": 29388885, "link": "https://stackoverflow.com/questions/29388885/calling-a-udf-sql-server-from-vb-access-undefined-function-function-name-in", "title": "Calling a UDF (Sql server) from VB Access &quot;Undefined function &lt;function name&gt; in expression&quot;", "body": "<p>I am trying to call a udf (SQL server) from Vb code in access. Connection to DB was successful and I am able to run queries on SQL server tables. However, when I try to call the UDF, it throws me an error saying <strong>undefined function</strong>.</p>\n\n<p>Please see the code below:</p>\n\n<pre><code>Private Sub cmd_Login_Click()\n    ' some code here\n    Set db = CurrentDb()\n\n    sSQL = \"SELECT UserID FROM TBL_User_Login WHERE UserName = '\" &amp; cbo_User &amp; \"' AND Status = 0\"\n    Set recset = db.OpenRecordset(sSQL)\n\n\n    recset.Close\n    Set rectset = Nothing\n\n    sSQL = \"SELECT fn_validate_user(\" &amp; gb_UserId &amp; \",'\" &amp; Hash(Me.txt_Password + cbo_User) &amp; \"') AS PasswordValid\"\n    Set recset = db.OpenRecordset(sSQL)  ' this is where i get error for undefined function fn_validate_user\n    PasswordValid = recset(\"PasswordValid\")\n</code></pre>\n\n<p>Can someone see if I am missing something here.</p>\n"}, {"tags": ["excel", "vba", "shapes"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1427888299, "post_id": 29388109, "comment_id": 46956839, "body": "Which cell in column <b>A</b> should be used to locate the <i>Shapes ??</i>"}, {"owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1427891327, "post_id": 29388109, "comment_id": 46958768, "body": "I&#39;m searching for something like <code>coords = shape1.position</code> or something. The shapes aren&#39;t to be located from column A. Something like <code>range(&quot;b1&quot;).countShapes</code>, and something like <code>shape1.position = coords</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427896879, "post_id": 29388109, "comment_id": 46962380, "body": "A shape has a <code>Top</code> and <code>Left</code> properties. It also has a <code>TopLeftCell</code> property which is assigned a Range object. You can use these properties to position the shapes to a cell and relative to other shapes (by adding the <code>.Width</code> to the <code>.Left</code> of the previous shape, etc."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 2, "last_activity_date": 1427898370, "creation_date": 1427898370, "answer_id": 29393416, "question_id": 29388109, "link": "https://stackoverflow.com/questions/29388109/shape-placement-and-shape-counter/29393416#29393416", "title": "Shape placement and shape counter", "body": "<p>This bit works for me, but of course you'll have to modify to use your own shapes and purpose.</p>\n\n<pre><code>Sub DrawShapesInPlace(shapeCell As Range, numShapes As Integer, Optional gap As Double = 3#)\n    Dim cellW As Double\n    Dim cellH As Double\n    Dim shapeW As Double\n    Dim shapeUL As Double\n    Dim shapeTop As Double\n    Dim shapeH As Double\n    Dim i As Integer\n    Dim newShape As Shape\n\n    If numShapes &lt; 1 Then\n        Exit Sub\n    End If\n\n    cellW = shapeCell.Width\n    cellH = shapeCell.Height\n    shapeW = (cellW / numShapes) - gap\n    shapeUL = shapeCell.Left\n    shapeTop = shapeCell.Top\n    shapeH = cellH\n\n    For i = 1 To numShapes\n        Set newShape = ActiveSheet.Shapes.AddShape(msoShapeRectangle, _\n                                                   shapeUL, _\n                                                   shapeTop, _\n                                                   shapeW, _\n                                                   shapeH)\n        newShape.Line.Weight = 1\n        shapeUL = shapeUL + gap + shapeW\n    Next i\nEnd Sub\n\nSub DrawShapes()\n    Call DrawShapesInPlace(ActiveSheet.Range(\"D9\"), 3)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 29393416, "answer_count": 1, "score": 0, "last_activity_date": 1427898370, "creation_date": 1427883124, "last_edit_date": 1427885148, "question_id": 29388109, "link": "https://stackoverflow.com/questions/29388109/shape-placement-and-shape-counter", "title": "Shape placement and shape counter", "body": "<p>I've got a few questions about shapes in VBA Excel.</p>\n\n<p>I've got Column A and Column B. They will be shown like this.</p>\n\n<pre><code>    A            B\n1 | some text    1 to 5 shapes\n2 | blabla       OOOO\n</code></pre>\n\n<p>I want to input the text and the shapes through a userform. So if a user selects '1', i want one shape to appear at the left of the cell in column B. If a user selects '3', I want 3 shapes to appear next to each other in column B.</p>\n\n<p>Also, if someone firstly chooses to have 3 shapes, and wants to change it to 4 shapes later, I have to put the fourth shape in the right place.</p>\n\n<p>All of this must still work if I change the widths of the columns.</p>\n\n<p>I really googled a lot, but I can't seem to find a right solution.</p>\n"}, {"tags": ["excel", "error-handling", "nested", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1427898895, "post_id": 29389287, "comment_id": 46963779, "body": "Sorry, but this code doesn&#39;t do what I want: errors in the alternative loop are not handled"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 1, "last_activity_date": 1427886761, "creation_date": 1427886761, "answer_id": 29389287, "question_id": 29388007, "link": "https://stackoverflow.com/questions/29388007/excel-vba-nested-error-handling/29389287#29389287", "title": "excel-vba nested error handling", "body": "<p>I recommend placing error handling routines on the level of the error (with the <em>If False</em> separator from normal course). Avoid <em>GoTo 0</em> in case of fundamental errors, it will just use up resources.</p>\n\n<pre><code>On Error GoTo ErrHandleri\nFor i = 1 To 100\n'...do something\n    For ii =1 To 50\n    On Error GoTo ErrHandlerii\n        'do other thing\n    If False Then\nErrhandlerii:\n    'do error handling stuff\n    End If\n    Next ii\nIf False Then\nErrHandleri:\n'code, e.g. paint the whole line blue\nEnd If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427886761, "creation_date": 1427882850, "last_edit_date": 1531164843, "question_id": 29388007, "link": "https://stackoverflow.com/questions/29388007/excel-vba-nested-error-handling", "title": "excel-vba nested error handling", "body": "<p>I wrote a vba-code for inserting data into a mysql-DB and to save time I've thought to make execute multiple \"insert\" with only one connection to the DB but I'm worried about possible errors in the insert command so, in case of error, I want to execute queries once at time.</p>\n\n<p>This makes it possible to execute the commands without errors but, If there was an error, it will be again and I'll need to handle it.</p>\n\n<p>To do this I thought the code below but, looking for something similar, I didn't find anything ... Maybe it was a bad idea? Is there a better way to do this?</p>\n\n<p>This is my idea:</p>\n\n<pre><code>For i = 1 To 100\n    '...do something\n\n    'First error handling activation\n    On Error GoTo ErrHandle1\n\n    'Reset SQL String\n    SQLStr = \"\"\n\n    'Loop for making SQL string for multiple INSERT\n    For ii = 1 To 50\n        '...example instructions:\n        SQLStr = SQLStr &amp; \"INSERT INTO myTab (myField) VALUES ('\" &amp; ii / i &amp; \"'); \"\n    Next ii\n    'Execute all insert at one time\n    rs.Open SQLStr, Cn, adOpenStatic\n\nGoNext:\nOn Error GoTo 0\nNext i\n\nExit Sub\n\n'primary error handling\nErrHandle1:\n'No instrutions here\n'I use resume only to reset error\nResume Handle1\nHandle1:\n\n'I try again INSERT loop with a connection to DB for every query\n'Second error handling activation\nOn Error GoTo ErrHandle2\nFor ii = 1 To 50\n    'String for only one INSERT\n    SQLStr = \"INSERT INTO myTab (myField) VALUES ('\" &amp; ii / i &amp; \"'); \"\n    'Single query execution\n    rs.Open SQLStr, Cn, adOpenStatic\nNext ii\n'Back to base code\nGoTo GoNext\n\n'secondary error handling\nErrHandle2:\nMsgBox Err &amp; \" - \" &amp; Error(Err)\nResume Next\n</code></pre>\n"}, {"tags": ["vba", "excel", "sql-server-2008-r2"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1427883104, "post_id": 29387942, "comment_id": 46953871, "body": "Thanks it resolved. can you please also suggest adding Stored Procedure in VBA. I think I nee that for later. Thanks"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "reply_to_user": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1427883320, "post_id": 29387942, "comment_id": 46953993, "body": "@KK1960 your question is unclear and not related to this problem. If you have any problems with stored procedures you should create a separate question and describe it with all the details."}, {"owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1427891363, "post_id": 29387942, "comment_id": 46958799, "body": "@ user3964075, I got one more requirement in the same task. I got one column that contains values of Red, Amber, Green and N/A. Now I want background Color for according values (Red, Amber, Green and White). How can I do this in VBA? Thanks"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "reply_to_user": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "edited": false, "score": 0, "creation_date": 1427892338, "post_id": 29387942, "comment_id": 46959426, "body": "@KK1960 I&#39;d suggest to apply conditional formatting to this column - no need to check every single value. Otherwise you have to iterate through all rows, compare the value and set cells <code>.Interior.Color</code> accordingly."}], "tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 1, "last_activity_date": 1427882689, "creation_date": 1427882689, "answer_id": 29387942, "question_id": 29387593, "link": "https://stackoverflow.com/questions/29387593/operation-not-allowed-when-the-object-is-closed-in-vba/29387942#29387942", "title": "Operation not allowed when the object is closed in VBA", "body": "<p>Your code defines <code>Recordset</code> but doesn't open it. Adding:</p>\n\n<pre><code>StaffData.Open\n</code></pre>\n\n<p>before:</p>\n\n<pre><code>Range(\"A2\").CopyFromRecordset StaffData\n</code></pre>\n\n<p>should solve the problem.</p>\n"}], "owner": {"reputation": 101, "user_id": 4658691, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/924e4142d39acfc5eecb0260d3754a11?s=128&d=identicon&r=PG&f=1", "display_name": "GK1960", "link": "https://stackoverflow.com/users/4658691/gk1960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7071, "favorite_count": 0, "accepted_answer_id": 29387942, "answer_count": 1, "score": 0, "last_activity_date": 1427888903, "creation_date": 1427881703, "last_edit_date": 1427888903, "question_id": 29387593, "link": "https://stackoverflow.com/questions/29387593/operation-not-allowed-when-the-object-is-closed-in-vba", "title": "Operation not allowed when the object is closed in VBA", "body": "<p>I am new to this site and also to VBA,\nsome how I managed to write VBA, but got above error. Please advise me any changes in my code. Thanks</p>\n\n<pre><code>Option Explicit\nConst ConStrSql As String = \"----\"\n\n\n\nSub CopyDataFromDatabase()\n\nDim DataConn As ADODB.Connection\nDim StaffData As ADODB.Recordset\nDim DataFiels As ADODB.Field\n\nSet DataConn = New ADODB.Connection\nSet StaffData = New ADODB.Recordset\n\nDataConn.ConnectionString = ConStrSql\nDataConn.Open\n\nOn Error GoTo CloseConnection\n\nWith StaffData\n.ActiveConnection = DataConn\n.Source = \"select ---\"\n.LockType = adLockReadOnly\n.CursorType = adOpenKeyset\n\nEnd With\n\nOn Error GoTo CloseRecordset\n\nWorksheets.Add\n\nFor Each DataFiels In StaffData.Fields\nActiveCell.Value = DataFiels.Name\nActiveCell.Offset(0, 1).Select\nNext DataFiels\n\nRange(\"A1\").Select\nRange(\"A2\").CopyFromRecordset StaffData\nRange(\"A1\").CurrentRegion.EntireColumn.AutoFit\n\nCloseRecordset:\nStaffData.Close\n\n\nCloseConnection:\nDataConn.Close\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>when I remove \n<code>CloseRecordset:\nStaffData.Close</code> </p>\n\n<p>I got columns listed in excel, but not data</p>\n\n<p>Please any advise. Thanks</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1427881870, "post_id": 29387505, "comment_id": 46953184, "body": "Path of the same Access file from which the VBA is executed?"}, {"owner": {"reputation": 35, "user_id": 4737424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcb8b75f0c648609d9afc1e90582334?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStuck", "link": "https://stackoverflow.com/users/4737424/foreverstuck"}, "reply_to_user": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1427882060, "post_id": 29387505, "comment_id": 46953312, "body": "Yes. That&#39;s what I&#39;m aiming for."}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 1, "creation_date": 1427882109, "post_id": 29387505, "comment_id": 46953348, "body": "Why not using <code>CurrentProject.FullName</code> ?"}, {"owner": {"reputation": 35, "user_id": 4737424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcb8b75f0c648609d9afc1e90582334?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStuck", "link": "https://stackoverflow.com/users/4737424/foreverstuck"}, "reply_to_user": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1427882605, "post_id": 29387505, "comment_id": 46953606, "body": "That works perfectly thank you. I hadn&#39;t used it because I&#39;m way too new to access and vba to know about it and System.IO.path.GetFullPath() was the only answer popping up on google. Any idea why System was failing?"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 1, "creation_date": 1427883098, "post_id": 29387505, "comment_id": 46953863, "body": "Are you using VBA or VB.NET cause Sytem.IO looks like .NET code."}, {"owner": {"reputation": 35, "user_id": 4737424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcb8b75f0c648609d9afc1e90582334?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStuck", "link": "https://stackoverflow.com/users/4737424/foreverstuck"}, "reply_to_user": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1427885710, "post_id": 29387505, "comment_id": 46955253, "body": "VBA. That must be it. I wasn&#39;t too sure of the differences when I started working on it  but I think I must have been using .NET in a VBA project"}], "answers": [{"tags": [], "owner": {"reputation": 360, "user_id": 3659875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d98f099cfc2bd6caa05978347c4f9c0d?s=128&d=identicon&r=PG", "display_name": "Madgui", "link": "https://stackoverflow.com/users/3659875/madgui"}, "is_accepted": true, "score": 1, "last_activity_date": 1427971828, "creation_date": 1427971828, "answer_id": 29411097, "question_id": 29387505, "link": "https://stackoverflow.com/questions/29387505/invalid-qualifier-when-using-system-io-path-in-vba/29411097#29411097", "title": "Invalid Qualifier when using System.IO.path in VBA", "body": "<p>VBA environment has only access to COM (and COM visible) component.<br/>\nSo forget about importing usual .Net namespaces.<br/>\n<b>But</b> some Wrappers exists : [<a href=\"https://technet.microsoft.com/en-us/magazine/2007.01.heyscriptingguy.aspx]\" rel=\"nofollow\">https://technet.microsoft.com/en-us/magazine/2007.01.heyscriptingguy.aspx]</a><br/>\nFor instance this works :<br/>\n<pre>DataList = CreateObject(\"System.Collections.ArrayList\")</pre><br/>\nBTW, in order to parse file full name in VBA, you can use <b>FileSystemObject</b>.</p>\n"}], "owner": {"reputation": 35, "user_id": 4737424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcb8b75f0c648609d9afc1e90582334?s=128&d=identicon&r=PG&f=1", "display_name": "ForeverStuck", "link": "https://stackoverflow.com/users/4737424/foreverstuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1332, "favorite_count": 0, "accepted_answer_id": 29411097, "answer_count": 1, "score": 0, "last_activity_date": 1594654618, "creation_date": 1427881433, "last_edit_date": 1594654618, "question_id": 29387505, "link": "https://stackoverflow.com/questions/29387505/invalid-qualifier-when-using-system-io-path-in-vba", "title": "Invalid Qualifier when using System.IO.path in VBA", "body": "<p>I'm extremely new to vba and feel like I have been falling down at the first hurdle all morning. I'm trying to get the path of my access file by doing the following</p>\n\n<pre><code>Sub getDirectoryPath()\n    Debug.Print (System.IO.path.GetFullPath())\nEnd Sub\n</code></pre>\n\n<p>However I get an \"Invalid Qualifier\" error on System when I try to run it. I've tried adding the 'System' reference but then it says IO is not found. What am I doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4737485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/595f46f8887090750bea25138ff70420?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/4737485/kev"}, "edited": false, "score": 0, "creation_date": 1427884413, "post_id": 29387714, "comment_id": 46954551, "body": "Although i know where you are coming from, the issue I am trying to solve is - VBA copy to cell if blank, if not blank copy to cell to the next cell to the right."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1427882061, "creation_date": 1427882061, "answer_id": 29387714, "question_id": 29387342, "link": "https://stackoverflow.com/questions/29387342/solving-the-automation-of-the-addition-of-new-markets/29387714#29387714", "title": "Solving the automation of the addition of new markets", "body": "<p>This is hard without seeing a data sample, but it looks like you are arranging your data against the regular flow of data from top left to bottom right. </p>\n\n<p>From your description is seems like your data looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/m5AF9.png\" alt=\"enter image description here\"></p>\n\n<p>Consider re-arranging the data in a table where the first column has the country and the second column has the currency. Select a cell in that new arrangement and click Insert ribbon > Table. Now it is dead easy to add new countries. Just click the next empty cell and start typing<img src=\"https://i.stack.imgur.com/vYKyj.png\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 110, "user_id": 4695744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-ZWK1GNVm3VE/AAAAAAAAAAI/AAAAAAAAIzA/W3kd_AxFWMQ/photo.jpg?sz=128", "display_name": "Anurag Singh", "link": "https://stackoverflow.com/users/4695744/anurag-singh"}, "edited": false, "score": 0, "creation_date": 1427949353, "post_id": 29405034, "comment_id": 46984931, "body": "This should work as desired!! When the user input Country in H3 and Currency in I3, the country and currency columns should be updated with new values"}], "tags": [], "owner": {"reputation": 110, "user_id": 4695744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-ZWK1GNVm3VE/AAAAAAAAAAI/AAAAAAAAIzA/W3kd_AxFWMQ/photo.jpg?sz=128", "display_name": "Anurag Singh", "link": "https://stackoverflow.com/users/4695744/anurag-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1427949266, "creation_date": 1427949266, "answer_id": 29405034, "question_id": 29387342, "link": "https://stackoverflow.com/questions/29387342/solving-the-automation-of-the-addition-of-new-markets/29405034#29405034", "title": "Solving the automation of the addition of new markets", "body": "<pre><code>Sub Test()\n'This Macro will Update Rows 6 and Rows 7 from the user input for country in Range H3 and currency in Range I3        \n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Set wb = ThisWorkbook\n    Set ws1 = wb.Sheets(\"Sheet1\") 'Rename sheet1 to your sheet name\n\n    LastCol1 = ws1.Cells(6, ws1.Columns.Count).End(xlToLeft).Column\n    LastCol2 = ws1.Cells(7, ws1.Columns.Count).End(xlToLeft).Column\n\n    Cells(6, LastCol1 + 1) = ws1.Cells(3,8)\n    Cells(7, LastCol2 + 1) = ws1.Cells(3,9)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4737485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/595f46f8887090750bea25138ff70420?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/4737485/kev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1427949266, "creation_date": 1427880899, "last_edit_date": 1427884605, "question_id": 29387342, "link": "https://stackoverflow.com/questions/29387342/solving-the-automation-of-the-addition-of-new-markets", "title": "Solving the automation of the addition of new markets", "body": "<p>I am trying to automate the addition of new markets to the spreadsheet using VBA. </p>\n\n<p>In Cell E6:J6 I have 6 countries. In E7:J7 I have their respective currency. I want the user to do the following: </p>\n\n<ol>\n<li>Enter a new market into H3 and its currency into I3</li>\n<li>Run the macro and the new market and currency appears in K6 and K7</li>\n</ol>\n\n<p>This part I can work out - however, when the user enters an additional market in H3 and I3, if there is a string in K6 and K7 then it will populate L6 and L7 with the new information and so on.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1427881940, "post_id": 29386971, "comment_id": 46953240, "body": "There are too many answers needed to solve this. J-Walk&#39;s code was a specific example of preventing cells being pasted into a data validated range. Do you re-instate the validation and check for invalid entries through the entire range; define the copied range then test just that; display a message or highlight the invalid cells; list the invalid cells in a form allowing the user to edit and replace them?"}, {"owner": {"reputation": 55, "user_id": 3108098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181fbb106b40a43a4473989867c4eb4c?s=128&d=identicon&r=PG&f=1", "display_name": "oliveirano25", "link": "https://stackoverflow.com/users/3108098/oliveirano25"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1427882563, "post_id": 29386971, "comment_id": 46953584, "body": "1st or 3rd suggestions is what I am looking for. I wish for the user to be made aware if data he has pasted has broken data validation rules. This can be through error/warning message or highlighting of invalid cells, whichever is possible."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1427882810, "post_id": 29386971, "comment_id": 46953705, "body": "You will have to attempt it then and come back when you encounter something that you can&#39;t solve. SO isn&#39;t a code writing service. I&#39;ll help you in the right direction but only so far."}, {"owner": {"reputation": 55, "user_id": 3108098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181fbb106b40a43a4473989867c4eb4c?s=128&d=identicon&r=PG&f=1", "display_name": "oliveirano25", "link": "https://stackoverflow.com/users/3108098/oliveirano25"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1427964822, "post_id": 29386971, "comment_id": 46991259, "body": "I have created a code to check for invalid cells. I am now having trouble searching a range to produce a msgbox if an invalid cell is found as detailed in the edit."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3108098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181fbb106b40a43a4473989867c4eb4c?s=128&d=identicon&r=PG&f=1", "display_name": "oliveirano25", "link": "https://stackoverflow.com/users/3108098/oliveirano25"}, "edited": false, "score": 1, "creation_date": 1427965332, "post_id": 29397288, "comment_id": 46991496, "body": "The idea is for someone with no knowledge of VBA or data validation to copy and paste as they wish, but be informed that they are breaking a rule."}], "tags": [], "owner": {"reputation": 137, "user_id": 1888461, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/030b7ed8ddb2bc9b51c7e65e1d951168?s=128&d=identicon&r=PG&f=1", "display_name": "Viladimir", "link": "https://stackoverflow.com/users/1888461/viladimir"}, "is_accepted": false, "score": -1, "last_activity_date": 1427933861, "last_edit_date": 1427933861, "creation_date": 1427909943, "answer_id": 29397288, "question_id": 29386971, "link": "https://stackoverflow.com/questions/29386971/force-pasted-values-to-obey-data-validation-rules/29397288#29397288", "title": "Force pasted values to obey data validation rules", "body": "<p>Try doing a paste special; a normal paste overwrites the format property of the cells.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 3108098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181fbb106b40a43a4473989867c4eb4c?s=128&d=identicon&r=PG&f=1", "display_name": "oliveirano25", "link": "https://stackoverflow.com/users/3108098/oliveirano25"}, "is_accepted": true, "score": 1, "last_activity_date": 1427969893, "creation_date": 1427969893, "answer_id": 29410464, "question_id": 29386971, "link": "https://stackoverflow.com/questions/29386971/force-pasted-values-to-obey-data-validation-rules/29410464#29410464", "title": "Force pasted values to obey data validation rules", "body": "<p>Decided not to go down the shape route and instead search for validation values:</p>\n\n<pre><code>Dim Cell As Range\nFor Each Cell In Range(\"D4:H8\")\n    If Not Cell.Validation.Value Then\n        MsgBox \"Actions Should Have Input and Output\"\n        Exit Sub\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7987900, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ab16625b973d340416b56bc00d7f350c?s=128&d=identicon&r=PG", "display_name": "Jared M", "link": "https://stackoverflow.com/users/7987900/jared-m"}, "is_accepted": false, "score": -1, "last_activity_date": 1494354087, "creation_date": 1494354087, "answer_id": 43877212, "question_id": 29386971, "link": "https://stackoverflow.com/questions/29386971/force-pasted-values-to-obey-data-validation-rules/43877212#43877212", "title": "Force pasted values to obey data validation rules", "body": "<p>Instead of clicking the cell and hitting paste, click the cell and paste the data into the formula bar at the top of excel. Then hit enter. This allowed me to paste text from the clipboard but retain the data validation. </p>\n\n<p>I only tested this with text and numbers within excel and from external sources, never with advanced formulas, etc, so it may not work for all needs.</p>\n\n<p>It is one extra step per paste, but it saved me lots of time on a specific project where I needed to check character counts.</p>\n"}], "owner": {"reputation": 55, "user_id": 3108098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181fbb106b40a43a4473989867c4eb4c?s=128&d=identicon&r=PG&f=1", "display_name": "oliveirano25", "link": "https://stackoverflow.com/users/3108098/oliveirano25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14977, "favorite_count": 0, "accepted_answer_id": 29410464, "answer_count": 3, "score": 4, "last_activity_date": 1494354087, "creation_date": 1427879739, "last_edit_date": 1428150922, "question_id": 29386971, "link": "https://stackoverflow.com/questions/29386971/force-pasted-values-to-obey-data-validation-rules", "title": "Force pasted values to obey data validation rules", "body": "<p>I have a (simplified example) matrix consisting of inputs and alarms. Each action (X) should have an input and an alarm i.e. no actions should be inserted in column E or row 6.</p>\n\n<p><img src=\"https://i.stack.imgur.com/e0KbO.png\" alt=\"\"></p>\n\n<p>I used data validation to implement this and it works.</p>\n\n<p><img src=\"https://i.stack.imgur.com/OthhS.png\" alt=\"\"></p>\n\n<p>However if I paste data to these cells they do not follow the validation rules. I inserted this VBA code to prevent this (extracted from www.j-walk.com/ss/excel/tips/tip98.htm):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'Does the validation range still have validation?\n    If HasValidation(Range(\"ValidationRange\")) Then\n        Exit Sub\n    Else\n       Application.EnableEvents = False\n       Application.Undo\n        MsgBox \"Your last operation was canceled.\" &amp; _\n        \" It would have deleted data validation rules.\", vbCritical\n    End If\nEnd Sub\n\nPrivate Function HasValidation(r) As Boolean\n'   Returns True if every cell in Range r uses Data Validation\n    On Error Resume Next\n    x = r.Validation.Type\n    If Err.Number = 0 Then HasValidation = True Else HasValidation = False\nEnd Function\n</code></pre>\n\n<p>However, this code also prevents values from being pasted into cells even when they do not break validation rules e.g. if I paste an X to input a;alarm 1, I get an error message. Is there any way to prevent values from being pasted only when they break validation rules?</p>\n\n<p>Edit:</p>\n\n<p>I have altered the code to:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nWith Range(\"D4:H8\").Validation\n        .Delete\n        .Add Type:=xlValidateCustom, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=\"=OR(ISBLANK(D4),AND(NOT(ISBLANK($C4)),NOT(ISBLANK(D$3))))\"\n        .IgnoreBlank = False\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"Stop\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"Actions Must Have Input and Output\"\n        .ShowInput = True\n        .ShowError = True\n    End With\n\nMe.CircleInvalid\n\nCount = 0\nDim shp As Shape\nFor Each shp In ActiveSheet.Shapes\n    If Not Intersect(shp.TopLeftCell, Range(\"D4:H8\")) Is Nothing Then Count = Count + 1\nNext\n\nIf Count &gt; 0 Then\nMsgBox \"Actions Must Have Input and Output\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This now circles invalid cells and produces a msg box if one is found. This is done based on the fact that the invalid circle is a shape. I can get the code to work by searching the whole sheet but I am trying to narrow the search to a specified range. However I get the error \"1004 - Application-defined or object-defined error\" due to shp.TopLeftCell. Any ideas?</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 21, "user_id": 4069964, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000446613205/picture?type=large", "display_name": "Aoon", "link": "https://stackoverflow.com/users/4069964/aoon"}, "edited": false, "score": 0, "creation_date": 1427881510, "post_id": 29386911, "comment_id": 46953004, "body": "I see it now. DateDiff function can return time difference in seconds, but the real difference is in miliseconds. <code>DateDiff</code> function can&#39;t compare it, because the smallest unit is a second. When you pass date parameter this way: <code>CDate(Left(date1, Len(date1)-7)</code> it will execute without errors."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1427884702, "post_id": 29386911, "comment_id": 46954702, "body": "@Maciej Los ans may have to be long, and your brackets are out of count, 7-&quot;(&quot; and only 6-&quot;)&quot;"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1427885313, "post_id": 29386911, "comment_id": 46955043, "body": "<a href=\"http://stackoverflow.com/questions/939230/how-to-get-a-datediff-value-in-milliseconds-in-vba-excel\">How to get a DateDiff-Value in milliseconds in VBA (Excel)?</a>"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1427889914, "post_id": 29386911, "comment_id": 46957820, "body": "@Davesexcel, Interesting question and answers, but - as i mentioned - it&#39;s impossible to get miliseconds via DateDiff function."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1427891480, "post_id": 29386911, "comment_id": 46958872, "body": "@Maciej Los-I didn&#39;t ask a question, I supplied a link to the Milli-seconds question and explained to you that your code does not have enough closing brackets and that &quot;ans&quot; should be long"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1427892227, "post_id": 29386911, "comment_id": 46959348, "body": "@Davesexcel, i know that you aren&#39;t a questioner. Answer has been updated."}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1427892179, "last_edit_date": 1427892179, "creation_date": 1427879561, "answer_id": 29386911, "question_id": 29386669, "link": "https://stackoverflow.com/questions/29386669/i-cant-use-datediff-vba/29386911#29386911", "title": "I can&#39;t use datediff vba", "body": "<p>Try to convert dates stored as a string to date data type by using <code>CDate(\"string_date\")</code>:</p>\n\n<pre><code>Dim date1 As String, date2 As String, ans As Long\n\ndate1 = \"2015-03-23 07:06:17.855000\"\ndate2 = \"2015-03-23 07:06:17.870000\"\nans = datediff(\"s\", CDate(Left(date1, Len(date1)-7)), CDate(Left(date2, Len(date2)-7)))\n'returns 0, because both date and parts are the same!\n</code></pre>\n\n<p>The smallest unit of <a href=\"https://msdn.microsoft.com/en-us/library/b5xbyt6f%28v=vs.90%29.aspx\" rel=\"nofollow\">DateDiff</a> function is a second.</p>\n"}, {"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1427893635, "creation_date": 1427893635, "answer_id": 29391677, "question_id": 29386669, "link": "https://stackoverflow.com/questions/29386669/i-cant-use-datediff-vba/29391677#29391677", "title": "I can&#39;t use datediff vba", "body": "<p>Doesn't look like you've got a successful answer yet, so here's a possibility.</p>\n\n<pre><code>Dim t() as string\nDim d1 as long\nDim d2 as long\n\ndate1 = \"2015-03-23 07:06:17.855000\"\ndate2 = \"2015-03-23 07:06:17.870000\"\nt = split(date1, \".\")   'use the \".\" to split off the miliseconds\nd1 = clng(t(2))         'grab the milliseconds, convert it to long\nt = split(date2, \".\")   'use the \".\" to split off the miliseconds from the other date\nd2 = clng(t(2))         'grab the milliseconds, convert it to long\n\nmsgbox \"Difference in milliseconds: \" &amp; cstr(d2-d1)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4069964, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000446613205/picture?type=large", "display_name": "Aoon", "link": "https://stackoverflow.com/users/4069964/aoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 29391677, "answer_count": 2, "score": 1, "last_activity_date": 1427893635, "creation_date": 1427878720, "last_edit_date": 1531164843, "question_id": 29386669, "link": "https://stackoverflow.com/questions/29386669/i-cant-use-datediff-vba", "title": "I can&#39;t use datediff vba", "body": "<p>Example input:</p>\n\n<pre><code>date1 = \"2015-03-23 07:06:17.855000\"\ndate2 = \"2015-03-23 07:06:17.870000\"\n</code></pre>\n\n<p>When I use </p>\n\n<pre><code>ans = datediff(\"s\", date1, date2)\n</code></pre>\n\n<p>It produces the error: <code>type mismatch</code></p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["sql", "database", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4737227"}, "edited": false, "score": 0, "creation_date": 1427876911, "post_id": 29386097, "comment_id": 46950379, "body": "the &quot;&gt;&quot; character in (&quot; &amp; &gt;Me!conID &amp; &quot;) it&#39;s a mistake, the code is without it.."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4737227"}, "edited": false, "score": 0, "creation_date": 1427879130, "post_id": 29386206, "comment_id": 46951653, "body": "ok, thank you! And how can I modify the code for multiple rows?"}, {"owner": {"reputation": 10949, "user_id": 621013, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/EDu5I.jpg?s=128&g=1", "display_name": "Sai Kalyan Kumar Akshinthala", "link": "https://stackoverflow.com/users/621013/sai-kalyan-kumar-akshinthala"}, "edited": false, "score": 0, "creation_date": 1427880785, "post_id": 29386206, "comment_id": 46952628, "body": "Refer to Edited answer"}], "tags": [], "owner": {"reputation": 10949, "user_id": 621013, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/EDu5I.jpg?s=128&g=1", "display_name": "Sai Kalyan Kumar Akshinthala", "link": "https://stackoverflow.com/users/621013/sai-kalyan-kumar-akshinthala"}, "is_accepted": true, "score": 0, "last_activity_date": 1427880772, "last_edit_date": 1427880772, "creation_date": 1427877177, "answer_id": 29386206, "question_id": 29386097, "link": "https://stackoverflow.com/questions/29386097/insert-multiple-rows-into-a-single-table-from-a-textbox-form-access-2010/29386206#29386206", "title": "Insert multiple rows into a single table from a textbox form - Access 2010", "body": "<p>The code you have written is for a single row insert and it will run only for one time.  If a seperator is present for the numbers in Textbox, then loop through each number by splitting the Text with seperator and insert as seperate rows in DB.</p>\n\n<p>Generally </p>\n\n<pre><code>INSERT INTO [Con_ID futcanc BAMB] (con_id) VALUES (1)\n</code></pre>\n\n<p>will inserts only one row and</p>\n\n<p><code>INSERT INTO [Con_ID futcanc BAMB] (con_id) VALUES (1,2)</code> is Invalid statement.</p>\n\n<p>EDIT:</p>\n\n<p>Refer the below link for Split and Loop code Logic</p>\n\n<p><a href=\"https://science.nature.nps.gov/im/units/arcn/data_management/code/39.htm\" rel=\"nofollow\">Split and Loop</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4737227"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 29386206, "answer_count": 1, "score": 0, "last_activity_date": 1427880772, "creation_date": 1427876775, "last_edit_date": 1427877358, "question_id": 29386097, "link": "https://stackoverflow.com/questions/29386097/insert-multiple-rows-into-a-single-table-from-a-textbox-form-access-2010", "title": "Insert multiple rows into a single table from a textbox form - Access 2010", "body": "<p>I have a table with a single field (defined as Number) in which I would like to insert multiple rows from a textbox in a form. The code is:</p>\n\n<pre><code>Private Sub CmdImportID_Click()\n\nDim strSQL As String\n\n  strSQL = \"DELETE * FROM [Con_ID futcanc BAMB]\"  \n  DoCmd.RunSQL strSQL\n\n  strSQL = \"INSERT INTO [Con_ID futcanc BAMB] (con_id) VALUES (\" &amp; Me!conID &amp; \");\"   \n  DoCmd.RunSQL strSQL    \n End Sub\n</code></pre>\n\n<p>Problem is: it works with a single number in textbox, but when I try to insert more than one I receive \"Run-time error '3075': Syntax error (missing operator) in query expression\".\nHow can I modify the code to insert more data? Sorry, I'm not really skilled in coding vba :(</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "is_accepted": false, "score": 0, "last_activity_date": 1427976072, "last_edit_date": 1427976072, "creation_date": 1427914407, "answer_id": 29398571, "question_id": 29385993, "link": "https://stackoverflow.com/questions/29385993/finding-more-than-instance-of-data-in-a-text-file/29398571#29398571", "title": "Finding more than instance of data in a Text File", "body": "<p>As far as being able to choose a different file each time, you could use</p>\n\n<pre><code>with application.filedialog(msoFileDialogOpen)\n'disallows the user from selecting more than one file at a time\n.allowmultiselect=false\n'shows the file open dialog box\n.show\n\n if .selecteditems.count=0 then\n 'dismisses dialog box if no selection\n else\n strPath=.selecteditems(1)\n end if\n end with\n</code></pre>\n\n<p>You can then use <code>strPath</code> to read the text from, though the way that I accomplished my reading from a text file was to write the text right to a hidden sheet in the workbook (make <code>text=textline</code> in your <code>Do Until EOF(1)</code> loop and add <code>[workbookname].sheet([sheetname]).cells(xrowx,1)=text</code> and <code>xrowx=xrowx+1</code> after that). The information is much more manageable in that format, rather than trying to read from one giant string.  Give that a whirl, see if it makes things easier for you. </p>\n"}], "owner": {"reputation": 1, "user_id": 4732085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155387790000015/picture?type=large", "display_name": "Shane Cann", "link": "https://stackoverflow.com/users/4732085/shane-cann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1427976072, "creation_date": 1427876436, "question_id": 29385993, "link": "https://stackoverflow.com/questions/29385993/finding-more-than-instance-of-data-in-a-text-file", "title": "Finding more than instance of data in a Text File", "body": "<p>I am desperately trying to create a macro which will allow me to do the following:</p>\n\n<ol>\n<li>Select a text file (different one everytime)</li>\n<li>Look at the data and identify the first instance of key phrases such as \"_ _Z_1_:_\"</li>\n<li>Then extract data following that phrase</li>\n<li>Write it to Excel</li>\n<li>Then identify the next instance of the key phrase</li>\n<li>Extract data</li>\n<li>Write to Excel</li>\n</ol>\n\n<p>Any help much appreciated.</p>\n\n<p>I'm really not sure how to do it. My code is as follows:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim myFile As String, text As String, textline As String, Day As String, Zno As String, NetSales As String, Cash As String, Card As String, HotDrinks As String, ColdDrinks As String, Sweets As String, Crisps As String, VAT As String, NextZ As String\n\nmyFile = Application.GetOpenFilename()\n\nDim bffr As String, p As Long\nbffr = (myFile)\np = InStr(p + 1, bffr, \"_ _Z_1_:_\", vbTextCompare)\nDo While CBool(p)\n\n'_ _Z_1_:_ was found; process it based upon the starting position p\n\n'see if there are other occurrences of _ _Z_1_:_\np = InStr(p + 1, bffr, \"_ _Z_1_:_\", vbTextCompare)\nLoop\n\nOpen myFile For Input As #1\nDo Until EOF(1)\nLine Input #1, textline\ntext = text &amp; textline\nLoop\nClose #1\n\nDay = InStr(text, \"Welcome Bite\")\nZno = InStr(text, \"_ _Z_1_:_\")\nNetSales = InStr(text, \"NET sales          \")\nCash = InStr(text, \"CASH in \")\nCard = InStr(text, \"CREDIT in\")\nHotDrinks = InStr(text, \"HOT DRINKS         \")\nColdDrinks = InStr(text, \"COLD DRINKS       \")\nSweets = InStr(text, \"Sweets             \")\nCrisps = InStr(text, \"Crisps             \")\nVAT = InStr(text, \"** Fixed Totaliser Period 1 Totals Reset\")\nNextZ = InStr(text, \"_ _Z_1_:_\")\n\n\nRange(\"A1\").Value = Mid(text, Day + 19, 18)\nRange(\"A2\").Value = Mid(text, Zno + 10, 8)\nRange(\"A3\").Value = Mid(text, NetSales + 30, 7)\nRange(\"A4\").Value = Mid(text, Cash + 30, 7)\nRange(\"A5\").Value = Mid(text, Card + 30, 7)\nRange(\"A6\").Value = Mid(text, HotDrinks + 30, 7)\nRange(\"A7\").Value = Mid(text, ColdDrinks + 30, 7)\nRange(\"A8\").Value = Mid(text, Sweets + 30, 7)\nRange(\"A9\").Value = Mid(text, Crisps + 30, 7)\nRange(\"A10\").Value = Mid(text, VAT - 9, 7)\n\nRange(\"B2\").Value = Mid(text, p + 1, 8)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "sql-server-2012", "adodb", "vba"], "comments": [{"owner": {"reputation": 5978, "user_id": 460363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b938ec8462feb7f5e2a4b81cbaa8f1?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Komorowski", "link": "https://stackoverflow.com/users/460363/micha%c5%82-komorowski"}, "edited": false, "score": 0, "creation_date": 1427874488, "post_id": 29385336, "comment_id": 46949167, "body": "Is my understanding correct that queries run from SQL Server Management Studio and from Excel VBA have the same input parameters and are run against the same database?"}, {"owner": {"reputation": 855, "user_id": 2470589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cf5d2021cb202aba5eb69d733454bf8?s=128&d=identicon&r=PG", "display_name": "iabbott", "link": "https://stackoverflow.com/users/2470589/iabbott"}, "reply_to_user": {"reputation": 5978, "user_id": 460363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b938ec8462feb7f5e2a4b81cbaa8f1?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Komorowski", "link": "https://stackoverflow.com/users/460363/micha%c5%82-komorowski"}, "edited": false, "score": 0, "creation_date": 1427874828, "post_id": 29385336, "comment_id": 46949319, "body": "yes the query is the same, i used the same parameters and the database is the same"}, {"owner": {"reputation": 5978, "user_id": 460363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b938ec8462feb7f5e2a4b81cbaa8f1?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Komorowski", "link": "https://stackoverflow.com/users/460363/micha%c5%82-komorowski"}, "edited": false, "score": 0, "creation_date": 1427875165, "post_id": 29385336, "comment_id": 46949487, "body": "Did you try to run this query in Excel VBA two times one by one. I&#39;d like to confirm that it always takes 2 minutes to execute it and not only for the first time."}, {"owner": {"reputation": 855, "user_id": 2470589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cf5d2021cb202aba5eb69d733454bf8?s=128&d=identicon&r=PG", "display_name": "iabbott", "link": "https://stackoverflow.com/users/2470589/iabbott"}, "reply_to_user": {"reputation": 5978, "user_id": 460363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b938ec8462feb7f5e2a4b81cbaa8f1?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Komorowski", "link": "https://stackoverflow.com/users/460363/micha%c5%82-komorowski"}, "edited": false, "score": 0, "creation_date": 1427875313, "post_id": 29385336, "comment_id": 46949562, "body": "It takes longer then 2 mins, i have set that as the timeout and it errors each time. I am changing the timeout to zero to see how long it takes, i will run it a couple of times and get back to you"}, {"owner": {"reputation": 855, "user_id": 2470589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cf5d2021cb202aba5eb69d733454bf8?s=128&d=identicon&r=PG", "display_name": "iabbott", "link": "https://stackoverflow.com/users/2470589/iabbott"}, "reply_to_user": {"reputation": 5978, "user_id": 460363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b938ec8462feb7f5e2a4b81cbaa8f1?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Komorowski", "link": "https://stackoverflow.com/users/460363/micha%c5%82-komorowski"}, "edited": false, "score": 0, "creation_date": 1427876136, "post_id": 29385336, "comment_id": 46949988, "body": "so 3 runs - 1st took 2min 31, 2nd took 2min 27, 3rd took 2min 35"}, {"owner": {"reputation": 5978, "user_id": 460363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b938ec8462feb7f5e2a4b81cbaa8f1?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Komorowski", "link": "https://stackoverflow.com/users/460363/micha%c5%82-komorowski"}, "edited": false, "score": 0, "creation_date": 1427877960, "post_id": 29385336, "comment_id": 46950966, "body": "What is your connection string? What library do you use in Excel (e.g. Microsoft ActiveX Data Objects 2.8 Library)?"}, {"owner": {"reputation": 5978, "user_id": 460363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b938ec8462feb7f5e2a4b81cbaa8f1?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Komorowski", "link": "https://stackoverflow.com/users/460363/micha%c5%82-komorowski"}, "reply_to_user": {"reputation": 855, "user_id": 2470589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cf5d2021cb202aba5eb69d733454bf8?s=128&d=identicon&r=PG", "display_name": "iabbott", "link": "https://stackoverflow.com/users/2470589/iabbott"}, "edited": false, "score": 0, "creation_date": 1427878419, "post_id": 29385336, "comment_id": 46951263, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/74239/discussion-between-michal-komorowski-and-iabbott\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 855, "user_id": 2470589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cf5d2021cb202aba5eb69d733454bf8?s=128&d=identicon&r=PG", "display_name": "iabbott", "link": "https://stackoverflow.com/users/2470589/iabbott"}, "edited": false, "score": 0, "creation_date": 1427884871, "post_id": 29388649, "comment_id": 46954774, "body": "So finally my connection string looks like: <code>conStr = &quot;Provider=SQLNCLI11;Data Source= (......).</code>"}], "tags": [], "owner": {"reputation": 5978, "user_id": 460363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b938ec8462feb7f5e2a4b81cbaa8f1?s=128&d=identicon&r=PG", "display_name": "Micha\u0142 Komorowski", "link": "https://stackoverflow.com/users/460363/micha%c5%82-komorowski"}, "is_accepted": true, "score": 2, "last_activity_date": 1427884721, "creation_date": 1427884721, "answer_id": 29388649, "question_id": 29385336, "link": "https://stackoverflow.com/questions/29385336/adodb-command-execute-timeout/29388649#29388649", "title": "ADODB Command.Execute Timeout", "body": "<p>The discussion on the chat showed that: </p>\n\n<ul>\n<li>The problem occurs only while connecting to the remote database. </li>\n<li>The old SQLOLEDB provider is used.</li>\n</ul>\n\n<p>I suggested to give a chance to a newer provider SQLNCLI which should be more effective while communicating with MSSQL. When a connection string was modified the execution time dropped from 2 minutes to 3 seconds.</p>\n"}], "owner": {"reputation": 855, "user_id": 2470589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cf5d2021cb202aba5eb69d733454bf8?s=128&d=identicon&r=PG", "display_name": "iabbott", "link": "https://stackoverflow.com/users/2470589/iabbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1664, "favorite_count": 0, "accepted_answer_id": 29388649, "answer_count": 1, "score": 1, "last_activity_date": 1427884785, "creation_date": 1427873981, "last_edit_date": 1531164843, "question_id": 29385336, "link": "https://stackoverflow.com/questions/29385336/adodb-command-execute-timeout", "title": "ADODB Command.Execute Timeout", "body": "<p>I am seeing a timeout error when running a query from Excel vba</p>\n\n<p>The query takes &lt;2 seconds from the SQL Server Management Studio, but from vba the timeout happens at 2 minutes with nothing returned</p>\n\n<p>Is there something i am not doing right setting up the Command object? I have noticed that ADODB seems to be slower but never anything like this</p>\n\n<p>The query joins several tables and does some other calculations, but going from 1.5 seconds to >2 minutes must mean something in the vba that I have missed</p>\n\n<p>This is my vba connection string code:</p>\n\n<pre><code>If svrCon Is Nothing Then\n    Set svrCon = New ADODB.Connection\nEnd If\n\nIf Not CheckServerConnectionState Then\n\n    conStr = \"Provider=SQLOLEDB;Data Source=ussantapps332;\" &amp; _\n                    \"Initial Catalog=Global_OEE_Data_Capture_Dev;User Id=sqluser;Password=*****;\"\n\n    ' Open the connection\n    svrCon.ConnectionTimeout = 0\n    svrCon.Open conStr\n\nEnd If\n</code></pre>\n\n<p>This is my vba SELECT code:</p>\n\n<pre><code>Dim cmd As ADODB.Command\nDim par As ADODB.Parameter\nDim rst As ADODB.Recordset        \n\n' Create command object\nSet cmd = New ADODB.Command\n\ncmd.CommandTimeout = 120\ncmd.ActiveConnection = svrCon\ncmd.CommandText = sql\n\n\n' Create parameter object\nIf IsArrayInitialized(params) Then\n    For x = 0 To UBound(params)\n        If IsNull(params(x, 1)) Then\n            Set par = cmd.CreateParameter(Type:=params(x, 0), Size:=1)\n        Else\n            Set par = cmd.CreateParameter(Type:=params(x, 0), Size:=Len(params(x, 1)) + 1)\n        End If\n        par.Value = params(x, 1)\n\n        cmd.Parameters.Append par\n\n        Set par = Nothing\n\n        DoEvents\n    Next\nEnd If\n\n\n' Open recordset object\nOn Error GoTo ExecuteError\nDebug.Print Format(Now, \"hh:mm:ss\")\nSet rst = cmd.Execute\nDebug.Print Format(Now, \"hh:mm:ss\")\nOn Error GoTo 0\n</code></pre>\n\n<p>The sql string and parameters are passed into the function, the connection is opened from another method</p>\n\n<p>The query is:</p>\n\n<pre><code>SELECT U.UnitsID, L.LineName, V.VSName, O.OperatorShift, O.LineLeader, O.CotyOps, O.TempOps, U.WorkOrder, U.ProductCode,\n           S.ProdDesc, U.TimeLineStart, U.TimeLineEnd, U.UnitsProduced, U.ActLineSpeed, U.TgtLineSpeed, SUM(CASE WHEN C.DTIncludedInOEE = 0 THEN D.DowntimeLength ELSE 0 END),\n           U.OfflineTaskID, R.Rate, S.LabHrsPerThou, S.PHeads, T.TgtOEE, T.TgtEff, T.TgtProd\n      FROM dataUnits U\n        LEFT JOIN dataOperatorNames O ON O.OperatorID = U.OperatorNameID\n        INNER JOIN setupLines L ON U.LineID = L.LineID\n        INNER JOIN setupValueStreams V on V.VSID = L.VSID\n        INNER JOIN setupPUs P ON V.PUID = P.PUID\n        LEFT JOIN dataDowntimes D ON U.UnitsID = D.UnitsID\n        LEFT JOIN setupDowntimes sD ON D.DTID = sD.DTID\n        LEFT JOIN setupDowntimeCats C ON sD.DTCatID = C.DTCatID\n        LEFT JOIN (SELECT VSID, AVG(RateVal) Rate\n                 FROM dataRates WHERE FYStart &gt;= '2014-07-01' AND FYStart &lt; '2015-07-01'\n                        GROUP BY VSID) R ON R.VSID = L.VSID\n        LEFT JOIN dataStandards S ON S.ProdCode = U.ProductCode\n        LEFT JOIN (SELECT LineID, AVG(TgtOEE) TgtOEE, AVG(TgtEff) TgtEff, AVG(TgtProd) TgtProd\n                    FROM dataTargets WHERE TgtMonth &gt;= '2015-03-01' AND TgtMonth &lt; '2015-04-01'\n                            GROUP BY LineID) T ON L.LineID = T.LineID\n      WHERE (S.SAPVersion = (SELECT MIN(SAPVersion) FROM dataStandards s2 WHERE s2.ProdCode = S.ProdCode)\n            OR S.SAPVersion IS NULL)\n      AND P.SiteID = 2 AND U.TimeLineStart &gt;= '2015-03-05 23:00' AND U.TimeLineStart &lt; '2015-03-31 23:00'\n      GROUP BY U.UnitsID, L.LineName, V.VSName, O.OperatorShift, O.LineLeader, O.CotyOps, O.TempOps, U.WorkOrder, U.ProductCode, S.ProdDesc, U.TimeLineStart,\n               U.TimeLineEnd, U.UnitsProduced, U.ActLineSpeed, U.TgtLineSpeed, U.OfflineTaskID, R.Rate, S.LabHrsPerThou, S.PHeads, T.TgtOEE, T.TgtEff, T.TgtProd\n      ORDER BY U.TimeLineStart ASC\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427874676, "post_id": 29385312, "comment_id": 46949258, "body": "Please, can you highlight the line which is returning an error?"}, {"owner": {"reputation": 23, "user_id": 4715520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3409fb0dcba59f102b9b47d3386873f?s=128&d=identicon&r=PG&f=1", "display_name": "Liew Yuqi", "link": "https://stackoverflow.com/users/4715520/liew-yuqi"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 1, "creation_date": 1427876945, "post_id": 29385312, "comment_id": 46950398, "body": "error occurs at Workbooks(file).Worksheets(ActiveSheet.Name).Copy _     after:=Workbooks(ControlFile).Worksheets(total)"}], "answers": [{"tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": true, "score": 1, "last_activity_date": 1427877587, "creation_date": 1427877587, "answer_id": 29386313, "question_id": 29385312, "link": "https://stackoverflow.com/questions/29385312/subscript-out-of-range-when-copying-worksheet/29386313#29386313", "title": "Subscript out of range when copying worksheet", "body": "<h1>Error :</h1>\n\n<p>The error occurs on the line<br>\n<code>Workbooks(file).Worksheets(ActiveSheet.Name).Copy...</code> because the <code>Workbooks(&lt;argument&gt;)</code> is expecting just the name of the file, without full path. You are parsing a full path.  </p>\n\n<h1>Fixed code</h1>\n\n<pre><code>Private Sub CmdBrowseFile_Click()\n\n    Dim intChoice As Integer, total As Integer 'note the correct declaring, for each variable As Type\n    Dim strFilePath As String, strControlFile As String\n    Dim strFileName As String\n\n    strControlFile = ActiveWorkbook.Name\n    'only allow the user to select one strFilePath\n    Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\n    'Remove all other filters\n    Call Application.FileDialog(msoFileDialogOpen).Filters.Clear\n    'Add a custom filter\n    Call Application.FileDialog(msoFileDialogOpen).Filters.Add( _\n        \"Text Files Only\", \"*.xlsx\")\n    'make the strFilePath dialog visible to the user\n    intChoice = Application.FileDialog(msoFileDialogOpen).Show\n    'determine what choice the user made\n    If intChoice &lt;&gt; 0 Then\n        'get the strFilePath path selected by the user\n        strFilePath = Application.FileDialog( _\n            msoFileDialogOpen).SelectedItems(1)\n        'get the file name\n        strFileName = Dir(strFilePath)\n        'open strFilePath\n        Workbooks.Open fileName:=strFilePath\n        total = Workbooks(strControlFile).Worksheets.Count\n        Workbooks(strFileName).Worksheets(ActiveSheet.Name).Copy _\n        after:=Workbooks(strControlFile).Worksheets(total)\n        Windows(strFileName).Activate\n        ActiveWorkbook.Close SaveChanges:=False\n        Windows(strControlFile).Activate\n    End If\n\nEnd Sub  \n</code></pre>\n\n<h2>Notes</h2>\n\n<p>The main change is the <code>Dim strFileName As String</code> and <code>strFileName = Dir(strFilePath)</code> and it's usage in the code after opening the new book. I changed the variables names for test purposes, I can read it more easily this way. You can use rename tool to revert the changes.</p>\n"}], "owner": {"reputation": 23, "user_id": 4715520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3409fb0dcba59f102b9b47d3386873f?s=128&d=identicon&r=PG&f=1", "display_name": "Liew Yuqi", "link": "https://stackoverflow.com/users/4715520/liew-yuqi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 29386313, "answer_count": 1, "score": 0, "last_activity_date": 1427877587, "creation_date": 1427873899, "last_edit_date": 1531164843, "question_id": 29385312, "link": "https://stackoverflow.com/questions/29385312/subscript-out-of-range-when-copying-worksheet", "title": "Subscript out of range when copying worksheet", "body": "<p>I would like to create a command button which imports the selected file into the current workbook.<br>\nI'm getting <code>Subscript out of range error</code> and I cannot find out the solution.<br>\nHere is what I have:</p>\n\n<pre><code>Private Sub CmdBrowseFile_Click()\nDim intChoice, total As Integer\nDim file, ControlFile As String\n\nControlFile = ActiveWorkbook.Name\n'only allow the user to select one file\nApplication.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\n'Remove all other filters\nCall Application.FileDialog(msoFileDialogOpen).Filters.Clear\n'Add a custom filter\nCall Application.FileDialog(msoFileDialogOpen).Filters.Add( _\n    \"Text Files Only\", \"*.xlsx\")\n'make the file dialog visible to the user\nintChoice = Application.FileDialog(msoFileDialogOpen).Show\n'determine what choice the user made\nIf intChoice &lt;&gt; 0 Then\n    'get the file path selected by the user\n    file = Application.FileDialog( _\n        msoFileDialogOpen).SelectedItems(1)\n    'open file\n    Workbooks.Open fileName:=file\n    total = Workbooks(ControlFile).Worksheets.Count\n    Workbooks(file).Worksheets(ActiveSheet.Name).Copy _\n    after:=Workbooks(ControlFile).Worksheets(total)\n    Windows(file).Activate\n    ActiveWorkbook.Close SaveChanges:=False\n    Windows(ControlFile).Activate\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "merge", "pivot", "combinations"], "comments": [{"owner": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "edited": false, "score": 0, "creation_date": 1427871803, "post_id": 29384575, "comment_id": 46947775, "body": "So if I understand your question, for each unique combination of values in cols A,B,C,D you want to separately sum columns E and F?  If that is it, where to you intend to place the results?  You&#39;ll need to use an array to store the combination (cols A&amp;B&amp;C&amp;D) and to store the two sums.  As you go from row to row, you look in the array to see if the combination already exists.  If so, add the new E,F values to whats already in the array.  If the combination does not exist, add a new entry to the end of the array with this new combination, and store the E,F values."}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "reply_to_user": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "edited": false, "score": 0, "creation_date": 1427872065, "post_id": 29384575, "comment_id": 46947889, "body": "The result will be in the first unique identifier row. The first row with the unique identifier remains and gets its sums added from other rows (which are deleted)."}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1427873912, "post_id": 29384575, "comment_id": 46948856, "body": "Lol, it is not homework. The records are radiations measurements from a PRM-9000 :D"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1427878852, "post_id": 29386035, "comment_id": 46951504, "body": "Thanks Jeeped: it works! But is there no other ways than the formulas? I was looking for a VBA-only solution for this."}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1427940208, "post_id": 29386035, "comment_id": 46982892, "body": "Thanks Jeeped! It looks amazing! But I get a &quot;Compile Error, User-defined Type not defined.&quot; on Dim dRADs As New Scripting.Dictionary :( Any idea about what is causing the error?"}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1427940797, "post_id": 29386035, "comment_id": 46983025, "body": "No worries. I am sorry I do not know better. I use Excel 2010 (on Windows 7), and cannot find Windows Scripting Runtime. It seems that I have to download it. What version of Excel are you using? Did you also have to download it?"}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1427941403, "post_id": 29386035, "comment_id": 46983151, "body": "Any way to do it without Windows Scripting Runtime? I have tried to download/install WSR but it gives me errors :( It seems that the alternative to a scripting dictionary would be an array (I am trying to educate myself on the topic)."}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1427943173, "post_id": 29386035, "comment_id": 46983522, "body": "Thanks Jeeped. Cannot believed I missed it. All works like a charm. Actively studying what you wrote, am familiar with arrays, but not sophisticated ones like that."}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1427955960, "post_id": 29386035, "comment_id": 46987164, "body": "Unfortunately, after doing manual calculations and checking the results, it does not seem to sum the integers where there are +2 identical types, it works for 2, but then there are 3 X or Y for an ABC, it sums the first 2 and then prints the last one separately :("}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1427956965, "post_id": 29386035, "comment_id": 46987576, "body": "Thanks Jeeped, that would be awesome. I actually learnt deal on .value2 and join looking at your code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1428003236, "post_id": 29386035, "comment_id": 47013734, "body": "@clippertm - after mulling it over a bit, the addition of dynamic keys and ints wasn&#39;t so bad. See <i>iNumKeys</i> and <i>iNumInts</i>."}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1428462502, "post_id": 29386035, "comment_id": 47167584, "body": "Genius! Thanks Jeeped! Looks like the commented (&#39;) iNumKeys and iNumInts arethe preferred way. I am testing it through my spreadsheets."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1428003095, "last_edit_date": 1428003095, "creation_date": 1427876558, "answer_id": 29386035, "question_id": 29384575, "link": "https://stackoverflow.com/questions/29384575/combine-rows-sum-values-in-a-worksheet/29386035#29386035", "title": "Combine Rows &amp; Sum Values in a Worksheet", "body": "<ol>\n<li>Sort them on all alphabetic columns you deem important.</li>\n<li><p>In an unused column to the right use a formula like the following in the second row,</p>\n\n<p>=IF($A2&amp;$B2&amp;$C2&amp;$D2=$A3&amp;$B3&amp;$C3&amp;$D3, \"\", SUMIFS(E:E,$A:$A, $A2,$B:$B, $B2,$C:$C, $C2,$D:$D, $D2))</p></li>\n<li><p>Copy that formula right one column then fill both columns down as far as your data goes</p></li>\n<li><p>Filter on the two columns, removing blanks.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/KVsP8.png\" alt=\"radiations measurements from a PRM-9000\"></p></li>\n<li><p>Optionally copy the data to a new report worksheet and remove columns E &amp; F.</p></li>\n</ol>\n\n<p><strong>Addendum:</strong></p>\n\n<p>A more automated approach could be achieved with some form of array and some simple mathematical operations. I've chosen a dictionary object in order to take use of its indexed <em>Key</em> to recognize patterns in the first four alphabetic identifiers.</p>\n\n<p>To use a scripting dictionary, you need to go into the VBE's Tools \u25ba References and add Microsoft Scripting Runtime. The following code will not compile without it.</p>\n\n<p>The following has been adjusted for dynamic columns of keys and integers.</p>\n\n<pre><code>Sub rad_collection()\n    Dim rw As Long, nc As Long, sTMP As String, v As Long, vTMP As Variant\n    Dim i As Long, iNumKeys As Long, iNumInts As Long\n    Dim dRADs As New Scripting.Dictionary\n\n    dRADs.CompareMode = vbTextCompare\n    iNumKeys = 5    'possibly calculated by num text (see below)\n    iNumInts = 2    'possibly calculated by num ints (see below)\n\n    With ThisWorkbook.Sheets(\"Sheet4\").Cells(1, 1).CurrentRegion\n        'iNumKeys = Application.CountA(.Rows(2)) - Application.Count(.Rows(2))  'alternate count of txts\n        'iNumInts = Application.Count(.Rows(2))    'alternate count of ints\n        For rw = 2 To .Cells(Rows.Count, 1).End(xlUp).row\n                vTMP = .Cells(rw, 1).Resize(1, iNumKeys).Value2\n                sTMP = Join(Application.Index(vTMP, 1, 0), Chr(183))\n                If Not dRADs.Exists(sTMP) Then\n                    dRADs.Add Key:=sTMP, Item:=Join(Application.Index(.Cells(rw, iNumKeys + 1).Resize(1, iNumInts).Value2, 1, 0), Chr(183))\n                Else\n                    vTMP = Split(dRADs.Item(sTMP), Chr(183))\n                    For v = LBound(vTMP) To UBound(vTMP)\n                        vTMP(v) = vTMP(v) + .Cells(rw, iNumKeys + 1 + v).Value2\n                    Next v\n                    dRADs.Item(sTMP) = Join(vTMP, Chr(183))\n                End If\n\n        Next rw\n\n        rw = 1\n        nc = iNumKeys + iNumInts + 1\n        .Cells(rw, nc + 1).CurrentRegion.ClearContents  'clear previous\n        .Cells(rw, nc + 1).Resize(1, nc - 1) = .Cells(rw, 1).Resize(1, nc - 1).Value2\n        For Each vTMP In dRADs.Keys\n            'Debug.Print vTMP &amp; \"|\" &amp; dRADs.Item(vTMP)\n            rw = rw + 1\n            .Cells(rw, nc + 1).Resize(1, iNumKeys) = Split(vTMP, Chr(183))\n            .Cells(rw, nc + iNumKeys + 1).Resize(1, iNumInts) = Split(dRADs.Item(vTMP), Chr(183))\n            .Cells(rw, nc + iNumKeys + 1).Resize(1, iNumInts) = _\n              .Cells(rw, nc + iNumKeys + 1).Resize(1, iNumInts).Value2\n        Next vTMP\n    End With\n\n    dRADs.RemoveAll: Set dRADs = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Just run the macro against the numbers you have provided as samples. I've assumed some form of column header labels in the first row. The dictionary object is populated and duplicates in the combined identifiers have their numbers summed. All that is left is to split them back up and return them to the worksheet in an unused area.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/LTncm.png\" alt=\"Rad measurement collection\"></p>\n\n<p>Location of Microsoft Scripting Runtime - In the Visual Basic Editor (aka VBE) choose Tools \u25ba References (<kbd>Alt</kbd>+<kbd>T</kbd>,<kbd>R</kbd>) and scroll down a little more than halfway to find it.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/hYgCT.png\" alt=\"Microsoft Scripting Runtime\"></p>\n"}], "owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1129, "favorite_count": 0, "accepted_answer_id": 29386035, "answer_count": 1, "score": 1, "last_activity_date": 1428006285, "creation_date": 1427871079, "last_edit_date": 1428006285, "question_id": 29384575, "link": "https://stackoverflow.com/questions/29384575/combine-rows-sum-values-in-a-worksheet", "title": "Combine Rows &amp; Sum Values in a Worksheet", "body": "<p>I have an excel sheet with the below (pipe \"|\" to delimit columns) data.</p>\n\n<pre><code>A|B|C|X|50|60\nD|E|F|X|40|30\nA|B|C|X|10|20\nA|B|C|Y|20|20\nA|B|C|X|20|70\nD|E|F|X|10|50\nA|B|C|Y|10|10\n</code></pre>\n\n<p>The result I am trying to get is:</p>\n\n<pre><code>A|B|C|X|80|150\nA|B|C|Y|30|30\nD|E|F|X|50|80\n</code></pre>\n\n<p>Values A, B, C and D, E, F are like unique identifiers. Actually only A or D can be considered. Values X and Y are like \"types\", and the integers are the values to sum. This sample was simplified, there are thousands of unique identifiers, dozen of types and dozens of values to sum. The rows are not sorted, the types can be located in higher or lower rows. I am trying to avoid the use of a pivot table.</p>\n\n<pre><code>Dim LastRow As Integer\nDim LastCol As Integer\nDim i As Integer\n\nLastCol = Sheets(1).Cells(1, Columns.Count).End(xlToLeft).Column\nLastRow = Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To LastRow\n????\nNext i\n</code></pre>\n\n<p>The code above gets to the point of looping through the rows but I am unclear on what to after that point.</p>\n"}, {"tags": ["excel", "ado", "vba"], "comments": [{"owner": {"reputation": 329, "user_id": 3124743, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/be77d0d2e3a18e52ac5f382e99762106?s=128&d=identicon&r=PG&f=1", "display_name": "techworld", "link": "https://stackoverflow.com/users/3124743/techworld"}, "edited": false, "score": 0, "creation_date": 1427944912, "post_id": 29383715, "comment_id": 46983920, "body": "can anyone help me to guide where i am making mistake"}], "answers": [{"tags": [], "owner": {"reputation": 2599, "user_id": 6574422, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Gkbt4.jpg?s=128&g=1", "display_name": "Kitson88", "link": "https://stackoverflow.com/users/6574422/kitson88"}, "is_accepted": false, "score": 0, "last_activity_date": 1474889527, "creation_date": 1474889527, "answer_id": 39701698, "question_id": 29383715, "link": "https://stackoverflow.com/questions/29383715/run-time-error-3251-current-recordset-does-not-support-updating/39701698#39701698", "title": "run time error 3251 current recordset does not support updating", "body": "<p>I know this is an old thread but I had the same issue sometime ago and felt it was worth updating everyone with what resolved it for me. </p>\n\n<p>Similar situation to yourself, everything was working fine then all of a sudden it was unable to write to Access DB. This issue for me was down to an IT migration which recently happend and all the users only had Read NTFS access to the Access DB. Giving users write NTFS access resolved the issue. </p>\n"}, {"tags": [], "owner": {"reputation": 378, "user_id": 5150025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kuv962nK3Vs/AAAAAAAAAAI/AAAAAAAABLE/uhwOHa1VuOQ/photo.jpg?sz=128", "display_name": "Marcelo Gazzola", "link": "https://stackoverflow.com/users/5150025/marcelo-gazzola"}, "is_accepted": false, "score": 0, "last_activity_date": 1568382625, "creation_date": 1568382625, "answer_id": 57924905, "question_id": 29383715, "link": "https://stackoverflow.com/questions/29383715/run-time-error-3251-current-recordset-does-not-support-updating/57924905#57924905", "title": "run time error 3251 current recordset does not support updating", "body": "<p>Some many years after this question I found a solution that I think it can help others.</p>\n\n<p>Instead open the record set using a SQL statement you should want to open using the statement below:</p>\n\n<p><code>rst.Open [TABLE_NAME], [ACTIVE_CONNECTION], adOpenKeyset, adLockOptimistic, adCmdTable</code></p>\n\n<p>Adapting to your code:</p>\n\n<p><code>rst.Open \"CT\", cn, adOpenKeyset, adLockOptimistic, adCmdTable</code></p>\n\n<p>Then you can use the method <code>find</code> to search the record in your database. It is the equivalent to SQL SELECT.</p>\n\n<p><code>rst.Find \"Invoice_ID = \" &amp; Me.ID.Value</code></p>\n\n<p>Now you are able to edit the record set.</p>\n\n<p>Example:</p>\n\n<p><code>rst!Last_Updated_by = Environ(\"Username\")</code></p>\n"}], "owner": {"reputation": 329, "user_id": 3124743, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/be77d0d2e3a18e52ac5f382e99762106?s=128&d=identicon&r=PG&f=1", "display_name": "techworld", "link": "https://stackoverflow.com/users/3124743/techworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2265, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1568382625, "creation_date": 1427867396, "last_edit_date": 1531164843, "question_id": 29383715, "link": "https://stackoverflow.com/questions/29383715/run-time-error-3251-current-recordset-does-not-support-updating", "title": "run time error 3251 current recordset does not support updating", "body": "<p>I am using excel 2007. i have successfully updated record sets in past using this code but Don't know why i start getting \"run time error 3251\"  on this one. Can someone help me to find out. please.</p>\n\n<p>for information, i am fetching data from access to excel vba user form &amp; then doing some updation &amp; deletion as per requirement.</p>\n\n<pre><code> Private Sub Update_Finance_return_details_Click()\n\nDim rs As ADODB.Recordset\nDim strSQL As String\nDim myDB As String\nDim cn As Object\n\nOn Error GoTo ErrorHandler\n\n  Set cn = CreateObject(\"ADODB.Connection\")\n\n  myDB = \"X:\\COMMERCIAL\\New Automated Invioce \n  Tracker\\Commercial_Invoice_Tracker.accdb\"\n\n  cn.CursorLocation = adUseServer\n\n  With cn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"    'For *.ACCDB Databases\n    .ConnectionString = myDB\n    .Open\n  End With\n\n  Set rs = New ADODB.Recordset\n  If rs.State &lt;&gt; adStateClosed Then rs.Close\n\n  strSQL = \"SELECT * FROM [CT] WHERE [Invoice_ID] = \" &amp; Me.ID.Value &amp; \"\"\n\n  rs.CursorLocation = adUseServer\n  rs.Open strSQL, cn, adOpenKeyset, adLockOptimistic\n\n  With rs\n    If (Me.Clarification_Rec_Date_return.Visible = True) Then\n        !Fin_Query_Dt = Me.Clarification_Rec_Date_return.Value\n    Else\n        !Fin_Query_Dt = Null\n    End If\n\n    !Fin_Query = Me.Clarification_Received_Finance_return.Value\n\n    If (Me.Clarification_Resolve_date_return.Visible = True) Then\n      !Fin_Query_Resolve_Dt =  Me.Clarification_Resolve_date_return.Value\n    Else\n        !Fin_Query_Resolve_Dt = Null\n    End If\n    !Last_Updated_by = Environ(\"Username\")\n    !Last_Updated_on = Now\n\n   .Update\n   .Close\n End With\n\n MsgBox (\"Record Updated Successfully\")\n\nCleanExit:\n   cn.Close\n   Set rs = Nothing\n   Set cn = Nothing\n   Application.ScreenUpdating = True\n\n   Exit Sub\nErrorHandler:\n   MsgBox Err.Description\n   Resume CleanExit\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427862095, "post_id": 29382630, "comment_id": 46944577, "body": "If you are using <code>Workbooks.Open</code> then the process is essentially a File \u25ba Open as opposed to an import to an existing or new worksheet. There will be only one worksheet when a CSV is open in this manner. Use  <code>Sheets(1)</code> worksheet object reference or the <code>Sheet1</code> sheet codename to reference it."}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "edited": false, "score": 0, "creation_date": 1427862326, "post_id": 29382630, "comment_id": 46944628, "body": "@Jeeped thanks! Sorry I&#39;m a little new to VBA; so do I edit the codes to Workbooks.Open().Sheets(1) ?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1427871592, "post_id": 29382630, "comment_id": 46947677, "body": "A CSV is just a text file. You don&#39;t need to import it into Excel to work on it. You can use an excel macro to change the text file directly."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427863319, "post_id": 29382913, "comment_id": 46944872, "body": "That could probably use a <code>wb.Close, False</code> before setting wb to nothing and leaving the sub."}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "edited": false, "score": 0, "creation_date": 1427875316, "post_id": 29382913, "comment_id": 46949566, "body": "Thank you @Jeeped, works great! Can&#39;t believe I couldn&#39;t figure out this simple solution"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1427862838, "creation_date": 1427862838, "answer_id": 29382913, "question_id": 29382630, "link": "https://stackoverflow.com/questions/29382630/opening-and-reading-a-csv-file-without-sheet-name/29382913#29382913", "title": "Opening and reading a CSV file without sheet name", "body": "<p>If you are using Workbooks.Open then the process is essentially a File \u25ba Open as opposed to an import to an existing or new worksheet. There will be only one worksheet when a CSV is open in this manner. Use <code>Sheets(1)</code> worksheets object collection reference or the <code>Sheet1</code> sheet codename to reference it. Example:</p>\n\n<pre><code>Dim rw As Long, lastRow As Long, file_Path As String, wb As Workbook, oSht_Input As Worksheet\n\nfile_Path = \"something\"\nSet wb = Workbooks.Open(file_Path, UpdateLinks:=False)\nSet oSht_Input = wb.Sheets(1)\n\nWith oSht_Input\n    lastRow = .Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    For rw = 2 To lastRow\n        'do stuff to .Cells or .Range here\n        extractedDataFileRecord.Variable1 = CStr(.Cells(rw, 1))\n    Next rw\nEnd With\n\nSet oSht_Input = Nothing\nSet wb = Nothing\n</code></pre>\n\n<p>That should get you going. I've used the worksheet reference in a <code>With ... End With</code> so that subsequent .cells and .range references need only be prefaced with a period to show the parent.</p>\n"}], "owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1654, "favorite_count": 0, "accepted_answer_id": 29382913, "answer_count": 1, "score": 0, "last_activity_date": 1427870502, "creation_date": 1427860964, "last_edit_date": 1427870502, "question_id": 29382630, "link": "https://stackoverflow.com/questions/29382630/opening-and-reading-a-csv-file-without-sheet-name", "title": "Opening and reading a CSV file without sheet name", "body": "<p>I'm trying to write VBA Codes that will read a given CSV file name and do some changes to the data before writing into another CSV file.</p>\n\n<pre><code>Set oSht_Input = Workbooks.Open(file_Path, UpdateLinks:=False).Worksheets(extractDataFile.convertedSheetName)\nlastRow = oSht_Input.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nFor Rows = 2 To lastRow\n    extractedDataFileRecord.Variable1 = CStr(oSht_Input.Cells(Rows, 1))\n\n.... code continues\n</code></pre>\n\n<p>This code is working fine generally.</p>\n\n<p>However, the flaw is that CSV files will just copy the file name and place into the sheet name. Therefore I can safely assume that the variable <em>convertedSheetName</em> is equivalent to the filename provided.</p>\n\n<p>This code will work if the file name is short enough to be copied into the sheet name. However if the file name is too long, the filename gets cut off within the sheet name, thus I am not able to get the correct reference to set the Worksheet object.</p>\n\n<p>Is there a better way to actually get the sheet reference, so that I can read the Cell Values within the sheet?</p>\n"}, {"tags": ["vba", "date", "excel", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427849711, "post_id": 29381013, "comment_id": 46941770, "body": "I understand that the cell is displaying <i>0215</i> but if you look in the formula bar, are you seeing <i>0215</i> or <i>215</i>? Do you want to change the values in the cells or create another column with date values? Do you want the first or last day of the month; pick one."}, {"owner": {"reputation": 571, "user_id": 3814836, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a3c6a6917f045bfe22eb3355a759cdbe?s=128&d=identicon&r=PG&f=1", "display_name": "James Willcox", "link": "https://stackoverflow.com/users/3814836/james-willcox"}, "edited": false, "score": 0, "creation_date": 1427849856, "post_id": 29381013, "comment_id": 46941797, "body": "seeing 215, new column and first"}], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 2, "last_activity_date": 1427849775, "creation_date": 1427849775, "answer_id": 29381122, "question_id": 29381013, "link": "https://stackoverflow.com/questions/29381013/converting-mmyy-into-a-useable-date/29381122#29381122", "title": "Converting mmyy into a useable date", "body": "<p>use this</p>\n\n<pre><code>=DATEVALUE(\"01/\"&amp;LEFT(A1;2)&amp;\"/20\"&amp;RIGHT(A1;2))\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/tYHXw.jpg\" alt=\"enter image description here\"></p>\n\n<p>do not forget to change Format Cells to \"Date\" for column \"B\"</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1427850110, "creation_date": 1427850110, "answer_id": 29381170, "question_id": 29381013, "link": "https://stackoverflow.com/questions/29381013/converting-mmyy-into-a-useable-date/29381170#29381170", "title": "Converting mmyy into a useable date", "body": "<p>With the 'dates' starting in A2, use this formula in an unused column to the right,</p>\n\n<pre><code>=DATE(20&amp;RIGHT(A2, 2), LEFT(TEXT(A2, \"0000\"), 2), 1)\n</code></pre>\n\n<p>Fill down as necessary. You will have to format as a date or you will receive the raw date value like <em>42064</em>.</p>\n\n<p>If you need the end-of-month, add <em>1</em> to the month and change the day to <em>0</em> like,</p>\n\n<pre><code>=DATE(20&amp;RIGHT(A2, 2), LEFT(TEXT(A2, \"0000\"), 2)+1, 0)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427860274, "post_id": 29381598, "comment_id": 46944194, "body": "Bonus points for brevity but a dozen or so extra characters will guard against <i>215</i> vs <i>0215</i> e.g. <code>=1*REPLACE(&quot;1&#47;&quot;&amp;TEXT(A1, &quot;0000;@&quot;),5,0,&quot;&#47;20&quot;)</code>. My m/d/yy regional system also interprets the OP&#39;s first sample value as 02-Jan-2015. A small change to <code>=1*REPLACE(TEXT(A1, &quot;0000;@&quot;),3,0,&quot;&#47;1&#47;20&quot;)</code> addresses the regional issue."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 4, "last_activity_date": 1427854098, "last_edit_date": 1427854098, "creation_date": 1427853500, "answer_id": 29381598, "question_id": 29381013, "link": "https://stackoverflow.com/questions/29381013/converting-mmyy-into-a-useable-date/29381598#29381598", "title": "Converting mmyy into a useable date", "body": "<p>30 characters:  </p>\n\n<pre><code>=1*REPLACE(\"1/\"&amp;A1,5,1,\"/201\")\n</code></pre>\n\n<p>Subject to the dates concerned the <code>20</code> may be redundant.</p>\n"}], "owner": {"reputation": 571, "user_id": 3814836, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a3c6a6917f045bfe22eb3355a759cdbe?s=128&d=identicon&r=PG&f=1", "display_name": "James Willcox", "link": "https://stackoverflow.com/users/3814836/james-willcox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1449, "favorite_count": 0, "accepted_answer_id": 29381170, "answer_count": 3, "score": 3, "last_activity_date": 1442244634, "creation_date": 1427849088, "last_edit_date": 1495535202, "question_id": 29381013, "link": "https://stackoverflow.com/questions/29381013/converting-mmyy-into-a-useable-date", "title": "Converting mmyy into a useable date", "body": "<p>My question is very similar to this problem, but for Excel: <a href=\"https://stackoverflow.com/questions/22566950/how-do-i-convert-mmyy-to-last-day-of-month-in-netezza\">how do I convert mmyy to last day of month in netezza</a> or this one: <a href=\"https://stackoverflow.com/questions/5262109/create-a-date-from-credit-card-expire-in-mmyy-format\">Create a date from Credit Card expire in MMYY format</a>.</p>\n\n<p>Essentially I have a column filled with dates that have been written as mmyy i.e.</p>\n\n<blockquote>\n  <p>0215<br>\n  0215<br>\n  0215<br>\n  0315<br>\n  0315</p>\n</blockquote>\n\n<p>The column has been saved as the data type: \"Special\".  </p>\n\n<p>How do I convert this data into a useable format? I don't mind if we put it into <em>dd/mm/yyyy</em> and use the first or the last day of the month that's fine.  Is there an Excel function that I could use or is this something I would have to do in VBA and if so, how?</p>\n"}, {"tags": ["macos", "vba", "excel"], "comments": [{"owner": {"reputation": 61, "user_id": 3838257, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/690cb163a6aef513b8f7a664742cd52c?s=128&d=identicon&r=PG&f=1", "display_name": "zigzaugg", "link": "https://stackoverflow.com/users/3838257/zigzaugg"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427850778, "post_id": 29381009, "comment_id": 46942053, "body": "In edit, all of the options are grayed out. When I hit record, after hitting OK, a dialog opens up saying &#39;Unable to Record&#39;"}, {"owner": {"reputation": 61, "user_id": 3838257, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/690cb163a6aef513b8f7a664742cd52c?s=128&d=identicon&r=PG&f=1", "display_name": "zigzaugg", "link": "https://stackoverflow.com/users/3838257/zigzaugg"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1427949404, "post_id": 29381009, "comment_id": 46984936, "body": "It was a miss-install because of Migrator, Thanks!"}], "owner": {"reputation": 61, "user_id": 3838257, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/690cb163a6aef513b8f7a664742cd52c?s=128&d=identicon&r=PG&f=1", "display_name": "zigzaugg", "link": "https://stackoverflow.com/users/3838257/zigzaugg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1427849063, "creation_date": 1427849063, "question_id": 29381009, "link": "https://stackoverflow.com/questions/29381009/excel-vba-for-mac-wont-start", "title": "Excel VBA for Mac won&#39;t start", "body": "<p>I'm trying to use VBA on Mac Excel 2011, but nothing seems to be responding. When I click on the 'Editor' button, a blank window that says 'Project' appears, in which I can do nothing. If I hit macros, a window comes up allowing me to input a name and hit create, but that is all and nothing happens after I hit create. I am able to place things like buttons, but I am unable to assign any VBA macros to them. How do I go about getting started on VBA or fixing this problem? Do I need to set up a workspace or something?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1427850218, "post_id": 29381053, "comment_id": 46941905, "body": "Unfortunately this approach doesn&#39;t work, I tried to change clearcontents to clear as well, still doesn&#39;t work.  I would like it to be dynamic but I may need to go with a static range to work around it"}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1427850516, "post_id": 29381053, "comment_id": 46941973, "body": "What range does <code>.Range(&quot;F2:F&quot; &amp; .Range(&quot;F2&quot;).End(xlDown)).address</code> return?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 1, "creation_date": 1427850618, "post_id": 29381053, "comment_id": 46942010, "body": "@PootyToot - Just tested it. Worked fine. I strongly suspect that the <i>Config Sheet</i> you are targeting is not in the same workbook as that code module. <code>ThisWorkbook</code> refers to the workbook that the code module resides in."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1427849295, "creation_date": 1427849295, "answer_id": 29381053, "question_id": 29380938, "link": "https://stackoverflow.com/questions/29380938/excel-vba-clear-column-contents-from-row-2-down/29381053#29381053", "title": "Excel VBA - Clear Column contents from row 2 down", "body": "<p>Try expanding the range to be more than just a single cell.</p>\n\n<pre><code>with wb3.Worksheets(\"Config Sheet\")\n    .Range(\"F2:F\" &amp; .range(\"F2\").End(xlDown).row).ClearContents\nend with\n</code></pre>\n\n<p>If you go to the <em>Config Sheet</em> worksheet, select F2 and tap <kbd>Ctrl</kbd>+<kbd>\u2193</kbd>, you will only have the last cell selected. The above modification is the same as if you had tapped <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>\u2193</kbd>.</p>\n"}], "owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8971, "favorite_count": 0, "accepted_answer_id": 29381053, "answer_count": 1, "score": 1, "last_activity_date": 1427849295, "creation_date": 1427848612, "question_id": 29380938, "link": "https://stackoverflow.com/questions/29380938/excel-vba-clear-column-contents-from-row-2-down", "title": "Excel VBA - Clear Column contents from row 2 down", "body": "<p>I am trying to clear column contents from row 2 down on a VBA script which I am running, the piece of code below is how I am going about this.</p>\n\n<p>This doesn't appear to be working, but no syntax issues or error messages.  Are there issues with this code?</p>\n\n<pre><code>Option Compare Text\nOption Explicit\n\nSub Loader()\n\nDim wb3 As Workbook\nSet wb3 = ThisWorkbook\n\nwb3.Worksheets(\"Config Sheet\").Range(\"F2\").End(xlDown).ClearContents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "charts"], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 1, "last_activity_date": 1427851628, "creation_date": 1427851628, "answer_id": 29381364, "question_id": 29380847, "link": "https://stackoverflow.com/questions/29380847/how-to-set-a-scatter-chart-legend-in-vba/29381364#29381364", "title": "How to set a scatter chart legend in VBA?", "body": "<p>How are the points colored differently? If you use two series of X and Y values, each series will have its own formatting and series name, both of which are displayed in the legend. One of the default legend positions is \"top\", which means between the chart and the chart title.</p>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1427851689, "creation_date": 1427851689, "answer_id": 29381371, "question_id": 29380847, "link": "https://stackoverflow.com/questions/29380847/how-to-set-a-scatter-chart-legend-in-vba/29381371#29381371", "title": "How to set a scatter chart legend in VBA?", "body": "<p>That's not really how scatterplots work. Without seeing your worksheet, I suspect that what you have is <em>one</em> series of data (two columns, so that would be your X/Y pairs).  No matter what colors you apply to the points, Excel still interprets this as <em>one series</em> of data, so you will only ever get one legend entry.</p>\n\n<p>Add a second series, and you'll get a second legend entry.</p>\n\n<p><img src=\"https://i.stack.imgur.com/zbmVS.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 61, "user_id": 4322375, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2aa1ea4c6053758a69783d120e9557b1?s=128&d=identicon&r=PG&f=1", "display_name": "Evgraph", "link": "https://stackoverflow.com/users/4322375/evgraph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1427851689, "creation_date": 1427847981, "question_id": 29380847, "link": "https://stackoverflow.com/questions/29380847/how-to-set-a-scatter-chart-legend-in-vba", "title": "How to set a scatter chart legend in VBA?", "body": "<p>It seems to be a simple problem, but I cannot find a solution anywhere. I have a scatter chart created from two columns of data in Excel by a VBA macro. There are 500 points (pairs of XY values), 200 of which have green color, the rest are blue. The chart is perfect and has everything except the legend. I want to add a very simple legend on the  top of the chart, below the title, showing something like this: blue dot -- \"data N1\" and green dot -- \"data N2\".</p>\n\n<p>How to do it?</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "spreadsheet"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4736129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08bfe741d3f6c7a4eb0d7b7ed01b697?s=128&d=identicon&r=PG&f=1", "display_name": "Mike L", "link": "https://stackoverflow.com/users/4736129/mike-l"}, "edited": false, "score": 0, "creation_date": 1427872354, "post_id": 29381303, "comment_id": 46948033, "body": "This seems to work just as activecell.copy or Ctrl-C do... without any formatting or line breaks. Am I missing something?"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 3, "user_id": 4736129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08bfe741d3f6c7a4eb0d7b7ed01b697?s=128&d=identicon&r=PG&f=1", "display_name": "Mike L", "link": "https://stackoverflow.com/users/4736129/mike-l"}, "edited": false, "score": 0, "creation_date": 1427878954, "post_id": 29381303, "comment_id": 46951561, "body": "@MikeL Try changing the <code>ActiveCell.Value</code> in @Vasily &#39;s code, to <code>ActiveCell.Text</code>"}, {"owner": {"reputation": 3, "user_id": 4736129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08bfe741d3f6c7a4eb0d7b7ed01b697?s=128&d=identicon&r=PG&f=1", "display_name": "Mike L", "link": "https://stackoverflow.com/users/4736129/mike-l"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427943397, "post_id": 29381303, "comment_id": 46983568, "body": "@BranislavKoll&#225;r Tried switching to activecell.text but I still get the same result in the clipboard (unformatted)"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1427851147, "creation_date": 1427851147, "answer_id": 29381303, "question_id": 29380837, "link": "https://stackoverflow.com/questions/29380837/copy-cell-contents-excel-2010-vba/29381303#29381303", "title": "Copy Cell Contents - Excel 2010 VBA", "body": "<p>use this</p>\n\n<pre><code>Sub copy()\n    Dim clipboard As Object\n    Set clipboard = CreateObject(\"new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    clipboard.SetText ActiveCell.Value\n    clipboard.PutInClipboard\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1427962697, "creation_date": 1427962697, "answer_id": 29408186, "question_id": 29380837, "link": "https://stackoverflow.com/questions/29380837/copy-cell-contents-excel-2010-vba/29408186#29408186", "title": "Copy Cell Contents - Excel 2010 VBA", "body": "<p>How about this. It's a character by character approach :  </p>\n\n<pre><code>Sub CopyCellContents()\n\n'divides original cell into multiple, delimiter is line break (character 10)\n'copies the individual character text and formatting\n'copies result into clipboard\n\nDim wsSrc As Worksheet 'sheet with original cells, the ones we want to copy from\nDim wsTemp As Worksheet 'sheet with temporatily stored data, cells from here will be in clipboard\nDim intOrigChars As Integer 'count of characters in original cell\nDim intDestChars As Integer 'count of characters in destination cell (varies by rows)\n\nSet wsSrc = Worksheets(\"format\") 'change to suit\nSet wsTemp = Worksheets(\"Temp\") 'change to suit, create new sheet, just for purpose of temporarily storing contents of cell\n\n    With wsSrc\n        intDestChars = 1\n        'loop through all the characters in original cell; Change \".Cells(1, 1)\" to suit you - use rename tool to change all of them below\n        For intOrigChars = 1 To .Cells(1, 1).Characters.Count\n            'if the character is a line break (character 10), move to next row and reset destination characters to 1\n            If Asc(.Cells(1, 1).Characters(intOrigChars, 1).Text) = 10 Then\n                rowAdd = rowAdd + 1\n                intDestChars = 1\n            Else\n                'copy text and formatting to temporary cells\n                With wsTemp.Cells(1 + rowAdd, 1).Characters(intDestChars, 1)\n                   .Text = wsSrc.Cells(1, 1).Characters(intOrigChars, 1).Text\n                   With .Font\n                    .Bold = wsSrc.Cells(1, 1).Characters(intOrigChars, 1).Font.Bold\n                    .Color = wsSrc.Cells(1, 1).Characters(intOrigChars, 1).Font.Color\n                    .Italic = wsSrc.Cells(1, 1).Characters(intOrigChars, 1).Font.Italic\n                    .Underline = wsSrc.Cells(1, 1).Characters(intOrigChars, 1).Font.Underline\n                    .FontStyle = wsSrc.Cells(1, 1).Characters(intOrigChars, 1).Font.FontStyle\n                    End With\n                End With\n                intDestChars = intDestChars + 1\n            End If\n\n        Next\n    End With 'wsSrc\n\n    'put result cells into clipboard\n    With wsTemp\n        .Range(.Cells(1, 1), .Cells(rowAdd + 1, 1)).Copy\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4736129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08bfe741d3f6c7a4eb0d7b7ed01b697?s=128&d=identicon&r=PG&f=1", "display_name": "Mike L", "link": "https://stackoverflow.com/users/4736129/mike-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 29408186, "answer_count": 2, "score": 0, "last_activity_date": 1427962697, "creation_date": 1427847953, "question_id": 29380837, "link": "https://stackoverflow.com/questions/29380837/copy-cell-contents-excel-2010-vba", "title": "Copy Cell Contents - Excel 2010 VBA", "body": "<p>I am trying to accomplish a relatively (I think) simple task. I want to create a button that copies the contents of the active cell to the clipboard. I will then use crtl+v to paste into another application. The goal is to copy a string of text inside of an excel sheet... including formatting and line breaks. I want to avoid having to press F2, Crtl+shift+home, then crtl+C. Is there a way to do this? </p>\n\n<p>Plain old Crtl+C and activecell.copy do not achieve the right result because they get rid of any line breaks when pasting into another app. TIA</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1427847326, "post_id": 29380570, "comment_id": 46941155, "body": "<a href=\"http://stackoverflow.com/q/22542834/4002530\">This question and answer</a> about regular expressions in VBA may be a good starting point"}, {"owner": {"reputation": 2291, "user_id": 2340690, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/25svl.jpg?s=128&g=1", "display_name": "cheezsteak", "link": "https://stackoverflow.com/users/2340690/cheezsteak"}, "edited": false, "score": 0, "creation_date": 1427848026, "post_id": 29380570, "comment_id": 46941340, "body": "Also you can use <code>str Like &quot;-[0-9][0-9][0-9][0-9]-&quot;</code>"}, {"owner": {"reputation": 862, "user_id": 2556978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a29a34715f5224b8979174677285ec8?s=128&d=identicon&r=PG", "display_name": "spaderdabomb", "link": "https://stackoverflow.com/users/2556978/spaderdabomb"}, "edited": false, "score": 0, "creation_date": 1427849393, "post_id": 29380570, "comment_id": 46941692, "body": "Wish I had known this lol"}], "answers": [{"tags": [], "owner": {"reputation": 862, "user_id": 2556978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a29a34715f5224b8979174677285ec8?s=128&d=identicon&r=PG", "display_name": "spaderdabomb", "link": "https://stackoverflow.com/users/2556978/spaderdabomb"}, "is_accepted": false, "score": 0, "last_activity_date": 1427847560, "creation_date": 1427847560, "answer_id": 29380781, "question_id": 29380570, "link": "https://stackoverflow.com/questions/29380570/find-within-a-string-where-each-star-represents-an-integer-0-to-9-in/29380781#29380781", "title": "Find &quot;-****-&quot; within a string, where each star represents an integer (0 to 9) in VBA", "body": "<p>I figured it out, I think I was just tired after a long day. Here is the code if anybody is interested, and I edited it in the question</p>\n\n<pre><code>Function onlyDigits(s As String) As Integer\n    Dim retval As String    ' This is the return string.      '\n    Dim i As Integer        ' Counter for character position. '\n    Dim firstDashPosition As Integer\n    Dim foundDash As Boolean\n    foundDash = False\n    firstDashPosition = 0\n\n    Debug.Print s\n    retval = \"\"\n\n    For i = 1 To Len(s)\n        If Mid(s, i, 1) Like \"-\" Then\n            If foundDash = True Then\n                retval = retval + \"-\"\n                firstDashPosition = i\n                onlyDigits = firstDashPosition - 6\n                Exit Function\n            End If\n\n            Debug.Print \"here\"\n            foundDash = True\n            retval = retval + \"-\"\n        ElseIf Mid(s, i, 1) &gt;= \"0\" And Mid(s, i, 1) &lt;= \"9\" And foundDash = True Then\n            retval = retval + Mid(s, i, 1)\n        Else\n            foundDash = False\n            retval = \"\"\n        End If\n    Next\n    onlyDigits = firstDashPosition\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2291, "user_id": 2340690, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/25svl.jpg?s=128&g=1", "display_name": "cheezsteak", "link": "https://stackoverflow.com/users/2340690/cheezsteak"}, "is_accepted": true, "score": 1, "last_activity_date": 1427848293, "creation_date": 1427848293, "answer_id": 29380883, "question_id": 29380570, "link": "https://stackoverflow.com/questions/29380570/find-within-a-string-where-each-star-represents-an-integer-0-to-9-in/29380883#29380883", "title": "Find &quot;-****-&quot; within a string, where each star represents an integer (0 to 9) in VBA", "body": "<p>Regular expressions might be a better solution but a simple one time solution would be </p>\n\n<pre><code>Function onlyDigits(s As String) As Integer\n\n    Dim i As Integer\n    For i = 1 To Len(s)\n\n        If Mid$(s, 1, 6) Like \"-[0-9][0-9][0-9][0-9]-\" Then\n           onlyDigits = i\n           Exit Function\n        EndIf\n    Next\n\n    onlyDigits = -1\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 862, "user_id": 2556978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a29a34715f5224b8979174677285ec8?s=128&d=identicon&r=PG", "display_name": "spaderdabomb", "link": "https://stackoverflow.com/users/2556978/spaderdabomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 29380883, "answer_count": 2, "score": 1, "last_activity_date": 1427848293, "creation_date": 1427846267, "last_edit_date": 1427847595, "question_id": 29380570, "link": "https://stackoverflow.com/questions/29380570/find-within-a-string-where-each-star-represents-an-integer-0-to-9-in", "title": "Find &quot;-****-&quot; within a string, where each star represents an integer (0 to 9) in VBA", "body": "<p>my brain is struggling a bit right now and I'm trying to accomplish what is said in the title. To reiterate, if I have an arbitrary string and I want to find the position of four consecutive numbers (of integer value between 0 and 9), separated by two \"-\", so I need to find \"-****-\" where each \"*\" represents an integer between 0 and 9. The ideal return value of the function would be the position of the first \"-\". </p>\n\n<p>What I have tried so far, which returns all integers within an arbitrary string. I haven't been able to get much farther than this. </p>\n\n<pre><code>Function onlyDigits(s As String) As Integer\n    Dim retval As String    ' This is the return string.      '\n    Dim i As Integer        ' Counter for character position. '\n    Dim firstDashPosition As Integer\n    Dim foundDash As Boolean\n    foundDash = False\n    firstDashPosition = 0\n\n    Debug.Print s\n    retval = \"\"\n\n    For i = 1 To Len(s)\n        If Mid(s, i, 1) Like \"-\" Then\n            If foundDash = True Then\n                retval = retval + \"-\"\n                firstDashPosition = i\n                onlyDigits = firstDashPosition - 6\n                Exit Function\n            End If\n\n            Debug.Print \"here\"\n            foundDash = True\n            retval = retval + \"-\"\n        ElseIf Mid(s, i, 1) &gt;= \"0\" And Mid(s, i, 1) &lt;= \"9\" And foundDash = True Then\n            retval = retval + Mid(s, i, 1)\n        Else\n            foundDash = False\n            retval = \"\"\n        End If\n    Next\n    onlyDigits = firstDashPosition\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 2651, "user_id": 4059942, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2bmaq.jpg?s=128&g=1", "display_name": "Saagar Elias Jacky", "link": "https://stackoverflow.com/users/4059942/saagar-elias-jacky"}, "is_accepted": false, "score": 0, "last_activity_date": 1427845141, "creation_date": 1427845141, "answer_id": 29380381, "question_id": 29380220, "link": "https://stackoverflow.com/questions/29380220/copy-reference-text-box-date-value-from-a-form-to-a-report-in-access/29380381#29380381", "title": "Copy/reference Text Box Date value from a form to a report in Access", "body": "<p>Assuming the form where the TextBox was is still open, you can use the below to show the data in the report</p>\n\n<pre><code>=[Forms]![FORM_NAME]!TEXTBOX_NAME\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4734559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lAuHGh2E3aM/AAAAAAAAAAI/AAAAAAAAAd8/S0ac_omv4L4/photo.jpg?sz=128", "display_name": "Daniel Bell", "link": "https://stackoverflow.com/users/4734559/daniel-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 475, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427845141, "creation_date": 1427844043, "question_id": 29380220, "link": "https://stackoverflow.com/questions/29380220/copy-reference-text-box-date-value-from-a-form-to-a-report-in-access", "title": "Copy/reference Text Box Date value from a form to a report in Access", "body": "<p>So I am working in an Access DB and this may be something i completely over looked. </p>\n\n<p>How can I take the value from a form that's in a text box formatted for Dates and the reference that value on a report?</p>\n\n<p>The dates aren't based of a query or anything it's something the user would have to input (ex. date the imported source date was created) and this should be added to the report output?</p>\n\n<p>Is it possible to reference/copy a form text box's date value into a report's txt box?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "http", "excel", "put"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1427841081, "post_id": 29379638, "comment_id": 46939291, "body": "Do you really have 25k columns?  I thought the max was ~16k."}, {"owner": {"reputation": 1, "user_id": 4735807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea7a8abee45bcd609a8f2997e96671ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cheetohz", "link": "https://stackoverflow.com/users/4735807/cheetohz"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1427938453, "post_id": 29379638, "comment_id": 46982502, "body": "It is all contained on multiple sheets. This was an approximation to show how big this project is.  Thanks for the edit by the way."}], "answers": [{"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1427841855, "post_id": 29379850, "comment_id": 46939546, "body": "Also, you might wanna transpose your data, Excel is longer down than it is wide across."}, {"owner": {"reputation": 1, "user_id": 4735807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea7a8abee45bcd609a8f2997e96671ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cheetohz", "link": "https://stackoverflow.com/users/4735807/cheetohz"}, "edited": false, "score": 0, "creation_date": 1427930440, "post_id": 29379850, "comment_id": 46980501, "body": "Hey! Thanks a ton for your response. I will try this later. I posted my own answer as well in case you wanted to see my approach. Mine is a bit archaic, Hoping I can put yours to use and learn something new in the process"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 0, "last_activity_date": 1427841788, "creation_date": 1427841788, "answer_id": 29379850, "question_id": 29379638, "link": "https://stackoverflow.com/questions/29379638/running-script-on-all-columns-in-excel-vba/29379850#29379850", "title": "Running script on all columns in excel/VBA", "body": "<p>If I understand correctly, this might help:</p>\n\n<p>Getting cell data in Excel VBA:</p>\n\n<pre><code>cells(rowindex,columnindex).value\n\nURL = \"https://domain.com/api/\" &amp; cells(1,1).value\nDATA = \"yaddayadda=\" &amp; cells(2,1).value\n</code></pre>\n\n<p>Add a for loop to this, and u're good to go:</p>\n\n<pre><code>For i = 1 To Cells(1, 1).End(xlToRight).Column 'assuming your cells are continously filled\n URL = \"https://domain.com/api/\" &amp; Cells(1, i).Value\n DATA = \"yaddayadda=\" &amp; Cells(2, i).Value\nNext i\n</code></pre>\n\n<p>The</p>\n\n<pre><code>Cells(1, 1).End(xlToRight).Column\n</code></pre>\n\n<p>part finds the column number of the last filled cell starting from cell A1, going right.</p>\n\n<p>Hope this helps, and I didn't completely misunderstand your question. :)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4735807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea7a8abee45bcd609a8f2997e96671ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cheetohz", "link": "https://stackoverflow.com/users/4735807/cheetohz"}, "is_accepted": true, "score": 0, "last_activity_date": 1427930220, "creation_date": 1427930220, "answer_id": 29402484, "question_id": 29379638, "link": "https://stackoverflow.com/questions/29379638/running-script-on-all-columns-in-excel-vba/29402484#29402484", "title": "Running script on all columns in excel/VBA", "body": "<p>So, I got my script working</p>\n\n<pre><code>x=0\nWhile x &lt; 25000\nx = (x + 1)\nURL = \"https://domain.com/api/\" Sheet1.Cells(x, 1)\nDATA = \"string_of_data=\" Sheet1.Cells(x, 1)\n   set HTTP = CreateObject(\"Microsoft.XMLHTTP\")\n   HTTP.Open \"PUT\", URL, False, \"Login\", \"Password\"\n   HTTP.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n   HTTP.send DATA\nwend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4735807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea7a8abee45bcd609a8f2997e96671ad?s=128&d=identicon&r=PG&f=1", "display_name": "Cheetohz", "link": "https://stackoverflow.com/users/4735807/cheetohz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 29402484, "answer_count": 2, "score": 0, "last_activity_date": 1427930220, "creation_date": 1427840714, "last_edit_date": 1427841024, "question_id": 29379638, "link": "https://stackoverflow.com/questions/29379638/running-script-on-all-columns-in-excel-vba", "title": "Running script on all columns in excel/VBA", "body": "<p>So, I have an HTTP PUT request that I need to run on a large amount of data. (50,000+ cells)</p>\n\n<p>All of this is contained in two rows, and about 25,000 columns. First row is the HTTP URL to PUT to, the second is data that will be part of a larger string as the request.</p>\n\n<p>Assuming the first two columns of my sheet are as follows, where the cells are separated via comma</p>\n\n<pre><code>Location1, Sample Data 1\nLocation2, Sample Data 2\n</code></pre>\n\n<p>I will be sending a PUT request to domain.com/API/Location1 containing the string \"data=Sample Data 1\" where \"domain.com/API/\" Is a constant and \"data=\" is also a constant.</p>\n\n<p>Not knowing enough about excel, I just created a button to call my code. I am still figuring out how to insert cell data into this code.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nURL = \"https://domain.com/api/Location1\" \nDATA = \"here_is_a_long_string_specifying_the_value_to_modify=Sample Data 1\"\n   Set HTTP = CreateObject(\"Microsoft.XMLHTTP\")\n   HTTP.Open \"PUT\", URL, False\n   HTTP.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n   HTTP.send REQUEST\n\nEnd Sub\n</code></pre>\n\n<p>Ultimately I would like it to do something like URL = \"\"(1,x)</p>\n\n<p>Then proceed through the list so (1,1) then 1,2 and 1,3, etc..</p>\n\n<p>I am unsure where to direct my searches at this point</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4734454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229f625ed1c7702bd8828bfae682a86?s=128&d=identicon&r=PG&f=1", "display_name": "ryemus", "link": "https://stackoverflow.com/users/4734454/ryemus"}, "edited": false, "score": 0, "creation_date": 1427842579, "post_id": 29379688, "comment_id": 46939775, "body": "Thanks Gary&#39;s Student. I tried the code and it works. But for only 2 cards. How if i&#39;ve got more cards?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1427840962, "creation_date": 1427840962, "answer_id": 29379688, "question_id": 29379558, "link": "https://stackoverflow.com/questions/29379558/how-to-make-non-random-this-excel-vba/29379688#29379688", "title": "How to make NON RANDOM this EXCEL VBA", "body": "<p>replace:</p>\n\n<pre><code>tries = 0\nDo While foundTerm = False And tries &lt; 1000\n  possibleRow = Rnd() * (finalTermRow - 2) + 2\n</code></pre>\n\n<p>with</p>\n\n<pre><code>tries = 0\npossibleRow=0\nDo While foundTerm = False And tries &lt; 1000\n   possibleRow = possibleRow + 1\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4734454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229f625ed1c7702bd8828bfae682a86?s=128&d=identicon&r=PG&f=1", "display_name": "ryemus", "link": "https://stackoverflow.com/users/4734454/ryemus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 29379688, "answer_count": 1, "score": 0, "last_activity_date": 1427840962, "creation_date": 1427840216, "last_edit_date": 1427840681, "question_id": 29379558, "link": "https://stackoverflow.com/questions/29379558/how-to-make-non-random-this-excel-vba", "title": "How to make NON RANDOM this EXCEL VBA", "body": "<p>Helo guys. Could someone help me resolve my EXCEL VBA Code. I'm really having trouble on how to make my FLASHCARD appear IN ORDER from Cell A1 down to the last cell. I have this code but it only generates a RANDOM cell or value. How can I make it non random? I know that by using the code RND, it generates randomly. But how about NON RANDOM? </p>\n\n<p>Here's the code:</p>\n\n<pre><code>Private Sub NextCard()\nApplication.ScreenUpdating = False\n\nDim finalTermRow As Integer\nfinalTermRow = Range(\"a60000\").End(xlUp).Row\n\nDim possibleRow As Integer\nDim foundTerm As Boolean\nfoundTerm = False\nDim tries As Integer\ntries = 0\n\nDo While foundTerm = False And tries &lt; 1000\n    possibleRow = Rnd() * (finalTermRow - 2) + 2\n\n    If Cells(possibleRow, 4).Value = \"\" Then\n        If possibleRow &lt;&gt; previousRow Then\n            foundTerm = True\n        End If\n    End If\n    tries = tries + 2\nLoop\n\nApplication.ScreenUpdating = True\n\nIf tries &lt; 1000 Then\n    currentRow = possibleRow\n    BoxQuestion.Text = Cells(currentRow, 1).Value\n    BoxDefinition.Text = \"\"\n    AltBox.Text = \"\"\nElse\n    MsgBox (\"There are no other cards to go to--you've learned everything else!  Congratulations!  To study all your cards again, click reset.\")\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Hope you could help me guys resolve this issue. Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3694, "user_id": 3374591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24276eb856ed7cbcb5f02d6bacf29ca1?s=128&d=identicon&r=PG", "display_name": "Arnon Zilca", "link": "https://stackoverflow.com/users/3374591/arnon-zilca"}, "edited": false, "score": 1, "creation_date": 1427840655, "post_id": 29379550, "comment_id": 46939169, "body": "not sure about reading excel format, but if you can save them as csv, you could check this easily using bash."}, {"owner": {"reputation": 1523, "user_id": 4713342, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/38a9ab324599fd206d89a56dedccd201?s=128&d=identicon&r=PG&f=1", "display_name": "TimeString", "link": "https://stackoverflow.com/users/4713342/timestring"}, "edited": false, "score": 1, "creation_date": 1427840783, "post_id": 29379550, "comment_id": 46939204, "body": "Assume you already have a way to read excel files: Why not parse the document 2 and store the necessary data in a dictionary, i.e., <code>var dict = {}</code>, which is easier to look up when matching the base_id in 1st document? The downside of this approach is high memory overhead but I think it&#39;s unavoidable.... (unless your files are indexed/sorted)"}, {"owner": {"reputation": 4200, "user_id": 175084, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f544c77759e09a54eeb1d71c6392557f?s=128&d=identicon&r=PG", "display_name": "user175084", "link": "https://stackoverflow.com/users/175084/user175084"}, "reply_to_user": {"reputation": 3694, "user_id": 3374591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24276eb856ed7cbcb5f02d6bacf29ca1?s=128&d=identicon&r=PG", "display_name": "Arnon Zilca", "link": "https://stackoverflow.com/users/3374591/arnon-zilca"}, "edited": false, "score": 0, "creation_date": 1427902189, "post_id": 29379550, "comment_id": 46966152, "body": "@ArnonZilca Yes I have it in csv format. Can you recommend a script samle/ link which does something similar?"}], "answers": [{"tags": [], "owner": {"reputation": 3694, "user_id": 3374591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24276eb856ed7cbcb5f02d6bacf29ca1?s=128&d=identicon&r=PG", "display_name": "Arnon Zilca", "link": "https://stackoverflow.com/users/3374591/arnon-zilca"}, "is_accepted": true, "score": 1, "last_activity_date": 1427924352, "last_edit_date": 1427924352, "creation_date": 1427924014, "answer_id": 29401252, "question_id": 29379550, "link": "https://stackoverflow.com/questions/29379550/comparing-2-excel-documents/29401252#29401252", "title": "Comparing 2 excel documents", "body": "<p>I Assumed your files look exactly like they are in the question (they can have commas instead of tabs - but they need to be textual, not in Excel format).</p>\n\n<p>It's not that efficient but if the files are not really long it shouldn't matter.<br>\nHope I understood what you're trying to achieve correctly:</p>\n\n<pre><code>#!/bin/bash\n\nset -e\n\nfile1=\"file1\"\nfile2=\"file2\"\n\nfor id in $(tail -n+2 \"${file1}\"); do\n    if ! grep \"${id}\" \"${file2}\"; then\n        echo \"${id}\"\n    fi\ndone\n</code></pre>\n\n<p>Btw, in your example none of the <code>base_id</code>s exist in file2.</p>\n"}], "owner": {"reputation": 4200, "user_id": 175084, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f544c77759e09a54eeb1d71c6392557f?s=128&d=identicon&r=PG", "display_name": "user175084", "link": "https://stackoverflow.com/users/175084/user175084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 29401252, "answer_count": 1, "score": -2, "last_activity_date": 1427924352, "creation_date": 1427840183, "last_edit_date": 1427874794, "question_id": 29379550, "link": "https://stackoverflow.com/questions/29379550/comparing-2-excel-documents", "title": "Comparing 2 excel documents", "body": "<p>I have two really huge excel documents.</p>\n\n<p>Below is just a sample of data in it.</p>\n\n<p>Document 1 contains:</p>\n\n<pre><code>base_id\nbd9ce21c-bc57-4e21-adf9a9693cbc\n5b0a3d79-ff6a-41fd-a28aa6a92164\nb7d80042-1fcf-4661-21d7dd5b1fbd\nB211B098-0544-4CDF-A2F93EAD22A4\n4FB55FE5-AE6A-425F-8B31E345181A\n</code></pre>\n\n<p>Document 2 contains:</p>\n\n<pre><code>path_id                   gate_no count text_id\n54ecfc619d1333b86a3a9cd9    3816    0   {\"abcd\":\"50C53378-5833-4827-9C2F-3211D3F42F13\"  abcd_tub:\"831e590de0cc185248f4208fc5d5ee89d2d\"  abcd_cub:\"1537fe51004bae1e71480b154372\"}\n54ecfc619d1333b86a3a9cd9    3005    0   {\"bolt\":\"66db1807f1e4a072744a77fd8429b5\"    mega:\"a1cd73b41d6b3eae97dbbdd76e323a44ab5140\"}  \n54ecfc619d1333b86a3a9cd9    2595    0   {\"bolt\":\"c58634ccdcb5e81eb0b447679b756\" mega:\"32b74bf7024944b457c69c000e44d43\"} \n54ecfc619d1333b86a3a9cd9    2220    0   {\"bolt\":\"acf98549461b87bcfe2c5190d6c\"   mega:\"2c1c788440d85ea70597ce135ccf2316748f\"}    \n54ecfc619d1333b86a3a9cd9    2160    0   {\"abcd\":\"16F8E7-F395-4551-B8C7-5FC8B\"   abcd_tub:\"a5301e4dfc6bad809a2917f495fc6f7\"  abcd_cub:\"4e5da03ffb35a0f17726acb60c8dc\"}\n</code></pre>\n\n<p>What i need to do is: </p>\n\n<p>Check if the base_id from document 1 exists in any of the rows of document 2. </p>\n\n<p>If exists, get the list of base_id and the row </p>\n\n<p>If it does not exist, get the list of base_ids only.</p>\n\n<p>What is a best way to do the above comparison in EXCEL?\nIf not excel, are there any sample script samples that i can look at?</p>\n\n<p>Any help is appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1427838680, "post_id": 29379117, "comment_id": 46938467, "body": "assign activeworkbook a var before you start then ref as normal,   you need to also check if COMPANY exists before you try delete it"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1427839063, "creation_date": 1427839063, "answer_id": 29379308, "question_id": 29379117, "link": "https://stackoverflow.com/questions/29379117/vba-finding-a-sheet-by-name-across-workbooks-and-copy-a-sheet-next-to-it/29379308#29379308", "title": "VBA: Finding a sheet by name across workbooks and copy a sheet next to it", "body": "<p>By <em>Active workbook</em> do you mean the one with the code module running the operation? If that is the case, then <code>ThisWorkbook</code> can be used to reference it as the parent of the <em>Company</em> worksheet you wish to copy to the workbook you just deleted a <em>Company</em> worksheet from.</p>\n\n<pre><code>   Application.DisplayAlerts = False\n   On Error Resume Next\n    For Each wb In Application.Workbooks\n        For Each ws In wb.Sheets\n            If ws.Name = \"EMPLOYEE\" Then\n                wb.Sheets(\"COMPANY\").Delete\n                ThisWorkbook.Sheets(\"Company\").Copy Before:=wb.Sheets(1)\n            End If\n        Next ws\n    Next wb\n    Application.DisplayAlerts = True\n</code></pre>\n\n<p>I find <code>ThisWorkbook</code> to be more definitive than <code>ActiveWorkbook</code> particularly in operations like this where the focus may (by default) be changed to the workbook receiving the copy of the <em>Company</em> worksheet.</p>\n\n<p>Alternately, you can assign a worksheet object reference to the <em>Company</em> worksheet you wish to copy across and use that reference repeatedly as you progress through the workbooks collection.</p>\n"}], "owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 29379308, "answer_count": 1, "score": 0, "last_activity_date": 1427893181, "creation_date": 1427838267, "last_edit_date": 1427893181, "question_id": 29379117, "link": "https://stackoverflow.com/questions/29379117/vba-finding-a-sheet-by-name-across-workbooks-and-copy-a-sheet-next-to-it", "title": "VBA: Finding a sheet by name across workbooks and copy a sheet next to it", "body": "<p>I am kind of lost with the workbook reference and nesting if condition. What I want to achieve is,</p>\n\n<ol>\n<li>Find a workbook which has a sheet name say \"EMPLOYEE\".</li>\n<li>Check is there any sheet name say \"COMPANY\" in the above workbook, Delete if exist.</li>\n<li>Copy sheet \"COMPANY\" from the Active workbook (not active sheet) to the above workbook.</li>\n</ol>\n\n<p>I am reaching so far but not sure how to copy the non-active-sheet \"COMPANY\" from the active workbook to the workbook which we find in point 1.</p>\n\n<p>Any suggestion will be much appreciated.</p>\n\n<pre><code>    Application.DisplayAlerts = False\n    For Each wb In Application.Workbooks\n       For Each ws In wb.Sheets\n       If ws.Name = \"EMPLOYEE\" Then wb.Sheets(\"COMPANY\").Delete\n       Next ws\n    Next wb\n    Application.DisplayAlerts = True\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427838188, "post_id": 29379025, "comment_id": 46938261, "body": "You&#39;re going to need to considerably overhaul the <code>For x = 1 to Selection.Rows.Count</code> loop. You will have to do cell-by-cell iteration over an array of values from each row&#39;s range, and update the array to include the <i>formatted</i> values (by default it would use the <code>.Value</code> which is entirely ignorant of any formatting).  Does that make sense?  If so, give it a shot and we can try to help if you get stuck."}, {"owner": {"reputation": 669, "user_id": 3525024, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/290e39088447a1e671b08a924b4323e1?s=128&d=identicon&r=PG&f=1", "display_name": "9Deuce", "link": "https://stackoverflow.com/users/3525024/9deuce"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427838286, "post_id": 29379025, "comment_id": 46938311, "body": "That does make some sense. I guess I was just seeing if anyone had any idea to do not have to do that."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427838668, "post_id": 29379025, "comment_id": 46938461, "body": "Right, I don&#39;t think there&#39;s another way when you&#39;re dealing with <i>conditionally</i> changing the values that need to be written to  what you&#39;re doing right now is an implicit conversion from the entire selection&#39;s row ranges, to an array, and then you&#39;re using the <code>Join</code> function to coerce that array in to a string, so that it can be written to the FSO file. The implicit conversion there will use the <code>.Value</code> of each cell in the row.  Instead, you need to build the array from the cell&#39;s <code>.Text</code> property which can only be done one cell/value at a time I think."}, {"owner": {"reputation": 669, "user_id": 3525024, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/290e39088447a1e671b08a924b4323e1?s=128&d=identicon&r=PG&f=1", "display_name": "9Deuce", "link": "https://stackoverflow.com/users/3525024/9deuce"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427908750, "post_id": 29379025, "comment_id": 46969983, "body": "@DavidZemens Overhaul was right. See the answer."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427909552, "post_id": 29396925, "comment_id": 46970389, "body": "Well-done.  If performance is an issue you could <i>first</i> put the entire row/range <code>.Value</code> into an array, and then iterate that rather than doing cell-by-cell iteration. It will probably be faster, but may not be noticeable on small datasets.  If you have many thousands of rows I might do it that way though."}, {"owner": {"reputation": 669, "user_id": 3525024, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/290e39088447a1e671b08a924b4323e1?s=128&d=identicon&r=PG&f=1", "display_name": "9Deuce", "link": "https://stackoverflow.com/users/3525024/9deuce"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427909786, "post_id": 29396925, "comment_id": 46970519, "body": "Usually datasets aren&#39;t that large, but I ran a test with about 2000 in total. The selection took about 5-10 seconds. The export was instant. So performance shouldn&#39;t be an issue. Thanks for the nudge in the right direction."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427909986, "post_id": 29396925, "comment_id": 46970626, "body": "Right the export should be super efficient you&#39;re using the optimized I/O functions to print the entire file at once. it&#39;s only the cell iteration that takes some time, but 5-10 seconds is tolerable for most people, so I wouldn&#39;t fuss with it unless it becomes a problem in the future :)  Cheers."}], "tags": [], "owner": {"reputation": 669, "user_id": 3525024, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/290e39088447a1e671b08a924b4323e1?s=128&d=identicon&r=PG&f=1", "display_name": "9Deuce", "link": "https://stackoverflow.com/users/3525024/9deuce"}, "is_accepted": true, "score": 1, "last_activity_date": 1427908720, "creation_date": 1427908720, "answer_id": 29396925, "question_id": 29379025, "link": "https://stackoverflow.com/questions/29379025/excel-2010-vba-code-to-write-formatted-numbers-to-csv/29396925#29396925", "title": "Excel 2010 - VBA code to Write Formatted Numbers to CSV", "body": "<p>I ended up following David Zemens' advice and overhauled the section that was <code>For X = 1 to Selection.Rows.Count</code> See below.</p>\n\n<pre><code>For X = 1 To Selection.Rows.Count\n    For Y = 1 To Selection.Columns.Count\n        If Y &lt;&gt; Selection.Columns.Count Then\n            If IsNumeric(temSheet.Cells(X + 1, Y).Value) Then\n                If temSheet.Cells(X + 1, Y).Value = 0 Then\n                    S(X) = S(X) &amp; \";\"\n                Else\n                    S(X) = S(X) &amp; Replace(temSheet.Cells(X + 1, Y).Text, \" \", \"\") &amp; \";\"\n                End If\n            Else\n                S(X) = S(X) &amp; Trim(temSheet.Cells(X + 1, Y).Text) &amp; \";\"\n            End If\n        Else\n            If IsNumeric(temSheet.Cells(X + 1, Y).Value) Then\n                If temSheet.Cells(X + 1, Y).Value &lt;&gt; 0 Then\n                    S(X) = S(X) &amp; Replace(temSheet.Cells(X + 1, Y).Text, \" \", \"\")\n                End If\n            Else\n                S(X) = S(X) &amp; Trim(temSheet.Cells(X + 1, Y).Text)\n            End If\n        End If\n    Next\nNext\n</code></pre>\n\n<p>Some more formatting was necessary. It goes cell by cell, purposefully skipping the first row of the sheet. The <code>.Text</code> property of some of the cells returned empty space before the value or between the $ and value, so it had to be removed. <code>Trim</code> removes leading and ending spaces while <code>Replace</code> replaces all spaces in the export.</p>\n"}], "owner": {"reputation": 669, "user_id": 3525024, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/290e39088447a1e671b08a924b4323e1?s=128&d=identicon&r=PG&f=1", "display_name": "9Deuce", "link": "https://stackoverflow.com/users/3525024/9deuce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 1, "accepted_answer_id": 29396925, "answer_count": 1, "score": 2, "last_activity_date": 1428151622, "creation_date": 1427837728, "last_edit_date": 1428151622, "question_id": 29379025, "link": "https://stackoverflow.com/questions/29379025/excel-2010-vba-code-to-write-formatted-numbers-to-csv", "title": "Excel 2010 - VBA code to Write Formatted Numbers to CSV", "body": "<p>I'm working on a 5 sheet workbook, where a button named <code>ExportCSV</code> on sheet 5 exports data on sheet 3. More specifically, the button runs a VBA code that goes row by row and checks the first 3 cells for data. If any of the first three cells have data, then the whole row is selected. After all rows with data are selected, the data is written row by row to a CSV file (the file itself is semicolon-delimited, however).</p>\n\n<p>The problem that I'm having is that some cell formatting is being copied over, but some is not. For example, values in cells formatted for Accounting with a $ are formatted correctly, meaning \"$12,345,678.90\" shows up as \"$12,345,678.90.\" However, values in cells formatted as Accounting but without $ are not being written to the csv correctly, meaning \"12,345,678.90\" is being written as \"12345678.9.\"</p>\n\n<p>Below is the Macro in question.</p>\n\n<pre><code>Dim planSheet As Worksheet\nDim temSheet As Worksheet\n\nPrivate Sub ExportCSV_Click()\n    Dim i As Integer\n    Dim j As Integer\n    Dim lColumn As Long\n    Dim intResult As Integer\n    Dim strPath As String\n    On Error GoTo Errhandler\n    Set temSheet = Worksheets(3)\n    i = 2\n    Do While i &lt; 1001\n        j = 1\n        Do While j &lt; 4\n            If Not IsEmpty(temSheet.Cells(i, j)) Then\n                temSheet.Select\n                lColumn = temSheet.Cells(2, Columns.Count).End(xlToLeft).Column\n                temSheet.Range(temSheet.Cells(2, 1), temSheet.Cells(i, lColumn)).Select\n            End If\n            j = j + 1\n        Loop\n        i = i + 1\n    Loop\n    Application.FileDialog(msoFileDialogFolderPicker).InitialFileName = Application.ActiveWorkbook.Path\n    Application.FileDialog(msoFileDialogFolderPicker).Title = \"Select a Path\"\n    Application.FileDialog(msoFileDialogFolderPicker).ButtonName = \"Select Path\"\n    intResult = Application.FileDialog(msoFileDialogFolderPicker).Show\n\n    If intResult &lt;&gt; 0 Then\n        'dispaly message box\n        strPath = Application.FileDialog(msoFileDialogFolderPicker).SelectedItems(1)\n    End If\n\n    Dim X As Long, FF As Long, S() As String\n    ReDim S(1 To Selection.Rows.Count)\n    For X = 1 To Selection.Rows.Count\n        S(X) = Join(WorksheetFunction.Transpose(WorksheetFunction.Transpose(Selection.Rows(X).Value)), \";\")\n    Next\n    FF = FreeFile\n    FilePath = strPath &amp; \"\\Data\" &amp; Format(Now(), \"yyyyMMddhhmmss\") &amp; \".csv\"\n    Open FilePath For Output As #FF\n    Print #FF, Join(S, vbNewLine)\n    Close #FF\n\n    Errhandler:\n        ...Error Handling Code omitted\n\nEnd Sub\n</code></pre>\n\n<p>I need to be able to copy over the exact formatting of the cells. Converting the no-$ cells to $ cells won't work because the values without $ are being used for a calculation later on in the process that can handle the commas, but not a $, and I can't change the code for the later calculation (proprietary plug-in doing the calculation.) Also, the rows have mixed content, meaning some values in the row are text instead of numbers.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1427837069, "post_id": 29378721, "comment_id": 46937754, "body": "<b>Post your current code.</b>"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1427837146, "post_id": 29378721, "comment_id": 46937797, "body": "Which part co you want help with? What kind of help do you need?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1427838575, "post_id": 29378721, "comment_id": 46938421, "body": "You are asking far too much in one go. Drop steps 2 to 6 and concentrate on step 1. A VBA program may access worksheets by numbers but the user does not know those numbers. One approach would be to have a listbox populated with the worksheet names. Another approach would be to require the user to confirm the required worksheet was active when the macro was started. Research coding a macro that addresses step 1.  If you run into difficulties, post the faulty code and explain what is wrong. Once that macro is working, research step 2."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1427839008, "post_id": 29378721, "comment_id": 46938588, "body": "@TonyDallimore, the assignment says they should prompt for the index."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1427842809, "post_id": 29378721, "comment_id": 46939842, "body": "@DougGlancy. I agree step 1 says the user enters a number but is that a reasonable design?  If the workbook has up to about five worksheets, the user can easily count along the tabs.  With more worksheets, it will be come increasingly difficult for the user to get the number correct.  Perhaps a number is OK but the OP needs to think about each step carefully if the result is to be usable."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1427843699, "post_id": 29378721, "comment_id": 46940109, "body": "@TonyDallimore, you&#39;re right, definitely not a good design. It&#39;s a beginning homework assignment."}], "answers": [{"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1427861528, "post_id": 29382094, "comment_id": 46944489, "body": "I&#39;m going to assume this all works and upvote just for the comments :-)"}, {"owner": {"reputation": 9, "user_id": 4735757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c939a1a32dd76f86ea067c31cd93572?s=128&d=identicon&r=PG&f=1", "display_name": "nmhomie13", "link": "https://stackoverflow.com/users/4735757/nmhomie13"}, "edited": false, "score": 1, "creation_date": 1428010563, "post_id": 29382094, "comment_id": 47017222, "body": "thank ya. this helped. i used it to compare to my partner&#39;s code actually haha. thanks though."}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 1, "last_activity_date": 1427868932, "last_edit_date": 1427868932, "creation_date": 1427856890, "answer_id": 29382094, "question_id": 29378721, "link": "https://stackoverflow.com/questions/29378721/excel-vba-programming-range-selection-questions/29382094#29382094", "title": "Excel VBA programming range selection questions", "body": "<p>Well...</p>\n\n<pre><code>Sub HomeworkForNmHomie13()\nDim Response, Index, L1, L2, Answer\nDo\n    Response = InputBox(\"Enter a number from 1 to \" &amp; Worksheets.Count)\n    If Response = \"\" Then Exit Sub\n    'Your teacher said don't do error handling, but that's for failures.\n    On Error Resume Next\n    Index = Int(Response)\n    On Error GoTo 0\n    If Index &gt; Worksheets.Count Or Index &lt; 1 Then\n        MsgBox (\"Your entry was invalid. Please enter a number between 1 and \" &amp; Worksheets.Count)\n    End If\nLoop While Index &gt; Worksheets.Count Or Index &lt; 1\nSheets(Index).Activate\nL1 = Cells(Rows.Count, \"A\").End(xlUp).Row 'Assuming an \"item\" includes blank cells\nL2 = Cells(Rows.Count, \"B\").End(xlUp).Row 'Just grab the last row with data\n'Use 2 IIF Statements to check the length using one line of code and look smart as hell\nAnswer = IIf(L1 &gt; L2, \"List 1 is longer\", IIf(L2 &gt; L1, \"List 2 is Longer\", \"Same length\"))\nMsgBox (Answer)\nEnd Sub\n</code></pre>\n\n<p>If you would prefer to \"impress\" your teacher by meeting the minimum requirements:</p>\n\n<pre><code>Sub LazyHomeworkForNmHomie13()\nIndex = Int(InputBox(\"Enter a number from 1 to \" &amp; Worksheets.Count))\nSheets(Index).Activate\nL1 = Cells(Rows.Count, \"A\").End(xlUp).Row\nL2 = Cells(Rows.Count, \"B\").End(xlUp).Row\nAnswer = IIf(L1 &gt; L2, \"List 1 is longer\", IIf(L2 &gt; L1, \"List 2 is Longer\", \"Same length\"))\nMsgBox (Answer)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4735757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c939a1a32dd76f86ea067c31cd93572?s=128&d=identicon&r=PG&f=1", "display_name": "nmhomie13", "link": "https://stackoverflow.com/users/4735757/nmhomie13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "closed_date": 1427877488, "answer_count": 1, "score": -5, "last_activity_date": 1427868932, "creation_date": 1427836492, "question_id": 29378721, "link": "https://stackoverflow.com/questions/29378721/excel-vba-programming-range-selection-questions", "closed_reason": "Needs more focus", "title": "Excel VBA programming range selection questions", "body": "<p>NEED HELP DOING THIS PLEASE:</p>\n\n<ol>\n<li>Opens an Input box and prompts the user to choose a worksheet number from 1 to</li>\n<li>Stores the value the user entered in a variable of type integer named Index.\nYou may assume the user will always enter a valid input (i.e. 1, 2 or 3). The\nprogram will give run time error if the user enters text for example- but you do\nnot need to write code to handle this case.</li>\n<li>Uses the index number entered by the user and the Worksheets( ) collection object\nto activate the selected worksheet.</li>\n<li>Find the number of items in the list in column A (starting in cell A1) and store it\nin a variable named L1; find the number of items in the list in column B (starting\nin cell B1) and store it in a variable named L2.</li>\n<li>Use an If statement to determine what string to store in a variable named\nAnswer:\n\u201c List 1 is longer\u201d if the number of items in column A is larger.\n\"List 2 is longer\" if the number of items in column B is larger, and\n\"Same length\" otherwise.</li>\n<li>Open a message box showing Answer.</li>\n</ol>\n"}, {"tags": ["vba", "excel", "levels"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 2, "creation_date": 1427837369, "post_id": 29378704, "comment_id": 46937890, "body": "Please show your code. Have you considered using a pivot table?"}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "is_accepted": false, "score": 0, "last_activity_date": 1428032674, "creation_date": 1428032674, "answer_id": 29425897, "question_id": 29378704, "link": "https://stackoverflow.com/questions/29378704/excel-vba-random-extra-grouping-levels/29425897#29425897", "title": "Excel VBA - Random extra grouping levels", "body": "<p>Try stepping through your code in trace mode to watch the groups being set up. (open the VBA window and use the F8 key to loop one line at a time)\nThis may reveal why the extra groups are being defined and suggest what to change.</p>\n"}], "owner": {"reputation": 33, "user_id": 3715933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2586020feaf66e130c639414db0a425a?s=128&d=identicon&r=PG&f=1", "display_name": "KopakaTon", "link": "https://stackoverflow.com/users/3715933/kopakaton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512020040, "creation_date": 1427836431, "last_edit_date": 1512020040, "question_id": 29378704, "link": "https://stackoverflow.com/questions/29378704/excel-vba-random-extra-grouping-levels", "title": "Excel VBA - Random extra grouping levels", "body": "<p>This is not really an issue that affects the code but rather a question of the table's appearance.\nSo, the table is the summary of records for income and expenses of different business departments. Let's call each department a type of the record. Each of those types has subtype1. Each subtype1 has subtypes2 and each subtype2 has subtypes3.\nSo the sample data would be something like this.</p>\n\n<pre><code>1, Type1, sum of subtypes1\n1.1, Subtype1, sum of subtypes2\n1.1.1 Subtype2, sum of subtypes3\n1.1.1.1 Subtype3, amount\n1.1.1.2 Subtype3, amount\n1.2, Subtype1, sum of subtypes2\n1.2.1, Subtype2, sum of subtypes3\n1.2.1.1, Subtype3, amount\n</code></pre>\n\n<p>Each subtype can have different number of \"children subtypes\". Children subtypes can't go further than subtype3.</p>\n\n<p>Then I am using VBA script to group the records of the same subtype under their direct parent up to the main type. Everything works fine, I can expand or hide every single level of this structure.\nHowever, logically the group outline on the left side of the table for rows should show 4 levels. Instead it shows 8 levels of groups. First 4 do exactly what you would expect, show or hide respective subtypes while the other 4 levels do absolutely nothing which is also expected because I don't see a reason for them to be there.</p>\n\n<p>Any ideas why extra levels have been created and how to get rid of them?\nI might have explained this in a not very clear way so feel free to ask for further information.</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1427836117, "post_id": 29378408, "comment_id": 46937301, "body": "You don&#39;t need to post all of your code, but it would be helpful to see the relevant portions. Please see <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1427836049, "creation_date": 1427836049, "answer_id": 29378589, "question_id": 29378408, "link": "https://stackoverflow.com/questions/29378408/how-to-use-vba-to-execute-a-macro-based-on-an-if-statement/29378589#29378589", "title": "How to use VBA to execute a macro based on an IF statement?", "body": "<p>It sounds as if it is important that the <em>Biology</em> (or <em>macro_Biology</em>) macro needs to know which row it is supposed to work on. You can pass this information across to it with a parameter. Example:</p>\n\n<pre><code>Sub start_with_this()\n    Dim rw As Long, lr As Long\n    With ActiveSheet\n        lr = .Cells(Rows.Count, \"C\").End(xlUp).Row\n        For rw = 2 To lr\n            If UCase(.Cells(rw, \"C\").Value) = \"X\" Then\n                Call macro_Biology(rw)\n            End If\n        Next rw\n    End With\nEnd Sub\n\nSub macro_Biology(r As Long)\n    ' r is the row that was passed in.\n    ' do something with r\nEnd Sub\n</code></pre>\n\n<p>After initially starting the <code>start_with_this</code> macro, it goes through each cell in column C from row 2 to the last row with anything in it. If it finds an <em>X</em> or an <em>x</em> (case-sensitivity is removed by forcing the cell value to upper case before comparing) then it calls the second macro, <code>macro_Biology</code> and tells it what row to deal with.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1427836446, "creation_date": 1427836446, "answer_id": 29378708, "question_id": 29378408, "link": "https://stackoverflow.com/questions/29378408/how-to-use-vba-to-execute-a-macro-based-on-an-if-statement/29378708#29378708", "title": "How to use VBA to execute a macro based on an IF statement?", "body": "<p>Lets assume that <em>Biology()</em> is a sub in a standard module:</p>\n\n<pre><code>Sub Biology()\n    MsgBox \"study biology!\"\nEnd Sub\n</code></pre>\n\n<p>To call this as you want, run:</p>\n\n<pre><code>Sub TestIt()\n    If Range(\"C22\").Value = \"X\" Then\n        Call Biology\n    End If\nEnd Sub\n</code></pre>\n\n<p>To call <em>Biology()</em> automatically if the user types an <strong>X</strong> in cell <strong>C22</strong>, Insert the following event macro in the worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Set intrs = Intersect(Target, Range(\"C22\"))\n    If Not intrs Is Nothing Then\n        If intrs.Value = \"X\" Then\n            Application.EnableEvents = False\n                Call Biology\n            Application.EnableEvents = True\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>To call <em>Biology()</em> automatically if a formula gives an <strong>X</strong> in cell <strong>C22</strong>, Insert the following event macro in the worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    If Range(\"C22\").Value = \"X\" Then\n            Application.EnableEvents = False\n                Call Biology\n            Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4735666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b31f62c21cbcd8911f6ff42d9c76b3?s=128&d=identicon&r=PG&f=1", "display_name": "ilovetheMBTA jk", "link": "https://stackoverflow.com/users/4735666/ilovethembta-jk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 575, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428151608, "creation_date": 1427835375, "last_edit_date": 1428151608, "question_id": 29378408, "link": "https://stackoverflow.com/questions/29378408/how-to-use-vba-to-execute-a-macro-based-on-an-if-statement", "title": "How to use VBA to execute a macro based on an IF statement?", "body": "<p>I want to run an Excel VBA code (all it will do is delete specific cells within the same row and I've turned on relative reference so that I can apply the Excel VBA code to all rows, if there's the appropriate \"X\") based on whether there is an X in a certain cell.</p>\n\n<p>Here's what I've tried so far (the Excel VBA code is just called \"Biology\"):</p>\n\n<pre><code>If Range(\"C22\").Value = \"X\" Then\n   Call macro_Biology\nEnd If\n</code></pre>\n\n<p>I should add that I'm writing this under VBA section \"GetATPLabel\". Like I said, total noob, but I think I'm close, so any help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 0, "creation_date": 1427852265, "post_id": 29378937, "comment_id": 46942445, "body": "I revised it as this, but still throws an error.. <code>&quot;=IFERROR(AVERAGEIFS(&#39;CAR Dashboard.xlsm&#39;!&quot; &amp; VPenName &amp; &quot;,&#39;CAR Dashboard.xlsm&#39;!&quot; &amp; ModuleName &amp; &quot;,B5,&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 0, "creation_date": 1427868689, "post_id": 29378937, "comment_id": 46946442, "body": "That&#39;s still not the same as my answer. You haven&#39;t escaped the final set of quotes."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 0, "creation_date": 1427879008, "post_id": 29378937, "comment_id": 46951594, "body": "the end needs to be <code>B5,&quot;&quot;&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 0, "creation_date": 1427893873, "post_id": 29378937, "comment_id": 46960447, "body": "Hi, thanks for being patient. I copied your answer in and it still throws an error..."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 0, "creation_date": 1427895818, "post_id": 29378937, "comment_id": 46961650, "body": "what is in <code>G1</code> and <code>G2</code> (where the variables get their values from)"}, {"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "edited": false, "score": 0, "creation_date": 1427899748, "post_id": 29378937, "comment_id": 46964452, "body": "G1 and G2 are formulas concatenate strings from other ranges. G1 <code>=SUBSTITUTE(TRIM($C$3),&quot; &quot;,&quot;_&quot;)&amp;&quot;_&quot;&amp;SUBSTITUTE(TRIM(F1),&quot; &quot;,&quot;_&quot;)</code> and the result is <code>Q2_15_Module</code>, and G2 formula <code>=SUBSTITUTE(TRIM($C$3),&quot; &quot;,&quot;_&quot;)&amp;&quot;_&quot;&amp;SUBSTITUTE(TRIM(F2),&quot; &quot;,&quot;_&quot;)</code> , result <code>Q2_15_Video_Penetration</code>"}, {"owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1427905735, "post_id": 29378937, "comment_id": 46968367, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/74276/discussion-between-qshngv-and-s-o\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1427837394, "creation_date": 1427837394, "answer_id": 29378937, "question_id": 29378228, "link": "https://stackoverflow.com/questions/29378228/vba-passing-variable-to-reference-named-ranges-object-defined-error/29378937#29378937", "title": "VBA Passing variable to reference Named Ranges - object-defined error", "body": "<p>Your closing bracket is in the wrong place, try this instead:</p>\n\n<pre><code>\"=IFERROR(AVERAGEIFS('CAR Dashboard.xlsm'!\" &amp; VPenName &amp; \",'CAR Dashboard.xlsm'!\" &amp; ModuleName &amp; \",B5,\"\"\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 767, "user_id": 4602281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/196ebe50c7744544c120e8ab49f07da5?s=128&d=identicon&r=PG&f=1", "display_name": "qshng", "link": "https://stackoverflow.com/users/4602281/qshng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427837394, "creation_date": 1427834688, "question_id": 29378228, "link": "https://stackoverflow.com/questions/29378228/vba-passing-variable-to-reference-named-ranges-object-defined-error", "title": "VBA Passing variable to reference Named Ranges - object-defined error", "body": "<p>I'm trying to define name ranges and then reference them in a formula</p>\n\n<p>The worksheet formula is this\n <code>=IFERROR(AVERAGEIFS('CAR Dashboard.xlsm'!Q2_15_Video_Penetration,'CAR Dashboard.xlsm'!Q2_15_Module,B5),\"\")</code></p>\n\n<p>I passed variables in the formula and is returning an object defined error</p>\n\n<p><code>Sheets(\"QoQ Summary\").Cells(5, 11).Formula = \"=IFERROR(AVERAGEIFS('CAR Dashboard.xlsm'!\" &amp; VPenName &amp; \",'CAR Dashboard.xlsm'!\" &amp; ModuleName &amp; \",B5,\"\")\"\"\"</code></p>\n\n<p>I'm not sure what's wrong with it. Can anybody help please? Thanks!</p>\n\n<p>Below is the testing code. Please ignore undefined variables.</p>\n\n<pre><code>Sub test()\nDim ModuleName, VPenName, HPenName, CPenName, XPenName As String\n   'Define  \n   ModuleName = Sheets(\"Settings and Instruction\").range(\"G1\").Value\n   VPenName = Sheets(\"Settings and Instruction\").range(\"G2\").Value\n\n   ActiveWorkbook.Names.Add Name:=ModuleName, RefersToR1C1:= _\n                \"=OFFSET('\" &amp; rp &amp; \"'!R5C\" &amp; Module.Column &amp; \",,,COUNTA('\" &amp; rp &amp; \"'!C\" &amp; Module.Column &amp; \"),)\"\n\n   ActiveWorkbook.Names.Add Name:=VPenName, RefersToR1C1:= _\n                \"=OFFSET('\" &amp; rp &amp; \"'!R5C\" &amp; VideoPen.Column &amp; \",,,COUNTA('\" &amp; rp &amp; \"'!C\" &amp; VideoPen.Column &amp; \"),)\"\n\nDim rng As range\n'Set rng = range(\"'CAR Dashboard.xlsm'!\" &amp; VPenName)\n'Application.Goto rng\n\n Sheets(\"QoQ Summary\").Cells(5, 11).Formula = _\n                 \"=IFERROR(AVERAGEIFS('CAR Dashboard.xlsm'!\" &amp; VPenName &amp; \",'CAR Dashboard.xlsm'!\" &amp; ModuleName &amp; \",B5,\"\")\"\"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4735559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8196adaecdb4fc768dfb13c2ec4113f8?s=128&d=identicon&r=PG&f=1", "display_name": "GMcNaugh", "link": "https://stackoverflow.com/users/4735559/gmcnaugh"}, "edited": false, "score": 0, "creation_date": 1427873032, "post_id": 29378281, "comment_id": 46948375, "body": "Geoff, thank you so much; your solution has fixed my problem.  You would not believe how long I have been toying with this. Sl&#224;inte mhath!"}], "tags": [], "owner": {"reputation": 8109, "user_id": 55487, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qN00M.jpg?s=128&g=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/55487/geoff"}, "is_accepted": true, "score": 0, "last_activity_date": 1427834934, "creation_date": 1427834934, "answer_id": 29378281, "question_id": 29378092, "link": "https://stackoverflow.com/questions/29378092/vba-to-autofilter-dataset-based-on-slicer-selections/29378281#29378281", "title": "VBA to AutoFilter Dataset Based on Slicer Selections", "body": "<p>You need to specify what type of criteria you're providing using the <code>Operator</code> parameter.  Change your line </p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$Z$50000\").AutoFilter _\n  Field:=1, _\n  Criteria1:=sArr()\n</code></pre>\n\n<p>to </p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$Z$50000\").AutoFilter _\n  Field:=1, _\n  Criteria1:=sArr(), _\n  Operator:=xlFilterValues\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4735559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8196adaecdb4fc768dfb13c2ec4113f8?s=128&d=identicon&r=PG&f=1", "display_name": "GMcNaugh", "link": "https://stackoverflow.com/users/4735559/gmcnaugh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1150, "favorite_count": 0, "accepted_answer_id": 29378281, "answer_count": 1, "score": 0, "last_activity_date": 1427834934, "creation_date": 1427834233, "last_edit_date": 1531164843, "question_id": 29378092, "link": "https://stackoverflow.com/questions/29378092/vba-to-autofilter-dataset-based-on-slicer-selections", "title": "VBA to AutoFilter Dataset Based on Slicer Selections", "body": "<p>I have a series of slicers controlling a number of pivot tables which in turn generate some pie charts.  From the slicer items selected I would like to autofilter the underlying dataset to summarise the information used to generate the pies.  So far I have managed to generate the following code which I admit I have gleaned from another post here: <a href=\"https://stackoverflow.com/questions/19042181/autofilter-criteria-using-array-error-too-large-string\">AutoFilter Criteria Using Array (Error) - Too Large String?</a>\nThe code below will AutoFilter the dataset but only using the last item selected in the slicer and not any other selections, i.e. if all the items of the slicer are selected the AutoFilter only filters using the last item and not the full series.  It appears the array element is not working as expected.\nAny assistance is gratefully accepted.\nThank you.</p>\n\n<pre><code>Sub FilterData()\nDim sArr() As String\nDim sCache As SlicerCache\nDim wb As Workbook\nSet wb = ThisWorkbook\nSet sCache = wb.SlicerCaches(\"Slicer_Unit\")\n   For Each sItem In ActiveWorkbook.SlicerCaches(sCache.Name).SlicerItems\n        If sItem.Selected = True Then\n            ReDim Preserve sArr(0 To sCount)\n            sArr(sCount) = sItem.Name\n            sCount = sCount + 1\n        End If\n    Next sItem\n Sheets(\"Sheet1\").Activate\nActiveSheet.Range(\"$A$1:$Z$50000\").AutoFilter Field:=1, Criteria1:=sArr()\nReDim sArr(0 To 0)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1427834935, "post_id": 29378091, "comment_id": 46936676, "body": "move ws1.Cells(1, 1).EntireRow.Copy into the for loop right before     ActiveSheet.Cells(1, 1).Select"}], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 0, "creation_date": 1427845930, "post_id": 29380493, "comment_id": 46940764, "body": "As an addendum, you&#39;ll make the workbook really big if you apply formatting to the entire column. It&#39;s a well known way to bloat workbooks. Try using <code>Range()</code> and specifying some usefully large number of cells instead, e.g. <code>ActiveSheet.Range(&quot;E2:E50000&quot;).NumberFormat = &quot;$#,##0.00&quot;</code>"}], "tags": [], "owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "is_accepted": false, "score": 0, "last_activity_date": 1427845819, "creation_date": 1427845819, "answer_id": 29380493, "question_id": 29378091, "link": "https://stackoverflow.com/questions/29378091/excel-vba-creating-new-sheets-and-pasting-stuff-in-raise-1004-error/29380493#29380493", "title": "Excel VBA - Creating new sheets and pasting stuff in raise 1004 Error", "body": "<p>This is basically because Excel's copying and pasting from VBA is horrible. I'd suggest using the following as your macro instead. Note that I assign the range, and then copy it directly to the destination (no messy selection takes place). This makes things a lot more reliable, because Excel handles the whole copy operation, not Windows. I think. Certainly makes things work for me though.</p>\n\n<pre><code>Public Sub Test()\n    Dim newSheets(1 To 4) As String\n    newSheets(1) = \"CHEM - ALSO\"\n    newSheets(2) = \"LBS - LBLA\"\n    newSheets(3) = \"LBS - LBFG\"\n    newSheets(4) = \"Chemicals\"\n    Dim sheetName As Variant\n    Dim ws1 As Excel.Worksheet\n    Dim rngCopyTarget As Excel.Range\n    Set ws1 = ThisWorkbook.Sheets(1)\n\n    'Copy Header Row from ws1\n\n    Set rngCopyTarget = ws1.Cells(1, 1).EntireRow\n    'Create New Worksheets\n    For Each sheetName In newSheets\n        Sheets.Add After:=Worksheets(Worksheets.Count)\n        ActiveSheet.Name = sheetName\n\n        'Paste Header Row\n        rngCopyTarget.Copy ActiveSheet.Range(rngCopyTarget.Address)\n\n        ' Autofit Columns &amp; Zoom &amp; Scroll\n        ActiveWindow.Zoom = 90\n        ActiveSheet.Columns(\"A:Y\").AutoFit\n        ActiveSheet.Columns(\"B\").ColumnWidth = 60  'Description\n        ActiveSheet.Columns(\"E\").ColumnWidth = 12  'WAS\n        ActiveSheet.Columns(\"F\").ColumnWidth = 12  'NOW\n\n        'THIS IS THE SECTION THAT BREAKS IT\n        'Format WAS, NOW, AVGCOST, VALUE to CURRENCY\n        ActiveSheet.Columns(\"E\").NumberFormat = \"$#,##0.00\"  'WAS\n        ActiveSheet.Columns(\"F\").NumberFormat = \"$#,##0.00\"  'NOW\n        ActiveSheet.Columns(\"H\").NumberFormat = \"$#,##0.00\"  'AvgCost\n        ActiveSheet.Columns(\"L\").NumberFormat = \"$#,##0.00\"  'Value\n\n    Next sheetName\n    ws1.Activate\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 0, "last_activity_date": 1427880742, "creation_date": 1427880742, "answer_id": 29387296, "question_id": 29378091, "link": "https://stackoverflow.com/questions/29378091/excel-vba-creating-new-sheets-and-pasting-stuff-in-raise-1004-error/29387296#29387296", "title": "Excel VBA - Creating new sheets and pasting stuff in raise 1004 Error", "body": "<p>@Sorceri has the idea in his comment but, as it hasn't been posted as an answer I'll expand on it.</p>\n\n<p>Your code is copying the header detail before you enter the loop. If you set your screen so you can see both Excel and the VBA editor windows. In the VBA editor click anywhere in your code and <strong>press F8</strong> - notice the yellow row highlight because that's the next line of code to be executed.</p>\n\n<p>Keep pressing <strong>F8</strong> while watching the changes in the Excel window. The \"marching ants\" will appear after your copy command. When you have <strong>F8</strong>'d down to</p>\n\n<p><code>ActiveSheet.Columns(\"E\").NumberFormat = \"$#,##0.00\"</code></p>\n\n<p>then swap back to Excel and select the AGESTOCK sheet - the marching ants will be there!</p>\n\n<p><strong>In the VBA editor press F8</strong> and <em>the ants are gone meaning that the clipboard has been cleared</em>. Certain Excel actions clear the clipboard but apparently setting column width isn't one of them and changing cell formats in a range definitely is. I tested it \"live\".</p>\n\n<p>Then the solution is to move your:</p>\n\n<p><code>ws1.Cells(1, 1).EntireRow.Copy</code></p>\n\n<p>into your loop like:</p>\n\n<pre><code>'*** DON'T Copy Header Row from ws1 yet ***\n'ws1.Cells(1, 1).EntireRow.Copy '**copies contents before 1st loop and is emptied\n'when you change the cell format ***\n\n'Create New Worksheets\nFor Each sheetName In newSheets\n    Sheets.Add After:=Worksheets(Worksheets.Count)\n    ActiveSheet.Name = sheetName\n\n    'Copy Header Row from ws1\n    ws1.Cells(1, 1).EntireRow.Copy\n\n    'Paste Header Row\n    ActiveSheet.Cells(1, 1).Select\n    ActiveSheet.Paste '\n</code></pre>\n"}], "owner": {"reputation": 971, "user_id": 823913, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/278ea216d836ca23bf7cffe9188e065f?s=128&d=identicon&r=PG", "display_name": "Sanfly", "link": "https://stackoverflow.com/users/823913/sanfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1203, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428150509, "creation_date": 1427834231, "last_edit_date": 1428150509, "question_id": 29378091, "link": "https://stackoverflow.com/questions/29378091/excel-vba-creating-new-sheets-and-pasting-stuff-in-raise-1004-error", "title": "Excel VBA - Creating new sheets and pasting stuff in raise 1004 Error", "body": "<p>I have an issue with the Excel VBA code below. I ONLY get a <code>1004 error</code> when the block that is commented out is active.  </p>\n\n<p>Error Result: </p>\n\n<ul>\n<li>the first sheet in the array is created, header row pasted in and Formatted correctly</li>\n<li>Second sheet created, NO header row pasted</li>\n<li>Error stops script at that point -> no further sheets created</li>\n</ul>\n\n<p>I cant figure out what the problem is, can anyone help?</p>\n\n<pre><code>Dim ws1 As Worksheet: Set ws1 = ActiveWorkbook.Sheets(\"AGESTOCK\")\n\nDim newSheets(1 To 4) As String\nnewSheets(1) = \"CHEM - ALSO\"\nnewSheets(2) = \"LBS - LBLA\"\nnewSheets(3) = \"LBS - LBFG\"\nnewSheets(4) = \"Chemicals\"\nDim sheetName As Variant\n\n'Copy Header Row from ws1\nws1.Cells(1, 1).EntireRow.Copy\n\n'Create New Worksheets\nFor Each sheetName In newSheets\n    Sheets.Add After:=Worksheets(Worksheets.Count)\n    ActiveSheet.Name = sheetName\n\n    'Paste Header Row\n    ActiveSheet.Cells(1, 1).Select\n    ActiveSheet.Paste\n\n    ' Autofit Columns &amp; Zoom &amp; Scroll\n    ActiveWindow.Zoom = 90\n    ActiveSheet.Columns(\"A:Y\").AutoFit\n    ActiveSheet.Columns(\"B\").ColumnWidth = 60  'Description\n    ActiveSheet.Columns(\"E\").ColumnWidth = 12  'WAS\n    ActiveSheet.Columns(\"F\").ColumnWidth = 12  'NOW\n\n    'THIS IS THE SECTION THAT BREAKS IT\n    'Format WAS, NOW, AVGCOST, VALUE to CURRENCY  \n'    ActiveSheet.Columns(\"E\").NumberFormat = \"$#,##0.00\"  'WAS\n'    ActiveSheet.Columns(\"F\").NumberFormat = \"$#,##0.00\"  'NOW\n'    ActiveSheet.Columns(\"H\").NumberFormat = \"$#,##0.00\"  'AvgCost\n'    ActiveSheet.Columns(\"L\").NumberFormat = \"$#,##0.00\"  'Value\n\nNext sheetName\nws1.Activate\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1427859536, "post_id": 29377965, "comment_id": 46944052, "body": "Verify the values in your range. Make sure it is numeric. Sum returns zero if it does not find any numeric value."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 4730519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f0b1700eb5710b4a5cc39f71500e2e0?s=128&d=identicon&r=PG&f=1", "display_name": "winegum", "link": "https://stackoverflow.com/users/4730519/winegum"}, "is_accepted": false, "score": 1, "last_activity_date": 1427834819, "creation_date": 1427834819, "answer_id": 29378252, "question_id": 29377965, "link": "https://stackoverflow.com/questions/29377965/sum-of-a-column/29378252#29378252", "title": "Sum of a column", "body": "<p>first of all, i have no excel here, so i cant try by myself what I'm thinking.\nbut i think you use the Range-Method the wrong way.. it should look like this:</p>\n\n<pre><code>Set Rng = Weight.Range(\"A2\" , Cells( LastrowA , \"A\") )\n</code></pre>\n\n<p>so there is a \",\" between the arguments instead of a \"&amp;\" an there is a second Cell instead of a row-number.\nHope that helps</p>\n"}, {"tags": [], "owner": {"reputation": 110, "user_id": 4695744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-ZWK1GNVm3VE/AAAAAAAAAAI/AAAAAAAAIzA/W3kd_AxFWMQ/photo.jpg?sz=128", "display_name": "Anurag Singh", "link": "https://stackoverflow.com/users/4695744/anurag-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1427837572, "last_edit_date": 1427837572, "creation_date": 1427836711, "answer_id": 29378770, "question_id": 29377965, "link": "https://stackoverflow.com/questions/29377965/sum-of-a-column/29378770#29378770", "title": "Sum of a column", "body": "<p>This sub will sum data in Sheet 1 Columns A to C and put results in Sheet2</p>\n\n<p>You can use this sub and just change column letters and output cells.</p>\n\n<p>Hope this helps    </p>\n\n<pre><code>Sub SumRange()\nDim wb as Workbook\nSet wb = Thisworkbook\nDim ws as worksheet\nSet Weight = wb.Sheets(\"Weight\")\n\nLastRow1 = Weight.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet Rng = Weight.Range(\"A2:A\" &amp; \"\" &amp; LastRow1 &amp; \"\")\nCol1Sum = WorksheetFunction.Sum(Rng)\n\nLastRow1 = Weight.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nSet Rng = Weight.Range(\"B2:B\" &amp; \"\" &amp; LastRow1 &amp; \"\")\nCol2Sum = WorksheetFunction.Sum(Rng)\n\nLastRow1 = Weight.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nSet Rng = Weight.Range(\"C2:C\" &amp; \"\" &amp; LastRow1 &amp; \"\")\nCol3Sum = WorksheetFunction.Sum(Rng)\n\nThisWorkbook.Sheets(\"Sheet2\").Cells(2, 2).Value = Col1Sum\nThisWorkbook.Sheets(\"Sheet2\").Cells(3, 2).Value = Col2Sum\nThisWorkbook.Sheets(\"Sheet2\").Cells(4, 2).Value = Col3Sum\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 29378770, "answer_count": 2, "score": 1, "last_activity_date": 1427837572, "creation_date": 1427833764, "question_id": 29377965, "link": "https://stackoverflow.com/questions/29377965/sum-of-a-column", "title": "Sum of a column", "body": "<p>I want to calculate Sum of different columns in a worksheet and fill it in another worksheet.</p>\n\n<pre><code>LastrowA = Weight.Cells(Weight.Rows.Count, \"A\").End(xlUp).Row\nSet Rng = Weight.Range(\"A2\" &amp; LastrowA)\nWeight.Activate\n\nSumm= WorksheetFunction.Sum(Rng)    ' Doesn't work\nSummary.Cells(1, 1).Value=Summ\n\nSummary.Cells(1, 1).Value = Application.Sum(Rng)  ' Doesn't Work\n</code></pre>\n\n<p>The two Sheets are Weight and Summary. I have tried above two ways and both give me an answer of Zero. I want to continue doing it for all my columns . Please advice. Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 651, "user_id": 2856558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41617ca7cd9e6ed3d2a868e90f973fe4?s=128&d=identicon&r=PG&f=1", "display_name": "AdmiralWen", "link": "https://stackoverflow.com/users/2856558/admiralwen"}, "edited": false, "score": 0, "creation_date": 1427833843, "post_id": 29377726, "comment_id": 46936139, "body": "The code you posted works perfectly for me with the sample data you provided. What is the exact error message? Do you have the ID that you&#39;re looking for in cell B3 on the Search worksheet?"}, {"owner": {"reputation": 3, "user_id": 4735183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd532bf15b94692151ebe7d742aad1b?s=128&d=identicon&r=PG&f=1", "display_name": "DBPx3", "link": "https://stackoverflow.com/users/4735183/dbpx3"}, "reply_to_user": {"reputation": 651, "user_id": 2856558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41617ca7cd9e6ed3d2a868e90f973fe4?s=128&d=identicon&r=PG&f=1", "display_name": "AdmiralWen", "link": "https://stackoverflow.com/users/2856558/admiralwen"}, "edited": false, "score": 0, "creation_date": 1427834248, "post_id": 29377726, "comment_id": 46936323, "body": "The exact error is in a Microsoft Visual Basic window and states: &quot;Run-time error &#39;6&#39;: Overflow&quot;.  It then gives me the option to End, Debug or Help.  If I choose Debug it highlights the x = x + 1 line of code.  I experience this error when doing a search for any number in B3.  When I tried with 108143 it pasted the first value as expected but then the error will pop up."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4735183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd532bf15b94692151ebe7d742aad1b?s=128&d=identicon&r=PG&f=1", "display_name": "DBPx3", "link": "https://stackoverflow.com/users/4735183/dbpx3"}, "edited": false, "score": 0, "creation_date": 1427836059, "post_id": 29378277, "comment_id": 46937270, "body": "Different error when I made that change.  It now says &quot;Run-time error &#39;1004&#39;: Application-defined or object-defined error."}, {"owner": {"reputation": 3, "user_id": 4735183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd532bf15b94692151ebe7d742aad1b?s=128&d=identicon&r=PG&f=1", "display_name": "DBPx3", "link": "https://stackoverflow.com/users/4735183/dbpx3"}, "edited": false, "score": 0, "creation_date": 1427836431, "post_id": 29378277, "comment_id": 46937448, "body": "I should also add that the when I choose Debug with this change it is highlighting this line of code: Worksheets(&quot;Search&quot;).Cells(x, 4) = searchResult.Offset(0, 1).Value"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 3, "user_id": 4735183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd532bf15b94692151ebe7d742aad1b?s=128&d=identicon&r=PG&f=1", "display_name": "DBPx3", "link": "https://stackoverflow.com/users/4735183/dbpx3"}, "edited": false, "score": 0, "creation_date": 1427837220, "post_id": 29378277, "comment_id": 46937826, "body": "You need to check <code>searchresult is nothing </code>. Make sure you&#39;ve actually found another result."}, {"owner": {"reputation": 3, "user_id": 4735183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd532bf15b94692151ebe7d742aad1b?s=128&d=identicon&r=PG&f=1", "display_name": "DBPx3", "link": "https://stackoverflow.com/users/4735183/dbpx3"}, "edited": false, "score": 0, "creation_date": 1427838298, "post_id": 29378277, "comment_id": 46938317, "body": "From the data above there are multiple instances of 108143 yet the error persists.  From that I should be able to deduce that the searchresult should not be nothing.  It is still only returning the value next to the first instance when I need it to return the values of each instance.  Is that what you were pointing out or am I missing your point?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 3, "user_id": 4735183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd532bf15b94692151ebe7d742aad1b?s=128&d=identicon&r=PG&f=1", "display_name": "DBPx3", "link": "https://stackoverflow.com/users/4735183/dbpx3"}, "edited": false, "score": 0, "creation_date": 1427839333, "post_id": 29378277, "comment_id": 46938710, "body": "Not sure off the exact reason you&#39;re hitting an error right now. Hard to analyze on a phone screen. However, you will want to check for not found because you&#39;ll eventually hit it"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1427834916, "creation_date": 1427834916, "answer_id": 29378277, "question_id": 29377726, "link": "https://stackoverflow.com/questions/29377726/excel-vba-with-single-search-criteria-loop-for-all-distinct-values/29378277#29378277", "title": "Excel VBA with single search criteria, loop for all distinct values", "body": "<p>Change</p>\n\n<pre><code>Dim x As Integer\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Dim x As Long\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1428152079, "creation_date": 1428152079, "answer_id": 29446653, "question_id": 29377726, "link": "https://stackoverflow.com/questions/29377726/excel-vba-with-single-search-criteria-loop-for-all-distinct-values/29446653#29446653", "title": "Excel VBA with single search criteria, loop for all distinct values", "body": "<p>Your problem changed because you are not resetting the origin point of the search with the <code>After:=...</code> parameter of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196143.aspx\" rel=\"nofollow\">Range.FindNext Method</a>. Yes, you are passing in <em>searchResult</em> but it was not accepting it as the After:= parameter.</p>\n\n<p>When I ran your code, I was thrown into an infinite loop due to the FindNext always finding the same second instance. This explains the integer coughing at being incremented above 2\u00b9\u2075. When it was changed to a long, that gave something else time to choke.</p>\n\n<p>After I changed one line to definitively include the named parameter, everything cleared up.</p>\n\n<pre><code>  Set searchResult = Cells.FindNext(After:=searchResult)\n</code></pre>\n\n<p>This was reproducible simply by adding/removing the parameter designation. It seems that the <code>Cells.FindNext(searchResult)</code> was finding Search!B3 and since that wasn't the <em>firstAddress</em>, it just kept looping on the same Search!B3. It wasn't until I forced <code>after:=searchResult</code> that the <code>.FindNext</code> adjusted itself. It's times like these I think fondly of my C/C++ days without this wallowing overhead.</p>\n\n<p>I've gone through your code and added a <code>With ... End With</code> block that should discourage any questionable parentage.</p>\n\n<pre><code>Sub Acct_Search()\n\n    Dim searchResult As Range, firstAddress As String\n    Dim x As Long, ws As Worksheet\n\n    x = 3\n    Set ws = Worksheets(\"Search\")\n\n    ' Search for \"Activity\" and store in Range\n    With Worksheets(\"Data\").Range(\"A1:A3500\")\n        Set searchResult = .Find(What:=ws.Range(\"B3\"), LookIn:=xlFormulas, After:=.Cells(.Rows.Count, .Columns.Count), _\n                                 LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                                 MatchCase:=False, SearchFormat:=False)\n\n        ' Store the address of the first occurrence of this word\n        firstAddress = searchResult.Address\n        Do\n            ' Set the value in the O column, using the row number and column number\n            ws.Cells(x, 4) = searchResult.Offset(0, 1).Value\n\n            ' Increase the counter to go to the next row\n            x = x + 1\n\n            ' Find the next occurrence of \"Activity\"\n            Set searchResult = .FindNext(After:=searchResult)\n            'Debug.Print searchResult.Address(0, 0, external:=True)\n\n            ' Check if a value was found and that it is not the first value found\n        Loop While Not searchResult Is Nothing And firstAddress &lt;&gt; searchResult.Address\n    End With\n\n    Set ws = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I've left the <code>After:=</code> parameter designation in although it is no longer needed.</p>\n"}], "owner": {"reputation": 3, "user_id": 4735183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd532bf15b94692151ebe7d742aad1b?s=128&d=identicon&r=PG&f=1", "display_name": "DBPx3", "link": "https://stackoverflow.com/users/4735183/dbpx3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2214, "favorite_count": 0, "accepted_answer_id": 29446653, "answer_count": 2, "score": 0, "last_activity_date": 1428152079, "creation_date": 1427832886, "last_edit_date": 1428148950, "question_id": 29377726, "link": "https://stackoverflow.com/questions/29377726/excel-vba-with-single-search-criteria-loop-for-all-distinct-values", "title": "Excel VBA with single search criteria, loop for all distinct values", "body": "<p>I am getting this error message when I run the macro:</p>\n\n<blockquote>\n  <p>Run-time error '6': Overflow</p>\n</blockquote>\n\n<p>I have two worksheets; Search and Data. The 'Data' worksheet contains two columns, column A with numbers I want to search through and column B with an alphanumeric value I want to copy and paste into the 'Search' worksheet when a number match is found.  Because a number I am searching for can be listed an unknown number of times I want a macro to loop through to find all of the instances, copy the value to its immediate right and paste it into the 'Search' worksheet in cell D3 and going down a row for multiple instances of the number being found.</p>\n\n<p>The number I am searching for is found in cell B3 on the 'Search' worksheet.</p>\n\n<p>This is a sample of what the 'Data' worksheet looks like:</p>\n\n<pre><code>ID          ISS_ID\n108143      136KQV4\n108143      173HBK3\n108143      136KQX0\n109728      7805JM1\n109706      7805JM1\n102791      23252T4\n105312      6477LZ6\n</code></pre>\n\n<p>Here is the code that I have now:</p>\n\n<pre><code>Sub Acct_Search()\n\n    Dim searchResult As Range\n    Dim x As Integer\n\n    x = 3\n\n    ' Search for \"Activity\" and store in Range\n    Set searchResult =        Worksheets(\"Data\").Range(\"A1:A3500\").Find(What:=Worksheets(\"Search\").Range(\"B3\"), _\n                     LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\n                     SearchDirection:=xlNext, MatchCase:=False, _\n                     SearchFormat:=False)\n\n    ' Store the address of the first occurrence of this word\n    firstAddress = searchResult.Address\n    Do\n\n        ' Set the value in the O column, using the row number and column number\n        Worksheets(\"Search\").Cells(x, 4) = searchResult.Offset(0, 1).Value\n\n        ' Increase the counter to go to the next row\n        x = x + 1\n\n        ' Find the next occurrence of \"Activity\"\n        Set searchResult = Cells.FindNext(searchResult)\n\n        ' Check if a value was found and that it is not the first value found\n    Loop While Not searchResult Is Nothing And firstAddress &lt;&gt; searchResult.Address\n\nEnd Sub\n</code></pre>\n\n<p>When I Debug it points to the <code>x = x + 1</code> line. Right now it is able to copy and paste the first value without issue but it is after that point that the error comes into play.</p>\n"}, {"tags": ["vb.net", "excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1427829831, "post_id": 29376738, "comment_id": 46934041, "body": "vb.net or excel-vba?  they are mutually exclusive.  <code>the first 10 rows of a database</code> means what?  oldest? newest?  how they are stored is not  usually relevant (or even known) to consumers of the data"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1427831896, "post_id": 29376738, "comment_id": 46935236, "body": "Do you know enough SQL to write the query to generate the data you&#39;re looking for?"}, {"owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1427925097, "post_id": 29376738, "comment_id": 46978561, "body": "That&#39;s already generated, I&#39;m simply taking the first 10 rows of the db (doesn&#39;t matter if you need to know if the data is ordered) (it is by lowest to highest)"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1427925186, "post_id": 29380695, "comment_id": 46978599, "body": "Thx, the button I have that will run this code  update every time 10 rows from the Db - basically my db has at the mo 24 rows, all I need is to export the first 10 each time a button is clicked"}, {"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "reply_to_user": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1427928001, "post_id": 29380695, "comment_id": 46979686, "body": "Pleasure - so you can link the code above to a button in excel quite easily. You&#39;ll still need code to select the top 10 rows, and as @Plutonix said yesterday, that&#39;s a very malleable concept in DB terms. My suggestion is to create a query in Access that does what you want (use the UI if you&#39;re not comfortable with SQL), then change it to SQL mode and copy the SQL Access gives you into the string that houses the query. Same for the other DB you&#39;re connecting to."}, {"owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1427976676, "post_id": 29380695, "comment_id": 46997998, "body": "Just wondering, where does this save the save the excel spreadsheet and is there a given name for it? Also how would I add column headers just above the data?"}, {"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "reply_to_user": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1427998550, "post_id": 29380695, "comment_id": 47011252, "body": "As it is, this doesn&#39;t save anything in Excel - it just copies the data into a range. You&#39;d have to save stuff manually, or add <code>ThisWorkbook.SaveAs &quot;C:\\Path\\To\\Your\\Workbook.xlsx&quot;</code> at the end. As to column headers, sorry, forgot about those. I believe there&#39;s an alternative method that brings them back, but failing that, what you can do it, before you pull out the data add something like <code>ForEach field In oRS.Fields : Range(A1).Value = field.Name : Next field</code>. You&#39;d need to dim field, and I honestly can&#39;t remember if that approach gives you fields or values, or if <code>field.Name</code> is valid..."}, {"owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1428079966, "post_id": 29380695, "comment_id": 47041612, "body": "I&#39;m having a few issues with the following - <code>Dim wksTarget As Excel.Worksheet</code> and <code>oRS = Nothing</code>. The first states that it is not defined and the second states that it is not declared."}, {"owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1428081049, "post_id": 29380695, "comment_id": 47042112, "body": "^Additionally <code>ThisWorkbook.SaveAs &quot;C:\\Path\\To\\Your\\Workbook.xlsx&quot;</code> doesn&#39;t work either."}, {"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "reply_to_user": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "edited": false, "score": 0, "creation_date": 1428148500, "post_id": 29380695, "comment_id": 47059089, "body": "Right, sorry for that - wrote this when it was late, and didn&#39;t have a database to test against on hand. Edited the code - you&#39;ll note the changes:(1) Now uses <code>ThisWorkbook.Worksheets</code> rather than <code>Excel.Woorksheets</code> (2) <code>oRS</code> is a standard name I use for my recordsets most of the time. I&#39;ve used <code>oRecords</code> here though, so that gets set to nothing (3) Added the save code that works. Note the directory check beforehand."}], "tags": [], "owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "is_accepted": true, "score": 0, "last_activity_date": 1428148374, "last_edit_date": 1428148374, "creation_date": 1427846996, "answer_id": 29380695, "question_id": 29376738, "link": "https://stackoverflow.com/questions/29376738/exporting-an-access-db-to-excel-through-vb-with-the-first-10-rows-of-db/29380695#29380695", "title": "Exporting an access DB to Excel through VB - with the first 10 rows of DB", "body": "<p>Assuming this is something like an Import Data button in Excel, you probably want to use ADODB to connect to your access databases, select data into a recordset, then read the recordset into an array and assign to the worksheet you want to import to (optionally at the end of existing data - this depends on whether you're importing \"10 more rows\" or refreshing the top 10 rows (whatever that means - guessing you have a query to get these in Access, though).</p>\n\n<p>Approach would look something like this. Oh, before we begin, you'll need to add a reference (Tools -> References) to <code>Microsoft ActiveX Data Objects 6.1</code>.</p>\n\n<pre><code>Public Sub Test()\n    Dim strSQL_Query As String\n    Dim oCN As ADODB.Connection\n    Dim oCMD As ADODB.Command\n    Dim oRecords As ADODB.Recordset\n    Dim strCN As String\n    Dim strDBPath As String\n    Dim varValues As Variant\n    Dim wksTarget As Excel.Worksheet\n    Dim lngRows As Long\n    Dim lngCols As Long\n\n\n    '' Replace with the path to your DB. You could also use a dialog box to let the user choose a DB, if\n    '' it moves around or isn't found.\n    strDBPath = \"C:\\myFolder\\myAccessFile.accdb\"\n    strCN = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strDBPath &amp; \";\" &amp; _\n            \"Persist Security Info=False;\"\n\n    '' Replace this with a query that does what you need it to\n    strSQL_Query = \"SELECT TOP 10 FROM [MyTable] WHERE &lt;Conditions&gt; ORDER BY [Column] DESC\"\n\n    Set oCN = New ADODB.Connection\n    oCN.ConnectionString = strCN\n    oCN.Open\n\n    Set oCMD = New ADODB.Command\n    oCMD.ActiveConnection = oCN\n    oCMD.CommandText = strSQL_Query\n    Set oRecords = oCMD.Execute\n\n    If oRecords.BOF And Not oRecords.EOF Then\n        varValues = oRecords.GetRows\n        Set wksTarget = ThisWorkbook.Worksheets(1)\n\n        '' You might need 0 and 1 instead of 1 and 2 - I forget\n        lngCols = UBound(varValues, 1)\n        lngRows = UBound(varValues, 2)\n        wksTarget.Range(\"A1\", wksTarget.Range(\"A1\").Offset(lngRows, lngCols)) = varValues\n    End If\n\n    '' Clean up...\n    Set oRecords = Nothing\n    Set oCMD = Nothing\n    oCN.Close\n    Set oCN = Nothing\n\n    '' Do Some more stuff...\n\n    '' And finish by saving the workbook\n    '' 1) Check if the directory exists and create it\n    Dim strDir as String\n    strDir = \"C:\\Some\\Path\\Here\"\n    If Dir(strDir, vbDirectory) = \"\" Then MkDir(strDir)\n    ThisWorkbook.SaveAs strDir &amp; \"YourWorkbookName.xlsm\", 52 '' 52 is a constant indicating a macro enabled format\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4252293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5cca80f981d788c95fea67a057e9407?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4252293/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3867, "favorite_count": 0, "accepted_answer_id": 29380695, "answer_count": 1, "score": 0, "last_activity_date": 1428148374, "creation_date": 1427829528, "last_edit_date": 1531161705, "question_id": 29376738, "link": "https://stackoverflow.com/questions/29376738/exporting-an-access-db-to-excel-through-vb-with-the-first-10-rows-of-db", "title": "Exporting an access DB to Excel through VB - with the first 10 rows of DB", "body": "<p>I am new to using VB alongside Excel and am in need of help.</p>\n\n<p>I have an two access databases; one having 10 columns with many rows (more than 10), and the other Database has 8 columns and the same amount of rows as the other.</p>\n\n<p>What I am trying to do is to export the first 10 rows of both databases to an excel sheet (in separate sheets or in two separate excel files, either way) so that this could be emailed or printed.</p>\n\n<p>I've been looking around trying to get an idea on how to do this and have tried a few ways of doing it but none of them have worked.</p>\n\n<p>Additionally I'll be fine if someone can help with exporting one database through VB with the first 10 rows of the database.</p>\n\n<p>Could someone please help me.</p>\n\n<p>Thanks,\nAndy</p>\n"}, {"tags": ["excel", "vba", "tabs", "custom-controls", "ribbon"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4602423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/becb2d3842ecbfc7777697c7d899fcd1?s=128&d=identicon&r=PG&f=1", "display_name": "ozzy", "link": "https://stackoverflow.com/users/4602423/ozzy"}, "edited": false, "score": 0, "creation_date": 1428152676, "post_id": 29419086, "comment_id": 47060199, "body": "Yes, II thought about this solution, but I was hoping to find a more elegant solution to implement. Is there in Excel2007 no callback function like the getvisibility() for exemple?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1427996203, "creation_date": 1427996203, "answer_id": 29419086, "question_id": 29376724, "link": "https://stackoverflow.com/questions/29376724/excel2007-vba-return-to-same-custom-ui-ribbon-tab-after-opening-another-workb/29419086#29419086", "title": "excel2007 vba: Return to same (Custom UI ribbon) tab after opening another workbook", "body": "<p>The Application class from the Excel object model provides two events:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff821328(v=office.15).aspx\" rel=\"nofollow\">WindowActivate</a> - is fired when any workbook window is activated.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff822473(v=office.15).aspx\" rel=\"nofollow\">WindowDeactivate</a> - is fired when any workbook window is deactivated.</li>\n</ul>\n\n<p>Starting from Office 2010 you can use the ActivateTab method of the IRibbonUI interface. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ee691834(v=office.14).aspx\" rel=\"nofollow\">Ribbon Extensibility in Office 2010: Tab Activation and Auto-Scaling</a> for more information. </p>\n\n<p>So, you can implement the required functionality on your own.</p>\n"}], "owner": {"reputation": 1, "user_id": 4602423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/becb2d3842ecbfc7777697c7d899fcd1?s=128&d=identicon&r=PG&f=1", "display_name": "ozzy", "link": "https://stackoverflow.com/users/4602423/ozzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531322067, "creation_date": 1427829470, "last_edit_date": 1531322067, "question_id": 29376724, "link": "https://stackoverflow.com/questions/29376724/excel2007-vba-return-to-same-custom-ui-ribbon-tab-after-opening-another-workb", "title": "excel2007 vba: Return to same (Custom UI ribbon) tab after opening another workbook", "body": "<p>I was adding ustom UI ribbons with tabs, groups an buttons. This works great. Among the makros I have also adden functions to open another excel files.\nMy problem is that when I return to original excel workbook, the first tab is always activated, instead of the one which was last used (for ex my custom tab).</p>\n\n<p><strong>Is there anyone knowing how can I make Excel remembering which tab I was last using?</strong> </p>\n\n<p>For genuine excel tabs this works, only for the custom tab doesn't.</p>\n\n<p>Thank you already for your comments.</p>\n\n<p>OZ</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "is_accepted": true, "score": 0, "last_activity_date": 1427829804, "creation_date": 1427829804, "answer_id": 29376815, "question_id": 29376706, "link": "https://stackoverflow.com/questions/29376706/vba-object-module-must-implement/29376815#29376815", "title": "VBA Object module must Implement ~?", "body": "<p>Actaully Per the second question I linked has the correct answer which I missed.</p>\n\n<p>All subs need to start with 'IModel_' and rest ot the name has to match the name in <code>IModel</code>.</p>\n\n<p>AND</p>\n\n<p>This is the part i missed, you cannot use underscore in the Sub name.</p>\n"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 29376815, "answer_count": 1, "score": 0, "last_activity_date": 1427829804, "creation_date": 1427829430, "last_edit_date": 1495541665, "question_id": 29376706, "link": "https://stackoverflow.com/questions/29376706/vba-object-module-must-implement", "title": "VBA Object module must Implement ~?", "body": "<p>I have created two classes, one being an interface for the other. Each time I try to instantiate <code>Transition_Model</code> I get:</p>\n\n<blockquote>\n  <p>Compile error: Object Module needs to implement '~' for interface'~'</p>\n</blockquote>\n\n<p>To my understanding Implementing class is supposed to have a copy of all public subs, function, &amp; properties. So I don't understant what is the problem here?  </p>\n\n<p>Have seen similar questions come up but either they refer to <a href=\"https://stackoverflow.com/questions/3171324/implementing-my-own-interface-in-vba-error-object-module-needs-to-implement\">actual Sub</a> or they include <a href=\"https://stackoverflow.com/questions/19373081/how-to-use-the-implements-in-excel-vba\">other complications</a> making answer too complicated for me to understand.</p>\n\n<p>Also note I tried changing Subs of <code>Transition_Model</code> to Private and add 'IModel_' in front of sub names(Just like top answer in second question I linked) but I still receive the same error.</p>\n\n<p>IModel</p>\n\n<pre><code>Option Explicit\nPublic Enum Model_Types\n      Transition\n      Dummy\nEnd Enum\nProperty Get M_Type() As Model_Types\nEnd Property\nSub Run(Collat As Collateral)\nEnd Sub\nSub Set_Params(key As String, value As Variant)\nEnd Sub\n</code></pre>\n\n<p>Transition_Model</p>\n\n<pre><code>Option Explicit\nImplements IModel\nPrivate Transitions As Collection\nPrivate Loan_States As Integer\nPrivate Sub Class_Initialize()\n    Set Transitions = New Collection\nEnd Sub\nPublic Property Get M_Type() As Model_Types\n    M_Type = Transition\nEnd Property\nPublic Sub Run(Collat As Collateral)\n    Dim A_Transition  As Transition\n    Dim New_Balance() As Double\n    Dim Row           As Integer\n\n    For Row = 1 To UBound(Collat.Curr_Balance)\n        For Each A_Transition In Transitions\n            If A_Transition.Begining = i Then\n                New_Balance = New_Balance + Collat.Curr_Balance(Row) * A_Transition.Probability\n            End If\n        Next A_Transition\n    Next\nEnd Sub\nPublic Sub Set_Params(key As String, value As Double)\n    Dim Split_key(1 To 2) As String\n    Dim New_Transition As Transition\n\n    Split_key = Split(key, \"-&gt;\")\n    Set New_Transition = New Transition\n\n    With New_Transition\n        .Begining = Split_key(1)\n        .Ending = Split_key(2)\n        .Probability = value\n    End With\n\n    Transitions.Add New_Transition, key\nEnd Sub\n</code></pre>\n\n<p>Lastly the Sub I am using to test my class</p>\n\n<pre><code>Sub Transition_Model()\n    Dim Tested_Class As New Transition_Model\n    Dim Collat As New Collateral\n\n    'Test is the model type is correct\n    Debug.Assert Tested_Class.M_Type = Transition\n\n    'Test if Model without transition indeed does not affect balances of its collateral\n    Collat.Curr_Balance(1) = 0.5\n    Collat.Curr_Balance(2) = 0.5\n\n    Tested_Class.Run (Collat)\n\n    Debug.Assert ( _\n        Collat.Curr_Balance(1) = 0.5 And _\n        Collat.Curr_Balance(2) = 0.5)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 18158, "user_id": 3293914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fPAnb.jpg?s=128&g=1", "display_name": "Dan Field", "link": "https://stackoverflow.com/users/3293914/dan-field"}, "edited": false, "score": 0, "creation_date": 1427830898, "post_id": 29376677, "comment_id": 46934620, "body": "I believe you&#39;d either need to use a RichTextBox or two text boxes to achieve this."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 3, "last_activity_date": 1427832661, "creation_date": 1427832661, "answer_id": 29377672, "question_id": 29376677, "link": "https://stackoverflow.com/questions/29376677/make-different-words-in-same-text-box-have-different-font-size-using-vba/29377672#29377672", "title": "Make different words in same text box have different font size using VBA", "body": "<p>A RichTextBox is not needed. The answer lies in the properties of the TextRange object within the TextFrame of the TextBox (what a mouthful!). Basically, you can parse/traverse the text within this range object and, if you make selections based on paragraphs (or sentences, words, characters, etc) you can apply different text effects.</p>\n\n<pre><code>Sub CreateTextbox()\n    Dim MyTextBox As Shape\n    Dim textBoxText As String\n    Dim textToChange As TextRange\n    textBoxText = \"this is some wild text\"\n    With ActiveWindow.Selection.SlideRange\n        Set MyTextBox = .Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, _\n                        Left:=153, Top:=50, Width:=400, Height:=100)\n        MyTextBox.TextFrame.TextRange.Text = textBoxText\n        MyTextBox.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignCenter\n        MyTextBox.TextFrame.TextRange.Font.Bold = msoTrue\n        MyTextBox.TextFrame.TextRange.Font.Name = \"Arial (Headings)\"\n\n        # here's where the magic happens\n        Set textToChange = MyTextBox.TextFrame.TextRange\n        textToChange.Words(3).Select\n        textToChange.Words(3).Font.Size = 42\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "is_accepted": false, "score": 0, "last_activity_date": 1427852642, "creation_date": 1427852642, "answer_id": 29381499, "question_id": 29376677, "link": "https://stackoverflow.com/questions/29376677/make-different-words-in-same-text-box-have-different-font-size-using-vba/29381499#29381499", "title": "Make different words in same text box have different font size using VBA", "body": "<p>Get the text range reference and then assign the desired font size.</p>\n\n<pre><code>With myTextBox.TextFrame2.TextRange\n    With .InsertAfter(\"This text should be of font size 24,\")\n        .Font.Size = 24\n    End With\n    With .InsertAfter(\"this text should be of font size 20\")\n        .Font.Size = 20\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 862, "user_id": 2556978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a29a34715f5224b8979174677285ec8?s=128&d=identicon&r=PG", "display_name": "spaderdabomb", "link": "https://stackoverflow.com/users/2556978/spaderdabomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4968, "favorite_count": 1, "accepted_answer_id": 29377672, "answer_count": 2, "score": 0, "last_activity_date": 1427852642, "creation_date": 1427829347, "question_id": 29376677, "link": "https://stackoverflow.com/questions/29376677/make-different-words-in-same-text-box-have-different-font-size-using-vba", "title": "Make different words in same text box have different font size using VBA", "body": "<p>the title pretty much says it all, but to make it a little more clear, say I want to create a text box via VBA that says \"This text should be of font size 24, this text should be of font size 20.\"</p>\n\n<p>Right now, I'm using my own function to create the text box, which is below. Cheers, and thanks for the help!</p>\n\n<pre><code>Sub textBox(textBoxText As String)\n    Dim myTextBox As Shape\n    With ActiveWindow.Selection.SlideRange\n        Set myTextBox = .Shapes.AddTextbox _\n            (Orientation:=msoTextOrientationHorizontal, Left:=153, Top:=50, _\n            Width:=400, Height:=100)\n        myTextBox.TextFrame.TextRange.Text = textBoxText\n        myTextBox.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignCenter\n        myTextBox.TextFrame.TextRange.Font.Bold = msoTrue\n        myTextBox.TextFrame.TextRange.Font.Name = \"Arial (Headings)\"\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1427829110, "creation_date": 1427829110, "answer_id": 29376595, "question_id": 29376525, "link": "https://stackoverflow.com/questions/29376525/how-to-convert-text-to-date-value/29376595#29376595", "title": "How to convert text to date value", "body": "<p>Use the formula <code>=DATEVALUE(A1)</code>.</p>\n\n<p>This takes a text input and converts it to a date.</p>\n"}], "owner": {"reputation": 7350, "user_id": 3022875, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/47e6e15bb7e835168e4c2d5f3c7facc4?s=128&d=identicon&r=PG&f=1", "display_name": "user3022875", "link": "https://stackoverflow.com/users/3022875/user3022875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427829110, "creation_date": 1427828878, "last_edit_date": 1531161705, "question_id": 29376525, "link": "https://stackoverflow.com/questions/29376525/how-to-convert-text-to-date-value", "title": "How to convert text to date value", "body": "<p>I have a 1/2/2015 21:00:00 in a cell A1 and when I do =istext(A1) I get TRUE  and this makes it hard to compare this date to other dates because it is in the Text format.  How can I convert this to a date format so I can compare it to other dates?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["loops", "excel", "average", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427829000, "post_id": 29376436, "comment_id": 46933565, "body": "Yes there is! <a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>. Give it a shot, maybe try the macro recorder, then post your code and the specific spot that is generating problems for you."}], "answers": [{"tags": [], "owner": {"reputation": 236, "user_id": 4709191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9TshA.jpg?s=128&g=1", "display_name": "Jeff Yontz", "link": "https://stackoverflow.com/users/4709191/jeff-yontz"}, "is_accepted": false, "score": 0, "last_activity_date": 1427829333, "creation_date": 1427829333, "answer_id": 29376670, "question_id": 29376436, "link": "https://stackoverflow.com/questions/29376436/loop-thru-the-dataset-and-get-yearly-average/29376670#29376670", "title": "Loop thru the dataset and get yearly average", "body": "<p>Not sure if there is a better way, but this is how I would do it. Make a new sheet with whatever formatting you want (ie. by day of the year or whatever). Once you have that, in column B next to the January 1, type <code>=average(</code> Then use the shortcut <code>CTRL+PgDown</code> to switch tabs from left to right. Click the first day entry on the first year, then press the <code>,</code> key, then use <code>CTRL+PgDown</code> (I use the right <code>CTRL</code> key with my left hand) to quickly cycle through clicking the first entry again on each tab. After the first comma, you won't have to press it again, so it should be pretty easy. </p>\n\n<p>When you've added the last entry, hit enter and the average for the first day will be there. If you have already done the formatting for each day in column A, just click the cell with the first average. You'll see a small square in the bottom right corner of the cell. Double click it and voila.</p>\n"}], "owner": {"reputation": 67, "user_id": 2237793, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c938f7a89773f246575e8b62a0b75896?s=128&d=identicon&r=PG", "display_name": "user2237793", "link": "https://stackoverflow.com/users/2237793/user2237793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427829333, "creation_date": 1427828517, "last_edit_date": 1531164843, "question_id": 29376436, "link": "https://stackoverflow.com/questions/29376436/loop-thru-the-dataset-and-get-yearly-average", "title": "Loop thru the dataset and get yearly average", "body": "<p>The excel file has 20 tabs. Each tab has over 2000 rows of daily forward curves. The layout of the data on each tab: the first column is the date 2007-01-01, 2007-01-02, 2007-01-03.. and the first row is 2008-01-01, 2008-02-01,2008-03-1 all the way to 2025-12-01</p>\n\n<p>Is there a way to loop through all the row and return the average price of Y+1, Y+2, Y+3 for each day in the first column?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "edited": false, "score": 0, "creation_date": 1427829485, "post_id": 29376512, "comment_id": 46933845, "body": "Thanks. Can you also tell me as hpow can I included <i>.xls</i> as I am getting an error over there&#39;"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "edited": false, "score": 0, "creation_date": 1427829917, "post_id": 29376512, "comment_id": 46934085, "body": "@Jain, see additional notes in my answer."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1427829824, "last_edit_date": 1427829824, "creation_date": 1427828850, "answer_id": 29376512, "question_id": 29376034, "link": "https://stackoverflow.com/questions/29376034/summing-entire-column-and-using-input-string-in-path/29376512#29376512", "title": "Summing entire column and using input string in path", "body": "<pre><code>fld = ws1.Cells.Value(i, \"B\")\n</code></pre>\n\n<p>two issues with this:</p>\n\n<ol>\n<li>it's <code>.cells</code> that needs the cell reference, not <code>.value</code></li>\n<li>you're mixing <code>R1C1</code> with <code>A1</code> in your cell reference</li>\n</ol>\n\n<p>Try it this way:</p>\n\n<p>or:</p>\n\n<pre><code>fld = ws1.Range(\"B\" &amp; i).Value\n</code></pre>\n\n<p>You're repeating error #2 in all your references where you're using <code>.cells()</code></p>\n\n<p><strong>Additional Error:</strong></p>\n\n<pre><code>fName = Dir(fld &amp; .Cells(i, \"C\").Value + \"*.xls*\")\n</code></pre>\n\n<p>In addition to error #2, above, you're using <code>+</code> for concatenation. VBA uses <code>&amp;</code>. </p>\n\n<pre><code>fName = Dir(fld &amp; .Cells(i, 3).Value &amp; \"*.xls*\")\n</code></pre>\n\n<p><strong>NOTE:</strong> </p>\n\n<p>You may want to consider putting some error handling around the <code>Set wb2 = Workbooks.Open(fld &amp; fName, ReadOnly:=True)</code> line, since you're relying on a user to correctly enter a path (you're assuming it ends in a <code>\\</code>) and a file name. The slightest typo and your <code>.Open()</code> will fail.</p>\n\n<p>You may also consider searching for <code>FileSystemObject</code> to present the user with the Windows standard file dialog box so they can pick the file they want to have opened. That will ensure you get back a  (if they cancel) or a guaranteed valid path\\filename since they selected something existing and didn't have to type it in.</p>\n"}], "owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427829824, "creation_date": 1427827206, "question_id": 29376034, "link": "https://stackoverflow.com/questions/29376034/summing-entire-column-and-using-input-string-in-path", "title": "Summing entire column and using input string in path", "body": "<pre><code>Sub Value()\n\n\nDim fName As String\nDim fld As String\nSet wb1 = ThisWorkbook\nSet ws1 = wb1.Worksheets(\"Profit\")\nSet ws2 = wb1.Worksheets(\"Loss\")\n\nWith ws1\nLastrow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\nEnd With\n\nFor i = 1 To Lastrow\n  **fld = ws1.Cells.Value(i, \"B\")\n    fName = Dir(fld &amp; .Cells(i, \"C\").Value + \"*.xls*\")**\n    Set wb2 = Workbooks.Open(fld &amp; fName, ReadOnly:=True)\n    wb1.Worksheets(\"Revenues\").UsedRange.Clear\n    wb2.Worksheets(\"Latest\").UsedRange.Copy  Destination:=wb1.Worksheets(\"Revenues\").Range(\"A1\")\n    wb2.Close savechanges:=False\n\n    With ws2\n    Lastrow2 = .Cells(.Rows.Count, \"P\").End(xlUp).Row\n    End With\n\n    **ws1.Cells(i, \"E\").Value = Excel.WorksheetFunction.Sum(ws2.Range(\"P2\" &amp; Lastrow2))**\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>I am facing small errors at two places. First, the file from which I get the latest data is opened using Directory and File name provided as String in B &amp; C column, but the compiler doesn't take it when I use. Secondly, when I sum the entire column it gives zero value always, don't know why. In short I take the file name and directory and place an output number(Sum up column) besides it. Also SUM(P:P) doesn't work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1427827214, "post_id": 29376000, "comment_id": 46932557, "body": "Why not just have <i>one</i> button that does all the work based on whatever cell is currently <i>selected</i>?"}, {"owner": {"reputation": 53, "user_id": 4735260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58582cb46c35c1e633c0ee8e1495759?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Keenan", "link": "https://stackoverflow.com/users/4735260/tom-keenan"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427830351, "post_id": 29376000, "comment_id": 46934300, "body": "Ah that would work, how do I do that?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427831143, "post_id": 29376000, "comment_id": 46934790, "body": "How would you do what, exactly?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1427839362, "post_id": 29376000, "comment_id": 46938726, "body": "You haven&#39;t shown any code, but it sounds like you should look into <code>activecell</code>"}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1427859252, "creation_date": 1427859252, "answer_id": 29382407, "question_id": 29376000, "link": "https://stackoverflow.com/questions/29376000/make-a-button-move-with-a-cell-in-excel/29382407#29382407", "title": "Make a button move with a cell in Excel", "body": "<p>Based on David's comment, you can try this set up.</p>\n\n<pre><code>Dim r As Range\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub CommandButton21_Click()\n    r.Offset(0, -1).Value = Time\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    On Error GoTo halt\n    Application.EnableEvents = False\n\n    If Target.CountLarge &gt; 1 Then GoTo moveon\n    Dim btn As OLEObject: Set btn = Me.OLEObjects(\"CommandButton21\")\n\n    If Not Intersect(Target, Me.Range(\"B:B\")) Is Nothing Then\n        Set r = Target\n        With btn\n            .Visible = True\n            .Left = r.Left\n            .Top = r.Top\n            .Width = r.Width\n            .Height = r.Height\n        End With\n    Else\n        btn.Visible = False\n    End If\n\nmoveon:\n    Application.EnableEvents = True\n    Exit Sub\nhalt:\n    MsgBox Err.Description\n    Resume moveon\nEnd Sub\n</code></pre>\n\n<p>You need to create an ActiveX Control with <code>CommandButton21</code> as its name.<br>\nThis buttons move and appear when something is selected in Column B.<br>\nYou can add your sort routine on the <em>CommandButton21_Click</em> event.</p>\n"}], "owner": {"reputation": 53, "user_id": 4735260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58582cb46c35c1e633c0ee8e1495759?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Keenan", "link": "https://stackoverflow.com/users/4735260/tom-keenan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1226, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427859252, "creation_date": 1427827102, "last_edit_date": 1427856549, "question_id": 29376000, "link": "https://stackoverflow.com/questions/29376000/make-a-button-move-with-a-cell-in-excel", "title": "Make a button move with a cell in Excel", "body": "<p>I am trying to create a spreadsheet in which I need a button in each row to stamp the time in the cell next to it and then sort the rows in order of time. My problem is that the buttons do not move. E.g. Button in cell B1 changes time in cell A1 and button in cell B2 changes time in cell A2 and for this example lets say A2 has a lower time than A1 so when sorted A1 and A2 effectively swap data. Now the button in B2 changes the time in cell A1. </p>\n\n<p>Been trying to figure this out for hours, any help would be greatly appreciated.</p>\n"}, {"tags": ["macos", "excel", "applescript", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2777, "user_id": 3406483, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8921851c87c9bf835ce733788720463a?s=128&d=identicon&r=PG", "display_name": "redOctober13", "link": "https://stackoverflow.com/users/3406483/redoctober13"}, "edited": false, "score": 0, "creation_date": 1574702215, "post_id": 29376282, "comment_id": 104316850, "body": "This was helpful. My problem is that <code>MacScript</code> returns a 126, which is &quot;Permission denied&quot; yet the script runs fine in the AppleScript editor. Does VBA require special permissions? (The script file has execute permissions for every group after I did <code>chmod +x test.sh</code>)"}, {"owner": {"reputation": 239138, "user_id": 45375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39f6e2dc52425b1e08027c01bb880be0?s=128&d=identicon&r=PG", "display_name": "mklement0", "link": "https://stackoverflow.com/users/45375/mklement0"}, "reply_to_user": {"reputation": 2777, "user_id": 3406483, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8921851c87c9bf835ce733788720463a?s=128&d=identicon&r=PG", "display_name": "redOctober13", "link": "https://stackoverflow.com/users/3406483/redoctober13"}, "edited": false, "score": 0, "creation_date": 1574702520, "post_id": 29376282, "comment_id": 104316978, "body": "@redOctober13: I personally don&#39;t know the answer, but I encourage you to ask a <i>new</i> question."}], "tags": [], "owner": {"reputation": 239138, "user_id": 45375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39f6e2dc52425b1e08027c01bb880be0?s=128&d=identicon&r=PG", "display_name": "mklement0", "link": "https://stackoverflow.com/users/45375/mklement0"}, "is_accepted": true, "score": 2, "last_activity_date": 1427831785, "last_edit_date": 1427831785, "creation_date": 1427827976, "answer_id": 29376282, "question_id": 29375503, "link": "https://stackoverflow.com/questions/29375503/macscript-invalid-procedure-call-or-argument/29376282#29376282", "title": "MacScript Invalid procedure call or argument", "body": "<p>Generally, to prevent <code>do shell script</code> (and therefore, indirectly, <code>MacScript()</code>) from throwing an error, make sure that the shell command exits with code <code>0</code>.</p>\n\n<p>In your case, to <em>merely capture the shell command's exit code</em>, append <code>; echo $?</code> to the command string passed to <code>do shell script</code>:</p>\n\n<p>Simplified example, using a malformed <code>date</code> command:</p>\n\n<pre><code>Dim rc As Integer\nrc = MacScript(\"do shell script \"\"date -nosuchoptions; echo $?\"\"\") ' returns 1\n</code></pre>\n\n<ul>\n<li><code>echo $?</code> outputs the (preceding) command's exit code to <em>stdout</em> and is therefore returned by <code>do shell script</code></li>\n<li>as a - desirable - side effect, the exit code will be set to <code>0</code>, because the <code>echo</code> command succeeds; therefore, the overall command exits with code <code>0</code>, thus preventing <code>do shell script</code> from throwing an error.</li>\n</ul>\n\n<p><em>Caveats</em>: </p>\n\n<ul>\n<li>Since you're assigning <code>MacScript</code>'s return value to an <code>Integer</code> variable, be sure that the <code>do shell script</code> command's output can be <em>parsed as a number</em>.<br>\n(The above command is safe, as is yours from the question, because the preceding command's stdout output is captured in a file, and the subsequent <code>echo $?</code> is guaranteed to output a \"number-looking\" string.)</li>\n<li>If your shell command is <em>syntactically</em> incorrect, <code>MacScript</code> will still throw an error; you could use this to distinguish between syntax and runtime errors.</li>\n</ul>\n\n<hr>\n\n<p>If, by contrast, you still want to return a command's <em>output</em> and simply know <em>in the abstract</em> whether something went wrong:</p>\n\n<pre><code>    Dim stdout As String\n    On Error Resume Next  ' ignore runtime errors\n    stdout = MacScript(\"do shell script \"\"date -nosuchoptions\"\"\")\n    If Err.Number &lt;&gt; 0 Then\n      MsgBox \"Something went wrong.\", vbExclamation\n    Else\n      MsgBox \"Captured output: \" &amp; stdout, vbInformation\n    End If\n</code></pre>\n\n<ul>\n<li>Note that this method does <em>not</em> allow you to determine the shell command's <em>specific</em> exit code, because Excel VBA translates <em>any</em> nonzero shell exit code into the generic error number <code>5</code> (<code>Invalid procedure call or argument</code>).</li>\n</ul>\n\n<hr>\n\n<p>Finally, you can <em>combine</em> the 2 approaches - return the command's output <em>and</em> its specific exit code:</p>\n\n<pre><code>    Dim stdout As String, rc As Integer, pos As Integer\n    ' Execute the command, and appends its exit code as the *last line* of output.\n    ' Note how both stdout and stderr output are captured via `2&gt;&amp;1`.\n    stdout = MacScript(\"do shell script \"\"{ date; date -nosuchoptions; } 2&gt;&amp;1; echo $?\"\"\")\n    ' Extract the last line from the output captured.\n    pos = InStrRev(stdout, Chr$(13)) ' find last line break (\\n has been translated to \\r by `do shell script`)\n    rc = Mid(stdout, pos + 1)        # exit code\n    stdout = Left(stdout, pos - 1)   # captured output (only)\n    If rc &lt;&gt; 0 Then\n      MsgBox \"Command failed with exit code \" &amp; rc &amp; \"; captured output: \" &amp; stdout, vbExclamation\n    Else\n        MsgBox \"Captured output: \" &amp; stdout, vbInformation\n    End If\n</code></pre>\n\n<p><em>Caveats</em>:</p>\n\n<ul>\n<li>If your shell command is <em>syntactically</em> incorrect, <code>MacScript</code> will still throw an error; you could use this to distinguish between syntax and runtime errors.</li>\n<li>If your shell command (the one preceding <code>echo $?</code>) doesn't terminate its output with <code>\\n</code>, parsing out the exit code will not work.</li>\n</ul>\n"}], "owner": {"reputation": 8181, "user_id": 709223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8eb1671ae3bf4a7536c1aa2c3276779?s=128&d=identicon&r=PG", "display_name": "ekkis", "link": "https://stackoverflow.com/users/709223/ekkis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1207, "favorite_count": 0, "accepted_answer_id": 29376282, "answer_count": 1, "score": 1, "last_activity_date": 1427831785, "creation_date": 1427825421, "last_edit_date": 1531164843, "question_id": 29375503, "link": "https://stackoverflow.com/questions/29375503/macscript-invalid-procedure-call-or-argument", "title": "MacScript Invalid procedure call or argument", "body": "<p>In OSX Excel provides functionality to run Applescript code via the <code>MacScript</code> keyword.  I am running shell code via this functionality and it generally looks like this:</p>\n\n<pre><code>MacScript \"do shell script \"\"/usr/bin/whatever\"\"\"\n</code></pre>\n\n<p>recently I decided I wanted to capture the output (and stderr) because the command was failing and I wanted to see what the error was... so I rewrote it like this:</p>\n\n<pre><code>MacScript \"do shell script \"\"/usr/bin/whatever &gt; /tmp/out 2&gt;&amp;1\"\"\"\n</code></pre>\n\n<p>but I get the error above.  if I run the given command in the AppleScript editor, I get the error:</p>\n\n<blockquote>\n  <p>The command exited with a non-zero status (number: 1)</p>\n</blockquote>\n\n<p>so my question is: how do I trap the return code of <code>MacScript</code> and prevent Excel from breaking?  I tried:</p>\n\n<pre><code>Dim rc As Integer: rc = MacScript(...)\n</code></pre>\n\n<p>but the script still breaks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427822878, "post_id": 29374713, "comment_id": 46930005, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>. Show what you&#39;ve attempted to do, we can help fix it."}, {"owner": {"reputation": 285, "user_id": 4085182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2c126d380f3496750fc50473eae10f2?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/4085182/kinfe"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427823063, "post_id": 29374713, "comment_id": 46930098, "body": "@pnuts Thanks, its for <code>3&#47;26&#47;2015</code>. The time format is excatly like <code>08:13a</code> this and the Date Field format <code>3&#47;26&#47;2015</code>. I think excel considered it as text because of <code>:</code> and letter <code>a</code> so that i can do any mathematical calculation"}], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 4085182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2c126d380f3496750fc50473eae10f2?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/4085182/kinfe"}, "edited": false, "score": 0, "creation_date": 1427824932, "post_id": 29375243, "comment_id": 46931139, "body": "Thank you so much @Gary&#39;s Work like a charm, But is there any way to put the cell range in the formula instead of selecting cells range manually?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 285, "user_id": 4085182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2c126d380f3496750fc50473eae10f2?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/4085182/kinfe"}, "edited": false, "score": 1, "creation_date": 1427825242, "post_id": 29375243, "comment_id": 46931305, "body": "@Keven  see my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1427825215, "last_edit_date": 1427825215, "creation_date": 1427824474, "answer_id": 29375243, "question_id": 29374713, "link": "https://stackoverflow.com/questions/29374713/how-to-remove-the-last-charactor-and-replace-by/29375243#29375243", "title": "How to remove the last charactor and replace `:` by `.`", "body": "<p>if <strong>8:13a</strong> is really 8 hours, 13 minutes, then running:</p>\n\n<pre><code>Sub TimeFixer()\n    For Each r In Selection\n        ary = Split(Mid(r.Text, 1, Len(r.Text) - 1), \":\")\n        r.Value = TimeSerial(ary(0), ary(1), 0)\n        r.NumberFormat = \"hh:mm:ss\"\n    Next r\nEnd Sub\n</code></pre>\n\n<p>will produce a time you can use numerically.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Formula:</p>\n\n<pre><code>=TIMEVALUE(LEFT(A1,LEN(A1)-1))\n</code></pre>\n\n<p>for example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/iUMGG.png\" alt=\"enter image description here\"></p>\n\n<p>Or in the code replace <strong>Selection</strong> with something like <strong>Range(\"A1:A100\")</strong><br><br><em>There are many ways to skin this cat.</em></p>\n"}], "owner": {"reputation": 285, "user_id": 4085182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2c126d380f3496750fc50473eae10f2?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/4085182/kinfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 29375243, "answer_count": 1, "score": -1, "last_activity_date": 1428149657, "creation_date": 1427822686, "last_edit_date": 1428149657, "question_id": 29374713, "link": "https://stackoverflow.com/questions/29374713/how-to-remove-the-last-charactor-and-replace-by", "title": "How to remove the last charactor and replace `:` by `.`", "body": "<p>I have two columns <code>M</code> and <code>U</code> containing employee time record in an Excel sheet but the time format is wrong it is something like <code>08:13a</code>. I want it look like <code>08.13</code> in order to use subtraction formula like <code>=U2-M2</code> to get the difference. so I want to replace <code>:</code> by <code>.</code> and get ride of the last character using Excel VBA.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4735000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10feb4b12c742b0b345b5862e791611?s=128&d=identicon&r=PG&f=1", "display_name": "TheDuckhat", "link": "https://stackoverflow.com/users/4735000/theduckhat"}, "edited": false, "score": 0, "creation_date": 1427911440, "post_id": 29374799, "comment_id": 46971427, "body": "Sorry I am not well versed in VBA, and I just started using it to do things like this. If I want this to work for the entire workbook, and be effective for all of the sheets, would I simply paste this code into the &quot;ThisWorkbook&quot; or sheet under Microsoft Excel Objects?"}, {"owner": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "reply_to_user": {"reputation": 3, "user_id": 4735000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10feb4b12c742b0b345b5862e791611?s=128&d=identicon&r=PG&f=1", "display_name": "TheDuckhat", "link": "https://stackoverflow.com/users/4735000/theduckhat"}, "edited": false, "score": 0, "creation_date": 1427911676, "post_id": 29374799, "comment_id": 46971547, "body": "@TheDuckhat Paste it into your <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192993.aspx\" rel=\"nofollow noreferrer\"><code>Worksheet_BeforeRightClick</code></a>  event."}, {"owner": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "reply_to_user": {"reputation": 3, "user_id": 4735000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10feb4b12c742b0b345b5862e791611?s=128&d=identicon&r=PG&f=1", "display_name": "TheDuckhat", "link": "https://stackoverflow.com/users/4735000/theduckhat"}, "edited": false, "score": 0, "creation_date": 1427913701, "post_id": 29374799, "comment_id": 46972672, "body": "@TheDuckhat Desired behavior?"}, {"owner": {"reputation": 3, "user_id": 4735000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10feb4b12c742b0b345b5862e791611?s=128&d=identicon&r=PG&f=1", "display_name": "TheDuckhat", "link": "https://stackoverflow.com/users/4735000/theduckhat"}, "edited": false, "score": 0, "creation_date": 1428003157, "post_id": 29374799, "comment_id": 47013677, "body": "I was able to use the following in the &quot;ThisWorkbook&quot; section:"}, {"owner": {"reputation": 3, "user_id": 4735000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10feb4b12c742b0b345b5862e791611?s=128&d=identicon&r=PG&f=1", "display_name": "TheDuckhat", "link": "https://stackoverflow.com/users/4735000/theduckhat"}, "edited": false, "score": 0, "creation_date": 1428003162, "post_id": 29374799, "comment_id": 47013680, "body": "Private Sub Workbook_BeforeRightClick()     With Application.CommandBars(&quot;Cell&quot;)             .Controls(&quot;Pick from drop-down list...&quot;).Visible = False     End With     End Sub"}, {"owner": {"reputation": 3, "user_id": 4735000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10feb4b12c742b0b345b5862e791611?s=128&d=identicon&r=PG&f=1", "display_name": "TheDuckhat", "link": "https://stackoverflow.com/users/4735000/theduckhat"}, "edited": false, "score": 0, "creation_date": 1428003886, "post_id": 29374799, "comment_id": 47014064, "body": "It did! I was able to work part of it into another piece of code I had in there so it is active when the workbook opens and goes away once it is closed. I would paste it in here, but I am having trouble how to get it formatted like your code up above."}, {"owner": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "reply_to_user": {"reputation": 3, "user_id": 4735000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10feb4b12c742b0b345b5862e791611?s=128&d=identicon&r=PG&f=1", "display_name": "TheDuckhat", "link": "https://stackoverflow.com/users/4735000/theduckhat"}, "edited": false, "score": 0, "creation_date": 1428004745, "post_id": 29374799, "comment_id": 47014507, "body": "@TheDuckhat no worries, glad I could help :)"}], "tags": [], "owner": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "is_accepted": true, "score": 0, "last_activity_date": 1427892558, "last_edit_date": 1427892558, "creation_date": 1427822973, "answer_id": 29374799, "question_id": 29374667, "link": "https://stackoverflow.com/questions/29374667/prevent-pick-from-drop-down-list-option-in-excel/29374799#29374799", "title": "Prevent Pick from Drop-down List Option in Excel", "body": "<p>Make that given option not visible with:</p>\n\n<pre><code>With Application.CommandBars(\"Cell\")\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0.Controls(\"Pick from drop-down list...\").Visible = False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4735000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10feb4b12c742b0b345b5862e791611?s=128&d=identicon&r=PG&f=1", "display_name": "TheDuckhat", "link": "https://stackoverflow.com/users/4735000/theduckhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 0, "accepted_answer_id": 29374799, "answer_count": 1, "score": 0, "last_activity_date": 1427892558, "creation_date": 1427822565, "question_id": 29374667, "link": "https://stackoverflow.com/questions/29374667/prevent-pick-from-drop-down-list-option-in-excel", "title": "Prevent Pick from Drop-down List Option in Excel", "body": "<p>I have created a form that to be used by my company's employees. One employee noticed that when right clicking on a cell, there is a \"Pick From Drop-down List...\" option in the menu. When using that option it will sometimes show some seemingly random options from elsewhere on the spreadsheet. </p>\n\n<p>How can I prevent that option from appearing in the right click menu? Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427825028, "post_id": 29374463, "comment_id": 46931199, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/7946192/good-algorithm-for-matching-names\">Good algorithm for matching names?</a>"}, {"owner": {"reputation": 11, "user_id": 2375327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a527388caf34c4637ba7e3637816999?s=128&d=identicon&r=PG", "display_name": "manny", "link": "https://stackoverflow.com/users/2375327/manny"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427916638, "post_id": 29374463, "comment_id": 46974291, "body": "Wow... I&#39;m in over my head, but you may be right, I just wouldn&#39;t know how to implement any of that in Excel... Thanks..."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427916862, "post_id": 29374463, "comment_id": 46974413, "body": "I&#39;ve shined a flashlight down that hole, I think there are some VB/VBA sample implementations if you look far enough. I don&#39;t have it any more, but a guy I used to work with implemented the Levenshtein distance algorithm. It was slow to execute, but it wasn&#39;t horribly difficult code. I&#39;ve not done it because I&#39;ve been redirected in another direction for now."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2375327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a527388caf34c4637ba7e3637816999?s=128&d=identicon&r=PG", "display_name": "manny", "link": "https://stackoverflow.com/users/2375327/manny"}, "edited": false, "score": 0, "creation_date": 1427917309, "post_id": 29375401, "comment_id": 46974638, "body": "Yeah, you&#39;re right, it is looking like a very complicated thing I&#39;m looking for... Thanks!..."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1427825104, "last_edit_date": 1495541187, "creation_date": 1427825104, "answer_id": 29375401, "question_id": 29374463, "link": "https://stackoverflow.com/questions/29374463/count-the-same-number-of-characters-between-two-cells-in-excel/29375401#29375401", "title": "Count the same number of characters between two cells in Excel", "body": "<p>Take a look at <a href=\"https://stackoverflow.com/questions/7946192/good-algorithm-for-matching-names\">this question</a>. It's asking about name matching under a different situation, but there are plenty of good examples of how to do it listed there.</p>\n\n<p>It's a pretty deep rabbit hole depending on how intense and in-depth you want to get.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 2375327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a527388caf34c4637ba7e3637816999?s=128&d=identicon&r=PG", "display_name": "manny", "link": "https://stackoverflow.com/users/2375327/manny"}, "edited": false, "score": 0, "creation_date": 1427917265, "post_id": 29376329, "comment_id": 46974615, "body": "Ok, let me try... I do mean that the function would compare the same character in the same position... but I&#39;m counting the space character as a character, too... so that&#39;s why John Doe and John Dowe I count as having 7 characters the same, they both start out with John_Do, if you count the space as a character... By looking at the length of a string and setting up a column beside it which would count the number of characters that are the same, I could set up a ratio which would help me find similar names to look at more closely..."}, {"owner": {"reputation": 11, "user_id": 2375327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a527388caf34c4637ba7e3637816999?s=128&d=identicon&r=PG", "display_name": "manny", "link": "https://stackoverflow.com/users/2375327/manny"}, "edited": false, "score": 0, "creation_date": 1428027429, "post_id": 29376329, "comment_id": 47021935, "body": "Wow! I&#39;m impressed, but I must be doing something wrong. I was anxious to try this out but I can&#39;t figure out why it won&#39;t work for me. I&#39;m new at this, though, so let me ask you a couple of dumb questions. I inserted this into a &#39;Module&#39; in Excel, then I tried to use the formula compareCells() by inserting BG116 within the parentheses, because that was my test cell. BG116 has cells on top and below it but I&#39;m getting a #VALUE! error. The cell above BG116 has a name that begins with Tom_ and so does BG116. I know I must be doing something wrong... What should I be doing?... Thanks again..."}, {"owner": {"reputation": 34, "user_id": 4032909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Td7e7.gif?s=128&g=1", "display_name": "FancyGamer", "link": "https://stackoverflow.com/users/4032909/fancygamer"}, "reply_to_user": {"reputation": 11, "user_id": 2375327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a527388caf34c4637ba7e3637816999?s=128&d=identicon&r=PG", "display_name": "manny", "link": "https://stackoverflow.com/users/2375327/manny"}, "edited": false, "score": 0, "creation_date": 1428033676, "post_id": 29376329, "comment_id": 47023010, "body": "I think I know where the problem is. I gave names to my worksheets, and you didn&#39;t. I have now updated the code. See my EDIT #2. The error will be gone."}], "tags": [], "owner": {"reputation": 34, "user_id": 4032909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Td7e7.gif?s=128&g=1", "display_name": "FancyGamer", "link": "https://stackoverflow.com/users/4032909/fancygamer"}, "is_accepted": false, "score": 0, "last_activity_date": 1428033790, "last_edit_date": 1428033790, "creation_date": 1427828133, "answer_id": 29376329, "question_id": 29374463, "link": "https://stackoverflow.com/questions/29374463/count-the-same-number-of-characters-between-two-cells-in-excel/29376329#29376329", "title": "Count the same number of characters between two cells in Excel", "body": "<p><strong>You are NOT giving us enough info.</strong></p>\n\n<p>In your case, A1 (\"John Doe\") contains two \"o\" characters. Because of that, the cell below, A2 (\"John Dowe\") will have only 6 characters in common.</p>\n\n<p><strong>IF</strong> what you mean by \"same character\" is same character in the same position, then you still have got a problem, between A1 and A2.</p>\n\n<p>John Do<strong>e</strong><br>\nJohn Do<strong>w</strong>e</p>\n\n<p>\"w\" and \"e\" don't match. Only 6 characters is same.</p>\n\n<p><strong>Provides us more info!</strong></p>\n\n<p><strong>EDIT #1</strong><br>\nCopy and paste this code in the Module</p>\n\n<pre><code>Function compareCells(ran As Range) As Variant\nDim numSame As Integer\n\nDim c As Integer\nDim r As Integer\nc = ran.Column  'find selected column\nr = ran.Row     'find selected row\n\nDim a As String\nDim b As String\na = Worksheets(\"Ark1\").Cells(r - 1, c).Value    'string of the cell above\nb = Worksheets(\"Ark1\").Cells(r, c).Value        'string of the current cell\n\nDim aLen As Integer\naLen = Len(a)      'check the length of the a string\n\n\nDim i As Integer\nFor i = 1 To aLen\n    If Mid(a, i, 1) = Mid(b, i, 1) Then 'if chars in same pos are equal...\n        numSame = numSame + 1\n    End If\nNext\n\ncompareCells = numSame\n\nEnd Function\n</code></pre>\n\n<p><strong>EDIT #2</strong></p>\n\n<pre><code>Function compareCells(ran As Range) As Variant\nDim numSame As Integer\n\nDim c As Integer\nDim r As Integer\nc = ran.Column  'find selected column\nr = ran.Row     'find selected row\n\nDim a As String\nDim b As String\na = ActiveSheet.Cells(r - 1, c).Value    'string of the cell above\nb = ActiveSheet.Cells(r, c).Value        'string of the current cell\n\nDim aLen As Integer\naLen = Len(a)      'check the length of the a string\n\n\nDim i As Integer\nFor i = 1 To aLen\n    If Mid(a, i, 1) = Mid(b, i, 1) Then 'if chars in same pos are equal...\n        numSame = numSame + 1\n    End If\nNext\n\ncompareCells = numSame\n\nEnd Function\n</code></pre>\n\n<p>Use <code>=compareCells()</code> and select <em>only</em> the cell you want to compare with the cell above</p>\n"}], "owner": {"reputation": 11, "user_id": 2375327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a527388caf34c4637ba7e3637816999?s=128&d=identicon&r=PG", "display_name": "manny", "link": "https://stackoverflow.com/users/2375327/manny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1815, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428033790, "creation_date": 1427821820, "last_edit_date": 1531164843, "question_id": 29374463, "link": "https://stackoverflow.com/questions/29374463/count-the-same-number-of-characters-between-two-cells-in-excel", "title": "Count the same number of characters between two cells in Excel", "body": "<p>I'm pretty new, not a first time user, but maybe been here once before. </p>\n\n<p>I have a huge list of names to check if they have duplicates.</p>\n\n<p>The problems is that sometimes the same name is spelled differently for the same person in the list.</p>\n\n<p>So, I'd like to check the first letters of a cell to see if they are the same.</p>\n\n<p>For example, here's a made-up list:</p>\n\n<pre><code> A1 John Doe\n A2 John Dowe\n A3 John Dove\n</code></pre>\n\n<p>Is there an Excel function I can use that will tell me how many characters are the same from the cell above it?</p>\n\n<p>So, in the example above the cells where the formula would be, would display:</p>\n\n<pre><code>A1 John Doe B1 0 (or \"NA\" or \"REF\" because there's no cell to compare to above it)\n A2 John Dowe B2 7 \n A3 John Dove B3 7\n</code></pre>\n\n<p>Because both A2 and A3 share 7 characters with the cell above them... I hope this is easy to understand.</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 110, "user_id": 4695744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-ZWK1GNVm3VE/AAAAAAAAAAI/AAAAAAAAIzA/W3kd_AxFWMQ/photo.jpg?sz=128", "display_name": "Anurag Singh", "link": "https://stackoverflow.com/users/4695744/anurag-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1427824668, "creation_date": 1427824668, "answer_id": 29375311, "question_id": 29373967, "link": "https://stackoverflow.com/questions/29373967/paste-value-of-cell-below-if-cell-below-is-non-blank/29375311#29375311", "title": "paste value of cell below if cell below is non blank", "body": "<p>Just use this function, make sure to input your range in the function. For example if you use the function and input C1 the function will copy value from C2 as I am increasing the row by one. Hope this helps.</p>\n\n<pre><code>Public Function CopyBelowCell(rng As Range) As Variant\n\nDim rw As Long\nDim col As Long\n\nrw = rng.Row\ncol = rng.Column\n\nCopyBelowCell = Cells(rw + 1, col)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4640742, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PTGF4aIu54s/AAAAAAAAAAI/AAAAAAAAAIM/cpjJ0IzDT7I/photo.jpg?sz=128", "display_name": "Jon mark", "link": "https://stackoverflow.com/users/4640742/jon-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1427824668, "creation_date": 1427820212, "last_edit_date": 1531161705, "question_id": 29373967, "link": "https://stackoverflow.com/questions/29373967/paste-value-of-cell-below-if-cell-below-is-non-blank", "title": "paste value of cell below if cell below is non blank", "body": "<p>I really need to paste value without the clipboard the cell below the cell where I enter the UDF. </p>\n\n<p>For example with the below code</p>\n\n<pre><code>Function macropastec5() As Variant\nmacropastec5 = Sheets(\"Sheet1\").Range(\"H7\").Value\nEnd Function\n</code></pre>\n\n<p>if I was to enter into cell <code>H6</code> =macropastec5()</p>\n\n<p>so how would I use this in any cell to get the cell below it?</p>\n\n<p>I need someting like</p>\n\n<pre><code> Function macropastec5( the cell I'd enter in excel formula bar  ) As Variant\nmacropastec5 = Sheets(\"Sheet1\").Range(\" the cell below where I enter in formula bar\").Value\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "syntax"], "comments": [{"owner": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "edited": false, "score": 1, "creation_date": 1427820139, "post_id": 29373923, "comment_id": 46928335, "body": "You have a space after <code>Add</code>."}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "edited": false, "score": 0, "creation_date": 1427820207, "post_id": 29373923, "comment_id": 46928379, "body": "I just tested it without that space, :( same result"}], "answers": [{"tags": [], "owner": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "is_accepted": true, "score": 3, "last_activity_date": 1427820869, "last_edit_date": 1427820869, "creation_date": 1427820293, "answer_id": 29373990, "question_id": 29373923, "link": "https://stackoverflow.com/questions/29373923/vba-strange-syntax/29373990#29373990", "title": "VBA Strange syntax", "body": "<p>It is because your code doesn't know what <code>Tranasitions</code> is, you have a typo in the declaration (the <code>Dim</code> line).</p>\n\n<p>So to fix it, fix the declaration:</p>\n\n<pre><code>Dim Transitions as Collection\n</code></pre>\n\n<p>And then remove the <code>()</code> from the call, you don't use them with subs in VBA (unless you put <code>Call</code> in front):</p>\n\n<pre><code>Transitions.Add value, key\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1427820645, "post_id": 29374068, "comment_id": 46928685, "body": "Minus one? I&#39;m correct here. Been doing this for years"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1427820851, "post_id": 29374068, "comment_id": 46928817, "body": "<code>Call</code> is an obsolete keyword from an ancient version of the language."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1427820903, "post_id": 29374068, "comment_id": 46928849, "body": "Actually not. The behaviour is very subtley different. Google it."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1427820964, "post_id": 29374068, "comment_id": 46928885, "body": "I understand the difference @Bathsheba."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1427822712, "post_id": 29374068, "comment_id": 46929924, "body": "People still use <code>Call</code> in VBA, and I don&#39;t see it&#39;s worth a downvote."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1427821485, "last_edit_date": 1427821485, "creation_date": 1427820517, "answer_id": 29374068, "question_id": 29373923, "link": "https://stackoverflow.com/questions/29373923/vba-strange-syntax/29374068#29374068", "title": "VBA Strange syntax", "body": "<p>Firstly, refer to the collection using a consistent name. </p>\n\n<p>Then, use <code>Call Transitions.Add</code> etc. or drop the brackets. </p>\n\n<p>Vba has this arcane calling syntax.</p>\n"}, {"tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 0, "last_activity_date": 1427820542, "creation_date": 1427820542, "answer_id": 29374074, "question_id": 29373923, "link": "https://stackoverflow.com/questions/29373923/vba-strange-syntax/29374074#29374074", "title": "VBA Strange syntax", "body": "<p>Remove the parenthesis.</p>\n\n<pre><code>Sub Set_Params(key As String, value As Variant)\n    Dim Transitions as New Collection\n    Transitions.Add value, key\nEnd Sub\n</code></pre>\n\n<p>Also, you have to actually create a new instance of Transitions. \nOh, and you spelled <code>Transitions</code> as <code>Tranasitions</code> when you declared it. Turn <code>Option Explicit</code> on so that doesn't happen anymore.</p>\n"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1427821033, "accepted_answer_id": 29373990, "answer_count": 3, "score": 1, "last_activity_date": 1427821485, "creation_date": 1427820063, "question_id": 29373923, "link": "https://stackoverflow.com/questions/29373923/vba-strange-syntax", "closed_reason": "Duplicate", "title": "VBA Strange syntax", "body": "<p>See bellow VBE tells it expects an \"=\" on line 3 inspite of the fact that <code>.Add</code> is a Sub, I don't understant why?</p>\n\n<pre><code>1  Sub Set_Params(key As String, value As Variant)\n2      Dim Tranasitions as Collection\n3      Transitions.Add (value, key)\n4  End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427822449, "post_id": 29373904, "comment_id": 46929770, "body": "Scott, thank you, it is my first time here, I did not know how to edit this."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427822316, "post_id": 29374138, "comment_id": 46929701, "body": "I can try this, but my suppliers have specific names instead of letters, that was just an example, that they are not months. For example: you can say, my supplier names are Colgate, pepsodent, toyota, mahindra, etc. I have 18 different names."}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427822522, "post_id": 29374138, "comment_id": 46929808, "body": "I just added the &quot;With&quot; and &quot;End With&quot; to my code, it ran through one cycle and when I debug it, hovering over Sheets(Supplier), shows me the name of my second supplier, but still for some reason the code does not want to run."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427822697, "post_id": 29374138, "comment_id": 46929916, "body": "<b>You must make absolutely certain that the set of names in the Array matches the Tab names.</b>  There should be no extra spaces and the upper/lower case must exactly match."}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427823037, "post_id": 29374138, "comment_id": 46930079, "body": "That is a great point, I checked and found some discrepancies. But, even now when I run the code, it only runs macro on activesheet but this time it does not stop by itself it just takes a little delay, but functions only once. When I do run it break points in, and re-run it again and again, the supplier seems to be taking up the next names from arrays, but still updates are not happening unless I am on that particular sheet and then running the macro."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427823288, "post_id": 29374138, "comment_id": 46930227, "body": "I understand............please notice in my <i>template</i> code there is a <b>dot</b> at the beginning of the <b>Range</b> statement...........you need these <b>dot</b>s  in front of any <b>Range()</b> or <b>Cells()</b> code you have...........it is the <b>dot</b>s that make the loop work!!"}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427823372, "post_id": 29374138, "comment_id": 46930267, "body": "But I thought that code is only functional if my names are alphabets, but they are not. Should I still include that in my code? If it is to be included, where is my code supposed to go?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427823605, "post_id": 29374138, "comment_id": 46930412, "body": "YES........the <b>With</b> statement causes something like <b>.Range(&quot;A1&quot;)</b> to be interpreted as <b>Sheets(&quot;toyota&quot;).Range(&quot;A1&quot;)</b>"}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427823833, "post_id": 29374138, "comment_id": 46930539, "body": "Okay, so I ran the code as suggested by you, every worksheet is getting &quot;qwerty&quot; in A1, but still the macro is only processed on the activesheet. I am sorry if I might be doing something fundamentally wrong, but this is the scenario. My code is okay, I know that, since it runs successfully on one sheet, I just dont understand why it won&#39;t loop."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427824030, "post_id": 29374138, "comment_id": 46930644, "body": "I must leave the office soon.............I am sure you are nearly 95% there.......If you post more of your <i>actual code</i>, we can complete this later."}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427824479, "post_id": 29374138, "comment_id": 46930888, "body": "I should not post it here as it is public, I can put my code in generic terms, I cannot disclose some specific names. But thank you so much for your help so far. I can post the generic code here."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427824553, "post_id": 29374138, "comment_id": 46930930, "body": "Excellent............post a simple generic extract that fails for you and we will fix that!!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1427820719, "creation_date": 1427820719, "answer_id": 29374138, "question_id": 29373904, "link": "https://stackoverflow.com/questions/29373904/i-modified-the-code-i-have-suppliers-as-sheet-names-but-it-seems-to-not-run-my/29374138#29374138", "title": "I modified the code, I have suppliers as sheet names, but it seems to not run my code through all the sheets", "body": "<p>Here is a template to use if your tabs are \"lettered\"</p>\n\n<pre><code>Sub LoopThroughSheets()\n    Dim Suppliers As Variant, Supplier As Variant\n    Suppliers = Array(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\")\n    For Each Supplier In Suppliers\n        With Sheets(Supplier)\n            .Range(\"A1\").Value = \"qwerty\"\n        End With\n    Next Supplier\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1427824760, "post_id": 29375313, "comment_id": 46931050, "body": "Okay so my answer again came in a very bad format, I am not sure what is the issue but that I can figure out later. My code is very repetitive here, but seems to work. The only issue as I have mentioned is, the whole code after running once, does not run again for next sheet."}, {"owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 0, "creation_date": 1427847605, "post_id": 29375313, "comment_id": 46941229, "body": "The simplest fix is to add an <code>.Activate</code> on the line after the <code>With</code>. That will ensure that the <code>Range</code> uses target the right sheet. Range always targets the most general thing it can, so <code>Range</code> on it&#39;s own targets the active sheet, <code>Sheets(1).Range</code> targets the first worksheet and <code>Sheets(1).Columns(1).Range</code>... you get the idea. This is true of a LOT of VBA functions, which is why you see such heavy use of with (which basically says &quot;any time you see a dot as though we&#39;re half way through something, prepend with this object)"}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "reply_to_user": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "edited": false, "score": 0, "creation_date": 1427890674, "post_id": 29375313, "comment_id": 46958339, "body": "@tobriand: that thing worked like a magic. Also, I appreciate you explaining me the reasoning behind it, that would definitely help me in my future endeavors with vba. Thank you so much!"}], "tags": [], "owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1427829960, "last_edit_date": 1427829960, "creation_date": 1427824676, "answer_id": 29375313, "question_id": 29373904, "link": "https://stackoverflow.com/questions/29373904/i-modified-the-code-i-have-suppliers-as-sheet-names-but-it-seems-to-not-run-my/29375313#29375313", "title": "I modified the code, I have suppliers as sheet names, but it seems to not run my code through all the sheets", "body": "<pre><code>Sub RefreshFormulas2()\n'\n' RefreshFormulas2 Macro\n'\n' Sub LoopThroughSheets()\n\nDim Suppliers As Variant\nDim Supplier As Variant\nDim rng As Range\nDim UnusedColumn As Range\n\nApplication.ScreenUpdating = False\n\nSuppliers = Array(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\")\n\nFor Each Supplier In Suppliers\n  With Sheets(Supplier)\n    .Range(\"A1\").Value = \"\"\n    'PURPOSE: Selects only cells with values or formulas and excludes blank values (ie =\"\" or +\"\")\n    Range(\"AG4\").Select\n    Selection.Copy\n    Set rng = Range(\"C4:C100\")\n    'Find a column with nothing in it\n    Set UnusedColumn = Cells.Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious).EntireColumn.Offset(0, 1)\n   'Create temporary calculation column to determine which cells to select (marked by an X)\n    Intersect(rng.EntireRow, UnusedColumn) = Evaluate(\"IF(\" &amp; rng.Address &amp; \"=\"\"\"\",\"\"\"\",\"\"X\"\")\")\n\n    'Make Selection\n    Intersect(UnusedColumn.SpecialCells(xlConstants).EntireRow, rng.EntireColumn).Select\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n    'Remove Temporary Blank Caluclations\n    UnusedColumn.Clear\n    Range(\"AI4\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Set rng = Range(\"E4:E100\")\n\n    'Find a column with nothing in it\n    Set UnusedColumn = Cells.Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious).EntireColumn.Offset(0, 1)\n\n    'Create temporary calculation column to determine which cells to select (marked by an X)\n    Intersect(rng.EntireRow, UnusedColumn) = Evaluate(\"IF(\" &amp; rng.Address &amp; \"=\"\"\"\",\"\"\"\",\"\"X\"\")\")\n\n    'Make Selection\n    Intersect(UnusedColumn.SpecialCells(xlConstants).EntireRow, rng.EntireColumn).Select\n\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n              SkipBlanks:=False, Transpose:=False\n    'Remove Temporary Blank Caluclations\n    UnusedColumn.Clear\n\n    Range(\"AJ4\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n\n    Set rng = Range(\"F4:F100\")\n\n    'Find a column with nothing in it\n    Set UnusedColumn = Cells.Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious).EntireColumn.Offset(0, 1)\n\n    'Create temporary calculation column to determine which cells to select (marked by an X)\n    Intersect(rng.EntireRow, UnusedColumn) = Evaluate(\"IF(\" &amp; rng.Address &amp; \"=\"\"\"\",\"\"\"\",\"\"X\"\")\")\n\n    'Make Selection\n    Intersect(UnusedColumn.SpecialCells(xlConstants).EntireRow, rng.EntireColumn).Select\n\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n              SkipBlanks:=False, Transpose:=False\n    'Remove Temporary Blank Caluclations\n    UnusedColumn.Clear\n\n    Range(\"AK4\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n\n    Set rng = Range(\"G4:G100\")\n\n    'Find a column with nothing in it\n    Set UnusedColumn = Cells.Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious).EntireColumn.Offset(0, 1)\n\n    'Create temporary calculation column to determine which cells to select (marked by an X)\n    Intersect(rng.EntireRow, UnusedColumn) = Evaluate(\"IF(\" &amp; rng.Address &amp; \"=\"\"\"\",\"\"\"\",\"\"X\"\")\")\n\n    'Make Selection\n    Intersect(UnusedColumn.SpecialCells(xlConstants).EntireRow, rng.EntireColumn).Select\n\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n    'Remove Temporary Blank Caluclations\n    UnusedColumn.Clear\n\n    Range(\"AL4\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n\n    Set rng = Range(\"H4:H100\")\n\n    'Find a column with nothing in it\n    Set UnusedColumn = Cells.Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious).EntireColumn.Offset(0, 1)\n\n    'Create temporary calculation column to determine which cells to select (marked by an X)\n    Intersect(rng.EntireRow, UnusedColumn) = Evaluate(\"IF(\" &amp; rng.Address &amp; \"=\"\"\"\",\"\"\"\",\"\"X\"\")\")\n\n    'Make Selection\n    Intersect(UnusedColumn.SpecialCells(xlConstants).EntireRow, rng.EntireColumn).Select\n\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n    'Remove Temporary Blank Caluclations\n    UnusedColumn.Clear\n\n    Range(\"AN4\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Set rng = Range(\"J4:J100\")\n\n    'Find a column with nothing in it\n    Set UnusedColumn = Cells.Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious).EntireColumn.Offset(0, 1)\n\n    'Create temporary calculation column to determine which cells to select (marked by an X)\n    Intersect(rng.EntireRow, UnusedColumn) = Evaluate(\"IF(\" &amp; rng.Address &amp; \"=\"\"\"\",\"\"\"\",\"\"X\"\")\")\n\n    'Make Selection\n    Intersect(UnusedColumn.SpecialCells(xlConstants).EntireRow, rng.EntireColumn).Select\n    ActiveSheet.Paste\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n    'Remove Temporary Blank Caluclations\n    UnusedColumn.Clear\n    ActiveSheet.Range(\"I4:I95\").ClearContents\n\n    ActiveSheet.Range(\"K5\").Select\n    Application.CutCopyMode = False\n  End With\n\nNext Supplier\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 29374138, "answer_count": 2, "score": 0, "last_activity_date": 1427829960, "creation_date": 1427819976, "last_edit_date": 1531164843, "question_id": 29373904, "link": "https://stackoverflow.com/questions/29373904/i-modified-the-code-i-have-suppliers-as-sheet-names-but-it-seems-to-not-run-my", "title": "I modified the code, I have suppliers as sheet names, but it seems to not run my code through all the sheets", "body": "<p><strong>Original Code:</strong></p>\n\n<pre><code>Sub LoopThroughSheets()\n\nDim Months As Variant\nDim Month As Variant\n\nMonths = Array(\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", _\n         \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\")\n\nFor Each Month In Months\n    'Code goes here.\nNext Month\n\nEnd Sub\n</code></pre>\n\n<p><strong>Modified Code:</strong></p>\n\n<pre><code>Sub LoopThroughSheets()\n\nDim Suppliers As Variant\nDim Supplier As Variant\n\nSuppliers = Array(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", _\n         \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\")\n\nFor Each Supplier In Suppliers\n    'Code goes here.\nNext Supplier\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "email", "excel", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1427819150, "post_id": 29373438, "comment_id": 46927748, "body": "show your current code"}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 1130306, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f3331abbf37669b5b85b4a92695020e?s=128&d=identicon&r=PG", "display_name": "user1130306", "link": "https://stackoverflow.com/users/1130306/user1130306"}, "edited": false, "score": 0, "creation_date": 1427820230, "post_id": 29373628, "comment_id": 46928394, "body": "Thanks everyone.  I was able to accomplish what I was trying to do with this &quot;String Concentate&quot; fuction I found here: <a href=\"http://www.cpearson.com/excel/stringconcatenation.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/stringconcatenation.aspx</a>  But your solutions are much for straightforward. Thanks!"}], "tags": [], "owner": {"reputation": 19, "user_id": 4730916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ri7MY.png?s=128&g=1", "display_name": "Ina gurey", "link": "https://stackoverflow.com/users/4730916/ina-gurey"}, "is_accepted": false, "score": 1, "last_activity_date": 1427819565, "last_edit_date": 1427819565, "creation_date": 1427819207, "answer_id": 29373628, "question_id": 29373438, "link": "https://stackoverflow.com/questions/29373438/excel-vba-array-of-strings-to-outlook-email-to-field/29373628#29373628", "title": "Excel VBA array of strings to Outlook email &quot;To&quot; field", "body": "<p>This might help but the concept is bit different as to the items. Hope this helps out- have used in the past for similar case but ofcourse, will only provide maproad. </p>\n\n<pre><code>Sub CreateMail()\n\nDim objOutlook As Object\nDim objMail As Object\nDim rngTo As Range\nDim rngCc As Range\nDim rngSubject As Range\nDim rngBody As Range\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objMail = objOutlook.CreateItem(0)\n\nWith ActiveSheet\n    Set rngTo = .Range(\"B1\")\n    Set rngCc = .Range(\"B2\")\n    Set rngSubject = .Range(\"B3\")\n    Set rngBody = .Range(.Range(\"B4\"), .Range(\"B4\").End(xlDown))\nEnd With\nrngBody.Copy\n\nWith objMail\n    .To = rngTo.Value\n    .Cc = rngCc.Value\n    .Subject = rngSubject.Value\n    .Display\nEnd With\nSendKeys \"^({v})\", True\n\nSet objOutlook = Nothing\nSet objMail = Nothing\nSet rngTo = Nothing\nSet rngCc = Nothing\nSet rngSubject = Nothing\nSet rngBody = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1427819403, "creation_date": 1427819403, "answer_id": 29373701, "question_id": 29373438, "link": "https://stackoverflow.com/questions/29373438/excel-vba-array-of-strings-to-outlook-email-to-field/29373701#29373701", "title": "Excel VBA array of strings to Outlook email &quot;To&quot; field", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865320(v=office.15).aspx\" rel=\"nofollow\">Recipients</a> property of the MailItem class for adding multiple recipients. It also allows to specify the type of the Recipient: To, CC or BCC.</p>\n\n<pre><code>Sub CreateStatusReportToBoss()  \n  Dim myItem As Outlook.MailItem  \n  Dim myRecipient As Outlook.Recipient  \n  Set myItem = Application.CreateItem(olMailItem)  \n  Set myRecipient = myItem.Recipients.Add(\"Dan Wilson\")  \n  myItem.Subject = \"Status Report\"  \n  myItem.Display  \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1225, "user_id": 2538157, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cf9242f898b064281d11f5a9bddd6da9?s=128&d=identicon&r=PG", "display_name": "User5590", "link": "https://stackoverflow.com/users/2538157/user5590"}, "edited": false, "score": 0, "creation_date": 1437453475, "post_id": 29373785, "comment_id": 51021645, "body": "I have added Microsoft Outlook 15 reference, then also I am getting error &quot;Object doesn&#39;t support type or method&quot; in line no 3 (CreateItem)."}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 1, "last_activity_date": 1427819655, "creation_date": 1427819655, "answer_id": 29373785, "question_id": 29373438, "link": "https://stackoverflow.com/questions/29373438/excel-vba-array-of-strings-to-outlook-email-to-field/29373785#29373785", "title": "Excel VBA array of strings to Outlook email &quot;To&quot; field", "body": "<p>This is based on Eugene's answer, edited to include the excel implementation</p>\n\n<pre><code>Sub CreateStatusReportToBoss(addRng as Excel.Range)  \n  Dim myItem As Outlook.MailItem  \n  Dim myRecipient As Outlook.Recipient  \n  Set myItem = Application.CreateItem(olMailItem)\n  For Each cell in addRng\n     Set myRecipient = myItem.Recipients.Add(cell.Value)\n  Next cell  \n  myItem.Subject = \"Status Report\"  \n  myItem.Display  \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 1130306, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f3331abbf37669b5b85b4a92695020e?s=128&d=identicon&r=PG", "display_name": "user1130306", "link": "https://stackoverflow.com/users/1130306/user1130306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3280, "favorite_count": 0, "accepted_answer_id": 29373785, "answer_count": 3, "score": 1, "last_activity_date": 1427819655, "creation_date": 1427818543, "question_id": 29373438, "link": "https://stackoverflow.com/questions/29373438/excel-vba-array-of-strings-to-outlook-email-to-field", "title": "Excel VBA array of strings to Outlook email &quot;To&quot; field", "body": "<p>I am trying to create a macro that will take a column of email addresses from my Excel sheet and populate the \"To\" field in an Outlook email.  I have the basics working, and I am able to create a new Outlook email message with the various field values I have specified - however, I cannot figure out how to populate multiple email addresses into the \"To\" field, for a single email.</p>\n\n<p>As of right now, I am able to create an array with all of the desired email addresses, but can't figure out how to populate the array values into the Outlook \"To\" field.</p>\n"}, {"tags": ["vba", "excel", "nested-if"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427817984, "post_id": 29372989, "comment_id": 46926996, "body": "Please revise with code formatting..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427818308, "post_id": 29372989, "comment_id": 46927221, "body": "Also, indicate in which cell you&#39;re trying to paste this formula."}, {"owner": {"reputation": 23, "user_id": 4734618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d6d91c06b4382334c399149e24e9d5b?s=128&d=identicon&r=PG&f=1", "display_name": "Omega73", "link": "https://stackoverflow.com/users/4734618/omega73"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427876263, "post_id": 29372989, "comment_id": 46950060, "body": "Sorry, I didn&#39;t know how to sort the formatting (it&#39;s my first post), but thanks to whoever did fix it."}, {"owner": {"reputation": 23, "user_id": 4734618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d6d91c06b4382334c399149e24e9d5b?s=128&d=identicon&r=PG&f=1", "display_name": "Omega73", "link": "https://stackoverflow.com/users/4734618/omega73"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427876422, "post_id": 29372989, "comment_id": 46950141, "body": "It shouldn&#39;t matter which cell the formula goes into, it&#39;s the process of doing it by VBA that is the problem.  I&#39;m intending to place the formula in a column with 1,000s of rows of data."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1427891061, "post_id": 29372989, "comment_id": 46958581, "body": "Oh but it does matter because of the offsets, a formula could refer to invalid ranges,etc. Fwiw, I enter the formula and it errors in any cell so the issue would seem to be with the formyla string itself. Anyways, it looks like you&#39;ve got a solution already, cheers."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4734618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d6d91c06b4382334c399149e24e9d5b?s=128&d=identicon&r=PG&f=1", "display_name": "Omega73", "link": "https://stackoverflow.com/users/4734618/omega73"}, "edited": false, "score": 0, "creation_date": 1427876864, "post_id": 29373591, "comment_id": 46950355, "body": "Thank you for this little gem, it works perfectly!!!  It&#39;s also reassurring to know that I was barking up the right tree when I was trying to assign it to a string and replace the double quotation marks.    This is certainly an effective migraine relief :)    Many thanks for taking the time to look at this."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1427819105, "creation_date": 1427819105, "answer_id": 29373591, "question_id": 29372989, "link": "https://stackoverflow.com/questions/29372989/long-nested-if-statement-creates-runtime-error-1004-in-excel-vba/29373591#29373591", "title": "Long nested IF statement creates runtime error 1004 in Excel VBA", "body": "<p>Consider:</p>\n\n<pre><code>Sub EvilFormula()\n    Dim st As String, DQ As String\n    DQ = Chr(34) &amp; Chr(34)\n    st = \"=IF(AND(I2=~,J2=~,K2=~,L2=~),~,IF(AND(G2=~,H2=~,K2=~,L2=~),~,IF(AND(G2=~,H2=~,I2=~,J2=~),~,IF(AND(H2&lt;&gt;~,I2&lt;&gt;~,J2&lt;&gt;~,K2&lt;&gt;~),IF(NETWORKDAYS(H2,I2)-2+NETWORKDAYS(J2,K2)-2&lt;1,~,NETWORKDAYS(H2,I2)-2+NETWORKDAYS(J2,K2)-2),IF(AND(H2&lt;&gt;~,I2&lt;&gt;~),IF(NETWORKDAYS(H2,I2)-2&lt;1,~,NETWORKDAYS(H2,I2)-2),IF(AND(H2&lt;&gt;~,K2&lt;&gt;~),IF(NETWORKDAYS(H2,K2)-2&lt;1,~,NETWORKDAYS(H2,K2)-2),IF(AND(J2&lt;&gt;~,K2&lt;&gt;~),IF(NETWORKDAYS(J2,K2)-2&lt;1,~,NETWORKDAYS(J2,K2)-2),~)))))))\"\n    st = Replace(st, \"~\", DQ)\n    ActiveCell.Formula = st\nEnd Sub\n</code></pre>\n\n<p>Here we first construct a <em>String</em> that represents the formula, but uses <em>tildas</em> in place of <strong>pairs</strong> of double-quotes.  We replace the tildas and deposit the formula.<br><br><em>I use this to avoid migraine headaches.</em></p>\n"}], "owner": {"reputation": 23, "user_id": 4734618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d6d91c06b4382334c399149e24e9d5b?s=128&d=identicon&r=PG&f=1", "display_name": "Omega73", "link": "https://stackoverflow.com/users/4734618/omega73"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 1, "accepted_answer_id": 29373591, "answer_count": 1, "score": 0, "last_activity_date": 1428148847, "creation_date": 1427817287, "last_edit_date": 1428148847, "question_id": 29372989, "link": "https://stackoverflow.com/questions/29372989/long-nested-if-statement-creates-runtime-error-1004-in-excel-vba", "title": "Long nested IF statement creates runtime error 1004 in Excel VBA", "body": "<p>I have a formula that works perfectly well in a spreadsheet, but when I try to automate the creation of the formula using VBA, I get the 1004 run time error.  </p>\n\n<p>I have a 3 stage process, each with a start and finish date (so 6 separate date columns). This formula looks at the series dates and calculates the time lost between each stage using the NETWORKDAYS function.  </p>\n\n<p>I thought the simple way to overcome this problem was to record a macro of me pasting this formula into a cell, which would generate the required VBA code that I could then adapt, but even using this method causes the 1004 error.</p>\n\n<p>I'm wondering whether it's the length of the formula that's the problem?  I've tried replacing the double quotation marks with <code>&amp; Chr(34) &amp; Chr(34) &amp;</code> and I've tried assigning the formula to a variable. I can get it to work if I add it as text using .value instead of .formulaR1C1, or if I add an apostrophe to the start of the formula string. It appears to be the fact that its a formula that causes the problem. Any help is greatly appreciated.</p>\n\n<p>The formula from the cell in the spreadsheet:</p>\n\n<pre><code>=IF(AND(I2=\"\",J2=\"\",K2=\"\",L2=\"\"),\"\",IF(AND(G2=\"\",H2=\"\",K2=\"\",L2=\"\"),\"\",IF(AND(G2=\"\",H2=\"\",I2=\"\",J2=\"\"),\"\",IF(AND(H2&lt;&gt;\"\",I2&lt;&gt;\"\",J2&lt;&gt;\"\",K2&lt;&gt;\"\"),IF(NETWORKDAYS(H2,I2)-2+NETWORKDAYS(J2,K2)-2&lt;1,\"\",NETWORKDAYS(H2,I2)-2+NETWORKDAYS(J2,K2)-2),IF(AND(H2&lt;&gt;\"\",I2&lt;&gt;\"\"),IF(NETWORKDAYS(H2,I2)-2&lt;1,\"\",NETWORKDAYS(H2,I2)-2),IF(AND(H2&lt;&gt;\"\",K2&lt;&gt;\"\"),IF(NETWORKDAYS(H2,K2)-2&lt;1,\"\",NETWORKDAYS(H2,K2)-2),IF(AND(J2&lt;&gt;\"\",K2&lt;&gt;\"\"),IF(NETWORKDAYS(J2,K2)-2&lt;1,\"\",NETWORKDAYS(J2,K2)-2),\"\")))))))\n</code></pre>\n\n<p>The code that the macro records when I enter the formula into the cell:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n        \"=IF(AND(RC[-10]=\"\"\"\",RC[-9]=\"\"\"\",RC[-8]=\"\"\"\",RC[-7]=\"\"\"\"),\"\"\"\",IF(AND(RC[-12]=\"\"\"\",RC[-11]=\"\"\"\",RC[-8]=\"\"\"\",RC[-7]=\"\"\"\"),\"\"\"\",IF(AND(RC[-12]=\"\"\"\",RC[-11]=\"\"\"\",RC[-10]=\"\"\"\",RC[-9]=\"\"\"\"),\"\"\"\",IF(AND(RC[-11]&lt;&gt;\"\"\"\",RC[-10]&lt;&gt;\"\"\"\",RC[-9]&lt;&gt;\"\"\"\",RC[-8]&lt;&gt;\"\"\"\"),IF(NETWORKDAYS(RC[-11],RC[-10])-2+NETWORKDAYS(RC[-9],RC[-8])-2&lt;1,\"\"\"\",NETWORKDAYS(RC[-11],RC[-10])-2+NETWORKDAYS(RC[\" &amp; _\n        \"8])-2),IF(AND(RC[-11]&lt;&gt;\"\"\"\",RC[-10]&lt;&gt;\"\"\"\"),IF(NETWORKDAYS(RC[-11],RC[-10])-2&lt;1,\"\"\"\",NETWORKDAYS(RC[-11],RC[-10])-2),IF(AND(RC[-11]&lt;&gt;\"\"\"\",RC[-8]&lt;&gt;\"\"\"\"),IF(NETWORKDAYS(RC[-11],RC[-8])-2&lt;1,\"\"\"\",NETWORKDAYS(RC[-11],RC[-8])-2),IF(AND(RC[-9]&lt;&gt;\"\"\"\",RC[-8]&lt;&gt;\"\"\"\"),IF(NETWORKDAYS(RC[-9],RC[-8])-2&lt;1,\"\"\"\",NETWORKDAYS(RC[-9],RC[-8])-2),\"\"\"\")))))))\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1427820248, "creation_date": 1427820248, "answer_id": 29373978, "question_id": 29372767, "link": "https://stackoverflow.com/questions/29372767/excel-vba-simple-but-complicated-while-initializing-userform/29373978#29373978", "title": "Excel VBA Simple but Complicated while initializing Userform", "body": "<p>You're missing a qualifier:</p>\n\n<pre><code>For Cmb = 2 To .Cells(.Rows.Count, 27).End(xlUp).Row\n</code></pre>\n\n<p>note the full stop before the <code>Rows</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 3196802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d38d67db29a0b041033e566522405a6?s=128&d=identicon&r=PG&f=1", "display_name": "Sarfaraz78615", "link": "https://stackoverflow.com/users/3196802/sarfaraz78615"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1427820248, "creation_date": 1427816607, "last_edit_date": 1531164843, "question_id": 29372767, "link": "https://stackoverflow.com/questions/29372767/excel-vba-simple-but-complicated-while-initializing-userform", "title": "Excel VBA Simple but Complicated while initializing Userform", "body": "<p>Actually I made the project in Excel VBA , and I wanted to hide ThisWorkbook.visible=False when the files open and then load the userform. However I the project is running fantastic but when i hide my thisworkbook then i am getting an error like \"method rows of object _global failed\"\non \nFor Cmb = 2 To .Cells(Rows.Count, 27).End(xlUp).Row</p>\n\n<pre><code>Sub ComboAddItems()\n    Dim Lc, Cmb, CmbItm As Integer\n    With ThisWorkbook.Worksheets(\"Tool Work\")\n        For Cmb = 2 To .Cells(Rows.Count, 27).End(xlUp).Row\n            Lc = .Range(.Cells(Cmb, 28), .Cells(Cmb, 28).End(xlToRight)).Count\n            For CmbItm = 1 To Lc\n                UserForm1.Controls(.Cells(Cmb, 27).Value).AddItem .Cells(Cmb, 27 + CmbItm).Value\n            Next CmbItm\n        Next Cmb\n    End With\nEnd Sub\n</code></pre>\n"}]