[{"tags": ["excel", "date", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1481178612, "post_id": 41030260, "comment_id": 69273536, "body": "Hi Tim, would this formula equate to the following or do the following, as the values I have are difference for each supplier in prices, so typically some of these suppliers would change their prices on a daily basis and some would not, those that do not, e.g. this would be a 0, would this formula, go up from the most current date and find a value with a defined difference x, and than find the corresponding date to subtract from current to work out the number of days since the most recent change."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1481178755, "post_id": 41030260, "comment_id": 69273604, "body": "Yes -  try it out"}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1481223839, "post_id": 41030260, "comment_id": 69301401, "body": "i have 687 date rows, and its giving me value error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1481224540, "post_id": 41030260, "comment_id": 69301749, "body": "I don&#39;t have your data - unless you can share it I&#39;m not going to be able to do much here"}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1481230248, "post_id": 41030260, "comment_id": 69304695, "body": "I will create a sample and send you the link via github"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1482950678, "post_id": 41030260, "comment_id": 69937392, "body": "I&#39;m not seeing why my formula wouldn&#39;t work with that data.  If you can share a sample file (use Box, Dropbox, Google drive, etc etc) with actual data then that would help"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1481160251, "creation_date": 1481160251, "answer_id": 41030260, "question_id": 41029291, "link": "https://stackoverflow.com/questions/41029291/finding-number-of-days-sice-last-change-of-date-value-given-a-condition/41030260#41030260", "title": "Finding number of days sice last change of date value given a condition", "body": "<p>Something like this might work for you, depending on your definition of \"significant\" increase:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tAfZz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tAfZz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Array formula so use Ctrl+Shift+Enter to apply to the cell. You can then fill to the right.</p>\n\n<p>Assumes no gaps in your price data.</p>\n\n<p>If you want to determine based on % change then try variations using <code>(B3:B11/B2:B10)</code> in place of subtraction.</p>\n"}, {"comments": [{"owner": {"reputation": 336, "user_id": 7078182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f6946b5a191af0780e74a38af91e?s=128&d=identicon&r=PG", "display_name": "Roger H.", "link": "https://stackoverflow.com/users/7078182/roger-h"}, "edited": false, "score": 0, "creation_date": 1481263001, "post_id": 41053747, "comment_id": 69315084, "body": "@user3287522 : Mine is an array formula as well."}], "tags": [], "owner": {"reputation": 336, "user_id": 7078182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f6946b5a191af0780e74a38af91e?s=128&d=identicon&r=PG", "display_name": "Roger H.", "link": "https://stackoverflow.com/users/7078182/roger-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1481262320, "last_edit_date": 1481262320, "creation_date": 1481261816, "answer_id": 41053747, "question_id": 41029291, "link": "https://stackoverflow.com/questions/41029291/finding-number-of-days-sice-last-change-of-date-value-given-a-condition/41053747#41053747", "title": "Finding number of days sice last change of date value given a condition", "body": "<p>This formula is simply another approach :NOW()-INDEX($A$2:$A$11,MAX(IFERROR(IF(B$2:B$12-B$1:B$11>0,ROW(B$1:B$12)),0))) . </p>\n"}], "owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482950517, "creation_date": 1481153743, "last_edit_date": 1531161705, "question_id": 41029291, "link": "https://stackoverflow.com/questions/41029291/finding-number-of-days-sice-last-change-of-date-value-given-a-condition", "title": "Finding number of days sice last change of date value given a condition", "body": "<p>In my first column A, I have dates going down since 2015 to present date. A2 across, the column headings or names of 50 suppliers. I am keen to know the number of days since the last change in Prices. The Process would be for me to go up from current date for each supplier until I see a significant difference >\u00a3x, and than go across to see the date and subtract this from current date to get the number of days since last change. </p>\n\n<p>I can use index and match to find the price for a given supplier given current date, but I am not aware of function that allows you to find the most ecent number of days since the price changed for supplier. As I am keen to make this dynamic.  </p>\n\n<p>Example </p>\n\n<pre><code>  Date      A   B   C   D   E    \n25/11/2016  0,  0   0   0   0   \n26/11/2016  0,  50  0   30  0  \n27/11/2016  0,  0   0   0   0  \n28/11/2016  0,  0   0   0   0  \n29/11/2016  40, 10  0   50  0  \n30/11/2016  0,  0   30  0   0  \n01/12/2016  0,  0   0   0   30  \n02/12/2016  10, 0   0   0   0  \n03/12/2016  0,  0   10  0   0  \n04/12/2016  0,  10  0   10  10  \n05/12/2016  0,  0   0   0   0  \n06/12/2016  0,  0   0   0   0  \n07/12/2016  10, 0   0   0   0  \n08/12/2016  0,  0   20  0   0  \n09/12/2016  0,  0   0   0   10  \n10/12/2016  0,  0   0   0   0  \n</code></pre>\n\n<p>Most recent No of days since chge<br>\n3 days  6 days  2 days  6 days  one day</p>\n\n<p>I have added to show the first column using comma, but I am assuming you get my gist, signed up to Github. and do not know how to upload a spreadsheet</p>\n\n<p>I am looking for the most RECENT</p>\n"}, {"tags": ["excel", "vba", "webpage", "html-object"], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 2756792, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7387491454a6a7e25fdcc14adffa5ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi", "link": "https://stackoverflow.com/users/2756792/vamsi"}, "edited": false, "score": 0, "creation_date": 1481211767, "post_id": 41029688, "comment_id": 69294183, "body": "For the noobs like me out there, please activate the Microsoft HTML object library by clicking on <i>Tools -&gt; References.. -&gt; Microsoft HTML Object Library</i> in the VBA window"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1481156381, "creation_date": 1481156381, "answer_id": 41029688, "question_id": 41029230, "link": "https://stackoverflow.com/questions/41029230/how-to-grab-a-portion-of-a-website-text-into-an-excel-cell/41029688#41029688", "title": "How to grab a portion of a website text into an Excel cell", "body": "<p>Using MSHTML to parse your HTML is a bit limited, since many \"modern\" document methods might not be implemented, but you can make it work in this case:</p>\n\n<pre><code>Sub myConnection()\n    Dim oHtml, myData, Title, cste, d\n    Set oHtml = New MSHTML.HTMLDocument\n\n\n    With CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\n        .Open \"GET\", \"http://www.gmpartsdirect.com/oe-gm/23498355\", False\n        .send\n        oHtml.body.innerHTML = .responseText\n\n        Set d = myGetElementsByClassName(oHtml, \"div\", \"description_body\")\n        If Not d Is Nothing Then\n            Debug.Print d.innerText\n        End If\n\n    End With\n'Rest of the code to grab the exact part description\nEnd Sub\n\n\n'return an element given its tag name and class name\nFunction myGetElementsByClassName(doc, tagName, className) As Object\n    Dim el As Object\n    For Each el In doc.getElementsByTagName(tagName)\n        If el.className = className Then\n            Set myGetElementsByClassName = el\n            Exit Function\n        End If\n    Next el\n    Set myGetElementsByClassName = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 2756792, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7387491454a6a7e25fdcc14adffa5ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Vamsi", "link": "https://stackoverflow.com/users/2756792/vamsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 41029688, "answer_count": 1, "score": 0, "last_activity_date": 1481156381, "creation_date": 1481153342, "question_id": 41029230, "link": "https://stackoverflow.com/questions/41029230/how-to-grab-a-portion-of-a-website-text-into-an-excel-cell", "title": "How to grab a portion of a website text into an Excel cell", "body": "<p>I'm trying to automate creating a list of descriptions from the GM Parts website for a range of part number values. </p>\n\n<p>For example, the following is the link for the Part number 23498355 -\n<a href=\"http://www.gmpartsdirect.com/oe-gm/23498355\" rel=\"nofollow noreferrer\">http://www.gmpartsdirect.com/oe-gm/23498355</a></p>\n\n<p>I'm trying to grab the Part description text \"This ABS Sensor is a genuine OEM GM part #23498355 and carries a factory warranty. We offer the best online prices with fast shipping on any order placed with us.\" available on this webpage into Excel.</p>\n\n<p>I wrote the following code to get that info, but couldn't complete the last few lines which can grab this specific info.</p>\n\n<pre><code>Option Explicit\n\nSub myConnection()\n    Dim oHtml, myData, Title, cste\n    Set oHtml = New HTMLDocument\n    With CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\n        .Open \"GET\", \"http://www.gmpartsdirect.com/oe-gm/23498355\", False\n        .send\n        oHtml.body.innerHTML = .responseText\n    End With\n'Rest of the code to grab the exact part description\nEnd Sub\n</code></pre>\n\n<p>Once I get this working, the idea is to automate the process for a list of part numbers.\nCan anyone help me with completing this piece of code?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1481152301, "post_id": 41028998, "comment_id": 69265595, "body": "When deleting rows it&#39;s best to work from the bottom up, so your row index doesn&#39;t get interfered with.  <code>For i = LastRow to 2 Step -1</code>"}, {"owner": {"reputation": 153, "user_id": 5637453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae0e71709c1da733b81eed98e3903111?s=128&d=identicon&r=PG&f=1", "display_name": "superblowncolon", "link": "https://stackoverflow.com/users/5637453/superblowncolon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481152406, "post_id": 41028998, "comment_id": 69265630, "body": "Good point. I&#39;ve made that change. Doesn&#39;t address the issue at hand though."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1481152534, "post_id": 41028998, "comment_id": 69265672, "body": "Tim has a point, run your for loop as <code>For i = LastRow to 2 Step -1</code> to go from the bottom up, but also you are using the <code>ws</code> object (presumably as a reference to the worksheet), but you never set it anywhere.  You can also add <code>Debug.Print recdate &amp; &quot; &quot; &amp; Date &amp; &quot; &quot; &amp; DateDiff(&quot;d&quot;, Date, recdate)</code> to the start of your loop to see exactly what it IS calculating."}, {"owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "edited": false, "score": 0, "creation_date": 1481152538, "post_id": 41028998, "comment_id": 69265674, "body": "What is the <code>d</code> in your <code>DateDiff</code> argument list?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1481152568, "post_id": 41028998, "comment_id": 69265687, "body": "<code>DateDiff(&quot;d&quot;, recdate, Date)</code>  Should have triggered a run-time error without the quotes."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1481152587, "post_id": 41028998, "comment_id": 69265696, "body": "Also, I believe <code>Datediff</code> treats the first date as the earliest one, which means that you may be getting a negative number as the result of the calculation.  You can avoid that with an <code>ABS</code> wrapped round the <code>DateDiff</code> call"}, {"owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1481152745, "post_id": 41028998, "comment_id": 69265756, "body": "Following @Dave&#39;s first answer, you don&#39;t need to <code>Select</code> any sheet for this, or deal with the <code>ActiveSheet</code>, just maintain a reference to a sheet named <code>ws</code>, but be sure you assign to it correctly.  <code>Dim ws as Worksheet: Set ws = Sheets[&quot;Data&quot;]</code>  Then you can put the <code>With</code> block around your <code>For</code> loop as well."}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1481153038, "post_id": 41028998, "comment_id": 69265863, "body": "Maybe try changing DateDiff(d, Date, recdate) &gt; 179 to DateDiff(&quot;d&quot;, Now, recdate) &gt; 179. As per Tim said with the &quot;d&quot;."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 3, "last_activity_date": 1481155535, "last_edit_date": 1495542871, "creation_date": 1481155535, "answer_id": 41029578, "question_id": 41028998, "link": "https://stackoverflow.com/questions/41028998/excel-vba-delete-old-records/41029578#41029578", "title": "Excel VBA: Delete Old Records", "body": "<p>In the VBA Date/Time is a numeric value starting at 1 which equates to #1/1/1900#. </p>\n\n<p><strong>Date/Time Values</strong></p>\n\n<ul>\n<li>1 Day = 1</li>\n<li>1 Hour = 1/24</li>\n<li>1 Minute = 1/24/60</li>\n<li>1 Second = 1/24/60/60</li>\n</ul>\n\n<p>As always delete from the last row/item to the first.  My answer to <a href=\"https://stackoverflow.com/questions/40755334/compare-cells-to-delete-rows-value-is-true-but-not-deleting-rows/40755406#40755406\">Compare cells to delete rows, value is true but not deleting rows</a> demonstrates why.</p>\n\n<hr>\n\n<p><code>DateDiff(\"d\", Date, recdate) &gt; 179</code> and <code>Int(Date - recdate) &gt; 179</code> are equivalent.  </p>\n\n<pre><code>Sub ClearOldData()\n    Application.ScreenUpdating = False\n    Dimi As Long\n\n    With Sheets(\"Data\")\n\n        For i = 2 To LastRow Step -1\n            If Int(Date - Cells(i, \"F\").Value) &gt; 179 Then\n                .Rows(i).Delete\n            End If\n        Next i\n\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 5637453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae0e71709c1da733b81eed98e3903111?s=128&d=identicon&r=PG&f=1", "display_name": "superblowncolon", "link": "https://stackoverflow.com/users/5637453/superblowncolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "accepted_answer_id": 41029578, "answer_count": 1, "score": 1, "last_activity_date": 1490874213, "creation_date": 1481152049, "last_edit_date": 1481152346, "question_id": 41028998, "link": "https://stackoverflow.com/questions/41028998/excel-vba-delete-old-records", "title": "Excel VBA: Delete Old Records", "body": "<p>I'm attempting to delete any records that are 180 days or older. The dates are in Column F. When I run this, nothing happens. I'm thinking that it has to do with the Date() function.</p>\n\n<pre><code>Sub ClearOldData()\nApplication.ScreenUpdating = False\nSheets(\"Data\").Select\nDim LastRow As Long\nWith ActiveSheet\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\nFor i = 2 To LastRow\n    Dim recdate As Date\n    recdate = Cells(i, \"F\").Value \n    If DateDiff(d, Date, recdate) &gt; 179 Then\n        ws.Rows(i).Delete\n    End If\nNext i\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1481151819, "post_id": 41028848, "comment_id": 69265397, "body": "I think I know your problem, perhaps is <a href=\"http://stackoverflow.com/questions/39986941/select-variable-object-with-counter\">like mine a while ago?</a>"}, {"owner": {"reputation": 5, "user_id": 6659982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/287de872032136b5e35c44b7af86994e?s=128&d=identicon&r=PG&f=1", "display_name": "neeenway", "link": "https://stackoverflow.com/users/6659982/neeenway"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1481154227, "post_id": 41028848, "comment_id": 69266293, "body": "It&#39;s similar (yours will help on something else that I have planned) except I need this calculation to execute only after each specific textbox has been clicked rather than it all happening all at once."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6659982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/287de872032136b5e35c44b7af86994e?s=128&d=identicon&r=PG&f=1", "display_name": "neeenway", "link": "https://stackoverflow.com/users/6659982/neeenway"}, "edited": false, "score": 0, "creation_date": 1481153410, "post_id": 41029116, "comment_id": 69266001, "body": "But this code will only execute when textbox46 changes? I want it to also run when textbox47, 48 etc. changes as well"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 6659982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/287de872032136b5e35c44b7af86994e?s=128&d=identicon&r=PG&f=1", "display_name": "neeenway", "link": "https://stackoverflow.com/users/6659982/neeenway"}, "edited": false, "score": 0, "creation_date": 1481154151, "post_id": 41029116, "comment_id": 69266268, "body": "@neeenway I updated my answer.  Alternately you could create a class to group the textbox change events but it&#39;s a bit more involved Here is an example of grouping events: <a href=\"http://stackoverflow.com/questions/39896458/returning-an-index-value-from-a-group-of-activex-option-buttons/39905641#39905641\">Returning an index value from a group of ActiveX Option Buttons</a>"}, {"owner": {"reputation": 5, "user_id": 6659982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/287de872032136b5e35c44b7af86994e?s=128&d=identicon&r=PG&f=1", "display_name": "neeenway", "link": "https://stackoverflow.com/users/6659982/neeenway"}, "edited": false, "score": 0, "creation_date": 1481155266, "post_id": 41029116, "comment_id": 69266647, "body": "Thanks so much. It works well. Would learning grouping events be beneficial and will it take long?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 6659982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/287de872032136b5e35c44b7af86994e?s=128&d=identicon&r=PG&f=1", "display_name": "neeenway", "link": "https://stackoverflow.com/users/6659982/neeenway"}, "edited": false, "score": 0, "creation_date": 1481156124, "post_id": 41029116, "comment_id": 69266920, "body": "Learning to write your own classes, working with events and grouping events will definitely help.  The more techniques that you learn the faster and more creative you become at programming.  Thanks for accepting my answer :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1481153860, "last_edit_date": 1481153860, "creation_date": 1481152646, "answer_id": 41029116, "question_id": 41028848, "link": "https://stackoverflow.com/questions/41028848/making-one-set-of-code-with-slight-differences-apply-to-specific-textboxes-in/41029116#41029116", "title": "Making one set of code (with slight differences) apply to specific textboxes in userform", "body": "<p>Create a function that will return a reference to the textboxes based on a number.</p>\n\n<pre><code>Private Sub TextBox46_Change()\n    TextBox_ChangeEvent 0\nEnd Sub\n\nPrivate Sub TextBox47_Change()\n    TextBox_ChangeEvent 1\nEnd Sub\n\nPrivate Sub TextBox48_Change()\n    TextBox_ChangeEvent 2\nEnd Sub\n\nPrivate Sub TextBox49_Change()\n    TextBox_ChangeEvent 3\nEnd Sub\n\nPrivate Sub TextBox50_Change()\n    TextBox_ChangeEvent 4\nEnd Sub\n\nPrivate Sub TextBox51_Change()\n    TextBox_ChangeEvent 5\nEnd Sub\n\nPrivate Sub TextBox52_Change()\n    TextBox_ChangeEvent 6\nEnd Sub\n\nPrivate Sub TextBox53_Change()\n    TextBox_ChangeEvent 7\nEnd Sub\n\nPrivate Sub TextBox_ChangeEvent(Index As Integer)\n    If getTxtBox(46 + Index).Value &gt; 0 And getTxtBox(46 + Index).Value &lt; 1000 Then\n        getTxtBox(54 + Index).Value = 100 * ((getTxtBox(46 + Index).Value - getTxtBox(14 + Index).Value) / (getTxtBox(30 + Index).Value - getTxtBox(14 + Index).Value))\n        getTxtBox(62 + Index).Value = 100 - getTxtBox(54 + Index).Value\n    Else: MsgBox (\"Revise Inputs\")\n    End If\nEnd Sub\n\nFunction getTxtBox(Index As Integer) As MSForms.TextBox\n    Set getTxtBox = DataInput.Controls(\"TextBox\" &amp; Index)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6659982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/287de872032136b5e35c44b7af86994e?s=128&d=identicon&r=PG&f=1", "display_name": "neeenway", "link": "https://stackoverflow.com/users/6659982/neeenway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 41029116, "answer_count": 1, "score": 0, "last_activity_date": 1481154380, "creation_date": 1481151260, "last_edit_date": 1531164843, "question_id": 41028848, "link": "https://stackoverflow.com/questions/41028848/making-one-set-of-code-with-slight-differences-apply-to-specific-textboxes-in", "title": "Making one set of code (with slight differences) apply to specific textboxes in userform", "body": "<p>I have a UserForm where I have multiple rows of textboxes for data entry. Upon finishing entry for a specific textbox in each row, it triggers a macro for another textbox within the same row to be calculated. </p>\n\n<p>The code is:</p>\n\n<pre><code>Private Sub TextBox46_Change()\n\n    If DataInput.TextBox46.Value &gt; 0 And DataInput.TextBox46.Value &lt; 1000 Then\n       DataInput.TextBox54.Value = 100 * ((DataInput.TextBox46.Value - DataInput.TextBox14.Value) / (DataInput.TextBox30.Value - DataInput.TextBox14.Value))\n       DataInput.TextBox62.Value = 100 - DataInput.TextBox54.Value\n    Else: MsgBox (\"Revise Inputs\")\n    End If\n    End Sub\n</code></pre>\n\n<p>Now I need to apply this for 8 other textboxes, except for example if it was TextBox47_Change then all the other textbox numbers in the code must shift up by 1. I have searched online and people have done it but the code did not change. Here,my code has slight differences for each textbox. </p>\n\n<p>Is there a way to repeat this code without just copy and pasting it to each TextBox_Change sub and then changing the numbers. </p>\n\n<p>For further clarification, in the image I have attached, everytime the Dish + Residue Mass column textbox changes then the TSR,VS,FS is calculated for the corresponding row. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 1, "creation_date": 1481151780, "post_id": 41028767, "comment_id": 69265375, "body": "Let me know if I answered your question - if you need more help, feel free to let me know."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1481153515, "post_id": 41028813, "comment_id": 69266046, "body": "I like the gif.  You might want to consider reducing the white space and showing the tabs.   Compare yours to my demo where I resize the Excel window <a href=\"https://www.dropbox.com/s/r6m7p08nmqey02q/demo.gif?dl=0\" rel=\"nofollow noreferrer\">Demo</a>"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1481153895, "post_id": 41028813, "comment_id": 69266193, "body": "Haha well, thanks for the tip - I throw it together usually, but it&#39;s not a bad idea. I rarely have to show the sheet - I mostly just worry about keeping the gif size small because the file size is terrible."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1481153928, "post_id": 41028813, "comment_id": 69266210, "body": "Since you gave me a tip, I will give you one. Checkout <code>ScreenToGif</code>. It&#39;s free and super useful. <a href=\"https://screentogif.codeplex.com/\" rel=\"nofollow noreferrer\">screentogif.codeplex.com</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1481154275, "post_id": 41028813, "comment_id": 69266310, "body": "Thanks but that&#39;s what I use.  Do you have anything else for me?..lol"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 1, "creation_date": 1481157015, "post_id": 41028813, "comment_id": 69267180, "body": "Ahh I should have known lol. Yes, eat your vegetables and brush your teeth. That is all ;)"}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 2, "last_activity_date": 1481151621, "last_edit_date": 1481151621, "creation_date": 1481151104, "answer_id": 41028813, "question_id": 41028767, "link": "https://stackoverflow.com/questions/41028767/excel-vba-sum-from-multiple-sheets/41028813#41028813", "title": "Excel VBA Sum from Multiple Sheets", "body": "<p>So, an example formula would look like this:</p>\n\n<p><code>=SUM(Sheet2!A1:A5,Sheet3!A1:A5,Sheet4!A1:A5)</code></p>\n\n<p>That would sum <code>Sheet2-Sheet4</code>, <code>A1:A5</code> on all sheets.</p>\n\n<p>Is there a reason you need to write the VBA code to do this?</p>\n\n<p>Can't you just enter it as a formula once?</p>\n\n<p>Also, if you're going to the trouble of writing VBA to generate a formula, it may make more sense to just do the sum entirely in VBA code.</p>\n\n<p>If not, try this:</p>\n\n<pre><code>Sub GenerateTheFormula()\nDim x, Formula\nFormula = \"=SUM(\" 'Formula begins with =SUM(\nFor x = 3 To Sheets.Count\n    Formula = Formula &amp; Sheets(x).Name &amp; \"!A1,\" 'Add SheetName and Cell and Comma\nNext x\nFormula = Left(Formula, Len(Formula) - 1) &amp; \")\" 'Remove trailing comma and add parenthesis\nRange(\"B1\").Formula = Formula 'Where do you want to put this formula?\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bthFm.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bthFm.gif\" alt=\"Results\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7264850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb52c99ad02d163fc0b15f2054f9ba7?s=128&d=identicon&r=PG&f=1", "display_name": "bearded4glory", "link": "https://stackoverflow.com/users/7264850/bearded4glory"}, "edited": false, "score": 0, "creation_date": 1481214762, "post_id": 41030263, "comment_id": 69296285, "body": "This seems like it should work but I get a #VALUE! when I try to use it.  I am in Excel 2016 if it makes a difference."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 7264850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb52c99ad02d163fc0b15f2054f9ba7?s=128&d=identicon&r=PG&f=1", "display_name": "bearded4glory", "link": "https://stackoverflow.com/users/7264850/bearded4glory"}, "edited": false, "score": 0, "creation_date": 1481214889, "post_id": 41030263, "comment_id": 69296376, "body": "It works on my Office 365 Excel.  I am use windows. I am not sure about Excel 2016."}, {"owner": {"reputation": 1, "user_id": 7264850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb52c99ad02d163fc0b15f2054f9ba7?s=128&d=identicon&r=PG&f=1", "display_name": "bearded4glory", "link": "https://stackoverflow.com/users/7264850/bearded4glory"}, "edited": false, "score": 0, "creation_date": 1481223742, "post_id": 41030263, "comment_id": 69301355, "body": "I got it to work, not sure why it wasn&#39;t working initially but I ended up just rolling the other functions into this one since they were fairly short.  Thanks!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 7264850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb52c99ad02d163fc0b15f2054f9ba7?s=128&d=identicon&r=PG&f=1", "display_name": "bearded4glory", "link": "https://stackoverflow.com/users/7264850/bearded4glory"}, "edited": false, "score": 0, "creation_date": 1481223843, "post_id": 41030263, "comment_id": 69301403, "body": "@bearded4glory you do that by clicking on the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1481160269, "creation_date": 1481160269, "answer_id": 41030263, "question_id": 41028767, "link": "https://stackoverflow.com/questions/41028767/excel-vba-sum-from-multiple-sheets/41030263#41030263", "title": "Excel VBA Sum from Multiple Sheets", "body": "<p>The functions return strings and not actual worksheets.  The Worksheet does not parse strings well.  So add a third function that uses the Evaluate function:</p>\n\n<pre><code>Function MySum(rng As Range)\n\nMySum = Application.Caller.Parent.Evaluate(\"SUM(\" &amp; FirstSheet &amp; \":\" &amp; LastSheet &amp; \"!\" &amp; rng.Address &amp; \")\")\n\nEnd Function\n</code></pre>\n\n<p>Then you would simply call it: <code>MySum(A1)</code></p>\n\n<p>It uses the other two function you already have created to create a string that can be evaluated as a formula.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6012628"}, "is_accepted": false, "score": 0, "last_activity_date": 1481170939, "creation_date": 1481170939, "answer_id": 41031729, "question_id": 41028767, "link": "https://stackoverflow.com/questions/41028767/excel-vba-sum-from-multiple-sheets/41031729#41031729", "title": "Excel VBA Sum from Multiple Sheets", "body": "<p>I didn't understand ur question completely but As I understood u have different sheets of different clients which contains supoose column 1  date and column 2\ncontains hours on that particular date wise hours and a final sheet which column1 contains name of client and column 2 contains total hours<br>Please try it</p>\n\n<pre><code>Sub countHours()\nDim last_Row As Integer\nDim sum As Double\nsum = 0\n  'Because I know number of client\n   For i = 1 To 2     'i shows client particular sheet\n\n  last_Row = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n  Sheets(i).Activate\n\n  For j = 2 To last_Row\n\n  'In my Excel sheet column 1 contains dates and column 2 contains number of hours\n\n  sum = sum + Cells(j, 2)\n  'MsgBox sum\n  Next j\n\n  'Sheet 3 is my final sheet\n  ThisWorkbook.Sheets(3).Cells(i + 1, 2).Value = sum\n  sum = 0\n  Next i\n\n  End Sub\n</code></pre>\n\n<p>Happy Coding :</p>\n"}], "owner": {"reputation": 1, "user_id": 7264850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb52c99ad02d163fc0b15f2054f9ba7?s=128&d=identicon&r=PG&f=1", "display_name": "bearded4glory", "link": "https://stackoverflow.com/users/7264850/bearded4glory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10344, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1580137373, "creation_date": 1481150818, "question_id": 41028767, "link": "https://stackoverflow.com/questions/41028767/excel-vba-sum-from-multiple-sheets", "title": "Excel VBA Sum from Multiple Sheets", "body": "<p>I am trying to create a function or functions that can sum daily hours from time cards for each client to come up with the total hours worked per day.  Each client has it's own sheet inside of a single workbook.</p>\n\n<p>Currently, I have a function that determines the sheet that goes with the first client (the third sheet in the workbook):</p>\n\n<pre><code>Function FirstSheet()\nApplication.Volatile\nFirstSheet = Sheets(3).Name\nEnd Function\n</code></pre>\n\n<p>And one to find the last sheet:</p>\n\n<pre><code>Function LastSheet()\nApplication.Volatile\nLastSheet = Sheets(Sheets.Count).Name\nEnd Function\n</code></pre>\n\n<p>The part that I am having trouble with it getting these to work within the sum function.</p>\n\n<pre><code>=sum(FirstSheet():LastSheet()!A1\n</code></pre>\n\n<p>That is basically what I want to accomplish.  I think the problem is that I don't know how to concatenate it without turning it into a string and it doesn't realize that it is sheet and cell references.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "edited": false, "score": 2, "creation_date": 1481149178, "post_id": 41028363, "comment_id": 69264280, "body": "have a look <a href=\"http://stackoverflow.com/questions/5192187/how-to-have-unlocked-cells-on-a-protected-vba-created-worksheet\">here</a>. looks like you need to unprotect the entire sheet first, then set which cells to leave unlocked, then proctect the sheet again."}], "owner": {"reputation": 21, "user_id": 7264741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5wOZQ.png?s=128&g=1", "display_name": "Simon D.", "link": "https://stackoverflow.com/users/7264741/simon-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481149243, "creation_date": 1481148930, "last_edit_date": 1481149243, "question_id": 41028363, "link": "https://stackoverflow.com/questions/41028363/prevent-excel-cell-being-protected-when-when-copying-formulas-via-vba", "title": "Prevent Excel cell being protected when when copying formulas via VBA", "body": "<p>I'm using VBA code to insert a new line in a Excel 2016 worksheet and then I copy the formulas from the above line to the new line so that I don't have to insert them manually. Unfortunately the cell where the formula is inserted is protected after copying the formula. This brings the disadvantage that I cannot delete the new row if I made a mistake. Here's my code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n' Disable events to prevent that insertion of the row triggers a new Worksheet_Change\n' event. Without this action the worksheet would be in an endles loop.\nApplication.EnableEvents = False\n\nIf Target.Column = 1 Then\n    If Cells(Target.Row + 2, 1).Value = \"end\" Then\n        Cells(Target.Row + 1, 1).EntireRow.Insert\n    End If\nEnd If\n\n' Copy formulas\nCells(Target.Row - 1, 2).Copy (Cells(Target.Row, 2))\nCells(Target.Row - 1, 5).Copy (Cells(Target.Row, 5))\nCells(Target.Row - 1, 2).Unprotect\nCells(Target.Row - 2, 5).Unprotect\n\n\n' Reactivate events so that the worksheet can react to user changes.\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>As you can see I also tried to unprotect the cell but this doesn't help. What can I do to prevent these cells from being protected after copying the formula? I'm trying this for hours now and Google didn't answer my question until now.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "edited": false, "score": 0, "creation_date": 1481212421, "post_id": 41027674, "comment_id": 69294691, "body": "Is the sheet always located at the same index from left to right?"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 7110451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429f8888155e3e90c966eb72378bd19e?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/7110451/greg"}, "edited": false, "score": 0, "creation_date": 1481206001, "post_id": 41029492, "comment_id": 69290065, "body": "The name of the tab follows a specific pattern: &quot;Components m-d&quot;. Example: Components 11-23. If I were going to do it manually, I would look for the tab Components 11-23."}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 1, "last_activity_date": 1481154921, "creation_date": 1481154921, "answer_id": 41029492, "question_id": 41027674, "link": "https://stackoverflow.com/questions/41027674/import-excel-spreadsheet-where-worksheet-name-varies-each-month/41029492#41029492", "title": "Import Excel spreadsheet where worksheet name varies each month", "body": "<p>Is there a pattern that would allow you to 'guess' the name of the sheet? i.e. will it be the only sheet that starts with 'Components'? Will there be a date in a certain cell of one of the sheets? In English, describe the way you would select the sheet if you were going to look at it.</p>\n\n<p>The following will list all sheet names in the workbook, then ask you to type in the name of the sheet. If you can define how to identify, then code could be changed to do that.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub cmdGetFile_Click()\n    'Import components spreadsheet into components table\n    Dim fDlg As FileDialog\n    Dim flNme As String\n    Dim flChsn As Integer\n\n    Set fDlg = Application.FileDialog(msoFileDialogOpen)\n\n    fDlg.Title = \"Select Products &amp; Components file\"\n    flChsn = fDlg.Show\n    fDlg.FilterIndex = 1\n\n    If flChsn &lt;&gt; -1 Then\n       MsgBox \"No file selected\"\n    Else\n       flNme = fDlg.SelectedItems(1)\n    End If\n\n    ' Open the Workbook and display a list of sheet names\n    Dim excelApp    As Excel.Application\n    Dim oWB         As Excel.Workbook\n    Dim oWS         As Excel.Worksheet\n    Dim strSheets   As String\n    Dim strRange    As String\n    Dim i           As Integer\n    Dim strSheet    As String\n    Dim iLastrow    As Long\n    Dim iLastCol    As Long\n\n    Set excelApp = New Excel.Application\n    Set oWB = excelApp.Workbooks.Open(flNme)\n    excelApp.Visible = True\n\n    ' Get all Sheet Names\n    strSheets = \"\"\n    For i = 1 To oWB.Worksheets.Count\n        strSheets = strSheets &amp; oWB.Worksheets(i).Name &amp; vbCr\n    Next i\n\nAskAgain:\n    ' Display the list\n    MsgBox \"List of all worksheet names:\" &amp; vbCrLf &amp; strSheets\n\n    strSheet = InputBox(\"Please enter the name of the Worksheet to import.\", \"Sheet Name?\")\n    If InStr(1, strSheets, strSheet) = 0 Then\n        MsgBox \"You entered a sheet name that does not exist.\", vbOKOnly, \"Unknown Sheet Name\"\n        GoTo AskAgain\n    End If\n\n    ' Get Cell Range... Assume range starts in A1????\n    Set oWS = oWB.Sheets(strSheet)\n\n    ' Get last used row\n    iLastrow = oWS.Cells(oWS.rows.Count, 1).End(xlUp).Row\n    ' Build Import range (Sheet &amp; cells)\n    strRange = strSheet &amp; \"!A1:BM\" &amp; iLastrow                   ' i.e.  \"SheetName!A1:P25\"\n\n    oWB.Close SaveChanges:=False        ' Close, don't save any changes\n    Set oWB = Nothing\n    Set excelApp = Nothing\n\n    ' Import worksheet\n    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"component\", flNme, -1, strRange         '[this is where I need help]\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 7110451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429f8888155e3e90c966eb72378bd19e?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/7110451/greg"}, "is_accepted": true, "score": 0, "last_activity_date": 1481212711, "last_edit_date": 1481212711, "creation_date": 1481212269, "answer_id": 41043485, "question_id": 41027674, "link": "https://stackoverflow.com/questions/41027674/import-excel-spreadsheet-where-worksheet-name-varies-each-month/41043485#41043485", "title": "Import Excel spreadsheet where worksheet name varies each month", "body": "<p>Since I know the worksheets code name property (it's always Sheet3), I am able to refer to the sheet number and not go through the process of manually typing a name into a dialog box.</p>\n\n<p>A big thank you to Wayne G. Dunn, your clear and well-written answer helped fill in several missing pieces for me! The code for finding spreadsheet names, displaying them and allowing user input I will save as a great example for future use.</p>\n\n<p>So here is the final code:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub cmdGetFile_Click()\n'Import components spreadsheet into components table\nDim fDlg As FileDialog\nDim flNme As String\nDim flChsn As Integer\n\nSet fDlg = Application.FileDialog(msoFileDialogOpen)\n\nfDlg.Title = \"Select Products &amp; Components file\"\nflChsn = fDlg.Show\nfDlg.FilterIndex = 1\n\nIf flChsn &lt;&gt; -1 Then\n   MsgBox \"No file selected\"\nElse\n   flNme = fDlg.SelectedItems(1)\nEnd If\n\n' Open the Workbook and display a list of sheet names\nDim excelApp    As Excel.Application\nDim oWB         As Excel.Workbook\nDim oWS         As Excel.Worksheet\nDim strSheets   As String\nDim strRange    As String\nDim i           As Integer\nDim strSheet    As String\nDim iLastrow    As Long\nDim iLastCol    As Long\n\nSet excelApp = New Excel.Application\nSet oWB = excelApp.Workbooks.Open(flNme)\nexcelApp.Visible = False    'Don't need to see the workbook\n\n' Sheet 3 is the worksheet that I want to import\ni = 3\nstrSheet = strSheets &amp; oWB.Worksheets(3).Name\n\n' Get Cell Range starting in A1\nSet oWS = oWB.Sheets(strSheet)\n\n' Get last used row\niLastrow = oWS.Cells(oWS.rows.Count, 1).End(xlUp).Row\n\n' Build Import range (Sheet &amp; cells)\nstrRange = strSheet &amp; \"!A1:L\" &amp; iLastrow   ' i.e.  \"SheetName!A1:P25\"\n\noWB.Close SaveChanges:=False        ' Close, don't save any changes\nSet oWB = Nothing\nSet excelApp = Nothing\n\n' Import worksheet\nDoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"component\", flNme, -1, strRange\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 7110451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429f8888155e3e90c966eb72378bd19e?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/7110451/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1298, "favorite_count": 0, "accepted_answer_id": 41043485, "answer_count": 2, "score": 0, "last_activity_date": 1594640870, "creation_date": 1481146023, "last_edit_date": 1594640870, "question_id": 41027674, "link": "https://stackoverflow.com/questions/41027674/import-excel-spreadsheet-where-worksheet-name-varies-each-month", "title": "Import Excel spreadsheet where worksheet name varies each month", "body": "<p>I need to import data from an Excel spreadsheet. The spreadsheet has multiple worksheets, but I'm only interested in the one for components. The worksheet name varies each month, though it always begins with \"Components\". I'm looking for a way to programmatically find the correct worksheet. </p>\n\n<p>The solution likely lies in getting the worksheet's code name property, but am not sure how to do that.</p>\n\n<p>FWIW, I don't control the spreadsheet and therefore cannot control the use of a named range (they don't use them) nor the naming convention for the worksheets.</p>\n\n<pre><code>Private Sub cmdGetFile_Click()\n'Import components spreadsheet into components table\n    Dim fDlg As FileDialog\n    Dim flNme As String\n    Dim flChsn As Integer\n\n    Set fDlg = Application.FileDialog(msoFileDialogOpen)\n\n    fDlg.Title = \"Select Products &amp; Components file\"\n    flChsn = fDlg.Show\n    fDlg.FilterIndex = 1\n\n    If flChsn &lt;&gt; -1 Then\n       MsgBox \"No file selected\"\n    Else\n       flNme = fDlg.SelectedItems(1)\n    End If\n\n    DoCmd.TransferSpreadsheet , acSpreadsheetTypeExcel12, \"component\", flNme, -1, [this is where I need help]\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1481145252, "post_id": 41027475, "comment_id": 69262362, "body": "You can only paste all or insert with cut."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1481145405, "post_id": 41027475, "comment_id": 69262453, "body": "<a href=\"http://stackoverflow.com/q/10714251/1188513\">Must. Read.</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1481148435, "post_id": 41027475, "comment_id": 69263935, "body": "Must watch: <a href=\"https://www.youtube.com/playlist?list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction</a>.  This is the relevant video: <a href=\"https://www.youtube.com/watch?v=c8reU-H1PKQ&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5&amp;index=5&amp;t=3072s\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1481146254, "post_id": 41027678, "comment_id": 69262879, "body": "But that doesn&#39;t explain the comment edited into the question, i.e. <code>I have tried Selection.Copy as well. It gave the same error</code>  (But I can&#39;t get <code>ActiveSheet.PasteSpecial</code> to work anyway - I would have thought that it would need to be <code>ActiveCell.PasteSpecial</code> - so I&#39;m not too sure how accurate the &quot;same error&quot; comment is.)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481146593, "post_id": 41027678, "comment_id": 69263032, "body": "Was just typing the same when I saw your edit @YowE3K  It should work with ActiveCell and Copy."}, {"owner": {"reputation": 31, "user_id": 7039932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cacecad618f6c1e58b5033c33a1865?s=128&d=identicon&r=PG&f=1", "display_name": "Collin Stacey", "link": "https://stackoverflow.com/users/7039932/collin-stacey"}, "edited": false, "score": 0, "creation_date": 1481147830, "post_id": 41027678, "comment_id": 69263664, "body": "When I run it it gives me Run-Time error &#39;1004&#39;: Application-defined or object-defined error."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31, "user_id": 7039932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cacecad618f6c1e58b5033c33a1865?s=128&d=identicon&r=PG&f=1", "display_name": "Collin Stacey", "link": "https://stackoverflow.com/users/7039932/collin-stacey"}, "edited": false, "score": 0, "creation_date": 1481158392, "post_id": 41027678, "comment_id": 69267606, "body": "@CollinStacey on which line?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31, "user_id": 7039932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cacecad618f6c1e58b5033c33a1865?s=128&d=identicon&r=PG&f=1", "display_name": "Collin Stacey", "link": "https://stackoverflow.com/users/7039932/collin-stacey"}, "edited": false, "score": 0, "creation_date": 1481158457, "post_id": 41027678, "comment_id": 69267623, "body": "@CollinStacey never mind I found the error see the edit."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1481158440, "last_edit_date": 1481158440, "creation_date": 1481146041, "answer_id": 41027678, "question_id": 41027475, "link": "https://stackoverflow.com/questions/41027475/vba-pastespecial-method-of-range-class-failed/41027678#41027678", "title": "VBA: PasteSpecial method of Range class failed", "body": "<p>As stated above in the comment you can only Paste everything when using Cut.  If only values are wanted then assign the values directly then clear the range.</p>\n\n<pre><code>Sub foo()\nDim rng As Range\nDim lastRow As Long\n\nSet rng = Sheets(\"New_Orders\").Range(\"B3:E29\")\nWith Sheets(\"Previous_Orders\")\n    lastRow = .Cells(.Rows.Count, 2).End(xlUp).Row + 1\n    .Cells(lastRow, 2).Resize(rng.Rows.Count, rng.Columns.Count).Value = rng.Value\nEnd With\nrng.Clear\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7039932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cacecad618f6c1e58b5033c33a1865?s=128&d=identicon&r=PG&f=1", "display_name": "Collin Stacey", "link": "https://stackoverflow.com/users/7039932/collin-stacey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481158440, "creation_date": 1481145175, "last_edit_date": 1531164843, "question_id": 41027475, "link": "https://stackoverflow.com/questions/41027475/vba-pastespecial-method-of-range-class-failed", "title": "VBA: PasteSpecial method of Range class failed", "body": "<p>I am using this to move orders from the new orders page to the previous orders page however I get the title error when I attempt to run it. I have looked at several different places to try to get it to work and I see that theirs should work but mine isn't.</p>\n\n<pre><code>Sheets(\"New_Orders\").Range(\"B3:E29\").Cut\n\nSheets(\"Previous_Orders\").Range(\"B31\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>This is more code that is supposed to do the same thing that isn't working either</p>\n\n<pre><code>Sheets(\"New_Orders\").Select\nRange(\"B3:E29\").Select\nSelection.Cut\nSheets(\"Previous_Orders\").Select\nRange(\"B:B\").Find(\"\").Select\nActiveSheet.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>I have tried Selection.Copy as well. It gave the same error</p>\n"}, {"tags": ["sql", "excel", "vba", "recordset"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481144484, "post_id": 41026931, "comment_id": 69261938, "body": "Are you getting an error? Where? What&#39;s the exact problem you&#39;re having with your code?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1481144657, "post_id": 41026931, "comment_id": 69262040, "body": "If you just want the count then <code>strSql = &quot;SELECT count(*) as numRecs FROM tbl_hoze&quot;</code> should be more efficient."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5498727, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/oIzcx.jpg?s=128&g=1", "display_name": "sasan mohammadi", "link": "https://stackoverflow.com/users/5498727/sasan-mohammadi"}, "edited": false, "score": 0, "creation_date": 1481146362, "post_id": 41027224, "comment_id": 69262930, "body": "hi, if i remove  rs.MoveLast it show me -1 in result"}, {"owner": {"reputation": 67, "user_id": 5498727, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/oIzcx.jpg?s=128&g=1", "display_name": "sasan mohammadi", "link": "https://stackoverflow.com/users/5498727/sasan-mohammadi"}, "edited": false, "score": 0, "creation_date": 1481146560, "post_id": 41027224, "comment_id": 69263008, "body": "i use below code bu the result is incorrect:         <code>strSql = &quot;SELECt * FROM tbl_hoze&quot;         Set rs = cn.Execute(strSql)         arr = rs.GetRows()         MsgBox UBound(arr)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 67, "user_id": 5498727, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/oIzcx.jpg?s=128&g=1", "display_name": "sasan mohammadi", "link": "https://stackoverflow.com/users/5498727/sasan-mohammadi"}, "edited": false, "score": 0, "creation_date": 1481149808, "post_id": 41027224, "comment_id": 69264539, "body": "@sasanmohammadi <code>.GetRows() </code> returns a 2D array with the columns being the first dimension and the rows the second.  <code>MsgBox UBound(arr, 2)</code> will return the row count.  Alternative, you could transpose the array: <code>arr = Application.Transpose(rs.GetRows)</code>"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1481144211, "creation_date": 1481144211, "answer_id": 41027224, "question_id": 41026931, "link": "https://stackoverflow.com/questions/41026931/how-to-get-the-number-of-records-in-excel-vba-recordeset/41027224#41027224", "title": "how to get the number of records in excel vba recordeset", "body": "<p>Assuming that your SQL statement is executed successfully and you get the recordset, I would get the rows in an array and use the array to do whatever I want. RecordCount function fails sometimes, this has happened to me often.</p>\n\n<p>Moreover, I don't know why you are using rs.MoveLast before you wanted to print the number of records. Delete it or move it to after msgbox line and see what happens. In short, you would do this:</p>\n\n<pre><code>dim arr() as variant\n\narr=rs.GetRows()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "is_accepted": false, "score": 0, "last_activity_date": 1502114658, "creation_date": 1502114658, "answer_id": 45548848, "question_id": 41026931, "link": "https://stackoverflow.com/questions/41026931/how-to-get-the-number-of-records-in-excel-vba-recordeset/45548848#45548848", "title": "how to get the number of records in excel vba recordeset", "body": "<p>I've ran into this problem whenever I'm working with a SQL Server DB (not so much with Access). So I've worked out this quick function that should be able to give you the row count of a SQL Server Recordset. </p>\n\n<pre><code>Private Function GetSQLRecordCount(rs As Recordset) As Integer\n\n    Dim retVal As Integer: retVal = 0\n    On Error GoTo NOROWSRETURNED\n        Dim counterArray() As Variant: counterArray = rs.GetRows()\n        retVal = UBound(counterArray, 2) - LBound(counterArray, 2) + 1\n    On Error GoTo 0\n\n    GetSQLRecordCount = retVal\n\n    Exit Function\nNOROWSRETURNED:\n    retVal = 0\n    GetSQLRecordCount = retVal\n\nEnd Function\n</code></pre>\n\n<p>I've been using this frequently recently, and it's been pretty solid.</p>\n"}], "owner": {"reputation": 67, "user_id": 5498727, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/oIzcx.jpg?s=128&g=1", "display_name": "sasan mohammadi", "link": "https://stackoverflow.com/users/5498727/sasan-mohammadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4334, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1502114658, "creation_date": 1481143084, "question_id": 41026931, "link": "https://stackoverflow.com/questions/41026931/how-to-get-the-number-of-records-in-excel-vba-recordeset", "title": "how to get the number of records in excel vba recordeset", "body": "<p>I want to get the total number of records in a record set using vba in excel, i used below code but it not running . maybe help me!</p>\n\n<pre><code> Set cn = CreateObject(\"ADODB.Connection\")\n    strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp;   Application.ActiveWorkbook.Path &amp; \"\\infodb.mdb\"\n    cn.Open strConnection\n\nstrSql = \"SELECt * FROM tbl_hoze\"\n        Set rs = cn.Execute(strSql)\n            rs.MoveLast\n            MsgBox rs.RecordCount\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 173, "user_id": 7231007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e984822b5caf20ac3d48447b3eb117?s=128&d=identicon&r=PG&f=1", "display_name": "jwdasdk", "link": "https://stackoverflow.com/users/7231007/jwdasdk"}, "edited": false, "score": 0, "creation_date": 1481143793, "post_id": 41026825, "comment_id": 69261494, "body": "You should choose a method to refer to Worksheets and stick with it .. altering between sheet code name and sheet tabname ... makes the code not very readable. For instance are <code>Sheet1</code> and <code>Worksheets(&quot;Sheet1&quot;)</code> the same sheet.   ... and to which sheet does <code>Subscriber</code> refer to ... I don&#39;t see a <code>Set</code> statement anywhere assigning anything to that variable. You need to provide a little more details ... plz."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481144140, "post_id": 41026825, "comment_id": 69261742, "body": "(a) Note that <code>Worksheets(\u201cSheet1\u201d)</code> will not usually work - you should be using <code>Worksheets(&quot;Sheet1&quot;)</code>.  (b) What do you mean by &quot;nothing is happening&quot;?  (c) Does stepping through the code show it going into the <code>For i = 2 To lastrow</code> loop, or does it skip over it (i.e. <code>lastrow</code> is less than 2)?"}], "answers": [{"tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 1, "last_activity_date": 1481145681, "last_edit_date": 1481145681, "creation_date": 1481144565, "answer_id": 41027318, "question_id": 41026825, "link": "https://stackoverflow.com/questions/41026825/copying-specific-columns-from-1-excel-sheet-to-another-using-vba/41027318#41027318", "title": "Copying specific columns from 1 excel sheet to another using VBA", "body": "<p>Let's say you want to copy column i in worksheet A to column j in worksheet B. One line can do this for you:</p>\n\n<p><strong>to copy values only:</strong></p>\n\n<pre><code>worksheets(\"B\").columns(j).value=worksheets(\"A\").columns(i).value\n</code></pre>\n\n<p><strong>to copy everything:</strong></p>\n\n<pre><code>worksheets(\"A\").columns(i).Copy\nworksheets(\"B\").columns(j).PasteSpecial xlPasteAll\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7264410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01282ca7e31168c56a2bf796cd0d29c9?s=128&d=identicon&r=PG&f=1", "display_name": "cmorrow", "link": "https://stackoverflow.com/users/7264410/cmorrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481145681, "creation_date": 1481142632, "last_edit_date": 1481142669, "question_id": 41026825, "link": "https://stackoverflow.com/questions/41026825/copying-specific-columns-from-1-excel-sheet-to-another-using-vba", "title": "Copying specific columns from 1 excel sheet to another using VBA", "body": "<p>I have this formula below that states it should transfer the specific columns I have for 1 worksheet to the ones I specified in the 2nd one. However, nothing is happening. Would really appreciate some help!</p>\n\n<pre><code>Sub copycolumns()\nDim lastrow As Long, erow As Long\n\nlastrow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To lastrow\nSheet1.Cells(i, 2).Copy\nairow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nSheet1.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 1)\n\nSubscriber.Cells(i, 1).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 2)\n\nSubscriber.Cells(i, 3).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 3)\n\nSubscriber.Cells(i, 4).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 4)\n\nSubscriber.Cells(i, 5).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 5)\n\nSubscriber.Cells(i, 6).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 6)\n\nSubscriber.Cells(i, 11).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 25)\n\nSubscriber.Cells(i, 12).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 26)\n\nSubscriber.Cells(i, 13).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 27)\n\nSubscriber.Cells(i, 14).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 28)\n\nSubscriber.Cells(i, 16).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 19)\n\nSubscriber.Cells(i, 17).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 7)\n\nSubscriber.Cells(i, 18).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 9)\n\nSubscriber.Cells(i, 19).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 13)\n\nSubscriber.Cells(i, 20).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 14)\n\nSubscriber.Cells(i, 23).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 15)\n\nSubscriber.Cells(i, 24).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 16)\n\nSubscriber.Cells(i, 25).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 10)\n\nSubscriber.Cells(i, 26).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 11)\n\nSubscriber.Cells(i, 27).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 12)\n\nSubscriber.Cells(i, 29).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 31)\n\nSubscriber.Cells(i, 30).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 17)\n\nSubscriber.Cells(i, 31).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 22)\n\nSubscriber.Cells(i, 32).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 23)\n\nSubscriber.Cells(i, 33).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 18)\n\nSubscriber.Cells(i, 33).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 32)\n\nSubscriber.Cells(i, 38).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 24)\n\nSubscriber.Cells(i, 42).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 29)\n\nSubscriber.Cells(i, 44).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 30)\n\nSubscriber.Cells(i, 46).Copy\nSubscriber.Paste Destination:=Worksheets(\u201cSheet1\u201d).Cells(airow, 3)\n\nNext i\n\nApplication.CutCopyMode = False\n\nRange(\u201cA1\u201d).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "windows-7"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481148284, "post_id": 41026800, "comment_id": 69263860, "body": "They use completely different stacks - <a href=\"https://support.microsoft.com/en-us/kb/290761\" rel=\"nofollow noreferrer\">this is what MS has to say</a>. I can&#39;t speak authoritatively, but IIR this will send your credentials in clear text."}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1497273665, "creation_date": 1497273665, "answer_id": 44500548, "question_id": 41026800, "link": "https://stackoverflow.com/questions/41026800/excel-vba-msxml2-xmlhttp-6-0-vs-msxml2-serverxmlhttp-6-0/44500548#44500548", "title": "Excel VBA Msxml2.XMLHTTP.6.0 vs Msxml2.ServerXMLHTTP.6.0", "body": "<p>Welcome to VBA and StackOverflow.  Your notes are thorough and so the only thing I can suggest is that you check your proxy settings.</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/289481/you-may-need-to-run-the-proxycfg-tool-for-serverxmlhttp-to-work\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/289481/you-may-need-to-run-the-proxycfg-tool-for-serverxmlhttp-to-work</a></p>\n\n<p>That link was buried in this link</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/290761/frequently-asked-questions-about-serverxmlhttp\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/290761/frequently-asked-questions-about-serverxmlhttp</a></p>\n\n<p>which you were referred to by <a href=\"https://stackoverflow.com/users/4088852/comintern\">ComIntern</a></p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 3142056, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1554ec5d3afdcf3f3992b1bf433373bb?s=128&d=identicon&r=PG&f=1", "display_name": "user3142056", "link": "https://stackoverflow.com/users/3142056/user3142056"}, "is_accepted": false, "score": 1, "last_activity_date": 1512754539, "creation_date": 1512754539, "answer_id": 47719480, "question_id": 41026800, "link": "https://stackoverflow.com/questions/41026800/excel-vba-msxml2-xmlhttp-6-0-vs-msxml2-serverxmlhttp-6-0/47719480#47719480", "title": "Excel VBA Msxml2.XMLHTTP.6.0 vs Msxml2.ServerXMLHTTP.6.0", "body": "<p>This <a href=\"https://blog.srpcs.com/picking-the-correct-xmlhttp-object/\" rel=\"nofollow noreferrer\">blog post</a> says that ServerXLMHTTP will not work through a proxy on the client, but XMLHTTP will.  In Excel VBA I was using ServerXLMHTTP.6.0, and it was failing for some clients inside corporate networks, whereas XMLHTTP worked.</p>\n"}], "owner": {"reputation": 91, "user_id": 7264327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069888084515f6efc32a9c10e7c8ad02?s=128&d=identicon&r=PG&f=1", "display_name": "AdamK33", "link": "https://stackoverflow.com/users/7264327/adamk33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18340, "favorite_count": 4, "answer_count": 2, "score": 9, "last_activity_date": 1589972700, "creation_date": 1481142543, "last_edit_date": 1495542333, "question_id": 41026800, "link": "https://stackoverflow.com/questions/41026800/excel-vba-msxml2-xmlhttp-6-0-vs-msxml2-serverxmlhttp-6-0", "title": "Excel VBA Msxml2.XMLHTTP.6.0 vs Msxml2.ServerXMLHTTP.6.0", "body": "<p>I am a self-taught, amateur programmer, and I am new to this forum. Please bear with me.</p>\n\n<p>About two years ago, I wrote a simple Excel vba program to login in to a website and grab a customer statement in the form of a .csv file. My program utilizes GET and POST requests. This program worked perfectly (for my needs) until about three weeks ago, when it unfortunately broke on me. The program could not get through the initial GET request. Specifically, it would break on the getReq.send line.</p>\n\n<p>I came across this post:\n<a href=\"https://stackoverflow.com/questions/35906564/login-into-website-using-msxml2-xmlhttp-instead-of-internetexplorer-application\">Login into website using MSXML2.XMLHTTP instead of InternetExplorer.Application with VBA</a></p>\n\n<p>Here, I learned that you can use \"Msxml2.XMLHTTP.6.0\" instead of \"Msxml2.ServerXMLHTTP.6.0\". I modified my code accordingly, eliminating the need to parse cookies after the Get request, and it worked! But I have no idea. Even though I got it to work, I do not feel like I have learned much in the process.</p>\n\n<p>Some information to note:</p>\n\n<ul>\n<li>My original program broke on my work computer (WindowsXP).</li>\n<li>Figuring that it may be an XP issue, and in the market for a new machine anyway, I updated to a new computer running Windows7. The program still did not work, though I received a different error message.</li>\n<li>I ran my code on a Windows10 computer and it worked fine.</li>\n<li>I use identical code to connect to various other websites and it works fine, regardless of what operating system.</li>\n</ul>\n\n<p>So, my specific questions:</p>\n\n<ol>\n<li>Why might the code work with Msxml2.XMLHTTP.6.0 but not Msxml2.ServerXMLHTTP.6.0?</li>\n<li>And why might the code have broken in the first place?</li>\n<li>Why would the code work on one particular website, but no another?</li>\n</ol>\n\n<p>Any insight would be greatly appreciated. I have attached my code (with login info X'd out).</p>\n\n<pre><code>Sub RCGInquiry()\n\n    Dim postReq, getReq, cookies\n    Dim p0 As Integer, p1 As Integer, temp As String\n    Dim result As String, respHead As String\n\n    Set getReq = CreateObject(\"Msxml2.ServerXMLHTTP.6.0\")\n    'Set getReq = CreateObject(\"Msxml2.XMLHTTP.6.0\")\n\n    ' Visit homepage so we can find the cookies\n    getReq.Open \"GET\", \"https://www.rcginquiry.com/sfs/Entry\", False\n    getReq.send\n\n    respHead = getReq.getAllResponseHeaders\n\n     Debug.Print respHead\n\n    ' Need to parse the cookie from Respone Headers\n    cookies = \"\"\n    p0 = 1\n    Do While InStr(p0, respHead, \"Set-Cookie:\") &gt; 0\n        p0 = InStr(p0, respHead, \"Set-Cookie:\") + 11\n        p1 = InStr(p0, respHead, Chr(10))\n        temp = Trim(Mid(respHead, p0, p1 - p0))\n        cookies = cookies &amp; temp &amp; \"; \"\n    Loop\n    cookies = Left(cookies, Len(cookies) - 2)\n\n    ' Debug.Print cookies\n\n    ' Login\n    Set postReq = CreateObject(\"Msxml2.ServerXMLHTTP.6.0\")\n    'Set postReq = CreateObject(\"Msxml2.XMLHTTP.6.0\")\n    postReq.Open \"POST\", \"https://www.rcginquiry.com/sfs/Entry\", False\n    postReq.setRequestHeader \"Cookie\", cookies\n    postReq.setRequestHeader \"Content-type\", \"application/x-www-form-urlencoded\" 'send appropriate Headers\n    postReq.send \"Usrid=XXXX&amp;Psswd=XXXX\" ' send login info\n\n    '-------------------------------------------------------------------------------\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    Dim FSO As Object\n    Dim myFile As Object\n    Dim path As String\n    Dim y As Integer\n\n    curDate = Format(Date, \"mm_dd_yy\")\n\n    ' Download CSV\n    postReq.Open \"POST\", \"https://www.rcginquiry.com/sfs/Downloads/tmp.csv?filetype=POS&amp;format=MFA20&amp;heading=true&amp;allaccts=true&amp;junk=tmp.csv\", False\n    postReq.setRequestHeader \"Cookie\", cookies 'must resend cookies so it knows i am logged in\n    postReq.setRequestHeader \"Content-type\", \"application/x-www-form-urlencoded\"\n    postReq.send \"filetype=POS&amp;format=MFA20&amp;heading=true&amp;allaccts=true&amp;junk=temp.csv\" 'url query parameters\n\n    ' Writes responseText to a .csv file\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set myFile = FSO.createtextfile(\"C:\\Users\\Adam\\Desktop\\POSITION\\\" &amp; curDate &amp; \".csv\", True)\n    myFile.write (postReq.responseText)\n    myFile.Close\n\n    Set FSO = Nothing\n    Set myFile = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1481142277, "post_id": 41026432, "comment_id": 69260692, "body": "The <code>.Column</code> returns the column number property of a range object, which is what you want.  However, the way they are getting it is wholly unnecessary.  A simple equivalent would be: <code>ActiveSheet.UsedRange.Columns.Count</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1481142425, "post_id": 41026432, "comment_id": 69260777, "body": "Note that relying on <code>UsedRange</code> to get the last row or column is notoriously unreliable however.  I would instead recommend performing a <code>Range.End</code> or a <code>Range.Find</code> to get the last row or column number."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1481147252, "post_id": 41026432, "comment_id": 69263380, "body": "@tigeravatar - Not <i>exactly</i> equivalent, given that <code>UBound(ActiveSheet.UsedRange.Value, 2)</code> is a runtime error if the <code>UsedRange</code> is less than 2 cells.  Also, the <code>UsedRange</code> doesn&#39;t have to begin in column A, so you can&#39;t just use the <code>Count</code>.  You need <code>.UsedRange.Columns(.UsedRange.Columns.Count).Column</code> (assuming <code>With SomeSheet</code>).  Like you said, best avoided entirely."}, {"owner": {"reputation": 105, "user_id": 7143169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/20b147e4c754fea37adf92aec7a59374?s=128&d=identicon&r=PG&f=1", "display_name": "Schbabako", "link": "https://stackoverflow.com/users/7143169/schbabako"}, "edited": false, "score": 0, "creation_date": 1481150913, "post_id": 41026432, "comment_id": 69265005, "body": "The code works without any problems. It finds the last column with data in it. Since i know that we start at Column A i should have not problem with finding the right last column number."}], "owner": {"reputation": 105, "user_id": 7143169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/20b147e4c754fea37adf92aec7a59374?s=128&d=identicon&r=PG&f=1", "display_name": "Schbabako", "link": "https://stackoverflow.com/users/7143169/schbabako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481141312, "creation_date": 1481141312, "last_edit_date": 1531161705, "question_id": 41026432, "link": "https://stackoverflow.com/questions/41026432/usedrange-propertie-explanation", "title": "UsedRange Propertie explanation", "body": "<p>I have a question concerning the use of UsedRange in my code.\nThe part that bothers me is:</p>\n\n<pre><code>lastcol = ActiveSheet.UsedRange.Columns(UBound(ActiveSheet.UsedRange.Value, 2)).Column\n</code></pre>\n\n<p>I just want to get the last column in numeric form from this. It would have been enough to just use the UBound part but my predecessor chose to do it like that. I don't understand what the last part \".column\" does. What does this \".column\" do in the end?\nOr in total why does the whole code work?</p>\n"}, {"tags": ["excel", "vba", "loops", "procedure", "large-data"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6402120"}, "edited": false, "score": 0, "creation_date": 1481140793, "post_id": 41026198, "comment_id": 69259761, "body": "Basically, it is finding most efficient way to distribute production procedures (phases) amoung operators by their level of knowledge and speed. Operators are always changing (sometimes hourly) but we have fixed number of max operators - 16,procedures are changing daily, except that certain procedures needs to be excluded from calculations and added to certain operators instantly while distributing his available capacity amoung other n operators in that case. As tested, this macro works and does what I need (when I reduce number of operators to 8 and therefore reduce the size of code)."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 9, "creation_date": 1481141183, "post_id": 41026198, "comment_id": 69260007, "body": "Refactor your code. You&#39;ve written it like it&#39;s 30 years ago. Break certain functionality into defined functions, and pass arguments. This really needs rebuilding from the ground up.."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 4, "creation_date": 1481141211, "post_id": 41026198, "comment_id": 69260025, "body": "All the <code>GoTo</code>s are bad practice.  Try rewriting the code without using any <code>GoTo</code>s as I suspect that is related the problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6402120"}, "edited": false, "score": 0, "creation_date": 1481141498, "post_id": 41026198, "comment_id": 69260208, "body": "Yup, I believe it looks prehistoric. I<code>m quite a noob, I know what I need but I</code>m building it like a lego, from fractions of what I know."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1481141509, "post_id": 41026198, "comment_id": 69260213, "body": "Shameless plug: <a href=\"http://stackoverflow.com/a/29991570/1188513\">vba code refactoring - are there any tools to assist?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6402120"}, "edited": false, "score": 0, "creation_date": 1481141598, "post_id": 41026198, "comment_id": 69260280, "body": "How could I make some of this variables global? I dont quite know how to use it, but it could possibly give me opportunity to break the code in smaller routines! For example functions with &quot;I&quot;s and &quot;KK&quot;s could be in other subroutines but as soon as I break the part of code with those variable it values is reset to 0 (in that subroutine)!"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481142392, "post_id": 41026198, "comment_id": 69260752, "body": "Not true, you can always pass variables back and forth to functions and subs."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481143380, "post_id": 41026198, "comment_id": 69261271, "body": "Frankly, you need to hire an experienced VBA programmer and have them spend a couple of weeks on a complete rewrite. Thousands of lines of code like this is almost definitely suboptimal, buggy, or both. It could be risky to base business decisions on it. Furthermore, it sounds like you are trying to code an ad-hoc solution to a linear programming problem. Excel&#39;s built-in solver can handle that. What you really need is a VBA programmer who knows operations research. If you want to develop the skills yourself, see the book &quot;VBA for Modelers&quot; by Chris Albright."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6402120"}, "edited": false, "score": 0, "creation_date": 1481143527, "post_id": 41026198, "comment_id": 69261351, "body": "But I tried and received a error. When Ive checked, in subroutine variable &quot;I&quot; and variable &quot;KK&quot; which is constantly updating in loop in main routine had value 0 in subroutine section even if it should have let say 93!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6402120"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1481143952, "post_id": 41026198, "comment_id": 69261607, "body": "Thnx @John Coleman for book suggestion, and also for solution suggestion, but unfortunately, our IT`s in company specialiased in different areas, so Im stuck with what I have, and due extremly large amount of data and operations we have on daily basis I must figure something on my own. So far it was ok, but maybe I was just lucky. As I said code finished OK and perfectly distributed operations but only with less No of operators (guess because of my prehistoric way of wrting code)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6402120"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481211271, "post_id": 41026198, "comment_id": 69293812, "body": "Thank you all for help guys, @Mat`s Mug and @John Coleman, you both have very good points and reffer to proper solution for my problem, but unfortunately i had to deal with it differently (to be honest to @MatsMug I didnt quite got what to do with add-in). I solved it with modifying my code a bit and making some variables global so it can be refactored. I know it is maybe prehistoric and not as it should be but it was done with what I know and what I have."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481211610, "post_id": 41026198, "comment_id": 69294061, "body": "@IvanKo\u010di\u0161 if your code works as intended now, take it to <a href=\"https://codereview.stackexchange.com\">Code Review</a> to learn how to improve your code structure and avoid it in the future."}], "owner": {"user_type": "does_not_exist", "display_name": "user6402120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "closed_date": 1481142989, "answer_count": 0, "score": 0, "last_activity_date": 1506000955, "creation_date": 1481140474, "last_edit_date": 1506102294, "question_id": 41026198, "link": "https://stackoverflow.com/questions/41026198/vba-procedure-too-large", "closed_reason": "Duplicate", "title": "VBA Procedure too large", "body": "<p>As I receive \"PROCEDURE TOO LARGE\" compile error I divided my code in multiple smaller subroutines, but I still receive this error and I don`t know how to divide it more.\nHere is the part of code that I didnt know how to divide more (as variable \"I\" doesnt update in main code as it should - it value is reset to 0 same as other variables included:</p>\n\n<pre><code>X7 = 109\nZ7 = 0\n\nFor Q7 = 92 + Z6 To X6\n  If Cells(Q7, I + 4).Value = \"\" Then GoTo OPERATOR7I\n  If Cells(Q7, I + 4).Value &gt;= TARGET - 0.01 Then GoTo OPERATOR7H\n  If Cells(Q7, I + 4).Value &lt; TARGET - 0.01 Then\n    Cells(X7, I + 1).Value = Cells(Q7, I + 1).Value\n    Cells(X7, I + 4).Value = TARGET - Cells(Q7, I + 4).Value\n    Z7 = Z7 + 1\n  End If\n\n  If Cells(123, I + 5).Value &lt; 60 + KK - 0.5 Then GoTo OPERATOR7F\n  If Cells(123, I + 5).Value &gt; 60 + KK - 0.5 And Cells(123, I + 5).Value &lt; 60 + KK + 0.5 Then GoTo OPERATOR7D\n  If Cells(123, I + 5).Value &gt; 60 + KK + 0.5 Then GoTo OPERATOR7G\n\nOPERATOR7G:\n  Cells(X7, I + 4).Value = Cells(X7, I + 4).Value - 1\n  If Cells(123, I + 5).Value &gt; 60 + KK + 0.5 Then GoTo OPERATOR7G\n  If Cells(123, I + 5).Value &gt; 60 + KK - 0.5 And Cells(123, I + 5).Value &lt; 60 + KK + 0.5 Then GoTo OPERATOR7D\n\nOPERATOR7I:\nOPERATOR7F:\n  If Z7 = 0 Then GoTo LOOP0EDIT7\n  X7 = X7 + 1\n\nLOOP0EDIT7:\nOPERATOR7H:\nNext Q7\n\nIf Application.Sum(Range(Cells(7, I + 15), Cells(Y1, I + 15))) &lt; 0.01 Then                  GoTo LOOPRECALC7B\nFor XOXO7 = 7 To Y1\n  If Cells(XOXO7, I + 15).Value &gt; 0.01 Then\n    Cells(X7, I + 1).Value = Cells(XOXO7, 3).Value\n    Cells(X7, I + 4).Value = Cells(XOXO7, I + 15).Value\n    X7 = X7 + 1\n    Z7 = Z7 + 1\n  End If\nNext XOXO7\nLOOPRECALC7C:\nIf Cells(123, I + 5).Value &gt; 60 + KK + 0.5 Then GoTo LOOPRECALC7A\nIf Cells(123, I + 5).Value &gt; 60 + KK - 0.5 And Cells(123, I + 5).Value &lt; 60 + KK + 0.5 Then GoTo LOOPRECALC7B\nIf Cells(123, I + 5).Value &lt; 60 + KK - 0.5 Then GoTo LOOPRECALC7B\n\nLOOPRECALC7A:\nCells(X7, I + 4).Value = Cells(X7, I + 4).Value - 1\nGoTo LOOPRECALC7C\n\nLOOPRECALC7B:\n\nOPERATOR7A:\nIf Cells(Y1 + 1, 3).Value = \"\" Then GoTo EXITLOOP7\nIf Cells(Y1 + 1, 4).Value = \"Kontrola kvaliteta.\" Then GoTo QUALITYLOOP7A\nCells(X7, I + 1).Value = Cells(Y1 + 1, 3).Value\nCells(X7, I + 4).Value = TARGET\nY1 = Y1 + 1\nGoTo QUALITYLOOP7B\n\nQUALITYLOOP7A:\nY1 = Y1 + 1\nGoTo OPERATOR7A\n\nQUALITYLOOP7B:\nOPERATOR7E:\nIf Cells(123, I + 5).Value &lt; 60 + KK - 0.5 Then GoTo OPERATOR7B\nIf Cells(123, I + 5).Value &gt; 60 + KK - 0.5 And Cells(123, I + 5).Value &lt; 60 + KK + 0.5 Then GoTo OPERATOR7D\nIf Cells(123, I + 5).Value &gt; 60 + KK + 0.5 Then GoTo OPERATOR7C\n\nOPERATOR7B:\nX7 = X7 + 1\nGoTo OPERATOR7A\n\nOPERATOR7C:\nCells(X7, I + 4).Value = Cells(X7, I + 4).Value - 1\nGoTo OPERATOR7E\n\nOPERATOR7D:\nEXITLOOP7:\n\n'OPERATOR8 LOOP\n\nX8 = 126\nZ8 = 0\n\nFor Q8 = 109 + Z7 To X7\n  If Cells(Q8, I + 4).Value = \"\" Then GoTo OPERATOR8I\n  If Cells(Q8, I + 4).Value &gt;= TARGET - 0.01 Then GoTo OPERATOR8H\n  If Cells(Q8, I + 4).Value &lt; TARGET - 0.01 Then\n    Cells(X8, I + 1).Value = Cells(Q8, I + 1).Value\n    Cells(X8, I + 4).Value = TARGET - Cells(Q8, I + 4).Value\n    Z8 = Z8 + 1\n  End If\n\n  If Cells(140, I + 5).Value &lt; 60 + KK - 0.5 Then GoTo OPERATOR8F\n  If Cells(140, I + 5).Value &gt; 60 + KK - 0.5 And Cells(140, I + 5).Value &lt; 60 + KK + 0.5 Then GoTo OPERATOR8D\n  If Cells(140, I + 5).Value &gt; 60 + KK + 0.5 Then GoTo OPERATOR8G\n\nOPERATOR8G:\n  Cells(X8, I + 4).Value = Cells(X8, I + 4).Value - 1\n  If Cells(140, I + 5).Value &gt; 60 + KK + 0.5 Then GoTo OPERATOR8G\n  If Cells(140, I + 5).Value &gt; 60 + KK - 0.5 And Cells(140, I + 5).Value &lt; 60 + KK + 0.5 Then GoTo OPERATOR8D\n\nOPERATOR8I:\nOPERATOR8F:\n  If Z8 = 0 Then GoTo LOOP0EDIT8\n  X8 = X8 + 1\n\nLOOP0EDIT8:\nOPERATOR8H:\nNext Q8\n\nIf Application.Sum(Range(Cells(7, I + 15), Cells(Y1, I + 15))) &lt; 0.01 Then GoTo LOOPRECALC8B\nFor XOXO8 = 7 To Y1\n  If Cells(XOXO8, I + 15).Value &gt; 0.01 Then\n    Cells(X8, I + 1).Value = Cells(XOXO8, 3).Value\n    Cells(X8, I + 4).Value = Cells(XOXO8, I + 15).Value\n    X8 = X8 + 1\n    Z8 = Z8 + 1\n  End If\nNext XOXO8\nLOOPRECALC8C:\nIf Cells(140, I + 5).Value &gt; 60 + KK + 0.5 Then GoTo LOOPRECALC8A\nIf Cells(140, I + 5).Value &gt; 60 + KK - 0.5 And Cells(140, I + 5).Value &lt; 60 + KK + 0.5 Then GoTo LOOPRECALC8B\nIf Cells(140, I + 5).Value &lt; 60 + KK - 0.5 Then GoTo LOOPRECALC8B\n\nLOOPRECALC8A:\nCells(X8, I + 4).Value = Cells(X8, I + 4).Value - 1\nGoTo LOOPRECALC8C\n\nLOOPRECALC8B:\n\nOPERATOR8A:\nIf Cells(Y1 + 1, 3).Value = \"\" Then GoTo EXITLOOP8\nIf Cells(Y1 + 1, 4).Value = \"Kontrola kvaliteta.\" Then GoTo QUALITYLOOP8A\nCells(X8, I + 1).Value = Cells(Y1 + 1, 3).Value\nCells(X8, I + 4).Value = TARGET\nY1 = Y1 + 1\nGoTo QUALITYLOOP8B\n\nQUALITYLOOP8A:\nY1 = Y1 + 1\nGoTo OPERATOR8A\n\nQUALITYLOOP8B:\nOPERATOR8E:\nIf Cells(140, I + 5).Value &lt; 60 + KK - 0.5 Then GoTo OPERATOR8B\nIf Cells(140, I + 5).Value &gt; 60 + KK - 0.5 And Cells(140, I + 5).Value &lt; 60 + KK + 0.5 Then GoTo OPERATOR8D\nIf Cells(140, I + 5).Value &gt; 60 + KK + 0.5 Then GoTo OPERATOR8C\n\nOPERATOR8B:\nX8 = X8 + 1\nGoTo OPERATOR8A\n\nOPERATOR8C:\nCells(X8, I + 4).Value = Cells(X8, I + 4).Value - 1\nGoTo OPERATOR8E\n\nOPERATOR8D:\nEXITLOOP8:\n</code></pre>\n\n<p>Code goes on and on with these LOOPS (X9, X10, X11....) and variables \"KK\" &amp; \"I\" are also used in other parts of code for other functiones (some of them are divided into smaller subroutines)! How to shorten this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1481145833, "post_id": 41026194, "comment_id": 69262667, "body": "What do you mean by &quot;does not apply my formulas in any of the cells&quot;? do the cells remain blank?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481149692, "post_id": 41026194, "comment_id": 69264485, "body": "(a) What is the address of <code>ActiveCell</code> when your code starts?  (b) What formula is in <code>T2</code> when your code starts (assuming <code>T2</code> is not the <code>ActiveCell</code>)? (c) What is the value of <code>LastRow</code>?"}, {"owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "edited": false, "score": 0, "creation_date": 1481150543, "post_id": 41026194, "comment_id": 69264853, "body": "A.S.H yes remains blank. i just want the make J3:N3 = T2:X2. s0 if j3 is 5 make T2 5.."}, {"owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "edited": false, "score": 0, "creation_date": 1481150710, "post_id": 41026194, "comment_id": 69264922, "body": "So i select t2 and then make =J3. that is the formula. LastRow is 147."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481151494, "post_id": 41026194, "comment_id": 69265251, "body": "To avoid any chance of having selected the wrong cell (and thus applying the formula in the wrong location) change <code>ActiveCell.FormulaR1C1 = &quot;=R[1]C[-10]&quot;</code> <code>Range(&quot;T2&quot;).Select</code> to <code>Range(&quot;T2&quot;).FormulaR1C1 = &quot;=R[1]C[-10]&quot;</code>."}, {"owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "edited": false, "score": 0, "creation_date": 1481198768, "post_id": 41026194, "comment_id": 69285391, "body": "Thanks YowE3K. it is working fine now. =)"}], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1481146052, "post_id": 41027471, "comment_id": 69262774, "body": "why score down?"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 1, "creation_date": 1481146639, "post_id": 41027471, "comment_id": 69263052, "body": "I&#39;m guessing that it&#39;s because you haven&#39;t provided any explanation of what was causing the OPs problem, and how your code resolves it. &quot;Code-splat&quot; answers generally aren&#39;t well received."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1481151644, "post_id": 41027471, "comment_id": 69265316, "body": "Just add the explanation and it should go up again, stack overflow is meant to point out where we are wrong in our questions and not just &quot;here you are&quot;. It helps us to learn why and how in order to be more analytical under that scope next time."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1481224066, "post_id": 41027471, "comment_id": 69301520, "body": "I added an explanation to explain how I meant to help, hope this work!"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1481224032, "last_edit_date": 1481224032, "creation_date": 1481145159, "answer_id": 41027471, "question_id": 41026194, "link": "https://stackoverflow.com/questions/41026194/copy-paste-loop/41027471#41027471", "title": "Copy paste Loop", "body": "<p>Recording a macro using the Excel UI could be useful sometimes, but what matters more is to write the code in a way to get done what you want in a better way. Also you have to think about maintaning or developing the code more in future so I suggest to remove every element that is an indication of using the UI such as activating sheets, or getting inputs  from the user through activecell, Select method etc. </p>\n\n<p>As mentioned in one of the previous comments using Range(\"T2\").FormulaR1C1 = \"=R[1]C[-10]\" would solve your problem, but if you consider two ranges as the origin and destination, then you can always do the job a lot faster and better with the least hassle to parametrise the code in a later time:</p>\n\n<pre><code>Sub CopyIt()\n    Dim rngOrigin As Range\n    Dim rngDestination As Range\n    Dim WS As Worksheet\n\n    Set WS = ActiveSheet\n    Set rngOrigin = WS.Range(\"T2:X2\")\n    Set rngDestination = WS.Range(\"J3:N3\")\n\n    rngDestination.NumberFormat = \"General\"\n    rngOrigin.Copy\n    rngDestination.PasteSpecial xlPasteFormulas\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481224032, "creation_date": 1481140465, "last_edit_date": 1531164843, "question_id": 41026194, "link": "https://stackoverflow.com/questions/41026194/copy-paste-loop", "title": "Copy paste Loop", "body": "<p>I want to make J3:N3 = T2:X2, then I want to copy the cells formulas of T2:X2 and paste, jump one and paste and so on. The code runs fine, but does not apply my formulas in any of the cells. Any idea what I am doing wrong?</p>\n\n<pre><code>WsScenarios.Activate\nApplication.CutCopyMode = False\nActiveCell.FormulaR1C1 = \"=R[1]C[-10]\"\nRange(\"T2\").Select\nSelection.AutoFill Destination:=Range(\"T2:X2\"), Type:=xlFillDefault\nSet RgnCopy = Range(\"T2:X2\")\n\ni = 4\nDo While i &lt;= LastRow    \n  RgnCopy.Copy\n  Range(Cells(i, 20), Cells(i, 24)).PasteSpecial xlPasteFormulas\n  i = i + 2        \nLoop\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1481140108, "post_id": 41026033, "comment_id": 69259329, "body": "cell&lt;&gt;columns...."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1481141742, "post_id": 41026033, "comment_id": 69260372, "body": "The fourth line from the top is an apostrophe...."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481145854, "post_id": 41026033, "comment_id": 69262685, "body": "<code>Selection.SpecialCells(xlCellTypeBlanks).Select</code> will fail if no cells are found (i.e. the column is empty).  Note that you should almost always avoid using the <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9218/never-assume-the-worksheet#t=201612072122306662861\">global collections</a>, <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate#t=201612072122306662861\"><code>Activate</code>, and <code>Select</code></a>. This is also a <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">must read</a>."}], "owner": {"reputation": 1, "user_id": 7264235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50b6523ad124a8a9fbb426b60731d82?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Harvey", "link": "https://stackoverflow.com/users/7264235/michael-harvey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481140225, "creation_date": 1481139877, "last_edit_date": 1481139947, "question_id": 41026033, "link": "https://stackoverflow.com/questions/41026033/run-time-error-1004-macos-2016", "title": "Run time error 1004 macos 2016", "body": "<p>Here is my code:</p>\n\n<pre><code>Sub SortData()\n'\n' SortData Macro\n'\n\n'\n    Columns(\"A:A\").Select\n    Selection.SpecialCells(xlCellTypeBlanks).Select\n    Selection.EntireRow.Delete\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n        :=\":\", FieldInfo:=Array(Array(1, 1), Array(2, 1))\n    Columns(\"A:A\").Select\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"A1\"), _\n        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    Columns(\"A:A\").Select\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"A1\"), _\n        SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n        .SetRange Range(\"A2:C70\")\n        .Header = xlGuess\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n\n<p>It says the problem is in the fourth line from the top. </p>\n\n<p>This macro is trying to reorganize simple data.</p>\n\n<p>Any help would be much appreciated. Thanks!</p>\n"}, {"tags": ["vba", "excel", "date", "graph"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1481139922, "post_id": 41025862, "comment_id": 69259227, "body": "Your question is unfortunately <i>too broad</i> for the Stack Overflow Q&amp;A format. Once you have a VBA function that <i>attempts</i> to solve the problem, and you&#39;re stuck with a <i>specific</i> problem, and research doesn&#39;t turn up anything, you&#39;ll have a valid question for this site. Good luck!"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1481150911, "post_id": 41025862, "comment_id": 69265004, "body": "Could we get an image of the data where it&#39;s pointed what you don&#39;t want to be counted and the code that you&#39;re using for it?"}], "owner": {"reputation": 9, "user_id": 7111719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3ba37850e9550fc686fdcdbac578b9e2?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/7111719/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481139795, "creation_date": 1481139316, "last_edit_date": 1481139795, "question_id": 41025862, "link": "https://stackoverflow.com/questions/41025862/using-vba-to-scale-excel-graph-x-axis", "title": "Using VBA to scale excel graph X-axis?", "body": "<p>I'm using a macro to generate graphs from a table such that the x-axis is a time stamp(date, time) and the y-axis is for the data at that time. So far, there is no problem getting this to work but the result is a graph that has \"blank space\" before and after the data(roughly 5-10 minutes before and after on a 1-hour time-frame). I have space constraints and this cuts into them so I'd like to utilize the entire plot area. Can I eliminate the blank space by extending the data to end of the plot area somehow? Any help is appreciated.</p>\n\n<p>Additionally the files I need to use are for different time frames and lengths of time(ie, different length of excel rows). Is there a way to only graph the rows with content instead of a \"worst-case scenario\" like using A2:A100000 because I know it will never be greater than 100,000 rows?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481140965, "post_id": 41025860, "comment_id": 69259858, "body": "Please see <a href=\"http://stackoverflow.com/q/10714251/1188513\">this post</a> for why and how you should avoid <code>Select</code> and <code>Activate</code>."}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481141069, "post_id": 41025860, "comment_id": 69259934, "body": "I replaced msgbox with debug.print, but I don&#39;t see what it&#39;s doing (sorry, I&#39;m still pretty new to vba).  How do I see the results of it?  Also, I thought I got all the selects and activates, I saw a few days ago that they were considered bad, seems I missed one, thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481141132, "post_id": 41025860, "comment_id": 69259982, "body": "Ctrl+G would bring up the immediate pane. But I removed that comment - the real problem is in the answer below: you&#39;re trying to update a collection, and you can&#39;t do that."}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481141180, "post_id": 41025860, "comment_id": 69260003, "body": "Damn.  Okay, well, thanks anyway!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481141260, "post_id": 41025860, "comment_id": 69260053, "body": "Don&#39;t forget to mark the answer as &quot;accepted&quot; by clicking the hollow checkmark next to it; that will remove your question from the pool of &quot;unanswered&quot; posts."}], "answers": [{"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1481140201, "post_id": 41025967, "comment_id": 69259372, "body": "Sorry, I got it wrong. comnum is a collection, i.e. you cannot update the value stored at the Key."}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1481141278, "post_id": 41025967, "comment_id": 69260063, "body": "Is there a way to replace it so that it&#39;s stored at the same place?  comcol and comnum (are supposed to) work so that comnum(a) tracks how many times comcol(a) appears; if they get out of order, it doesn&#39;t really work.  Or is that not possible and I should just create a dummy variable to count and then at the very end just add comcol.add (dummy_variable)?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1481141301, "post_id": 41025967, "comment_id": 69260081, "body": "@GrahamPerry you might want to look at <code>Scripting.Dictionary</code> instead of a <code>Collection</code> (reference the <i>Microsoft Scripting Runtime</i> library from the &quot;Tools&quot; menu)"}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1481141463, "post_id": 41025967, "comment_id": 69260175, "body": "I will look into it.  Thanks again."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1481140346, "last_edit_date": 1481140346, "creation_date": 1481139693, "answer_id": 41025967, "question_id": 41025860, "link": "https://stackoverflow.com/questions/41025860/object-required-error-on-two-as-near-as-i-can-tell-valid-objects/41025967#41025967", "title": "Object Required error on two as-near-as-I-can-tell valid objects", "body": "<p>You cannot update the value stored at the Key.\nWould you like to do sth like that</p>\n\n<pre><code>comnum.Add comnum(a) + 1\n</code></pre>\n\n<p>see my comment</p>\n"}], "owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 41025967, "answer_count": 1, "score": 0, "last_activity_date": 1481140346, "creation_date": 1481139314, "last_edit_date": 1531164843, "question_id": 41025860, "link": "https://stackoverflow.com/questions/41025860/object-required-error-on-two-as-near-as-i-can-tell-valid-objects", "title": "Object Required error on two as-near-as-I-can-tell valid objects", "body": "<p>Can anyone help me figure out why I'm getting an object required error on this code?  The line in question is</p>\n\n<pre><code>comnum(a) = comnum(a)+1  \n</code></pre>\n\n<p>I used msgbox to make sure both of these things actually worked, and it spat them out just fine.  But for reasons unknown to me, while vba is quite happy to read out both of those individually, setting them equal is a problem?  </p>\n\n<p>I cut out a bit of code that doesn't interact with this line in order to save on space, I hope no one minds: </p>\n\n<pre><code>Sub create_sheets(mms, dds, yys, mme, dde, yye)\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nDim fso As New FileSystemObject\nDim wb1 As Workbook\nDim wb2 As Workbook\n\nSet wb1 = ThisWorkbook\n\ndd = dds\nmm = mms\nyyyy = yys\n\n'this is where all that unrelated crap went\n'it's just formatting, checking if a filepath exists, and if it does_\n'opening the file and copying the data.  \n'It's like 60 unrelated lines, hence my omission\n\nDim comcol As New Collection\nDim comnum As New Collection\n\n            While wb1.Sheets(1).Cells(1, 4) &lt;&gt; \"\"                               'as long as data remains\n            strnum = 0                                                          'start with no counts of the string\n            stro = wb1.Sheets(1).Cells(1, 4)                                    'the string is the contents of the first row's string column\n            comcol.Add (wb1.Sheets(1).Cells(1, 5))\n            comnum.Add (0)\n\n                For c = 1 To 65536                                              'for all rows\n                    If wb1.Sheets(1).Cells(c, 4) = stro Then                    'if you see the string\n                        strnum = strnum + 1                                     'count it\n                        For a = 1 To comcol.Count                               'go through the entire collection\n                            If comcol(a) = wb1.Sheets(1).Cells(c, 5) Then       'if it finds the string, increments the count of it\n                                MsgBox comnum(a) &amp; \" and \" &amp; comnum(a) + 1\n                                comnum(a) = comnum(a) + 1\n                            End If\n                        Next a\n                        wb1.Sheets(1).Row(c).Delete\n                        c = c - 1\n                    End If\n                Next c\n\n                Sheets(\"Results\").Activate\n\n                Cells(3, 2) = Sheets(1).Cells(1, 4)\n                While comcol.Count &lt;&gt; 0\n                    Cells(4, 2) = comcol(1) &amp; \", appeared \" &amp; comcol(2) &amp; \"times\"\n                Wend\n            Wend\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481138387, "post_id": 41025541, "comment_id": 69258407, "body": "Is <code>ws</code> the same as <code>ActiveSheet</code> when this executes?"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481138592, "post_id": 41025541, "comment_id": 69258514, "body": "@Comintern - yes, I set ws = ActiveSheet.  Updated code."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1481138934, "post_id": 41025541, "comment_id": 69258697, "body": "Is this in a loop?  You don&#39;t have i defined to be anything."}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481139148, "post_id": 41025541, "comment_id": 69258817, "body": "@Rdster - copy paste error.  Full syntax now showing."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481140570, "post_id": 41025541, "comment_id": 69259596, "body": "Is the <code>For i = 2 To lr</code> correct?  If so, where is <code>lr</code> declared and set?"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1481140526, "post_id": 41025819, "comment_id": 69259571, "body": "@StarsFlyFreeFromCozyNights - I can&#39;t replicate. Do you have empty cells in the target columns?"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1481140648, "post_id": 41025819, "comment_id": 69259666, "body": "No empty cells.  column B contains text, and column C contains numbers."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1481139155, "creation_date": 1481139155, "answer_id": 41025819, "question_id": 41025541, "link": "https://stackoverflow.com/questions/41025541/set-hyperlink-through-code/41025819#41025819", "title": "Set Hyperlink Through Code", "body": "<p>The <code>TextToDisplay</code> parameter of <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822490.aspx\" rel=\"nofollow noreferrer\">HyperLinks.Add</a> is type <code>Variant</code>. That means when you pass it a <code>Range</code> object with <code>ws.Cells(i, 3)</code>, the default member (<code>.Value</code>) doesn't get called.  This causes the invalid parameter error as the function expects a <code>Variant</code> of subtype <code>String</code>.  You need to explicitly call <code>.Value</code>:</p>\n\n<pre><code>ws.Hyperlinks.Add Anchor:=ws.Cells(i, 3), Address:=\"\", _\n                  SubAddress:=\"'\" &amp; ws.Cells(i, 2).Value &amp; \"'!A1\", _\n                  TextToDisplay:=ws.Cells(i, 3).Value\n</code></pre>\n\n<p>Note that when you use named arguments, you're using a late-bound call to an early-bound interface. This is better:</p>\n\n<pre><code>ws.Hyperlinks.Add ws.Cells(i, 3), vbNullString, \"'\" &amp; ws.Cells(i, 2).Value &amp; \"'!A1\", _\n                  , ws.Cells(i, 3).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": true, "score": 2, "last_activity_date": 1481150591, "creation_date": 1481150591, "answer_id": 41028703, "question_id": 41025541, "link": "https://stackoverflow.com/questions/41025541/set-hyperlink-through-code/41028703#41028703", "title": "Set Hyperlink Through Code", "body": "<p>The TextToDisplay does need to be a string. Using CStr (convert to string) will take care of that.</p>\n\n<pre><code>TextToDisplay:=CStr(ws.cells(i, 3))\n</code></pre>\n\n<p>After making that change, this tests successfully with your sample workbook.</p>\n"}], "owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 41028703, "answer_count": 2, "score": 1, "last_activity_date": 1481150591, "creation_date": 1481138134, "last_edit_date": 1481140803, "question_id": 41025541, "link": "https://stackoverflow.com/questions/41025541/set-hyperlink-through-code", "title": "Set Hyperlink Through Code", "body": "<p>I am trying to set-up VBA syntax to create hyperlinks in a few cells.  This is what I have it down to, but I get a debug error of 'invalid procedure call or argument'</p>\n\n<p>This is my syntax that produces the err</p>\n\n<pre><code>Public Sub AddHyperlinks()\nDim ws As Worksheet, lastrow As Long, i As Long\nSet ws = ActiveSheet\nlastrow = Cells(Rows.Count, 2).End(xlUp).Row\nFor i = 2 To lastrow\n  ActiveSheet.Hyperlinks.Add Anchor:=ws.Cells(i, 3), Address:=\"\", SubAddress:=\"'\" &amp; ws.Cells(i, 2).Value &amp; \"'!A1\", TextToDisplay:=ws.Cells(i, 3)\nNext i\nEnd Sub\n</code></pre>\n\n<p><strong>Sample Workbook</strong><br>\n<a href=\"http://www.filedropper.com/book1_17\" rel=\"nofollow noreferrer\">Sample Workbook</a></p>\n"}, {"tags": ["arrays", "vba", "excel", "search"], "comments": [{"owner": {"reputation": 1, "user_id": 7263985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa6d89d3e8f5775c71a388b81e55d47?s=128&d=identicon&r=PG&f=1", "display_name": "Mattaphorica", "link": "https://stackoverflow.com/users/7263985/mattaphorica"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481137292, "post_id": 41025160, "comment_id": 69257815, "body": "(firstly I&#39;m new at this, so bear with me! This is my first ever post!) I guess that&#39;s my problem.  I don&#39;t know where to start.  Everything I&#39;ve seen so far is just looking for a certain value or is searching for the number of instances.  I&#39;m extremely inexperienced with VBA and I&#39;m not sure where to begin.  Here&#39;s what I have so far: &#39;col = 3     For row = 1 To 50         If searchterm = Matrix(row, col) Then         searchrow = row     Next row&#39;"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481137866, "post_id": 41025160, "comment_id": 69258118, "body": "Code should be edited into your original question, it is too hard to read as a comment."}, {"owner": {"reputation": 1, "user_id": 7263985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa6d89d3e8f5775c71a388b81e55d47?s=128&d=identicon&r=PG&f=1", "display_name": "Mattaphorica", "link": "https://stackoverflow.com/users/7263985/mattaphorica"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481137896, "post_id": 41025160, "comment_id": 69258137, "body": "Bleh, that looks terrible.  I edited the post so you can see the code I&#39;m using!  Thanks."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481137934, "post_id": 41025160, "comment_id": 69258155, "body": "You will need an End If for one..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1481140151, "post_id": 41025160, "comment_id": 69259353, "body": "Try this instead of your For loop <code>MsgBox Application.Match(searchterm, Application.Index(matrix, col), 0)</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1481140911, "creation_date": 1481140911, "answer_id": 41026322, "question_id": 41025160, "link": "https://stackoverflow.com/questions/41025160/search-for-a-string-in-an-array-and-store-the-row-number-in-which-it-occurs/41026322#41026322", "title": "Search for a string in an array and store the row number in which it occurs?", "body": "<p>Arrays are intrinsically fast.  This function will return an array of indices.  The return value will be empty if the lookup value isn't found.  </p>\n\n<h2>Usage</h2>\n\n<pre><code>indices = getValueIndices(8, DataArray)\n\nIf not isEmpty(indices) then\n    x = indices(0)\n    y = indices(1)\nEnd if\n</code></pre>\n\n<h2>Function</h2>\n\n<pre><code>Function getValueIndices(Value As Variant, DataArray As Variant) As Variant\n    Dim x As Long, y As Long\n    Dim is2d As Boolean\n    Dim v As Variant\n    x = LBound(DataArray, 1)\n\n    On Error Resume Next\n    is2d = UBound(DataArray, 2)\n    On Error GoTo 0\n\n    If is2d Then y = LBound(DataArray, 2)\n\n    For Each v In DataArray\n        If v = Value Then\n            If is2d Then\n                getValueIndices = Array(x, y)\n            Else\n                getValueIndices = Array(x)\n            End If\n            Exit Function\n        End If\n        x = x + 1\n        If x &gt; UBound(DataArray, 1) Then\n            x = LBound(DataArray, 1)\n            y = y + 1\n        End If\n    Next\n\nEnd Function\n</code></pre>\n\n<h2>Test</h2>\n\n<pre><code>Sub Test()\n    Dim DataArray As Variant\n\n    'Test 1D Array - Base 0\n    DataArray = Array(1, 2, 3, 4, 5, 6, 7, 8)\n    Debug.Print \"Test 1D Array - Base 0: \"; getValueIndices(8, DataArray)(0)\n\n    'Test 2D Array - Base 1\n    DataArray = [{1,2,3;4,5,6;7,8,9}]\n    Debug.Print \"Test 2D Array - Base 1:\"; getValueIndices(8, DataArray)(0), getValueIndices(8, DataArray)(1)\n\n    'Test 2D Array - Base 0\n    ReDim DataArray(0 To 2, 0 To 2)\n    DataArray(0, 0) = 1: DataArray(0, 1) = 2: DataArray(0, 2) = 3\n    DataArray(1, 0) = 4: DataArray(1, 1) = 5: DataArray(1, 2) = 6\n    DataArray(2, 0) = 7: DataArray(2, 1) = 7: DataArray(2, 2) = 8\n    Debug.Print \"Test 2D Array - Base 0: \"; getValueIndices(8, DataArray)(0), getValueIndices(8, DataArray)(1)\n    Debug.Print \"Test IsEmpty with Bad Value: \"; IsEmpty(getValueIndices(100, DataArray))\n\nEnd Sub\n</code></pre>\n\n<h2>Results</h2>\n\n<p><a href=\"https://i.stack.imgur.com/XfIR3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XfIR3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 7263985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa6d89d3e8f5775c71a388b81e55d47?s=128&d=identicon&r=PG&f=1", "display_name": "Mattaphorica", "link": "https://stackoverflow.com/users/7263985/mattaphorica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481140911, "creation_date": 1481136784, "last_edit_date": 1531164843, "question_id": 41025160, "link": "https://stackoverflow.com/questions/41025160/search-for-a-string-in-an-array-and-store-the-row-number-in-which-it-occurs", "title": "Search for a string in an array and store the row number in which it occurs?", "body": "<p>I've seen a few questions similar to this, but none are quite the same!</p>\n\n<p>I have a rather large array with <strong>no two values repeated</strong>.\nI need to search through the array for a certain string and <strong>store the row number</strong> where the string is located.</p>\n\n<p>This will be performed several times, so if possible, the \"fastest\" way would be appreciated!</p>\n\n<p>For example\nArray: </p>\n\n<pre><code>   1  2  3\n   4  5  6\n   7  8  9\n</code></pre>\n\n<p>Say I want to look for \"8\".  The code should search through the matrix, find that it's on the 3rd row and store a \"2\" into a variable (or \"3\" depending on whether option base 1 is included or not).</p>\n\n<p>In my case, <strong>the value(s) I'm looking for will only occur on a single column</strong>, so I don't need to search the entire array.</p>\n\n<p>Thanks so much.</p>\n\n<p>EDIT:\nSorry for my lack of ediquette! This is my first post.  Here is what I have so far:</p>\n\n<pre><code>col=3\nFor row = 1 to 50\n  if searchterm = Matrix(row,col).value Then\n    searchrow=row\n    exit for\n  end if\nNext row\n</code></pre>\n\n<p>Is there a more efficient way to do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1481136621, "post_id": 41025021, "comment_id": 69257415, "body": "add some images of a &quot;before&quot; and &quot;after&quot; scenario"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481137208, "post_id": 41025021, "comment_id": 69257767, "body": "What errors are you getting?  And on what line?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1481137234, "post_id": 41025021, "comment_id": 69257783, "body": "So in AK9:AK47 are cell addresses?? Like <code>A5</code>, <code>B10</code>, <code>E22</code>, etc?  And if that&#39;s the case, won&#39;t the variable <code>o</code> always result in 9 because <code>x</code> will always be 1 cell, so <code>x.Count</code> will always equal 1, +8 = 9..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1481137346, "post_id": 41025021, "comment_id": 69257846, "body": "Based on what @tigeravatar said, you probably need to change <code>Range(o, p)</code> to <code>Range(x.Row, p)</code>.   Hmmm, but if AK9 contains something like <code>A5:D5</code>, perhaps you are only wanting to copy <code>D9:G9</code> to <code>A5:D5</code> - I think we definitely need some sample data to look at."}, {"owner": {"reputation": 13, "user_id": 7262636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206447212454088/picture?type=large", "display_name": "Igor Sena", "link": "https://stackoverflow.com/users/7262636/igor-sena"}, "edited": false, "score": 0, "creation_date": 1481138755, "post_id": 41025021, "comment_id": 69258601, "body": "Yeah. Practically I Want to copy D9:J9 to P10:V:10 in another worksheet. I&#39;ll try to simplify the code by using resize and excluding that For lines."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7262636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206447212454088/picture?type=large", "display_name": "Igor Sena", "link": "https://stackoverflow.com/users/7262636/igor-sena"}, "edited": false, "score": 0, "creation_date": 1481152085, "post_id": 41025675, "comment_id": 69265505, "body": "Got incompatible types error on this line: &quot;If Evaluate(&quot;ISREF(&quot; &amp; .Text &amp; &quot;)&quot;) Then&quot;. This is occurring very often with me as I&#39;m dealing with range objects. Thanks for the advice on the variables I&#39;m pretty new to VBA and in programming codes to."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1481138597, "creation_date": 1481138597, "answer_id": 41025675, "question_id": 41025021, "link": "https://stackoverflow.com/questions/41025021/transporting-text-from-one-worksheet-to-another-with-two-dynamic-ranges-vba-exc/41025675#41025675", "title": "Transporting text from one worksheet to another with two Dynamic ranges- VBA Excel", "body": "<p>If there are valid cell addresses in range AK9:AK47, then something like this should work for you.  Note that using single letter variables is bad practice, and you can customize the code by adjusting the constants at the top.</p>\n\n<pre><code>Sub tgr()\n\n    Const sDestInfoCol As String = \"AK\"\n    Const lHeaderRow As Long = 8\n    Const lStartCopyCol As String = \"D\"\n    Const lFinalCopyCol As String = \"J\"\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rDestInfo As Range\n    Dim rDestTemp As Range\n    Dim lNumCols As Long\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Sheets(\"Formulario\")\n    Set wsDest = wb.Sheets(\"SdB pg1\")\n    Set rDestInfo = wsData.Range(sDestInfoCol &amp; lHeaderRow + 1, wsData.Cells(wsData.Rows.Count, sDestInfoCol).End(xlUp))\n    If rDestInfo.Row &lt;= lHeaderRow Then Exit Sub    'No data\n    lNumCols = Columns(lFinalCopyCol).Column - Columns(lStartCopyCol).Column + 1\n\n    For Each rDestTemp In rDestInfo.Cells\n        With rDestTemp\n            If Evaluate(\"ISREF(\" &amp; .Text &amp; \")\") Then\n                wsDest.Range(.Text).Resize(1, lNumCols).Value = wsData.Cells(.Row, lStartCopyCol).Resize(1, lNumCols).Value\n            End If\n        End With\n    Next rDestTemp\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7262636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206447212454088/picture?type=large", "display_name": "Igor Sena", "link": "https://stackoverflow.com/users/7262636/igor-sena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481138597, "creation_date": 1481136322, "last_edit_date": 1481138134, "question_id": 41025021, "link": "https://stackoverflow.com/questions/41025021/transporting-text-from-one-worksheet-to-another-with-two-dynamic-ranges-vba-exc", "title": "Transporting text from one worksheet to another with two Dynamic ranges- VBA Excel", "body": "<p>I have two worksheets (one for input and another for output) and I'm trying to copy some information on cells along a row from the input to cells along a row on the output. My code stops if, on a separated list of ranges, there's no info. The code I'm using is like that right now:</p>\n\n<pre><code>Sub Txt_Manobra()\n\nDim x As Range\nDim i As Integer\nDim o As Integer\nDim p As Integer\nDim Txt1 As String\nDim Txt2 As Variant\n\nFor Each x In Worksheets(\"Formulario\").Range(\"AK9:AK47\").Cells\n    If x.Value &lt;&gt; \"\" Then Txt1 = x.Value\n        o = 8 + x.Count\n        For i = 1 To 7\n            p = 3 + i\n            Txt2 = Worksheets(\"Formulario\").Range(o, p).Value\n            Worksheets(\"SdB pg1\").Range(Txt1).Cells(1, i) = Txt2\n        Next i\n    Next x\nEnd Sub\n</code></pre>\n\n<p>For each range value (x), it looks on the range txt1 (That is composed of only one row), and it should copy the values on range (D9:J9), one at a time and put on the range determined x (also only one row and with the same number of columns as D9:J9) then look on the next row (D10:J10) and so on.</p>\n\n<p>I'm getting errors and I think this might be easier to do than I Think.</p>\n\n<p>It's like that:\n<a href=\"https://i.stack.imgur.com/hWW17.png\" rel=\"nofollow noreferrer\">Input</a></p>\n\n<p>And I want to tranfer to\n<a href=\"https://i.stack.imgur.com/b9Hq2.png\" rel=\"nofollow noreferrer\">Output</a></p>\n\n<p>Each cell in the range \"AK9:AK47\" Contains a range like \"P10:V10\"</p>\n\n<p>I haven't made it to work out to see if my \"o\" changes</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1481139411, "post_id": 41024757, "comment_id": 69258950, "body": "You cannot read from a http-hosted workbook without opening it: there is nothing in the HTTP protocol which supports this (absent some kind of server-side coding).  What&#39;s the problem with opening the workbook?"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1481149644, "post_id": 41027666, "comment_id": 69264461, "body": "Thanks for that explanation.  I knew that I could define a local workbook as such, but was running into the issue for online workbooks.  Since this particular spreadsheet is on SharePoint, do you know offhand if there is an API to make VBA interface with that?  I will dig a bit on my own, but you already seem a bit knowledgeable in the matter and may be quicker than my reading."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1481150492, "post_id": 41027666, "comment_id": 69264830, "body": "Yeah, I have had the same problem as you -and have read overtime how I may surpass it- in the past, however, I have not found an effective way to do so and to be honest, there are many limitation in the sharepoint API for excel -for my workbooks due to many macros there, it is better to open it by Excel-. My workaround would be that you screenupdating=false in your code do your stuff and then close the workbook, sadly, there&#39;s no other way to achieve it -that could improve your code running speed at least-."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1481219393, "post_id": 41027666, "comment_id": 69299096, "body": "Thank you for the tip for screenupdating.  I will accept your answer; thanks for all of the information!"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 1, "last_activity_date": 1481147585, "last_edit_date": 1481147585, "creation_date": 1481146006, "answer_id": 41027666, "question_id": 41024757, "link": "https://stackoverflow.com/questions/41024757/how-to-reference-online-workbook-in-vba/41027666#41027666", "title": "How to reference online workbook in VBA", "body": "<p><strong><em>Short Answer:</em></strong>\n<br>You need <code>Workbooks.Open(</code>\" In order to analyze the workbook. \n<br>\n<strong><em><br>Solution Explanation:</em></strong>\n<br>Using common language, <code>workbooks</code> is not a final instruction by itself, you need to specify what would you like to do with that object -kind of like talking in 3rd person-: \"Workbook get opened\" (Workbooks.Open) \"Workbook add a new sheet\"  (Workbooks.NewSheet) and such. As you may see, \"Workbook\" cannot work on itself, it is waiting an \"order\" -in this case events for it-. You may see a list of what can you do with workbook at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835568.aspx\" rel=\"nofollow noreferrer\">official documentation</a>.\n<br>\n<br><strong><em>Further explanation:</em></strong>\n<br>Code itself cannot possible know what are you trying to do. You need to analyze the object as an Excel archive OR find a way that you perform it through the <a href=\"http://www.excely.com/excel-vba/ie-automation.shtml\" rel=\"nofollow noreferrer\">webpage itself</a> -which would be more complicated and you can only do so by IE since there are no <a href=\"http://www.webopedia.com/TERM/A/API.html\" rel=\"nofollow noreferrer\">API</a> (API for short: a way to tell your code in one program to send commands to another one) for Excel for chrome or firefox to my knowledge-.</p>\n"}], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 41027666, "answer_count": 1, "score": 0, "last_activity_date": 1481147585, "creation_date": 1481135406, "last_edit_date": 1531164843, "question_id": 41024757, "link": "https://stackoverflow.com/questions/41024757/how-to-reference-online-workbook-in-vba", "title": "How to reference online workbook in VBA", "body": "<p>Stuck on trying to reference a workbook which is on SharePoint.</p>\n\n<p>I can use this to open the file:</p>\n\n<pre><code>Workbooks.Open(\"http://www.website.com/File.xlsx\")\n</code></pre>\n\n<p>However, I want to execute without opening the file... is there a way to utilize that online workbook without opening?</p>\n\n<p>I have tried (had to split out the string to multiple lines so it would show up like code): </p>\n\n<pre><code>Workbooks(\"http://www.website.com/File.xlsx\")._\nSheets(\"Sheet1\").Range(\"A1\").Value\n</code></pre>\n\n<p>references and get errors if I try to add a website to the Workbooks section (typically run-time error 9, subscript out of range).  I have had the same error in trying to define the workbook beforehand:</p>\n\n<pre><code>Dim wbk as Workbook\nSet wbk = Workbooks(\"http://www.website.com/File.xlsx\")\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1481135554, "post_id": 41024739, "comment_id": 69256735, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">This will be helpful</a>, as your entire macro is &quot;hard-coded&quot;, it will be better to use explicit variables and to assign <code>Range</code> objects to each as needed, also to avoid <code>Activate</code> method... Apart from that: It&#39;s not clear from your code which parts need to be dynamic (something about the range size -- columns or rows? which line(s)? etc)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1481135797, "post_id": 41024739, "comment_id": 69256914, "body": "Also see <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this answer</a> for ideas on how to find the <i>last</i> row or column in a range."}, {"owner": {"reputation": 9, "user_id": 7263910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8edd22580522bce8be4c644ccc041a88?s=128&d=identicon&r=PG", "display_name": "user7263910", "link": "https://stackoverflow.com/users/7263910/user7263910"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1481135955, "post_id": 41024739, "comment_id": 69257005, "body": "It is the rows that will vary per month, depending on entries (sales related). I need to be able to sort all rows (however many appear on that month&#39;s report), by column A. My code I wrote is very incorrect, and I cannot seem to get the expressions right in &#39;Sort by Column A to Remove Extra Rows from View."}, {"owner": {"reputation": 9, "user_id": 7263910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8edd22580522bce8be4c644ccc041a88?s=128&d=identicon&r=PG", "display_name": "user7263910", "link": "https://stackoverflow.com/users/7263910/user7263910"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1481136103, "post_id": 41024739, "comment_id": 69257094, "body": "The other issue is later in the Auto Fit Contents of Columns and Rows. My Columns is fine. It will never be more than AG per month. It however can exceed 77 rows. I do not know how to build the expression to autofit columns to column AG, and autofit all rows containing data, or just autofit entire sheet."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1481136497, "post_id": 41024739, "comment_id": 69257339, "body": "1) Are you suggesting that <code>Columns(&quot;A:AN&quot;).Sort...</code> doesn&#39;t actually <i>sort</i> your range? If not, please explain in more detail what is the problem with the sort. 2) For finding last row, please see second link provided above, attempt to implement, and if you get stuck, <a href=\"http://stackoverflow.com/posts/41024739/edit\">edit your question</a> with your updated code."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481136990, "post_id": 41024739, "comment_id": 69257641, "body": "Is there a reason to have <code>Range.EntireRow.EntireRow</code>? I&#39;m unfamiliar with this usage."}, {"owner": {"reputation": 9, "user_id": 7263910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8edd22580522bce8be4c644ccc041a88?s=128&d=identicon&r=PG", "display_name": "user7263910", "link": "https://stackoverflow.com/users/7263910/user7263910"}, "edited": false, "score": 0, "creation_date": 1481138031, "post_id": 41024739, "comment_id": 69258207, "body": "I put that there to define it to sort the entire rows, not just column. I need entire rows, and their values, sorted by A."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481138530, "post_id": 41024739, "comment_id": 69258479, "body": "But why twice??"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7263910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8edd22580522bce8be4c644ccc041a88?s=128&d=identicon&r=PG", "display_name": "user7263910", "link": "https://stackoverflow.com/users/7263910/user7263910"}, "edited": false, "score": 0, "creation_date": 1481139878, "post_id": 41025841, "comment_id": 69259207, "body": "I remove the redudancies in both stating entire column twice, and entire row. Not sure what my reasoning was. It works perfectly without. I have got the sort to work, I had to fix an issue of my own error. It wasnt the code, it was error on my part for all columns I needed to define. Now I am down to 1 issue. Just how to autofit all rows, without stating autofit 1:77. Instead more dynamic, saying autofit all rows on sheet, or all rows with data. Either or. I will be updating my question shortly to account for only the one oustanding issue. I really appreciate all the questions, feedback, and e"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481140360, "post_id": 41025841, "comment_id": 69259467, "body": "David Zemens already posted a link that should show you how to do that."}], "tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": false, "score": 0, "last_activity_date": 1481139255, "creation_date": 1481139255, "answer_id": 41025841, "question_id": 41024739, "link": "https://stackoverflow.com/questions/41024739/excel-macro-autofit-all-rows-with-data-or-entire-sheet-updated/41025841#41025841", "title": "Excel Macro autofit all rows with data -or- entire sheet *updated*", "body": "<p>I would say that the main problem is with your sort. Sorting a variable range in VBA is tricky. I would strongly suggest using a named range. \nYou can select the \"Active\" region of your spreadsheet and give it a name with the following statements:</p>\n\n<pre><code>Range(\"A1\").Select\nSelection.CurrentRegion.Select\nSelection.Name = \"myRange\"\n</code></pre>\n\n<p>After that, use myRange instead of a static address. Here is a simple example:</p>\n\n<pre><code>Sub NameRangeAndSort()\n' Create Named Range and Sort by 1st column\n    Dim TotalRows As Integer\n    Range(\"A1\").Select\n    Selection.CurrentRegion.Select\n    Selection.Name = \"myRange\"\n\n    ActiveWorkbook.ActiveSheet.Sort.SortFields.Clear\n    ActiveWorkbook.ActiveSheet.Sort.SortFields.Add Key:=Range(\"A1\") _\n    , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.ActiveSheet.Sort\n        .SetRange Range(\"myRange\")\n        .Header = xlGuess\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n\n<p>You also have EntireColumn repeated twice in a couple of your  autofit statements. That should only be included once per statement.    </p>\n"}], "owner": {"reputation": 9, "user_id": 7263910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8edd22580522bce8be4c644ccc041a88?s=128&d=identicon&r=PG", "display_name": "user7263910", "link": "https://stackoverflow.com/users/7263910/user7263910"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2169, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1481140175, "creation_date": 1481135353, "last_edit_date": 1481140175, "question_id": 41024739, "link": "https://stackoverflow.com/questions/41024739/excel-macro-autofit-all-rows-with-data-or-entire-sheet-updated", "title": "Excel Macro autofit all rows with data -or- entire sheet *updated*", "body": "<p>****updated as sort now works, only need how to autofit rows, dynamically without defining rows to autofit. Columns withh always be same and can be hard code***</p>\n\n<p>Newbie here, with limited VBA. </p>\n\n<p>I have a current project, and although my question may seem basic, considering how many steps I have completed accurately, I cannot seem to autofit all rows, without defining the rows.</p>\n\n<p>I can do it by a range, but every month the amount of entries on the report differs. </p>\n\n<p>My macro essentials takes a report (name changes every month as it is exported by another application in a messy Excel format) and cleans it up.  Later it will be transposed by other methodology into a SharePoint datasheet list.</p>\n\n<p>I spell everything out in steps as I am more a workflow writer. If there is anything I can clean up to simplify, Id learn to love that as well.</p>\n\n<p>Macro is as follows: (please forgive formatting errors from trying to copy into Question)</p>\n\n<pre><code>Sub ComponentBalRptCleanup()\n\n'Unmerge all Cells in Worksheet\nActiveSheet.Cells.UnMerge\n\n'Delete Columns A1 thru D1\nRange(\"A1:D1\").EntireColumn.Delete\n\n'Delete Rows A1 thru A9\nRange(\"A1:A9\").EntireRow.Delete\n\n'Cut and Paste Cells\nRange(\"A2\").Cut Range(\"A1\")\nRange(\"G1\").Cut Range(\"F1\")\nRange(\"P1\").Cut Range(\"O1\")\nRange(\"AA1\").Cut Range(\"Z1\")\n\n'Sort by Column A to Remove Extra Rows from View\n Columns(\"A:AN\").Sort key1:=Range(\"A:A\"), order1:=xlAscending, Header:=xlYes\n\n'Auto Fit Contents in Columns and Rows\n     ActiveCell.Columns(\"A:AG\").EntireColumn.Select\n    ActiveCell.Columns(\"A:AG\").AutoFit\nActiveCell.Rows(\"1:77\").EntireRow.Select\n       ActiveCell.Rows(\"1:77\").EntireRow.AutoFit\n\n'Delete Empty Columns\nRange(\"B:B, D:D, G:I, K:L, N:N, P:Q, T:V, X:Y, AA:AB, AD:AF\").EntireColumn.Delete\n\n'Remove Wrap Text from Cell B1\nRange(\"B1\").WrapText = False\n\n'Autofit Contents of Columns\nRange(\"A1:AF1\").Columns.AutoFit\n\n'Autofit Row A2 Contents\nRange(\"A2:A2\").Rows.AutoFit\n\n'Save File As\nApplication.GetSaveAsFilename\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481134431, "post_id": 41024419, "comment_id": 69256098, "body": "Do you have a <code>Named Range</code> in your new workbook named &quot;cst_last_import_folder&quot; ?"}, {"owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481134614, "post_id": 41024419, "comment_id": 69256204, "body": "Absolutely! I debugged it to print Thisworkbook.names(&quot;cst_....&quot;).value &amp; I get the right value.  If I move the very same code into a module, it now works..."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481134802, "post_id": 41024419, "comment_id": 69256311, "body": "you have it in one of your <code>Worksheets</code> as a code ? why ?"}, {"owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481134963, "post_id": 41024419, "comment_id": 69256387, "body": "Well because in the newer workbook, there&#39;s an import button which triggers this code and since it&#39;s only short script I figured I might as well but code it directly in the _click() event. Perhaps slightly lazy. I mean the fix for this isn&#39;t hard - just created a import() sub in a module &amp; make it happen there. But still, I want to understand this wouldn&#39;t work outside a module? (Also to understand if other methods might fail in similar circumstances....)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1481138065, "post_id": 41024419, "comment_id": 69258227, "body": "<b>ALWAYS</b> qualify the sheet that the <code>Range</code>, <code>Cells</code>, <code>Rows.Count</code>, <code>Columns.Count</code>, etc, etc, etc refer to."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1481138150, "post_id": 41024419, "comment_id": 69258265, "body": "Anyone wondering if that&#39;s &quot;actually&quot; a duplicate, see @YowE3K&#39;s comment. The error is the same, the solution is the same. Read the answer there, first paragraph and two bullet points are exactly what the problem is here."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481138489, "post_id": 41024419, "comment_id": 69258460, "body": "Along the same lines as the duplicate answer @Mat&#39;sMug posted, you may also have a named range that is scoped to the worksheet only.  In that case, your code would work in a separate module, the specific sheet module, but not code from a different sheet in which case the same error would be observed.  Comes down to the same solution of fully qualifying your cell locations."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481138501, "post_id": 41024419, "comment_id": 69258465, "body": "In a sheet code module, an unqualified <code>Range</code> refers to the sheet that the code belongs to and your range name is probably not part of that sheet.  (So it&#39;s like saying &quot;select the orange [which is in a box of oranges] from this box of apples&quot; - it doesn&#39;t work.)  In a project level code module, an unqualified <code>Range</code> will usually refer to the <code>ActiveSheet</code>, but if used with a range name as the index it can usually work out where to go."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1481138648, "post_id": 41024419, "comment_id": 69258545, "body": "FWIW <a href=\"https://github.com/rubberduck-vba/Rubberduck/releases\" rel=\"nofollow noreferrer\">Rubberduck 2.0</a> will include a code inspection that locates all implicit references to <code>ActiveSheet</code> and <code>ActiveWorkbook</code>. That will be my contribution to Humanity. Cheers!"}, {"owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 0, "creation_date": 1481138776, "post_id": 41024419, "comment_id": 69258613, "body": "Yup you guys are right - broadly speaking it amounts to the same thing. I usually use named workbook references because it&#39;s easy to reference it from anywhere, but that code&#39;s not all mine so I wasn&#39;t careful and ended with the unqualified range. Thanks for pointing out!"}], "owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "closed_date": 1481138679, "answer_count": 0, "score": 0, "last_activity_date": 1481134227, "creation_date": 1481134227, "question_id": 41024419, "link": "https://stackoverflow.com/questions/41024419/range-working-only-in-modules-excel-vba", "closed_reason": "Duplicate", "title": "RANGE() working only in modules? (Excel VBA)", "body": "<p>So I'm basically transferring code from one workbook to the other. I'm opening a file through file pickers in both cases the code is identical:</p>\n\n<pre><code>Private Sub ImportData_Click()\n(... irrelevant stuff...)\n\nWith fileDialog\n'The file stores the last path chosen by the user. Goes there first. \n'Otherwise, defaults to the workbook's location because we know it exists\n\n    If file_exists(Range(ThisWorkbook.Names(\"cst_last_import_folder\")).Value) Then\n\n(... more irrelevent stuff...)\n\nEnd Sub\n</code></pre>\n\n<p>The Range() method fails in the new workbook (runtime 1004 error), but not in the old one. It took me a while to figure out - but that's because in the old book, this part is actually done within a module. In the new workbook, this bit of code is hosted directly on the sheet.</p>\n\n<p>So I know how it fails - e.g. the Range() methode doesn't work if the code resides on the worksheet. But why is it so? E.g. what causes the method to fail only if hosted on the worksheet? Or is there a more fundamental reason behind this that I am missing?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481134168, "post_id": 41024295, "comment_id": 69255975, "body": "are the values in Column A and Column B unique ? I mean. does each value in Column A doesn&#39;t repeat itself ? Column B?"}, {"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481134250, "post_id": 41024295, "comment_id": 69256020, "body": "the values in column A are unique but in colmn B they are repeted !"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481135020, "post_id": 41024295, "comment_id": 69256426, "body": "so if a value in Column A in row 10, matches a value in Column B at row 20, you want to copy values of cells &quot;A:D&quot;to cells &quot;E:H&quot; at row 20 ? or row 10 ?"}, {"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481135322, "post_id": 41024295, "comment_id": 69256593, "body": "no , like if we have x in row 10 in column A and x in row 20 in column B  , copy x in E and in H with their C and D whish are in the same cell as x"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481135497, "post_id": 41024295, "comment_id": 69256705, "body": "I find it hard to understand what you need. Can you add to your post 2 screen-shots of your simulated sheet, make a manual simulation of before and after a match, how does it look, what value goes to which cell"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1481136355, "post_id": 41024295, "comment_id": 69257260, "body": "@AnasRAFEI, as ShaiRado already said, post examples of a &quot;before&quot; and &quot;after&quot; scenario"}, {"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481137017, "post_id": 41024295, "comment_id": 69257654, "body": "i have added a picture that explain what i need in the link i have updated the poste"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481134898, "post_id": 41024518, "comment_id": 69256354, "body": "still the same thing nothing changed !"}], "tags": [], "owner": {"reputation": 1, "user_id": 7263712, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J1_zMHT900Y/AAAAAAAAAAI/AAAAAAAAAEc/3MvaWuMchy8/photo.jpg?sz=128", "display_name": "Shaderhoth", "link": "https://stackoverflow.com/users/7263712/shaderhoth"}, "is_accepted": false, "score": -1, "last_activity_date": 1481135744, "last_edit_date": 1481135744, "creation_date": 1481134593, "answer_id": 41024518, "question_id": 41024295, "link": "https://stackoverflow.com/questions/41024295/comparing-values-in-two-columns-using-vba/41024518#41024518", "title": "Comparing values in two columns using VBA", "body": "<p>It might be that you just need to tab in a few lines, so it should look like this:</p>\n\n<pre><code>Sub copy_lignes()\n\nDim DerLigA As Long\nDim DerLigB As Long\nDim i As Integer\nDim j As Integer\ni = 2\nj = 2\nDerLigA = Sheets(\"sheet3\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nDerLigB = Sheets(\"sheet3\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nFor i To DerLigA\n    For j To DerLigB\n        If Sheets(\"sheet3\").Range(\"A\" &amp; i) = Sheets(\"sheet3\").Range(\"B\" &amp; j) Then\n\n            Sheets(\"sheet3\").Range(\"A\" &amp; i).Copy Destination:=Sheets(\"sheet3\").Range(\"E\" &amp; i)\n            Sheets(\"sheet3\").Range(\"B\" &amp; i).Copy Destination:=Sheets(\"sheet3\").Range(\"F\" &amp; i)\n            Sheets(\"sheet3\").Range(\"C\" &amp; i).Copy Destination:=Sheets(\"sheet3\").Range(\"G\" &amp; i)\n            Sheets(\"sheet3\").Range(\"D\" &amp; i).Copy Destination:=Sheets(\"sheet3\").Range(\"H\" &amp; i)\n\n        End If\n    Next j\nNext i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481136291, "post_id": 41024805, "comment_id": 69257213, "body": "it still blocks , untill i shutdown excel , but it gives results near to what i want , the E and F are not the same !"}, {"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481137053, "post_id": 41024805, "comment_id": 69257674, "body": "i have added a picture in the link in my poste for the results that i want"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481137339, "post_id": 41024805, "comment_id": 69257843, "body": "@AnasRAFEI try now (edited code), should match the results you want"}, {"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481138108, "post_id": 41024805, "comment_id": 69258245, "body": "yes it is doing exactly the job but it blocks excel is it because of the amount of data i am processing ??"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481138224, "post_id": 41024805, "comment_id": 69258316, "body": "@AnasRAFEI  yes, how many rows do u have ? try now with the 2 lines I added, should be faster when running with  <code>Application.ScreenUpdating = False</code>"}, {"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481138447, "post_id": 41024805, "comment_id": 69258430, "body": "in column A i have 9200 row and in B i have 30000 !"}, {"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481138546, "post_id": 41024805, "comment_id": 69258488, "body": "i have tried it but still blocks do i need to use the dictionnary ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481138576, "post_id": 41024805, "comment_id": 69258502, "body": "@AnasRAFEI  that&#39;s a LOT, did u try with my edited section? It could still take the code a minute or two to run ~ 270M iterations"}, {"owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481138850, "post_id": 41024805, "comment_id": 69258648, "body": "yes i am giving it some time to see how much minute it will take , this work need to be done just once so if it works its all good"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "edited": false, "score": 0, "creation_date": 1481138942, "post_id": 41024805, "comment_id": 69258706, "body": "@AnasRAFEI  that&#39;s what I wanted to say, if u run this code once a month, and it takes 4-5 minutes to run, just wait. But if u are running it every day, then that&#39;s something else"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1481138325, "last_edit_date": 1481138325, "creation_date": 1481135598, "answer_id": 41024805, "question_id": 41024295, "link": "https://stackoverflow.com/questions/41024295/comparing-values-in-two-columns-using-vba/41024805#41024805", "title": "Comparing values in two columns using VBA", "body": "<p>Try the code below, maybe this is what you meant in your post:</p>\n\n<pre><code>Sub copy_lignes()\n\nDim DerLigA, DerLigB  As Long, i, j As Long\nDim PasteRow As Long\n\n' optimize speed performance\nApplication.ScreenUpdating = False\n\nWith Sheets(\"Sheet3\")\n\n    DerLigA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    DerLigB = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n    PasteRow = 2\n\n    For i = 2 To DerLigA\n        For j = 2 To DerLigB\n            If .Range(\"A\" &amp; i) = .Range(\"B\" &amp; j) Then\n                .Range(\"A\" &amp; i).Copy Destination:=.Range(\"E\" &amp; PasteRow)\n                .Range(\"B\" &amp; j &amp; \":D\" &amp; j).Copy Destination:=.Range(\"F\" &amp; PasteRow)\n                PasteRow = PasteRow + 1\n            End If\n        Next j\n    Next i\nEnd With\n\n' restore settings \nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7259813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a27442c4b9d566677b84eca994f0a49?s=128&d=identicon&r=PG&f=1", "display_name": "Anas RAFEI", "link": "https://stackoverflow.com/users/7259813/anas-rafei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 41024805, "answer_count": 2, "score": 0, "last_activity_date": 1481141411, "creation_date": 1481133771, "last_edit_date": 1481141411, "question_id": 41024295, "link": "https://stackoverflow.com/questions/41024295/comparing-values-in-two-columns-using-vba", "title": "Comparing values in two columns using VBA", "body": "<p>I am working on this code that compares column A ( code source) and column B( code roc)   and for each code source in column A it has his code regate in column C  and address in column D so if A=B copy them back in E and F with their code regate in column G and their address in column H .\nthis the code I am using it blocks until I shut down excel  and it doesn't give me the exact results if anyone can help me thank you \nhere is a picture of the result that i need from A and B , C and D </p>\n\n<p><a href=\"https://i.stack.imgur.com/4ZhUa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4ZhUa.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub copy_lignes()\n\n  Dim DerLigA, DerLigB  As Long, i, j As Long\n\n    DerLigA = Sheets(\"sheet3\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    DerLigB = Sheets(\"sheet3\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To DerLigA\n      For j = 2 To DerLigB\n        If Sheets(\"sheet3\").Range(\"A\" &amp; i) = Sheets(\"sheet3\").Range(\"B\" &amp; j) Then\n\n          Sheets(\"sheet3\").Range(\"A\" &amp; i).Copy Destination:=Sheets(\"sheet3\").Range(\"E\" &amp; i)\n          Sheets(\"sheet3\").Range(\"B\" &amp; i).Copy Destination:=Sheets(\"sheet3\").Range(\"F\" &amp; i)\n          Sheets(\"sheet3\").Range(\"C\" &amp; i).Copy Destination:=Sheets(\"sheet3\").Range(\"G\" &amp; i)\n          Sheets(\"sheet3\").Range(\"D\" &amp; i).Copy Destination:=Sheets(\"sheet3\").Range(\"H\" &amp; i)\n\n        End If\n      Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 1887944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d06eea458145f8a9683a9e861700233?s=128&d=identicon&r=PG", "display_name": "Joe Glines", "link": "https://stackoverflow.com/users/1887944/joe-glines"}, "is_accepted": false, "score": 3, "last_activity_date": 1495201909, "last_edit_date": 1495201909, "creation_date": 1495201843, "answer_id": 44071819, "question_id": 41024198, "link": "https://stackoverflow.com/questions/41024198/controlling-chrome-via-vba-with-seleniumbasic/44071819#44071819", "title": "Controlling Chrome via VBA with SeleniumBasic", "body": "<p>Use this instead of <code>bot.start</code></p>\n\n<pre><code>driver.Get(\"http://www.google.com\")\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7263754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74b4cd3a84d5d674b0d9f8cb98301a01?s=128&d=identicon&r=PG&f=1", "display_name": "Veebeah", "link": "https://stackoverflow.com/users/7263754/veebeah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495201909, "creation_date": 1481133425, "last_edit_date": 1531164843, "question_id": 41024198, "link": "https://stackoverflow.com/questions/41024198/controlling-chrome-via-vba-with-seleniumbasic", "title": "Controlling Chrome via VBA with SeleniumBasic", "body": "<p>I have installed SeleniumBasic, and have updated the chromedriver file to the latest version. I have gone into tools> References and activated Selenium Library Type.</p>\n\n<p>At this point, all I am trying to do is  get VBA to open a Chrome browser to google as a starting point. Here is the super complicated macro im trying to fire off:</p>\n\n<pre><code>Sub ChromeWebdriver()\n  Dim bot As New Selenium.ChromeDriver\n  bot.Start \"chrome\", \"http://www.google.com\"\nEnd Sub\n</code></pre>\n\n<p>When I try to run this, I get:</p>\n\n<blockquote>\n  <p>Run-time error '-2146232576 (80131700)': Automation Error</p>\n</blockquote>\n\n<p>The research I did on that error message says that there is an incorrect variable. When I hit debug, it highlights:</p>\n\n<pre><code>bot.Start \"chrome\", \"http://www.google.com\"\n</code></pre>\n\n<p>Does any good Samaritan have advice that can get me started with SeleniumBasic?</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1481143192, "post_id": 41024161, "comment_id": 69261174, "body": "<a href=\"http://stackoverflow.com/questions/41025377/vba-powerpoint-updating-embedded-excel-objects\" title=\"vba powerpoint updating embedded excel objects\">stackoverflow.com/questions/41025377/&hellip;</a>     This might help you get started."}], "owner": {"reputation": 31, "user_id": 5694994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oG9Ph.png?s=128&g=1", "display_name": "Smart.Man", "link": "https://stackoverflow.com/users/5694994/smart-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1481133283, "creation_date": 1481133283, "question_id": 41024161, "link": "https://stackoverflow.com/questions/41024161/powerpoint-2013-vba-convert-linked-charts-to-embedded", "title": "Powerpoint 2013 VBA Convert linked charts to embedded", "body": "<p>The case is for powerpoint 2013, where i have got a presentation with around 50 slides, each slide contains a linked chart from an excel sheet, however all the links are there but without the files, in other words the links are broken.</p>\n\n<p>Ofcourse what is required is to make some slight edits to EVERY chart, that would be easy if they are embedded charts - which is not the case. I always try to educate colleges to clean the sheet from all but the pivot workbook of which they are pasting the chart and then paste as an embedded chart - But again this is not the usual case.\u00a0</p>\n\n<p>I do have a VBA code to copy the data from the broken charts (all the series) to the clipboard which i then use to manually create an excel file with single workbook and manually paste the data (i get them as a single long column with an empty cell separation between every originally-was row), then re-arrange it in the right order then change the source of the chart to point to the new file then edit the data, then copy the chart then paste it identically in its place as an embedded chart after deleting the original one.! :) yes i know ... !</p>\n\n<p>The process is a long tedious no-brains effort which i believe that it can be automated somehow. however my searches did not yield me to any direct powerpoint 2013 capabilities of converting a broken link chart to an embedded one (at least with the data visible - and no need ofcourse to the source workbooks of these data!).</p>\n\n<p>I have found other powerpoint (and non-powerpoint) VBAs that write to excel sheet, copy to clipboard, break chart links, paste charts ... etc., but I have not been in coding VBA for long time now and used to do only for access, so ...</p>\n\n<p>I would really appreciate any help that can be offered in this direction. Thanks</p>\n"}, {"tags": ["oop", "ms-access", "interface", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481132063, "post_id": 41023670, "comment_id": 69254729, "body": "Interfaces will mean the the structure of class B, derived from Class A, must inherit the functions etc of A, but not the code.  So if you had an employee in your DB, they would be a human, so you&#39;d have properties of name, last name, etc, standard human properties, but in the employee class you also want staff number, you&#39;d implement clsHUMAN in clsEMPLOYEE, but add an extra property called strStaffID in clsEMPLOYEE.  In clsEMPOYEE, you can have events, that the class can raise, so if an event was evtNAMECHANGE, we could execute this in the EMPLOYEE property change not the HUMAN."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481132162, "post_id": 41023670, "comment_id": 69254785, "body": "From this, EMPLOYEE has to have Name, LastName as HUMAN does, but also has a property called evtNAMECHANGE.  If creating the instance of the class in a form for example, we could subscribe to that event from EMPLOYEE class and enable a save button from it."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1511337965, "post_id": 41023670, "comment_id": 81813605, "body": "Since this question has an accepted answer, wouldn\u2019t it be more reasonable to create a new question linked to this one, state what the problem is and what have you tried so far?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1511371034, "post_id": 41023670, "comment_id": 81835882, "body": "That&#39;s probably not a bad idea. I guess I&#39;ll leave the bounty up in case anyone does decide to answer it (plus, I lose the bounty anyway lol)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1511786907, "post_id": 41023670, "comment_id": 81978409, "body": "Gah, just saw the bounty now (an upvote brought me here)... I&#39;ll definitely miss the bounty period, but I&#39;ll find some time to do this - it&#39;s worth it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1511793345, "post_id": 41023670, "comment_id": 81982547, "body": "@Mat&#39;sMug, that would be awesome. Tell you what, I&#39;ll just award you the bounty since half of it was almost headed for you anyway (you had the answer with the most upvotes when I posted the bounty so you would have received 25 points anyway when the bounty expired) and trust that you&#39;ll provide the complete explanation of Pieter&#39;s answer. I could really use a full explanation of it since it seems to really be the kind of answer that can change how Access apps are written, so that they are more flexible and useful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1511793470, "post_id": 41023670, "comment_id": 81982619, "body": "Well, actually @Mat&#39;sMug, I just realized I have another 24 hours to award the bounty after it expires. I was going to put the bounty on your old answer but I&#39;ll wait for your new answer."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1511794217, "post_id": 41023670, "comment_id": 81983094, "body": "FWIW I originally meant to award S.Meaden&#39;s answer a bounty as well, only the SE system forces subsequent bounties to be double the previous one. Feel free to give it to that answer, I&#39;ll still put up a new answer with full explanation. This page will become a reference! =)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1511796166, "post_id": 41023670, "comment_id": 81984338, "body": "Alright, awesome. I&#39;ll do that."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1481133439, "post_id": 41023988, "comment_id": 69255579, "body": "Thanks for the simple example, that&#39;s the kind of thing I&#39;m looking for. It brings up some questions. What is the benefit of having an interface (I believe clsHUMAN is the interface, which I guess is called &quot;Implemented Class&quot; in some cases... which helps me understand its use in the answer on the other forum I mentioned) in this case? Would we ever use clsHUMAN in this case?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1481133551, "post_id": 41023988, "comment_id": 69255651, "body": "For instance, in the client code (the form code), I would have thought we would have declared a variable of type clsHUMAN and then used that somehow, but I guess that&#39;s the problem. It sounds like it is illegal in VBA to put events inside Interfaces (a.k.a Implemented Classes?)."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481133865, "post_id": 41023988, "comment_id": 69255815, "body": "You could do, in the above, they are a HUMAN, then an APPLICANT, then either back to HUMAN or EMPLOYEE, but the idea is the interface is something that is adhered to, for example, you could have an interface of <code>Clickable</code>, which contains the function <code>OnClick</code>, then a button implements it, so does an image, so does a hyperlink, but they all follow a different code path, you&#39;d never use <code>Clickable</code> in the form holding these, however the form itself would implement <code>Clickable</code> maybe???"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1481134234, "post_id": 41023988, "comment_id": 69256014, "body": "I thought the value of an interface was really to be able to create a variable typed to that interface and then assign different concrete implementations of that interface to that variable? So <code>Dim human as clsHUMAN</code> and then you could potentially loop through a collection of objects that implement <code>clsHuman</code>, <code>For Each human in CollectionOfEmployeesAndOtherHumans ...</code>. In reference to your response, we could loop through all buttons, images, and hyperlinks and treat them all the same way. But, not if we don&#39;t have a variable such as <code>Dim clk as Clickable</code> anywhere in the form code... right?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481134520, "post_id": 41023988, "comment_id": 69256143, "body": "You do, you loop through the collection Controls in a form which is a collection of Control classes.  You could do, dim arrEEs(100) as clsEmployee or as clsHuman, and loop, but you wont have staff number, I think you&#39;re looking at the IEnumerable interface in .NET?  In access, all you&#39;re tables are of a Table definition, but they are all distinct objects in the DB, just have names, fields, indexes etc.  we could say the interface is Table in this case"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1481132588, "creation_date": 1481132588, "answer_id": 41023988, "question_id": 41023670, "link": "https://stackoverflow.com/questions/41023670/can-we-use-interfaces-and-events-together-at-the-same-time/41023988#41023988", "title": "Can we use Interfaces and Events together at the same time?", "body": "<p>Implemented Class</p>\n\n<pre><code>'   clsHUMAN\n\nPublic Property Let FirstName(strFirstName As String)\nEnd Property\n</code></pre>\n\n<p>Derived Class</p>\n\n<pre><code>'   clsEmployee\n\nImplements clsHUMAN\n\nEvent evtNameChange()\n\nPrivate Property Let clsHUMAN_FirstName(RHS As String)\n    UpdateHRDatabase\n    RaiseEvent evtNameChange\nEnd Property\n</code></pre>\n\n<p>Using in form</p>\n\n<pre><code>Private WithEvents Employee As clsEmployee\n\nPrivate Sub Employee_evtNameChange()\n    Me.cmdSave.Enabled = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1481136692, "post_id": 41024560, "comment_id": 69257455, "body": "Thanks for the detailed answer. Examples like this are very helpful. I&#39;m working through your answer slowly. I feel like I&#39;m circling around groking this, but I haven&#39;t landed yet. I think the crux of your answer is in this statement: &quot;So Class1 might define events, but the implementing class has no way of implementing them.&quot; I&#39;m trying to match that with your examples, but I&#39;m having a tough time. Is that explained directly in the code examples you gave or is it explained in the technical limitations of VBA due to the COM issue?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1481136794, "post_id": 41024560, "comment_id": 69257516, "body": "In other words, as an experienced programmer, do you look at the &quot;broken&quot; <code>Class1</code> code you wrote and think &quot;Oh, that&#39;s obviously broken. You can&#39;t put an event inside an interface like that.&quot; or do you think &quot;Hey, that should work. I mean, that kind of thing works in other languages. It must be a problem with VBA itself.&quot; I guess I&#39;m trying to see it from your perspective."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481137152, "post_id": 41024560, "comment_id": 69257737, "body": "@BarrettNashville I <i>did</i> try to expose events once (<a href=\"http://codereview.stackexchange.com/q/58348/23788\">here</a> actually), figured it didn&#39;t work, dropped the idea. <a href=\"http://codereview.stackexchange.com/q/64109/23788\">This post</a> makes a good example of how interfaces/polymorphism might be used in VBA. Not sure how documented it actually is, but if you look at a type library such as Excel&#39;s in Visual Studio&#39;s <i>Object Browser</i>, you&#39;ll see a <code>Workbook</code> type, and then a <code>WorkbookEvents</code> separate type: VBA just sort-of combines them into one, but our own VBA code can&#39;t do that AFAIK."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481137254, "post_id": 41024560, "comment_id": 69257798, "body": "Side note, if you&#39;re curious about that <i>Code Explorer</i> and <code>&#39;@Folder</code> annotations, it&#39;s from the latest build of my <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> VBE add-in."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481137481, "post_id": 41024560, "comment_id": 69257904, "body": "Basically the solution I ended up with to work around the no-events-in-interfaces limitation was some kind of &quot;command pattern&quot; which leveraged <code>CallByName</code> and some funky stuff. Check out that post I linked, if you want to go down that rabbit hole."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1481137673, "post_id": 41024560, "comment_id": 69258017, "body": "These are very, very helpful comments.  I can see now that I have way more to learn that I thought. Yes, you&#39;re right. This is quite the rabbit hole. Thanks very much for the link to your post on Code Review about the MVP pattern. I hadn&#39;t seen that and it&#39;s just the kind of thing I&#39;m thinking about doing."}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 1, "creation_date": 1503431939, "post_id": 41024560, "comment_id": 78610150, "body": "@Mat&#39;sMug: In my answer below I explain how use of the Adapter Pattern can nicely encapsulate the two interfaces, IEvents and ICommand, into a single object that both accepts the commands and raise proper COM Events. In turn the Adapter class depends only on the two interfaces IEvents and ICommands, and thus allows proper Inversion of Control. and run-time Dependency Injection."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1511888744, "post_id": 41024560, "comment_id": 82031063, "body": "@Mat&#39;sMug Don&#39;t you still need to put the subroutine in Class1? Otherwise, I get a Compile Error <code>Method or data member not found</code>."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 19, "last_activity_date": 1481135083, "last_edit_date": 1495541848, "creation_date": 1481134720, "answer_id": 41024560, "question_id": 41023670, "link": "https://stackoverflow.com/questions/41023670/can-we-use-interfaces-and-events-together-at-the-same-time/41024560#41024560", "title": "Can we use Interfaces and Events together at the same time?", "body": "<p>An <em>interface</em> is, strictly speaking and only in OOP terms, what an <em>object</em> exposes to the outside world (i.e. its callers/\"clients\").</p>\n\n<p>So you can define an interface in a class module, say <code>ISomething</code>:</p>\n\n<pre><code>Option Explicit\nPublic Sub DoSomething()\nEnd Sub\n</code></pre>\n\n<p>In another class module, say <code>Class1</code>, you can <em>implement</em> the <code>ISomething</code> interface:</p>\n\n<pre><code>Option Explicit\nImplements ISomething\n\nPrivate Sub ISomething_DoSomething()\n    'the actual implementation\nEnd Sub\n</code></pre>\n\n<p>When you do exactly that, notice how <code>Class1</code> doesn't expose anything; the only way to access its <code>DoSomething</code> method is through the <code>ISomething</code> interface, so the calling code would look like this:</p>\n\n<pre><code>Dim something As ISomething\nSet something = New Class1\nsomething.DoSomething\n</code></pre>\n\n<p>So <code>ISomething</code> is the <em>interface</em> here, and the code that actually runs is <em>implemented</em> in the body of <code>Class1</code>. This is one of the fundamental pillars of OOP: <em>polymorphism</em> - because you could very well have a <code>Class2</code> that <em>implements</em> <code>ISomething</code> in a wildly different way, yet the caller wouldn't ever need to care at all: the implementation is <em>abstracted</em> behind an interface - and that's a beautiful and refreshing thing to see in VBA code!</p>\n\n<p>There are a number of things to keep in mind though:</p>\n\n<ul>\n<li><em>Fields</em> are normally considered as implementation details: if an interface exposes public fields, implementing classes must implement a <code>Property Get</code> and a <code>Property Let</code> (or <code>Set</code>, depending on the type) for it.</li>\n<li><em>Events</em> are considered implementation details, too. Therefore they need to be implemented in the class that <code>Implements</code> the interface, not the interface itself.</li>\n</ul>\n\n<p>That last point is rather annoying. Given <code>Class1</code> that looks like this:</p>\n\n<pre><code>'@Folder StackOverflowDemo\nPublic Foo As String\nPublic Event BeforeDoSomething()\nPublic Event AfterDoSomething()\n\nPublic Sub DoSomething()\nEnd Sub\n</code></pre>\n\n<p>The implementing class would look like this:</p>\n\n<pre><code>'@Folder StackOverflowDemo\nImplements Class1\n\nPrivate Sub Class1_DoSomething()\n    'method implementation\nEnd Sub\n\nPrivate Property Let Class1_Foo(ByVal RHS As String)\n    'field setter implementation\nEnd Property\n\nPrivate Property Get Class1_Foo() As String\n    'field getter implementation\nEnd Property\n</code></pre>\n\n<p>If it's any easier to visualize, the project looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Vcj9l.png\" alt=\"Rubberduck Code Explorer\"></p>\n\n<p>So <code>Class1</code> might define events, but the implementing class has no way of implementing them - that's one sad thing about events and interfaces in VBA, and it stems from <a href=\"https://stackoverflow.com/q/39511528/1188513\">the way events work in COM</a> - events <em>themselves</em> are defined in their own \"event provider\" interface; so a \"class interface\" can't expose events in COM (as far as I understand it), and therefore in VBA.</p>\n\n<hr>\n\n<p>So the events must be defined on the implementing class to make any sense:</p>\n\n<pre><code>'@Folder StackOverflowDemo\nImplements Class1\nPublic Event BeforeDoSomething()\nPublic Event AfterDoSomething()\n\nPrivate foo As String\n\nPrivate Sub Class1_DoSomething()\n    RaiseEvent BeforeDoSomething\n    'do something\n    RaiseEvent AfterDoSomething\nEnd Sub\n\nPrivate Property Let Class1_Foo(ByVal RHS As String)\n    foo = RHS    \nEnd Property\n\nPrivate Property Get Class1_Foo() As String\n    Class1_Foo = foo\nEnd Property\n</code></pre>\n\n<p>If you want to handle the events <code>Class2</code> raises while running code that implements the <code>Class1</code> interface, you need a module-level <code>WithEvents</code> field of type <code>Class2</code> (the implementation), and a procedure-level object variable of type <code>Class1</code> (the interface):</p>\n\n<pre><code>'@Folder StackOverflowDemo\nOption Explicit\nPrivate WithEvents SomeClass2 As Class2 ' Class2 is a \"concrete\" implementation\n\nPublic Sub Test(ByVal implementation As Class1) 'Class1 is the interface\n    Set SomeClass2 = implementation ' will not work if the \"real type\" isn't Class2\n    foo.DoSomething ' runs whichever implementation of the Class1 interface was supplied\nEnd Sub\n\nPrivate Sub SomeClass2_AfterDoSomething()\n'handle AfterDoSomething event of Class2 implementation\nEnd Sub\n\nPrivate Sub SomeClass2_BeforeDoSomething()\n'handle BeforeDoSomething event of Class2 implementation\nEnd Sub\n</code></pre>\n\n<p>And so we have <code>Class1</code> as the interface, <code>Class2</code> as the implementation, and <code>Class3</code> as some client code:</p>\n\n<p><img src=\"https://i.stack.imgur.com/1jEnE.png\" alt=\"Rubberduck Code Explorer\"></p>\n\n<p>...which arguably defeats the purpose of polymorphism, since that class is now coupled with a specific implementation - but then, that's what VBA events do: they <em>are</em> implementation details, inherently coupled with a specific implementation... as far as I know.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1503432537, "post_id": 45825831, "comment_id": 78610434, "body": "That&#39;s beautiful! I&#39;ll let the bounty up for a few days to boost exposure a bit, and then will award it here manually. Well done!"}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1503432770, "post_id": 45825831, "comment_id": 78610523, "body": "@Mat&#39;sMug: Thank you. The true beauty of <i>design patterns</i> is in providing a vocabulary that not only improves communication, but that can guide and inspire thinking. I got to sitting one day thinking &quot;I need some sort of adapter that ... - wait!  That&#39;s a pattern name! How would that work?&quot; A while later, I had the sketch of this design worked out."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1503432880, "post_id": 45825831, "comment_id": 78610564, "body": "My implementation would [ab]use the predeclaredId instance of these classes to expose &quot;static factory methods&quot;, so I&#39;d do <code>Set this.Controller = Controller.Create(ViewAdapter.Create(frm))</code> instead of having a &quot;constructors module&quot; and initializer methods, where <code>this</code> is a private UDT encapsulating all fields for the class; that way I don&#39;t need any semi-Hungarian prefixes ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1503440729, "post_id": 45825831, "comment_id": 78613786, "body": "You know, the worst part is that <i>I knew</i> about the adapter pattern when I wrote my answer... and now I wonder why the heck I didn&#39;t think of doing that!"}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503442885, "post_id": 45825831, "comment_id": 78614342, "body": "@Mat&#39;sMug: I think this particular design advanced me to a true <i>grokking</i> of the <i>adapter pattern</i>. The realization that it is an abstraction despite being a concrete object was the <b>Ah! Ha!</b>  moment; as all client objects instantiate the same concrete class yet have injected their own unique dependencies."}, {"owner": {"reputation": 178, "user_id": 2583994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71ea8638a4d7a64a4308c123bc82ff02?s=128&d=identicon&r=PG", "display_name": "robodude666", "link": "https://stackoverflow.com/users/2583994/robodude666"}, "edited": false, "score": 1, "creation_date": 1503683540, "post_id": 45825831, "comment_id": 78733158, "body": "@PieterGeerkens, I&#39;m not following along with how the different components interact with one another. It seems like <code>ViewAdapter</code>&#39;s <code>DoSomething</code> calls my <code>frm</code>, but <code>Controller</code> doesn&#39;t seem to do anything with <code>ViewAdapter</code>. Is it missing a <code>DoSomething</code> function? Could you please expand on the example to demo the expected setup?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 1, "creation_date": 1511030730, "post_id": 45825831, "comment_id": 81691989, "body": "Pieter I really appreciate you posting this. I&#39;m going to use it as the basis of a new project. I&#39;ve created a sample project with it but I don&#39;t quite understand how all the different events should be used. I know this is asking a lot, but could you expand your answer to include a complete example that 1) creates and uses a real form 2) adds the error handling you mentioned 3) uses the various events and maybe 4) explains how each event should be used? There&#39;s nothing else this professional I&#39;ve ever found and it would help me (and hopefully others) tremendously to see it fully fleshed out."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 1, "creation_date": 1581136724, "post_id": 45825831, "comment_id": 106339008, "body": "@Pieter Geerkens why does <code>Private mData As Object</code> exists if its never used in the Controller or anywhere in the classes?"}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "reply_to_user": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1581153816, "post_id": 45825831, "comment_id": 106341543, "body": "@Jose: That&#39;s an oversight."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 1, "creation_date": 1581154271, "post_id": 45825831, "comment_id": 106341643, "body": "Ah! Got it. Going to use your adapter pattern design on a project I am working on. Ill send you the link once I post on Code Review, would love your feedback. Will also be implementing @Matieu Guindon MVP Pattern he taught on his blog. Code Reuse-ability at its finest here ;)"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1581297615, "post_id": 45825831, "comment_id": 106372929, "body": "Peter - Kinda lost here: &quot;Open and assign frm here as instance of a Form implementing <code>IViewCommands</code> and raising events through the callback interface <code>IViewEvents</code>&quot; - Would this be correct: <code>Set frm = New UserForm1</code> Code behind form <code>Implements IViewCommands</code>. Who is responsible for showing the UserForm?"}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "reply_to_user": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1581301052, "post_id": 45825831, "comment_id": 106373523, "body": "@Jose: Who ever in the code wishes, or is requested, to open the form. If on initial display of the workbook that would be somewhere below <b>ThisWorkbook.Open_Workbook()</b>."}], "tags": [], "owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "is_accepted": true, "score": 28, "last_activity_date": 1535662183, "last_edit_date": 1535662183, "creation_date": 1503431207, "answer_id": 45825831, "question_id": 41023670, "link": "https://stackoverflow.com/questions/41023670/can-we-use-interfaces-and-events-together-at-the-same-time/45825831#45825831", "title": "Can we use Interfaces and Events together at the same time?", "body": "<p>This is a perfect use-case for an <strong>Adapter</strong>: internally <em>adapting</em> the semantics for a set of contracts (interfaces) and exposing them as its own external API; possibly according to some other contract.</p>\n\n<p>Define class modules IViewEvents:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Const mModuleName   As String = \"IViewEvents\"\n\nPublic Sub OnBeforeDoSomething(ByVal Data As Object, ByRef Cancel As Boolean):  End Sub\nPublic Sub OnAfterDoSomething(ByVal Data As Object):                            End Sub\n\nPrivate Sub Class_Initialize()\n    Err.Raise 5, mModuleName, AccessError(5) &amp; \"-Interface class must not be instantiated.\"\nEnd Sub\n</code></pre>\n\n<p>IViewCommands:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Const mModuleName   As String = \"IViewCommands\"\n\nPublic Sub DoSomething(ByVal arg1 As String, ByVal arg2 As Long):   End Sub\n\nPrivate Sub Class_Initialize()\n    Err.Raise 5, mModuleName, AccessError(5) &amp; \"-Interface class must not be instantiated.\"\nEnd Sub\n</code></pre>\n\n<p>ViewAdapter:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Const mModuleName   As String = \"ViewAdapter\"\n\nPublic Event BeforeDoSomething(ByVal Data As Object, ByRef Cancel As Boolean)\nPublic Event AfterDoSomething(ByVal Data As Object)\n\nPrivate mView       As IViewCommands\n\nImplements IViewCommands\nImplements IViewEvents\n\nPublic Function Initialize(View As IViewCommands) As ViewAdapter\n    Set mView = View\n    Set Initialize = Me\nEnd Function\n\nPrivate Sub IViewCommands_DoSomething(ByVal arg1 As String, ByVal arg2 As Long)\n    mView.DoSomething arg1, arg2\nEnd Sub\n\nPrivate Sub IViewEvents_OnBeforeDoSomething(ByVal Data As Object, ByRef Cancel As Boolean)\n    RaiseEvent BeforeDoSomething(Data, Cancel)\nEnd Sub\nPrivate Sub IViewEvents_OnAfterDoSomething(ByVal Data As Object)\n    RaiseEvent AfterDoSomething(Data)\nEnd Sub\n</code></pre>\n\n<p>and Controller:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Const mModuleName       As String = \"Controller\"\n\nPrivate WithEvents mViewAdapter As ViewAdapter\n\nPrivate mData As Object\n\nPublic Function Initialize(ViewAdapter As ViewAdapter) As Controller\n    Set mViewAdapter = ViewAdapter\n    Set Initialize = Me\nEnd Function\n\nPrivate Sub mViewAdapter_AfterDoSomething(ByVal Data As Object)\n    ' Do stuff\nEnd Sub\n\nPrivate Sub mViewAdapter_BeforeDoSomething(ByVal Data As Object, ByRef Cancel As Boolean)\n    Cancel = Data Is Nothing\nEnd Sub\n</code></pre>\n\n<p>plus Standard Modules Constructors:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nOption Private Module\n\nPrivate Const mModuleName   As String = \"Constructors\"\n\nPublic Function NewViewAdapter(View As IViewCommands) As ViewAdapter\n    With New ViewAdapter:   Set NewViewAdapter = .Initialize(View):         End With\nEnd Function\n\nPublic Function NewController(ByVal ViewAdapter As ViewAdapter) As Controller\n    With New Controller:    Set NewController = .Initialize(ViewAdapter):   End With\nEnd Function\n</code></pre>\n\n<p>and MyApplication:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Const mModuleName   As String = \"MyApplication\"\n\nPrivate mController As Controller\n\nPublic Function LaunchApp() As Long\n    Dim frm As IViewCommands \n    ' Open and assign frm here as instance of a Form implementing \n    ' IViewCommands and raising events through the callback interface \n    ' IViewEvents. It requires an initialization method (or property \n    ' setter) that accepts an IViewEvents argument.\n    Set mController = NewController(NewViewAdapter(frm))\nEnd Function\n</code></pre>\n\n<p>Note how use of the <strong>Adapter Pattern</strong> combined with programming to interfaces results in a very flexible structure, where different Controller or View implementations can be substituted in at run time. Each Controller definition (in the case of different implementations being required) uses different instances of the same ViewAdapter implementation, as Dependency Injection is being used to delegate the event-source and command-sink for each instance at run time.</p>\n\n<p>The same pattern can be repeated to define the relationship between the Controller/Presenter/ViewModel and the Model, though implementing MVVM in COM can get rather tedious. I have found MVP or MVC is usually better suited for COM-based applications.</p>\n\n<p>A production implementation would also add proper error handling (at a  minimum) to the extent supported by VBA, which I have only hinted at with the definition of the mModuleName constant in each module.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503532816, "post_id": 45850162, "comment_id": 78660090, "body": "<i>this is [...] why COM got a reputation for being overly complicated</i> - and then came Java (/jk). This is a great answer. Would you happen to know any C#? <a href=\"https://github.com/rubberduck-vba/rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> could use more contributors that know COM (hmm but you probably already know that, right?)..."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503565157, "post_id": 45850162, "comment_id": 78672230, "body": "You&#39;re very kind.  I do know some C#.  I need to execute on some of my own ideas right now."}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503688034, "post_id": 45850162, "comment_id": 78735407, "body": "@Mat&#39;sMug: RubberDuck eh! I recently built a multi-lingual MVVM dispatcher in VBA (should be in C#, exposed to VBA, but my team has no means of distributing functionality outside EXCEL) to ease Ribbon development. It totally eliminates the name for control-specific call-backs, by dispatching all the standard callbacks to the appropriate control view-model by Control.ID. Interested? It&#39;s just a few days work."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1503688576, "post_id": 45850162, "comment_id": 78735594, "body": "@PieterGeerkens Rubberduck is currently completely ignoring Ribbon callbacks, which <i>is</i> causing some inspection false positives (e.g. &quot;procedure not used&quot;). Join us in <a href=\"https://chat.stackexchange.com/rooms/14929\">VBA Rubberducking</a> chat, let&#39;s not discuss this here."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503768143, "post_id": 45850162, "comment_id": 78754809, "body": "Argh, I forgot about the rule that minimum rep cost of successive bounties on the same question <i>double</i> with every new bounty.. I&#39;d have to put up a  +200 bounty to reward another answer.. I&#39;ll probably get around to it, but not right now; still, thanks for posting this amazing answer!"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 9, "last_activity_date": 1503527797, "last_edit_date": 1503527797, "creation_date": 1503526980, "answer_id": 45850162, "question_id": 41023670, "link": "https://stackoverflow.com/questions/41023670/can-we-use-interfaces-and-events-together-at-the-same-time/45850162#45850162", "title": "Can we use Interfaces and Events together at the same time?", "body": "<p>Because bounty is already headed for Pieter's answer I'll not attempt to answer the MVC aspect of the question but instead the headline question.  The answer is Events have limits.</p>\n\n<p>It would be harsh to call them \"syntactic sugar\" because they save a lot of code but at some point if your design gets too complex then you have to bust out and manually implement the functionality.  </p>\n\n<p>But first, a callback mechanism (for that is what events are)</p>\n\n<p>modMain, the entry/starting point</p>\n\n<pre><code>Option Explicit\n\nSub Main()\n\n    Dim oClient As Client\n    Set oClient = New Client\n\n    oClient.Run\n\n\nEnd Sub\n</code></pre>\n\n<p>Client</p>\n\n<pre><code>Option Explicit\n\nImplements IEventListener\n\nPrivate Sub IEventListener_SomethingHappened(ByVal vSomeParam As Variant)\n    Debug.Print \"IEventListener_SomethingHappened \" &amp; vSomeParam\nEnd Sub\n\nPublic Sub Run()\n\n    Dim oEventEmitter As EventEmitter\n    Set oEventEmitter = New EventEmitter\n\n    oEventEmitter.ServerDoWork Me\n\n\nEnd Sub\n</code></pre>\n\n<p>IEventListener, the interface contract that describes the events</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SomethingHappened(ByVal vSomeParam As Variant)\n\nEnd Sub\n</code></pre>\n\n<p>EventEmitter, the server class</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ServerDoWork(ByVal itfCallback As IEventListener)\n\n    Dim lLoop As Long\n    For lLoop = 1 To 3\n        Application.Wait Now() + CDate(\"00:00:01\")\n        itfCallback.SomethingHappened lLoop\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>So how does WithEvents work?  One answer is to look in the type library, here is some IDL from Access (<code>Microsoft Access 15.0 Object Library</code>) defining the events to be raised.  </p>\n\n<pre><code>[\n  uuid(0EA530DD-5B30-4278-BD28-47C4D11619BD),\n  hidden,\n  custom(0F21F359-AB84-41E8-9A78-36D110E6D2F9, \"Microsoft.Office.Interop.Access._FormEvents\")    \n\n]\ndispinterface _FormEvents2 {\n    properties:\n    methods:\n        [id(0x00000813), helpcontext(0x00003541)]\n        void Load();\n        [id(0x0000080a), helpcontext(0x00003542)]\n        void Current();\n    '/* omitted lots of other events for brevity */\n};\n</code></pre>\n\n<p>Also from Access IDL here is the class detailing what its main interface is and what is event interface is, look for <code>source</code> keyword, and VBA needs a <code>dispinterface</code> so ignore one of them.</p>\n\n<pre><code>[\n  uuid(7398AAFD-6527-48C7-95B7-BEABACD1CA3F),\n  helpcontext(0x00003576)\n]\ncoclass Form {\n    [default] interface _Form3;\n    [source] interface _FormEvents;\n    [default, source] dispinterface _FormEvents2;\n};\n</code></pre>\n\n<p>So what that is saying to a client is that operate me via the _Form3 interface but if you want to receive events then <em>you, the client, must implement _FormEvents2.</em>  <strong>And believe it or not VBA will when WithEvents is met spin up an object that implements the source interface for you and then route incoming calls to your VBA handler code.</strong>  Pretty amazing actually.  </p>\n\n<p>So VBA generates a class/object implementing the source interface for you but questioner has met the limits with the interface polymorphism mechanism and events.  So my advice is to abandon WithEvents and implement you own callback interface and this is what the given code above does.</p>\n\n<p>For more information then I recommend reading a C++ book that implements events using the connection point interfaces, your google search terms are <a href=\"https://www.google.co.uk/search?q=connection%20points%20withevents%20&amp;oq=connection%20points%20withevents\" rel=\"noreferrer\" title=\"Google connection points withevents\">connection points withevents</a></p>\n\n<p>Here is a <a href=\"http://thrysoee.dk/InsideCOM+/ch08b.htm\" rel=\"noreferrer\">good quote from 1994</a> highlighting the work VBA does I mentioned above</p>\n\n<blockquote>\n  <p>After slogging through the preceding CSink code, you'll find that intercepting events in Visual Basic is almost dishearteningly easy. You simply use the WithEvents keyword when you declare an object variable, and Visual Basic dynamically creates a sink object that implements the source interface supported by the connectable object. Then you instantiate the object using the Visual Basic New keyword. Now, whenever the connectable object calls methods of the source interface, Visual Basic's sink object checks to see whether you have written any code to handle the call.</p>\n</blockquote>\n\n<p>EDIT: Actually, mulling my example code you could simplify and abolish the intermediate interface class if you do not want to replicate the way COM does things and you are not bothered by coupling.  It is after all just a glorified callback mechanism.  I think this is an example of why COM got a reputation for being overly complicated.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3804, "favorite_count": 27, "accepted_answer_id": 45825831, "answer_count": 4, "score": 29, "last_activity_date": 1535662183, "creation_date": 1481131508, "last_edit_date": 1525816150, "question_id": 41023670, "link": "https://stackoverflow.com/questions/41023670/can-we-use-interfaces-and-events-together-at-the-same-time", "title": "Can we use Interfaces and Events together at the same time?", "body": "<p>I'm still trying to wrap my head around how Interfaces and Events work together (if at all?) in VBA. I'm about to build a large application in Microsoft Access, and I want to make it as flexible and extendable as possible. To do this, I want to make use of <a href=\"https://stackoverflow.com/a/28347000/2363207\">MVC</a>, <a href=\"https://stackoverflow.com/a/19908375/2363207\">Interfaces</a> (<a href=\"http://www.cpearson.com/excel/Implements.aspx\" rel=\"noreferrer\">2</a>) (<a href=\"http://www.devx.com/getHelpOn/10MinuteSolution/20416\" rel=\"noreferrer\">3</a>) , <a href=\"http://dailydoseofexcel.com/archives/2010/07/04/custom-collection-class/\" rel=\"noreferrer\">Custom Collection Classes</a>, <a href=\"https://stackoverflow.com/a/19327352/2363207\">Raising Events Using Custom Collection Classes</a>, finding better ways to <a href=\"https://stackoverflow.com/a/23529951/2363207\">centralize</a> and <a href=\"https://codereview.stackexchange.com/questions/68221/overriding-all-access-form-control-afterupdate-methods\">manage</a> the events triggered by the controls on a form, and some additional <a href=\"http://www.utteraccess.com/forum/Vba-Design-Patterns-and-Pr-t1972131.html\" rel=\"noreferrer\">VBA design patterns</a>. </p>\n\n<p>I anticipate that this project is going to get pretty hairy so I want to try to grok the limits and benefits of using interfaces and events together in VBA since they are the two main ways (I think) to really implement loose-coupling in VBA. </p>\n\n<p>To start with, there is <a href=\"https://stackoverflow.com/questions/3022879/run-time-error-459-when-using-withevents-with-a-class-that-implements-another\">this question</a> about an error raised when trying to use interfaces and events together in VBA. The answer states \"Apparently Events are not allowed to be passed through an interface class into the concrete class like you want to using 'Implements'.\"</p>\n\n<p>Then I found this statement in an <a href=\"https://www.pcreview.co.uk/threads/interfaces-for-vba-forms.987855/#post-2897067\" rel=\"noreferrer\">answer on another forum</a>: \"In VBA6 we can only raise events declared in a class's default interface - we can't raise events declared in an Implemented interface.\" </p>\n\n<p>Since I'm still groking interfaces and events (VBA is the first language I've really had a chance to try out OOP in a real-world setting, I know <em>shudder</em>), I can't quite work through in my mind what all this means for using events and interfaces together in VBA. It kinda sounds like you can use them both at the same time, and it kinda sounds like you can't. (For instance, I'm not sure what is meant above by \"a class's default interface\" vs \"an Implemented interface.\")</p>\n\n<p>Can someone give me some basic examples of the real benefits and limitations of using Interfaces and Events together in VBA?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 146, "user_id": 4016180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_p4hxsnAQmA/AAAAAAAAAAI/AAAAAAAAJzs/ytIsqnM3gKY/photo.jpg?sz=128", "display_name": "Bernd Stoeckel", "link": "https://stackoverflow.com/users/4016180/bernd-stoeckel"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1481132586, "post_id": 41023568, "comment_id": 69255064, "body": "oh, If that doesn&#39;t help there might be an Issue with the references, I found somewhere else: <a href=\"https://www.pcreview.co.uk/threads/application-screenupdating.3585123/\" rel=\"nofollow noreferrer\">pcreview.co.uk/threads/application-screenupdating.3585123</a>  Check From the editor Tools -&gt; References  and what you have ticked there It&#39;s about ScreenUpdating but the same error message."}], "tags": [], "owner": {"reputation": 146, "user_id": 4016180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_p4hxsnAQmA/AAAAAAAAAAI/AAAAAAAAJzs/ytIsqnM3gKY/photo.jpg?sz=128", "display_name": "Bernd Stoeckel", "link": "https://stackoverflow.com/users/4016180/bernd-stoeckel"}, "is_accepted": false, "score": 1, "last_activity_date": 1481131167, "creation_date": 1481131167, "answer_id": 41023568, "question_id": 41023527, "link": "https://stackoverflow.com/questions/41023527/excel-vba-application-statusbar-in-worksheet-deactivate-fails-with-50290/41023568#41023568", "title": "Excel VBA Application.StatusBar in Worksheet_Deactivate fails with 50290", "body": "<p>Just set it to False</p>\n\n<pre><code>Application.StatusBar = False\n</code></pre>\n\n<p>from Microsoft: </p>\n\n<blockquote>\n  <p>This property returns False if Microsoft Excel has control of the status bar. To restore the default status bar text, set the property to False; this works even if the status bar is hidden.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 0, "last_activity_date": 1481709766, "creation_date": 1481709766, "answer_id": 41139725, "question_id": 41023527, "link": "https://stackoverflow.com/questions/41023527/excel-vba-application-statusbar-in-worksheet-deactivate-fails-with-50290/41139725#41139725", "title": "Excel VBA Application.StatusBar in Worksheet_Deactivate fails with 50290", "body": "<p>I found the problem. When an event handler starts execution, the Excel Application may not be ready, so this has to be checked if the code refers to objects related to the Application:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    If Application.Ready = False Then Exit Sub\n    ' Rest of the code referring to Application.x or Me.y or ActiveSheet.z, etc.\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481709766, "creation_date": 1481131056, "question_id": 41023527, "link": "https://stackoverflow.com/questions/41023527/excel-vba-application-statusbar-in-worksheet-deactivate-fails-with-50290", "title": "Excel VBA Application.StatusBar in Worksheet_Deactivate fails with 50290", "body": "<p>I have a Worksheet, which updates the StatusBar based on which cell is selected (this works fine). My problem is, with the code that sets the StatusBar back to empty when the user goes to another Worksheet:</p>\n\n<pre><code>Private Sub Worksheet_Deactivate()\n    Application.StatusBar = vbNullString ' Run time error here\nEnd Sub\n</code></pre>\n\n<p>Err.Description is: \"Method 'StatusBar' of object '_Application' failed\", Err.Number is: 50290.</p>\n\n<p>This error occurs only if the user changes from Worksheet to Worksheet rapidly (by pressing Ctrl+PgUp or Ctrl+PgDown) and does not happen in case of switching to another Sheet slowly.</p>\n\n<p>Why do I have this error?</p>\n"}, {"tags": ["excel", "vba", "number-formatting"], "comments": [{"owner": {"reputation": 25, "user_id": 6825160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad80f3f7ec5158603bdedb349202e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6825160/albert"}, "edited": false, "score": 0, "creation_date": 1481131058, "post_id": 41023449, "comment_id": 69254096, "body": "in the first solution i would like to use NumberFormat instead of the Format function, but VBA doesn&#39;t allow me. Don&#39;t know why. The problem of this solution is that i don&#39;t get numbers but strings"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1481131969, "post_id": 41023449, "comment_id": 69254670, "body": "Is <code>ArrayTOService(i)</code> an internal VBA array or an array of worksheet cells ???"}, {"owner": {"reputation": 25, "user_id": 6825160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad80f3f7ec5158603bdedb349202e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6825160/albert"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1481132260, "post_id": 41023449, "comment_id": 69254848, "body": "just an array that i made up. i use it for some graphs."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6825160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad80f3f7ec5158603bdedb349202e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6825160/albert"}, "edited": false, "score": 0, "creation_date": 1481134646, "post_id": 41024053, "comment_id": 69256220, "body": "I am sorry, but i don&#39;t get you. Your code writes as string the number format. It erases actually the values of arrayToService(i)"}, {"owner": {"reputation": 25, "user_id": 6825160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad80f3f7ec5158603bdedb349202e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6825160/albert"}, "edited": false, "score": 0, "creation_date": 1481203286, "post_id": 41024053, "comment_id": 69288269, "body": "Please some help?  I have found that the function FORMAT just works in Excel, not with arrays. How can I change the formatnumber in a array? I have 800000 and i want 800.000."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 25, "user_id": 6825160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad80f3f7ec5158603bdedb349202e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6825160/albert"}, "edited": false, "score": 0, "creation_date": 1481204231, "post_id": 41024053, "comment_id": 69288868, "body": "@Albert  see my <b>EDIT#1</b>"}, {"owner": {"reputation": 25, "user_id": 6825160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad80f3f7ec5158603bdedb349202e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6825160/albert"}, "edited": false, "score": 0, "creation_date": 1481207588, "post_id": 41024053, "comment_id": 69291154, "body": "Thanks a lot for your answer, but still not what I need. I repeat, I don&#39;t want strings, I want doubles with points (800  .   000) in my array.  I just want to have an array with doubles, and this doubles with the point separator for 1000- Ex: 1.000.000 instead of 1000000 Thanks!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 25, "user_id": 6825160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad80f3f7ec5158603bdedb349202e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6825160/albert"}, "edited": false, "score": 0, "creation_date": 1481207671, "post_id": 41024053, "comment_id": 69291208, "body": "@Albert  I don&#39;t understand."}, {"owner": {"reputation": 25, "user_id": 6825160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad80f3f7ec5158603bdedb349202e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6825160/albert"}, "edited": false, "score": 0, "creation_date": 1481208472, "post_id": 41024053, "comment_id": 69291727, "body": "I have an array with following info: MyArray(1) = 800000 --&gt; type Double /  I want an array with following info: MyArray(1) = 800.000 --&gt; Type Double / your solution: MyArray(1) = 800.000 --&gt; Type STRING.  I don&#39;t want strings, I want doubles as type. I need to still operate with the numbers, i can&#39;t operate with strings, at least with charts"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1481204206, "last_edit_date": 1481204206, "creation_date": 1481132882, "answer_id": 41024053, "question_id": 41023449, "link": "https://stackoverflow.com/questions/41023449/change-numberformat-with-expression-in-array/41024053#41024053", "title": "Change NumberFormat (with expression) in array", "body": "<p>If\n    <code>ArrayTOService</code></p>\n\n<p>is just a VBA array, you do not need a qualifier:</p>\n\n<pre><code>Sub dural()\n    Dim ArrayTOService(1 To 2) As String\n    For i = 1 To 2\n        ArrayTOService(i) = \"[&gt;=1000000] $#,##0.0,,\"\"M\"\";[&gt;0] $#,##0.0,\"\"K\"\";General\"\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>We need to convert each <strong>numeric</strong> value into a <strong>string</strong>:</p>\n\n<pre><code>Sub dural2()\n    Dim ArrayTOService(1 To 2) As String\n    ArrayTOService(1) = 1.123\n    ArrayTOService(2) = -8.123\n\n    For i = 1 To 2\n        ArrayTOService(i) = Format(ArrayTOService(i), \"[&gt;=1000000] $#,##0.0,,\"\"M\"\";[&gt;0] $#,##0.0,\"\"K\"\";General\")\n    Next i\n\n    MsgBox ArrayTOService(1) &amp; vbCrLf &amp; ArrayTOService(2)\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/1WBMj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1WBMj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 6825160, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad80f3f7ec5158603bdedb349202e1ab?s=128&d=identicon&r=PG&f=1", "display_name": "Albert", "link": "https://stackoverflow.com/users/6825160/albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488817483, "creation_date": 1481130808, "last_edit_date": 1488817483, "question_id": 41023449, "link": "https://stackoverflow.com/questions/41023449/change-numberformat-with-expression-in-array", "title": "Change NumberFormat (with expression) in array", "body": "<p>I want to use an expression to change the format number of an array:</p>\n\n<pre><code>'ArrayTOService(i) = Format(ArrayTOService(i), \"[&gt;=1000000] $#,##0.0,,\"\"M\"\";[&gt;0] $#,##0.0,\"\"K\"\";General\")\nArrayTOService(i).NumberFormat = \"[&gt;=1000000] $#,##0.0,,\"\"M\"\";[&gt;0] $#,##0.0,\"\"K\"\";General\"\n</code></pre>\n\n<p>I have tried these two solutions. None of them working.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1481130639, "post_id": 41023377, "comment_id": 69253827, "body": "Record a macro using Remove Duplicates, then make it dynamic to fit your needs."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 2, "creation_date": 1481130830, "post_id": 41023377, "comment_id": 69253946, "body": "One way to avoid writing code is to just concatenate the columns you want (in this case, D and E). Then, filter by that concatenation and delete. You can create this concatenated column using the formula <code>=D1&amp;E1</code> and dragging it down. Or, if you&#39;re looking to see if D and E are the same value on each row, you would use <code>=D1=E1</code> and filter the <code>TRUE</code>&#39;s to delete."}], "answers": [{"tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 2, "last_activity_date": 1481131554, "creation_date": 1481131554, "answer_id": 41023682, "question_id": 41023377, "link": "https://stackoverflow.com/questions/41023377/remove-duplicate-rows-excel-vba/41023682#41023682", "title": "Remove duplicate rows Excel VBA", "body": "<p>Here is an example that does this.</p>\n\n<p>Make sure you run it with the sheet you want to use up:</p>\n\n<pre><code>Sub DeleteDupes()\nDim x\nFor x = Cells(Rows.CountLarge, \"D\").End(xlUp).Row To 1 Step -1\n    If Cells(x, \"D\") = Cells(x, \"E\") Then\n        'This line deletes the row:\n        Cells(x, \"D\").EntireRow.Delete xlShiftUp\n        'This line highlights the row to show what would be deleted;\n        'Cells(x, \"D\").EntireRow.Interior.Color = RGB(230, 180, 180)\n    End If\nNext x\nEnd Sub\n</code></pre>\n\n<p>Results of highlighting:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YqhJR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YqhJR.png\" alt=\"Results\"></a></p>\n\n<p>Results of Delete:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iXa5x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iXa5x.png\" alt=\"Results2\"></a></p>\n"}], "owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3612, "favorite_count": 0, "accepted_answer_id": 41023682, "answer_count": 1, "score": -3, "last_activity_date": 1539890595, "creation_date": 1481130556, "question_id": 41023377, "link": "https://stackoverflow.com/questions/41023377/remove-duplicate-rows-excel-vba", "title": "Remove duplicate rows Excel VBA", "body": "<p>I am writing a script in VBA that would remove duplicate rows in an Excel spreadsheet. However, I want it to delete duplicate rows considering only information in two columns.</p>\n\n<p>In other words, I have a table with the range B:F. I want the script to remove duplicate rows considering, for each row, only the values on columns D and E. In the end, only rows which simultaneously have the exact same values on columns D and E - regardless of other columns - will be removed. How could I go about doing this? Thank you</p>\n"}, {"tags": ["excel", "vba", "loops", "charts", "automation"], "comments": [{"owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 1, "creation_date": 1481135147, "post_id": 41023360, "comment_id": 69256511, "body": "Not sure I completely understand you - what&#39;s wrong with copying the tabs &amp; renaming? How many tabs are we talking about? Is it a one-off operation? Because if it is it seems to me writing a script is an overkill no?"}, {"owner": {"reputation": 1, "user_id": 7263555, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5EcAcfznV1U/AAAAAAAAAAI/AAAAAAAACGg/YTk8ccsar0I/photo.jpg?sz=128", "display_name": "Batman ", "link": "https://stackoverflow.com/users/7263555/batman"}, "reply_to_user": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 0, "creation_date": 1481209466, "post_id": 41023360, "comment_id": 69292486, "body": "This is currently a one off request. So i will try to explain better. I have 32 reports and i have created a set of six charts for the first tab. I now need to write a macro to create a new tab next to each existing tab and rename said tab to the value include in cell a5 and then copy the template charts to each of the new tabs. While this is a one off I forsee the organization requesting similiar reports."}, {"owner": {"reputation": 1, "user_id": 7263555, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5EcAcfznV1U/AAAAAAAAAAI/AAAAAAAACGg/YTk8ccsar0I/photo.jpg?sz=128", "display_name": "Batman ", "link": "https://stackoverflow.com/users/7263555/batman"}, "reply_to_user": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 0, "creation_date": 1481209615, "post_id": 41023360, "comment_id": 69292608, "body": "Here is the code i have so far                                                                 Sub CreateSheetsFromAList()     Dim MyCell As Range, MyRange As Range          Set MyRange = Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;)     Set MyRange = Range(MyRange, MyRange.End(xlDown))      For Each MyCell In MyRange         Sheets.Add After:=Sheets(Sheets.Count) &#39;creates a new worksheet         Sheets(Sheets.Count).Name = MyCell.Value &#39; renames the new worksheet     Next MyCell End Sub            This will create the Tabs but i am having an issue with where they are placed"}], "owner": {"reputation": 1, "user_id": 7263555, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5EcAcfznV1U/AAAAAAAAAAI/AAAAAAAACGg/YTk8ccsar0I/photo.jpg?sz=128", "display_name": "Batman ", "link": "https://stackoverflow.com/users/7263555/batman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481145642, "creation_date": 1481130502, "last_edit_date": 1481145642, "question_id": 41023360, "link": "https://stackoverflow.com/questions/41023360/vba-loop-to-create-a-new-tab-for-every-existing-tab-and-then-copy-a-predesignate", "title": "VBA loop to create a new tab for every existing tab and then copy a predesignated chart template to each new tab", "body": "<p>I need to create a new tab for every existing tab and select a cell name on the extisting tab to rename the new adjacent tab. Next I would like to copy a template  which includes 6 charts to each of the new tabs.</p>\n\n<p>Is this possible or does someone possibly already have code that could accomplish this? I am new to vba and this is a little over my head. I will go through and just do it individually but it would be awesome if this could be automated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 146, "user_id": 4016180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_p4hxsnAQmA/AAAAAAAAAAI/AAAAAAAAJzs/ytIsqnM3gKY/photo.jpg?sz=128", "display_name": "Bernd Stoeckel", "link": "https://stackoverflow.com/users/4016180/bernd-stoeckel"}, "edited": false, "score": 0, "creation_date": 1481130655, "post_id": 41023309, "comment_id": 69253840, "body": "sounds all plausible, where do you have the problem? Can you post the basic code you have?"}, {"owner": {"reputation": 13, "user_id": 5640770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb26d6e6bf721651bfd6c1908e67575a?s=128&d=identicon&r=PG&f=1", "display_name": "tcoco", "link": "https://stackoverflow.com/users/5640770/tcoco"}, "reply_to_user": {"reputation": 146, "user_id": 4016180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_p4hxsnAQmA/AAAAAAAAAAI/AAAAAAAAJzs/ytIsqnM3gKY/photo.jpg?sz=128", "display_name": "Bernd Stoeckel", "link": "https://stackoverflow.com/users/4016180/bernd-stoeckel"}, "edited": false, "score": 0, "creation_date": 1481130976, "post_id": 41023309, "comment_id": 69254045, "body": "I can get a1 and  one section to copy but adding the others I am getting lost"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1481135431, "post_id": 41023309, "comment_id": 69256666, "body": "You need to qualify the <code>Rows.Count</code> with the sheet. I don&#39;t know if it&#39;ll solve it, but you should do, for example, <code>pasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues</code>  Otherwise, the <code>Rows.Count</code> is going to count the rows on whatever sheet you have active."}, {"owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 1, "creation_date": 1481135856, "post_id": 41023309, "comment_id": 69256952, "body": "I think you need to re-think your structure a bit. What one day is skipped? If you just copy-past blindly without checking the data is there not a chance everything gets pasted in the wrong place? Also since you have a bunch of &quot;ranges&quot; on top of one another, it isn&#39;t practical for expension - i would put them horizontally (to leave room below). Finally, I think I would recommand using tables for your destinations...."}, {"owner": {"reputation": 13, "user_id": 5640770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb26d6e6bf721651bfd6c1908e67575a?s=128&d=identicon&r=PG&f=1", "display_name": "tcoco", "link": "https://stackoverflow.com/users/5640770/tcoco"}, "edited": false, "score": 0, "creation_date": 1481136675, "post_id": 41023309, "comment_id": 69257447, "body": "ok I think i will relook at everything the final numbers get plotted on graphs  and I was trying to make it easier on some end users but I might be making it to complicated on myself"}], "owner": {"reputation": 13, "user_id": 5640770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb26d6e6bf721651bfd6c1908e67575a?s=128&d=identicon&r=PG&f=1", "display_name": "tcoco", "link": "https://stackoverflow.com/users/5640770/tcoco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526481513, "creation_date": 1481130321, "last_edit_date": 1526481513, "question_id": 41023309, "link": "https://stackoverflow.com/questions/41023309/vb-copy-and-paste-in-excel-from-one-sheet-to-another-with-multiple-targets", "title": "VB copy and paste in excel from one sheet to another with multiple targets", "body": "<p>What I am trying to accomplish is I have an excel worksheet that is updated on a daily basis. I would like to implement a script that takes the data from those cells and add them to the next available cell on another sheet via a button. I have a basic code that works by copying a range of cells to the other sheets next available blank cell. But this is what I'm looking to do cell A1(which is a date) on sheet1 needs to copy to A7,G7,M7,A34,G34 and M34 on sheet2. Then B2,B3,B4,B5 from sheet1 copy to B7,C7,D7,E7 on sheet2. Then C2,C3,C4,C5 from sheet1 to H7,I7,J7,K7 on sheet2.</p>\n\n<p>Sheet 1 cells never change only the data that the user puts into those cells change. Sheet2 cells would have to move down one after the button click</p>\n\n<p>Code that I am playing with</p>\n\n<pre><code>Sub Rectangle1_Click()\nApplication.ScreenUpdating = False\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\n\nSet copySheet = Worksheets(\"Sheet1\")\nSet pasteSheet = Worksheets(\"Sheet2\")\n\ncopySheet.Range(\"A1\").Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Maybe a Picture of what I'm working with will help</p>\n\n<p>This is where users enter the daily data:</p>\n\n<p><img src=\"https://i.stack.imgur.com/fP09N.png\" alt=\"This is where users enter the daily data\"></p>\n\n<p>This is where the data needs to populate to:</p>\n\n<p><img src=\"https://i.stack.imgur.com/GjctB.png\" alt=\"This is where the data needs to populate to\"></p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481131047, "post_id": 41023277, "comment_id": 69254086, "body": "you need to put all the lines, starting with <code>Range(FieldName.Offset(1), FieldName.End(xlDown)).Select</code> at the <code>Else</code> section of <code>If FieldName Is Nothing Then</code> , to make sure <code>Find</code> method for finding <code>FieldName</code> was successful."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5806469, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d0f10413165fa78e2b86aae51947e00?s=128&d=identicon&r=PG&f=1", "display_name": "MrLockett", "link": "https://stackoverflow.com/users/5806469/mrlockett"}, "edited": false, "score": 0, "creation_date": 1481134821, "post_id": 41023749, "comment_id": 69256322, "body": "Hi, I am not sure where to insert this into the existing code and if this is selecting all in the Column(Field) including blanks to the end of the column?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 93, "user_id": 5806469, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d0f10413165fa78e2b86aae51947e00?s=128&d=identicon&r=PG&f=1", "display_name": "MrLockett", "link": "https://stackoverflow.com/users/5806469/mrlockett"}, "edited": false, "score": 0, "creation_date": 1481189755, "post_id": 41023749, "comment_id": 69279431, "body": "Add the code as a new function.  Create a range variable in the <code>SelectDown</code> procedure - e.g. <code>Dim rLastCell as Range</code>.  Replace the <code>End If</code> after your <code>MsgBox</code> with <code>Else</code> and the <code>Else</code> at the bottom of your code with an <code>End If</code>.  Now, after the <code>Else</code> statement add this line of code: <code>Set rLastCell = LastCell(ActiveSheet, FieldName.Column)</code> and change <code>Range(FieldName.Offset(1), FieldName.End(xlDown)).Select</code> to <code>Range(FieldName.Offset(1), rLastCell.Row).Select</code>.  I won&#39;t go into the whole avoid using <code>Select</code> thing."}, {"owner": {"reputation": 93, "user_id": 5806469, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d0f10413165fa78e2b86aae51947e00?s=128&d=identicon&r=PG&f=1", "display_name": "MrLockett", "link": "https://stackoverflow.com/users/5806469/mrlockett"}, "edited": false, "score": 0, "creation_date": 1481209821, "post_id": 41023749, "comment_id": 69292761, "body": "Hello, I have changed the code as such and now I am getting a Runtime error 1004: Method Range of Object Global Failed. for the line <code>Range(FieldName.Offset(1), rLastCell.Row).Select</code> I put the function first then a break then the Sub follows that. I made the changes with the else and the code and this is what happens. Not sure what I may be doing incorrect."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 93, "user_id": 5806469, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d0f10413165fa78e2b86aae51947e00?s=128&d=identicon&r=PG&f=1", "display_name": "MrLockett", "link": "https://stackoverflow.com/users/5806469/mrlockett"}, "edited": false, "score": 0, "creation_date": 1481210412, "post_id": 41023749, "comment_id": 69293159, "body": "Sorry - rushed my response a bit as was due in a meeting.  Try changing the line to <code>Cells(rLastCell.Row,FieldName.Column).Select</code>"}, {"owner": {"reputation": 93, "user_id": 5806469, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d0f10413165fa78e2b86aae51947e00?s=128&d=identicon&r=PG&f=1", "display_name": "MrLockett", "link": "https://stackoverflow.com/users/5806469/mrlockett"}, "edited": false, "score": 0, "creation_date": 1481211805, "post_id": 41023749, "comment_id": 69294214, "body": "Ok, changed that, essentially the action now is that it goes to the last cell in the Column and makes the change to that cell. Is there a way to make that go all the way to the top minus the header, even if there are blanks and select that entire range of that column so that I can make the change? Thank you for all your help."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 93, "user_id": 5806469, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d0f10413165fa78e2b86aae51947e00?s=128&d=identicon&r=PG&f=1", "display_name": "MrLockett", "link": "https://stackoverflow.com/users/5806469/mrlockett"}, "edited": false, "score": 0, "creation_date": 1481212191, "post_id": 41023749, "comment_id": 69294498, "body": "Ah, ok.  Get  you now.  So to select the visible cells from row 2 to the bottom row you&#39;d use <code>Range(Cells(2, FieldName.Column), Cells(rLastCell.Row, FieldName.Column)).SpecialCells(xlCellTypeVisible).Select</code>.  I&#39;d also strongly suggest looking into avoiding using <code>Select</code>, using <code>With...End With</code> and qualifying range references."}, {"owner": {"reputation": 93, "user_id": 5806469, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d0f10413165fa78e2b86aae51947e00?s=128&d=identicon&r=PG&f=1", "display_name": "MrLockett", "link": "https://stackoverflow.com/users/5806469/mrlockett"}, "edited": false, "score": 0, "creation_date": 1481212900, "post_id": 41023749, "comment_id": 69295041, "body": "Works Perfect, I am fairly new to this, if you have any links with insight on why not and also what to do in place of that, I am all for it, always trying to grow. Thank you so much again!!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 93, "user_id": 5806469, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d0f10413165fa78e2b86aae51947e00?s=128&d=identicon&r=PG&f=1", "display_name": "MrLockett", "link": "https://stackoverflow.com/users/5806469/mrlockett"}, "edited": false, "score": 0, "creation_date": 1481213919, "post_id": 41023749, "comment_id": 69295707, "body": "Qualifying range references: <a href=\"http://stackoverflow.com/questions/25871416/excel-vba-fully-qualifying-range-cells-cells\" title=\"excel vba fully qualifying range cells cells\">stackoverflow.com/questions/25871416/&hellip;</a>.  Avoid using select: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/28700020\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a> With...End With:  <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/wc500chb.aspx</a>"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1481131758, "creation_date": 1481131758, "answer_id": 41023749, "question_id": 41023277, "link": "https://stackoverflow.com/questions/41023277/xldown-not-selecting-blank-cells/41023749#41023749", "title": "xlDown Not Selecting Blank Cells", "body": "<p>You could use this code.<br>\nUse <code>Set FieldName = Range(\"A1:BZ1\").Find(\"COLUMN NAME\")</code> to find the column number (providing it's NOT NOTHING) and supply that as the Optional Col number.</p>\n\n<pre><code>Public Function LastCell(wrkSht As Worksheet, Optional Col As Long = 0) As Range\n\n    Dim lLastCol As Long, lLastRow As Long\n\n    On Error Resume Next\n\n    With wrkSht\n        If Col = 0 Then\n            lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n            lLastRow = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n        Else\n            lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n            lLastRow = .Columns(Col).Find(\"*\", , , , xlByColumns, xlPrevious).Row\n        End If\n\n        If lLastCol = 0 Then lLastCol = 1\n        If lLastRow = 0 Then lLastRow = 1\n\n        Set LastCell = wrkSht.Cells(lLastRow, lLastCol)\n    End With\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5806469, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d0f10413165fa78e2b86aae51947e00?s=128&d=identicon&r=PG&f=1", "display_name": "MrLockett", "link": "https://stackoverflow.com/users/5806469/mrlockett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1130, "favorite_count": 0, "accepted_answer_id": 41023749, "answer_count": 1, "score": 0, "last_activity_date": 1481131758, "creation_date": 1481130225, "last_edit_date": 1481130925, "question_id": 41023277, "link": "https://stackoverflow.com/questions/41023277/xldown-not-selecting-blank-cells", "title": "xlDown Not Selecting Blank Cells", "body": "<p>I am having an issue where a particular Column has blanks in the middle of it for certain rows. This is leading the code: </p>\n\n<blockquote>\n  <p>Range(FieldName.Offset(1), FieldName.End(xlDown)).Select</p>\n</blockquote>\n\n<p>To not select all of the cells since it is stopping at the blank cells and filling in XYZ for the cells right before the blanks.</p>\n\n<p>I know that xlup will remedy this issue, however, if the last cell of the field is blank then it will not change that cell and go to the next populated cell. I am not sure on how to modify my code so that it utilizes xlup and avoids if the bottom cells are blank in the column. I do have a column named \"ABC\" that will always have all of its rows populated that I can maybe ping off of in order to call it out as the last row of the filtered data, but I am not sure how to do this.</p>\n\n<p><strong>My Code</strong></p>\n\n<pre><code>Sub SelectDown()\n\nDim FieldName As Range\nDim rng As Range, res As Variant, lrow As Long\n\nSet rng = ActiveSheet.AutoFilter.Range.Rows(1)\nres = Application.Match(\"Errors\", rng, 0)\n\n'Finds the Specific Error'\nrng.AutoFilter Field:=res, Criteria1:=\"*-SHOULD BE XYZ*\"\n\n'Only Shows rows that have something that matches the filter criteria\nlrow = ActiveSheet.Cells(Rows.Count, res).End(xlUp).Row + 1\n\nIf ActiveSheet.Range(Cells(1, res), Cells(lrow, res)).SpecialCells(xlCellTypeVisible).Cells.Count &gt; 1 Then\n\n    Set FieldName = Range(\"A1:BZ1\").Find(\"COLUMN NAME\")\n\n    'If field isnt present shows message\n    If FieldName Is Nothing Then\n        MsgBox \"Field Name was not found.\"\n    End If\n\n    'Changes the Selection to XYZ if there is a change present\n    Range(FieldName.Offset(1), FieldName.End(xlDown)).Select\n    Selection.FormulaR1C1 = \"XYZ\"\n    'Changes the Color of the fields changed to Yellow\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n    End With\nElse\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1481130071, "post_id": 41023102, "comment_id": 69253503, "body": "Do you need VBA? I <i>think</i> you could do this, with some uses of <code>Mid()</code> and <code>Search()</code>.  Edit: Here&#39;s a quick, probably too easy, way: <code>=LEFT(A1,SEARCH(&quot; &quot;,A1))&amp;RIGHT(A1,4)</code>. And if you need it in VBA, just &quot;translate&quot; it to VBA.  This assumes your last word is always 4 letters...if it&#39;s more, you can tweak."}, {"owner": {"reputation": 146, "user_id": 4016180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_p4hxsnAQmA/AAAAAAAAAAI/AAAAAAAAJzs/ytIsqnM3gKY/photo.jpg?sz=128", "display_name": "Bernd Stoeckel", "link": "https://stackoverflow.com/users/4016180/bernd-stoeckel"}, "edited": false, "score": 0, "creation_date": 1481130222, "post_id": 41023102, "comment_id": 69253577, "body": "I prefer VBA to worksheets because on the long run I have less work but whether you do you manually or programmatically, I also wanted to ask if you wouldn&#39;t rather use Left() and Mid() or Find() (Search() if manually)"}, {"owner": {"reputation": 277, "user_id": 6328219, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-i23iUmWbtIc/AAAAAAAAAAI/AAAAAAAAAAA/SCA_yrgV8go/photo.jpg?sz=128", "display_name": "jay", "link": "https://stackoverflow.com/users/6328219/jay"}, "edited": false, "score": 0, "creation_date": 1481131165, "post_id": 41023102, "comment_id": 69254170, "body": "Thanks guys, I know about Left() and Mid() but I&#39;m looking for a way to do this with less and simpler coding as possible. Left() and Mid() were my first option but then I remember seeing a solution like this before, I just couldn&#39;t remember the term or name of that solution.:) I need to find a solution through VBA for other reasons."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1481130091, "creation_date": 1481130091, "answer_id": 41023228, "question_id": 41023102, "link": "https://stackoverflow.com/questions/41023102/excel-vba-complex-string-replace/41023228#41023228", "title": "Excel VBA Complex String Replace", "body": "<p>Something like this, in line with BruceWayne, instr is the search and we're using mid, both available as WS functions</p>\n\n<pre><code>Dim sINPUT  As String\n    Dim sOUTPUT As String\n\n    sINPUT = \"Mandatory659852 y n n TRY RACE\"\n\n    sOUTPUT = Mid(sINPUT, 1, (InStr(1, sINPUT, \" y n n\") - 6) - 1)\n    sOUTPUT = sOUTPUT &amp; Mid(sINPUT, 3 + (InStr(1, sINPUT, \"y n n\") + 1 + Len(\"y n n\")))        \n    Debug.Print sOUTPUT\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1481130723, "post_id": 41023241, "comment_id": 69253879, "body": "This is awesome, I never knew you could do that.  (Also, the confirmation that&#39;s dragged into the view made me chuckle)."}, {"owner": {"reputation": 277, "user_id": 6328219, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-i23iUmWbtIc/AAAAAAAAAAI/AAAAAAAAAAA/SCA_yrgV8go/photo.jpg?sz=128", "display_name": "jay", "link": "https://stackoverflow.com/users/6328219/jay"}, "edited": false, "score": 1, "creation_date": 1481131435, "post_id": 41023241, "comment_id": 69254340, "body": "There it is! :D Awesome! <code>Sheet1.Range(&quot;B1&quot;).Value = Sheet1.Range(&quot;A1&quot;).Replace(&quot;?????? y n n ??? &quot;, &quot; &quot;, xlPart, xlByRows, False)</code>. It is simpler and easy to code."}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 10, "last_activity_date": 1481130553, "last_edit_date": 1481130553, "creation_date": 1481130134, "answer_id": 41023241, "question_id": 41023102, "link": "https://stackoverflow.com/questions/41023102/excel-vba-complex-string-replace/41023241#41023241", "title": "Excel VBA Complex String Replace", "body": "<p>VBA:</p>\n\n<p>You use <code>?</code> to match a single wildcard character.</p>\n\n<p>Just highlight the cells and run this macro.</p>\n\n<p>You can also just use this in the Find/Replace dialog.</p>\n\n<pre><code>Sub FixIt()\nSelection.Replace \"?????? y n n ???\", \"\", xlPart\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Chxfp.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Chxfp.gif\" alt=\"Results\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "is_accepted": false, "score": 3, "last_activity_date": 1481130334, "creation_date": 1481130334, "answer_id": 41023312, "question_id": 41023102, "link": "https://stackoverflow.com/questions/41023102/excel-vba-complex-string-replace/41023312#41023312", "title": "Excel VBA Complex String Replace", "body": "<p>I used a formula as you have quite a common format. If the value is in A1, then in B1 try:  </p>\n\n<p>=LEFT(A1,SEARCH(\"y n n\",A1)-8) &amp; RIGHT(A1,LEN(A1)-(SEARCH(\"y n n\",A1)+8))</p>\n\n<p><a href=\"https://i.stack.imgur.com/tfjNv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tfjNv.png\" alt=\"Excel results\"></a></p>\n\n<p>Of course this depends on you always having a very strict format with 6 digits followed by a space followed by a \"y n n\" followed by a space, followed by a 3 letter word, followed by a space and then something else!!</p>\n"}], "owner": {"reputation": 277, "user_id": 6328219, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-i23iUmWbtIc/AAAAAAAAAAI/AAAAAAAAAAA/SCA_yrgV8go/photo.jpg?sz=128", "display_name": "jay", "link": "https://stackoverflow.com/users/6328219/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "accepted_answer_id": 41023241, "answer_count": 3, "score": 3, "last_activity_date": 1481130553, "creation_date": 1481129673, "last_edit_date": 1481130120, "question_id": 41023102, "link": "https://stackoverflow.com/questions/41023102/excel-vba-complex-string-replace", "title": "Excel VBA Complex String Replace", "body": "<p>Is there a way to find a sub-string in a string then replace that sub-string and a number of characters before and after it?</p>\n\n<p>For example, I have these:</p>\n\n<pre><code>Mandatory659852 y n n TRY RACE\nMechanica888654 y n n FRY SAME\nGILLETE685254 y n n CRY FACE\n</code></pre>\n\n<p>Can I program VBA to remove the sub-string <code>\" y n n \"</code> including whatever 6 characters to the left of the sub-string and whatever 3 characters to the right of it? So the result should be:</p>\n\n<pre><code>\"Mandatory RACE\"\n\"Mechanica SAME\"\n\"GILLETE FACE\"\n</code></pre>\n\n<p>I couldn't get a search on Google as I have no clue what the term is. I know I can use .replace in VBA to replace sub-strings but I do not know how to use wild cards by number of character like <code>.replace(****** y n n ***)</code> </p>\n"}, {"tags": ["excel", "internet-explorer", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 7263469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ab453557424db40accfa21ac49d82f?s=128&d=identicon&r=PG", "display_name": "user7263469", "link": "https://stackoverflow.com/users/7263469/user7263469"}, "edited": false, "score": 0, "creation_date": 1481551203, "post_id": 41023064, "comment_id": 69409158, "body": "Here is a solution with SendKeys.  I lauch a script contained in a VBS file at the beginning of the macro. The script waits for the appearance a the popup and send the login/password in using SendKeys.  My problem, now, is that the script is still running after the end of the macro...  Does somebody have a solution to kill the script?"}, {"owner": {"reputation": 1, "user_id": 7263469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ab453557424db40accfa21ac49d82f?s=128&d=identicon&r=PG", "display_name": "user7263469", "link": "https://stackoverflow.com/users/7263469/user7263469"}, "edited": false, "score": 0, "creation_date": 1481562036, "post_id": 41023064, "comment_id": 69415743, "body": "I found: in giving a duration limitation when I call the script... Shell &quot;wscript.exe &quot;&quot;path\\file.vbs&quot;&quot; //T:20&quot; &#39;example with 20s"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7263469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ab453557424db40accfa21ac49d82f?s=128&d=identicon&r=PG", "display_name": "user7263469", "link": "https://stackoverflow.com/users/7263469/user7263469"}, "is_accepted": false, "score": 0, "last_activity_date": 1481562087, "creation_date": 1481562087, "answer_id": 41105825, "question_id": 41023064, "link": "https://stackoverflow.com/questions/41023064/control-windows-security-popup-when-accessing-a-website-via-vba-excel/41105825#41105825", "title": "Control Windows Security popup when accessing a website via VBA Excel", "body": "<p>There is a solution with SendKeys. I lauch a script contained in a VBS file at the beginning of the macro. The script waits for the appearance a the popup and send the login/password in using SendKeys.</p>\n"}], "owner": {"reputation": 1, "user_id": 7263469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ab453557424db40accfa21ac49d82f?s=128&d=identicon&r=PG", "display_name": "user7263469", "link": "https://stackoverflow.com/users/7263469/user7263469"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 824, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1481562087, "creation_date": 1481129569, "last_edit_date": 1531164843, "question_id": 41023064, "link": "https://stackoverflow.com/questions/41023064/control-windows-security-popup-when-accessing-a-website-via-vba-excel", "title": "Control Windows Security popup when accessing a website via VBA Excel", "body": "<p>Since an Excel file, I would like to connect that intranet of our company. My problem is that the login and the password are to be written in Windows Security popup.\nI don't know how to manage that without using SendKeys... Another problem linked to that is that sometimes, the popup appears again, even if the login and password are good. Do youhave an idea to the way to catch such an event?</p>\n\n<p><a href=\"https://i.stack.imgur.com/K9msW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K9msW.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1481129991, "post_id": 41022782, "comment_id": 69253447, "body": "When you are using the <code>stop</code> keyword, e.g. <code>If UserForm1(&quot;CheckBox1&quot;).Value Then Stop</code>, are you just expecting it to exit the sub routine? If so then use <code>exit sub</code> instead, <code>stop</code> is equivalent to setting a breakpoint, I know behaviour around breaking macro execution with Ctrl + Pause/Break has changed since 2010, It would be my best guess that is the culprit, although there is plenty more wrong with this code.."}, {"owner": {"reputation": 11, "user_id": 7263408, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cfqx9WEy_L4/AAAAAAAAAAI/AAAAAAAAABc/NrYDrojKEyU/photo.jpg?sz=128", "display_name": "Eric Smith", "link": "https://stackoverflow.com/users/7263408/eric-smith"}, "edited": false, "score": 0, "creation_date": 1481130972, "post_id": 41022782, "comment_id": 69254040, "body": "No, I&#39;m not expecting to exit.  If I do stop, the screen updates as it should and I press run to continue.  The display does not update if the code runs unattended."}, {"owner": {"reputation": 11, "user_id": 7263408, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cfqx9WEy_L4/AAAAAAAAAAI/AAAAAAAAABc/NrYDrojKEyU/photo.jpg?sz=128", "display_name": "Eric Smith", "link": "https://stackoverflow.com/users/7263408/eric-smith"}, "edited": false, "score": 0, "creation_date": 1481131335, "post_id": 41022782, "comment_id": 69254274, "body": "The only purpose of this code is to reproduce the issue.  What else is wrong with it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1481160808, "post_id": 41022782, "comment_id": 69268251, "body": "<code>Screenupdating=False</code> on <code>openForm</code> before <code>doStuff</code>, the 0.01 second wait is weird. How does it perform with <code>msgbox(&quot;I broke&quot;): exit sub</code> vs <code>stop</code>?"}], "owner": {"reputation": 11, "user_id": 7263408, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cfqx9WEy_L4/AAAAAAAAAAI/AAAAAAAAABc/NrYDrojKEyU/photo.jpg?sz=128", "display_name": "Eric Smith", "link": "https://stackoverflow.com/users/7263408/eric-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563958801, "creation_date": 1481128744, "last_edit_date": 1526481384, "question_id": 41022782, "link": "https://stackoverflow.com/questions/41022782/userform-and-worksheet-display-works-in-excel-2010-but-not-in-excel-2016", "title": "Userform and Worksheet display works in Excel 2010 but not in Excel 2016", "body": "<p>I'm having an issue with a userform that updates the worksheet displayed behind it.  I'm able to reproduce the problem with the linked test worksheet.  In Excel 2010 the code works as expected.  In 2016 (and I assume 2013) the worksheet display only updates if the code is stopped in the debugger.  In addition, the userform will take 20-30 seconds to give control back to the user after the code completes and it will then take 5-10 seconds to even tab from field to field on the userform.</p>\n\n<p>I would appreciate any guidance as to how to make this code work with the newer versions of Excel.</p>\n\n<h3>UserForm1</h3>\n\n<p><img src=\"https://i.stack.imgur.com/8npRy.png\" alt=\"UserForm1 Image\"></p>\n\n<h3>UserForm1 Code</h3>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Call DisplayBanner\n    Debug.Print \"End - Button 1\"\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    Call ExitForm\nEnd Sub\n</code></pre>\n\n<h3>Worksheet</h3>\n\n<p><img src=\"https://i.stack.imgur.com/96boO.png\" alt=\"Worksheet Image\"></p>\n\n<h3>Macro Code</h3>\n\n<pre><code>Private xmlDoc As Object, Flow As Object\n\nSub OpenForm()  'RUN button on Home sheet\n    Application.ScreenUpdating = False\n    UserForm1.Show vbModal\nEnd Sub\n\nSub DisplayBanner()\n    'UserForm1.Hide\n\n    Call DoBeforeStuff\n    Application.ScreenUpdating = True\n    Cells(1, 6).Value = \"Banner Text Here\"\nIf UserForm1(\"CheckBox1\").Value Then Stop\n    Application.ScreenUpdating = False\n\n    Call DoAfterStuff\n    Application.ScreenUpdating = True\n    Cells(1, 6).Value = vbNullString\nIf UserForm1(\"CheckBox1\").Value Then Stop\n    Application.ScreenUpdating = False\n\n    If Not UserForm1.Visible Then UserForm1.Show\nDebug.Print \"End - DisplayBanner\"\nEnd Sub\n\nSub ExitForm()\n    UserForm1.Hide\n    Application.EnableEvents = True\nEnd Sub\n\nSub DoBeforeStuff()\n    Set xmlDoc = CreateObject(\"MSXML2.DOMDocument\")\n    xmlDoc.async = False: xmlDoc.validateOnParse = False\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n    exFilename = Application.GetOpenFilename(\"Get XML File (*.*),*.*\", , _\n     \"Select a XML file\")\n    If Not xmlDoc.Load(exFilename) Then\n        Err.Raise xmlDoc.parseError.ErrorCode, , xmlDoc.parseError.reason\n    End If\nEnd Sub\n\nSub DoAfterStuff()\n    Set Flow = xmlDoc.DocumentElement\n    Set xParent = Flow.FirstChild\n    p = 1\n    For Each xParent In Flow.ChildNodes\n        ParentNode = xParent.nodeName\n        Sheets(\"OtherSheet\").[Table1].Cells(p, 1).Value = ParentNode\n        c = 1\n        For Each xChild In xParent.ChildNodes\n            nodeName = xChild.nodeName\n            Sheets(\"OtherSheet\").[Table1].Cells(p, c + 1).Value = nodeName\n            c = c + 1\n        Next xChild\n        p = p + 1\nDebug.Print ParentNode &amp; \" - \" &amp; p\n    Next xParent\n    Set xmlDoc = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 233, "user_id": 5818624, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Ql6J9.jpg?s=128&g=1", "display_name": "Sam Slaughterbeck", "link": "https://stackoverflow.com/users/5818624/sam-slaughterbeck"}, "edited": false, "score": 0, "creation_date": 1481133350, "post_id": 41022611, "comment_id": 69255521, "body": "This maybe a limitation in Access. I found something that may or may not work for so I won&#39;t post it as an answer. You can try use the &quot;Form_Click&quot; callback to accomplish the logic you are trying to implement. Ref: <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/e2ef0e84-8679-480b-82e2-cca06b55a11d/access-pivot-table-click-event?forum=accessdev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 5063074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4a910d27f8df951c74dba2a1e042201?s=128&d=identicon&r=PG&f=1", "display_name": "cyb3rwolf", "link": "https://stackoverflow.com/users/5063074/cyb3rwolf"}, "reply_to_user": {"reputation": 233, "user_id": 5818624, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Ql6J9.jpg?s=128&g=1", "display_name": "Sam Slaughterbeck", "link": "https://stackoverflow.com/users/5818624/sam-slaughterbeck"}, "edited": false, "score": 0, "creation_date": 1481136831, "post_id": 41022611, "comment_id": 69257537, "body": "Thanks. Yeah I had tried that... the event fires, however The value it returns for the field is always the first in the recordsource not the record i click on like I&#39;m trying to do."}], "owner": {"reputation": 13, "user_id": 5063074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4a910d27f8df951c74dba2a1e042201?s=128&d=identicon&r=PG&f=1", "display_name": "cyb3rwolf", "link": "https://stackoverflow.com/users/5063074/cyb3rwolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481128289, "creation_date": 1481128289, "question_id": 41022611, "link": "https://stackoverflow.com/questions/41022611/return-field-value-when-clicking-on-pivot-table-sub-form", "title": "return field value when clicking on pivot table sub form", "body": "<p>I have an Access 2007 form with a pivot table subform. I have an onclick event for one of the fields in the table in the subform to fire an event. Works in datasheet view, but not in pivottable view. The event doesn't fire at all in pivot table view. How do i pull this off?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1481128983, "post_id": 41022598, "comment_id": 69252790, "body": "Welcome to SO. Please review <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> and amend your question accordingly. You will receive little to no help as your question is currently written."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5486156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yfFdsKmTeik/AAAAAAAAAAI/AAAAAAAAAWM/PNsd-5fFPws/photo.jpg?sz=128", "display_name": "Magesh Waran", "link": "https://stackoverflow.com/users/5486156/magesh-waran"}, "edited": false, "score": 0, "creation_date": 1481202838, "post_id": 41023089, "comment_id": 69287987, "body": "Hi Bernd, It is a really helpful code but my problem retains, upto sheet8 I had a specific columns has to be copied. Finally those columns has to be come in last sheet with same column headers.My array(column index for those 8 sheets will look this)=&gt;My_req_col_arr(From sht1-B,J,N,R,V,Z,AD,AH,AL,AP).( sht2-B,J,M,Q,U,Y,AC). (sht3-B,J,M,Q,U,Y,AD,AI).(sht4-B,J,M,Q,U,YAC,AG,AK). (sht5-B,J,N,R,V,Z,AD,AH).(sht6-B,J,M,Q,U,Y,AC,AG,AK,AQ,AS,AW&zwnj;&#8203;).(sht7- B,J,M,Q,U,Y,AC,AG,AK,AO,AS,AW). (sht8-B,J,M,Q,U,Y,AC,AG,AL)"}, {"owner": {"reputation": 146, "user_id": 4016180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_p4hxsnAQmA/AAAAAAAAAAI/AAAAAAAAJzs/ytIsqnM3gKY/photo.jpg?sz=128", "display_name": "Bernd Stoeckel", "link": "https://stackoverflow.com/users/4016180/bernd-stoeckel"}, "reply_to_user": {"reputation": 13, "user_id": 5486156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yfFdsKmTeik/AAAAAAAAAAI/AAAAAAAAAWM/PNsd-5fFPws/photo.jpg?sz=128", "display_name": "Magesh Waran", "link": "https://stackoverflow.com/users/5486156/magesh-waran"}, "edited": false, "score": 0, "creation_date": 1481202842, "post_id": 41023089, "comment_id": 69287988, "body": "Hi Magesh, that is actually possible with a little tweaking: the above code is made as if you would need the same columns in each sheet, now that is not what you need, I see. We just need to make a  2 Dimensional array for the column numbers (I&#39;m using numbers instead of letters. for that 2 dimensional array it would be best you&#39;d use a sheet to store, then you can read this table as an array (a = range()) and if you use a line per worksheet we can pull it with  .Range(.Cells(1, a(i, o)), .Cells(lastrow, a(i, o))).Copy I hope that is somehow clear (also lastrow has to be amended in that way"}], "tags": [], "owner": {"reputation": 146, "user_id": 4016180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_p4hxsnAQmA/AAAAAAAAAAI/AAAAAAAAJzs/ytIsqnM3gKY/photo.jpg?sz=128", "display_name": "Bernd Stoeckel", "link": "https://stackoverflow.com/users/4016180/bernd-stoeckel"}, "is_accepted": true, "score": 0, "last_activity_date": 1481129629, "creation_date": 1481129629, "answer_id": 41023089, "question_id": 41022598, "link": "https://stackoverflow.com/questions/41022598/in-jagged-array-how-to-use-columns-as-array-values-from-different-sheets/41023089#41023089", "title": "In jagged array how to use columns as array values from different sheets", "body": "<p>I'm gonna try. Is it something like this? Alter the code to your need of course and set more arrays for the column indexes if you need. This will paste all of these columns on a new sheet. </p>\n\n<pre><code>Sub test()\nDim a() As Variant\nDim wb As Workbook\nDim newWS As Worksheet\nDim nextColumn As Long, lastrow As Long, i As Long, o As Long\nSet wb = ThisWorkbook\nSet newWS = wb.Worksheets.Add(After:=wb.Worksheets(wb.Worksheets.Count))\na = Array(1, 4, 6, 8, 10, 11) 'column indexes\n\nWith wb\n    nextColumn = 1\n    For i = 1 To 12\n        With .Worksheets(i)\n            For o = LBound(a) To UBound(a)\n                lastrow = .Cells(65536, a(o)).End(xlUp).Row\n                .Range(.Cells(1, a(o)), .Cells(lastrow, a(o))).Copy\n                newWS.Cells(1, nextColumn).PasteSpecial xlPasteAll\n                nextColumn = nextColumn + 1\n            Next o\n        End With\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5486156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yfFdsKmTeik/AAAAAAAAAAI/AAAAAAAAAWM/PNsd-5fFPws/photo.jpg?sz=128", "display_name": "Magesh Waran", "link": "https://stackoverflow.com/users/5486156/magesh-waran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 41023089, "answer_count": 1, "score": -2, "last_activity_date": 1481129629, "creation_date": 1481128261, "last_edit_date": 1531164843, "question_id": 41022598, "link": "https://stackoverflow.com/questions/41022598/in-jagged-array-how-to-use-columns-as-array-values-from-different-sheets", "title": "In jagged array how to use columns as array values from different sheets", "body": "<p>how to use jagged array for copy and pasting specific columns(like B,J,N,M,U,V,) from 12 xl sheets and finally it has to stored in a seperate single sheet.</p>\n\n<p>For Example:\nIn Sheet1 I need B,J,N,M has to be copied \nIn Sheet2 I need B,J,N,O,U,V,X,AO to be copied\n.\n.\n.\nUpto Sheet12 I need like this specific columns and its values till its last row has to be copied and finally 12 sheet values has to be pasted at the end of the new worksheet.Pls someone help me using vba</p>\n"}, {"tags": ["excel", "conditional-formatting", "vba"], "answers": [{"comments": [{"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "edited": false, "score": 0, "creation_date": 1481129492, "post_id": 41022497, "comment_id": 69253137, "body": "I tried to do it this way and excel corrected to to be [green]0;[red]0;[blue]0. In short it didn&#39;t work, but you did say use something like what you had above. I am not the best with the custom format, but thank you."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 1, "last_activity_date": 1481128031, "creation_date": 1481128031, "answer_id": 41022497, "question_id": 41022383, "link": "https://stackoverflow.com/questions/41022383/conditional-formatting-using-left-and-right/41022497#41022497", "title": "Conditional Formatting using Left and Right", "body": "<p>You can do this without using conditional formatting. Highlight your cells and apply custom formatting (right click > format cells > number > custom) and use something like this as your custom number string:</p>\n\n<pre><code>0[green];0[red];0[blue]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "edited": false, "score": 0, "creation_date": 1481129531, "post_id": 41022609, "comment_id": 69253163, "body": "You are right, X and Y are strings. I meant to say when the value is displayed they are integers. I used your method and it worked. Thank you."}], "tags": [], "owner": {"reputation": 146, "user_id": 4016180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_p4hxsnAQmA/AAAAAAAAAAI/AAAAAAAAJzs/ytIsqnM3gKY/photo.jpg?sz=128", "display_name": "Bernd Stoeckel", "link": "https://stackoverflow.com/users/4016180/bernd-stoeckel"}, "is_accepted": true, "score": 2, "last_activity_date": 1481128282, "creation_date": 1481128282, "answer_id": 41022609, "question_id": 41022383, "link": "https://stackoverflow.com/questions/41022383/conditional-formatting-using-left-and-right/41022609#41022609", "title": "Conditional Formatting using Left and Right", "body": "<p>no, X and Y are parts of a string, not integers, convert them though while grabbing the part of that string: (don't try with right however, you have a parenthesis there)</p>\n\n<pre><code>Int(Left()) and Int(Mid())\n</code></pre>\n"}], "owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 41022609, "answer_count": 2, "score": 0, "last_activity_date": 1481128282, "creation_date": 1481127673, "last_edit_date": 1531161705, "question_id": 41022383, "link": "https://stackoverflow.com/questions/41022383/conditional-formatting-using-left-and-right", "title": "Conditional Formatting using Left and Right", "body": "<p>I am trying to perform Conditional Formatting for a group of cells based on each cells value. In each cell I have \"X (Y)\" such that X and Y are integers. It is formed by using the Concatenate formula and grabs values from elsewhere in my workbook. I need to perform some conditional formatting that says the following:</p>\n\n<pre><code>If Y &gt; 0, then highlight green\nIf Y &lt; 0, then highlight red\nIf Y = 0, then highlight blue (or no highlight)\n</code></pre>\n\n<p>I solved the negative issue by just checking to see if a cell contained a \"-\", but the other two I am stuck on. I have tried using the search function to search for \"(0)\", but the formula only applies to the first cell I have. I have tried using Left and Right to check for the greater than 0 part, but excel doesn't like it. </p>\n\n<p>I think the issue might be because of relative/absolute cells, but I do not know.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1481131695, "post_id": 41022377, "comment_id": 69254489, "body": "Are the conditions <b><i>AND</i></b> conditions or <b><i>OR</i></b> conditions ???"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1481131846, "post_id": 41022377, "comment_id": 69254576, "body": "Do you want the cell highlighted if it contains <b><i>no</i></b> characters ???"}, {"owner": {"reputation": 43, "user_id": 7263233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7537d7dee3b3baabc5bda858d3344a3?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/7263233/mahesh"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1481159181, "post_id": 41022377, "comment_id": 69267829, "body": "Condition is OR only. Blank cells with no characters need not be highlighted."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7263233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7537d7dee3b3baabc5bda858d3344a3?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/7263233/mahesh"}, "edited": false, "score": 0, "creation_date": 1481169626, "post_id": 41030640, "comment_id": 69270503, "body": "Thanks Gary. it works brilliant..!! Can you include other rows in it too. I mean G,H,I,J...BX,BY,BZ.It works only in G row as of now."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 43, "user_id": 7263233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7537d7dee3b3baabc5bda858d3344a3?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/7263233/mahesh"}, "edited": false, "score": 0, "creation_date": 1481169716, "post_id": 41030640, "comment_id": 69270528, "body": "@Mahesh  I would need a complete list of the"}, {"owner": {"reputation": 43, "user_id": 7263233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7537d7dee3b3baabc5bda858d3344a3?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/7263233/mahesh"}, "edited": false, "score": 0, "creation_date": 1481170402, "post_id": 41030640, "comment_id": 69270699, "body": "Hi Gary, I can&#39;t see your comment completely."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1481163001, "creation_date": 1481163001, "answer_id": 41030640, "question_id": 41022377, "link": "https://stackoverflow.com/questions/41022377/how-to-highlight-cells-with-decimals-or-characters-less-than-3-and-more-than-6-u/41030640#41030640", "title": "How to highlight cells with decimals or characters less than 3 and more than 6 using vba?", "body": "<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/p66rE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p66rE.png\" alt=\"enter image description here\"></a></p>\n\n<p>This code is almost a direct translation of your description in English into VBA:</p>\n\n<pre><code>Sub Dural()\n    Dim N As Long, i As Long, s As String, L As Long\n\n    N = Cells(Rows.Count, \"G\").End(xlUp).Row\n    For i = 1 To N\n        s = Cells(i, \"G\").Text\n        L = Len(s)\n        If InStr(1, s, \".\") &gt; 0 Or (L &lt; 3 Or L &gt; 6) Then\n            With Cells(i, \"G\").Interior\n              .Pattern = xlSolid\n              .PatternColorIndex = xlAutomatic\n              .Color = 65535\n              .TintAndShade = 0\n              .PatternTintAndShade = 0\n            End With\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>and after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/q2V78.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q2V78.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 7263233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7537d7dee3b3baabc5bda858d3344a3?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/7263233/mahesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1481211085, "creation_date": 1481211085, "answer_id": 41043067, "question_id": 41022377, "link": "https://stackoverflow.com/questions/41022377/how-to-highlight-cells-with-decimals-or-characters-less-than-3-and-more-than-6-u/41043067#41043067", "title": "How to highlight cells with decimals or characters less than 3 and more than 6 using vba?", "body": "<pre><code>Sub Test()\n    Application.ScreenUpdating = False\n    LastRow = Rows(ActiveSheet.UsedRange.Row + _\n    ActiveSheet.UsedRange.Rows.Count - 1).Row\n    LastCol = Columns(ActiveSheet.UsedRange.Column + _\n    ActiveSheet.UsedRange.Columns.Count - 1).Column\n    For Each cll In Range(Cells(1, 7), Cells(LastRow, LastCol))\n    s = cll.Value\n    l = Len(s)\n    If ((l &gt; 0) And (l &lt; 3)) Or (l &gt; 6) Or (s Like \"*#.#*\") _\n        Then cll.Interior.Color = vbRed\n    Next cll\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 43, "user_id": 7263233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7537d7dee3b3baabc5bda858d3344a3?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/7263233/mahesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1481211085, "creation_date": 1481127661, "last_edit_date": 1531161705, "question_id": 41022377, "link": "https://stackoverflow.com/questions/41022377/how-to-highlight-cells-with-decimals-or-characters-less-than-3-and-more-than-6-u", "title": "How to highlight cells with decimals or characters less than 3 and more than 6 using vba?", "body": "<p>I'm new to VBA coding and please help me create a VBA script with the following conditions.</p>\n\n<ol>\n<li>Should highlight cells containing decimals.</li>\n<li>Should highlight cells with number of characters less than 3 or more than 6.</li>\n<li>Should execute from Column G (G1) till the last row last used cell.</li>\n</ol>\n\n<p>My data is alphanumeric or numeric.</p>\n\n<p>I have tried using <code>characters.count</code> and <code>Value.count</code> but it didn't work out. Hope it will work with <code>len</code>, but I'm not sure how to start with.</p>\n\n<p>Attached is the sample excel file with highlighted cells</p>\n\n<p>I have tried the below code.  Since my data is alphanumeric, characters count doesn't help.</p>\n\n<pre><code>Sub HighlightCells()\nRange(\" G1\").Select\nDo\n  If ActiveCell.Characters.Count &lt; 3 Then\n    With Selection.Interior\n      .Pattern = xlSolid\n      .PatternColorIndex = xlAutomatic\n      .Color = 65535\n      .TintAndShade = 0\n      .PatternTintAndShade = 0\n    End With\n  End If\n  ActiveCell.Offset(0, 1).Select 'need to run in every row till the last row     last used cell\nLoop Until ActiveCell = \"\"\n\nRange(\" G1\").Select\nDo\n  If ActiveCell.Characters.Count &gt; 6 Then\n    With Selection.Interior\n      .Pattern = xlSolid\n      .PatternColorIndex = xlAutomatic\n      .Color = 65535\n      .TintAndShade = 0\n      .PatternTintAndShade = 0\n    End With\n  End If\n  ActiveCell.Offset(0, 1).Select 'need to run in every row till the last row   last used cell\nLoop Until ActiveCell = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error", "rename", "worksheet"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1481127849, "post_id": 41022319, "comment_id": 69251993, "body": "You should <code>Set wks = wbk.Sheets.Add</code>, <i>and then</i> set its <code>.Name</code>. That way you wouldn&#39;t need to have the string literal spelled out twice."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1481127912, "post_id": 41022319, "comment_id": 69252034, "body": "You could try a <code>DoEvents</code> call or two. If you can, though, it would probably be safer to use an <code>Application.Ontime</code> call to run the code to change the codename (and anything else that happens)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481127965, "post_id": 41022319, "comment_id": 69252073, "body": "Just to clarify, is the runtime error 9 raised on the <code>wks.Parent.VBProject.VBComponents(wks.CodeName)</code> access?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1481128376, "post_id": 41022319, "comment_id": 69252331, "body": "You&#39;re adding and renaming VBComponents in the VBProject that&#39;s currently executing. You&#39;re lucky the entire IDE &amp; host app doesn&#39;t completely crash already - I suspect the VBE needs to have been loaded specifically so that something behind the scenes involving either the P-Code compiler or the VBA interpreter is having a chance to pick up the new component; if the VBE hasn&#39;t loaded, you&#39;re executing compiled code where <code>wks.CodeName</code> doesn&#39;t exist as a component. Tricky stuff. Interesting question."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1481128683, "post_id": 41022319, "comment_id": 69252577, "body": "As much as I still want to know the answer to this particular issue - is there a reason you can&#39;t just have the sheet already in the workbook with the correct code name but set the visibility to <code>xlVeryHidden</code> when it&#39;s not required?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481128838, "post_id": 41022319, "comment_id": 69252696, "body": "My suspicion (fwiw) is that the <code>VBComponents</code> collection is initialized at the start of run-time, but that opening the IDE triggers a refresh (presumably triggered in a separate thread but still accessing the same instance of that collection) because it has to display all available components at that time. Before opening the IDE that particular index doesn&#39;t exist because it wasn&#39;t there at the start of run-time. No idea how you would test that though - * glares at @Mat&#39;sMug *"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1481128969, "post_id": 41022319, "comment_id": 69252777, "body": "@MacroMan you know me, my solution would be to do code changes at design-time with my <a href=\"https://github.com/rubberduck-vba/Rubberduck/releases\" rel=\"nofollow noreferrer\">Rubberduck</a>&#39;s <i>refactor/rename</i> feature. That way if the <code>MyAwesomeNewSheet</code> code name is referred to in the code, I&#39;m not breaking anything."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1481129034, "post_id": 41022319, "comment_id": 69252829, "body": "<b>or</b> opening the IDE causes the execution to return control to the application - which updates the collection. But then I&#39;m sure using <code>DoEvents</code> (as rory suggested) would accomplish the same thing...."}, {"owner": {"reputation": 93, "user_id": 7263215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e24a6f0fb34cdb4e55a06fe16f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Fu113R", "link": "https://stackoverflow.com/users/7263215/fu113r"}, "edited": false, "score": 0, "creation_date": 1481190365, "post_id": 41022319, "comment_id": 69279855, "body": "The whole point is that I want to be able to easily add a change log to different workbooks, so rather than creating the sheets (or move/copy sheets from a different workbook), I want the user to be able to add the sheets then add the necessary code to the sheets at a press of a button. There are a large number of workbooks that this could potentially be added to so want to make it as automated as possible."}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1481130453, "post_id": 41023265, "comment_id": 69253709, "body": "Is simply referencing <code>wbk.VBProject.VBE.MainWindow.Caption</code> enough or would it have to be explicitly used with the Debug object? (I know <code>Debug.Print</code> is better for &quot;throw away&quot; code - just curious)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1481130927, "post_id": 41023265, "comment_id": 69254020, "body": "@MacroMan - Not <i>entirely</i> sure.  I did test just a <code>Debug.Print</code> and that didn&#39;t do anything.  Printing the <code>Caption</code> was the first thing that I thought of that would get a property request all the way through to the <code>MainWindow</code>.  Setting a object reference also appears to work.  I&#39;ll update the answer."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 4, "last_activity_date": 1481131016, "last_edit_date": 1481131016, "creation_date": 1481130201, "answer_id": 41023265, "question_id": 41022319, "link": "https://stackoverflow.com/questions/41022319/changing-sheet-codename-run-time-error-9-subscript-out-of-range/41023265#41023265", "title": "Changing sheet codename Run-Time Error 9: Subscript out of range", "body": "<p>If you need the VBE to have been opened, you can \"trick\" the debugging context into doing it for you.  This seems to do whatever the project needs to update its indexing by forcing the <code>VBE.MainWindow</code> into existence:</p>\n\n<pre><code>Dim wbk As Workbook\nDim wks As Worksheet\n\nSet wbk = ThisWorkbook\n\nSet wks = wbk.Sheets.Add\nwks.Name = \"Admin - Save Log\"\nDebug.Print wbk.VBProject.VBE.MainWindow.Caption   '&lt;--Force the VBE to exist.\nwbk.VBProject.VBComponents(wks.CodeName).Name = \"wksAdminSaveLog\"\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>It seems that simply obtaining the reference to the <code>VBE.MainWindow</code> is enough (see the comments).  This also works:</p>\n\n<pre><code>Dim editor As Object\nSet editor = wbk.VBProject.VBE.MainWindow   '&lt;--Force the VBE to exist.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481140155, "post_id": 41026063, "comment_id": 69259354, "body": "I don&#39;t think it&#39;s odd at all: you&#39;re &quot;creating&quot; the VBE <i>after</i> all VBComponents exist in the project."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481140348, "post_id": 41026063, "comment_id": 69259457, "body": "@Mat&#39;sMug - Actually this doesn&#39;t de-reference the VBE at all.  I wonder if I was swinging for the fences and could have just stopped at dereferencing <code>wbk.Project</code>. @ThunderFrame - Do you have to use the hidden <code>_CodeName</code> after you&#39;ve dereferenced the project? Good call on the <code>.Assert</code>, BTW."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481140508, "post_id": 41026063, "comment_id": 69259552, "body": "@Comintern eh, I meant &quot;VBE&quot; as in &quot;the debug environment&quot;, or whatever it is that makes the VBA runtime understand what&#39;s going on. Good call on <code>[_CodeName]</code>, IIRC not using that hidden property was a bug with Rubberduck&#39;s <i>refactor/rename</i> functionality when renaming worksheets at one point."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1481142365, "post_id": 41026063, "comment_id": 69260732, "body": "I didn&#39;t try the vanilla <code>CodeName</code> <i>because</i> I knew about what Rubberduck does. And before I realised the placement of <code>vbProject</code> was important, I <i>thought</i> I&#39;d found a bug in using `[_CodeName] inside a with block."}, {"owner": {"reputation": 93, "user_id": 7263215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e24a6f0fb34cdb4e55a06fe16f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Fu113R", "link": "https://stackoverflow.com/users/7263215/fu113r"}, "edited": false, "score": 0, "creation_date": 1481192223, "post_id": 41026063, "comment_id": 69281167, "body": "@ThunderFrame When I try this method it comes up with the following error on the Debug.Assert bit . . . . . Run-time error &#39;1004: Programmatic access to Visual Basic Project is not trusted . . . . any ideas on how I can get around this?"}, {"owner": {"reputation": 93, "user_id": 7263215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e24a6f0fb34cdb4e55a06fe16f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Fu113R", "link": "https://stackoverflow.com/users/7263215/fu113r"}, "edited": false, "score": 0, "creation_date": 1481208395, "post_id": 41026063, "comment_id": 69291674, "body": "I had to go to file&gt;options&gt;trust centre&gt;trust centre settings&gt;macros and then tick the box at the bottom &quot;Trust access to the VBA project object model&quot; - once I&#39;ve done this, the code you suggested worked a treat! Thankyou very much! :)"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 6, "last_activity_date": 1481139989, "creation_date": 1481139989, "answer_id": 41026063, "question_id": 41022319, "link": "https://stackoverflow.com/questions/41022319/changing-sheet-codename-run-time-error-9-subscript-out-of-range/41026063#41026063", "title": "Changing sheet codename Run-Time Error 9: Subscript out of range", "body": "<p>@Comintern already got you a working solution, but this code doesn't pollute your Immediate Window, and uses the hidden <code>_CodeName</code> property to change the sheet name instead of accessing the <code>vbComponents</code> collection.</p>\n\n<p>It also uses an early-bound <code>Worksheet</code> assignment to <code>wks</code>, and then a <code>With</code> block because it is accessing more than 1 member of <code>wks</code>.</p>\n\n<p>Interestingly, the <em>placement</em> of the VBProject member usage is important.</p>\n\n<pre><code>Dim wbk As Workbook\nDim wks As Worksheet\n\nSet wbk = ThisWorkbook\nSet wks = wbk.Worksheets.Add\n\n'Oddly, this statement MUST appear AFTER the Worksheets.add\nDebug.Assert wbk.VBProject.Name &lt;&gt; vbNullString 'Don't pollute the Immediate window\n\nWith wks\n  .Name = \"Admin - Save Log\"\n  .[_CodeName] = \"wksAdminSaveLog\"\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 450, "user_id": 2981328, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55b5a57989320394ee6a2acaf766c01f?s=128&d=identicon&r=PG&f=1", "display_name": "hymced", "link": "https://stackoverflow.com/users/2981328/hymced"}, "is_accepted": false, "score": 0, "last_activity_date": 1504562197, "creation_date": 1504562197, "answer_id": 46044458, "question_id": 41022319, "link": "https://stackoverflow.com/questions/41022319/changing-sheet-codename-run-time-error-9-subscript-out-of-range/46044458#46044458", "title": "Changing sheet codename Run-Time Error 9: Subscript out of range", "body": "<p>Another simple method to force refreshing of the VBComponents Collection:</p>\n\n<pre><code>PropertyGetDiscard ThisWorkbook.VBProject.VBComponents.Count\n</code></pre>\n\n<p>\u00a0</p>\n\n<pre><code>Private Sub PropertyGetDiscard(AnyPropertyGet): End Sub\n</code></pre>\n\n<p>The procedure <code>PropertyGetDiscard</code> is used to avoid polluting the Immediate window or using a superfluous variable</p>\n"}, {"tags": [], "owner": {"reputation": 3207, "user_id": 1915920, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6be77f4bfa373c33055ada8f3414ae09?s=128&d=identicon&r=PG", "display_name": "Andreas Covidiot", "link": "https://stackoverflow.com/users/1915920/andreas-covidiot"}, "is_accepted": false, "score": 0, "last_activity_date": 1573033099, "creation_date": 1573033099, "answer_id": 58727046, "question_id": 41022319, "link": "https://stackoverflow.com/questions/41022319/changing-sheet-codename-run-time-error-9-subscript-out-of-range/58727046#58727046", "title": "Changing sheet codename Run-Time Error 9: Subscript out of range", "body": "<p>A general approach to solve such <em>VBComponent</em>-dependent code problems is to use the <strong><a href=\"https://stackoverflow.com/a/58726959/1915920\"><code>VbeInit</code> procedure given here</a></strong> that is flexible to be called multiple times for each newly opened workbook that may not yet be \"<em>VBComponent</em>-initialized\".</p>\n"}], "owner": {"reputation": 93, "user_id": 7263215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e24a6f0fb34cdb4e55a06fe16f6774?s=128&d=identicon&r=PG&f=1", "display_name": "Fu113R", "link": "https://stackoverflow.com/users/7263215/fu113r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1480, "favorite_count": 1, "accepted_answer_id": 41026063, "answer_count": 4, "score": 9, "last_activity_date": 1576254154, "creation_date": 1481127469, "last_edit_date": 1576254154, "question_id": 41022319, "link": "https://stackoverflow.com/questions/41022319/changing-sheet-codename-run-time-error-9-subscript-out-of-range", "title": "Changing sheet codename Run-Time Error 9: Subscript out of range", "body": "<p>I've code which, when I press a button, will add a new sheet to a workbook and change the codename of the sheet to make it easier to refer to later in my code.</p>\n\n<pre><code>Dim wbk As Workbook\nDim wks As Worksheet\n\nSet wbk = ThisWorkbook\n\nwbk.Sheets.Add.Name = \"Admin - Save Log\"\nSet wks = wbk.Worksheets(\"Admin - Save Log\")\nwks.Parent.VBProject.VBComponents(wks.CodeName).Name = \"wksAdminSaveLog\"\n</code></pre>\n\n<p>This does work - HOWEVER - only when I have the \"Developer\" window open or have previously had it open.</p>\n\n<p>If I click the button when I first open the Excel document (having not opened the \"Developer\" window) it adds the sheet, however it comes up with the following error and does not change the codename of the sheet:</p>\n\n<blockquote>\n  <p>Run-time error '9': Subscript out of range</p>\n</blockquote>\n\n<p>It is only when I press Debug and then run the code after the \"Developer\" window is open again that it adds the codename.</p>\n\n<p>Is there any way around this so that the user does not have to have the developer window open in order for it to run correctly?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "edited": false, "score": 2, "creation_date": 1481126635, "post_id": 41021979, "comment_id": 69251185, "body": "It looks as though you are iterating over the string. You may find it easier to <code>Replace(Replace(string, &quot;.&quot;, &quot;&quot;), &quot;-&quot;, &quot;&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "reply_to_user": {"reputation": 13, "user_id": 7263150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81677304b241958cc2f3bd93b46e3d5?s=128&d=identicon&r=PG&f=1", "display_name": "Cojonni", "link": "https://stackoverflow.com/users/7263150/cojonni"}, "edited": false, "score": 0, "creation_date": 1481299634, "post_id": 41022102, "comment_id": 69335845, "body": "@Cojonni So maybe you have done <code>Application.EnableEvents = False</code> or something."}], "tags": [], "owner": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "is_accepted": true, "score": 2, "last_activity_date": 1481126860, "creation_date": 1481126860, "answer_id": 41022102, "question_id": 41021979, "link": "https://stackoverflow.com/questions/41021979/excel-vba-how-to-alter-the-value-of-multiple-cells-inputted-by-the-user/41022102#41022102", "title": "Excel VBA - How to alter the value of multiple cells inputted by the user?", "body": "<p>Only the first cell in the range is being changed by your code because you are not iterating over the range. You could instead do this:</p>\n\n<pre><code>For each c in Target\n    if c.column = 3 then \n         c.value = Replace(Replace(c.value, \".\", \"\"), \"-\", \"\")\n    end if\nNext c\n</code></pre>\n\n<p>inside your Worksheet_Change.</p>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1481127921, "creation_date": 1481127921, "answer_id": 41022468, "question_id": 41021979, "link": "https://stackoverflow.com/questions/41021979/excel-vba-how-to-alter-the-value-of-multiple-cells-inputted-by-the-user/41022468#41022468", "title": "Excel VBA - How to alter the value of multiple cells inputted by the user?", "body": "<p>You can replace directly on the entire desired range. You'll also need to Disable Events from firing since the changes you make will again fire the code. Also, since it's sheet level code, no need to refer to the sheet.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rCheck as Range\n    Set rCheck = Application.Intersect(Target, Me.Range(\"C:C\"))\n\n    If Not rCheck is Nothing\n\n        Application.EnableEvents = False\n        rCheck.Replace(\".\",\"\",lookat:=xlPart)\n        rCheck.Replace(\"-\",\"\",lookat:=xlPart)\n        Application.EnableEvents = True\n\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>I will also warn that if the data set being checked is very large, this replace method can have poor performance. However, if copy / paste is relatively small in terms of cell counts, it should be fine.</p>\n"}], "owner": {"reputation": 13, "user_id": 7263150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81677304b241958cc2f3bd93b46e3d5?s=128&d=identicon&r=PG&f=1", "display_name": "Cojonni", "link": "https://stackoverflow.com/users/7263150/cojonni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 41022102, "answer_count": 2, "score": 1, "last_activity_date": 1481127921, "creation_date": 1481126469, "question_id": 41021979, "link": "https://stackoverflow.com/questions/41021979/excel-vba-how-to-alter-the-value-of-multiple-cells-inputted-by-the-user", "title": "Excel VBA - How to alter the value of multiple cells inputted by the user?", "body": "<p>I have a worksheet on Excel in which the user must input some registration numbers in column C. These numbers are usually inserted by the user by copying a pasting several of them at a time. The format of the copy source is often in the format \"000.000.000-00\", but I want it to be just \"00000000000\" in the worksheet, without the dots and dash. </p>\n\n<p>I am trying to develop a code in Excel VBA to automatically remove these dots and dash after the user types or paste the registration number. I need it to be in the same cell. The code is: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim SkipEvents As Boolean\n    If SkipEvents Then Exit Sub\n    With ActiveWorkbook.Sheets(\"Staff\")\n    If Not Application.Intersect(Target, Me.Range(\"C:C\")) Is Nothing Then\n        SkipEvents = True\n        li = Intersect(Target, Range(\"C:C\")).Row\n        nl = Intersect(Target, Range(\"C:C\")).Rows.Count\n        lf = li + nl - 1\n\n        For i = li To lf\n            RegNumb = Range(\"C\" &amp; i).Value\n            If Len(RegNumb) = 14 Then\n                Range(\"C\" &amp; i).Value = Left(RegNumb, 3) &amp; Mid(RegNumb, 5, 3) &amp; Mid(RegNumb, 9, 3) &amp; Right(RegNumb, 2)\n            End If\n        Next i\n        SkipEvents = False\n    End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>So far, the code is able to remove the dots and dash if the user types or copy+paste one registration number at a time. However, when the user copy+paste 2 or more registraton numbers at a time, only the first cell from the range have its dots and dash removed, and the others stay as they are. Can someone help me with this problem?</p>\n"}, {"tags": ["excel", "csv", "utf-8", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481126205, "post_id": 41021654, "comment_id": 69250879, "body": "Is 65001 the correct code page? Is the only problem with <a href=\"http://stackoverflow.com/questions/32416841/import-text-with-foreign-characters/32417169#32417169\">Import text with foreign characters</a> the length of the code? Did you try the answer that suggests inserting a UTF8 BOM from <a href=\"http://stackoverflow.com/a/11399444/4088852\">this answer</a> to your first link?  I see a bunch of proposed solutions, and it looks like you tried one of them."}, {"owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481126865, "post_id": 41021654, "comment_id": 69251327, "body": "I didn&#39;t find Excel VBA example for this BOM. As I understand it is for csv file creation in other programing languages. In my case one csv file I create from xml with C# and I do encoding things correctly and got csv file with correct all utf-8 symbols. I can attach some additional information in my C# program to this csv file, but problem is that I need operate in Excel VBA with some csv files which are downloaded from other systems."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481127313, "post_id": 41021654, "comment_id": 69251642, "body": "That goes back to the question of whether you know the correct code page.  If you do, you can either open the csv file as a binary and insert a BOM if there isn&#39;t on there or specify it with <code>Origin:=CorrectCodePage</code>.  If you <i>don&#39;t</i> know the code page, Excel&#39;s guess is as good as anyone&#39;s."}, {"owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481128684, "post_id": 41021654, "comment_id": 69252579, "body": "It is more complicated than solution - Import text with foreign characters -which I implemented  and it works."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481128997, "post_id": 41021654, "comment_id": 69252798, "body": "I&#39;m not sure how you think &quot;text with foreign characters&quot; gets stored in a .csv file, but the only complicated part is figuring out the code page if you don&#39;t know it. I&#39;d trust Excel&#39;s best guess over anything that anyone is going to come up with in VBA. So is the question &quot;How do I detect the code page of a random .csv file&quot; or &quot;How do I open a .csv file in a known code page&quot;?"}, {"owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481129660, "post_id": 41021654, "comment_id": 69253231, "body": "One file I created in C# and use this code:                                                 StreamWriter sw = new streamWriter(@&quot;D:\\FileFolder\\FileName.csv&quot;,false,Encoding.UT&zwnj;&#8203;F8); as I understand BOM must be written into created file."}], "owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1290, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481125880, "creation_date": 1481125493, "last_edit_date": 1531164843, "question_id": 41021654, "link": "https://stackoverflow.com/questions/41021654/why-does-this-code-for-open-a-csv-file-with-utf-8-encoding-not-work", "title": "Why does this code for open a CSV file with UTF-8 encoding not work?", "body": "<p>I need to open a CSV file with UTF-8 encoding through Excel VBA. I found for this purpose code snippet in the - <a href=\"https://stackoverflow.com/questions/6002256/is-it-possible-to-force-excel-recognize-utf-8-csv-files-automatically\">Is it possible to force Excel recognize UTF-8 CSV files automatically?</a>. This code snippet did not work for me. Many non-ASCII symbols become unreadable. </p>\n\n<p>I also found other solution  -<a href=\"https://stackoverflow.com/questions/32416841/import-text-with-foreign-characters/32417169#32417169\">Import text with foreign characters</a>, which solved this problem, but that code is much longer. Maybe someone knows why the code below doesn\u2019t work?</p>\n\n<pre><code>Workbooks.OpenText Filename:=filetoopen, Origin:=65001, DataType:=xlDelimited, Comma:=True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "edited": false, "score": 5, "creation_date": 1481125369, "post_id": 41021545, "comment_id": 69250273, "body": "Can you post some sample code for one of the command buttons please?"}, {"owner": {"reputation": 636, "user_id": 7174786, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d37a1bf625f18df544b7c67d24585d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Scarlatti", "link": "https://stackoverflow.com/users/7174786/alessandro-scarlatti"}, "edited": false, "score": 0, "creation_date": 1481128830, "post_id": 41021545, "comment_id": 69252689, "body": "See <a href=\"http://stackoverflow.com/questions/6242605/excel-vba-getting-row-of-clicked-button\" title=\"excel vba getting row of clicked button\">stackoverflow.com/questions/6242605/&hellip;</a>."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1481128831, "post_id": 41021545, "comment_id": 69252691, "body": "Post your sheet screenshot with command buttons and also post codes."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1481142665, "post_id": 41021545, "comment_id": 69260908, "body": "Here&#39;s a tip: Don&#39;t use commandbuttons for this. Just color a cell to look like a button and hook the <code>Selection Changed</code> event. You can also hook the double click event so that people don&#39;t accidentally send emails when clicking the &quot;send&quot; cell or introduce a simple confirm dialog."}], "answers": [{"tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 1, "last_activity_date": 1481144227, "last_edit_date": 1481144227, "creation_date": 1481142994, "answer_id": 41026906, "question_id": 41021545, "link": "https://stackoverflow.com/questions/41021545/separating-command-buttons-and-vba-code-in-excel/41026906#41026906", "title": "Separating Command Buttons and VBA code in Excel", "body": "<p>I said in a comment, it's probably easier to simply color cells to look like buttons and have the users click on a cell to send the emails - then you can simply use the offset for the particular row, but if you insist on using command buttons, it's quite simple.</p>\n\n<p>Take your current code and put it in a new subroutine that accepts a range parameter.</p>\n\n<p>Then, add your buttons, and link each one to its own code with a different range.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton3_Click()\nSendEmail Range(\"A3\")\nEnd Sub\n\nPrivate Sub CommandButton4_Click()\nSendEmail Range(\"A4\")\nEnd Sub    \n\nPrivate Sub CommandButton5_Click()\nSendEmail Range(\"A5\")\nEnd Sub\n\n`...\n\nSub SendEmail(TheRange as Range)\n    On Error GoTo ErrHandler\n    ' SET Outlook APPLICATION OBJECT.\n    Dim objOutlook As Object\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    ' CREATE EMAIL OBJECT.\n    Dim objEmail As Object\n    Set objEmail = objOutlook.CreateItem(olMailItem)\n    With objEmail\n        .to = \"[email address].com\"\n        .Subject = TheRange 'Change this line\n        .Body = \"[Message]\"\n        .Send        ' SEND THE MESSAGE.\n    End With\n    ' CLEAR.\n    Set objEmail = Nothing:    Set objOutlook = Nothing\nErrHandler:\nEnd Sub\n</code></pre>\n\n<p>If you prefer instead to use the <code>SelectionChanged</code> event, you can do it like this.</p>\n\n<p>Then, you can just update <code>[C4:C8]</code> if you want to add any more \"buttons\"</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.CountLarge &gt; 1 Then Exit Sub\nIf Not Intersect(Target, [C4:C8]) Is Nothing Then\n    SendEmail Range(\"A\" &amp; Target.Row)\n    'Optionally select the subject we sent so we can re-click\n    'You can choose any other cell not in our event range\n    Range(\"A\" &amp; Target.Row).Select\nEnd If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QRaCf.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QRaCf.gif\" alt=\"Email Sending\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 7263128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7feae64dce6acfe8e76f1c18964fb6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Sue R", "link": "https://stackoverflow.com/users/7263128/sue-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1481144227, "creation_date": 1481125203, "last_edit_date": 1481139646, "question_id": 41021545, "link": "https://stackoverflow.com/questions/41021545/separating-command-buttons-and-vba-code-in-excel", "title": "Separating Command Buttons and VBA code in Excel", "body": "<p>I have an Excel worksheet with over 100 rows of data.  When the user completes filling in the information in their row, there is a command button at the end of the row that automatically sends an email to a specific email account with information from the row.  </p>\n\n<p>I've inserted several command buttons with the VB code to send the email and it works great!.  The problem I'm having is that I can't separate the command buttons, i.e., each button's code should be specific to the row it is on; when I change the code with the cell location that contains the information for that command button, it changes all of the command buttons to that information.  </p>\n\n<p>I know the answer must be really simple, but I've drawn a complete blank.I appreciate any help!</p>\n\n<p>Here is the code I have:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton2_Click()\n\nOn Error GoTo ErrHandler\n\n    ' SET Outlook APPLICATION OBJECT.\n    Dim objOutlook As Object\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n\n    ' CREATE EMAIL OBJECT.\n    Dim objEmail As Object\n    Set objEmail = objOutlook.CreateItem(olMailItem)\n\n    With objEmail\n        .to = \"[email address].com\"\n        .Subject = Range(\"A3\")\n        .Body = \"[Message]\"\n        .Send        ' SEND THE MESSAGE.\n    End With\n\n    ' CLEAR.\n    Set objEmail = Nothing:    Set objOutlook = Nothing\n\nErrHandler:\n    '\nEnd Sub\n</code></pre>\n\n<p>Each row should have this same command with only the CommandButton number changing and the .Subject = Range  entry changing.</p>\n\n<p>I'm doing something wrong though because that doesn't work.</p>\n"}, {"tags": ["vba", "shell", "ms-access"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481125377, "post_id": 41021180, "comment_id": 69250278, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1860563/redirecting-input-to-an-executable-from-excel-vba\">Redirecting input to an executable from Excel VBA</a>"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481149969, "post_id": 41021180, "comment_id": 69264613, "body": "tried a couple of ways but still can&#39;t get it to execute the prompt."}], "owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593957061, "creation_date": 1481124119, "last_edit_date": 1593957061, "question_id": 41021180, "link": "https://stackoverflow.com/questions/41021180/programmatically-execute-bat-file-in-access-2016", "title": "Programmatically execute .bat file in Access 2016", "body": "<p>I would like to execute a bat file from Access 2016. \nThis code opens the bat file: <code>Shell \"cmd /c \"\"Desktop\\mtwo3.bat\"\", vbHide\"</code>\nHowever, the bat file requires for the user the press any key on a keyboard. Is there a way to accomplish this programmatically?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 1, "creation_date": 1481124023, "post_id": 41021136, "comment_id": 69249265, "body": "That got it.  One additional ? - how can I keep the cell text what it is currently and not change it to the value of Cells(i,2)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481124349, "post_id": 41021136, "comment_id": 69249527, "body": "Add additional argument -  TextToDisplay:=&quot;something&quot;. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822490.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff822490.aspx</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1481123928, "creation_date": 1481123928, "answer_id": 41021136, "question_id": 41021009, "link": "https://stackoverflow.com/questions/41021009/use-cell-value-contains-periods-apastrophe-in-hyperlink-address/41021136#41021136", "title": "Use Cell Value (Contains periods &amp; Apastrophe) In Hyperlink Address", "body": "<p>Shooting without trying it:\nChange it to this:</p>\n\n<pre><code>  ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:=Cells(i, 2).Value &amp; \"!A1\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481124565, "post_id": 41021301, "comment_id": 69249682, "body": "This puts the hyperlink in column B - I want the hyperlink to be in column O, but have the Address be the name in column B."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481125232, "post_id": 41021301, "comment_id": 69250167, "body": "Updated - should do what you want now"}, {"owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481125421, "post_id": 41021301, "comment_id": 69250318, "body": "I get an error of invalid procedure call or argument.  On the ActiveSheet... line"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481125726, "post_id": 41021301, "comment_id": 69250508, "body": "@SmallFriesBigGuys I thought you wanted to keep the text in column o but you obviously don&#39;t have text there.. I&#39;ve updated again"}, {"owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481125864, "post_id": 41021301, "comment_id": 69250607, "body": "if I click the newly created hyperlink I get an error of reference is not valid.  If I hover over the hyperlink, it shows the correct naming convention Workbookname.xlsx - Worksheetname!A1 - Click once to follow - Click and hold to select cell."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481126278, "post_id": 41021301, "comment_id": 69250930, "body": "I assume you won&#39;t actually have these sheets created? I&#39;ve included a line to create these above"}, {"owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481126377, "post_id": 41021301, "comment_id": 69251007, "body": "No the sheets already exist.  That&#39;s why I was confused that it was saying invalid reference.  And if I compare the worksheet name to the value in the cell in column B they are an exact match."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481126544, "post_id": 41021301, "comment_id": 69251118, "body": "The name must be different (that&#39;s the only thing it could be) because I&#39;ve checked and it&#39;s fine for me - Maybe different case or spaces before or after the sheet names in column B (or the sheet names themselves)"}, {"owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481127100, "post_id": 41021301, "comment_id": 69251487, "body": "It appears the hyperlink is not properly being created.  For example, if I right click the cell and say Edit Hyperlink, the tab &#39;Place in this Document&#39; is selected, but a worksheet name is not selected.  If I manually add the worksheet name, the hyperlink then becomes clicakble."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481127581, "post_id": 41021301, "comment_id": 69251809, "body": "@SmallFriesBigGuys That&#39;s what <code>SubAddress:=ws.Cells(i, 2).Value &amp; &quot;!A1&quot;</code> does.. it works fine for me"}, {"owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481127795, "post_id": 41021301, "comment_id": 69251960, "body": "I see what the diff is, if I have no text in column O it works.  My workbook has a numeric value in column O that I want to keep, just make it link to the worksheet name contained in column B"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481128008, "post_id": 41021301, "comment_id": 69252097, "body": "Ok.. one last time!"}, {"owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481128113, "post_id": 41021301, "comment_id": 69252165, "body": "Also, it will give me the invalid reference error if the value in column B contains a &quot;.&quot;, a &quot;,&quot; a single quote &quot; &#39; &quot;"}, {"owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "edited": false, "score": 0, "creation_date": 1481128269, "post_id": 41021301, "comment_id": 69252266, "body": "Updated syntax throws an error of Invalid Procedure call or argument"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1481127993, "last_edit_date": 1481127993, "creation_date": 1481124443, "answer_id": 41021301, "question_id": 41021009, "link": "https://stackoverflow.com/questions/41021009/use-cell-value-contains-periods-apastrophe-in-hyperlink-address/41021301#41021301", "title": "Use Cell Value (Contains periods &amp; Apastrophe) In Hyperlink Address", "body": "<p>Here you go:</p>\n\n<pre><code>Dim lr As Long, i As Long\nDim sSheet As String\nDim ws As Worksheet\n\nSet ws = ActiveSheet\nlr = Cells(Rows.Count, 2).End(xlUp).Row\nFor i = 2 To lr\n    ActiveSheet.Hyperlinks.Add Anchor:=ws.Cells(i, 15), Address:=\"\", SubAddress:=ws.Cells(i, 2).Value &amp; \"!A1\", TextToDisplay:=ws.Cells(i, 15)\nNext i\nws.Activate\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 7086614, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4fad256a51f36f252838afd4a50a17d3?s=128&d=identicon&r=PG&f=1", "display_name": "SmallFries BigGuys", "link": "https://stackoverflow.com/users/7086614/smallfries-bigguys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 41021136, "answer_count": 2, "score": 0, "last_activity_date": 1481136846, "creation_date": 1481123539, "last_edit_date": 1481136846, "question_id": 41021009, "link": "https://stackoverflow.com/questions/41021009/use-cell-value-contains-periods-apastrophe-in-hyperlink-address", "title": "Use Cell Value (Contains periods &amp; Apastrophe) In Hyperlink Address", "body": "<p>I want to take the value from cell A2 and use it as the hyperlink address with my VBA.  For example, let's say that cell A2 has a value of Pink, I want to link to worksheet Pink!A1.  Issue I have is that I get an error of </p>\n\n<blockquote>\n  <p>Syntax error</p>\n</blockquote>\n\n<p>How should this be altered in order to be valid syntax?</p>\n\n<pre><code>Dim lr As Long, i As Long\nlr = Cells(Rows.Count, 2).End(xlUp).Row\nFor i = 2 To lr\n  ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:=Cells(i, 2).Value\"!A1\"\nNext i\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nFor clarity let me add that I want the link to be placed in Column O, with the current cell value of Column O, but the worksheet to link to should be the value of column B.</p>\n\n<p><strong>EDIT 2</strong><br>\nUsing thte syntax suggested by @Jeremy has gotten me closer and I am at this point, where I found the issue was any special symbol (i.e. a comma, period, hyphen etc) must be enclosed with a single quote.  Which leaves my syntax at the below, but get an error</p>\n\n<blockquote>\n  <p>Invalid Procedure call or argument</p>\n</blockquote>\n\n<p>I think I am close to having this perfect but not quite there:</p>\n\n<pre><code>Function TakeTwo()\nDim lr As Long, i As Long\nDim sSheet As String\nDim ws As Worksheet\n\nSet ws = ActiveSheet\nlr = Cells(Rows.Count, 2).End(xlUp).Row\nFor i = 2 To lr\n  If ws.Cells(i, 2).Value Like \"*,*\" Or ws.Cells(i, 2).Value Like \"*'*\" Or ws.Cells(i, 2).Value Like \"*&amp;*\" Or ws.Cells(i, 2).Value Like \"*-*\" Or ws.Cells(i, 2).Value Like \"*.*\" Then\n    ActiveSheet.Hyperlinks.Add Anchor:=ws.Cells(i, 15), Address:=\"\", SubAddress:=\"'\" &amp; ws.Cells(i, 2).Value &amp; \"'!A1\", TextToDisplay:=ws.Cells(i, 15)\n  Else\n    ActiveSheet.Hyperlinks.Add Anchor:=ws.Cells(i, 15), Address:=\"\", SubAddress:=ws.Cells(i, 2).Value &amp; \"!A1\", TextToDisplay:=ws.Cells(i, 15)\n  End If\nNext i\nws.Activate\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 1, "creation_date": 1481140446, "post_id": 41021008, "comment_id": 69259516, "body": "Welcome to SO Evil Patrick!  Please be sure to mark an answer as correct, this is sort of our &quot;coin of the realm&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 4016180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_p4hxsnAQmA/AAAAAAAAAAI/AAAAAAAAJzs/ytIsqnM3gKY/photo.jpg?sz=128", "display_name": "Bernd Stoeckel", "link": "https://stackoverflow.com/users/4016180/bernd-stoeckel"}, "is_accepted": false, "score": 1, "last_activity_date": 1481123998, "creation_date": 1481123998, "answer_id": 41021151, "question_id": 41021008, "link": "https://stackoverflow.com/questions/41021008/excel-vba-to-dynamically-replace-rnumbercnumber-for-pivot-table/41021151#41021151", "title": "Excel vba to dynamically replace R(number)C(number) for pivot table", "body": "<p><code>\"My_Data!R1C1:R210C23\"</code> is a string. \nYou may always replace a part of a string like this:</p>\n\n<pre><code>\"My_Data!R1C1:R\" &amp; LastRow &amp; \"C23\"\n</code></pre>\n\n<p>make sure that the string includes everything needed when you replace something with a variable. </p>\n"}], "owner": {"reputation": 1, "user_id": 7262912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7JwE.jpg?s=128&g=1", "display_name": "Evil Patrick", "link": "https://stackoverflow.com/users/7262912/evil-patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481140357, "creation_date": 1481123536, "last_edit_date": 1531161705, "question_id": 41021008, "link": "https://stackoverflow.com/questions/41021008/excel-vba-to-dynamically-replace-rnumbercnumber-for-pivot-table", "title": "Excel vba to dynamically replace R(number)C(number) for pivot table", "body": "<p>I'm very new to vba. As such, I've been using the \"Record Macro...\" functionality to get my scripts started. From that point, I hack away.</p>\n\n<p>I've recorded a macro to create a pivot table that is based on data that will dynamically change as time goes on (ie. from day to day, or from month to month).</p>\n\n<p>The \"My_Data\" table contains trouble ticket info, such as the year and month that a ticket was closed.</p>\n\n<p>Here's what the recorded script looks like (though I hacked a bit by adding the simple line to create a target sheet for the pivot chart that is named \"Closed\"):</p>\n\n<pre><code>Sub CreateClosedPivot()\n    Sheets(\"My_Data\").Select\n    Sheets.Add.Name = \"Closed\"\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"My_Data!R1C1:R210C23\", Version:=xlPivotTableVersion15). _\n        CreatePivotTable TableDestination:=\"Closed!R1C1\", TableName:=\"PivotTable8\" _\n        , DefaultVersion:=xlPivotTableVersion15\n    Sheets(\"Closed\").Select\n    Cells(1, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable8\").PivotFields(\"Year Closed\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable8\").AddDataField    ActiveSheet.PivotTables( _\n    \"PivotTable8\").PivotFields(\"Month Closed\"), \"Count of Month Closed\", xlCount\n    With ActiveSheet.PivotTables(\"PivotTable8\").PivotFields(\"Month Closed\")\n        .Orientation = xlRowField\n        .Position = 2\n    End With\nEnd Sub\n</code></pre>\n\n<p>As stated above, the My_Data table will change. What that means is that the static, recorded line that contains \"My_Data!R1C1:R210C23\" will be incorrect the next month this macro is run. Specifically, this issue is isolated to 'R210' in that line of code. The row number will change. The other numbers are static (eg C23).</p>\n\n<p>I also know how to get count of the last row of My_Data:</p>\n\n<pre><code>Dim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ThisWorkbook.Worksheets(\"My_Data\")\n\nLastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nMsgBox \"LastRow is \" &amp; LastRow, vbInformation\n</code></pre>\n\n<p>What would be nice would be the ability to somehow replace the static 'R210' with 'LastRow'.</p>\n\n<p>If that's possible, can someone please provide the syntax to enable this substitution?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 3910616, "user_type": "registered", "profile_image": "https://graph.facebook.com/609687831/picture?type=large", "display_name": "Teng Bang Wei", "link": "https://stackoverflow.com/users/3910616/teng-bang-wei"}, "edited": false, "score": 0, "creation_date": 1481161708, "post_id": 41021558, "comment_id": 69268458, "body": "Thanks Scott! You are a life-saver! :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1481125262, "last_edit_date": 1495539958, "creation_date": 1481125262, "answer_id": 41021558, "question_id": 41020965, "link": "https://stackoverflow.com/questions/41020965/using-vba-to-select-a-group-of-cells-based-on-same-values/41021558#41021558", "title": "Using VBA to select a group of cells based on same values", "body": "<p><a href=\"https://www.excelcampus.com/vba/macros-explained-part-2/\" rel=\"nofollow noreferrer\">Qualify the objects</a> and <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid select</a></p>\n\n<pre><code>Sub ActualColouring()\n\nDim ws as Worksheet\nSet ws = ThisWorkbook.Worksheets(\"mySheet\") ' change name as needed\n\nWith ws\n\n    Dim SerialNumber As Long, lRow as Long\n    lRow = .Range(\"A\" &amp; .Rows.Count).End(xlup).Row\n\n    For SerialNumber = 2 to lRow                                                                                             \n\n        If .Cells(1, SerialNumber).Value = .Cells(1, SerialNumber + 1).Value Then     \n            With .Cells(1, SerialNumber).Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .ThemeColor = xlThemeColorAccent1\n                .TintAndShade = 0.799981688894314\n                .PatternTintAndShade = 0\n            End With                                                                                                \n        End If\n    Next\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 160, "user_id": 3910616, "user_type": "registered", "profile_image": "https://graph.facebook.com/609687831/picture?type=large", "display_name": "Teng Bang Wei", "link": "https://stackoverflow.com/users/3910616/teng-bang-wei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1310, "favorite_count": 0, "accepted_answer_id": 41021558, "answer_count": 1, "score": 0, "last_activity_date": 1481125262, "creation_date": 1481123435, "last_edit_date": 1481123634, "question_id": 41020965, "link": "https://stackoverflow.com/questions/41020965/using-vba-to-select-a-group-of-cells-based-on-same-values", "title": "Using VBA to select a group of cells based on same values", "body": "<p>I would like write a VBA code to select a group of cells that has the same value and colour it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ydbNJ.jpg\" rel=\"nofollow noreferrer\">MySpreadSheet</a></p>\n\n<p>For Row A, Staff ID, are the same, for the same person, I intend to scan through them and if they are the same, fill the cells with the light blue colour you see in the picture above, for Column A to MaxColumn of Current Region.</p>\n\n<p>I have a drafted a code to do that but it does nothing when I run it. Any help will be appreciated:</p>\n\n<pre><code>Sub ActualColouring()\n\nDim SerialNumber As Integer\n\nSerialNumber = 2                                                                                            'this variable will be assign to the rows, ignore the header, start from 2\n\nDo While Cells(1, SerialNumber).Value &lt;&gt; \"\"                                                   'keep looping as long as cell is not blank\n    If Cells(1, SerialNumber).Value = Cells(1, SerialNumber + 1).Value Then     'if the value of the cell is the same as the cell below, then\n        Cells(1, SerialNumber).Select                                                                  'then select it\n        With Selection.Interior                                                                             'this line is the start of the fill colouring\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorAccent1\n            .TintAndShade = 0.799981688894314\n            .PatternTintAndShade = 0\n        End With                                                                                                'end of fill colouring function\n    End If\n    SerialNumber = SerialNumber + 1                                                               'move to the next cell\nLoop                                                                                                               'loop until the end of current region\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 3, "creation_date": 1481120855, "post_id": 41019859, "comment_id": 69247060, "body": "I would suggest stepping through the code until you&#39;re sure that&#39;s the exact line it fails and then looking at the locals (variables) window to find out what is undefined"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1481121587, "post_id": 41020254, "comment_id": 69247605, "body": "Good catch, I think that&#39;s it. Error is raising from the Userform on the function call to <code>schrijven</code>, but the error actually occurs within that function, for reason you indicate."}, {"owner": {"reputation": 3, "user_id": 7262692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed73a244afffc7400b6d3dbf4921bf97?s=128&d=identicon&r=PG&f=1", "display_name": "Sasquatch-cyber", "link": "https://stackoverflow.com/users/7262692/sasquatch-cyber"}, "edited": false, "score": 0, "creation_date": 1481131440, "post_id": 41020254, "comment_id": 69254345, "body": "I&#39;ve tried commenting out the line using <code>nextrow.text</code>, and commented out all mentions of my previous workaround (using a <code>nextrow</code> duplicate) to no avail. Any other ways I can see if this is the problem?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 7262692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed73a244afffc7400b6d3dbf4921bf97?s=128&d=identicon&r=PG&f=1", "display_name": "Sasquatch-cyber", "link": "https://stackoverflow.com/users/7262692/sasquatch-cyber"}, "edited": false, "score": 0, "creation_date": 1481135598, "post_id": 41020254, "comment_id": 69256771, "body": "@Joren it is most definitely  a problem.  If you link a sample workbook to me using a service like Google Drive,Google DOcs, FileHippo or DropBox, I&#39;ll debug it for you."}, {"owner": {"reputation": 3, "user_id": 7262692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed73a244afffc7400b6d3dbf4921bf97?s=128&d=identicon&r=PG&f=1", "display_name": "Sasquatch-cyber", "link": "https://stackoverflow.com/users/7262692/sasquatch-cyber"}, "edited": false, "score": 0, "creation_date": 1481135608, "post_id": 41020254, "comment_id": 69256783, "body": "It actually worked! I found a typo I added later elsewhere, after simplifying further I got it to work. Yours was definitely the answer to the problem I&#39;ve had from the start. Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 4, "last_activity_date": 1481121766, "last_edit_date": 1481121766, "creation_date": 1481121495, "answer_id": 41020254, "question_id": 41019859, "link": "https://stackoverflow.com/questions/41019859/excel-vba-error-424-calling-sub/41020254#41020254", "title": "Excel VBA error 424 calling sub", "body": "<p>Here you declare <code>Nextrow</code> as a vriant</p>\n\n<pre><code>Dim Nextrow As Variant\n</code></pre>\n\n<p>You assign <code>Nextrow</code> a numeric value.  <code>Nextrow</code> is now effectively a number.</p>\n\n<pre><code>Nextrow = Sheets(\"Database\").Range(\"A65536\").End(xlUp).Row + 1\n</code></pre>\n\n<p>Since numeric values do not have a <code>Text</code> property, the 424 error is raised.</p>\n\n<pre><code>Sheets(\"Database\").Range(\"A\" &amp; Nextrow) = Nextrow.Text\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7262692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed73a244afffc7400b6d3dbf4921bf97?s=128&d=identicon&r=PG&f=1", "display_name": "Sasquatch-cyber", "link": "https://stackoverflow.com/users/7262692/sasquatch-cyber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 41020254, "answer_count": 1, "score": 0, "last_activity_date": 1481121766, "creation_date": 1481120521, "question_id": 41019859, "link": "https://stackoverflow.com/questions/41019859/excel-vba-error-424-calling-sub", "title": "Excel VBA error 424 calling sub", "body": "<p>I've scoured the internet but I can't seem to find an answer to my question, according to the answers I've seen I shouldn't have a problem.</p>\n\n<p>A lot of the code is sloppy since it's a copy pasta from something that used to work. Intention was to clean up after it being functional.</p>\n\n<p>Im passing 7 strings to a sub from my userform, but I keep getting the 424 error.</p>\n\n<p>From the userform:</p>\n\n<pre><code>Sub CommandButton1_Click()\n\nDim Bericht As Variant\n\nDim RuilingOfVermissing As String\nDim Benaming As String\nDim NSN As String\nDim Aantal As String\nDim Bijzonderheden As String\nDim DatumIn As String\nDim Naam As String\n\n\n'Check verplichte velden\nIf OptionButton1.Value = False And OptionButton2.Value = False Then\n    Bericht = MsgBox(\"Selecteer Ruiling of Vermissing\", vbOKOnly)\n    GoTo ErrorExit\nElseIf OptionButton1.Value = True And OptionButton2.Value = True Then\n    Bericht = MsgBox(\"Selecteer Ruiling OF Vermissing, niet allebei\", vbOKOnly)\n    GoTo ErrorExit\nElseIf OptionButton1.Value = True Then\n    RuilingOfVermissing = \"Ruiling\"\nElseIf OptionButton2.Value = True Then\n    RuilingOfVermissing = \"Vermissing\"\nEnd If\n\n\nIf Len(TextBox2 &amp; vbNullString) = 0 Then\n    Bericht = MsgBox(\"Vul een benaming in\", vbOKOnly)\n    GoTo ErrorExit\nElseIf Len(TextBox3 &amp; vbNullString) = 0 Then\n    Bericht = MsgBox(\"Vul een NSN in\", vbOKOnly)\n    GoTo ErrorExit\nElseIf Len(TextBox4 &amp; vbNullString) = 0 Then\n    Bericht = MsgBox(\"Vul een aantal in\", vbOKOnly)\n    GoTo ErrorExit\nElseIf Len(TextBox5 &amp; vbNullString) = 0 Then\n    Bericht = MsgBox(\"Vul een 'datum in' in\", vbOKOnly)\n    GoTo ErrorExit\nElseIf Len(TextBox9 &amp; vbNullString) = 0 Then\n    Bericht = MsgBox(\"Vul je naam in\", vbOKOnly)\n    GoTo ErrorExit\nEnd If\n\n'Niet verplicht veld (\"bijzonderheden\") aanpassen naar spatie om Null te voorkomen\nIf Len(TextBox7 &amp; vbNullString) = 0 Then\n    TextBox7.Text = \"-\"\nEnd If\n\nBenaming = TextBox2.Text\nNSN = TextBox3.Text\nAantal = TextBox4.Text\nBijzonderheden = TextBox7.Text\nDatumIn = TextBox5.Text\nNaam = TextBox9.Text\n\nRuilVernis.schrijven RuilingOfVermissing, Benaming, NSN, Aantal, Bijzonderheden, DatumIn, Naam\n\nErrorExit:\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>From the called sub:</p>\n\n<pre><code>Sub schrijven(Optional RuilingOfVermissing As String, _\nOptional Benaming As String, _\nOptional NSN As String, _\nOptional Aantal As String, _\nOptional Bijzonderheden As String, _\nOptional DatumIn As String, _\nOptional Naam As String)\n\nDim Nextrow As Variant\n\nSheets(\"Database\").Select\n\nNextrow = Sheets(\"Database\").Range(\"A65536\").End(xlUp).Row + 1\n\nSheets(\"Database\").Range(\"A\" &amp; Nextrow) = Nextrow.Text\nSheets(\"Database\").Range(\"B\" &amp; Nextrow) = RuilingOfVermissing\nSheets(\"Database\").Range(\"C\" &amp; Nextrow) = Benaming\nSheets(\"Database\").Range(\"D\" &amp; Nextrow) = NSN\nSheets(\"Database\").Range(\"E\" &amp; Nextrow) = Aantal\nSheets(\"Database\").Range(\"F\" &amp; Nextrow) = Bijzonderheden\nSheets(\"Database\").Range(\"G\" &amp; Nextrow) = DatumIn\nSheets(\"Database\").Range(\"I\" &amp; Nextrow) = Naam\n\nSheets(\"Start\").Select\n\nUnload UserForm1\nUserForm1.Show\n\nSave\n\nEnd Sub\n</code></pre>\n\n<p>When I run the 424 points to:</p>\n\n<pre><code>RuilVernis.schrijven RuilingOfVermissing, Benaming, NSN, Aantal, Bijzonderheden, DatumIn, Naam'\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>Many thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481120332, "post_id": 41019729, "comment_id": 69246662, "body": "Think you might be outta luck.  <a href=\"https://word.uservoice.com/forums/304924-word-for-windows-desktop-application/suggestions/10643091-bring-back-offline-help-in-office-2016\" rel=\"nofollow noreferrer\">word.uservoice.com/forums/&hellip;</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1481120419, "post_id": 41019729, "comment_id": 69246720, "body": "Well, how about reassigning the shortcut of F1 and opening something you wish?"}, {"owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 1, "creation_date": 1481120599, "post_id": 41019729, "comment_id": 69246850, "body": "Vityata I don&#39;t think it&#39;s that easy. It usually opens help relevent to whatever you have currently selected... So it&#39;s not just a generic shortcut."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 5, "creation_date": 1481123244, "post_id": 41019729, "comment_id": 69248694, "body": "Is this what you are looking for? <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=40326\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=40326</a>"}], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 646, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1481120494, "creation_date": 1481120197, "last_edit_date": 1531164843, "question_id": 41019729, "link": "https://stackoverflow.com/questions/41019729/configure-excel-vba-help-for-offline-use", "title": "Configure Excel VBA Help for Offline Use", "body": "<p>I recently acquired a new Windows 10 computer running Office 365.  This was purchased to replace my \"old\" Windows 7 machine running Excel 2007.</p>\n\n<p>I frequently work on the road and would like to configure VBA Help to work on offline <em>(local)</em> help files.  Currently, whenever I touch <kbd>F1</kbd> in the VBA window it tries to go online for the information.</p>\n\n<p>Is there any solution for this ??</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7099932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1271155812905553/picture?type=large", "display_name": "Alekos Mazzolotti", "link": "https://stackoverflow.com/users/7099932/alekos-mazzolotti"}, "edited": false, "score": 0, "creation_date": 1481199637, "post_id": 41020739, "comment_id": 69285942, "body": "Hi, Doug! Thanks for your help! I have updated my question with an example of the code I use. I have to define variables this way because I need the calculations to happen in real time as any of the TextBoxes change, and it prevents errors from happening in case of a user typing text or symbols. Is it possible to embed your solution on my code?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 15, "user_id": 7099932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1271155812905553/picture?type=large", "display_name": "Alekos Mazzolotti", "link": "https://stackoverflow.com/users/7099932/alekos-mazzolotti"}, "edited": false, "score": 0, "creation_date": 1481209319, "post_id": 41020739, "comment_id": 69292369, "body": "@AlekosMazzolotti I have updated my answer to explain it in more detail and show you what part you can use"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 0, "last_activity_date": 1481209270, "last_edit_date": 1481209270, "creation_date": 1481122810, "answer_id": 41020739, "question_id": 41019728, "link": "https://stackoverflow.com/questions/41019728/calculations-in-form-with-percent-formated-box/41020739#41020739", "title": "Calculations in form with percent formated box", "body": "<p>Without seeing your code I have decided to whip a cool example for you to see how to deal with your issue. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Rx9BM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rx9BM.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    If InStr(TextBox1.Value, \"%\") &gt; 0 Then\n        myValue1 = Mid(TextBox1.Value, 1, InStr(TextBox1.Value, \"%\") - 1)\n        myValue1 = myValue1 / 100\n    End If\n\n    myValue2 = TextBox2.Value\n\n    myValue3 = myValue1 * myValue2\n\n    TextBox3.Value = myValue3\n\n    Debug.Print \"v1 \"; myValue1\n    Debug.Print \"v2 \"; myValue2\n    Debug.Print \"v3 \"; myValue3\n\nEnd Sub\n</code></pre>\n\n<p>The issue youre having with your code is</p>\n\n<pre><code>If IsNumeric(.BoxIPI.Text) = True Then\n   IPI = CDbl(.BoxIPI)\nElse: IPI = 0\nEnd If\n</code></pre>\n\n<p>The % sign makes the compiler think that BoxIPI.Value is not numeric. Using this will solve your issue</p>\n\n<pre><code>If IsNumeric(Mid(TextBox1.Value, 1, InStr(TextBox1.Value, \"%\") - 1)) Then\n    myValue1 = Mid(TextBox1.Value, 1, InStr(TextBox1.Value, \"%\") - 1)\n    myValue1 = myValue1 / 100\nEnd If\n</code></pre>\n\n<p>Of course you dont need to use my decimal division as you can just adapt this to your cause and of course change \"TextBox1\" to BoxIPI, but you get the point :)</p>\n"}], "owner": {"reputation": 15, "user_id": 7099932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1271155812905553/picture?type=large", "display_name": "Alekos Mazzolotti", "link": "https://stackoverflow.com/users/7099932/alekos-mazzolotti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 41020739, "answer_count": 1, "score": 0, "last_activity_date": 1481209270, "creation_date": 1481120197, "last_edit_date": 1531164843, "question_id": 41019728, "link": "https://stackoverflow.com/questions/41019728/calculations-in-form-with-percent-formated-box", "title": "Calculations in form with percent formated box", "body": "<p>I have some TextBoxes programed to show results of calculations based on cost, quantities and taxes. The problem is, if I program the tax box to be formatted as percent on exit, the calculation no longer occurs after the action, because the box becomes string typed. Is that a normal behavior? Is there a way to solve that? Currency formatted TextBoxes bring normal calculation results. The problem is a percent issue only...</p>\n\n<p><img src=\"https://i.stack.imgur.com/BNkhL.png\" alt=\"Form print with visual explanation\"></p>\n\n<p>PS.: I use the common formatting method:</p>\n\n<pre><code>Private Sub BoxIPI_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n\n    BoxIPI = Format(BoxIPI, \"percent\")\n\nEnd Sub\n</code></pre>\n\n<p>The code is long because of the quantity of calculations needed, but, to put it on a nutshell, I united the parts that calculate de IPI, as an example (the variables are public):</p>\n\n<pre><code>If IsNumeric(.BoxQtd.Text) = True Then\nQuantidade = .BoxQtd\nElse: Quantidade = 0\nEnd If\n\nIf IsNumeric(.BoxVendaU.Text) = True Then\nVendaUni = .BoxVendaU\nElse: VendaUni = 0\nEnd If\n\nIf IsNumeric(.BoxIPI.Text) = True Then\nIPI = CDbl(.BoxIPI)\nElse: IPI = 0\nEnd If\n\nVIPI = (Quantidade * VendaUni) * IPI\n.BoxValorIPI = Format(VIPI, \"currency\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1481120294, "post_id": 41019445, "comment_id": 69246632, "body": "Showing an image of before and after of some example data of what you&#39;re trying to &#39;merge&#39; would be very helpful."}, {"owner": {"reputation": 13, "user_id": 7262636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206447212454088/picture?type=large", "display_name": "Igor Sena", "link": "https://stackoverflow.com/users/7262636/igor-sena"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1481123815, "post_id": 41019445, "comment_id": 69249090, "body": "They&#39;re empty cells. The code I wrote down was for formatting borders and cells ranges in an output table based on input data for defining the ranges. The answer down here nailed it."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7262636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206447212454088/picture?type=large", "display_name": "Igor Sena", "link": "https://stackoverflow.com/users/7262636/igor-sena"}, "edited": false, "score": 0, "creation_date": 1481125240, "post_id": 41019833, "comment_id": 69250169, "body": "It worked perfectly! Thanks a lot. The part that interested me was the one that merged the cells 5 to 8. 2 and 3 should be one at a time as they already was."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1481120470, "creation_date": 1481120470, "answer_id": 41019833, "question_id": 41019445, "link": "https://stackoverflow.com/questions/41019445/selecting-some-columns-from-a-already-defined-range/41019833#41019833", "title": "Selecting some columns from a already defined range", "body": "<p>Would this work for you?</p>\n\n<pre><code>Sub Test()\n\n    Dim l As Long\n    Dim Geo1 As Range\n\n    Set Geo1 = ThisWorkbook.Worksheets(\"Sdb pg1\").Range(\"A1:H5\")\n\n    Geo1.Columns(2).Resize(, 2).MergeCells = True\n    Geo1.Columns(4).Resize(, 5).MergeCells = True\n\nEnd Sub\n</code></pre>\n\n<p>I've added the borders manually:\n<a href=\"https://i.stack.imgur.com/oesFg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oesFg.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 7262636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206447212454088/picture?type=large", "display_name": "Igor Sena", "link": "https://stackoverflow.com/users/7262636/igor-sena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 41019833, "answer_count": 1, "score": 1, "last_activity_date": 1481120470, "creation_date": 1481119405, "question_id": 41019445, "link": "https://stackoverflow.com/questions/41019445/selecting-some-columns-from-a-already-defined-range", "title": "Selecting some columns from a already defined range", "body": "<p>I'm new into VBA for excel and I was trying to select some columns within a range (that is working in a loop). Then I want to merge these columns. I've coded like that for now</p>\n\n<pre><code>For l = 2 To 8\nWorksheets(\"SdB pg1\").Range(Geo1).Columns(l).MergeCells = True\nNext l`      \n</code></pre>\n\n<p>Geo1 is a Range variable</p>\n\n<p>l is an integer variable</p>\n\n<p>But I Want to make it run just for columns 2 and 3 then pick columns 4, 5, 6, 7 and 8 together and then merge. I've already tried \"And\", \"&amp;\", Columns(\"K:O\") with no success. \nIf possible, i don't want to create new variables, just work directly with the range and avoiding \".select\".\nHope any of you could help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1481119460, "post_id": 41019392, "comment_id": 69246063, "body": "Loop through range C to last column and if a value exists redim array +1 and add value"}, {"owner": {"reputation": 63, "user_id": 6304389, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/q9oDC.jpg?s=128&g=1", "display_name": "Jordan Violet", "link": "https://stackoverflow.com/users/6304389/jordan-violet"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1481120220, "post_id": 41019392, "comment_id": 69246583, "body": "@Flephal, What is the best way to select the Row when I have the .Address I want of the cell in Col1?"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1481120393, "post_id": 41019392, "comment_id": 69246702, "body": "You can use .Row for the found range."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1481120706, "post_id": 41019392, "comment_id": 69246948, "body": "Say you named the <code>.Address</code> Col1 then <code>Cells(Col1.row, 3)</code> or <code>Range(&quot;C&quot; &amp; Col1.row)</code> for the 3rd column, or define a long for it and reference that instead... Another option is create a Do Until Loop and do until x,y is blank."}, {"owner": {"reputation": 63, "user_id": 6304389, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/q9oDC.jpg?s=128&g=1", "display_name": "Jordan Violet", "link": "https://stackoverflow.com/users/6304389/jordan-violet"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1481120846, "post_id": 41019392, "comment_id": 69247050, "body": "@Flephal Would you be able to give a code snippet? When I call my rangeObject.Row I get a Type Mismatch."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1481120962, "post_id": 41019392, "comment_id": 69247136, "body": "What code have you tried already? Editing your question to show current code would help out"}], "answers": [{"tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 3, "last_activity_date": 1481120652, "creation_date": 1481120652, "answer_id": 41019903, "question_id": 41019392, "link": "https://stackoverflow.com/questions/41019392/how-to-select-range-of-values-on-same-row-as-selected-cell/41019903#41019903", "title": "How to select range of values on same row as selected cell?", "body": "<p>This may help:</p>\n\n<pre><code>Sub SelectNumbers()\n    Dim foundCell As Range, lastNum As Integer, nums As Range, arr() as variant, i As Integer\n\n    Set foundCell = ActiveCell\n    lastNum = foundCell.Offset(0, 2).End(xlToRight).Column\n\n    //Get range object\n    Set nums = Range(Cells(foundCell.Row, 3), Cells(foundCell.Row, lastNum))\n\n    Debug.Print nums.Address\n\n    //Read as array\n    arr = Range(Cells(foundCell.Row, 3), Cells(foundCell.Row, lastNum)).Value\n\n    For i = 1 To UBound(arr, 2)\n        Debug.Print arr(1, i)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I am not sure how your code defines the cell you are searching for. In my code I have used <code>ActiveCell</code> as a surrogate. You will need to adapt this.</p>\n\n<p>I have made two assumptions:</p>\n\n<ol>\n<li>Your <code>nums</code> always start in column 3</li>\n<li>Your <code>nums</code> are always contiguous i.e. no blank cells interspersed within <code>nums</code></li>\n</ol>\n\n<p>I also show how to get <code>range</code> object or <code>array</code>. You decide which you prefer.</p>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 7231007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e984822b5caf20ac3d48447b3eb117?s=128&d=identicon&r=PG&f=1", "display_name": "jwdasdk", "link": "https://stackoverflow.com/users/7231007/jwdasdk"}, "is_accepted": false, "score": 0, "last_activity_date": 1481121936, "creation_date": 1481121936, "answer_id": 41020414, "question_id": 41019392, "link": "https://stackoverflow.com/questions/41019392/how-to-select-range-of-values-on-same-row-as-selected-cell/41020414#41020414", "title": "How to select range of values on same row as selected cell?", "body": "<p>if a column is inserted between Col2 and Col3, Or the data structure is different, all you need to do is adapt the <code>foundCell.Offset(row, column).End(xlToRight).Column</code></p>\n\n<p>Just adding to Alex P's answer</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Your <code>nums</code> are always contiguous i.e. no blank cells interspersed within nums</li>\n  </ol>\n</blockquote>\n\n<p>if Col3 can contain some empty spot, like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/CIvkI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CIvkI.jpg\" alt=\"empty values\"></a></p>\n\n<p>something like <code>Cells(4, Columns.Count).End(xlToLeft).Column</code> would be more suited to get last value of Col3 ( IF and Only IF Column 3 is the last column of your table )</p>\n"}], "owner": {"reputation": 63, "user_id": 6304389, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/q9oDC.jpg?s=128&g=1", "display_name": "Jordan Violet", "link": "https://stackoverflow.com/users/6304389/jordan-violet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481121936, "creation_date": 1481119235, "question_id": 41019392, "link": "https://stackoverflow.com/questions/41019392/how-to-select-range-of-values-on-same-row-as-selected-cell", "title": "How to select range of values on same row as selected cell?", "body": "<p>So I am using a search to find a value in Col1 (shown in the image below) and once I find that cell, I want to select all items in that row that are in Col3 and over that have values.</p>\n\n<p>For example if my search is looking for val1, then I want to select num1, num2, and num3 into an array.</p>\n\n<p>I have the search working to find the Address of the val, but I have not been able to figure out how to get all the values in Col3 and to the right that are not empty.</p>\n\n<p><img src=\"https://i.imgur.com/ncDfa6C.png\" alt=\"my excel example\"></p>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481118429, "post_id": 41018920, "comment_id": 69245365, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/36157512/show-number-stored-as-text-error\">Show &quot;Number stored as Text&quot; error</a>"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1481118774, "post_id": 41018920, "comment_id": 69245594, "body": "Maybe one could set <code>Application.ErrorCheckingOptions.NumberAsText = False</code> to ignore those errors and <code>Application.ErrorCheckingOptions.NumberAsText = True</code> to not ignore."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481119897, "post_id": 41018920, "comment_id": 69246364, "body": "@Comintern, your proposed solution it to check cells individually (<code>For Each current In ActiveSheet.UsedRange.Cells</code>). That&#39;s specifically what I&#39;m trying not not do."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1481120341, "post_id": 41018920, "comment_id": 69246667, "body": "@AxelRichter, I would consider changing the <code>ErrorCheckingOptions</code> settings if I could use it on this specific worksheet, but I&#39;m not willing to change the application settings of users (and changing it every time the user activate/deactivate the sheet seems like a bad idea)."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1481120761, "post_id": 41018920, "comment_id": 69246982, "body": "@Tibo: No, <code>Application.ErrorCheckingOptions</code> is an application setting and not possible only for one sheet. That&#39;s why I have not posted this as an answer. But as far as I know, the <code>Errors</code> object can only be gotten cell by cell. The concept <code>Range</code> in <code>Excel</code> is a little bit confusing some times, not only in this case."}], "owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1662, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481119925, "creation_date": 1481117751, "last_edit_date": 1481119925, "question_id": 41018920, "link": "https://stackoverflow.com/questions/41018920/clear-or-ignore-all-range-errors-in-excel-using-vba", "title": "Clear or ignore all Range.errors in Excel using VBA", "body": "<p>I'm trying to clear all errors (Range.Errors Property, not value errors) on a worksheet. Is it possible to do it <strong>without</strong> dealing with each cell <strong>individually</strong> ?</p>\n\n<p><code>.Range(\"C3\").Errors(xlNumberAsText).Ignore = True</code> works fine (whether there is an error or not in C3).</p>\n\n<p>But <code>.Range(\"C3:F3\").Errors(xlNumberAsText).Ignore = True</code> or <code>.Cells.Errors(xlNumberAsText).Ignore = True</code> don't.</p>\n\n<p>Looking as <a href=\"https://msdn.microsoft.com/library/office/ff835287.aspx\" rel=\"nofollow noreferrer\">MSDN Excel VBA reference</a>, the property should work for any Range (whether it is multi-cell or not), isn't it ?</p>\n\n<blockquote>\n  <p><em>expression</em> .Errors</p>\n  \n  <p><em>expression</em> A variable that represents a Range object.</p>\n</blockquote>\n"}, {"tags": ["vba", "cmd", "io-redirection", "wsh"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481118250, "post_id": 41017977, "comment_id": 69245237, "body": "If it sends output to STDOUT, <a href=\"https://msdn.microsoft.com/en-us/library/cbxxzwb5(v=vs.84).aspx\" rel=\"nofollow noreferrer\">something like this might</a> be useful."}], "answers": [{"comments": [{"owner": {"reputation": 475, "user_id": 1298649, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/241bed9df9309c1d92bd18953cb0a606?s=128&d=identicon&r=PG", "display_name": "anurag", "link": "https://stackoverflow.com/users/1298649/anurag"}, "edited": false, "score": 0, "creation_date": 1481127063, "post_id": 41018145, "comment_id": 69251465, "body": "It worked perfectly when i used command1 = &quot;cmd /c &quot;&quot;&quot; &amp; command1 &amp; &quot;&quot;&quot;&quot;.Thumbs up for that."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 1, "last_activity_date": 1481115561, "last_edit_date": 1495540905, "creation_date": 1481115561, "answer_id": 41018145, "question_id": 41017977, "link": "https://stackoverflow.com/questions/41017977/running-and-saving-command-output-using-vba/41018145#41018145", "title": "Running and saving command output using VBA", "body": "<p>Two thoughts:</p>\n\n<ol>\n<li>Try <code>E:\\anurag.csv</code> instead of <code>E:/anurag.csv</code></li>\n<li><p>Use <code>cmd</code> to invoke <code>plink</code>, since <code>cmd</code> usually processes the redirections.  Replace the <code>wsh.Run</code> line with:</p>\n\n<pre><code>command1 = command1 &amp; \"&gt;E:\\anurag.csv\"\ncommand1 = \"cmd /c \"\"\" &amp; command1 &amp; \"\"\"\"\nwsh.Run command1, 0, True\n</code></pre>\n\n<p>The first line completes the command you wanted to execute and the second wraps it in a <code>cmd /c</code> call.</p>\n\n<ul>\n<li>If this doesn't work, try changing <code>/c</code> above to <code>/c /s</code> per <a href=\"https://stackoverflow.com/a/356014/2877364\">this answer</a>.</li>\n</ul></li>\n</ol>\n\n<p>YMMV - not tested</p>\n"}], "owner": {"reputation": 475, "user_id": 1298649, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/241bed9df9309c1d92bd18953cb0a606?s=128&d=identicon&r=PG", "display_name": "anurag", "link": "https://stackoverflow.com/users/1298649/anurag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1515, "favorite_count": 0, "accepted_answer_id": 41018145, "answer_count": 1, "score": 1, "last_activity_date": 1481115965, "creation_date": 1481115094, "last_edit_date": 1481115965, "question_id": 41017977, "link": "https://stackoverflow.com/questions/41017977/running-and-saving-command-output-using-vba", "title": "Running and saving command output using VBA", "body": "<p>I am trying to run shell commands from VBA and get output into a csv file. Below is the code I am using:</p>\n\n<pre><code>Dim wsh as Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")  \nplink_path=\"C:\\plink.exe\"\nkey_path=\"putty key path\"\npass_query=\"select * from test\"\ncommand1 = Replace(plink_path &amp; \" hadoop@11.11.11.11 -i \" &amp; key_path &amp; \" mysql -uuser -ppass -e 'use radar;\" &amp; pass_query &amp; \"'\", Chr(10), \" \")\nwsh.Run command1 &amp; \"&gt;E:/anurag.csv\", 0, True\n</code></pre>\n\n<p>But I am not able to view output file in the E drive.  When I run the above command manually from a <code>cmd</code> prompt I do get an output in the E drive.</p>\n"}, {"tags": ["excel", "powershell", "vba"], "comments": [{"owner": {"reputation": 15120, "user_id": 269453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200abab7089e2613cdba8f3e7c25923e?s=128&d=identicon&r=PG", "display_name": "Mike Miller", "link": "https://stackoverflow.com/users/269453/mike-miller"}, "edited": false, "score": 1, "creation_date": 1481115248, "post_id": 41017915, "comment_id": 69243017, "body": "this looks a more solid approach <a href=\"http://stackoverflow.com/questions/21020077/ping-ip-address-with-vba-code-and-return-results-in-excel\" title=\"ping ip address with vba code and return results in excel\">stackoverflow.com/questions/21020077/&hellip;</a>"}, {"owner": {"reputation": 10981, "user_id": 2208505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b30f13eba910edd70ffd2c62920a3169?s=128&d=identicon&r=PG", "display_name": "James C.", "link": "https://stackoverflow.com/users/2208505/james-c"}, "edited": false, "score": 0, "creation_date": 1481115283, "post_id": 41017915, "comment_id": 69243043, "body": "<code>;</code> is a separator for commands in powershell. You can tell PS to exit after your ping command like this: <code>strexec = &quot;powershell -WindowStyle Hidden -Command ping &quot; &amp; hostname &amp; &quot; -n 1 ;exit&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 7262137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf34aefee5039e67b33a3987849efe9e?s=128&d=identicon&r=PG&f=1", "display_name": "Ingo Miller", "link": "https://stackoverflow.com/users/7262137/ingo-miller"}, "reply_to_user": {"reputation": 10981, "user_id": 2208505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b30f13eba910edd70ffd2c62920a3169?s=128&d=identicon&r=PG", "display_name": "James C.", "link": "https://stackoverflow.com/users/2208505/james-c"}, "edited": false, "score": 0, "creation_date": 1481117343, "post_id": 41017915, "comment_id": 69244515, "body": "@JamesC. Thanks and nice to know but nothing has changed, the window keeps, don&#39;t exit. The script remains in the loop and wait for closing the shell.      <code>Do Until oExec.Status = 1         Application.Wait (Now + TimeValue(&quot;00:00:01&quot;))     Loop</code>"}, {"owner": {"reputation": 10981, "user_id": 2208505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b30f13eba910edd70ffd2c62920a3169?s=128&d=identicon&r=PG", "display_name": "James C.", "link": "https://stackoverflow.com/users/2208505/james-c"}, "edited": false, "score": 1, "creation_date": 1481118140, "post_id": 41017915, "comment_id": 69245168, "body": "Ah that&#39;s a shame, next try is WshShell.Run which you&#39;d use like this: <code>Set oExec = WshShell.Run strexec,0,True</code> The <code>0</code> hides CMD prompt and <code>True</code> makes the script wait for the command to finish before it continuing. (I don&#39;t have Excel so can&#39;t test this so am putting it as a comment not an answer)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6811411"}, "edited": false, "score": 0, "creation_date": 1481147852, "post_id": 41017915, "comment_id": 69263667, "body": "Since your evaluation of the ping results resolves to a true/false why not use test-connection instead of ping <code>strexec = &quot;powershell -WindowStyle Hidden -Command test-Connection &quot; &amp; hostname &amp; &quot; -count 1 -quiet&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 7262137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf34aefee5039e67b33a3987849efe9e?s=128&d=identicon&r=PG&f=1", "display_name": "Ingo Miller", "link": "https://stackoverflow.com/users/7262137/ingo-miller"}, "reply_to_user": {"reputation": 10981, "user_id": 2208505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b30f13eba910edd70ffd2c62920a3169?s=128&d=identicon&r=PG", "display_name": "James C.", "link": "https://stackoverflow.com/users/2208505/james-c"}, "edited": false, "score": 0, "creation_date": 1481154459, "post_id": 41017915, "comment_id": 69266374, "body": "@JamesC. If I try your last code I get a &quot;runtime error 13 type mismatch&quot;, if I change the code to <code>Set oExec = WshShell.Run(strexec, 0, True)</code> the error massage is &quot;compile error object required&quot;.  @LotPings Hi, thank you. Also with your code the powershell remains open after the run.  @all Should I upload the complete document?"}], "owner": {"reputation": 11, "user_id": 7262137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf34aefee5039e67b33a3987849efe9e?s=128&d=identicon&r=PG&f=1", "display_name": "Ingo Miller", "link": "https://stackoverflow.com/users/7262137/ingo-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 935, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1481115103, "creation_date": 1481114864, "last_edit_date": 1531164843, "question_id": 41017915, "link": "https://stackoverflow.com/questions/41017915/excel-vba-powershell-dont-exit-how-to-hide-cmd", "title": "Excel VBA - Powershell don&#39;t exit | How to hide CMD", "body": "<p>I have this code that I am running: </p>\n\n<pre><code>Public Function checkhost(hostname As String)\n    'bla bal...\n    strexec = \"powershell -WindowStyle Hidden -Command ping \" &amp; hostname &amp; \" -n 1\"\n    Set oExec = WshShell.exec(strexec)\n    'bla bla...\nEnd Function\n</code></pre>\n\n<p>From my Excel document, the shell does not close - it remains open. The same code does work, if I use it in Powershell.</p>\n\n<p>With cmd it works fine but I want to hide the cmd window.</p>\n\n<pre><code>strexec = \"%comspec% /C %WINDIR%\\system32\\ping.exe \" &amp; hostname &amp; \" -n 1\"\nSet oExec = WshShell.exec(strexec)\n</code></pre>\n\n<p>AFAIK the only way to hide CMD is to use WshShell.Run but I don't know how to change my existing code. Can anyone suggest a solution?</p>\n\n<p><strong>Complete code</strong></p>\n\n<pre><code>    Public Function checkhost(hostname As String)\n\n    Dim WshShell As Variant\n    Set WshShell = CreateObject(\"Wscript.Shell\")\n\n    Dim ReturnErrorLevel As Variant\n    strexec = \"powershell -WindowStyle Hidden -Command ping \" &amp; hostname &amp; \" -n 1\"\n    Set oExec = WshShell.exec(strexec)\n\n\n\n    Do Until oExec.Status = 1\n        Application.Wait (Now + TimeValue(\"00:00:01\"))\n    Loop\n\n    Result = Split(oExec.StdOut.readAll, vbCrLf, , vbTextCompare)\n\n    For Each Item In Result\n        Debug.Print Item\n        If InStr(1, Item, \"Ping request could not find host\", vbTextCompare) &gt; 0 Then\n            checkhoststatus = \"0.0.0.0\"\n            Exit For\n        End If\n\n        If InStr(1, Item, \"Request timed out.\", vbTextCompare) &gt; 0 Then\n            checkhoststatus = \"0.0.0.0\"\n           Exit For\n        End If\n\n        If InStr(1, Item, \"Reply from \", vbTextCompare) &gt; 0 Then\n            checkhoststatus = Mid(Item, 12, InStr(1, Item, \":\", vbTextCompare) - 12)\n            Exit For\n        End If\n\n    Next Item\nEnd Function\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1481115246, "post_id": 41017553, "comment_id": 69243015, "body": "When the code fails has it executed this line <code>MsgBox Err.Description</code>?"}, {"owner": {"reputation": 325, "user_id": 3480989, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/38a0c369578ceadf6669af5fca71c5be?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/3480989/mak"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1481116188, "post_id": 41017553, "comment_id": 69243704, "body": "no, because I deactived the msgbox. But without error handler it Points to &quot;If Not IsNull(CurrentDb.QueryDefs(QueryName).Name) Then &quot; with a Run Time Error 3265 - Item not found in this collection and I cannot find any incorrect code. But I will try with &quot;On Error resume next&quot;, maybe it skips..."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1481116191, "post_id": 41017553, "comment_id": 69243706, "body": "I&#39;ve added the general VBA tag, to increase the views on this question."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1481117560, "post_id": 41017553, "comment_id": 69244703, "body": "Does the following reproduce the error:  Call you function <code>SQL_PassThrough &quot;SELECT 1&quot;, &quot;PT_NewNameNotUsedBefore&quot;</code>.  I think the problem is with the method used to detect if an existing query already uses the provided name."}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 3480989, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/38a0c369578ceadf6669af5fca71c5be?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/3480989/mak"}, "edited": false, "score": 0, "creation_date": 1481125723, "post_id": 41018904, "comment_id": 69250502, "body": "I am not ready with my modifications, but I think your thoughts are correct. Without error handler I get exact at this code &quot;IsNull(CurrentDb.QueryDefs(QueryName).Name)&quot; the error and I cannot even skip it with &quot;On error resume next&quot;."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1481117709, "creation_date": 1481117709, "answer_id": 41018904, "question_id": 41017553, "link": "https://stackoverflow.com/questions/41017553/ms-access-2010-pass-through-queries-are-deleted/41018904#41018904", "title": "MS Access 2010: Pass through queries are deleted", "body": "<p>You cannot check for the existence of a query object like this:</p>\n\n<pre><code>IsNull(CurrentDb.QueryDefs(QueryName).Name)\n</code></pre>\n\n<p>It will raise an error at once. You will have to loop the QueryDefs collection to see if the name is present.</p>\n\n<p>But why delete and create the query? Just leave it once created and adjust the SQL before you run it.</p>\n"}, {"tags": [], "owner": {"reputation": 325, "user_id": 3480989, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/38a0c369578ceadf6669af5fca71c5be?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/3480989/mak"}, "is_accepted": false, "score": 0, "last_activity_date": 1481278030, "creation_date": 1481278030, "answer_id": 41057836, "question_id": 41017553, "link": "https://stackoverflow.com/questions/41017553/ms-access-2010-pass-through-queries-are-deleted/41057836#41057836", "title": "MS Access 2010: Pass through queries are deleted", "body": "<p>If someone is interesting, here is my modified function, which hopefully avoids the deletion of the permanent stored queries in my database:</p>\n\n<pre><code>Function SQL_PT(ByVal SQL As String, Optional QueryName As String)  Dim qdf As QueryDef\n\nOn Error GoTo ErrHandler\n\nIf Len(QueryName) = 0 Then 'temp query    \n    Set qdf = CurrentDb.CreateQueryDef(\"\")\n    With qdf\n        .Connect = TempVars!ConnectionString\n        .SQL = SQL\n        .ReturnsRecords = False  \n        .Execute\n    End With\n\nElse  \n    Set qdf = CurrentDb.QueryDefs(QueryName)\n    qdf.SQL = SQL\nEnd If\n\nqdf.Close\nSet qdf = Nothing\n\nExitHere:\n    Exit Function\n\nErrHandler:\nMsgBox Err.Description\n\n    Resume ExitHere\nEnd Function\n</code></pre>\n\n<p>I do not delete and recreate the query anymore, but only modify the SQL of the query.</p>\n\n<p>Michael</p>\n"}], "owner": {"reputation": 325, "user_id": 3480989, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/38a0c369578ceadf6669af5fca71c5be?s=128&d=identicon&r=PG&f=1", "display_name": "mak", "link": "https://stackoverflow.com/users/3480989/mak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594651267, "creation_date": 1481113843, "last_edit_date": 1594651267, "question_id": 41017553, "link": "https://stackoverflow.com/questions/41017553/ms-access-2010-pass-through-queries-are-deleted", "title": "MS Access 2010: Pass through queries are deleted", "body": "<p>I use PT queries to get data from SQL Server 2008R2.\nThe query with ODBC connection string is stored in MS Access Client and gets the variable SQL-string from this function, which I found Long time ago in the web:</p>\n\n<pre><code>'If QueryName is not provided or is an empty string ( = \"\" ) no query object will be created but the SQL statement or stored procedure will be executed (useful for DELETE, INSERT, UPDATE statements).\n'If you provide the parameter QueryName a query will be created with the provided name (this is useful for a SELECT statement as you expect to retrieve the resulting data set).\nFunction SQL_PassThrough(ByVal SQL As String, Optional QueryName As String)\n    Dim qdf As QueryDef\nOn Error GoTo ErrHandler\n    Set qdf = CurrentDb.CreateQueryDef\n    With qdf\n        .Name = QueryName\n                .Connect = TempVars!ConnectionString\n        .SQL = SQL\n        .ReturnsRecords = (Len(QueryName) &gt; 0)\n        If .ReturnsRecords = False Then\n           .Execute\n        Else\n            If Not IsNull(CurrentDb.QueryDefs(QueryName).Name) Then\n                CurrentDb.QueryDefs.Delete QueryName\n            End If\n            CurrentDb.QueryDefs.Append qdf\n        End If\n        .Close\n    End With\n    Set qdf = Nothing\nExitHere:\n    Exit Function\n\nErrHandler:\nMsgBox Err.Description\n\n    Resume ExitHere\nEnd Function\n</code></pre>\n\n<p>TempVars!ConnectionString contains the Connection string, which is stored in a table.</p>\n\n<p>Everything works fine while the SQL-String (e.g. \"EXEC dbo.spLookupSomething\") Returns 0 records.</p>\n\n<p>From time to time - and I cannot find out when or why - the PT query is DELETED at all from the Access objects and not appended anymore.\nI noticed, that the function starts with </p>\n\n<pre><code>Set qdf = CurrentDb.CreateQueryDef\n</code></pre>\n\n<p>although the query with exact this Name is already existing. But in most of the times it works (seems to overwrite the existing query) but sometimes it does not work at all.</p>\n\n<p>I start all my PT queries from code like this:</p>\n\n<pre><code>strsql=\"\"EXEC dbo.spLookupSomething\"\ncall SQL_PassThrough(strsql, \"PT_LookupSomething\")\n</code></pre>\n\n<p>It is even very difficult to reproduce this behaviour. I tried to run the code more times (knowing that it Returns 0 !!), - nothing happens.</p>\n\n<p>But sometime I can see in dev environment of the datebase, that the query disappears at the first run and the code crashed of course.</p>\n\n<p>Any idea, WHY this happens and how to avoid it? It seems that the deletion and the appendage does not work properly all the time.</p>\n\n<p>Thanks \nMichael</p>\n"}, {"tags": ["sql-server", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "edited": false, "score": 0, "creation_date": 1481114037, "post_id": 41017392, "comment_id": 69242159, "body": "will Excel actually see the 1 or 2 though?  I need to continue the SP and say if 1 then do this else do something else"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1481113329, "creation_date": 1481113329, "answer_id": 41017392, "question_id": 41017245, "link": "https://stackoverflow.com/questions/41017245/excel-vba-query-recordset-value-from-sql-sp-type-mismatch-error/41017392#41017392", "title": "Excel VBA query recordset value from SQL SP Type Mismatch error", "body": "<p><code>rs</code> is a recordset object, comparing it to <code>1</code> is not valid, its not the value returned from the procedure.</p>\n\n<p>If 1 or 2 is a value from a <code>SELECT</code> then to read the single value:</p>\n\n<pre><code>if rs.eof then\n   msgbox \"no rows\"\nelse\n   result = rs.collect(0)\n   msgbox result\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7351900"}, "is_accepted": false, "score": 0, "last_activity_date": 1483392058, "creation_date": 1483392058, "answer_id": 41433423, "question_id": 41017245, "link": "https://stackoverflow.com/questions/41017245/excel-vba-query-recordset-value-from-sql-sp-type-mismatch-error/41433423#41433423", "title": "Excel VBA query recordset value from SQL SP Type Mismatch error", "body": "<p>I think doing it like this would be better.</p>\n\n<p>The function inserts SQL Server data to the target Excel range using ADO.</p>\n\n<pre><code>Function ImportSQLtoRange(ByVal conString As String, ByVal query As String, _\n    ByVal target As Range) As Integer\n\n    On Error Resume Next\n\n    ' Object type and CreateObject function are used instead of ADODB.Connection,\n    ' ADODB.Command for late binding without reference to\n    ' Microsoft ActiveX Data Objects 2.x Library\n\n    ' ADO API Reference\n    ' http://msdn.microsoft.com/en-us/library/ms678086(v=VS.85).aspx\n\n    ' Dim con As ADODB.Connection\n    Dim con As Object\n    Set con = CreateObject(\"ADODB.Connection\")\n\n    con.ConnectionString = conString\n\n    ' Dim cmd As ADODB.Command\n    Dim cmd As Object\n    Set cmd = CreateObject(\"ADODB.Command\")\n\n    cmd.CommandText = query\n    cmd.CommandType = 1         ' adCmdText\n\n    ' The Open method doesn't actually establish a connection to the server\n    ' until a Recordset is opened on the Connection object\n    con.Open\n    cmd.ActiveConnection = con\n\n    ' Dim rst As ADODB.Recordset\n    Dim rst As Object\n    Set rst = cmd.Execute\n\n    If rst Is Nothing Then\n        con.Close\n        Set con = Nothing\n\n        ImportSQLtoRange = 1\n        Exit Function\n    End If\n\n    Dim ws As Worksheet\n    Dim col As Integer\n\n    Set ws = target.Worksheet\n\n    ' Column Names\n    For col = 0 To rst.Fields.Count - 1\n        ws.Cells(target.row, target.Column + col).Value = rst.Fields(col).Name\n    Next\n    ws.Range(ws.Cells(target.row, target.Column), _\n        ws.Cells(target.row, target.Column + rst.Fields.Count)).Font.Bold = True\n\n    ' Data from Recordset\n    ws.Cells(target.row + 1, target.Column).CopyFromRecordset rst\n\n    rst.Close\n    con.Close\n\n    Set rst = Nothing\n    Set cmd = Nothing\n    Set con = Nothing\n\n    ImportSQLtoRange = 0\n\nEnd Function\n</code></pre>\n\n<p>Code comments:</p>\n\n<pre><code>The query parameter can contain a SELECT or EXECUTE query.\nThe resulting data will be inserted starting from the top left cell of the target range.\nUsing Object types and the CreateObject function instead of direct use of ADO types\nlets to avoid setting ActiveX Data Objects 2.x Library references on user computers.\nThis code works in Microsoft Excel 2003-2016.\nAlways use Set Nothing statements for ADODB.Connection and ADODB.Recordset objects to free resources.\n</code></pre>\n"}], "owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1483392058, "creation_date": 1481112925, "question_id": 41017245, "link": "https://stackoverflow.com/questions/41017245/excel-vba-query-recordset-value-from-sql-sp-type-mismatch-error", "title": "Excel VBA query recordset value from SQL SP Type Mismatch error", "body": "<p>Using SQL Server 2012 \\ Excel 2010. Excel calls a SQL SP that will return either a 1 or 2 and I then need to perform something else based on that.</p>\n\n<pre><code>Dim con As ADODB.Connection\nDim cmd As ADODB.Command\nDim rs As ADODB.RecordSet\nDim WSP1 As Worksheet\n\nSet con = New ADODB.Connection\nSet cmd = New ADODB.Command\nSet rs = New ADODB.RecordSet\n\n' Log into our SQL Server, and run the Stored Procedure\ncon.Open \"Provider=SQLOLEDB;Data Source=xxxxxxxx;Initial Catalog=xxxxxxx;Integrated Security=SSPI;Trusted_Connection=Yes;\"\ncmd.ActiveConnection = con\n\n' Set up the parameter for our Stored Procedure\n' (Parameter types can be adVarChar,adDate,adInteger)\ncmd.Parameters.Append cmd.CreateParameter(\"User\", adVarChar, adParamInput, 15, Trim(Range(\"C7\").Text))\n\nApplication.StatusBar = \"Running stored procedure...\"\n\ncmd.CommandText = \"usp_GL_Code_Access\"\n\nSet rs = cmd.Execute(, , adCmdStoredProc)\n\nIf rs = 1 Then\n\nMsgBox \"true\"\n\nElse\n\nMsgBox \"false\"\n\nrs.Close\nSet rs = Nothing\nSet cmd = Nothing\n\ncon.Close\nSet con = Nothing\n</code></pre>\n\n<p>At the moment I'm just using the msgbox true\\false to see the value from the rs\\SQL SP, but I keep receiving the error message 'Type Mismatch' and it highlights the </p>\n\n<pre><code>IF rs = 1 Then\n</code></pre>\n\n<p>Line.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1481110908, "post_id": 41016363, "comment_id": 69240186, "body": "This is never a good idea: if you&#39;re new to vba, it&#39;s best if you dont use it: &quot;On Error Resume Next&quot;, it will just hide the (useful) error messages"}, {"owner": {"reputation": 13, "user_id": 7261865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798b7026fe76249ae6faabee216e9931?s=128&d=identicon&r=PG&f=1", "display_name": "liam391", "link": "https://stackoverflow.com/users/7261865/liam391"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1481111081, "post_id": 41016363, "comment_id": 69240302, "body": "Thanks Tom, I&#39;ve removed the line from my code. I&#39;m not actually getting any error however."}, {"owner": {"reputation": 470, "user_id": 2011597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/10vNY.png?s=128&g=1", "display_name": "blackworx", "link": "https://stackoverflow.com/users/2011597/blackworx"}, "edited": false, "score": 0, "creation_date": 1481113497, "post_id": 41016363, "comment_id": 69241817, "body": "If <code>=Code(cellwhichlooksblank)</code> is returning 32, then it&#39;s got a space character in it.  You could try adding a line to replace all cells containing a space with a null string, (i.e. <code>Range.Replace What:=&quot; &quot;, Replacement:=&quot;&quot;, Lookat:=XlWhole</code>) before running the rest of your code.  You may find that you also have to save the workbook after running the replace in order for XL to detect these cells as actually being blank."}, {"owner": {"reputation": 13, "user_id": 7261865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798b7026fe76249ae6faabee216e9931?s=128&d=identicon&r=PG&f=1", "display_name": "liam391", "link": "https://stackoverflow.com/users/7261865/liam391"}, "reply_to_user": {"reputation": 470, "user_id": 2011597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/10vNY.png?s=128&g=1", "display_name": "blackworx", "link": "https://stackoverflow.com/users/2011597/blackworx"}, "edited": false, "score": 0, "creation_date": 1481116163, "post_id": 41016363, "comment_id": 69243681, "body": "@blackworx - thanks for the input; I tried as you suggested (replacing range with my output range), including the save, and XL somehow still considers the cells nonblank?!"}, {"owner": {"reputation": 470, "user_id": 2011597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/10vNY.png?s=128&g=1", "display_name": "blackworx", "link": "https://stackoverflow.com/users/2011597/blackworx"}, "edited": false, "score": 0, "creation_date": 1481139352, "post_id": 41016363, "comment_id": 69258919, "body": "You&#39;re welcome.  Likely it was multiple spaces (e.g. <code>=CODE(A1)</code> would return 32 regardless of how many spaces there were in cell A1). Was going to comment again as I figured this was a distinct possibility but got sidetracked and I see you have solved your problem now anyway."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7261865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798b7026fe76249ae6faabee216e9931?s=128&d=identicon&r=PG&f=1", "display_name": "liam391", "link": "https://stackoverflow.com/users/7261865/liam391"}, "edited": false, "score": 0, "creation_date": 1481116435, "post_id": 41017910, "comment_id": 69243865, "body": "Hello Thomas - thanks but my output range could also have manual input by users so I&#39;d prefer to use the first blank cell in the range rather than going to the end of the list i.e. there may be gaps which need filling."}, {"owner": {"reputation": 13, "user_id": 7261865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798b7026fe76249ae6faabee216e9931?s=128&d=identicon&r=PG&f=1", "display_name": "liam391", "link": "https://stackoverflow.com/users/7261865/liam391"}, "edited": false, "score": 0, "creation_date": 1481120420, "post_id": 41017910, "comment_id": 69246721, "body": "@ Thomas-Inzina - thanks for your update, it has helped me to realise where my newbie error has occurred. My vlookup is finding matches in the first column, then copying the 3rd column of the lookup table. However, sometimes the 3rd column is blank. I thought that using IF Vlookup &gt; 0 within the loop would mean these entries were skipped, but instead a space the size of one character is copied - hence the nonblank issue. How can I avoid this and only copy the cells which contain data? Nest another IF within the loop?"}, {"owner": {"reputation": 13, "user_id": 7261865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798b7026fe76249ae6faabee216e9931?s=128&d=identicon&r=PG&f=1", "display_name": "liam391", "link": "https://stackoverflow.com/users/7261865/liam391"}, "edited": false, "score": 0, "creation_date": 1481121489, "post_id": 41017910, "comment_id": 69247523, "body": "apologies -  I pressed enter by accident and only sent the first part of my reply - it turns out that the strange behavior was due to my mistake after all, as described above. Working on fixing it just now, any suggestions gratefully received!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 13, "user_id": 7261865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798b7026fe76249ae6faabee216e9931?s=128&d=identicon&r=PG&f=1", "display_name": "liam391", "link": "https://stackoverflow.com/users/7261865/liam391"}, "edited": false, "score": 0, "creation_date": 1481122748, "post_id": 41017910, "comment_id": 69248397, "body": "@liam391 I added to my answer."}, {"owner": {"reputation": 13, "user_id": 7261865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798b7026fe76249ae6faabee216e9931?s=128&d=identicon&r=PG&f=1", "display_name": "liam391", "link": "https://stackoverflow.com/users/7261865/liam391"}, "edited": false, "score": 0, "creation_date": 1481124160, "post_id": 41017910, "comment_id": 69249379, "body": "Thank you very much for your time and patience - i was able to use your code example to solve my problem (the cells that I want to copy will always be numbers, so I used: If IsNumeric(value) Then with Sheets(&quot;ISMVer&quot;).... etc)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 13, "user_id": 7261865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798b7026fe76249ae6faabee216e9931?s=128&d=identicon&r=PG&f=1", "display_name": "liam391", "link": "https://stackoverflow.com/users/7261865/liam391"}, "edited": false, "score": 0, "creation_date": 1481135065, "post_id": 41017910, "comment_id": 69256452, "body": "@liam391 Thanks for accepting my answer.  Happy coding :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1481122732, "last_edit_date": 1481122732, "creation_date": 1481114848, "answer_id": 41017910, "question_id": 41016363, "link": "https://stackoverflow.com/questions/41016363/attempt-to-write-vlookup-output-within-for-loop-to-next-blank-cell-in-range-re/41017910#41017910", "title": "Attempt to write vlookup output (within for loop) to next blank cell in range results in gaps due to non-blank cells", "body": "<p><code>SpecialCells(xlCellTypeBlanks)</code> finds an empty cell in a contiguous block of cells. It will fail if there are no blank cells in the range</p>\n\n<p><code>Range(\"B2:B\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row</code> </p>\n\n<p>This is the most popular pattern to return the next empty cell in a list</p>\n\n<p><code>Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/0WO5J.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0WO5J.gif\" alt=\"enter image description here\"></a></p>\n\n<h2>UPDATE</h2>\n\n<p>This will find the first empty cell in column B after B1</p>\n\n<blockquote>\n  <p>Range(\"B:B\").Find(What:=\"*\",After:=Range(\"B1\"), SearchDirection:=xlNext)</p>\n</blockquote>\n\n<hr>\n\n<p>Remove <code>On Error Resume Next</code>. Create a variable to hold the VLookup's value and set a breakpoint.  Run the code and check the value of the variable under different scenarios.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yatf1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yatf1.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>For Each cell In Sheets(\"Verification\").Range(\"B2:B\" &amp; lr)\n    Value = Application.VLookup(cell, lookupWS.Range(\"B3:D\" &amp; Counter), 3, False)\n\n    If Value Then\n        With Sheets(\"ISMVer\").Range(\"B:B\").Find(What:=\"*\", After:=Range(\"B1\"), SearchDirection:=xlNext)\n            .Value = Application.VLookup(cell, lookupWS.Range(\"B3:D\" &amp; Counter), 3, False)\n        End With\n    End If\n\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7261865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798b7026fe76249ae6faabee216e9931?s=128&d=identicon&r=PG&f=1", "display_name": "liam391", "link": "https://stackoverflow.com/users/7261865/liam391"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 41017910, "answer_count": 1, "score": 1, "last_activity_date": 1481122732, "creation_date": 1481110304, "last_edit_date": 1531164843, "question_id": 41016363, "link": "https://stackoverflow.com/questions/41016363/attempt-to-write-vlookup-output-within-for-loop-to-next-blank-cell-in-range-re", "title": "Attempt to write vlookup output (within for loop) to next blank cell in range results in gaps due to non-blank cells", "body": "<p>this is my first post so please bear with me. I've had a look around for a solution but I'm not sure how to proceed.</p>\n\n<p>I have a vba module which aims to do the following (relevant code at the bottom of the post):</p>\n\n<ul>\n<li>lookup each value in Column 1 of Range A, Worksheet 1 against values in Column 1 of Range B, Worksheet 2</li>\n<li>if a match is found, copy the corresponding value in Column 3 of Range B in Worksheet 2 to the next empty cell in Output Range in Worksheet 3.</li>\n</ul>\n\n<p>The vlookup part of this works fine, but I am having trouble outputting to the next blank row of the output range. It appears that the cells which appear blank are actually not blank. I checked this on the worksheet using the function =code(cellwhichlooksblank), which returned 32. I know I can get around this outside of VBA by referring to cells which = \"\" instead of using Blanks as a cell type, but I don't know how to implement this within my VBA. Any help would be appreciated. I've copied the relevant parts of the code below (I haven't provided all the definitions etc as I didn't think them relevant).</p>\n\n<pre><code>ISMcount = Sheets(\"ISMVer\").Range(\"B2:B\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\n\n    On Error Resume Next\n    For Each cell In Sheets(\"Verification\").Range(\"B2:B\" &amp; lr)\n        If Application.WorksheetFunction.VLookup(cell, lookupWS.Range(\"B3:D\" &amp; counter), 3, False) &gt; 0 Then:\n        Sheets(\"ISMVer\").Range(\"B\" &amp; ISMcount).Value = _\n        Application.WorksheetFunction.VLookup(cell, lookupWS.Range(\"B3:D\" &amp; counter), 3, False)\n        ISMcount = Sheets(\"ISMVer\").Range(\"B2:B\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\n    Next cell\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1481110411, "post_id": 41016318, "comment_id": 69239865, "body": "Maybe you could explain more about how two&#39;s comp works so that we have a better idea of what output you want?"}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1481110534, "post_id": 41016318, "comment_id": 69239952, "body": "Start by enabling the developer mode on Excel. Draw an ActiveX button and insert the code you linked to the button. Try to tweak the code and, if it fails, come here with the code and the tweaks you made."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481112229, "post_id": 41016318, "comment_id": 69241014, "body": "You need to look for the code to loop a range of cells in excel, then pass the cell value into the function in your example."}, {"owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481117417, "post_id": 41016318, "comment_id": 69244579, "body": "Thanks guys, I&#39;ll let you know what I come up with."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481122853, "post_id": 41019494, "comment_id": 69248462, "body": "Hi Comintern, thanks for your answer. I am using a 32-bit version of Excel. The top part of that code however keeps coming up with &quot;Only comments allowed after End Sub&quot;. Either way, being as I am a noob to this, would you just explain a bit more about what is going on here? Thanks."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481123109, "post_id": 41019494, "comment_id": 69248603, "body": "@MattGriffin - The <code>Public Declare</code> bit needs to be at the very top of the module (after <code>Option Explicit</code>).  All it&#39;s doing is copying the exact binary representation of a floating point number (IEEE 754 <code>Single</code>) into a twos complement variable type (<code>Long</code>) without allowing VBA to perform a cast on it.  This gives you access to its the in-memory layout."}, {"owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481124106, "post_id": 41019494, "comment_id": 69249326, "body": "ah ok cool I understand now, thanks! I&#39;m getting an error though that says &quot;Argument not optional&quot; despite not having any optional declarations on the SingleToTwosComp part."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481124408, "post_id": 41019494, "comment_id": 69249570, "body": "@MattGriffin - How are you calling it?  You have to pass it a value."}, {"owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481540518, "post_id": 41019494, "comment_id": 69402837, "body": "Sorry I&#39;ve been away for the last few days. I&#39;m trying to pass it a range of cells from my datasheet so I&#39;m not sure if it&#39;s having an issue with that."}, {"owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481561192, "post_id": 41019494, "comment_id": 69415234, "body": "I&#39;ve managed to get it to loop through my range of cells but it&#39;s not outputting a correct value. For example, if I enter 51234 and convert it to 2&#39;s comp it should come out as -14302, however, the code outputs it as a huge number (<code>1E+09</code>). Any help would be much appreciated."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481561545, "post_id": 41019494, "comment_id": 69415438, "body": "@MattGriffin - Maybe I&#39;m not exactly clear on what you intend to do - almost <i>any</i> floating point number will look be huge if you treat it as twos complement because <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format#IEEE_754_single-precision_binary_floating-point_format:_binary32\" rel=\"nofollow noreferrer\">the exponent is in the high order bytes</a>."}, {"owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481562755, "post_id": 41019494, "comment_id": 69416127, "body": "I intend on converting a decimal number to two&#39;s comp, to then multiply it, so I can convert it to an angle (e.g. 90 degrees)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1481563096, "post_id": 41019494, "comment_id": 69416295, "body": "@MattGriffin - That basically just restating &quot;convert decimal numbers from a range of cells into two&#39;s comp (using 16 bit binary) so that I can multiply this by a scaling factor&quot; from the question. By &quot;multiply it&quot;, do you mean &quot;change the exponent bits&quot;?"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1506030152, "last_edit_date": 1506030152, "creation_date": 1481119569, "answer_id": 41019494, "question_id": 41016318, "link": "https://stackoverflow.com/questions/41016318/convert-a-range-of-cells-from-decimal-to-twos-comp/41019494#41019494", "title": "Convert a range of cells from Decimal to Two&#39;s Comp", "body": "<p>Floating point types are <em>already</em> stored as IEEE 754 internally, so there isn't any reason to re-convert them using VBA - just copy them directly from memory to a non-floating point type with the same width.  Note that VBA doesn't have a native 16 bit float type - the shortest is the 32 bit <code>Single</code>.  This will copy a <code>Single</code> into a <code>Long</code> (which has a twos complement layout):</p>\n\n<pre><code>'In a module\nPublic Declare PtrSafe Sub CopyMemory Lib \"kernel32\" Alias _\n    \"RtlMoveMemory\" (ByVal Destination As LongPtr, ByVal Source As LongPtr, _\n    ByVal length As Long)\n\nPublic Function SingleToTwosComplement(data As Single) As Long\n    Dim retVal As Long\n    CopyMemory VarPtr(retVal), VarPtr(data), LenB(retVal)\n    SingleToTwosComplement = retVal\nEnd Function\n</code></pre>\n\n<p>If you're using a 64 bit version of Office, you can do the same thing with a <code>Double</code> into a <code>LongLong</code>:</p>\n\n<pre><code>'64 bit VBA only.\nPublic Function DoubleToTwosComplement(data As Double) As LongLong\n    Dim retVal As LongLong\n    CopyMemory VarPtr(retVal), VarPtr(data), LenB(retVal)\n    DoubleToTwosComplement = retVal\nEnd Function\n</code></pre>\n\n<p>On 32 bit Office, you'd need to copy it into a pair of Longs or some other structure that was 64 bits wide.</p>\n\n<p>Use it like this:</p>\n\n<pre><code>Public Sub Usage()\n    Dim foo As Single\n    foo = 3.14159265359\n    Debug.Print SingleToTwosComplement(foo)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506030152, "creation_date": 1481110189, "question_id": 41016318, "link": "https://stackoverflow.com/questions/41016318/convert-a-range-of-cells-from-decimal-to-twos-comp", "title": "Convert a range of cells from Decimal to Two&#39;s Comp", "body": "<p>I'm currently creating a tool and teaching myself excel vba at the same time. I'm not a programmer but for the purpose of this task I am.</p>\n\n<p>I'm trying to convert decimal numbers from a range of cells into two's comp (using 16 bit binary) so that I can multiply this by a scaling factor. I've seen several pieces of code around the net on how to do this for singular values and cells but nothing on a range.</p>\n\n<p><a href=\"http://dailydoseofexcel.com/archives/2005/12/02/decimal-to-binary/\" rel=\"nofollow noreferrer\">Here</a> is a link to a page I found rather useful but I'm still unsure of how to code it or even how it works. </p>\n\n<p>Apologies for a bit of a noob style question and I usually post what I have tried (if needed), but I honestly do not know where to start with this. Any help would be much appreciated.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "edited": false, "score": 0, "creation_date": 1481108848, "post_id": 41015735, "comment_id": 69238903, "body": "what you mean by block ?"}, {"owner": {"reputation": 470, "user_id": 2011597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/10vNY.png?s=128&g=1", "display_name": "blackworx", "link": "https://stackoverflow.com/users/2011597/blackworx"}, "edited": false, "score": 0, "creation_date": 1481114238, "post_id": 41015735, "comment_id": 69242306, "body": "Unless the code is somehow saved in your default workbook template, or there&#39;s something you&#39;ve omitted from your question, it shouldn&#39;t cause the behaviour you describe."}, {"owner": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "edited": false, "score": 0, "creation_date": 1481116136, "post_id": 41015735, "comment_id": 69243665, "body": "Why don&#39;t you protect the worksheet and select to tick everything Insert Columns/Rows and Delete Columns/Rows. If you want to reverse this simply too for now, just change all those False values to True, save and reopen the workbook."}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "edited": false, "score": 0, "creation_date": 1481181313, "post_id": 41015735, "comment_id": 69274879, "body": "Most probably it changed the default template. did you try setting those properties to true?   AllowInsertingRows:=true, _  AllowDeletingColumns:=true, _  AllowDeletingRows:=true"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1481188297, "post_id": 41015735, "comment_id": 69278460, "body": "Hi, yes i have made it with true, run it, close open, but it just doesn&#39;t work. Its just stupid. The protect worksheet with selection of block columns/rows  insertion/delete turned on didn&#39;t work before macro."}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481181077, "creation_date": 1481108509, "last_edit_date": 1531161705, "question_id": 41015735, "link": "https://stackoverflow.com/questions/41015735/block-insert-delete-rows-on-excel", "title": "Block insert/delete rows on excel", "body": "<p>I made a file with the following code</p>\n\n<pre><code>Private Sub Workbook_Open() \n    With Worksheets(\"Sheet1\") \n        .Protect AllowInsertingColumns:=False, _ \n        AllowInsertingRows:=False, _ \n        AllowDeletingColumns:=False, _ \n        AllowDeletingRows:=False \n    End With \nEnd Sub \n</code></pre>\n\n<p>Now all the excel files have the block for insert/delete no mater the extension (xlsm,xls etc) . I have restarted the PC but the problem is always there. Every new excel has blocked insert/delete rows/columns and the first sheet is protected. Any help is welcomed. Thank you.  </p>\n"}, {"tags": ["vba", "excel", "collections"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 2, "creation_date": 1481107979, "post_id": 41015470, "comment_id": 69238299, "body": "What usually happens why you try to <code>debug.print</code> a range object?"}, {"owner": {"reputation": 69, "user_id": 6005884, "user_type": "registered", "profile_image": "https://graph.facebook.com/442462715949746/picture?type=large", "display_name": "Hu\u1ef3nh T&#249;ng", "link": "https://stackoverflow.com/users/6005884/hu%e1%bb%b3nh-t%c3%b9ng"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1481108306, "post_id": 41015470, "comment_id": 69238555, "body": "@CallumDA33 It is Run-time error &#39;13&#39;: Type mismatch."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 6005884, "user_type": "registered", "profile_image": "https://graph.facebook.com/442462715949746/picture?type=large", "display_name": "Hu\u1ef3nh T&#249;ng", "link": "https://stackoverflow.com/users/6005884/hu%e1%bb%b3nh-t%c3%b9ng"}, "edited": false, "score": 0, "creation_date": 1481109123, "post_id": 41015770, "comment_id": 69239080, "body": "Yes, What I am trying to do is print a range of at least 2 cells into another cell after store it by a collection. Because I want to do something with the data in the collection. Your code just print the cell A1 so It is not what I need. Do you have any other idea? Thanks for your help."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 69, "user_id": 6005884, "user_type": "registered", "profile_image": "https://graph.facebook.com/442462715949746/picture?type=large", "display_name": "Hu\u1ef3nh T&#249;ng", "link": "https://stackoverflow.com/users/6005884/hu%e1%bb%b3nh-t%c3%b9ng"}, "edited": false, "score": 0, "creation_date": 1481111558, "post_id": 41015770, "comment_id": 69240593, "body": "Can you give screenshot with an example. With some expectred input and output?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1481108636, "creation_date": 1481108636, "answer_id": 41015770, "question_id": 41015470, "link": "https://stackoverflow.com/questions/41015470/how-to-call-each-item-of-a-collection/41015770#41015770", "title": "How to call each item of a collection", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n    Dim i                   As Long\n    Dim lastRowIndex        As Long\n    Dim PGname              As Object\n    Dim HScode              As Object\n\n    lastRowIndex = 10\n\n    Set PGname = New Collection\n    Set HScode = New Collection\n    For i = 1 To lastRowIndex\n        PGname.Add Range((Cells(i, 1)), (Cells(i, 2)))\n        HScode.Add (Cells(i, 2))\n    Next i\n    Debug.Print PGname.Item(1).Address\n    Debug.Print PGname.Item(1)(1)(1) 'this would print you cell A1\n\nEnd Sub\n</code></pre>\n\n<p>You get an error, because you were trying to print a range of more than once cell. \nTake a look at the two debug.prints. Put some value in A1 to make sure what it prints.</p>\n"}], "owner": {"reputation": 69, "user_id": 6005884, "user_type": "registered", "profile_image": "https://graph.facebook.com/442462715949746/picture?type=large", "display_name": "Hu\u1ef3nh T&#249;ng", "link": "https://stackoverflow.com/users/6005884/hu%e1%bb%b3nh-t%c3%b9ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7042, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1608649310, "creation_date": 1481107784, "last_edit_date": 1598188481, "question_id": 41015470, "link": "https://stackoverflow.com/questions/41015470/how-to-call-each-item-of-a-collection", "title": "How to call each item of a collection", "body": "<p>I managed to store a range of cells to a collection.</p>\n<p>I am trying to use each item of the collection.</p>\n<p>I failed to call it by using <code>Collection.Item</code> and <code>debug.Print</code> to show it in the Immediate window.</p>\n<p>This works if I store only one cell into the collection.</p>\n<pre><code>lastRowIndex = Cells(Rows.Count, 1).End(xlUp).Row\nSet PGname = New Collection\nSet HScode = New Collection\nFor i = 1 To lastRowIndex\n    PGname.Add Range((Cells(i, 1)), (Cells(i, 2)))\n    HScode.Add (Cells(i, 2))\nNext i\nDebug.Print PGname.Item(1)  'this does not work\nDebug.Print HScode.Item(1)  'this works\n</code></pre>\n"}, {"tags": ["vba", "excel", "directory"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481107934, "post_id": 41015127, "comment_id": 69238266, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/aa242714(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa242714(v=vs.60).aspx</a> and <a href=\"https://msdn.microsoft.com/en-us/library/aa711216(v=vs.71).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa711216(v=vs.71).aspx</a> should help"}], "answers": [{"tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 0, "last_activity_date": 1481110891, "creation_date": 1481110891, "answer_id": 41016551, "question_id": 41015127, "link": "https://stackoverflow.com/questions/41015127/excel-vba-select-multiple-folders/41016551#41016551", "title": "Excel VBA: Select multiple folders", "body": "<p>I think I come up with some better solution than manually selecting all the folders. You said that all of your files are in some directory, which have some subfolders inside. With below code, you will loop through every file in folder you pick. You will store every formating logics in Formatting sub. </p>\n\n<pre><code>Sub Button1_Click()\nDim objFolder As Object\nDim objFile As Object\nDim objFSO As Object\nDim MyPath As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n    Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n        .Title = \"Select A Target Folder\"\n        .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        MyPath = .SelectedItems(1)\n    End With\n\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Call GetAllFiles(MyPath, objFSO)\n    Call GetAllFolders(MyPath, objFSO)\n\n  MsgBox \"Complete.\"\n\nNextCode:\nEnd Sub\nSub GetAllFiles(ByVal strPath As String, ByRef objFSO As Object)\nDim objFolder As Object\nDim objFile As Object\n\n    Set objFolder = objFSO.GetFolder(strPath)\n    For Each objFile In objFolder.Files\n            Formatting (objFile.Path)\n    Next objFile\nEnd Sub\n\nSub GetAllFolders(ByVal strFolder As String, ByRef objFSO As Object)\nDim objFolder As Object\nDim objSubFolder As Object\n\n    Set objFolder = objFSO.GetFolder(strFolder)\n    For Each objSubFolder In objFolder.subfolders\n        Call GetAllFiles(objSubFolder.Path, objFSO)\n        Call GetAllFolders(objSubFolder.Path, objFSO)\n    Next objSubFolder\nEnd Sub\n\nSub Formatting(strFile As String)\nDim wb As Workbook\n    If Right(strFile, 3) = \"xls\" Then\n        Set wb = Workbooks.Open(Filename:=MyPath &amp; myFile)\n        DoEvents\n\n        'Formatting adjustments etc go here\n\n        wb.Close SaveChanges:=True\n        DoEvents\n        myFile = Dir\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1481293584, "creation_date": 1481293584, "answer_id": 41062587, "question_id": 41015127, "link": "https://stackoverflow.com/questions/41015127/excel-vba-select-multiple-folders/41062587#41062587", "title": "Excel VBA: Select multiple folders", "body": "<p>How about this concept?  You recursively map to all files in all folders, and create a schema of your whole folder structure.  Then, control each file, based on each folder path.</p>\n\n<pre><code>Option Explicit\n\nSub ListAllFiles()\n        searchForFiles \"C:\\your_path_here\\\", \"writefilestosheet\", \"*.*\", True, True\n    End Sub\n\n    Sub processOneFile(ByVal aFilename As String)\n        Debug.Print aFilename\n    End Sub\n\n    Sub writeFilesToSheet(ByVal aFilename As String)\n        With ActiveSheet\n        .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Value = aFilename\n            End With\n    End Sub\n\n\n    Private Sub processFiles(ByVal DirToSearch As String, _\n                ByVal ProcToCall As String, _\n                ByVal FileTypeToFind As String)\n            Dim aFile As String\n            aFile = Dir(DirToSearch &amp; FileTypeToFind)\n            Do While aFile &lt;&gt; \"\"\n                Application.Run ProcToCall, DirToSearch &amp; aFile\n                aFile = Dir()\n                Loop\n    End Sub\n\n    Private Sub processSubFolders(ByVal DirToSearch As String, _\n                ByVal ProcToCall As String, _\n                ByVal FileTypeToFind As String, _\n                ByVal SearchSubDir As Boolean, _\n                ByVal FilesFirst As Boolean)\n\n    Dim aFolder As String, SubFolders() As String\n\n    ReDim SubFolders(0)\n\n    aFolder = Dir(DirToSearch, vbDirectory)\n\n        Do While aFolder &lt;&gt; \"\"\n\n            If aFolder &lt;&gt; \".\" And aFolder &lt;&gt; \"..\" Then\n\n                If (GetAttr(DirToSearch &amp; aFolder) And vbDirectory) _\n                        = vbDirectory Then\n                    SubFolders(UBound(SubFolders)) = aFolder\n                    ReDim Preserve SubFolders(UBound(SubFolders) + 1)\n                    End If\n                    End If\n                aFolder = Dir()\n                Loop\n\n            If UBound(SubFolders) &lt;&gt; LBound(SubFolders) Then\n                Dim i As Long\n                For i = LBound(SubFolders) To UBound(SubFolders) - 1\n                    searchForFiles _\n                        DirToSearch &amp; SubFolders(i), _\n                        ProcToCall, FileTypeToFind, SearchSubDir, FilesFirst\n                    Next i\n                End If\n\n        End Sub\n\n    Sub searchForFiles(ByVal DirToSearch As String, ByVal ProcToCall As String, _\n            Optional ByVal FileTypeToFind As String = \"*.*\", _\n            Optional ByVal SearchSubDir As Boolean = False, _\n            Optional ByVal FilesFirst As Boolean = False)\n        On Error GoTo ErrXIT\n        If Right(DirToSearch, 1) &lt;&gt; Application.PathSeparator Then _\n            DirToSearch = DirToSearch &amp; Application.PathSeparator\n\n    If FilesFirst Then processFiles DirToSearch, ProcToCall, FileTypeToFind\n    If SearchSubDir Then processSubFolders DirToSearch, ProcToCall, _\n        FileTypeToFind, SearchSubDir, FilesFirst\n\n        If Not FilesFirst Then _\n            processFiles DirToSearch, ProcToCall, FileTypeToFind\n        Exit Sub\n    ErrXIT:\n        MsgBox \"Fatal error: \" &amp; Err.Description &amp; \" (Code=\" &amp; Err.Number &amp; \")\"\n        Exit Sub\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7261606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bq1IM.jpg?s=128&g=1", "display_name": "bobsmith", "link": "https://stackoverflow.com/users/7261606/bobsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2244, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1481293584, "creation_date": 1481106836, "question_id": 41015127, "link": "https://stackoverflow.com/questions/41015127/excel-vba-select-multiple-folders", "title": "Excel VBA: Select multiple folders", "body": "<p>I currently have a macro that checks a folder for excel files and runs a few formatting type adjustments (adds columns etc).</p>\n\n<p>The problem is that it will only allow me to select one folder and check in there. There are lots of folders that I need it to check in which all exist within the same directory.</p>\n\n<p>I cannot select more than one folder to check in, even by adjusting the AllowMultiSelect to True. How can I modify this code so that it will allow me to select all folders within a directory?</p>\n\n<pre><code>Sub Button1_Click()\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n  NextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n  myExtension = \"*.xls\"\n\n  myFile = Dir(myPath &amp; myExtension)\n\n  Do While myFile &lt;&gt; \"\"\n      Set wb = Workbooks.Open(fileName:=myPath &amp; myFile)\n\n      DoEvents\n\n        'Formatting adjustments etc go here\n\n      wb.Close SaveChanges:=True\n\n      DoEvents\n\n      myFile = Dir\n\n  Loop\n\n  MsgBox \"Complete.\"\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "datatables"], "comments": [{"owner": {"reputation": 365, "user_id": 4890963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-736h1CBQBh8/AAAAAAAAAAI/AAAAAAAABbc/4ybXk5rbcb4/photo.jpg?sz=128", "display_name": "CyberClaw", "link": "https://stackoverflow.com/users/4890963/cyberclaw"}, "edited": false, "score": 2, "creation_date": 1481106783, "post_id": 41015049, "comment_id": 69237445, "body": "This site is not about finding other programmers to do the work for you. Taken from the <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a> -&gt; &quot;Focus on questions about an actual problem you have faced. Include details about what you have tried and exactly what you are trying to do.&quot; (...) &quot;Don&#39;t ask about... Questions you haven&#39;t tried to find an answer for (show your work!)&quot;"}, {"owner": {"reputation": 15, "user_id": 7161296, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ntcc9Ge1Lq0/AAAAAAAAAAI/AAAAAAAABHo/PDgAJ9_exnQ/photo.jpg?sz=128", "display_name": "Tiago Faria", "link": "https://stackoverflow.com/users/7161296/tiago-faria"}, "reply_to_user": {"reputation": 365, "user_id": 4890963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-736h1CBQBh8/AAAAAAAAAAI/AAAAAAAABbc/4ybXk5rbcb4/photo.jpg?sz=128", "display_name": "CyberClaw", "link": "https://stackoverflow.com/users/4890963/cyberclaw"}, "edited": false, "score": 0, "creation_date": 1481119492, "post_id": 41015049, "comment_id": 69246082, "body": "You&#39;re are right. I totally forgot of putting the code I was using. I already update"}, {"owner": {"reputation": 305, "user_id": 6435422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebd2c80f456dc3596617b2d8505f70b?s=128&d=identicon&r=PG&f=1", "display_name": "Lybren", "link": "https://stackoverflow.com/users/6435422/lybren"}, "edited": false, "score": 0, "creation_date": 1481220543, "post_id": 41015049, "comment_id": 69299713, "body": "There are plenty of threads where you can get examples of recursively drill down directories here in SO."}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 6435422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebd2c80f456dc3596617b2d8505f70b?s=128&d=identicon&r=PG&f=1", "display_name": "Lybren", "link": "https://stackoverflow.com/users/6435422/lybren"}, "is_accepted": true, "score": 1, "last_activity_date": 1481221149, "last_edit_date": 1495541633, "creation_date": 1481221149, "answer_id": 41046232, "question_id": 41015049, "link": "https://stackoverflow.com/questions/41015049/access-vba-import-specific-excel-files-from-different-subfolders/41046232#41046232", "title": "Access VBA Import Specific Excel Files from different subfolders", "body": "<pre><code>Dim FileSystem As Object\nDim HostFolder As String\n\nHostFolder = MyPath\n\nSet FileSystem = CreateObject(\"Scripting.FileSystemObject\")\nDoFolder FileSystem.GetFolder(HostFolder)\n\nSub DoFolder(Folder)\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        Dim File\n        For Each File In Folder.Files\n            ' Operate on each file\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Code credit to <a href=\"https://stackoverflow.com/users/1031929/rich\">Rich,</a> rearranged code so it doesn't recursively iterate all subfolders, just the subfolders of <code>MyPath</code></p>\n"}], "owner": {"reputation": 15, "user_id": 7161296, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ntcc9Ge1Lq0/AAAAAAAAAAI/AAAAAAAABHo/PDgAJ9_exnQ/photo.jpg?sz=128", "display_name": "Tiago Faria", "link": "https://stackoverflow.com/users/7161296/tiago-faria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "accepted_answer_id": 41046232, "answer_count": 1, "score": 0, "last_activity_date": 1481221149, "creation_date": 1481106595, "last_edit_date": 1481119461, "question_id": 41015049, "link": "https://stackoverflow.com/questions/41015049/access-vba-import-specific-excel-files-from-different-subfolders", "title": "Access VBA Import Specific Excel Files from different subfolders", "body": "<p>I have a problem that I can't find the right code to do it. </p>\n\n<p>So I have a Main Folder (C:\\Products) with multiple subfolders that correspond to different the products (C:\\Products\\Chocolates , C:\\Products\\Milk and many more). \nEach subfolder have many excel files but I just want to import the one that is named sells.xlxs. Each subfolder have a sells.xlxs and I Want to import all sells.xlxs to an access Database.</p>\n\n<p>EDIT: Sorry I didn't Upload the code I was using:</p>\n\n<pre><code>Sub Insert2()\n  Const cstrSheetName As String = \"Weekly\"\n  Dim strDir As String\n  Dim strFile As String\n  Dim strTableName As String\n  Dim MyPath As String\n  Dim i As Long\n\n  i = 0\n   MyPath = \"C:\\Products\"\n   strTableName = \"Sells\"\n  If Left(MyPath, 1) &lt;&gt; \"\\\" Then\n   strDir = MyPath &amp; \"\\\"\n  Else\n   strDir = MyPath\n End If\n   strFile = Dir(MyPath &amp; \"\\Sells.XLSX\")\nWhile strFile &lt;&gt; \"\"\n i = i + 1\n strFile = strDir &amp; strFile\n Debug.Print \"importing \" &amp; strFile\n\n     DoCmd.TransferSpreadsheet _\n    TransferType:=acImport, _\n    SpreadsheetType:=acSpreadsheetTypeExcel9, _\n     TableName:=strTableName, _\n    FileName:=strFile, _\n    HasFieldNames:=True, _\n    Range:=cstrSheetName &amp; \"$\"\n\n  strFile = Dir()\n\n Wend\n  End Sub\n</code></pre>\n\n<p>Do you think you can help me?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "excel", "svg", "icons"], "comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 1, "creation_date": 1481109677, "post_id": 41015029, "comment_id": 69239412, "body": "They are probably embedded in the <code>.exe</code> or some other resource file. You could try something like <a href=\"http://www.howtogeek.com/109347/extract-high-quality-icons-from-files-using-a-free-tool/\" rel=\"nofollow noreferrer\">this</a>?"}, {"owner": {"reputation": 520, "user_id": 1138354, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/o5MXC.png?s=128&g=1", "display_name": "spences10", "link": "https://stackoverflow.com/users/1138354/spences10"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1481110574, "post_id": 41015029, "comment_id": 69239976, "body": "@Vegard thank you, if no one else can answer in a way I can do it via VBA then I guess you could answer with this and I&#39;ll accept it. Thanks :)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481125216, "post_id": 41015029, "comment_id": 69250156, "body": "This is possible via some Windows APIs, but would be a serious PITA because you either need to hard code the file paths or <a href=\"http://stackoverflow.com/a/40962539/4088852\">find</a> where they are installed on the machine.  There are examples <a href=\"http://www.vbforums.com/showthread.php?637452-vb6-Icon-Handle-to-File-Array\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://www.jasinskionline.com/windowsapi/ref/e/extracticon.html\" rel=\"nofollow noreferrer\">here</a>. The first 3 icons live in vbe7.dll, and the 4th in excel.exe. No clue where the last one is loaded from.  I&#39;d suspect one of the shared office dlls."}], "answers": [{"tags": [], "owner": {"reputation": 520, "user_id": 1138354, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/o5MXC.png?s=128&g=1", "display_name": "spences10", "link": "https://stackoverflow.com/users/1138354/spences10"}, "is_accepted": true, "score": 0, "last_activity_date": 1483004557, "creation_date": 1483004557, "answer_id": 41376983, "question_id": 41015029, "link": "https://stackoverflow.com/questions/41015029/vba-ide-icons-svg-ico/41376983#41376983", "title": "VBA IDE Icons *.svg *.ico", "body": "<p>I used the BeCyIconGrabber as detailed in the comment from @Vegard from <a href=\"http://www.howtogeek.com/109347/extract-high-quality-icons-from-files-using-a-free-tool/\" rel=\"nofollow noreferrer\">How to Geek</a></p>\n\n<p>Still took a while to find what I was after, I also found <a href=\"http://soltechs.net/customui/imageMso01.asp?gal=4&amp;count=no\" rel=\"nofollow noreferrer\">this</a> which has some of the icons I was after.</p>\n"}], "owner": {"reputation": 520, "user_id": 1138354, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/o5MXC.png?s=128&g=1", "display_name": "spences10", "link": "https://stackoverflow.com/users/1138354/spences10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 41376983, "answer_count": 1, "score": 1, "last_activity_date": 1483004557, "creation_date": 1481106545, "question_id": 41015029, "link": "https://stackoverflow.com/questions/41015029/vba-ide-icons-svg-ico", "title": "VBA IDE Icons *.svg *.ico", "body": "<p>Can someone please tell me how I can get the VBA IDE icons <strong>files</strong> [pictured]</p>\n\n<p><a href=\"https://i.stack.imgur.com/HapVI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HapVI.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have spent the last several hours trying to find a way to expose them via <code>FaceId</code> all the links I have found are either for making a ribbon or a form with the faces on there I just want the files.</p>\n\n<p>Google wasn't my friend this time, even with the advanced search tools where you can specify the type as an icon </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1481106816, "post_id": 41014916, "comment_id": 69237470, "body": "Could this refer to a missing reference?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1481112250, "post_id": 41014916, "comment_id": 69241029, "body": "I would think a missing reference would affect the process every time I run it, but as I wrote, even when the error is present, it will run one report but not another."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1481117935, "post_id": 41014916, "comment_id": 69244997, "body": "Is <code>rptname</code> a string variable? Without been able to see the rest of the code, I am wondering if this variable or the <code>strWhere</code> string is sometimes incorrectly produced."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1481119437, "post_id": 41014916, "comment_id": 69246048, "body": "Yes. These are both strings. I added the full code... my browser is currently not displaying the formatting options of SO, so the formatting is crap. sorry. will fix asap."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1481228240, "post_id": 41014916, "comment_id": 69303648, "body": "Can you post the results of your strWhere clause on the next runtime error? is it possible you have an odd ISIN value or your string has an odd character in the cases where it fails?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1481269421, "post_id": 41014916, "comment_id": 69317607, "body": "@dbmitch good idea. i&#39;ll check for that and post back the next time it occurrs."}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 739, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481119450, "creation_date": 1481106242, "last_edit_date": 1481119450, "question_id": 41014916, "link": "https://stackoverflow.com/questions/41014916/ms-access-db-produces-run-time-error-2473-inconsistently", "title": "MS Access DB produces run time error 2473 inconsistently", "body": "<p>An Access DB I designed produces the run time error 2473 stating \"Object or class does not support the set of events\". The error is produced inconsistently, which makes it very hard for me to track it down.</p>\n\n<p>The debugger stops on the following line of code when it appears:</p>\n\n<pre><code>'Open report containing code to create TOC with list of ISINs from above\nDoCmd.OpenReport rptName, acViewPreview, , strWhere\n</code></pre>\n\n<p>Even when the error occurs, this code works fine for some reports, but produces the run time error for others. After opening up the report and the underlying queries in design mode, the run time error sometimes disappears, even though I have changed absolutely nothing in the code, the forms, or even updated the underlying data.</p>\n\n<p>In an attempt to get at this problem, I have <strong>restored my DB</strong> to an earlier version where I know the problem still existed, but <strong>upon opening up the restored version, it no longer has a run time error either!</strong></p>\n\n<p><strong>What could cause this behavior?</strong></p>\n\n<p>UPDATE:\nFull code as contained in the Form</p>\n\n<pre><code>Sub cmdFundSelectionReport_Click()\n'Gather selected ISIN and pass it to Fund Selection Report\nDim var As Variant\nDim sFund As String\nDim strWhere As String\nDim lst As Access.ListBox\nDim i As Integer\nDim rptType As Integer\n\n'Create list of isin to send to report\nSet lst = Me.libFilterSelection\nrptType = Me.cmbReportType\n\nDim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nFor i = 0 To lst.ListCount - 1\n    If Not dict.Exists(lst.Column(1, i)) Then\n        dict.Add lst.Column(1, i), i\n    End If\nNext i\n\nDim a As Variant\na = dict.keys\n\nstrWhere = \"[ISIN] IN(\"\nFor i = 0 To dict.Count - 1\n    strWhere = strWhere &amp; \"\"\"\" &amp; a(i) &amp; \"\"\",\"\nNext i\nstrWhere = Left(strWhere, Len(strWhere) - 1)\nstrWhere = strWhere &amp; \")\"\n\n'Set dictionary back\nSet dict = Nothing\n\nDim rptName As String\nSelect Case rptType\nCase 2\n    rptName = \"rptRDRSelectionList\" '2 is the RDR List\n    'strWhere = strWhere &amp; \" AND Fund_Selection=2\"\nCase 3\n    rptName = \"rptAsiaSelectionList\" '3 Asia\n    'strWhere = strWhere &amp; \" AND Fund_Selection=3\"\nCase Else\n    rptName = \"rptFundSelectionList\" '0 = Fund Selection\n    'strWhere = strWhere &amp; \" AND Fund_Selection=0\"\nEnd Select\n\n'Open Report for view\nOpenReport rptName, strWhere\n\n'Write Log\nWritelogMessage Now &amp; \" | User: \" &amp; fncUserName &amp; \" | Report Created | ReportName: \" &amp; rptName\n\nEnd Sub\n\nSub OpenReport(rptName As String, strWhere As String)\n\n'Open report containing code to create TOC with list of ISINs from above\nDoCmd.OpenReport rptName, acViewPreview, , strWhere\n\n'Click through report so that TOC code is executed\nDim rptCurReport As Report\nSet rptCurReport = Screen.ActiveReport\n\nWith rptCurReport\n    Application.DoCmd.SelectObject acReport, .Name\n    .Visible = True 'switch to false once code is ok\n    'Go through all pages\n    SendKeys \"{End}\", True\n    DoEvents\n    Application.DoCmd.SelectObject acReport, .Name\n    DoCmd.Close acReport, .Name, acSaveNo\nEnd With\n\nrptName = rptName &amp; \"TOC\" 'Add TOC to get Table of Contents Report\n\n''Check whether \"Internal Use Only Flag\" is set to true or false\n'Dim bInternalUse As Boolean\n'bInternalUse = Me.ckbInternalUse.Value\n'Call modProcess.ChangeReportPicture(\"rptFundSelectionListTOC\", \"picInternalUse\", bInternalUse)\n\n'Open final report that includes the TOC as a subreport with same string of ISIN\nDoCmd.OpenReport rptName, acViewPreview, , strWhere\nSendKeys \"{Home}\", True\nDoEvents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 3, "last_activity_date": 1481106419, "creation_date": 1481106419, "answer_id": 41014976, "question_id": 41014327, "link": "https://stackoverflow.com/questions/41014327/microsoft-excel-vba-run-time-error-5/41014976#41014976", "title": "Microsoft Excel VBA Run Time Error 5", "body": "<p>The SubMatches collection is zero indexed so simply change to:</p>\n\n<pre><code>vText = Trim(M.SubMatches(0))\n</code></pre>\n\n<p>Currently you will only get the first match, if you want them all you need <code>Reg.Global = True</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 7261418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2234ee1e31cad74c6a1d6282b66e06c2?s=128&d=identicon&r=PG&f=1", "display_name": "Niisa", "link": "https://stackoverflow.com/users/7261418/niisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1481106443, "creation_date": 1481104523, "last_edit_date": 1531164843, "question_id": 41014327, "link": "https://stackoverflow.com/questions/41014327/microsoft-excel-vba-run-time-error-5", "title": "Microsoft Excel VBA Run Time Error 5", "body": "<p>I am so new on Excel VBA. I am working on Outlook automation to get data from Outlook email body, generate a report and send out to team. I just started trying out some recipes on getting data from Outlook email body and export to Excel. I tried extracting specific data in the email body to export to Excel sheet, it seems like I kept getting <em>Run Time Error 5</em> running:</p>\n\n<pre><code>vText = Trim(M.SubMatches(1))\n</code></pre>\n\n<p>E.g.</p>\n\n<pre><code>Sub GetData()\n    Dim folders As Outlook.folders\n    Dim folder As Outlook.MAPIFolder\n    Dim iRow As Integer\n    Dim Pst_Folder_Name As String\n    Dim MailboxName As String\n    Dim subFolderName As String\n    Dim xlSheet As Object\n    Dim Reg As Object\n    Dim sText As String\n    Dim vText As Variant\n    Dim M As Object\n    Dim M1 As Object\n\n    MailboxName = \"nms@gmail.com\"\n\n    Pst_Folder_Name = \"My Folders\"\n\n    subFolderName = \"HTD Ticketing System\"\n\n    Set folder = Outlook.Session.folders(MailboxName).folders(Pst_Folder_Name).folders(subFolderName)\n    If folder = \"\" Then\n        MsgBox \"Invalid Data in Input\"\n        GoTo end_lbl1:\n    End If\n\n    Sheets(1).Activate\n\n    For iRow = 1 To folder.Items.Count\n        Sheets(1).Cells(iRow, 1).Select\n\n        sText = folder.Items.Item(iRow).Body\n\n        Set Reg = CreateObject(\"VBScript.RegExp\")\n\n        With Reg\n            .Pattern = \"(http.)\"\n        End With\n\n        If Reg.Test(sText) Then\n            Set M1 = Reg.Execute(sText)\n            For Each M In M1\n                vText = Trim(M.SubMatches(1))\n            Next\n        End If\n\n        Sheets(1).Cells(iRow, 2) = vText\n\n        Set M = Nothing\n        Set M1 = Nothing\n        Set Reg = Nothing\n    Next iRow\n\n    end_lbl1:\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n\n<p>Niisa</p>\n"}, {"tags": ["excel", "image", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1481105657, "post_id": 41013958, "comment_id": 69236669, "body": "They are there to set, not showing in intellisense, I used the following <code>Public Function AlterImage(ByRef img As Image) img.Height = 2 * img.Height End Function</code>  and it worked. Called by <code>AlterImage Me.Image1</code>  Not sure why they don&#39;t show.."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481105905, "post_id": 41013958, "comment_id": 69236835, "body": "If you do the code, <code>Dim I as image, set I=me.image1</code>, the properties are also not there, so I would suggest that its available from Me.Image1 only.  Passing it as a control, gives you these, but you lose the image properties, so I&#39;d say it is a control in the form context, but containing an image, and you&#39;re passing the image, so I think you&#39;ll need to pass the control, and access the image.."}, {"owner": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481106812, "post_id": 41013958, "comment_id": 69237469, "body": "@Nathan_Sav The problem is not the .Height (I can change that by passing it as StdImage) - the problem is the .Top and .Left  Can you give me an code-example for passing the control to the procedure and then accessing the image?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481107168, "post_id": 41013958, "comment_id": 69237710, "body": "Public Function x(i As Control) look at the locals window in the code, the properties of the form objects."}, {"owner": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481107857, "post_id": 41013958, "comment_id": 69238197, "body": "Sorry but I&#39;m not as advanced as you may think so I have to ask more specific: In my <code>Image1_move(...)</code> I  <code>Call zoom(Image1)</code> and then in my <code>public sub zoom(i As Control)</code> I can <code>i.Left = i.Left * 2</code> ? Thanks again :)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "edited": false, "score": 0, "creation_date": 1481108352, "post_id": 41015576, "comment_id": 69238592, "body": "But the code itself is perfectly working in the (Userform1)MouseMove-Event itself - the problem is, that I want do do this with multiple images and therefore want to do it in a procedure in my Module1. How can I pass the Image to the procedure and then be able to change <code>Left</code> and <code>Top</code> ? Furthermore I have a public boolean zoomed which goes to true when the event fired once so this is taken care of (did not include it in my code above to keep it clean)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "edited": false, "score": 0, "creation_date": 1481109818, "post_id": 41015576, "comment_id": 69239505, "body": "@OliverBecker I misunderstood your problem.  I updated my answer."}, {"owner": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "edited": false, "score": 0, "creation_date": 1481111073, "post_id": 41015576, "comment_id": 69240296, "body": "When I pass it as <code>MSForms.Image</code> I can only call functions like <code>.Imageeffect</code>etc when I tried but not even <code>.Width</code> (As stated in my original Post this is possible with <code>As StdPicture</code> - but with no method i can change <code>.Top</code> and <code>.Left</code>)  This is what I want to do, but these propertys seem to be not part of the MSForms.Image class.@"}, {"owner": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "edited": false, "score": 0, "creation_date": 1481114757, "post_id": 41015576, "comment_id": 69242671, "body": "This is exactly what I searched for! Will try it as soon as I come home - Thank you very much for the work you put in this answer especially for the pics and the gif! Now - I searched like you did in the object explorer but do you have a hint how I can get a list of all &quot;Actions&quot; I can do with my Image1 to find the connection to MSForms.Control myself the next time when I have a similar case (Instead of searching for &#39;.Top&#39; and finding a mass of classes(Shape/ShapeRange/Object/Control....) who use it trying to guess which one I have to pass?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "edited": false, "score": 0, "creation_date": 1481115155, "post_id": 41015576, "comment_id": 69242957, "body": "@OliverBecker all the <code>MsForms.Controls</code> return a  <code>MsForms.Control</code> object as their default value.  This means you can use all the <code>MsForms.Control</code> properties as well as the control specific properties.  I have images of the properties in my answer."}, {"owner": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "edited": false, "score": 0, "creation_date": 1481116650, "post_id": 41015576, "comment_id": 69244010, "body": "Yes and your Images are great - my question now is more unspecific for future reference so I dont have to ask questions like my main question again: If there is a way to see all Members of an specific Object with their parent-class. I did search for Image like you did and from there clicking the Member Picture I came to StdImage and was able to get the Member <code>.Width</code> - but how do I get all the Classes f.e. <code>Image1</code>uses including MSForms.Image, MSForms.Control? Like if it was not for you and Stackoverflow - how could I have found the Connection between my Image1 and the MSForms.Control myself?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "edited": false, "score": 0, "creation_date": 1481121137, "post_id": 41015576, "comment_id": 69247269, "body": "@OliverBecker I think that the easiest approach would be to use a direct reference to the <code>Image</code> control while writing the code and switch to the local variable while testing.  So you will have two <code>With</code> statements: <code>With Userform1.Image1</code> and  <code>With MyImage</code>.  While writing the code use <code>With Userform1.Image1</code> then comment it out and uncomment  <code>With MyImage</code> for testing and deployment.  It&#39;s not the prettiest solution by it works."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1481113510, "last_edit_date": 1481113510, "creation_date": 1481108105, "answer_id": 41015576, "question_id": 41013958, "link": "https://stackoverflow.com/questions/41013958/passing-image-to-procedure-in-excel-vba/41015576#41015576", "title": "Passing Image to procedure in Excel/VBA", "body": "<p>The problem is that you need to track if an image has been zoomed in.  Instead of using a class variable for each image you could use the image's tag property.</p>\n\n<pre><code>Sub MoveImage(Image1 As MSForms.Image)\n\n    If Not Image1.Tag = \"Zoomed\" Then\n        Image1.left = Image1.left - (Image1.Width * 2 - Image1.Width)\n        Image1.Top = Image1.Top - (Image1.Height * 2 - Image1.Height)\n\n        Image1.Height = Image1.Height * 2\n        Image1.Width = Image1.Width * 2\n        Image1.Tag = \"Zoomed\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<h2>Update</h2>\n\n<p>When passing a <code>MSForms.Image</code> to a sub only the <code>Image</code> properties are available to IntelliSense.  Properties such as <code>Top, Left, Width and Height</code> belong to the <code>MSForms.Control</code> base class.  Becuase the <code>MSForms.Image</code> default value returns a <code>MSForms.Control</code> you will still be able to modify those properties.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    TestMSFormsControl Image1, Image1\nEnd Sub\n\nSub TestMSFormsControl _\n    (Ctrl As MSForms.Control, Img As MSForms.Image)\n    Stop\nEnd Sub\n</code></pre>\n\n<p>In the demonstration below I pass an <code>MSForms.Image</code> to a subroutine in a public module both as a <code>MSForms.Control</code> and a <code>MSForms.Image</code>.  Notice that the <code>Left</code> property of <code>Img As MSForms.Image</code> isn't available to Intellisense but can still be read and modified.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xbKCq.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xbKCq.gif\" alt=\"enter image description here\"></a></p>\n\n<h2>MSForms Image</h2>\n\n<p><a href=\"https://i.stack.imgur.com/Y1w9t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y1w9t.png\" alt=\"enter image description here\"></a></p>\n\n<h2>MSForms Control</h2>\n\n<p><a href=\"https://i.stack.imgur.com/VORYk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VORYk.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 7261297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc79e14cb3f13ad5d0086d16800720?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Becker", "link": "https://stackoverflow.com/users/7261297/oliver-becker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 41015576, "answer_count": 1, "score": 0, "last_activity_date": 1481113510, "creation_date": 1481103499, "last_edit_date": 1481108703, "question_id": 41013958, "link": "https://stackoverflow.com/questions/41013958/passing-image-to-procedure-in-excel-vba", "title": "Passing Image to procedure in Excel/VBA", "body": "<p>I'm new to VBA but have some experience in other languages.</p>\n\n<p>I have the following working code (A Imagezoom) im my UserForm1:</p>\n\n<pre><code>public Dim zoomed As Boolean\nzoomed = False\n\nImage1_MouseMove(...)\n\nIf zoomed = False Then\nzoomed = True\n\nImage1.Left = Image1.Left - (Image1.Width*2 - Image1.Width)\nImage1.Top = Image1.Top - (Image1.Height*2 - Image1.Height)\n\nImage1.Height = Image1.Height * 2\nImage1.Width = Image1.Width * 2\nEnd If\n</code></pre>\n\n<p>Now I want to give this to a procedure in a Module but I keep struggling:</p>\n\n<ul>\n<li>Passing as MSForms.Image gives me only Options like ImageEffects, etc</li>\n<li>Passing as Image does not work either (Is the same?)</li>\n<li>Passing as Shape/ShapeRange gives me incompatible Types-Error</li>\n<li>Passing as StdImage gives me the .Width and .Height but not .Top and\n.Left</li>\n<li>Passing as Object lets me read (f.e. MsgBox) .Width, .Height, .Left\nand .Top but I can't change it - even if I pass it ByRef. If I add\n\"Set\" it throws an Error with \"Object needed\"?</li>\n</ul>\n\n<p>Is it possible to see all Items of Image1 in the objectbrowser? If I search Image I can find the specific Items of Image1 but not the general object Items of Image1 - though I can call it from the procedure itself.\nI tried searching for Top and Left but can't figure this out.</p>\n\n<p>Thanks for your Help</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1481104158, "post_id": 41013733, "comment_id": 69235712, "body": "Do you want to loop down through all ships listed in sheet1?"}, {"owner": {"reputation": 3, "user_id": 7261172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df931ce6fc8d1627ef7d12d4b77d779e?s=128&d=identicon&r=PG&f=1", "display_name": "Phyx", "link": "https://stackoverflow.com/users/7261172/phyx"}, "reply_to_user": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1481105263, "post_id": 41013733, "comment_id": 69236390, "body": "No, there will be always one listed ship in sheet1 in a specified row"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1481107365, "post_id": 41013733, "comment_id": 69237844, "body": "done (please see below)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7261172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df931ce6fc8d1627ef7d12d4b77d779e?s=128&d=identicon&r=PG&f=1", "display_name": "Phyx", "link": "https://stackoverflow.com/users/7261172/phyx"}, "edited": false, "score": 0, "creation_date": 1481111208, "post_id": 41014760, "comment_id": 69240372, "body": "I don&#39;t know There wasnt any error but this didn&#39;t work, thank you for your time anyway."}], "tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": false, "score": 0, "last_activity_date": 1481105829, "creation_date": 1481105829, "answer_id": 41014760, "question_id": 41013733, "link": "https://stackoverflow.com/questions/41013733/overwrite-paste-whole-row-if-copied-rows-first-column-value-matches/41014760#41014760", "title": "Overwrite paste whole row if copied row&#39;s first column value matches", "body": "<p>I have modified your code and added a part to find the ship in sheet1 (A5) in sheet2. If found, code will replace the data else add to the end of the data. </p>\n\n<pre><code>Sub CopyShip()\n\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\n\nSet copySheet = Worksheets(\"sheet1\")\nSet pasteSheet = Worksheets(\"sheet2\")\n\nDim rowToCopy As Integer\nrowToCopy = 5 ' this variable in case a for loop is implemented in future\n\nDim findShip As Range\n\n'find current ship in sheet2\nSet findShip = pasteSheet.Cells.Find(What:=copySheet.Range(\"A\" &amp; rowToCopy), LookIn:=xlFormulas, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False)\n\n\ncopySheet.Range(\"A\" &amp; rowToCopy &amp; \":AT\" &amp; rowToCopy).Copy\nIf findShip Is Nothing Then\n    'current ship was not found\n    pasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n    Else\n    'ship with same name was found\n    'assuming all data is within columns A to AT\n    'other wise need to clear the entire row before pasting\n    pasteSheet.Cells(findShip.Row, 1).PasteSpecial xlPasteValues\nEnd If\n\n\nApplication.CutCopyMode = False\nWorksheets(\"sheet2\").Activate\nSheets(\"sheet2\").Range(\"A2\").CurrentRegion.Select\nSelection.Sort Key1:=Sheets(\"sheet2\").Range(\"A1\"), Order1:=xlAscending, Header:=xlYes, _\n    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n    DataOption1:=xlSortNormal\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": true, "score": 0, "last_activity_date": 1481118637, "last_edit_date": 1481118637, "creation_date": 1481106995, "answer_id": 41015179, "question_id": 41013733, "link": "https://stackoverflow.com/questions/41013733/overwrite-paste-whole-row-if-copied-rows-first-column-value-matches/41015179#41015179", "title": "Overwrite paste whole row if copied row&#39;s first column value matches", "body": "<p>Here:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nApplication.ScreenUpdating = False\nDim Rng As Range\n\nSheets(\"Sheet1\").Range(\"A5:AT5\").Copy   ' copies the row mentioned\n\nSheets(\"Sheet2\").Activate\nSet Rng = Range(\"A:A\").Find(What:=Sheets(\"Sheet1\").Range(\"A5\").Value, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True) ' Check to see if ship is already in sheet2 (\"Rng = nothing\" means it's not, \"Rng = [Ship's name]\" means it is)\n\nIf Not Rng Is Nothing Then  'if it's not nothing, it's somthing (ship's name)\n    Rng.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False 'Pastes over old record of ship\n    Else\n        Range(\"A\" &amp; Range(\"A\" &amp; Cells.Rows.Count).End(xlUp).Row + 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False ' enters ne entry for ship\nEnd If\n\nApplication.CutCopyMode = False\n\nSheets(\"sheet2\").Range(\"A2\").Sort Key1:=Sheets(\"sheet2\").Range(\"A1\"), Order1:=xlAscending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n\nSet Rng = Nothing\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7261172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df931ce6fc8d1627ef7d12d4b77d779e?s=128&d=identicon&r=PG&f=1", "display_name": "Phyx", "link": "https://stackoverflow.com/users/7261172/phyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 41015179, "answer_count": 2, "score": 0, "last_activity_date": 1481118637, "creation_date": 1481102886, "last_edit_date": 1531164843, "question_id": 41013733, "link": "https://stackoverflow.com/questions/41013733/overwrite-paste-whole-row-if-copied-rows-first-column-value-matches", "title": "Overwrite paste whole row if copied row&#39;s first column value matches", "body": "<p>I have list of ship data in sheet2. First column is ship's name and the others columns are that ship's details. A row below is another ship and so on. What I'm trying to do is copy a row of ship data in sheet1 and paste it to sheet2, but if sheet2 already has that ship i want that ship in sheet2's row replaced with copied one from sheet1.</p>\n\n<p>What I got so far is I copy the row from sheet1 and paste it to sheet2's first avaible empty row and then sort it in alphabetical order :P. So I have lots of rows with the same ship.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nApplication.ScreenUpdating = False\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\n\nSet copySheet = Worksheets(\"sheet1\")\nSet pasteSheet = Worksheets(\"sheet2\")\n\ncopySheet.Range(\"A5:AT5\").Copy\n\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial     xlPasteValues\n\nApplication.CutCopyMode = False\n\nWorksheets(\"sheet2\").Activate\n\nSheets(\"sheet2\").Range(\"A2\").CurrentRegion.Select\n\nSelection.Sort Key1:=Sheets(\"sheet2\").Range(\"A1\"), Order1:=xlAscending, Header:=xlYes, _\n    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n    DataOption1:=xlSortNormal\n\nSet Rng = Nothing\n\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1481102567, "creation_date": 1481102567, "answer_id": 41013620, "question_id": 41013214, "link": "https://stackoverflow.com/questions/41013214/how-to-prevent-data-changes-in-excel/41013620#41013620", "title": "How to prevent data changes in excel", "body": "<p>If you change this:</p>\n\n<p><code>Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlMultiply, _\nSkipBlanks:=False, Transpose:=False</code></p>\n\n<p>With this:</p>\n\n<p><code>Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False</code></p>\n\n<p>It should do it</p>\n"}], "owner": {"reputation": 39, "user_id": 6299271, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ed6cc32160bf01f972425f2fd19c6ca3?s=128&d=identicon&r=PG&f=1", "display_name": "Gloom", "link": "https://stackoverflow.com/users/6299271/gloom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481102567, "creation_date": 1481101383, "question_id": 41013214, "link": "https://stackoverflow.com/questions/41013214/how-to-prevent-data-changes-in-excel", "title": "How to prevent data changes in excel", "body": "<p>Good morning,\nI have tables with data. Most of them are numbers but some of them contains letters. I need to use \"pastespecial\" property from range. \nThe problem is that sometimes I have number like :\n5924017E7 and excel convert it to 59240170000000.</p>\n\n<pre><code>Range(\"A5\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlMultiply, _\nSkipBlanks:=False, Transpose:=False\nApplication.CutCopyMode = False\nSelection.NumberFormat = \"@\"\n</code></pre>\n\n<p>I was trying to define column as \"General\", \"Number\", \"Text\" and define Selection.NumberFormat to proper value but for this number \"5924017E7\" it doesn't work. Is is changing it no matter what.\nHow to prevent this change?</p>\n"}, {"tags": ["vba", "excel", "function"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1481101014, "creation_date": 1481101014, "answer_id": 41013088, "question_id": 41012841, "link": "https://stackoverflow.com/questions/41012841/vba-ubound-function/41013088#41013088", "title": "VBA UBound Function", "body": "<p><code>List</code> is range object not an array.  <code>Range.Value</code> will return an array of values from a range and <code>Range.Formula</code> will return an array of formulas from a range.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ea5mU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ea5mU.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Function test(list As Range) As Double\n\n    test = UBound(list.Value)\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 1, "last_activity_date": 1481101483, "last_edit_date": 1481101483, "creation_date": 1481101024, "answer_id": 41013091, "question_id": 41012841, "link": "https://stackoverflow.com/questions/41012841/vba-ubound-function/41013091#41013091", "title": "VBA UBound Function", "body": "<p>Since you do not <code>Dim</code> <code>list</code> explicitly, it is <code>Variant</code>. So if you call <code>=TEST(A1:B4)</code> it will be a <code>Range</code> and not an <code>Array</code>. A <code>Range</code> does not have a <code>UBound</code> but does have <code>Rows.Count</code>.</p>\n\n<p>So:</p>\n\n<pre><code>Function test(list As Range) As Double\n test = list.Rows.Count\nEnd Function\n</code></pre>\n\n<p>will work.</p>\n\n<p>Or if you really need an <code>Array</code>, you could do:</p>\n\n<pre><code>Function test(list As Variant) As Double\n list = list\n test = UBound(list)\nEnd Function\n</code></pre>\n\n<p>The <code>list = list</code> does the following: If <code>list</code> is a <code>Range</code>-Object then it will be implicit converted to <code>Array</code> since <code>Set</code> is not used to set an object. If <code>list</code> is an <code>Array</code> already, then it will be also an <code>Array</code> after that.</p>\n"}, {"tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1481101076, "creation_date": 1481101076, "answer_id": 41013111, "question_id": 41012841, "link": "https://stackoverflow.com/questions/41012841/vba-ubound-function/41013111#41013111", "title": "VBA UBound Function", "body": "<p>The UBound function is to give you elements in a variant array, you're passing it a range.  You could try this:</p>\n\n<pre><code>Sub mains()\n    Dim myRange As Range, myArray As Variant\n    Set myRange = Range(\"A1:B4\")\n    myArray = myRange.Value\n    Debug.Print test(myArray)\nEnd Sub\nFunction test(list) As Double\n\n    test = UBound(list)\n\nEnd Function\n</code></pre>\n\n<p><strong>EDIT</strong> With a two dimensional range (as mentioned by KazimierzJawor) the default ubound  will be the vertical, as you wanted, if you want to specify, you can add the optional perameter UBound(list, 1), but with the data you specified this defults to 4 as you wished</p>\n"}, {"tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 1, "last_activity_date": 1481101463, "last_edit_date": 1481101463, "creation_date": 1481101089, "answer_id": 41013117, "question_id": 41012841, "link": "https://stackoverflow.com/questions/41012841/vba-ubound-function/41013117#41013117", "title": "VBA UBound Function", "body": "<p>It seems that you have 2-dimensional array, therefore you have to provide additional parameter for <code>UBound</code> like:</p>\n\n<pre><code>UBound(array, dimension)\n</code></pre>\n\n<p>Please remember, if you get array from Excel Range than it is 1-based array.</p>\n\n<p>Complete solution can look like this one:</p>\n\n<pre><code>Function testArrray(List, Dimmension)\n\n    Dim ListConverted As Variant\n        ListConverted = List\n    testArrray = UBound(ListConverted, Dimmension)\nEnd Function\n</code></pre>\n\n<p>Sample call: <code>=testArrray(G15:H20,1)</code> produces <code>6</code> as a result which is correct.</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 7261147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49891f028f033d5baab7efc29fd8acd3?s=128&d=identicon&r=PG&f=1", "display_name": "Soto", "link": "https://stackoverflow.com/users/7261147/soto"}, "edited": false, "score": 0, "creation_date": 1481140411, "post_id": 41013169, "comment_id": 69259496, "body": "Thank you all! I appreciate it"}], "tags": [], "owner": {"reputation": 486, "user_id": 7063259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba38d2193de960ba9decc54826e508ae?s=128&d=identicon&r=PG&f=1", "display_name": "RegBes", "link": "https://stackoverflow.com/users/7063259/regbes"}, "is_accepted": false, "score": 0, "last_activity_date": 1481104082, "last_edit_date": 1481104082, "creation_date": 1481101229, "answer_id": 41013169, "question_id": 41012841, "link": "https://stackoverflow.com/questions/41012841/vba-ubound-function/41013169#41013169", "title": "VBA UBound Function", "body": "<p>Ubound is a function that works on arrays you are passing it a range</p>\n\n<p>try this </p>\n\n<pre><code>dim i(3)\ni(0) = 1\ni(1) =2\ni(2) = 3\n\nmsgbox ubound(i)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1481101659, "creation_date": 1481101659, "answer_id": 41013306, "question_id": 41012841, "link": "https://stackoverflow.com/questions/41012841/vba-ubound-function/41013306#41013306", "title": "VBA UBound Function", "body": "<p>This is how you get the number of rows in a function.</p>\n\n<pre><code>Option Explicit\n\nFunction l_number_of_rows(rng_range As Range) As Long\n\n    l_number_of_rows = rng_range.Rows.Count\n\nEnd Function\n</code></pre>\n\n<p>if you want the one from the dimension, this is a possible solution.</p>\n\n<pre><code>Sub test()\n\n    Dim MyArray(1 To 2, 0 To 3)     As Long\n    MyArray(1, 0) = 10\n    MyArray(1, 1) = 11\n    MyArray(1, 2) = 12\n    MyArray(1, 3) = 13\n    MyArray(2, 0) = 20\n    MyArray(2, 1) = 21\n    MyArray(2, 2) = 22\n    MyArray(2, 3) = 23\n\n    Debug.Print MyArray(UBound(MyArray), 3)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7261147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49891f028f033d5baab7efc29fd8acd3?s=128&d=identicon&r=PG&f=1", "display_name": "Soto", "link": "https://stackoverflow.com/users/7261147/soto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4366, "favorite_count": 1, "accepted_answer_id": 41013088, "answer_count": 6, "score": 2, "last_activity_date": 1519504030, "creation_date": 1481100215, "last_edit_date": 1519504030, "question_id": 41012841, "link": "https://stackoverflow.com/questions/41012841/vba-ubound-function", "title": "VBA UBound Function", "body": "<p>I'm trying to explore UBound applications for my code in Visual Basic for Applications (VBA). Let's say I have a 4 by 2 array...(A1:B4) and I want to count the number of rows. I would think my code would be...</p>\n\n<pre><code>Function test(list) As Double\n   test = UBound(list)\nEnd Function\n</code></pre>\n\n<p>My input is <code>=test(A1:B4)</code>but so far I get \"#value!\" error. I thought the return would be 4.</p>\n\n<p>What am I doing wrong? I know how to get the number of rows using the row command but I simply want to go through the coding exercise.</p>\n"}, {"tags": ["excel", "excel-formula", "range", "vba"], "comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1481099907, "post_id": 41012455, "comment_id": 69232916, "body": "If you are looking for a VBA solution then please post what you have tried already and we can work off of that. If you&#39;re happy with a formula solution that will just show blanks for the rows over the number of results that you are after I can knock that up quite easily"}, {"owner": {"reputation": 3, "user_id": 6682104, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206544224076058/picture?type=large", "display_name": "Pepek Trejbal", "link": "https://stackoverflow.com/users/6682104/pepek-trejbal"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1481100166, "post_id": 41012455, "comment_id": 69233092, "body": "I don&#39;t necessary need Vba.  I&#39;ll be satisfied if it will work.  In some cases when I have 20k rows and rows must be prepared for this number of data,  Excel file is too large and computer in work have problem with it .  I want to have it light for cases when I need to add just some data if you understand me :)"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1481100364, "post_id": 41012455, "comment_id": 69233204, "body": "oh well, perhaps file size reduction may suffice. do all the computers at work run Excel 2007 or better? if so consider a binary spreadsheet (save as). Also consider whether you need column H with formula for ID_TYPE when it is at the end of your output anyway, you could compress this to one formula. the formula work around will only increase the file size..."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 1, "creation_date": 1481100486, "post_id": 41012455, "comment_id": 69233280, "body": "Also, SO is not a free coding service, give it a go yourself and if you come into any problems post the problems you face here and we can work together to overcome them, there&#39;s plenty of tutorials out there. come back to us with something even if it is really bad xD"}], "answers": [{"tags": [], "owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "is_accepted": false, "score": 0, "last_activity_date": 1481115309, "last_edit_date": 1592644375, "creation_date": 1481114425, "answer_id": 41017759, "question_id": 41012455, "link": "https://stackoverflow.com/questions/41012455/excel-range-for-data-based-on-cell-value/41017759#41017759", "title": "Excel range for data based on cell value", "body": "<p>Presuming you want to look up the n values from a table matching your type, where n is the number of records to be shown (see Picture), it can be done with the following Array formula</p>\n<pre><code>=IFERROR(INDEX($B$4:$B$500,SMALL(IF($D$1=$A$4:$A$500,ROW($A$4:$A$500)-ROW($A$4)+1),IF(ROW(1:1)&lt;=$G$1,ROW(1:1),&quot;&quot;))),&quot;&quot;)\n</code></pre>\n<p>Please Keep in mind to enter the formula pressing <kbd>CTRL</kbd>+<kbd>ALT</kbd>+<kbd>ENTER</kbd></p>\n<p><a href=\"https://i.stack.imgur.com/HFGBz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HFGBz.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 3, "user_id": 6682104, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206544224076058/picture?type=large", "display_name": "Pepek Trejbal", "link": "https://stackoverflow.com/users/6682104/pepek-trejbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486151860, "creation_date": 1481098851, "last_edit_date": 1531161705, "question_id": 41012455, "link": "https://stackoverflow.com/questions/41012455/excel-range-for-data-based-on-cell-value", "title": "Excel range for data based on cell value", "body": "<p>I am trying to create Excel which will extend or decrease range based on cell value. </p>\n\n<p>I have 3 columns (cell for data, formula1, formula2) </p>\n\n<p>I want to type number in to cell under \"Number of units\" and than generate for example 1000 rows of these 3 columns (cell for data, formula1, formula2)</p>\n\n<p>Formula 1 - <code>=IF(K5=0;\"\";K5)</code> is on every row same (I have defined list)</p>\n\n<p>Formula 2 - <code>=IF(G5&amp;H5=\"\";\"\";(G5&amp;\",\"&amp;H5))</code> needs to increment by 1 on every next row</p>\n\n<p>Can you help me, how to achieve this function?</p>\n\n<p>Here is a screenshot for better illustration:</p>\n\n<p><a href=\"https://i.stack.imgur.com/c3gOb.png\" rel=\"nofollow noreferrer\">Screen here</a></p>\n\n<p>Thanks for every advice.</p>\n"}, {"tags": ["excel", "vba", "charts", "label"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1481103091, "post_id": 41012251, "comment_id": 69234986, "body": "what if you call <code>Cht.SeriesCollection(1).ApplyDataLabels</code> first, before the loop?"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 1588582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653cd5920f2168711384722dc898e691?s=128&d=identicon&r=PG", "display_name": "gth826a", "link": "https://stackoverflow.com/users/1588582/gth826a"}, "is_accepted": false, "score": 0, "last_activity_date": 1500565900, "creation_date": 1500565900, "answer_id": 45219623, "question_id": 41012251, "link": "https://stackoverflow.com/questions/41012251/excel-xy-chart-vba-add-data-labels-to-dynamic-selected-points/45219623#45219623", "title": "Excel XY Chart: VBA Add Data Labels to Dynamic Selected Points", "body": "<p>ptindx is becoming an invalid value for Points() to use...\nIn turn, Points(ptindx).DataLabels refers to something that either doesn't exist, or can't be associated with a datalabel.</p>\n\n<p>Or, perhaps you have to make the datalabel visible first.\ni.e.  <code>.Points(ptindx).HasDataLabel = TRUE</code></p>\n"}], "owner": {"reputation": 1, "user_id": 7175171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00921c89fd9c40f931d615e18c71b38b?s=128&d=identicon&r=PG&f=1", "display_name": "MDL", "link": "https://stackoverflow.com/users/7175171/mdl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 621, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500565900, "creation_date": 1481097990, "last_edit_date": 1481098984, "question_id": 41012251, "link": "https://stackoverflow.com/questions/41012251/excel-xy-chart-vba-add-data-labels-to-dynamic-selected-points", "title": "Excel XY Chart: VBA Add Data Labels to Dynamic Selected Points", "body": "<p>I have XY Chart plotted based on column C &amp; D values. I want to add data label to selected points in chart using values in column B. I wrote the code below, but Rn-Time error message pop-up all the time... It says \"Method 'DataLabel' of Object 'Point' failed\". </p>\n\n<pre><code>Sub AddLabelsToSelected()\n\nDim Cht As Chart\nDim i, ptcnt, ptindx, rownum As Integer\n\nSet Cht = ActiveSheet.ChartObjects(1).Chart\n\n' Add labels to these many selected points\nptcnt = Range(\"A1\").Value\n\nFor i = 1 To ptcnt\n\nptindx = Cells(i + 29, 1).Value\nrownum = Cells(i + 29, 1).Value + 29\n\n    Cht.SeriesCollection(1).Points(ptindx).DataLabel.Text = _\n      ActiveSheet.Cells(rownum, 2).Value\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "autofilter", "vba"], "comments": [{"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 1, "creation_date": 1481101531, "post_id": 41011971, "comment_id": 69233961, "body": "Quick question before I speed this up for you - the 4th last line says                                                                                                                                                                             .Range(&quot;A:E&quot;).AutoFilter Field:=17, Criteria1:=&quot;africs&quot;                                                                                                                                      Should this be                                                                                                 .Range(&quot;A:E&quot;).AutoFilter Field:=17, Criteria1:=&quot;africa&quot;?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1481103329, "post_id": 41011971, "comment_id": 69235165, "body": "Seems to me you&#39;d probably be better off with some COUNTIFS formulas in <code>Sheets(15)</code>."}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1481103442, "post_id": 41011971, "comment_id": 69235236, "body": "You&#39;d be better off using the <a href=\"http://codereview.stackexchange.com\">Code Review Site</a> to request a code review of otherwise working code."}, {"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1481155962, "post_id": 41011971, "comment_id": 69266874, "body": "Hi Jeremy, you are correct, sorry for the typo."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1481167773, "post_id": 41013968, "comment_id": 69270068, "body": "Thanks a million Limak. The irregularity of the criteria made it difficult for me to come with a loop. COUNTIFS is a great idea."}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": true, "score": 2, "last_activity_date": 1481103552, "creation_date": 1481103552, "answer_id": 41013968, "question_id": 41011971, "link": "https://stackoverflow.com/questions/41011971/optimisation-of-autofiltermode/41013968#41013968", "title": "Optimisation of AutoFilterMode", "body": "<p>It's gonna be faster to use <code>Excel.WorksheetFunction.CountIfs</code> istead of <code>AutoFilter</code> just for counting number of rows with some criteria. You can replace this:</p>\n\n<pre><code>    .AutoFilterMode = False\n    .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n    .Range(\"A:E\").AutoFilter Field:=14, Criteria1:=\"america\"\n    j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n    Sheets(15).Cells(18, 2) = j\n</code></pre>\n\n<p>With this:</p>\n\n<pre><code>Sheets(15).Cells(18, 2) = Excel.WorksheetFunction.CountIfs(Sheets(7).Columns(1), \"=*apple\", Sheets(7).Columns(14), \"america\")\n</code></pre>\n\n<p>So, you can easly replace your code by: </p>\n\n<pre><code>With Sheets(7)\n    Sheets(15).Cells(18, 2) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(14), \"america\")\n    Sheets(15).Cells(19, 2) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(14), \"asia\")\n    Sheets(15).Cells(20, 2) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(14), \"europe\")\n    Sheets(15).Cells(21, 2) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(14), \"africa\")\n    Sheets(15).Cells(18, 3) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(15), \"america\", .Columns(12), \"red\")\n    Sheets(15).Cells(19, 3) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(15), \"asia\", .Columns(12), \"green\")\n    Sheets(15).Cells(20, 3) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(15), \"europe\", .Columns(12), \"yellow\")\n    Sheets(15).Cells(21, 3) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(15), \"africa\", .Columns(12), \"dark red\")\n    Sheets(15).Cells(18, 5) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(17), \"america\")\n    Sheets(15).Cells(19, 5) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(17), \"asia\")\n    Sheets(15).Cells(20, 5) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(17), \"europe\")\n    Sheets(15).Cells(21, 5) = Excel.WorksheetFunction.CountIfs(.Columns(1), \"=*apple\", .Columns(17), \"africa\")\nEnd With\n</code></pre>\n\n<p>It's fine at this point, because creating a loop would be tricky, according to fact that your conditions are irregular. However, you can wrap it like this:</p>\n\n<pre><code>cols = Array(2, 3, 5)\ncontin = Array(\"america\", \"asia\", \"europe\", \"africa\")\ncolour = Array(\"red\", \"green\", \"yellow\", \"dark red\")\n\nFor Each k In cols\n    For i = 0 To 3\n        If k &lt;&gt; 3 Then Sheets(15).Cells(i + 18, k) = Excel.WorksheetFunction.CountIfs(Sheets(7).Columns(1), \"=*apple\", Sheets(7).Columns(12 + k), contin(i))\n        If k = 3 Then Sheets(15).Cells(i + 18, k) = Excel.WorksheetFunction.CountIfs(Sheets(7).Columns(1), \"=*apple\", Sheets(7).Columns(12 + k), contin(i), Sheets(7).Columns(12), colour(i))\n    Next i\nNext k\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 41013968, "answer_count": 1, "score": 0, "last_activity_date": 1481155927, "creation_date": 1481096953, "last_edit_date": 1531164843, "question_id": 41011971, "link": "https://stackoverflow.com/questions/41011971/optimisation-of-autofiltermode", "title": "Optimisation of AutoFilterMode", "body": "<p>I have written this piece of VBA and it does exactly what I want it to do. However most of the values repeat themselves numerous time, and I am wondering if the below could be transformed into a loop. Surely this can be optimised in some way, but I am struggling to see how, particularly if \"AutoFilter\" can only carry one single \"Field\". Any idea?</p>\n\n<pre><code>With Sheets(7)\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=14, Criteria1:=\"america\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(18, 2) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=14, Criteria1:=\"asia\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(19, 2) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=14, Criteria1:=\"europe\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(20, 2) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=14, Criteria1:=\"africa\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(21, 2) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=15, Criteria1:=\"america\"\n        .Range(\"A:E\").AutoFilter Field:=12, Criteria1:=\"red\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(18, 3) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=15, Criteria1:=\"asia\"\n        .Range(\"A:E\").AutoFilter Field:=12, Criteria1:=\"green\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(19, 3) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=15, Criteria1:=\"europe\"\n        .Range(\"A:E\").AutoFilter Field:=12, Criteria1:=\"yellow\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(20, 3) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=15, Criteria1:=\"africa\"\n        .Range(\"A:E\").AutoFilter Field:=12, Criteria1:=\"dark red\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(21, 3) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=17, Criteria1:=\"america\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(18, 5) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=17, Criteria1:=\"asia\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(19, 5) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=17, Criteria1:=\"europe\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(20, 5) = j\n\n        .AutoFilterMode = False\n        .Range(\"A:E\").AutoFilter Field:=1, Criteria1:=\"=*apple\"\n        .Range(\"A:E\").AutoFilter Field:=17, Criteria1:=\"africa\"\n        j = .AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n        Sheets(15).Cells(21, 5) = j\n\n        .AutoFilterMode = False\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word", "activexobject"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1481100520, "post_id": 41011932, "comment_id": 69233301, "body": "Is your problem only that the option buttons are not read or also that the checkboxes are in the wrong order?"}, {"owner": {"reputation": 101, "user_id": 5912608, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3cbe0cb3327ed40141de68d91d9b7234?s=128&d=identicon&r=PG&f=1", "display_name": "Reem", "link": "https://stackoverflow.com/users/5912608/reem"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1481100950, "post_id": 41011932, "comment_id": 69233595, "body": "@arcadeprecinct the option buttons are not read"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 1, "last_activity_date": 1481102053, "creation_date": 1481102053, "answer_id": 41013430, "question_id": 41011932, "link": "https://stackoverflow.com/questions/41011932/transfer-data-from-word-to-excel-via-vba/41013430#41013430", "title": "transfer data from word to excel via vba", "body": "<p>Your radiobuttons are inlineshapes so you need a separate loop for them</p>\n\n<p>to keep in line with your current code, it would be something like</p>\n\n<pre><code>Dim shp As InlineShape\nFor Each shp In .InlineShapes\n    j = j + 1\n    myWkSht.Cells(i, j) = shp.OLEFormat.Object.Value\nNext shp\n</code></pre>\n\n<p>However I wouldn't want to rely on Word always giving me the right order and there could be other inlineshapes so it might be better to check the controls first:</p>\n\n<pre><code>With myDoc\n    'content controls\n    For Each CCtl In .ContentControls\n        Select Case CCtl.Title\n            Case \"name\"\n                myWkSht.Cells(i, 1) = CCtl.Range.Text\n            'similar for age and gender\n            Case \"checkbox1\"\n                myWkSht.Cells(i, 4) = CCtl.Checked  'true and false are easier to evaluate in Excel than the checkmark symbols\n            'same for checkbox 2\n        End Select\n    Next CCtl\n\n    'option buttons\n    For Each shp In .InlineShapes\n        If shp.Type = wdInlineShapeOLEControlObject Then 'skip other inlineshapes\n            Select Case shp.OLEFormat.Object.Name\n                Case \"singleSelectQuestionOption1\" 'name it something unique\n                    myWkSht.Cells(i, 6) = shp.OLEFormat.Object.Value\n                'similar for option button 2\n            End Select\n        End If\n    Next shp\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1481105994, "creation_date": 1481105994, "answer_id": 41014827, "question_id": 41011932, "link": "https://stackoverflow.com/questions/41011932/transfer-data-from-word-to-excel-via-vba/41014827#41014827", "title": "transfer data from word to excel via vba", "body": "<p>You can refer to an ActiveX control on a Word document by it's name</p>\n\n<blockquote>\n  <p>myDoc.singlechoice1.Value</p>\n</blockquote>\n\n<p>It is better to refer to the <code>ContentControls</code> by their tag names. </p>\n\n<blockquote>\n  <p>myDoc.SelectContentControlsByTag(\"name\").Item(1).Range.Text</p>\n</blockquote>\n\n<h2>Refactored Code</h2>\n\n<pre><code>Sub getWordFormData()\n    Dim wdApp As Object, myDoc As Object\n\n    Dim myFolder As String, strFile As String\n    Dim i As Long, j As Long\n\n    myFolder = \"C:\\Users\\alarfajal\\Desktop\\myform\"\n\n    If Len(Dir(myFolder)) = 0 Then\n        MsgBox myFolder &amp; vbCrLf &amp; \"Not Found\", vbInformation, \"Cancelled - getWordFormData\"\n        Exit Sub\n    End If\n\n    Application.ScreenUpdating = False\n    Set wdApp = CreateObject(\"Word.Application\")\n\n    With ActiveSheet\n        .Cells.Clear\n        With .Range(\"A1:G1\")\n            .Value = Array(\"name\", \"age\", \"gender\", \"checkbox1\", \"checkbox2\", \"singlechoice1\", \"singlechoice2\")\n            .Font.Bold = True\n        End With\n\n        strFile = Dir(myFolder &amp; \"\\*.docx\", vbNormal)\n\n        i = 1\n        While strFile &lt;&gt; \"\"\n            i = i + 1\n\n            Set myDoc = wdApp.Documents.Open(Filename:=myFolder &amp; \"\\\" &amp; strFile, ReadOnly:=True, AddToRecentFiles:=False, Visible:=False)\n\n            .Cells(i, 1).Value = myDoc.SelectContentControlsByTag(\"name\").Item(1).Range.Text\n            .Cells(i, 2).Value = myDoc.SelectContentControlsByTag(\"age\").Item(1).Range.Text\n            .Cells(i, 3).Value = myDoc.SelectContentControlsByTag(\"gender\").Item(1).Range.Text\n            .Cells(i, 4).Value = myDoc.SelectContentControlsByTag(\"checkbox1\").Item(1).Checked\n            .Cells(i, 5).Value = myDoc.SelectContentControlsByTag(\"checkbox2\").Item(1).Checked\n            .Cells(i, 6).Value = myDoc.singlechoice1.Value\n            .Cells(i, 7).Value = myDoc.singlechoice2.Value\n\n            myDoc.Close SaveChanges:=False\n            strFile = Dir()\n        Wend\n        wdApp.Quit\n\n        Application.ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5912608, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3cbe0cb3327ed40141de68d91d9b7234?s=128&d=identicon&r=PG&f=1", "display_name": "Reem", "link": "https://stackoverflow.com/users/5912608/reem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2352, "favorite_count": 0, "accepted_answer_id": 41014827, "answer_count": 2, "score": 0, "last_activity_date": 1481105994, "creation_date": 1481096822, "last_edit_date": 1481099088, "question_id": 41011932, "link": "https://stackoverflow.com/questions/41011932/transfer-data-from-word-to-excel-via-vba", "title": "transfer data from word to excel via vba", "body": "<p>I have a form in ms word with some of the fields are content control and some (which are the radio buttons) are ActiveX control. I want to automatically transfer hundred word forms to an excel file. I use the following vba code:</p>\n\n<pre><code>Sub getWordFormData()\nDim wdApp As New Word.Application\nDim myDoc As Word.Document\nDim CCtl As Word.ContentControl\nDim myFolder As String, strFile As String\nDim myWkSht As Worksheet, i As Long, j As Long\n\nmyFolder = \"C:\\Users\\alarfajal\\Desktop\\myform\"\nApplication.ScreenUpdating = False\n\nIf myFolder = \"\" Then Exit Sub\nSet myWkSht = ActiveSheet\nActiveSheet.Cells.Clear\nRange(\"A1\") = \"name\"\nRange(\"a1\").Font.Bold = True\nRange(\"B1\") = \"age\"\nRange(\"B1\").Font.Bold = True\nRange(\"C1\") = \"gender\"\nRange(\"C1\").Font.Bold = True\nRange(\"D1\") = \"checkbox1\"\nRange(\"D1\").Font.Bold = True\nRange(\"E1\") = \"checkbox2\"\nRange(\"E1\").Font.Bold = True\nRange(\"F1\") = \"singlechoice1\"\nRange(\"F1\").Font.Bold = True\nRange(\"G1\") = \"singlechoice2\"\nRange(\"G1\").Font.Bold = True\n\n\n\ni = myWkSht.Cells(myWkSht.Rows.Count, 1).End(xlUp).Row\nstrFile = Dir(myFolder &amp; \"\\*.docx\", vbNormal)\n\nWhile strFile &lt;&gt; \"\"\n    i = i + 1\n\n    Set myDoc = wdApp.Documents.Open(Filename:=myFolder &amp; \"\\\" &amp; strFile, AddToRecentFiles:=False, Visible:=False)\n\n    With myDoc\n        j = 0\n        For Each CCtl In .ContentControls\n            j = j + 1\n            myWkSht.Cells(i, j) = CCtl.Range.Text\n        Next\n        myWkSht.Columns.AutoFit\n    End With\n    myDoc.Close SaveChanges:=False\n    strFile = Dir()\nWend\nwdApp.Quit\nSet myDoc = Nothing: Set wdApp = Nothing: Set myWkSht = Nothing\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>all the data (text fields, checkbox) are transferred successfully but, the radio button (which is ActiveX) is not transferred. </p>\n\n<p><strong>This is the word doc:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/UU1mz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UU1mz.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>This is the excel result:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/xFGxM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xFGxM.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I solve this problem? </p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481111528, "post_id": 41011852, "comment_id": 69240571, "body": "Look at FireEvent, however looks like it&#39;s just calling the submit of the form, so get the elements form, and call the submit yourself."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1481112119, "post_id": 41011852, "comment_id": 69240940, "body": "double check what submitOnEnter does, if you can, I think it will just check for enter key rather than entering text."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1481111773, "creation_date": 1481111773, "answer_id": 41016816, "question_id": 41011852, "link": "https://stackoverflow.com/questions/41011852/vba-enter-key-event-in-ie-not-working-in-another-machine/41016816#41016816", "title": "VBA Enter key event in IE not working in another machine", "body": "<p>Not, an answer, backup for comment, using HTML Object Library</p>\n\n<pre><code>Public Function x(i As Control)\n\nDim d As HTMLDocument\nDim f As MSHTML.HTMLFormElement\nDim e As MSHTML.HTMLInputElement\n\nSet e = d.getElementById(\"x\")\nSet f = e.form\nf.submit\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7035879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BciyV00Dyv8/AAAAAAAAAAI/AAAAAAAABCY/hy5fDY3_y5s/photo.jpg?sz=128", "display_name": "Pawan Joshi", "link": "https://stackoverflow.com/users/7035879/pawan-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 830, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1481111773, "creation_date": 1481096491, "last_edit_date": 1481097353, "question_id": 41011852, "link": "https://stackoverflow.com/questions/41011852/vba-enter-key-event-in-ie-not-working-in-another-machine", "title": "VBA Enter key event in IE not working in another machine", "body": "<p>I have one text box in my web page and I entered one number on it. After that I want to execute \u201cEnter\u201d key press event. How to do that?</p>\n\n<p>I tried:</p>\n\n<ol>\n<li>Sendkey option (it's not working properly, looking for some good alternate option for that)</li>\n<li>I also tried following option suggest by someone. In this case this work fine in one system however when I tried the same code in different machine with same IE version same Excel version, it\u2019s not working. </li>\n</ol>\n\n<p>The code:</p>\n\n<pre><code>Private Declare Sub keybd_event Lib \"user32\" (ByVal bVk As Byte, ByVal bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)\n\nPrivate Const VK_ENTER = &amp;HD\n\nDeclare Function GetKeyState Lib \"user32.dll\" (ByVal nVirtKey As Long) As Integer\n\nFunction ENT()\n    keybd_event VK_ENTER, 1, 0, 0\nEnd Function\n</code></pre>\n\n<p>VBA code I used to input number in that text box:</p>\n\n<pre><code>.document.getElementById(\"filteredListForm:wfmtAllTaskList:wfmtAllTaskList_columns_2:2:_filterInput\").Value = number\n</code></pre>\n\n<p>** after this code I what to execute enter key event in this text bow.</p>\n\n<p>HTML code for that Text box: </p>\n\n<pre><code>&lt;input id=\"filteredListForm:wfmtAllTaskList:wfmtAllTaskList_columns_2:2:_filterInput\"\nclass=\"mdw_columnFilter\" type=\"text\" placeholder=\"Project ID\"\nonblur=\"hideFilterInput(this);\" onkeydown=\"submitOnEnter(event, this.form);\"\nvalue=\"\" name=\"filteredListForm:wfmtAllTaskList:wfmtAllTaskList_columns_2:2:_filterInput\"&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 2, "creation_date": 1481095308, "post_id": 41011532, "comment_id": 69230602, "body": "Can&#39;t you just record the conditions?"}, {"owner": {"reputation": 3, "user_id": 6744107, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1cbbb384bea703bd32330f9596e06b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/6744107/joel"}, "reply_to_user": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1481095615, "post_id": 41011532, "comment_id": 69230785, "body": "my &quot;boss&quot; doesn&#39;t want the idea of recording the conditions...."}, {"owner": {"reputation": 3, "user_id": 6744107, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1cbbb384bea703bd32330f9596e06b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/6744107/joel"}, "edited": false, "score": 0, "creation_date": 1481096673, "post_id": 41011532, "comment_id": 69231281, "body": "Plus if i do record the conditional formatting there too much codes in the vba and I&#39;m not sure which code will be necessary, as I&#39;m that pro/good in excel vba. So writing the vba code from scratch, I kinda understand the code"}], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "reply_to_user": {"reputation": 3, "user_id": 6744107, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1cbbb384bea703bd32330f9596e06b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/6744107/joel"}, "edited": false, "score": 0, "creation_date": 1481099581, "post_id": 41012245, "comment_id": 69232726, "body": "@Joel it would be nice to mark my answer as the correct one. :)"}], "tags": [], "owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "is_accepted": true, "score": 2, "last_activity_date": 1481097955, "creation_date": 1481097955, "answer_id": 41012245, "question_id": 41011532, "link": "https://stackoverflow.com/questions/41011532/how-to-add-multiple-conditional-formatting-in-vba-coding-excel/41012245#41012245", "title": "How to add multiple conditional formatting in VBA coding - EXCEL", "body": "<p>I just duplicated the <code>With</code> block and applied the conditions you have. You can try this:</p>\n\n<pre><code>Sub Button5_Click()\nDim ws As Worksheet\nDim i As Integer\nSet ws = Sheets(\"COMPARISON\")\ni = 1\n\nWith Range(\"I2:I146\").FormatConditions.Add( _\n    Type:=xlExpression, _\n    Formula1:=\"=((($I2-$E2)/$E2)*100) &gt; 20\")\n    .Interior.Color = RGB(255, 0, 0)\n\nEnd With\n\nWith Range(\"I2:I146\").FormatConditions.Add( _\n    Type:=xlCellValue, _\n    Operator:=xlEqual, _\n    Formula1:=\"0\")\n    .Interior.Color = RGB(0, 0, 0)\n    .Font.Color = RGB(255, 255, 255)\nEnd With\n\nWith Range(\"I2:I146\").FormatConditions.Add( _\n    Type:=xlExpression, _\n    Formula1:=\"=AND($I2&lt;$E2, $I2&lt;&gt;0)\")\n    .Interior.Color = RGB(255, 255, 0)\nEnd With\n\nDo Until i = 300\n   If ws.Range(\"I\" &amp; i).DisplayFormat.Interior.Color = RGB(255, 0, 0) Then\n       msg = \"I\" &amp; i &amp; \" -\" &amp; \" Data has changed\"\n       MsgBox msg\n   End If\ni = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6744107, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1cbbb384bea703bd32330f9596e06b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/6744107/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8552, "favorite_count": 0, "accepted_answer_id": 41012245, "answer_count": 1, "score": 0, "last_activity_date": 1481097955, "creation_date": 1481095194, "question_id": 41011532, "link": "https://stackoverflow.com/questions/41011532/how-to-add-multiple-conditional-formatting-in-vba-coding-excel", "title": "How to add multiple conditional formatting in VBA coding - EXCEL", "body": "<p>How do I code multiple conditional formatting ? Currently, I'm only able to code a single conditional formatting. </p>\n\n<p>MY CODE: </p>\n\n<pre><code>Sub Button5_Click()\nDim ws As Worksheet\nDim i As Integer\nSet ws = Sheets(\"COMPARISON\")\ni = 1\n\nWith Range(\"I2:I146\").FormatConditions.Add( _\n    Type:=xlExpression, _\n    Formula1:=\"=((($I2-$E2)/$E2)*100) &gt; 20\")\n    .Interior.Color = RGB(255, 0, 0)\n\nEnd With\n\nDo Until i = 300\n   If ws.Range(\"I\" &amp; i).DisplayFormat.Interior.Color = RGB(255, 0, 0) Then\n       msg = \"I\" &amp; i &amp; \" -\" &amp; \" Data has changed\"\n       MsgBox msg\n   End If\ni = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I have manage to create one conditional formatting, where if the value of I2 - E2 is more than 20%, fill the cell red. </p>\n\n<p>I wish to create two more conditional formatting such where</p>\n\n<p>1) if the cell is 0 fill the cell black and set the font white </p>\n\n<p>2) if the cell I2 is &lt; E2 but not 0 fill the cell yellow. </p>\n\n<p>Could someone help me with the other 2 conditional formatting ? Many thanks.</p>\n"}, {"tags": ["php", "vba", "rest", "calendar", "lotus-notes"], "answers": [{"tags": [], "owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1481121256, "creation_date": 1481121256, "answer_id": 41020148, "question_id": 41011504, "link": "https://stackoverflow.com/questions/41011504/access-to-lotus-notes-calendar-via-php/41020148#41020148", "title": "Access to Lotus Notes Calendar via PHP?", "body": "<p>This <a href=\"http://www.ibm.com/developerworks/lotus/library/domino-php/\" rel=\"nofollow noreferrer\">old article</a> describes how to use the Lotus Notes COM API in PHP. It also gives a couple of other alternatives, which you might find useful if you're not running your PHP server on a Windows host.</p>\n"}], "owner": {"reputation": 305, "user_id": 2550641, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c26ea6a564f232ea8bdb152d6a04fa47?s=128&d=identicon&r=PG", "display_name": "user2550641", "link": "https://stackoverflow.com/users/2550641/user2550641"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481121256, "creation_date": 1481095074, "question_id": 41011504, "link": "https://stackoverflow.com/questions/41011504/access-to-lotus-notes-calendar-via-php", "title": "Access to Lotus Notes Calendar via PHP?", "body": "<p><strong>I try to get my Lotus Notes calendar entries via PHP.</strong> </p>\n\n<p>I read about the <a href=\"https://www-10.lotus.com/ldd/ddwiki.nsf/xpViewCategories.xsp?lookupName=API%20Documentation\" rel=\"nofollow noreferrer\">REST API</a>, but when I tried to access my calendar there is an forbidden error and it seems that to access the content, there must be some settings on the Lotus Notes Server (I cannot make this as the servers are hold by external admins)</p>\n\n<p>I know that I cann access the entries via vba, like the guy in <a href=\"https://www.experts-exchange.com/questions/28339272/loop-all-calendar-entries-in-lotus-notes-in-vba.html#answer39784950\" rel=\"nofollow noreferrer\">this thread</a> made. For this I only need the mail database .nsf and the server (for me it works with just \"\")</p>\n\n<p>I'm sure that there must be a possibility to also get the wished content in PHP...</p>\n\n<p>Please help me, a workaround by calling a vba file doing the job wouldn't be very nice ;-)</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481099838, "post_id": 41011450, "comment_id": 69232875, "body": "(a) Transfer your data to arrays first, process on the arrays, write arrays back to sheet at end.  (b) Unless there is a possibility that a cell can be changed to one of the <code>text_to_fill</code> values on Sheet2, and then that value can then be changed to a later <code>text_to_fill</code> value, you can put an <code>Exit For</code> after you change the cell.  (And, if you do have values where one <code>text_to_fill</code> needs to change to another, simplify the data on Sheet2 so that you can&#39;t.)"}, {"owner": {"reputation": 251, "user_id": 4669905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a74cbe9119a06fdb77751fe8d431218d?s=128&d=identicon&r=PG&f=1", "display_name": "Broly", "link": "https://stackoverflow.com/users/4669905/broly"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481102022, "post_id": 41011450, "comment_id": 69234283, "body": "Hi, sorry I didn&#39;t understand your solution. I don&#39;t know how to process arrrays. Would it be possible for you to share a sample code?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481136860, "post_id": 41011450, "comment_id": 69257556, "body": "The code in your edit works for me, but obviously it is doing a full match instead of a partial match.  It would still be faster to write the results to an array while processing, and then write the array to the sheet in one operation at the end.  (I am assuming that none of your cells in <code>L1!I:I</code> contain formulae which are dependent on <code>L1!L:L</code>.)  It&#39;s the writing of information to the sheet that will be consuming the bulk of the time."}], "answers": [{"tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 0, "last_activity_date": 1481138141, "last_edit_date": 1481138141, "creation_date": 1481102883, "answer_id": 41013729, "question_id": 41011450, "link": "https://stackoverflow.com/questions/41011450/faster-way-to-execute-loops/41013729#41013729", "title": "Faster way to execute loops", "body": "<p>The most cost here is using <code>InStr()</code>, but you should also:</p>\n\n<ul>\n<li>Declare your variables, <code>Variant</code> are slower</li>\n<li><p>Wrap your loops with</p>\n\n<pre><code>With Sheets(\"Sheet1\")\n   ...\nEnd With\n</code></pre></li>\n<li><p>Change cell addressing to <code>.Cell(10, i)</code> instead of <code>.Range(\"D\" &amp; j)</code></p></li>\n</ul>\n\n<p>My tests show it runs 50% faster, note that I had all cells empty, so the <code>InStr()</code> cost is relatively low in that case.</p>\n"}, {"comments": [{"owner": {"reputation": 251, "user_id": 4669905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a74cbe9119a06fdb77751fe8d431218d?s=128&d=identicon&r=PG&f=1", "display_name": "Broly", "link": "https://stackoverflow.com/users/4669905/broly"}, "edited": false, "score": 0, "creation_date": 1481128776, "post_id": 41021289, "comment_id": 69252647, "body": "I tested using your code. Definitely runs way faster but there is no output in column J. It was blank to begin with and after running the code it stays the same."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 251, "user_id": 4669905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a74cbe9119a06fdb77751fe8d431218d?s=128&d=identicon&r=PG&f=1", "display_name": "Broly", "link": "https://stackoverflow.com/users/4669905/broly"}, "edited": false, "score": 0, "creation_date": 1481135944, "post_id": 41021289, "comment_id": 69256995, "body": "Do you have any of your <code>text_to_check</code> (i.e. Sheet2!D1:D14430) cells that are empty?  Your code is designed to store only the last match into column J and, if (for instance) cell D14430 is empty then it will be the last match."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 251, "user_id": 4669905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a74cbe9119a06fdb77751fe8d431218d?s=128&d=identicon&r=PG&f=1", "display_name": "Broly", "link": "https://stackoverflow.com/users/4669905/broly"}, "edited": false, "score": 0, "creation_date": 1481136927, "post_id": 41021289, "comment_id": 69257595, "body": "@AkshayNayar - P.S. Do you want to store the last match?  Or the first match?"}, {"owner": {"reputation": 251, "user_id": 4669905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a74cbe9119a06fdb77751fe8d431218d?s=128&d=identicon&r=PG&f=1", "display_name": "Broly", "link": "https://stackoverflow.com/users/4669905/broly"}, "edited": false, "score": 0, "creation_date": 1481169926, "post_id": 41021289, "comment_id": 69270585, "body": "Thanks. I want to store the first match only. Also none of the cells in range D1:D14430 is empty. Column J is empty though."}, {"owner": {"reputation": 251, "user_id": 4669905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a74cbe9119a06fdb77751fe8d431218d?s=128&d=identicon&r=PG&f=1", "display_name": "Broly", "link": "https://stackoverflow.com/users/4669905/broly"}, "edited": false, "score": 0, "creation_date": 1481181737, "post_id": 41021289, "comment_id": 69275089, "body": "Noticed an interesting thing. When I deliberately fill column J with some data it gets deleted after the code is run. I am guessing that the code is writing blanks on the given range but I am not able to figure out why. There are no blanks in the other ranges that I am passing into array on Sheet2"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 251, "user_id": 4669905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a74cbe9119a06fdb77751fe8d431218d?s=128&d=identicon&r=PG&f=1", "display_name": "Broly", "link": "https://stackoverflow.com/users/4669905/broly"}, "edited": false, "score": 0, "creation_date": 1481183059, "post_id": 41021289, "comment_id": 69275736, "body": "@AkshayNayar - I have edited the answer to exit the inner loop as soon as a match is made.  I have also added in some <code>Debug.Print</code> statements which will write values to the Immediate Window (in the VBA editor, press Ctrl-G to display the Immediate Window it it isn&#39;t already displayed) while it is processing the first row.  Those values might give me a clue as to why it isn&#39;t working.  (If the code actually <b>does</b> work now that the <code>Exit For</code> is there, I might get you to run it again with the <code>Exit For</code> commented out to see what <b>was</b> wrong.)"}, {"owner": {"reputation": 251, "user_id": 4669905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a74cbe9119a06fdb77751fe8d431218d?s=128&d=identicon&r=PG&f=1", "display_name": "Broly", "link": "https://stackoverflow.com/users/4669905/broly"}, "edited": false, "score": 0, "creation_date": 1481521873, "post_id": 41021289, "comment_id": 69394429, "body": "Thanks. Worked like a charm."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1481182687, "last_edit_date": 1481182687, "creation_date": 1481124390, "answer_id": 41021289, "question_id": 41011450, "link": "https://stackoverflow.com/questions/41011450/faster-way-to-execute-loops/41021289#41021289", "title": "Faster way to execute loops", "body": "<p>I haven't tested this code, but it should at least give an idea of how to put the values into arrays, process everything \"in-memory\", and then write the results out.</p>\n\n<pre><code>Sub loop()\n    Dim i As Long\n    Dim j As Long\n    Dim check_cell() As Variant\n    Dim result() As Variant\n    Dim text_to_check() As Variant\n    Dim text_to_fill() As Variant\n\n    check_cell = Sheets(\"Sheet1\").Range(\"I1:I100000\").Value\n    result = Sheets(\"Sheet1\").Range(\"J1:J100000\").Value\n    text_to_check = Sheets(\"Sheet2\").Range(\"D1:D14430\").Value\n    text_to_fill = Sheets(\"Sheet2\").Range(\"E1:E14430\").Value\n    For i = 1 To 100000\n        For j = 1 To 14430\n            If InStr(check_cell(i, 1), text_to_check(j, 1)) Then\n                 result(i, 1) = text_to_fill(j, 1)\n                 If i = 1 Then\n                     Debug.Print \"check_cell=\" &amp; check_cell(i, 1)\n                     Debug.Print \"j=\" &amp; j\n                     Debug.Print \"text_to_check=\" &amp; text_to_check(j, 1)\n                     Debug.Print \"text_to_fill=\" &amp; text_to_fill(j, 1)\n                 End If\n                 ' exit as soon as first match is made\n                 Exit For\n            End If\n        Next j\n    Next i\n    Sheets(\"Sheet1\").Range(\"J1:J100000\").Value = result\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 4669905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a74cbe9119a06fdb77751fe8d431218d?s=128&d=identicon&r=PG&f=1", "display_name": "Broly", "link": "https://stackoverflow.com/users/4669905/broly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 41021289, "answer_count": 2, "score": 1, "last_activity_date": 1481182687, "creation_date": 1481094824, "last_edit_date": 1531164843, "question_id": 41011450, "link": "https://stackoverflow.com/questions/41011450/faster-way-to-execute-loops", "title": "Faster way to execute loops", "body": "<p>I am new to VBA and need help in figuring out a faster way to execute my code. Here is the code I am using:</p>\n\n<pre><code>Sub loop()\nFor i = 1 To 100000\ncheck_cell = Sheets(\"Sheet1\").Range(\"I\" &amp; i)\n  For j = 1 To 14430\n    text_to_check = Sheets(\"Sheet2\").Range(\"D\" &amp; j)\n    text_to_fill = Sheets(\"Sheet2\").Range(\"E\" &amp; j)\n    If InStr(check_cell, text_to_check) Then\n      Sheets(\"Sheet1\").Range(\"J\" &amp; i).Value = text_to_fill\n    End If\n  Next j\nNext i\nEnd Sub\n</code></pre>\n\n<p>I know that I am using a very brutal way by running the system through a loop 1,443,000,000 times. Any help on shortening this would be appreciated. Thanks.</p>\n\n<p>EDIT: Based on suggestion, I tried with new code using variants but nothing seems to be happening. Would you be able to tell me what am I doing wrong here? Thanks</p>\n\n<pre><code>Sub loop_2()\n    Dim varray_1 As Variant\n    Dim varray_2 As Variant\n    Dim i As Long\n    Dim j As Long\n    varray_1 = Sheets(\"L1\").Range(\"I2:I39997\").Value\n    varray_2 = Sheets(\"Sheet2\").Range(\"G1:G14394\").Value\n    For i = UBound(varray_1, 1) To LBound(varray_1, 1) Step -1\n        For j = UBound(varray_2, 1) To LBound(varray_2, 1) Step -1\n            If varray_1(i, 1) = varray_2(j, 1) Then\n                Sheets(\"L1\").Range(\"L\" &amp; i).Value = Sheets(\"Sheet2\").Range(\"H\" &amp; j).Value\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1481093987, "post_id": 41011173, "comment_id": 69230003, "body": "what if you write it in one line, without concatenating formula text and without any <code>line continuation</code> with <code>_</code>?"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1481094192, "post_id": 41011173, "comment_id": 69230099, "body": "It does that automatically"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1481094243, "post_id": 41011173, "comment_id": 69230120, "body": "and i have a lot of macros with those and they all work fine"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1481094453, "post_id": 41011173, "comment_id": 69230204, "body": "ok. I did wht u said....it works....lol. thanks man"}], "answers": [{"tags": [], "owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "is_accepted": false, "score": 0, "last_activity_date": 1481094712, "creation_date": 1481094712, "answer_id": 41011420, "question_id": 41011173, "link": "https://stackoverflow.com/questions/41011173/add-formula-in-vba-syntax-error/41011420#41011420", "title": "add formula in vba - syntax error", "body": "<p>The only thing that's wrong is the <code>\"&amp; _</code> part. It should be replaced by <code>RC[-7]=</code>. See the corrected line below.</p>\n\n<pre><code>Selection.FormulaR1C1 = _\n        \"=IF(AND(OR(RC[-6]={\"\"1\"\",\"\"2\"\",\"\"3\"\",\"\"4\"\",\"\"5\"\",\"\"6\"\",\"\"7\"\",\"\"8\"\",\"\"9\"\",\"\"10\"\",\"\"11\"\",\"\"12\"\",\"\"13\"\",\"\"14\"\",\"\"15 \"\",\"\"16 \"\"}), OR(RC[2]={\"\"Q1\"\",\"\"Q2\"\",\"\"Q3\"\",\"\"Q4\"\"})), CONCATENATE(RC[2],\"\" \"\",IF(RC[3]=\"\"p\"\",\"\"pre\"\",\"\"\"\"),\"\"-\"\",\"\" \"\",IF(RC[-7]=\"\"\"\",0,RC[-7])),\"\"\"\")\"\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1481097262, "creation_date": 1481097262, "answer_id": 41012071, "question_id": 41011173, "link": "https://stackoverflow.com/questions/41011173/add-formula-in-vba-syntax-error/41012071#41012071", "title": "add formula in vba - syntax error", "body": "<p><code>IF(A2=\"\",0,A2)),\"\")</code> Is being converted to <code>IF(\"\"\",0,RC[-7])),\"\"\"\")</code></p>\n\n<h2>Assuming that If your original formula is in <code>Range(\"H2\")</code></h2>\n\n<pre><code>\"=IF(AND(OR(RC[-6]={\"\"1\"\",\"\"2\"\",\"\"3\"\",\"\"4\"\",\"\"5\"\",\"\"6\"\",\"\"7\"\",\"\"8\"\",\"\"9\"\",\"\"10\"\",\"\"11\"\",\"\"12\"\",\"\"13\"\",\"\"14\"\",\"\"15 \"\",\"\"16 \"\"}),OR(RC[2]={\"\"Q1\"\",\"\"Q2\"\",\"\"Q3\"\",\"\"Q4\"\"})),CONCATENATE(RC[2],\"\" \"\",IF(RC[3]=\"\"p\"\",\"\"pre\"\",\"\"\"\"),\"\"-\"\",\"\" \"\",IF(RC[-7]=\"\"\"\",0,RC[-7])),\"\"\"\")\"\n</code></pre>\n\n<h2>I don't see the need to surround number with quotes when using formula contants</h2>\n\n<pre><code>\"=IF(AND(OR(RC[-6]={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16}),OR(RC[2]={\"\"Q1\"\",\"\"Q2\"\",\"\"Q3\"\",\"\"Q4\"\"})),CONCATENATE(RC[2],\"\" \"\",IF(RC[3]=\"\"p\"\",\"\"pre\"\",\"\"\"\"),\"\"-\"\",\"\" \"\",IF(RC[-7]=\"\"\"\",0,RC[-7])),\"\"\"\")\"\n</code></pre>\n\n<h2>Don't start a line continuations in the middle of a double escape pattern <code>\"\"\"\"</code>. I prefer to place them between statements when possible</h2>\n\n<h2>The easiest way to convert a formula to <code>R1C1</code> notation is to use the Immediate Window</h2>\n\n<blockquote>\n  <p>?Chr(34) &amp; Replace(Range(\"H2\").FormulaR1C1,chr(34),Chr(34) &amp; Chr(34))  &amp; Chr(34)</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/Vxhoe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vxhoe.png\" alt=\"enter image description here\"></a></p>\n\n<h2>Build and test your strings in the Immediate Window when possible.  It will complain when it is wrong</h2>\n\n<p><a href=\"https://i.stack.imgur.com/QgEET.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QgEET.gif\" alt=\"enter image description here\"></a></p>\n\n<h2>You can even use create variables in the Immediate Window when writing concatenations</h2>\n\n<p><a href=\"https://i.stack.imgur.com/hgxtp.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hgxtp.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 41012071, "answer_count": 2, "score": 0, "last_activity_date": 1481097262, "creation_date": 1481093721, "last_edit_date": 1481093928, "question_id": 41011173, "link": "https://stackoverflow.com/questions/41011173/add-formula-in-vba-syntax-error", "title": "add formula in vba - syntax error", "body": "<p>im trying to record a macro. my formula in excel is:</p>\n\n<p><code>=IF(AND(OR(B2={\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15 \",\"16 \"}),OR(J2={\"Q1\",\"Q2\",\"Q3\",\"Q4\"})),CONCATENATE(J2,\" \",IF(K2=\"p\",\"pre\",\"\"),\"-\",\" \",IF(A2=\"\",0,A2)),\"\")</code></p>\n\n<p>(this formula basically changes the names of my product according to quarter and type, while taking into consideration previous quarters )</p>\n\n<p>note: once i record it. it looks like this in vba:</p>\n\n<p><code>Selection.FormulaR1C1 = _\n        \"=IF(AND(OR(RC[-6]={\"\"1\"\",\"\"2\"\",\"\"3\"\",\"\"4\"\",\"\"5\"\",\"\"6\"\",\"\"7\"\",\"\"8\"\",\"\"9\"\",\"\"10\"\",\"\"11\"\",\"\"12\"\",\"\"13\"\",\"\"14\"\",\"\"15 \"\",\"\"16 \"\"}),OR(RC[2]={\"\"Q1\"\",\"\"Q2\"\",\"\"Q3\"\",\"\"Q4\"\"})),CONCATENATE(RC[2],\"\" \"\",IF(RC[3]=\"\"p\"\",\"\"pre\"\",\"\"\"\"),\"\"-\"\",\"\" \"\",IF(\"&amp; _\n        \"\"\"\",0,RC[-7])),\"\"\"\")\"</code></p>\n\n<p>and yet, it gives me a syntax error...whats wrong?!</p>\n\n<p>thank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1481091093, "post_id": 41010429, "comment_id": 69228854, "body": "Have you attempted to solve this? I suggest to look into formulas like CELL, INDIRECT and string operators like MID, LEFT etc."}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 2284877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/041b5353112512851f3a4897b1b2ce26?s=128&d=identicon&r=PG", "display_name": "user2284877", "link": "https://stackoverflow.com/users/2284877/user2284877"}, "reply_to_user": {"reputation": 65, "user_id": 6177416, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1785fcb7427d011623588c690fe922ac?s=128&d=identicon&r=PG&f=1", "display_name": "David Syriac", "link": "https://stackoverflow.com/users/6177416/david-syriac"}, "edited": false, "score": 1, "creation_date": 1481271663, "post_id": 41015270, "comment_id": 69318583, "body": "for j=4 to ... / replace a with b ... etc"}], "tags": [], "owner": {"reputation": 138, "user_id": 2284877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/041b5353112512851f3a4897b1b2ce26?s=128&d=identicon&r=PG", "display_name": "user2284877", "link": "https://stackoverflow.com/users/2284877/user2284877"}, "is_accepted": false, "score": 1, "last_activity_date": 1481107272, "creation_date": 1481107272, "answer_id": 41015270, "question_id": 41010429, "link": "https://stackoverflow.com/questions/41010429/vba-to-pull-data-from-various-sheets-with-sheet-name/41015270#41015270", "title": "VBA to pull data from various sheets with sheet name", "body": "<p>Adjust this to your needs:       </p>\n\n<pre><code>Sub xxxxx()\nDim j As Integer\nx = Sheets.Count ' count no of sheets\nFor j = 1 To x - 1 \nRange(\"a\" &amp; j) = Worksheets(j + 1).Name ' main sheet must be the first, run code from main sheet\nNext\nEnd Sub      \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 6177416, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1785fcb7427d011623588c690fe922ac?s=128&d=identicon&r=PG&f=1", "display_name": "David Syriac", "link": "https://stackoverflow.com/users/6177416/david-syriac"}, "is_accepted": true, "score": 0, "last_activity_date": 1481530069, "creation_date": 1481530069, "answer_id": 41096527, "question_id": 41010429, "link": "https://stackoverflow.com/questions/41010429/vba-to-pull-data-from-various-sheets-with-sheet-name/41096527#41096527", "title": "VBA to pull data from various sheets with sheet name", "body": "<p>So the final codes will be </p>\n\n<p><code>Sub xxxxx()\nDim j As Integer\nx = Sheets.Count ' count no of sheets\nFor j = 4 To x + 2\nRange(\"B\" &amp; j) = Worksheets(j - 2).Name ' main sheet must be the first, run code from main sheet\nNext\nEnd Sub</code></p>\n"}], "owner": {"reputation": 65, "user_id": 6177416, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1785fcb7427d011623588c690fe922ac?s=128&d=identicon&r=PG&f=1", "display_name": "David Syriac", "link": "https://stackoverflow.com/users/6177416/david-syriac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 41096527, "answer_count": 2, "score": 0, "last_activity_date": 1487878393, "creation_date": 1481090406, "last_edit_date": 1487878393, "question_id": 41010429, "link": "https://stackoverflow.com/questions/41010429/vba-to-pull-data-from-various-sheets-with-sheet-name", "title": "VBA to pull data from various sheets with sheet name", "body": "<p>I have a workbook which consist of a main sheet \"Monthly collection reeport\" and few sheets with dates. I need to pull the data from all sheets (only total column C14-D14) to main sheet \"Monthly\" (C4-D14 ) one below other first column with sheet names in column B1-B13 respectively. </p>\n\n<p><a href=\"https://i.stack.imgur.com/OXrzQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OXrzQ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "datetime"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 1, "creation_date": 1481090057, "post_id": 41010229, "comment_id": 69228432, "body": "Hi there and welcome to Stackoverflow. This site is not a &quot;develop this code for me&quot; site but rather a site to help each other see where our code is not working.  What you are needed is achievable. Use a Loop which starts from the bottom of your list then inserts the number of rows depending on the value int the duration column, then divide the time difference by that number too and populate the times. Try is and post what you get here and we can have a look"}, {"owner": {"reputation": 5310, "user_id": 2134538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a1a0901a20851db89f15ddc3f38aa67?s=128&d=identicon&r=PG&f=1", "display_name": "MarmiK", "link": "https://stackoverflow.com/users/2134538/marmik"}, "edited": false, "score": 0, "creation_date": 1481092251, "post_id": 41010229, "comment_id": 69229265, "body": "You can apply shorting in VBA on first second and Third Column."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4882149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fG8hX.jpg?s=128&g=1", "display_name": "Srivathsan V", "link": "https://stackoverflow.com/users/4882149/srivathsan-v"}, "edited": false, "score": 0, "creation_date": 1481096406, "post_id": 41010963, "comment_id": 69231157, "body": "Thanks a lot Jean! However the below line was causing an error, which I commented it out. I believe it is to clear the result sheet before populating it. The code works just fine. Thanks a lot for your timely help  ResultSheet.Range(Cells(2, &quot;A&quot;), Cells(ResultSheet.Rows.Count, ResultSheet.Columns.Count)).Delete"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 33, "user_id": 4882149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fG8hX.jpg?s=128&g=1", "display_name": "Srivathsan V", "link": "https://stackoverflow.com/users/4882149/srivathsan-v"}, "edited": false, "score": 0, "creation_date": 1481100705, "post_id": 41010963, "comment_id": 69233432, "body": "@SrivathsanV good stuff, enjoy stackoverflow. Remember to mark correct and upvote the answers you select to your questions."}], "tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 0, "last_activity_date": 1481092747, "creation_date": 1481092747, "answer_id": 41010963, "question_id": 41010229, "link": "https://stackoverflow.com/questions/41010229/repeating-multiple-rows-multiple-times-in-excel-vba-with-calculations/41010963#41010963", "title": "Repeating Multiple Rows Multiple Times in Excel VBA, with Calculations", "body": "<p>In my testing this does exactly what you asked for.</p>\n\n<p>You will need to rename the Sheets depending on what your sheet names for the original data sheet name is and your output / result sheet name is.</p>\n\n<pre><code> Option Explicit\n\n Sub splittinghours()\n\n      Dim DataSheet As Worksheet\n      Dim ResultSheet As Worksheet\n      Set DataSheet = ThisWorkbook.Sheets(\"Sheet1\")\n      Set ResultSheet = ThisWorkbook.Sheets(\"Sheet2\")\n\n      Dim DataSheetLastRow As Long\n      With DataSheet\n          DataSheetLastRow = .Range(\"A1\").SpecialCells(xlCellTypeLastCell).Row\n      End With\n\n      Dim ActualWarehouse As String\n      Dim ActualDate As String\n      Dim InTime As Date\n      Dim OutTime As Date\n      Dim Duration As Long\n      Dim CurrentRow As Long\n      Dim DurationCounter As Long\n      Dim SegmentedDuration As Date\n      Dim ResultSheetNextFreeLine As Long\n\n      ResultSheet.Range(Cells(2, \"A\"), Cells(ResultSheet.Rows.Count, ResultSheet.Columns.Count)).Delete\n\n      ResultSheetNextFreeLine = 0\n\n      For CurrentRow = 2 To DataSheetLastRow\n\n           ActualWarehouse = DataSheet.Cells(CurrentRow, \"A\").Value\n           ActualDate = DataSheet.Cells(CurrentRow, \"B\").Value\n           InTime = DataSheet.Cells(CurrentRow, \"C\").Value\n           OutTime = DataSheet.Cells(CurrentRow, \"D\").Value\n           Duration = DataSheet.Cells(CurrentRow, \"E\").Value\n           SegmentedDuration = (OutTime - InTime) / Duration\n\n           ResultSheetNextFreeLine = ResultSheet.Cells(ResultSheet.Rows.Count, \"A\").End(xlUp).Row\n\n           For DurationCounter = 1 To Duration\n\n                With ResultSheet\n\n                    .Cells(ResultSheetNextFreeLine + DurationCounter, \"A\").Value = ActualWarehouse\n                    .Cells(ResultSheetNextFreeLine + DurationCounter, \"B\").Value = ActualDate\n                    .Cells(ResultSheetNextFreeLine + DurationCounter, \"C\").Value = InTime\n                    .Cells(ResultSheetNextFreeLine + DurationCounter, \"D\").Value = InTime + SegmentedDuration\n                     InTime = InTime + SegmentedDuration\n\n                End With\n\n           Next DurationCounter\n\n      Next CurrentRow\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4882149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fG8hX.jpg?s=128&g=1", "display_name": "Srivathsan V", "link": "https://stackoverflow.com/users/4882149/srivathsan-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "closed_date": 1481103125, "accepted_answer_id": 41010963, "answer_count": 1, "score": -5, "last_activity_date": 1481092747, "creation_date": 1481089419, "last_edit_date": 1481092178, "question_id": 41010229, "link": "https://stackoverflow.com/questions/41010229/repeating-multiple-rows-multiple-times-in-excel-vba-with-calculations", "closed_reason": "Needs details or clarity", "title": "Repeating Multiple Rows Multiple Times in Excel VBA, with Calculations", "body": "<p>I have an excel sheet with data as per the image below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/dtMY2.jpg\" alt=\"Input\"></p>\n\n<p>And I need to have it set out as follows:</p>\n\n<p><img src=\"https://i.stack.imgur.com/R64Y6.jpg\" alt=\"Output\"></p>\n\n<p>Could someone help me in coming up with an excel macro for this request, as there are numerous such rows and I am not so proficient with excel macros?</p>\n"}, {"tags": ["excel", "sap", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481089213, "post_id": 41009935, "comment_id": 69228115, "body": "You <i>might</i> be able to do this with the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633494(v=vs.85).aspx\" rel=\"nofollow noreferrer\">EnumChildWindows</a> and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633548(v=vs.85).aspx\" rel=\"nofollow noreferrer\">ShowWindow</a> API functions. You&#39;d need to check to make sure that you can hide the Logon window if it&#39;s modal though.  I can&#39;t remember offhand."}, {"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481090243, "post_id": 41009935, "comment_id": 69228489, "body": "Thanks Comintern, I will take a look into that."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1481143466, "post_id": 41011824, "comment_id": 69261312, "body": "Thanks Scriptman, this works great for the SAP Logon window. Do you have any ideas for my main problem using .iconify?"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1481183074, "post_id": 41011824, "comment_id": 69275742, "body": "I&#39;m so sorry. I do not know how to hide all windows in SAP GUI Scripting. I guess it does not work at all. Iconify is the only thing I know."}, {"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1481217268, "post_id": 41011824, "comment_id": 69297894, "body": "That&#39;s ok, thank you for your help! The answer you provided is useful for hiding the SAP Logon window."}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": false, "score": 1, "last_activity_date": 1481096366, "creation_date": 1481096366, "answer_id": 41011824, "question_id": 41009935, "link": "https://stackoverflow.com/questions/41009935/vba-2010-hide-all-sap-windows-using-iconify/41011824#41011824", "title": "VBA 2010 - Hide all SAP windows using .iconify", "body": "<p>I use a workaround for it.</p>\n\n<pre><code> bWindowFound = Wshell.AppActivate(\"SAP Logon\")\n  if bWindowFound then\n     Wshell.appActivate \"SAP Logon\"\n     WScript.Sleep 200\n     Wshell.sendkeys \"%{F4}\" \n     WScript.Sleep 200\n  end if\n</code></pre>\n\n<p>The window will not be closed, but it will land in the taskliste.</p>\n\n<p>Regards,\nScriptMan</p>\n"}], "owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2849, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1481096366, "creation_date": 1481087942, "last_edit_date": 1531164843, "question_id": 41009935, "link": "https://stackoverflow.com/questions/41009935/vba-2010-hide-all-sap-windows-using-iconify", "title": "VBA 2010 - Hide all SAP windows using .iconify", "body": "<p>below is code I have found online to log in to SAP to export data using VBA. I have tailored it to work for what I need it for and it works great. Just one problem, I can't seem to figure out how to hide ALL windows (including the Logon window) using .iconify.</p>\n\n<p>I have basically added <code>Session.findById(\"wnd[0]\").iconify</code> or <code>Session.findById(\"wnd[1]\").iconify</code> throughout the code; seems excessive. Most windows will flash open, then hide, but there are some that don't.</p>\n\n<p>It would be nice if there was a way to hide ALL windows completely, even to where they do not flash open. Any ideas?</p>\n\n<p>Also, the logon pad stays open but I have found a way to get rid of it using some API code. Is there a better way to do this?</p>\n\n<pre><code>Sub SAPextract()\nDim SAPGUI\nDim Applic\nDim connection\nDim Session\nDim WSHShell\n\nApplication.DisplayAlerts = False\n\nShell \"C:\\Program Files (x86)\\SAP\\FrontEnd\\SAPgui\\saplogon.exe\", vbNormalFocus\n\nSet WSHShell = CreateObject(\"WScript.Shell\")\n  Do Until WSHShell.AppActivate(\"SAP Logon \")\n    Application.Wait Now + TimeValue(\"0:00:01\")\n  Loop\n\nSet WSHShell = Nothing\nSet SAPGUI = GetObject(\"SAPGUI\")\nSet Applic = SAPGUI.GetScriptingEngine\nSet connection = Applic.OpenConnection(\"******\", True)\nSet Session = connection.Children(0)\n  Session.findById(\"wnd[0]\").iconify\n  Session.findById(\"wnd[0]/usr/txtRSYST-MANDT\").Text = \"100\"\n  Session.findById(\"wnd[0]/usr/txtRSYST-BNAME\").Text = ******\n  Session.findById(\"wnd[0]/usr/pwdRSYST-BCODE\").Text = ******\n  Session.findById(\"wnd[0]\").sendVKey 0\n'Session.findById(\"wnd[0]\").maximize\nSession.findById(\"wnd[0]\").iconify\nSession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"******\"\nSession.findById(\"wnd[0]\").sendVKey 0\n\n'Session.findById(\"wnd[0]\").maximize\nSession.findById(\"wnd[0]\").iconify\nSession.findById(\"wnd[0]/usr/btn[1]\").press\nSession.findById(\"wnd[1]\").iconify\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,0]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,1]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,2]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,3]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,4]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,5]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,6]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,7]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,7]\").SetFocus\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,7]\").caretPosition = 5\nSession.findById(\"wnd[1]/tbar[0]/btn[8]\").press\nSession.findById(\"wnd[0]\").iconify\nSession.findById(\"wnd[0]/usr/btn[17]\").press\nSession.findById(\"wnd[1]\").iconify\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,0]\").Text = \"******\"\nSession.findById(\"wnd[1]\").iconify\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,1]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,2]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,3]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,4]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,5]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,6]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,7]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE\").verticalScrollbar.Position = 1\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,7]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE\").verticalScrollbar.Position = 2\nSession.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssub/1/2/tblSAPLALDBSINGLE/ctxt[1,7]\").Text = \"******\"\nSession.findById(\"wnd[1]/tbar[0]/btn[8]\").press    \nSession.findById(\"wnd[0]\").iconify\nSession.findById(\"wnd[0]/usr/ctxt[48]\").Text = \"******\"\nSession.findById(\"wnd[0]/usr/txt[68]\").Text = \"******\"\nSession.findById(\"wnd[0]/tbar[1]/btn[8]\").press\nSession.findById(\"wnd[0]\").iconify\nSession.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").selectColumn \"******\"\nSession.findById(\"wnd[0]/tbar[1]/btn[40]\").press\nSession.findById(\"wnd[0]\").iconify\n\n'Export\nSession.findById(\"wnd[0]\").iconify\nSession.findById(\"wnd[0]\").sendVKey 21\nSession.findById(\"wnd[1]\").iconify\nSession.findById(\"wnd[1]/usr/rad[1]\").Select\nSession.findById(\"wnd[1]/usr/rad[0]\").Select\nSession.findById(\"wnd[1]\").iconify\nSession.findById(\"wnd[1]/tbar[0]/btn[0]\").press\nSession.findById(\"wnd[1]\").iconify\nSession.findById(\"wnd[1]/usr/ctxt[0]\").Text = \"******\"\nSession.findById(\"wnd[1]/usr/ctxt[1]\").Text = \"******\"\nSession.findById(\"wnd[1]/tbar[0]/btn[11]\").press\n\nSet Session = Nothing\n  connection.CloseSession (\"ses[0]\")\nSet connection = Nothing\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481088812, "post_id": 41009763, "comment_id": 69227959, "body": "Assigning <code>.Value</code> is essentially the same thing as &quot;Paste Values&quot;.  What do you expect the result to be when there&#39;s an existing formula in the target cell?"}], "answers": [{"tags": [], "owner": {"reputation": 140, "user_id": 3828905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JzFtQ.jpg?s=128&g=1", "display_name": "Roie R", "link": "https://stackoverflow.com/users/3828905/roie-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1481105544, "creation_date": 1481105544, "answer_id": 41014660, "question_id": 41009763, "link": "https://stackoverflow.com/questions/41009763/how-to-stop-every-time-cells-changing-to-value-after-coping-data-to-another-shee/41014660#41014660", "title": "How to stop every time cells changing to value after coping data to another sheet in EXCEL", "body": "<p>You can't write to a cell's <code>.Formula</code> and then add unrelated data to the same cell's <code>.Value</code> - writing to <code>.Value</code> deletes the formula.\nSo the following code line:</p>\n\n<pre><code>.Range(\"A\" &amp; x &amp; \":Y\" &amp; x).Value = .Range(\"A\" &amp; x &amp; \":Y\" &amp; x).Value\n</code></pre>\n\n<p>is unnecessary (and damaging).</p>\n"}], "owner": {"reputation": 39, "user_id": 7259240, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1213dbe9ae5dbc5b47f4c09c06b39475?s=128&d=identicon&r=PG&f=1", "display_name": "Mantas La", "link": "https://stackoverflow.com/users/7259240/mantas-la"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481105544, "creation_date": 1481086880, "last_edit_date": 1531164843, "question_id": 41009763, "link": "https://stackoverflow.com/questions/41009763/how-to-stop-every-time-cells-changing-to-value-after-coping-data-to-another-shee", "title": "How to stop every time cells changing to value after coping data to another sheet in EXCEL", "body": "<p>I would like to write perfectly working code but am faced with this issue. I want to transfer the data as values to another sheet. To fill out the data I use a form with formulas inside cells.</p>\n\n<p>Then every time I click to transfer the data to another sheet it replaces the source data with its values in both sheets, but for me need that forms cells in the <code>sheet1</code> stay unchanged. I use a form  with formula to put data in the <code>sheet1</code> from different sources, so it should work every time then I use it (now, after each click I have to recover formulas in the <code>sheet1</code>).</p>\n\n<p>Here is the code: </p>\n\n<pre><code>Sub Button4_Click()\n    Dim x As Long\n    Dim erow as Long\n\n'Calculate starting rows\nx = 15\nWith Worksheets(\"Sheet2\")\n    erow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nEnd With\n\nWith Worksheets(\"Sheet1\")\n    Do While .Cells(x, 1) &lt;&gt; \"\"\n        'Current code replaces the source data with its values'\n        .Range(\"A\" &amp; x &amp; \":Y\" &amp; x).Value = .Range(\"A\" &amp; x &amp; \":Y\" &amp; x).Value\n\n        'The next line copies values to Sheet2\n        Worksheets(\"Sheet2\").Range(\"A\" &amp; erow &amp; \":Y\" &amp; erow).Value = .Range(\"A\" &amp; x &amp; \":Y\" &amp; x).Value\n\n        'increment row counters\n        x = x + 1\n        erow = erow + 1\n    Loop\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "finance", "tax"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481082654, "post_id": 41008993, "comment_id": 69226169, "body": "Welcome to SO! I&#39;ve formatted the code and removed a bit of fluff from your post, but unfortunately your question is off-topic as worded. Questions asking &quot;what&#39;s wrong with my code?&quot; must <b>include the desired behavior</b>, a <b>specific problem</b> or error and the shortest code necessary to reproduce it in the question itself (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>). Questions without a clear problem statement are not useful to other readers."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481082691, "post_id": 41008993, "comment_id": 69226177, "body": "Your loop count <code>For i = 1 To UBound(sizeArray, 1)</code> assumes a 2D array, but you&#39;re only using 1 dimensional indexing:  <code>taxRates(i)</code>"}, {"owner": {"reputation": 13, "user_id": 7260198, "user_type": "registered", "profile_image": "https://graph.facebook.com/1365661583457864/picture?type=large", "display_name": "Dalton Hoover", "link": "https://stackoverflow.com/users/7260198/dalton-hoover"}, "edited": false, "score": 0, "creation_date": 1481082821, "post_id": 41008993, "comment_id": 69226219, "body": "Thank you for the warm welcome. I did change the title to say that I am needing help with the #VALUE error I am getting in excel when running my function. Is there anything else I need to change with my post?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481082928, "post_id": 41008993, "comment_id": 69226242, "body": "@DaltonHoover - Do you get a specific error? Does it highlight a specific line? How are you calling the function?  If you&#39;re passing ranges, what does the worksheet look like? What do you expect it to return for a specific input?  Etc.  A good start would be to place a breakpoint at the start of the function and step through it with the debugger."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1481083095, "post_id": 41008993, "comment_id": 69226277, "body": "The <code>#VALUE</code> error is masking the real problem, Excel is swallowing the real error. Try calling the function from the <i>immediate pane</i> (Ctrl+G) instead of from an Excel formula. F9 to set/remove a breakpoint, F8 to step through line by line. Once you get a real runtime error and know exactly which instruction is raising that error, <i>and you still have no idea why</i>, and Google doesn&#39;t turn up anything useful, <b>then</b> you have a SO question =)"}, {"owner": {"reputation": 13, "user_id": 7260198, "user_type": "registered", "profile_image": "https://graph.facebook.com/1365661583457864/picture?type=large", "display_name": "Dalton Hoover", "link": "https://stackoverflow.com/users/7260198/dalton-hoover"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481083375, "post_id": 41008993, "comment_id": 69226338, "body": "@Comintern -  I am expecting it to return a number. So I could have it As Double for the function, instead of As Variant, but thought that that could be a cause of the problem. I am getting the #VALUE error in excel, although no error in VBA and not highlighting a specific line of the code. Also, unsure on what you mean by how I am calling the function. Also, can you provide some more clarity on the 1D vs. 2D array part? I am very new to any kind of coding."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481083701, "post_id": 41008993, "comment_id": 69226410, "body": "Right, but what number for what inputs? The return type doesn&#39;t make any difference at all - literally <b><i>anything</i></b> can be returned as a <code>Variant</code>.  By calling the function, I mean something like &quot;I call it with <code>CalculateTax(3.14, $A$1:$A$10, $B$1:$B$10, 1.42, &quot;Yes&quot;, &quot;Yes&quot;)</code>&quot; and &quot;The data looks like this nicely formatted html (or screenshot)&quot;.  See <a href=\"http://stackoverflow.com/documentation/vba/3064/arrays/17455/multidimensional-arrays#t=201612070407493744662\">Documentation</a> for a brief explanation of how array dimensions work."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481083925, "post_id": 41008993, "comment_id": 69226473, "body": "Type <code>?CalculateTax(3.14, $A$1:$A$10, $B$1:$B$10, 1.42, &quot;Yes&quot;, &quot;Yes&quot;)</code> in the <i>immediate pane</i> (Ctrl+G - that <code>?</code> stands for <code>Print</code>, and means if the function runs without error, its result will be &quot;printed&quot; on the next line in the <i>immediate pane</i> - you can do <code>?2+2</code> to see how it outputs <code>4</code>), that will execute your function without Excel interfering with the execution."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481084136, "post_id": 41008993, "comment_id": 69226542, "body": "There&#39;s also a good primer for debugging in the <a href=\"http://stackoverflow.com/documentation/excel-vba/861/debugging-and-troubleshooting#t=201612070414486341641\">excel-vba Documentation</a>."}], "answers": [{"comments": [{"owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "edited": false, "score": 0, "creation_date": 1481095933, "post_id": 41011448, "comment_id": 69230935, "body": "^Looks like he might want to move that line within his for statement."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1481098075, "last_edit_date": 1481098075, "creation_date": 1481094815, "answer_id": 41011448, "question_id": 41008993, "link": "https://stackoverflow.com/questions/41008993/why-am-i-getting-a-value-error-in-excel-with-my-code-take-a-look-at-my-code/41011448#41011448", "title": "Why am I getting a #VALUE Error in excel with my code? Take a Look at My Code", "body": "<pre><code>AltTaxRate = taxRates(i) - 0.05\n</code></pre>\n\n<p>There's no <code>i</code> where you have this line.  </p>\n\n<p>If you haven't declared <code>i</code> then it will have a default value of zero, and your error is because <code>taxRates(0)</code> does not exist.</p>\n"}], "owner": {"reputation": 13, "user_id": 7260198, "user_type": "registered", "profile_image": "https://graph.facebook.com/1365661583457864/picture?type=large", "display_name": "Dalton Hoover", "link": "https://stackoverflow.com/users/7260198/dalton-hoover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1481098075, "creation_date": 1481081876, "last_edit_date": 1481094575, "question_id": 41008993, "link": "https://stackoverflow.com/questions/41008993/why-am-i-getting-a-value-error-in-excel-with-my-code-take-a-look-at-my-code", "title": "Why am I getting a #VALUE Error in excel with my code? Take a Look at My Code", "body": "<p>I am very stuck on this coding project and could really use some help.</p>\n\n<p>I am trying to write code that will calculate the taxes due on a person's income. In this model, my professor has given us a list of tax rates to use and a set of rules that change how taxes are calculated. I have worked on this for hours and can never get it to give me the correct answer.</p>\n\n<p>The function returns a <code>#VALUE</code> error in Excel, and I don't understand why.</p>\n\n<pre><code>'This function calculate the tax liability based on taxable income (AGI)\nFunction CalculateTax(taxableIncome As Variant, taxRates As Variant, _\n           taxThresholds As Variant, standardDeduction As Variant, _\n           personalException As Variant, AlternativeTaxSystem As Variant, _\n                                             bequest As Variant) As Variant\n'Initiate a variable to use to determine the size of taxRates - for some reason doing this directly doesn't work\nDim sizeArray As Variant\nsizeArray = taxRates\n'Initiate a variable for the alternative tax system\nDim AltTaxRate As Double\nAltTaxRate = taxRates(i) - 0.05\n'Initiate variable and calculate amount to apply to tax table, leaving out the deductions from the equation\nDim amountToTax As Double\namountToTax = taxableIncome\n'Initiate tax amount and set to zero\nDim taxAmount As Double\ntaxAmount = 0\n\n'loop over tax brackets, adding the incremental tax each time\nFor i = 1 To UBound(sizeArray, 1)\n    'Runs an if statement to check if all three conditions are met\n    If AlternativeTaxSystem = \"Yes\" And bequest = \"No\" And taxRates(i) &gt;= 0.2 Then\n        'Calculate the tax amount per bracket, based on the minimum of the bracket size or total tax minus the bracket threshold, with a true minimum at zero, and subtracting off 0.05 from the tax rates\n        taxAmount = taxAmount + Application.Max(Application.Min(taxThresholds(i + 1) - taxThresholds(i), amountToTax - taxThresholds(i)), 0) * AltTaxRate\n    ElseIf AlternativeTaxSystem = \"Yes\" And bequest = \"No\" And taxRates(i) &lt; 0.2 Then\n        taxAmount = taxAmount + Application.Max(Application.Min(taxThresholds(i + 1) - taxThresholds(i), amountToTax - taxThresholds(i)), 0) * taxRates(i)\n    ElseIf AlternativeTaxSystem = \"Yes\" And bequest = \"Yes\" And taxRates(i) &gt;= 0.2 Then\n        amountToTax = taxableIncome - 250000\n        taxAmount = taxAmount + Application.Max(Application.Min(taxThresholds(i + 1) - taxThresholds(i), amountToTax - taxThresholds(i)), 0) * AltTaxRate\n    ElseIf AlternativeTaxSystem = \"Yes\" And bequest = \"Yes\" And taxRates(i) &lt; 0.2 Then\n        amountToTax = taxableIncome - 250000\n        taxAmount = taxAmount + Application.Max(Application.Min(taxThresholds(i + 1) - taxThresholds(i), amountToTax - taxThresholds(i)), 0) * taxRates(i)\n    Else\n        amountToTax = taxableIncome - standardDeduction - personalException\n        taxAmount = taxAmount + Application.Max(Application.Min(taxThresholds(i + 1) - taxThresholds(i), amountToTax - taxThresholds(i)), 0) * taxRates(i)\n    End If\nNext i\n'output answer to function\nCalculateTax = taxAmount\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "multidimensional-array", "indexing", "match"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481082074, "post_id": 41008888, "comment_id": 69226014, "body": "Welcome to SO! Your question is rather unclear, please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> too - then <a href=\"https://stackoverflow.com/posts/41008888/edit\">edit</a> your post to make a question that&#39;s answerable without starting a TeamViewer session. Cheers!"}, {"owner": {"reputation": 21, "user_id": 7190089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cdc74605961c1b2f4d0f4e1a54d43f?s=128&d=identicon&r=PG&f=1", "display_name": "VOSS", "link": "https://stackoverflow.com/users/7190089/voss"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481083185, "post_id": 41008888, "comment_id": 69226297, "body": "I&#39;ve tried to explain as best I can, is there anything else I&#39;ve missed?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481083339, "post_id": 41008888, "comment_id": 69226327, "body": "Nice edits, I <i>think</i> I understand the question, but I still don&#39;t understand what you&#39;re trying to do - a cell can only have one value, how are you expecting a formula to &quot;return more than one value&quot;?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481083700, "post_id": 41008888, "comment_id": 69226408, "body": "Also, since you&#39;re using a <i>table</i>, your formula should use <a href=\"https://support.office.com/en-us/article/Using-structured-references-with-Excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e\" rel=\"nofollow noreferrer\"><i>structured references</i></a> that reference table columns by name, not range addresses. That way when the table grows you don&#39;t need to remember to modify the formula!"}, {"owner": {"reputation": 21, "user_id": 7190089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cdc74605961c1b2f4d0f4e1a54d43f?s=128&d=identicon&r=PG&f=1", "display_name": "VOSS", "link": "https://stackoverflow.com/users/7190089/voss"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481087651, "post_id": 41008888, "comment_id": 69227559, "body": "correct each cell only has one value, but in the table there are multiple values and I need the formula to spit out every value that matches the criteria, not just the first one in the list. I could place the formula in every cell on the results page but when it runs it is still only going to spit out the first result even though the cell above might have the same result. I need a version of the formula that returns all the matches, not just the first."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481088429, "post_id": 41008888, "comment_id": 69227813, "body": "The MATCH function can only return one result.  See the <a href=\"https://support.office.com/en-us/article/MATCH-function-e8dffd45-c762-47d6-bf89-533f4a37673a\" rel=\"nofollow noreferrer\">documentation here</a>. I&#39;d suggest trying to write a VBA function that doesn&#39;t stop at the first match. There are plenty of examples here on SO. <a href=\"http://stackoverflow.com/search?q=%5Bexcel-vba%5D+match+multiple\">This search should get you started</a>. If you run into <i>specific issues</i> in coding it, come back and ask them along with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 21, "user_id": 7190089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cdc74605961c1b2f4d0f4e1a54d43f?s=128&d=identicon&r=PG&f=1", "display_name": "VOSS", "link": "https://stackoverflow.com/users/7190089/voss"}, "edited": false, "score": 0, "creation_date": 1481088946, "post_id": 41008888, "comment_id": 69228026, "body": "so a function of this sort modified to look at both criteria and then output  =IFERROR(SMALL(IF(Sheet1!E:E=$E$1,ROW(Sheet1!E:E)-MIN(ROW(Sh&zwnj;&#8203;eet1!E:E))+1,&quot;&quot;),ROW&zwnj;&#8203;(A1)),&quot;&quot;) would not work?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481113048, "post_id": 41008888, "comment_id": 69241523, "body": "You need to write your own, in VBA."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7190089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cdc74605961c1b2f4d0f4e1a54d43f?s=128&d=identicon&r=PG&f=1", "display_name": "VOSS", "link": "https://stackoverflow.com/users/7190089/voss"}, "is_accepted": false, "score": 1, "last_activity_date": 1481170111, "creation_date": 1481170111, "answer_id": 41031612, "question_id": 41008888, "link": "https://stackoverflow.com/questions/41008888/excel-index-return-multiple-values-matching-multiple-criteria/41031612#41031612", "title": "Excel Index Return multiple values matching multiple criteria", "body": "<p>For anyone interested I figured out a function that doesn't require any VBA.</p>\n\n<pre><code>=IFERROR(INDEX(Data!$B$2:$B$280, SMALL(IF($A$8&amp;\" \"&amp;$B$8=Data!$A$2:$A$280, ROW(Data!$B$2:$B$280)-1,\"\"), ROW()-14)),\"\")\n</code></pre>\n\n<p>The first data in B column is the data I want returned if a match is found.</p>\n\n<p>The \"Small(IF(A...\" function is combining the two variables I want a match looked for. Ie. A=Australia &amp; B=GOLD etc etc and it'll look for a match on the next sheet.</p>\n\n<p>The \"ROW(Data...\" compares the value in cell A8 and B8 with each value in the range. If a match is found,  \"ROW(Data!$B$2:$B$280)-1\" returns the number of the corresponding row (-1 is used to deduct the header row). If the compared values do not match, the IF function returns an empty string.</p>\n\n<p>The  \"ROW()-14)),\"\"\" function acts as an incremental counter. Since the formula is copied into cells A15, we add -14 for the function to return 1 for cell A15 (row 15 minus 14), 15 for cell A16 (row 16 minus 15), etc</p>\n"}], "owner": {"reputation": 21, "user_id": 7190089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cdc74605961c1b2f4d0f4e1a54d43f?s=128&d=identicon&r=PG&f=1", "display_name": "VOSS", "link": "https://stackoverflow.com/users/7190089/voss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1421, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1481170111, "creation_date": 1481081094, "last_edit_date": 1481092775, "question_id": 41008888, "link": "https://stackoverflow.com/questions/41008888/excel-index-return-multiple-values-matching-multiple-criteria", "title": "Excel Index Return multiple values matching multiple criteria", "body": "<p>Index and Match wont return multiple values need to find a way, whether thats a function or VBA. </p>\n\n<p>Essentially I have an Index and Match function that looks at two variables and then returns the corresponding Company that matches from a different sheet.</p>\n\n<p>i.e you select \"Australia\" from a drop down and then \"GOLD\" from another drop down then the Index and Match will pull a company from another sheet that operates in Australia and mines Gold.\nSo far the function works but It only returns the first result and there may be more than one company and I haven't figured out how to return more than one result. </p>\n\n<p>The code so far is as follows:</p>\n\n<pre><code>=INDEX(Datapage!B$2:B$280,MATCH(1,(A$8=Datapage!$C$2:$C$280) * (B$8=Sheet11!$D$2:$D$280),0))\n</code></pre>\n\n<p>I have also tried this one:</p>\n\n<p>=IFERROR(INDEX(Table26[[Location]:[Commodity]],SMALL(IF(Table26[Location]=$B8,ROW(Table26[Commodity])-ROW($D$2)+1),COLUMNS($B14:B14))),\"\")\nthe Data sheet has values in B2 - D280 </p>\n\n<p>But nothing happens and it only searches off one variable which is useless for this need. </p>\n\n<p>B being Company name</p>\n\n<p>C being Location </p>\n\n<p>D being Commodity </p>\n\n<p>I've attached some pictures for clarification </p>\n\n<p>this is what the sheets look like </p>\n\n<p><img src=\"https://i.stack.imgur.com/rPDJw.png\" alt=\"Data page containing the names of companies\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/13h2v.png\" alt=\"Search page\"></p>\n\n<p>Any help would be greatly appreciated!\nThanks </p>\n"}, {"tags": ["excel", "vba", "find"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481081620, "post_id": 41008736, "comment_id": 69225894, "body": "<code>Found</code> variable doesn&#39;t contain a <code>String</code>, you&#39;ve declared it <code>As Range</code>, so it contains a <code>Range</code> object reference. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx\" rel=\"nofollow noreferrer\">A <code>Range</code> has an <code>Address</code> property</a> - use it. The string content you&#39;re seeing is the range&#39;s <code>Value</code>, which is the <i>default property</i> (i.e. the member that&#39;s implicitly referred to when no member is specified)."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1481080911, "post_id": 41008824, "comment_id": 69225706, "body": "<code>Find</code> can return <code>Nothing</code>, so tacking <code>.Address</code> onto the end of it is <a href=\"http://stackoverflow.com/search?q=%5Bexcel-vba%5D+find+error+91\">just begging for a run-time error 91</a>.  <code>Find</code> should always be set to a temporary <code>Range</code> object and tested against <code>Nothing</code> before any of the properties are used."}, {"owner": {"reputation": 199, "user_id": 2606653, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e08d03a0f7e0a3e13c7c962fad4cad86?s=128&d=identicon&r=PG", "display_name": "Randy Adhitama", "link": "https://stackoverflow.com/users/2606653/randy-adhitama"}, "edited": false, "score": 0, "creation_date": 1481082024, "post_id": 41008824, "comment_id": 69226006, "body": "Hi @nightcrawler23 thanks for your feedback. Is there any way to get the row and column from &quot;ra.Address&quot; seperately? I want to apply it into cells selection (Ex: Cells(1,2))"}, {"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1481082160, "post_id": 41008824, "comment_id": 69226031, "body": "A Range has row and column properties. So you can use ra.Row and ra.Column to get the values. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx#Anchor_3\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff838238.aspx#Anchor&zwnj;&#8203;_3</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 199, "user_id": 2606653, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e08d03a0f7e0a3e13c7c962fad4cad86?s=128&d=identicon&r=PG", "display_name": "Randy Adhitama", "link": "https://stackoverflow.com/users/2606653/randy-adhitama"}, "edited": false, "score": 1, "creation_date": 1481082326, "post_id": 41008824, "comment_id": 69226069, "body": "@RandyAdhitama when you type the <code>.</code> dot after <code>ra</code>, there should be a little in-place dropdown (that&#39;s <i>IntelliSense</i>) showing you all the available members. Explore a bit. Research the members online when you&#39;re not sure what they do - <i>everything</i> is thoroughly documented. You can also use the <i>object browser</i> (F2 in the VBE editor) to browse all the types and members in all referenced libraries."}], "tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": true, "score": 11, "last_activity_date": 1481081297, "last_edit_date": 1481081297, "creation_date": 1481080577, "answer_id": 41008824, "question_id": 41008736, "link": "https://stackoverflow.com/questions/41008736/how-to-get-cell-address-from-find-function-in-excel-vba/41008824#41008824", "title": "How to get cell address from Find function in Excel VBA", "body": "<p>It seems you can just use <code>found.address</code> even though it shows as string. The below code worked for me.</p>\n\n<pre><code>Sub findCellAddress()\n\n    Dim ra As Range\n\n    Set ra = Cells.Find(What:=\"fff\", LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\n\n    If ra Is Nothing Then\n        MsgBox (\"Not found\")\n        Else\n        MsgBox (ra.Address)\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 756, "user_id": 2040023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3781c26eee05ffc874b134ea0e55762f?s=128&d=identicon&r=PG", "display_name": "John Joseph", "link": "https://stackoverflow.com/users/2040023/john-joseph"}, "edited": false, "score": 0, "creation_date": 1616622319, "post_id": 57484525, "comment_id": 118064427, "body": "This answer is useful but could use some work. You could put in the variable type declarations but also I believe ThisRow actually gets the column and ThisColumn gets the row."}], "tags": [], "owner": {"reputation": 31, "user_id": 11924206, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q9q2lWMjcQ0/AAAAAAAAAAI/AAAAAAAAGM8/T5-0Ei-izFM/photo.jpg?sz=128", "display_name": "James Greaves", "link": "https://stackoverflow.com/users/11924206/james-greaves"}, "is_accepted": false, "score": 3, "last_activity_date": 1565726504, "last_edit_date": 1565726504, "creation_date": 1565726188, "answer_id": 57484525, "question_id": 41008736, "link": "https://stackoverflow.com/questions/41008736/how-to-get-cell-address-from-find-function-in-excel-vba/57484525#57484525", "title": "How to get cell address from Find function in Excel VBA", "body": "<p>I could not find this anywhere ON THE Internet. \nThis code will give you the Row AND Column.</p>\n\n<pre><code>    Dim ThisPos As Range\n    With Range(\"A1:J100\")\n        Set ThisPos  = .Find(What:=\"List_Position\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        If Not ThisPos  Is Nothing Then\n            Cell_Add= Split(ThisPos.Address, \"$\")\n            ThisRow = Cell_Add(1)\n            ThisCol = Cell_Add(2)\n        End If\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14751806, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8xAHoL7LNpw/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckJyNQekyrTzMWLNhVPM6fvZxGPyQ/s96-c/photo.jpg?sz=128", "display_name": "Roman Szab&#243;", "link": "https://stackoverflow.com/users/14751806/roman-szab%c3%b3"}, "is_accepted": false, "score": 0, "last_activity_date": 1606942250, "creation_date": 1606942250, "answer_id": 65115936, "question_id": 41008736, "link": "https://stackoverflow.com/questions/41008736/how-to-get-cell-address-from-find-function-in-excel-vba/65115936#65115936", "title": "How to get cell address from Find function in Excel VBA", "body": "<p>This code will give you reference style of the cell address.</p>\n<pre><code> Dim SValue As Range\n   With Range(&quot;D1:D100&quot;)\n\n    Set SValue = .Find(What:=&quot;Searched Value&quot;, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    \n    If Not SValue Is Nothing Then\n        Cell_Split_R = Split(SValue.Address(ReferenceStyle:=xlR1C1), &quot;R&quot;)\n        Cell_Split_C = Split(Cell_Split_R(1), &quot;C&quot;)\n        SCol = Cell_Split_C(0)\n        SRow = Cell_Split_C(1)\n        \n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 2606653, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e08d03a0f7e0a3e13c7c962fad4cad86?s=128&d=identicon&r=PG", "display_name": "Randy Adhitama", "link": "https://stackoverflow.com/users/2606653/randy-adhitama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81191, "favorite_count": 0, "accepted_answer_id": 41008824, "answer_count": 3, "score": 4, "last_activity_date": 1606942250, "creation_date": 1481079910, "last_edit_date": 1568354325, "question_id": 41008736, "link": "https://stackoverflow.com/questions/41008736/how-to-get-cell-address-from-find-function-in-excel-vba", "title": "How to get cell address from Find function in Excel VBA", "body": "<p>How do I get cell address using Find function.</p>\n\n<p>Here's the code</p>\n\n<pre><code>Dim Found As Range\n\nSet Found = Worksheets(\"Sheet 1\").Cells.Find(What:=\"test\", LookAt:=xlWhole, MatchCase:=True)\n\nIf Not Found Is Nothing Then\n    ' do something\nEnd If\n</code></pre>\n\n<p>When I debug the code, \"Found\" variable contain a \"string\" instead of cell address.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013", "excel-2013"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1481098942, "post_id": 41007418, "comment_id": 69232351, "body": "Why not just link the csv file? Then you don&#39;t have to delete anything, and if you run the import/link wizard adjusting settings for the fields, these will be preserved when you replace the csv file."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1481099352, "post_id": 41007418, "comment_id": 69232571, "body": "And - referring to the title - there is, per definition, no order of the records in a table, only the order you define yourself. So create a simple select query to pull the data from the linked table and define basic sorting, filtering, and converting in this. Then use this query for all your further processing."}, {"owner": {"reputation": 11, "user_id": 7259730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff8ff4db4ae1a220481c7084f50a2b0a?s=128&d=identicon&r=PG", "display_name": "DSpart", "link": "https://stackoverflow.com/users/7259730/dspart"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1481142959, "post_id": 41007418, "comment_id": 69261060, "body": "Knew I was missing something simple! I&#39;d dismissed the idea of linking in my head as it didn&#39;t preserve the formatting from excel, so never came back to that for the csv&#39;s.  Thanks a lot, appreciate the help!"}], "owner": {"reputation": 11, "user_id": 7259730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff8ff4db4ae1a220481c7084f50a2b0a?s=128&d=identicon&r=PG", "display_name": "DSpart", "link": "https://stackoverflow.com/users/7259730/dspart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481070717, "creation_date": 1481070717, "last_edit_date": 1592644375, "question_id": 41007418, "link": "https://stackoverflow.com/questions/41007418/importing-csv-with-record-order-intact", "title": "Importing CSV with record order intact", "body": "<p>I'm trying to achieve what I understand should be a fairly simple task, but I'm just not seeing how to fix it.</p>\n<p>I have a database in Excel, which I would like to also have in Access, keeping the .xls as a master file (not my choice, this is what I've been told to do). My current thought process is that a user can save the Excel database as a .CSV (this preserves the &quot;look&quot; of custom formatting used quite frequently in the Excel sheet), then open Access and hit a command button which will import the CSV, overwriting/updating data in an already existing table.The basic import code for Access is:</p>\n<pre><code>Function ImportLineLists()\n    DoCmd.DeleteObject Table, &quot;__&quot;\n    DoCmd.TransferText acImportDelim, &quot;__&quot;, _\n    &quot;__&quot;, &quot;__&quot;\nEnd Function\n</code></pre>\n<p>Where __  is just where I've omitted actual file/table names as they include slightly sensitive info. My issue is that when I import the CSV using this function, it ignores the primary key I setup in the import spec (not creating a field for it at all, when it appears in the CSV normally), and indents the fields by 1 column.</p>\n<p>E.g:      <a href=\"https://i.stack.imgur.com/Fk0mr.png\" rel=\"nofollow noreferrer\">Example</a></p>\n<p>The IDNUM field gets deleted/omitted, and its values are moved across to the Site Code field. Am I missing something extremely obvious? Any help is much appreciated! (:</p>\n"}, {"tags": ["vba", "excel", "foreach"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6759139, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1fd7dcb8be8c4bfdd61ef9d7fc9d9826?s=128&d=identicon&r=PG&f=1", "display_name": "penfold255", "link": "https://stackoverflow.com/users/6759139/penfold255"}, "edited": false, "score": 1, "creation_date": 1481069764, "post_id": 41007213, "comment_id": 69222943, "body": "It does as you describe perfectly, using offset did work as I needed it to. I didn&#39;t need the other for, as you suggested. Much appreciated."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1481069348, "creation_date": 1481069348, "answer_id": 41007213, "question_id": 41007106, "link": "https://stackoverflow.com/questions/41007106/vba-nesting-for-each-for-pdf/41007213#41007213", "title": "VBA nesting for each for PDF", "body": "<p>You dont need two loops, just one to iterate on the <code>K</code> column. At each iteration you retrieve the corresponding value in <code>L</code> by using ``Offset.</p>\n\n<pre><code>For Each c In Range(\"Rng\")\n    Set f  = c.Offset(, 1)\n    ' ...\n    ' do the work. I cant verify if the code inside your loop\n    ' does the intended work. But this quick fix should solve the\n    ' 16 values issue. Now you should have only 4 records to work on. \nNext\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6759139, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1fd7dcb8be8c4bfdd61ef9d7fc9d9826?s=128&d=identicon&r=PG&f=1", "display_name": "penfold255", "link": "https://stackoverflow.com/users/6759139/penfold255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 41007213, "answer_count": 1, "score": 1, "last_activity_date": 1481069348, "creation_date": 1481068618, "last_edit_date": 1531164843, "question_id": 41007106, "link": "https://stackoverflow.com/questions/41007106/vba-nesting-for-each-for-pdf", "title": "VBA nesting for each for PDF", "body": "<p>I am having a problem in this output. It seems to mostly working but I am missing a step somewhere.</p>\n\n<p>In the below code:\nK4 to K7 is number codes and l4 to l7 is some word names - 4 records\nIm trying to output this to PDF and it should only have 4 records however for some reason it outputs repeated versions, 16 in total. I know the loops are wrong. Anyway to fix this?</p>\n\n<pre><code>Sub foreachtest2()\nApplication.ScreenUpdating = False\nDim c As Range\nDim f As Range\n\n\n\nSheets(\"Lookup Table\").Range(\"K4:K7\").Name = \"Rng\"\nSheets(\"Lookup Table\").Range(\"L4:L7\").Name = \"RngName\"\n\n\nFor Each c In Range(\"Rng\")\n    For Each f In Range(\"RngName\")\n\n    Sheets(\"Site Report\").Select\n    Range(\"D7\").Select\n    ActiveCell.FormulaR1C1 = c.Value\n\n\n\n\nSheets(\"Site Report\").Select\n Range(\"A1:M78\").Select\n ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"C:\\path\" &amp; f.Value &amp; c.Value &amp; \".pdf\", Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, IgnorePrintAreas:=False\n\nNext\nNext\n\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7259428, "user_type": "registered", "profile_image": "https://graph.facebook.com/1292980937401654/picture?type=large", "display_name": "Barbara Ines Gonzalez Jorge", "link": "https://stackoverflow.com/users/7259428/barbara-ines-gonzalez-jorge"}, "is_accepted": false, "score": 0, "last_activity_date": 1481775294, "creation_date": 1481775294, "answer_id": 41156324, "question_id": 41006901, "link": "https://stackoverflow.com/questions/41006901/vba-code-execution-stop-when-macro-is-started-from-custom-tab-or-activex-butto/41156324#41156324", "title": "vba, code execution stop when macro is started from custom tab, or activeX button, but not when sheet form button", "body": "<p>There is no solution to that: if you execute a macro and that macro closes the workbook that started the macro, the lines after closing will not be executed. So, as I was working with several workbooks, the right way to go was to create and Addin, so that way the macro is not called from my workbook, but from the addin, and because the addin is open all the time I could safely close the workbook and the macro will continue. Thanks to Andy Pope with the idea and for the visual ribbon editor.</p>\n"}], "owner": {"reputation": 1, "user_id": 7259428, "user_type": "registered", "profile_image": "https://graph.facebook.com/1292980937401654/picture?type=large", "display_name": "Barbara Ines Gonzalez Jorge", "link": "https://stackoverflow.com/users/7259428/barbara-ines-gonzalez-jorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481775294, "creation_date": 1481067397, "last_edit_date": 1481255087, "question_id": 41006901, "link": "https://stackoverflow.com/questions/41006901/vba-code-execution-stop-when-macro-is-started-from-custom-tab-or-activex-butto", "title": "vba, code execution stop when macro is started from custom tab, or activeX button, but not when sheet form button", "body": "<p>I've been searching for hours but I can't find any answer. I hope someone can help me. \nI have a workbook with all the data and macros let's name it \"wbCurrent\", but I use a macro in the PERSONAL.XLSB workbook to save the wbCurrent with another name, let's say 06-12-2016, in other location. Then I close it(the rename one) and reopen the original wbCurrent again. This macro works perfectly when I call it from a button in the sheet. But recently I modify the excel with custom tab and buttons, but when I call the macro from there, the code stop without error when I close the wbCurrent. I try using an ActiveX button and the problem shows again. I put a form control button and it run ok. What could this be? I really want to use my pretty custom tab. This is what the macro do essentially, remember it is located in PERSONAL</p>\n\n<pre><code>Sub New()\n' do some changes in wbCurrent\nwbCurrent.Save\noldwb = wbCurrent.SaveAs (different location, diferent name)\n' Do some change\noldwb.Save\n' here is where it stop executing only when call from activeX or custom tab\noldwb.Close\nwbCurrent=nothing\nwbCurrent=Open FileName.....\n'Do some change\nwbCurrent.save\nend Sub\n</code></pre>\n\n<p>Thank u in advance\nBarby\nPD the macro is called from wbCurrent via Application.Run \"PERSONAL.XlBS!New\"</p>\n\n<p>update \nI made this test to be sure of the problem\nI put a macro in personal.xlsb with 2 lines of code: 1 close the\nworkbook that call the macro, and 2 shows a message. In an empty\nworkbook I call that macro from 3 different places: control form\nbutton in the sheet, activeX button in the sheet and a button in a\ncustom tab created with an editor. You can only see the message when\nyou call the macro from the first choice, in the others the execution\nsimply ends when the original wookbook is closed, despite the personal\nworkbook is open all the time. Ah, you also see the message when you\nexecute it directly from vba editor.\nIt seem to be something related with who has the control or ownership\nof the macro, but i can't find anything in Application object that\nseem to be related to that.\nAny ideas, please!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 0, "last_activity_date": 1481067904, "creation_date": 1481067904, "answer_id": 41006992, "question_id": 41006835, "link": "https://stackoverflow.com/questions/41006835/replacing-variable-text-via-vba/41006992#41006992", "title": "Replacing variable text via VBA", "body": "<p>Avoid using <code>.Select</code> method. Try the below code:</p>\n\n<pre><code>Sub Test()\n\n    With Sheets(\"Roulette Summary\")\n        .Columns(\"J:J\").Replace _\n            What:=.Range(\"A1\").Value, _\n            Replacement:=.Range(\"A2\").Value, _\n            LookAt:=xlPart, _\n            SearchOrder:=xlByRows, _\n            MatchCase:=False, _\n            SearchFormat:=False, _\n            ReplaceFormat:=False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Put the string to be replaced into cell <code>A1</code>, and replacement string into <code>A2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1481067952, "creation_date": 1481067952, "answer_id": 41007003, "question_id": 41006835, "link": "https://stackoverflow.com/questions/41006835/replacing-variable-text-via-vba/41007003#41007003", "title": "Replacing variable text via VBA", "body": "<p>Avoid <code>Select</code> where possible. Set a variable to the value of a cell in your workbook. This can be on a different sheet. Then something like</p>\n\n<pre><code>Sub test()\nDim FindMe As String, UseMe As String\n\nFindMe = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value\nUseMe = \"Colin\"\n\nThisWorkbook.Worksheets(\"Roulette Summary\").Range(\"J:J\").Replace _\n    What:=FindMe, Replacement:=UseMe, LookAt:=xlPart _\n    , SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nEnd Sub\n</code></pre>\n\n<p>If you set variables at the top of your code, it will be easy and quick to make changes to their values, so you don't have to find and replace stuff deep in your code.</p>\n"}], "owner": {"reputation": 1, "user_id": 7259600, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155452592357506/picture?type=large", "display_name": "Colin", "link": "https://stackoverflow.com/users/7259600/colin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2570, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481067952, "creation_date": 1481066997, "last_edit_date": 1531164843, "question_id": 41006835, "link": "https://stackoverflow.com/questions/41006835/replacing-variable-text-via-vba", "title": "Replacing variable text via VBA", "body": "<p>I have very little knowledge of VBA and tend to record macros through EXCEL and work from there.  I have recorded this macro but instead of replacing specific text I want it to replace text found in any formulas with the text found in a specific cell</p>\n\n<pre><code>Sheets(\"Roulette Summary\").Select\nColumns(\"J:J\").Select\nSelection.Replace What:=\"Test case\", Replacement:=\"Colin\", LookAt:=xlPart _\n    , SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n\n<p>So instead of looking for the specific text string 'Test Case' I want it to look for a text string I have inputted in a cell and replace it with another text string in another cell</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1481066405, "post_id": 41006634, "comment_id": 69221889, "body": "You can&#39;t <code>ReDim Preserve w(k, 1)</code>.  Only the highest dimension can change with <code>ReDim Preserve</code>.  Since you only use 1 for the upper dimension, just transpose the arrays."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481070484, "post_id": 41006634, "comment_id": 69223146, "body": "You could get rid of the dimensions of <code>w</code> entirely by just making it a <code>Long</code> instead of an array of <code>Long</code>, initialising it to <code>-2,147,483,648</code> and then using <code>If z(i, 1) &gt; w Then w = z(i, 1)</code>.  That then gets rid of the need for <code>Application.Max</code> too.  (But I don&#39;t like the fact that <code>w</code> is declared to be a <code>Long</code> anyway - it will undoubtedly confuse people who use the function.)"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1481068337, "last_edit_date": 1481068337, "creation_date": 1481066978, "answer_id": 41006830, "question_id": 41006634, "link": "https://stackoverflow.com/questions/41006634/user-defined-function-to-emulate-max-ifs-in-vba-2010/41006830#41006830", "title": "User defined function to emulate Max.ifs in VBA 2010", "body": "<p>Two things to fix the code:</p>\n\n<p>1) Change <code>z() as long</code> into <code>z() as Variant</code></p>\n\n<p>2) You cannot <code>redim w</code> the way you are doing (with a 2D array). However, you can avoid this headache by making <code>w</code> a single-dimension array, since you are simply keeping simple values in it in order to call <code>Application.Max</code>...</p>\n\n<pre><code> ReDim Preserve w(k)\n w(k) = z(i, 1)\n ....\n MaxIf = application.max(w)\n</code></pre>\n\n<p>The UDF worked well for me after these changes.</p>\n"}], "owner": {"reputation": 531, "user_id": 6254149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1UvBh.jpg?s=128&g=1", "display_name": "Moreno", "link": "https://stackoverflow.com/users/6254149/moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "accepted_answer_id": 41006830, "answer_count": 1, "score": -1, "last_activity_date": 1507903520, "creation_date": 1481065855, "last_edit_date": 1531164843, "question_id": 41006634, "link": "https://stackoverflow.com/questions/41006634/user-defined-function-to-emulate-max-ifs-in-vba-2010", "title": "User defined function to emulate Max.ifs in VBA 2010", "body": "<p>I'm trying to create a function to calculate the maximum of a range based on 2 criteria, just like Excel's 2016 function (MAX.IFS) do, as far as I know I am doing it ok but it returns #VALUE error.</p>\n\n<p>Could you help me?</p>\n\n<pre><code>Option Base 1\nFunction MaxIf(RangoUno As Range, RangoDos As Range, RangoTres As Range, RUno As Variant, RDos As Variant) As Variant\nDim x() As Variant, y() As Variant, z() As Long, w() As Long\nDim i As Long\nDim ConstraintUno As Variant, ConstraintDos As Variant, k As Long\ni = 1\nk = 0\nConstraintUno = RUno\nConstraintDos = RDos\n x = RangoUno 'Rango que contiene la primera restricci\u00f3n\n y = RangoDos  'Rango que contiene la segunda restricci\u00f3n\n z = RangoTres 'Rango que contiene los valores numericos\n  For i = 1 To RangoUno.Rows.Count\n   If x(i, 1) = RUno Then\n    If y(i, 1) = RDos Then\n    k = k + 1\n    ReDim Preserve w(k, 1)\n     w(k, 1) = z(i, 1) ' w() es una matriz que almacena los valores numericos en cuya fila cumpla con las rectricciones 1 y 2\n      End If\n    End If\n   Next i\nMaxIf = application.max(w)\nEnd Function\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 305, "user_id": 6435422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebd2c80f456dc3596617b2d8505f70b?s=128&d=identicon&r=PG&f=1", "display_name": "Lybren", "link": "https://stackoverflow.com/users/6435422/lybren"}, "edited": false, "score": 0, "creation_date": 1481117599, "post_id": 41006549, "comment_id": 69244728, "body": "Hi, instead of left use trim function. Also, are your [Accessibility feature] numeric or strings?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4107403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819de508e0fee11001b85cac5a2e94cc?s=128&d=identicon&r=PG&f=1", "display_name": "tecwhizz", "link": "https://stackoverflow.com/users/4107403/tecwhizz"}, "edited": false, "score": 0, "creation_date": 1481154724, "post_id": 41020338, "comment_id": 69266475, "body": "That seemed to do the trick! Thanks. To get it to work the way I wanted, I also added a Name for the query, ran the script and then created a Report for the new query before deleting the new query and adding the lines <code>DoCmd.OpenReport &quot;...&quot;, acViewPreview</code> and <code>DoCmd.DeletObject acQuery&quot;...&quot;</code> Again, very grateful for the help!!!"}], "tags": [], "owner": {"reputation": 305, "user_id": 6435422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebd2c80f456dc3596617b2d8505f70b?s=128&d=identicon&r=PG&f=1", "display_name": "Lybren", "link": "https://stackoverflow.com/users/6435422/lybren"}, "is_accepted": true, "score": 0, "last_activity_date": 1481121756, "creation_date": 1481121756, "answer_id": 41020338, "question_id": 41006549, "link": "https://stackoverflow.com/questions/41006549/using-a-lookup-field-to-filter-a-report-or-query-in-access/41020338#41020338", "title": "Using a lookup field to filter a report or query in Access", "body": "<p>Ok, you got it halfway right. You can feed parameters to a query, one value for each parameter that the query uses.<br>\nIn your query, you are using just one parameter, and you are assigning it a string. This is not the proper way to use parameters. You would better build an SQL select and filter it based on the string you created.  </p>\n\n<pre><code>Dim qdf As QueryDef\nDim rst As Recordset\nSet qdf = CurrentDb.CreateQueryDef(\"\", \"SELECT * from tblBuildingFeatures WHERE [Accessibility Features]=\" &amp; strWhere &amp; \";\")\nSet rst = qdf.OpenRecordset\n</code></pre>\n\n<p>That will filter the query.</p>\n"}], "owner": {"reputation": 5, "user_id": 4107403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819de508e0fee11001b85cac5a2e94cc?s=128&d=identicon&r=PG&f=1", "display_name": "tecwhizz", "link": "https://stackoverflow.com/users/4107403/tecwhizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 41020338, "answer_count": 1, "score": 0, "last_activity_date": 1481121756, "creation_date": 1481065417, "last_edit_date": 1481083878, "question_id": 41006549, "link": "https://stackoverflow.com/questions/41006549/using-a-lookup-field-to-filter-a-report-or-query-in-access", "title": "Using a lookup field to filter a report or query in Access", "body": "<p>I've been looking for a while to see whether it is possible to limit the results in a report by using a lookup field in a form. First, a little context. I'm making a database to store accessibility information for buildings at a University for the Union. I need to be able to produce a report showing what user-selected qualities a building has, like ramp access or a staffed reception.</p>\n\n<p>I've stored all these features in a table of their own so users can edit them, and then used lookup fields to select these features for buildings. The issue now is running the query to produce the report.\nIf I hard code in values to the query like <code>...WHERE [Buildings].[Accessibility Features].Value = 2 AND [Buildings].[Accessibility Features].Value = 8;</code> I get sensible results. If I use the <code>IN()</code> function (which I have got to work with the field using the <code>DoCmd.OpenReport()</code> function) I get returned all buildings that have <em>either</em> feature 2 <strong>or</strong> feature 8 which isn't that handy. The aforementioned <code>DoCmd.OpenReport()</code> function doesn't appear to work when stringing together AND statements.</p>\n\n<p>I've tried using VBA to assemble the SQL code as follows (feeding a parameter into the Criteria box preceded by the appropriate statement):</p>\n\n<pre><code>If Me.BuildingFeatSelect.ItemsSelected.Count = 0 Then\n    MsgBox \"Must select at least one feature\"\n    Exit Sub\nEnd If\n\nSet ctl = Me.BuildingFeatSelect\nFor Each varItem In ctl.ItemsSelected\n    strWhere = strWhere &amp; ctl.ItemData(varItem) &amp; \" AND Buildings.[Accessibility Features].Value = \"\nNext varItem\n\nstrWhere = Left(strWhere, Len(strWhere) - 48)\nMsgBox strWhere, , Output\n\nDim qdf As QueryDef\nDim rst As Recordset\nSet qdf = CurrentDb.QueryDefs(\"Copy of Building Features 2\")\nqdf.Parameters(0) = strWhere\nSet rst = qdf.OpenRecordset\n\nrst.Close\nqdf.Close\nSet rst = Nothing\nSet qdf = Nothing\n</code></pre>\n\n<p>This gets me nowhere quickly. It just throws an error about parameter types. I've tried setting the type using the Parameter window but this doesn't work.</p>\n\n<p>Is there an efficient way to generate a report based on multiple entries in a lookup box?</p>\n\n<p>Thanks for your help, and sorry for the long question.</p>\n"}, {"tags": ["vba", "excel", "excel-2013", "worksheet-function"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1481065521, "post_id": 41006504, "comment_id": 69221557, "body": "it looks like youre trying to incorrectly use worksheet formalus - i could be wrong though"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1481066697, "post_id": 41006757, "comment_id": 69221997, "body": "I get a compile error.  Syntax Error.  Thank you for the valuable insight on getting formula to work correctly in the worksheet before attempting to put it together in VBA!"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1481067023, "post_id": 41006757, "comment_id": 69222119, "body": "I moved the quote from before Totals to after the closing paren and it compiles, and runs, but the worksheet shows #Name? for everything."}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1481068695, "post_id": 41006757, "comment_id": 69222677, "body": "Yes, if it matters that is the first sheet in the workbook"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1481069579, "post_id": 41006757, "comment_id": 69222900, "body": "just added file of garbage data"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "edited": false, "score": 0, "creation_date": 1481070967, "post_id": 41006757, "comment_id": 69223274, "body": "@StarsFlyFreeFromCozyNights I updated my answer.   My formula was a little off."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1481070905, "last_edit_date": 1481070905, "creation_date": 1481066500, "answer_id": 41006757, "question_id": 41006504, "link": "https://stackoverflow.com/questions/41006504/vba-to-perform-calculation/41006757#41006757", "title": "VBA To Perform Calculation", "body": "<blockquote>\n  <p>\"=RC7+RC8\" / \"=VLookup(A2, Totals!B2:R100, 3, False)\"</p>\n</blockquote>\n\n<p>Remove the equal sign from <code>\"=VLookup(</code>.</p>\n\n<p>You can not mix <code>R1C1</code> notation with <code>A1</code> notation: <code>RC7+RC8</code> &amp; <code>A2</code> don't mix</p>\n\n<p>Instead of killing yourself trying to build a FormulaR1C1 in the VBA, get the formula working correctly on the worksheet and then print the working formula to the Immediate Window</p>\n\n<p><a href=\"https://i.stack.imgur.com/DmUpT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DmUpT.png\" alt=\"enter image description here\"></a></p>\n\n<h2>UPDATE</h2>\n\n<pre><code>ws.Cells(countie, 12).FormulaR1C1 = \"=RC7+RC8/VLOOKUP(RC1, Totals!R2C2:R100C18, 3, FALSE)\"\n</code></pre>\n\n<hr>\n\n<pre><code>Sub JunctionTest()\n    Dim ws As Worksheet\n    Dim lastRow As Long\n    For Each ws In ActiveWorkbook.Worksheets\n        With ws\n            lastRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n            .Range(\"L2:L\" &amp; lastRow).FormulaR1C1 = \"=RC7+RC8/VLOOKUP(RC1, Totals!R2C2:R100C18, 3, FALSE)\"\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 41006757, "answer_count": 1, "score": 0, "last_activity_date": 1481070905, "creation_date": 1481065223, "last_edit_date": 1481070011, "question_id": 41006504, "link": "https://stackoverflow.com/questions/41006504/vba-to-perform-calculation", "title": "VBA To Perform Calculation", "body": "<p>I am trying to use VBA to add a calculation to the used range of multiple worksheets.  Problem is, I keep getting this error </p>\n\n<blockquote>\n  <p>'Type Mismatch'</p>\n</blockquote>\n\n<p>on the line reading <code>ws.Cells(countie, 12).FormulaR1C1 =...</code></p>\n\n<p>Here is my syntax - what will fix this so this syntax will execute?</p>\n\n<pre><code>Function JunctionTest()\nDim ws As Worksheet, countie As Long\nFor Each ws In ActiveWorkbook.Worksheets\n  With ws\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n    LastRow = .Cells.Find(What:=\"*\",After:=.Range(\"A1\"),LookAt:=xlPart, _\n                  LookIn:=xlFormulas, SearchOrder:=xlByRows,SearchDirection:=xlPrevious, _\n                  MatchCase:=False).Row\n  Else\n    LastRow = 1\n  End If\n  For countie = 1 To LastRow\n        ws.Cells(countie, 12).FormulaR1C1 = \"=RC7+RC8\" / \"=VLookup(A2, Totals!B2:R100, 3, False)\"\nNext countie\nEnd Function\n</code></pre>\n\n<p>EDIT --</p>\n\n<p><a href=\"http://www.filedropper.com/garbage\" rel=\"nofollow noreferrer\">Download Sample Workbook - Garbagedata.xlsx</a></p>\n"}, {"tags": ["excel", "for-loop", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481064869, "post_id": 41006419, "comment_id": 69221356, "body": "Yes, there are many ways to do this. Can you edit the question with the code you&#39;ve tried?"}], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "edited": false, "score": 0, "creation_date": 1481065575, "post_id": 41006445, "comment_id": 69221580, "body": "&quot;Control&quot; is key! This is what I have been looking for! I have been searching for GroupName etc and found nothing! I guess I could throw in an &#39;And&#39; to the condition to check if the GroupName matches too right?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "edited": false, "score": 0, "creation_date": 1481065955, "post_id": 41006445, "comment_id": 69221739, "body": "it seems like youre well on your way to solving it :)"}, {"owner": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "edited": false, "score": 0, "creation_date": 1481100203, "post_id": 41006445, "comment_id": 69233110, "body": "I&#39;m very new to using userForms (if you couldn&#39;t guess) and I thought I was well one my way to solving it but it seems otherwise.   If I declare cCont As &quot;Control&quot; I cannot acccess the GroupName property.   If I declare cCont As &quot;OptionButton&quot; (as this is all I want to check for) then it gives a type mis-match in my For Loop when trying to loop through Me.Controls. I&#39;m not trying to get you to tell me exactly what to do but I need some direction?!"}, {"owner": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "edited": false, "score": 0, "creation_date": 1481101228, "post_id": 41006445, "comment_id": 69233768, "body": "to further explain.  I have two groups of OptionButtons, hence me needing to check what group it is part of.  I can work around it for now simply by counting through the OptionButtons (so say after 4 - the first group of buttons - I know I&#39;m on the next group) but this seems a long approach to what I need to do."}, {"owner": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "edited": false, "score": 0, "creation_date": 1481189244, "post_id": 41006445, "comment_id": 69279067, "body": "Cheers Doug.  Strange!  Maybe it&#39;s certain Controls that aren&#39;t working then, I must have been iterating past one that didn&#39;t support the GroupName property as I have just copied and pasted your code and chaged the Boobaloobie bit for <code>MsgBox(cCont.GroupName)</code> and it works until it gets to a component that doesn&#39;t have a GroupName property.  Thanks for your help!  I will try this again as it seems much more efficient for what I need to do."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1481115533, "last_edit_date": 1481115533, "creation_date": 1481064936, "answer_id": 41006445, "question_id": 41006419, "link": "https://stackoverflow.com/questions/41006419/vba-loop-group-of-buttons-on-userform/41006445#41006445", "title": "VBA loop group of buttons on UserForm", "body": "<pre><code>Private Sub UserForm_Initialize()\n            Dim cCont As Control\n\n            For Each cCont In Me.Controls\n                If TypeName(cCont) = \"CommandButton\" Or TypeName(cCont) = \"OptionButton\" Then\n                    cCont.Caption = \"Boobaloobie\"\n                End If\n            Next cCont\n</code></pre>\n\n<p>Alright this is exactly what you're looking for. Works for me perfectly</p>\n"}, {"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1481064968, "post_id": 41006447, "comment_id": 69221379, "body": "beat you to it :P"}, {"owner": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "edited": false, "score": 0, "creation_date": 1481098641, "post_id": 41006447, "comment_id": 69232217, "body": "@Dai thanks for the answer btw, I had to mark Doug as correct as he was first in there."}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 1, "last_activity_date": 1481064970, "last_edit_date": 1481064970, "creation_date": 1481064943, "answer_id": 41006447, "question_id": 41006419, "link": "https://stackoverflow.com/questions/41006419/vba-loop-group-of-buttons-on-userform/41006447#41006447", "title": "VBA loop group of buttons on UserForm", "body": "<p>I searched google for \"vba userform get controls\", this is the top result:</p>\n\n<p><a href=\"http://www.ozgrid.com/VBA/control-loop.htm\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/VBA/control-loop.htm</a></p>\n\n<pre><code>Dim control As Control\nFor Each control In Me.Controls\n\n    If TypeName( control ) = \"RadioButton\" Then\n\n        ' do stuff\n    End If\n\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 4396846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c663de3b176f13c44713da336b200b05?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/4396846/frank"}, "is_accepted": false, "score": 0, "last_activity_date": 1545098245, "creation_date": 1545098245, "answer_id": 53825377, "question_id": 41006419, "link": "https://stackoverflow.com/questions/41006419/vba-loop-group-of-buttons-on-userform/53825377#53825377", "title": "VBA loop group of buttons on UserForm", "body": "<p>I decided to add a suffix to the control\u2019s name that symbolized the group it was in. \nThen it was a simple matter of looping through and checking for the suffix text. </p>\n"}], "owner": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1795, "favorite_count": 0, "accepted_answer_id": 41006445, "answer_count": 3, "score": -1, "last_activity_date": 1545098245, "creation_date": 1481064781, "last_edit_date": 1531161705, "question_id": 41006419, "link": "https://stackoverflow.com/questions/41006419/vba-loop-group-of-buttons-on-userform", "title": "VBA loop group of buttons on UserForm", "body": "<p>I have a user form with a group of radio buttons. O when I click the continue button I want it to iterate over each button. </p>\n\n<p>I would have thought there would be something I could do with a for loop, like 'For Each button In group'!</p>\n\n<p>Is there a way to do this?</p>\n\n<p>edit***********</p>\n\n<p>I have decided to push the buttons into arrays and loop through the array.  I found this was more suitable as it allowed access to all the OptionButton properties where-as looping through Controls did not.  </p>\n\n<p>If there is a better way to do this I'd still like to know.  What I wanted to do in Doug's answer below was:</p>\n\n<pre><code>'... within For Each Loop\n    If cCont.GroupName = \"GroupB\" Then\n        'blah blah blah\n    End If\n</code></pre>\n\n<p>This didn't work as GroupName was not available on cCont which was declared as \"Control\".</p>\n\n<p>Thanks again for the replies!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1481063874, "post_id": 41006157, "comment_id": 69220996, "body": "You don&#39;t need either <code>Offset</code> <i>or</i> <code>Activate</code>.  Just use the <code>Cells</code> collection directly. What exactly is this supposed to do?  The <code>Offsets</code> of 3 and 4 are going to increase the gap between your 2 ranges the longer the loop runs."}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 4, "creation_date": 1481063878, "post_id": 41006157, "comment_id": 69221001, "body": "try: <code>set targetcell = targetcell.offset(3,0)</code> and <code>set resultcell = resultcell.offset(4,0)</code> instead of trying to activate the cell. your current code does activate the cell, but thats about it. target and result cell dont change"}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "edited": false, "score": 1, "creation_date": 1481064747, "post_id": 41006157, "comment_id": 69221317, "body": "For this to be a successful <code>for</code> loop you need to use the iterator (<code>x</code>) to actually update something, or for something to incrementally change and update in the loop. Neither of which exist."}, {"owner": {"reputation": 71, "user_id": 6333689, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1367599706587172/picture?type=large", "display_name": "Lachy Vass", "link": "https://stackoverflow.com/users/6333689/lachy-vass"}, "reply_to_user": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1481074980, "post_id": 41006157, "comment_id": 69224341, "body": "@NickSlash that did it. Thanks so much"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6687952, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154243457461278/picture?type=large", "display_name": "LeahPleurodon", "link": "https://stackoverflow.com/users/6687952/leahpleurodon"}, "is_accepted": false, "score": 0, "last_activity_date": 1481075618, "creation_date": 1481075618, "answer_id": 41008133, "question_id": 41006157, "link": "https://stackoverflow.com/questions/41006157/how-to-increment-a-range-object-with-a-loop/41008133#41008133", "title": "How to increment a Range object with a Loop", "body": "<p>Here's the issue that I see...</p>\n\n<p>Your value isn't changing because you're target_cell isn't changing... you should add</p>\n\n<pre><code>  target_cell.address \n</code></pre>\n\n<p>to your debug script and you will see it's not changing...\nTo change the target cell you need to set the target_cell you can't just activate another... so you would do this:</p>\n\n<pre><code>    set target_cell = target_cell.Offset(3, 0)\n    set result_cell = result_cell.Offset(4, 0)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6333689, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1367599706587172/picture?type=large", "display_name": "Lachy Vass", "link": "https://stackoverflow.com/users/6333689/lachy-vass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 579, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1481075618, "creation_date": 1481063521, "question_id": 41006157, "link": "https://stackoverflow.com/questions/41006157/how-to-increment-a-range-object-with-a-loop", "title": "How to increment a Range object with a Loop", "body": "<p>In this code I'm trying to increment two Range object's using .OffSet(1, 0).Activate. </p>\n\n<pre><code>  Function Foundry_check_func(target_cell As Range, result_cell As Range)\n    For x = 1 To 20\n        If result_cell &lt;= 5 Then\n            target_cell = \"Value 1\"\n        ElseIf result_cell &gt;= 10 Then\n            target_cell = \"Value 2\"\n        Else: target_cell = \"Value 3\"\n        End If\n\n        With target_cell\n        .Interior.Color = RGB(0, 255, 0)\n        End With\n\n        target_cell.Offset(3, 0).Activate\n        result_cell.Offset(4, 0).Activate\n        Debug.Print (\"Value: \" &amp; result_cell &amp; \" Loop: \" &amp; x)\n    Next x\n\n\n    ' Don't forget to format target cell at end of loop\n\nEnd Function\n\n\nSub Foundry_check()\n    Main = Foundry_check_func(Range(\"J22\"), Range(\"K22\"))\nEnd Sub\n</code></pre>\n\n<p>However, I can see using Debug.Print that after each loop, the cell being read does not change. Here's the output: </p>\n\n<pre><code>Value: 1 Loop: 1\nValue: 1 Loop: 2\nValue: 1 Loop: 3\nValue: 1 Loop: 4\nValue: 1 Loop: 5\netc.\n</code></pre>\n\n<p>I've made a similar macro work using ActiveCell instead of a Range. But in this program I need to OffSet two sets of cells. One to read data (result_cell) and another to write a value based on that data (target_cell). I'm not sure how I could use ActiveCell to offset two different cells in the same loop. </p>\n\n<p>Any help would be appreciated. </p>\n"}, {"tags": ["vba", "excel", "automation", "accounting", "banking"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1481065245, "post_id": 41005821, "comment_id": 69221462, "body": "Quickly googling your title gives me 9 web pages and a video on how to do this.  Did you try anything at all?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7259389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5nU6Q.jpg?s=128&g=1", "display_name": "Libby T", "link": "https://stackoverflow.com/users/7259389/libby-t"}, "edited": false, "score": 0, "creation_date": 1481120878, "post_id": 41006502, "comment_id": 69247077, "body": "I do work with pivot tables, I format the transactions to notate once I&#39;ve reconciled them based off of this banking data.  I&#39;m not sure a pivot table will work in that scenario?  I might mess around with it, thank you for your suggestion!"}], "tags": [], "owner": {"reputation": 61, "user_id": 7254044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc32c9152aa923125587502a69f9034b?s=128&d=identicon&r=PG&f=1", "display_name": "Ash Notts", "link": "https://stackoverflow.com/users/7254044/ash-notts"}, "is_accepted": false, "score": 0, "last_activity_date": 1481065213, "creation_date": 1481065213, "answer_id": 41006502, "question_id": 41005821, "link": "https://stackoverflow.com/questions/41005821/transfer-data-from-a-master-worksheet-to-multiple-worksheets-based-on-column-usi/41006502#41006502", "title": "Transfer Data from a Master Worksheet to Multiple Worksheets based on Column using VBA", "body": "<p>This can certainly be done with VBA.</p>\n\n<p>However there is an easier way, are you familiar with pivot tables?</p>\n\n<p>1 create your pivot table, and make it look nice</p>\n\n<p>2 add account number as a filter</p>\n\n<p>3 in the ribbon, find pivot table options and press the down arrow then click \"Show Report Filter Pages\".  </p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1481286118, "creation_date": 1481286118, "answer_id": 41060408, "question_id": 41005821, "link": "https://stackoverflow.com/questions/41005821/transfer-data-from-a-master-worksheet-to-multiple-worksheets-based-on-column-usi/41060408#41060408", "title": "Transfer Data from a Master Worksheet to Multiple Worksheets based on Column using VBA", "body": "<p>I think this will do what you want.</p>\n\n<pre><code>Sub Copy_To_Worksheets()\n'Note: This macro use the function LastRow\n    Dim My_Range As Range\n    Dim FieldNum As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n    Dim ws2 As Worksheet\n    Dim Lrow As Long\n    Dim cell As Range\n    Dim CCount As Long\n    Dim WSNew As Worksheet\n    Dim ErrNum As Long\n\n    'Set filter range on ActiveSheet: A1 is the top left cell of your filter range\n    'and the header of the first column, D is the last column in the filter range.\n    'You can also add the sheet name to the code like this :\n    'Worksheets(\"Sheet1\").Range(\"A1:D\" &amp; LastRow(Worksheets(\"Sheet1\")))\n    'No need that the sheet is active then when you run the macro when you use this.\n    Set My_Range = Range(\"A1:D\" &amp; LastRow(ActiveSheet))\n    My_Range.Parent.Select\n\n    If ActiveWorkbook.ProtectStructure = True Or _\n       My_Range.Parent.ProtectContents = True Then\n        MsgBox \"Sorry, not working when the workbook or worksheet is protected\", _\n               vbOKOnly, \"Copy to new worksheet\"\n        Exit Sub\n    End If\n\n    'This example filters on the first column in the range(change the field if needed)\n    'In this case the range starts in A so Field:=1 is column A, 2 = column B, ......\n    FieldNum = 1\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    'Change ScreenUpdating, Calculation, EnableEvents, ....\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n    'Add a worksheet to copy the a unique list and add the CriteriaRange\n    Set ws2 = Worksheets.Add\n\n    With ws2\n        'first we copy the Unique data from the filter field to ws2\n        My_Range.Columns(FieldNum).AdvancedFilter _\n                Action:=xlFilterCopy, _\n                CopyToRange:=.Range(\"A1\"), Unique:=True\n\n        'loop through the unique list in ws2 and filter/copy to a new sheet\n        Lrow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        For Each cell In .Range(\"A2:A\" &amp; Lrow)\n\n            'Filter the range\n            My_Range.AutoFilter Field:=FieldNum, Criteria1:=\"=\" &amp; _\n             Replace(Replace(Replace(cell.Value, \"~\", \"~~\"), \"*\", \"~*\"), \"?\", \"~?\")\n\n            'Check if there are no more then 8192 areas(limit of areas)\n            CCount = 0\n            On Error Resume Next\n            CCount = My_Range.Columns(1).SpecialCells(xlCellTypeVisible) _\n                     .Areas(1).Cells.Count\n            On Error GoTo 0\n            If CCount = 0 Then\n                MsgBox \"There are more than 8192 areas for the value : \" &amp; cell.Value _\n                     &amp; vbNewLine &amp; \"It is not possible to copy the visible data.\" _\n                     &amp; vbNewLine &amp; \"Tip: Sort your data before you use this macro.\", _\n                       vbOKOnly, \"Split in worksheets\"\n            Else\n                'Add a new worksheet\n                Set WSNew = Worksheets.Add(After:=Sheets(Sheets.Count))\n                On Error Resume Next\n                WSNew.Name = cell.Value\n                If Err.Number &gt; 0 Then\n                    ErrNum = ErrNum + 1\n                    WSNew.Name = \"Error_\" &amp; Format(ErrNum, \"0000\")\n                    Err.Clear\n                End If\n                On Error GoTo 0\n\n                'Copy the visible data to the new worksheet\n                My_Range.SpecialCells(xlCellTypeVisible).Copy\n                With WSNew.Range(\"A1\")\n                    ' Paste:=8 will copy the columnwidth in Excel 2000 and higher\n                    ' Remove this line if you use Excel 97\n                    .PasteSpecial Paste:=8\n                    .PasteSpecial xlPasteValues\n                    .PasteSpecial xlPasteFormats\n                    Application.CutCopyMode = False\n                    .Select\n                End With\n            End If\n\n            'Show all data in the range\n            My_Range.AutoFilter Field:=FieldNum\n\n        Next cell\n\n        'Delete the ws2 sheet\n        On Error Resume Next\n        Application.DisplayAlerts = False\n        .Delete\n        Application.DisplayAlerts = True\n        On Error GoTo 0\n\n    End With\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    If ErrNum &gt; 0 Then\n        MsgBox \"Rename every WorkSheet name that start with \"\"Error_\"\" manually\" _\n             &amp; vbNewLine &amp; \"There are characters in the name that are not allowed\" _\n             &amp; vbNewLine &amp; \"in a sheet name or the worksheet already exist.\"\n    End If\n\n    'Restore ScreenUpdating, Calculation, EnableEvents, ....\n    My_Range.Parent.Select\n    ActiveWindow.View = ViewMode\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlValues, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p><a href=\"http://www.rondebruin.nl/win/s3/win006_4.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s3/win006_4.htm</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7259389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5nU6Q.jpg?s=128&g=1", "display_name": "Libby T", "link": "https://stackoverflow.com/users/7259389/libby-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 739, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1481286118, "creation_date": 1481061997, "last_edit_date": 1495542254, "question_id": 41005821, "link": "https://stackoverflow.com/questions/41005821/transfer-data-from-a-master-worksheet-to-multiple-worksheets-based-on-column-usi", "title": "Transfer Data from a Master Worksheet to Multiple Worksheets based on Column using VBA", "body": "<p>I am brand new to VBA and am trying to take banking information in an excel format and break it down by account per excel spreadsheet.  I'm dropping in the bank data (all accounts consolidated in one spreadsheet) on the first sheet.  I would like to use VBA for 8 additional tabs to break apart the banking details of each account.  </p>\n\n<p>Bank Data sheet1 columns: \n-account type\n-date\n-routing\n-account no.\n-currency\n-account name*\n-transaction code\n-transaction type\n-transaction value\n-transaction notes\n-add't notes\n-detail\n-misc\n-misc (column N is end of data)</p>\n\n<p>I would like VBA to split the banking data based on account name, and keep all the same columns as sheet1.  I think my query is similar to this one: <a href=\"https://stackoverflow.com/questions/35556135/transfer-data-from-a-master-worksheet-to-multiple-based-on-column-using-vba?newreg=7658895dc3f34573b90be91dc313a916\">Transfer Data from a Master Worksheet to Multiple based on Column using VBA</a>\nbut I'm struggling to understand how the solution would apply to my case (and I don't have nearly as much data as this person does; at most in a given worksheet I would probably only have about 5000 rows of data). </p>\n\n<p>Can someone assist, or point me in the right direction? </p>\n\n<p>Thank you. </p>\n"}, {"tags": ["vba", "ms-access", "64-bit", "x86-64"], "answers": [{"comments": [{"owner": {"reputation": 378, "user_id": 5150025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kuv962nK3Vs/AAAAAAAAAAI/AAAAAAAABLE/uhwOHa1VuOQ/photo.jpg?sz=128", "display_name": "Marcelo Gazzola", "link": "https://stackoverflow.com/users/5150025/marcelo-gazzola"}, "edited": false, "score": 0, "creation_date": 1481114773, "post_id": 41017837, "comment_id": 69242681, "body": "Tks. I have opened a ACCDB file on windows 32 bits and created the accde using this operational system."}], "tags": [], "owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "is_accepted": false, "score": 1, "last_activity_date": 1481114651, "creation_date": 1481114651, "answer_id": 41017837, "question_id": 41005560, "link": "https://stackoverflow.com/questions/41005560/open-64-bit-accde-file-in-32-bit-version-of-microsoft-access/41017837#41017837", "title": "Open 64-bit .accde file in 32-bit version of Microsoft Access", "body": "<p>Probably not doable.</p>\n\n<p>You might be able to <em>open</em> it, but you won't be able to edit or run the VBA code, so if the file depends on that, it'll be completely worthless.</p>\n\n<p>The reason for this is that an <code>accde</code> file is a stripped/locked-down version of the original <code>accdb</code> file. It includes <em>only</em> the compiled version of the VBA code, and this code would have been compiled to target a 64-bit architecture. 64-bit code cannot be run from a 32-bit process, so it will not work when you try to run it in 32-bit Access.</p>\n\n<p>Your only real option would be to reverse-engineer the file, and therefore the compiled VBA code that it contains, such that you could translate it back into VBA. This would <em>not</em> be a trivial undertaking, even if you used a tool to help, since decompilation is never perfect.</p>\n"}], "owner": {"reputation": 378, "user_id": 5150025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Kuv962nK3Vs/AAAAAAAAAAI/AAAAAAAABLE/uhwOHa1VuOQ/photo.jpg?sz=128", "display_name": "Marcelo Gazzola", "link": "https://stackoverflow.com/users/5150025/marcelo-gazzola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2058, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593644403, "creation_date": 1481061004, "last_edit_date": 1593644403, "question_id": 41005560, "link": "https://stackoverflow.com/questions/41005560/open-64-bit-accde-file-in-32-bit-version-of-microsoft-access", "title": "Open 64-bit .accde file in 32-bit version of Microsoft Access", "body": "<p>I have created a .accde access file using MS Office 2013 64-bit, but I have to open in other PC that is running a 32-bit version of Access.</p>\n\n<p>How can I do it?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1481061495, "creation_date": 1481061495, "answer_id": 41005696, "question_id": 41005425, "link": "https://stackoverflow.com/questions/41005425/how-to-copy-specific-columns/41005696#41005696", "title": "How to copy specific columns?", "body": "<p>The following code will copy just columns A to Y.  I have also refactored it to get rid of the need to constantly switch between sheets.</p>\n\n<pre><code>Sub Button4_Click()\n    Dim x As Long\n    Dim erow as Long\n\n    'Calculate starting rows\n    x = 15\n    With Worksheets(\"Sheet2\")\n        erow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    End With\n\n    With Worksheets(\"Sheet1\")\n        Do While .Cells(x, 1) &lt;&gt; \"\"\n            'Your current code replaces the source data with its values so\n            'I have left that functionality in by using the following line\n            .Range(\"A\" &amp; x &amp; \":Y\" &amp; x).Value = .Range(\"A\" &amp; x &amp; \":Y\" &amp; x).Value\n\n            'The next line copies values to Sheet2\n            Worksheets(\"Sheet2\").Range(\"A\" &amp; erow &amp; \":Y\" &amp; erow).Value = .Range(\"A\" &amp; x &amp; \":Y\" &amp; x).Value\n\n            'increment row counters\n            x = x + 1\n            erow = erow + 1\n        Loop\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7259240, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1213dbe9ae5dbc5b47f4c09c06b39475?s=128&d=identicon&r=PG&f=1", "display_name": "Mantas La", "link": "https://stackoverflow.com/users/7259240/mantas-la"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 427, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560120923, "creation_date": 1481060423, "last_edit_date": 1560120923, "question_id": 41005425, "link": "https://stackoverflow.com/questions/41005425/how-to-copy-specific-columns", "title": "How to copy specific columns?", "body": "<p>When I push a button, rows of one sheet are copied to another sheet.</p>\n\n<p>I want to copy data from column A to column Y, not the whole row. </p>\n\n<p>My code:</p>\n\n<pre><code>Sub Button4_Click()\nx = 15\nDo While Cells(x, 1) &lt;&gt; \"\"\n    If Cells(x, 1) &lt;&gt; \"\" Then\n        Worksheets(\"Sheet1\").Rows(x).Copy\n        Rows(x).PasteSpecial xlPasteValues\n        Worksheets(\"Sheet2\").Activate\n        erow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n        ActiveSheet.Paste Destination:=Worksheets(\"Sheet2\").Rows(erow)\n    End If\n    Worksheets(\"Sheet1\").Activate\n    x = x + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6845988, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1470384866321526/picture?type=large", "display_name": "codingYogi", "link": "https://stackoverflow.com/users/6845988/codingyogi"}, "edited": false, "score": 0, "creation_date": 1481063194, "post_id": 41005652, "comment_id": 69220716, "body": "It does have a sheet named MathResults, as I stated above I have already written data to the sheet and selected the sheet with the same code that caused a problem here."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 39, "user_id": 6845988, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1470384866321526/picture?type=large", "display_name": "codingYogi", "link": "https://stackoverflow.com/users/6845988/codingyogi"}, "edited": false, "score": 0, "creation_date": 1481063594, "post_id": 41005652, "comment_id": 69220874, "body": "@codingYogi If the sheet <code>MathResults</code> already exists, then the only thing I could think of is that the Workbook containing it might not be the active one. Do you have more than workbook open at the time you invoke this routine?"}, {"owner": {"reputation": 39, "user_id": 6845988, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1470384866321526/picture?type=large", "display_name": "codingYogi", "link": "https://stackoverflow.com/users/6845988/codingyogi"}, "edited": false, "score": 0, "creation_date": 1481075993, "post_id": 41005652, "comment_id": 69224621, "body": "You were right, I had more than one workbook open Thanks! For some reason though when I run the code now it adds the chart sheet but freezes excel on a blank chart. Can you think of any reason this would be happening?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 39, "user_id": 6845988, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1470384866321526/picture?type=large", "display_name": "codingYogi", "link": "https://stackoverflow.com/users/6845988/codingyogi"}, "edited": false, "score": 0, "creation_date": 1481106510, "post_id": 41005652, "comment_id": 69237259, "body": "@codingYogi Glad it helped. I think that this now you are facing a different issue. If you did not solve it yet, I suggest that you post a dedicated question."}, {"owner": {"reputation": 39, "user_id": 6845988, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1470384866321526/picture?type=large", "display_name": "codingYogi", "link": "https://stackoverflow.com/users/6845988/codingyogi"}, "edited": false, "score": 0, "creation_date": 1481127861, "post_id": 41005652, "comment_id": 69252005, "body": "Thanks but it only lets me ask one question every 4 days, very annoying."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 39, "user_id": 6845988, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1470384866321526/picture?type=large", "display_name": "codingYogi", "link": "https://stackoverflow.com/users/6845988/codingyogi"}, "edited": false, "score": 0, "creation_date": 1481144657, "post_id": 41005652, "comment_id": 69262043, "body": "It might be again the result of counting on which wb is Active, which worksheet is active, etc. I highly recommend to use fully qualified objects, where each statement specifies precisely the object (wb, ws, chart, etc) it applies to, instead of the <code>ActiveThing</code>... For example <code>With someWorkbook.Charts.Add</code>..."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1481061350, "creation_date": 1481061350, "answer_id": 41005652, "question_id": 41005416, "link": "https://stackoverflow.com/questions/41005416/how-to-create-a-chart-sheet-with-a-column-chart-from-a-button-on-a-form-and-data/41005652#41005652", "title": "How to create a chart sheet with a column chart from a button on a form and data on a worksheet", "body": "<p>Obviously your Workbook does not have a sheet called <code>\"MathResults\"</code>. What you want is to <strong>create it</strong> then work with it. </p>\n\n<p>Change</p>\n\n<blockquote>\n  <p><code>Set ws = Sheets(\"MathResults\")</code></p>\n</blockquote>\n\n<p>into:</p>\n\n<pre><code>Set ws = Sheets.Add\nws.Name = \"MathResults\"\n</code></pre>\n\n<p>Better yet, you can try to find the sheet and create it IF it is not yet there:</p>\n\n<pre><code>On Error Resume Next\nSet ws = Sheets(\"MathResults\")\nIf ws Is Nothing Then ' &lt;~~ the sheet is not there yet, we need to create it\n    Set ws = Sheets.Add\n    ws.Name = \"MathResults\"\nEnd If\nOn Error GoTo 0\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6845988, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1470384866321526/picture?type=large", "display_name": "codingYogi", "link": "https://stackoverflow.com/users/6845988/codingyogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 41005652, "answer_count": 1, "score": 1, "last_activity_date": 1481061350, "creation_date": 1481060377, "question_id": 41005416, "link": "https://stackoverflow.com/questions/41005416/how-to-create-a-chart-sheet-with-a-column-chart-from-a-button-on-a-form-and-data", "title": "How to create a chart sheet with a column chart from a button on a form and data on a worksheet", "body": "<p>This is part of my final project for an Excel VBA class. I have created a calculator app that also writes the equations and results to the <em>MathResults</em> sheet. My next task is to take the results and create a chart sheet with them. The issue I am getting from the code below is that the subscript is out of range <em>Set ws = Sheets(\"MathResults\")</em>. This code worked fine when I used it to select the worksheet to write the data to.</p>\n\n<pre><code>Private Sub bttnAddChart_Click()\n    'variables\n    Dim dataRange As Range\n    Dim endRow As Integer\n    Set ws = Sheets(\"MathResults\")\n\n    'find the end of the row\n    endRow = ws.Range(\"A:A\").Find(What:=\"\", After:=Range(\"A1\")).Row\n\n    'set the data range\n    Set dataRange = ws.Range(\"B2:B\" &amp; endRow)\n\n    Charts.Add\n    With ActiveChart\n        .ChartType = xlColumnClustered\n        .Legend.Position = xlRight\n        .Axes(xlCategory).MinorTickMark = xlOutside\n        .Axes(xlValue).MinorTickMark = xlOutside\n    End With\nEnd Sub\n</code></pre>\n"}]