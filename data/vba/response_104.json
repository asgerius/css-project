[{"tags": ["excel", "xbap", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1483577297, "post_id": 41475211, "comment_id": 70157282, "body": "Maybe this will give you some ideas: <a href=\"http://stackoverflow.com/q/22821902/4996248\">stackoverflow.com/q/22821902/4996248</a> This is about JavaScript and XBAP, but JavaScript code which interacts with the browser in some way can usually be translated to VBScript which in turn can be tweaked to VBA."}, {"owner": {"reputation": 13, "user_id": 1845502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80481e675c1752cf641d82508f9a5ab?s=128&d=identicon&r=PG", "display_name": "Arvinder", "link": "https://stackoverflow.com/users/1845502/arvinder"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1483663525, "post_id": 41475211, "comment_id": 70200516, "body": "Thank you @JohnColeman. I have no experience with jscript. can you help with more details please."}], "owner": {"reputation": 13, "user_id": 1845502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80481e675c1752cf641d82508f9a5ab?s=128&d=identicon&r=PG", "display_name": "Arvinder", "link": "https://stackoverflow.com/users/1845502/arvinder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483574267, "creation_date": 1483574267, "last_edit_date": 1531164843, "question_id": 41475211, "link": "https://stackoverflow.com/questions/41475211/interact-with-an-xbap-application-via-vba", "title": "Interact with an XBAP application via VBA", "body": "<p>I work for a service request fulfillment team. We have a XBAP tool that runs an application where we do user rights maangement. For each request, I have to search the user in the XBAP application and then do the needful operations. Is there a way we can interact with the XBAP Application from outside the XBAP framework, like VBA and send commands. I'm looking forward to design a solution in Excel using VBA that can loop through the requests. That is the second part however I could not find any information on how can I effectively address the form fields in XBAP. I only have access to the hosted application with no access to source code. The developer tools show no information for the XBAP form fields as this is encapsulated in a secured framework(XAML/WPF). Please help or guide me in the right direction.</p>\n"}, {"tags": ["excel", "vba", "hyperlink"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1483574267, "post_id": 41475184, "comment_id": 70156459, "body": "How does VBA link them, when you record a macro, do the CTRL+Click on the sheets, then change a value? What else have you tried? Is that all the code you have?"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1483574860, "post_id": 41475184, "comment_id": 70156610, "body": "Would you be able to share your full code? It might make it easier to understand what you are trying to achieve."}, {"owner": {"reputation": 435, "user_id": 6459965, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1ef76de619a4042b74cfa02cc9752e0?s=128&d=identicon&r=PG&f=1", "display_name": "gluc7", "link": "https://stackoverflow.com/users/6459965/gluc7"}, "edited": false, "score": 0, "creation_date": 1483575004, "post_id": 41475184, "comment_id": 70156662, "body": "What I meant by that was I recorded a macro to see what the code looks like when you hold either ctrl or shift and click on a tab that you want to link. I was going to try to acitvate that code by using Private Sub Worksheet_Change(ByVal Target As Range) whenever there was a change in the main sheet. I was kinda stumped for ideas on how to do this but I guess as I look at it again I could just keep the sheets all linked to the Main Sheet and hide certain rows I don&#39;t need. Unless anyone has any other ideas."}, {"owner": {"reputation": 435, "user_id": 6459965, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1ef76de619a4042b74cfa02cc9752e0?s=128&d=identicon&r=PG&f=1", "display_name": "gluc7", "link": "https://stackoverflow.com/users/6459965/gluc7"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1483586539, "post_id": 41475184, "comment_id": 70159462, "body": "@VBAPete  I don&#39;t have any code because I am not really sure what direction I should go. Linking the sheets by doing ctrl + clicking on the sheet you want to link does not stay linked. So I am back to square one unfortunately.  Just looking for the most efficient way to have changes in the Main sheet occur in two other sheets. Rows may be added or moved so I don&#39;t think formulas in cells is the best way to do it. Not even sure there is a good solution using VBA."}], "answers": [{"tags": [], "owner": {"reputation": 140, "user_id": 3828905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JzFtQ.jpg?s=128&g=1", "display_name": "Roie R", "link": "https://stackoverflow.com/users/3828905/roie-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1483605887, "creation_date": 1483605887, "answer_id": 41480559, "question_id": 41475184, "link": "https://stackoverflow.com/questions/41475184/best-way-to-link-two-worksheets-in-excel-vba/41480559#41480559", "title": "Best way to link two worksheets in excel- vba", "body": "<p>You have the <a href=\"http://www.ozgrid.com/VBA/run-macros-change.htm\" rel=\"nofollow noreferrer\">worksheet.Change</a> event for that. Something simple like the following:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  ThisWorkbook.Sheets(\"sheet2\").Cells(Target.Row, Target.Column).Value = Target\nEnd Sub\n</code></pre>\n\n<p>Will copy the value on every cell change from one sheet to another (the code goes in the sheet's private module).</p>\n"}], "owner": {"reputation": 435, "user_id": 6459965, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1ef76de619a4042b74cfa02cc9752e0?s=128&d=identicon&r=PG&f=1", "display_name": "gluc7", "link": "https://stackoverflow.com/users/6459965/gluc7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2750, "favorite_count": 0, "accepted_answer_id": 41480559, "answer_count": 1, "score": 1, "last_activity_date": 1579111781, "creation_date": 1483574076, "question_id": 41475184, "link": "https://stackoverflow.com/questions/41475184/best-way-to-link-two-worksheets-in-excel-vba", "title": "Best way to link two worksheets in excel- vba", "body": "<p>I am looking for the best way to \"link\" two worksheets together. I have a main worksheet where information and data is added and then I would like to have two basic worksheets that draws columns from main spreadsheet. Whenever changes are made to the main sheet, they will also occur in the other two sheets. I was thinking of trying to activate a macro which automates hitting ctrl or shift and the two tabs like the below</p>\n\n<pre><code>sheets (Array(\"Main\", \"Summary\")).select\n</code></pre>\n\n<p>But this failed to work as well. Its too much information for vlookups or anything like that so if anyone knows a way to have changes that occur in one sheet effect multiple other ones it would be much appreciated. </p>\n\n<p>Thanks!!!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7146698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwUuI.jpg?s=128&g=1", "display_name": "Amar", "link": "https://stackoverflow.com/users/7146698/amar"}, "edited": false, "score": 0, "creation_date": 1483576126, "post_id": 41475433, "comment_id": 70156991, "body": "hey thank you for your response...  but actually I am trying to do is to count data with two criteria ... which is done with excel formula but now I need the vba code for the same."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1483575950, "creation_date": 1483575950, "answer_id": 41475433, "question_id": 41475076, "link": "https://stackoverflow.com/questions/41475076/getting-run-time-13-error-in-vba-how-to-fix-this/41475433#41475433", "title": "getting run time 13 error in vba how to fix this", "body": "<p>I didn't get exactly what you're trying to do, but if (just a guess) you're trying to evaluate the <code>SUMPRODUCT</code> of columns 14 and 15, you might want to try this: </p>\n\n<pre><code>Sub TestEvaluate()\n\nDim ws As Worksheet, x As String\n\nSet ws = Worksheets(2)\nx = Evaluate(\"sumproduct(\" &amp; ws.Columns(14).Address &amp; \",\" &amp; ws.Columns(15).Address &amp; \")\")\nMsgBox x\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7146698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwUuI.jpg?s=128&g=1", "display_name": "Amar", "link": "https://stackoverflow.com/users/7146698/amar"}, "edited": false, "score": 0, "creation_date": 1484005530, "post_id": 41476256, "comment_id": 70322966, "body": "hey @YowE3K... can you tell the how to modify the above code to count with 4 criteria... When doing a modification, getting an error ..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 7146698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwUuI.jpg?s=128&g=1", "display_name": "Amar", "link": "https://stackoverflow.com/users/7146698/amar"}, "edited": false, "score": 0, "creation_date": 1484013748, "post_id": 41476256, "comment_id": 70325007, "body": "@Amar To use 4 criteria, just add two more parameters to the <code>CountIfs</code> function - the range to look at, and the value to look for."}, {"owner": {"reputation": 13, "user_id": 7146698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwUuI.jpg?s=128&g=1", "display_name": "Amar", "link": "https://stackoverflow.com/users/7146698/amar"}, "edited": false, "score": 0, "creation_date": 1484066886, "post_id": 41476256, "comment_id": 70352694, "body": "yup, your are right .. I tried but the bracket closure might be misplaced that&#39;s what it didn&#39;t work so did I ask. It may work... let me try first. thank you again.. :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 7146698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwUuI.jpg?s=128&g=1", "display_name": "Amar", "link": "https://stackoverflow.com/users/7146698/amar"}, "edited": false, "score": 0, "creation_date": 1484073423, "post_id": 41476256, "comment_id": 70356677, "body": "@Amar You need to change <code>...  .Columns(4), &quot;&lt;&quot; &amp; CDbl(nxt_date))</code> to <code>...  .Columns(4), &quot;&lt;&quot; &amp; CDbl(nxt_date), new_search_column, new_search_value)</code>"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1484073494, "last_edit_date": 1484073494, "creation_date": 1483581899, "answer_id": 41476256, "question_id": 41475076, "link": "https://stackoverflow.com/questions/41475076/getting-run-time-13-error-in-vba-how-to-fix-this/41476256#41476256", "title": "getting run time 13 error in vba how to fix this", "body": "<p>In a comment to another answer, you say that you are actually trying to do a count with two criteria (or three criteria according to the question).  That is better achieved with Excel's <code>CountIfs</code> function, which can be coded in VBA using something like:</p>\n\n<pre><code>Option Explicit\nSub sample_sumpro()\n    Dim cal_date As Date, nxt_date As Date\n    Dim name As String\n    Dim dm_daily As String\n\n    cal_date = #12/30/2016#\n    nxt_date = cal_date + 1\n    name = \"Kawale, Amar\"\n\n    With Sheets(1)\n        dm_daily = Application.WorksheetFunction.CountIfs(.Columns(16), name, _\n                                                          .Columns(4), \"&gt;=\" &amp; CDbl(cal_date), _\n                                                          .Columns(4), \"&lt;\" &amp; CDbl(nxt_date))\n    End With\n    MsgBox dm_daily\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7146698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwUuI.jpg?s=128&g=1", "display_name": "Amar", "link": "https://stackoverflow.com/users/7146698/amar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 41476256, "answer_count": 2, "score": 1, "last_activity_date": 1484073494, "creation_date": 1483573364, "last_edit_date": 1531164843, "question_id": 41475076, "link": "https://stackoverflow.com/questions/41475076/getting-run-time-13-error-in-vba-how-to-fix-this", "title": "getting run time 13 error in vba how to fix this", "body": "<p>I'm actually trying to code the sumproduct VBA script but I'm getting the runtime 13 error... </p>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\nSub sample_sumpro()\n\nDim cal_date, nxt_date As Date\n\ncal_date = #12/30/2016#\n\nnxt_date = cal_date + 1\n\nDim name As String, ws As Sheets\n\nname = \"Kawale, Amar\"\n\nDim dm_daily As String\n\nWith Sheets(1)\ndm_daily = Application.Evaluate(\"SUMPRODUCT((Columns(16)=name)*Columns(4)&gt;=cal_date)*Columns(4)&lt;nxt_date))\")\nEnd With\n\nMsgBox dm_daily\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vsto", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1483572963, "post_id": 41474971, "comment_id": 70156070, "body": "&quot;...formatting cells programmatically and style/color if often defined conditionally...&quot;  Are you using VBA, or C#? What&#39;s the code you&#39;re using? Are you in a table, or is it plain data?"}, {"owner": {"reputation": 976, "user_id": 5014665, "user_type": "registered", "accept_rate": 19, "profile_image": "https://i.stack.imgur.com/dnYqC.png?s=128&g=1", "display_name": "whatever", "link": "https://stackoverflow.com/users/5014665/whatever"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1483650266, "post_id": 41474971, "comment_id": 70195342, "body": "I&#39;m using C#. It&#39;s plain data which I&#39;m formatting to speed up data reading/interpretation."}], "answers": [{"comments": [{"owner": {"reputation": 976, "user_id": 5014665, "user_type": "registered", "accept_rate": 19, "profile_image": "https://i.stack.imgur.com/dnYqC.png?s=128&g=1", "display_name": "whatever", "link": "https://stackoverflow.com/users/5014665/whatever"}, "edited": false, "score": 0, "creation_date": 1483609401, "post_id": 41479049, "comment_id": 70168381, "body": "I confirm that the &quot;issue&quot; which was not a real issue but a feature :) was due to Excel&#39;s &quot;extend data range formats and formulas&quot;. Your line of code works fine although it disables the option in Excel. This option should be something defined at the workbook level not at the application/client level."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 976, "user_id": 5014665, "user_type": "registered", "accept_rate": 19, "profile_image": "https://i.stack.imgur.com/dnYqC.png?s=128&g=1", "display_name": "whatever", "link": "https://stackoverflow.com/users/5014665/whatever"}, "edited": false, "score": 0, "creation_date": 1483633625, "post_id": 41479049, "comment_id": 70185397, "body": "Perhaps, but there are many settings like this one, which a (VBA) developer must turn off and back on again (or at least back in the previous state)."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 0, "last_activity_date": 1483599827, "creation_date": 1483599827, "answer_id": 41479049, "question_id": 41474971, "link": "https://stackoverflow.com/questions/41474971/excel-stop-cells-formatting-being-applied-to-adjacent-cell/41479049#41479049", "title": "Excel: stop cells formatting being applied to adjacent cell?", "body": "<p>This is controlled by a setting of the Excel Application Object:</p>\n\n<pre><code>YourExcelObjectReference.Application.ExtendList = False\n</code></pre>\n"}], "owner": {"reputation": 976, "user_id": 5014665, "user_type": "registered", "accept_rate": 19, "profile_image": "https://i.stack.imgur.com/dnYqC.png?s=128&g=1", "display_name": "whatever", "link": "https://stackoverflow.com/users/5014665/whatever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 41479049, "answer_count": 1, "score": 0, "last_activity_date": 1483599827, "creation_date": 1483572577, "last_edit_date": 1531161705, "question_id": 41474971, "link": "https://stackoverflow.com/questions/41474971/excel-stop-cells-formatting-being-applied-to-adjacent-cell", "title": "Excel: stop cells formatting being applied to adjacent cell?", "body": "<p>I noticed that if I format (font, color, etc.) a certain number of cells in a row or in a column, as soon as I type text in adjacent cells in the same row or column formatting is automatically applied to the added cell. How can this automatic behavior be stopped? I'm formatting cells programmatically and style/color if often defined conditionally, it is not simply to please the eye or to make data more readable and excel's automatic formatting is setting formatting/color without knowledge of the underlying logic. Formatting is not being set via formulas but via C# code.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483573433, "post_id": 41474699, "comment_id": 70156220, "body": "Does cell J4 contain the filename (excluding path) of one of the currently open workbooks?  Include a <code>Debug.Print FileName</code> or a <code>MsgBox FileName</code> immediately after the <code>FileName = Range(&quot;J4&quot;)</code> line and tell us what it shows."}, {"owner": {"reputation": 11, "user_id": 7376300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQJBy.jpg?s=128&g=1", "display_name": "JohnO", "link": "https://stackoverflow.com/users/7376300/johno"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483629152, "post_id": 41474699, "comment_id": 70182123, "body": "The value in J4 contains the filename (excluding path) of an open workbook.  The value is the result of a concatenate function merging the month from one cell and the year from another. Neither the Debug nor the MsgBox statements yielded any result."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483643165, "post_id": 41474699, "comment_id": 70191406, "body": "When you say &quot;Neither the Debug nor the MsgBox statements yielded any result&quot; do you mean that the <code>MsgBox</code> didn&#39;t display, or that it just displayed an empty string as the message?  If it didn&#39;t display at all, it means your code never reached the statement.  If it displayed an empty string then it means cell J4 is empty (or null).  Are you sure that the <code>ActiveSheet</code> when the statement <code>FileName = Range(&quot;J4&quot;)</code> is executed is the one on which your filename is stored?"}], "answers": [{"tags": [], "owner": {"reputation": 1440, "user_id": 8108679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/abOaf.jpg?s=128&g=1", "display_name": "ChrisM", "link": "https://stackoverflow.com/users/8108679/chrism"}, "is_accepted": false, "score": 0, "last_activity_date": 1509624150, "creation_date": 1509624150, "answer_id": 47074822, "question_id": 41474699, "link": "https://stackoverflow.com/questions/41474699/activating-excel-workbook-sheet-using-cell-reference-as-name-of-workbook-and-wor/47074822#47074822", "title": "Activating Excel Workbook/Sheet using cell reference as name of Workbook and Worksheet", "body": "<p>There are a couple of things that could be happening here.</p>\n\n<p>On my testing both give an error </p>\n\n<blockquote>\n  <p>Run-time error \u20189\u2019: Subscript out of range</p>\n</blockquote>\n\n<p>Firstly, in one of your comments you say you concatenate the Month and Year from two other cells into J4, if this gives <strong>November2017</strong> for example then this will give the error above as it with be looking for a file name. If however J4 gives <strong>November2017.xlsx</strong> then it would look for this file.</p>\n\n<p>Secondly, if J4 gives <strong>November2017.xlsx</strong> but this file is not already open the above error will also be displayed.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10407414, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214277458785327/picture?type=large", "display_name": "Isabelle Tan", "link": "https://stackoverflow.com/users/10407414/isabelle-tan"}, "is_accepted": false, "score": 0, "last_activity_date": 1563505517, "creation_date": 1563505517, "answer_id": 57104978, "question_id": 41474699, "link": "https://stackoverflow.com/questions/41474699/activating-excel-workbook-sheet-using-cell-reference-as-name-of-workbook-and-wor/57104978#57104978", "title": "Activating Excel Workbook/Sheet using cell reference as name of Workbook and Worksheet", "body": "<p>I had the same problem.</p>\n\n<p>Change  Workbooks(FileName).Activate to  Workbooks(FileName.value).Activate</p>\n\n<p>You must provide the .value method as the you're referring to the value of the cell instead of the cell destination.</p>\n"}], "owner": {"reputation": 11, "user_id": 7376300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQJBy.jpg?s=128&g=1", "display_name": "JohnO", "link": "https://stackoverflow.com/users/7376300/johno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1884, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563505517, "creation_date": 1483570983, "last_edit_date": 1531164843, "question_id": 41474699, "link": "https://stackoverflow.com/questions/41474699/activating-excel-workbook-sheet-using-cell-reference-as-name-of-workbook-and-wor", "title": "Activating Excel Workbook/Sheet using cell reference as name of Workbook and Worksheet", "body": "<p>Here is the code as I have it.</p>\n\n<p>I get a subscript error on the line <code>Workbooks(FileName).Activate</code></p>\n\n<pre><code>Sub GoToRoomSchedule()\n'\n' GoToRoomSchedule Macro\n'   Set up Workbook as a reference to Cell J9 contents (MonthYear based on calendar selection)\n'   Set up Worksheet as a reference to Cell H4 contents (Day of month based on calendar selection)\n\n    Dim WBook As String\n    Dim FileName As String\n    FileName = Range(\"J4\")\n    WBook = FileName\n    Workbooks(FileName).Activate\n\n    Dim WSheet As String\n    Dim SheetName As String\n    SheetName = Range(\"H4\")\n    WSheet = SheetName\n    Sheets(SheetName).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 0, "creation_date": 1483623270, "post_id": 41474631, "comment_id": 70177875, "body": "Is there a way to copy the sheets without the formula referencing to the original workbook?"}], "tags": [], "owner": {"reputation": 1715, "user_id": 3115000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/22Pgz.jpg?s=128&g=1", "display_name": "smozgur", "link": "https://stackoverflow.com/users/3115000/smozgur"}, "is_accepted": true, "score": 1, "last_activity_date": 1483632150, "last_edit_date": 1483632150, "creation_date": 1483570589, "answer_id": 41474631, "question_id": 41474476, "link": "https://stackoverflow.com/questions/41474476/excel-copy-active-sheet-and-specified-sheets-to-new-workbook/41474631#41474631", "title": "Excel Copy active sheet and specified sheets to new workbook", "body": "<p>I don't know what is the stuff at the end other than copying A1 range but I put it there too. </p>\n\n<p>You simply need to assign the workbook object (wrk in my sample, NewWB in your sample - variable name doesn't matter) at the beginning and tell the Copy method where to copy. You will see that I specified first parameter - which is :Before - as wrk.Worksheets(1), so copied sheets are copied just before the first worksheet in the new workbook.</p>\n\n<pre><code>Sub Create_Work_Order()\nDim currentWrk As Workbook\nDim wrk As Workbook\n\nSet currentWrk = ActiveWorkbook\nSet wrk = Workbooks.Add\n\ncurrentWrk.ActiveSheet.Copy wrk.Worksheets(1)\nDropDown_Sheet_1_VB.Copy wrk.Worksheets(1)\nControl_Sheet_VB.Copy wrk.Worksheets(1)\n\n'wrk.ActiveSheet.Range(\"A1\").Copy 'do stuff on new workbook\nwrk.Save\n\n' EDIT: I added following to change the functions to refer to the new file\nwrk.ChangeLink currentWrk.FullName, wrk.FullName, xlExcelLinks  \nwrk.Save\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1981, "favorite_count": 0, "accepted_answer_id": 41474631, "answer_count": 1, "score": 0, "last_activity_date": 1483632150, "creation_date": 1483569779, "question_id": 41474476, "link": "https://stackoverflow.com/questions/41474476/excel-copy-active-sheet-and-specified-sheets-to-new-workbook", "title": "Excel Copy active sheet and specified sheets to new workbook", "body": "<p>im trying to copy the active sheet and 2 specified sheets to a new workbook and then have the macro to continue to run on the new workbook to change a few things before i save it</p>\n\n<p>i want to copy the sheets by the sheets codenames</p>\n\n<ul>\n<li>1st Sheet 3 to copy this will be the \"active sheet\"</li>\n<li>2nd Sheets codename is \"DropDown_Sheet_1_VB\"</li>\n<li>3rd Sheets codename is \"Control_Sheet_VB\"</li>\n</ul>\n\n<p>Example Code.</p>\n\n<pre><code>Sub Create_Work_Order()\n\nWorkbooks.Add\n\nActiveSheet.Copy 'copy to new workbook\nDropDown_Sheet_1_VB.Copy 'also copy to new workbook\nControl_Sheet_VB.Copy 'also copy to new workbook\n\nDim NewWB As Workbook\n\nNewWB.ActiveSheet.Range(\"A1\").Copy 'do stuff on new workbook\nNewWB.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1483571980, "creation_date": 1483571980, "answer_id": 41474874, "question_id": 41474415, "link": "https://stackoverflow.com/questions/41474415/excal-vba-convert-a-string-of-number-numbers-to-rows-and-add-recurrent-name-aft/41474874#41474874", "title": "Excal-VBA: Convert a string of number numbers to rows and add recurrent name after", "body": "<p>Try this</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim rng As Excel.Range\n    Set rng = ThisWorkbook.Worksheets.Item(1).Cells(1, 1).CurrentRegion\n    Set rng = rng.Offset(1)\n    Set rng = rng.Resize(rng.Rows.Count - 1)\n\n\n    Dim vPaste\n\n\n\n    Dim lTotalRows As Long\n\n    Dim lPass As Long\n    For lPass = 0 To 1\n\n        Dim rowLoop As Excel.Range\n        For Each rowLoop In rng.Rows\n\n            Dim sName As String\n            sName = rowLoop.Cells(1, 1)\n\n            Dim sAccounts As String\n            sAccounts = rowLoop.Cells(1, 2)\n\n            Dim vSplitAccounts As Variant\n            vSplitAccounts = VBA.Split(sAccounts, \";\")\n\n            If lPass = 0 Then\n                lTotalRows = lTotalRows + UBound(vSplitAccounts) + 1\n            Else\n\n                Dim vLoop As Variant\n                For Each vLoop In vSplitAccounts\n                    lTotalRows = lTotalRows + 1\n                    vPaste(lTotalRows, 1) = sName\n                    vPaste(lTotalRows, 2) = vLoop\n\n\n                Next vLoop\n            End If\n\n        Next\n        If lPass = 0 Then\n            ReDim vPaste(1 To lTotalRows, 1 To 2)\n            lTotalRows = 0\n\n        End If\n\n    Next\n\n    ThisWorkbook.Worksheets.Item(2).Cells(1, 1).Value = \"Name\"\n    ThisWorkbook.Worksheets.Item(2).Cells(1, 2).Value = \"Account\"\n\n    Dim rngPaste As Excel.Range\n    Set rngPaste = ThisWorkbook.Worksheets.Item(2).Cells(2, 1).Resize(lTotalRows, 2)\n\n    rngPaste.Value2 = vPaste\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 7376508, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ac2b171ad61a50a0042d14087460c16b?s=128&d=identicon&r=PG&f=1", "display_name": "Aabo", "link": "https://stackoverflow.com/users/7376508/aabo"}, "edited": false, "score": 0, "creation_date": 1483597813, "post_id": 41474892, "comment_id": 70162601, "body": "This is genuis! thanks a million.. works like a charm!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1483572064, "creation_date": 1483572064, "answer_id": 41474892, "question_id": 41474415, "link": "https://stackoverflow.com/questions/41474415/excal-vba-convert-a-string-of-number-numbers-to-rows-and-add-recurrent-name-aft/41474892#41474892", "title": "Excal-VBA: Convert a string of number numbers to rows and add recurrent name after", "body": "<p>The following short macro will take data from <em>Sheet1</em> and output records in <em>Sheet2</em>:</p>\n\n<pre><code>Sub DataReorganizer()\n    Dim i As Long, j As Long, N As Long\n    Dim s1 As Worksheet, s2 As Worksheet\n    Set s1 = Sheets(\"Sheet1\")\n    Set s2 = Sheets(\"Sheet2\")\n    N = s1.Cells(Rows.Count, \"A\").End(xlUp).Row\n    j = 1\n\n    For i = 2 To N\n        v1 = s1.Cells(i, 1)\n        ary = Split(s1.Cells(i, 2), \";\")\n        For Each a In ary\n            s2.Cells(j, 1).Value = v1\n            s2.Cells(j, 2).Value = a\n            j = j + 1\n        Next a\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Input:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pwVsW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pwVsW.png\" alt=\"enter image description here\"></a></p>\n\n<p>and output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bPFaS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bPFaS.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 145, "user_id": 7376508, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ac2b171ad61a50a0042d14087460c16b?s=128&d=identicon&r=PG&f=1", "display_name": "Aabo", "link": "https://stackoverflow.com/users/7376508/aabo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 41474892, "answer_count": 2, "score": 1, "last_activity_date": 1485875894, "creation_date": 1483569476, "last_edit_date": 1485875894, "question_id": 41474415, "link": "https://stackoverflow.com/questions/41474415/excal-vba-convert-a-string-of-number-numbers-to-rows-and-add-recurrent-name-aft", "title": "Excal-VBA: Convert a string of number numbers to rows and add recurrent name after", "body": "<p>I have an issue which I use a lot of manual time on currently.</p>\n\n<p>I have following simple data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/E9sbW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E9sbW.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And I wish to convert all the accounts downwards with the name next to the accounts in another column. Currently I do this by using the 'text to columns' function and then manually copy the names down.. HARD work.. :)</p>\n\n<p>This is an example of my wish scenario..</p>\n\n<p><a href=\"https://i.stack.imgur.com/qEC4f.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qEC4f.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Hope you are able to help..</p>\n\n<p>Thanks a lot\nKristoffer</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7075507"}, "edited": false, "score": 0, "creation_date": 1483569867, "post_id": 41474453, "comment_id": 70154883, "body": "I knew that was it!  It&#39;s too late in the day to do work now.  Heading home. Thanks ASH!!!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1483569628, "creation_date": 1483569628, "answer_id": 41474453, "question_id": 41474190, "link": "https://stackoverflow.com/questions/41474190/how-to-loop-through-a-cell-three-times-to-do-a-multi-find-replace/41474453#41474453", "title": "How to loop through a cell three times to do a multi find &amp; replace?", "body": "<p>Get that string once and work on it, i.e.:</p>\n\n<pre><code>Dim str as string: str = ActiveSheet.Range(CellAddress).Value\nFor x = LBound(fndList) To UBound(fndList)\n    str = Replace(str, fndList(x), rplcList(x))\nNext x\n\nActiveSheet.Range(CellAddress).Offset(0, -8).Value = str\n</code></pre>\n\n<p>However, be aware that this will not replace the patterns as \"whole words\", they will be replaced even inside other words if they appear.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7075507"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 41474453, "answer_count": 1, "score": 1, "last_activity_date": 1483569628, "creation_date": 1483568452, "last_edit_date": 1531164843, "question_id": 41474190, "link": "https://stackoverflow.com/questions/41474190/how-to-loop-through-a-cell-three-times-to-do-a-multi-find-replace", "title": "How to loop through a cell three times to do a multi find &amp; replace?", "body": "<p>I'm trying to do a Find/Replace and I'm getting stuck.  Basically, I want to copy the contents of a cell, let's say it is cell P6.  I want to put the conents of that cell 8 cells to the left.</p>\n\n<p>So, in CellAddress of P6 I have the following:\n1. Campaign Name = YES \n2. Campaign / Program Manager = YES \n30. Creative Indicator = YES \nQ1. New  Legal Approval = YES \nQ2. Targeting Indicator = YES </p>\n\n<p>In cell H6, I want to see this:\n1. Campaign Name\n2. Campaign / Program Manager\n30. Creative Indicator\nQ1. New  Legal Approval\nQ2. Targeting Indicator</p>\n\n<p>Basically, anything with \"YES\", \"NO\", or \"=\" is replaced with \"\".  I see what the problem with the loop is...I just can't seem to fix it.</p>\n\n<p>Here is my non-working code.</p>\n\n<pre><code>fndList = Array(\"NO\", \"YES\", \"=\")\nrplcList = Array(\"\", \"\", \"\")\n    For x = LBound(fndList) To UBound(fndList)\n        ActiveSheet.Range(\"AA1\").Value = Replace(ActiveSheet.Range(CellAddress).Value, fndList(x), rplcList(x))\n        ActiveSheet.Range(CellAddress).Offset(0, -8).Value = ActiveSheet.Range(\"AA1\").Value\n        ActiveSheet.Range(\"AA1\").Clear\n    Next\n</code></pre>\n\n<p>This is the problem.  On the first iteration through the loop I get this:\n1. Campaign Name = YES 2. Campaign / Program Manager = YES 30. Creative Indicator = YES Q1. New Legal Approval = YES Q2. Targeting Indicator = YES</p>\n\n<p>On the second iteration, I get this:\n1. Campaign Name =  2. Campaign / Program Manager =  30. Creative Indicator =  Q1. New Legal Approval =  Q2. Targeting Indicator = </p>\n\n<p>On the third iteration, I get this:\n1. Campaign Name YES 2. Campaign / Program Manager YES 30. Creative Indicator YES Q1. New Legal Approval YES Q2. Targeting Indicator YES</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1483567750, "post_id": 41473889, "comment_id": 70154022, "body": "Ooh, ooh, ooh!  I learned this one yesterday!!  Change <code>rng3 = vStages</code> to <code>Not IsError(Application.Match(rng3.Value, vStages, 0))</code>"}, {"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483568680, "post_id": 41473889, "comment_id": 70154411, "body": "That seems to be half working! I&#39;m now running into a problem though where the stage name that it posts next to the value all says the same thing, which is also not a value from the array. It might be a problem with the line sh3.Cells(Rows.Count, 4).End(xlUp)(2) = rng3.Value ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483569587, "post_id": 41473889, "comment_id": 70154777, "body": "Ahhh - I hadn&#39;t noticed that <code>rng3</code> wasn&#39;t a single cell - that it&#39;s really just all possible values.  <code>rng3.Value</code> will just be <code>[D2]</code> from the &quot;WIP&quot; sheet.  Looking at your code further, it looks like you are going to have to change your code to actually <code>Find</code> the appropriate row on sheet &quot;WIP&quot; that you are wanting to look at.  (Doing a <code>Count</code> tells you that it exists, but not <b>where</b> it exists.)"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483572671, "post_id": 41474081, "comment_id": 70155981, "body": "@AlisterM - answer updated to use <code>Find</code>.  I have done limited testing (based on what I <b>think</b> your data might be)."}, {"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483628020, "post_id": 41474081, "comment_id": 70181312, "body": "This seems to work perfectly, thank you so much! I didn&#39;t really know that was how Count worked vs Find, so it&#39;s really good to know the difference and be able to see them both compared here."}, {"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483649498, "post_id": 41474081, "comment_id": 70194953, "body": "I think I spoke too soon. It appeared to be working correctly but I actually went through to compare and make sure it wasn&#39;t missing any entries from the data and I&#39;m finding that it&#39;s correctly pulling SOME, but not touching others. For instance, it correctly matched T-90379 (Shipped) but skipped over T-90345 (Shipped). The cells are formatted the same, there&#39;s no extra spaces, I&#39;ve copied and pasted the stage name directly into the code to account for any typos, so I&#39;m not sure what&#39;s happening."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483649726, "post_id": 41474081, "comment_id": 70195084, "body": "@AlisterM And &quot;T-90345&quot; only appears once in column B of WIP?"}, {"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483650739, "post_id": 41474081, "comment_id": 70195597, "body": "Yes, that entry only appears once. Some of the data entries start with hyphenated letters (such as T-12345 or G-09876) but the numbers themselves should never repeat (ie there will never be T-12345 and G-12345). However, there is the occasion when there&#39;s a &quot;two-part&quot; entry and it will be designated as part A and B in the WIP (such as 12345A and 12345B). In that instance, there will only be &quot;12345&quot; listed on the FLEX list, but both 12345A and 12345B will appear on the WIP list and we&#39;d need to see both of them, if applicable."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483651070, "post_id": 41474081, "comment_id": 70195768, "body": "(a) Temporarily change the code by replacing <code>Set rng1 = sh1.Range(&quot;A2:A&quot; &amp; lr1)</code> to something like <code>Set rng1 = sh1.Range(&quot;A497&quot;)</code> (use whatever cell address is applicable to &quot;T-90345&quot; on the &quot;FLEX&quot; sheet).  Then step through the code line-by-line to see why it doesn&#39;t get down to the &quot;store details&quot; part."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483651188, "post_id": 41474081, "comment_id": 70195832, "body": "(b) If you have multiple instances of the data entries in WIP, your original method of saying &quot;only process if Count = 1&quot; would have ignored them.  That&#39;s why I included the <code>If rng2.FindNext(FindCell).Address = FindCell.Address Then</code> statement - to exclude entries which occurred twice.  (That statement would only be True if it appeared once.)  So you now want <b>all</b> records for those type of data to be selected?"}, {"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483652955, "post_id": 41474081, "comment_id": 70196756, "body": "I discovered the problem with it &quot;skipping&quot; the entry- it was completely my mistake because the line wasn&#39;t in the FLEX list at all and I had totally forgotten to even check that in the first place. Sorry for that confusion on my part!  As for part b, I hadn&#39;t figured that part into my solution so I apologize for not bringing it up sooner. Yes, I would need for it to be able to select all records for those type of data, if they&#39;re listed more than once."}, {"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483654907, "post_id": 41474081, "comment_id": 70197698, "body": "The list only shows one of the entries, and the WIP list is actually being updated to change the cell value. ie: T-90379A and T-90379 are both on the WIP list. Running the updated code posts T-90379A in the report list, and then changes the &quot;A&quot; to a &quot;B&quot; on the WIP list so that there are two entries of &quot;T-90379B&quot; (I used your commented = FindCell.Value towards the end to help me see what was going on a bit better)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483655561, "post_id": 41474081, "comment_id": 70197970, "body": "@AlisterM As far as I can see, the code in my answer never updates anything other than on the &quot;Report&quot; sheet."}, {"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483717255, "post_id": 41474081, "comment_id": 70223863, "body": "Would the line <code>FindCell = rng2.FindNext(FindCell)</code> have anything to do with it? I tested the actual value-writing part of the code and temporarily removed the part where it posts the data values into the report, and the entry in the WIP list still ended up changing."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483724257, "post_id": 41474081, "comment_id": 70228258, "body": "@AlisterM DOH!!!! - yes it would - it needs to be <code>Set FindCell = rng2.FindNext(FindCell)</code> - I&#39;ll update the answer.  Sometimes I hate that VBA allows <code>.Value</code> to be a default property - without the <code>Set</code> it was interpreting the statement as <code>FindCell.Value = rng2.FindNext(FindCell).Value</code>"}, {"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483736160, "post_id": 41474081, "comment_id": 70234424, "body": "I&#39;ve THOROUGHLY tested it and in combination with the rest of the script that I had to put together for the whole process, and I&#39;m excited to say that everything is running smoothly now! :) Thank you so much for your help, it was a great learning opportunity and I&#39;m hoping that next time I have to work on something similar I&#39;ll be able to use this knowledge as a platform to build on."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1483738779, "post_id": 41474081, "comment_id": 70235639, "body": "@AlisterM - That&#39;s the ideal outcome for SO - a user who not only has been given a fix for their problem but has also learned something in the process :)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1483724328, "last_edit_date": 1483724328, "creation_date": 1483567863, "answer_id": 41474081, "question_id": 41473889, "link": "https://stackoverflow.com/questions/41473889/excel-vba-copy-cell-if-value-matches-list-and-also-is-in-array/41474081#41474081", "title": "Excel VBA - copy cell if value matches list and ALSO is in array", "body": "<p>To test whether the value of <code>rng3</code> exists in the array <code>vStages</code> you can use</p>\n\n<pre><code>... And Not IsError(Application.Match(rng3.Value, vStages, 0)) Then\n</code></pre>\n\n<p><code>Application.Match</code> will return an error if the lookup value does not exist in the array so, if no error is returned, it means the value <strong>does</strong> exist in the array.</p>\n\n<hr>\n\n<p>I have updated your code to use a <code>Find</code> to locate the row on the \"WIP\" sheet that matches the data on the \"FLEX\" sheet:</p>\n\n<pre><code>Sub status()\n    Dim sh1 As Worksheet, sh2 As Worksheet, sh3 As Worksheet, lr1 As Long, lr2 As Long, rng1 As Range, rng2 As Range, c As Range\n    Dim vStages As Variant\n    Dim FindCell As Range\n    Set sh1 = Sheets(\"FLEX\")\n    Set sh2 = Sheets(\"WIP\")\n    Set sh3 = Sheets(\"Report\")\n\n    lr1 = sh1.Cells(sh1.Rows.Count, 1).End(xlUp).Row\n    lr2 = sh2.Cells(sh2.Rows.Count, 1).End(xlUp).Row\n    Set rng1 = sh1.Range(\"A2:A\" &amp; lr1)\n    Set rng2 = sh2.Range(\"B2:B\" &amp; lr2)\n\n    vStages = Array(\"Shipped\", \"Delivered\", \"Complete - Design\", \"Delivered to USPS\", _\n        \"Delivered\", \"Complete - Fulfillment\", \"Complete - Inventory\", \"Complete - Mailing\")\n\n    With sh3\n        .Range(\"C1\") = \"Finished but not Invoiced\"\n        For Each c In rng1\n            'Search on WIP for the value from FLEX\n            Set FindCell = rng2.Find(What:=c.Value, LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False)\n            'See if we found it\n            If Not FindCell Is Nothing Then\n                'Ensure that the value only appears once in WIP\n                If rng2.FindNext(FindCell).Address = FindCell.Address Then\n                    'Check the stage is one of the ones we are after\n                    If Not IsError(Application.Match(FindCell.Offset(0, 2).Value, vStages, 0)) Then\n                        'Store details\n                        .Cells(.Rows.Count, 3).End(xlUp)(2) = c.Value 'Or maybe \"= FindCell.Value\" ?\n                        .Cells(.Rows.Count, 4).End(xlUp)(2) = FindCell.Offset(0, 2).Value\n                    End If\n                End If\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Modified to process every match in WIP:</p>\n\n<pre><code>Sub status()\n    Dim sh1 As Worksheet, sh2 As Worksheet, sh3 As Worksheet, lr1 As Long, lr2 As Long, rng1 As Range, rng2 As Range, c As Range\n    Dim vStages As Variant\n    Dim FindCell As Range\n    Dim FirstFind As String\n    Set sh1 = Sheets(\"FLEX\")\n    Set sh2 = Sheets(\"WIP\")\n    Set sh3 = Sheets(\"Report\")\n\n    lr1 = sh1.Cells(sh1.Rows.Count, 1).End(xlUp).Row\n    lr2 = sh2.Cells(sh2.Rows.Count, 1).End(xlUp).Row\n    Set rng1 = sh1.Range(\"A2:A\" &amp; lr1)\n    Set rng2 = sh2.Range(\"B2:B\" &amp; lr2)\n\n    vStages = Array(\"Shipped\", \"Delivered\", \"Complete - Design\", \"Delivered to USPS\", _\n        \"Delivered\", \"Complete - Fulfillment\", \"Complete - Inventory\", \"Complete - Mailing\")\n\n    With sh3\n        .Range(\"C1\") = \"Finished but not Invoiced\"\n        For Each c In rng1\n            'Search on WIP for the value from FLEX\n            Set FindCell = rng2.Find(What:=c.Value, LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False)\n            'See if we found it\n            If Not FindCell Is Nothing Then\n                FirstFind = FindCell.Address\n                'Loop through all occurrences\n                Do\n                    'Check the stage is one of the ones we are after\n                    If Not IsError(Application.Match(FindCell.Offset(0, 2).Value, vStages, 0)) Then\n                        'Store details\n                        .Cells(.Rows.Count, 3).End(xlUp)(2) = c.Value 'Or maybe \"= FindCell.Value\" ?\n                        .Cells(.Rows.Count, 4).End(xlUp)(2) = FindCell.Offset(0, 2).Value\n                    End If\n                    Set FindCell = rng2.FindNext(FindCell)\n                    If FindCell.Address = FirstFind Then\n                        Exit Do\n                    End If\n                Loop\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1514, "favorite_count": 1, "accepted_answer_id": 41474081, "answer_count": 1, "score": 2, "last_activity_date": 1483724328, "creation_date": 1483566902, "last_edit_date": 1531164843, "question_id": 41473889, "link": "https://stackoverflow.com/questions/41473889/excel-vba-copy-cell-if-value-matches-list-and-also-is-in-array", "title": "Excel VBA - copy cell if value matches list and ALSO is in array", "body": "<p>I'm trying to compare a list in sheet 1 to a longer list in sheet 2 (I have this part working). I then am trying to implement a second statement where, IF the value on sheet 1 is found on sheet 2, I want to see if the associated value in another column on sheet 2 is one of 8 specific values (which I've stored in an array set in the script). If the value of that cell matches one of the items in the array, I want it to then add the match with its array value to a list in a separate sheet. Below is what I have so far (please pardon how Frankenstein-ed this code looks!):</p>\n\n<pre><code>Sub status()\nDim sh1 As Worksheet, sh2 As Worksheet, sh3 As Worksheet, lr1 As Long, lr2 As Long, rng1 As Range, rng2 As Range, rng3 As Range, c As Range\nDim vStages As Variant\nSet sh1 = Sheets(\"FLEX\")\nSet sh2 = Sheets(\"WIP\")\nSet sh3 = Sheets(\"Report\")\n\nlr1 = sh1.Cells(Rows.Count, 1).End(xlUp).Row\nlr2 = sh2.Cells(Rows.Count, 1).End(xlUp).Row\nSet rng1 = sh1.Range(\"A2:A\" &amp; lr1)\nSet rng2 = sh2.Range(\"B2:B\" &amp; lr2)\nSet rng3 = sh2.Range(\"D2:D\" &amp; lr2)\n\nvStages = Array(\"Shipped\", \"Delivered\", \"Complete - Design\", \"Delivered to USPS\", _\n    \"Delivered\", \"Complete - Fulfillment\", \"Complete - Inventory\", \"Complete - Mailing\")\n\nWith sh3\n    .Range(\"C1\") = \"Finished but not Invoiced\"\nEnd With\n\nFor Each c In rng1 \nIf WorksheetFunction.CountIf(rng2, \"*\" &amp; c.Value &amp; \"*\") = 1 And rng3 = vStages Then\n        sh3.Cells(Rows.Count, 3).End(xlUp)(2) = c.Value\n        sh3.Cells(Rows.Count, 4).End(xlUp)(2) = rng3.Value\n\nEnd If\n\nNext\nEnd Sub\n</code></pre>\n\n<p>I know the problem is occurring at the \"And rng3 = vStages Then\" part but I don't know how to properly set that part up. Any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2296, "user_id": 1575416, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32e1e3caa938438115454a4688a3d4a2?s=128&d=identicon&r=PG", "display_name": "aggaton", "link": "https://stackoverflow.com/users/1575416/aggaton"}, "edited": false, "score": 0, "creation_date": 1483567025, "post_id": 41473866, "comment_id": 70153654, "body": "duplicate of <a href=\"http://stackoverflow.com/questions/7876340/deleting-empty-rows-in-excel-using-vba\" title=\"deleting empty rows in excel using vba\">stackoverflow.com/questions/7876340/&hellip;</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1483567466, "post_id": 41473866, "comment_id": 70153889, "body": "Why is this all one line? <code>On Error Resume Next Worksheet.Columns(&quot;$Q:$AC&quot;).SpecialCells(xlCellTypeBlanks).E&zwnj;&#8203;ntireRow.Delete On Error GoTo 0</code>? That should be three lines. <code>On Error Resume Next</code> // <code>Worksheet.Columns(&quot;$Q:$AC&quot;).SpecialCells(xlCellTypeBlanks).E&zwnj;&#8203;ntireRow.Delete</code> // <code>On Error GoTo 0</code> ...also, take the <code>On Error</code>s out, and see what error you get, that may be hindering the deleting."}, {"owner": {"reputation": 10140, "user_id": 763029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TVwEa.jpg?s=128&g=1", "display_name": "Caffeinated", "link": "https://stackoverflow.com/users/763029/caffeinated"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1483567759, "post_id": 41473866, "comment_id": 70154027, "body": "@BruceWayne - thanks, fixed this. Ok I will try that out"}, {"owner": {"reputation": 10140, "user_id": 763029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TVwEa.jpg?s=128&g=1", "display_name": "Caffeinated", "link": "https://stackoverflow.com/users/763029/caffeinated"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1483567851, "post_id": 41473866, "comment_id": 70154078, "body": "@BruceWayne - when I take those lines out I get this  -  <code>Run-time error &#39;424&#39;: Object required </code>   .. not sure what is meant by 424."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1483567987, "post_id": 41473866, "comment_id": 70154130, "body": "<code>Worksheet.Columns(</code> is where you get the error? You mean <code>ActiveSheet</code>?"}, {"owner": {"reputation": 10140, "user_id": 763029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TVwEa.jpg?s=128&g=1", "display_name": "Caffeinated", "link": "https://stackoverflow.com/users/763029/caffeinated"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1483568099, "post_id": 41473866, "comment_id": 70154181, "body": "@PatricK - not sure what this means. What is <code>ActiveSheet</code> ?"}, {"owner": {"reputation": 10140, "user_id": 763029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TVwEa.jpg?s=128&g=1", "display_name": "Caffeinated", "link": "https://stackoverflow.com/users/763029/caffeinated"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1483568391, "post_id": 41473866, "comment_id": 70154303, "body": "@PatricK - ah Ok , I think I see what you mean. I will try this, thanks !"}], "answers": [{"tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": true, "score": 1, "last_activity_date": 1483582765, "last_edit_date": 1483582765, "creation_date": 1483568702, "answer_id": 41474245, "question_id": 41473866, "link": "https://stackoverflow.com/questions/41473866/how-do-i-remove-rows-that-dont-have-any-values-using-excel-vba/41474245#41474245", "title": "How do I remove rows that don&#39;t have any values ( using Excel VBA )?", "body": "<p>Replace this line,</p>\n\n<pre><code>Worksheet.Columns(\"$Q:$AC\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>With this,</p>\n\n<pre><code>Columns(\"$Q:$AC\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>Either state the sheet you want to delete from by setting it or just start with <code>Columns</code> </p>\n\n<p>The error you are getting is due to it not recognignising <code>Worksheet</code> you have before <code>Columns(\"$Q:$AC\")</code></p>\n\n<p>You could do this if you need to specify the sheet you are deleteing from.</p>\n\n<pre><code>Dim ws As Worksheet\n\nSet ws = Sheets(\"Sheet1\")\nws.Columns(\"$Q:$AC\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>Or even this</p>\n\n<pre><code>ActiveSheet.Columns(\"$Q:$AC\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>And as per comments, if you have multiple blanks cells you will throw an error, so if you have multiple blanks cells in one row and any cell that is blank determins the entire row to be deleted this code should do it for you.</p>\n\n<pre><code>Dim ws As Worksheet\nDim lastrow As Long\nDim rng As Range\n\nSet ws = Sheets(\"Sheet1\")\nlastrow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To lastrow\n     If WorksheetFunction.CountA(ws.Range(ws.Cells(i, 17), ws.Cells(i, 21))) = 0 Then\n        If Not rng Is Nothing Then\n              Set rng = Union(ws.Cells(i, 1), rng)\n        Else\n              Set rng = ws.Cells(i, 1)\n        End If\n     End If\nNext i\n\nrng.EntireRow.Delete\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1483583726, "creation_date": 1483583726, "answer_id": 41476493, "question_id": 41473866, "link": "https://stackoverflow.com/questions/41473866/how-do-i-remove-rows-that-dont-have-any-values-using-excel-vba/41476493#41476493", "title": "How do I remove rows that don&#39;t have any values ( using Excel VBA )?", "body": "<p>My lazy way is usually to hide the non-blank rows, and delete the visible ones (not tested):</p>\n\n<pre><code>Cells.SpecialCells(xlCellTypeConstants).EntireRow.Hidden = True\nCells.SpecialCells(xlCellTypeVisible).EntireRow.Delete\nCells.EntireRow.Hidden = False\n</code></pre>\n"}], "owner": {"reputation": 10140, "user_id": 763029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TVwEa.jpg?s=128&g=1", "display_name": "Caffeinated", "link": "https://stackoverflow.com/users/763029/caffeinated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 41474245, "answer_count": 2, "score": 1, "last_activity_date": 1483583726, "creation_date": 1483566796, "last_edit_date": 1483568780, "question_id": 41473866, "link": "https://stackoverflow.com/questions/41473866/how-do-i-remove-rows-that-dont-have-any-values-using-excel-vba", "title": "How do I remove rows that don&#39;t have any values ( using Excel VBA )?", "body": "<p>I am working on an Excel VBA Script to clean up a spreadsheet (first I remove lines with blanks, then I find/replace some text to be more summarized). </p>\n\n<p>I would like to remove rows where the respondent did not answer any survey questions. The row <em>does</em> contain some data in the first few columns (A, B, C), such as their IP address , etc. The survey answers are located in column Q3 until column AC ( $Q4 to $AC) Here is screenshot :</p>\n\n<p><a href=\"https://i.stack.imgur.com/1lbkO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1lbkO.png\" alt=\"enter image description here\"></a></p>\n\n<p>But if user did not answer any survey question, I want to delete that row.</p>\n\n<p>My VBA script is here : </p>\n\n<pre><code>Sub Main()\n    ReplaceBlanks    \n    Multi_FindReplace   \nEnd Sub\n\nSub ReplaceBlanks()\n    On Error Resume Next \n    Worksheet.Columns(\"$Q:$AC\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n    On Error GoTo 0\nEnd Sub\n\nSub Multi_FindReplace() 'PURPOSE: Find &amp; Replace a list of text/values throughout entire workbook 'SOURCE: www.TheSpreadsheetGuru.com/the-code-vault\n\n    Dim sht As Worksheet Dim fndList As Variant \n    Dim rplcList As Variant Dim x As Long\n\n    fndList = Array(\"Mostly satisfied\", \"Completely satisfied\", \"Not at all satisfied\")\n    rplcList = Array(\"satisfied\", \"satisfied\", \"unsatisfied\")\n\n    'Loop through each item in Array lists\n    For x = LBound(fndList) To UBound(fndList)\n        'Loop through each worksheet in ActiveWorkbook\n        For Each sht In ActiveWorkbook.Worksheets\n            sht.Cells.Replace What:=fndList(x), Replacement:=rplcList(x), _\n            LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n            SearchFormat:=False, ReplaceFormat:=False\n        Next sht\n    Next x\nEnd Sub\n</code></pre>\n\n<p>When I run this without the error-handling in the <code>ReplaceBlanks</code> subroutine, I obtain this error message :</p>\n\n<blockquote>\n  <p>Run-time error '424': Object required</p>\n</blockquote>\n\n<p>So far, only the second subroutine works (i.e Multi_FindReplace ).  How do I fix the first subroutine, so that it removes the rows that don't have respondent answers ? </p>\n"}, {"tags": ["excel", "powershell", "richtextbox", "vba"], "comments": [{"owner": {"reputation": 8928, "user_id": 6788803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNRMz.png?s=128&g=1", "display_name": "BenH", "link": "https://stackoverflow.com/users/6788803/benh"}, "edited": false, "score": 1, "creation_date": 1483568004, "post_id": 41473821, "comment_id": 70154140, "body": "Can you just add it as property to the object, like this? <code>$rtb = New-Object System.Windows.Forms.RichTextBox -property @{ rtf =  $Worksheet.Cells.Item(1,9).Text }</code>"}, {"owner": {"reputation": 117, "user_id": 3897187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573e9801436b37ed6ffb36fd3a073772?s=128&d=identicon&r=PG&f=1", "display_name": "Bernhard Frick", "link": "https://stackoverflow.com/users/3897187/bernhard-frick"}, "reply_to_user": {"reputation": 8928, "user_id": 6788803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNRMz.png?s=128&g=1", "display_name": "BenH", "link": "https://stackoverflow.com/users/6788803/benh"}, "edited": false, "score": 0, "creation_date": 1483569296, "post_id": 41473821, "comment_id": 70154672, "body": "@BenH Thank you that worked! Make it an Answer and I will accept it!"}], "answers": [{"tags": [], "owner": {"reputation": 8928, "user_id": 6788803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sNRMz.png?s=128&g=1", "display_name": "BenH", "link": "https://stackoverflow.com/users/6788803/benh"}, "is_accepted": true, "score": 2, "last_activity_date": 1483569571, "creation_date": 1483569571, "answer_id": 41474438, "question_id": 41473821, "link": "https://stackoverflow.com/questions/41473821/load-string-into-richtextbox/41474438#41474438", "title": "Load String into RichTextBox", "body": "<p>The <code>RichTextBox</code> <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox(v=vs.110).aspx\" rel=\"nofollow noreferrer\">class</a> has a property <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.rtf(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Rtf</a>. When constructing a new instance of the RichTextBox, you could set the Rtf property by using the <code>-property</code> parameter of <code>New-Object</code>:</p>\n\n<pre><code>[Reflection.Assembly]::LoadWithPartialName(\"System.Windows.Forms\")\n$rtb = New-Object System.Windows.Forms.RichTextBox -property @{\n    rtf = $Worksheet.Cells.Item(1,9).Text \n}\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 3897187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/573e9801436b37ed6ffb36fd3a073772?s=128&d=identicon&r=PG&f=1", "display_name": "Bernhard Frick", "link": "https://stackoverflow.com/users/3897187/bernhard-frick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 41474438, "answer_count": 1, "score": 2, "last_activity_date": 1483569571, "creation_date": 1483566649, "last_edit_date": 1531164843, "question_id": 41473821, "link": "https://stackoverflow.com/questions/41473821/load-string-into-richtextbox", "title": "Load String into RichTextBox", "body": "<p>I fail at finding a way to Load a String that is NOT coming from a File into a new Instance of an RichTextBox. Specifically, the Text is coming from an Excel-Sheet, that contains RTF-formatted Text.</p>\n\n<p>There is the LoadFile-Method for loading Files into a RichTextBox, that is overloaded for use with Streams:</p>\n\n<pre><code>LoadFile(Stream,\u2002RichTextBoxStreamType)\n</code></pre>\n\n<p>My Progress so far:</p>\n\n<pre><code>[Reflection.Assembly]::LoadWithPartialName(\"System.Windows.Forms\")\n$rtb = New-Object System.Windows.Forms.RichTextBox\n$rtb.LoadFile($Worksheet.Cells.Item(1,9).Text, [System.Windows.Forms.RichTextBoxStreamType]::RichText)\n</code></pre>\n\n<p>Is this the right way to do it? Am I heading in the wrong direction?</p>\n\n<p>Any Help is greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1483566319, "post_id": 41473710, "comment_id": 70153314, "body": "You need to qualify every range object with the worksheet variable.  <code>wkst.Range(&quot;B4:D4,G4,K4:M4&quot;).Select</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1483566494, "post_id": 41473710, "comment_id": 70153405, "body": "...and then not use the <code>.Select</code> part or <code>Selection</code>."}], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": false, "score": 0, "last_activity_date": 1483568550, "creation_date": 1483568550, "answer_id": 41474208, "question_id": 41473710, "link": "https://stackoverflow.com/questions/41473710/i-have-issues-with-looping-my-vba/41474208#41474208", "title": "I have issues with looping my vba", "body": "<p>Add this line after your For Each statement to make it iterate through each sheet:</p>\n\n<pre><code>wkst.Activate\n</code></pre>\n\n<p>Disclaimer: Scott Craner and Comintern are right. Using Activate, .Select, and Selection results in slower and more error prone code. Follow their advice and you will have the best result in the end.</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "is_accepted": false, "score": 0, "last_activity_date": 1483647680, "creation_date": 1483647680, "answer_id": 41493985, "question_id": 41473710, "link": "https://stackoverflow.com/questions/41473710/i-have-issues-with-looping-my-vba/41493985#41493985", "title": "I have issues with looping my vba", "body": "<p>Here's an update on an answer to my question so I figured it out. It had nothing to do with the .Activate or .Select, I actually had to declare what is the active sheet.</p>\n\n<pre><code>Sub Con()\nDim sht As Worksheet, csheet As Worksheet\nCall removecond\nApplication.ScreenUpdating = False\nSet csheet = ActiveSheet\nFor Each sht In ActiveWorkbook.Worksheets\nIf sht.Visible Then\nsht.Activate\nRange(\"E8\").Select\n Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E8&gt;E9\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E8&lt;E9\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E8=\"\"\"\",E8=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E8:Q8\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E11\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E11&gt;E12\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E11&lt;E12\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E11=\"\"\"\",E11=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlNone\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E11:Q11\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E17\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E17&gt;E18\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E17&lt;E18\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E17=\"\"\"\",E17=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E17:Q17\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E20\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E20&gt;E21\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E20&lt;E21\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E20=\"\"\"\",E20=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E20:Q20\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E23\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E23&gt;E24\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E23&lt;E24\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E23=\"\"\"\",E23=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E23:Q23\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E26\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E26&gt;E27\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E26&lt;E27\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E26=\"\"\"\",E26=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E26:Q26\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\nSkipBlanks:=False, Transpose:=False\n\nRange(\"E30\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E30&gt;E31\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E30&lt;E31\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E30=\"\"\"\",E30=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E30:Q30\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E42\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E42&lt;E43\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E42&gt;E43\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E42=\"\"\"\",E42=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E42:Q42\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E33\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E33&gt;E34\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E33&lt;E34\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E33=\"\"\"\",E33=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E33:Q33\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\nSkipBlanks:=False, Transpose:=False\n\nRange(\"E39\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E39&gt;E40\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=E39&lt;E40\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E39=\"\"\"\",E39=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E39:Q39\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\nSkipBlanks:=False, Transpose:=False\n\nEnd If\nNext sht\ncsheet.Activate\nApplication.ScreenUpdating = True\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1483647680, "creation_date": 1483566152, "question_id": 41473710, "link": "https://stackoverflow.com/questions/41473710/i-have-issues-with-looping-my-vba", "title": "I have issues with looping my vba", "body": "<p>I have the following Macro that applies conditional formatting to a worksheet.  I want to apply this formatting to every worksheet in the workbook.  I dim the worksheet and included for Each and Next in my vba but it's not looping for every worksheet.</p>\n\n<pre><code>Sub Con()\nDim wkst As Worksheet\n\nFor Each wkst In ThisWorkbook.Sheets\n\n Range(\"B4:D4,G4,K4:M4\").Select\n\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = -0.249977111117893\n    .PatternTintAndShade = 0\nEnd With\n    Range(\"F1:J1\").Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .Color = 49407\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\n\nRange(\"E8\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"E8&gt;E9\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"E8&lt;E9\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E8=\"\"\"\",E8=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E8:Q8\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n\nRange(\"E11\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=E11&gt;E12\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=E11&lt;E12\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E11=\"\"\"\",E11=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlNone\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E11:Q11\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n\n'--------------------------------------------------------------------------------------------------------'\nRange(\"E17\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=E17&gt;E18\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=E17&lt;E18\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E17=\"\"\"\",E17=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E17:Q17\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n\n'''----------------------------------------------------------------------------------------------------------------------------------'''''\n\nRange(\"E20\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=E20&gt;E21\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=E20&lt;E21\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E20=\"\"\"\",E20=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E20:Q20\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\n'''----------------------------------------------------------------------------------------------------------------------------------'''''\n'''----------------------------------------------------------------------------------------------------------------------------------'''''\n'''----------------------------------------------------------------------------------------------------------------------------------'''''\n\nRange(\"E23\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=E23&gt;E24\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=E23&lt;E24\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E23=\"\"\"\",E23=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E23:Q23\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E26\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=E26&gt;E27\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=E26&lt;E27\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E26=\"\"\"\",E26=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E26:Q26\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\nSkipBlanks:=False, Transpose:=False\n\nRange(\"E30\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=E30&gt;E31\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=E30&lt;E31\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E30=\"\"\"\",E30=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E30:Q30\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E42\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=E42&lt;E43\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=E42&gt;E43\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E42=\"\"\"\",E42=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E42:Q42\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n\nRange(\"E33\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=E33&gt;E34\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=E33&lt;E34\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E33=\"\"\"\",E33=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E33:Q33\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\nSkipBlanks:=False, Transpose:=False\n\nRange(\"E39\").Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=E39&gt;E40\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 5287936\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=E39&lt;E40\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR(E39=\"\"\"\",E39=0)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.799981688894314\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nSelection.Copy\nRange(\"E39:Q39\").Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\nSkipBlanks:=False, Transpose:=False\n\nNext\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>This is a macro I'm creating because I have a different macro that creates a temp workbook but ruins all the conditional formatting.  So I'm creating a macro that reapplies it.  Any assistance on how I can loop this would be great.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1483566088, "post_id": 41473668, "comment_id": 70153185, "body": "Can&#39;t you just check to see if the ranges that are passed in are empty?"}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483566347, "post_id": 41473668, "comment_id": 70153328, "body": "You&#39;re right. That will do it. Thanks."}], "owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483565968, "creation_date": 1483565968, "last_edit_date": 1531164843, "question_id": 41473668, "link": "https://stackoverflow.com/questions/41473668/bypass-error-from-stdev-p-when-range-has-no-values", "title": "Bypass error from StDev_P when range has no values", "body": "<p>I am trying to handle errors in a program that takes in a set of ranges, and among other items, calculates its Standard Deviation.  Because some ranges passed in are empty, I get a <code>Run-time error: Unable to get the StDev_P property of the WorksheetFunction Class</code>.  However, I am having trouble bypassing it. I tried the following, but the error still throws.</p>\n\n<pre><code>        set WF = Application.WorksheetFunction\n        If Application.WorksheetFunction.IsError(WF.StDev_P(range1)) = True Then\n            sd = 0\n        Else\n            sd = WF.StDev_P(range1)\n        End If\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1483565175, "post_id": 41473418, "comment_id": 70152753, "body": "<code>=SUMPRODUCT(TRANSPOSE(MyRange());{1;1;1})</code>?"}, {"owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1483565557, "post_id": 41473418, "comment_id": 70152919, "body": "@ScottCraner If you want to create an answer. I will accept it. Many thanks !"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1483567067, "post_id": 41473418, "comment_id": 70153686, "body": "or maybe <code>INDEX({1;1;1},0,1)</code> or <code>MyRange = Application.Transpose(output)</code> in VBA"}, {"owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1483570638, "post_id": 41473418, "comment_id": 70155201, "body": "@Slai Nice catch with TRANSPOSE directly in the VBA. It works !"}], "answers": [{"comments": [{"owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "edited": false, "score": 0, "creation_date": 1483565787, "post_id": 41473601, "comment_id": 70153019, "body": "Really weird. It looks perfectly in Function Wizard but Excel still return #VALUE! when I click OK !"}, {"owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "edited": false, "score": 0, "creation_date": 1483566129, "post_id": 41473601, "comment_id": 70153206, "body": "I put the TRANSPOSE on the other part <code>=SUMPRODUCT(MyRange();TRANSPOSE({1;1;1}))</code> and it&#39;s working now ! Many thanks !"}, {"owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "edited": false, "score": 0, "creation_date": 1483566941, "post_id": 41473601, "comment_id": 70153606, "body": "Finally, and unfortunately for me, TRANSPOSE seems to work only on &quot;hardcoded&quot; array. If I use another EXCEL function instead like <code>TRANSPOSE(--(WEEKDAY(D3:D1257,3)&lt;5))</code> or <code>--(TRANSPOSE(WEEKDAY(D3:D1257,3))&lt;5)</code>, the wizard show it correctly but not in the cell :("}, {"owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "edited": false, "score": 0, "creation_date": 1483570735, "post_id": 41473601, "comment_id": 70155244, "body": "I follow @Slai suggestion and putting TRANSPOSE directly in the VBA do the trick :)  TRANSPOSE was the right direction. Thanks !"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1483566219, "last_edit_date": 1483566219, "creation_date": 1483565652, "answer_id": 41473601, "question_id": 41473418, "link": "https://stackoverflow.com/questions/41473418/converting-a-vba-array-into-a-column-array/41473601#41473601", "title": "Converting a VBA array into a &quot;column&quot; array", "body": "<p>Use Tranpose to switch it:</p>\n\n<pre><code>=SUMPRODUCT(MyRange();TRANSPOSE({1;1;1}))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1483577304, "creation_date": 1483577304, "answer_id": 41475611, "question_id": 41473418, "link": "https://stackoverflow.com/questions/41473418/converting-a-vba-array-into-a-column-array/41475611#41475611", "title": "Converting a VBA array into a &quot;column&quot; array", "body": "<p>Another a bit faster option is to use a \"vertical\" array (not tested):</p>\n\n<pre><code>Function MyRange()\n    Dim output(1 To 3, 1 To 1)\n    output(1, 1) = 1\n    output(2, 1) = 2\n    output(3, 1) = 3\n    MyRange = output\nEnd Function\n</code></pre>\n\n<p>or a bit slower (also not tested):</p>\n\n<pre><code>Function MyRange()\n    MyRange = [{1;2;1}]\n    MyRange(3, 1) = 3\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 41473601, "answer_count": 2, "score": 0, "last_activity_date": 1483577304, "creation_date": 1483564775, "question_id": 41473418, "link": "https://stackoverflow.com/questions/41473418/converting-a-vba-array-into-a-column-array", "title": "Converting a VBA array into a &quot;column&quot; array", "body": "<p>As I'm now aware, array in Excel have two kinds of representation :</p>\n\n<pre><code>{1,2,3,4} also known as \"one-dimensional horizontal array\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>{1;2;3;4} also known as \"one-dimensional vertical array\"\n</code></pre>\n\n<p>I created a VBA function that return an array but when I use it in a function that need arrays (SUMPRODUCT), Excel display it with commas. So it always interpret it as an horizontal array. It's fine if I want to have the product with another horizontal array but it doesn't work when I try with a vertical array.</p>\n\n<p>VBA :</p>\n\n<pre><code>Function MyRange()\n    Dim output(2)\n    output(0) = 1\n    output(1) = 1\n    output(2) = 1\n    MyRange = output\nEnd Function\n</code></pre>\n\n<p>Excel</p>\n\n<pre><code>=SUMPRODUCT(MyRange();{1,1,1}) works\n=SUMPRODUCT(MyRange();{1;1;1}) is not working\n</code></pre>\n\n<p>My question ?</p>\n\n<p>How I can have Excel to show {1;1;1} instead of {1,1,1} in the 1st array ?</p>\n\n<p><a href=\"https://i.stack.imgur.com/q7iga.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q7iga.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1483563466, "post_id": 41473070, "comment_id": 70151924, "body": "Welcome to Stack Overflow.  Stack Overflow is not a code for me service.  It is a place to get specific help with existing code that does not work.  If you have problematic code please post it in the original post, with a specific explanation of what is wrong.  As is this question is too broad for this forum."}, {"owner": {"reputation": 1, "user_id": 7375316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4297c446043f0b69badcf1e6243664fa?s=128&d=identicon&r=PG&f=1", "display_name": "jdoss", "link": "https://stackoverflow.com/users/7375316/jdoss"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1483631606, "post_id": 41473070, "comment_id": 70183921, "body": "Hi, I&#39;m not trying to get someone to code for me, I am trying to get pointers to the right direction to look. I think I need to use nested loops but I&#39;m not even sure what to search. :(  Kind of stuck until I can even search for something, but everything I&#39;ve tried is too broad and what I&#39;ve found is just &quot;yes, nested loops are a thing you can do&quot; unfortunately. I had hoped I could get pointed in the right direction here. If I figure it out ever I&#39;ll post the answer."}], "owner": {"reputation": 1, "user_id": 7375316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4297c446043f0b69badcf1e6243664fa?s=128&d=identicon&r=PG&f=1", "display_name": "jdoss", "link": "https://stackoverflow.com/users/7375316/jdoss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483565813, "creation_date": 1483563294, "last_edit_date": 1483565813, "question_id": 41473070, "link": "https://stackoverflow.com/questions/41473070/excel-looping-formulas-and-merging-rows", "title": "Excel looping, formulas, and merging rows", "body": "<p>I have an excel data dump that I am trying to parse out into a report. I think that I need to use loops but my VBA is not up to snuff, haven't used it since college. I've been searching online, but my problem is I don't even know what to search to get specifically what I need. Any advice is appreciated, even if it's just pointing me in the right direction.  If I figure this out based on advice, I will post the solution later.  </p>\n\n<p>My data dump looks something like this (with many more fields/columns):\n<a href=\"https://i.stack.imgur.com/UJEax.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UJEax.png\" alt=\"Excel Screenshot with ID, Title, Rev, State, Date Changed columns\"></a>\nMy issue is with having multiple rows per ID and with the Date Changed field essentially being using for multiple purposes, as I need to pull the time between Approved to Done.  </p>\n\n<p>Here's what I have gotten so far:<br>\n<a href=\"https://i.stack.imgur.com/7tWgk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7tWgk.png\" alt=\"Excel Screenshot with Added Approved Date and Done Date columns\"></a></p>\n\n<p>I have made the data into a table, and created new columns for Approved Date and Done date.  I put in a formula that says if the State = Approved, grab the Date Changed, and the same for Done Date.  Otherwise I put N/A.  </p>\n\n<p>So now I need to go through each ID (I am thinking needs to use looping but not sure what type), keep just the rows with Approved or Done and drop the others.  Then I need to merge the rows so that there's just one row per ID, so I have the approved and done dates on the same row, and then get the date diff.  But the issue with all this is that some of these haven't been approved or done yet (will just drop those I think), some never hit the Approval state but did hit the Done state (have them throw an error about not using correct process?), and some have been changed multiple times so you actually have Approved or Done coming up multiple times per ID.  So then I need to only keep the first one and drop the others?</p>\n\n<p>And THEN I need to write it into a macro so it's repeatable and as idiot proof as possible.  :( </p>\n\n<p>So my thought is that I need to loop through each ID, and end that loop when it hits the next ID.  Inside that loop I need to set variables for the Approved and Done states and then create the Time to Complete and each loop needs to then write to a new sheet, with one ID per row and the relevant information, throwing the \"Did not complete process\" error when it was skipped and dumping the IDs that just have not finished the process yet (difference between missing Approved and missing Done). </p>\n\n<p>Am I totally overthinking this?  I am hoping to get something that I can then hand off to non-technical people where they can take their data dump and I won't have to do this for them every week, hence wanting to make it into a macro.</p>\n\n<p>Thank you for any help or advice!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1394, "user_id": 3218398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3AML.jpg?s=128&g=1", "display_name": "hstay", "link": "https://stackoverflow.com/users/3218398/hstay"}, "edited": false, "score": 0, "creation_date": 1483563446, "post_id": 41472933, "comment_id": 70151911, "body": "Where is the data you want to sum? You state in the question that you have data in Columns <code>A</code> to <code>D</code> but you are using column <code>G</code> to set your maximum row number and then you sum in Column <code>M</code> the values of Columns <code>J</code>, <code>K</code> and <code>L</code>."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 1394, "user_id": 3218398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3AML.jpg?s=128&g=1", "display_name": "hstay", "link": "https://stackoverflow.com/users/3218398/hstay"}, "edited": false, "score": 0, "creation_date": 1483563625, "post_id": 41472933, "comment_id": 70152009, "body": "Sorry, table is set up from Column A to Column R. I mis-spelled it. Every column have the same amount of data (same # of rows). So I don&#39;t think if  I set up the last row to be G or B will make a difference which I have tried. And yes, M is the sum of J, K and L."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1483564000, "post_id": 41472933, "comment_id": 70152174, "body": "Quick fixes/test, you need to define the worksheet when using <code>Rows.Count</code>, so switch it to <code>lRow = ws.Cells(ws.Rows.Count, &quot;G&quot;).End(xlUp).Row</code>.  Also, step through your macro with <code>F8</code>, and after it sets the last row, hover the mouse over <code>lRow</code> and it should show you the value that is.  Also, perhaps add <code>.Select</code> after both <code>With Range()</code> lines. (Note that using <code>.Select</code> is generally frowned upon, it can help when stepping through a macro and lets you see the range you&#39;re working with)."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483564235, "post_id": 41472933, "comment_id": 70152279, "body": "Thank you but it gave me the same result so it was still trying to go through the whole column without taking account of # of rows in column G or any other columns I have tried. When I press F8, it has yellow pointer at next i and evaluates as how I have described above."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1483564407, "post_id": 41472933, "comment_id": 70152347, "body": "What is the value you get for <code>lRow</code>?"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483564477, "post_id": 41472933, "comment_id": 70152391, "body": "The $2,005 entry is in row 2100 and so it keeps calculating as in the image. And this is something very odd. I have other arithmetic operation using vba and they all work just fine and I am trying to do this last step but it fails, so it is quite frustrating."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483564495, "post_id": 41472933, "comment_id": 70152404, "body": "Using <code>lRow = ws.Cells(ws.Rows.Count, &quot;G&quot;).End(xlUp).Row</code> will assign lrow to be the last row in your table, not the last used row.  Are you sure that your code &quot;literally ran to the bottom of the sheet&quot; or did it just go to the bottom of the table?"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1483564649, "post_id": 41472933, "comment_id": 70152474, "body": "@A.S.H. it skips that when I pressed F8."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483564651, "post_id": 41472933, "comment_id": 70152475, "body": "@YowE3K, the way I set up my data range as the table is from column A to R, so that will mean the same thing? It went to the bottom of the table which is the last row of the excel sheet. If I only set up my data range to be 2100 rows from column A to R, next week, if I dump in 2500 rows, will it capture or do I need to resize? This is what I am trying to avoid."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483564857, "post_id": 41472933, "comment_id": 70152586, "body": "@YowE3K I don&#39;t understand your comment but please see my second image if it helps."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483565200, "post_id": 41472933, "comment_id": 70152766, "body": "I tried to resize my table to be A2100-R2100 and it works but my concern is that next week if I dump new data and if range if more or less than that, do I need to resize everyweek?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483565439, "post_id": 41472933, "comment_id": 70152863, "body": "This appears to just be Excel&#39;s normal behaviour in a table.  If you enter a formula (or a formula masquerading as a <code>Value</code>) into a table and there is nothing in that column already, it will copy that formula into all rows for that column."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483565577, "post_id": 41472933, "comment_id": 70152929, "body": "You can get around it by putting a dummy value of, perhaps, &quot;x&quot; in cell M2 and then, when you run your macro, it will work correctly.  (Or as correctly as it can with the unqualified <code>Range</code>s etc.)  And it will continue to run correctly in the future."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483565824, "post_id": 41472933, "comment_id": 70153045, "body": "I tried to run &#39;lastRow = ActiveSheet.Cells(Rows.Count, &quot;G&quot;).End(xlUp).Row&#39; and it gives me 2100."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 1, "creation_date": 1483566751, "post_id": 41473761, "comment_id": 70153519, "body": "@sc1324 I was going to suggest a workaround of making the code writing a dummy constant value into the column first (which would stop Excel populating the whole column with the first formula entered) but then realised that applying the formula to more than one row at once also avoided the issue."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1483566355, "creation_date": 1483566355, "answer_id": 41473761, "question_id": 41472933, "link": "https://stackoverflow.com/questions/41472933/adding-3-columns-and-pasting-results-in-a-different-column/41473761#41473761", "title": "Adding 3 columns and pasting results in a different column", "body": "<p>This appears to just be Excel's normal behaviour in a table. If you enter a formula (or a formula masquerading as a Value) into a table and there is nothing in that column already, it will copy that formula into all rows for that column.</p>\n\n<p>This code will avoid the issue by just writing the formula to the specific rows.  (It might still have issues if row 2 is the last row of data, but I assume that won't be an issue for you.)</p>\n\n<pre><code>Sub Prem_Inc()\n    Dim lRow As Long\n    Dim i As Long\n    With Worksheets(\"TB\")\n        lRow = .Cells(.Rows.Count, \"G\").End(xlUp).Row\n        With .Range(.Cells(2, \"M\"), .Cells(lRow, \"M\"))\n            .FormulaR1C1 = \"=Sum(RC[-3], RC[-2], RC[-1])\"\n            .Style = \"Currency\"\n            'Why set NumberFormat twice??\n            .NumberFormat = \"_($* #,##0.0_);_($* (#,##0.0);_($* \"\"-\"\"??_);_(@_)\"\n            .NumberFormat = \"_($* #,##0_);_($* (#,##0);_($* \"\"-\"\"??_);_(@_)\"\n        End With\n\n        With .Range(.Cells(2, \"P\"), .Cells(lRow, \"R\"))\n            .Style = \"Currency\"\n            .NumberFormat = \"_($* #,##0.0_);_($* (#,##0.0);_($* \"\"-\"\"??_);_(@_)\"\n            .NumberFormat = \"_($* #,##0_);_($* (#,##0);_($* \"\"-\"\"??_);_(@_)\"\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 1, "accepted_answer_id": 41473761, "answer_count": 1, "score": 0, "last_activity_date": 1483566355, "creation_date": 1483562745, "last_edit_date": 1483564875, "question_id": 41472933, "link": "https://stackoverflow.com/questions/41472933/adding-3-columns-and-pasting-results-in-a-different-column", "title": "Adding 3 columns and pasting results in a different column", "body": "<p>I have a table in Excel and I want to add 3 of the columns and put the sum in another column of the same sheet using VBA. However, it seems like the code runs it to the very end (row 1048576) even though my data only has 2000+ rows. When I defined the table, I defined it like its from column A to column R so I don't know how to modify the code so it will only go through how many other rows there are in the data. </p>\n\n<p>You can see image below that it literally ran to the bottom of the sheet, which is not what I am asking for. The 3 columns are values only like 1, 2 and 3. And why I set up data as table is because every week I get new data with different # of rows. I tried to implement different formulas but it looks like the code will run to the very end of the column instead of stopping at the end of the data. So it is clearly not an issue about the formula but the way I am setting up the data range or the table.</p>\n\n<pre><code>Sub Prem_Inc()\n    Dim lRow As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"TB\")\n    lRow = ws.Cells(Rows.Count, \"G\").End(xlUp).Row\n\n    For i = 2 To lRow\n      Worksheets(\"TB\").Cells(i, 13).Value = \"=Sum(RC[-3], RC[-2], RC[-1])\"\n    Next i\n\n    With Range(\"M2\", \"M\" &amp; lRow)\n      .Style = \"Currency\"\n      .NumberFormat = \"_($* #,##0.0_);_($* (#,##0.0);_($* \"\"-\"\"??_);_(@_)\"\n      .NumberFormat = \"_($* #,##0_);_($* (#,##0);_($* \"\"-\"\"??_);_(@_)\"\n    End With\n\n    With Range(\"P2\", \"R\" &amp; lRow)\n      .Style = \"Currency\"\n      .NumberFormat = \"_($* #,##0.0_);_($* (#,##0.0);_($* \"\"-\"\"??_);_(@_)\"\n      .NumberFormat = \"_($* #,##0_);_($* (#,##0);_($* \"\"-\"\"??_);_(@_)\"\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/8UfyM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8UfyM.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/NcmyR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NcmyR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 7291567, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205980758678461/picture?type=large", "display_name": "Dakota McCarty", "link": "https://stackoverflow.com/users/7291567/dakota-mccarty"}, "is_accepted": true, "score": 0, "last_activity_date": 1484934040, "last_edit_date": 1484934040, "creation_date": 1483632814, "answer_id": 41489669, "question_id": 41472889, "link": "https://stackoverflow.com/questions/41472889/export-outlook-calendar-to-excel-to-have-that-sheet-used-as-data-to-fill-another/41489669#41489669", "title": "Export Outlook Calendar to Excel to have that sheet used as data to fill another", "body": "<p>I figured it out. </p>\n\n<p>The process I used just in case anyone had a similar problem is: </p>\n\n<p>I had one excel sheet that used: </p>\n\n<pre><code>=INDEX([CalendarExport.xlsx]Sheet1!$C:$C,MATCH(\"*first.last*\"&amp;C$3,[CalendarExport.xlsx]Sheet1!$A:$A&amp;[nate.xlsx]Sheet1!$D:$D,0))\n</code></pre>\n\n<p>This indexed the exported data from Outlook to just input whatever that calendar had for the same Person and Date. The C:C column in CalendarExport.xlsx is the data needed (the personal, vacation, etc).</p>\n\n<p>I just made a separate formula for each person. (don't forget cntl+shift+enter)</p>\n\n<p>While this gave the data I needed, it also gave much more. For example, if someone got a haircut it put \"haircut\" in the cell that corresponded with the person and the date of the haircut. </p>\n\n<p>To remedy this, I made another sheet that filtered through this. \nThis second sheet used: </p>\n\n<pre><code> =IF(COUNTIF(C5,\"**vacation**\"),\"V\",IF(COUNTIF(C5,\"**personal**\"),\"P\",IF(COUNTIF(C5,\"**half day**\"),\"Hd\",\"\")))\n</code></pre>\n\n<p>This just looked for keywords in the cells that indexed the outlook export, and put the corresponding codes if true. </p>\n\n<p>This allowed me to have a sheet with V's, P's, and Hd's and no other information. So, I had everything I needed.</p>\n\n<p>In order to automate the data to go to the Calendar sheet, I just did a macros to copy it. I didn't want to have a formula on the main sheet to connect to this smaller sheet because the data is updated and refreshed every friday, so the data from the week before would be deleted if I used a formula to find the text needed for the cell. </p>\n\n<p>To copy the data from the filtered calendar sheet and paste it as text (not as a formula) into the Main Calendar sheet, I used the following: </p>\n\n<pre><code>   Sub UpdateCalendar()\n'\n'Update Calendar\n'\n'Jan to March\n    Sheets(\"Calendar(Mechanics)\").Activate\n    ActiveSheet.Range(\"C16:BO23\").Select\n    Selection.Copy\n    Sheets(\"2017\").Select\n    Range(\"B7\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n'April to June\n    Sheets(\"Calendar(Mechanics)\").Activate\n    ActiveSheet.Range(\"BP16:EB23\").Select\n    Selection.Copy\n    Sheets(\"2017\").Select\n    Range(\"B19\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n'July to September\n    Sheets(\"Calendar(Mechanics)\").Activate\n    ActiveSheet.Range(\"EC16:GO23\").Select\n    Selection.Copy\n    Sheets(\"2017\").Select\n    Range(\"B31\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n'October to December\n    Sheets(\"Calendar(Mechanics)\").Activate\n    ActiveSheet.Range(\"GP16:JB23\").Select\n    Selection.Copy\n    Sheets(\"2017\").Select\n    Range(\"B43\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n\nEnd Sub\n</code></pre>\n\n<p>Due to how my master calendar is set up, I had to copy and paste in four separate chunks. But, no problem for me. </p>\n\n<p>On the main sheet I put a button at the top corner to allow for that page to run the macros in order to update whenever. </p>\n\n<p>I am still needing to work on automating the outlook export, but should not be very hard with some coding and google. </p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 43, "user_id": 7291567, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205980758678461/picture?type=large", "display_name": "Dakota McCarty", "link": "https://stackoverflow.com/users/7291567/dakota-mccarty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2079, "favorite_count": 0, "accepted_answer_id": 41489669, "answer_count": 1, "score": 1, "last_activity_date": 1514230865, "creation_date": 1483562602, "last_edit_date": 1514230865, "question_id": 41472889, "link": "https://stackoverflow.com/questions/41472889/export-outlook-calendar-to-excel-to-have-that-sheet-used-as-data-to-fill-another", "title": "Export Outlook Calendar to Excel to have that sheet used as data to fill another", "body": "<p><strong>Background:</strong>\nWe have a weekly meeting that we all sit around and dish out our schedules and manually input them into a master excel sheet. This is inconvenient, time consuming, and inefficient. We would like to automate the process.</p>\n\n<p><strong>What we need:</strong>\nOutlook Calendars (7 in total) -> Master Excel Sheet -> Member Schedule Excel Sheet</p>\n\n<p><strong>Outlook needs:</strong></p>\n\n<ol>\n<li>We need all 7 outlook calendars to go into one single excel\nsheet. We want it to happen on a weekly basis on Fridays.</li>\n<li>The excel sheet needs to have variables for the owner, category,\nsubject, start date, end date, attendees (this is already in the code below)</li>\n<li>The code below needs to be edited to where it is automatic and\nnot manual. At the moment we have to manually select the dates that\nthe code draws from on the calendar. We want it to be an automated\nprocess to take place every Friday evening.</li>\n<li>Also, we have a system of classification in place to say if the\nfile is confidential or not. This has caused problems with the code\nwhen trying to save since it cannot tell the program what to do.\nThis is a minor problem that we could probably work around, but\nwould be nice to have it automated as well.</li>\n</ol>\n\n<hr>\n\n<p><strong>Master excel sheet needs:</strong></p>\n\n<ol>\n<li>The 7 calendars need to be imported into this one sheet</li>\n<li>The variables mentioned above should be the columns</li>\n<li>The code below does this well, but as mentioned, we need it to be automated</li>\n</ol>\n\n<hr>\n\n<p><strong>Member Schedule Excel Sheet:</strong></p>\n\n<ol>\n<li><p>This excel sheet has a list of the members with dates by day and\nmonth. Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ROzNj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ROzNj.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>We need this excel sheet to be filled based on criteria from the\nmaster excel sheet</p>\n\n<p>a. Example: if Person1 has a vacation scheduled for 10/04/2017 to\n10/10/2017, we need the corresponding boxes filled with a \u201cV\u201d on\nthose dates for that person inside of the excel sheet.</p></li>\n<li><p>The criteria needed to be met for the sheet are:</p>\n\n<p>a. Date of event matches on both sheets</p>\n\n<p>b. Owner of Calendar matches Person (this will have to be searched\nby keyword\u2026 example: First Last on the Member Schedule Excel sheet\nwill be displayed as \u201cfirst.last@email.com\\calendar \u201c on the master\nexcel sheet.)</p>\n\n<p>c. Look for certain keywords (ie. \u201cvacation\u201d, \u201cpersoanl\u201d, etc\u2026 we\nwill set these) inside of the master sheet subject box column to\ndetermine if the specific date and person has added is a vacation\nday, personal day, half day vacation, etc. This command should fill\nin the sheet with the appropriate symbol to indicate what type of\nday it is</p>\n\n<p>d. If an event contains 2 or more of the Persons, then the column\nshould be yellow with \u201cMajor Events/Meetings\u201d being filled with the\nname of the event</p></li>\n<li>The criteria need to return the correct code corresponding with\nthe correct person, date and event</li>\n<li>If an event is more than one day, the master excel will only have\nthe start date and end date, we will need for all days in between to\nbe highlighted with the correct symbol.</li>\n</ol>\n\n<p>So far, the code I have made is:</p>\n\n<pre><code>=IF(AND(ISNUMBER(SEARCH(\"dakota.mccarty\",[Macros.xlsx]Sheet1!$A:$A)),(K$3=[Macros.xlsx]Sheet1!$D:$D),(COUNTIF( [Macros.xlsx]Sheet1!$C:$C, \"**vacation**\"))), $B$15, \"0\")\n</code></pre>\n\n<p>This searches if Vacation is in the subject and returns a \u201cV\u201d</p>\n\n<p>As you can see, its long and does only one thing...</p>\n\n<p>This is the code to bring calendars from Outlook into Excel:\nIt works, but isn't automated. </p>\n\n<pre><code>  Sub ExportAppointmentsToExcel()\n    'On the next line, the list of calendars you want to export.  Each entry is the path to a calendar.  Entries are separated by a comma.\n    Const CAL_LIST = \"user1\\Calendar, user2\\Calendar, user3\\Calendar , etc\"\n    'On the next line, edit the path to and name of the Excel spreadsheet to export to\n    Const EXCEL_FILE = \"c:\\users\\415085\\desktop\\Macros\\Macros.xlsx\"\n    Const SCRIPT_NAME = \"Export Appointments to Excel (Rev 2)\"\n    Const xlAscending = 1\n    Const xlYes = 1\n    Dim olkFld As Object, _\n        olkLst As Object, _\n        olkRes As Object, _\n        olkApt As Object, _\n        olkRec As Object, _\n        excApp As Object, _\n        excWkb As Object, _\n        excWks As Object, _\n        lngRow As Long, _\n        lngCnt As Long, _\n        strFil As String, _\n        strLst As String, _\n        strDat As String, _\n        datBeg As Date, _\n        datEnd As Date, _\n        arrTmp As Variant, _\n        arrCal As Variant, _\n        varCal As Variant\n    strDat = InputBox(\"Enter the date range of the appointments to export in the form \"\"mm/dd/yyyy to mm/dd/yyyy\"\"\", SCRIPT_NAME, Date &amp; \" to \" &amp; Date)\n    arrTmp = Split(strDat, \"to\")\n    datBeg = IIf(IsDate(arrTmp(0)), arrTmp(0), Date) &amp; \" 12:00am\"\n    datEnd = IIf(IsDate(arrTmp(1)), arrTmp(1), Date) &amp; \" 11:59pm\"\n    Set excApp = CreateObject(\"Excel.Application\")\n    Set excWkb = excApp.Workbooks.Add()\n    Set excWks = excWkb.Worksheets(1)\n    'Write Excel Column Headers\n    With excWks\n        .Cells(1, 1) = \"Calendar\"\n        .Cells(1, 2) = \"Category\"\n        .Cells(1, 3) = \"Subject\"\n        .Cells(1, 4) = \"Starting Date\"\n        .Cells(1, 5) = \"Ending Date\u201d\n        .Cells(1, 6) = \"Attendees\"\n    End With\n    lngRow = 2\n    arrCal = Split(CAL_LIST, \",\")\n    For Each varCal In arrCal\n        Set olkFld = OpenOutlookFolder(CStr(varCal))\n        If TypeName(olkFld) &lt;&gt; \"Nothing\" Then\n            If olkFld.DefaultItemType = olAppointmentItem Then\n                Set olkLst = olkFld.Items\n                olkLst.Sort \"[Start]\"\n                olkLst.IncludeRecurrences = True\n                Set olkRes = olkLst.Restrict(\"[Start] &gt;= '\" &amp; Format(datBeg, \"ddddd h:nn AMPM\") &amp; \"' AND [Start] &lt;= '\" &amp; Format(datEnd, \"ddddd h:nn AMPM\") &amp; \"'\")\n                'Write appointments to spreadsheet\n                For Each olkApt In olkRes\n                    'Only export appointments\n                    If olkApt.Class = olAppointment Then\n                        strLst = \"\"\n                        For Each olkRec In olkApt.Recipients\n                            strLst = strLst &amp; olkRec.Name &amp; \", \"\n                        Next\n                        If strLst &lt;&gt; \"\" Then strLst = Left(strLst, Len(strLst) - 2)\n                        'Add a row for each field in the message you want to export\n                        excWks.Cells(lngRow, 1) = olkFld.FolderPath\n                        excWks.Cells(lngRow, 2) = olkApt.Categories\n                        excWks.Cells(lngRow, 3) = olkApt.Subject\n                        excWks.Cells(lngRow, 4) = Format(olkApt.Start, \"mm/dd/yyyy\")\n                        excWks.Cells(lngRow, 5) = Format(olkApt.End, \"mm/dd/yyyy\")\n                        excWks.Cells(lngRow, 6) = strLst\n                        lngRow = lngRow + 1\n                        lngCnt = lngCnt + 1\n                    End If\n                Next\n            Else\n                MsgBox \"Operation cancelled.  The selected folder is not a calendar.  You must select a calendar for this macro to work.\", vbCritical + vbOKOnly, SCRIPT_NAME\n            End If\n        Else\n            MsgBox \"I could not find a folder named \" &amp; varCal &amp; \".  Folder skipped.  I will continue processing the remaining folders.\", vbExclamation + vbOKOnly, SCRIPT_NAME\n        End If\n    Next\n    excWks.Columns(\"A:I\").AutoFit\n    excWks.Range(\"A1:I\" &amp; lngRow - 1).Sort Key1:=\"Category\", Order1:=xlAscending, Header:=xlYes\n    excWks.Cells(lngRow, 8) = \"=sum(H2:H\" &amp; lngRow - 1 &amp; \")\"\n    excWkb.SaveAs EXCEL_FILE\n    excWkb.Close\n    MsgBox \"Process complete.  I exported a total of \" &amp; lngCnt &amp; \" appointments were exported.\", vbInformation + vbOKOnly, SCRIPT_NAME\n    Set excWks = Nothing\n    Set excWkb = Nothing\n    Set excApp = Nothing\n    Set olkApt = Nothing\n    Set olkLst = Nothing\n    Set olkFld = Nothing\nEnd Sub\nPrivate Function OpenOutlookFolder(strFolderPath As String) As Outlook.MAPIFolder\n    Dim arrFolders As Variant, _\n        varFolder As Variant, _\n        bolBeyondRoot As Boolean\n    On Error Resume Next\n    If strFolderPath = \"\" Then\n        Set OpenOutlookFolder = Nothing\n    Else\n        Do While Left(strFolderPath, 1) = \"\\\"\n            strFolderPath = Right(strFolderPath, Len(strFolderPath) - 1)\n        Loop\n        arrFolders = Split(strFolderPath, \"\\\")\n        For Each varFolder In arrFolders\n            Select Case bolBeyondRoot\n                Case False\n                    Set OpenOutlookFolder = Outlook.Session.Folders(varFolder)\n                    bolBeyondRoot = True\n                Case True\n                    Set OpenOutlookFolder = OpenOutlookFolder.Folders(varFolder)\n            End Select\n            If Err.Number &lt;&gt; 0 Then\n                Set OpenOutlookFolder = Nothing\n                Exit For\n            End If\n        Next\n    End If\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>Let me know if you have any other questions or confusion, I am struggling real hard with this one.</p>\n\n<p>So far I have this:</p>\n\n<pre><code>=IF(AND(ISNUMBER(SEARCH(\"dakota.mccarty\",[Macros.xlsx]Sheet1!$A:$A)),(COUNTIF([Macros.xlsx]Sheet1!$D:$D,C3)),(COUNTIF([Macros.xlsx]Sheet1!$C:$C,\"Personal\"))),$B$15, \"0\")\n</code></pre>\n\n<p>I need the \u201cPersonal\u201d to return a TRUE match only if it matches the date in the underlined COUNTIF (C3, is a date that is being matched with column D on the Macros sheet). I just don\u2019t know how to write that. I have tried a few things and keep failing.</p>\n\n<p>I really need the first and second logics to be met THEN allow for the third logic to be met to determine if its true or not. So, the first and second logics are like a large filter, then the third (and other logics after) will be the final filter of what makes the sheet.</p>\n"}, {"tags": ["arrays", "excel", "variables", "formulas", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 1758252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c2ad20d699c4a664d9c39474705da?s=128&d=identicon&r=PG", "display_name": "rchrysler", "link": "https://stackoverflow.com/users/1758252/rchrysler"}, "edited": false, "score": 0, "creation_date": 1483697646, "post_id": 41472727, "comment_id": 70212070, "body": "I have Tried using &quot;&quot; but this applies the formula to the variable as string I have tried using [ ] but this then wants to execute the formula and apply the results to a variable"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1758252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c2ad20d699c4a664d9c39474705da?s=128&d=identicon&r=PG", "display_name": "rchrysler", "link": "https://stackoverflow.com/users/1758252/rchrysler"}, "edited": false, "score": 0, "creation_date": 1483697091, "post_id": 41472808, "comment_id": 70211727, "body": "Thank you for the help. I think you may have misunderstood though.  I looking to find a way to assign the formula itself, if that is even possible, to a variable for later use and not the results of the formula."}, {"owner": {"reputation": 1, "user_id": 1758252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c2ad20d699c4a664d9c39474705da?s=128&d=identicon&r=PG", "display_name": "rchrysler", "link": "https://stackoverflow.com/users/1758252/rchrysler"}, "edited": false, "score": 0, "creation_date": 1483697713, "post_id": 41472808, "comment_id": 70212114, "body": "wsSumRange &amp;  wsLookupRange &amp; wsLookupRange2 are already set as a range and wsLookupValue &amp; varEmployeeName are string values as the sumifs criteria."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1483562268, "creation_date": 1483562268, "answer_id": 41472808, "question_id": 41472727, "link": "https://stackoverflow.com/questions/41472727/vba-assign-formula-to-variable-then-use-the-variable-to-evaluate-the-formula/41472808#41472808", "title": "VBA assign Formula to Variable then use the Variable to evaluate the Formula", "body": "<p>Use this as your formula strings:</p>\n\n<pre><code>\"SumIfs(\" &amp; wsSumRange.Address(0,0) &amp; \",\" &amp; wsLookupRange.Address(0,0) &amp; \",\" &amp;  wsLookupValue &amp; \")\"\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>\"SumIfs(\" &amp; wsSumRange.Address(0,0) &amp; \",\" &amp; wsLookupRange.Address(0,0) &amp; \",\" &amp;  wsLookupValue &amp; \",\" &amp;  wsLookupRange2.Address(0,0) &amp; \",\" &amp;  varEmployeeName &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1758252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c2ad20d699c4a664d9c39474705da?s=128&d=identicon&r=PG", "display_name": "rchrysler", "link": "https://stackoverflow.com/users/1758252/rchrysler"}, "is_accepted": false, "score": 0, "last_activity_date": 1485107916, "creation_date": 1485107916, "answer_id": 41794295, "question_id": 41472727, "link": "https://stackoverflow.com/questions/41472727/vba-assign-formula-to-variable-then-use-the-variable-to-evaluate-the-formula/41794295#41794295", "title": "VBA assign Formula to Variable then use the Variable to evaluate the Formula", "body": "<p>Thanks to all who gave their suggestions and Help.\nUltimately i was not able to get anything to work and ended up designing and rewriting the code.\nIt was hoped that there was a simply solution of applying a Formula with variables to a variable so that one did not have to keep retyping the formula and could just reference the variable that contained the formula.\nI will post my solution shortly once i have the code finalized and debugged.</p>\n"}], "owner": {"reputation": 1, "user_id": 1758252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c2ad20d699c4a664d9c39474705da?s=128&d=identicon&r=PG", "display_name": "rchrysler", "link": "https://stackoverflow.com/users/1758252/rchrysler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485107916, "creation_date": 1483561962, "last_edit_date": 1531161705, "question_id": 41472727, "link": "https://stackoverflow.com/questions/41472727/vba-assign-formula-to-variable-then-use-the-variable-to-evaluate-the-formula", "title": "VBA assign Formula to Variable then use the Variable to evaluate the Formula", "body": "<p>I require some help please.\nUsing Excel 2007.\nI'm not even sure this can be done.\nI need to maintain efficiency and speed else the application will not be used.</p>\n\n<p>I have a 'IF' statement to test for a criteria.\ndepending on the results want to assign one of several possible Formulas to a Variable for later use.\nI then need to have the Variable to Evaluate the Formula so that the result can be stored in a second variable to build an array.</p>\n\n<p>Sample Code:</p>\n\n<pre><code>If (varEmployeeName = \"(All)\" Or varEmployeeName = \"(Multiple Items)\") Then\n     **varArrayFormula = \"Application.WorksheetFunction.SumIfs(wsSumRange, wsLookupRange, wsLookupValue)\"**\nElse\n     **varArrayFormula = \"Application.WorksheetFunction.SumIfs(wsSumRange, wsLookupRange, wsLookupValue, wsLookupRange2, varEmployeeName)\"**\n</code></pre>\n\n<p>Then Later on this code will execute:</p>\n\n<pre><code>ReDim varKPIArray(0 To varLastRow) ' creates the array size\n\nFor varCol = 10 To 13\n    For varRow = 8 To varLastRow\n        varDailyKPIHeading = ws.Cells(7, varCol).Value\n        Select Case varDailyKPIHeading\n            Case \"PRODUCTIVITY\"\n                Set wsSumRange = ThisWorkbook.Worksheets(\"DailyProductivity\").Range(\"$G:$G\")\n                Set wsLookupRange = ThisWorkbook.Worksheets(\"DailyProductivity\").Range(\"$F:$F\")\n                wsLookupValue = ws.Range(\"B\" &amp; varRow).Value\n                **varSumifValue = Application.Evaluate(varArrayFormula)**\n                varKPIArray(varRow - 8) = varSumifValue\n\n            Case \"HOURS\"\n</code></pre>\n\n<p>The program will then loop through several columns and rows hence why the variables are needed.  I have 2 options at this point:\n1) is to build an array and then I can paste the array results in the appropriate cells with a second loop. \nor\n2) As I am loop through each cell I Populate the formula results to the cell</p>\n\n<p>Thank you everyone for you help, suggestions and ideas</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "edited": false, "score": 0, "creation_date": 1483563199, "post_id": 41472686, "comment_id": 70151787, "body": "Thanks for sharing. I am still having trouble as to how this looks in practice.  The link you provided gives me the answer, but what would it look in practice?"}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "edited": false, "score": 0, "creation_date": 1483564875, "post_id": 41472686, "comment_id": 70152590, "body": "Scratch that...figured it out.  Thanks."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1483564706, "last_edit_date": 1483564706, "creation_date": 1483561755, "answer_id": 41472686, "question_id": 41472619, "link": "https://stackoverflow.com/questions/41472619/setting-custom-axis-values-on-sparkline/41472686#41472686", "title": "Setting custom axis values on sparkline", "body": "<blockquote>\n  <p>The CustomMinScaleValue property can be returned or set only when the\n  MinScaleType property of the specified SparkVerticalAxis object is set\n  to xlSparkScaleCustom (3).</p>\n</blockquote>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff194837.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff194837.aspx</a></p>\n\n<p>Similar issue for <code>CustomMaxScaleValue</code></p>\n\n<p>Untested:</p>\n\n<pre><code>With spark\n\n    .Points.Markers.Visible = True\n    .Points.Markers.Color.Color = vbBlack\n\n    .Axes.Vertical.MinScaleType = xlSparkScaleCustom '&lt;&lt;&lt;\n    .CustomMinScaleValue = -0.1 \n\n    .Axes.Vertical.MaxScaleType = xlSparkScaleCustom '&lt;&lt;&lt;\n    .CustomMaxScaleValue = 1.2 \n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 41472686, "answer_count": 1, "score": 0, "last_activity_date": 1483564706, "creation_date": 1483561427, "question_id": 41472619, "link": "https://stackoverflow.com/questions/41472619/setting-custom-axis-values-on-sparkline", "title": "Setting custom axis values on sparkline", "body": "<p>I am trying to set custom values in my sparkline, however, I keep getting a <code>Run-time error: Object doesn't support this property or method</code>.  Where am I going wrong in my <code>.Custom</code> value section?</p>\n\n<pre><code>    With spark\n        .Points.Markers.Visible = True\n        .Points.Markers.Color.Color = vbBlack\n        .CustomMinScaleValue = -0.1 'error thrown here\n        .CustomMaxScaleValue = 1.2 'error will most likely be thrown here\n    End With\n</code></pre>\n"}, {"tags": ["vba", "reporting-services", "ssrs-2008", "ssrs-2008-r2"], "comments": [{"owner": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "edited": false, "score": 0, "creation_date": 1483563108, "post_id": 41472595, "comment_id": 70151744, "body": "Can&#39;t you just add <code>AND items(i) != &quot; &quot;</code> in your IF statement?"}, {"owner": {"reputation": 329, "user_id": 6475561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d4765efd1e8c45302f3a78d868f456c7?s=128&d=identicon&r=PG&f=1", "display_name": "a415", "link": "https://stackoverflow.com/users/6475561/a415"}, "reply_to_user": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "edited": false, "score": 0, "creation_date": 1483564004, "post_id": 41472595, "comment_id": 70152175, "body": "Public Shared Function RemoveDuplicates(ByVal items As Object())  As String() System.Array.Sort(items) Dim k As Integer = 0 For i As Integer = 0 To items.Length - 1 If i &gt; 0 AndAlso items(i).Equals(items(i - 1)) And items(i) != &quot; &quot; Then Continue For End If items(k) = items(i) k += 1 Next Dim unique As [String]() = New [String](k - 1) {} System.Array.Copy(items, 0, unique, 0, k) Return unique End Function   This errored out for me."}, {"owner": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "edited": false, "score": 0, "creation_date": 1483564543, "post_id": 41472595, "comment_id": 70152427, "body": "Oh yeah, in VBA the inequality operator is <code>&lt;&gt;</code>. But looking at that again, we want that to be an <code>OR</code> condition. In other words, if it&#39;s blank then skip it."}, {"owner": {"reputation": 329, "user_id": 6475561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d4765efd1e8c45302f3a78d868f456c7?s=128&d=identicon&r=PG&f=1", "display_name": "a415", "link": "https://stackoverflow.com/users/6475561/a415"}, "reply_to_user": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "edited": false, "score": 0, "creation_date": 1483565040, "post_id": 41472595, "comment_id": 70152683, "body": "That did work syntactically...but now all rows for that column appear as blank."}, {"owner": {"reputation": 329, "user_id": 6475561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d4765efd1e8c45302f3a78d868f456c7?s=128&d=identicon&r=PG&f=1", "display_name": "a415", "link": "https://stackoverflow.com/users/6475561/a415"}, "reply_to_user": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "edited": false, "score": 0, "creation_date": 1483565128, "post_id": 41472595, "comment_id": 70152732, "body": "Would you be able to tell me why the following gives me an error when there is no value for the entire field. =Join(Code.RemoveDuplicates(LookupSet(Fields!Fund_Family.Val&zwnj;&#8203;ue &amp;Fields!Portfolio_Company_Name.Value,Fields!Fund_Family.Valu&zwnj;&#8203;e &amp; Fields!Portfolio_Company_Name.Value,Fields!Security_Name.Val&zwnj;&#8203;ue, &quot;DataSet1&quot;)), &quot; / &quot;).Remove(1,1)  If I get rid of the Remove(1,1) it seems to work without any issues."}, {"owner": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "edited": false, "score": 0, "creation_date": 1483570074, "post_id": 41472595, "comment_id": 70154976, "body": "<code>.Remove(1,1)</code> means remove the second character in a string. It doesn&#39;t work with empty strings."}, {"owner": {"reputation": 329, "user_id": 6475561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d4765efd1e8c45302f3a78d868f456c7?s=128&d=identicon&r=PG&f=1", "display_name": "a415", "link": "https://stackoverflow.com/users/6475561/a415"}, "reply_to_user": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "edited": false, "score": 0, "creation_date": 1483583359, "post_id": 41472595, "comment_id": 70158789, "body": "UnderStood....is there something I can do to Not get the error....?"}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 6475561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d4765efd1e8c45302f3a78d868f456c7?s=128&d=identicon&r=PG&f=1", "display_name": "a415", "link": "https://stackoverflow.com/users/6475561/a415"}, "edited": false, "score": 0, "creation_date": 1483979015, "post_id": 41493565, "comment_id": 70309928, "body": "That did not work for me either. It gives me an ERROR where there is no Lookup."}], "tags": [], "owner": {"reputation": 815, "user_id": 3983198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b22de5d92e15bce915c99af2b58d91b?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse Potter", "link": "https://stackoverflow.com/users/3983198/jesse-potter"}, "is_accepted": false, "score": 0, "last_activity_date": 1483646004, "creation_date": 1483646004, "answer_id": 41493565, "question_id": 41472595, "link": "https://stackoverflow.com/questions/41472595/removing-blank-fields-and-duplicates/41493565#41493565", "title": "Removing blank fields and duplicates", "body": "<p>You can prevent the <code>remove(1,1)</code> error by wrapping your function in an <code>IIf()</code> function.  This way you only remove the second character from the string if there are at least two characters in the string.</p>\n\n<p>So your function would become</p>\n\n<pre><code>IIf(Len(Join(Code.RemoveDuplicates(LookupSet(Fields!Fund_Family.Val\u200c\u200bue &amp;Fields!Portfolio_Company_Name.Value,Fields!Fund_Family.Valu\u200c\u200be &amp; Fields!Portfolio_Company_Name.Value,Fields!Security_Name.Val\u200c\u200bue, \"DataSet1\")), \" / \")) &gt;= 2, Join(Code.RemoveDuplicates(LookupSet(Fields!Fund_Family.Val\u200c\u200bue &amp;Fields!Portfolio_Company_Name.Value,Fields!Fund_Family.Valu\u200c\u200be &amp; Fields!Portfolio_Company_Name.Value,Fields!Security_Name.Val\u200c\u200bue, \"DataSet1\")), \" / \").Remove(1,1), Join(Code.RemoveDuplicates(LookupSet(Fields!Fund_Family.Val\u200c\u200bue &amp;Fields!Portfolio_Company_Name.Value,Fields!Fund_Family.Valu\u200c\u200be &amp; Fields!Portfolio_Company_Name.Value,Fields!Security_Name.Val\u200c\u200bue, \"DataSet1\")), \" / \"))\n</code></pre>\n\n<p>To make this more readable, I have replaced your function with <code>CustomFunction()</code></p>\n\n<pre><code>IIf(Len(CustomFunction()) &gt;= 2, CustomFunction().Remove(1,1), CustomFunction())\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 6475561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d4765efd1e8c45302f3a78d868f456c7?s=128&d=identicon&r=PG&f=1", "display_name": "a415", "link": "https://stackoverflow.com/users/6475561/a415"}, "is_accepted": true, "score": 0, "last_activity_date": 1483979150, "creation_date": 1483979150, "answer_id": 41552442, "question_id": 41472595, "link": "https://stackoverflow.com/questions/41472595/removing-blank-fields-and-duplicates/41552442#41552442", "title": "Removing blank fields and duplicates", "body": "<p>In order to prevent the .Remove(1,1) stating an error. I created a duplicate dataset, eliminated all blank values and then performed a Lookup without the .Remove(1,1). That seemed to do the trick for me. </p>\n\n<pre><code>= Join(Code.RemoveDuplicates(LookupSet(Fields!Fund_Family.Val\u200c\u200bue &amp;Fields!Portfolio_Company_Name.Value,Fields!Fund_Family.Valu\u200c\u200be &amp; Fields!Portfolio_Company_Name.Value,Fields!Security_Name.Val\u200c\u200bue, \"DataSet4\")), \" / \")\n</code></pre>\n\n<p>That did the trick.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 13360467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oov8s.png?s=128&g=1", "display_name": "Soluzione IT Services", "link": "https://stackoverflow.com/users/13360467/soluzione-it-services"}, "is_accepted": false, "score": 0, "last_activity_date": 1589461002, "creation_date": 1589461002, "answer_id": 61797947, "question_id": 41472595, "link": "https://stackoverflow.com/questions/41472595/removing-blank-fields-and-duplicates/61797947#61797947", "title": "Removing blank fields and duplicates", "body": "<p>To handle blank field update your Shared Function code as below:</p>\n\n<pre><code>Public Shared Function RemoveDuplicates(ByVal items As Object())  As String()\nSystem.Array.Sort(items)\nDim k As Integer = 0\nFor i As Integer = 0 To items.Length - 1\n    If i &gt; 0 AndAlso items(i) &lt;&gt; \"\" AndAlso items(i).Equals(items(i - 1)) Then\n        Continue For\n    End If\n    items(k) = items(i)\n    k += 1\nNext\nDim unique As [String]() = New [String](k - 1) {}\nSystem.Array.Copy(items, 0, unique, 0, k)\nReturn unique\nEnd Function\n</code></pre>\n\n<p>Also, update the LookupSet to handle the blank space as below</p>\n\n<pre><code>=IIF(IsNothing(Code.RemoveDuplicates(LookupSet(\nFields!Fund_Family.Value &amp; Fields!Portfolio_Company_Name.Value,\nFields!Fund_Family.Value &amp; Fields!Portfolio_Company_Name.Value,\nFields!Security_Name.Value, \"DataSet1\"))(0)), \"\", Join(Code.RemoveDuplicates(LookupSet(\nFields!Fund_Family.Value &amp;Fields!Portfolio_Company_Name.Value,\nFields!Fund_Family.Value &amp; Fields!Portfolio_Company_Name.Value,\nFields!Security_Name.Value, \"DataSet1\")), \" / \"))\n</code></pre>\n\n<p>Cheers,<br/>\nKirti Singh | Soluzione IT Services</p>\n"}], "owner": {"reputation": 329, "user_id": 6475561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d4765efd1e8c45302f3a78d868f456c7?s=128&d=identicon&r=PG&f=1", "display_name": "a415", "link": "https://stackoverflow.com/users/6475561/a415"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 41552442, "answer_count": 3, "score": 2, "last_activity_date": 1595289824, "creation_date": 1483561309, "last_edit_date": 1595289824, "question_id": 41472595, "link": "https://stackoverflow.com/questions/41472595/removing-blank-fields-and-duplicates", "title": "Removing blank fields and duplicates", "body": "<p>This function works.</p>\n<pre><code>Public Shared Function RemoveDuplicates(ByVal items As Object())  As String()\n    System.Array.Sort(items)\n    Dim k As Integer = 0\n    For i As Integer = 0 To items.Length - 1\n        If i &gt; 0 AndAlso items(i).Equals(items(i - 1)) Then\n            Continue For\n        End If\n        items(k) = items(i)\n        k += 1\n    Next\n    Dim unique As [String]() = New [String](k - 1) {}\n    System.Array.Copy(items, 0, unique, 0, k)\n    Return unique\nEnd Function\n</code></pre>\n<p>I'd like to add a condition to remove the &quot; &quot; field.</p>\n<p>I am using this within a Lookupset</p>\n<pre><code>=Join(Code.RemoveDuplicates(LookupSet(Fields!Fund_Family.Value &amp;Fields!Portfolio_Company_Name.Value,Fields!Fund_Family.Value &amp; Fields!Portfolio_Company_Name.Value,Fields!Security_Name.Value, &quot;DataSet1&quot;)), &quot; / &quot;)\n</code></pre>\n<p>I am getting a result that looks like the following:<br />\n/Partners<br />\n/Orchids<br />\nTwentySomething</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1483561914, "post_id": 41472512, "comment_id": 70151166, "body": "Not being rude but it has caught me out before, are you opening the right one to check? if you look in your Documents folder (generally C:\\users&#91;USERNAME]\\documents&#91;FileN\\me].xlsm) it may be there, you didnt provide a full path, so it may be placing it in your &#39;documents&#39; folder by default."}, {"owner": {"reputation": 195, "user_id": 4690714, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/498d91afae713f28d7866f8afa9be5d2?s=128&d=identicon&r=PG&f=1", "display_name": "JeffK627", "link": "https://stackoverflow.com/users/4690714/jeffk627"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1483562577, "post_id": 41472512, "comment_id": 70151494, "body": "Good point, but it is saving to the expected location."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 4690714, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/498d91afae713f28d7866f8afa9be5d2?s=128&d=identicon&r=PG&f=1", "display_name": "JeffK627", "link": "https://stackoverflow.com/users/4690714/jeffk627"}, "edited": false, "score": 0, "creation_date": 1483562676, "post_id": 41472709, "comment_id": 70151538, "body": "Your solution partially works. It is applying the ReadOnlyRecommended, but not the WritePassword. I can&#39;t use WriteResPasswords, it&#39;s not a method of the BeforeClose event."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 195, "user_id": 4690714, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/498d91afae713f28d7866f8afa9be5d2?s=128&d=identicon&r=PG&f=1", "display_name": "JeffK627", "link": "https://stackoverflow.com/users/4690714/jeffk627"}, "edited": false, "score": 0, "creation_date": 1483562971, "post_id": 41472709, "comment_id": 70151672, "body": "OK, then with minimal change make your code do: <code>ActiveWorkbook.SaveAs FileName:=ActiveWorkbook.FullName, FileFormat:=xlOpenXMLWorkbookMacroEnabled, WriteResPassword:=&quot;abc123&quot;, ReadOnlyRecommended:=True</code>"}, {"owner": {"reputation": 195, "user_id": 4690714, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/498d91afae713f28d7866f8afa9be5d2?s=128&d=identicon&r=PG&f=1", "display_name": "JeffK627", "link": "https://stackoverflow.com/users/4690714/jeffk627"}, "edited": false, "score": 1, "creation_date": 1483564175, "post_id": 41472709, "comment_id": 70152248, "body": "Using FullName worked. This will be run by an application that will open a template and save it under a new name. One of the requirements is that the new file can only be opened for editing by people who know the password; for all others it will open as Read Only. We can&#39;t have the template opening as Read Only, hence the name comparison."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1483564233, "last_edit_date": 1483564233, "creation_date": 1483561850, "answer_id": 41472709, "question_id": 41472512, "link": "https://stackoverflow.com/questions/41472512/vba-code-in-workbook-beforeclose-runs-but-has-no-effect/41472709#41472709", "title": "VBA Code in Workbook_BeforeClose runs but has no effect", "body": "<p>You've suppressed alerts with <code>Application.DisplayAlerts = False</code>. Remove this line, and you'll see what the problem is.</p>\n\n<p>When alerts are disabled, Excel uses the default option. In this case, you would be warned that a file already exists, and Excel wants you to confirm that it's OK to overwrite. The default option to this Yes/No/Cancel is \"No\", so it would appear that the file is not actually being saved.</p>\n\n<p>The other potential problem is that you may be confusing <code>ThisWorkbook</code> and <code>ActiveWorkbook</code>.  The <code>_BeforeClose</code> event will only run from the workbook that it's in, so there is arguably no reason to do any sort of name check, assuming you always want to save the workbook where this code resides, when you close it.  </p>\n\n<p>Instead, try:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    With ThisWorkbook\n        .WritePassword = \"abc123\"\n        .ReadOnlyRecommended = True\n        .Save\n    End With\nEnd Sub\n</code></pre>\n\n<p>The above assumption may not hold if the workbook is being closed programmatically, in which case you <em>may</em> need a distinction between <code>ThisWorkbook</code> and <code>ActiveWorkbook</code>, but it's hard to imagine why when closing <em>this</em> workbook, you'd want to save a different (active) workbook.</p>\n\n<p>Also, to Gary's comment above (and I've tested this) if you're not providing a full path, the file will be saved to your Documents folder (at least it is for me in Excel 2013).</p>\n\n<p>You may need to do:</p>\n\n<pre><code>ActiveWorkbook.SaveAs FileName:=ActiveWorkbook.FullName, FileFormat:=xlOpenXMLWorkbookMacroEnabled, WriteResPassword:=\"abc123\", ReadOnlyRecommended:=True\n</code></pre>\n\n<p>In your code, as:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    If ActiveWorkbook.Name &lt;&gt; \"Shipping Manifest SaveAS Update.xlsm\" Then\n        Application.DisplayAlerts = False\n        ActiveWorkbook.SaveAs FileName:=ActiveWorkbook.FullName, FileFormat:=xlOpenXMLWorkbookMacroEnabled, WriteResPassword:=\"abc123\", ReadOnlyRecommended:=True\n        Application.DisplayAlerts = True\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1483562442, "post_id": 41472816, "comment_id": 70151433, "body": "No it didn&#39;t :)  If this code actually works then you&#39;ve placed an event procedure in a standard module and it won&#39;t fire as an event.  You can&#39;t remove the <code>Cancel</code> argument from the BeforeClose event, it&#39;s required, so if you have this code in the Workbook module, you&#39;ll get a compile error."}, {"owner": {"reputation": 1, "user_id": 7376107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cm8cW.png?s=128&g=1", "display_name": "Stoploss", "link": "https://stackoverflow.com/users/7376107/stoploss"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1483562847, "post_id": 41472816, "comment_id": 70151611, "body": "i will concede that i know far less about this than you have demonstrated. that being said: mine did run. it did save. and upon reopening did prompt me for the specified password. &#175;_(\u30c4)_/&#175;"}, {"owner": {"reputation": 195, "user_id": 4690714, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/498d91afae713f28d7866f8afa9be5d2?s=128&d=identicon&r=PG&f=1", "display_name": "JeffK627", "link": "https://stackoverflow.com/users/4690714/jeffk627"}, "edited": false, "score": 0, "creation_date": 1483562930, "post_id": 41472816, "comment_id": 70151653, "body": "Yeah, if you remove the Cancel As Boolean from the event it errors out."}, {"owner": {"reputation": 1, "user_id": 7376107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cm8cW.png?s=128&g=1", "display_name": "Stoploss", "link": "https://stackoverflow.com/users/7376107/stoploss"}, "edited": false, "score": 0, "creation_date": 1483563176, "post_id": 41472816, "comment_id": 70151772, "body": "yep... jumped the gun a bit.  mine doesn&#39;t give any errors (i also removed display alerts false) but it isn&#39;t doing a save as"}], "tags": [], "owner": {"reputation": 1, "user_id": 7376107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cm8cW.png?s=128&g=1", "display_name": "Stoploss", "link": "https://stackoverflow.com/users/7376107/stoploss"}, "is_accepted": false, "score": -1, "last_activity_date": 1483562786, "last_edit_date": 1483562786, "creation_date": 1483562286, "answer_id": 41472816, "question_id": 41472512, "link": "https://stackoverflow.com/questions/41472512/vba-code-in-workbook-beforeclose-runs-but-has-no-effect/41472816#41472816", "title": "VBA Code in Workbook_BeforeClose runs but has no effect", "body": "<p>I removed the \"cancel as Boolean\" and it worked perfectly</p>\n\n<pre><code>Private Sub Workbook_BeforeClose()\nDim FileName As String\n\n\n\nFileName = ActiveWorkbook.Name\n\nIf FileName = \"False\" Then Exit Sub\n\n\nIf FileName &lt;&gt; \"Shipping Manifest SaveAS Update.xlsm\" Then\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs FileName:=FileName, FileFormat:=xlOpenXMLWorkbookMacroEnabled, WriteResPassword:=\"abc123\", ReadOnlyRecommended:=True\n    Application.DisplayAlerts = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 4690714, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/498d91afae713f28d7866f8afa9be5d2?s=128&d=identicon&r=PG&f=1", "display_name": "JeffK627", "link": "https://stackoverflow.com/users/4690714/jeffk627"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 848, "favorite_count": 0, "accepted_answer_id": 41472709, "answer_count": 2, "score": 1, "last_activity_date": 1483564233, "creation_date": 1483560944, "last_edit_date": 1531164843, "question_id": 41472512, "link": "https://stackoverflow.com/questions/41472512/vba-code-in-workbook-beforeclose-runs-but-has-no-effect", "title": "VBA Code in Workbook_BeforeClose runs but has no effect", "body": "<p>I have the following code in an Excel 2010 workbook:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    Dim FileName As String\n\n    FileName = ActiveWorkbook.Name\n\n    If FileName = \"False\" Then Exit Sub\n\n    If FileName &lt;&gt; \"Shipping Manifest SaveAS Update.xlsm\" Then\n        Application.DisplayAlerts = False\n        ActiveWorkbook.SaveAs FileName:=FileName, FileFormat:=xlOpenXMLWorkbookMacroEnabled, WriteResPassword:=\"abc123\", ReadOnlyRecommended:=True\n        Application.DisplayAlerts = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The code executes if I insert a breakpoint and run it line-by-line, but when I reopen the workbook it does not prompt for the \"abc123\" password to open not in Read Only mode - it just opens. What am I doing wrong? I made sure macros are enabled.</p>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1483560622, "post_id": 41472365, "comment_id": 70150518, "body": "<code>Dim rng As range</code> - did you copy this directly from the VB editor? <code>range</code> should be automatically converted to <code>Range</code>: if that&#39;s not happeneing then there is something off in your code (did you define a variable named &quot;range&quot; somewhere ?)"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1483560728, "post_id": 41472365, "comment_id": 70150575, "body": "yes, i wrote it in VBE following a guide i found online"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1483560765, "post_id": 41472365, "comment_id": 70150596, "body": "&quot;yes&quot; to which question?"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1483561345, "post_id": 41472365, "comment_id": 70150904, "body": "i coppied it directly from the editor and defined rng in the first set statement and used it in the stement above the last comment"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1483561661, "post_id": 41472365, "comment_id": 70151063, "body": "Check the rest of your code for a variable or sub/function called &quot;range&quot; - something is wrong there."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1483561813, "post_id": 41472365, "comment_id": 70151131, "body": "i have this code isolated in a separate sub untill i get it running and it gives me that error"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1483561906, "post_id": 41472365, "comment_id": 70151165, "body": "Copy just that code into a new workbook and compile it.  Is &quot;range&quot; automatically converted to &quot;Range&quot; ?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1483563548, "post_id": 41472365, "comment_id": 70151970, "body": "What is the value of <code>lMaxRows</code>? Could you check it in the debugger or print it out before the statement?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1483596046, "post_id": 41472365, "comment_id": 70161929, "body": "@Vbasic4now can you also upload the rest of your relevant code ?"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1484101059, "post_id": 41472365, "comment_id": 70368001, "body": "Sometimes the VB Editor will stop capitalizing a certain type, who knows why. I&#39;m more interested in how <code>lMaxRows</code> is declared (should be a Long) and what its value is."}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483560333, "creation_date": 1483560333, "question_id": 41472365, "link": "https://stackoverflow.com/questions/41472365/excel-vba-issues-creating-a-chart", "title": "excel vba issues creating a chart", "body": "<p>I am trying to add some code to the bottom of an already working macro that will add a chart to the sheet that i just copied data into. the amount of data is changing regularly so I need the data range to be variable. however when I run the code it gives me the error \"Run-time error '1004': Method 'Range' of object'_Worksheet' failed\"</p>\n\n<pre><code>Dim destSheet As Worksheet: Set destSheet = ThisWorkbook.Worksheets(\"Name Search\")\nDim rng As range\nDim cht As Object\nlMaxRows = destSheet.Cells(destSheet.Rows.Count, \"A\").End(xlUp).Row\n\n'Your data range for the chart\n  Set rng = destSheet.range(\"F6:G\" &amp; lMaxRows)\n\n'Create a chart\n  Set cht = destSheet.Shapes.AddChart2\n\n'Give chart some data\n  cht.chart.SetSourceData Source:=rng\n\n'Determine the chart type\n  cht.chart.ChartType = xlXYScatterLines\n</code></pre>\n\n<p>the error is occuring on the line under the \"Your data range for the chart\" note. Any help would be greatly appreciated. Ive never been able to successfully make a chart through VBA before </p>\n"}, {"tags": ["excel", "mouseover", "udf", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483565008, "post_id": 41472325, "comment_id": 70152666, "body": "Even if you <i>could</i> alter the cell formatting with a UDF, you aren&#39;t actually <b><i>returning</i></b> anything, so your first argument to <code>HYPERLINK</code> is <code>Empty</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483582098, "post_id": 41472325, "comment_id": 70158495, "body": "@Comintern - check the link at the top of the question"}], "answers": [{"comments": [{"owner": {"reputation": 3218, "user_id": 268721, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/377b60db3c8bf7ffc68f52330a58b4b2?s=128&d=identicon&r=PG", "display_name": "tic", "link": "https://stackoverflow.com/users/268721/tic"}, "edited": false, "score": 0, "creation_date": 1483591329, "post_id": 41476253, "comment_id": 70160484, "body": "You can set the color but not the linestyle. And I imagine also the width. So, it does NOT work also for you."}, {"owner": {"reputation": 3218, "user_id": 268721, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/377b60db3c8bf7ffc68f52330a58b4b2?s=128&d=identicon&r=PG", "display_name": "tic", "link": "https://stackoverflow.com/users/268721/tic"}, "edited": false, "score": 0, "creation_date": 1483591688, "post_id": 41476253, "comment_id": 70160577, "body": "Sorry, I intend weight, not width."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1483581883, "creation_date": 1483581883, "answer_id": 41476253, "question_id": 41472325, "link": "https://stackoverflow.com/questions/41472325/public-function-in-excel-that-does-not-work-properly-as-udf/41476253#41476253", "title": "public function in Excel that does not work properly as UDF", "body": "<p>This worked for me - I could set the color but not the linestyle to xlNone</p>\n\n<pre><code>Public Function OnMouseOver(row, col)\n     With ActiveSheet\n        .Range(\"C5:H23\").Borders.Color = RGB(200, 200, 200)\n        .Cells(row, col).Borders.Color = vbRed\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3218, "user_id": 268721, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/377b60db3c8bf7ffc68f52330a58b4b2?s=128&d=identicon&r=PG", "display_name": "tic", "link": "https://stackoverflow.com/users/268721/tic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483581883, "creation_date": 1483560174, "last_edit_date": 1531161705, "question_id": 41472325, "link": "https://stackoverflow.com/questions/41472325/public-function-in-excel-that-does-not-work-properly-as-udf", "title": "public function in Excel that does not work properly as UDF", "body": "<p>I've use <a href=\"https://superuser.com/questions/802479/how-can-i-trigger-an-excel-macro-by-hovering-a-mouse-over-a-cell\">this</a> hack to intercept a mouse movement on a cell.\nIn A1 I have imputed the following formula:</p>\n\n<pre><code>=IFERROR(HYPERLINK(OnMouseOver(ROW(),COLUMN()),\"Click here\"), \"Click here\")\n</code></pre>\n\n<p>Then I've written the following function to clear all the borders in a large range and draw thick borders around the cell the mouse is hovering.</p>\n\n<pre><code>Public Function OnMouseOver(row, col)\nDim ra As Range\n    Set ra = Sheets(\"Sheet1\").Columns(\"A:BJ\") 'Range(\"griglia\")\n    ra.Borders(xlDiagonalDown).LineStyle = xlNone\n    ra.Borders(xlDiagonalUp).LineStyle = xlNone\n    ra.Borders(xlEdgeLeft).LineStyle = xlNone\n    ra.Borders(xlEdgeTop).LineStyle = xlNone\n    ra.Borders(xlEdgeBottom).LineStyle = xlNone\n    ra.Borders(xlEdgeRight).LineStyle = xlNone\n    ra.Borders(xlInsideVertical).LineStyle = xlNone\n    ra.Borders(xlInsideHorizontal).LineStyle = xlNone\n\n    Set ra = ActiveSheet.Cells(row, col)\n    ra.Borders(xlDiagonalDown).LineStyle = xlNone\n    ra.Borders(xlDiagonalUp).LineStyle = xlNone\n    With ra.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .Color = -16776961\n        .TintAndShade = 0\n        .Weight = xlThick\n    End With\n    With ra.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .Color = -16776961\n        .TintAndShade = 0\n        .Weight = xlThick\n    End With\n    With ra.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .Color = -16776961\n        .TintAndShade = 0\n        .Weight = xlThick\n    End With\n    With ra.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .Color = -16776961\n        .TintAndShade = 0\n        .Weight = xlThick\n    End With\nEnd Function\n</code></pre>\n\n<p>This function does not clear existing borders and furthermore it draws only thin borders around A1. On the other hand it works as expected when I run it through this code:</p>\n\n<pre><code>Sub testfunction()\nCall OnMouseOver(1, 1)\nEnd Sub\n</code></pre>\n\n<p>Why this strange behaviour?</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2013"], "comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 1, "creation_date": 1483561964, "post_id": 41472061, "comment_id": 70151187, "body": "It&#39;s possible that it won&#39;t execute because it&#39;s open, you may have to write the changes to an array and then run them all after you close rs2.  You should try looking at the Execute method, it allows better error handling.  The difference between the two, with examples, is <a href=\"http://www.utteraccess.com/wiki/index.php/RunSQL_vs_Execute\" rel=\"nofollow noreferrer\">explained nicely on this Wiki site</a>."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1483579329, "post_id": 41472061, "comment_id": 70157836, "body": "Are you saying the <code>DoCmd.RunSQL</code> does not run? If it failed, an error would raise."}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1483620080, "post_id": 41472061, "comment_id": 70175554, "body": "@Parfait - when stepping through the code the line is hit, no error is thrown.  When the code completes, if I design view the table &quot;___TestTable&quot; there are multiple fields that are data type other than Text"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1483620111, "post_id": 41472061, "comment_id": 70175574, "body": "@JohnnyBones - that is a good theory!  I am looking into syntax of populating an array to iterate after closing rs2 :)"}], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "is_accepted": true, "score": 0, "last_activity_date": 1483627536, "creation_date": 1483627536, "answer_id": 41487865, "question_id": 41472061, "link": "https://stackoverflow.com/questions/41472061/vba-to-execute-alter-table-statement/41487865#41487865", "title": "VBA To Execute Alter Table Statement", "body": "<p>It looks like @Johnny Bones was correct with his statement of the syntax not executing due to it being open.  I altered syntax and use this which works exactly as it should.  May not be the best syntax, and def needs some error handling, but it is working now!</p>\n\n<pre><code>Function Blue()\nDim CreateTableSQL As String\nDim fld As DAO.Field\nSet db = CurrentDb()\n\nCreateTableSQL = \"CREATE TABLE [GreenSocks] (FieldPK COUNTER CONSTRAINT PrimaryKey PRIMARY KEY, fieldname TEXT);\"\ndb.Execute CreateTableSQL\n\nSet rs2 = db.OpenRecordset(\"___TestTable\")\nFor Each fld In rs2.Fields\n    If fld.Name &lt;&gt; \"ID\" And fld.Name &lt;&gt; \"Store Number\" Then\n        If FieldTypeName(fld) &lt;&gt; \"Text\" Then\n            Debug.Print fld.Name\n\n                strSQL = \"INSERT INTO GreenSocks (fieldname) VALUES ('\" &amp; fld.Name &amp; \"' );\"\n                DoCmd.RunSQL strSQL\n\n        End If\n    End If\nNext\n\nSet fld = Nothing\nrs2.Close\n\nstrSQL = \"select fieldname from GreenSocks\"\n\nSet rs3 = db.OpenRecordset(strSQL)\nFor Each fld In rs3.Fields\n\n    Debug.Print fld.Value\n\n    secondSQL = \"ALTER TABLE __TestTable ALTER COLUMN [\" &amp; fld.Value &amp; \"] TEXT(40);\"\n\n    DoCmd.RunSQL secondSQL\n\n Next\n\n  Set fld = Nothing\n  rs3.Close\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3911, "favorite_count": 0, "accepted_answer_id": 41487865, "answer_count": 1, "score": 0, "last_activity_date": 1593956932, "creation_date": 1483559122, "last_edit_date": 1593956932, "question_id": 41472061, "link": "https://stackoverflow.com/questions/41472061/vba-to-execute-alter-table-statement", "title": "VBA To Execute Alter Table Statement", "body": "<p>I am attempting to execute an <code>Alter Table</code> statement through VBA.  I use the function <a href=\"http://allenbrowne.com/func-06.html\" rel=\"nofollow noreferrer\">Allen Brown Table Info()</a> to get the field type, and this VBA to actually run the SQL Sytnax.  Here is my issue:</p>\n\n<blockquote>\n  <p>1) <code>Debug.Print fld.Name</code> prints the correct field naem<br>\n  2) <code>Debug.Print SecondSQL</code> prints valid &amp; correct SQL Syntax (if I run in a query it actaully alters the table)</p>\n</blockquote>\n\n<p>What should I alter in order for the VBA syntax to alter the table?</p>\n\n<pre><code>Function AlterTable()\nDim secondSQL As String\nSet rs2 = db.OpenRecordset(\"___TestTable\")\nFor Each fld In rs2.Fields\nIf fld.Name &lt;&gt; \"ID\" Then\n    If FieldTypeName(fld) &lt;&gt; \"Text\" Then\n        Debug.Print fld.Name            \n        secondSQL = \"ALTER TABLE ___TestTable ALTER COLUMN [\" &amp; fld.Name &amp; \"] TEXT(40);\"\n        Debug.Print secondSQL\n        DoCmd.RunSQL secondSQL\n    End If\nEnd If\nNext\n\n'Disposing of Objects\nSet fld = Nothing\nrs2.Close\n\nEnd Function\n\n\nFunction FieldTypeName(fld As DAO.Field) As String\n'Purpose: Converts the numeric results of DAO Field.Type to text.\nDim strReturn As String    'Name to return\n\nSelect Case CLng(fld.Type) 'fld.Type is Integer, but constants are Long.\n    Case dbBoolean: strReturn = \"Yes/No\"            ' 1\n    Case dbByte: strReturn = \"Byte\"                 ' 2\n    Case dbInteger: strReturn = \"Integer\"           ' 3\n    Case dbLong                                     ' 4\n        If (fld.Attributes And dbAutoIncrField) = 0&amp; Then\n            strReturn = \"Long Integer\"\n        Else\n            strReturn = \"AutoNumber\"\n        End If\n    Case dbCurrency: strReturn = \"Currency\"         ' 5\n    Case dbSingle: strReturn = \"Single\"             ' 6\n    Case dbDouble: strReturn = \"Double\"             ' 7\n    Case dbDate: strReturn = \"Date/Time\"            ' 8\n    Case dbBinary: strReturn = \"Binary\"             ' 9 (no interface)\n    Case dbText                                     '10\n        If (fld.Attributes And dbFixedField) = 0&amp; Then\n            strReturn = \"Text\"\n        Else\n            strReturn = \"Text (fixed width)\"        '(no interface)\n        End If\n    Case dbLongBinary: strReturn = \"OLE Object\"     '11\n    Case dbMemo                                     '12\n        If (fld.Attributes And dbHyperlinkField) = 0&amp; Then\n            strReturn = \"Memo\"\n        Else\n            strReturn = \"Hyperlink\"\n        End If\n    Case dbGUID: strReturn = \"GUID\"                 '15\n\n    'Attached tables only: cannot create these in JET.\n    Case dbBigInt: strReturn = \"Big Integer\"        '16\n    Case dbVarBinary: strReturn = \"VarBinary\"       '17\n    Case dbChar: strReturn = \"Char\"                 '18\n    Case dbNumeric: strReturn = \"Numeric\"           '19\n    Case dbDecimal: strReturn = \"Decimal\"           '20\n    Case dbFloat: strReturn = \"Float\"               '21\n    Case dbTime: strReturn = \"Time\"                 '22\n    Case dbTimeStamp: strReturn = \"Time Stamp\"      '23\n\n    'Constants for complex types don't work prior to Access 2007 and later.\n    Case 101&amp;: strReturn = \"Attachment\"         'dbAttachment\n    Case 102&amp;: strReturn = \"Complex Byte\"       'dbComplexByte\n    Case 103&amp;: strReturn = \"Complex Integer\"    'dbComplexInteger\n    Case 104&amp;: strReturn = \"Complex Long\"       'dbComplexLong\n    Case 105&amp;: strReturn = \"Complex Single\"     'dbComplexSingle\n    Case 106&amp;: strReturn = \"Complex Double\"     'dbComplexDouble\n    Case 107&amp;: strReturn = \"Complex GUID\"       'dbComplexGUID\n    Case 108&amp;: strReturn = \"Complex Decimal\"    'dbComplexDecimal\n    Case 109&amp;: strReturn = \"Complex Text\"       'dbComplexText\n    Case Else: strReturn = \"Field type \" &amp; fld.Type &amp; \" unknown\"\nEnd Select\n\nFieldTypeName = strReturn\nEnd Function\n</code></pre>\n"}, {"tags": ["python", "vba", "excel"], "comments": [{"owner": {"reputation": 8450, "user_id": 3462319, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89268869f7b0ba2846aecad61a51b458?s=128&d=identicon&r=PG&f=1", "display_name": "depperm", "link": "https://stackoverflow.com/users/3462319/depperm"}, "edited": false, "score": 0, "creation_date": 1483558767, "post_id": 41471924, "comment_id": 70149655, "body": "correct indentation, what isn&#39;t working"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1483558955, "post_id": 41471924, "comment_id": 70149740, "body": "VBA: <code>If Saved = False Then</code>, python <code>if Saved==True:</code>. Are you for real?"}, {"owner": {"reputation": 75033, "user_id": 84270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2c0de47c3681c58f25b1eb821f7221?s=128&d=identicon&r=PG", "display_name": "John Machin", "link": "https://stackoverflow.com/users/84270/john-machin"}, "edited": false, "score": 0, "creation_date": 1483559266, "post_id": 41471924, "comment_id": 70149876, "body": "indentation NOT correct -- see def followed by if at same indent level"}, {"owner": {"reputation": 75033, "user_id": 84270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2c0de47c3681c58f25b1eb821f7221?s=128&d=identicon&r=PG", "display_name": "John Machin", "link": "https://stackoverflow.com/users/84270/john-machin"}, "edited": false, "score": 0, "creation_date": 1483559703, "post_id": 41471924, "comment_id": 70150101, "body": "Saved and SaveNormSRnd need to be either globals (YUK!) or args that must be carried around or attributes of a class instance"}, {"owner": {"reputation": 75033, "user_id": 84270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2c0de47c3681c58f25b1eb821f7221?s=128&d=identicon&r=PG", "display_name": "John Machin", "link": "https://stackoverflow.com/users/84270/john-machin"}, "edited": false, "score": 0, "creation_date": 1483560097, "post_id": 41471924, "comment_id": 70150285, "body": "need to return some value, don&#39;t assign to function name"}, {"owner": {"reputation": 75033, "user_id": 84270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2c0de47c3681c58f25b1eb821f7221?s=128&d=identicon&r=PG", "display_name": "John Machin", "link": "https://stackoverflow.com/users/84270/john-machin"}, "edited": false, "score": 0, "creation_date": 1483560675, "post_id": 41471924, "comment_id": 70150542, "body": "np is not defined"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1483561859, "post_id": 41471924, "comment_id": 70151153, "body": "I don&#39;t know python (I came to the question because of the vba tag) but should <code>def MarsagliaBrayNormSRnd(u1,u1,x,y):</code> be <code>def MarsagliaBrayNormSRnd(u1,u2,x,y):</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 19199, "user_id": 131187, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/27eJi.jpg?s=128&g=1", "display_name": "Bill Bell", "link": "https://stackoverflow.com/users/131187/bill-bell"}, "is_accepted": false, "score": 1, "last_activity_date": 1483563176, "creation_date": 1483563176, "answer_id": 41473038, "question_id": 41471924, "link": "https://stackoverflow.com/questions/41471924/marsaglia-bray-converting-vba-code-to-python/41473038#41473038", "title": "Marsaglia bray, converting VBA code to Python", "body": "<p>No need for the truly hideous constructions required in many other languages!</p>\n\n<pre><code>from random import random\nfrom numpy import sqrt, log\n\ndef MarsagliaBrayNormSRnd():\n    while True:\n        x = 2\n        while x &gt; 1:\n            u1 = 2 * random() - 1\n            u2 = 2 * random() - 1\n            x = (u1 * u1) + (u2 * u2)   \n        y = sqrt( -2 * log(x) / x )\n        yield u1 * y\n        yield u2 * y\n\nfor i, N in enumerate(MarsagliaBrayNormSRnd()):\n    print (N)\n    if i&gt;10:\n        break\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 7128258, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157646866865524/picture?type=large", "display_name": "J&#248;rgen Hanson Mathiesen", "link": "https://stackoverflow.com/users/7128258/j%c3%b8rgen-hanson-mathiesen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1483577054, "creation_date": 1483558608, "last_edit_date": 1531164843, "question_id": 41471924, "link": "https://stackoverflow.com/questions/41471924/marsaglia-bray-converting-vba-code-to-python", "title": "Marsaglia bray, converting VBA code to Python", "body": "<p>I was wondering if someone knows how to convert this VBA code for a random variable generation into Python.\n(The \"Saved\" variable is a Boolean in VBA)</p>\n\n<pre><code>function MarsagliaBrayNormSRnd() As Double\nDim U1 As Double, U2 As Double\nDim x As Double, Y As Double\n\nIf Saved = False Then\n   x = 2\n\n   While x &gt; 1\n      U1 = (2 * Rnd() - 1)\n      U2 = (2 * Rnd() - 1)\n      x = (U1 * U1) + (U2 * U2)\n   Wend\n\n   Y = Sqr(-2 * Log(x) / x)\n   MarsagliaBrayNormSRnd = U1 * Y\n   SavedNormSRnd = U2 * Y\n   Saved = True\nElse\n   MarsagliaBrayNormSRnd = SavedNormSRnd\n   Saved = False\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>I tried this code myself but did not get it to work:</p>\n\n<pre><code>import math\nimport pandas as pd\nimport numpy as np\n\ndef MarsagliaBrayNormSRnd(u1,u1,x,y):\nif Saved==False:\n    x = 2\n\n    while x &gt; 1:\n        np.random.seed(1)\n        u1 = 2 * np.random.random((3,1)) - 1\n        u2 = 2 * np.random.random((3,1)) - 1\n        x = (u1 * u1) + (u2 * u2)   \n\n    y = math.sqrt(-2 * math.log(x) / x)\n    MarsagliaBrayNormSRnd = u1 * y\n    SavedNormSRnd = u2 * y\n    Saved = True\nelse:\n    MarsagliaBrayNormSRnd = SavedNormSRnd\n    Saved = False\n</code></pre>\n"}, {"tags": ["excel", "vba", "dom", "captcha"], "comments": [{"owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 1, "creation_date": 1483558778, "post_id": 41471836, "comment_id": 70149661, "body": "Let me guess, you have an excel column of CNPJ numbers and you&#39;re trying to screen scrape data out of this website.  That&#39;s exactly what the captcha is designed to prevent, and it&#39;s doing a good job."}, {"owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "reply_to_user": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 0, "creation_date": 1483559110, "post_id": 41471836, "comment_id": 70149810, "body": "Human interaction is preserved - the characters will still have to be typed. Captcha will still do its job which is to prevent bots even if i succed. So, I do not undertand your comment, which isnt useful or helpful in any way at all. I will only automate the &quot;copy&quot; and &quot;paste&quot; of data..."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483572052, "post_id": 41471836, "comment_id": 70155731, "body": "See <a href=\"http://stackoverflow.com/q/36636255/4088852\">this question</a>."}, {"owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483572485, "post_id": 41471836, "comment_id": 70155895, "body": "Thanks @comintern. Before posting I had stumbled on that post, but since i&#39;m not familiar with Python, i skiped that and still hope there is a vba solution or workaround. There is a lot more code than this already working in the macro and the effort to transport it entirly to another code wold be a pain in the a**... but thx!!!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483572543, "post_id": 41471836, "comment_id": 70155924, "body": "Use the same method, not Python - take a screenshot, then crop it."}], "owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1496, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483558231, "creation_date": 1483558231, "question_id": 41471836, "link": "https://stackoverflow.com/questions/41471836/dealing-with-random-generated-captcha-on-access-in-excel-vba", "title": "Dealing with random generated captcha on access in excel/vba", "body": "<p>The task is kind o simple, yet complicated.</p>\n\n<p>I'm trying to:\n1. get the captcha image from a specific internet page\n2. load it into a Picture.box inside a form.\n3. the user type the characters which are sent back to the respective input in that page.</p>\n\n<p>The site is: <a href=\"http://www.receita.fazenda.gov.br/PessoaJuridica/CNPJ/cnpjreva/Cnpjreva_Solicitacao2.asp\" rel=\"nofollow noreferrer\">http://www.receita.fazenda.gov.br/PessoaJuridica/CNPJ/cnpjreva/Cnpjreva_Solicitacao2.asp</a></p>\n\n<p>The captcha image is downloaded from a static address, there is no unique id in the url or any \"src\" attribute inside its DOM element.</p>\n\n<p>Having no problem at downloading the image and showing it in a form (even it being png).</p>\n\n<p>The issue is that each time the link of the image is accessed it generates any random captcha, so when the code downloads it, it gets a different image than the one on the page, which characters do not match the ones expected.</p>\n\n<p>I've made a manual test, to load in a alternate tab of the browser the direct link of the captcha, which obviously returned a different image from that on the page, but for my surprise, typing its character even it being different worked. So, if a new image is generated in the same enviroment (in this example Internet explorer), it will match the expecteded sequence in the input of the page.\nSo i think a workaround would have to do with dealing with cookies or sort of, but idk how...</p>\n\n<p>The direct link of the Captcha Image is: <a href=\"http://www.receita.fazenda.gov.br/PessoaJuridica/CNPJ/cnpjreva/captcha/gerarCaptcha.asp\" rel=\"nofollow noreferrer\">http://www.receita.fazenda.gov.br/PessoaJuridica/CNPJ/cnpjreva/captcha/gerarCaptcha.asp</a></p>\n\n<p>The small piece of code which concerns to this is:</p>\n\n<pre><code>IMGurl = \"http://www.receita.fazenda.gov.br/PessoaJuridica/CNPJ/cnpjreva/captcha/gerarCaptcha.asp\" 'Direct link of the captcha image\n    filepath = ThisWorkbook.Path &amp; \"\\\" &amp; \"captcha.png\"\n    fileR = URLDownloadToFile(0, IMGurl, filepath, 0, 0)'function to download the image file\n\n    Load FrmCaptcha 'form to show the image downloaded\n    FrmCaptcha.Show\n\n\n    docweb.getElementsByTagName(\"input\")(2).Value = FrmCaptcha.TextBox1.Value    'send the characters typed in the form to the input at the page.\n    docweb.getElementsByTagName(\"input\")(3).click    'clicks the button\n    Unload FrmCaptcha     'unloads the form\n</code></pre>\n\n<p>Hope someone can help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1483561351, "post_id": 41471740, "comment_id": 70150908, "body": "You&#39;ll have to use a workaround.  See <a href=\"http://stackoverflow.com/questions/16602872/set-auto-filtering-multiple-wildcards/34822944#34822944\">here for using a dictionary</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4223089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d0ea16f945a9b7b137c59ed52f096c48?s=128&d=identicon&r=PG&f=1", "display_name": "user4223089", "link": "https://stackoverflow.com/users/4223089/user4223089"}, "edited": false, "score": 0, "creation_date": 1483717111, "post_id": 41472669, "comment_id": 70223763, "body": "WOW! You are THE man Tom. Thank you! Just beautiful how some people know these things, bravo sir!"}], "tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": true, "score": 1, "last_activity_date": 1483561689, "creation_date": 1483561689, "answer_id": 41472669, "question_id": 41471740, "link": "https://stackoverflow.com/questions/41471740/excel-begins-with-range-of-alphabet-letters/41472669#41472669", "title": "Excel &quot;Begins With...&quot; range of alphabet letters", "body": "<p>If you don't mind using an advanced filter, this should work</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=6, Criteria1:= _\n    \"&gt;=a\", Operator:=xlAnd, Criteria2:=\"&lt;j\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4223089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d0ea16f945a9b7b137c59ed52f096c48?s=128&d=identicon&r=PG&f=1", "display_name": "user4223089", "link": "https://stackoverflow.com/users/4223089/user4223089"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 41472669, "answer_count": 1, "score": 0, "last_activity_date": 1483561689, "creation_date": 1483557840, "last_edit_date": 1531161705, "question_id": 41471740, "link": "https://stackoverflow.com/questions/41471740/excel-begins-with-range-of-alphabet-letters", "title": "Excel &quot;Begins With...&quot; range of alphabet letters", "body": "<p>I am trying to filter a column to show all rows that start with the letters A through I. I have looked at the VBA code and I see that for two criteria it shows:</p>\n\n<p><code>ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=6, Criteria1:= _\n        \"=a*\", Operator:=xlOr, Criteria2:=\"=b*\"</code></p>\n\n<p>How would I tell it to only show letters A THROUGH I?</p>\n\n<p>*I would also not like to use Advanced Filter if at all possible.</p>\n"}, {"tags": ["vba", "excel", "macros", "export-to-csv"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483559137, "post_id": 41471556, "comment_id": 70149829, "body": "(a) You can&#39;t have VBA in a CSV file - a CSV file is a simple text file.  (b) Instead of deleting rows via a macro, why don&#39;t you just not bother writing those records to the original CSV file?  (c) I just noticed that your file isn&#39;t a CSV file anyway, it&#39;s a pipe-delimited file with a CSV extension."}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483559269, "post_id": 41471556, "comment_id": 70149878, "body": "@YowE3K thanks for the comment! Since It&#39;s a SQL server that is connected with Access, It&#39;s impossible for me to edit it."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483559327, "post_id": 41471556, "comment_id": 70149906, "body": "So you can&#39;t edit &quot;Step 1&quot; code?  It isn&#39;t Access VBA?"}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483559332, "post_id": 41471556, "comment_id": 70149909, "body": "@YowE3K to follow-up (a), I believe I can run a vba code on the csv file. As I have deleted unnecessary rows through vba code."}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483559399, "post_id": 41471556, "comment_id": 70149947, "body": "@YowE3K Maybe I can code to export only those rows that I want to export?"}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483559438, "post_id": 41471556, "comment_id": 70149964, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/132334/discussion-between-john-tipton-and-yowe3k\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 0, "creation_date": 1483559545, "post_id": 41472150, "comment_id": 70150017, "body": "So you have edited to CDate(rst(3)) &gt;= Date! I see what you are doing there! Thanks will let you know how it works!"}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 0, "creation_date": 1483559814, "post_id": 41472150, "comment_id": 70150153, "body": "Thank you so much! You are a genius! :) You found a much simpler way to solve it! Thank you again"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 0, "creation_date": 1483559954, "post_id": 41472150, "comment_id": 70150222, "body": "Just check whether the downstream processes are expecting comma or pipe as the delimiter.  My guess is that your old method was saving the file out of excel as a true comma-separated values file, while Access was saving it as pipe-delimited.  (You may need to change the <code>&quot;|&quot;</code> to <code>&quot;,&quot;</code> in the code I posted.)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1483560302, "last_edit_date": 1483560302, "creation_date": 1483559483, "answer_id": 41472150, "question_id": 41471556, "link": "https://stackoverflow.com/questions/41471556/dynamically-add-and-run-a-vba-code/41472150#41472150", "title": "Dynamically add and run a vba code", "body": "<p>You could simply change your existing Step 1 code to be:</p>\n\n<pre><code>Dim dbs As DAO.Database\nDim rst As DAO.Recordset\nDim intFile As Integer\nDim strFilePath As String\nDim intCount As Integer\nDim strHold    \nstrFilePath = \"C:\\temp\\TEST.csv\"    \nSet dbs = CurrentDb    \nSet rst = dbs.OpenRecordset(\"Import\", dbOpenForwardOnly)    \nintFile = FreeFile\nOpen strFilePath For Output As #intFile    \nDo Until rst.EOF\n   'Check the 4th field to see whether it is today or later\n   If CDate(rst(3)) &gt;= Date Then\n       'If so, create a record (if not, don't)\n       For intCount = 0 To rst.Fields.Count - 1\n           strHold = strHold &amp; rst(intCount).Value &amp; \"|\"\n       Next\n       If Right(strHold, 1) = \"|\" Then\n           strHold = Left(strHold, Len(strHold) - 1)\n       End If\n       Print #intFile, strHold\n   End If\n   rst.MoveNext\n   strHold = vbNullString\nLoop    \nClose intFile    \nrst.Close    \nSet rst = Nothing        \nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1146, "favorite_count": 0, "accepted_answer_id": 41472150, "answer_count": 1, "score": 3, "last_activity_date": 1483560302, "creation_date": 1483557147, "last_edit_date": 1495540426, "question_id": 41471556, "link": "https://stackoverflow.com/questions/41471556/dynamically-add-and-run-a-vba-code", "title": "Dynamically add and run a vba code", "body": "<p>The followings are my current steps</p>\n\n<ol>\n<li><p>Access file exports a CSV file by Macro (VBA code)</p></li>\n<li><p>The exported CSV file get modified by Macro (VBA code)</p></li>\n</ol>\n\n<p>Right now, I'm executing the macro on Access (step 1)-> under the exported file, add the code and run (step 2) </p>\n\n<p>I'd like to simplify the process.</p>\n\n<p>Is it possible to by doing step 1, the step 2 code get added to the csv file and run?</p>\n\n<p>Step 1 code </p>\n\n<pre><code>Dim dbs As DAO.Database\nDim rst As DAO.Recordset\nDim intFile As Integer\nDim strFilePath As String\nDim intCount As Integer\nDim strHold    \nstrFilePath = \"C:\\temp\\TEST.csv\"    \nSet dbs = CurrentDb    \nSet rst = dbs.OpenRecordset(\"Import\", dbOpenForwardOnly)    \nintFile = FreeFile\nOpen strFilePath For Output As #intFile    \nDo Until rst.EOF\n   For intCount = 0 To rst.Fields.Count - 1\n   strHold = strHold &amp; rst(intCount).Value &amp; \"|\"\n   Next\n   If Right(strHold, 1) = \"|\" Then\n      strHold = Left(strHold, Len(strHold) - 1)\n   End If\n   Print #intFile, strHold\n   rst.MoveNext\n   strHold = vbNullString\nLoop    \nClose intFile    \nrst.Close    \nSet rst = Nothing        \nEnd Function\n</code></pre>\n\n<p>Step 2 code </p>\n\n<pre><code>Sub deleterows()\nlastrow = Cells(Rows.Count, 4).End(xlUp).Row\nFor i = lastrow To 1 Step -1\n    If Cells(i, 4).Value &lt; Date Then Rows(i).EntireRow.Delete\nNext i\nEnd Sub\n</code></pre>\n\n<p><em>note</em> I prefer not to use windows scheduler to run Macro at a certain time. </p>\n\n<p>My good reference has been so far <a href=\"https://stackoverflow.com/questions/20450440/is-it-possible-to-automatically-input-vba-code-when-a-new-sheet-is-generated\">Is it possible to automatically input VBA code when a new sheet is generated?</a> &amp; <a href=\"https://stackoverflow.com/questions/8635231/dynamically-insert-macro-into-a-new-excel-workbook\">Dynamically insert macro into a new excel workbook</a> &amp; <a href=\"https://support.microsoft.com/en-us/kb/219905\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/kb/219905</a></p>\n\n<p>I will try my best to be responsive! Please leave a comment for clarification. Thank you! </p>\n"}, {"tags": ["vba", "web"], "comments": [{"owner": {"reputation": 2810, "user_id": 3594657, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Otook.png?s=128&g=1", "display_name": "Sethmr", "link": "https://stackoverflow.com/users/3594657/sethmr"}, "edited": false, "score": 1, "creation_date": 1483557036, "post_id": 41471377, "comment_id": 70148738, "body": "Always have a clear question that shows you have done research. <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask a Question</a>"}, {"owner": {"reputation": 1, "user_id": 3460810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1227d6f6a868fc62bb59475e6740f682?s=128&d=identicon&r=PG&f=1", "display_name": "twoice", "link": "https://stackoverflow.com/users/3460810/twoice"}, "reply_to_user": {"reputation": 2810, "user_id": 3594657, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Otook.png?s=128&g=1", "display_name": "Sethmr", "link": "https://stackoverflow.com/users/3594657/sethmr"}, "edited": false, "score": 0, "creation_date": 1483602966, "post_id": 41471377, "comment_id": 70164918, "body": "Sorry i&#39;m first ask question,and I will learn more about ask question"}], "answers": [{"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1483570990, "post_id": 41474601, "comment_id": 70155355, "body": "Actually, re-reading your question, it looks like you want Facebook login which I cannot do because Facebook is banned on our system."}, {"owner": {"reputation": 1, "user_id": 3460810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1227d6f6a868fc62bb59475e6740f682?s=128&d=identicon&r=PG&f=1", "display_name": "twoice", "link": "https://stackoverflow.com/users/3460810/twoice"}, "edited": false, "score": 0, "creation_date": 1483599401, "post_id": 41474601, "comment_id": 70163280, "body": "is my fault, I already fix my cod,my problem is I want to send then message(like photo),and Now U can try the code will login and show then send form,but I don&#39;t know how to send it"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1483570447, "creation_date": 1483570447, "answer_id": 41474601, "question_id": 41471377, "link": "https://stackoverflow.com/questions/41471377/use-vba-ie-automation-to-send-message-from-pinkoi-com/41474601#41474601", "title": "Use VBA IE Automation to send message from pinkoi.com", "body": "<p>Sorry we downvoted you, try this.   If we click on the anchor you specified but I needed to use Unicode character logic.  The rest is just navigating the DOM.  I have put default username and password of \"hello\" and \"world\".</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub test()\n    'use ie open https://www.pinkoi.com/\n    'Please use FB login then web\n\n    '* Might want to consider using the Tools References to give yourself Intellisense\n    '* Tools-&gt;References Microsoft Internet Controls\n    '* Tools-&gt;References Microsoft HTML Object Library\n\n    Dim IE As Object 'SHDocVw.InternetExplorer\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.Navigate \"https://www.pinkoi.com/user/testpkko\"\n    Do While IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Loop\n\n\n    Dim anchorTags As Object 'MSHTML.IHTMLElementCollection\n    Set anchorTags = IE.document.GetElementsByTagName(\"A\")\n\n    Dim oAnchorLoop As Object 'MSHTML.IHTMLAnchorElement\n    For Each oAnchorLoop In anchorTags\n        Dim anchorText As String\n        anchorText = oAnchorLoop.Text\n        If anchorText = ChrW(20659) &amp; ChrW(36865) &amp; ChrW(35338) &amp; ChrW(24687) Then\n            Dim oAnchorLogon As Object 'MSHTML.IHTMLAnchorElement2\n            Set oAnchorLogon = oAnchorLoop\n\n            oAnchorLogon.Click\n            Exit For\n\n            'oAnchorLoop.Click 'here can show the form,but i can put message and select file from it\n        End If\n    Next\n\n    Do While IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Loop\n    '* so now logon form should be visible\n\n    On Error Resume Next\n    Dim oUserNameInput As Object 'MSHTML.IHTMLInputElement\n    Set oUserNameInput = IE.document.getElementById(\"n-login-id\")\n\n    Do While IE.Busy Or IE.readyState &lt;&gt; 4 Or oUserNameInput Is Nothing\n        DoEvents\n        Set oUserNameInput = IE.document.getElementById(\"n-login-id\")\n    Loop\n\n    oUserNameInput.Value = \"hello\"\n\n    Dim oUserPassword As Object 'MSHTML.IHTMLInputElement\n    Set oUserPassword = IE.document.getElementById(\"n-login-password\")\n\n    oUserPassword.Value = \"world\"\n\n\n    Dim oListElement As Object 'MSHTML.HTMLLIElement\n    Set oListElement = oUserNameInput.parentElement\n\n    Dim oUnorderedList As Object 'MSHTML.IHTMLUListElement\n    Set oUnorderedList = oListElement.parentElement\n\n    Dim oForm As Object 'MSHTML.IHTMLFormElement\n    Set oForm = oUnorderedList.parentElement\n\n    Dim oSubmitInputElememt As Object 'MSHTML.HTMLInputElement\n    Set oSubmitInputElememt = Nothing\n\n    Dim lFormChildrenLoop As Long\n    For lFormChildrenLoop = 1 To oForm.all.Length\n\n        If oForm.elements.Item(lFormChildrenLoop).Type = \"submit\" Then\n            Set oSubmitInputElememt = oForm.elements.Item(lFormChildrenLoop)\n            Exit For\n\n        End If\n\n    Next lFormChildrenLoop\n\n    If Not oSubmitInputElememt Is Nothing Then\n        Stop '* get ready .....\n        oSubmitInputElememt.Click\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3460810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1227d6f6a868fc62bb59475e6740f682?s=128&d=identicon&r=PG&f=1", "display_name": "twoice", "link": "https://stackoverflow.com/users/3460810/twoice"}, "is_accepted": false, "score": 0, "last_activity_date": 1483692028, "creation_date": 1483692028, "answer_id": 41501889, "question_id": 41471377, "link": "https://stackoverflow.com/questions/41471377/use-vba-ie-automation-to-send-message-from-pinkoi-com/41501889#41501889", "title": "Use VBA IE Automation to send message from pinkoi.com", "body": "<p>I alreay know how to input subject and body and send the file</p>\n\n<pre><code>ie.document.all(\"title\").Value = \"subject\"\nie.document.all(\"description\").Value = \"Body\"\nFor Each e In ie.document.GetElementsByTagName(\"INPUT\")\n    a = e.Type\n    If CStr(a) = \"submit\" Then e.Click\nNext\n</code></pre>\n\n<p>But after click select file , it will no response and program will stop\ndid anybody can use vba to select file?</p>\n\n<pre><code>ie.document.all(\"file\").Click\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3460810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1227d6f6a868fc62bb59475e6740f682?s=128&d=identicon&r=PG&f=1", "display_name": "twoice", "link": "https://stackoverflow.com/users/3460810/twoice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1483692028, "creation_date": 1483556487, "last_edit_date": 1483605150, "question_id": 41471377, "link": "https://stackoverflow.com/questions/41471377/use-vba-ie-automation-to-send-message-from-pinkoi-com", "title": "Use VBA IE Automation to send message from pinkoi.com", "body": "<p>Forgive my English.  Using VBA Automation of Internet Explorer, I want to send message from pinkoi.com.</p>\n\n<p>Now I can show the send message form,But I don't know how to input the subject and body and select file and send it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XJrb9.jpg\" rel=\"nofollow noreferrer\">the send form photo</a></p>\n\n<pre><code>Sub test()\nDim ie As Object 'SHDocVw.InternetExplorer\nSet ie = CreateObject(\"InternetExplorer.Application\")\nCall login(ie) 'just for login\nCall show_the_form(ie) 'My problem in here\nEnd Sub\nSub login(ie)\nie.Visible = True\nie.Navigate \"https://www.pinkoi.com/user/testpkko\"\nDo While ie.Busy Or ie.readyState &lt;&gt; 4: DoEvents: Loop\n\n\nDim anchorTags As Object 'MSHTML.IHTMLElementCollection\nSet anchorTags = ie.document.GetElementsByTagName(\"A\")\n\nDim oAnchorLoop As Object 'MSHTML.IHTMLAnchorElement\nFor Each oAnchorLoop In anchorTags\n    Dim anchorText As String\n    anchorText = oAnchorLoop.Text\n    If anchorText = ChrW(20659) &amp; ChrW(36865) &amp; ChrW(35338) &amp; ChrW(24687) Then\n        Dim oAnchorLogon As Object 'MSHTML.IHTMLAnchorElement2\n        Set oAnchorLogon = oAnchorLoop\n        oAnchorLogon.Click\n        Exit For\n    End If\nNext\n\nDo While ie.Busy Or ie.readyState &lt;&gt; 4: DoEvents: Loop\n'* so now logon form should be visible\n\nOn Error Resume Next\nDim oUserNameInput As Object 'MSHTML.IHTMLInputElement\nSet oUserNameInput = ie.document.getElementById(\"n-login-id\")\nnowtime = Timer\nDo While ie.Busy Or ie.readyState &lt;&gt; 4 Or oUserNameInput Is Nothing\n    DoEvents\n    If Timer - nowtime &gt; 1 Then Exit Do 'Already logoin\n    Set oUserNameInput = ie.document.getElementById(\"n-login-id\")\nLoop\n\noUserNameInput.Value = \"testpkko\"\n\nDim oUserPassword As Object 'MSHTML.IHTMLInputElement\nSet oUserPassword = ie.document.getElementById(\"n-login-password\")\n\noUserPassword.Value = \"abc123\"\n\n\nDim oListElement As Object 'MSHTML.HTMLLIElement\nSet oListElement = oUserNameInput.parentElement\n\nDim oUnorderedList As Object 'MSHTML.IHTMLUListElement\nSet oUnorderedList = oListElement.parentElement\n\nDim oForm As Object 'MSHTML.IHTMLFormElement\nSet oForm = oUnorderedList.parentElement\n\nDim oSubmitInputElememt As Object 'MSHTML.HTMLInputElement\nSet oSubmitInputElememt = Nothing\n\nDim lFormChildrenLoop As Long\nFor lFormChildrenLoop = 1 To oForm.all.Length\n\nIf oForm.elements.Item(lFormChildrenLoop).Type = \"submit\" Then\n    Set oSubmitInputElememt = oForm.elements.Item(lFormChildrenLoop)\n    Exit For\n\nEnd If\n\nNext lFormChildrenLoop\nIf Not oSubmitInputElememt Is Nothing Then\n    'Stop '* get ready .....\n    oSubmitInputElememt.Click\n    Do While ie.Busy Or ie.readyState &lt;&gt; 4: DoEvents: Loop\nEnd If\nEnd Sub\nSub show_the_form(ie)\nApplication.Wait Now + TimeValue(\"00:00:03\")\n\nie.Navigate \"https://en.pinkoi.com/user/testpkko2\" 'After login we can trip to other people website\nDo While ie.Busy Or ie.readyState &lt;&gt; 4: DoEvents: Loop\nWith ie.document\nOn Error Resume Next\nFor Each E In .GetElementsByTagName(\"A\")\n    a = E.Text\n    If CStr(a) = \"Message\" Then\n        E.Click 'After Click I want to send a message\n        'how can I input Subject and body and select file to upload?\n        'And I want to learn how to do this , Very thanks.\n    End If\nNext\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483556043, "post_id": 41471199, "comment_id": 70148167, "body": "<code>Empty</code> means there is nothing in the cell.  A null string though would be generated if the cell contained either a null string, or a formula that returned a null string."}, {"owner": {"reputation": 337, "user_id": 7157732, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b6e5e4d7e6e92b0747f19a7bd1062ad1?s=128&d=identicon&r=PG&f=1", "display_name": "user7157732", "link": "https://stackoverflow.com/users/7157732/user7157732"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483557225, "post_id": 41471199, "comment_id": 70148839, "body": "Thanks! @YowE3k But Is there a way to convert those string type to Empty type? The column has 8000 rows. It isn&#39;t feasible to go through each row. What may I add in the code such that string is assigned as empty?"}, {"owner": {"reputation": 337, "user_id": 7157732, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b6e5e4d7e6e92b0747f19a7bd1062ad1?s=128&d=identicon&r=PG&f=1", "display_name": "user7157732", "link": "https://stackoverflow.com/users/7157732/user7157732"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483557248, "post_id": 41471199, "comment_id": 70148851, "body": "@YowE3K : please see above! thnx"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483557862, "post_id": 41471199, "comment_id": 70149189, "body": "I find it strange that <code>h_current</code> is a <code>Variant&#47;String</code> at the line you say it crashes at - it should be a <code>Variant&#47;Null</code> if it gets to that point."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1483558378, "post_id": 41471199, "comment_id": 70149464, "body": "To answer your specific question, just say <code>If h_current = &quot;&quot; Then h_current = Empty</code> but, as I mention in my previous comment, that does not seem to be the issue you have - both <code>Empty</code> and <code>&quot;&quot;</code> would be going through the <code>True</code> leg of your <code>If</code>."}], "owner": {"reputation": 337, "user_id": 7157732, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b6e5e4d7e6e92b0747f19a7bd1062ad1?s=128&d=identicon&r=PG&f=1", "display_name": "user7157732", "link": "https://stackoverflow.com/users/7157732/user7157732"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483555894, "creation_date": 1483555894, "question_id": 41471199, "link": "https://stackoverflow.com/questions/41471199/type-mismatch-excel-vba", "title": "Type Mismatch - Excel VBA", "body": "<p>I have a column of Integers(<code>h_current</code>) with some values and some are blank.\nWhen there are no values, excel VBA sometimes labels  the type  as <code>Variant/EMPTY</code> and sometimes as <code>Variant/String</code>. \nWhat is the reason behind this? </p>\n\n<p>When it is <code>EMPTY</code> type, I can use it for addition with any integer(for ex: <code>hinitial</code>)  but when it is <code>STRING</code> type, of course the code fails! </p>\n\n<pre><code>t_step=0\nDim hinitial As Integer\nDim h_current As Variant\nhinitial = Worksheets(\"LatLen\").Cells(2 + t_step, 9)\n\nDo while(something something)\nh_current = Worksheets(\"LatLen\").Cells(3 + t_step, 9)\n  If (Not IsNull(h_current)) Then\n   Worksheets(\"LatLen\").Cells(3 + t_step, 11).Value = h_current + hinitial\n  Else\n   Worksheets(\"LatLen\").Cells(3 + t_step, 11).Value = h_current\n   hinitial = h_current  'FAILS HERE when h_current is VARIANT/STRING\n  End If\n t_step = t_step + 1\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 5116980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2628b2188af424a54d96c968e49550b?s=128&d=identicon&r=PG&f=1", "display_name": "andresej21", "link": "https://stackoverflow.com/users/5116980/andresej21"}, "edited": false, "score": 0, "creation_date": 1483557922, "post_id": 41471195, "comment_id": 70149214, "body": "I hadnt considered using <code>MAX</code>, though I think in my case I&#39;d need to use <code>MIN</code> since the days would skew if it skipped over the next, immediate status date. But maybe something like this should work:  SCOPEDAYS:     =IF(IF(OR([@STALLED]&lt;&gt;&quot;&quot;,[@CANCELED]&lt;&gt;&quot;&quot;),&quot;&quot;,IF([@BUILDDATE]&zwnj;&#8203;=&quot;&quot;,NETWORKDAYS([@SC&zwnj;&#8203;OPEDATE],MIN([@BUILD&zwnj;&#8203;DATE]:[@GOLIVEDATE],&zwnj;&#8203;(NETWORKDAYS([@STATU&zwnj;&#8203;SADATE],[@SCOPEATE])&zwnj;&#8203;))))&lt;0,&quot;&quot;,(IF(OR([@S&zwnj;&#8203;TALLED]&lt;&gt;&quot;&quot;,[@CANCEL&zwnj;&#8203;ED]&lt;&gt;&quot;&quot;),&quot;&quot;,IF([@INT&zwnj;&#8203;AKEDATE]=&quot;&quot;,&quot;&quot;,F([@B&zwnj;&#8203;UILDDATE]=&quot;&quot;,NETWORK&zwnj;&#8203;DAYS([@SCOPEDATE],MI&zwnj;&#8203;N([@BUILDDATE]:[@GOL&zwnj;&#8203;IVEDATE])))))))"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5116980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2628b2188af424a54d96c968e49550b?s=128&d=identicon&r=PG&f=1", "display_name": "andresej21", "link": "https://stackoverflow.com/users/5116980/andresej21"}, "is_accepted": false, "score": 0, "last_activity_date": 1483616774, "creation_date": 1483616774, "answer_id": 41484273, "question_id": 41471195, "link": "https://stackoverflow.com/questions/41471195/excel-forumla-vba-to-skip-blank-columns-for-calculation/41484273#41484273", "title": "Excel Forumla/VBA to skip blank columns for calculation", "body": "<p>So I figured it out using <code>MIN</code> and by adjusting the <code>IF</code> formulas a bit. Whoever it was that posted about <code>MAX</code> earlier, really helped me out getting me down this path. Kudos to you sir/madam.</p>\n\n<p>I had to add the check to see if SCOPEDATE=BUILDDATE because without that it was returning 1 if the dates matched, with was adding one more day when compared to running the networkdays from INTAKEDATE to GOLIVEDATE.</p>\n\n<pre><code>=IF(OR([@STALLED]&lt;&gt;\"\",[@CANCELED]&lt;&gt;\"\"),\"\",\n     IF([@SCOPEDATE]=\"\",\"\",\n     IF([@SCOPEDATE]=[@BUILDDATE],0,\n     IF(NETWORKDAYS([@SCOPEDATE],(MIN([@BUILDDATE],[@TESTDATE],[@GOLIVEDATE])))&lt;0,NETWORKDAYS([@SCOPEDATE],TODAY()),NETWORKDAYS([@SCOPEDATE],(MIN([@BUILDDATE],[@TESTDATE],[@GOLIVEDATE])))))))\n</code></pre>\n\n<p>I hope this is helpful for someone else.</p>\n"}], "owner": {"reputation": 1, "user_id": 5116980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2628b2188af424a54d96c968e49550b?s=128&d=identicon&r=PG&f=1", "display_name": "andresej21", "link": "https://stackoverflow.com/users/5116980/andresej21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483616774, "creation_date": 1483555874, "question_id": 41471195, "link": "https://stackoverflow.com/questions/41471195/excel-forumla-vba-to-skip-blank-columns-for-calculation", "title": "Excel Forumla/VBA to skip blank columns for calculation", "body": "<p>I have a particular data set that consists of information for projects our company works on. Each project can go through five different statuses and we have a column that records each date the project is put into that particular status. </p>\n\n<p>Now for the Excel part. We are trying to calculate the days in each status and find the total project time. The total is easy to do, because I can use network days between the project submitted date and the project go live date. The statuses, however, are giving me issues because sometimes a project will skip a status, leaving the date field empty. So what happens is a project goes from status B to status D, the formula for days in status \"B\" look for a date in column \"C\" to use as the second date in a NETWORKDAYS formula. When it is empty, the IF argument tells the formula to use TODAY() as the second date. What I need it to do is  the search the columns to the right (within the given range of A:E for that row) and use that date if it exists. If not, then it can default to TODAY() because this would be an \"active\" project that has not moved on.</p>\n\n<pre><code>=IF(IF(OR([@STALLED]&lt;&gt;\"\",[@CANCELED]&lt;&gt;\"\"),\"\",IF([@INTAKEDATE]=\"\",\"\",IF([@SCOPEATE]=\"\",NETWORKDAYS([@INTAKEDATE],TODAY()),(NETWORKDAYS([@STATUSADATE],[@SCOPEATE])))))&lt;0,\"\",(IF(OR([@STALLED]&lt;&gt;\"\",[@CANCELED]&lt;&gt;\"\"),\"\",IF([@INTAKEDATE]=\"\",\"\",IF([@SCOPEATE]=\"\",NETWORKDAYS([@INTAKEDATE],TODAY()),(NETWORKDAYS([@STATUSADATE],[@SCOPEATE])))))))\n</code></pre>\n\n<p>This is done for each of the statuses so the table looks something like this:</p>\n\n<p>PROJECTID   PROJECTNAME    INTAKEDATE  SCOPEATE   BUILDDATE   TESTDATE  GOLIVEDATE  INTAKEDAYS   SCOPEDAYS   BUILDDAYS   TESTDAYS   </p>\n\n<p>If there is any Macro or better formula someone could help me figure out, I'd appreciate it. There is also another field that gives the current status or if the project is considered live if that helps at all. I have excel-block right now and cant think of anything that makes sense for this.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1483555945, "post_id": 41470891, "comment_id": 70148104, "body": "You should declare your local variables and your functions&#39; return types and parameters. Without <code>Option Explicit</code> specified at the top of a module, VBA will happily compile a typo, which makes problems much harder to debug than necessary. Now, seems you&#39;re fetching the <code>DisplayName</code> property, which can reasonably be assumed to be &quot;Smith, Dave&quot;. Have you tried enumerating the properties and seeing if there wasn&#39;t another one that would be more appropriate?"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1483555200, "post_id": 41470960, "comment_id": 70147738, "body": "I think OP is looking to get the user name, based on the value in a cell. This may or may not necessarily be the active user, unless I misunderstand the question."}], "tags": [], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "is_accepted": false, "score": 0, "last_activity_date": 1483555019, "creation_date": 1483555019, "answer_id": 41470960, "question_id": 41470891, "link": "https://stackoverflow.com/questions/41470891/vba-get-windows-first-and-last-name-of-user/41470960#41470960", "title": "VBA get windows first and last name of user", "body": "<p>I used this code to get the username of the user. </p>\n\n<pre><code>Option Explicit\nPublic strUser As String\nPrivate Sub Workbook_Open()\nDim strUser\n\n    strUser = CreateObject(\"WScript.Network\").UserName\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1483556146, "post_id": 41471211, "comment_id": 70148208, "body": "<i>But this method will make twice the use of resources</i> - OP&#39;s function takes a <i>comma-separated list of properties</i>... and returns the values separated by a <code>vbCrLf</code>. You could just specify &quot;givenName,sn&quot; for the last parameter and split the returned string on <code>vbCrLf</code>, then join with a dot and add the <code>@inbox.com</code>, making one single call to <code>Get_LDAP_User_Properties</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1483556838, "post_id": 41471211, "comment_id": 70148609, "body": "Not quite - I don&#39;t think <code>Get_LDAP_User_Properties</code> needs any modifications done (well other than declaring its locals and its return type and its parameters&#39; types, and the params should be passed <code>ByVal</code>).. in fact doing that could be harmful if the function is used elsewhere for other purposes. What I meant was <code>result = Join(Split(Get_LDAP_User_Properties(&quot;user&quot;, &quot;samAccountName&quot;, strUser, &quot;givenName,sn&quot;), vbCrLf), &quot;.&quot;) &amp; &quot;@inbox.com&quot;</code>"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1483556399, "last_edit_date": 1483556399, "creation_date": 1483555939, "answer_id": 41471211, "question_id": 41470891, "link": "https://stackoverflow.com/questions/41470891/vba-get-windows-first-and-last-name-of-user/41471211#41471211", "title": "VBA get windows first and last name of user", "body": "<p>You can do it in two ways. 1. Split the displayName on \",\" and re-arrange. </p>\n\n<pre><code> struserdn = Get_LDAP_User_Properties(\"user\", \"samAccountName\", strUser, \"displayName\")\n    struserdn = Split(struserdn, \",\")(1) &amp; Space(1) &amp; Split(struserdn, \",\")(0)\n</code></pre>\n\n<p>2.You can get First Name and Last Name in seperate calls using <code>GivenName</code> and <code>sn</code> params.</p>\n\n<p><code>strFirstName = Get_LDAP_User_Properties(\"user\", \"samAccountName\", strUser, \"givenName\")\n    strLastName = Get_LDAP_User_Properties(\"user\", \"samAccountName\", strUser, \"sn\")</code></p>\n\n<p>But thi smethod will make twice the use of resources.</p>\n\n<p><strong>Edit :</strong> </p>\n\n<p><em>As per Matt's comment.</em></p>\n\n<p>Change this line </p>\n\n<pre><code>strReturnVal = strReturnVal &amp; vbcrlf &amp; adoRecordset.Fields(intCount).Value\n</code></pre>\n\n<p>To</p>\n\n<pre><code>strReturnVal = strReturnVal &amp; \".\" &amp; adoRecordset.Fields(intCount).Value\n</code></pre>\n\n<p>and then this will give you the full name in just one call.</p>\n\n<pre><code> strFullName = Get_LDAP_User_Properties(\"user\", \"samAccountName\", strUser, \"givenName,sn\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1483559123, "post_id": 41471928, "comment_id": 70149819, "body": "Huh, looks like there&#39;s a bug in the &quot;undeclared variable&quot; inspection, it should be firing much more results than that."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1483558937, "last_edit_date": 1495542810, "creation_date": 1483558633, "answer_id": 41471928, "question_id": 41470891, "link": "https://stackoverflow.com/questions/41470891/vba-get-windows-first-and-last-name-of-user/41471928#41471928", "title": "VBA get windows first and last name of user", "body": "<blockquote>\n  <p><em>Please can someone show me where i am going wrong?</em></p>\n</blockquote>\n\n<p>You're asking for the <code>displayName</code>, and that's what you're getting (\"Doe, John\"). What you want is <em>not</em> the \"display name\", but the user's first and last name.</p>\n\n<p>Let's look at the signature for the function you've got here:</p>\n\n<pre><code>Function Get_LDAP_User_Properties(strObjectType, strSearchField, strObjectToGet, strCommaDelimProps)\n</code></pre>\n\n<p>That last parameter is named <code>strCommaDelimProps</code>, short for \"string, comma-delimited property names\".</p>\n\n<p>If you <em>look</em> at what it's doing with the <code>strCommaDelimProps</code> you're giving it, you'll notice it's concatenated into the <code>strQuery</code> that's sent to the LDAP server, and then it's also turned into an array named <code>arrProperties</code> (gosh dat Hungarian naming):</p>\n\n<pre><code>arrProperties = Split(strCommaDelimProps, \",\")\n</code></pre>\n\n<p>Then it loops through the query results and...</p>\n\n<pre><code>strReturnVal = strReturnVal &amp; vbCrLf &amp; adoRecordset.Fields(intCount).Value\n</code></pre>\n\n<p>That's right, it appends each field value to the <code>strReturnVal</code> string, with each result separated by a <code>vbCrLf</code>.</p>\n\n<p>So if you were to give the function two properties separated by commas, it would return you a string with the two values, separated by <code>vbCrLf</code> characters. That would look something like this:</p>\n\n<pre><code>\"John[CRLF]\nDoe\"\n</code></pre>\n\n<p>So you take that string, <code>Split</code> it on <code>vbCrLf</code> to make an array, and <code>Join</code> it using a dot delimiter (<code>.</code>):</p>\n\n<pre><code>strParts = Get_LDAP_User_Properties(\"user\", \"samAccountName\", strUser, \"givenName,sn\")\narrParts = Split(strParts, vbCrLf) 'splits the string into an array\nresult = Join(arrParts, \".\") 'joins array elements back into a string\n</code></pre>\n\n<p>The two properties are, per <a href=\"https://stackoverflow.com/a/41471211/1188513\">cyboashu's answer</a>, <code>\"givenName\"</code> and <code>\"sn\"</code>, so you give the function <code>\"givenName,sn\"</code> for the last parameter.</p>\n\n<p>At that point the <code>result</code> string looks something like <code>John.Doe</code>; you might want to make that lowercase before you concatenate the <code>@inbox.com</code> part:</p>\n\n<pre><code>result = LCase$(result) &amp; \"@inbox.com\"\nMsgBox result\n</code></pre>\n\n<hr>\n\n<p>As for <em>what am I doing wrong?</em>, the latest <a href=\"http://rubberduckvba.com/Inspections/List\" rel=\"nofollow noreferrer\">Rubberduck</a> (my little pet project) can help you pinpoint a few things:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Warning: 'Vbnullstring' preferred to empty string literals - (Book2) VBAProject.Module1, line 69\nWarning: 'Vbnullstring' preferred to empty string literals - (Book2) VBAProject.Module1, line 73\nWarning: Parameter 'strObjectType' is implicitly Variant - (Book2) VBAProject.Module1, line 11\nWarning: Parameter 'strSearchField' is implicitly Variant - (Book2) VBAProject.Module1, line 11\nWarning: Parameter 'strObjectToGet' is implicitly Variant - (Book2) VBAProject.Module1, line 11\nWarning: Parameter 'strCommaDelimProps' is implicitly Variant - (Book2) VBAProject.Module1, line 11\nWarning: Member 'Range' implicitly references ActiveSheet - (Book2) VBAProject.Module1, line 2\nHint: Member 'Test' is implicitly public - (Book2) VBAProject.Module1, line 1\nHint: Member 'Get_LDAP_User_Properties' is implicitly public - (Book2) VBAProject.Module1, line 11\nHint: Parameter 'strObjectType' is implicitly passed by reference - (Book2) VBAProject.Module1, line 11\nHint: Parameter 'strSearchField' is implicitly passed by reference - (Book2) VBAProject.Module1, line 11\nHint: Parameter 'strObjectToGet' is implicitly passed by reference - (Book2) VBAProject.Module1, line 11\nHint: Parameter 'strCommaDelimProps' is implicitly passed by reference - (Book2) VBAProject.Module1, line 11\nHint: Return type of member 'Get_LDAP_User_Properties' is implicitly 'Variant' - (Book2) VBAProject.Module1, line 11\nError: Option Explicit is not specified in 'Module1' - (Book2) VBAProject.Module1, line 1\nError: Local variable 'strUser' is not declared - (Book2) VBAProject.Module1, line 2\nError: Local variable 'struserdn' is not declared - (Book2) VBAProject.Module1, line 3\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 7231013, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/c660b465c5501da811e99c6eaf2e2dac?s=128&d=identicon&r=PG&f=1", "display_name": "Princess.Bell", "link": "https://stackoverflow.com/users/7231013/princess-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2916, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1483558937, "creation_date": 1483554725, "question_id": 41470891, "link": "https://stackoverflow.com/questions/41470891/vba-get-windows-first-and-last-name-of-user", "title": "VBA get windows first and last name of user", "body": "<p>I am using the following code to get the first and last name of a windows user.</p>\n\n<p>The username is in cell A2 like:</p>\n\n<p>SmithD</p>\n\n<p>The code works but it puts the user's last name seperated by a comma and then their first name. I.e:</p>\n\n<p>Smith, Dave</p>\n\n<p>I want to change this to look like:</p>\n\n<p>Dave.Smith and then add @inbox.com</p>\n\n<p>So:</p>\n\n<p>Dave.Smith@inbox.com</p>\n\n<pre><code>Sub Test()\n    strUser = Range(\"A2\").Value\n    struserdn = Get_LDAP_User_Properties(\"user\", \"samAccountName\", strUser, \"displayName\")\n    If Len(struserdn) &lt;&gt; 0 Then\n        MsgBox struserdn\n    Else\n        MsgBox \"No record of \" &amp; strUser\n    End If\nEnd Sub\n\nFunction Get_LDAP_User_Properties(strObjectType, strSearchField, strObjectToGet, strCommaDelimProps)\n\n' This is a custom function that connects to the Active Directory, and returns the specific\n' Active Directory attribute value, of a specific Object.\n' strObjectType: usually \"User\" or \"Computer\"\n' strSearchField: the field by which to seach the AD by. This acts like an SQL Query's WHERE clause.\n'             It filters the results by the value of strObjectToGet\n' strObjectToGet: the value by which the results are filtered by, according the strSearchField.\n'             For example, if you are searching based on the user account name, strSearchField\n'             would be \"samAccountName\", and strObjectToGet would be that speicific account name,\n'             such as \"jsmith\".  This equates to \"WHERE 'samAccountName' = 'jsmith'\"\n' strCommaDelimProps: the field from the object to actually return.  For example, if you wanted\n'             the home folder path, as defined by the AD, for a specific user, this would be\n'             \"homeDirectory\".  If you want to return the ADsPath so that you can bind to that\n'             user and get your own parameters from them, then use \"ADsPath\" as a return string,\n'             then bind to the user: Set objUser = GetObject(\"LDAP://\" &amp; strReturnADsPath)\n\n' Now we're checking if the user account passed may have a domain already specified,\n' in which case we connect to that domain in AD, instead of the default one.\n    If InStr(strObjectToGet, \"\\\") &gt; 0 Then\n        arrGroupBits = Split(strObjectToGet, \"\\\")\n        strDC = arrGroupBits(0)\n        strDNSDomain = strDC &amp; \"/\" &amp; \"DC=\" &amp; Replace(Mid(strDC, InStr(strDC, \".\") + 1), \".\", \",DC=\")\n        strObjectToGet = arrGroupBits(1)\n    Else\n        ' Otherwise we just connect to the default domain\n        Set objRootDSE = GetObject(\"LDAP://RootDSE\")\n        strDNSDomain = objRootDSE.Get(\"defaultNamingContext\")\n    End If\n\n    strBase = \"&lt;LDAP://\" &amp; strDNSDomain &amp; \"&gt;\"\n    ' Setup ADO objects.\n    Set adoCommand = CreateObject(\"ADODB.Command\")\n    Set ADOConnection = CreateObject(\"ADODB.Connection\")\n    ADOConnection.Provider = \"ADsDSOObject\"\n    ADOConnection.Open \"Active Directory Provider\"\n    adoCommand.ActiveConnection = ADOConnection\n\n\n    ' Filter on user objects.\n    'strFilter = \"(&amp;(objectCategory=person)(objectClass=user))\"\n    strFilter = \"(&amp;(objectClass=\" &amp; strObjectType &amp; \")(\" &amp; strSearchField &amp; \"=\" &amp; strObjectToGet &amp; \"))\"\n\n    ' Comma delimited list of attribute values to retrieve.\n    strAttributes = strCommaDelimProps\n    arrProperties = Split(strCommaDelimProps, \",\")\n\n    ' Construct the LDAP syntax query.\n    strQuery = strBase &amp; \";\" &amp; strFilter &amp; \";\" &amp; strAttributes &amp; \";subtree\"\n    adoCommand.CommandText = strQuery\n    ' Define the maximum records to return\n    adoCommand.Properties(\"Page Size\") = 100\n    adoCommand.Properties(\"Timeout\") = 30\n    adoCommand.Properties(\"Cache Results\") = False\n\n    ' Run the query.\n    Set adoRecordset = adoCommand.Execute\n    ' Enumerate the resulting recordset.\n    strReturnVal = \"\"\n    Do Until adoRecordset.EOF\n        ' Retrieve values and display.\n        For intCount = LBound(arrProperties) To UBound(arrProperties)\n            If strReturnVal = \"\" Then\n                strReturnVal = adoRecordset.Fields(intCount).Value\n            Else\n                strReturnVal = strReturnVal &amp; vbCrLf &amp; adoRecordset.Fields(intCount).Value\n            End If\n        Next\n        ' Move to the next record in the recordset.\n        adoRecordset.MoveNext\n    Loop\n\n    ' Clean up.\n    adoRecordset.Close\n    ADOConnection.Close\n    Get_LDAP_User_Properties = strReturnVal\n\nEnd Function\n</code></pre>\n\n<p>Please can someone show me where i am going wrong?</p>\n"}, {"tags": ["excel", "bloomberg", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1483554806, "post_id": 41470851, "comment_id": 70147525, "body": "Add a reference to the Bloomberg API."}, {"owner": {"reputation": 71, "user_id": 7375650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70ad9918c333b02d7fdb1d86aada54e?s=128&d=identicon&r=PG&f=1", "display_name": "mattsurw", "link": "https://stackoverflow.com/users/7375650/mattsurw"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483555525, "post_id": 41470851, "comment_id": 70147886, "body": "As far as I know, I have a reference to the API. Where can I check that?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483555608, "post_id": 41470851, "comment_id": 70147920, "body": "Tools-&gt;References... from the menu."}, {"owner": {"reputation": 71, "user_id": 7375650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70ad9918c333b02d7fdb1d86aada54e?s=128&d=identicon&r=PG&f=1", "display_name": "mattsurw", "link": "https://stackoverflow.com/users/7375650/mattsurw"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483556293, "post_id": 41470851, "comment_id": 70148290, "body": "Thanks very much. That was it."}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1483613051, "post_id": 41470851, "comment_id": 70170737, "body": "@mattsurw You can answer your question in the answer section below so that future users can benefit from your experience."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 7375650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70ad9918c333b02d7fdb1d86aada54e?s=128&d=identicon&r=PG&f=1", "display_name": "mattsurw", "link": "https://stackoverflow.com/users/7375650/mattsurw"}, "is_accepted": true, "score": 0, "last_activity_date": 1483631611, "creation_date": 1483631611, "answer_id": 41489264, "question_id": 41470851, "link": "https://stackoverflow.com/questions/41470851/compile-error-thrown-when-calling-blpapicomlib2/41489264#41489264", "title": "Compile Error thrown when calling blpapicomLib2", "body": "<p>I was missing a reference to the Bloomberg API, which I was able to change under in the references menu (Tools->References). Smooth sailing after that.</p>\n"}], "owner": {"reputation": 71, "user_id": 7375650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70ad9918c333b02d7fdb1d86aada54e?s=128&d=identicon&r=PG&f=1", "display_name": "mattsurw", "link": "https://stackoverflow.com/users/7375650/mattsurw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1110, "favorite_count": 0, "accepted_answer_id": 41489264, "answer_count": 1, "score": 0, "last_activity_date": 1483631611, "creation_date": 1483554596, "last_edit_date": 1531164843, "question_id": 41470851, "link": "https://stackoverflow.com/questions/41470851/compile-error-thrown-when-calling-blpapicomlib2", "title": "Compile Error thrown when calling blpapicomLib2", "body": "<p>Here is the beginning of my class module:</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents session As blpapicomLib2.session\nPrivate cid As blpapicomLib2.CorrelationId\n\nDim subFields As Variant\nDim securitiesArray() As String\n</code></pre>\n\n<p>These five lines are <em>straight</em> from the Bloomberg API example files. If I open the example spreadsheet and run the sub in question, it's fine. If I copy the code into another VBA editor in a new workbook, I get the \"Compile Error: User-defined type not defined,\" with the second line highlighted. If I comment it out, same error is thrown except the first line is then highlighted. </p>\n\n<p>I'm very confused. Is there a reference outside of the code I'm forgetting to make?</p>\n"}, {"tags": ["excel", "vba", "if-statement", "macros"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1483554129, "post_id": 41470670, "comment_id": 70147143, "body": "<code>If IsEmpty(Range(&quot;g6&quot;)) = True Then Range(&quot;g6&quot;).Select</code> needs to be split into two lines after the <code>Then</code>"}], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": false, "score": 0, "last_activity_date": 1483554362, "creation_date": 1483554362, "answer_id": 41470790, "question_id": 41470670, "link": "https://stackoverflow.com/questions/41470670/excel-macro-if-else-issue/41470790#41470790", "title": "Excel Macro If Else issue", "body": "<p>Move Range(\"g6\").Select down to the next line (otherwise that line is a complete If statement). Also, remove the colon from the Else line.</p>\n\n<pre><code>Sub TotalR()\n   Dim Rng As Range\n   Dim c As Range\n\n   Sheets(\"Data\").Select\n   If IsEmpty(Range(\"g6\")) = True Then\n        Range(\"g6\").Select\n        ActiveCell.Formula = \"=sum(g5)\"\n    Else\n        Set Rng = Range(\"g5:g\" &amp; Range(\"g5\").End(xlDown).Row)\n        Set c = Range(\"g5\").End(xlDown).Offset(1, 0)\n        c.Formula = \"=SUM(\" &amp; Rng.Address(False, False) &amp; \")\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1483554374, "creation_date": 1483554374, "answer_id": 41470795, "question_id": 41470670, "link": "https://stackoverflow.com/questions/41470670/excel-macro-if-else-issue/41470795#41470795", "title": "Excel Macro If Else issue", "body": "<p>The error is caused exactly like @Scott Craner mentioned, you need to split to 2 lines: </p>\n\n<pre><code>If IsEmpty(Range(\"g6\")) = True Then \n    Range(\"g6\").Select\n    ActiveCell.Formula = \"=sum(g5)\"\n</code></pre>\n\n<p>However, it's better if you stay away from  <code>Select</code> and <code>ActiveCell</code> , and instead use referenced objects as <code>Worksheets</code> and <code>Range</code>s.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub TotalR()\n\nDim Rng As Range\nDim c As Range\n\nWith Sheets(\"Data\")    \n    If IsEmpty(.Range(\"G6\")) Then\n        .Range(\"G6\").Formula = \"=Sum(G5)\"\n    Else\n        Set Rng = .Range(\"G5:G\" &amp; .Range(\"G5\").End(xlDown).Row)\n        Set c = .Range(\"G5\").End(xlDown).Offset(1, 0)\n        c.Formula = \"=SUM(\" &amp; Rng.Address(False, False) &amp; \")\"\n    End If    \nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 2231688, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/f6f973090cc3f8c9a6f84359036a3d52?s=128&d=identicon&r=PG", "display_name": "user2231688", "link": "https://stackoverflow.com/users/2231688/user2231688"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1483554374, "creation_date": 1483553981, "last_edit_date": 1483554052, "question_id": 41470670, "link": "https://stackoverflow.com/questions/41470670/excel-macro-if-else-issue", "title": "Excel Macro If Else issue", "body": "<p>I am having issues getting my If else statment to work, as below.</p>\n\n<p>I want to sum everything from G5 down, but if G6 is blank (ie there is only one entry), then i just want to sum G5. So i have come up with the code below.</p>\n\n<p>However, i am getting an error saying Else without If. But, if i put If after the else, i get another syntax error. </p>\n\n<p>Clearly i am missing something, but cant figure out what is wrong.</p>\n\n<pre><code>Sub TotalR()\n\nSheets(\"Data\").Select\n\nDim Rng As Range\nDim c As Range\n\nIf IsEmpty(Range(\"g6\")) = True Then Range(\"g6\").Select\nActiveCell.Formula = \"=sum(g5)\"\nElse:\n    Set Rng = Range(\"g5:g\" &amp; Range(\"g5\").End(xlDown).Row)\n    Set c = Range(\"g5\").End(xlDown).Offset(1, 0)\n    c.Formula = \"=SUM(\" &amp; Rng.Address(False, False) &amp; \")\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1483553741, "post_id": 41470167, "comment_id": 70146936, "body": "add:  on error resume next"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1483595415, "post_id": 41470167, "comment_id": 70161701, "body": "@Keith  have you tried the code in my answer below ?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7375515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599d78486b9e9b26d62faebdc78677b8?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/7375515/keith"}, "edited": false, "score": 0, "creation_date": 1485226018, "post_id": 41471309, "comment_id": 70826414, "body": "Yes I use your example and it solved the problem.  It was just want I needed.  Thank you very much for your help!!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7375515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599d78486b9e9b26d62faebdc78677b8?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/7375515/keith"}, "edited": false, "score": 0, "creation_date": 1485226353, "post_id": 41471309, "comment_id": 70826483, "body": "@Keith  you&#39;re welcome, please mark as answer , by clicking the little <b>V</b> next to my answer"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1483556221, "creation_date": 1483556221, "answer_id": 41471309, "question_id": 41470167, "link": "https://stackoverflow.com/questions/41470167/excel-vb-code-with-input-box-to-select-a-range-when-nothing-is-selected-it-gene/41471309#41471309", "title": "Excel VB Code with Input Box to select a range, when nothing is selected it generates and error", "body": "<p>I've added 2 events to trap the possible errors:</p>\n\n<ol>\n<li>If the user hits cancel >> <code>On Error Resume Next</code> , and later check <code>If Err.Number &lt;&gt; 0 Then</code>.</li>\n<li>If the user didn't select any cell, use another parameter in the <code>Application.InputBox</code> of <code>Default:=Selection.Address</code>. So you compare if the <code>Selection.Address</code> after the <code>InputBox</code> is the same as the <code>Selection.Address</code> before the <code>InputBox</code>. If it is, then no new selection was made >> abort the operation.</li>\n</ol>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Copy_St5_50_Ramp_Click()\n\nDim sCell As Range\nDim CurrentSelectionRng As String\n\nCurrentSelectionRng = Selection.Address\n\nOn Error Resume Next\nSet sCell = Application.InputBox(prompt:=\"Select the Column of data below that is valid Ramp Data STARTING With 24 Minutes!!!\", Title:=\"Station 5\", Default:=Selection.Address, Type:=8)\n\n' trap a case when the user selectes \"Cancel\"\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox \"You chose cancel !\", vbCritical\n    Exit Sub\nEnd If\n\n' if the user didn't select anything (but the cell curser stayed on previous selection)\nIf sCell.Address = CurrentSelectionRng Then\n    MsgBox \"No cell was selected !\", vbCritical\n    Exit Sub\nEnd If\n\nIf sCell Is Nothing Then Exit Sub\n\nIf sCell.Cells.Count &lt; 2 Then Application.InputBox (\"You Did not Select Enough Cells\"), (\"ERROR\"), vbOK\n\nsCell.Copy\n\nWorksheets(\"50 Ramp Data\").Range(\"CJ13\").PasteSpecial xlPasteValues\n\n'Clear Clipboard (removes \"marching ants\" around your original data set)\nApplication.CutCopyMode = False\n\nWorksheets(\"50 Ramp Data\").Range(\"L4\").Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7375515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599d78486b9e9b26d62faebdc78677b8?s=128&d=identicon&r=PG&f=1", "display_name": "Keith", "link": "https://stackoverflow.com/users/7375515/keith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "accepted_answer_id": 41471309, "answer_count": 1, "score": 0, "last_activity_date": 1483556221, "creation_date": 1483552078, "last_edit_date": 1531164843, "question_id": 41470167, "link": "https://stackoverflow.com/questions/41470167/excel-vb-code-with-input-box-to-select-a-range-when-nothing-is-selected-it-gene", "title": "Excel VB Code with Input Box to select a range, when nothing is selected it generates and error", "body": "<p>Let me start with the fact that I am NOT a programmer.  I am self taught some VB with Excel and MS Access.  I know just enough to be dangerous.</p>\n\n<p>I have the following code to prompt the user to select a range.  The Input box has an OK and Cancel button.  If you do not select any cells and hit the OK or select Cancel it generates an errors.</p>\n\n<pre><code>Private Sub Copy_St5_50_Ramp_Click()\nDim sCell As Range\n\nSet sCell = Application.InputBox(\"Select the Column of data below that is valid Ramp Data STARTING With 24 Minutes!!!\", \"Station 5\", Type:=8)\n\nIf sCell Is Nothing Then Exit Sub\n\nIf sCell.Cells.Count &lt; 2 Then Application.InputBox (\"You Did not Select Enough Cells\"), (\"ERROR\"), vbOK\n\nsCell.Copy\n\nWorksheets(\"50 Ramp Data\").Range(\"CJ13\").PasteSpecial Paste:=xlPasteValues\n\n\n'Clear Clipboard (removes \"marching ants\" around your original data set)\n  Application.CutCopyMode = False\n\nWorksheets(\"50 Ramp Data\").Range(\"L4\").Select\nEnd Sub\n</code></pre>\n\n<p>I need it to not error but just close the input box and maybe prompt with a message box as to what went wrong </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1483551859, "post_id": 41470040, "comment_id": 70145965, "body": "Have you tried using <a href=\"https://support.office.com/en-gb/article/Automate-tasks-with-the-Macro-Recorder-974ef220-f716-4e01-b015-3ea70e64937b?ui=en-US&amp;rs=en-GB&amp;ad=GB&amp;fromAR=1\" rel=\"nofollow noreferrer\">Excel&#39;s Macro Recorder</a>.  Turn the recorder on, perform the action manually and then review the VBA Excel has written for you.  This technique is great when you know what you want, but not how to do it."}], "answers": [{"comments": [{"owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 0, "creation_date": 1483553542, "post_id": 41470102, "comment_id": 70146827, "body": "would it be passable to use the sheets code here <code>Set Master_Work_Order = Worksheets(&quot;YourMasterSheetsName&quot;)</code> instead?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 0, "creation_date": 1483554037, "post_id": 41470102, "comment_id": 70147097, "body": "you mean the <code>Sheet.Index</code> ? like <code>Worksheets(2)</code> ? the sheet in the 2nd position in the Workbook ?"}, {"owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 0, "creation_date": 1483554336, "post_id": 41470102, "comment_id": 70147246, "body": "Sorry meant to say, the sheets CodeName instead."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 0, "creation_date": 1483554562, "post_id": 41470102, "comment_id": 70147385, "body": "can you explain better , like what do you want to use ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 2, "creation_date": 1483555565, "post_id": 41470102, "comment_id": 70147903, "body": "@luke - yes, if the sheet&#39;s codename is already <code>Master_Work_Order</code>, then you don&#39;t need the <code>Set Master_Work_Order</code> statement, or the <code>Dim Master_Work_Order</code> statement.  They are implicitly done by Excel."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1483551849, "creation_date": 1483551849, "answer_id": 41470102, "question_id": 41470040, "link": "https://stackoverflow.com/questions/41470040/vba-store-current-sheet-name-to-use-on-new-sheet/41470102#41470102", "title": "VBA Store current sheet name to use on new sheet", "body": "<p>Try the code below:</p>\n\n<pre><code>Option Explicit\n\nSub Reset_Work_Order()\n\nDim ShtName As String\nDim Master_Work_Order As Worksheet\nApplication.DisplayAlerts = False\n\nSet Master_Work_Order = Worksheets(\"YourMasterSheetsName\")\n\n' keep name of ActiveSheet\nShtName = ActiveSheet.Name\nActiveSheet.Delete\n\nDim NewSht              As Worksheet\n\nMaster_Work_Order.Copy After:=ActiveSheet\n\nSet NewSht = ActiveSheet\n' set new copied sheet name to Previous ActiveSheet's name\nNewSht.Name = ShtName\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2905, "favorite_count": 0, "accepted_answer_id": 41470102, "answer_count": 1, "score": 0, "last_activity_date": 1484593901, "creation_date": 1483551561, "last_edit_date": 1484593901, "question_id": 41470040, "link": "https://stackoverflow.com/questions/41470040/vba-store-current-sheet-name-to-use-on-new-sheet", "title": "VBA Store current sheet name to use on new sheet", "body": "<p>I am wanting to have excel remember the active sheet name and then delete the active sheet and copy a different sheet that i use as a template and rename the new sheet with the stored name from the deleted sheet.</p>\n\n<p>This is the code im using i just need to have it rename the sheet with the stored sheet name</p>\n\n<pre><code>Sub Reset_Work_Order()\n\nApplication.DisplayAlerts = False\nActiveWindow.SelectedSheets.Delete\n\n\nDim NewSht              As Worksheet\n\nMaster_Work_Order.Copy After:=ActiveSheet\nSet NewSht = ActiveSheet\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483551914, "post_id": 41470034, "comment_id": 70145998, "body": "Replace <code>*numeric value*</code> with <code>Date</code>."}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483552353, "post_id": 41470034, "comment_id": 70146212, "body": "@Comintern Thanks for reply! How can i set it as the last date of the record??"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483552489, "post_id": 41470034, "comment_id": 70146274, "body": "Do you mean something by &quot;before today&#39;s date&quot; other than &quot;before today&#39;s date&quot;?  If so, what do you mean by &quot;today&#39;s date&quot;?"}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483552665, "post_id": 41470034, "comment_id": 70146371, "body": "let&#39;s say today&#39;s date is 1/3/2017, then I want all rows with before 1/3/2017 to be deleted e.g. 12/31/2016, 1/4/2016 :)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1483552730, "post_id": 41470034, "comment_id": 70146423, "body": "That&#39;s exactly what <code>If Cells(i, 4).Value &lt; Date Then Rows(i).EntireRow.Delete</code> <b><i>does</i></b>."}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483552744, "post_id": 41470034, "comment_id": 70146435, "body": "as I run this code, I want every row except 1/4/2017 to be deleted! :) Thanks for the comment!"}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483553011, "post_id": 41470034, "comment_id": 70146582, "body": "@Comintern Thanks for the comment! I think both you and cyboashu is correct! Sorry for my stupidity. I forgot to use updated excel file."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 0, "creation_date": 1483552301, "post_id": 41470118, "comment_id": 70146192, "body": "Hi, as a follow-up, when i executed the code, It deletes everything except the first row of the file."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 1, "creation_date": 1483552372, "post_id": 41470118, "comment_id": 70146225, "body": "looking at ur screenshot all dates are older than today, so it will delete the rows. Do you have anyy dates for or beyond today."}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 0, "creation_date": 1483552571, "post_id": 41470118, "comment_id": 70146309, "body": "nope. 1/3/2017 is the latest date! Also, A\tB\t\t1/4/2016\t\t\tC  is what i got for executing your code: which is the first row of the file."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 1, "creation_date": 1483552735, "post_id": 41470118, "comment_id": 70146429, "body": "1. First row will never be touched irrespective of date as your For Loop terminates at Row 2. |||| 2. Put down a date for 1/4/2017 (yes its 2017 now  :)) in any of the Rows and see if it gets deleted. Most likely it won&#39;t."}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 0, "creation_date": 1483553040, "post_id": 41470118, "comment_id": 70146599, "body": "Thanks for the comment! I forgot to use updated excel file. Sorry for my stupidity. Thank you again!"}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 0, "creation_date": 1483553082, "post_id": 41470118, "comment_id": 70146626, "body": "is there anyway that i can loop to delete the first row as well? @cyboashu sorry for the follow up.."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 0, "creation_date": 1483553168, "post_id": 41470118, "comment_id": 70146667, "body": "change this <code>lastrow To 2 </code> to <code>lastrow To 1</code>"}, {"owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "edited": false, "score": 1, "creation_date": 1483553173, "post_id": 41470118, "comment_id": 70146672, "body": "changed to For i = lastrow To 1 Step -1!"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 6, "last_activity_date": 1483551900, "creation_date": 1483551900, "answer_id": 41470118, "question_id": 41470034, "link": "https://stackoverflow.com/questions/41470034/vba-delete-rows-before-todays-date/41470118#41470118", "title": "VBA delete rows before today&#39;s date", "body": "<p>For dates (and currency), its always recommended to use <code>Value2</code> instead of <code>Value</code>. </p>\n\n<p>MSDN:</p>\n\n<blockquote>\n  <p>The only difference between this property and the Value property is\n  that the Value2 property doesn\u2019t use the Currency and Date data types.\n  You can return values formatted with these data types as\n  floating-point numbers by using the Double data type.</p>\n</blockquote>\n\n<p>So all you need to do is change this part <code>If Cells(i, 4).Value &lt; *numeric value* Then</code></p>\n\n<p>With this <code>If Cells(i, 4).Value2 &lt; Date Then</code> </p>\n\n<p>and it evaluate as true if Column D is older than today. </p>\n"}], "owner": {"reputation": 185, "user_id": 7318518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a29816587aaca043eb2efce3410cfbe?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7318518/john-tipton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3420, "favorite_count": 1, "accepted_answer_id": 41470118, "answer_count": 1, "score": 1, "last_activity_date": 1483564391, "creation_date": 1483551538, "last_edit_date": 1483564391, "question_id": 41470034, "link": "https://stackoverflow.com/questions/41470034/vba-delete-rows-before-todays-date", "title": "VBA delete rows before today&#39;s date", "body": "<p>I have a csv file on excel that is ~CU for the column. </p>\n\n<p>And the row gets keep updated (as of now it's 2606). </p>\n\n<p>I'm trying to </p>\n\n<ol>\n<li>delete all row that are <code>before today's date</code> as recorded on column D</li>\n<li>no typing/text box/human input for today's date. </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/BvM8K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BvM8K.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub deleterows()\nlastrow = Cells(Rows.Count, 4).End(xlUp).Row\nFor i = lastrow To 2 Step -1\n    If Cells(i, 4).Value &lt; *numeric value* Then Rows(i).EntireRow.Delete\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5683238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76433a9de379d7215b51e41211ef26fb?s=128&d=identicon&r=PG&f=1", "display_name": "AlanB", "link": "https://stackoverflow.com/users/5683238/alanb"}, "edited": false, "score": 0, "creation_date": 1483550915, "post_id": 41469736, "comment_id": 70145401, "body": "In the sample above, every value in columns Analysis\\xx for AccountNumber ABCD1234 need to be changed to 80321, irrespective of what the field currently contains.  The new Analysis\\xx value will be fixed by the AccountNumber.  I only need to change the value where the column heading is Analysis\\xx.  In the data above, it goes up to Analysis\\57 (366 columns wide including the other relevant data which isn&#39;t changed). There is usually about 200 rows in each file and maybe 20-30 of these are affected."}], "tags": [], "owner": {"reputation": 212, "user_id": 7373309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a438ae919aeb17b00417d619f90852f?s=128&d=identicon&r=PG&f=1", "display_name": "EKSK", "link": "https://stackoverflow.com/users/7373309/eksk"}, "is_accepted": false, "score": 0, "last_activity_date": 1483550481, "creation_date": 1483550481, "answer_id": 41469736, "question_id": 41469605, "link": "https://stackoverflow.com/questions/41469605/excel-vba-to-update-cell-values-within-table-with-variable-number-of-columns/41469736#41469736", "title": "Excel VBA to update cell values within table with variable number of columns", "body": "<p>Hallo have you tried to use something like this for which TEST1 is the Varibale you like to replace and Test2 is the Variable you like to chnage it to ? This code does it for the entire Worksheet.</p>\n\n<pre><code>Sub Macro1()\n\n    Cells.Replace What:=\"TEST1\", Replacement:=\"Test2\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 5683238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76433a9de379d7215b51e41211ef26fb?s=128&d=identicon&r=PG&f=1", "display_name": "AlanB", "link": "https://stackoverflow.com/users/5683238/alanb"}, "edited": false, "score": 0, "creation_date": 1483552355, "post_id": 41470016, "comment_id": 70146216, "body": "I think so, but I only need to look for columns where the value in the header row is called Analysis\\xx.  The number of analysis columns changes in each file and it could be anything from 4 to 60+.  There are also at least another 50 columns of data which I don&#39;t want to change."}, {"owner": {"reputation": 83, "user_id": 5683238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76433a9de379d7215b51e41211ef26fb?s=128&d=identicon&r=PG&f=1", "display_name": "AlanB", "link": "https://stackoverflow.com/users/5683238/alanb"}, "edited": false, "score": 0, "creation_date": 1483552533, "post_id": 41470016, "comment_id": 70146286, "body": "Hit enter by mistake. The query needs to be use the logic &#39;for each cell where accountnumber  = ABCD1234 and column heading = analysis\\1 to x, change value at intersect to 80321&#39;"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 83, "user_id": 5683238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76433a9de379d7215b51e41211ef26fb?s=128&d=identicon&r=PG&f=1", "display_name": "AlanB", "link": "https://stackoverflow.com/users/5683238/alanb"}, "edited": false, "score": 0, "creation_date": 1483553819, "post_id": 41470016, "comment_id": 70146991, "body": "Question: Do you use Listobjects in your sheets?"}, {"owner": {"reputation": 83, "user_id": 5683238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76433a9de379d7215b51e41211ef26fb?s=128&d=identicon&r=PG&f=1", "display_name": "AlanB", "link": "https://stackoverflow.com/users/5683238/alanb"}, "edited": false, "score": 0, "creation_date": 1483976023, "post_id": 41470016, "comment_id": 70307904, "body": "that was a great help, thank you.  The only point left is to only update cells which already contain a value.  The code above updates all cells with the relevant column/row value irrespective of the existing cell contents."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1483555033, "last_edit_date": 1483555033, "creation_date": 1483551461, "answer_id": 41470016, "question_id": 41469605, "link": "https://stackoverflow.com/questions/41469605/excel-vba-to-update-cell-values-within-table-with-variable-number-of-columns/41470016#41470016", "title": "Excel VBA to update cell values within table with variable number of columns", "body": "<p>Assuming your table has a name you can use the follwoing code to loop through each row off column A and in this case just print the value of a column in the same row. </p>\n\n<pre><code>Sub Tester()\n\nDim rg As Range\nDim rgA As Range\nDim sngCell As Range\n\n    Set rg = Range(\"Your TableName\")\n    Set rgA = rg.Columns(1)\n    For Each sngCell In rgA.Rows\n        Debug.Print sngCell.Offset(, 3).Value2\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Does that code go in the right direction?</p>\n\n<p>EDIT: Assuming you use a listobject, this code might help you</p>\n\n<pre><code>Sub ChangeTable()\n\nConst ACCT_NO = \"ABCD1234\"\nConst HEADING = \"Analysis*\"\nConst NEW_VAL = \"80321\"\n\nDim tbl As ListObject\nDim x As Long\nDim i As Long\nDim hdrCount As Long\n\n    Set tbl = ActiveSheet.ListObjects(\"Your Name here\")\n    hdrCount = tbl.HeaderRowRange.Columns.Count\n\n    For x = 1 To tbl.ListRows.Count\n        With tbl.ListRows(x)\n            If .Range(1, 1).Value2 = ACCT_NO Then\n                For i = 2 To hdrCount\n                    If tbl.HeaderRowRange(i).Value2 Like HEADING Then\n                        .Range(1, i).Value = NEW_VAL\n                    End If\n                Next\n            End If\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5683238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76433a9de379d7215b51e41211ef26fb?s=128&d=identicon&r=PG&f=1", "display_name": "AlanB", "link": "https://stackoverflow.com/users/5683238/alanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15385, "favorite_count": 0, "accepted_answer_id": 41470016, "answer_count": 2, "score": 0, "last_activity_date": 1483555033, "creation_date": 1483550043, "last_edit_date": 1531164843, "question_id": 41469605, "link": "https://stackoverflow.com/questions/41469605/excel-vba-to-update-cell-values-within-table-with-variable-number-of-columns", "title": "Excel VBA to update cell values within table with variable number of columns", "body": "<p>I have a table of data which needs certain values to be changed based upon the value in column A.  The data resides in a column headed Analysis\\xx where xx is a variable value from 1 to 60.  The number of columns varies per row, so that row 4 may go up to Analysis\\4 whereas row 5 might go up to Analysis\\30.  Every value appearing in the Analysis\\xx field needs to be updated, where a certain value exists in column A. </p>\n\n<p>I have code to update values based upon a single fixed column position but I'm struggling to work out how to iterate through each row to update a variable number of columns.</p>\n\n<p>Any suggestions would be gratefully received. </p>\n\n<p>I've attached a sample of the data below which shows a good selection of the variation, with the columns that don't need amending hidden.  Row 26 actually goes all the way to column NB.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tLEzy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tLEzy.png\" alt=\"Data Sample\"></a></p>\n"}, {"tags": ["excel", "vba", "macos", "macos-sierra"], "comments": [{"owner": {"reputation": 804, "user_id": 824313, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7da6b17ebd0217fbdd3ad41706c23d8a?s=128&d=identicon&r=PG", "display_name": "tro", "link": "https://stackoverflow.com/users/824313/tro"}, "edited": false, "score": 0, "creation_date": 1483550281, "post_id": 41469337, "comment_id": 70145017, "body": "Got it, RefEdit is missing on MacOS."}], "answers": [{"tags": [], "owner": {"reputation": 804, "user_id": 824313, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7da6b17ebd0217fbdd3ad41706c23d8a?s=128&d=identicon&r=PG", "display_name": "tro", "link": "https://stackoverflow.com/users/824313/tro"}, "is_accepted": false, "score": 1, "last_activity_date": 1483550500, "creation_date": 1483550500, "answer_id": 41469742, "question_id": 41469337, "link": "https://stackoverflow.com/questions/41469337/excel-vba-compile-error-in-hidden-module-only-on-macos/41469742#41469742", "title": "EXCEL VBA: Compile error in hidden module only on MacOS", "body": "<p>The RefEdit reference was missing on MacOS. I removed it and now it seems to work. </p>\n"}], "owner": {"reputation": 804, "user_id": 824313, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7da6b17ebd0217fbdd3ad41706c23d8a?s=128&d=identicon&r=PG", "display_name": "tro", "link": "https://stackoverflow.com/users/824313/tro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593679185, "creation_date": 1483549089, "last_edit_date": 1593679185, "question_id": 41469337, "link": "https://stackoverflow.com/questions/41469337/excel-vba-compile-error-in-hidden-module-only-on-macos", "title": "EXCEL VBA: Compile error in hidden module only on MacOS", "body": "<p>I have a problem with running a VBA in a Excel spreadsheet on a MacOS (Sierra). On Windows everything works like expected. I always get the \"Compile error in hidden module: Interpolation ...</p>\n\n<p>I tried to remove the whole content of the module and this is the leftover:</p>\n\n<pre><code>Function interpolate(x As Double, ran As Range) As String\n\ninterpolate1 = 1\ninterpolate = interpolate1\n\nEnd Function\n</code></pre>\n\n<p>The VBA code is password protected and I don't use any ActiveX controls. \nThe references I use are as follows:</p>\n\n<ul>\n<li>Visual Basic For Applications</li>\n<li>Microsoft Excel 16.0 Object Library</li>\n<li>OLE Automation</li>\n<li>Microsoft Office 16.0 Object Library</li>\n<li>Microsoft Forms 2.0 Object Library</li>\n<li>RefEdit Control</li>\n</ul>\n\n<p>If anyone has any suggestions on how to go about this problem, that would be great.</p>\n\n<p>Thanks,\nTro</p>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 170, "user_id": 6801688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37a17d5a095e296eabc8cd88e78a3?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/6801688/joe"}, "edited": false, "score": 2, "creation_date": 1483547054, "post_id": 41468545, "comment_id": 70142760, "body": "Start by trying &quot;A6:K&quot; &amp; lMaxRows. This will make your range argument A6:K500 (if 500 is the last row, for example). As it is currently constructed, you are feeding it the literal string of A6:KlmaxRows which is making it justifiably freak out a little bit."}, {"owner": {"reputation": 314, "user_id": 5724081, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1308c226220acb79f649ed25159676ed?s=128&d=identicon&r=PG&f=1", "display_name": "dudu721", "link": "https://stackoverflow.com/users/5724081/dudu721"}, "edited": false, "score": 0, "creation_date": 1483547065, "post_id": 41468545, "comment_id": 70142769, "body": "You should add Option explicit at the top of your vba module. It will display you errors. I think the &quot;&quot; in the range aren&#39;t correctly placed also. (move the closing one just before the &amp;)"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 170, "user_id": 6801688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37a17d5a095e296eabc8cd88e78a3?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/6801688/joe"}, "edited": false, "score": 0, "creation_date": 1483547295, "post_id": 41468545, "comment_id": 70142940, "body": "@Joe thank you that worked perfectly. Can you write that as an answer?"}, {"owner": {"reputation": 170, "user_id": 6801688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37a17d5a095e296eabc8cd88e78a3?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/6801688/joe"}, "edited": false, "score": 0, "creation_date": 1483547539, "post_id": 41468545, "comment_id": 70143137, "body": "@Vbasic4now Sure, I added it below."}], "answers": [{"comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1483548144, "post_id": 41468818, "comment_id": 70143595, "body": "The range argument was <code>&quot;A6:K &amp; lMaxRows&quot;</code>, without any modification (since the <code>&amp;</code> was inside the double quotes it was not evaluated.)."}], "tags": [], "owner": {"reputation": 170, "user_id": 6801688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37a17d5a095e296eabc8cd88e78a3?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/6801688/joe"}, "is_accepted": true, "score": 4, "last_activity_date": 1483547525, "creation_date": 1483547525, "answer_id": 41468818, "question_id": 41468545, "link": "https://stackoverflow.com/questions/41468545/excel-vba-clearing-a-range-of-data-that-is-changing-regularly/41468818#41468818", "title": "Excel vba clearing a range of data that is changing regularly", "body": "<p>As requested by the OP, I'm moving my comment to the answer. </p>\n\n<p>The issue was with the line </p>\n\n<pre><code>destSheet.range(\"A6:K &amp; lMaxRows\").ClearContents\n</code></pre>\n\n<p>It needed to be changed to: </p>\n\n<pre><code>destSheet.range(\"A6:K\" &amp; lMaxRows).ClearContents\n</code></pre>\n\n<p>Note that the ending quotation mark moved. Supposing that lMaxRows is 500, this makes the range argument \"A6:K500\", which VBA can then evaluate as a range object. Before, it was the literal string A6:KlMaxRows, which VBA is <em>not</em> able to evaluate to a range object, since the variable is part of a string. </p>\n"}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 41468818, "answer_count": 1, "score": 1, "last_activity_date": 1483547525, "creation_date": 1483546749, "question_id": 41468545, "link": "https://stackoverflow.com/questions/41468545/excel-vba-clearing-a-range-of-data-that-is-changing-regularly", "title": "Excel vba clearing a range of data that is changing regularly", "body": "<p>I am trying to make a simple vba function in excel that clears a range of data, that goes from column A to K and row 6 to the bottom of the data, by finding the last used row and setting that as the end of the range. This is the code I have that is not working:</p>\n\n<pre><code>Sub clearNameData()\n\nDim destSheet As Worksheet: Set destSheet = ThisWorkbook.Worksheets(\"Name Search\")\n\nlMaxRows = destSheet.Cells(destSheet.Rows.Count, \"A\").End(xlUp).Row\n\ndestSheet.range(\"A6:K &amp; lMaxRows\").ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>When I run this code it gives me the error \"Run-time error '1004': MEthod 'Range' of object'_Worksheet' failed\"</p>\n\n<p>I cant figure out exactly how to get what im trying to do to work despite trying every syntax combination of my range definition. Any help would be greatly appreciated!</p>\n"}, {"tags": ["xml", "vba", "excel", "dom"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483549119, "post_id": 41468528, "comment_id": 70144280, "body": "Just leave the &quot;extra&quot; header row out of the <code>Range</code> you pass the function - i.e. define your range starting in <code>Row(2)</code>..."}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483603163, "post_id": 41468528, "comment_id": 70165009, "body": "Thanks, but ofc I tested this before posting. <code>Range.Value</code> will extend it&#39;s range to get a value for <code>AttributeType rs:name=&quot;&lt;&lt;Header&gt;&gt;&quot;</code> to up to two <code>Rows</code> upwards."}], "answers": [{"comments": [{"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 1, "creation_date": 1487151577, "post_id": 42089425, "comment_id": 71649423, "body": "Try <code>Debug.Print rngInputRange.value(xlRangeValueMSPersistXML)</code>. The XML code shows us why<code>Trim</code> won&#39;t work here. A more specific <code>Replace</code> will likely solve the problem, <b>if</b> the row above the header row is blank: <code>xlXML.LoadXML Replace(rngInputRange.Value(xlRangeValueMSPersistXML), &quot;rs:name=&quot;&quot; &quot;, &quot;rs:name=&quot;&quot;&quot;)</code>. Technically, one could dynamically replace the <code>rs:name=&quot;Cell1 Cell2&quot;</code> with <code>rs:name=&quot;Cell2&quot;</code> regardless of Cell1&#39;s content"}], "tags": [], "owner": {"reputation": 106, "user_id": 7094499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ea06c4fef2235b3bbdbfb725a51348e?s=128&d=identicon&r=PG&f=1", "display_name": "BoffWx", "link": "https://stackoverflow.com/users/7094499/boffwx"}, "is_accepted": false, "score": 1, "last_activity_date": 1486470552, "last_edit_date": 1486470552, "creation_date": 1486469038, "answer_id": 42089425, "question_id": 41468528, "link": "https://stackoverflow.com/questions/41468528/excel-range-xml-uses-two-rows-for-header/42089425#42089425", "title": "Excel-Range XML uses two rows for header", "body": "<p>I've been struggling with the same issue. The only way around I've found so far is to just insert another row above the header row and then pass the required range after that.</p>\n\n<p>When filtering I have to append an extra space at the beginning.\nSo </p>\n\n<pre><code>RS.Filter = \"[field_header] = \" &amp; strSome_text\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>RS.Filter = \"[ field_header] = \" &amp; strSome_text\n</code></pre>\n\n<p>as it appears Excel is appending it. I am trying <code>Trim</code>:</p>\n\n<pre><code>xlXML.LoadXML Trim(rngInputRange.value(xlRangeValueMSPersistXML))\n</code></pre>\n\n<p>with no joy. A couple of my headers have spaces so using <code>Replace</code> makes things much more ugly.</p>\n\n<p>Adding the extra row and appending the space to the beginning of the field name means that I can filter on field names with spaces as I could normally with the header row on row 1, so although a bit dirty, this is a good enough workaround for me for now.</p>\n"}], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487151840, "creation_date": 1483546698, "last_edit_date": 1531164843, "question_id": 41468528, "link": "https://stackoverflow.com/questions/41468528/excel-range-xml-uses-two-rows-for-header", "title": "Excel-Range XML uses two rows for header", "body": "<p>I use <a href=\"https://usefulgyaan.wordpress.com/2013/07/11/vba-trick-of-the-week-range-to-recordset-without-making-connection/\" rel=\"nofollow noreferrer\">this</a> function to get recordsets from <code>Range</code>-Objects without setting up ADO-connections.</p>\n\n<pre><code>Function GetRecordset(rng As Range) As Object    \n\n    Dim xlXML As Object\n    Dim rst As Object\n\n    Set rst = CreateObject(\"ADODB.Recordset\")\n    Set xlXML = CreateObject(\"MSXML2.DOMDocument\")\n\n    xlXML.LoadXML rng.Value(xlRangeValueMSPersistXML)\n\n    rst.Open xlXML\n\n    Set GetRecordset = rst\n\nEnd Function\n</code></pre>\n\n<p>I typically use <strong>one</strong> header row. I get the expected results if the data starts in <code>Row(1)</code>.</p>\n\n<p>However, if there are 1+ <code>Rows</code> above the data, excel assumes i have <strong>two</strong> header-rows and concatenates them with a blank.</p>\n\n<p>Therefore, my recordset uses Fieldnames like <code>![Underneath's your header, mate MyField]</code> instead of <code>![MyField]</code>.</p>\n\n<p>More technically speaking, the problem is that <code>rng.Value(xlRangeValueMSPersistXML)</code> returns the concatenated two rows as header and I'm unable to set that to one row.</p>\n\n<p>Interested to hear your thoughts!</p>\n\n<p><strong>EDIT:</strong> a workaround might be to replace leading blanks with something like</p>\n\n<pre><code>xlXML.LoadXML Replace(rng.Value(xlRangeValueMSPersistXML), \"rs:name=\"\" \", \"rs:name=\"\"\")\n</code></pre>\n\n<p>or an iterative </p>\n\n<pre><code>Replace XML, \"rs:name=\"\"Cell1 Cell\", \"rs:name=\"\"Cell2\")\n</code></pre>\n\n<p>for each datafield</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 5, "creation_date": 1483546105, "post_id": 41468305, "comment_id": 70142037, "body": "Use a loop.  The code you provided only specifies one cell.  You probably want to loop through a range of cells instead.  You might also consider a relative formula containing a conditional instead of code."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7375104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7fcd58280908a390f1bd170d6a1107?s=128&d=identicon&r=PG&f=1", "display_name": "HoroHoro", "link": "https://stackoverflow.com/users/7375104/horohoro"}, "edited": false, "score": 0, "creation_date": 1483580780, "post_id": 41468784, "comment_id": 70158191, "body": "i tried to intergrate your formula intomy vba, it does not work, i am not too sure why."}, {"owner": {"reputation": 13, "user_id": 7375104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7fcd58280908a390f1bd170d6a1107?s=128&d=identicon&r=PG&f=1", "display_name": "HoroHoro", "link": "https://stackoverflow.com/users/7375104/horohoro"}, "edited": false, "score": 0, "creation_date": 1483582427, "post_id": 41468784, "comment_id": 70158577, "body": "i tried to intergrate your formula into my vba, it does not work, i am not too sure why.  My code is as follow.                                                               With Columns(3).SpecialCells(XlCellType.xlCellTypeConstants, xlNumbers).Offset(, 1).FormulaR1C1 = &quot;=IF(RC[-1]=1 Then&quot;                     rng = mRng         Sheet1.Range(&quot;A&quot; &amp; rng.Row &amp; &quot;:N&quot; &amp; rng.Row).Interior.Color = 5287936.                                                                                                        I tried to improvise it by highlighting it green but cannot work. what is wrong?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13, "user_id": 7375104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7fcd58280908a390f1bd170d6a1107?s=128&d=identicon&r=PG&f=1", "display_name": "HoroHoro", "link": "https://stackoverflow.com/users/7375104/horohoro"}, "edited": false, "score": 0, "creation_date": 1483600510, "post_id": 41468784, "comment_id": 70163751, "body": "You have to type it in your VBA just as I wrote it. Let me know"}, {"owner": {"reputation": 13, "user_id": 7375104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7fcd58280908a390f1bd170d6a1107?s=128&d=identicon&r=PG&f=1", "display_name": "HoroHoro", "link": "https://stackoverflow.com/users/7375104/horohoro"}, "edited": false, "score": 0, "creation_date": 1483604197, "post_id": 41468784, "comment_id": 70165478, "body": "Hi, I want it in it in such a way that if column C has 1, the corresponding row from column N will be highlighted. instead of having yes no. Hope is not confusing for you. and thanks for all the help"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13, "user_id": 7375104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7fcd58280908a390f1bd170d6a1107?s=128&d=identicon&r=PG&f=1", "display_name": "HoroHoro", "link": "https://stackoverflow.com/users/7375104/horohoro"}, "edited": false, "score": 0, "creation_date": 1483613611, "post_id": 41468784, "comment_id": 70171106, "body": "Well that&#39;s quite a different thing than what you asked in your post, and you&#39;ll need &quot;classic&quot; loop for that. BTW if I solved your <i>original</i> question (<i>&quot;like my cell D2 will show &quot;yes&quot; when cell C2 show &quot;1&quot; and cell D3 show &quot;No&quot; when Cell C3 show a different number&quot;</i>) then please mark answer as accepted. Thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1483547432, "creation_date": 1483547432, "answer_id": 41468784, "question_id": 41468305, "link": "https://stackoverflow.com/questions/41468305/how-to-do-if-cell-contains-in-vba/41468784#41468784", "title": "How to do &quot;If cell contains&quot; in VBA", "body": "<p>you can avoid loops this way:</p>\n\n<pre><code>Columns(3).SpecialCells(XlCellType.xlCellTypeConstants, xlNumbers).Offset(, 1).FormulaR1C1 = \"=IF(RC[-1]=1,\"\"yes\"\",\"\"no\"\")\"\n</code></pre>\n\n<p>and if you want to get rid of formulas:</p>\n\n<pre><code>With Columns(3).SpecialCells(XlCellType.xlCellTypeConstants, xlNumbers).Offset(, 1)\n    .FormulaR1C1 = \"=IF(RC[-1]=1,\"\"yes\"\",\"\"no\"\")\"\n    .value = .value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7375104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7fcd58280908a390f1bd170d6a1107?s=128&d=identicon&r=PG&f=1", "display_name": "HoroHoro", "link": "https://stackoverflow.com/users/7375104/horohoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 41468784, "answer_count": 1, "score": 1, "last_activity_date": 1483547432, "creation_date": 1483546023, "last_edit_date": 1483546061, "question_id": 41468305, "link": "https://stackoverflow.com/questions/41468305/how-to-do-if-cell-contains-in-vba", "title": "How to do &quot;If cell contains&quot; in VBA", "body": "<p>I am looking for a code to do an statement when a cell contain the number \"1\".</p>\n\n<p>I have been using this code found online.</p>\n\n<pre><code>Dim celltxt As String\ncelltxt = ActiveSheet.Range(\"C6\").Text\nIf InStr(1, celltxt, \"1\") Then\nMsgBox (\"Yes\")\nElse\nMsgBox (\"no\")\nEnd If\n</code></pre>\n\n<p>However this work if it only read cell C6. How do i set it in such a way that it will read a range of cell from C2:C5000. Like my cell D2 will show \"yes\" when cell C2 show \"1\" and cell D3 show \"No\" when Cell C3 show a different number?.</p>\n\n<p>Thanks for the big help</p>\n\n<p>Horo</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1483546326, "post_id": 41468168, "comment_id": 70142194, "body": "The first step is taking out <code>On Error Resume Next</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7375091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f88f918f3f3e69d7880134f41f47ebc?s=128&d=identicon&r=PG&f=1", "display_name": "xxx", "link": "https://stackoverflow.com/users/7375091/xxx"}, "edited": false, "score": 0, "creation_date": 1483631937, "post_id": 41468649, "comment_id": 70184159, "body": "Thank you so much. That worked. How do I get it to allow the date to be entered in more than one format such as dd/MMM/yyyy or ddMMMyyyy, etc.."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 11, "user_id": 7375091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f88f918f3f3e69d7880134f41f47ebc?s=128&d=identicon&r=PG&f=1", "display_name": "xxx", "link": "https://stackoverflow.com/users/7375091/xxx"}, "edited": false, "score": 0, "creation_date": 1483633808, "post_id": 41468649, "comment_id": 70185514, "body": "Glad it helped! If it&#39;s answered your question then you&#39;re best marking this as the answer. To recognise a date without punctuation would require a different method - you&#39;re best asking a new question about that."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1483547066, "creation_date": 1483547066, "answer_id": 41468649, "question_id": 41468168, "link": "https://stackoverflow.com/questions/41468168/how-do-you-add-an-error-loop-to-vba-word/41468649#41468649", "title": "How do you add an error loop to VBA Word?", "body": "<p>Check if a date has been submitted using the <a href=\"https://msdn.microsoft.com/en-us/library/00wf8zk9(v=vs.90).aspx\" rel=\"nofollow noreferrer\"><code>IsDate</code> Function</a>.</p>\n\n<p>You can loop until an actual date has been entered using a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264682.aspx\" rel=\"nofollow noreferrer\"><code>While... Wend</code> Statement</a>. Once a date has been entered, convert this date into the format you require for processing.</p>\n\n<pre><code>Private Sub GetDate()\n\n    Dim dateInput As Variant\n\n    While Not IsDate(dateInput)\n        dateInput = InputBox(\"Insert date.\")\n    Wend\n\n    dateInput = Format(dateInput, \"dd/MMM/yyyy\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7375091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f88f918f3f3e69d7880134f41f47ebc?s=128&d=identicon&r=PG&f=1", "display_name": "xxx", "link": "https://stackoverflow.com/users/7375091/xxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 41468649, "answer_count": 1, "score": 0, "last_activity_date": 1483897160, "creation_date": 1483545679, "last_edit_date": 1483897160, "question_id": 41468168, "link": "https://stackoverflow.com/questions/41468168/how-do-you-add-an-error-loop-to-vba-word", "title": "How do you add an error loop to VBA Word?", "body": "<p>I am trying to create an automated form in Word and am almost done but I cannot figure out how to get an error message to pop up if a date is entered incorrectly and then to loop back to the question until it is answered correctly. Can anyone help me with this? </p>\n\n<p>This is what the code currently looks like for the date entry:</p>\n\n<pre><code>Sub mStartDate1()\n\nvStartDate1 = InputBox(Prompt:=\"Please enter the Start Date (dd/MMM/yyyy) and click ok.\")\n\nOn Error Resume Next\n   ActiveDocument.FormFields(\"bkStartDate1\").Result = vStartDate1\n\nCall mStartTime1\n\nEnd Sub\n</code></pre>\n\n<p>When an error occurs, I currently have it going to the next field but I would like it to present an error message and then loop back to the question until it is answered correctly. </p>\n"}, {"tags": ["javascript", "excel", "cors", "vba"], "comments": [{"owner": {"reputation": 124, "user_id": 3961837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0421c8d3b433f6cf5bd2730d8babdc8d?s=128&d=identicon&r=PG&f=1", "display_name": "Fred Vollmer", "link": "https://stackoverflow.com/users/3961837/fred-vollmer"}, "edited": false, "score": 1, "creation_date": 1483546392, "post_id": 41467992, "comment_id": 70142245, "body": "Do you have control over the server? In order to allow CORS requests, you need to have the server return an <code>Access-Control-Allow-Origin</code> header with your domain (or <code>*</code>) as the value, just as the error you receive indicates."}, {"owner": {"reputation": 57, "user_id": 824026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434d2d5d78ce88ef52c020ae563f51ba?s=128&d=identicon&r=PG", "display_name": "Tyler Mitchell", "link": "https://stackoverflow.com/users/824026/tyler-mitchell"}, "reply_to_user": {"reputation": 124, "user_id": 3961837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0421c8d3b433f6cf5bd2730d8babdc8d?s=128&d=identicon&r=PG&f=1", "display_name": "Fred Vollmer", "link": "https://stackoverflow.com/users/3961837/fred-vollmer"}, "edited": false, "score": 0, "creation_date": 1483546938, "post_id": 41467992, "comment_id": 70142672, "body": "I guess I should have been more specific. I have no control over the server. That app is controlled by a different team at my company(In a different location) I am surprised that CORS is in effect because my domain is: mydomain.somebs.domain.com Theirs is: theirdomain.domain.com So I can&#39;t just accept my subdomain in their server policy. Updating the initial post."}, {"owner": {"reputation": 1218, "user_id": 4555594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-3IwHtCD3o9k/AAAAAAAAAAI/AAAAAAAAAh0/4QZ-TpUkgpE/photo.jpg?sz=128", "display_name": "ethesx", "link": "https://stackoverflow.com/users/4555594/ethesx"}, "edited": false, "score": 1, "creation_date": 1483548821, "post_id": 41467992, "comment_id": 70144064, "body": "Since the server&#39;s returning a csv, jsonp isn&#39;t an option - I believe the cleanest option would be to contact the team responsible for the server and have them add the CORS header and specify the base domain: <code>Access-control-allow-origin: https:&#47;&#47;domain.com</code>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 824026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434d2d5d78ce88ef52c020ae563f51ba?s=128&d=identicon&r=PG", "display_name": "Tyler Mitchell", "link": "https://stackoverflow.com/users/824026/tyler-mitchell"}, "edited": false, "score": 0, "creation_date": 1483589880, "post_id": 41468150, "comment_id": 70160183, "body": "Thanks for your quick suggestion.This was the working response. It makes no sense to me though that you can&#39;t grab a resource from the client side with ajax and fiddle with it but you can grab it from the server side and pump the data into javascript and fiddle with it... I&#39;ll have to read more into what CORS is supposed to prevent."}], "tags": [], "owner": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "is_accepted": true, "score": 3, "last_activity_date": 1483545625, "creation_date": 1483545625, "answer_id": 41468150, "question_id": 41467992, "link": "https://stackoverflow.com/questions/41467992/cors-request-working-in-excel-but-not-in-javascript/41468150#41468150", "title": "Cors request working in Excel but not in Javascript", "body": "<p>Its because CORS is typically a browser policy, Excel doesn't care about CORS policy because Excel isn't really vulnerable to a scenario that browsers face every day (fake websites running javascript that pulls data from the real site.) If what you're doing is just a one off scenario you can disable CORS policy in your browser, but that won't work for a production website.</p>\n\n<p>My advice would be to use some php in a server side script to download the CSV and then print its contents..</p>\n\n<p>Something like...</p>\n\n<pre><code>&lt;?php\necho file_get_contents('http://otherdomain.com/that_csv_file.csv');\n?&gt;\n</code></pre>\n\n<p>Then point your javascript url at your now 'same domain' php script.</p>\n"}], "owner": {"reputation": 57, "user_id": 824026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434d2d5d78ce88ef52c020ae563f51ba?s=128&d=identicon&r=PG", "display_name": "Tyler Mitchell", "link": "https://stackoverflow.com/users/824026/tyler-mitchell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "accepted_answer_id": 41468150, "answer_count": 1, "score": 2, "last_activity_date": 1483547022, "creation_date": 1483545180, "last_edit_date": 1531164843, "question_id": 41467992, "link": "https://stackoverflow.com/questions/41467992/cors-request-working-in-excel-but-not-in-javascript", "title": "Cors request working in Excel but not in Javascript", "body": "<p>I understand the CORS policy and since the server is not set to accept CORS requests, I should not be able to download the CSV file from a different origin. However the server seems perfectly happy to fullfill the request when it is made from VBA in Excel. So why can't I grab the same file using Javascript?</p>\n\n<p>In Excel:</p>\n\n<pre><code>Sub transfercsv()\nsCSVLink = \"https://subdomain.domain.com/specific_page/pending_csv?var=specificLocation\"\nsfile = \"Filename_Specific_Location_\" &amp; Year(Date) &amp; \"-\" &amp; Month(Date) &amp; \"-\" &amp; Day(Date) &amp; \".csv\"\nssheet = \"CSV Transfer\"\nSet wnd = ActiveWindow\nApplication.ScreenUpdating = False\nSheets(ssheet).Cells.ClearContents\nWorkbooks.Open Filename:=sCSVLink\nWindows(\"pending_CSV\").Activate\nActiveSheet.Cells.Copy\nwnd.Activate\nSheet1.Select\nSheets(\"CSV Transfer\").Range(\"A1\").Select\nSheets(\"CSV Transfer\").Paste\nApplication.DisplayAlerts = False\nWindows(\"pending_CSV\").Activate\nWindows(\"pending_CSV\").Close False\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nCall anotherFunc\nEnd Sub\n</code></pre>\n\n<p>In Javascript:</p>\n\n<pre><code>function displayData(){\n    //this function takes a csv and displays it as a table in the page\n  var tabulate = function (data,columns) {\n      var table = d3.select('body').append('table')\n        var thead = table.append('thead')\n        var tbody = table.append('tbody')\n        thead.append('tr')\n          .selectAll('th')\n            .data(columns)\n            .enter()\n          .append('th')\n            .text(function (d) { return d })\n        var rows = tbody.selectAll('tr')\n            .data(data)\n            .enter()\n          .append('tr')\n        var cells = rows.selectAll('td')\n            .data(function(row) {\n                return columns.map(function (column) {\n                    return { column: column, value: row[column] }\n              })\n          })\n          .enter()\n        .append('td')\n          .text(function (d) { return d.value })\n      return table;\n    }\n    //this function actually makes the xhr request and gets the csv\n    d3.csv('https://subdomain.domain.com/specific_page/pending_csv?var=specificLocation',function (data) {\n        var columns = ['column_name_1','column_name_2','column_name_3','column_name_4','column_name_5','column_name_6','column_name_7','column_name_8','column_name_9','column_name_10','column_name_11']\n      tabulate(data,columns)\n    })\n</code></pre>\n\n<p>So the Excel code above works for me no problem, but the Javascript code above gives me a security error:</p>\n\n<p>Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at <a href=\"https://subdomain.domain.com/specific_page/pending_csv?var=specificLocation\" rel=\"nofollow noreferrer\">https://subdomain.domain.com/specific_page/pending_csv?var=specificLocation</a>. (Reason: CORS header 'Access-Control-Allow-Origin' missing).</p>\n\n<p>Also, I have no control over the server. That app is controlled by a different team at my company(In a different location) I am surprised that CORS is in effect because my domain is: mydomain.somebs.domain.com Theirs is: theirdomain.domain.com So I can't just accept my subdomain in their server policy.</p>\n\n<p>So there should be a way for me to get this resource with Javascript right?</p>\n"}, {"tags": ["excel", "number-formatting", "french", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7761, "user_id": 456167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602c0d6b9ed63baf061dfffbd6b8ace9?s=128&d=identicon&r=PG", "display_name": "G&#244;T&#244;", "link": "https://stackoverflow.com/users/456167/g%c3%b4t%c3%b4"}, "is_accepted": false, "score": 0, "last_activity_date": 1483544723, "creation_date": 1483544723, "answer_id": 41467826, "question_id": 41467694, "link": "https://stackoverflow.com/questions/41467694/change-to-canadian-cdn-french-number-formatting-in-excel-vba/41467826#41467826", "title": "Change to Canadian (CDN) French number formatting in Excel VBA", "body": "<p>To get the code for any action in Excel:</p>\n\n<ol>\n<li>start recording a macro</li>\n<li>do what you want to replicate via code</li>\n<li>stop the recording</li>\n<li>check the macro code (ALT+F11)</li>\n</ol>\n\n<p>In this case applying the formatting gives this code:</p>\n\n<pre><code>Selection.NumberFormat = \"#,##0.00 $\"\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "edited": false, "score": 0, "creation_date": 1483548554, "post_id": 41468403, "comment_id": 70143886, "body": "Thanks for the help! I have a loop of code which I am trying to use to find and replace all currency formatting in my workbook but it does not seem to replace with new formatting code properly.    For Each Sheet In ActiveWorkbook.Sheets     Application.FindFormat.NumberFormat = &quot;$#,##0.00&quot;     Application.ReplaceFormat.NumberFormat = &quot;#,##0.00 [$$-40C]&quot;     Sheet.Cells.Replace What:=&quot;&quot;, Replacement:=&quot;&quot;, LookAt:=xlPart, SearchOrder _     :=xlByRows, MatchCase:=False, SearchFormat:=True, ReplaceFormat:=True  Next  It returns a application/object defined error. Any ideas?"}, {"owner": {"reputation": 1991, "user_id": 447485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4e2946c3270f4a20e60ec3d3c8f552?s=128&d=identicon&r=PG", "display_name": "airstrike", "link": "https://stackoverflow.com/users/447485/airstrike"}, "reply_to_user": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "edited": false, "score": 0, "creation_date": 1483549554, "post_id": 41468403, "comment_id": 70144545, "body": "@Greg usually that error relates to referring to an object that hasn&#39;t been <code>Set</code>. This is probably because you&#39;re using <code>Sheet</code> in the <code>For Each</code> loop. Try adding a <code>Dim Sht as Worksheet</code> just above the for and using <code>For Each Sht in ActiveWorkbook.Sheets</code> instead. You&#39;ll also need to change any <code>Sheet</code> inside the loop to <code>Sht</code>"}, {"owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "edited": false, "score": 0, "creation_date": 1483550376, "post_id": 41468403, "comment_id": 70145081, "body": "I have <code>dim Sheet as Worksheet</code> written into my code and all following code uses this property however it will not run. The error occurs at <code>Application.ReplaceFormat.NumberFormat = &quot;#,##0.00 [$$-40C]&quot;</code>"}, {"owner": {"reputation": 1991, "user_id": 447485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4e2946c3270f4a20e60ec3d3c8f552?s=128&d=identicon&r=PG", "display_name": "airstrike", "link": "https://stackoverflow.com/users/447485/airstrike"}, "reply_to_user": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "edited": false, "score": 1, "creation_date": 1483552720, "post_id": 41468403, "comment_id": 70146412, "body": "@Greg my bad, the code should be <code>[$$-C0C]</code>. Try that instead. I&#39;ve edited the answer"}], "tags": [], "owner": {"reputation": 1991, "user_id": 447485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4e2946c3270f4a20e60ec3d3c8f552?s=128&d=identicon&r=PG", "display_name": "airstrike", "link": "https://stackoverflow.com/users/447485/airstrike"}, "is_accepted": true, "score": 1, "last_activity_date": 1483549939, "last_edit_date": 1483549939, "creation_date": 1483546338, "answer_id": 41468403, "question_id": 41467694, "link": "https://stackoverflow.com/questions/41467694/change-to-canadian-cdn-french-number-formatting-in-excel-vba/41468403#41468403", "title": "Change to Canadian (CDN) French number formatting in Excel VBA", "body": "<p>To make the currency symbol appear to the right of your numbers, use the <code>NumberFormat</code> property of a <code>Range</code> object and set it to:</p>\n\n<ul>\n<li>For dollars: <code>#,##0.00 [$$-C0C]</code></li>\n<li>For euro: <code>#,##0.00 [$\u20ac-C0C]</code></li>\n</ul>\n\n<p>The behavior of commas and periods for decimals and digit grouping is usually controlled by your Region and Language Settings in Windows.</p>\n\n<p>You can change this setting application-wide (i.e. it will affect any workbook opened on your machine) by changing the values of <code>Application.DecimalSeparator</code> and <code>Application.ThousandsSeparator</code> in VBA. Alternatively, you can achieve the same effect by going to File > Options > Advanced and uncheck \"Use system separators\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/vvzca.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vvzca.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7179, "favorite_count": 0, "accepted_answer_id": 41468403, "answer_count": 2, "score": 2, "last_activity_date": 1483549939, "creation_date": 1483544396, "last_edit_date": 1531164843, "question_id": 41467694, "link": "https://stackoverflow.com/questions/41467694/change-to-canadian-cdn-french-number-formatting-in-excel-vba", "title": "Change to Canadian (CDN) French number formatting in Excel VBA", "body": "<p>I would like to build a piece of code which can convert numbers in my workbook from English to French number formatting. </p>\n\n<p>For example, </p>\n\n<ul>\n<li>English formatting would be <code>$1,000,000.99</code>, and </li>\n<li>French would be <code>1 000 000,99 $</code></li>\n</ul>\n\n<p>I can not seem to find any default French codes built into excel and using a <code>,</code> instead of a <code>.</code> for the decimal does not show numbers less than $1. </p>\n\n<p>Any assistance or advice is appreciated!</p>\n"}, {"tags": ["vba", "excel", "while-loop"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1483544438, "post_id": 41467674, "comment_id": 70140844, "body": "You need another End IF"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1483544569, "post_id": 41467674, "comment_id": 70140951, "body": "im blind thank you so mich"}], "answers": [{"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 1, "last_activity_date": 1483545986, "creation_date": 1483545986, "answer_id": 41468292, "question_id": 41467674, "link": "https://stackoverflow.com/questions/41467674/excel-vba-do-while-loop-not-recognizing-the-do-while-statement/41468292#41468292", "title": "Excel vba do while loop not recognizing the do while statement", "body": "<p>You are missing an <code>End If</code> ... see below</p>\n\n<pre><code>Sub NameSearch()\n\nSheets(\"Raw Data\").Unprotect (\"29745\")\nApplication.ScreenUpdating = False\n\nDim x As Long\n\n'set starting point at row 2\nx = 2\n\nDim sourceSheet As Worksheet: Set sourceSheet = ThisWorkbook.Worksheets(\"Raw Data\")\nDim destSheet As Worksheet: Set destSheet = ThisWorkbook.Worksheets(\"Name Search\")\n\nDo While sourceSheet.range(\"A\" &amp; x).Value &lt;&gt; \"\"\n\n    If sourceSheet.range(\"O\" &amp; x).Value &lt;&gt; destSheet.range(\"B2\") Then\n        x = x + 1\n\n    Else\n    If sourceSheet.range(\"O\" &amp; x).Value = destSheet.range(\"B2\") Then\n\n'selects the next row where the 1st column is empty\n            lMaxRows = destSheet.Cells(destSheet.Rows.Count, \"A\").End(xlUp).Row\n'pastes the data from the specified cells into the next empty row\n            destSheet.range(\"A\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"A\" &amp; x).Value\n            destSheet.range(\"B\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"B\" &amp; x).Value\n            destSheet.range(\"C\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"C\" &amp; x).Value\n            destSheet.range(\"D\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"D\" &amp; x).Value\n            destSheet.range(\"E\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"E\" &amp; x).Value\n            destSheet.range(\"F\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"F\" &amp; x).Value\n            destSheet.range(\"G\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"G\" &amp; x).Value\n            destSheet.range(\"H\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"F\" &amp; x).Value - sourceSheet.range(\"G\" &amp; x).Value\n            destSheet.range(\"I\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"M\" &amp; x).Value\n            destSheet.range(\"J\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"N\" &amp; x).Value\n\n        x = x + 1\n\n    End If\nEnd If '&lt;----MISSING END IF\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 41468292, "answer_count": 1, "score": 0, "last_activity_date": 1483545986, "creation_date": 1483544344, "question_id": 41467674, "link": "https://stackoverflow.com/questions/41467674/excel-vba-do-while-loop-not-recognizing-the-do-while-statement", "title": "Excel vba do while loop not recognizing the do while statement", "body": "<p>I am attempting to write a macro that checks each row in one sheet called raw data for a matching name and if the name matches, copy the data from that row over to a sheet called name search. I am attempting to do this using a do while loop similar to one that i have used successfully in the past. </p>\n\n<p>However when I try to run it, it gives me the error \"Loop without do\" despite the fact that everything seems to be in the correct place. my code is as follows:</p>\n\n<pre><code>Sub NameSearch()\n\nSheets(\"Raw Data\").Unprotect (\"29745\")\nApplication.ScreenUpdating = False\n\nDim x As Long\n\n'set starting point at row 2\nx = 2\n\nDim sourceSheet As Worksheet: Set sourceSheet = ThisWorkbook.Worksheets(\"Raw Data\")\nDim destSheet As Worksheet: Set destSheet = ThisWorkbook.Worksheets(\"Name Search\")\n\nDo While sourceSheet.range(\"A\" &amp; x).Value &lt;&gt; \"\"\n\n    If sourceSheet.range(\"O\" &amp; x).Value &lt;&gt; destSheet.range(\"B2\") Then\n        x = x + 1\n\n    Else\n    If sourceSheet.range(\"O\" &amp; x).Value = destSheet.range(\"B2\") Then\n\n'selects the next row where the 1st column is empty\n            lMaxRows = destSheet.Cells(destSheet.Rows.Count, \"A\").End(xlUp).Row\n'pastes the data from the specified cells into the next empty row\n            destSheet.range(\"A\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"A\" &amp; x).Value\n            destSheet.range(\"B\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"B\" &amp; x).Value\n            destSheet.range(\"C\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"C\" &amp; x).Value\n            destSheet.range(\"D\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"D\" &amp; x).Value\n            destSheet.range(\"E\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"E\" &amp; x).Value\n            destSheet.range(\"F\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"F\" &amp; x).Value\n            destSheet.range(\"G\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"G\" &amp; x).Value\n            destSheet.range(\"H\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"F\" &amp; x).Value - sourceSheet.range(\"G\" &amp; x).Value\n            destSheet.range(\"I\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"M\" &amp; x).Value\n            destSheet.range(\"J\" &amp; lMaxRows + 1).Value = sourceSheet.range(\"N\" &amp; x).Value\n\n        x = x + 1\n\n    End If\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I can not for the life of me figure out what I did wrong. Any help improving my code would be greatly appreciated! </p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "edited": false, "score": 2, "creation_date": 1483544110, "post_id": 41467243, "comment_id": 70140613, "body": "line1 = Split(Trim(myItem.Body), vbCrLf)(0)"}, {"owner": {"reputation": 23, "user_id": 5526239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Lw5h.jpg?s=128&g=1", "display_name": "WaveJam", "link": "https://stackoverflow.com/users/5526239/wavejam"}, "reply_to_user": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "edited": false, "score": 1, "creation_date": 1483549624, "post_id": 41467243, "comment_id": 70144593, "body": "Bingo! Thanks @Barney !"}], "owner": {"reputation": 23, "user_id": 5526239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Lw5h.jpg?s=128&g=1", "display_name": "WaveJam", "link": "https://stackoverflow.com/users/5526239/wavejam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1483543167, "creation_date": 1483543167, "question_id": 41467243, "link": "https://stackoverflow.com/questions/41467243/outlook-script-forward-first-line-of-an-inbound-email", "title": "Outlook Script - Forward first line of an inbound email", "body": "<p>I'm trying to write a script that simply forwards the very first line of an email to another email address. The inbound emails are always formatted like: </p>\n\n<blockquote>\n  <p>Line1 </p>\n  \n  <p>Line2<br>\n  Line3</p>\n</blockquote>\n\n<p>You'll note that there is a carriage return after line 1. Not sure if that helps but I want the output email to have the same subject line, forwarded to a different email and the body will contain: </p>\n\n<blockquote>\n  <p>Line1</p>\n</blockquote>\n\n<p>I've found samples where I can look for specific strings of text, but haven't found a sample to grab the first line. Searching for specific text won't work because that first line is always different. The only thing that is common is the CR between Line 1 and Line 2. </p>\n\n<p>So far I have simply:</p>\n\n<pre><code>Sub SendNew(Item As Outlook.MailItem)\n\nDim objMsg As MailItem\nSet objMsg = Application.CreateItem(olMailItem)\n\nobjMsg.Body = Item.Body\nobjMsg.Subject = Item.Subject\nobjMsg.Recipients.Add \"person@domain.com\"\n\nobjMsg.Send\n\nEnd Sub\n</code></pre>\n\n<p>Could someone please assist with something i can insert to grab just the first line? Thanks much! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1483543277, "post_id": 41467202, "comment_id": 70140065, "body": "What do you mean by &quot;output&quot;? On the worksheet or in the variable?  BTW, that code plays fast and loose with it&#39;s data types - I&#39;d refactor to treat dates as dates, not strings.  You&#39;ll end up with much more robust code."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1483543691, "post_id": 41467202, "comment_id": 70140336, "body": "Also, <code>DateAdd</code> is adding seconds. A quick fix could be to wrap <code>HumanTime</code> in a <code>Format</code> function: <code>Format(HumanTime,&quot;mm&#47;dd&#47;yyyy HH:MM:SS&quot;)</code>"}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1483543957, "post_id": 41467202, "comment_id": 70140519, "body": "HumanTime comes out to be just a time, with no date attached to it.  12:00:00 AM, iirc, though I can&#39;t check now because the code isn&#39;t complaining anymore.  Which part of the code is bad?  Doesn&#39;t CDate ensure that is a date?  Absent the middle part, which is...bad..."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483543959, "post_id": 41467202, "comment_id": 70140522, "body": "If you already have &quot;12/31/2016  7:15:00 AM&quot; in the target cell, why are you doing this conversion at all? <a href=\"https://en.wikipedia.org/wiki/Unix_time\" rel=\"nofollow noreferrer\">Unix time</a> is measured in seconds from epoch (which should be a <code>Long</code>)."}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1483544359, "post_id": 41467202, "comment_id": 70140798, "body": "I don&#39;t know why the conversion is being done, the code is awfully commented.  There&#39;s a few ifs afterwards - if it&#39;s January 1 - March 10, or November 5 - December 31, then <code>HumanTime=HumanTime - (1 &#47; 24)</code>.  I don&#39;t even understand still how you can just subtract a fraction from a date though.  That just doesn&#39;t make sense to me.  It should just be the next day at 7:15 AM.  Do I have anything to lose by just replacing this whole section with <code>dateadd(&quot;d&quot;, 1, cells(i,4))</code>, and making that the new cell?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1483547030, "post_id": 41467202, "comment_id": 70142744, "body": "In VBA dates are a number of days starting from 31-Dec-1899 as 1. Times are fractional parts of those numbers, so subtracting 1/24 is subtracting one hour."}], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": false, "score": 0, "last_activity_date": 1483543754, "creation_date": 1483543754, "answer_id": 41467443, "question_id": 41467202, "link": "https://stackoverflow.com/questions/41467202/adding-dates-to-dates-using-dateadd/41467443#41467443", "title": "Adding dates to dates using dateadd", "body": "<p>Since your UnixTime is a string, you will need to CDate that as well</p>\n\n<pre><code>HumanTime = DateAdd(\"s\", CDate(UnixTime), CDate(\"12/31/1969 08:00:00 PM\"))\n</code></pre>\n\n<p>I agree with Comintern that it would be better to work with these as dates rather than strings.</p>\n"}], "owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483543754, "creation_date": 1483543045, "last_edit_date": 1531164843, "question_id": 41467202, "link": "https://stackoverflow.com/questions/41467202/adding-dates-to-dates-using-dateadd", "title": "Adding dates to dates using dateadd", "body": "<p>I am looking through problematic code someone else wrote (I am unable to contact them, they've long since moved on) and I found out the code was having trouble because of dateadd.  Online, everywhere I look, they say the format for dateadd is (interval, number, date).  It is written in this code as (interval, date, date).  </p>\n\n<p>More specifically: </p>\n\n<pre><code>Dim UnixTime As String\nDim HumanTime As String\nFor i = 2 to 37\nUnixTime = Sheets(\"Current Values\").Cells(i, 4) 'cell(2, 4) is \"12/31/2016  7:15:00 AM\" without quotes\nHumanTime = DateAdd(\"s\", UnixTime, CDate(\"12/31/1969 08:00:00 PM\"))\n</code></pre>\n\n<p>This code has worked in the past, so I never had cause to look at it, but now it's just outputting a time, with no date attached to it.  To add to the mystery, halfway through troubleshooting it, it seemed to mysteriously start working.  I'm not complaining about it working, but next time it whines at me, I'd like to know where to start looking.  How does vba convert a date to a number?  Is there a more appropriate function than dateadd for this purpose?  </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1483542822, "post_id": 41467086, "comment_id": 70139771, "body": "Instead of using a sledgehammer to kill a fly, why don&#39;t you change the formula in those cells to <code>=IFERROR([current formula],&quot;NA&quot;)</code> ?"}, {"owner": {"reputation": 3333, "user_id": 3138531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a9a9881a8fedbbd3048ebdfced5ef3a?s=128&d=identicon&r=PG", "display_name": "serakfalcon", "link": "https://stackoverflow.com/users/3138531/serakfalcon"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1483542930, "post_id": 41467086, "comment_id": 70139833, "body": "agree with @MacroMan!"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1483543117, "post_id": 41467086, "comment_id": 70139946, "body": "No can do.  The entire code needs to be in the script so that it can be run on a blank new excel sheet."}, {"owner": {"reputation": 688, "user_id": 5878789, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22b3eb794027cc5e5eabc50b61a2ecfc?s=128&d=identicon&r=PG&f=1", "display_name": "tomdemaine", "link": "https://stackoverflow.com/users/5878789/tomdemaine"}, "edited": false, "score": 0, "creation_date": 1483543494, "post_id": 41467086, "comment_id": 70140207, "body": "But then the script must be adding the formula to your cells at some point. Make the script add macromans formula instead of the current one."}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1483543664, "post_id": 41467352, "comment_id": 70140322, "body": "Yes this is what I was looking for.  Thank you"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1483543481, "creation_date": 1483543481, "answer_id": 41467352, "question_id": 41467086, "link": "https://stackoverflow.com/questions/41467086/excel-vba-code-to-replace-string-in-range-of-cells/41467352#41467352", "title": "Excel VBA code to replace string in range of cells", "body": "<p>If you really need VBA to do this then you can use the <code>IsError()</code> function</p>\n\n<pre><code>Dim rngDiv As Range\nFor Each rngDiv In Range(\"E4:W10\")\n    If IsError(rngDiv) Then\n        rngDiv.Value = \"NA\"\n    End If\nNext\n</code></pre>\n\n<p>However it's best to catch your errors in the actual formula rather than afterwards with VBA.</p>\n\n<hr>\n\n<p><strong>Note:</strong> The above will catch <strong>all</strong> errors - if you just want the <code>#DIV/0!</code> error then you need to test for the <code>.Text</code> property instead of the <code>.Value</code> property:</p>\n\n<pre><code>Dim rngDiv As Range\nFor Each rngDiv In Range(\"E4:W10\")\n    If rngDiv.Text = \"#DIV/0!\" Then\n        rngDiv.Value = \"NA\"\n    End If\nNext rngDiv\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1483543695, "post_id": 41467354, "comment_id": 70140341, "body": "Strangely enough - I was actually going to link to <a href=\"http://www.mrexcel.com/forum/excel-questions/703597-xl2003-visual-basic-applications-replacing-div-0-error-string.html#post3474780\" rel=\"nofollow noreferrer\">an old post of yours...</a>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1483543482, "creation_date": 1483543482, "answer_id": 41467354, "question_id": 41467086, "link": "https://stackoverflow.com/questions/41467086/excel-vba-code-to-replace-string-in-range-of-cells/41467354#41467354", "title": "Excel VBA code to replace string in range of cells", "body": "<p>How about:</p>\n\n<pre><code>Sub marine()\n    Dim rngDiv As Range\n    For Each rngDiv In Range(\"E4:W10\")\n        If rngDiv.Text = \"#DIV/0!\" Then\n            rngDiv.Value = \"NA\"\n        End If\n    Next rngDiv\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "accepted_answer_id": 41467352, "answer_count": 2, "score": 0, "last_activity_date": 1483543482, "creation_date": 1483542707, "last_edit_date": 1531161705, "question_id": 41467086, "link": "https://stackoverflow.com/questions/41467086/excel-vba-code-to-replace-string-in-range-of-cells", "title": "Excel VBA code to replace string in range of cells", "body": "<p>I am trying to add code that will search for the string #DIV/0! in a range of cells (EF:W10) and if found, will replace that cell with NA.  Below is what I have, but it is not quite working.  What am I missing?</p>\n\n<pre><code>Dim rngDiv As Range\nFor Each rngDiv In Range(\"E4:W10\")\n    If InStr(rngDiv.Value, \"#DIV/0!\") &gt; 0 Then\n        rngDiv.Value = \"NA\"\n    End If\nNext rngDiv\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba", "vsto", "excel-addins"], "comments": [{"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 2, "creation_date": 1483542362, "post_id": 41466908, "comment_id": 70139500, "body": "<i>&quot;and it shows me it as a COM add-in...I don&#39;t want to create a COM add-in i want Excel plugin&quot;</i> - sorry to pop your balloon but add-ins created via VSTO <i>are</i> COM add-ins as far as Excel is concerned."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7374757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I-yDkLKrEaI/AAAAAAAAAAI/AAAAAAAAH1U/sJdWklzRbrs/photo.jpg?sz=128", "display_name": "Keyur Patel", "link": "https://stackoverflow.com/users/7374757/keyur-patel"}, "edited": false, "score": 0, "creation_date": 1483594773, "post_id": 41466983, "comment_id": 70161462, "body": "Is there any way to make the excel add-in in c# not in VBA?, because i already have vba excel add-in."}, {"owner": {"reputation": 143226, "user_id": 993547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aOivq.jpg?s=128&g=1", "display_name": "Patrick Hofman", "link": "https://stackoverflow.com/users/993547/patrick-hofman"}, "reply_to_user": {"reputation": 33, "user_id": 7374757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I-yDkLKrEaI/AAAAAAAAAAI/AAAAAAAAH1U/sJdWklzRbrs/photo.jpg?sz=128", "display_name": "Keyur Patel", "link": "https://stackoverflow.com/users/7374757/keyur-patel"}, "edited": false, "score": 0, "creation_date": 1483618193, "post_id": 41466983, "comment_id": 70174210, "body": "Well, yes. Create the add-in as you did from Visual Studio and code from there. There are some pretty good tutorials that helped me out. Just search Google on <i>VSTO C#</i> and you will find plenty of them (primarily the MSDN resources are useful)."}], "tags": [], "owner": {"reputation": 143226, "user_id": 993547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aOivq.jpg?s=128&g=1", "display_name": "Patrick Hofman", "link": "https://stackoverflow.com/users/993547/patrick-hofman"}, "is_accepted": true, "score": 3, "last_activity_date": 1483542362, "creation_date": 1483542362, "answer_id": 41466983, "question_id": 41466908, "link": "https://stackoverflow.com/questions/41466908/excel-add-in-is-being-shown-as-a-com-add-in/41466983#41466983", "title": "Excel add-in is being shown as a COM add-in", "body": "<p>A VSTO Office add-in <em>is</em> a COM add-in by definition. That is how Microsoft implemented it. They have built a bridge from .NET to the native Microsoft Office code using COM.</p>\n\n<p>If you want an XLAM add-in, as you say, you need to go through <a href=\"https://support.office.com/en-us/article/Add-or-remove-add-ins-64d3d147-98fb-4b82-8833-709d54e3ace1?ui=en-US&amp;rs=en-US&amp;ad=US&amp;fromAR=1#bmexceladdin\" rel=\"nofollow noreferrer\">this reference</a>, which doesn't involve creating a Visual Studio VSTO project.</p>\n"}], "owner": {"reputation": 33, "user_id": 7374757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I-yDkLKrEaI/AAAAAAAAAAI/AAAAAAAAH1U/sJdWklzRbrs/photo.jpg?sz=128", "display_name": "Keyur Patel", "link": "https://stackoverflow.com/users/7374757/keyur-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 41466983, "answer_count": 1, "score": -1, "last_activity_date": 1483542507, "creation_date": 1483542070, "last_edit_date": 1483542507, "question_id": 41466908, "link": "https://stackoverflow.com/questions/41466908/excel-add-in-is-being-shown-as-a-com-add-in", "title": "Excel add-in is being shown as a COM add-in", "body": "<p>I want to build an excel add-in which is application level. I followed the instructions to create a project on <a href=\"https://msdn.microsoft.com/en-GB/library/cc668205.aspx\" rel=\"nofollow noreferrer\">MSDN</a>.</p>\n\n<p>I don't want to create a COM add-in, I want an Excel plugin. The plugin we create as .xlam file and code it in VBA.</p>\n\n<p>Please suggest me what to do. How to deploy the .vsto file and patch up with the .xlam file?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6853737, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f660a8497833b1d3429557227dd1e898?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelMonkey19", "link": "https://stackoverflow.com/users/6853737/excelmonkey19"}, "edited": false, "score": 0, "creation_date": 1483549496, "post_id": 41468202, "comment_id": 70144504, "body": "So I&#39;ve tried running this now but I am getting a failure at      .Width = 350  It is saying it has failed at this section for a few of the charts. I don&#39;t know why."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "reply_to_user": {"reputation": 23, "user_id": 6853737, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f660a8497833b1d3429557227dd1e898?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelMonkey19", "link": "https://stackoverflow.com/users/6853737/excelmonkey19"}, "edited": false, "score": 0, "creation_date": 1483550086, "post_id": 41468202, "comment_id": 70144916, "body": "Also, does it work when you comment out <code>.InsideLeft</code>?  I&#39;m guessing it&#39;s unrelated."}, {"owner": {"reputation": 23, "user_id": 6853737, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f660a8497833b1d3429557227dd1e898?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelMonkey19", "link": "https://stackoverflow.com/users/6853737/excelmonkey19"}, "edited": false, "score": 0, "creation_date": 1483623716, "post_id": 41468202, "comment_id": 70178170, "body": "you were right it was an unrelated issue that occurred when the ActieChart portion was removed but i found a fix for it. Thanks!"}], "tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": true, "score": 0, "last_activity_date": 1483545770, "creation_date": 1483545770, "answer_id": 41468202, "question_id": 41466846, "link": "https://stackoverflow.com/questions/41466846/chart-data-table-sizing-issue/41468202#41468202", "title": "Chart Data Table Sizing Issue", "body": "<p>I was able to duplicate your problem using Excel 2010 by recording a macro while moving the plot area.  When running the recorded macro the data table legend resized and text wrapped.  I was not able to find any direct handle for the data table legend but did find that both <code>.Left</code> and <code>.InsideLeft</code> affect word wrapping.</p>\n\n<p>Here is your code, <em>modified a little to remove all <code>Active</code> statements.</em></p>\n\n<pre><code>Sub Color_Loop_Series()\n    Dim sht As Worksheet\n    Dim CurrentSheet As Worksheet\n    Dim cht As ChartObject\n    Dim ser As Series\n\n    For Each sht In ActiveWorkbook.Worksheets\n        For Each cht In sht.ChartObjects\n            With cht.Chart\n                .ChartType = xlLineMarkers\n                .Legend.Position = xlLegendPositionBottom\n                .Legend.Font.Size = 9\n                .DataTable.Font.Size = 5.5\n                .Axes(xlValue).AxisTitle.Position = xlAxisPositionLeft\n            End With\n\n            With cht.Chart.PlotArea\n                .Width = 380\n                .Height = 250\n                .Left = 11\n                .Top = 3\n                .InsideLeft = 80    '&lt;- Adjust this value\n            End With\n        Next cht\n    Next sht\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Results when using <code>.InsideLeft</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/pqoWf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pqoWf.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Results when not using <code>.InsideLeft</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/6L3Sj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6L3Sj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 6853737, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f660a8497833b1d3429557227dd1e898?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelMonkey19", "link": "https://stackoverflow.com/users/6853737/excelmonkey19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 0, "accepted_answer_id": 41468202, "answer_count": 1, "score": 1, "last_activity_date": 1483545770, "creation_date": 1483541902, "question_id": 41466846, "link": "https://stackoverflow.com/questions/41466846/chart-data-table-sizing-issue", "title": "Chart Data Table Sizing Issue", "body": "<p>I am running a macro to resize my plot area to make all graphs uniform within a report. However, when resizing the plot area the Chart Data Table resizes as well and the Labels for the rows in the Data Table become text wrapped. This issue is fixed if I manually resize the Plot Area slightly and then the text is fixed and is autofit and no longer text wrapped to take up three or four lines. Any way to fix this? This is my current code.</p>\n\n<pre><code>Sub Color_Loop_Series()\nDim sht As Worksheet\nDim CurrentSheet As Worksheet\nDim cht As ChartObject\nDim ser As Series\n\nFor Each sht In ActiveWorkbook.Worksheets\nFor Each cht In sht.ChartObjects\ncht.Activate\nActiveChart.ChartType = xlLineMarkers\nActiveChart.Legend.Position = xlLegendPositionBottom\nActiveChart.Legend.Font.Size = 9\nActiveChart.PlotArea.Select\nSelection.Width = 380\nSelection.Left = 11\nSelection.Top = 3\nSelection.Height = 250\nActiveChart.Axes(xlValue).AxisTitle.Position = xlAxisPositionLeft\nActiveChart.DataTable.Font.Size = 5.5\nNext cht\nNext sht\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "option"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7327319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f364aebd2cbf9367f947f427027b7902?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Taylor", "link": "https://stackoverflow.com/users/7327319/josh-taylor"}, "edited": false, "score": 0, "creation_date": 1483628495, "post_id": 41468069, "comment_id": 70181651, "body": "Thanks for your response, although i altered my code to the solution and i still get the same error."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 1, "user_id": 7327319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f364aebd2cbf9367f947f427027b7902?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Taylor", "link": "https://stackoverflow.com/users/7327319/josh-taylor"}, "edited": false, "score": 0, "creation_date": 1483688608, "post_id": 41468069, "comment_id": 70207595, "body": "Could you replace the code with an <code>if...then</code> statement?"}], "tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": false, "score": 0, "last_activity_date": 1483545391, "creation_date": 1483545391, "answer_id": 41468069, "question_id": 41466780, "link": "https://stackoverflow.com/questions/41466780/run-time-error-2448-you-cant-assign-a-value-to-this-object-vba-access-op/41468069#41468069", "title": "Run-Time Error &#39;2448&#39;: You can&#39;t assign a value to this object - VBA/Access - option group", "body": "<p>I believe the error is that you have selected the value and not the field.</p>\n\n<p>hence the solution is:</p>\n\n<pre><code>Select Case ProgrammeF\ncase 1\n    programmeChoiceT.value =\"AM\"\n</code></pre>\n\n<p>Alternatively, if you want to select the value, then use and <code>if...then</code> statement.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7914888, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5267466d04da5c3452ed82565570a4f6?s=128&d=identicon&r=PG", "display_name": "JMM", "link": "https://stackoverflow.com/users/7914888/jmm"}, "is_accepted": false, "score": 0, "last_activity_date": 1493050922, "creation_date": 1493050922, "answer_id": 43593221, "question_id": 41466780, "link": "https://stackoverflow.com/questions/41466780/run-time-error-2448-you-cant-assign-a-value-to-this-object-vba-access-op/43593221#43593221", "title": "Run-Time Error &#39;2448&#39;: You can&#39;t assign a value to this object - VBA/Access - option group", "body": "<p>Does the field that you're saving the value into have a dropdown with multiple columns in it? I wonder if the error you received was due to the options in the drop-down field not having multiple columns involved. The numeric option would be the bound column, and the values for those options would be a second column. You can change the column widths so that just the text values show, but the numeric values are saved. </p>\n"}], "owner": {"reputation": 1, "user_id": 7327319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f364aebd2cbf9367f947f427027b7902?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Taylor", "link": "https://stackoverflow.com/users/7327319/josh-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1709, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1493050922, "creation_date": 1483541691, "question_id": 41466780, "link": "https://stackoverflow.com/questions/41466780/run-time-error-2448-you-cant-assign-a-value-to-this-object-vba-access-op", "title": "Run-Time Error &#39;2448&#39;: You can&#39;t assign a value to this object - VBA/Access - option group", "body": "<p>I am using an option group for a student to select the programme they are studying. Once selected a textbox named ProgrammeChoiceT has its value set to the ProgrammeID, with a control source set to the ProgrammeID.</p>\n\n<p>This is all done so that the ProgrammeID can be stored not as the default option group values of 1-3. However it does not work and this error appears:</p>\n\n<p><strong>Run-Time Error '2448': You can't assign a value to this object</strong></p>\n\n<p>When i remove the control source, the ProgrammeChoiceT.Value of the textbox changes to \"AM\", it is only when the control source is set the error appears. </p>\n\n<p>How do i fix this?</p>\n\n<p>Code is shown below:</p>\n\n<pre><code>Private Sub ProgrammeF_AfterUpdate()\n\n Select Case ProgrammeF.Value\n  Case 1\n    ProgrammeChoiceT.Value = \"AM\"\n  Case 2\n    ProgrammeChoiceT.Value = \"FM\"\n  Case 3\n    ProgrammeChoiceT.Value = \"HRM\"\nEnd Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1483541839, "post_id": 41466726, "comment_id": 70139164, "body": "How often is this run, could it be an issue with IE itself, long script, messagebox showing or something.  Do task manager, check on the IE being still active.  Perhaps, try grabbing an open IE first, using error trapping to create one, if one isn&#39;t open?  Try a doevnts after the quit"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1483541873, "post_id": 41466726, "comment_id": 70139190, "body": "Does <code>Set IE = New InternetExplorerMedium</code> work? or maybe <code>Set IE = CreateObject(&quot;InternetExplorer.Application&quot;)</code>?  Also, when you mean after continuous use, do you mean you run the sub once, and it loops a lot, and gives an error? Or it runs once, all the way through, and when you run it again it&#39;ll error?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1483542337, "post_id": 41466726, "comment_id": 70139489, "body": "If you are running this code at high frequency, you might want to cache the IE object and not create one every time. If I remember well the InternetExplorer object takes time to be destroyed after the Quit and may keep using resources even after the end of the function, blocking next creations."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483542566, "post_id": 41466726, "comment_id": 70139614, "body": "Is that the correct error code? My headers say that&#39;s <code>ERROR_SHUTDOWN_IS_SCHEDULED</code>."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1483542648, "post_id": 41466726, "comment_id": 70139661, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/27626253/excel-vba-force-shutdown-ie\">Excel VBA force shutdown IE</a>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1483542685, "post_id": 41466726, "comment_id": 70139689, "body": "You need to add <code>Set IE = Nothing</code> after <code>IE.Quit</code>"}, {"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1483543016, "post_id": 41466726, "comment_id": 70139881, "body": "@Nathan_Sav I click every two seconds on various buttons which are linked these macro, always the same code, but with different target cells, now you can see &quot;D2&quot; and &quot;D3&quot;, another same code with &quot;D4&quot; and &quot;D5&quot; and so on... And after some click the error come out."}, {"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1483543351, "post_id": 41466726, "comment_id": 70140109, "body": "@BruceWayne No bruce just done, the first solution open a InternetExplorer window that i would like to remain closed and it gave me another kind of error: &quot;Class doesn&#39;t support Automation (Error 430)&quot;, on this line: &quot;Loop Until IE.readyState = READYSTATE_COMPLETE&quot;. The second solution gave me the same error of the question."}, {"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1483543760, "post_id": 41466726, "comment_id": 70140382, "body": "@VincentG Yeah, i&#39;ve read the same thing on internet and in fact after a few seconds or minutes the code back to work, but i need to use it 12 times in a span of a few seconds. After that i can also wait several minutes because i have to analyze the data extracted on my Excel document, the problem is only those 12 clicks."}, {"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1483544555, "post_id": 41466726, "comment_id": 70140933, "body": "@RobinMackenzie yeah Robin the error is the same, but if i add <code>Set IE = Nothing</code> the error remain :("}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1483544825, "post_id": 41466726, "comment_id": 70141141, "body": "You can cache the IE object instead of destroying it and creating a new one each time."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1483544993, "post_id": 41466726, "comment_id": 70141264, "body": "Look at using <code>CreateObject</code> and <code>GetObject</code> with some error trapping, so you only open &amp; close 1 instance of IE, just navigate/refresh each time, so the 1st time will take a shade longer, the other 11 will be quicker."}, {"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1483545076, "post_id": 41466726, "comment_id": 70141304, "body": "@VincentG How can i do this? if i close and open again the excel file i can&#39;t use the marco the error still there :("}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1483545591, "post_id": 41466726, "comment_id": 70141674, "body": "Since there is no <code>Dim IE ...</code> in your code I think it is defined as a global variable somewhere? If so just check for <code>Nothing</code> and create a new instance only if needed. <code>If IE is Nothing Then Set IE = New InternetExplorer</code>"}, {"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1483545677, "post_id": 41466726, "comment_id": 70141735, "body": "@Nathan_Sav Ehi, i&#39;ve put  <code>Set IE = Nothing</code> after <code>IE.Quit</code> only in the 1/12 of my macro code and it&#39;s seem to work, now I will do other tests to see if the problem is really solved. Unfortunately i can not make many consecutive tests because excel crash constantly."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1483548403, "post_id": 41466726, "comment_id": 70143775, "body": "Your loop is not checking for IE.Busy, Loop Until IE.readyState = READYSTATE_COMPLETE and not ie.busy you could try also."}, {"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1483548778, "post_id": 41466726, "comment_id": 70144040, "body": "@Nathan_Sav Ok, but the crash is due to the fact that the links generated by the macro executions are taken and used by Dynamic Web Query and when the and when queries calculate Excel crash"}, {"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1483560431, "post_id": 41466726, "comment_id": 70150437, "body": "@Nathan_Sav Unfortunately the problem persists, 2 clicks are ok but on the 3rd there is the problem, always on the 3rd :("}, {"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "edited": false, "score": 0, "creation_date": 1483640562, "post_id": 41466726, "comment_id": 70189885, "body": "do you think is so important here to IE like a global variable? The macro run also without"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "edited": false, "score": 0, "creation_date": 1483650879, "post_id": 41491892, "comment_id": 70195658, "body": "x_X with that modification there aren&#39;t errors but the macro&#39;s don&#39;t respond"}], "tags": [], "owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "is_accepted": false, "score": 0, "last_activity_date": 1483652463, "last_edit_date": 1483652463, "creation_date": 1483639950, "answer_id": 41491892, "question_id": 41466726, "link": "https://stackoverflow.com/questions/41466726/how-do-i-solve-this-run-time-error-2147023706-800704a6/41491892#41491892", "title": "How do i solve this &quot;Run-Time Error &#39;-2147023706 (800704a6)&quot;?", "body": "<p>I found this solution on the internet and <strong>it works</strong> by the moment, do you think is it right?</p>\n\n<pre><code>Sub EstrazDati_A_ieri()\nOn Error Resume Next\n\nDim doc As HTMLDocument\nDim output As Object\n\nSet IE = New InternetExplorer\nIE.Visible = False\nIE.navigate Range(\"D2\")\n\nDo\n    DoEvents\n    Loop Until IE.readyState = READYSTATE_COMPLETE\n\nSet doc = IE.document\nSet output = doc.getElementsByTagName(\"a\")\n\nFor Each link In output\n    If link.innerHTML = \"Main\" Then\n        Range(\"D3\").Value2 = link\n    End If\n\nNext\nIE.Quit\nSet IE = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT :</strong> Now i've tried in this way</p>\n\n<pre><code>Sub EstrazDati_A_ieri()\nDim IE As Object\nDim doc As HTMLDocument\nDim output As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = False\nIE.navigate Range(\"D2\")\n\nDo\n    DoEvents\n    Loop Until IE.readyState = READYSTATE_COMPLETE\n\nSet doc = IE.document\nSet output = doc.getElementsByTagName(\"a\")\n\nFor Each link In output\n    If link.innerHTML = \"Main\" Then\n        Range(\"D3\").Value2 = link\n    End If\n\nNext\nIE.Quit\nSet IE = Nothing\nEnd Sub\n</code></pre>\n\n<p>But after the eighth run of these macro's ERROR :(</p>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "is_accepted": false, "score": 0, "last_activity_date": 1483746534, "creation_date": 1483746534, "answer_id": 41516208, "question_id": 41466726, "link": "https://stackoverflow.com/questions/41466726/how-do-i-solve-this-run-time-error-2147023706-800704a6/41516208#41516208", "title": "How do i solve this &quot;Run-Time Error &#39;-2147023706 (800704a6)&quot;?", "body": "<pre><code>Sub EstrazDati_A_ieri()\nDim IE As Object\nDim doc As HTMLDocument\nDim output As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.navigate Range(\"D2\")\n\nDo\n    DoEvents\n    Loop Until IE.readyState = READYSTATE_COMPLETE\n\nSet doc = IE.document\nSet output = doc.getElementsByTagName(\"a\")\n\nFor Each link In output\n    If link.innerHTML = \"Main\" Then\n        Range(\"D3\").Value2 = link\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p><strong>Ok Guys! in this way no error.</strong> The problem is just that i would not open up a new web page every time but i would used the same, because i have to run this macro repeatedly for 12 times.\nHow can i modify this line of code?</p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7343082, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cznwO.png?s=128&g=1", "display_name": "ALIENATO", "link": "https://stackoverflow.com/users/7343082/alienato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1916, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1483746534, "creation_date": 1483541524, "question_id": 41466726, "link": "https://stackoverflow.com/questions/41466726/how-do-i-solve-this-run-time-error-2147023706-800704a6", "title": "How do i solve this &quot;Run-Time Error &#39;-2147023706 (800704a6)&quot;?", "body": "<p>i have a big problem with this code:</p>\n\n<pre><code>Sub EstrazDati_A_ieri()\n\nDim doc As HTMLDocument\nDim output As Object\n\nSet IE = New InternetExplorer\nIE.Visible = False\nIE.navigate Range(\"D2\")\n\nDo\n    DoEvents\n    Loop Until IE.readyState = READYSTATE_COMPLETE\n\nSet doc = IE.document\nSet output = doc.getElementsByTagName(\"a\")\n\nFor Each link In output\n    If link.innerHTML = \"Main\" Then\n        Range(\"D3\").Value2 = link\n    End If\n\nNext\nIE.Quit\n\nEnd Sub\n</code></pre>\n\n<p>The code is correct and it works, but sometimes after a continuous use of itself a Windows box appear with a Run-Time Error on this line:</p>\n\n<pre><code>Set IE = New InternetExplorer\n</code></pre>\n\n<p>I have already tested several solutions found on the internet but i couldn't fix it.</p>\n\n<p>p.s. I'm an Italian boy sorry for the bad English :)</p>\n"}, {"tags": ["python", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 7267457, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea371989d65e97bf2f250d7bff7059fd?s=128&d=identicon&r=PG&f=1", "display_name": "M Kaye", "link": "https://stackoverflow.com/users/7267457/m-kaye"}, "edited": false, "score": 0, "creation_date": 1483550890, "post_id": 41466811, "comment_id": 70145383, "body": "Is there a way to preferably do this via VBA at all?"}], "tags": [], "owner": {"reputation": 49388, "user_id": 6779307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7O3q.jpg?s=128&g=1", "display_name": "Patrick Haugh", "link": "https://stackoverflow.com/users/6779307/patrick-haugh"}, "is_accepted": true, "score": 2, "last_activity_date": 1483541814, "creation_date": 1483541814, "answer_id": 41466811, "question_id": 41466714, "link": "https://stackoverflow.com/questions/41466714/run-python-from-vba-in-other-directory/41466811#41466811", "title": "Run Python from VBA in other directory", "body": "<p>Use <code>os.chdir</code> to change the current working directory of your python script</p>\n\n<pre><code>import os\n\nos.chdir(r'I:\\Forecasting Model')\n\nimport Forecast\n\n#... more code\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 7267457, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea371989d65e97bf2f250d7bff7059fd?s=128&d=identicon&r=PG&f=1", "display_name": "M Kaye", "link": "https://stackoverflow.com/users/7267457/m-kaye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 41466811, "answer_count": 1, "score": 0, "last_activity_date": 1483541814, "creation_date": 1483541498, "last_edit_date": 1531164843, "question_id": 41466714, "link": "https://stackoverflow.com/questions/41466714/run-python-from-vba-in-other-directory", "title": "Run Python from VBA in other directory", "body": "<p>I am trying to run a python script from VBA and all works fine now as the excel file is in the same directory as the python script, my code is :</p>\n\n<pre><code>Sub forecast()\n    RunPython (\"import Forecast; Forecast.data_forecast()\")\nEnd Sub\n</code></pre>\n\n<p>However I now want to move the excel file to a separate path and can't figure out how to direct it to the correct path ('I:\\Forecasting Model') despite looking at numerous other posts.</p>\n\n<p>Thanks in advance, Max</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1483542097, "creation_date": 1483542097, "answer_id": 41466918, "question_id": 41466632, "link": "https://stackoverflow.com/questions/41466632/positioning-the-cursor-mouse-tip-using-vba/41466918#41466918", "title": "Positioning the cursor/mouse tip using VBA", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms648394%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">SetCursorPos</a> API for this, although the UX might be horrible if you don't put it back where you found it:</p>\n\n<pre><code>Private Declare Sub SetCursorPos Lib \"user32.dll\" (x As Long, y As Long)\n\nSub Example()\n    SetCursorPos 0, 0\nEnd Sub\n</code></pre>\n\n<p>If you <em>do</em> want to restore the original location, just grab it with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms648390(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetCursorPos</a> first.</p>\n"}], "owner": {"reputation": 1, "user_id": 7374709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/936c21217e5bfbfd15ae58ec71bbae35?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/7374709/rafael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483542097, "creation_date": 1483541257, "question_id": 41466632, "link": "https://stackoverflow.com/questions/41466632/positioning-the-cursor-mouse-tip-using-vba", "title": "Positioning the cursor/mouse tip using VBA", "body": "<p>I am using Visual Basic for Applications, and in my program, I am opening Inventor parts and capturing thumbnails. I get undesirable results if the mouse tip is left hovering over the parts. I would like to be able to re-position the cursor such that it is well out of the way.</p>\n\n<p>Any VBA code that accomplishes this along with the required references would be much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5250115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb20fba95cf9b7d62d591b2c975b7935?s=128&d=identicon&r=PG&f=1", "display_name": "TTiT", "link": "https://stackoverflow.com/users/5250115/ttit"}, "edited": false, "score": 0, "creation_date": 1484128288, "post_id": 41466639, "comment_id": 70378824, "body": "I get the same error. That macros of the opened file are deactivated. The user just get ask to activate the macros if the Programming Window of excel is open but the normal user will not have open is Window.."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1483541276, "creation_date": 1483541276, "answer_id": 41466639, "question_id": 41466414, "link": "https://stackoverflow.com/questions/41466414/run-a-marko-in-a-second-excel-file/41466639#41466639", "title": "Run a marko in a second Excel file", "body": "<p>You need to use the filename without the path when you're building the function name to pass to <code>Application.Run</code>:</p>\n\n<pre><code>Dim wb As Workbook\nSet wb = Workbooks.Open(excelPath)\nApplication.Run wb.Name &amp; \"!RequestFunc\", String1, String2\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5250115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb20fba95cf9b7d62d591b2c975b7935?s=128&d=identicon&r=PG&f=1", "display_name": "TTiT", "link": "https://stackoverflow.com/users/5250115/ttit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483541276, "creation_date": 1483540606, "question_id": 41466414, "link": "https://stackoverflow.com/questions/41466414/run-a-marko-in-a-second-excel-file", "title": "Run a marko in a second Excel file", "body": "<p>I programming sth. in Excel vba that opens from a excel file a second excel file and call a function in the second excel file --> looks like that</p>\n\n<pre><code>Workbooks.Open excelPath \nApplication.Run(excelPath &amp; \"!RequestFunc\", String1, String2)\n</code></pre>\n\n<p>It works fine so far but the problem is I have to configure the macro security configurations that I always accept to use macros but this is not possible in my case.</p>\n\n<p>I need a solution where I can automatically active the macros in the second file or that the user get ask to activate them.&lt;-- If I have the Development IDE of MS-Excel open the user get ask but if the IDE is closed there is just an Error coming that the marcos are deactivated and its not possible to call this macro...</p>\n\n<p>Any ideas ?\nThanks a lot :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1483541573, "post_id": 41466405, "comment_id": 70138949, "body": "To make sure, as I can&#39;t see how you declare <code>sCol</code>, that&#39;s a letter, correct?"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1483541649, "post_id": 41466405, "comment_id": 70139009, "body": "Yes it is. It&#39;s passed in.  And End.Row finds the correct ending row."}], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 1, "last_activity_date": 1483541722, "creation_date": 1483541722, "answer_id": 41466791, "question_id": 41466405, "link": "https://stackoverflow.com/questions/41466405/does-pagesetup-printarea-only-work-on-activesheet/41466791#41466791", "title": "Does .PageSetup.PrintArea only work on Activesheet?", "body": "<p>Setting the print area in fact is the same as adding a sheet-level defined name called Print_Area, so you might use this instead of the .PageSetup.Printarea line:</p>\n\n<pre><code>                .Range(\"$\" &amp; sCol &amp; \"$8:$R$\" &amp; rEnd.Row).Name = \"'\" &amp; .Name &amp; \"'!Print_Area\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1483543759, "post_id": 41467220, "comment_id": 70140380, "body": "Ugh, didn&#39;t even see the &amp; before the 8...changed that to $ and it worked fine."}], "tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": true, "score": 1, "last_activity_date": 1483543096, "creation_date": 1483543096, "answer_id": 41467220, "question_id": 41466405, "link": "https://stackoverflow.com/questions/41466405/does-pagesetup-printarea-only-work-on-activesheet/41467220#41467220", "title": "Does .PageSetup.PrintArea only work on Activesheet?", "body": "<p>This gives me a valid PrintArea. Added surrounding quotes and removed extra ampersand.</p>\n\n<pre><code>.PageSetup.PrintArea = \"\" &amp; \"$\" &amp; sCol &amp; \"8:$R$\" &amp; rEnd.Row &amp; \"\"\n</code></pre>\n"}], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 41467220, "answer_count": 2, "score": 0, "last_activity_date": 1483543096, "creation_date": 1483540590, "question_id": 41466405, "link": "https://stackoverflow.com/questions/41466405/does-pagesetup-printarea-only-work-on-activesheet", "title": "Does .PageSetup.PrintArea only work on Activesheet?", "body": "<p>I have a loop that goes through all of the sheets in my workbook...and then sets the print area to whatever button was selected.  One button sets it to start at Col A, another Col C...etc.</p>\n\n<p>However, I'm getting a run time error 1004 saying that I've typed a formula wrong.  Using the immediate window, I can test that my print area IS what I want it to be.</p>\n\n<pre><code>With sheet\n  If .Name &lt;&gt; \"Index\" Then\n    Set rEnd = .Columns(\"A\").Find(\"END\", .[A8], xlValues, xlWhole, xlByRows, xlNext)\n    If rEnd Is Nothing Then\n      'Not Found - leave as is\n    Else\n      'Found\n      .PageSetup.PrintArea = \"$\" &amp; sCol &amp; \"&amp;8:$R$\" &amp; rEnd.Row  '&lt;---Fails here\n      SetZoom sheet, \"Report Print \"\"\" &amp; sCol &amp; \"\"\" Scale\"\n    End If\n  End If\nEnd With\n</code></pre>\n\n<p>Every example I've seen online shows it using ActiveSheet.  Does .PageSetup.PrintArea require ActiveSheet?  I'd rather not have to activate each sheet if I don't have to.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483540523, "post_id": 41466356, "comment_id": 70138189, "body": "What are you trying to iterate over?  <code>wb</code> is a Workbook."}], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1483540524, "creation_date": 1483540524, "answer_id": 41466380, "question_id": 41466356, "link": "https://stackoverflow.com/questions/41466356/object-does-not-support-this-property-or-method-in-vba/41466380#41466380", "title": "Object Does not support this property or method in VBA", "body": "<p><code>For Each ws_cnt In wb.Worksheets</code></p>\n\n<p>You need to specify the collection that you wish to iterate over, so in this instance it is the <code>wb.Worksheets</code> collection.</p>\n\n<p>Then you can just work with the worksheet.</p>\n\n<p><code>ws_cnt.Range(\"A1\").Copy</code></p>\n"}], "owner": {"reputation": 13, "user_id": 7349375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64252ca3c02727f0a5a4294cc20c8e88?s=128&d=identicon&r=PG&f=1", "display_name": "Sudharshan", "link": "https://stackoverflow.com/users/7349375/sudharshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 0, "accepted_answer_id": 41466380, "answer_count": 1, "score": 0, "last_activity_date": 1483540524, "creation_date": 1483540436, "last_edit_date": 1483540484, "question_id": 41466356, "link": "https://stackoverflow.com/questions/41466356/object-does-not-support-this-property-or-method-in-vba", "title": "Object Does not support this property or method in VBA", "body": "<p>I am working on a code that will collate data from multiple workbooks in a folder in to one single sheet.\nNow, I am trying to make the code read through all the worksheets in the workbooks with the below code. I get the error - \"Object Doesnt support this property or method\" in the highlighted line.</p>\n\n<pre><code>For Each objFile In objFolder.Files\n\nRowCount = ws1.UsedRange.Rows.Count\n\nIf objFile.Type = \"Microsoft Excel Worksheet\" Or objFile.Type = \"Microsoft Excel Macro-Enabled Worksheet\" Then\n\nSet wb = Application.Workbooks.Open(path &amp; objFile.Name)\n\nFor Each ws_cnt In wb '&lt;---Error here.\n\nSet srWS = wb.Sheets(1)\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1483899064, "creation_date": 1483899064, "answer_id": 41536054, "question_id": 41466035, "link": "https://stackoverflow.com/questions/41466035/visual-basic-edit-word-documents-in-bulk/41536054#41536054", "title": "Visual Basic edit Word documents in bulk", "body": "<p>Look into <a href=\"http://www.officetooltips.com/word/tips/using_wildcards.html\" rel=\"nofollow noreferrer\">Using wildcards</a> and test the pattern in word first. For example (not tested):</p>\n\n<pre><code>With Doc.Range.Find\n    .MatchWildcards = True\n    .Text = \"&lt;(?*)&gt;\\-&lt;(?*)&gt;\\-&lt;(?*)&gt;\"\n    .Replacement.Text = \"\\1\\2\\3\" 'Replace With\n    ' ... the rest of the options\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 4869373, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/0a1416979ed535a2bbace4ad69d29b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Donald", "link": "https://stackoverflow.com/users/4869373/donald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 402, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1483899064, "creation_date": 1483539540, "last_edit_date": 1483897141, "question_id": 41466035, "link": "https://stackoverflow.com/questions/41466035/visual-basic-edit-word-documents-in-bulk", "title": "Visual Basic edit Word documents in bulk", "body": "<p>I have hundreds of docx-documents which I would like to edit in bulk with a visual basic macro. They all share an id on the first line which looks like this:</p>\n\n<pre><code>9-ZKB-S\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>12-JK-17\n</code></pre>\n\n<p>I would like to remove the '-' from the id so it will become like this:</p>\n\n<pre><code>9ZKBS\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>12JK17\n</code></pre>\n\n<p>Then somewhere in the document I have a word followed by a number like this:</p>\n\n<pre><code>Productionnumber. 42-563-12\n</code></pre>\n\n<p>And I also would like to remove the minus character:</p>\n\n<pre><code>Productionnumber. 4256312\n</code></pre>\n\n<p>I've found a visual basic script which enables me to select a folder containing word-documents and to perform a search and replace. But I don't know how to do the specific things I've mentioned such as:</p>\n\n<ul>\n<li>In each document, remove the - and the space between characters on the first line</li>\n<li><p>In each document, remove the - and the space between characters after <em>Productionnumber.</em></p>\n\n<pre><code>Sub CommandButton1_Click()\nDim MyDialog As FileDialog, GetStr(1 To 500) As String '100 files is the    maximum applying this code\nOn Error Resume Next\nSet MyDialog = Application.FileDialog(msoFileDialogFilePicker)\nWith MyDialog\n.Filters.Clear\n.Filters.Add \"All WORD File \", \"*.docx\", 1\n.AllowMultiSelect = True\ni = 1\nIf .Show = -1 Then\nFor Each stiSelectedItem In .SelectedItems\nGetStr(i) = stiSelectedItem\ni = i + 1\nNext\ni = i - 1\nEnd If\nApplication.ScreenUpdating = False\nFor j = 1 To i Step 1\nSet Doc = Documents.Open(FileName:=GetStr(j), Visible:=True)\nWindows(GetStr(j)).Activate\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nWith Selection.Find\n.Text = \"search\" 'Find What\n.Replacement.Text = \"find\" 'Replace With\n.Forward = True\n.Wrap = wdFindAsk\n.Format = False\n.MatchCase = False\n.MatchWholeWord = False\n.MatchByte = True\n.MatchWildcards = False\n.MatchSoundsLike = False\n.MatchAllWordForms = False\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\nApplication.Run macroname:=\"NEWMACROS\"\nActiveDocument.Save\nActiveWindow.Close\nNext\nApplication.ScreenUpdating = True\nEnd With\nMsgBox \"operation end, please view\", vbInformation\nEnd Sub\n</code></pre></li>\n</ul>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483539598, "post_id": 41465747, "comment_id": 70137504, "body": "I should have added that the macro copies an Excel template and produces one workbook for each country in the list in Countries worksheet."}, {"owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1483539781, "post_id": 41465747, "comment_id": 70137638, "body": "Have you tried with this <a href=\"http://stackoverflow.com/questions/12936646/how-to-insert-a-picture-into-excel-at-a-specified-cell-position-with-vba\" title=\"how to insert a picture into excel at a specified cell position with vba\">stackoverflow.com/questions/12936646/&hellip;</a>"}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "reply_to_user": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1483540279, "post_id": 41465747, "comment_id": 70138026, "body": "Yes, thank you Maxime - I had seen that, but it&#39;s a different problem - my picture inserts at the correct cell location. I cannot get the loop to work."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483540394, "post_id": 41466158, "comment_id": 70138110, "body": "The problem with Shapes is that it places the picture at an absolute location, which I don&#39;t want, because the cells above the absolute location will expand when text is entered and the picture needs to move with the cell."}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483540416, "post_id": 41466158, "comment_id": 70138125, "body": "Also please I am asking about the looping, not the location."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483540860, "post_id": 41466158, "comment_id": 70138421, "body": "is the source folder always <code>&quot;C:\\temp\\profiles\\2017\\Maps\\EN JPGs</code> and the pic name always <code>countryName_En.jpg</code>,with <code>countryName</code> part variable and equal to the sheet name?"}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483541281, "post_id": 41466158, "comment_id": 70138734, "body": "The folders will change, but that&#39;s easy to manage. Also the filename conventions for the JPGs and XLSXs aren&#39;t identical, but I guess I could make them identical and manage the differences through the folders."}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483543967, "post_id": 41466158, "comment_id": 70140531, "body": "Thanks 3598756! That has got me moving forward again!"}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483545198, "post_id": 41466158, "comment_id": 70141393, "body": "But a problem still :-( although the Range starts at A2, it is reading the values from the header row A1"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483546075, "post_id": 41466158, "comment_id": 70142009, "body": "see little edit: <code>.Range(&quot;A2&quot;, .Cells(.Rows.Count).End(xlUp)</code> -&gt; <code>.Range(&quot;A2&quot;, .Cells(.Rows.Count, 1).End(xlUp)</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483547571, "post_id": 41466158, "comment_id": 70143164, "body": "@cdfj, did it fix it up?"}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1483604541, "post_id": 41466158, "comment_id": 70165625, "body": "Hi @user3598756 - yes, thank you so much, it&#39;s great! But it was not clearing the preceding map in the loop and they were accumulating in each new workbook. So I added <code>ActiveSheet.Shapes.SelectAll</code> <code>Selection.Delete</code> before <code>ActiveSheet.Pictures.Insert</code>. Again, many thanks!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1483546040, "last_edit_date": 1483546040, "creation_date": 1483539866, "answer_id": 41466158, "question_id": 41465747, "link": "https://stackoverflow.com/questions/41465747/loop-to-insert-picture-in-correspondingly-named-workbook/41466158#41466158", "title": "Loop to insert picture in correspondingly named workbook", "body": "<p>edited after OP's clarifications</p>\n\n<p>you may want to try this refactored code:</p>\n\n<pre><code>Option Explicit\n\nSub SaveCountryYear_XLSX_English_map()\n\n    Dim wbName As String\n    Dim MapPath As String 'Not used in example below\n    Dim MapName As String 'Not used in example below\n    Dim index As Integer  'Not used in example below\n    Dim cell As Range\n\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n\n    With Worksheets(\"Countries\") '&lt;--| reference \"Countries\" worksheet of your currently active workbook\n        For Each cell In .Range(\"A2\", .Cells(.Rows.Count, 1).End(xlUp)).SpecialCells(XlCellType.xlCellTypeConstants, xlTextValues) '&lt;--| loop through referenced worksheet column A cells filled with some text from A2 down to last not empty one\n\n        '1. Enter country name and year in User Form worksheet cells B2 and B3.\n\n            Worksheets(\"User Form\").Range(\"B2\").value = cell.value '&lt;--| name is in current cell\n            Worksheets(\"User Form\").Range(\"B3\").value = cell.Offset(, 1).value '&lt;--| date is in adjacent cell\n\n        '2. Enter country population and income level in Countries worksheet cells B1 and E1.\n\n            Worksheets(\"Table\").Range(\"B1\").value = cell.Offset(, 2).value '&lt;--| population is in cell two columns right of current one\n            Worksheets(\"Table\").Range(\"E1\").value = cell.Offset(, 3).value '&lt;--| income level is in cell three columns right of current one\n\n\n        '3. Insert country map JPG in User Form worksheet at cell A18\n        '(cannot get this to loop!).\n        'The following is just an example - it works,\n        'but without loop of course (inserts the named file correctly).\n\n            Worksheets(\"User Form\").Activate\n            Range(\"A18\").Select\n            ActiveSheet.Pictures.Insert _\n                \"C:\\temp\\profiles\\2017\\Maps\\EN JPGs\\\" _\n                &amp; cell.value &amp; \"_EN.jpg\"\n\n\n        '4. Save the workbook as CountryName.xlxs.\n            Worksheets.Copy '&lt;--| copy current workbook worksheets to a new workbook\n            ActiveWorkbook.SaveAs Filename:=\"C:\\temp\\profiles\\2017\\Production\\Batch_EN_1\\\" _\n                &amp; wbName &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n            ActiveWorkbook.Close\n        Next cell\n\n    End With\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>where:</p>\n\n<ul>\n<li><p>you have to adapt: </p>\n\n<pre><code>ActiveSheet.Pictures.Insert _\n        \"C:\\temp\\profiles\\2017\\Maps\\EN JPGs\\\" _\n        &amp; cell.value &amp; \"_EN.jpg\"\n</code></pre>\n\n<p>to your actual filenames and source path conventions</p></li>\n<li><p>I changed section 4 (Save the workbook as CountryName.xlxs)</p></li>\n</ul>\n"}], "owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 0, "accepted_answer_id": 41466158, "answer_count": 1, "score": 0, "last_activity_date": 1488691317, "creation_date": 1483538737, "last_edit_date": 1488691317, "question_id": 41465747, "link": "https://stackoverflow.com/questions/41465747/loop-to-insert-picture-in-correspondingly-named-workbook", "title": "Loop to insert picture in correspondingly named workbook", "body": "<p>I am trying to insert the correct country map JPG in the correct country XLSX. By \"correct\" I mean there is one map for each XLSX - Albania.jpg into Albania.xlxs, Andorra.jpg into Andorra.xlxs, etc.</p>\n\n<p>My macro is to do the following:</p>\n\n<ol>\n<li>Enter country name and year in User Form worksheet cells B2 and B3 (works fine!).</li>\n<li>Enter country population and income level in Countries worksheet cells B1 and E1 (works fine!).</li>\n<li>Insert country map JPG in User Form worksheet at cell A18 (cannot get this to loop!).</li>\n<li>Save the workbook as CountryName.xlxs (works fine!).</li>\n</ol>\n\n<p>I have tried using Filename = Dir(Path &amp; \"*.jpg\") and ActiveSheet.Pictures.Insert without success. I think I need to use ActiveSheet.Pictures.Insert because the cells above the map's position (cell A18) will expand and the map needs to move down.</p>\n\n<pre><code>Sub SaveCountryYear_XLSX_English_map()\n\nDim lRow, x As Integer\nDim wbName As String\nDim MapPath As String 'Not used in example below\nDim MapName As String 'Not used in example below\nDim index As Integer\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nlRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nx = 1\nDo\nx = x + 1\n\nWorksheets(\"Countries\").Activate\n\n'1. Enter country name and year in User Form worksheet cells B2 and B3.\n\n    Range(\"A\" &amp; x).Select\n    Selection.Copy\n    Sheets(\"User Form\").Select\n    Range(\"B2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Sheets(\"Countries\").Select\n    Range(\"B\" &amp; x).Select\n    Selection.Copy\n    Sheets(\"User Form\").Select\n    Range(\"B3\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n\n'2. Enter country population and income level in Countries worksheet cells B1 and E1.\n\n    Sheets(\"Countries\").Select\n    Range(\"C\" &amp; x).Select\n    Selection.Copy\n    Sheets(\"Table\").Select\n    Range(\"B1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Sheets(\"Countries\").Select\n    Range(\"D\" &amp; x).Select\n    Selection.Copy\n    Sheets(\"Table\").Select\n    Range(\"E1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n\n'3. Insert country map JPG in User Form worksheet at cell A18 \n'(cannot get this to loop!). \n'The following is just an example - it works, \n'but without loop of course (inserts the named file correctly).\n\n    Sheets(\"User Form\").Select\n    Range(\"A18\").Select\n    ActiveSheet.Pictures.Insert( _\n        \"C:\\temp\\profiles\\2017\\Maps\\EN JPGs\\Albania_EN.jpg\").Select\n\nSheets(\"Countries\").Select\n\n'4. Save the workbook as CountryName.xlxs.\n\n    wbName = Range(\"A\" &amp; x).Value &amp; \"_\" &amp; Range(\"B\" &amp; x).Value &amp; \"_EN\"\n    ActiveWorkbook.SaveAs Filename:=\"C:\\temp\\profiles\\2017\\Production\\Batch_EN_1\\\" _ \n        &amp; wbName &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\nLoop Until x = lRow\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "udf", "excel-addins"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 2, "creation_date": 1483538884, "post_id": 41465478, "comment_id": 70137026, "body": "in IDE, when you select AddIn <code>ThisWorkbook module</code>, next goto Properties Window, search for <code>Is Addin</code> property and change it to <code>False</code> to see the Workbook. However, I&#39;m not sure if this is your problem."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1483539322, "post_id": 41465478, "comment_id": 70137306, "body": "@KazimierzJawor Thanks for suggestion. It results in displaying the addin as regular workbook, with some visible sheet, but then it can no longer be saved as an addin file type. I want this to be shared as an addin."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1483539775, "post_id": 41465478, "comment_id": 70137633, "body": "you are wrong, it can be saved as AddIn. All you need to do is to change back this <code>IsAddin</code>property to <code>True</code> after you make any changes."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1483540380, "post_id": 41465478, "comment_id": 70138100, "body": "@KazimierzJawor I see, you are proposing an temporary state. Will try that."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1483550945, "post_id": 41465478, "comment_id": 70145415, "body": "@KazimierzJawor Hi, can you please help with my issue in Edit #1?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1483596892, "post_id": 41465478, "comment_id": 70162286, "body": "I don&#39;t get the issue with remaining &#39;addin window&#39;. Your code seems to be quite ok. Maybe the problem is inside <code>getRegExResultRegister</code> subroutine."}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1529677982, "post_id": 41465478, "comment_id": 88975071, "body": "Raised by @ScottTrautmann: I get the exact same behavior when using the code given in Edit #1. Has anyone resolved this issue?"}], "answers": [{"comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1483543909, "post_id": 41466314, "comment_id": 70140481, "body": "Can you please recommend, where to put this lines? Inside some event or into UDF itself, or where?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1483544911, "post_id": 41466314, "comment_id": 70141205, "body": "Either inside the Workbook_Open before the <code>Call getRegExResultRegister</code> or at the start of the <code>getRegExResultRegister</code> function itself."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1483551109, "post_id": 41466314, "comment_id": 70145529, "body": "When I use this code, it immediately stops, when it executes the <code>Application.AddIns(&quot;Your Addin name&quot;).Installed = False</code>, since this gets rid of the addin that is currently running the code. :)"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1483545055, "last_edit_date": 1483545055, "creation_date": 1483540308, "answer_id": 41466314, "question_id": 41465478, "link": "https://stackoverflow.com/questions/41465478/register-udf-with-descriptions-of-arguments-using-excel-addin/41466314#41466314", "title": "Register UDF with descriptions of arguments using excel addin", "body": "<p>Use the following code before setting the .MacroOption:</p>\n\n<pre><code>Application.AddIns(\"Your Addin name\").Installed = True\n</code></pre>\n\n<p>This code may need to be preceded by :</p>\n\n<pre><code>Application.AddIns(\"Your Addin name\").Installed = False\n</code></pre>\n\n<p>According to <a href=\"https://blogs.msdn.microsoft.com/accelerating_things/2010/09/16/loading-excel-add-ins-at-runtime/\" rel=\"nofollow noreferrer\">MSDN Blog</a>, it is because automation loaded AddIns are not really opened at startup. So you have to close it before re-openning it.</p>\n\n<p>Note that <code>\"Your Addin name\"</code> is not the filename of the AddIn but its Name as it appears in the Add-ins option windows.</p>\n\n<p><em>Edit: Full code, don't forget to edit the AddIn name</em></p>\n\n<pre><code>Public Sub getRegExResultRegister()\n    Application.AddIns(\"Your Addin name\").Installed = False\n    Application.AddIns(\"Your Addin name\").Installed = True\n    Application.MacroOptions Macro:=\"getRegExResult\", Description:=\"Returns a concatenated string of NONE, ONE, or ALL Regular Expression Match(es).\", Category:=\"User Defined\", _\n        ArgumentDescriptions:=Array(\"Source string to inspect for matches.\", _\n        \"Regular Expression Pattern. E.g. \"\"\\d+\"\" matches at least 1 or more digits.\", _\n        \"[Default = True] True = Returns all the matches found. False = Returns only the first match.\", _\n        \"[Default = True] True = Not case sensitive search. False = Case sensitive search.\", _\n        \"[Default = \"\";\"\"] Delimiter to insert between every macth, if more than 1 matches are found.\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1529676707, "creation_date": 1483538014, "last_edit_date": 1495541388, "question_id": 41465478, "link": "https://stackoverflow.com/questions/41465478/register-udf-with-descriptions-of-arguments-using-excel-addin", "title": "Register UDF with descriptions of arguments using excel addin", "body": "<p>I have an addin with an UDF <code>getRegExResult</code>. I want to add a function description and arguments descriptions to this function, so when user installs the addin, closes, opens excel few times and goes to \"Insert Function\" Dialog box he will be able to find the function with description of the arguments.  </p>\n\n<p>The same is asked <a href=\"https://stackoverflow.com/questions/40948181/registering-udf-in-excel-2003-addin\">here</a>. I found one <a href=\"https://stackoverflow.com/a/21917614/4636801\">answer</a> that suits my needs. Except...  </p>\n\n<p>I want to be able to do this through an Excel Addin. My idea is to put call into addin <code>workbook_open</code> event like so:  </p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call getRegExResultRegister\nEnd Sub  \n\nPublic Sub getRegExResultRegister()\n    Application.MacroOptions Macro:=\"getRegExResult\", Description:=\"Returns a concatenated string of NONE, ONE, or ALL Regular Expression Match(es).\", Category:=\"User Defined\", _\n        ArgumentDescriptions:=Array(\"Source string to inspect for matches.\", _\n        \"Regular Expression Pattern. E.g. \"\"\\d+\"\" matches at least 1 or more digits.\", _\n        \"[Default = True] True = Returns all the matches found. False = Returns only the first match.\", _\n        \"[Default = True] True = Not case sensitive search. False = Case sensitive search.\", _\n        \"[Default = \"\";\"\"] Delimiter to insert between every macth, if more than 1 matches are found.\")\nEnd Sub\n</code></pre>\n\n<p>After I install the addin, close, open excel, I get runtime error 1004: \"Cannot edit a macro on a hidden workbook. Uhnide the workbook...\"  </p>\n\n<h2>Question 1</h2>\n\n<p>How to unhide an addin workbook? I tried to put <code>Thisworkbook.Windows(1).visible = True</code> into the <code>Workbook_open</code> event before the call to register, but that results in Runtime 9, subscript out of range.</p>\n\n<h2>Question 2</h2>\n\n<p>If the unhide addin is impossible, is there any other way to do this?</p>\n\n<hr>\n\n<p>Thanks for help.</p>\n\n<p>Similar questions:<br>\n<a href=\"https://stackoverflow.com/questions/25762127/excel-register-udf-in-personal-xslb\">Excel Register UDF in Personal.xslb</a>  </p>\n\n<h2>Edit #1</h2>\n\n<p>Current code does what I want, with one bug. When I open some existing workbook, I get 2 excel windows. One of the opened workbook (correct), one of the addin (not wanted). How to get rid of the second window?   </p>\n\n<pre><code>Private Sub Workbook_Open()\n    With ThisWorkbook\n        .IsAddin = False\n        Call getRegExResultRegister\n        .IsAddin = True\n        .Saved = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483538453, "post_id": 41465244, "comment_id": 70136725, "body": "AFAIK, <code>FileDialog.Filters</code> only supports the <code>*</code> wildcard. If this is a requirement, designing your own file dialog may be the only option."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483539575, "post_id": 41465788, "comment_id": 70137488, "body": "Pretty sure for the <code>.Filters</code> that it&#39;s only <code>*</code> - using a <code>?</code> gives a run-time error &quot;Invalid procedure call or argument&quot;."}, {"owner": {"reputation": 7761, "user_id": 456167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602c0d6b9ed63baf061dfffbd6b8ace9?s=128&d=identicon&r=PG", "display_name": "G&#244;T&#244;", "link": "https://stackoverflow.com/users/456167/g%c3%b4t%c3%b4"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483539747, "post_id": 41465788, "comment_id": 70137605, "body": "@Comintern these are for the <code>InitialFileName</code> property, I have successfully tested with <code>.InitialFileName = &quot;c:\\test\\test_?.csv&quot;</code> and a file named <code>test_1.csv</code>. I haven&#39;t tried with the <code>Filters</code> which don&#39;t seem to be necessary here"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483540367, "post_id": 41465788, "comment_id": 70138086, "body": "Right, but the OP was asking about a filter."}, {"owner": {"reputation": 7761, "user_id": 456167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602c0d6b9ed63baf061dfffbd6b8ace9?s=128&d=identicon&r=PG", "display_name": "G&#244;T&#244;", "link": "https://stackoverflow.com/users/456167/g%c3%b4t%c3%b4"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483540515, "post_id": 41465788, "comment_id": 70138182, "body": "@Comintern <code>InitialFileName</code> does filter. OP asked how to <i>modify</i> his filter, which is already using this property."}, {"owner": {"reputation": 69, "user_id": 7374376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8512f4e50f5364749183384fe9e9510b?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/7374376/stefan"}, "edited": false, "score": 0, "creation_date": 1483598910, "post_id": 41465788, "comment_id": 70163057, "body": "thank you very much for your reply.  In principle the approach by G&#244;T&#244; works fine, The only thing is, what to do if the &#39;_#&#39; is larger than nine?   &#39;?&#39; allows only one character. In best case I need an unknown amount of numbers. E.g. test_1223345.csv Is this somehow possible?"}, {"owner": {"reputation": 7761, "user_id": 456167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602c0d6b9ed63baf061dfffbd6b8ace9?s=128&d=identicon&r=PG", "display_name": "G&#244;T&#244;", "link": "https://stackoverflow.com/users/456167/g%c3%b4t%c3%b4"}, "reply_to_user": {"reputation": 69, "user_id": 7374376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8512f4e50f5364749183384fe9e9510b?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/7374376/stefan"}, "edited": false, "score": 1, "creation_date": 1483600394, "post_id": 41465788, "comment_id": 70163698, "body": "@Stefan actually your question was to show only the files without the <code>_#</code> while your comment suggests the contrary? You could use <code>test_*.csv</code> but would get any file with this prefix, even <code>test_aaaa.csv</code>"}, {"owner": {"reputation": 69, "user_id": 7374376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8512f4e50f5364749183384fe9e9510b?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/7374376/stefan"}, "edited": false, "score": 1, "creation_date": 1483603133, "post_id": 41465788, "comment_id": 70164997, "body": "@G&#244;T&#244; your right it was more a general question. Your suggestion by using &#39;*&#39; instead of &#39;?&#39; works. Thanks a lot.  Nevertheless, it would be great to have the possibility to use regular expression here :-) Anyway thank again for your help."}], "tags": [], "owner": {"reputation": 7761, "user_id": 456167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602c0d6b9ed63baf061dfffbd6b8ace9?s=128&d=identicon&r=PG", "display_name": "G&#244;T&#244;", "link": "https://stackoverflow.com/users/456167/g%c3%b4t%c3%b4"}, "is_accepted": true, "score": 2, "last_activity_date": 1483604353, "last_edit_date": 1483604353, "creation_date": 1483538848, "answer_id": 41465788, "question_id": 41465244, "link": "https://stackoverflow.com/questions/41465244/open-file-dialog-with-exclude-filter-excel-vba/41465788#41465788", "title": "Open File Dialog with exclude Filter (Excel VBA)", "body": "<p>Unfortunately you are very limited here and can only use the wildcards <code>*</code> and <code>?</code> which do not allow to exclude characters.</p>\n\n<p>You can have a filter like this:</p>\n\n<pre><code>With Application.FileDialog(msoFileDialogFilePicker)\n    .AllowMultiSelect = True\n    .Title = \"Datei w\u00e4hlen\"\n    .InitialFileName = \"c:\\test\\test_*.csv\"\n    .Show\n\n    If .SelectedItems.Count &gt; 0 Then\n       'do something \n    End If\nEnd With  \n</code></pre>\n\n<p>To retrieve all CSV files starting with <code>test_</code>but that's the best you can do.</p>\n\n<p>See <strong><a href=\"https://msdn.microsoft.com/en-us/library/aa432281(v=office.12).aspx\" rel=\"nofollow noreferrer\">doc</a></strong> on Microsoft's website.</p>\n"}], "owner": {"reputation": 69, "user_id": 7374376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8512f4e50f5364749183384fe9e9510b?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/7374376/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1325, "favorite_count": 1, "accepted_answer_id": 41465788, "answer_count": 1, "score": 2, "last_activity_date": 1483604353, "creation_date": 1483537260, "question_id": 41465244, "link": "https://stackoverflow.com/questions/41465244/open-file-dialog-with-exclude-filter-excel-vba", "title": "Open File Dialog with exclude Filter (Excel VBA)", "body": "<p>I'm currently writing a small script for Excel to import csv files. Therefore I integrated an open file dialog with a csv-filter.</p>\n\n<pre><code> With Application.FileDialog(msoFileDialogFilePicker)\n    .AllowMultiSelect = True\n    .Title = \"Datei w\u00e4hlen\"\n    .InitialFileName = \"c:\\test\\*.csv\"\n    .Show\n\n    If .SelectedItems.Count &gt; 0 Then\n       'do something \n    End If\n End With\n</code></pre>\n\n<p>So far this works fine for me. But unfortunately I have different types of csv-files like</p>\n\n<ul>\n<li>file.csv</li>\n<li>test.csv </li>\n<li>file_1.csv</li>\n<li>lala_2.csv</li>\n<li>...</li>\n</ul>\n\n<p>Can i modify my filter in that way, that he only shows me the files without '_#' in front of '.csv'?</p>\n\n<p>Thanks for your help.\nBest wishes</p>\n\n<p>Stefan</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1483535264, "post_id": 41464463, "comment_id": 70134664, "body": "<code>Var</code> is a local variable accessible only from within the Populate sub. The Variable1 sub has no access to <code>Var</code>. If you are using the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278855.aspx\" rel=\"nofollow noreferrer\">Option Explicit</a> statement, your code shouldn&#39;t compile (even when correcting the <code>Dim</code> typo at the start. I suggest you to always use <code>Option Explicit</code>, and to use <code>Function</code> to return values instead of <code>Sub</code> and shared variables."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1483535660, "post_id": 41464463, "comment_id": 70134933, "body": "<code>&quot; &amp; Var &amp; &quot;</code> is a string constant, not code doing any concatenation. What do you want to concatenate <code>Var</code> with? See <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264104.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg264104.aspx</a> on how to use the <code>&amp;</code>operator to concatenate."}, {"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1483536227, "post_id": 41464463, "comment_id": 70135283, "body": "Thanks Vincent G 50, I&#39;m trying to replace the text box ID inside of the quotes &quot;...&quot; with a variable after IE.Document.All(&quot; ... &quot;).Value, but found using the &amp;..&amp; didn&#39;t work. Also typo was corrected - it wasn&#39;t spelled this way in my actual code :)"}, {"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1483536748, "post_id": 41464463, "comment_id": 70135599, "body": "If I wanted to include calculations based on excel sheet values in Variable1()... would you still recommend making it a function instead of a sub? I&#39;d like to use it to return values, but also make calculations and do other things."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1483537975, "post_id": 41464463, "comment_id": 70136391, "body": "See @Comintern answer. IMHO Function are the best wait to return a single value. When multiples values need to be returned, a Function or a Sub with ByRef parameters can be used equally. I can&#39;t think of anything done in a sub that cannot be done in a function."}, {"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1483620856, "post_id": 41464463, "comment_id": 70176122, "body": "I edited my original post here with an update showing new code to give a more accurate glimpse into what I&#39;m trying to accomplish. However a couple new issues have come up that I can&#39;t seem to fix.."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "edited": false, "score": 0, "creation_date": 1483536324, "post_id": 41464644, "comment_id": 70135334, "body": "Thanks I think I&#39;ll try making these subs public instead, only because I want to include other commands inside of Variable1() such as calculating averages from specific cells in the excel worksheet. The cell numbers for the calculations will also vary by each sub (ex. Variable 1(), Variable 2(), etc.)"}, {"owner": {"reputation": 258, "user_id": 7369240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pHaas.gif?s=128&g=1", "display_name": "AdzzzUK", "link": "https://stackoverflow.com/users/7369240/adzzzuk"}, "reply_to_user": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "edited": false, "score": 0, "creation_date": 1483536985, "post_id": 41464644, "comment_id": 70135757, "body": "Is it the same calculation being done lots of times?  I would move away from just giving the function names generic names - give it a name you would understand."}], "tags": [], "owner": {"reputation": 258, "user_id": 7369240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pHaas.gif?s=128&g=1", "display_name": "AdzzzUK", "link": "https://stackoverflow.com/users/7369240/adzzzuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1483535412, "creation_date": 1483535412, "answer_id": 41464644, "question_id": 41464463, "link": "https://stackoverflow.com/questions/41464463/pass-variable-after-calling-sub/41464644#41464644", "title": "Pass Variable After Calling Sub", "body": "<p>If you Declare (DIM) a Variable within a subroutine/function, it is only available within that subroutine/function.</p>\n\n<p>You need to declare the variables publicly for them to be available to other subroutines.</p>\n\n<p>Alternatively, you could rewrite the code, as follows:</p>\n\n<pre><code>Private Sub Populate()\n\nDim strVar As String \nDim IE As Object\n\nDoEvents\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nSet IE = CreateObject(\"InternetExplorer.Application\")\nWith IE\n    .Navigate \"https://website.com\"\n    .Visible = True\n    While .busy\n        DoEvents  \n    Wend\nEnd With\nstrVar=Variable1()\n\nIE.Document.All(\" &amp; strVar &amp; \").Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B5\")\n\nEnd Sub\n\nPrivate Function Variable1() AS String\n    Var = \"R_575031\"\nEnd Sub\n</code></pre>\n\n<p>By turning the routine into a function, you can return a value.  Private Functions only exist in the module (eg within a form).  Public Functions and subs belong in global module containers rather than in Form / Sheet containers.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "edited": false, "score": 0, "creation_date": 1483542903, "post_id": 41465209, "comment_id": 70139814, "body": "Thank you Comintern, this was helpful. When I create a function As String, does that limit the use of the function to strings only? Basically I want to add more to this function such as make calculations, pass multiple variables, etc and not just use it for passing strings into variables. If this is the case, would you then suggest going with your first option using ByRef?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "edited": false, "score": 0, "creation_date": 1483543053, "post_id": 41465209, "comment_id": 70139909, "body": "@RS - I&#39;m not sure what you mean by &quot;make calculations and not just use it for passing strings&quot;. But yes, if it returns a <code>String</code>, that&#39;s what it returns. Good design practices would only have each <code>Sub</code> or <code>Function</code> responsible for doing 1 thing though."}, {"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "edited": false, "score": 0, "creation_date": 1483543405, "post_id": 41465209, "comment_id": 70140143, "body": "My plan is to have multiple functions/subs and when one is called have it perform a series of individual tasks. One task will involve selecting cells on an excel sheet and making calculations such as average, min, and max values, etc. For each function/sub the cell range will differ when making these calculations. The variable Var is just one result. There will  be multiple variables such as Var1, Var2, etc for each result and all will go into IE. Sorry I should have made this more clear in my original post. I will definitely post more detailed code in the future. I hope this is clear."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "edited": false, "score": 0, "creation_date": 1483543711, "post_id": 41465209, "comment_id": 70140352, "body": "@RS - You can certainly use more than 1 &#39;ByRef&#39; parameter for either functions or subs (<a href=\"http://stackoverflow.com/documentation/vba/7363/passing-arguments-byref-or-byval#t=201701041526358654955\">see this page on Documentation</a>), but in general it would indicate poor design. If the variables are going to be used globally, declare them as globals."}, {"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "edited": false, "score": 0, "creation_date": 1483620867, "post_id": 41465209, "comment_id": 70176131, "body": "I edited my original post here with an update showing new code to give a more accurate glimpse into what I&#39;m trying to accomplish. However a couple new issues have come up that I can&#39;t seem to fix.."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1483537139, "creation_date": 1483537139, "answer_id": 41465209, "question_id": 41464463, "link": "https://stackoverflow.com/questions/41464463/pass-variable-after-calling-sub/41465209#41465209", "title": "Pass Variable After Calling Sub", "body": "<p>This isn't how variables work, and it isn't how parameters work.  As pointed out in the comments, variables declared inside procedures only have scope inside those procedures.  If you want to change the value outside of the procedure you're in from a different procedure you have 2 options - either pass them <code>ByRef</code>:</p>\n\n<pre><code>Sub Variable1(ByRef Var As String)\n    Var = \"R_575031\"\nEnd Sub\n\n'In the calling code...\nVariable1 Var\n</code></pre>\n\n<p>...or assign them to the return value of a function:</p>\n\n<pre><code>Function Variable1() As String\n    Variable1 = \"R_575031\"\nEnd Function\n\n'In the calling code...\nVar = Variable1\n</code></pre>\n\n<p>In your case, the second makes for clearer, easier to read code.</p>\n\n<p>As for <em>using</em> it, this line is wrong:</p>\n\n<blockquote>\n<pre><code>E.Document.All(\" &amp; strVar &amp; \").Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B5\")\n</code></pre>\n</blockquote>\n\n<p>You don't concatenate variables into commands.  If you need to pass a parameter, pass a parameter:</p>\n\n<pre><code>E.Document.All(strVar).Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B5\")\n              '^^^^^^ this is a parameter of .All()\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 0, "accepted_answer_id": 41465209, "answer_count": 2, "score": 0, "last_activity_date": 1489966693, "creation_date": 1483534771, "last_edit_date": 1489966693, "question_id": 41464463, "link": "https://stackoverflow.com/questions/41464463/pass-variable-after-calling-sub", "title": "Pass Variable After Calling Sub", "body": "<p>I have two issues. </p>\n\n<ol>\n<li><p>Because Var3 can be blank sometimes depending on the Sub, I get a 424 error and the word 'undefined' is copied into the textbox on the website - however I need to leave it blank and not paste anything in this case. </p></li>\n<li><p>I have a dropdown box in Excel to select what Sub will be called. I would like to incorporate this into an IF statement as shown below, but when I try the code, nothing happens.</p></li>\n</ol>\n\n<p>Here is my attempt:</p>\n\n<pre><code>Public Sub Populate()\n\nDim Var1 As String\nDim Var2 As String\nDim Var3 As String    \n\nDim User_Name As String\nDim StrFile1 As String\nDim StrFile2 As String\nDim Filename As String\nDim strFilename As String\n\nDim IE As Object\n\nIf ComboBox1.Value = \"Data1\" Then\n    Call Data1 (Filename, Var1, Var2, Var3)\nEnd If\n\nIf ComboBox1.Value = \"Data2\" Then\n    Call Data2 (Filename, Var1, Var2, Var3)\nEnd If\n\n'If ComboBox1.Value = Data3, Data4, etc...\n\n    User_Name = Environ(\"UserName\")\n    StrFile1 = \"C:\\Users\\\"\n    StrFile2 = \"\\Desktop\\\"\n\n    strFilename = StrFile1 &amp; User_Name &amp; StrFile2 &amp; Filename\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; strFilename, Destination _\n        :=Range(\"$A$22\"))\n        .Name = Filename\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlOverwriteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = False\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n\n    ActiveWindow.SmallScroll Down:=-27\n\n    DoEvents\n\n    'FillInternetForm\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Navigate \"https://website.com\"\n    IE.Visible = True\n    While IE.busy\n        DoEvents  'wait until IE is done loading page.\n    Wend\n\n    IE.Document.All(Var1).Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B5\")\n    IE.Document.All(Var2).Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B6\")\n    IE.Document.All(Var3).Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B7\")\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n\n\nPublic Sub Data1 (ByRef Filename As String, ByRef Var1 As String, ByRef Var2 As String, ByRef Var3 As String)\n\n    Filename = \"FILE1.CSV\"\n    Var1 = \"Response123\"\n    Var2 = \"Response456\"\n    Var3 = \"Response789\"\n\nEnd Sub\n\nPublic Sub Data2 (ByRef Filename As String, ByRef Var1 As String, ByRef Var2 As String, ByRef Var3 As String)\n\n    Filename = \"FILE2.CSV\"\n    Var1 = \"Response987\"\n    Var2 = \"Response654\"\n    Var3 = \"Response321\"\n\nEnd Sub\n\n'Public Sub Data3, Data4, etc...\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1483534187, "post_id": 41464045, "comment_id": 70133966, "body": "Perhaps you want #N/A which is creatable with <code>=CVErr(2042)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "is_accepted": false, "score": 0, "last_activity_date": 1483533838, "creation_date": 1483533838, "answer_id": 41464152, "question_id": 41464045, "link": "https://stackoverflow.com/questions/41464045/excel-vba-pass-variable-between-functions/41464152#41464152", "title": "Excel VBA pass variable between functions", "body": "<p>Problem is here:</p>\n\n<pre><code>Cells(rng, i).Value = \"NA\"\n</code></pre>\n\n<p>why you give range to place where Number (row number) must go?</p>\n\n<p>You need to use</p>\n\n<pre><code>Cells(rng.Row, i).Value = \"NA\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1483535201, "post_id": 41464164, "comment_id": 70134622, "body": "Yes, thank you, that worked.  I had quotes around the NA, but forgot to copy them here.  However, the rng.Row is what fixed it."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1483534222, "last_edit_date": 1483534222, "creation_date": 1483533855, "answer_id": 41464164, "question_id": 41464045, "link": "https://stackoverflow.com/questions/41464045/excel-vba-pass-variable-between-functions/41464164#41464164", "title": "Excel VBA pass variable between functions", "body": "<p><code>rng</code> on its own (without an explicit property name) defaults to returning <code>.Value</code> which when <code>0</code> tries to use row index <code>0</code> which is not valid, instead get the row number via <code>.Row</code>:</p>\n\n<pre><code>Cells(rng.Row, i).Value = \"NA\"\n</code></pre>\n\n<p>If <code>NA</code> is not a variable but a string, quote it.</p>\n\n<p>Non-loop alternative:</p>\n\n<pre><code> If rng.Value = 0 Then Range(rng.Offset(0, 1), rng.Offset(0, 21)).Value = \"NA\"\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 41464164, "answer_count": 2, "score": 2, "last_activity_date": 1483534222, "creation_date": 1483533510, "last_edit_date": 1531164843, "question_id": 41464045, "link": "https://stackoverflow.com/questions/41464045/excel-vba-pass-variable-between-functions", "title": "Excel VBA pass variable between functions", "body": "<p>I am trying to write excel VBA code that will parse column B (analyst login time), and if that column is 0 (as in they were out that day), it will update the adjacent columns to say NA.  Currently, the below code errors out.  If I change the rng variable in Cells(rng, i) to a number, then the code will take that number (let's say 4) and put NA in all of the fields (3 to 23, so, C to W).  I believe that the issue is that the value of rng is not being passed into the inner function, but I do not know how to get arround this.</p>\n\n<pre><code>Dim rng As Range\nFor Each rng In Range(\"B4:B10\")\n    If rng.Value = 0 Then\n        For i = 3 To 23\n            Cells(rng, i).Value = NA\n        Next i\n    End If\nNext rng\n</code></pre>\n"}, {"tags": ["vba", "excel", "smtp", "cdo.message"], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 2, "last_activity_date": 1483537036, "last_edit_date": 1495542873, "creation_date": 1483537036, "answer_id": 41465178, "question_id": 41463936, "link": "https://stackoverflow.com/questions/41463936/when-sending-mail-via-smtp-i-get-transport-failed-to-connect-to-server/41465178#41465178", "title": "When sending mail via SMTP, I get &quot;Transport Failed to Connect to server&quot;", "body": "<p>That code works totally fine for me (send <em>from</em> Gmail <em>to</em> Gmail) - so you need to check the following:</p>\n\n<ul>\n<li>try it with port 587 as well as port 465 (<a href=\"https://stackoverflow.com/questions/15796530/what-is-the-difference-between-ports-465-and-587\">further reading</a>)</li>\n<li>configure your sending account in Gmail for <code>Access for less secure apps</code> - there is a <code>Turn On</code> option per the following <a href=\"https://support.google.com/accounts/answer/6010255?hl=en\" rel=\"nofollow noreferrer\">support page</a></li>\n</ul>\n\n<blockquote>\n  <p>Allowing less secure apps to access your account\n  Google may block sign-in attempts from some apps or devices that do not use modern security standards. Since these apps and devices are easier to break into, blocking them helps keep your account safe.</p>\n  \n  <p>Some examples of apps that do not support the latest security standards include:</p>\n  \n  <p>The Mail app on your iPhone or iPad with iOS 6 or below</p>\n  \n  <p>The Mail app on your Windows phone preceding the 8.1 release</p>\n  \n  <p>Some Desktop mail clients like Microsoft Outlook and Mozilla Thunderbird</p>\n  \n  <p>...</p>\n  \n  <p>Option 2: Change your settings to allow less secure apps to access your account. We don't recommend this option because it might make it easier for someone to break into your account. If you want to allow access anyway, follow these steps:</p>\n  \n  <p><strong>Go to the \"Less secure apps\" section in My Account.</strong></p>\n  \n  <p><strong>Next to \"Access for less secure apps,\" select Turn on. (Note to Google Apps users: This setting is hidden if your administrator has locked less secure app account access.)</strong></p>\n</blockquote>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms526914(v=exchg.10).aspx\" rel=\"nofollow noreferrer\">CDO</a> is pretty old now so assume that is an example of an app that doesn't <em>support latest security standards</em>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user564300"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12934, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554495458, "creation_date": 1483533211, "last_edit_date": 1554495458, "question_id": 41463936, "link": "https://stackoverflow.com/questions/41463936/when-sending-mail-via-smtp-i-get-transport-failed-to-connect-to-server", "title": "When sending mail via SMTP, I get &quot;Transport Failed to Connect to server&quot;", "body": "<p>I have the code below to send mail from a VBA macro using CDO. I get an error in the code:</p>\n\n<blockquote>\n  <p>Transport failed To connect to server Error</p>\n</blockquote>\n\n<p>I am sending a mail from the Gmail SMTP service. Looks like the configuration is set correctly, but somehow it doesn't work.</p>\n\n<pre><code>Sub Email()\n\n    Dim CDO_Mail As Object\n    Dim CDO_Config As Object\n    Dim SMTP_Config As Variant\n    Dim strSubject As String\n    Dim strFrom As String\n    Dim strTo As String\n    Dim strCc As String\n    Dim strBcc As String\n    Dim strBody As String\n\n    strSubject = \"Results from Excel Spreadsheet\"\n    strFrom = \"xxx@gmail.com\"\n    strTo = \"xxx@gmail.com\"\n    strBody = \"The total results are: 167\"\n\n    Set CDO_Mail = CreateObject(\"CDO.Message\")\n\n    Set CDO_Config = CreateObject(\"CDO.Configuration\")\n    CDO_Config.Load -1\n\n    Set SMTP_Config = CDO_Config.Fields\n\n    With SMTP_Config\n      .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n      .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.gmail.com\"\n      .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = 1\n      .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"xxxx@gmail.com\"\n      .Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"xxxx\"\n      .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 465\n      .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = True\n        .Update\n    End With\n\n    With CDO_Mail\n        Set .Configuration = CDO_Config\n    End With\n\n    CDO_Mail.Subject = strSubject\n    CDO_Mail.From = strFrom\n    CDO_Mail.To = strTo\n    CDO_Mail.TextBody = strBody\n    CDO_Mail.Send\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "cursor"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483537228, "post_id": 41463595, "comment_id": 70135936, "body": "Impossible to tell without seeing your code. Please edit a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> into your question."}, {"owner": {"reputation": 101, "user_id": 7373954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RJx6j.jpg?s=128&g=1", "display_name": "Harry Audus", "link": "https://stackoverflow.com/users/7373954/harry-audus"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483775067, "post_id": 41463595, "comment_id": 70244154, "body": "@Comintern I&#39;ve added the macro code."}, {"owner": {"reputation": 101, "user_id": 7373954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RJx6j.jpg?s=128&g=1", "display_name": "Harry Audus", "link": "https://stackoverflow.com/users/7373954/harry-audus"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484017474, "post_id": 41463595, "comment_id": 70325797, "body": "@Comintern Ok, I see I haven&#39;t given enough info to prompt an answer, or no-one has any idea either what I&#39;m talking about or how to solve the problem. I&#39;d include the cut-down Word document itself, with table, if I could work out how to upload it. Is this possible?"}], "owner": {"reputation": 101, "user_id": 7373954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RJx6j.jpg?s=128&g=1", "display_name": "Harry Audus", "link": "https://stackoverflow.com/users/7373954/harry-audus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 910, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483670464, "creation_date": 1483532106, "last_edit_date": 1483670464, "question_id": 41463595, "link": "https://stackoverflow.com/questions/41463595/in-an-ms-word-table-how-to-locate-the-cursor-position-and-the-mouse-cursor-posi", "title": "In an MS Word table, how to locate the cursor position and the mouse cursor position separately", "body": "<p>I have a Word table in which I want to hide or reveal text in specific columns. I have written a macro linked to a check box in the header row. Ticking the box is supposed to hide the text in a column on the row where the cursor sits. The macro works fine when I test the VBA, but when I run it using the tick box, the code \"thinks\" the relevant row is the header row where the tick box resides. </p>\n\n<p>How can I relay the correct row index (i.e. the row selected, where the text cursor sits, before the tick box is ticked) to the macro? </p>\n\n<p>Maybe the correct question is: How does one differentiate between the cursor position in text (in a Word table) and the mouse cursor position?</p>\n\n<p>Here is the macro code...</p>\n\n<p>Private Sub CheckBox1_Click()\n    Call HideOrRevealAnswer\nEnd Sub</p>\n\n<p>Sub HideOrRevealAnswer()</p>\n\n<pre><code>Dim iCellRange As Range\nDim iColStart, iColEnd As Integer\nDim iRow As Integer\n\niColStart = 4 'column for Answers\niColEnd = 5 'column for Explanation\n\nWith ActiveDocument\n    iRow = Selection.Cells(1).RowIndex\n    Set iCellRange = .Range(Start:=.Tables(1).Cell(iRow,iColStart).Range.Start, _\n        End:=.Tables(1).Cell(iRow, iColEnd).Range.End)\n    iCellRange.Select\nEnd With\n\nWith iCellRange\n    Select Case .Font.Color\n        Case wdColorAutomatic\n            .Font.Color = wdColorWhite\n        Case wdColorWhite\n            .Font.Color = wdColorAutomatic\n    End Select\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "excel-charts"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 4, "creation_date": 1483532536, "post_id": 41463504, "comment_id": 70132873, "body": "Try <code>MyChtObj.Chart.SeriesCollection(3).Delete</code>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1483540045, "post_id": 41463504, "comment_id": 70137847, "body": "@ShaiRado - serious; OP just needed prompt to refer to <code>Chart</code> object of the <code>ChartObject</code> which is a bit confusing for lots of people - so it is a useful answer which you is completely fine to write up IMO. Cheers."}], "answers": [{"comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1483542465, "post_id": 41466978, "comment_id": 70139560, "body": "Upvote for highlighting difference between <code>ChartObject</code> and the <code>Chart</code> property of the <code>ChartObject</code>."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 5, "last_activity_date": 1483542350, "creation_date": 1483542350, "answer_id": 41466978, "question_id": 41463504, "link": "https://stackoverflow.com/questions/41463504/remove-series-from-chart-with-vba/41466978#41466978", "title": "Remove series from chart with VBA", "body": "<p>The <code>SeriesCollection</code> is part of the <code>ChartObject.Chart</code> object, and not the <code>ChartObject</code>.</p>\n\n<p>Therfore, replace your line of:</p>\n\n<pre><code>MyChtObj.SeriesCollection(3).Delete\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>MyChtObj.Chart.SeriesCollection(3).Delete\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1484100788, "creation_date": 1484100788, "answer_id": 41581639, "question_id": 41463504, "link": "https://stackoverflow.com/questions/41463504/remove-series-from-chart-with-vba/41581639#41581639", "title": "Remove series from chart with VBA", "body": "<p>Your line of code</p>\n\n<pre><code>.SeriesCollection.NewSeries.XValues = Sht1.Range(\"F36\", Sht1.Range(\"F36\").End(xlToRight))\n</code></pre>\n\n<p>is adding a third series via <code>.NewSeries</code>. Change it to</p>\n\n<pre><code>.SeriesCollection(1).XValues = Sht1.Range(\"F36\", Sht1.Range(\"F36\").End(xlToRight))\n</code></pre>\n\n<p>Now there's nothing to delete.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11228451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef82b3ce4cce53a923582145ab7b6149?s=128&d=identicon&r=PG&f=1", "display_name": "sabrinahewa", "link": "https://stackoverflow.com/users/11228451/sabrinahewa"}, "is_accepted": false, "score": 0, "last_activity_date": 1553028397, "last_edit_date": 1553028397, "creation_date": 1553027844, "answer_id": 55249581, "question_id": 41463504, "link": "https://stackoverflow.com/questions/41463504/remove-series-from-chart-with-vba/55249581#55249581", "title": "Remove series from chart with VBA", "body": "<p>THis doesn't seem to work always</p>\n\n<pre><code>.SeriesCollection(1).XValues = Sht1.Range(\"F36\", Sht1.Range(\"F36\").End(xlToRight))\n</code></pre>\n\n<p>This wont work if there is no series 3 to delete (some times randomly this series 3 doesn't appear by default then you'll get an error for this line )</p>\n\n<pre><code>MyChtObj.Chart.SeriesCollection(3).Delete\n</code></pre>\n\n<p>Here's a fast n dirty trick. Add this (repeated 3 times here but repeat more depending on your sheet because different sheets depending on the nr of cells populated, generate different numbers of random series). It will keep deleting the series that falls into the 3rd position in the \"list\" with every deletion until nr or series is 2 </p>\n\n<pre><code>        If .SeriesCollection.Count &gt; 2 Then\nMyChtObj.Chart.SeriesCollection(3).Delete\n        End If\n\n        If .SeriesCollection.Count &gt; 2 Then\nMyChtObj.Chart.SeriesCollection(3).Delete\n        End If\n\n        If .SeriesCollection.Count &gt; 2 Then\nMyChtObj.Chart.SeriesCollection(3).Delete\n        End If\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 7267457, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea371989d65e97bf2f250d7bff7059fd?s=128&d=identicon&r=PG&f=1", "display_name": "M Kaye", "link": "https://stackoverflow.com/users/7267457/m-kaye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10458, "favorite_count": 0, "accepted_answer_id": 41466978, "answer_count": 3, "score": 3, "last_activity_date": 1553028397, "creation_date": 1483531788, "last_edit_date": 1531164843, "question_id": 41463504, "link": "https://stackoverflow.com/questions/41463504/remove-series-from-chart-with-vba", "title": "Remove series from chart with VBA", "body": "<p>I am creating a chart in excel via vba code. I am using contiguous data and the chart pops up no problem, however there is an extra series named \"Series 3\" that I didn't ask for and need to get rid of (via deleting it or omitting in the first place). It has no data in it but needs to be removed from the legend at least. Here is my code :</p>\n\n<pre><code>Dim MyChtObj As ChartObject\nDim Sht1 As Worksheet\nDim ShtName As String\n\nSet Sht1 = Worksheets(\"Parameter Forecasts\")\nShtName = Sht1.Name\nSet MyChtObj = Sht1.ChartObjects.Add(100, 100, 500, 500)\n\nSet a = Sht1.Range(\"E37\", Sht1.Range(\"E37\").End(xlToRight))\nSet b = Sht1.Range(\"E38\", Sht1.Range(\"E38\").End(xlToRight))\nSet InputData = Union(a, b)\n\nWith MyChtObj.Chart\n    .ChartType = xlLineMarkers\n    .SetSourceData InputData\n    .PlotBy = xlRows\n    .SeriesCollection.NewSeries.XValues = Sht1.Range(\"F36\", Sht1.Range(\"F36\").End(xlToRight))\nEnd With\n</code></pre>\n\n<p>I have already tried:</p>\n\n<p><code>MyChtObj.SeriesCollection(3).Delete</code></p>\n\n<p>But this does not work.</p>\n\n<p>Thanks in advance, Max</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483543440, "post_id": 41465352, "comment_id": 70140164, "body": "Hello, thanks for that I have made the changes :) However I am still getting that code block skip in the same place now, I think that it may have something to do with my data structure or the range i set in &#39;With&#39; as when i use the .Find method to search sheet2, a blank cell is being referenced rather than the cell which contains the matching data."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483543713, "post_id": 41465352, "comment_id": 70140353, "body": "@Dingge like i wrote above, sharing how your data structure in your worksheet looks like will help us help you"}, {"owner": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483544514, "post_id": 41465352, "comment_id": 70140906, "body": "There you go, Left is the sheet people will search deadlines from, using that button i want them to be able to press it on an active cell and retrieve the deadline from sheet2"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483551947, "post_id": 41465352, "comment_id": 70146012, "body": "You might have a problem with cell format consistency since you are using a Date, it might be formatted in a different way"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1483537913, "last_edit_date": 1483537913, "creation_date": 1483537582, "answer_id": 41465352, "question_id": 41463470, "link": "https://stackoverflow.com/questions/41463470/evaluation-error/41465352#41465352", "title": "Evaluation error", "body": "<p>You mixed-up a little between all the different types of variables, and what type each function returns.</p>\n\n<p><code>WorksheetFunction.Index</code> - returns a value of a certain cell (or range of cells), so you need to define <code>cabDate As String</code>.\nSo instead of using <code>If Not cabDate Is Nothing Then</code> (since it's not a <code>Range</code>) you need to use <code>If Not IsEmpty(cabDate) Then</code>.</p>\n\n<p>The <code>Find</code> method using the <code>Set findme</code> returns a <code>Range</code>, so you can't later on also use it with <code>findme = findme.Address(True, True)</code> , but you need to define another variable <code>As String</code> and then you can read the <code>String</code> address to it.</p>\n\n<p>And last, since you want to read a value from <code>printable</code>, it needs to be <code>As String</code> or <code>As Integer</code>, but not a <code>Range</code>. </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nDim cabDate As String, findme As Range\nDim searchCol As Integer\n\nsearchCol = ActiveCell.Column\ncabDate = WorksheetFunction.Index(Range(\"A1:O9999\"), ActiveCell.Row, 2)\n\nIf Not IsEmpty(cabDate) Then\n    With Worksheets(\"Deadlines\").Range(\"B:B\")\n        Set findme = .Find(what:=cabDate)\n\n        If Not findme Is Nothing Then\n            Dim findmeAddr As String\n            findmeAddr = findme.Address(True, True)\n\n            Dim printable As String                \n            printable = findme.Offset(0, searchCol).Value\n            MsgBox (printable)\n        Else\n            MsgBox (\"Deadline not found\")\n        End If\n    End With\nElse\n    MsgBox (\"invalid or non existent cabinet date\")\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483604306, "post_id": 41468478, "comment_id": 70165528, "body": "Still getting the same skip, I will try messing around with the data types here maybe, thank you for the help"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483613897, "post_id": 41468478, "comment_id": 70171270, "body": "I wouldn&#39;t say data types are the culprit, rather step through your code and check for <code>ActiveCell</code> to be what you actually expect it to be"}, {"owner": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483614949, "post_id": 41468478, "comment_id": 70172026, "body": "Ive been using msgbox and the debugger notifications to show me that the variables are being picked up correctly. So far cabDate seems to print fine no matter where i place the active cell, it gives me the correct cabDate from sheet1.  It seems the problem im having now is actually getting the program to locate an exact match on sheet2, I keep getting &#39;findme = nothing&#39; in the debugger, Ive tried using Vlookup as well but this also cant find the matching value."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483615085, "post_id": 41468478, "comment_id": 70172115, "body": "are dates really dates? I mean if you query <code>?cabDate.Value</code> what do you get returned?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483615619, "post_id": 41468478, "comment_id": 70172466, "body": "so <code>Set cabDate = WorksheetFunction.Index(Range(&quot;A1:O9999&quot;), ActiveCell.Row, 2)</code> isn&#39;t working as expected, is it?"}, {"owner": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483616028, "post_id": 41468478, "comment_id": 70172716, "body": "Why does the messagebox show me the correct value?  Isnt that because i set cabDate to a string and .value needs a range?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483616140, "post_id": 41468478, "comment_id": 70172796, "body": "in your code I see <code>Dim cabDate As Range</code>. If you dimmed it to a <code>String</code> then type <code>?cabDate</code>"}, {"owner": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "edited": false, "score": 0, "creation_date": 1483616325, "post_id": 41468478, "comment_id": 70172916, "body": "Ah, I will update the original code, apologies. Now i get &#39;object doesn&#39;t support this property or method&#39; highlighting the print line."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1483613844, "last_edit_date": 1483613844, "creation_date": 1483546571, "answer_id": 41468478, "question_id": 41463470, "link": "https://stackoverflow.com/questions/41463470/evaluation-error/41468478#41468478", "title": "Evaluation error", "body": "<p>try</p>\n\n<pre><code>Set findme = .Find(what:=cabDate, lookIn:=xlValues, lookAt:=xlWhole)\n</code></pre>\n\n<p>since <code>Find()</code> method of <code>Range</code> object remembers the last settings of those parameters even if made from Excel UI</p>\n\n<p>and be sure that <code>ActiveCell</code> is what you're actually expecting it to be!</p>\n"}], "owner": {"reputation": 51, "user_id": 7368495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d11e488a577bf6ea8e9a363f7aebead?s=128&d=identicon&r=PG&f=1", "display_name": "Dingge", "link": "https://stackoverflow.com/users/7368495/dingge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1483616636, "creation_date": 1483531642, "last_edit_date": 1531164843, "question_id": 41463470, "link": "https://stackoverflow.com/questions/41463470/evaluation-error", "title": "Evaluation error", "body": "<p>I have 2 sheets which I am working with here.  sheet1 which the user will press this button from, contains a column called \"Cabinet date\" which is just a list of dates that relate to each report.\nSheet2 (Deadlines) contains also the cabinet date column, matched with a series of deadlines to be met before this date (in the same row).\n//for example the deadline of any draft report in January cabinet would be in the same row.//</p>\n\n<p>I want to make a button that when pressed will find the cabinet date in sheet2 which matches the one in the active cell (on sheet1), as well as pick up the heading which it was under (the searchCol), then return the exact deadline value for that event in the correct cabinet date from sheet2.</p>\n\n<p>The problem I have currently is that when I run this button it seems to not pick up the cabinet date value from sheet2, and cause  the annotated line to evaluate to nothing/true and skip the block of code which would print the deadline date.</p>\n\n<p>All Im getting when I press this is \"deadline not found\". even when there is in fact a value it should pick up.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\nDim cabDate As String, findme As Range\nDim searchCol As Integer\n\nsearchCol = ActiveCell.Column\ncabDate = WorksheetFunction.Index(Range(\"A1:O9999\"), ActiveCell.Row, 2)\n\nIf Not IsEmpty(cabDate) Then\n    With Worksheets(\"Deadlines\").Range(\"B:B\")\n        Set findme = Application.WorksheetFunction.VLookup(cabDate, Sheets(\"Deadlines\").Range(\"A1:O9999\"), 1, False)\n        If Not findme Is Nothing Then\n            Dim findmeAddr As String\n            findmeAddr = findme.Address(True, True)\n            Dim printable As String\n            printable = findme.Offset(0, searchCol).Value\n            MsgBox (printable)\n        Else\n            MsgBox (\"Deadline not found\")\n        End If\n    End With\nElse\n    MsgBox (\"invalid or non existent cabinet date\")\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Not all that experienced with coding so any help at all would be appreciated</p>\n\n<p>Edit:\n<a href=\"https://i.stack.imgur.com/oZZ9j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oZZ9j.png\" alt=\"made up some data as the I work with confidential data\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 997, "user_id": 1766561, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/17ecb5da273e1f90bc55790ea2d1001c?s=128&d=identicon&r=PG", "display_name": "Joshua Hysong", "link": "https://stackoverflow.com/users/1766561/joshua-hysong"}, "edited": false, "score": 0, "creation_date": 1483531734, "post_id": 41463324, "comment_id": 70132344, "body": "Do you truly mean &#39;random&#39;? Do the particular cells in sheet1 need to correspond to any particular columns in sheet2? I think we need a bit more info here. What have you tried so far?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 997, "user_id": 1766561, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/17ecb5da273e1f90bc55790ea2d1001c?s=128&d=identicon&r=PG", "display_name": "Joshua Hysong", "link": "https://stackoverflow.com/users/1766561/joshua-hysong"}, "edited": false, "score": 0, "creation_date": 1483531761, "post_id": 41463324, "comment_id": 70132366, "body": "@Joshua Hysong: &#39;Random access&#39; is read that as."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1483532364, "post_id": 41463324, "comment_id": 70132745, "body": "You could start by recording a macro.  Then clean it up by eliminating all the &quot;Selects&quot; and &quot;Activates&quot; you will see there.  Plenty of examples in this forum about that.  You should also consider developing a user form to enter your selections of cells to copy.  Post back with your code if you run into problems."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7373927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8dc91ef80bda88c6c48edea0abe8473?s=128&d=identicon&r=PG&f=1", "display_name": "Darko", "link": "https://stackoverflow.com/users/7373927/darko"}, "edited": false, "score": 0, "creation_date": 1483903552, "post_id": 41464396, "comment_id": 70278909, "body": "Guys thank you all for a quick response. El dude did exactly what I needed, simple yet effective! I will try out the other two soon, I&#39;m rushing with the first one &#39;cause it&#39;s working and I&#39;m on a deadline. Thank you once more, Cheers"}], "tags": [], "owner": {"reputation": 11, "user_id": 6800848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217128c66d4e0830733fde9e6d32baa?s=128&d=identicon&r=PG&f=1", "display_name": "El Dude", "link": "https://stackoverflow.com/users/6800848/el-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1483534583, "creation_date": 1483534583, "answer_id": 41464396, "question_id": 41463324, "link": "https://stackoverflow.com/questions/41463324/copy-random-multiple-excel-cells-into-a-single-row/41464396#41464396", "title": "copy random multiple excel cells into a single row", "body": "<p>not a very elegant solution, but it works. If you don't have a header row on sheet 2 remove the +1 after iRow</p>\n\n<pre><code>Sub CopyCells()\n\nDim iRow As Integer\n\n'Get last row on sheet 2\niRow = Sheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row\n\n'copy each cell on sheet 2\nSheets(\"Sheet2\").Cells(iRow + 1, 1) = Sheets(\"Sheet1\").Range(\"J4\")\nSheets(\"Sheet2\").Cells(iRow + 1, 2) = Sheets(\"Sheet1\").Range(\"B5\")\nSheets(\"Sheet2\").Cells(iRow + 1, 3) = Sheets(\"Sheet1\").Range(\"J5\")\nSheets(\"Sheet2\").Cells(iRow + 1, 4) = Sheets(\"Sheet1\").Range(\"K6\")\nSheets(\"Sheet2\").Cells(iRow + 1, 5) = Sheets(\"Sheet1\").Range(\"D8\")\nSheets(\"Sheet2\").Cells(iRow + 1, 6) = Sheets(\"Sheet1\").Range(\"E11\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 997, "user_id": 1766561, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/17ecb5da273e1f90bc55790ea2d1001c?s=128&d=identicon&r=PG", "display_name": "Joshua Hysong", "link": "https://stackoverflow.com/users/1766561/joshua-hysong"}, "is_accepted": false, "score": 0, "last_activity_date": 1483536193, "creation_date": 1483536193, "answer_id": 41464880, "question_id": 41463324, "link": "https://stackoverflow.com/questions/41463324/copy-random-multiple-excel-cells-into-a-single-row/41464880#41464880", "title": "copy random multiple excel cells into a single row", "body": "<p>If you are wanting to enter data into another sheet when data is entered into sheet1 then I suggest looking into using the worksheet_change event. </p>\n\n<p>Here is a quick example I put together:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim KeyCells As Range\n    Dim Sheet2 As Worksheet\n    Dim lastColumn As Long\n    Dim lastRow As Long\n\n    Set KeyCells = Range(\"A1:C5\")\n    Set Sheet2 = ActiveWorkbook.Sheets(\"Sheet2\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n\n        lastRow = Sheet2.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n        ' Start on second row\n        If lastRow = 1 Then lastRow = 2\n\n        lastColumn = Sheet2.Cells(lastRow, Columns.Count).End(xlToLeft).Column\n\n        ' Move to next row after the 5th column\n        If lastColumn &gt; 5 Then\n            lastRow = lastRow + 1\n            lastColumn = 1\n        End If\n\n        Sheet2.Cells(lastRow, lastColumn + 1).Value = Target.Value\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This function will write whatever values are entered into cells A1 through C5 on Sheet1 to Sheet 2. The values will be written starting on Row 2 and after the 5th column new values will automatically be written to the next row. </p>\n\n<p>You'll need to adapt this example to your specific situation but hopefully it helps you get started in the right direction.</p>\n\n<p>If you are wanting to wait until all data is entered into sheet1 first you can easily add a button that triggers a similar macro to copy the data dynamically to the correct row/columns like above. </p>\n\n<p>Hope that helps!</p>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 7109846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01e1bb2b9f9592175575c9e19b4cc7d?s=128&d=identicon&r=PG&f=1", "display_name": "Jayant Kumar jain", "link": "https://stackoverflow.com/users/7109846/jayant-kumar-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1483687165, "creation_date": 1483687165, "answer_id": 41500858, "question_id": 41463324, "link": "https://stackoverflow.com/questions/41463324/copy-random-multiple-excel-cells-into-a-single-row/41500858#41500858", "title": "copy random multiple excel cells into a single row", "body": "<pre><code>    'It seems, you want to linearize your range.\n    'Use following code to achieve that.\n    'Plz customize as per your exact needs\n    Sub LinearizeMyRange()\n        'find last row in sheet2\n        Sheet2.Activate\n        sheet2lastrow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Row\n        'Linearize range to next row\n        n = 1\n        For Each c In Sheet1.Range(\"A1:C5\")\n        Sheet2.Cells(sheet2lastrow + 1, n) = c\n        n = n + 1\n        Next c\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7373927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8dc91ef80bda88c6c48edea0abe8473?s=128&d=identicon&r=PG&f=1", "display_name": "Darko", "link": "https://stackoverflow.com/users/7373927/darko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1483687165, "creation_date": 1483531241, "question_id": 41463324, "link": "https://stackoverflow.com/questions/41463324/copy-random-multiple-excel-cells-into-a-single-row", "title": "copy random multiple excel cells into a single row", "body": "<p>I'm a bit new to VBA so I have a question. I have 2 sheets in excel. First has a table that serves a purpose of a \"form\" for users to enter data. I need a way to copy random cells from the first sheet into a (first empty)single row on the second sheet and do so for every new entry.</p>\n\n<p>For example I need to copy data from sheet1, cells:J4,B5,J5,K6,D8,E11 to sheet2, cells: A2,B2,C2,D2,E2,F2. On the next entry in sheet1 and I need the data to go on sheet2, cells: A3,B3,C3,D3,E3,F3, on the next one to A4,B4,C4,D4,E4,F4 and so on.</p>\n\n<p>Thanks in advance to anyone and everyone who can help. </p>\n"}, {"tags": ["xml", "vba", "ms-access"], "owner": {"reputation": 135, "user_id": 6438795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh6.googleusercontent.com/-eWooblKrZbA/AAAAAAAAAAI/AAAAAAAAABI/o9hlRDOBCrY/photo.jpg?sz=128", "display_name": "vivek padelkar", "link": "https://stackoverflow.com/users/6438795/vivek-padelkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594023041, "creation_date": 1483528177, "last_edit_date": 1594023041, "question_id": 41462369, "link": "https://stackoverflow.com/questions/41462369/how-to-export-access-tables-to-xml-in-access-vba", "title": "how to export access tables to XML in access vba", "body": "<p>I'm trying to export XML file from Access table,I Created code that is used to convert the access table to .txt file ('$' delimited),can I change this code to convert the access table to .XMl or I need to code again for this,<br>\nI have following code:</p>\n\n<pre><code>sSql = \"\"\nsSql = \"SELECT * from tbl_exportFile where Upload_date=cdate(#\" &amp; Format(CDate(txtToDayDate), \"dd-MMM-yyyy\") &amp; \"#)\"\n\nIf rs.State = 1 Then rs.Close\nrs.Open sSql, con, adOpenKeyset, adLockOptimistic\n\nIf rs.RecordCount &gt; 0 Then\n    If FE.FolderExists(Application.CurrentProject.Path &amp; \"\\Reports\\\") = False Then\n       FE.CreateFolder (Application.CurrentProject.Path &amp; \"\\Reports\\\")\n    End If\n\n    F_Name1 = Application.CurrentProject.Path &amp; \"\\Reports\\\" &amp; strReportFileName &amp; \".txt\"\n\n    Set TSWrite = FE.OpenTextFile(F_Name1, ForWriting, True)\n\n    strData = \"\"\n    strData = strData &amp; \"noOfShippingBills$\"\n    strData = strData &amp; \"noOfInvoices$\"\n    strData = strData &amp; \"exportAgency$\"\n\n    TSWrite.WriteLine strData\n\n    Do While rs.EOF = False\n        strData = \"\"\n        strData = strData &amp; IIf(IsNull(rs.Fields![noOfShippingBills]), \"\", rs.Fields![noOfShippingBills]) &amp; \"$\"\n        strData = strData &amp; IIf(IsNull(rs.Fields!noOfInvoices), \"\", rs.Fields!noOfInvoices) &amp; \"$\"\n        strData = strData &amp; IIf(IsNull(rs.Fields!exportAgency), \"\", rs.Fields!exportAgency) &amp; \"$\"\n            TSWrite.WriteLine strData\n        rs.MoveNext\n    Loop    \n\n    TSWrite.Close\n\n    DoCmd.Hourglass (False)\n\n    MsgBox \"Export file Report Generated Successfully.\", vbInformation, \"RBI Macro\"\nElse\n    MsgBox \"Data not found to generate Import file Report.\", vbInformation, \"RBI Macro\"\n    DoCmd.Hourglass (False)\nEnd If\n</code></pre>\n\n<p>please help me, thanks in advance !!</p>\n"}, {"tags": ["vba", "macos", "cocoa", "powerpoint", "office-addins"], "comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1483526884, "post_id": 41461340, "comment_id": 70129212, "body": "I see you have two PowerPoint:mac add-ins. Is the first targeted for 2011 and the second for 2016? What does your pluginPath resolve to for both Mac configurations? On the system that shows the error, can you manually load the Kahani.ppam file via the PowerPoint:mac Tools/[PowerPoint ]Add-Ins... menu without the error? FYI, digital signatures added to PPAM files on Windows are ignored on a Mac."}, {"owner": {"reputation": 684, "user_id": 2024276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ct5OH.jpg?s=128&g=1", "display_name": "Sivaprasad Km", "link": "https://stackoverflow.com/users/2024276/sivaprasad-km"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1483533096, "post_id": 41461340, "comment_id": 70133248, "body": "@JamieG: First of all Please ignore the name of ppam file . I just write two ppam files. I cant able to open ppam file to powerpoint from app using the code and the same error will get once we double click on the ppam file from finder.  Yes, I can able to add the ppam file manually from powerpoint (Tools-&gt;Powerpoint addins-&gt; add) and its working like charm."}, {"owner": {"reputation": 684, "user_id": 2024276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ct5OH.jpg?s=128&g=1", "display_name": "Sivaprasad Km", "link": "https://stackoverflow.com/users/2024276/sivaprasad-km"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1483533185, "post_id": 41461340, "comment_id": 70133304, "body": "@JamieG : Finding add-in path and coping the add-in to the path and solving the issue is just my thought , I don&#39;t know is that really works. some what I have to solve this issue."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1483633744, "post_id": 41461340, "comment_id": 70185484, "body": "Start a new file, add a few lines of code then attempt to save it as an Add-in (PPAM). PowerPoint normally opens the save-as dialog box on whatever folder it considers the default for add-ins.  However, from the error message you&#39;re getting, it seems that PowerPoint is finding the file but rejecting it for some other reason/s that the error message lists."}], "owner": {"reputation": 684, "user_id": 2024276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ct5OH.jpg?s=128&g=1", "display_name": "Sivaprasad Km", "link": "https://stackoverflow.com/users/2024276/sivaprasad-km"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1593773576, "creation_date": 1483525044, "last_edit_date": 1593773576, "question_id": 41461340, "link": "https://stackoverflow.com/questions/41461340/get-the-storage-location-of-powerpoint-add-ins-mac", "title": "Get the Storage location of Powerpoint add-ins Mac", "body": "<p>I have to add the powerpoint Add-in to Powerpoint Mac from my cocoa application.I already adding the .ppam file from my cocoa application through below code</p>\n\n<pre><code> NSString *pluginPath = [[NSBundle mainBundle] pathForResource:@\"Kahani2016\" ofType:@\"ppam\"];\n    [[NSWorkspace sharedWorkspace] openFile:pluginPath];\n</code></pre>\n\n<p>Its working with most of powerpoint. \nWe can view the added powerpoint add-in from powerpoint </p>\n\n<p><a href=\"https://i.stack.imgur.com/ippHw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ippHw.png\" alt=\"\"></a></p>\n\n<p>But some systems Its showing below error message\n<a href=\"https://i.stack.imgur.com/nAAkJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nAAkJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am trying to fix this issue. I tried to fix this issue by adding digital signature with .ppam file . but its not help to solve the issue.\nI just confused because I tried to recreate this issue in another machine with same OSX and Powerpoint version but its working fine in another machine. \nMy configurations\nPowerpoint 15.29.1 Mac </p>\n\n<p>So if I get the location of the powerpoint-Addin , then I can try to copy my add-ins to the location and fix the issue.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1483523480, "post_id": 41460705, "comment_id": 70127066, "body": "if you will try to indent your code properly, you&#39;ll find you have <b>One</b> <code>For Each cellSource In rngSource</code> and <b>Two</b> <code>Next cell</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7373321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3138f60d218dec611719e6835b93ff2?s=128&d=identicon&r=PG&f=1", "display_name": "Mdugo Trading", "link": "https://stackoverflow.com/users/7373321/mdugo-trading"}, "edited": false, "score": 0, "creation_date": 1483532370, "post_id": 41460855, "comment_id": 70132749, "body": "Oooh Ok. Thanks for that. I have rectified the mistake, but still i cannot assign the values to cellTarget on sheet2. Please take a closely look at my code where i assigned the cellTarget from cellSource using the loop if value is greater than 9."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 5, "user_id": 7373321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3138f60d218dec611719e6835b93ff2?s=128&d=identicon&r=PG&f=1", "display_name": "Mdugo Trading", "link": "https://stackoverflow.com/users/7373321/mdugo-trading"}, "edited": false, "score": 0, "creation_date": 1483532916, "post_id": 41460855, "comment_id": 70133102, "body": "without your data it&#39;s hard to tell. step through your code (press F8 to start macro and keep pressing it to jump to next statement to be executed) and querying relevant variables trough Immediate Window (e.g.: type <code>?cellSource.Address, cellSource.Value</code> and press return) to see what&#39;s going on. If you get stuck make a new post following <a href=\"http://stackoverflow.com/help/asking\">How to create a Minimal, Complete, and Verifiable example</a> rules. As to this post you may want to mark my answer as accepted since I solved its <i>Error says &quot;Invalid Next Control Variable Reference&quot;</i> issue. Thank you"}, {"owner": {"reputation": 5, "user_id": 7373321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3138f60d218dec611719e6835b93ff2?s=128&d=identicon&r=PG&f=1", "display_name": "Mdugo Trading", "link": "https://stackoverflow.com/users/7373321/mdugo-trading"}, "edited": false, "score": 0, "creation_date": 1484123269, "post_id": 41460855, "comment_id": 70375760, "body": "Thank you!!! Of-cause yes You have fixed that error... i will try to  rewrite the correct question. Thanks  for your Response"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 5, "user_id": 7373321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3138f60d218dec611719e6835b93ff2?s=128&d=identicon&r=PG&f=1", "display_name": "Mdugo Trading", "link": "https://stackoverflow.com/users/7373321/mdugo-trading"}, "edited": false, "score": 0, "creation_date": 1484127190, "post_id": 41460855, "comment_id": 70378058, "body": "You are welcome. Since my answer solved your <i>original</i> question you may then want to mark it as accepted. Thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1483523681, "creation_date": 1483523681, "answer_id": 41460855, "question_id": 41460705, "link": "https://stackoverflow.com/questions/41460705/excel-vba-2016-passing-range-cells-to-another-sheet-as-calculated/41460855#41460855", "title": "Excel VBA 2016 Passing range cells to another sheet as calculated", "body": "<p>you</p>\n\n<ul>\n<li><p>either susbtitute </p>\n\n<p>first <code>Next cell</code> with <code>Next cellTarget</code></p>\n\n<p>second <code>Next cell</code> with <code>Next cellSource</code></p></li>\n<li><p>or just substitute each <code>Next cell</code> with <code>Next</code></p></li>\n</ul>\n\n<p>what follows is the second <em>option</em>:</p>\n\n<pre><code>Sub main()\n    Dim rngSource As Range, cellSource As Range\n    Dim rngTagert As Range, cellTarget As Range\n\n    Set rngSource = Range(\"SourceRange\") 'Sheet1\n    Set rngTagert = Range(\"TargetRange\") 'Sheet2\n\n    For Each cellSource In rngSource\n        If cellSource.value &gt;= 9 Then\n            For Each cellTarget In rngTagert\n                cellTarget.value = cellSource.value - 9 'Sheet2 Cell.Value = Sheet1 Cell.Value -9\n            Next\n        Else\n            cellSource.value = cellSource.value 'Sheet1 cellTarget.Value = cellTarget.Value 'Sheet2\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7373321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3138f60d218dec611719e6835b93ff2?s=128&d=identicon&r=PG&f=1", "display_name": "Mdugo Trading", "link": "https://stackoverflow.com/users/7373321/mdugo-trading"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 41460855, "answer_count": 1, "score": 0, "last_activity_date": 1483530164, "creation_date": 1483523231, "last_edit_date": 1483530164, "question_id": 41460705, "link": "https://stackoverflow.com/questions/41460705/excel-vba-2016-passing-range-cells-to-another-sheet-as-calculated", "title": "Excel VBA 2016 Passing range cells to another sheet as calculated", "body": "<p>I am looking for a code to loop through a named range cells values if they are greater than 9 in sheet1. if the Cells value(>9) is found pass that cell value to sheet2 as calculated value</p>\n\n<p>The format is like: <code>Sheet2.Range(name).Cells.value = Sheet1.Range(name).Cells.value</code></p>\n\n<p>Currently i managed to check those values in sheet1 and it works.</p>\n\n<p>I am failing to assign the value in sheet2 cellTarget looping</p>\n\n<p><strong>code:</strong></p>\n\n<pre><code>Dim rngSource As Range, cellSource As Range\nDim rngTagert As Range, cellTarget As Range\n\nSet rngSource = Range(\"SourceRange\") 'Sheet1\nSet rngTagert = Range(\"TargetRange\") 'Sheet2\n\nFor Each cellSource In rngSource\n    If cellSource.Value &gt;= 9 Then\n        For Each cellTarget In rngTagert\n            cellTarget.Value = cellSource.Value - 9\n        Next cellTarget\n    Else\n        cellTarget.Value = cellTarget.Value\n    End If\nNext cellSource\n</code></pre>\n\n<p>Error says \"Invalid Next Control Variable Reference\"</p>\n\n<p>Many Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1483524033, "post_id": 41460680, "comment_id": 70127399, "body": "is <code>Sheet2</code> suppose to be your worksheet&#39;s name ? or the index ?"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1483530178, "post_id": 41460680, "comment_id": 70131383, "body": "Please update your question to clarify what <code>Ess1Volt</code> refers to. We guess that <code>Sheet2</code> refers to <code>Worksheets(&quot;Sheet2&quot;)</code> but no-one has any idea what your <code>Ess1Volt</code> is."}, {"owner": {"reputation": 1, "user_id": 7373360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90d9f0dc99777249c40f180c297ed924?s=128&d=identicon&r=PG&f=1", "display_name": "Steve R", "link": "https://stackoverflow.com/users/7373360/steve-r"}, "edited": false, "score": 0, "creation_date": 1483586266, "post_id": 41460680, "comment_id": 70159408, "body": "&quot;Ess1Volt&quot; is the name of the text box. It displays the Essential Bus 1 Voltage. Part of the DC electrical circuit i&#39;m animating. I have 2 sheets in the workbook. Sheet 1 displays the electrical wiring diagram, with switches that you can turn on/off. Sheet 2 is the Graphic Display that would be visible to the pilot. I&#39;ll have the circuit up on the whiteboard and the cockpit display on my laptop. I&#39;ve animated a few other systems fire protection, brakes etc, but the DC electrical system is much more complicated!"}], "answers": [{"comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1483529573, "post_id": 41461235, "comment_id": 70130999, "body": "You can definitely do <code>SheetX.Range(&quot;A1&quot;).Value = &quot;foo&quot;</code> or whatever - if <code>SheetX</code> is the name of the sheet object. You can check that in the Properties window in the VBE by selecting a sheet in the Project pane. Agree, as always, about using <code>Option Explicit</code>"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1483529936, "post_id": 41461235, "comment_id": 70131233, "body": "Yes, and same goes with Ess1Volt, wtf is that? Option explicit FTW!"}, {"owner": {"reputation": 1, "user_id": 7373360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90d9f0dc99777249c40f180c297ed924?s=128&d=identicon&r=PG&f=1", "display_name": "Steve R", "link": "https://stackoverflow.com/users/7373360/steve-r"}, "edited": false, "score": 0, "creation_date": 1483585937, "post_id": 41461235, "comment_id": 70159354, "body": "&quot;Ess1Volt&quot; is the name of the text box. It displays the Essential Bus 1 Voltage. Part of the DC electrical circuit i&#39;m animating."}, {"owner": {"reputation": 1, "user_id": 7373360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90d9f0dc99777249c40f180c297ed924?s=128&d=identicon&r=PG&f=1", "display_name": "Steve R", "link": "https://stackoverflow.com/users/7373360/steve-r"}, "edited": false, "score": 0, "creation_date": 1483603870, "post_id": 41461235, "comment_id": 70165329, "body": "I&#39;ve found out what the problem is. All the textboxes that were on the worksheet have converted to objects. How I did that I do not know. If I place a &#39;new&#39; textbox on the sheet and rewrite the code from &#39;Ess1volt&#39; to textbox1 it works. Anyone got an idea what i did? is there a way of converting them back?"}], "tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 0, "last_activity_date": 1483524740, "creation_date": 1483524740, "answer_id": 41461235, "question_id": 41460680, "link": "https://stackoverflow.com/questions/41460680/textbox-method-or-data-member-not-found/41461235#41461235", "title": "Textbox &quot;Method or data member not found&quot;", "body": "<p>use option explicit to avoid such mistakes. ;-)</p>\n\n<p>Sheet2 isn't declared as a worksheet (dim Sheet2 as worksheet  //  set sheet2= whatever ) , so I assume you meant Worksheets(\"Sheet2\") </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10218581, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHz_GO-x5q4/AAAAAAAAAAI/AAAAAAAAGIM/iCrnHqdb9P8/photo.jpg?sz=128", "display_name": "Ascanio Vandooren", "link": "https://stackoverflow.com/users/10218581/ascanio-vandooren"}, "is_accepted": false, "score": 0, "last_activity_date": 1534155460, "last_edit_date": 1534155460, "creation_date": 1534153310, "answer_id": 51819448, "question_id": 41460680, "link": "https://stackoverflow.com/questions/41460680/textbox-method-or-data-member-not-found/51819448#51819448", "title": "Textbox &quot;Method or data member not found&quot;", "body": "<p>The same thing happened to me. After deleting the textbox and recreating it, everything worked just fine.</p>\n"}], "owner": {"reputation": 1, "user_id": 7373360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90d9f0dc99777249c40f180c297ed924?s=128&d=identicon&r=PG&f=1", "display_name": "Steve R", "link": "https://stackoverflow.com/users/7373360/steve-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 976, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534155460, "creation_date": 1483523167, "last_edit_date": 1531164843, "question_id": 41460680, "link": "https://stackoverflow.com/questions/41460680/textbox-method-or-data-member-not-found", "title": "Textbox &quot;Method or data member not found&quot;", "body": "<p>I am writing an aircraft system emulation using Excel (2013) VBA, Windows 10. I have macros which will allow students to operate the system and display it on the screen. Before the xmas break i was doing some  development work and it was working fine. However I have come back to it today I am getting a \"Method or data member not found\" for some of the textboxes, which are still showing the correct names. I would say that in design mode I can't access the textbox properties. </p>\n\n<p>This is the code that was working:</p>\n\n<pre><code>Sub Batt_MasterOFFExample()\n\n    ' Indications\n    Sheet2.Ess1Volt.Text = \"---V\"\n    With Sheet2.Ess1Volt\n        .ForeColor = &amp;HFFFFFF\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Now when I run it it highlights <code>Sheet2.Ess1Volt.Text = \"---V\"</code> and gives me the error.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1483522971, "post_id": 41460528, "comment_id": 70126768, "body": "you need to have the <code>Copy</code> &gt;&gt; <code>Paste</code> without the <code>ClearContents</code> in the middle. Also, modify yout <code>PasteSpecial</code> to <code>ThisWorkbook.Sheets(&quot;final&quot;).Range(&quot;C4&quot;).PasteSpecial xlPasteAll</code> . Besided that, your entire code is a mess ! all this <code>Select</code> , <code>Selection</code> ...."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1483524523, "post_id": 41460528, "comment_id": 70127695, "body": "what is the value of lrow just before you invoke ActiveSheet.Range(&quot;A5:AF&quot; &amp; lrow).Copy?"}], "owner": {"reputation": 111, "user_id": 7062926, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e37e4967447e1758594cd4bfaffc4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sabir Moglad", "link": "https://stackoverflow.com/users/7062926/sabir-moglad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 819, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483523520, "creation_date": 1483522693, "last_edit_date": 1483523520, "question_id": 41460528, "link": "https://stackoverflow.com/questions/41460528/pastespecial-method-of-range-class-failed", "title": "pasteSpecial method of Range class failed", "body": "<p>sometimes I don't get Excel VBA, I am just copying data from one sheet to another but I get the error :</p>\n\n<blockquote>\n  <p>pasteSpecial method of Range class failed</p>\n</blockquote>\n\n<p>I copy some date from a source in the internet, paste it in \"temporary\" sheet,deleted some columns, do some calculations, and paste it into \"final\" sheet.\nhere is my code:</p>\n\n<pre><code>    Sub copying()\n'\n' copying Macro\n'\nApplication.Calculation = xlManual\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n\n  Dim tempSheet As Worksheet\n\nSet tempSheet = ThisWorkbook.Sheets(\"temporary\")\n\ntempSheet.Activate\n\n\n\n    tempSheet.Cells.ClearFormats\n\n    tempSheet.Cells(4, 1).Select\n    ActiveSheet.Paste\n\n\n    Columns(4).Select\n    Selection.Cut\n    Columns(3).Select\n    ActiveSheet.Paste\n\n     Columns(6).Select\n    Selection.Cut\n    Columns(4).Select\n    ActiveSheet.Paste\n\n    '\n     Columns(7).Select\n    Selection.Cut\n    Columns(5).Select\n    ActiveSheet.Paste\n\n     Columns(8).Select\n     Selection.ClearFormats\n\n\n    Columns(8).Select\n    Selection.Cut\n    Columns(6).Select\n    ActiveSheet.Paste\n\n\n      Columns(9).Select\n    Selection.Cut\n    Columns(7).Select\n    ActiveSheet.Paste\n\n      Columns(19).Select\n    Selection.Cut\n    Columns(8).Select\n    ActiveSheet.Paste\n\n\n\n\n\n      Columns(21).Select\n    Selection.Cut\n    Columns(9).Select\n    ActiveSheet.Paste\n\n\n\n    Columns(10).Select\n     Selection.ClearFormats\n     Selection.ClearContents\n\n\n    Columns(73).Select\n    Selection.Cut\n    Columns(11).Select\n    ActiveSheet.Paste\n\n      Columns(23).Select\n    Selection.Cut\n    Columns(12).Select\n    ActiveSheet.Paste\n\n      Columns(25).Select\n    Selection.Cut\n    Columns(13).Select\n    ActiveSheet.Paste\n\n\n      Columns(14).Select\n     Selection.ClearFormats\n     Selection.ClearContents\n\n\n\n\n\n      Columns(37).Select\n    Selection.Cut\n    Columns(21).Select\n    ActiveSheet.Paste\n\n\n\n      Columns(22).Select\n     Selection.ClearFormats\n     Selection.ClearContents\n\n\n\n         Columns(76).Select\n    Selection.Cut\n    Columns(23).Select\n    ActiveSheet.Paste\n\n\n\n    Range(\"X1\").Select\n\n    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\n\n    Selection.ClearContents\n\n\nColumns(\"E:E\").Select\n    Selection.NumberFormat = \"m/d/yyyy\"\n\n    Columns(\"F:F\").Select\n    Selection.NumberFormat = \"m/d/yyyy\"\n\n      Columns(\"L:L\").Select\n    Selection.NumberFormat = \"0.00\"\n\n\n      Columns(\"H:H\").Select\n    Selection.NumberFormat = \"0.00\"\n\n     Columns(8).Select\n    Selection.NumberFormat = \"0.00\"\n\n     Columns(9).Select\n    Selection.NumberFormat = \"0.00\"\n\n     Columns(10).Select\n    Selection.NumberFormat = \"0.00\"\n\n\n\n\n     Columns(12).Select\n    Selection.NumberFormat = \"0.00\"\n\n     Columns(13).Select\n    Selection.NumberFormat = \"0.00\"\n\n     Columns(14).Select\n    Selection.NumberFormat = \"0.00\"\n\n\n\n\n\n     Columns(16).Select\n    Selection.NumberFormat = \"0.00\"\n\n     Columns(17).Select\n    Selection.NumberFormat = \"0.00\"\n\n     Columns(18).Select\n    Selection.NumberFormat = \"0.00\"\n\n\n     Columns(20).Select\n    Selection.NumberFormat = \"0.00\"\n\n     Columns(21).Select\n    Selection.NumberFormat = \"0.00\"\n\n     Columns(22).Select\n    Selection.NumberFormat = \"0.00\"\n\n\n   ' Debug.Print Cells(10, 2)\n lrow = Cells(Rows.Count, \"C\").End(xlUp).row\n\n\n 'debig.Print Cells(2, 9).Value\n    Dim i As Integer\n    For i = 5 To lrow\n    ' calculating the UM = NS - CoS\n\n\n    'for SDP3\n    If (Cells(i, 8).Value = \"Missing Data\" Or Cells(i, 9).Value = \"Missing Data\") Then\n    Cells(i, 10).Value = \"Missing Data\"\n    Else\n    Cells(i, 10).Value = Cells(i, 8).Value - Cells(i, 9).Value\n    End If\n\n    'TG2\nIf (Cells(i, 12).Value = \"Missing Data\" Or Cells(i, 13).Value = \"Missing Data\") Then\n    Cells(i, 14).Value = \"Missing Data\"\n    Else\n\n Cells(i, 14).Value = Cells(i, 12).Value - Cells(i, 13).Value\n   End If\n\n' PTD\nIf (Cells(i, 16).Value = \"Missing Data\" Or Cells(i, 17).Value = \"Missing Data\") Then\n    Cells(i, 18).Value = \"Missing Data\"\n    Else\n   Cells(i, 18).Value = Cells(i, 16).Value - Cells(i, 17).Value\n    End If\n\n' PTE\nIf (Cells(i, 20).Value = \"Missing Data\" Or Cells(i, 21).Value = \"Missing Data\") Then\n    Cells(i, 22).Value = \"Missing Data\"\n    Else\n   Cells(i, 22).Value = Cells(i, 20).Value - Cells(i, 21).Value\n    End If\n\n'%UM DEVIATION = UM% of the second - UM%\n'SDP3 --- TG2\nIf (Cells(i, \"K\").Value = \"N/A\" Or Cells(i, \"O\").Value = \"N/A\") Then\n    Cells(i, \"Y\").Value = \"N/A\"\n    Else\n   Cells(i, \"Y\").Value = Cells(i, \"O\").Value - Cells(i, \"K\").Value\n    End If\n\n'SDP3 --- PTE\nIf (Cells(i, \"K\").Value = \"N/A\" Or Cells(i, \"S\").Value = \"N/A\") Then\n    Cells(i, \"AB\").Value = \"N/A\"\n    Else\n   Cells(i, \"AB\").Value = Cells(i, \"S\").Value - Cells(i, \"K\").Value\n    End If\n\n\n'TG2 -- PTE\nIf (Cells(i, \"O\").Value = \"N/A\" Or Cells(i, \"S\").Value = \"N/A\") Then\n    Cells(i, \"AE\").Value = \"N/A\"\n    Else\n   Cells(i, \"AE\").Value = Cells(i, \"S\").Value - Cells(i, \"O\").Value\n    End If\n\n\n' DEV MSEK if (UM% of both &lt; 0 -&gt; %UM * NS of the second)\n'SDP3 --- TG2\nIf (Cells(i, \"Y\").Value = \"N/A\" Or Cells(i, \"L\").Value = \"N/A\") Then\nCells(i, \"X\").Value = \"N/A\"\nElse\n    If (Cells(i, \"Y\").Value &lt; 0) Then\n\n    Cells(i, \"X\").Value = 0\n    Else\n     Cells(i, \"X\").Value = Cells(i, \"Y\").Value * Cells(i, \"L\").Value\n\n    End If\n\nEnd If\n\n\n\n\n'SDP3 --- PTE\nIf (Cells(i, \"AB\").Value = \"N/A\" Or Cells(i, \"P\").Value = \"N/A\") Then\nCells(i, \"AA\").Value = \"N/A\"\nElse\n    If (Cells(i, \"AB\").Value &lt; 0) Then\n\n    Cells(i, \"AA\").Value = 0\n    Else\n     Cells(i, \"AA\").Value = Cells(i, \"AB\").Value * Cells(i, \"P\").Value\n\n    End If\n\nEnd If\n\n\n\n\n\n'TG2 -- PTE\nIf (Cells(i, \"AE\").Value = \"N/A\" Or Cells(i, \"P\").Value = \"N/A\") Then\nCells(i, \"AD\").Value = \"N/A\"\nElse\n    If (Cells(i, \"AE\").Value &lt; 0) Then\n\n    Cells(i, \"AD\").Value = 0\n    Else\n     Cells(i, \"AD\").Value = Cells(i, \"AE\").Value * Cells(i, \"P\").Value\n\n    End If\n\nEnd If\n\n' indicators Y,AB,AE   - &gt; Z, AC , AF\nIf (Cells(i, \"Y\").Value = \"N/A\") Then\nCells(i, \"Z\").Value = \"N/A\"\nElse\n    If (Cells(i, \"Y\").Value &lt; 0) Then\n    Cells(i, \"Z\").Value = Chr(226)\n    Cells(i, \"Z\").Font.Name = \"Wingdings\"\n    Cells(i, \"Z\").Font.Color = vbRed\n    ElseIf (Cells(i, \"Y\").Value &gt; 0) Then\n    Cells(i, \"Z\").Value = Chr(225)\n    Cells(i, \"Z\").Font.Name = \"Wingdings\"\n    Cells(i, \"Z\").Font.Color = vbGreen\n    Else\n    Cells(i, \"Z\").Value = \"-\"\n    End If\nEnd If\n\nIf (Cells(i, \"AB\").Value = \"N/A\") Then\nCells(i, \"AC\").Value = \"N/A\"\nElse\n    If (Cells(i, \"AB\").Value &lt; 0) Then\n    Cells(i, \"AC\").Value = Chr(226)\n    Cells(i, \"AC\").Font.Name = \"Wingdings\"\n    Cells(i, \"AC\").Font.Color = vbRed\n    ElseIf (Cells(i, \"AB\").Value &gt; 0) Then\n    Cells(i, \"AC\").Value = Chr(225)\n    Cells(i, \"AC\").Font.Name = \"Wingdings\"\n    Cells(i, \"AC\").Font.Color = vbGreen\n    Else\n    Cells(i, \"AC\").Value = \"-\"\n    End If\nEnd If\n\n\nIf (Cells(i, \"AE\").Value = \"N/A\") Then\nCells(i, \"AF\").Value = \"N/A\"\nElse\n    If (Cells(i, \"AE\").Value &lt; 0) Then\n    Cells(i, \"AF\").Value = Chr(226)\n    Cells(i, \"AF\").Font.Name = \"Wingdings\"\n    Cells(i, \"AF\").Font.Color = vbRed\n    ElseIf (Cells(i, \"AE\").Value &gt; 0) Then\n    Cells(i, \"AF\").Value = Chr(225)\n    Cells(i, \"AF\").Font.Name = \"Wingdings\"\n    Cells(i, \"AF\").Font.Color = vbGreen\n    Else\n    Cells(i, \"AF\").Value = \"-\"\n    End If\nEnd If\nNext\n    ' format the columns\nColumns(\"Y:Y\").Select\n    Selection.NumberFormat = \"0.00%\"\n\n\n    Columns(\"AB:AB\").Select\n    Selection.NumberFormat = \"0.00%\"\n\n\n    Columns(\"AE:AE\").Select\n    Selection.NumberFormat = \"0.00%\"\n\n    ActiveSheet.Range(\"A5:AF\" &amp; lrow).Copy\n\n\n    ThisWorkbook.Worksheets(\"final\").Activate\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n     lrowFinal = Cells(Rows.Count, \"C\").End(xlUp).row\n     If lrowFinal &lt; 4 Then\n     lrowFinal = 4\n     End If\n\n\n     ThisWorkbook.Sheets(\"final\").Range(\"C3:AH\" &amp; lrowFinal).ClearContents\n\n\n\n\n     ThisWorkbook.Sheets(\"final\").Range(\"C4\").PasteSpecial (Excel.XlPasteType.xlPasteAll)\n    'ActiveSheet.PasteSpecial Paste:=xlPasteValues\n    'PasteAsLocalFormula\n\n    Application.CutCopyMode = False\n\nWith ActiveSheet\n\n        .AutoFilterMode = False\n\n        .Range(\"C4\").CurrentRegion.AutoFilter\n\n    End With\n\n\n     Application.Calculation = xlCalculationAutomatic\n  Application.ScreenUpdating = True\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>the error happens a few lines at the end at:</p>\n\n<blockquote>\n  <p>ThisWorkbook.Sheets(\"final\").Range(\"C4\").PasteSpecial (Excel.XlPasteType.xlPasteAll)</p>\n</blockquote>\n\n<p>what did I do wrong, I tried many fixes but none worked</p>\n\n<p>EDIT:</p>\n\n<p>I changed the copying code to the following but I am still getting the error:</p>\n\n<pre><code>    ThisWorkbook.Sheets(\"final\").Activate\n\n     Application.Wait (Now + TimeValue(\"0:00:01\"))\n lrowFinal = Cells(Rows.Count, \"C\").End(xlUp).row\n If lrowFinal &lt; 4 Then\n lrowFinal = 4\n End If\n\n\nActiveSheet.Range(\"C3:AH\" &amp; lrowFinal).ClearContents\n\nSheets(\"temporary\").Activate\n\nActiveSheet.Range(\"A5:AF\" &amp; lrow).Copy\n\n\nThisWorkbook.Worksheets(\"final\").Activate\n\n\n ActiveSheet.Range(\"C4\").PasteSpecial xlPasteAll\n</code></pre>\n"}, {"tags": ["excel", "vba", "clipboard"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1483524286, "post_id": 41460446, "comment_id": 70127546, "body": "since you know how to populate a listbox from a source table, why don&#39;t you do that right before (and avoid) copying data into clipboard?"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1483525641, "post_id": 41460446, "comment_id": 70128416, "body": "Post some code and we&#39;ll try to help if it&#39;s not working.  And yes you are right, it is a stupid question for SO."}, {"owner": {"reputation": 307, "user_id": 4704290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l3RmA.jpg?s=128&g=1", "display_name": "svacx", "link": "https://stackoverflow.com/users/4704290/svacx"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1483526174, "post_id": 41460446, "comment_id": 70128781, "body": "Where do you recommend posting this into? @MarkFitzgerald"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1483526208, "post_id": 41460446, "comment_id": 70128801, "body": "I don&#39;t think it is possible. If I remember correctly you can assign all items at once <code>ListBox1.List = Split(&quot;a b c&quot;)</code>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1483533354, "post_id": 41460446, "comment_id": 70133414, "body": "A perfectly reasonable question."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 1, "creation_date": 1483534794, "post_id": 41460446, "comment_id": 70134357, "body": "See also: <a href=\"http://stackoverflow.com/questions/5552299/how-to-copy-to-clipboard-using-access-vba\" title=\"how to copy to clipboard using access vba\">stackoverflow.com/questions/5552299/&hellip;</a> (identical for Access and Excel, since it&#39;s both VBA)"}], "answers": [{"tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": true, "score": 1, "last_activity_date": 1483533262, "last_edit_date": 1483533262, "creation_date": 1483524527, "answer_id": 41461154, "question_id": 41460446, "link": "https://stackoverflow.com/questions/41460446/copy-from-clipboard-and-paste-into-a-userform/41461154#41461154", "title": "Copy from clipboard and paste into a userform", "body": "<p>This copyies any info in the current selection in clipboard and puts it into a textbox,</p>\n\n<pre><code>Dim clipBoard As MsForms.DataObject\nSet clipBoard = New MsForms.DataObject\n\nclipBoard.GetFromClipboard\nTextBox1.Value = clipBoard.GetText(1)\n</code></pre>\n\n<p>Of course you can adapt this to have the data put into different form controls.  You will need to handle when the clipboard is empty.</p>\n"}], "owner": {"reputation": 307, "user_id": 4704290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l3RmA.jpg?s=128&g=1", "display_name": "svacx", "link": "https://stackoverflow.com/users/4704290/svacx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2028, "favorite_count": 0, "accepted_answer_id": 41461154, "answer_count": 1, "score": 0, "last_activity_date": 1575245160, "creation_date": 1483522489, "last_edit_date": 1575245160, "question_id": 41460446, "link": "https://stackoverflow.com/questions/41460446/copy-from-clipboard-and-paste-into-a-userform", "title": "Copy from clipboard and paste into a userform", "body": "<p>I am using a program that populates a table with data, and the sizes (col/row) of these table grows every period in an unpredicted way. </p>\n\n<p>So let's say I copy the contents of the table into clipboard, and what I want to know is:</p>\n\n<p><strong>Is it possible to paste this data into some sort of userform instead of going to an Excel sheet and then loading the source into a listbox?</strong> </p>\n\n<p>I couldn't find any source material on this. I was interested to know if it was possible or if not, why it's not a good idea to do this! </p>\n\n<p>I did find a lot of material about using the source of a table to populate a listbox, or, using a right click to copy data from a userform, but not the other way around.</p>\n"}, {"tags": ["vba", "excel", "drop-down-menu"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7373208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953e589a54093d5eedf6771779caed2b?s=128&d=identicon&r=PG&f=1", "display_name": "Danielle Parker", "link": "https://stackoverflow.com/users/7373208/danielle-parker"}, "edited": false, "score": 0, "creation_date": 1483611592, "post_id": 41460596, "comment_id": 70169834, "body": "Thank you for your response!  Sorry my question was so convoluted!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1483522898, "creation_date": 1483522898, "answer_id": 41460596, "question_id": 41460172, "link": "https://stackoverflow.com/questions/41460172/excel-drop-down-list-auto-select/41460596#41460596", "title": "Excel Drop Down List Auto-Select", "body": "<p>you don't need VBA</p>\n\n<p>assuming:</p>\n\n<ul>\n<li><p>your table of work hours is in cells G4:K28</p></li>\n<li><p>your table of work hours \"person\" headers are in cells G2:K2 </p></li>\n<li><p>your table of work \"dates\" are in cells F4:F28</p></li>\n<li><p>your first date drop down list is in cell C4</p></li>\n<li><p>your \"person #\" cells to write hours into are in cells C5:C9</p></li>\n</ul>\n\n<p>then you can write the following formula in cell C5</p>\n\n<pre><code>=INDEX($G$4:$K$16,MATCH($C$4,$F$4:$F$16,0),MATCH(Left($B5,Len($B5)-1),$G$2:$K$2,0))\n</code></pre>\n\n<p>and drag it down to other cells</p>\n"}], "owner": {"reputation": 3, "user_id": 7373208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953e589a54093d5eedf6771779caed2b?s=128&d=identicon&r=PG&f=1", "display_name": "Danielle Parker", "link": "https://stackoverflow.com/users/7373208/danielle-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "accepted_answer_id": 41460596, "answer_count": 1, "score": -1, "last_activity_date": 1483624211, "creation_date": 1483521693, "last_edit_date": 1483624211, "question_id": 41460172, "link": "https://stackoverflow.com/questions/41460172/excel-drop-down-list-auto-select", "title": "Excel Drop Down List Auto-Select", "body": "<p>See My spreadsheet here <a href=\"https://i.stack.imgur.com/MNxHL.png\" rel=\"nofollow noreferrer\">My Spread Sheet</a>, I have circled where the 3 drop down lists are.</p>\n\n<p>I have recently started trying to do some very basic VBA in Excel. In my current spread sheet I have a table of work hours, which is filled in by selecting a date from a drop down list and then selecting the hours worked for each person from a drop down list per person, finally \"set\" is selected from a 3rd drop down list which results in the table being filled with the right time for the given date. </p>\n\n<p>Bearing in mind I am new to this, what I want to know is if there is a way so that when a date is selected for the first drop down list, the drop down lists for each person will autoselect the time which is already in the table?</p>\n\n<p>For example if the 26/10/2016 were selected in the first date drop down list, below person 1 would autoselect \"02:25\"from the drop downlist, person 2 would autoselecgt \"03:00\" from the drop down list, person 3 would select \"OFF\", person 4 \"OFF\" and finally person 5 would auto select \"OFF\" from the drop down list. See <a href=\"https://i.stack.imgur.com/eC7Wu.png\" rel=\"nofollow noreferrer\">SpreadSheet</a></p>\n\n<p>I hope that makes sense! </p>\n\n<p>Thanks for any help you can give!</p>\n\n<p>Dani</p>\n\n<p>EDIT:</p>\n\n<p>So I took the formula you provided and I wrote some very simple VBA anyway (as this is more of an academic project) so that when the date in the drop down list changes it updates the times. I have removed the drop down lists that were used for the changing the times. Once again, thank you for your help @user3598756</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target = Range(\"C4\") Then\n\n        Application.EnableEvents = False\n\n        ActiveSheet.Range(\"C6\").FormulaLocal = \"=INDEX($G$4:$K$35,MATCH($C$4,$F$4:$F$35,0),MATCH(Left($B6,Len($B6)),$G$2:$K$2,0))\"\n\n        ActiveSheet.Range(\"C7\").FormulaLocal = \"=INDEX($G$4:$K$35,MATCH($C$4,$F$4:$F$35,0),MATCH(LEFT($B7,LEN($B7)),$G$2:$K$2,0))\"\n\n        ActiveSheet.Range(\"C8\").FormulaLocal = \"=INDEX($G$4:$K$35,MATCH($C$4,$F$4:$F$35,0),MATCH(LEFT($B8,LEN($B8)),$G$2:$K$2,0))\"\n\n        ActiveSheet.Range(\"C9\").FormulaLocal = \"=INDEX($G$4:$K$35,MATCH($C$4,$F$4:$F$35,0),MATCH(LEFT($B9,LEN($B9)),$G$2:$K$2,0))\"\n\n        ActiveSheet.Range(\"C10\").FormulaLocal = \"=INDEX($G$4:$K$35,MATCH  ($C$4,$F$4:$F$35,0),MATCH(LEFT($B10,LEN($B10)),$G$2:$K$2,0))\"\n\nApplication.EnableEvents = True\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "powerpoint", "vba"], "answers": [{"tags": [], "owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "is_accepted": true, "score": 0, "last_activity_date": 1483550731, "creation_date": 1483550731, "answer_id": 41469816, "question_id": 41459678, "link": "https://stackoverflow.com/questions/41459678/changing-slidesize-in-powerpoint-using-vba-in-excel/41469816#41469816", "title": "Changing SlideSize in PowerPoint Using VBA in Excel", "body": "<p>If you are using late binding to automate PowerPoint then you will have to define the constant.</p>\n\n<p><code>Const ppSlideSizeA4Paper = 3</code> </p>\n"}], "owner": {"reputation": 105, "user_id": 7373202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcaeb3d2fe3206462b3bab3d8d4e5eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/7373202/andi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 41469816, "answer_count": 1, "score": 0, "last_activity_date": 1483550731, "creation_date": 1483519953, "last_edit_date": 1531164843, "question_id": 41459678, "link": "https://stackoverflow.com/questions/41459678/changing-slidesize-in-powerpoint-using-vba-in-excel", "title": "Changing SlideSize in PowerPoint Using VBA in Excel", "body": "<p>I am working on a VBA Code converting my numerous excel worksheets to a powerpoint presentation. The code works fine but I need to convert my SlideSize to A4 format for printing. For creating the presentation i am using a template of my company. When I create a new PPT from this template it is always in A4. When my code creates one it is in 4:3.\nChanging the SlideSize in PageSetup doesn't work.</p>\n\n<p>Here is an excerpt of my code:</p>\n\n<pre><code>Dim oPP As Object\nDim oPPT As Object\nDim oPPTslide As Object\n\nSet oPP = CreateObject(\"PowerPoint.Application\")\noPP.Visible = True\nSet oPPT = oPP.Presentations.Add\noPPT.ApplyTemplate {Template Name and Path}\noPPT.PageSetup.SlideSize = ppSlideSizeA4Paper    \n</code></pre>\n\n<p>I always get an error <i>PageSetup.SlideSize: Invalid enumeration value.</i></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1483560514, "post_id": 41459503, "comment_id": 70150467, "body": "Make sure that every variable except <code>myList</code> is local to the <code>listImages</code> function."}, {"owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1483613742, "post_id": 41459503, "comment_id": 70171189, "body": "I&#39;m not sure what you mean and don&#39;t fully understand I&#39;m afraid."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1483628357, "post_id": 41459503, "comment_id": 70181556, "body": "<code>myList</code> is a local variable within <code>listImages</code> so it gets start over every time you call the function. Remove <code>Dim myList As String</code> and add <code>Public myList As String</code> outside of any function. Then make sure you set <code>myList=&quot;&quot;</code> before the very first time you call <code>listImages</code> OUTSIDE the <code>listImages</code> function."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1483677572, "post_id": 41459503, "comment_id": 70203807, "body": "Just checked your code, worked for me fine. myList declaration is OK if all you need - just Debug.Print text. If you need function, which returns the string with files, declare myList as <code>Static</code> and add resetting of myList for not recursive calls or use public variable as proposed above"}, {"owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "edited": false, "score": 0, "creation_date": 1484046765, "post_id": 41459503, "comment_id": 70338860, "body": "I still cannot get this to work.  If I declare Public myList As Static then I receive the error &quot;Expected: New or type name&quot;"}], "owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1483519417, "creation_date": 1483519417, "last_edit_date": 1495541238, "question_id": 41459503, "link": "https://stackoverflow.com/questions/41459503/ms-access-vba-lookup-images-from-folders", "title": "MS Access VBA lookup images from folders", "body": "<p>I'm using the below code from this page:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/41300598/ms-access-vba-lookup-image-file-names-from-table-search-for-them-and-copy-them\">MS Access VBA lookup image file names from table, search for them and copy them</a></p>\n\n<pre><code>Public Sub listImages(folderPath As String)\n\n    'define variables\n    Dim fso As Object\n    Dim objFolder As Object\n    Dim objFolders As Object\n    Dim objF As Object\n    Dim objFile As Object\n    Dim objFiles As Object\n    Dim strFileName As String\n    Dim strFilePath As String\n    Dim myList As String\n\n    'set file system object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    'set folder object\n    Set objFolder = fso.GetFolder(folderPath)\n\n    'set files\n    Set objFiles = objFolder.files\n    Set objFolders = objFolder.subfolders\n\n    'list all images in folder\n    For Each objFile In objFiles\n\n        If Right(objFile.Name, 4) = \".jpg\" Then\n            strFileName = objFile.Name\n            strFilePath = objFile.Path\n            myList = myList &amp; strFileName &amp; \" - \" &amp; strFilePath &amp; vbNewLine\n        End If\n\n    Next\n\n    'go through all subflders\n    For Each objF In objFolders\n\n        'call same procedure for each subfolder\n        Call listImages(objF.Path)\n\n     Next\n\n     Debug.Print myList\n\n     Set objFolder = Nothing\n     set objFolders = Nothing\n     Set objFile = Nothing\n     set objF = Nothing\n     Set fso = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>However, it only returns the first image from each folder and sub folder.  How do I modify it so it shows all images in each folder\\subfolder?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "class"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1483534734, "post_id": 41459282, "comment_id": 70134309, "body": "If your data is so very tabular why not consider a solution along the lines of ActiveX Data Objects (ADO) and their recordsets?"}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1483544932, "post_id": 41459282, "comment_id": 70141218, "body": "I&#39;m not familiar with those. Can you elaborate?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1483553479, "post_id": 41459282, "comment_id": 70146796, "body": "What database technologies are you familiar with please? This is so we can have a common frame of reference."}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1483639981, "post_id": 41459282, "comment_id": 70189586, "body": "I&#39;m not really sure how to answer that! I&#39;m an intermediate user of Access, but my project is entirely in Excel."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": -1, "last_activity_date": 1483522363, "creation_date": 1483522363, "answer_id": 41460401, "question_id": 41459282, "link": "https://stackoverflow.com/questions/41459282/putting-excel-tables-into-a-custom-class/41460401#41460401", "title": "Putting Excel Tables into a Custom Class", "body": "<p>I would use a class for each, and an array of each also, so arrCars holds clsCars, and arrProd holds clsProduction.  I would then use the index of each for each array when populating, so arrCars(1)=Corvette and arrProd(1)=US Sport then from each you can refer to the others, so if x=3, cars(x) and prod(x) will be correct.  Or use a vlookup in excel first, and make one larger table, with the need for only 1 ID then, if that is the way they are related, but can a Bentley also be 3.  Its not quite clear what you mean by the 2nd table, is there an entry for each car, or is it like catgeorising the car further, just using a certain selection.  Another idea would be to have an extra property in the car class, of ProductionID and then use a static production \"table\" of classes to refer to.</p>\n"}, {"comments": [{"owner": {"reputation": 4164, "user_id": 1240154, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/27a02128a21602f320d10c1801740c71?s=128&d=identicon&r=PG", "display_name": "SWa", "link": "https://stackoverflow.com/users/1240154/swa"}, "edited": false, "score": 0, "creation_date": 1483532264, "post_id": 41462224, "comment_id": 70132694, "body": "Minor point, might be worth adding the car id as the collection key, you wouldn&#39;t need to loop through to get by ID then :)"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 4164, "user_id": 1240154, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/27a02128a21602f320d10c1801740c71?s=128&d=identicon&r=PG", "display_name": "SWa", "link": "https://stackoverflow.com/users/1240154/swa"}, "edited": false, "score": 0, "creation_date": 1483534500, "post_id": 41462224, "comment_id": 70134169, "body": "@Kyle: Yes, but since the &quot;ID&quot; comes from a source which does not check uniqueness of the ID, I believe this would make things more difficult than bring advantages."}, {"owner": {"reputation": 4164, "user_id": 1240154, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/27a02128a21602f320d10c1801740c71?s=128&d=identicon&r=PG", "display_name": "SWa", "link": "https://stackoverflow.com/users/1240154/swa"}, "edited": false, "score": 0, "creation_date": 1483535318, "post_id": 41462224, "comment_id": 70134703, "body": "Ritcher Ok, horses for courses, I&#39;d rather have an error so I know something is wrong than simply silently fail by only returning the first car. Nice solution anyway, +1 :)"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 2, "last_activity_date": 1483529574, "last_edit_date": 1483529574, "creation_date": 1483527723, "answer_id": 41462224, "question_id": 41459282, "link": "https://stackoverflow.com/questions/41459282/putting-excel-tables-into-a-custom-class/41462224#41462224", "title": "Putting Excel Tables into a Custom Class", "body": "<p>I would have two classes. A class <code>clsCar</code> for one car and a class <code>clsCars</code> for a collection of cars.</p>\n\n<p>Each of this classes may have setter and getter methods and also may have custom methods if needed. Especially the <code>clsCars</code> should have a set of <code>getBy...</code>-methods to get a car or a collection of cars from the collection by criterion.</p>\n\n<p>Example:</p>\n\n<p><code>clsCar</code>:</p>\n\n<pre><code>Private pID As Long\nPrivate pMAKE As String\nPrivate pMODEL As String\nPrivate pDOORS As Integer\nPrivate pENGINE As String\nPrivate pCOUNTRY As String\nPrivate pTYPE As String\n\nPublic Property Get ID() As Long\n    ID = pID\nEnd Property\nPublic Property Let ID(Value As Long)\n    pID = Value\nEnd Property\n\nPublic Property Get MAKE() As String\n    MAKE = pMAKE\nEnd Property\nPublic Property Let MAKE(Value As String)\n    pMAKE = Value\nEnd Property\n\nPublic Property Get MODEL() As String\n    MODEL = pMODEL\nEnd Property\nPublic Property Let MODEL(Value As String)\n    pMODEL = Value\nEnd Property\n\nPublic Property Get DOORS() As Integer\n    DOORS = pDOORS\nEnd Property\nPublic Property Let DOORS(Value As Integer)\n    pDOORS = Value\nEnd Property\n\nPublic Property Get ENGINE() As String\n    ENGINE = pENGINE\nEnd Property\nPublic Property Let ENGINE(Value As String)\n    pENGINE = Value\nEnd Property\n\nPublic Property Get COUNTRY() As String\n    COUNTRY = pCOUNTRY\nEnd Property\nPublic Property Let COUNTRY(Value As String)\n    pCOUNTRY = Value\nEnd Property\n\nPublic Property Get CarTYPE() As String\n    CarTYPE = pTYPE\nEnd Property\nPublic Property Let CarTYPE(Value As String)\n    pTYPE = Value\nEnd Property\n\nPublic Function toString() As String\n toString = pID &amp; \"; \" &amp; _\n            pMAKE &amp; \"; \" &amp; _\n            pMODEL &amp; \"; \" &amp; _\n            pDOORS &amp; \"; \" &amp; _\n            pENGINE &amp; \"; \" &amp; _\n            pCOUNTRY &amp; \"; \" &amp; _\n            pTYPE\nEnd Function\n</code></pre>\n\n<p><code>clsCars</code>:</p>\n\n<pre><code>Private pCars As collection\n\nPrivate Sub Class_Initialize()\n Set pCars = New collection\nEnd Sub\n\nPublic Sub add(oCar As clsCar)\n pCars.add oCar\nEnd Sub\n\nPublic Function getByIndex(lIndex As Long) As clsCar\n Set getByIndex = pCars.Item(lIndex)\nEnd Function\n\nPublic Function getByID(lID As Long) As clsCar\n Dim oCar As clsCar\n For Each oCar In pCars\n  If oCar.ID = lID Then\n   Set getByID = oCar\n  End If\n Next\nEnd Function\n\nPublic Function getByEngine(sEngine As String) As collection\n Dim oCar As clsCar\n Set getByEngine = New collection\n For Each oCar In pCars\n  If oCar.ENGINE = sEngine Then\n   getByEngine.add oCar\n  End If\n Next\nEnd Function\n</code></pre>\n\n<p><code>default Module</code>:</p>\n\n<pre><code>Public oCars As clsCars\n\nSub initialize()\n Dim oCar As clsCar\n Dim oListObject As ListObject\n Dim oListRow As ListRow\n Dim oCells As Range\n\n Set oCars = New clsCars\n\n Set oListObject = Worksheets(\"Sheet1\").ListObjects(\"tblCarDesc\")\n For Each oListRow In oListObject.ListRows\n  Set oCells = oListRow.Range.Cells\n  Set oCar = New clsCar\n  oCar.ID = oCells(, 1).Value\n  oCar.MAKE = oCells(, 2).Value\n  oCar.MODEL = oCells(, 3).Value\n  oCar.DOORS = oCells(, 4).Value\n  oCar.ENGINE = oCells(, 5).Value\n  oCars.add oCar\n Next\n\n Set oListObject = Worksheets(\"Sheet1\").ListObjects(\"tblCarProd\")\n Dim lID As Long\n For Each oListRow In oListObject.ListRows\n  Set oCells = oListRow.Range.Cells\n  lID = oCells(, 1).Value\n  Set oCar = oCars.getByID(lID)\n  If Not oCar Is Nothing Then\n   oCar.COUNTRY = oCells(, 2).Value\n   oCar.CarTYPE = oCells(, 3).Value\n  End If\n Next\n\n MsgBox oCars.getByIndex(2).toString\n\n For Each oCar In oCars.getByEngine(\"V8\")\n  MsgBox oCar.toString\n Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1202, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1483529574, "creation_date": 1483518541, "question_id": 41459282, "link": "https://stackoverflow.com/questions/41459282/putting-excel-tables-into-a-custom-class", "title": "Putting Excel Tables into a Custom Class", "body": "<p>I'm new to using VBA classes, and I think what I want to do -- using them with ListObjects -- is more of an \"intermediate\" than \"beginner\" technique.</p>\n\n<p>Let's say I have two tables related to cars. </p>\n\n<pre><code>tblCarDesc\nID   MAKE        MODEL      DOORS     ENGINE\n1    Chevrolet   Corvette    2         V8\n2    Ford        Escort      4         V6\n3    Rolls-Royce SilverCloud 4         V8\n\ntblCarProd\nID      COUNTRY  TYPE\n1       US       Sport\n2       US       Economy\n3       UK       Luxury\n</code></pre>\n\n<p>(The same cars are in both tables, and shown by the ID numbers.)</p>\n\n<p>I want to have a class called objCars that includes the fields (columns) from both tables. That way, when referring to Car #3, objCars.Make would be \"Rolls-Royce\" and objCars.Type would be \"Luxury\".</p>\n\n<p>1) Is there a way to import both tables into objCars? </p>\n\n<p>Perhaps I would create an array big enough to hold all the columns, then load both tables into it. The tutorial I've been reading says that I would then create a Collection, loop through each row of the array, make a new instance of objCars, and assign objCars.Make, objCars.Model, etc., for each row.  Then each item of the Collection would contain a car. (Or something like that. I don't really know much about Collections either.)  If that's right, is it the best way?</p>\n\n<p>2) How exactly does one refer to a specific car? The examples I've read like to loop through Collections and work on each item therein, but what if I want to extract a particular item? I know the Ford is Car #2; how do I get the objCars.Make and objCars.Model for that particular ID number?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6638853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10201914452019439/picture?type=large", "display_name": "Fi&#237;nek Cah\u016f", "link": "https://stackoverflow.com/users/6638853/fi%c3%adnek-cah%c5%af"}, "edited": false, "score": 0, "creation_date": 1483519993, "post_id": 41459419, "comment_id": 70124911, "body": "thank you this part works perfect Sheets(&quot;data&quot;).Shapes(&quot;Picture 1&quot;).Visible = True"}, {"owner": {"reputation": 53, "user_id": 6638853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10201914452019439/picture?type=large", "display_name": "Fi&#237;nek Cah\u016f", "link": "https://stackoverflow.com/users/6638853/fi%c3%adnek-cah%c5%af"}, "edited": false, "score": 0, "creation_date": 1483520529, "post_id": 41459419, "comment_id": 70125272, "body": "Probably I need a automatic macro which will watch changing value in cell C3 and I must call this macro if the C3 change. I dont known how."}, {"owner": {"reputation": 21, "user_id": 7368134, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XbZbnFUnbns/AAAAAAAAAAI/AAAAAAAAAEA/2DA9WnfYk2s/photo.jpg?sz=128", "display_name": "styfi", "link": "https://stackoverflow.com/users/7368134/styfi"}, "reply_to_user": {"reputation": 53, "user_id": 6638853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10201914452019439/picture?type=large", "display_name": "Fi&#237;nek Cah\u016f", "link": "https://stackoverflow.com/users/6638853/fi%c3%adnek-cah%c5%af"}, "edited": false, "score": 0, "creation_date": 1483521879, "post_id": 41459419, "comment_id": 70126068, "body": "Look at next answer, put macro Worsheet_Change to your macros, it should be automatically called when work sheet changes. Once I also wanted to use it, but it is called after every change to worksheet so it can slow your excel significantly - that was my case. I had to change my approach"}], "tags": [], "owner": {"reputation": 21, "user_id": 7368134, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XbZbnFUnbns/AAAAAAAAAAI/AAAAAAAAAEA/2DA9WnfYk2s/photo.jpg?sz=128", "display_name": "styfi", "link": "https://stackoverflow.com/users/7368134/styfi"}, "is_accepted": false, "score": 2, "last_activity_date": 1483521994, "last_edit_date": 1483521994, "creation_date": 1483519117, "answer_id": 41459419, "question_id": 41459249, "link": "https://stackoverflow.com/questions/41459249/hide-image-when-macro-successfully-done/41459419#41459419", "title": "Hide image when macro successfully done", "body": "<p>I think you have to work with object Shape if you want to hide Image. I`m not sure if there is a function which gives you Shape from a Cell, but there is a function which gives you top-left cell from a shape. You will have to slightly change your approach, but i think some of this functions may be usefull.</p>\n\n<pre><code>Sheets(\"data\").Shapes(\"Picture 1\").Visible = True\n\nSheets(\"data\").Shapes(\"Picture 1\").TopLeftCell.Row \nSheets(\"data\").Shapes(\"Picture 1\").TopLeftCell.Column\n\nFor Each s In ActiveSheet.Shapes\n    With s\n    .Visible = False\n    End With\nNext s\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483521088, "post_id": 41459717, "comment_id": 70125598, "body": "@Fi&#237;nekCah\u016f, did you try this?"}, {"owner": {"reputation": 53, "user_id": 6638853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10201914452019439/picture?type=large", "display_name": "Fi&#237;nek Cah\u016f", "link": "https://stackoverflow.com/users/6638853/fi%c3%adnek-cah%c5%af"}, "edited": false, "score": 0, "creation_date": 1483522864, "post_id": 41459717, "comment_id": 70126702, "body": "I creat new module for Worksheet_Change but I dont known where i call this module. Where i call this module? After I click on img, procedure sucussfully done macro img will be hide. And how can I call worksheet_change ? is it call automaticly? How can I visible img again when I change value in cell C3 ?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 53, "user_id": 6638853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10201914452019439/picture?type=large", "display_name": "Fi&#237;nek Cah\u016f", "link": "https://stackoverflow.com/users/6638853/fi%c3%adnek-cah%c5%af"}, "edited": false, "score": 0, "creation_date": 1483523166, "post_id": 41459717, "comment_id": 70126885, "body": "in the VBA IDE activate the Project Window (CTRL+R to make it pop out) , explode the &quot;Microsoft Excel Objects&quot; node and double click the item corresponding to the relevant worksheet to open up its code pane where you&#39;ll paste the <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> code"}, {"owner": {"reputation": 53, "user_id": 6638853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10201914452019439/picture?type=large", "display_name": "Fi&#237;nek Cah\u016f", "link": "https://stackoverflow.com/users/6638853/fi%c3%adnek-cah%c5%af"}, "edited": false, "score": 0, "creation_date": 1483523184, "post_id": 41459717, "comment_id": 70126898, "body": "I know :) i try it: D sorry :)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 53, "user_id": 6638853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10201914452019439/picture?type=large", "display_name": "Fi&#237;nek Cah\u016f", "link": "https://stackoverflow.com/users/6638853/fi%c3%adnek-cah%c5%af"}, "edited": false, "score": 0, "creation_date": 1483523229, "post_id": 41459717, "comment_id": 70126920, "body": "Did you get through it?"}, {"owner": {"reputation": 53, "user_id": 6638853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10201914452019439/picture?type=large", "display_name": "Fi&#237;nek Cah\u016f", "link": "https://stackoverflow.com/users/6638853/fi%c3%adnek-cah%c5%af"}, "edited": false, "score": 0, "creation_date": 1483523767, "post_id": 41459717, "comment_id": 70127232, "body": "Super you are best !!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1483520074, "creation_date": 1483520074, "answer_id": 41459717, "question_id": 41459249, "link": "https://stackoverflow.com/questions/41459249/hide-image-when-macro-successfully-done/41459717#41459717", "title": "Hide image when macro successfully done", "body": "<p>assuming your image is named after \"ZadatShape\"</p>\n\n<ul>\n<li><p>place the following statement in your <code>Sub zadat2()</code> right after the statement that certifies the <em>\"macro successfully done\"</em> :</p>\n\n<pre><code>ActiveSheet.Shapes(\"ZadatShape\").Visible = False '&lt;--| change \"ZadatShape\" to your actual shape name\n</code></pre></li>\n<li><p>place the following code in the code pane of the worksheet where the shape is:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$C$3\" Then ActiveSheet.Shapes(\"ZadatShape\").Visible = True '&lt;--| change \"ZadatShape\" to your actual shape name\nEnd Sub\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 53, "user_id": 6638853, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10201914452019439/picture?type=large", "display_name": "Fi&#237;nek Cah\u016f", "link": "https://stackoverflow.com/users/6638853/fi%c3%adnek-cah%c5%af"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 41459717, "answer_count": 2, "score": 0, "last_activity_date": 1487465522, "creation_date": 1483518376, "last_edit_date": 1531164843, "question_id": 41459249, "link": "https://stackoverflow.com/questions/41459249/hide-image-when-macro-successfully-done", "title": "Hide image when macro successfully done", "body": "<p>I have an image on which I have bound macro \"Zadat2\". I would like to hide the image after the macro is successfully done but if I change the value in cell C3 that image is made visible again.</p>\n\n<p><code>done.visible = False</code> does not function.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub zadat2()\n\n    Dim reg, check1 As String\n    Dim i, j, done As Integer\n    reg = Cells(2, 3).Value\n    check1 = Range(\"C4\").Value\n\n    If check1 = \"PRAVDA\" Then\n\n        i = 2\n        j = 1\n        done = 0\n        Do While Sheets(\"data\").Cells(i, j) &lt;&gt; \"\"\n            If Sheets(\"data\").Cells(i, j) = reg Then\n                vytisteno = ZkontrolovatAVytiskoutSoubor()\n                cekej = Wait()\n                done = Sheets(\"data\").Cells(i, j + 3)\n                Sheets(\"data\").Cells(i, j + 3) = done\n                done.Visible = False\n                Exit Do\n            End If\n            i = i + 1\n\n        Loop\n    Else\n        MsgBox (\"Opravit, \u0161patn\u00fd \u0161t\u00edtek!!!\")\n    End If\n\n    Cells(3, 3) = \"\"\n\n    Cells(3, 3).Select\n    ActiveWindow.ScrollRow = Cells(1, 1).Row\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "vba", "excel", "listbox", "line-breaks"], "comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1483518286, "post_id": 41459193, "comment_id": 70124015, "body": "I think the short answer is no, why not just use another column?"}, {"owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1483518483, "post_id": 41459193, "comment_id": 70124115, "body": "Wolfie The problem is less with the columns and more with the rows. I want each item&#39;s description to be on the same row as the item, but on the next line. So that when the user selects an item, it is all selected together."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1483518678, "post_id": 41459193, "comment_id": 70124226, "body": "Yes, what I mean is why can&#39;t you just have the description in column 2, price in column 3? Alternatively you could put them as two rows, one for the item and one for the description, and then add some code so that when the selection changes they are both selected?"}, {"owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1483520059, "post_id": 41459193, "comment_id": 70124951, "body": "I will if it is the only option, but I would prefer not to just because, while in the example shown above the description is very short, there are times when the description might be a full paragraph."}], "owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4089, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1483518138, "creation_date": 1483518138, "question_id": 41459193, "link": "https://stackoverflow.com/questions/41459193/is-there-a-way-to-wrap-text-in-excel-vba-form-listbox", "title": "Is there a way to wrap text in Excel VBA form listbox?", "body": "<p>Is there a way to wrap text in Excel VBA form listbox?</p>\n\n<pre><code>item = item &amp; WorksheetFunction.Rept(\" \",30 - Len(item))\n    subtotal = WorksheetFunction.Rept(\" \", 10 - subtotal_pad) &amp; _\n        \"$ \" &amp; WorksheetFunction.Rept(\" \", subtotal_pad - Len(Format(subtotal, \"0.00\"))) &amp; Format(subtotal, \"0.00\")\n    taxed = \"  \"\n        If tax_rate &lt;&gt; 0 Then\n            taxed = \" T\"\n        End If\n    description = \"\"\n        If description &lt;&gt; \"\" Then\n            description = vbNewLine &amp; \"  - \" &amp; description\n        End If\n    quantity = \"\"\n        If unit &lt;&gt; \"ea\" Then\n            quantity = vbNewLine &amp; \"  - \" &amp; quantity &amp; \" @ $\" &amp; Format(cost, \"0.00#\") &amp; \"/\" &amp; unit\n        End If\n\n    lbxCharges.AddItem (item &amp; subtotal &amp; taxed &amp; description &amp; quantity)\n</code></pre>\n\n<p>This is how it looks:\n<a href=\"https://i.stack.imgur.com/KxlIO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KxlIO.png\" alt=\"no line breaks\"></a></p>\n\n<p>but this is how it should look:\n<a href=\"https://i.stack.imgur.com/RbkEz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RbkEz.png\" alt=\"with line breaks\"></a></p>\n"}, {"tags": ["javascript", "html", "vba", "getelementsbytagname"], "comments": [{"owner": {"reputation": 47165, "user_id": 5053002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9edfd2614014563162586c1b0697?s=128&d=identicon&r=PG", "display_name": "Jaromanda X", "link": "https://stackoverflow.com/users/5053002/jaromanda-x"}, "edited": false, "score": 0, "creation_date": 1483515368, "post_id": 41458457, "comment_id": 70122710, "body": "contents of an iframe are a separate document - you&#39;ll need to read that separately"}, {"owner": {"reputation": 1, "user_id": 7372338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a45b251ccd41111197920044e921e18c?s=128&d=identicon&r=PG&f=1", "display_name": "Adnan", "link": "https://stackoverflow.com/users/7372338/adnan"}, "reply_to_user": {"reputation": 47165, "user_id": 5053002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9edfd2614014563162586c1b0697?s=128&d=identicon&r=PG", "display_name": "Jaromanda X", "link": "https://stackoverflow.com/users/5053002/jaromanda-x"}, "edited": false, "score": 0, "creation_date": 1483517120, "post_id": 41458457, "comment_id": 70123492, "body": "Thank you for your answer! I googled it and found that a solution to this problem is to use .document.getelementsbytagname(&quot;iframe&quot;).contentDocument but it somehow returned an error message."}, {"owner": {"reputation": 47165, "user_id": 5053002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9edfd2614014563162586c1b0697?s=128&d=identicon&r=PG", "display_name": "Jaromanda X", "link": "https://stackoverflow.com/users/5053002/jaromanda-x"}, "edited": false, "score": 0, "creation_date": 1483518042, "post_id": 41458457, "comment_id": 70123906, "body": "can you somehow convey what the error message is, or do we have to guess?"}, {"owner": {"reputation": 1, "user_id": 7372338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a45b251ccd41111197920044e921e18c?s=128&d=identicon&r=PG&f=1", "display_name": "Adnan", "link": "https://stackoverflow.com/users/7372338/adnan"}, "reply_to_user": {"reputation": 47165, "user_id": 5053002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9edfd2614014563162586c1b0697?s=128&d=identicon&r=PG", "display_name": "Jaromanda X", "link": "https://stackoverflow.com/users/5053002/jaromanda-x"}, "edited": false, "score": 0, "creation_date": 1483522994, "post_id": 41458457, "comment_id": 70126787, "body": "&quot;Object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 47165, "user_id": 5053002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9edfd2614014563162586c1b0697?s=128&d=identicon&r=PG", "display_name": "Jaromanda X", "link": "https://stackoverflow.com/users/5053002/jaromanda-x"}, "edited": false, "score": 0, "creation_date": 1483524884, "post_id": 41458457, "comment_id": 70127933, "body": "perhaps you need to <code>Set element = elements[0].contentDocument</code>"}, {"owner": {"reputation": 1, "user_id": 7372338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a45b251ccd41111197920044e921e18c?s=128&d=identicon&r=PG&f=1", "display_name": "Adnan", "link": "https://stackoverflow.com/users/7372338/adnan"}, "reply_to_user": {"reputation": 47165, "user_id": 5053002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9edfd2614014563162586c1b0697?s=128&d=identicon&r=PG", "display_name": "Jaromanda X", "link": "https://stackoverflow.com/users/5053002/jaromanda-x"}, "edited": false, "score": 0, "creation_date": 1483525529, "post_id": 41458457, "comment_id": 70128336, "body": "I tried    <b>Set element = elements(0).contentDocument</b> and    <b>Set element = elements.item(0).contentDocument</b> they both returned an error of &quot;automation error&quot;  Also, Set <b>element = elements.item(0).contentWindow.Document</b> returned an error of &quot;Access is denied&quot;"}], "owner": {"reputation": 1, "user_id": 7372338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a45b251ccd41111197920044e921e18c?s=128&d=identicon&r=PG&f=1", "display_name": "Adnan", "link": "https://stackoverflow.com/users/7372338/adnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 727, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483523295, "creation_date": 1483515138, "last_edit_date": 1483523295, "question_id": 41458457, "link": "https://stackoverflow.com/questions/41458457/internet-explorer-automation-doesnt-get-all-elements", "title": "Internet Explorer automation doesn&#39;t get all elements", "body": "<p>I'm learning about VBA web automation. I have successfully logged in to other websites and pulled data from them, but I couldn't do the same thing for this specific website: <a href=\"https://moodle.telt.unsw.edu.au/login/index.php\" rel=\"nofollow noreferrer\">https://moodle.telt.unsw.edu.au/</a>.</p>\n\n<pre><code>&lt;html&gt;\n   &lt;div&gt;\n      &lt;div&gt;\n         &lt;div&gt;\n            &lt;section&gt;\n               &lt;div&gt;\n                  &lt;div&gt;\n                     &lt;div&gt;\n                         &lt;div&gt;\n                           &lt;iframe&gt;\n                             &lt;html&gt;\n                                &lt;there are more tags under here and if you go far enough you'll reach the elements I want VBA to read. They are under &lt;input&gt; tag&gt;\n                           &lt;div&gt;\n</code></pre>\n\n<p>I want VBA to get the three login elements that fall under the second <code>&lt;html&gt;</code> tag that is under <code>&lt;iframe&gt;</code>: <code>id = \"username\"</code>, <code>id =\"password\"</code>, and <code>id = \"submit\"</code>. I tried <code>getelementbyid(\"\")</code> but for some reason it couldn't find these elements. I then tried using this code that lists all the elements' tags.</p>\n\n<pre><code>Sub moodleautomation()\n    Dim IE As Object\n    Dim website As String\n    Dim elements As Object\n    Dim element As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    website = \"https://moodle.telt.unsw.edu.au/login/index.php\"\n\n    With IE\n\n        .Visible = True\n        .Navigate website\n\n        Do While .busy Or .ReadyState &lt;&gt; 4\n            DoEvents\n        Loop\n\n       'get all elements in the document\n       Set elements = .document.getelementsbytagname(\"*\")\n\n       'find how many elements there are in the document\n       MsgBox elements.Length\n\n       'Display each element's tag name\n       For Each element In elements\n            MsgBox element.tagName\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>After running this code it shows me the tags until <code>&lt;iframe&gt;</code> tag then it ignores <code>&lt;html&gt;</code> tag and all the tags under it and goes directly to <code>div</code> tag. The problem is that the elements I want to read are inside the second <code>&lt;html&gt;</code> tag that my code ignored.</p>\n\n<p>Is there a way to read those elements?</p>\n\n<p>EDIT: </p>\n\n<pre><code>Sub moodleautomation()\n    Dim IE As Object\n    Dim website As String\n    Dim elements As Object\n    Dim element As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    website = \"https://moodle.telt.unsw.edu.au/login/index.php\"\n\n    With IE\n\n        .Visible = True\n        .Navigate website\n\n        Do While .busy Or .ReadyState &lt;&gt; 4\n            DoEvents\n        Loop\n\n       'get iframe elements in the document\n       Set elements = .document.getelementsbytagname(\"iframe\")\n\n       'find how many iframe elements there are in the document\n       MsgBox elements.Length\n\n       'get the iframe document\n       Set element = elements.contentDocument\n\n\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This code gives me an error message that says \"Object doesn't support this property or method\" on this line (Set element = elements.contentDocument)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13, "user_id": 6649386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0af3cf51d39c9fd57d1babb9f3df156?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Shettigar", "link": "https://stackoverflow.com/users/6649386/nithin-shettigar"}, "edited": false, "score": 1, "creation_date": 1483519286, "post_id": 41458853, "comment_id": 70124556, "body": "too vague a clue to help you out. don&#39;t you agree?"}, {"owner": {"reputation": 13, "user_id": 6649386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0af3cf51d39c9fd57d1babb9f3df156?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Shettigar", "link": "https://stackoverflow.com/users/6649386/nithin-shettigar"}, "edited": false, "score": 0, "creation_date": 1483519982, "post_id": 41458853, "comment_id": 70124906, "body": "i have a code which convert database table to csv file and sheet name will be the table name and there will be only one sheet with data in it,after that my vbscript will run to generate graph now i want that graph in seperate sheet. i want to create new sheet and add chart to it"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1483521005, "last_edit_date": 1483521005, "creation_date": 1483516715, "answer_id": 41458853, "question_id": 41458409, "link": "https://stackoverflow.com/questions/41458409/to-generate-scatter-xy-graph-in-excel-using-macro/41458853#41458853", "title": "To generate scatter xy graph in excel using macro", "body": "<p><strong>edited</strong> after OP's clarification he has to make a new sheet to host the chart into</p>\n\n<p>to stick to your code as much as possible:</p>\n\n<ul>\n<li><p>remove <code>ActiveChart.Location Where:=xlLocationAsObject, Name:=ActiveSheet.Name</code></p></li>\n<li><p>place the following code right before <code>End if</code></p>\n\n<pre><code>Dim myChart As Chart: Set myChart = ActiveChart\nWorksheets.Add\nmyChart.Location Where:=xlLocationAsObject, Name:=ActiveSheet.Name\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 6649386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0af3cf51d39c9fd57d1babb9f3df156?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Shettigar", "link": "https://stackoverflow.com/users/6649386/nithin-shettigar"}, "edited": false, "score": 0, "creation_date": 1483519239, "post_id": 41459006, "comment_id": 70124530, "body": "So modify the code according to your sheets name ? Is that the sheet where u keep ur data? Or where u want ur chart to be placed At ?"}, {"owner": {"reputation": 13, "user_id": 6649386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0af3cf51d39c9fd57d1babb9f3df156?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Shettigar", "link": "https://stackoverflow.com/users/6649386/nithin-shettigar"}, "edited": false, "score": 0, "creation_date": 1483519488, "post_id": 41459006, "comment_id": 70124643, "body": "i have a code which convert database table to csv file and sheet name will be the table name and there will be only one sheet with data in it,after that my vbscript will run to generate graph now i want that graph in seperate sheet"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 6649386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0af3cf51d39c9fd57d1babb9f3df156?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Shettigar", "link": "https://stackoverflow.com/users/6649386/nithin-shettigar"}, "edited": false, "score": 0, "creation_date": 1483519721, "post_id": 41459006, "comment_id": 70124769, "body": "Ok, so actualy you want to create a new sheet and add the chart there ?"}, {"owner": {"reputation": 13, "user_id": 6649386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0af3cf51d39c9fd57d1babb9f3df156?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Shettigar", "link": "https://stackoverflow.com/users/6649386/nithin-shettigar"}, "edited": false, "score": 0, "creation_date": 1483520836, "post_id": 41459006, "comment_id": 70125462, "body": ".Top = ShtCht.Range(&quot;M1&quot;).Top         .Left = ShtCht.Range(&quot;M1&quot;).Left    why this code is required"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 6649386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0af3cf51d39c9fd57d1babb9f3df156?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Shettigar", "link": "https://stackoverflow.com/users/6649386/nithin-shettigar"}, "edited": false, "score": 0, "creation_date": 1483520899, "post_id": 41459006, "comment_id": 70125500, "body": "it&#39;s not, you can remove it, you can also add extra properties, i out it in to share some other placing capabilities it has"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1483520134, "last_edit_date": 1483520134, "creation_date": 1483517282, "answer_id": 41459006, "question_id": 41458409, "link": "https://stackoverflow.com/questions/41458409/to-generate-scatter-xy-graph-in-excel-using-macro/41459006#41459006", "title": "To generate scatter xy graph in excel using macro", "body": "<p>My answer covers not only how to solve your question in your post, but how to automatically define and set-up charts in VBA in a \u201ccleaner\u201d and safer way.</p>\n\n<p>It's better if you avoid using <code>ActiveSheet</code>, <code>Select</code>, and <code>ActiveChart</code>. Instead always use referenced objects, in this case <code>Worksheets</code> and <code>ChartObject</code>. E.g <code>Dim ChtObj As ChartObject</code> , and later set it with <code>Set ChtObj = ShtCht.ChartObjects.Add(100, 100, 500, 500)</code> , where <code>ShtCht</code> is the worksheet where you create your chart.</p>\n\n<p>Once you defined and set your <code>ChartObject</code>, its quite easy to modify its properties by using the <code>With ChtObj</code> , and also nested properties, by adding <code>With .Chart.ChartArea</code> under the first <code>With</code> statement.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub LumData1()\n\nDim ChtObj As ChartObject\nDim ShtSrc  As Worksheet\nDim ShtCht  As Worksheet\n\n' change \"Sheet1\" to your sheet's name (where you have your chart's data)\nSet ShtSrc = Worksheets(\"Sheet1\") ' &lt;-- I preffer not to work with ActiveSheet\n\n'Set ShtCht = Worksheets(\"Sheet2\") ' &lt;-- set the chart's destination worksheet\nSet ShtCht = Worksheets.Add ' &lt;-- create a new worksheet to place the chart\nShtCht.Name = \"Chart\"\n\nIf Not IsEmpty(ShtSrc.Range(\"B2,D2\")) Then\n\n    Set ChtObj = ShtCht.ChartObjects.Add(100, 100, 500, 500)\n\n    With ChtObj\n        .Chart.ChartType = xlXYScatterSmoothNoMarkers\n        .Chart.SetSourceData ShtSrc.Range(\"$B:$B,$D:$D,$H:$H,$I:$I,$J:$J,$M:$M\")\n\n        ' set position of the chart to Cell M1\n        .Top = ShtCht.Range(\"M1\").Top\n        .Left = ShtCht.Range(\"M1\").Left\n\n        ' modify chart position and dimensions\n        With .Chart.ChartArea\n            .Width = 1060\n            .Height = 420\n            .Left = 0\n        End With\n\n        With .Chart\n            .SeriesCollection(1).AxisGroup = 2\n            .SeriesCollection(5).AxisGroup = 2\n\n            .Axes(xlCategory, xlPrimary).HasTitle = True\n            .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Date\"\n            .Axes(xlValue, xlPrimary).HasTitle = True\n            .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Value\"\n            .Axes(xlCategory).TickLabels.Orientation = 45\n        End With\n\n    End With\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6649386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0af3cf51d39c9fd57d1babb9f3df156?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Shettigar", "link": "https://stackoverflow.com/users/6649386/nithin-shettigar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 41459006, "answer_count": 2, "score": 0, "last_activity_date": 1483521005, "creation_date": 1483514957, "last_edit_date": 1483515555, "question_id": 41458409, "link": "https://stackoverflow.com/questions/41458409/to-generate-scatter-xy-graph-in-excel-using-macro", "title": "To generate scatter xy graph in excel using macro", "body": "<p>I have written a macro to generate graph in excel but i want that graph to be generated in the next sheet not in the same sheet.i have pasted my macro below its working properly i just want it to be in the next sheet. please provide me some solution*  </p>\n\n<pre><code>Sub LumData1()\n\n    If IsEmpty(Range(\"B2,D2\")) = False Then\n        Range(\"B:B,D:D,H:H,I:I,J:J,M:M\").Select\n        Range(\"M1\").Activate\n        ActiveSheet.Shapes.AddChart.Select\n        ActiveChart.ChartType = xlXYScatterSmoothNoMarkers\n        ActiveChart.SetSourceData Source:=Sheets(ActiveSheet.Name).Range( _\n            \"$B:$B,$D:$D,$H:$H,$I:$I,$J:$J,$M:$M\" _\n            )\n        ActiveChart.Location Where:=xlLocationAsObject, Name:=ActiveSheet.Name\n\n        With ActiveChart.ChartArea\n            .Width = 1060\n            .Height = 420\n            .Left = 0\n        End With\n\n        ActiveChart.SeriesCollection(1).Select\n        ActiveChart.SeriesCollection(1).AxisGroup = 2\n        ActiveChart.SeriesCollection(5).Select\n        ActiveChart.SeriesCollection(5).AxisGroup = 2\n        ActiveChart.Axes(xlCategory, xlPrimary).HasTitle = True\n        ActiveChart.Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Date\"\n        ActiveChart.Axes(xlValue, xlPrimary).HasTitle = True\n        ActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Value\"\n        ActiveChart.Axes(xlCategory).TickLabels.Orientation = 45\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483515469, "post_id": 41458032, "comment_id": 70122764, "body": "Step through your code placing a breakpoint at &quot;sheet_name = &quot;LIS01&quot;&quot; and once you hit that statement query the immediate window with &quot;?cond&quot; and press return. That way you&#39;ll be able to compare the wanted sql string with the actually built one"}, {"owner": {"reputation": 1, "user_id": 6944313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865e2309db4840a24aaac9bcc6dfb2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/6944313/kai"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483519272, "post_id": 41458032, "comment_id": 70124544, "body": "@user3598756 Thanks your for your comment. I don&#39;t really get what press return means? press backspace?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483519366, "post_id": 41458032, "comment_id": 70124596, "body": "in the immediate window you&#39;ll type <code>?cond</code> and then you have to press the return key to have the result of this query appear right below the query itslef"}, {"owner": {"reputation": 1, "user_id": 6944313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865e2309db4840a24aaac9bcc6dfb2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/6944313/kai"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483519945, "post_id": 41458032, "comment_id": 70124888, "body": "@user3598756 see what you mean. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1483562895, "creation_date": 1483562895, "answer_id": 41472971, "question_id": 41458032, "link": "https://stackoverflow.com/questions/41458032/join-expression-not-supported-occured-when-left-join-two-worksheets-from-two-dif/41472971#41472971", "title": "Join expression not supported occured when left join two worksheets from two different workbooks", "body": "<p>The issue is in your SQL <code>JOIN</code> as the expression <code>on 1=1</code> is not allowed in the <code>ON</code> clause for the Jet/ACE SQL dialect. Because you needed this item to initiate the string for your loop, consider removing it after loop:</p>\n\n<pre><code>con = Replace(con, \"on 1=1 and \", \"on \")\n</code></pre>\n\n<p>Alternatively, re-write an equivalent query by moving <code>ON</code> expressions to <code>WHERE</code> clause and comma-separating the <code>FROM</code> tables. This is known as the <em>implicit join</em> as opposed to <em>explicit join</em> using <code>JOIN</code>, both of which are equal evaluation and performance:</p>\n\n<pre><code>select b.[COMMENTS] \nfrom [LIS01$A3:AZ3000] a,\n[Excel 12.0;HDR=Yes;Database=C:\\Users\\ZhouK\\Desktop\\offline comments\\offline-comments\\56022473AML2002 OFFLINE listings 20161010 - reviewed.xls;].[LIS01$A3:AZ3000] b \nwhere 1=1 and a.[Study Site Identifier]=b.[Study Site Identifier] \nand a.[Unique Subject Identifier]=b.[Unique Subject Identifier] \nand a.[CM Record Number]=b.[CM Record Number] \nand a.[Medication]=b.[Medication] \nand a.[Indication]=b.[Indication] \nand a.[AE-Date-Term1]=b.[AE-Date-Term1] and a.[AE-Date-Term2]=b.[AE-Date-Term2] and a.[AE-Date-Term3]=b.[AE-Date-Term3] \nand a.[AE-Date-Term4]=b.[AE-Date-Term4] and a.[AE-Date-Term5]=b.[AE-Date-Term5] \nand a.[MH-Date-Term1]=b.[MH-Date-Term1] and a.[MH-Date-Term2]=b.[MH-Date-Term2] and a.[MH-Date-Term3]=b.[MH-Date-Term3] \nand a.[MH-Date-Term4]=b.[MH-Date-Term4] and a.[MH-Date-Term5]=b.[MH-Date-Term5] \nand a.[Prohylaxis or Other]=b.[Prohylaxis or Other] \nand a.[Dose]=b.[Dose] and a.[Dose Unit]=b.[Dose Unit] \nand a.[Dose Form]=b.[Dose Form] and a.[Frequency]=b.[Frequency] \nand a.[Route]=b.[Route] and a.[Ongoing]=b.[Ongoing] \nand a.[CM Start Date]=b.[CM Start Date] and a.[CM End Date]=b.[CM End Date]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6944313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865e2309db4840a24aaac9bcc6dfb2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/6944313/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 41472971, "answer_count": 1, "score": 0, "last_activity_date": 1483562895, "creation_date": 1483513468, "last_edit_date": 1483538610, "question_id": 41458032, "link": "https://stackoverflow.com/questions/41458032/join-expression-not-supported-occured-when-left-join-two-worksheets-from-two-dif", "title": "Join expression not supported occured when left join two worksheets from two different workbooks", "body": "<p>I would like to left join two worksheets from two different workbooks. Below is my code and I encountered error 'JOIN expression not supported' when I executed the sql.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RunSELECT()\nDim cn As Object, rs As Object, output As String, sql As String\nDim pre_reviewed_file As String, cond As String\n\nDim fso As Object, outfile As String, file_obj As Object\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\noutfile = \"C:\\Users\\ZhouK\\Desktop\\offline comments\\offline-comments\\result.txt\"\nSet file_obj = fso.CreateTextFile(outfile, True)\n\n\npre_reviewed_file = \"56022473AML2002 OFFLINE listings 20161010 - reviewed.xls\"\n\n\n'MsgBox ActiveWorkbook.FullName\n'---Connecting to the Data Source---\nSet cn = CreateObject(\"ADODB.Connection\")\nWith cn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=\" &amp; ActiveWorkbook.Path &amp; \"\\\" &amp; ActiveWorkbook.Name &amp; \";\" &amp; _\n    \"Extended Properties=\"\"Excel 12.0 Xml;HDR=YES\"\";\"\n    .Open\nEnd With\n\ncond = \"1=1\"\n\nWith ActiveWorkbook.Sheets(\"LIS01\").Rows(3)\n    For i = 1 To 24\n        cond = cond &amp; \" and a.[\" &amp; .Cells(i).Value &amp; \"]=b.[\" &amp; .Cells(i).Value &amp; \"]\"\n    Next\nEnd With\n\nsheet_name = \"LIS01\"\n\n'---Run the SQL SELECT Query---\nsql = \"SELECT b.[COMMENTS] FROM [\" &amp; sheet_name &amp; \"$A3:AZ3000] a left join [Excel 12.0;HDR=Yes;Database=\" &amp; ActiveWorkbook.Path &amp; _\n        \"\\\" &amp; pre_reviewed_file &amp; \";].[\" &amp; sheet_name &amp; \"$A3:AZ3000] b on \" &amp; cond\n\nfile_obj.Write (sql)\nfile_obj.Close\n\nSet rs = cn.Execute(sql)\nActiveWorkbook.Sheets(\"me\").Range(\"A1\").CopyFromRecordset rs\n\n'Do\n   'output = output &amp; rs(0) &amp; \";\" &amp; rs(1) &amp; \";\" &amp; rs(2) &amp; vbNewLine\n   'Debug.Print rs(0); \";\" &amp; rs(1) &amp; \";\" &amp; rs(2)\n   'rs.Movenext\n'Loop Until rs.EOF\n\n'MsgBox output\n\n'---Clean up---\nrs.Close\ncn.Close\nSet cn = Nothing\nSet rs = Nothing\nEnd Sub\n</code></pre>\n\n<p>The real sql is </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select b.[COMMENTS] \nfrom [LIS01$A3:AZ3000] a \nleft join [Excel 12.0;HDR=Yes;Database=C:\\Users\\ZhouK\\Desktop\\offline comments\\offline-comments\\56022473AML2002 OFFLINE listings 20161010 - reviewed.xls;].[LIS01$A3:AZ3000] b \non 1=1 and a.[Study Site Identifier]=b.[Study Site Identifier] \nand a.[Unique Subject Identifier]=b.[Unique Subject Identifier] \nand a.[CM Record Number]=b.[CM Record Number] \nand a.[Medication]=b.[Medication] \nand a.[Indication]=b.[Indication] \nand a.[AE-Date-Term1]=b.[AE-Date-Term1] and a.[AE-Date-Term2]=b.[AE-Date-Term2] and a.[AE-Date-Term3]=b.[AE-Date-Term3] \nand a.[AE-Date-Term4]=b.[AE-Date-Term4] and a.[AE-Date-Term5]=b.[AE-Date-Term5] \nand a.[MH-Date-Term1]=b.[MH-Date-Term1] and a.[MH-Date-Term2]=b.[MH-Date-Term2] and a.[MH-Date-Term3]=b.[MH-Date-Term3] \nand a.[MH-Date-Term4]=b.[MH-Date-Term4] and a.[MH-Date-Term5]=b.[MH-Date-Term5] \nand a.[Prohylaxis or Other]=b.[Prohylaxis or Other] \nand a.[Dose]=b.[Dose] and a.[Dose Unit]=b.[Dose Unit] \nand a.[Dose Form]=b.[Dose Form] and a.[Frequency]=b.[Frequency] \nand a.[Route]=b.[Route] and a.[Ongoing]=b.[Ongoing] \nand a.[CM Start Date]=b.[CM Start Date] and a.[CM End Date]=b.[CM End Date]\n</code></pre>\n\n<p>I don't really know which part is wrong. Could you please take a look into my code?</p>\n"}, {"tags": ["vba", "excel", "tree", "binary-tree", "multi-level"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1483515491, "post_id": 41458030, "comment_id": 70122773, "body": "first, fully qualify your <code>ws_c</code> by changing to <code>ws_c = ws1.Cells(ws1.Rows.Count, &quot;D&quot;).End(xlUp).Row</code> , on the following line define your variables correctly, it should be <code>Dim Lev1 As Long, Lev2 As Long, Lev3 As Long</code>"}, {"owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1483515927, "post_id": 41458030, "comment_id": 70122970, "body": "I have corrected the above code as you wrote..."}], "answers": [{"tags": [], "owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "is_accepted": true, "score": 1, "last_activity_date": 1483518213, "creation_date": 1483518213, "answer_id": 41459207, "question_id": 41458030, "link": "https://stackoverflow.com/questions/41458030/set-up-numbers-into-multilevel-tree/41459207#41459207", "title": "Set up numbers into MultiLevel tree", "body": "<p>finally I did it:</p>\n\n<pre><code>For i = 3 To ws_c\n    '**************************************************************** L1\n    If ws1.Range(\"B\" &amp; i).Value &lt;&gt; \"\" Then\n       ws1.Range(\"F\" &amp; i).Value = Lev1\n       Lev1 = Lev1 + 1\n       Lev2 = 100\n    End If\n    '**************************************************************** L1.1\n    If ws1.Range(\"C\" &amp; i).Value &lt;&gt; \"\" Then\n        ws1.Range(\"F\" &amp; i).Value = Lev2 + Lev1 - 1\n        Lev2 = Lev2 + 100            \n        Lev3 = 10000\n    End If\n    '**************************************************************** L1.1.1\n    If ws1.Range(\"D\" &amp; i).Value &lt;&gt; \"\" Then\n        ws1.Range(\"F\" &amp; i).Value = Lev3 + Lev1 - 1 + Lev2 - 100\n        Lev3 = Lev3 + 10000\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 41459207, "answer_count": 1, "score": 0, "last_activity_date": 1483518213, "creation_date": 1483513464, "last_edit_date": 1483515898, "question_id": 41458030, "link": "https://stackoverflow.com/questions/41458030/set-up-numbers-into-multilevel-tree", "title": "Set up numbers into MultiLevel tree", "body": "<p>I need to generate numbers into column F, based on hierarchy (col B:D). Below is excel examaple and also result/values which should I get.\n<a href=\"https://i.stack.imgur.com/873JH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/873JH.png\" alt=\"enter image description here\"></a></p>\n\n<p>I know only how to display values for Level1. Here is my code:</p>\n\n<pre><code>ws_c = ws1.Cells(ws1.Rows.Count, \"D\").End(xlUp).Row\nDim Lev1 As Long, Lev2 As Long, Lev3 As Long\nLev1 = 1\n    For i = 3 To ws_c        \n        If ws1.Range(\"B\" &amp; i).Value &lt;&gt; \"\" Then\n           ws1.Range(\"F\" &amp; i).Value = Lev1\n           Lev1 = Lev1 + 1\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1483512034, "post_id": 41457361, "comment_id": 70121255, "body": "Yes I want to filter cells that contain a &quot;b&quot; and also the other criteria along with the b is exists in my data. one think i want to share when i use only 2 criteria&#39;s as per the below code i.e. ActiveSheet.Range(&quot;$A$1:$AH$122460&quot;).AutoFilter Field:=34, - Criteria1:=&quot;&lt;&gt;#N/A&quot;, Criteria2:=&quot;=*b*&quot;, Operator:=xlFilterValues                     it&#39;s working fine only i got error while i entering 3 criteria."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1483512663, "post_id": 41457361, "comment_id": 70121533, "body": "try with &#39;macro recorder&#39; to find out the proper solution. With <code>.Autofilter</code> you could use only two <code>.Criteria</code> parameters but one could be an array with multiple criteria. However, array is not working with all criteria types. Therefore try with macro recorder first to figure out the correct code. Alternatively, try with <code>Advanced filtering</code>..."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1483513409, "post_id": 41457361, "comment_id": 70121883, "body": "<a href=\"http://stackoverflow.com/questions/21834701/use-autofilter-on-more-than-2-criteria\" title=\"use autofilter on more than 2 criteria\">stackoverflow.com/questions/21834701/&hellip;</a>"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1483513946, "post_id": 41457361, "comment_id": 70122081, "body": "I have tried with Macro recorder as well but the recorded code contain the other criteria in array which is in-relevant for my coding as the other contain will change every time. is there any other way like using IfAnd condition or something."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483525484, "post_id": 41457361, "comment_id": 70128295, "body": "<i>&quot;as the other contain will change every time&quot;</i>: you can fill an array with variables values. you may also want to give better detail about your exact filtering needs along with some examples"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1483528760, "post_id": 41457361, "comment_id": 70130525, "body": "Respected Sir, my data contain different values every time for example: in Column &quot;A&quot; if A,B,C,D,#N/A   is available Next time when i received the data which might be contain A,E,F,G,B,#N/A in column &quot;A&quot;, So simply I would like to ignore A,B,#N/A and filtered other values from the data.Therefore I couldn&#39;t define array with variables values because the other contain or Values will change every time when I receive the Data. Thus please help me out is there any way where I can use more then 2 criteria OR let me guide how can i use &lt;&gt; sign in array so the defined Values in array will be ignore."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483536659, "post_id": 41457361, "comment_id": 70135536, "body": "so you <i>always</i> want to <i>&quot;ignore A,B,#N/A&quot;</i> values in column AH, no matter the data will be there, don&#39;t you?"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1483592968, "post_id": 41457361, "comment_id": 70160887, "body": "Yes Sir, I always want to ignore A,B,#N/A values in column AH. Even the relevant data of these values are not require to me.Apart from those values other data i would like to use for my further working."}, {"owner": {"reputation": 639, "user_id": 5908729, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8f324dd3b2d7d3ec4a9c559d69f65cf0?s=128&d=identicon&r=PG&f=1", "display_name": "sql_dummy", "link": "https://stackoverflow.com/users/5908729/sql-dummy"}, "edited": false, "score": 0, "creation_date": 1487257509, "post_id": 41457361, "comment_id": 71711400, "body": "@sagar I am facing same issue tried using `Selection.AutoFilter Field:=13, Criteria1:=Array(&quot;&lt;&gt;A&quot;, &quot;&lt;&gt;B&quot;, &quot;&lt;&gt;C&quot;) Operator:=xlFilterValues. but it did not work."}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3084, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1483510697, "creation_date": 1483510697, "last_edit_date": 1531164843, "question_id": 41457361, "link": "https://stackoverflow.com/questions/41457361/auto-filter-more-than-2-or-3-criteria", "title": "Auto filter more than 2 or 3 Criteria", "body": "<p>Please help me out In the below code where I am trying to use more than 2 or 3 Criteria in Auto filter VBA code.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$AH$122460\").AutoFilter Field:=34, _\nCriteria1:=\"&lt;&gt;#N/A\", Operator:=xlOr, Criteria2:=\"&lt;&gt;*n*\", _\nOperator:=xlOr, Criteria3:=\"=*b*\"\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$AH$122460\").AutoFilter Field:=34, _\nCriteria1:=\"&lt;&gt;#N/A\", Criteria2:=\"&lt;&gt;\", Criteria3:=\"=*b*\", Operator:=xlFilterValues\n</code></pre>\n\n<p>None of the above codes are working, please guide me how to deal while filtering the data with different criteria's.</p>\n"}, {"tags": ["vba", "email", "outlook", "automation", "categories"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "is_accepted": false, "score": 0, "last_activity_date": 1483514529, "creation_date": 1483514529, "answer_id": 41458288, "question_id": 41457224, "link": "https://stackoverflow.com/questions/41457224/outlook-vba-for-assigning-work-with-categories-on-selected-emails/41458288#41458288", "title": "Outlook VBA for Assigning Work with Categories on Selected Emails", "body": "<p>I have finally cracked the solution so sharing the same as below, thank you.</p>\n\n<pre><code>Sub category_assigment()\nDim oOutlook As Object: Dim oExplorer As Object\nDim i As Long: Set oOutlook = CreateObject(\"Outlook.Application\")\nDim objSelection As Outlook.Selection\nDim Result As Integer\nSet objSelection = Application.ActiveExplorer.Selection\n\nSet oExplorer = oOutlook.ActiveExplorer: Dim oSelection As Object\nSet oSelection = oExplorer.Selection\nDim oCategory As String\n'For i = 1 To oSelection.Count\nOn Error Resume Next\nFor i = oSelection.Count To 1 Step -1\nIf oSelection.Item(i).Categories = \"\" Then\nFor x = 0 To 15\nIf x = 0 Then\noCategory = \"Agent 1\"\nElseIf x = 3 Then\noCategory = \"Agent 2\"\nElseIf x = 6 Then\noCategory = \"Agent 3\"\nElseIf x = 9 Then\noCategory = \"Agent 4\"\nElseIf x = 12 Then\noCategory = \"Agent 5\"\nElseIf x = 15 Then\noCategory = \"Agent 6\"\nElse: GoTo Line01\nEnd If\nFor y = 0 To 2\nIf oSelection.Item(i - x - y).Categories = \"\" Then\noSelection.Item(i - x - y).Categories = oCategory\noSelection.Item(i - x - y).Save\nEnd If\nNext\nLine01:\nNext\nEnd If\nNext i\n\nResult = MsgBox(\"Total Emails Assigned : \" &amp; _\n            objSelection.Count, vbInformation, \"Selected Items\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483514529, "creation_date": 1483510079, "question_id": 41457224, "link": "https://stackoverflow.com/questions/41457224/outlook-vba-for-assigning-work-with-categories-on-selected-emails", "title": "Outlook VBA for Assigning Work with Categories on Selected Emails", "body": "<p>I'm looking for a way to assign work (emails) with the help of outlook categories to my team members however I have to do that manually considering I have 2000 emails daily this is a huge task too attend , I am trying to achieve the below</p>\n\n<p>1) assign 3 emails to each team member \n2) assignment on only selected emails and not the entire mailbox\n3) assignment in order of oldest to newest emails.\n4) assignment to be done as per the below requirement i.e.</p>\n\n<p>if 10 emails are selected the distribution should look like emails i.e. 1,2,3 to agent 1, email i.e. 4,5,6 to agent 2, email i.e. 7,8,9 to agent 3 and email i.e. 10  to agent 4 and loop stops here.</p>\n\n<pre><code>Sub EmailCategories()\nDim strCat As String\nDim olmail As MailItem\n'If Item.Class = olmail Then\n'For i = 0 To 2\n\nFor Each olmail In Outlook.Application.ActiveExplorer.Selection\n'olmail.Categories = \"Agent - 1\"\n\nSelect Case i\nCase 0\nolmail.Categories = \"Agent - 1\"\nCase 1\nolmail.Categories = \"Agent - 2\"\nCase 2\nolmail.Categories = \"Agent - 3\"\nCase 3\nolmail.Categories = \"Agent - 4\"\nCase 4\nolmail.Categories = \"Agent - 5\"\nCase 5\nolmail.Categories = \"Agent - 6\"\nEnd Select\n\n'Item.Categories = mailMsg\nolmail.Item.Save\nErr.Clear\n\nNext\n'End If\ni = i + 3\nDebug.Print i\nIf i = 5 Then\ni = 0\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 701, "user_id": 1959724, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7ca84710d2de3d87f9c81141b6175747?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/1959724/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1483528202, "creation_date": 1483528202, "answer_id": 41462378, "question_id": 41456829, "link": "https://stackoverflow.com/questions/41456829/merging-sheets-in-to-a-master-sheet/41462378#41462378", "title": "Merging sheets in to a master sheet", "body": "<p>Actually you just have to change the code that defines the area that should be copied. In your case you have to check the \"ranges\" before copying the data:</p>\n\n<pre><code>sh.Range(\"A1:Z1\").Copy DestSh.Range(\"A1\")\n</code></pre>\n\n<p>That line takes care of the headlines, so you can replace the Z1 with e. g. P1.</p>\n\n<p>The next range is to copy the data:</p>\n\n<pre><code>Set CopyRng = sh.Range(sh.Rows(StartRow), sh.Rows(shLast))\n</code></pre>\n\n<p>Here you can use the existing functionality to get the correct start row and last row. But instead of selecting the complete rows you will just select a part of the sheet:</p>\n\n<pre><code>sh.Range(\"A\" &amp; StartRow &amp; \":P\" &amp; shLast)\n</code></pre>\n\n<p>That should do the trick.</p>\n\n<p>P. S. Even If you are not a programmer. Have a look at the VBA Basics, its not that hard and you can do a lot of cool stuff if you know how it works... :)</p>\n"}], "owner": {"reputation": 1, "user_id": 7372509, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YhqBHV5m-Ac/AAAAAAAAAAI/AAAAAAAADZY/01Qj4nwExY4/photo.jpg?sz=128", "display_name": "Raga Sandhya", "link": "https://stackoverflow.com/users/7372509/raga-sandhya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483528202, "creation_date": 1483507956, "last_edit_date": 1531164843, "question_id": 41456829, "link": "https://stackoverflow.com/questions/41456829/merging-sheets-in-to-a-master-sheet", "title": "Merging sheets in to a master sheet", "body": "<p>I got the following code from Ron de Bruin's site and it works pretty much fine for pulling data into a master sheet, and updating the master sheet whenever there are changes in the other sheets.</p>\n\n<p>But I would like to copy only certain columns of data. For example my sheets have data from <code>A:Z</code> but i only need the <code>A:P</code> data in my master sheet. </p>\n\n<p>Any help on this will be greatly appreciated and please know that im a non-coder, so please be specific about what to change and where to change it.</p>\n\n<pre><code>Sub CopyDataWithoutHeaders()\nDim sh As Worksheet\nDim DestSh As Worksheet\nDim Last As Long\nDim shLast As Long\nDim CopyRng As Range\nDim StartRow As Long\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n'Delete the sheet \"Master Sheet\" if it exist\nApplication.DisplayAlerts = False\nOn Error Resume Next\nActiveWorkbook.Worksheets(\"Master Sheet\").Delete\nOn Error GoTo 0\nApplication.DisplayAlerts = True\n\n'Add a worksheet with the name \"Master Sheet\"\nSet DestSh = ActiveWorkbook.Worksheets.Add\nDestSh.Name = \"Master Sheet\"\n\n'Fill in the start row\nStartRow = 2\n\n'loop through all worksheets and copy the data to the DestSh\nFor Each sh In ActiveWorkbook.Worksheets\n    If sh.Name &lt;&gt; DestSh.Name Then\n    'Copy header row, change the range if you use more columns\nIf WorksheetFunction.CountA(DestSh.UsedRange) = 0 Then\n  sh.Range(\"A1:Z1\").Copy DestSh.Range(\"A1\")\nEnd If\n\n        'Find the last row with data on the DestSh and sh\n        Last = LastRow(DestSh)\n        shLast = LastRow(sh)\n\n        'If sh is not empty and if the last row &gt;= StartRow copy the CopyRng\n        If shLast &gt; 0 And shLast &gt;= StartRow Then\n\n            'Set the range that you want to copy\n            Set CopyRng = sh.Range(sh.Rows(StartRow), sh.Rows(shLast))\n            'Test if there enough rows in the DestSh to copy all the data\n            If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                MsgBox \"There are not enough rows in the Destsh\"\n                GoTo ExitTheSub\n            End If\n\n            'This example copies values/formats, if you only want to copy the\n            'values or want to copy everything look below example 1 on this page\n            CopyRng.Copy\n            With DestSh.Cells(Last + 1, \"A\")\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n\n        End If\n\n    End If\nNext\n\nExitTheSub:\n\nApplication.Goto DestSh.Cells(1)\n\n'AutoFit the column width in the DestSh sheet\nDestSh.Columns.AutoFit\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    End With\nEnd Sub\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\n\nFunction LastCol(sh As Worksheet)\n    On Error Resume Next\n    LastCol = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}, {"tags": ["python", "excel", "vba"], "comments": [{"owner": {"reputation": 156940, "user_id": 416467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32cad7487ccecc3740a62e797fc326dc?s=128&d=identicon&r=PG", "display_name": "kindall", "link": "https://stackoverflow.com/users/416467/kindall"}, "edited": false, "score": 0, "creation_date": 1483506100, "post_id": 41456316, "comment_id": 70119119, "body": "You&#39;re getting that error because there is no program called <code>xl.Application.Run(&quot;macro1&quot;)</code> installed on your system. Yes, you are using <code>Popen</code> wrong. It isn&#39;t for this. Why are you using it? Why aren&#39;t you just doing <code>xl.Application.Run(&quot;macro1&quot;)</code>?"}, {"owner": {"reputation": 1, "user_id": 7372363, "user_type": "registered", "profile_image": "https://graph.facebook.com/1368647358/picture?type=large", "display_name": "Hiro Jung", "link": "https://stackoverflow.com/users/7372363/hiro-jung"}, "reply_to_user": {"reputation": 156940, "user_id": 416467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32cad7487ccecc3740a62e797fc326dc?s=128&d=identicon&r=PG", "display_name": "kindall", "link": "https://stackoverflow.com/users/416467/kindall"}, "edited": false, "score": 0, "creation_date": 1483511182, "post_id": 41456316, "comment_id": 70120878, "body": "That&#39;s what I used at first, but the script ran the macros concurrently, not in series. I was under the impression that Popen was used to have the processes &quot;wait&quot; for others to finish."}, {"owner": {"reputation": 156940, "user_id": 416467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32cad7487ccecc3740a62e797fc326dc?s=128&d=identicon&r=PG", "display_name": "kindall", "link": "https://stackoverflow.com/users/416467/kindall"}, "edited": false, "score": 0, "creation_date": 1483554157, "post_id": 41456316, "comment_id": 70147155, "body": "Well, I mean, yes, you can use the <code>Popen.wait()</code> method to wait for the subprocess to finish, but to do that you have to start the subprocess using <code>Popen</code> to begin with. What you give <code>Popen</code> is the command line you use to start the process, not a Python command. You have already started the process using PyWin32 so..."}], "owner": {"reputation": 1, "user_id": 7372363, "user_type": "registered", "profile_image": "https://graph.facebook.com/1368647358/picture?type=large", "display_name": "Hiro Jung", "link": "https://stackoverflow.com/users/7372363/hiro-jung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 397, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483504859, "creation_date": 1483504859, "last_edit_date": 1531161705, "question_id": 41456316, "link": "https://stackoverflow.com/questions/41456316/running-vba-macros-using-python-but-wait-between-macros", "title": "Running VBA macros using Python, but wait between macros", "body": "<p>I am trying to run VBA macros in several workbooks, but I would like to have the macros run sequentially. So far, I figured out how to run the macros using PyWin32, but the macros do not run in series. I tried to get it to work by using subprocess like so:</p>\n\n<pre><code>for subdir, dirs, files in os.walk(rootdir):\n    for file in files:\n    xl=win32com.client.Dispatch(\"Excel.Application\")\n    xl.Workbooks.Open(Filename=os.path.join(subdir,file))\n    p = subprocess.Popen([\"xl.Application.Run(\\\"macro1\\\")\"])\n    p.wait()\n    p = subprocess.Popen([\"xl.Application.Run(\\\"macro2\\\")\"])\n    p.wait()\n</code></pre>\n\n<p>but I came across an error which said: \"[WinError 2] The system cannot find the file specified\"</p>\n\n<p>Am I using the Popen object wrong? Is there an alternative solution this problem? I am quite new to Python so any answer is appreciated. Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1483500182, "post_id": 41455672, "comment_id": 70117755, "body": "from your code it looks like you want to find the first empty cel in H1:H21 and fill it with current timestamp. If thats all you want to do, the code runs fine"}, {"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1483500876, "post_id": 41455672, "comment_id": 70117894, "body": "the only issue i see is when the last row in col H is not 21. your code will basically look for an empty cell between 1 and last non-empty cell."}, {"owner": {"reputation": 11, "user_id": 7352400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69lz7.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7352400/mike"}, "reply_to_user": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1483501364, "post_id": 41455672, "comment_id": 70117994, "body": "Hi nc23, I&#39;m wondering though if I can change the sourceColumn and instead use a range.  The code works, but not as I would have intended.  I used that source as a place holder for now.  As well, I&#39;d like to get rid of the need for something in-between the blank cells...I&#39;m unsure why that is being needed. Thanks!"}, {"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1483501621, "post_id": 41455672, "comment_id": 70118039, "body": "you can create a named range for your sourcecolumn and use it in the code. see my answer. I still don&#39;t understand where do you need to have a filler. May be a screenshot would help"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483517672, "post_id": 41455672, "comment_id": 70123744, "body": "what&#39;s your actual goal? you may post some &quot;before&quot; and &quot;after&quot; scenarios"}], "answers": [{"tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": false, "score": 0, "last_activity_date": 1483501534, "last_edit_date": 1483501534, "creation_date": 1483501083, "answer_id": 41455822, "question_id": 41455672, "link": "https://stackoverflow.com/questions/41455672/excel-vba-time-card-error-with-clock-in-clock-out-function/41455822#41455822", "title": "Excel VBA Time card - Error with clock in clock out function", "body": "<p>if you are specifically looking at the range H1:H21, below code may work</p>\n\n<pre><code>Sub ClockInClockOut2()\n    Dim c As Range\n    For Each c In Range(\"myTimestamps\")\n        If IsEmpty(c) Or c.Value = \"\" Then\n            With c\n                .Value = Now()\n                .NumberFormat = \"[$-en-US]mm/dd/yyyy hh:mm AM/PM;@\"\n                Exit For\n            End With\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7352400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69lz7.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7352400/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1483501534, "creation_date": 1483499676, "last_edit_date": 1483499836, "question_id": 41455672, "link": "https://stackoverflow.com/questions/41455672/excel-vba-time-card-error-with-clock-in-clock-out-function", "title": "Excel VBA Time card - Error with clock in clock out function", "body": "<p>I have created a basic time card for work that can be run on excel daily for multiple users.  I'm running into two issues that I am looking for help on.  </p>\n\n<ol>\n<li>The VBA I've created seems to need a \"filler\" in-between blank spaces in order to allow it to work. IE Blank, Filler Data, Blank, Filler Data, etc. Otherwise, it will not initialize upon running the macro button.  Is there a better way to do this or an error in my code causing this?</li>\n<li>I'm wondering if this code can also be modified to allow for a specific range instead of H1 through H21.  I'd like to move the actual timecard for easier printing.</li>\n</ol>\n\n<hr>\n\n<pre><code>Sub ClockInClockOut()\n\n'This code looks for empty cells in the range H1:H21\n'and allows the user to clock-in and clock-out.\n'It looks at cells one by one and enters time stamp.\n\n    Dim sourceCol As Integer, rowCount As Integer, currentRow As Integer\n    Dim currentRowValue As String\n\n    sourceCol = 8 'column H has a value of 8\n    rowCount = Cells(Rows.Count, sourceCol).End(xlUp).Row\n\n    'for every row, find the first blank cell and select it\n    For currentRow = 1 To rowCount\n        currentRowValue = Cells(currentRow, sourceCol).Value\n        If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\n            Cells(currentRow, sourceCol).Select\n            Exit For\n\n        End If\n\n    Next\n\n    ActiveCell.FormulaR1C1 = \"=NOW()\"\n    Selection.NumberFormat = \"[$-en-US]mm/dd/yyyy hh:mm AM/PM;@\"\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [".net", "vb.net", "vba", "inheritance", "com"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1483503755, "post_id": 41455522, "comment_id": 70118527, "body": "Define interfaces for both classes, and have the child interface implement the base interface. COM coclasses are almost always just collections of interface implementations - create them explicitly instead of relying on the compiler to do it for you."}], "answers": [{"tags": [], "owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": false, "score": 2, "last_activity_date": 1483547232, "creation_date": 1483547232, "answer_id": 41468714, "question_id": 41455522, "link": "https://stackoverflow.com/questions/41455522/vb-net-com-class-inheritance/41468714#41468714", "title": "VB.Net Com Class inheritance", "body": "<p>COM uses a hyper-pure interface-based paradigm under the hood.  You are doing battle with the way it is mapped onto the VB.NET and VBA languages.  Implementation inheritance is a problem on the VB.NET side, the compiler rewrites your class to implement <em>two</em> interfaces.  The default interface maps the members of the class, a second non-default interface maps the inherited members.</p>\n\n<p>That's a problem on the VBA side, mostly because it has no direct support for interfaces at all.  You can only use the default interface directly, obtaining a reference to another interface requires using the <code>Set</code> keyword.  Like this:</p>\n\n<pre><code>Dim child As New TestInheritance.MyChild\nchild.child_hello_world\nDim parent As TestInheritance.MyParent\nSet parent = child\nparent.parent_hello_world\n</code></pre>\n\n<hr>\n\n<p>That works just fine, but certainly no great reason to be enthusiastic about it.  Biggest problem is that this is code that is completely undiscoverable.  The reason you asked this question, nothing in the auto-complete dialog in the VBA text editor told you that this can work.  You'd have to write a manual to let your client programmer know about it.  And if the client programmer prefers late-binding then he's completely stuck.</p>\n\n<p>One thing you might consider to help him get it right is exposing the base class directly through a property, about the shortest code you'll ever write:</p>\n\n<pre><code>Public ReadOnly Property Parent As MyParent\n    Get\n        Return Me\n    End Get\nEnd Property\n</code></pre>\n\n<p>Now it is highly discoverable in VBA and you'll have no problem arriving at:</p>\n\n<pre><code>Dim child As New TestInheritance.MyChild\nchild.child_hello_world\nchild.parent.parent_hello_world\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7372091, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uzFqBgGA8UY/AAAAAAAAAAI/AAAAAAAAA3A/0BJk40pVPC0/photo.jpg?sz=128", "display_name": "Scott Barber", "link": "https://stackoverflow.com/users/7372091/scott-barber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1483547232, "creation_date": 1483498533, "question_id": 41455522, "link": "https://stackoverflow.com/questions/41455522/vb-net-com-class-inheritance", "title": "VB.Net Com Class inheritance", "body": "<p>I have a situation where a VB.Net COM Class in not inheriting functions accessible to the parent class when accessing the interface via VBA.</p>\n\n<p>I.e. I have a VB.Net COM Class (myParent) and a VB.net COM Subclass (myChild).</p>\n\n<p>I have searched and found something similar here: <a href=\"https://stackoverflow.com/questions/259730/exposing-inherited-members-of-a-com-vb-net-class\">Exposing inherited members of a COM vb.net class</a> but the solution \"try this\" did not seem to exist?</p>\n\n<pre><code>&lt;ComClass(MyParent.ClassId, MyParent.InterfaceId, MyParent.EventsId)&gt;\nPublic Class MyParent\n\n#Region \"COM GUIDs\"\n    Public Const ClassId As String = \"386e628c-872b-41ee-abb2-d2a5dfb4e51e\"\n    Public Const InterfaceId As String = \"f4b194f1-9dc9-4f37-93d8-57cb97e05593\"\n    Public Const EventsId As String = \"4320826d-a02c-4360-b8b5-4c98569c2b2e\"\n#End Region\n\n    Public Sub New()\n        MyBase.New()\n    End Sub\n\n\n    Public Function parent_hello_world() As Boolean\n        MsgBox(\"Hello from Parent\")\n        Return True\n    End Function\n\nEnd Class\n\n&lt;ComClass(MyChild.ClassId, MyChild.InterfaceId, MyChild.EventsId)&gt;\nPublic Class MyChild\n    Inherits MyParent\n\n#Region \"COM GUIDs\"\n    Public Const ClassId As String = \"65674d29-7bb7-447e-8282-47b9873cec4a\"\n    Public Const InterfaceId As String = \"cbcdfb17-c8b9-42e2-bed7-b516b9df6111\"\n    Public Const EventsId As String = \"22a8959c-7594-4584-b53d-a087246be623\"\n#End Region\n\n    Public Sub New()\n        MyBase.New()\n    End Sub\n\n\n    Public Function child_hello_world() As Boolean\n        MsgBox(\"Hello from Child\")\n        Return True\n    End Function\n\nEnd Class\n</code></pre>\n\n<p>And the below code (when executed from VBA) fails:</p>\n\n<pre><code>Sub test_me()\n    Dim tip As New TestInheritance.MyParent\n    Dim tic As New TestInheritance.MyChild\n    tip.parent_hello_world()  'this works - directly from parent\n\n    tic.child_hello_world()  'this works - child function\n    tic.parent_hello_world()  'throws an error - not accessible?\n\nEnd Sub\n</code></pre>\n\n<p>Is there any solution for this aside from needing to redefine the interfaces in the child class?</p>\n\n<p>Thanks so much.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1483497540, "post_id": 41455259, "comment_id": 70117146, "body": "What happens if you turn on the macro recorder, change the column names, stop the macro recorder?"}], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": false, "score": 0, "last_activity_date": 1483504960, "creation_date": 1483504960, "answer_id": 41456336, "question_id": 41455259, "link": "https://stackoverflow.com/questions/41455259/how-to-name-newly-added-table-columns-generated-by-vlook-up/41456336#41456336", "title": "How to name newly added table columns generated by vlook up", "body": "<p>Naming a range is pretty straightforward: </p>\n\n<pre><code>Range(\"AE2:AE\" &amp; lastrow).Name = \"NamedRange1\"\nRange(\"AF2:AF\" &amp; lastrow).Name = \"NamedRange2\"\nRange(\"AG2:AG\" &amp; lastrow).Name = \"NamedRange3\"\nRange(\"AH2:AH\" &amp; lastrow).Name = \"NamedRange4\"\nRange(\"AI2:AI\" &amp; lastrow).Name = \"NamedRange5\"\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6577141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43377c1664fb3ffbb563fe403be963f1?s=128&d=identicon&r=PG&f=1", "display_name": "wainseven", "link": "https://stackoverflow.com/users/6577141/wainseven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483504960, "creation_date": 1483496574, "last_edit_date": 1531164843, "question_id": 41455259, "link": "https://stackoverflow.com/questions/41455259/how-to-name-newly-added-table-columns-generated-by-vlook-up", "title": "How to name newly added table columns generated by vlook up", "body": "<p>Currently I used the below codes to generate some new columns to the table using vlookup. How could I name the new columns as well as their current names are column 1, column 2, column 3 etc. Thank you very much!  </p>\n\n<pre><code>Columns(\"A\").Delete\n\nDim lastrow As Long\nlastrow = Range(\"A2\").End(xlDown).Row\n\nRange(\"AE2:AE\" &amp; lastrow).FormulaR1C1 = \"=IF(RC[+1]=\"\"PAYING\"\",         VLOOKUP(RC[-30],'Sheet2'!R1C1:R20000C8,8,0),\"\"PENDING\"\")\"\n\nRange(\"AF2:AF\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(VLOOKUP(RC[-31],'Sheet2'!R1C1:R20000C8,2,0), \"\"PENDING\"\")\"\n\nRange(\"AG2:AG\" &amp; lastrow).FormulaR1C1 = \"=(LEN(RC[-31])-LEN(SUBSTITUTE(RC[-31], \"\";\"\", \"\"\"\"))+1)*1200\"\n\nRange(\"AH2:AH\" &amp; lastrow).FormulaR1C1 = \"=VLOOKUP(RC[-33],'Sheet3'!R2C2:R220C4,2,0)\"\n\nRange(\"AI2:AI\" &amp; lastrow).FormulaR1C1 = \"=VLOOKUP(RC[-34],'Sheet3'!R2C2:R220C4,3,0)\"\n\nColumns(\"X:AI\").EntireColumn.AutoFit\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "is_accepted": true, "score": 1, "last_activity_date": 1483801094, "creation_date": 1483801094, "answer_id": 41522779, "question_id": 41454908, "link": "https://stackoverflow.com/questions/41454908/vlookup-to-workbook-a-from-workbook-b/41522779#41522779", "title": "vlookup to workbook A from workbook B", "body": "<p>Here is the code. check if it works for you. Autofill would not work properly, so it better you identify the lastrow and use with and end with option.</p>\n\n<pre><code>Sub vlookupexample()\n\nDim FileA As Workbook\nDim FileB As Workbook\nDim fileALastrow As Long\nDim FileBLastrow As Long\n\n\nSet FileA = Workbooks.Open(\"C:\\Users\\raja\\Desktop\\fileA.xlsx\")\nSet FileB = Workbooks.Open(\"C:\\Users\\raja\\Desktop\\fileB.xlsx\")\n\nFileA.Activate\n\nfileALastrow = FileA.Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFileB.Activate\n\nFileBLastrow = FileB.Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFileA.Activate\nFileA.Sheets(\"Sheet1\").Range(\"B2\").Select\nWith FileA.Sheets(\"Sheet1\").Range(\"B2:B\" &amp; fileALastrow)\n        .Formula = \"=VLOOKUP(RC[-1],[fileB.xlsx]Sheet1!C1:C2,2,0)\"\n       .Value = .Value\n        End With\nMsgbox \"Process Completed\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7128564, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/1066e36af20d2f14d8f50b69faa44f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Johnseito", "link": "https://stackoverflow.com/users/7128564/johnseito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 1, "accepted_answer_id": 41522779, "answer_count": 1, "score": 0, "last_activity_date": 1488674963, "creation_date": 1483493694, "last_edit_date": 1488674963, "question_id": 41454908, "link": "https://stackoverflow.com/questions/41454908/vlookup-to-workbook-a-from-workbook-b", "title": "vlookup to workbook A from workbook B", "body": "<p>I want to do a vlookup in workbook A that will pull identical information from workbook B. Both workbooks are already open.</p>\n\n<p>The program should be in a third workbook C. </p>\n\n<p>The name of both workbooks are not the same so I give it a variable format (hence, the program should work for any workbook we set) and the range to the last record from either workbook A or B can vary. </p>\n\n<p>I have an example I recorded but it doesn't work the way I want it.  </p>\n\n<p>In my example, I am pulling to workbook B from workbook A. I also trimmed the lookup value from workbook B because of spaces and I want it to match lookup value in workbook A (most doesn't have space, not sure about all). Is there a way trim lookup value in workbook A as well?</p>\n\n<pre><code>Windows(\"test A.xlsx\").Activate\nWindows(\"test B.xlsx\").Activate\nActiveCell.FormulaR1C1 = \"=VLOOKUP(trim(RC[-1]),'[test A.xlsx]Sheet1'!C1:C2,2,FALSE)\"\nRange(\"B1\").Select\nSelection.AutoFill Destination:=Range(\"B1:B30000\")\nRange(\"B1:B30000\").Select\nRange(\"B1\").Select\nWindows(\"mac.xlsm\").Activate\n</code></pre>\n"}, {"tags": ["excel", "count", "excel-formula", "row", "vba"], "comments": [{"owner": {"reputation": 11724, "user_id": 233337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dqjJ9.jpg?s=128&g=1", "display_name": "Serg Chernata", "link": "https://stackoverflow.com/users/233337/serg-chernata"}, "edited": false, "score": 0, "creation_date": 1483491487, "post_id": 41454547, "comment_id": 70115698, "body": "Have you tried writing any code?"}, {"owner": {"reputation": 1, "user_id": 3113282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2edde751dcf6889cb7d1161231579fdf?s=128&d=identicon&r=PG&f=1", "display_name": "user3113282", "link": "https://stackoverflow.com/users/3113282/user3113282"}, "reply_to_user": {"reputation": 11724, "user_id": 233337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dqjJ9.jpg?s=128&g=1", "display_name": "Serg Chernata", "link": "https://stackoverflow.com/users/233337/serg-chernata"}, "edited": false, "score": 0, "creation_date": 1483546428, "post_id": 41454547, "comment_id": 70142273, "body": "I am not familiar with code :( Though I have bought a VBA beginners book and plan to start reading this afternoon."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1483491054, "creation_date": 1483491054, "answer_id": 41454597, "question_id": 41454547, "link": "https://stackoverflow.com/questions/41454547/excel-finding-row-count-between-two-specific-values/41454597#41454597", "title": "Excel: Finding row count between two specific values", "body": "<p>If both search terms occur only once in their respective columns, try</p>\n\n<pre><code>=match(\"Criteria Matched\",D:D,0)-match(TRUE,C:C,0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 336, "user_id": 7078182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f6946b5a191af0780e74a38af91e?s=128&d=identicon&r=PG", "display_name": "Roger H.", "link": "https://stackoverflow.com/users/7078182/roger-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1483600338, "creation_date": 1483600338, "answer_id": 41479170, "question_id": 41454547, "link": "https://stackoverflow.com/questions/41454547/excel-finding-row-count-between-two-specific-values/41479170#41479170", "title": "Excel: Finding row count between two specific values", "body": "<p>To expand upon the previous answer to account for multiple occurrences, you can put this formula in B1 and copy down as needed: =IF($C1=TRUE,MATCH(\"Criteria Matched\",$D2:$D$300,0)-1,\"\"). This gives a count of rows \"between\" the two values where  \"TRUE\" is followed by \"Criteria Matched\" as you stated. If you really meant rows \"until\", remove the -1 from the formula.</p>\n\n<p>If you need a count between when any one follows the other, then this in B1: =IFERROR(IF($C1=TRUE,MATCH(\"Criteria Matched\",$D2:$D$300,0)-1,IF($D1=\"Criteria Matched\",MATCH(TRUE,$C2:$C$300,0)-1,\"\")),\"\")</p>\n"}], "owner": {"reputation": 1, "user_id": 3113282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2edde751dcf6889cb7d1161231579fdf?s=128&d=identicon&r=PG&f=1", "display_name": "user3113282", "link": "https://stackoverflow.com/users/3113282/user3113282"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1260, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1548063511, "creation_date": 1483490718, "last_edit_date": 1531161705, "question_id": 41454547, "link": "https://stackoverflow.com/questions/41454547/excel-finding-row-count-between-two-specific-values", "title": "Excel: Finding row count between two specific values", "body": "<p>I need to indicate in column B the number of rows between where \"Criteria Matched\" is found in Col D and where \"TRUE\" is found in Col C.</p>\n\n<p>Criteria Matched and True can occur multiple times, I am looking for the row count distance between the first True and Criteria matched, then the distance between the next two.. etc. </p>\n\n<p>Any ideas? I am a VBA and Excel noob. </p>\n\n<p><a href=\"https://i.stack.imgur.com/WrXsE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WrXsE.png\" alt=\"Row Count Problem\"></a></p>\n"}, {"tags": ["regex", "vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1483505268, "post_id": 41454315, "comment_id": 70118907, "body": "Why do you need PR_TRANSPORT_MESSAGE_HEADERS  for this instead of the MailItem.Recipients collection?"}, {"owner": {"reputation": 440, "user_id": 6814465, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-q5r4l4mqVo4/AAAAAAAAAAI/AAAAAAAAAAA/VAvFKflNv3o/photo.jpg?sz=128", "display_name": "Elio Fernandes", "link": "https://stackoverflow.com/users/6814465/elio-fernandes"}, "edited": false, "score": 0, "creation_date": 1483533681, "post_id": 41454315, "comment_id": 70133620, "body": "Dimitri, can you tell me how can I get the SMTP email address of the sender?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1483605186, "post_id": 41454315, "comment_id": 70165951, "body": "What is wrong with <code>SenderEmailAddress</code> which is a regular property of <code>MailItem</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 6814465, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-q5r4l4mqVo4/AAAAAAAAAAI/AAAAAAAAAAA/VAvFKflNv3o/photo.jpg?sz=128", "display_name": "Elio Fernandes", "link": "https://stackoverflow.com/users/6814465/elio-fernandes"}, "edited": false, "score": 0, "creation_date": 1483718613, "post_id": 41488530, "comment_id": 70224736, "body": "Tony, With this can get the information I need. Thanks."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 0, "last_activity_date": 1483733243, "last_edit_date": 1483733243, "creation_date": 1483629570, "answer_id": 41488530, "question_id": 41454315, "link": "https://stackoverflow.com/questions/41454315/how-to-get-the-email-addresses-from-pr-transport-message-headers-with-vba/41488530#41488530", "title": "How to get the email addresses from PR_TRANSPORT_MESSAGE_HEADERS with VBA", "body": "<p>The macro below gets bigger every time I want to investigate a new mail item property.  I add the new property or properties, comment out those I do not need today, select a few relevant emails and run the macro. I can then examine the desktop file \u201cDemoExplorer.txt\u201d at my leisure.</p>\n\n<p>I have added all the \u201cnon-standard\u201d properties that seem relevant to your requirement.  Most seem duplicate of \u201cstandard properties\u201d.  The only one that seems useful is the \u201cTo:\u201d line of PR_TRANSPORT_MESSAGE_HEADERS.  The email addresses have been stripped out of the standard To property but they are present in the \u201cTo:\u201d line.</p>\n\n<p>Hope this helps.  </p>\n\n<pre><code>Public Sub DemoExplorer()\n\n  ' Outputs selected properties of selected emails to a file.\n\n  ' ???????  No record of when originally coded\n  ' 22Oct16  Output to desktop file rather than Immediate Window.\n  ' Various  New properties added as necessary\n\n  ' Technique for locating desktop from answer by Kyle:\n  ' http://stackoverflow.com/a/17551579/973283\n\n  ' Source of PropertyAccessor information:\n  ' https://www.slipstick.com/developer/read-mapi-properties-exposed-outlooks-object-model/\n\n  ' Needs reference to Microsoft Scripting Runtime if \"TextStream\"\n  ' and \"FileSystemObject\" are to be recognised\n\n  Dim AttachCount As Long\n  Dim AttachType As Long\n  Dim FileOut As TextStream\n  Dim Fso As FileSystemObject\n  Dim Exp As Outlook.Explorer\n  Dim InxA As Long\n  Dim InxR As Long\n  Dim ItemCrnt As MailItem\n  Dim NumSelected As Long\n  Dim Path As String\n  Dim PropAccess As Outlook.propertyAccessor\n\n  Path = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\")\n\n  Set Fso = CreateObject(\"Scripting.FileSystemObject\")\n  Set FileOut = Fso.CreateTextFile(Path &amp; \"\\DemoExplorer.txt\", True)\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  NumSelected = Exp.Selection.Count\n\n  If NumSelected = 0 Then\n    Debug.Print \"No emails selected\"\n  Else\n    For Each ItemCrnt In Exp.Selection\n      With ItemCrnt\n        FileOut.WriteLine \"--------------------------\"\n        FileOut.WriteLine \"From (Sender): \" &amp; .Sender\n        FileOut.WriteLine \"From (Sender name): \" &amp; .SenderName\n        FileOut.WriteLine \"From (Sender email address): \" &amp; .SenderEmailAddress\n        FileOut.WriteLine \"Subject: \" &amp; CStr(.Subject)\n        FileOut.WriteLine \"Received: \" &amp; Format(.ReceivedTime, \"dMMMyy h:mm:ss\")\n        FileOut.WriteLine \"To: \" &amp; .To\n        FileOut.WriteLine \"CC: \" &amp; .CC\n        FileOut.WriteLine \"Recipients: \" &amp; .Recipients(1)\n        For InxR = 2 To .Recipients.Count\n          FileOut.WriteLine Space(12) &amp; .Recipients(InxR)\n        Next\n        'FileOut.WriteLine \"Text: \" &amp; Replace(Replace(Replace(.Body, vbLf, \"{lf}\"), vbCr, \"{cr}\"), vbTab, \"{tb}\")\n        'FileOut.WriteLine \"Html: \" &amp; Replace(Replace(Replace(.HtmlBody, vbLf, \"{lf}\"), vbCr, \"{cr}\"), vbTab, \"{tb}\")\n        'AttachCount = .Attachments.Count\n        'FileOut.WriteLine \"Number of attachments: \" &amp; AttachCount\n        'For InxA = 1 To AttachCount\n        '  AttachType = .Attachments(InxA).Type\n        '  FileOut.WriteLine \"Attachment \" &amp; InxA\n        '  FileOut.Write \"  Attachment type: \"\n        '  Select Case AttachType\n        '    Case olByValue\n        '      FileOut.WriteLine \"By value\"\n        '    Case olEmbeddeditem\n        '      FileOut.WriteLine \"Embedded item\"\n        '    Case olByReference\n        '      FileOut.WriteLine \"By reference\"\n        '    Case olOLE\n        '      FileOut.WriteLine \"OLE\"\n        '    Case Else\n        '      FileOut.WriteLine \"Unknown \" &amp; AttachType\n        '  End Select\n        '  ' I recall PathName giving an error for some types\n        '  On Error Resume Next\n        '  FileOut.WriteLine \"  Path: \" &amp; .Attachments(InxA).PathName\n        '  On Error GoTo 0\n        '  FileOut.WriteLine \"  File name: \" &amp; .Attachments(InxA).FileName\n        '  FileOut.WriteLine \"  Display name: \" &amp; .Attachments(InxA).DisplayName\n        '  ' I do not recall every seeing a parent but it is listed as a property\n        '  ' but for some attachment types it gives an error\n        '  On Error Resume Next\n        '  FileOut.WriteLine \"  Parent: \" &amp; .Attachments(InxA).Parent\n        '  On Error GoTo 0\n        '  FileOut.WriteLine \"  Position: \" &amp; .Attachments(InxA).Position\n        'Next\n\n        Set PropAccess = .propertyAccessor\n\n        FileOut.WriteLine \"PR_RECEIVED_BY_NAME: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0040001E\")\n        FileOut.WriteLine \"PR_SENT_REPRESENTING_NAME: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0042001E\")\n        FileOut.WriteLine \"PR_REPLY_RECIPIENT_NAMES: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0050001E\")\n        FileOut.WriteLine \"PR_SENT_REPRESENTING_EMAIL_ADDRESS: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0065001E\")\n        FileOut.WriteLine \"PR_RECEIVED_BY_EMAIL_ADDRESS: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0076001E\")\n        FileOut.WriteLine \"PR_TRANSPORT_MESSAGE_HEADERS:\" &amp; vbLf &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x007D001E\")\n        FileOut.WriteLine \"PR_SENDER_NAME: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0C1A001E\")\n        FileOut.WriteLine \"PR_SENDER_EMAIL_ADDRESS: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0C1F001E\")\n        FileOut.WriteLine \"PR_DISPLAY_BCC: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0E02001E\")\n        FileOut.WriteLine \"PR_DISPLAY_CC: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0E03001E\")\n        FileOut.WriteLine \"PR_DISPLAY_TO: \" &amp; _\n                           PropAccess.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x0E04001E\")\n\n        Set PropAccess = Nothing\n      End With\n    Next\n  End If\n\n  FileOut.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 440, "user_id": 6814465, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-q5r4l4mqVo4/AAAAAAAAAAI/AAAAAAAAAAA/VAvFKflNv3o/photo.jpg?sz=128", "display_name": "Elio Fernandes", "link": "https://stackoverflow.com/users/6814465/elio-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 41488530, "answer_count": 1, "score": -1, "last_activity_date": 1593414849, "creation_date": 1483488593, "last_edit_date": 1593414849, "question_id": 41454315, "link": "https://stackoverflow.com/questions/41454315/how-to-get-the-email-addresses-from-pr-transport-message-headers-with-vba", "title": "How to get the email addresses from PR_TRANSPORT_MESSAGE_HEADERS with VBA", "body": "<p>How can I get the email addresses from <strong>PR_TRANSPORT_MESSAGE_HEADERS</strong> using VBA?</p>\n\n<p>I have been trying some regular expressions but I never worked with it and I am having some problems.</p>\n\n<p>I need to retrieve the email address from \"To:\" and \"From:\" and \"CC:\"</p>\n"}, {"tags": ["vba", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1483484522, "post_id": 41453516, "comment_id": 70113881, "body": "Please reformat your <b><code>code</code></b>"}], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": true, "score": 1, "last_activity_date": 1483487465, "creation_date": 1483487465, "answer_id": 41454151, "question_id": 41453516, "link": "https://stackoverflow.com/questions/41453516/open-a-recordset-with-a-parameter-from-an-open-form/41454151#41454151", "title": "Open a recordset with a parameter from an open form", "body": "<p>You need to remove the form and field reference from the double quotes and join it to the rest of the sql string with an ampersand.</p>\n\n<pre><code>Set rstEMail = MyDB.OpenRecordset(\"Select [Courriel] FROM [N_BR_TEST_TOTAL]where [D examen]=\" &amp; [Forms]![F-EVENEMENT]![DATE], dbOpenSnapshot, dbOpenForwardOnly)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7371541, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153934160452030/picture?type=large", "display_name": "Alain Day", "link": "https://stackoverflow.com/users/7371541/alain-day"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 41454151, "answer_count": 1, "score": 1, "last_activity_date": 1483643424, "creation_date": 1483483335, "last_edit_date": 1483643424, "question_id": 41453516, "link": "https://stackoverflow.com/questions/41453516/open-a-recordset-with-a-parameter-from-an-open-form", "title": "Open a recordset with a parameter from an open form", "body": "<p>I'm trying to send emails from Access to Outlook. The record-set is to be base on a table using a parameter (date) on an open form.</p>\n\n<p>I get this running OK : </p>\n\n<pre><code>    Set rstEMail = MyDB.OpenRecordset(\"Select [Courriel] FROM [N_BR_TEST_TOTAL]where [D examen]=#2016-08-20#\", dbOpenSnapshot, dbOpenForwardOnly)\n</code></pre>\n\n<p>But not this : </p>\n\n<pre><code>    Set rstEMail = MyDB.OpenRecordset(\"Select [Courriel] FROM [N_BR_TEST_TOTAL]where [D examen]=[Forms]![F-EVENEMENT]![DATE]\", dbOpenSnapshot, dbOpenForwardOnly)\n</code></pre>\n\n<hr>\n\n<p>The second line gives a Run-time error 3061: Too few parameters. Expected 1.</p>\n\n<p>Is there away to pass the value of the date on the Select/Where?</p>\n\n<p>I'd like for an email to be sent to all registered for an event on a specific date shown on the form containing the command button that run the code</p>\n\n<hr>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 4, "creation_date": 1483481769, "post_id": 41452733, "comment_id": 70112920, "body": "The built-in data entry form is not customizable.  To add data validation, you would need to insert a user form into your project. Then you can add combo boxes or perform validation using events, etc."}, {"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1483481887, "post_id": 41452733, "comment_id": 70112971, "body": "Your question is too vague. Please be more explicit, show us what you did. At a high level, you can get the look up values, use a hidden sheet, and ranges from that hidden sheet as dropdown list candidates for data validation"}, {"owner": {"reputation": 181, "user_id": 3258041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/98b2a65bb17e4cde7d71f106a65d63bb?s=128&d=identicon&r=PG&f=1", "display_name": "jhugo", "link": "https://stackoverflow.com/users/3258041/jhugo"}, "reply_to_user": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1483483362, "post_id": 41452733, "comment_id": 70113479, "body": "@dgorti , I&#39;m using the built-in form provided by Excel for a table (range). No vba yet, and apparently it is not customizable, so I will build my own form in vba. Thanks for your answers"}, {"owner": {"reputation": 181, "user_id": 3258041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/98b2a65bb17e4cde7d71f106a65d63bb?s=128&d=identicon&r=PG&f=1", "display_name": "jhugo", "link": "https://stackoverflow.com/users/3258041/jhugo"}, "reply_to_user": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1483483398, "post_id": 41452733, "comment_id": 70113494, "body": "Thanks @tlemaster. I will build my own vba form then"}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 3258041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/98b2a65bb17e4cde7d71f106a65d63bb?s=128&d=identicon&r=PG&f=1", "display_name": "jhugo", "link": "https://stackoverflow.com/users/3258041/jhugo"}, "is_accepted": true, "score": 1, "last_activity_date": 1483483485, "creation_date": 1483483485, "answer_id": 41453546, "question_id": 41452733, "link": "https://stackoverflow.com/questions/41452733/data-validation-dropdown-in-standard-excel-form/41453546#41453546", "title": "Data Validation dropdown in standard excel form", "body": "<p>The Excel built-in data entry form is not customizable</p>\n"}], "owner": {"reputation": 181, "user_id": 3258041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/98b2a65bb17e4cde7d71f106a65d63bb?s=128&d=identicon&r=PG&f=1", "display_name": "jhugo", "link": "https://stackoverflow.com/users/3258041/jhugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 1, "accepted_answer_id": 41453546, "answer_count": 1, "score": 2, "last_activity_date": 1483483485, "creation_date": 1483479245, "last_edit_date": 1483480169, "question_id": 41452733, "link": "https://stackoverflow.com/questions/41452733/data-validation-dropdown-in-standard-excel-form", "title": "Data Validation dropdown in standard excel form", "body": "<p>I'm using an excel built-in data entry form for a table, and I would like to get the same data validation dropdowns from the table in the form. Is this possible?</p>\n\n<p>If vba is the answer, how do I get the form fields in vba to add the proper conditions?</p>\n\n<p>Thanks!!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1483476149, "post_id": 41451941, "comment_id": 70110413, "body": "You are using * would be my guess maybe.  Do you know where in the loop this happens, isolate the char that&#39;s causing it"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1483476639, "post_id": 41451941, "comment_id": 70110641, "body": "What does the <code>*</code> do here, <code>Dim A As String * 1</code>?  Also, when you get to the <code>*</code>, you want to find/replace <code>~*</code>."}, {"owner": {"reputation": 85, "user_id": 7332258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a40d6b7cd236abb86ca385f9e488b8d2?s=128&d=identicon&r=PG&f=1", "display_name": "tlaw the outlaw", "link": "https://stackoverflow.com/users/7332258/tlaw-the-outlaw"}, "edited": false, "score": 0, "creation_date": 1483476777, "post_id": 41451941, "comment_id": 70110694, "body": "I removed the asterisks and it still deletes the entire sheet. I do not know where in the loop this happens - i am not too skillful in vba"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1483476809, "post_id": 41451941, "comment_id": 70110707, "body": "@BruceWayne - it&#39;s a <a href=\"http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11784/string#t=201701032053010822684\">fixed length string</a>."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1483477008, "post_id": 41451941, "comment_id": 70110804, "body": "1 Major Issue I see with this is the &quot;!&quot; being in a foreign character.  I know that excel freaks out when I try to remove it, without it being part of more characters.  Additionally, the apostrophe, in my past, has began removing entire cells worth of data... not sure why, but I&#39;ve had that issue as well.  Possibly if you made a replace function for each individual item, you can figure out the problem children, then combine later?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1483477848, "post_id": 41451941, "comment_id": 70111193, "body": "If your <code>Replace</code> is being done with <code>LookAt:=xlFormulas</code>, then changing something like <code>=IF(&#39;Sheet 5&#39;!A4&lt;&gt;&#39;Another Sheet&#39;!B6,D7*17,59)</code> to <code>=IF(Sheet 5A4Another SheetB6,D717,59)</code> is going to cause real problems.  If your worksheet <b>only</b> has values, you should be OK.  (Apart from the issues with wildcard and other special characters.)"}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483478400, "post_id": 41452425, "comment_id": 70111409, "body": "@YowE3K I will fix it"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483478732, "post_id": 41452425, "comment_id": 70111561, "body": "P.S.  I love your first sentence!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483479241, "post_id": 41452425, "comment_id": 70111810, "body": "You still have the backtick in <code>ForeignChars</code>.  (I don&#39;t use wildcards in <code>Find</code> often enough / at all, so I don&#39;t know whether a backtick actually is a special case or not.  All I know is that it <b>looks</b> strange being treated both ways.)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1483479055, "last_edit_date": 1483479055, "creation_date": 1483477800, "answer_id": 41452425, "question_id": 41451941, "link": "https://stackoverflow.com/questions/41451941/how-to-remove-specific-characters-from-large-set-of-data/41452425#41452425", "title": "How to remove specific characters from large set of data", "body": "<p>You must <strong>escape</strong> your problems:</p>\n\n<pre><code>Sub Removeforeigncharacters()\n  Dim ForeignChars As String\n  Dim RegChars As String\n\n  ForeignChars = \"!@%^&amp;|`~&lt;&gt;\u00b7\"\n  RegChars = \"\"\n  Set MyRange = ActiveSheet.UsedRange\n\n  Dim A As String * 1\n  Dim B As String * 1\n  Dim i As Integer\n\n  For i = 1 To Len(ForeignChars)\n    A = Mid(ForeignChars, i, 1)\n    B = Mid(RegChars, i, 1)\n\n    MyRange.Replace What:=A, Replacement:=B, LookAt:=xlPart, MatchCase:=False\n  Next\n\n  MyRange.Replace What:=\"~*\", Replacement:=\"\", LookAt:=xlPart, MatchCase:=False\n  MyRange.Replace What:=\"~`\", Replacement:=\"\", LookAt:=xlPart, MatchCase:=False\n  MyRange.Replace What:=\"~?\", Replacement:=\"\", LookAt:=xlPart, MatchCase:=False\n  MyRange.Replace What:=\"~~\", Replacement:=\"\", LookAt:=xlPart, MatchCase:=False\nEnd Sub\n</code></pre>\n\n<p>Note I have reduced <code>ForeignChars</code></p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 5, "last_activity_date": 1483478074, "creation_date": 1483478074, "answer_id": 41452477, "question_id": 41451941, "link": "https://stackoverflow.com/questions/41451941/how-to-remove-specific-characters-from-large-set-of-data/41452477#41452477", "title": "How to remove specific characters from large set of data", "body": "<p>The <code>What</code> parameter of <code>Range.Replace</code> uses <code>*</code> as a wildcard, which means that it will match every single character (and them replace them).  Note that this doesn't technically <em>remove</em> the characters because you're using fixed length strings - it replaces them with spaces because the code...</p>\n\n<pre><code>B = Mid(RegChars, i, 1)\n</code></pre>\n\n<p>...is always going to result in a space.</p>\n\n<p>If you need to search for the literal <code>*</code> instead of the wildcard match, you need to escape them:</p>\n\n<pre><code>  Dim A As String\n  Dim i As Integer\n\n  For i = 1 To Len(ForeignChars)\n    A = Mid(ForeignChars, i, 1)\n    If A Like \"[~*?`]\" Then A = \"~\" &amp; A\n    MyRange.Replace What:=A, Replacement:=vbNullString, LookAt:=xlPart, MatchCase:=False\n  Next\n</code></pre>\n\n<p>(I may have missed some that need escaping).</p>\n\n<p>Note that if you do this, you can't declare <code>A</code> as a fixed length string (there really isn't a compelling reason to do that anyway).</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1483480130, "creation_date": 1483480130, "answer_id": 41452934, "question_id": 41451941, "link": "https://stackoverflow.com/questions/41451941/how-to-remove-specific-characters-from-large-set-of-data/41452934#41452934", "title": "How to remove specific characters from large set of data", "body": "<p>Using an array should give you a significant performance boost.</p>\n\n<p>Here is how:</p>\n\n<ul>\n<li>Load the data into an array</li>\n<li>Test each element to see if it contains ant of the Foreign Characters\n\n<ul>\n<li>Remove the Foreign Characters</li>\n</ul></li>\n<li>Write the data back to the WorkSheet</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub Removeforeigncharacters()\n    Dim x As Long, y As Long\n    Dim Data As Variant, ForeignChars As Variant, v As Variant\n\n    ForeignChars = \"!@%^&amp;*|`~&lt;&gt;?\u00b7\"\n    Data = ActiveSheet.UsedRange.Value2\n\n    For x = 1 To UBound(Data, 1)\n        For y = 1 To UBound(Data, y)\n            For Each v In ForeignChars\n                If InStr(Data(x, y), v) Then\n                    Data(x, y) = Replace(Data(x, y), v, \"\")\n                End If\n            Next\n        Next\n    Next\n    ActiveSheet.UsedRange.Value2 = Data\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7332258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a40d6b7cd236abb86ca385f9e488b8d2?s=128&d=identicon&r=PG&f=1", "display_name": "tlaw the outlaw", "link": "https://stackoverflow.com/users/7332258/tlaw-the-outlaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 41452425, "answer_count": 3, "score": 3, "last_activity_date": 1483480130, "creation_date": 1483475897, "last_edit_date": 1483476800, "question_id": 41451941, "link": "https://stackoverflow.com/questions/41451941/how-to-remove-specific-characters-from-large-set-of-data", "title": "How to remove specific characters from large set of data", "body": "<p>I am cleaning a large set of data full of symbol characters ex. <code>!@%^&amp;*|'~&lt;&gt;?\u00b7</code> and want to remove them all at one time. The script below seems to do so effectively, however it then goes on to delete the entire contents of the workbook. </p>\n\n<pre><code>Sub Removeforeigncharacters()\n  Dim ForeignChars As String\n  Dim RegChars As String\n\n  ForeignChars = \"!@%^&amp;*|`~&lt;&gt;?\u00b7\"\n  RegChars = \"\"\n  Set MyRange = ActiveSheet.UsedRange\n\n  Dim A As String * 1\n  Dim B As String * 1\n  Dim i As Integer\n\n  For i = 1 To Len(ForeignChars)\n    A = Mid(ForeignChars, i, 1)\n    B = Mid(RegChars, i, 1)\n    MyRange.Replace What:=A, Replacement:=B, LookAt:=xlPart, MatchCase:=False\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1483476319, "post_id": 41451937, "comment_id": 70110489, "body": "Use <code>Like</code>: <code>If (Cells(i, &quot;D&quot;).Value) Like &quot;*Saturday*&quot; Then</code>"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1483477399, "last_edit_date": 1483477399, "creation_date": 1483476619, "answer_id": 41452129, "question_id": 41451937, "link": "https://stackoverflow.com/questions/41451937/delete-entire-row-based-on-part-of-the-value-of-a-cell/41452129#41452129", "title": "Delete entire row based on part of the value of a cell", "body": "<p>Change</p>\n\n<pre><code>If (Cells(i, \"D\").Value) = \"*Saturday*\" Then`\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If (Cells(i, \"D\").Text) Like \"*Saturday*\" Then\n</code></pre>\n\n<p>Using <code>Text</code> instead of <code>Value</code> will access the displayed value, rather than the underlying value (which is a date), and using <code>Like</code> instead of <code>=</code> will allow wildcards to work.</p>\n\n<hr>\n\n<p>Your question is confusing as to which column the dates are in.  Some of your code (and your question) suggests they are in column A, but other parts of your code suggest column D.  If they are in column A, change the code above to use <code>\"A\"</code> instead of <code>\"D\"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1483477265, "post_id": 41452174, "comment_id": 70110934, "body": "Ahhh - I had forgotten that <code>Find</code> &quot;remembers&quot; which parameters it last used.  So omitting the <code>LookAt:=xlPart</code> would work if the OP had previously done a manual <code>Find</code> like that, but wouldn&#39;t work if their previous find was for a <code>xlWhole</code>.  That explains why the OP&#39;s code worked for me."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483477377, "post_id": 41452174, "comment_id": 70110990, "body": "yeah, this is one of the fun bits. :) Robust approach is to store your current settings, run the Find method and one you are done reset it."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1483476816, "creation_date": 1483476816, "answer_id": 41452174, "question_id": 41451937, "link": "https://stackoverflow.com/questions/41451937/delete-entire-row-based-on-part-of-the-value-of-a-cell/41452174#41452174", "title": "Delete entire row based on part of the value of a cell", "body": "<p>Set the LookAt Parameter to <code>xlPart</code></p>\n\n<pre><code>Find(\"Saturday\", , , xlPart)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7371221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4777e33d269845445430beeb8c494e6?s=128&d=identicon&r=PG&f=1", "display_name": "user7371221", "link": "https://stackoverflow.com/users/7371221/user7371221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1483484584, "creation_date": 1483475866, "last_edit_date": 1531164843, "question_id": 41451937, "link": "https://stackoverflow.com/questions/41451937/delete-entire-row-based-on-part-of-the-value-of-a-cell", "title": "Delete entire row based on part of the value of a cell", "body": "<p>I have spreadsheets that list the dates in column A, ex 12/1/2016 1:45:00 AM. I reformat all the cells in this column so they display Day, Month #, Year. Example <code>Thursday, December 01, 2016</code>. The <code>Find</code> function works if I click on the actual find button and search for the values, however I am struggling to code this. I want to delete all the rows that contain \"Saturday\" and \"Sunday\". The latest code I have tried is as follows;</p>\n\n<pre><code>Last = Cells(Rows.Count, \"D\").End(xlUp).Row\nFor i = Last To 1 Step -1\n    If (Cells(i, \"D\").Value) = \"*Saturday*\" Then\nCells(i, \"A\").EntireRow.Delete\n    End If\nNext i\n</code></pre>\n\n<p>I have also tried the following code as well;</p>\n\n<pre><code>Set Find = Range(\"A:A\").Find(\"Saturday\", LookIn:=xlValues)\nDo Until Find Is Nothing\n    Find.EntireRow.Delete\n    Set Find = Range(\"A:A\").FindNext\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483477216, "post_id": 41452045, "comment_id": 70110903, "body": "Thank you, it works great! Is there a way to do filter without assigning the range as a table? As i have described it in my second half of my issue? your codes works fine but I need to set my data range as a table."}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 1, "creation_date": 1483480235, "post_id": 41452045, "comment_id": 70112241, "body": "sure is, just use the .ListObjects(&quot;Table1&quot;) reference in pretty much the same way. If you record a macro it will give you the exact syntax. Probably easier than trying to get it by hand. Just take the bit you need from it but it is close to the same. I like to do an initial clear of all filters and then filter on what I want to see. When you do your copy method on the table (this is from memory so not 100% sure) use the .DataBodyRange and you might need to expressly state visible cells only but I don&#39;t remember at the moment."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483481285, "post_id": 41452045, "comment_id": 70112729, "body": "Thank you, I will dig more on the subject and once again, your method works just fine!! Thanks"}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483484307, "post_id": 41452045, "comment_id": 70113803, "body": "Give it a go, start by creating your table then record a macro to clear then set the filter. Copy the data from the table and paste it into the destination sheet. Then when you look at it there will be some cleaning up and reference changes to make but the code will be very close to what you need. If you have difficulties comment back and we will sort it out."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483549965, "post_id": 41452045, "comment_id": 70144843, "body": "OK, I will let you know. Thanks"}], "tags": [], "owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "is_accepted": true, "score": 1, "last_activity_date": 1483476572, "last_edit_date": 1483476572, "creation_date": 1483476261, "answer_id": 41452045, "question_id": 41451740, "link": "https://stackoverflow.com/questions/41451740/vba-filter-and-paste-as-values/41452045#41452045", "title": "vba filter and paste as values", "body": "<p>I can think of a few ways of doing it but without changing you existing code much you can just split the copy paste methods. Unless you are talking big data sets it shouldn't be a problem.</p>\n\n<pre><code>Set ws1 = Worksheets(\"AT\")\nSet ws2 = Worksheets(\"BT\")\nlr1 = ws1.Cells(ws1.Rows.Count, \"B\").End(xlUp).Row\nlr2 = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row + 1\nWith ws1.Range(\"B2\", \"R\" &amp; lr1)\n    .AutoFilter Field:=1, Criteria1:=\"#N/A\"\n    .Copy\nEnd With\nws2.Cells(lr2, \"A\").PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1366, "favorite_count": 1, "accepted_answer_id": 41452045, "answer_count": 1, "score": 0, "last_activity_date": 1483476572, "creation_date": 1483475092, "last_edit_date": 1483475738, "question_id": 41451740, "link": "https://stackoverflow.com/questions/41451740/vba-filter-and-paste-as-values", "title": "vba filter and paste as values", "body": "<p>I am trying to filter and copy the values from one sheet to another but I get stuck in one of my codes.  I can't seem to paste as values or don't know the correct syntax.</p>\n\n<pre><code>     Set ws1 = Worksheets(\"AT\")\n    Set ws2 = Worksheets(\"BT\")\n   lr1 = ws1.Cells(ws1.Rows.Count, \"B\").End(xlUp).Row\n    lr2 = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row + 1\n    With ws1.Range(\"B2\", \"R\" &amp; lr1)\n        .AutoFilter Field:=1, Criteria1:=\"#N/A\"\n        .Copy Destination:=ws2.Cells(lr2, \"A\")\n        .PasteSpecial (XlPastevalues, , , )\n    End With\n</code></pre>\n\n<p>The rest of the codes follow through without .pastespecial line so that is why I am not copying everything here except the portion I have issues with. Right now I don't have the following format because I am pasting values on the existing data at the end so I am just adding data (more rows) to it. And there are formats on the existing so that is why I don't want to mess with it.</p>\n\n<pre><code> Worksheets(\"Sheet2\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues \n</code></pre>\n\n<p>Also if anyone can also suggest a different way to do filters let me know. My current codes only work if my range is a table, so if I don't create a table for it, it will fail. My data is from A1 to R and there is a header. Without setting it as a table, it will filter from B2 and it will have wrong filter. See below. When I filter and copy, I do not need to copy header to my existing data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/poRMZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/poRMZ.png\" alt=\"enter image description here\"></a></p>\n"}]