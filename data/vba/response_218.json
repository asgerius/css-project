[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1552583288, "post_id": 55153804, "comment_id": 97075955, "body": "This worked perfectly. I am not that familiar with the excel object but now I know about dictionary. I added a count of the worksheet collection on the loop and it loops through them all.  Thank you for this very useful code for me to learn from and use.  geddeca"}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1552601983, "post_id": 55153804, "comment_id": 97084811, "body": "Oh Oh,  I adjusted the code to have more columns and have now accidentally got columns D and E which now hold List and Sale Price numbers which are now being changed by the code because of my lack of understanding.  Here is what I tried to use. ok I am struggling to enter code. Not enough characters left. will try next."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11198948"}, "reply_to_user": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1552606525, "post_id": 55153804, "comment_id": 97086018, "body": "You need to ask a new question with the revised code and a full description of the new conditions and any errors that are occurring."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11198948"}, "is_accepted": false, "score": 0, "last_activity_date": 1552528360, "creation_date": 1552528360, "answer_id": 55153804, "question_id": 55152844, "link": "https://stackoverflow.com/questions/55152844/excel-want-to-conglomerate-data-from-2-columns-then-sort-by-unique-strings-and/55153804#55153804", "title": "Excel - want to conglomerate data from 2 columns then sort by unique strings and count", "body": "<p>A dictionary can give you a unique list and count at the same time. Once the information is returned to the worksheet, a quick sort can be performed.</p>\n\n<p>The following gathers and processes the information from a single worksheet. It should be relatively easy to loop through a dozen worksheets and process each.</p>\n\n<ul>\n<li>collect values from worksheet</li>\n<li>process dictionary of list and count</li>\n<li>return new values to worksheet</li>\n<li>sort values by count descending then name ascending</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\n\nSub macro()\n\n    Dim i As Long, j As Long, w As Long\n    Dim arr As Variant, dict As Object\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n    dict.comparemode = vbTextCompare\n\n    For w = 1 To 1\n        With Worksheets(w)\n\n            'collect values from worksheet\n            arr = .Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"B\").End(xlUp)).Value2\n\n            'process dictionary of list and count\n            dict.RemoveAll\n            For i = LBound(arr, 1) To UBound(arr, 1)\n                For j = LBound(arr, 2) To UBound(arr, 2)\n                    dict.Item(arr(i, j)) = dict.Item(arr(i, j)) + 1\n                Next j\n            Next i\n\n            'return new values to worksheet\n            .Cells(1, \"D\").Resize(1, 2) = Array(\"list\", \"count\")\n            .Cells(2, \"D\").Resize(dict.Count, 1) = Application.Transpose(dict.keys)\n            .Cells(2, \"E\").Resize(dict.Count, 1) = Application.Transpose(dict.items)\n\n            'sort values by count descending then name ascending\n            With .Range(.Cells(1, \"D\"), .Cells(.Rows.Count, \"E\").End(xlUp))\n                .Sort key1:=.Columns(2), order1:=xlDescending, _\n                      key2:=.Columns(1), order2:=xlAscending, _\n                      Header:=xlYes\n            End With\n\n        End With\n    Next w\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552528360, "creation_date": 1552520989, "last_edit_date": 1552521216, "question_id": 55152844, "link": "https://stackoverflow.com/questions/55152844/excel-want-to-conglomerate-data-from-2-columns-then-sort-by-unique-strings-and", "title": "Excel - want to conglomerate data from 2 columns then sort by unique strings and count", "body": "<p>I am trying to gather data from a project with 12 worksheets (1 for every month) with approximately 1000 rows monthly. Each row has both a listing firm and selling firm column.\nI wish to filter both columns for every unique string and end up with a list/row for each company with a count of how many times they are listed. These rows then sorted descending numbers.\nie:     </p>\n\n<pre><code>CENTURY         15\nCENTRAL          4\nCIR              4\nPROFESSIONALS   3 etc.\nSUTTON          3\nHOUSE           1\nURBAN           1\n</code></pre>\n\n<hr>\n\n<pre><code>Listing Firm 1      Selling Firm 1 Name\nCENTURY             CIR \nMOUNTAINVIEW        CENTURY \nCENTRAL             CENTURY \nCIR                 SUTTON  \nCENTRAL             CENTRAL\nPLINTZ              DIRECT\nCENTURY             CIR \nCENTURY             CENTURY\nDIRECT              CENTURY \nSUTTON              CIR\nCENTURY             HOUSE\nCENTURY             PROFESSIONALS\nREALTY              CENTURY \nCENTRAL             CENTURY \nWALLER              HOUSE\nPROFESSIONALS       CENTURY\nPROFESSIONALS       CENTURY \nCENTURY             URBAN\nCENTURY            SUTTON \n</code></pre>\n\n<p>I am thinking that I need to do this VBA. Not sure if this is the case or not.:<br>\nCan I somehow combine the 2 columns into one array \nthen loop through the array for unique strings.\n and Assign that array to a variable (not sure how to use it for the next step though). I still need to go through the original 2000 or so entrys (column1 and column2) and total how many each Firm had.\nI hope this makes sense to someone. I am trying to organize it to the best of my ability which is limited.\nI am hoping for some guidance if my logic is correct and if so where to begin.\nThank you.  geddeca</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1552519922, "post_id": 55152638, "comment_id": 97045751, "body": "<a href=\"https://stackoverflow.com/q/2695198/2127508\">This question</a> discusses a similar issue and may be helpful"}], "answers": [{"tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": true, "score": 0, "last_activity_date": 1552532395, "creation_date": 1552532395, "answer_id": 55154301, "question_id": 55152638, "link": "https://stackoverflow.com/questions/55152638/vba-calling-a-subroutine-using-a-concatenation-of-strings/55154301#55154301", "title": "VBA - Calling a subroutine using a concatenation of strings", "body": "<p>I googled  'vba calling dynamic subroutine' and\nI found this at  <a href=\"http://www.vbaexpress.com/forum/showthread.php?36844-Solved-Dynamic-Procedure-call\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/showthread.php?36844-Solved-Dynamic-Procedure-call</a></p>\n\n<pre><code>Sub Call_This_2019()\n   ' do something\n   MsgBox (\"Got here\")\nEnd Sub\n\nSub From_this()\n    Dim theCallee As String\n    theCallee = \"Call_This_\" &amp; LTrim(Str(2019)) ' LTrim removes leading blank\n    'Call theCallee         ' Syntax error\n    'Call Eval(theCallee)   ' 2766 no Application object\n    Application.Run theCallee\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10615957"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 55154301, "answer_count": 1, "score": 0, "last_activity_date": 1552532395, "creation_date": 1552519382, "question_id": 55152638, "link": "https://stackoverflow.com/questions/55152638/vba-calling-a-subroutine-using-a-concatenation-of-strings", "title": "VBA - Calling a subroutine using a concatenation of strings", "body": "<p>is it possible to call a subroutine in VBA using a concatenation of strings? For example</p>\n\n<pre><code>Sub Call_This_2019()\n   ' do something\nend sub\n\nSub From_this()\n   Call (\"Call_This_\" + str(2019))\nSub\n</code></pre>\n\n<p>I haven't had any luck using this approach.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11194490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2713bab76e54ea4801062c9e876bd0a1?s=128&d=identicon&r=PG&f=1", "display_name": "bluesky", "link": "https://stackoverflow.com/users/11194490/bluesky"}, "edited": false, "score": 0, "creation_date": 1552523375, "post_id": 55152258, "comment_id": 97046624, "body": "Thanks for your response but it didn&#39;t solve my problem. Reason is, my data starts from cell E10 (and is dynamic in number of rows). In the above method, it copied over everything to A10. I want it to copy over to A1."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1552517388, "last_edit_date": 1552517388, "creation_date": 1552517066, "answer_id": 55152258, "question_id": 55152196, "link": "https://stackoverflow.com/questions/55152196/copy-range-of-cells-to-a-new-location/55152258#55152258", "title": "Copy range of cells to a new location", "body": "<p>This should work for you:</p>\n\n<pre><code>Sub Kopy()\n    Dim N As Long\n    N = Cells(Rows.Count, \"E\").End(xlUp).Row\n    Range(\"E1:E\" &amp; N).Cut Range(\"A1\")\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE:</strong></p>\n\n<p>You do not need to specify the same dimensions for the destination.  A single cell will do.</p>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WF7yC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WF7yC.png\" alt=\"enter image description here\"></a></p>\n\n<p>and after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wBFEI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wBFEI.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 11194490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2713bab76e54ea4801062c9e876bd0a1?s=128&d=identicon&r=PG&f=1", "display_name": "bluesky", "link": "https://stackoverflow.com/users/11194490/bluesky"}, "edited": false, "score": 0, "creation_date": 1552562525, "post_id": 55157065, "comment_id": 97061430, "body": "Thank you for your inputs. Have a great day."}], "tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": true, "score": 0, "last_activity_date": 1552548604, "creation_date": 1552548604, "answer_id": 55157065, "question_id": 55152196, "link": "https://stackoverflow.com/questions/55152196/copy-range-of-cells-to-a-new-location/55157065#55157065", "title": "Copy range of cells to a new location", "body": "<p>As per your comment above, see below code:</p>\n\n<pre><code>Sub CutPaste()\n\n    Dim i As Long\n    Dim sRow As Long, eRow As Long\n    Dim ws As Worksheet\n\n    Set ws = Sheets(\"Sheet1\")\n\n    'set the last row of data\n    eRow = ws.Range(\"E\" &amp; ws.Rows.Count).End(xlUp).Row\n\n    'find the start row of data\n    For i = 1 To eRow\n        If ws.Range(\"E\" &amp; i).Value &lt;&gt; \"\" Then\n            sRow = i\n            Exit For\n        End If\n    Next i\n\n    'now cut and paste\n    ws.Range(\"E\" &amp; sRow, \"E\" &amp; eRow).Cut ws.Range(\"A1\").Paste\n    'clear clipboard and object\n    Application.CutCopyMode = False\n    Set ws = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11194490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2713bab76e54ea4801062c9e876bd0a1?s=128&d=identicon&r=PG&f=1", "display_name": "bluesky", "link": "https://stackoverflow.com/users/11194490/bluesky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55157065, "answer_count": 2, "score": 0, "last_activity_date": 1552548604, "creation_date": 1552516628, "last_edit_date": 1552547595, "question_id": 55152196, "link": "https://stackoverflow.com/questions/55152196/copy-range-of-cells-to-a-new-location", "title": "Copy range of cells to a new location", "body": "<p>I have a range of cells (dynamic number of rows) that I want to copy over starting with A1 cell. The below code isn't working for me as it is not moving the entire range of cell values from current location to A1. Please advise.</p>\n\n<pre><code>Range(\"E:E\").Cut Range(\"A1\")\n</code></pre>\n\n<p>Example, </p>\n\n<p>If range in E is 50 rows, the cut and move should start at A1 and end at A50.\nIf range in E is 999 rows, the cut and move should start at A1 and end at A999.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1552515515, "post_id": 55151885, "comment_id": 97044447, "body": "Pretty much you have to <a href=\"https://stackoverflow.com/a/37749663/4717755\">code the undo stack yourself</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1552517395, "creation_date": 1552517395, "answer_id": 55152306, "question_id": 55151885, "link": "https://stackoverflow.com/questions/55151885/check-a-range-of-cells-and-if-criteria-is-met-message-box-appears-and-undos-acti/55152306#55152306", "title": "Check a range of cells and if criteria is met message box appears and undos action", "body": "<p>This seems to work for me for a single cell....</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim myRange As Range\nSet myRange = Range(\"M31:M41\")\n\nIf Not Intersect(Target, myRange) Is Nothing Then\n    If Target.Interior.Color = 15 Then\n        Application.EnableEvents = False\n            MsgBox \"Cannot Change This Cell\"\n            Application.Undo\n        Application.EnableEvents = True\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>And for a multi-ranged change...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim myRange As Range, xCell As Range\nSet myRange = Range(\"M31:M41\")\n\nFor Each xCell In Target\n    If Not Intersect(xCell, myRange) Is Nothing Then\n        If xCell.Interior.Color = 15 Then\n            Application.EnableEvents = False\n                MsgBox \"Cannot Change This Cell\"\n                Application.Undo\n            Application.EnableEvents = True\n            Exit Sub\n        End If\n    End If\nNext xCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11035368, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-42h_EBn1ZHM/AAAAAAAAAAI/AAAAAAAAAB8/X_RCxRsBylk/photo.jpg?sz=128", "display_name": "JamNalus", "link": "https://stackoverflow.com/users/11035368/jamnalus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552547472, "creation_date": 1552514724, "last_edit_date": 1552547472, "question_id": 55151885, "link": "https://stackoverflow.com/questions/55151885/check-a-range-of-cells-and-if-criteria-is-met-message-box-appears-and-undos-acti", "title": "Check a range of cells and if criteria is met message box appears and undos action", "body": "<p>I'm trying to verify a range of cells from M31:M41 and if the cells are grey and a user enters in information by mistake, then a message box appears and then the last action is undone. Here's my code so far </p>\n\n<pre><code>Set rng = ThisWorkbook.Sheets(\"Edit Entry\").Range(\"M31:M41\")\n\nFor each cell in rng \n    If cell.interior.Colorindex = 15 then \n        If Not Intersect(Target, Range(\"M31:M41\")) Is Nothing then \n            Msgbox \"NOT AN EDITABLE FIELD.\", vbCritical + vbOkOnly, \"NO DATA ENTRY\"\n\n            With Application \n                .EnableEvents = False \n                .Undo \n                .EnableEvents = True \n            End With \n        End If \n    End If \nNext Cell\n</code></pre>\n\n<p>The issue, is that it works how I want it to but it gives me the error </p>\n\n<blockquote>\n  <p>Run-Time error '1004': Method 'Undo' of object' _Application' Failed.</p>\n</blockquote>\n\n<p>Any ideas on how to achieve this without any coding issues? </p>\n"}, {"tags": ["excel", "xml", "vba", "child-nodes"], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1552555008, "post_id": 55151892, "comment_id": 97056657, "body": "Hint:-) Using <code>Dim xmlDoc As New MSXML2.DOMDocument60</code> referring to the current (recommended) <b>version 6.0</b>,  you even needn&#39;t set the XPath property explicitly as XPath 1.0 is already fully supported.  <code>MSXML2.DOMDocument</code> automatically refers to the last stable <i>version 3.0</i> sometimes necessary for compatibility reasons;  it allows the integration of XPath by explicit selection language setting as demonstrated above."}, {"owner": {"reputation": 23, "user_id": 11199745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d6947521278804418879f4d5ea4a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Hanna", "link": "https://stackoverflow.com/users/11199745/hanna"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1552572161, "post_id": 55151892, "comment_id": 97068075, "body": "Thanks a lot @T.M.!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1552514744, "creation_date": 1552514744, "answer_id": 55151892, "question_id": 55151669, "link": "https://stackoverflow.com/questions/55151669/how-to-get-a-record-not-from-first-child-xml-vba-api/55151892#55151892", "title": "How to get a record not from first child XML VBA API", "body": "<p>Here's something which does what you want:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim xmlDoc As New MSXML2.DOMDocument\nDim countries As MSXML2.IXMLDOMNodeList, country As MSXML2.IXMLDOMNode\n\n'need these next two....\nxmlDoc.setProperty \"SelectionLanguage\", \"XPath\"\nxmlDoc.setProperty \"SelectionNamespaces\", \"xmlns:wb='http://www.worldbank.org'\"\n\n'loading from a local file for testing\nIf Not xmlDoc.Load(ThisWorkbook.Path &amp; \"\\country.xml\") Then\n    MsgBox (\"Blad ladowania URL\")\n    Exit Sub\nEnd If\n\nSet countries = xmlDoc.SelectNodes(\"//wb:country\")\n\nDebug.Print countries.Length\n\nFor Each country In countries\n    Debug.Print \"------------------------------------\"\n    Debug.Print \"id\", country.Attributes.getNamedItem(\"id\").Text\n    Debug.Print \"Name\", country.SelectSingleNode(\"wb:name\").nodeTypedValue\n    Debug.Print \"Region\", country.SelectSingleNode(\"wb:region\").nodeTypedValue\n    'etc\nNext country\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11199745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d6947521278804418879f4d5ea4a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Hanna", "link": "https://stackoverflow.com/users/11199745/hanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "protected_date": 1584627482, "accepted_answer_id": 55151892, "answer_count": 1, "score": 2, "last_activity_date": 1584627366, "creation_date": 1552513524, "question_id": 55151669, "link": "https://stackoverflow.com/questions/55151669/how-to-get-a-record-not-from-first-child-xml-vba-api", "title": "How to get a record not from first child XML VBA API", "body": "<p>I've got data from WorldBank like this\n(source: <a href=\"http://api.worldbank.org/V2/country?incomeLevel=LIC\" rel=\"nofollow noreferrer\">http://api.worldbank.org/V2/country?incomeLevel=LIC</a>)\nTo use this VBA code you need to set References\nmicrosoft winhttp services\nmicrosoft xml\nmicrosoft 2.0 object library</p>\n\n<pre><code>&lt;wb:countries xmlns:wb=\"http://www.worldbank.org\" page=\"1\" pages=\"1\" per_page=\"50\" total=\"34\"&gt;\n&lt;wb:country id=\"AFG\"&gt;\n&lt;wb:iso2Code&gt;AF&lt;/wb:iso2Code&gt;\n&lt;wb:name&gt;Afghanistan&lt;/wb:name&gt;\n&lt;wb:region id=\"SAS\" iso2code=\"8S\"&gt;South Asia&lt;/wb:region&gt;\n&lt;wb:adminregion id=\"SAS\" iso2code=\"8S\"&gt;South Asia&lt;/wb:adminregion&gt;\n&lt;wb:incomeLevel id=\"LIC\" iso2code=\"XM\"&gt;Low income&lt;/wb:incomeLevel&gt;\n&lt;wb:lendingType id=\"IDX\" iso2code=\"XI\"&gt;IDA&lt;/wb:lendingType&gt;\n&lt;wb:capitalCity&gt;Kabul&lt;/wb:capitalCity&gt;\n&lt;wb:longitude&gt;69.1761&lt;/wb:longitude&gt;\n&lt;wb:latitude&gt;34.5228&lt;/wb:latitude&gt;\n&lt;/wb:country&gt;\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Dim strURL As String\nDim ws As Worksheet\n\nSet ws = Worksheets(\"API\")\n\nstrURL = ws.[API_URL]\n\nDim hReq As New WinHttpRequest\nhReq.Open \"GET\", strURL, False \nhReq.Send \n\nDim strResp As String\nstrResp = hReq.ResponseText\nDim xmlDoc As New MSXML2.DOMDocument\nIf Not xmlDoc.LoadXML(Right(strResp, Len(strResp) - 1)) Then\n    MsgBox (\"B\u0142\u0105d \u0142adowania URL\")\nEnd If\n\nDim xnodelist As MSXML2.IXMLDOMNodeList\nSet xnodelist = xmlDoc.getElementsByTagName(\"wb:countries\")\n\nDim xNode As MSXML2.IXMLDOMNode\nSet xNode = xnodelist.Item(0)\n\nDim obAtt1 As MSXML2.IXMLDOMAttribute\nDim obAtt2 As MSXML2.IXMLDOMAttribute\n\nDim xChild As MSXML2.IXMLDOMNode\nDim xChild2 As MSXML2.IXMLDOMNode\n\nDim intRow As Integer\nintRow = 3\n\nDim dtVal As String\nDim dblRate As String\nDim strVal As String\n</code></pre>\n\n<p>it works until here:</p>\n\n<pre><code>For Each xChild In xNode.ChildNodes\n\n    Set obAtt1 = xChild.Attributes.getNamedItem(\"id\")\n\n    strVal = Trim(obAtt1.Text)\n\n    ws.Cells(intRow, 2) = obAtt1.Text\n    intRow = intRow + 1\n\nNext xChild\n</code></pre>\n\n<p>it works only for first child - gets country code but I need for example to get wb:name (full name)\nI would be very thankful for any hints</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1552513673, "post_id": 55151666, "comment_id": 97043781, "body": "I could be wring but you&#39;re not incrementing &quot;dag&quot; ... if that&#39;s the case, it will loop forever."}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1552513682, "post_id": 55151666, "comment_id": 97043789, "body": "Doesn&#39;t look like your Do loop modifies the value of the dag variable."}, {"owner": {"reputation": 1, "user_id": 11199688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d35bce3fe360cd9b13b160af854a65d7?s=128&d=identicon&r=PG&f=1", "display_name": "Mathias", "link": "https://stackoverflow.com/users/11199688/mathias"}, "edited": false, "score": 0, "creation_date": 1552514220, "post_id": 55151666, "comment_id": 97044001, "body": "Thank you for commenting. I indeed forgot to increment &quot;dag&quot; . Stupid me. I tried again and now its giving me a range error (= Then Range(&quot;Cells(dag, rij2), Cells(dag, rij3)&quot;).Value = &quot;W&quot; )"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1552514357, "post_id": 55151666, "comment_id": 97044052, "body": "Your cells should not be in quotes. Try: <code>Range(Cells(dag, rij2), Cells(dag, rij3)).Value</code>"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1552514961, "post_id": 55151666, "comment_id": 97044252, "body": "Mathias, please change the title of your question as it is now misleading."}, {"owner": {"reputation": 1, "user_id": 11199688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d35bce3fe360cd9b13b160af854a65d7?s=128&d=identicon&r=PG&f=1", "display_name": "Mathias", "link": "https://stackoverflow.com/users/11199688/mathias"}, "edited": false, "score": 0, "creation_date": 1552514997, "post_id": 55151666, "comment_id": 97044270, "body": "That was it. Also &quot;dag&quot; and &quot;rij&quot; were switched around... Thanks everyone for helping."}], "owner": {"reputation": 1, "user_id": 11199688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d35bce3fe360cd9b13b160af854a65d7?s=128&d=identicon&r=PG&f=1", "display_name": "Mathias", "link": "https://stackoverflow.com/users/11199688/mathias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559052141, "creation_date": 1552513511, "last_edit_date": 1559052141, "question_id": 55151666, "link": "https://stackoverflow.com/questions/55151666/excel-vba-code-is-not-working-because-of-a-syntax-error", "title": "Excel VBA code is not working because of a syntax error", "body": "<p>I'm using the following code to check if a cell contains the word 'saturday' or 'sunday'. If yes I want to add text in some other cells. When I execute the code Excel freezes (I think it's stuck in the loop?).</p>\n\n<pre><code>Sub sbFORMAT()\n\n'delete all shiftdata\nSheets(\"ploegregeling\").Activate\n\nRange(\"ploeginput\").UnMerge\nRange(\"ploeginput\").ClearContents\nRange(\"ploeginput\").ClearComments\n\n\n'color weekends blue (= add W in cell, conditional formatting adds blue color + text)\n\nDim dag As Integer\nDim rij As Integer\nDim rij2 As Integer\nDim rij3 As Integer\n\ndag = 3\nrij = 5\n\nDo Until dag = 33\n\nrij2 = rij + 2\nrij3 = rij2 + 17\n\nIf Cells(dag, rij).Value = \"Saturday\" Or Cells(dag, rij).Value = \"Sunday\" Then Range(\"Cells(dag, rij2), Cells(dag, rij3)\").Value = \"W\"\n\ndag = dag + 1\n\nLoop\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NxE9u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NxE9u.png\" alt=\"The Excel sheets looks like this\"></a></p>\n\n<p>The code should add <code>W</code> in every cell in the range <code>G7:G24,H7:H24,N7:N24</code>, etc.\nBy writing <code>W</code> in the cell it will then turn blue (conditional formatting). This is working by doing it manually.</p>\n"}, {"tags": ["ms-access", "vba", "adobe", "activex", "acrobat"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1552515138, "post_id": 55151482, "comment_id": 97044331, "body": "It&#39;s my understanding that Adobe/PDF manipulation requires install of Acrobat, not just the Reader."}, {"owner": {"reputation": 39, "user_id": 9835522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed993c3a8b112f712c977cf5a29482b?s=128&d=identicon&r=PG&f=1", "display_name": "EscapeToTheMountains", "link": "https://stackoverflow.com/users/9835522/escapetothemountains"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552523525, "post_id": 55151482, "comment_id": 97046651, "body": "I can&#39;t pull it up on my home computer right now since it doesn&#39;t have Acrobat, but there&#39;s an option for Acrobat DC Browser Implementation or something similar, but I assumed that was using an internet browser window"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552531338, "post_id": 55151482, "comment_id": 97048460, "body": "Taking a closer look at your code. Nowhere do you show declaring and setting Adobe objects. Here is example of code manipulating Adobe objects <a href=\"http://www.accessforums.net/showthread.php?t=25574\" rel=\"nofollow noreferrer\">accessforums.net/showthread.php?t=25574</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552539366, "post_id": 55151482, "comment_id": 97050182, "body": "Okay, been exploring this. Since posted code is intended to work with ActiveX control, it is very different from the Adobe object code I referenced in previous comment. I have never had success with ActiveX controls and installing dll&#39;s; and, yes, everything I&#39;ve read advised to avoid ActiveX. I tried to adapt my code but the intrinsic Adobe library doesn&#39;t seem to have the methods and elements referenced in the ActiveX code. Documentation for any Adobe interaction/automation is scarce. Sorry, I got nothing."}, {"owner": {"reputation": 39, "user_id": 9835522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed993c3a8b112f712c977cf5a29482b?s=128&d=identicon&r=PG&f=1", "display_name": "EscapeToTheMountains", "link": "https://stackoverflow.com/users/9835522/escapetothemountains"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552587915, "post_id": 55151482, "comment_id": 97078501, "body": "The exact verbiage of the ActiveX control that I was referring to is &quot;Adobe Acrobat DC Browser Control Implementation&quot;, so I was really close off the top of my head. But that is discouraging to hear; I&#39;ll keep trying though. I will work with the link you have given me and go from there."}, {"owner": {"reputation": 39, "user_id": 9835522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed993c3a8b112f712c977cf5a29482b?s=128&d=identicon&r=PG&f=1", "display_name": "EscapeToTheMountains", "link": "https://stackoverflow.com/users/9835522/escapetothemountains"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552670695, "post_id": 55151482, "comment_id": 97113658, "body": "This isn&#39;t an answer to this question, but I wanted to share what I ended up doing to accomplish this task; I used a Web Browser control on the Microsoft form and I have programmed it to where users select the pdf based on selection from a combobox on the same form. The process is detailed here (<a href=\"https://www.youtube.com/watch?v=KeyoRBTAa9I\" rel=\"nofollow noreferrer\">link</a>), but my product is quite different from this seeing as I won&#39;t have my users picking the file that they open. So no ActiveX control, but this works just fine."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552679328, "post_id": 55151482, "comment_id": 97117762, "body": "I thought this would not allow PDF layers to function so would not be satisfactory?"}, {"owner": {"reputation": 39, "user_id": 9835522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed993c3a8b112f712c977cf5a29482b?s=128&d=identicon&r=PG&f=1", "display_name": "EscapeToTheMountains", "link": "https://stackoverflow.com/users/9835522/escapetothemountains"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552791896, "post_id": 55151482, "comment_id": 97143867, "body": "I had assumed that since it&#39;s a web browser control that it would only open links in a web browser window. But, if you put the link as a file location, then whatever your default program is set to is what will be used. The only downside of this is ensuring everyone has their default PDF viewer as Acrobat"}], "owner": {"reputation": 39, "user_id": 9835522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed993c3a8b112f712c977cf5a29482b?s=128&d=identicon&r=PG&f=1", "display_name": "EscapeToTheMountains", "link": "https://stackoverflow.com/users/9835522/escapetothemountains"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552512482, "creation_date": 1552512482, "question_id": 55151482, "link": "https://stackoverflow.com/questions/55151482/embedding-a-layered-pdf-into-an-access-database", "title": "Embedding a Layered PDF into an Access Database", "body": "<p>I am constructing a Microsoft Access 2016 (32-bit) database that shows information about roads, and I want to have a control on a form that allows the user to interact with a pdf through Adobe Acrobat. I have tried inserting an ActiveX control, but the first error that throws after inserting some code to display the .pdf file is \"Error: The OLE server isn't registered. To register the OLE server, reinstall it.\" After that, \"run-time error '438': Object doesn't support this property or method\" pops up and highlights </p>\n\n<p>My code currently:</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\nDim filePath As String\nfilePath = \"C:\\Users\\username1\\Documents\\CountyMapFile1.pdf\"\nAcroPDF0.src = filePath\nAcroPDF0.setShowToolbar (False)\nAcroPDF0.setShowScrollbars (False)\nAcroPDF0.setLayoutMode (\"SinglePage\")\nAcroPDF0.setPageMode (\"none\")\nAcroPDF0.setView (\"Fit\")\nAcroPDF0.Height = 9000\nEnd Sub\n\nPrivate Sub cmdShowToolbar_Click()\nIf cmdShowToolbar Then\nAcroPDF0.setShowToolbar (True)\nMe.cmdShowToolbar.Caption = \"Hide ToolBar\"\nElse\nAcroPDF0.setShowToolbar (False)\nMe.cmdShowToolbar.Caption = \"Show ToolBar\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I want to use the Acrobat Reader specifically because the .pdf in question is a map that has layers used to explore features contained within the map. <a href=\"https://connect.ncdot.gov/resources/State-Mapping/Pages/County-Bridge-Maps.aspx\" rel=\"nofollow noreferrer\">Here are links to the maps in question</a>. Select a county and then select County Maps, then you can download the Layered .pdf files from there. To use the layer capabilities, one must use the model tree in order to be able to select specific features. The model tree isn't accessible when opening the file in an internet browser, so a Web browser control on the form is not an option unfortunately.</p>\n\n<p>I have scoured the internet looking for the solution, but either my knowledge is too limited to understand what I need to do or I simply can't find it. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/6682322/access-database-form-activex-control-error\">This conversation</a> says to not even use ActiveX controls. But I have no idea what my other options are (besides third-party, costly solutions.)</p>\n\n<p>So my question is how do I register the OLE server and continue with developing this solution?</p>\n\n<p>My PC is running Windows 10 64-Bit. I hope that this is an issue that can be resolved to where I won't have to replicate the solution on every machine that will eventually be using this database as it's put onto the shared drive on the network. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1552512451, "post_id": 55151207, "comment_id": 97043252, "body": "That line just opens the CSV file for me... What are you trying to do once it&#39;s open?"}, {"owner": {"reputation": 117, "user_id": 5121252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/538e4777ddbdbb91283fb68fc09d3447?s=128&d=identicon&r=PG&f=1", "display_name": "Alf", "link": "https://stackoverflow.com/users/5121252/alf"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1552513710, "post_id": 55151207, "comment_id": 97043796, "body": "That line should open the CSV but also format the 18th &amp; 19th column as date MDY. To make the issue more apparent you can try Array(18, 9), Array(19, 9), which should NOT import those 2 columns, however all it disables are column 1 &amp; 2."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1552574897, "post_id": 55151207, "comment_id": 97070173, "body": "Very interesting - I&#39;m taking a look into this right now. Btw value 5 is &quot;YMD&quot; format, Value 3 is MDY."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1552575712, "post_id": 55151207, "comment_id": 97070762, "body": "Take a look at this post <a href=\"https://stackoverflow.com/questions/42197238/workbooks-opentext-not-parsing-csv-files-properly-excel-2016\">here</a>, this might help explain what&#39;s going on..."}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 2, "last_activity_date": 1552666826, "last_edit_date": 1552666826, "creation_date": 1552577077, "answer_id": 55166268, "question_id": 55151207, "link": "https://stackoverflow.com/questions/55151207/workbooks-opentext-ignoring-fieldinfo-column-parameter/55166268#55166268", "title": "Workbooks.OpenText ignoring FieldInfo column parameter", "body": "<p>I was able to reproduce this issue using a <code>.txt</code> file and using <code>Tab=True</code>:</p>\n\n<pre><code>Workbooks.OpenText Filename:=Path &amp; \"Testfile.txt\", DataType:=xlDelimited, Tab:=True, FieldInfo:=Array(Array(18, 9), Array(19, 9)), Local:=True\n</code></pre>\n\n<p>And by using value 9 (<code>xlSkipColumn</code>) I attempted to omit columns 18 and 19, but columns 1 and 2 were skipped instead (<code>Test1</code> and <code>Test2</code>):</p>\n\n<p><a href=\"https://i.stack.imgur.com/1SjEi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1SjEi.png\" alt=\"img1\"></a></p>\n\n<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.opentext\" rel=\"nofollow noreferrer\">documentation</a> for clearly says \"The column specifiers can be in any order\", but this looks to be incorrect. The first element of the first array will always be column 1, the first element of the second array will always be column 2, and after all the arrays have been iterated the rest of the columns will be parsed with the General setting.</p>\n\n<p>IMO, this looks like a bug to me. If it's <em>not</em> a bug, then the documentation is very confusing and needs to be re-written. </p>\n"}, {"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 2, "last_activity_date": 1552609229, "creation_date": 1552609229, "answer_id": 55173871, "question_id": 55151207, "link": "https://stackoverflow.com/questions/55151207/workbooks-opentext-ignoring-fieldinfo-column-parameter/55173871#55173871", "title": "Workbooks.OpenText ignoring FieldInfo column parameter", "body": "<p>This indeed looks like a bug or the documentation is misleading.  One workaround to avoid ugly code would be to import the text file without delimiting it and using <code>TextToColumns</code> to split it.  Something like that (which oddly enough seems to work):</p>\n\n<pre><code>Workbooks.OpenText Filename:=sPath, DataType:=xlDelimited, Comma:=False\n\nColumns(\"A:A\").TextToColumns Destination:=Range(\"A1\"), _\n    DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, _\n    ConsecutiveDelimiter:=False, _\n    FieldInfo:=Array(Array(18, 4), Array(19, 4))\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 5121252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/538e4777ddbdbb91283fb68fc09d3447?s=128&d=identicon&r=PG&f=1", "display_name": "Alf", "link": "https://stackoverflow.com/users/5121252/alf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 2, "accepted_answer_id": 55166268, "answer_count": 2, "score": 3, "last_activity_date": 1594145347, "creation_date": 1552511208, "question_id": 55151207, "link": "https://stackoverflow.com/questions/55151207/workbooks-opentext-ignoring-fieldinfo-column-parameter", "title": "Workbooks.OpenText ignoring FieldInfo column parameter", "body": "<p>I have the below line to import a csv format file.</p>\n\n<pre><code> Workbooks.OpenText Filename:=sPath, DataType:=xlDelimited, Comma:=True, FieldInfo:=Array(Array(18, 5), Array(19, 5)), Local:=True\n</code></pre>\n\n<p>From microsoft's documentation <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.opentext\" rel=\"nofollow noreferrer\">here</a>, the FieldInfo doesn't have to be in any order if it is in delimited. </p>\n\n<blockquote>\n  <p>The column specifiers can be in any order. If there's no column\n  specifier for a particular column in the input data, the column is\n  parsed with the General setting.</p>\n</blockquote>\n\n<p>However excel seems to treat the first array as 1st column and 2nd array as 2nd column no matter what I put in the first parameter <code>Array(Array(x, 5), Array(y, 5))</code>. So to reach the 18th &amp; 19th column, I have to do this, which isn't pretty:</p>\n\n<pre><code>Workbooks.OpenText Filename:=sPath, DataType:=xlDelimited, Comma:=True, _\n    FieldInfo:=Array(Array(1, 1), _\n    Array(2, 1), _\n    Array(3, 1), _\n    Array(4, 1), _\n    Array(5, 1), _\n    Array(6, 1), _\n    Array(7, 1), _\n    Array(8, 1), _\n    Array(9, 1), _\n    Array(10, 1), _\n    Array(11, 1), _\n    Array(12, 1), _\n    Array(13, 1), _\n    Array(14, 1), _\n    Array(15, 1), _\n    Array(16, 1), _\n    Array(17, 1), _\n    Array(18, 5), _\n    Array(19, 5)), _\n    Local:=True\n</code></pre>\n\n<p>csv file sample data:</p>\n\n<pre><code>fill_c1,pick_n2,po_num3,quanti4,addres5,cust_s6,color_7,size_d8,style9,shipto10,shipto11,addres12,addres13,city14,state15,zipcod16,custom17,start_18,end_da19,udford20\n\"52\",\"1\",\"2\",\"000000001\",\"000000000000000000000000000000\",\"6\",\"Z\",\"XS\",\"7\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"M\",20190310,20190318,\"CF3\"\n\"52\",\"1\",\"2\",\"000000002\",\"000000000000000000000000000000\",\"6\",\"Z\",\"S\",\"7\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"M\",\"20190310\",\"20190318\",\"CF3\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1552513391, "creation_date": 1552513391, "answer_id": 55151643, "question_id": 55151109, "link": "https://stackoverflow.com/questions/55151109/vba-importing-and-splitting-a-delimited-text-file/55151643#55151643", "title": "VBA importing and splitting a delimited text file", "body": "<p>Writing cell-by cell is pretty slow, so this would be faster.</p>\n\n<pre><code>For i = 2 To UBound(arrResultsLine) - 1\n\n     arr = Split(arrResultsLine(i), vbTab)\n\n     'write the data as an array\n     Sheets(\"RawData\").Cells(intRow, \"A\").Resize(1, 5).Value = _\n           Array(arr(0), arr(1), arr(2), arr(3), arr(4))\n\n     intRow = intRow + 1\n\nNext i\n</code></pre>\n\n<p>If you need more speed then create a 2-D array with all of the data and then write that directly to the sheet in one operation.</p>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1552519486, "creation_date": 1552519486, "answer_id": 55152647, "question_id": 55151109, "link": "https://stackoverflow.com/questions/55151109/vba-importing-and-splitting-a-delimited-text-file/55152647#55152647", "title": "VBA importing and splitting a delimited text file", "body": "<p>Best speed can be achieved by collecting all the data into an array, and writing it all to the sheet in one go.</p>\n\n<p>There are also a raft of other issues in your code, see imbeded notes below marked <code>&lt;~~~</code></p>\n\n<pre><code>Sub FindResults()\n    'Selecting file for import\n    Dim FileSelect As FileDialog '&lt;~~~ use explicit type\n    Dim PlateMapFolder As String\n\n    '&lt;~~~ declare all Variables\n    Dim SelectedFile As String\n    Dim strFileContent As String\n    Dim strResults() As String\n    Dim arrResultsLine() As String\n    Dim arrResultsTab() As String\n    Dim i As Long\n\n    PlateMapFolder = \"C:\\\"\n    Set FileSelect = Application.FileDialog(msoFileDialogFilePicker)\n    With FileSelect\n        .InitialFileName = PlateMapFolder\n        .AllowMultiSelect = False\n        .Title = \"Please select associated run\"\n        .Show\n\n        If .SelectedItems.Count = 0 Then\n            Exit Sub\n        End If\n\n        'SelectedFile = Dir(.SelectedItems(1)) '&lt;~~~ No need for Dir here\n        SelectedFile = .SelectedItems(1)\n    End With\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    'Splitting SelectedFile\n    Const strSearch = \"[Results]\"\n    Dim intFileNumber As Integer\n\n    intFileNumber = FreeFile\n\n    Open SelectedFile For Input As intFileNumber\n    strFileContent = Input(LOF(intFileNumber), intFileNumber)\n    Close intFileNumber '&lt;~~~ close file after use\n\n    'Split result file at [Results]\n    strResults = Split(strFileContent, strSearch)\n\n    'Split line breaks\n    arrResultsLine = Split(strResults(1), vbLf)\n\n    'Split each line by tab\n\n    ' &lt;~~~ declare and size array to hold results\n    Dim Res As Variant\n    ReDim Res(1 To UBound(arrResultsLine) - 2, 1 To 5)\n    'intRow = 1 &lt;~~~ not needed\n\n    '&lt;~~~ this will skip first and last line after [Results].\n    '     Is this what you want?\n    '     If not, also adjust Redim size\n    For i = 2 To UBound(arrResultsLine) - 1\n        arrResultsTab = Split(arrResultsLine(i), vbTab)\n        '&lt;~~~ collect data into array\n        Res(i - 1, 1) = arrResultsTab(0)\n        Res(i - 1, 2) = arrResultsTab(1)\n        Res(i - 1, 3) = arrResultsTab(2)\n        Res(i - 1, 4) = arrResultsTab(3)\n        Res(i - 1, 5) = arrResultsTab(4)\n    Next i\n    '&lt;~~~ write to sheet in one go\n    Sheets(\"RawData\").Range(\"A1\").Resize(UBound(Res, 1), UBound(Res, 2)).Value = Res\n\n    '&lt;~~~ turn these back on!\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11198556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ebd660e0f60b82fa4d9fc3c281dac2?s=128&d=identicon&r=PG&f=1", "display_name": "moneybags", "link": "https://stackoverflow.com/users/11198556/moneybags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 55152647, "answer_count": 2, "score": 1, "last_activity_date": 1552519486, "creation_date": 1552510811, "question_id": 55151109, "link": "https://stackoverflow.com/questions/55151109/vba-importing-and-splitting-a-delimited-text-file", "title": "VBA importing and splitting a delimited text file", "body": "<p>I have tab delimited files that need to be imported and then only certain information extracted and pasted into my workbook. I wrote the following Sub and it works, but it's slow. I have to imagine it's because of the for loop, but I'm pretty new to doing this and it's the best I  could come up with. I see EOF used, but can I use that after splitting?  </p>\n\n<pre><code>Sub FindResults()\n'Selecting file for import'\n        Dim FileSelect As Object\n            Dim PlateMapFolder As String\n                PlateMapFolder = \"C:\\\"\n        Set FileSelect = Application.FileDialog(msoFileDialogFilePicker)\n\n                With FileSelect\n                    .InitialFileName = PlateMapFolder\n                    .AllowMultiSelect = False\n                    .Title = \"Please select associated run\"\n                    .Show\n\n                        If .SelectedItems.Count = 0 Then\n                        Exit Sub\n                        End If\n\n                    SelectedFile = Dir(.SelectedItems(1))\n                End With\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n'Splitting SelectedFile\nConst strSearch = \"[Results]\"\nDim intFileNumber As Integer\n\nintFileNumber = FreeFile\n\nOpen SelectedFile For Input As intFileNumber\n    strFileContent = Input(LOF(intFileNumber), intFileNumber)\n\n    'Split result file at [Results]\n    strResults = Split(strFileContent, strSearch)\n\n    'Split line breaks\n    arrResultsLine = Split(strResults(1), vbLf)\n\n   'Split each line by tab\n   intRow = 1\n    For i = 2 To UBound(arrResultsLine) - 1\n        arrResultsTab = Split(arrResultsLine(i), vbTab)\n                Sheets(\"RawData\").Range(\"A\" &amp; CStr(intRow)).Value = arrResultsTab(0)\n                Sheets(\"RawData\").Range(\"B\" &amp; CStr(intRow)).Value = arrResultsTab(1)\n                Sheets(\"RawData\").Range(\"C\" &amp; CStr(intRow)).Value = arrResultsTab(2)\n                Sheets(\"RawData\").Range(\"D\" &amp; CStr(intRow)).Value = arrResultsTab(3)\n                Sheets(\"RawData\").Range(\"E\" &amp; CStr(intRow)).Value = arrResultsTab(4)\n            intRow = intRow + 1\n        Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "edited": false, "score": 1, "creation_date": 1552510809, "post_id": 55151012, "comment_id": 97042549, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5971292/vba-excel-getting-file-path-ends-with-folder\">VBA Excel Getting File Path (ends with folder)</a>"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 2, "creation_date": 1552510898, "post_id": 55151012, "comment_id": 97042599, "body": "Have you googled that? You\u2019ll find literally 100\u2019s of examples."}, {"owner": {"reputation": 3, "user_id": 11199582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Ou3E.jpg?s=128&g=1", "display_name": "Daniel De Anda", "link": "https://stackoverflow.com/users/11199582/daniel-de-anda"}, "edited": false, "score": 0, "creation_date": 1552518625, "post_id": 55151012, "comment_id": 97045398, "body": "Thanks everyone for your help. Actually this is what i needed <a href=\"https://www.youtube.com/watch?v=Y4PG2qr9tRM\" rel=\"nofollow noreferrer\">youtube.com/watch?v=Y4PG2qr9tRM</a>"}], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 7088521, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-muJwF_bXwCU/AAAAAAAAAAI/AAAAAAAAAds/6b79u8iMFfM/photo.jpg?sz=128", "display_name": "Saumitra Topinkatti", "link": "https://stackoverflow.com/users/7088521/saumitra-topinkatti"}, "is_accepted": false, "score": 0, "last_activity_date": 1552511864, "creation_date": 1552511864, "answer_id": 55151354, "question_id": 55151012, "link": "https://stackoverflow.com/questions/55151012/get-folder-path-as-string/55151354#55151354", "title": "Get Folder Path as String", "body": "<p><strong>1. Ask for a user to select the folder containing the necessary files for the macro to work with:</strong></p>\n\n<p>I would recommend you to use <strong>FolderDialog</strong> and <strong>Show</strong> the <strong>Dialog</strong> to the user, and let him/her choose the folder. Next, check whether the required files exist in the selected directory. Use <code>System.IO.File.Exists(&lt;path&gt;)=&lt;boolean&gt;</code> .</p>\n\n<p><strong>2. Trap that path:</strong></p>\n\n<p>Just after validating the folder path, you can save the folder path in a variable.\nThen do an assignment statement,\nLet's say you created a variable '<strong>path</strong>', so, <code>path = path &amp; \"\\\" &amp; &lt;file_name&gt;</code> .\nAnd there you have it, stored in '<strong>path</strong>'.</p>\n\n<p><strong>3. Replace it in the WorkBooks.Open:</strong></p>\n\n<p>Then use the following code:</p>\n\n<pre><code>Workbooks.Open (\"C:\\Users\\j.lopez\\Documents\\AdHoc Reports\\Serrano\\\" &amp; path)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8765, "user_id": 1945525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E7uTt.jpg?s=128&g=1", "display_name": "rickvdbosch", "link": "https://stackoverflow.com/users/1945525/rickvdbosch"}, "edited": false, "score": 0, "creation_date": 1552520371, "post_id": 55152531, "comment_id": 97045877, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/22458227\">From Review</a>"}, {"owner": {"reputation": 3, "user_id": 11199582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Ou3E.jpg?s=128&g=1", "display_name": "Daniel De Anda", "link": "https://stackoverflow.com/users/11199582/daniel-de-anda"}, "reply_to_user": {"reputation": 8765, "user_id": 1945525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E7uTt.jpg?s=128&g=1", "display_name": "rickvdbosch", "link": "https://stackoverflow.com/users/1945525/rickvdbosch"}, "edited": false, "score": 0, "creation_date": 1552521048, "post_id": 55152531, "comment_id": 97046029, "body": "Got it! Thank you for the review"}], "tags": [], "owner": {"reputation": 3, "user_id": 11199582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Ou3E.jpg?s=128&g=1", "display_name": "Daniel De Anda", "link": "https://stackoverflow.com/users/11199582/daniel-de-anda"}, "is_accepted": false, "score": -1, "last_activity_date": 1552521151, "last_edit_date": 1552521151, "creation_date": 1552518694, "answer_id": 55152531, "question_id": 55151012, "link": "https://stackoverflow.com/questions/55151012/get-folder-path-as-string/55152531#55152531", "title": "Get Folder Path as String", "body": "<p>EDIT- </p>\n\n<p>This code was adapted to my needs, and i found it on this YouTube Video</p>\n\n<pre><code>Dim diaFolder As FileDialog\n\nSet diaFolder = Application.FileDialog(msoFileDialogFolderPicker)\ndiaFolder.AllowMultiSelect = False\ndiaFolder.Show\n\nfle = diaFolder.SelectedItems(1)\n\nRange(\"A15\") = fle\n\nSet diaFolder = Nothing\n\n'Opening WorkBooks\n\nWorkbooks.Open (fle &amp; \"\\Daily Sports VIP Report.xlsx\")\n</code></pre>\n\n<p>video for Reference \n- <a href=\"https://www.youtube.com/watch?v=Y4PG2qr9tRM\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=Y4PG2qr9tRM</a></p>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 3391693, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/89ff10741fcd628a6c587e60e04f86a4?s=128&d=identicon&r=PG&f=1", "display_name": "Durgaprasad", "link": "https://stackoverflow.com/users/3391693/durgaprasad"}, "is_accepted": false, "score": 0, "last_activity_date": 1552536456, "creation_date": 1552536456, "answer_id": 55154827, "question_id": 55151012, "link": "https://stackoverflow.com/questions/55151012/get-folder-path-as-string/55154827#55154827", "title": "Get Folder Path as String", "body": "<p>Selecting file or folder with Browse File Option with VBA</p>\n\n<pre><code>' To Select File \n\nsub select_file()\nselected_file = Application.GetOpenFilename(, , \"Select File\", , False)\nEnd sub\n\n' To Select Folder\n\nSub selectfolder()\n\nzhr_folder = GetFolder()\n\nEnd sub\n\n\n\nFunction GetFolder() As String\n\nDim fldr As FileDialog\n\nDim sItem As String\n\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith fldr\n\n    .Title = \"Select a Folder\"\n\n    .AllowMultiSelect = False\n\n    .InitialFileName = \"\"\n\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n\n    sItem = .SelectedItems(1)\n\nEnd With\n\nNextCode:\n\nGetFolder = sItem\n\nSet fldr = Nothing\n\nEnd Function\n</code></pre>\n\n<p>Post that you can combine both file and folder names to adapt your needs</p>\n\n<p>Source: <a href=\"https://play.google.com/store/apps/details?id=com.vbausefulcodes.dp\" rel=\"nofollow noreferrer\">https://play.google.com/store/apps/details?id=com.vbausefulcodes.dp</a></p>\n"}], "owner": {"reputation": 3, "user_id": 11199582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Ou3E.jpg?s=128&g=1", "display_name": "Daniel De Anda", "link": "https://stackoverflow.com/users/11199582/daniel-de-anda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1385, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1552536456, "creation_date": 1552510300, "last_edit_date": 1552510992, "question_id": 55151012, "link": "https://stackoverflow.com/questions/55151012/get-folder-path-as-string", "title": "Get Folder Path as String", "body": "<p>I'm relatively new with VBA and currently working on a macro that will change from PC to PC, for test purposes I'm using the direct path:</p>\n\n<pre><code>Sub VIP()\n\n'Define Folder Paths &amp; Workbooks\n\nWorkbooks.Open (\"C:\\Users\\j.lopez\\Documents\\AdHoc Reports\\Serrano\\Daily VIP Report Master.xlsx\")\n</code></pre>\n\n<p>to open the workbooks, but eventually that path will change, so i was thinking to make the user select the folder path with:</p>\n\n<pre><code>Application.FileDialog(msoFileDialogFolderPicker)\n</code></pre>\n\n<p>But im lost, how can i properly:</p>\n\n<ul>\n<li>1.- Ask for a user to select the folder containing the necessary files for the macro to work with</li>\n<li>2.- Trap that path</li>\n<li>3.- Replace it in the WorkBooks.Open</li>\n</ul>\n"}, {"tags": ["arrays", "excel", "vba", "string"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1552512571, "post_id": 55150982, "comment_id": 97043308, "body": "Is it currently performing badly or something?"}, {"owner": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1552512648, "post_id": 55150982, "comment_id": 97043342, "body": "not really - just seems redundant/good learning experience"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 1, "creation_date": 1552512871, "post_id": 55150982, "comment_id": 97043459, "body": "I like your current approach but if you want to use an array or something, look at redim preserve and then google pasting arrays to ranges."}], "answers": [{"comments": [{"owner": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "edited": false, "score": 0, "creation_date": 1552513347, "post_id": 55151563, "comment_id": 97043672, "body": "will the end(x1Up).row work for this case b/c it&#39;s all forumlas?"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "edited": false, "score": 0, "creation_date": 1552540752, "post_id": 55151563, "comment_id": 97050546, "body": "end(xlup) will still work with formulae. I have just double checked this."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "edited": false, "score": 0, "creation_date": 1552541124, "post_id": 55151563, "comment_id": 97050636, "body": "@novawaly If this code works and solves your problem please mark as answer."}], "tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": true, "score": 0, "last_activity_date": 1552543850, "last_edit_date": 1552543850, "creation_date": 1552512891, "answer_id": 55151563, "question_id": 55150982, "link": "https://stackoverflow.com/questions/55150982/storing-a-string-and-ouputting-to-multiple-cells-in-vba/55151563#55151563", "title": "Storing a String and ouputting to Multiple Cells in VBA", "body": "<p>So with this I personally wouldn't want to use an array. I would prefer using a collection. It is easier because you do not know the parameters for your array so it is tough to give it dimensions. </p>\n\n<p>Nonetheless find below a possible solution. Work it to your needs. I have yet to test or debug myself. But should do the trick.</p>\n\n<pre><code>Sub ErrorCheck()\n\n    Dim x As Long, lRow1 As Long, lRow2 As Long\n    Dim myCollection As New Collection\n    Dim ws As Worksheet\n    Dim mySheet As Worksheet\n\n    Set mySheet = Sheets(\"ErrorCheckSheet\")\n\n    'create the for loop to cycle through worksheets\n    For Each ws In ThisWorkbook.Worksheets\n        'set the lrow to iterate through column\n        'set the colum for your need - \"Error\" column\n        lRow1 = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n        'IF lRow does not match your cell, use a static variable ie. 50\n        'assuming your data starts in row 2 as per picture\n        For x = 2 To lRow1\n            'check each cell for error text\n            If ws.Range(\"A\" &amp; x).Text = \"Error\" Then\n                'when found add to collection\n                'adjust to meet your cell you want to input into collection\n                myCollection.Add ws.Range(\"B\" &amp; x).Text\n            End If\n        Next x\n     Next ws\n     'once you have completely cycled through your workbook your collection will now be loaded\n    For x = 1 To myCollection.Count\n        'set the lrow on the sheet you want to enter the data in\n        lRow2 = mySheet.Range(\"U\" &amp; mySheet.Rows.Count).End(xlUp).Row + 1\n        'now set the variable\n        mySheet.Range(\"U\" &amp; lRow2).Value = \"Error on\" &amp; myCollection(x)\n    Next x\n\n    Set myCollection = New Collection\n    Set mySheet = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 55151563, "answer_count": 1, "score": 0, "last_activity_date": 1552550476, "creation_date": 1552510131, "last_edit_date": 1552550476, "question_id": 55150982, "link": "https://stackoverflow.com/questions/55150982/storing-a-string-and-ouputting-to-multiple-cells-in-vba", "title": "Storing a String and ouputting to Multiple Cells in VBA", "body": "<p>I currently have  code set up that will loop through all the worksheets in my workbook, paste a date in a cell which, when non blank, will have the remaining cells in the row populate with data. </p>\n\n<p>At the beginning of each row - I have a formula that will say \"Error\" if any of the cells in that row has an error in it. like this:\n<a href=\"https://i.stack.imgur.com/8T9Eg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8T9Eg.png\" alt=\"enter image description here\"></a></p>\n\n<p>I then have another loop which will go back through each worksheet and check to see if there is an error in that cell and if so, will go to the first sheet in the workbook to a specific cell and add \"Error on xyz Tab\". If there are multiple errors, it'll go to the next row down and paste it. So it looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DrTep.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DrTep.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm thinking instead of looping through each sheet again, could i store the text string in a variable/array and just paste it on the front sheet at the end of the loop in the same manner?</p>\n\n<p>This is the code for the error loop that's currently set up:</p>\n\n<pre><code>For I = 1 To WS_Count \n    ActiveWorkbook.Worksheets(I).Activate\n\n    Cells.Find(What:=\"Date\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).End(xlDown).Offset(0, -1).Activate\n\n    If ActiveCell.Value = \"Error\" Then        \n        Application.Goto \"ErrorCheck\" \n\n        If ActiveCell.Offset(1, 0).Value = vbNullString Then\n            ActiveCell.Offset(1, 0).Value = \"Error on \" &amp; ActiveWorkbook.Worksheets(I).Name &amp; \" \" &amp; Hour(Now) &amp; \"00\"\n        Else\n            Selection.End(xlDown).Activate                \n            ActiveCell.Offset(1, 0).Value = \"Error on \" &amp; ActiveWorkbook.Worksheets(I).Name &amp; \" \" &amp; Hour(Now) &amp; \"00\"\n        End If\n\n    Else\n\n    End If\nNext I\n</code></pre>\n"}, {"tags": ["excel", "vba", "cell-formatting"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11036387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26588fad49989ef0a77fafb022d68258?s=128&d=identicon&r=PG&f=1", "display_name": "Jjc1000", "link": "https://stackoverflow.com/users/11036387/jjc1000"}, "edited": false, "score": 0, "creation_date": 1552514952, "post_id": 55151267, "comment_id": 97044249, "body": "Thank you for the answer. The text is entered manually (for the most part).Looks like it just can&#39;t be done like I was hoping. Thanks @teylyn"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1552511436, "creation_date": 1552511436, "answer_id": 55151267, "question_id": 55150954, "link": "https://stackoverflow.com/questions/55150954/excel-vba-custom-cell-formats-number-and-text-spacing/55151267#55151267", "title": "Excel (VBA?) - Custom Cell Formats, number and text spacing", "body": "<p>The cells contain text. Text formatting cannot be changed with a number format. Text will always shows as entered in the cell. If you want to see spaces, there will need to be spaces in the cell. </p>\n\n<p>You don't specify where the data comes from. If it is not entered manually, but loaded from another system, you could use a formula to add the spaces in the specific places and then hide the original column. </p>\n\n<pre><code>=LEFT(A1,2)&amp;\" \"&amp;MID(A1,3,3)&amp;\" \"&amp;MID(A1,6,5)&amp;\" \"&amp;RIGHT(A1,3)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>=REPLACE(REPLACE(REPLACE(A1,11,0,\" \"),6,0,\" \"),3,0,\" \")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/HWqoQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HWqoQ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 11036387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26588fad49989ef0a77fafb022d68258?s=128&d=identicon&r=PG&f=1", "display_name": "Jjc1000", "link": "https://stackoverflow.com/users/11036387/jjc1000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 55151267, "answer_count": 1, "score": 1, "last_activity_date": 1552511436, "creation_date": 1552510023, "question_id": 55150954, "link": "https://stackoverflow.com/questions/55150954/excel-vba-custom-cell-formats-number-and-text-spacing", "title": "Excel (VBA?) - Custom Cell Formats, number and text spacing", "body": "<p>I am working on an excel sheet that tracks report numbers. The report numbers all follow the same sequence. \n XX########X##, where X is a letter and # is a digit 0 thru 9. All report numbers are 2 letters followed by 8 digits, then 1 letter and then 2 more digits.</p>\n\n<p>The numbers/letters are not random but identify what is contained in the report. So, it's custom to refer to them in a specific cadence which is:\n XX ### ##### X##.\nAs you can see, this pattern is so much easier on the brain than the above.\nLike how phone numbers are all said in a specific ###-#### pattern or SS is ### ## ####.</p>\n\n<p>Anyway, I would like the column that these report numbers are in to \"display\" with spaces. I put display in quotations because I don't want to actually have a  space character in the cell. This will affect other parts of the spreadsheet downstream. </p>\n\n<p>Excel has built in cell formatting options (Format Cells > Custom). I am able to use to create a spacing pattern using zero (0).\n E.g. if my file reports were all numbers \"1234567891234\" I can input a custom pattern as \"00 000 00000 000\" and it will \"display\" \"12 345 67891 234\". However, I cannot get this to work with text and numbers. I have tried \"*\", \"@\", \"?\" but no luck. I am unable to find a solution in VBA but I suspect that is the way to go. \nThanks!</p>\n"}, {"tags": ["excel", "vba", "loops", "repeat"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1552509772, "creation_date": 1552509772, "answer_id": 55150900, "question_id": 55150800, "link": "https://stackoverflow.com/questions/55150800/vba-loop-repeat-formula-through-column/55150900#55150900", "title": "VBA loop, repeat formula through column", "body": "<p>If you want to use a loop, you can use something like the code below:</p>\n\n<pre><code>For i = 1 To 134\n    If Range(\"A\" &amp; i).Value &gt; 0 Then\n        Range(\"B\" &amp; i).FormulaR1C1 = \"X\"\n    Else\n        Range(\"B\" &amp; i\").FormulaR1C1 = \"Y\"\n    End If\nNext I\n</code></pre>\n\n<p>It can be done without a loop, something like:</p>\n\n<pre><code>Range(\"B1:B134\").Formula = \"=IF(A1&gt;0,\" &amp; Chr(34) &amp; \"X\" &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; \"Y\" &amp; Chr(34) &amp; \")\"\n</code></pre>\n\n<p>Not sure what formula you are trying to achieve with <code>.FormulaR1C1 = \"Y\"</code> ?</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11199514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7145d656f3256d5d33085b86965d2230?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/11199514/paolo"}, "edited": false, "score": 0, "creation_date": 1552988714, "post_id": 55152103, "comment_id": 97208758, "body": "Thanks, that&#39;s exactly what I was looking for"}, {"owner": {"reputation": 64, "user_id": 11119632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBBf8Yc4Kb8/AAAAAAAAAAI/AAAAAAAAMe8/oJYS_a3Xi5s/photo.jpg?sz=128", "display_name": "Kleberson Felix Silva", "link": "https://stackoverflow.com/users/11119632/kleberson-felix-silva"}, "reply_to_user": {"reputation": 1, "user_id": 11199514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7145d656f3256d5d33085b86965d2230?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/11199514/paolo"}, "edited": false, "score": 0, "creation_date": 1553089412, "post_id": 55152103, "comment_id": 97255687, "body": "Great! I am glad to hear that."}], "tags": [], "owner": {"reputation": 64, "user_id": 11119632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBBf8Yc4Kb8/AAAAAAAAAAI/AAAAAAAAMe8/oJYS_a3Xi5s/photo.jpg?sz=128", "display_name": "Kleberson Felix Silva", "link": "https://stackoverflow.com/users/11119632/kleberson-felix-silva"}, "is_accepted": false, "score": 0, "last_activity_date": 1552516066, "creation_date": 1552516066, "answer_id": 55152103, "question_id": 55150800, "link": "https://stackoverflow.com/questions/55150800/vba-loop-repeat-formula-through-column/55152103#55152103", "title": "VBA loop, repeat formula through column", "body": "<p>I'm trying to improve my English, I swear...</p>\n\n<p>I would do something like this:</p>\n\n<pre><code>dim row as long\ndim last_row as Long\n\nlast_row = ActiveSheet.Range(\"A1048576\").End(xlUp).Row\n\nFor row = 1 to last_row\n    If Range(\"A\" &amp; row).Value &gt; 0 Then\n        ActiveSheet.Range(\"B\" &amp; row).Value = \"X\"\n    Else\n        ActiveSheet.Range(\"B\" &amp; row).Value = \"Y\"\n    End If\nNext row\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1552518442, "last_edit_date": 1552518442, "creation_date": 1552518135, "answer_id": 55152443, "question_id": 55150800, "link": "https://stackoverflow.com/questions/55150800/vba-loop-repeat-formula-through-column/55152443#55152443", "title": "VBA loop, repeat formula through column", "body": "<h2>You do not need to loop to drop formulas in. You just need to know where the last row is!</h2>\n\n<hr>\n\n<p>Pick a column that is most likely to represent your last row (I am using <code>Column A</code> in my example) and then you can dynamically <em>drop-down</em> your equation in one line without the loop. </p>\n\n<p>The below will fill in the equation <code>A2 + 1</code> in <code>Column B</code> starting from 2nd row (<em>assuming you have a header row</em>) down to the last used row in <code>Column A</code></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub Formula_Spill()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\") '&lt;-- Update sheet!\nDim LR As Long\n\nLR = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row '&lt;-- Update column!\n\nws.Range(\"B2:B\" &amp; LR).Formula = \"=A2+1\" '&lt;-- Update formula!\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11199514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7145d656f3256d5d33085b86965d2230?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/11199514/paolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1026, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1616645922, "creation_date": 1552509373, "last_edit_date": 1552547276, "question_id": 55150800, "link": "https://stackoverflow.com/questions/55150800/vba-loop-repeat-formula-through-column", "title": "VBA loop, repeat formula through column", "body": "<p>I am trying to replicate in VBA the simple function in excel which allows you to repeat a function through an entire column, and stops when the columns on the side are empty. Specifically, I want to repeat an if - else if function for the entire relevant part of the column</p>\n\n<p>Here's an attempt which does not really work</p>\n\n<pre><code>Sub RepeatIfElseif\n    Range(\"A1\").Select\n    If selection &gt; 0 Then\n        Range(\"B1\").Select\n        ActiveCell.FormulaR1C1 = \"X\"\n        Range(\"A1\").Select\n    ElseIf selection &lt;= 0 Then\n        Range(\"B1\").Select\n        ActiveCell.FormulaR1C1 = \"Y\"\n    End If\n    Range(\"B1\").Select\n    selection.AutoFill Destination:=Range(\"B1:B134\")\n</code></pre>\n\n<p>Is there any way I can do it with a loop?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1552508977, "post_id": 55150616, "comment_id": 97041703, "body": "Debug.Print the formula and try copying it into a cell - that will give you more info about what the problem might be."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1552511464, "post_id": 55150616, "comment_id": 97042826, "body": "You are missing the comma&#39;s between the lookup values and lookup ranges"}, {"owner": {"reputation": 15, "user_id": 4107497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c691b1e269dfda806343b648d34a0e?s=128&d=identicon&r=PG&f=1", "display_name": "C0BeH0K", "link": "https://stackoverflow.com/users/4107497/c0beh0k"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1552568810, "post_id": 55150616, "comment_id": 97065536, "body": "@chrisneilsen Thank you, it worked. For those who interested: <code>Cells(TableIndex, 43).FormulaR1C1 = &quot;=CONCATENATE(VLOOKUP(R&quot; &amp; i &amp; &quot;C&quot; &amp; ShiftColumn - 1 &amp; &quot;,R7C2:R&quot; &amp; ShiftCount &amp; &quot;C10,9),&quot;&quot; &quot;&quot;,TEXT(VLOOKUP(R&quot; &amp; i &amp; &quot;C&quot; &amp; ShiftColumn - 1 &amp; &quot;,R7C2:R&quot; &amp; ShiftCount &amp; &quot;C10,3),&quot;&quot;hhmm&quot;&quot;),&quot;&quot;-&quot;&quot;,TEXT(VLOOKUP(R&quot; &amp; i &amp; &quot;C&quot; &amp; ShiftColumn - 1 &amp; &quot;,R7C2:R&quot; &amp; ShiftCount &amp; &quot;C10,4),&quot;&quot;hhmm&quot;&quot;))&quot;</code>"}], "owner": {"reputation": 15, "user_id": 4107497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c691b1e269dfda806343b648d34a0e?s=128&d=identicon&r=PG&f=1", "display_name": "C0BeH0K", "link": "https://stackoverflow.com/users/4107497/c0beh0k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580154162, "creation_date": 1552508675, "last_edit_date": 1580154162, "question_id": 55150616, "link": "https://stackoverflow.com/questions/55150616/vba-formula-to-cell-that-contains-string-and-another-formula", "title": "VBA Formula to cell that contains string and another formula", "body": "<p>I need to paste into a cell, using VBA, 3 connected VLOOKUP searches</p>\n\n<pre><code>TableIndex = 1\ni = 1\nShiftColumn = 20\nShiftCount =  20\nCells(TableIndex, 43).FormulaR1C1 = \"=CONCATENATE(VLOOKUP(R\" &amp; i &amp; \"C\" &amp; ShiftColumn &amp; \"R7C2:R\" &amp; ShiftCount &amp; \"C10,9),TEXT(VLOOKUP(R\" &amp; i &amp; \"C\" &amp; ShiftColumn &amp; \"R7C2:R\" &amp; ShiftCount &amp; \"C10,3),\"\"hhmm\"\"),TEXT(VLOOKUP(R\" &amp; i &amp; \"C\" &amp; ShiftColumn &amp; \"R7C2:R\" &amp; ShiftCount &amp; \"C10,4),\"\"hhmm\"\"))\"\n</code></pre>\n\n<p>But it gives an 1004 error</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 3, "creation_date": 1552510804, "post_id": 55150562, "comment_id": 97042547, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2426371/in-an-access-form-how-to-return-to-previous-record-after-requery\">In an Access form, how to return to previous record after requery</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1553161583, "post_id": 55150562, "comment_id": 97285133, "body": "Have you actually tried using the techniques in the answer on the duplicate (using <code>.FindFirst</code> to navigate back to the record)? What went wrong? I&#39;m unconvinced it&#39;s not a duplicate just by you stating you want to use it in different scenario&#39;s."}, {"owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "edited": false, "score": 0, "creation_date": 1553195142, "post_id": 55150562, "comment_id": 97304800, "body": "The <code>.FindFirst</code> one uses <code>me.</code> object which I cannot use cause I am in a differnt form. Doing something like <code>Forms!frmMain!frmMainSub.Form.RecordSource.RecordsetClone</code> does not work and gives me Object required error"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1553198106, "post_id": 55150562, "comment_id": 97306090, "body": "Well, that&#39;s just because <code>RecordSource</code> should not be in there. It&#39;s just <code>Forms!frmMain!frmMainSub.Form.RecordsetClone</code>"}], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 557, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1553126928, "creation_date": 1552508411, "last_edit_date": 1553126885, "question_id": 55150562, "link": "https://stackoverflow.com/questions/55150562/how-to-keep-focus-after-requery-in-ms-access", "title": "How to keep focus after requery in MS Access?", "body": "<p>I am using the following code in VBA to keep focus on a certain recordset even after requery :</p>\n\n<pre><code>With Forms!frmMain!frmMainSub\n        strControlName = .Form.ActiveControl.Name\n        lngCurrentPos = .Form.Recordset.AbsolutePosition\n        .Requery\n        .Form.Recordset.AbsolutePosition = lngCurrentPos\n        .Form.Controls(strControlName).SetFocus\n    End With\n</code></pre>\n\n<p>The problem with this code is that the subform is in datasheet view and is usually sorted by a field. Since the code above records the absolute position on dynaset- or snapshot-type Recordset object, it cannot keep track of the sorted datasheet.</p>\n\n<p>Is there a better way to keep focus on a specific field after the form is requeired?</p>\n\n<p>Edit:</p>\n\n<p>This question is not a duplicate because there are answers about keeping the focus from the same form. The problem is that I am in a different form and also I want to preserve focus even when filter is applied to one of the fields.</p>\n"}, {"tags": ["arrays", "excel", "vba", "range", "row"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1552508488, "post_id": 55150387, "comment_id": 97041490, "body": "From the description and picture you&#39;ve provided I can&#39;t tell what you are trying to do... Can you please elaborate?"}], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1552508580, "creation_date": 1552508580, "answer_id": 55150597, "question_id": 55150387, "link": "https://stackoverflow.com/questions/55150387/insert-array-of-text-into-last-row/55150597#55150597", "title": "Insert array of text into last row", "body": "<p>You have to resize the target range to get the full array contents</p>\n\n<pre><code>ActiveSheet.Cells(last_row, \"A\").Resize(1, UBound(Header) + 1).Value = Header\n</code></pre>\n\n<p>:-)</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 11199326, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sVVx5vPIoUI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf9BWEoQ_6sHlb2NqpsaTE1B-dh4A/mo/photo.jpg?sz=128", "display_name": "Todd Cee", "link": "https://stackoverflow.com/users/11199326/todd-cee"}, "edited": false, "score": 0, "creation_date": 1552508975, "post_id": 55150617, "comment_id": 97041700, "body": "absolutely love it. thank you so much , exactly what i needed"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11198948"}, "is_accepted": false, "score": 0, "last_activity_date": 1552508675, "creation_date": 1552508675, "answer_id": 55150617, "question_id": 55150387, "link": "https://stackoverflow.com/questions/55150387/insert-array-of-text-into-last-row/55150617#55150617", "title": "Insert array of text into last row", "body": "<p>To put the array in several columns within one row simply resize the target. Remember that arrays are zero-based by default.</p>\n\n<pre><code>ActiveSheet.Cells(last_row, \"A\").Resize(1, Ubound(header)+1).Value = Header\n</code></pre>\n\n<p>To put the array in several rows within one column resize the target and transpose the array.</p>\n\n<pre><code>ActiveSheet.Cells(last_row, \"A\").Resize(Ubound(header)+1, 1).Value = application.transpose(Header)\n</code></pre>\n\n<p>To put the array into a single cell, Join the array.</p>\n\n<pre><code>ActiveSheet.Cells(last_row, \"A\").Value = Join(Header, \", \")\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11199326, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sVVx5vPIoUI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf9BWEoQ_6sHlb2NqpsaTE1B-dh4A/mo/photo.jpg?sz=128", "display_name": "Todd Cee", "link": "https://stackoverflow.com/users/11199326/todd-cee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 55150597, "answer_count": 2, "score": 1, "last_activity_date": 1552515139, "creation_date": 1552507693, "last_edit_date": 1552515139, "question_id": 55150387, "link": "https://stackoverflow.com/questions/55150387/insert-array-of-text-into-last-row", "title": "Insert array of text into last row", "body": "<p>For the life of me I cannot figure this out. I have a summary spreadsheet that is compiled based on multiple other sheets within the same workbook. On the main sheet I find the last row and need to insert row with text but cannot. Getting stuck. I'm using an array as these fields will never change. But only the first value of the array is displaying and not the rest. </p>\n\n<p>Here's my code:</p>\n\n<pre><code> sub Headers()\n\n    Dim last_row As Long \n    Dim Header() As Variant\n    Header = VBA.Array(\"koko\", \"momo\", \"dodo\", \"gogo\")\n\n    last_row = Cells(Rows.Count, \"B\").End(xlUp).Row + 1\n    ActiveSheet.Cells(last_row, \"A\").Value = Header\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KSJXM.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1552507105, "post_id": 55149957, "comment_id": 97040843, "body": "You don&#39;t need to use only <code>Target.Value</code>  - you can access both parts of the RUT using (eg) <code>Target.EntireRow.Cells(1).Value</code> and <code>Target.EntireRow.Cells(2).Value</code>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1552508673, "creation_date": 1552508673, "answer_id": 55150615, "question_id": 55149957, "link": "https://stackoverflow.com/questions/55149957/validate-chilean-rut-using-target-value-on-2-columns/55150615#55150615", "title": "Validate chilean RUT using Target.Value on 2 columns", "body": "<p>Here's an example (omitting your checking code)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range, rute, chk, c As Range\n\n    Set rng = Intersect(Target, Me.Range(\"C:D\"))\n\n    If Not rng Is Nothing Then\n        For Each c in rng.cells\n\n            rute = c.entirerow.cells(3).value\n            chk = c.entirerow.cells(4).value\n\n            'validate rute and chk here and\n            '  show msgbox if needed\n\n\n        Next c   \n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 10957872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b0147d8de5b9b313264d5bb3b76b29?s=128&d=identicon&r=PG&f=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/10957872/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55150615, "answer_count": 1, "score": 0, "last_activity_date": 1552547203, "creation_date": 1552505723, "last_edit_date": 1552547203, "question_id": 55149957, "link": "https://stackoverflow.com/questions/55149957/validate-chilean-rut-using-target-value-on-2-columns", "title": "Validate chilean RUT using Target.Value on 2 columns", "body": "<p>I'm trying to validate chilean RUT (12345678-9) using the <a href=\"https://es.wikipedia.org/wiki/Rol_%C3%9Anico_Tributario\" rel=\"nofollow noreferrer\">math algorithm</a> wich works perfectly but the procedure is applied only when the RUT it's stored in one cell.\nSo when the user inputs a RUT it will display a <code>MsgBox</code> letting the user know the result.</p>\n\n<pre><code>RUT\n----------\n01234567-8 ' MSGBOX \"THIS IS CORRECT/INCORRECT.\"\n</code></pre>\n\n<p>Now, our database stores RUT in two parts, the RUT itself <code>01234567</code> and the check digit -the number after the score symbol- <code>8</code>. \nI was thinking of a way to store and validate the RUT when the check digit column is changed but I can't figure how to store both values at the same time using <code>Target.Value</code>.\nOur excel \"template\" for the DB</p>\n\n<pre><code>RUT          DV\n----------------\n01234567     8  ' DISPLAY ALERT AS SOON AS DV IS ADDED?\n</code></pre>\n\n<p>My code validating one cell:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Columns(\"C\")) Is Nothing Then\n    On Error Resume Next\n\n    rute = Target.Value\n    arut = UCase(Target.Value)\n\n    Rut = Replace(\"0000\" &amp; Rut, \".\", \"\", 1)\n    If InStr(1, Rut, \"-\") &gt; 0 Then Rut = Left(rute, InStr(1, rute, \"-\") - 1)\n    Rut = Right(rute, 8)\n    suma = 0\n    For i = 1 To 8\n    suma = suma + Val(Mid(rute, i, 1)) * Val(Mid(\"32765432\", i, 1))\n    Next i\n    dv = 11 - (suma Mod 11)\n    If dv = 10 Then dv = \"K\"\n    If dv = 11 Then dv = 0\n\n    'If Right(arut, 1) = CStr(dv) Then MsgBox (\"Rut \" &amp; rute &amp; \" Correcto\")\n    If Right(arut, 1) &lt;&gt; CStr(dv) Then MsgBox (\"Rut: \" &amp; rute &amp; \" Incorrecto.\")\n    If rute = \"\" Then MsgBox (\"Campo(s) modificado(s).\")\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Any hints on what should I do or other approach it's appreciated.</p>\n\n<p>NOTE: In cell formula isn't possible due to requirements.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11150663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94edb84ca88c2a05368f8cf3799275ce?s=128&d=identicon&r=PG&f=1", "display_name": "F.Ymn", "link": "https://stackoverflow.com/users/11150663/f-ymn"}, "edited": false, "score": 0, "creation_date": 1552508846, "post_id": 55149888, "comment_id": 97041645, "body": "Hi Tim!  Thanks for your reply :)"}, {"owner": {"reputation": 13, "user_id": 11150663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94edb84ca88c2a05368f8cf3799275ce?s=128&d=identicon&r=PG&f=1", "display_name": "F.Ymn", "link": "https://stackoverflow.com/users/11150663/f-ymn"}, "edited": false, "score": 0, "creation_date": 1552509126, "post_id": 55149888, "comment_id": 97041778, "body": "I want what I type in to be left and the rest to be deleted. So if for example if I write: Object and Color then the table should look like the picture I have sent.  ie everything else should be deleted, so what remains is Bara Object, and Color. ie door1, door2 .... and Yellow, green ....  So instead of marking what I write with the color red, it should - Delete all other information"}, {"owner": {"reputation": 13, "user_id": 11150663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94edb84ca88c2a05368f8cf3799275ce?s=128&d=identicon&r=PG&f=1", "display_name": "F.Ymn", "link": "https://stackoverflow.com/users/11150663/f-ymn"}, "edited": false, "score": 0, "creation_date": 1552557259, "post_id": 55149888, "comment_id": 97058075, "body": "please i need help with another thing:  My code looks at the forgotten seen now:"}, {"owner": {"reputation": 13, "user_id": 11150663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94edb84ca88c2a05368f8cf3799275ce?s=128&d=identicon&r=PG&f=1", "display_name": "F.Ymn", "link": "https://stackoverflow.com/users/11150663/f-ymn"}, "edited": false, "score": 0, "creation_date": 1552557275, "post_id": 55149888, "comment_id": 97058083, "body": "Sub test()   aaa = InputBox(&quot;Which object information do you want to display:&quot;)    Dim myrange As Range Set myrange = ThisWorkbook.Worksheets(&quot;Tabell&quot;).UsedRange   For Each cell In myrange.Cells   If Not (cell.Value Like aaa &amp; &quot;*&quot;) Then     cell.Value = &quot;&quot; End If    Next   End Sub"}, {"owner": {"reputation": 13, "user_id": 11150663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94edb84ca88c2a05368f8cf3799275ce?s=128&d=identicon&r=PG&f=1", "display_name": "F.Ymn", "link": "https://stackoverflow.com/users/11150663/f-ymn"}, "edited": false, "score": 0, "creation_date": 1552557289, "post_id": 55149888, "comment_id": 97058091, "body": "But the problem with it is that you can write in once what it should keep. That is, the user can only enter once and then it will delete everything except what it writes. But I want the user to be able to type in several times before removing everything else. That is, I want the user to write, for example: Objects, Traps AND SEN if it writes the word END then the program should end up asking him, If he wants to write several things.  So I want the user to be able to write several things and then when he is finished writing END and then it stops asking him."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1552580157, "last_edit_date": 1552580157, "creation_date": 1552505441, "answer_id": 55149888, "question_id": 55149850, "link": "https://stackoverflow.com/questions/55149850/highlight-a-cell-if-there-is-a-specific-word-in-the-cells-text/55149888#55149888", "title": "Highlight a cell if there is a specific word in the cell&#39;s text", "body": "<p>You can use <code>Like</code>.</p>\n\n<p><strong>edit</strong> - updated to allow for multiple terms to be entered (untested)</p>\n\n<pre><code>dim terms as new collection, term, deleteMe as boolean\n\ndo\n    term = Trim(InputBox(\"Enter value (leave blank to end entry)\"))\n    if len(term)&gt;0 then\n        terms.add term\n    else\n        exit do\n    end if\nloop\n\nif terms.count=0 then exit sub '&lt;&lt; no terms to check for\n\nFor Each cell In myrange.Cells\n\n    deleteMe = true\n\n    for each term in terms\n        if not cell.value like term &amp; \"*\" then\n            deleteMe = false \n            exit for\n        end if\n    next term\n\n    if deleteMe then cell.value = \"\"\nnext cell\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11150663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94edb84ca88c2a05368f8cf3799275ce?s=128&d=identicon&r=PG&f=1", "display_name": "F.Ymn", "link": "https://stackoverflow.com/users/11150663/f-ymn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559693249, "creation_date": 1552505275, "last_edit_date": 1559693249, "question_id": 55149850, "link": "https://stackoverflow.com/questions/55149850/highlight-a-cell-if-there-is-a-specific-word-in-the-cells-text", "title": "Highlight a cell if there is a specific word in the cell&#39;s text", "body": "<p>I want to red highlight all cells that contain the word \"Color\" and \"Width\".</p>\n\n<p>With the code I have, I enter the cell's value. I want to enter the word \"Color\" and \"Width\".</p>\n\n<pre><code>Sub test()    \n\naaa = InputBox(\"Enter value 1:\")\nbbb = InputBox(\"Enter value 2:\")\n\nDim myrange As Range\nSet myrange = ThisWorkbook.Worksheets(\"Tabell\").UsedRange\n\nFor Each cell In myrange.Cells\n\n    If cell.Value = aaa Or cell.Value = bbb Then\n        cell.Interior.Color = 255\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/JhrHV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JhrHV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "object", "parameters"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11199098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6617fc0512ea2e4f6f3ca67a01d94d4b?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Babakian", "link": "https://stackoverflow.com/users/11199098/glenn-babakian"}, "edited": false, "score": 0, "creation_date": 1552598505, "post_id": 55149892, "comment_id": 97083638, "body": "Thanks user11198948 and Ricardo A. A dot makes all the difference!"}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1552505881, "last_edit_date": 1552505881, "creation_date": 1552505456, "answer_id": 55149892, "question_id": 55149819, "link": "https://stackoverflow.com/questions/55149819/excel-vba-problem-passing-workbook-worksheet-objects-to-subroutines/55149892#55149892", "title": "Excel VBA: problem passing workbook, worksheet objects to subroutines", "body": "<p>This is because inside your <code>With</code> Segment, you are not using a dot (.) to specify the change in that wb/ws.</p>\n\n<p>Inside any <code>With</code> segments, using a dot, ties the \"command\" to the <code>With</code> Segment. Ej:</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Sheet5\")\n    Range(\"A5\").Value = \"String Test\" 'This changes the Cell A5 of the ActiveSheet\n    .Range(\"A5\").Value = \"Test 2\" 'This Changes the Value of Sheet5, part of the With Segment\nEnd With\n</code></pre>\n\n<p>Just add the Dots/Periods</p>\n\n<pre><code>Sub AddXactSheetHeaders(ByVal wb, ByVal ws)\n    With wb\n        With ws\n            .Range(\"A1\").Value = \"TradeDate\"\n            .Range(\"B1\").Value = \"SettleDate\"\n            .Range(\"C1\").Value = \"Tran ID\"\n            .Range(\"D1\").Value = \"Tranx Type\"\n            .Range(\"E1\").Value = \"Security Type\"\n            .Range(\"F1\").Value = \"Security ID\"\n            .Range(\"G1\").Value = \"SymbolDescription\"\n            .Range(\"H1\").Value = \"Local Amount\"\n            .Range(\"I1\").Value = \"Book Amount\"\n            .Range(\"J1\").Value = \"MOIC Label\"\n            .Range(\"K1\").Value = \"Quantity\"\n            .Range(\"L1\").Value = \"Price\"\n            .Range(\"M1\").Value = \"CurrencyCode\"\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11198948"}, "is_accepted": true, "score": 1, "last_activity_date": 1552505917, "creation_date": 1552505917, "answer_id": 55150007, "question_id": 55149819, "link": "https://stackoverflow.com/questions/55149819/excel-vba-problem-passing-workbook-worksheet-objects-to-subroutines/55150007#55150007", "title": "Excel VBA: problem passing workbook, worksheet objects to subroutines", "body": "<p>Use <em>ByRef</em> to pass the workbook/worksheet objects by pointer instead of copying them then use them as parent references in the helper sub. To reference a Range inside a With ... End With, use a prefix period.</p>\n\n<pre><code>Sub AddXactSheetHeaders(Byref wb as workbook, ByRef ws as worksheet)\n\n  With wb\n   With ws\n     .Range(\"A1\").Value = \"TradeDate\"\n     .Range(\"B1\").Value = \"SettleDate\"\n     .Range(\"C1\").Value = \"Tran ID\"\n     .Range(\"D1\").Value = \"Tranx Type\"\n     .Range(\"E1\").Value = \"Security Type\"\n     .Range(\"F1\").Value = \"Security ID\"\n     .Range(\"G1\").Value = \"SymbolDescription\"\n     .Range(\"H1\").Value = \"Local Amount\"\n     .Range(\"I1\").Value = \"Book Amount\"\n     .Range(\"J1\").Value = \"MOIC Label\"\n     .Range(\"K1\").Value = \"Quantity\"\n     .Range(\"L1\").Value = \"Price\"\n     .Range(\"M1\").Value = \"CurrencyCode\"\n   End With\n  End With \n\nEnd Sub\n</code></pre>\n\n<p>In fact, the <em>wb</em> reference is completely unnecessary and syntactically wrong. The <em>ws</em> worksheet knows what its parent workbook is.</p>\n\n<pre><code>Sub AddXactSheetHeaders(ByRef ws as worksheet)\n\n  With ws\n     .Range(\"A1\").Value = \"TradeDate\"\n     .Range(\"B1\").Value = \"SettleDate\"\n     .Range(\"C1\").Value = \"Tran ID\"\n     .Range(\"D1\").Value = \"Tranx Type\"\n     .Range(\"E1\").Value = \"Security Type\"\n     .Range(\"F1\").Value = \"Security ID\"\n     .Range(\"G1\").Value = \"SymbolDescription\"\n     .Range(\"H1\").Value = \"Local Amount\"\n     .Range(\"I1\").Value = \"Book Amount\"\n     .Range(\"J1\").Value = \"MOIC Label\"\n     .Range(\"K1\").Value = \"Quantity\"\n     .Range(\"L1\").Value = \"Price\"\n     .Range(\"M1\").Value = \"CurrencyCode\"\n  End With \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11199098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6617fc0512ea2e4f6f3ca67a01d94d4b?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Babakian", "link": "https://stackoverflow.com/users/11199098/glenn-babakian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1668, "favorite_count": 0, "accepted_answer_id": 55150007, "answer_count": 2, "score": 0, "last_activity_date": 1552505917, "creation_date": 1552505163, "last_edit_date": 1552505641, "question_id": 55149819, "link": "https://stackoverflow.com/questions/55149819/excel-vba-problem-passing-workbook-worksheet-objects-to-subroutines", "title": "Excel VBA: problem passing workbook, worksheet objects to subroutines", "body": "<p>I have a main routine that creates a new Workbook and dynamically associates new sheets with it (based on the data in a separate input workbook/sheet).</p>\n\n<p>Excerpting the main routine:</p>\n\n<pre><code>Sub MainRoutine()\n    Dim NmOutBook As String\n    NmOutBook = \"Client1Output_\" &amp; Format(CStr(Now), \"yyyy_mm_dd_hh_mm\")\n\n    Dim PosSourceBk, TrnSourceBk, OutputBk As Workbook\n    Set PosSourceBk = Workbooks.Open(\"U:\\Documents\\Implementations\\Client1\\Client1Positions.xlsx\")\n    Set TrnSourceBk = Workbooks.Open(\"U:\\Documents\\Implementations\\Client1\\TradeHistory_0301.xlsx\")\n    Dim TrnSrcSht, TrnOutSht, PriorTrnOutSht, PosOutSht As Worksheet\n    Set TrnSrcSht = TrnSourceBk.ActiveSheet\n\n    'Create workbook to store output sheets\n    Set OutputBk = Workbooks.Add\n</code></pre>\n\n<p>...</p>\n\n<pre><code>If (SecNm &lt;&gt; PriorSecNm) Then\n    Set TrnOutSht = OutputBk.Sheets.Add(after:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n    TrnOutShtName = CStr(SecNm) + \"_b\"\n    TrnOutSht.Name = TrnOutShtName\n    AddXactSheetHeaders OutputBk, TrnOutSht\n</code></pre>\n\n<p>I'm passing my output workbook object and the corresponding worksheet object to the subroutine AddXactSheetHeaders, which looks like this:</p>\n\n<pre><code>Sub AddXactSheetHeaders(ByVal wb, ByVal ws)\n    With wb\n        With ws\n            Range(\"A1\").Value = \"TradeDate\"\n            Range(\"B1\").Value = \"SettleDate\"\n            Range(\"C1\").Value = \"Tran ID\"\n            Range(\"D1\").Value = \"Tranx Type\"\n            Range(\"E1\").Value = \"Security Type\"\n            Range(\"F1\").Value = \"Security ID\"\n            Range(\"G1\").Value = \"SymbolDescription\"\n            Range(\"H1\").Value = \"Local Amount\"\n            Range(\"I1\").Value = \"Book Amount\"\n            Range(\"J1\").Value = \"MOIC Label\"\n            Range(\"K1\").Value = \"Quantity\"\n            Range(\"L1\").Value = \"Price\"\n            Range(\"M1\").Value = \"CurrencyCode\"\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>The result of this is that cells A1:M1 are updated, but in the wrong workbook / worksheet.</p>\n\n<p>I've tried passing the object references by reference; when I do this a different (but still wrong) workbook / worksheet is updated.</p>\n\n<p>I must be missing something obvious, but have no idea what it might be.</p>\n\n<p>Any assistance appreciated. Thanks.</p>\n"}, {"tags": ["excel", "vba", "vlookup", "worksheet-function"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9990923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9182b7600f00c009a2aef7ae6d6baf8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9990923/mike"}, "edited": false, "score": 0, "creation_date": 1552503411, "post_id": 55149192, "comment_id": 97039105, "body": "Hi Thanks! Here is the code: I get an error &quot;Unable to Get the index Property of the Worksheet function class&quot;  The data is located to the left column &quot;B&quot; (or 2) and the serial #&#39;s are located in column &quot;H&quot; (or 8).  Can you tell me what i&#39;m doing wrong? I&#39;ve been working on this for two days.@Mistella"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 39, "user_id": 9990923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9182b7600f00c009a2aef7ae6d6baf8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9990923/mike"}, "edited": false, "score": 0, "creation_date": 1552507713, "post_id": 55149192, "comment_id": 97041115, "body": "If the serial numbers are in Excel as numbers, not text (to input as text, they would have a <code>&#39;</code> in front), then you need to get rid of the quotation marks around the number in the <code>.Match</code> section. If that&#39;s not it, which version of the answer are you trying to use?"}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": false, "score": 0, "last_activity_date": 1552502606, "creation_date": 1552502606, "answer_id": 55149192, "question_id": 55148940, "link": "https://stackoverflow.com/questions/55148940/finding-a-value-to-the-left-reverse-vlookup-using-index-and-match-vba/55149192#55149192", "title": "Finding a value to the left Reverse Vlookup using INDEX and MATCH VBA", "body": "<p>I would use an Index-Match combination. Something like this should work:</p>\n\n<pre><code>Sal = Application.WorksheetFunction.INDEX(Sheets(PreviousTabName).Range(ThisRAnge),Application.WorksheetFunction.MATCH(\"3491709101\",Application.WorksheetFunction.INDEX(Sheets(PreviousTabName).Range(ThisRAnge),0,3),0),1)\n</code></pre>\n\n<p>Alternatively, assuming column 1's reference is stored in variable <code>1stColumn</code>, and column 3 in <code>3rdColumn</code> then the code should be:</p>\n\n<pre><code>Sal = Application.WorksheetFunction.INDEX(1stColumn,Application.WorksheetFunction.MATCH(\"3491709101\",3rdColumn,0))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9990923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9182b7600f00c009a2aef7ae6d6baf8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9990923/mike"}, "edited": false, "score": 0, "creation_date": 1552509733, "post_id": 55149751, "comment_id": 97042034, "body": "This is Great! That&#39;s what I needed. I was just trying to get the row. Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11198948"}, "is_accepted": false, "score": 0, "last_activity_date": 1552504924, "creation_date": 1552504924, "answer_id": 55149751, "question_id": 55148940, "link": "https://stackoverflow.com/questions/55148940/finding-a-value-to-the-left-reverse-vlookup-using-index-and-match-vba/55149751#55149751", "title": "Finding a value to the left Reverse Vlookup using INDEX and MATCH VBA", "body": "<blockquote>\n  <p>I would like to seach <em>[sic]</em> for a serial # on the right, say column 3, and get a value on column 1.</p>\n</blockquote>\n\n<p>Use Application.Match to retrieve the row number. Using Application.Index is sort of overkill since Cells will do just as well.</p>\n\n<pre><code>dim n as variant, val as variant\n\nn = application.match(\"3491709101\", Sheets(PreviousTabName).Range(\"C:C\"), 0)\n\nif not iserror(n) then\n    val = Sheets(PreviousTabName).Cells(n, \"A\").Value\n    debug.print val\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1552505243, "creation_date": 1552505243, "answer_id": 55149841, "question_id": 55148940, "link": "https://stackoverflow.com/questions/55148940/finding-a-value-to-the-left-reverse-vlookup-using-index-and-match-vba/55149841#55149841", "title": "Finding a value to the left Reverse Vlookup using INDEX and MATCH VBA", "body": "<p>I would replace the <code>VLOOKUP</code> with <code>Application.Match</code>, but you need to add an error handler scenario, just in case the <code>Application.Match</code> will fail.</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub UseMatch()\n\nDim PreviousTabName As String\nDim SourceSht As Worksheet\nDim ThisRange As Range\nDim LastRow As Long, MatchRow As Variant\nDim Val\n\n' set the worksheet object where you have the data you are trying to match it with\nSet SourceSht = ThisWorkbook.Sheets(\"Sheet2\") ' &lt;-- modify \"Sheet2\" to your sheet's name\n\n' set the range where you want to search for a Match\nWith SourceSht\n    LastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row ' find last row in column \"C\" , you can change to the column you need\n\n    ' set dynamic Range\n    Set ThisRange = .Range(.Cells(1, \"C\"), .Cells(LastRow, \"C\")) ' change the column to where your data you are trying to compare lies\nEnd With\n\nIf Not IsError(Application.Match(\"3491709101\", ThisRange, 0)) Then\n    MatchRow = Application.Match(\"3491709101\", ThisRange, 0) ' row of match found\n    Val = SourceSht.Range(\"A\" &amp; MatchRow) ' getting the value 2 columns to the left of column \"C\"\n    MsgBox Val\nElse\n    ' Match error, raise a msgbox\n    MsgBox \"Unable finding 3491709101 in range \" &amp; ThisRange.Address(0, 0, xlA1), vbCritical, \"Error\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Note</strong>: when dealing with Numeric values, you need to make sure they are formatted the same in both places.</p>\n\n<p>For instance, you are looking for <code>\"3491709101\"</code> which is a numeric value converted to String, so if the source data in <code>ThisRange</code> is not set-up the same (as String) match will fail.</p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1552508910, "post_id": 55150538, "comment_id": 97041671, "body": "<code>Range(ThisRange)</code> when <code>ThisRange As Range</code> ? a <code>Range</code> inside a <code>Range</code> , not a String, or directly use a <code>ThisRange</code> ?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1552509519, "post_id": 55150538, "comment_id": 97041942, "body": "@ShaiRado Looking at his Vlookup code, I understood them to be sheet and range variables, I was just using his variables.I normally use the proper worksheet and range in code unless they will be used multiple times within a large macro."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1552508281, "creation_date": 1552508281, "answer_id": 55150538, "question_id": 55148940, "link": "https://stackoverflow.com/questions/55148940/finding-a-value-to-the-left-reverse-vlookup-using-index-and-match-vba/55150538#55150538", "title": "Finding a value to the left Reverse Vlookup using INDEX and MATCH VBA", "body": "<p>Looking at your comment to @Mistella, I don't think that you need <code>Vlookup</code> or <code>Match</code>. My understanding is that you want to find the serial number <code>\"3491709101\"</code> in Column 8 and set the value from <code>Columns(2)</code> to the Variable <code>Sal</code>. If I'm right, then a simple Find is what you need.</p>\n\n<pre><code>Dim rng As Range, findVal As Variant, Sal As Variant\nDim PreviousTabname As Worksheet, ThisRange As Range\n\nSet rng = Sheets(PreviousTabname).Range(ThisRange)\n\n    Set findVal = rng.Find(What:=\"3491709101\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n        If findVal Is Nothing Then\n            Exit Sub\n        Else: Sal = findVal.Offset(, -6).Value\n\n        End If\n    MsgBox Sal   \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1559133999, "creation_date": 1559133999, "answer_id": 56361019, "question_id": 55148940, "link": "https://stackoverflow.com/questions/55148940/finding-a-value-to-the-left-reverse-vlookup-using-index-and-match-vba/56361019#56361019", "title": "Finding a value to the left Reverse Vlookup using INDEX and MATCH VBA", "body": "<p><strong>Index-Match syntax VBA</strong></p>\n\n<pre><code>Dim ReturnValueRange as range, LookupRange as range\n\nSet ReturnValueRange = Thisworkbook.Sheets(\"Sheet1\").range(\"$E$1:$E$7\")\nSet LookupRange = Thisworkbook.Sheets(\"Sheet1\").range(\"$G$1:$G$7\")\n\nLookUpValue = \"findMe\"\n\nResult = Application.WorksheetFunction.INDEX(ReturnValueRange,Application.WorksheetFunction.MATCH(LookUpValue, LookupRange, 0))\n</code></pre>\n\n<p><strong>Index-Match syntax FORMULA</strong></p>\n\n<pre><code>=INDEX(ReturnValueRange,MATCH(LookUpValue, LookupRange, 0))\n</code></pre>\n\n<p><strong>LEFT VLOOKUP Syntax VBA</strong></p>\n\n<ul>\n<li>Return Error in not match</li>\n</ul>\n\n<p><code>Result = WorksheetFunction.VLOOKUP(LookUpValue, WorksheetFunction.CHOOSE(Array(1,2), LookupRange, ReturnValueRange), 2, 0))</code></p>\n\n<p><strong>LEFT VLOOKUP Syntax FORMULA</strong></p>\n\n<pre><code>=VLOOKUP(LookUpValue, WorksheetFunction.CHOOSE({1,2}, LookupRange, ReturnValueRange), 2, 0))\n</code></pre>\n\n<ul>\n<li>the \u201cCHOOSE\u201d function is manipulating the two fields.</li>\n<li>You\u2019re assigning reference \u201cindex\u201d numbers to ranges of data \u2013\nassigning the LookupRange to index number 1 and the ReturnValueRange to index number 2</li>\n<li>So, when you type \u201c2\u201d in the VLookup function, you\u2019re actually\nreferring to Index number 2 in the CHOOSE function.</li>\n</ul>\n"}], "owner": {"reputation": 39, "user_id": 9990923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9182b7600f00c009a2aef7ae6d6baf8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9990923/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1466, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1559133999, "creation_date": 1552501719, "last_edit_date": 1552547187, "question_id": 55148940, "link": "https://stackoverflow.com/questions/55148940/finding-a-value-to-the-left-reverse-vlookup-using-index-and-match-vba", "title": "Finding a value to the left Reverse Vlookup using INDEX and MATCH VBA", "body": "<p>I've seen many forum saying that it is possible to find data to the left column, as opposed to <code>Vlookup</code> function. </p>\n\n<p>I have a sheet of which I would like to get the value from the left. In other words, I would like to seach for a serial # on the right, say column 3, and get a value on column 1. </p>\n\n<p>What would an alternative to <code>Vlookup</code> in VBA? (i.e., reverse vlookup)</p>\n\n<p>I seen several forums with examples using index match, but I cannot understand the syntax. Can someone please provide me with a simple example? </p>\n\n<p>Here is what I was using before and found out that Vlookup cannot search to the left: </p>\n\n<pre><code>Sal = Application.WorksheetFunction.VLookup(\"3491709101\",Sheets(PreviousTabName).Range(ThisRAnge), 2, False)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11198700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bbea14510029b8467e7b2c0787437e?s=128&d=identicon&r=PG&f=1", "display_name": "SO_2", "link": "https://stackoverflow.com/users/11198700/so-2"}, "edited": false, "score": 0, "creation_date": 1552501518, "post_id": 55148610, "comment_id": 97038073, "body": "This ends up being the same functionality, same bug with values not present in book1 are removed when executed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11198948"}, "reply_to_user": {"reputation": 3, "user_id": 11198700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bbea14510029b8467e7b2c0787437e?s=128&d=identicon&r=PG&f=1", "display_name": "SO_2", "link": "https://stackoverflow.com/users/11198700/so-2"}, "edited": false, "score": 0, "creation_date": 1552501706, "post_id": 55148610, "comment_id": 97038196, "body": "If vlookup doesn&#39;t find a match it returns #N/A. A variant can catch an #N/A and IsError is true when val is #N/A. How could it possibly do what you are describing? Perhaps you should post the actual code as I had to modify your vlookup in order to make it work. You cannot vlookup Range(&quot;a23:a100&quot;) all at once, you have to make a lookup for each cell in Range(&quot;a23:a100&quot;)."}, {"owner": {"reputation": 3, "user_id": 11198700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bbea14510029b8467e7b2c0787437e?s=128&d=identicon&r=PG&f=1", "display_name": "SO_2", "link": "https://stackoverflow.com/users/11198700/so-2"}, "edited": false, "score": 0, "creation_date": 1552502032, "post_id": 55148610, "comment_id": 97038367, "body": "the posted code works on my end... what did you have to modify to make it work on your end?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11198948"}, "reply_to_user": {"reputation": 3, "user_id": 11198700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bbea14510029b8467e7b2c0787437e?s=128&d=identicon&r=PG&f=1", "display_name": "SO_2", "link": "https://stackoverflow.com/users/11198700/so-2"}, "edited": false, "score": 1, "creation_date": 1552502225, "post_id": 55148610, "comment_id": 97038481, "body": "vlookup is meant to take a single value as its first argument. You&#39;ve shoving 78 values (Range(&quot;a23:a100&quot;)) into the first argument so you are implicitly using Range(&quot;a23&quot;)."}, {"owner": {"reputation": 3, "user_id": 11198700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bbea14510029b8467e7b2c0787437e?s=128&d=identicon&r=PG&f=1", "display_name": "SO_2", "link": "https://stackoverflow.com/users/11198700/so-2"}, "edited": false, "score": 0, "creation_date": 1552502738, "post_id": 55148610, "comment_id": 97038750, "body": "I made a huge mistake in explaining this bug... swap book1 and book2 meanings. I am using book2 as my source that I want to update from - does this make sense? sorry for the confusion... edits to original question were made"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11198948"}, "is_accepted": false, "score": 0, "last_activity_date": 1552500480, "creation_date": 1552500480, "answer_id": 55148610, "question_id": 55148297, "link": "https://stackoverflow.com/questions/55148297/how-to-prevent-data-loss-using-application-vlookup/55148610#55148610", "title": "How to prevent data loss using Application.VLookup?", "body": "<p>Test the return value and only update if there is something to return.</p>\n\n<pre><code>Dim val as Variant\n\nSet lookFor = book1.Sheets(1).Range(\"a23:a100\")\nSet srchRange = book2.Sheets(1).Range(\"b:f\")\n\nval = Application.VLookup(lookFor.Cells(1), srchRange, 2, False)\n\nIf Not IsError(val) Then\n    lookFor.Offset(0, 7).Value = val\nEnd If\n</code></pre>\n\n<p>You can test the return to a variant with Application.VLookup or Application.Match. It has to be returned to a variant and it doesn't work with WorksheetFunction.VLookup or WorksheetFunction.Match.</p>\n"}], "owner": {"reputation": 3, "user_id": 11198700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bbea14510029b8467e7b2c0787437e?s=128&d=identicon&r=PG&f=1", "display_name": "SO_2", "link": "https://stackoverflow.com/users/11198700/so-2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552547180, "creation_date": 1552499339, "last_edit_date": 1552547180, "question_id": 55148297, "link": "https://stackoverflow.com/questions/55148297/how-to-prevent-data-loss-using-application-vlookup", "title": "How to prevent data loss using Application.VLookup?", "body": "<p>The following macro utilizes the VLookup function between two workbooks. Both workbooks contain tables. The intent is for <strong>book1</strong> to update values from <strong>book2</strong></p>\n\n<p>The data loss (cells that have values in <strong>book1</strong>, column 7 gets removed) occurs whenever the lookup value is not present in <strong>book2</strong>. Which leads to my question: how to prevent this deletion from occurring? </p>\n\n<pre><code>Sub Update()\nDim lookFor As Range\nDim srchRange As Range\n\nDim book1 As Workbook\nDim book2 As Workbook\n\nDim book2Name As String\nbook2Name = \"table2.xlsm\"\n\nDim book2NamePath As String\nbook2NamePath = ThisWorkbook.Path &amp; \"\\\" &amp; book2Name\n\nSet book1 = ThisWorkbook\n\nIf IsOpen(book2Name) = False Then Workbooks.Open (book2NamePath)\nSet book2 = Workbooks(book2Name)\n\nSet lookFor = book1.Sheets(1).Range(\"a23:a100\")\nSet srchRange = book2.Sheets(1).Range(\"b:f\")\n\nlookFor.Offset(0, 7).Value = Application.VLookup(lookFor, srchRange, 2, False)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "richtextbox"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1552501448, "creation_date": 1552501448, "answer_id": 55148876, "question_id": 55148173, "link": "https://stackoverflow.com/questions/55148173/using-microsofts-text-object-model-in-access/55148876#55148876", "title": "Using Microsoft&#39;s Text Object Model in Access", "body": "<p>I can't help you with TOM, and I'm not sure the RTF editor can handle strikethrough at all - at least the number of questions regarding this implies so. Instead, I offer a workaround:</p>\n\n<pre><code>Private Sub btnStrikethrough_Click()\n    Me.Field1.Value = StrikeThrough(Me.Field1.Value)\nEnd Sub\n\nFunction StrikeThrough(Text As String) As String\n    For i = 1 To Len(Text)\n        StrikeThrough = StrikeThrough &amp; ChrW(822) &amp; Mid(Text, i, 1)\n    Next i\nEnd Function\n</code></pre>\n\n<p>This is perhaps too blunt for your need, but it will strike through your text. It does so by inserting U+0336 (COMBINING LONG STROKE OVERLAY) before every character, making the combined result visible. If you have other formatting, it will destroy it, but I think that can be handled with some parsing.</p>\n"}], "owner": {"reputation": 11, "user_id": 6905975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WhNkq.jpg?s=128&g=1", "display_name": "John T.", "link": "https://stackoverflow.com/users/6905975/john-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552501448, "creation_date": 1552498874, "question_id": 55148173, "link": "https://stackoverflow.com/questions/55148173/using-microsofts-text-object-model-in-access", "title": "Using Microsoft&#39;s Text Object Model in Access", "body": "<p>In one of my Access applications, I want the user to be able to Strike Through words in textboxes. The textboxes have Rich Text enabled now, where one can Bold, Underline, change color, etc, but Strike Through is unavailable. </p>\n\n<p>I was thinking that the Text Object Model is the way to go, but cannot find examples of it, with code written in vba, used anywhere. </p>\n\n<p>I have referenced the Text Object Model (tom) in my app. But then, I am unable to set an object reference, say, to a sentence that has been selected with the mouse. </p>\n\n<p>Is there anyone out there that knows or can show me: </p>\n\n<ol>\n<li><p>Do textboxes, either \"regular\" or ActiveX, have hooks in them that allow access to them using the tom? </p></li>\n<li><p>If textboxes in Access do not have this capability, are there other ways I can get Strike Through functionality in the entries?</p></li>\n<li><p>Where are there vba examples that can help me with this?</p></li>\n</ol>\n\n<p>Thanks so much for your input\nv/r,\nJohnny</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1552500094, "post_id": 55148118, "comment_id": 97037339, "body": "You&#39;ll want to iterate the cells that have the values you want to bring into your form, then find the control with the <code>Name</code> matching <code>Cells(y, 1)</code> and assign it the value you find in <code>Cells(y, 2)</code>. You can find the control you want with <code>begin.Controls(controlName)</code>. Make sure you never store any state in, and never call <code>.Show</code> against the form&#39;s <i>default instance</i> (<a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">this article</a> has all the info)."}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 8908722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fff738e9a9628a7bffef7b3e3f3f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Con", "link": "https://stackoverflow.com/users/8908722/con"}, "is_accepted": false, "score": 0, "last_activity_date": 1552510285, "creation_date": 1552510285, "answer_id": 55151007, "question_id": 55148118, "link": "https://stackoverflow.com/questions/55148118/fill-a-userform-with-saved-data/55151007#55151007", "title": "Fill a userform with saved data", "body": "<p>Thanks Mathieu, you put me in the right direction and I try\nto compare, when it is true then I can fill de value (I think);</p>\n\n<pre><code>Private Sub tmp10_Click()\ny = 1\nDim cCtl As Control\nFor Each cCtl In begin.Controls\n    For x = 1 To 67\n    If cCtl.Name = Cells(x, 1) Then Cells(x, 4) = \"true\"\n    Next\ny = y + 1\nNext\nEnd Sub\n</code></pre>\n\n<p>And so, I think, I can handle the rest.</p>\n"}], "owner": {"reputation": 5, "user_id": 8908722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fff738e9a9628a7bffef7b3e3f3f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Con", "link": "https://stackoverflow.com/users/8908722/con"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556949917, "creation_date": 1552498700, "last_edit_date": 1556949917, "question_id": 55148118, "link": "https://stackoverflow.com/questions/55148118/fill-a-userform-with-saved-data", "title": "Fill a userform with saved data", "body": "<p>A user fills a userform and I save the contents into a sheet.</p>\n\n<p>I want, after opening the sheet, to populate the form with the saved data.</p>\n\n<p>I write the data with;</p>\n\n<pre><code>For Each cCtl In begin.Controls\n    If TypeOf cCtl Is MSForms.CheckBox Then\n        Cells(y, 1) = cCtl.Name\n        Cells(y, 2) = cCtl.Value\n        y = y + 1\n    End If\n\n    If TypeOf cCtl Is MSForms.TextBox Then\n        Cells(y, 1) = cCtl.Name\n        Cells(y, 2) = cCtl.Value\n        y = y + 1\n    End If\n</code></pre>\n\n<p>This works and (some of) the results are:</p>\n\n<ul>\n<li>cbklant Agentschap Telecom,</li>\n<li>labelklant Omschrijving,</li>\n<li>cbcalc Con van Doornik,</li>\n<li>cbkans 50%</li>\n</ul>\n\n<p>in cell A1 to B4 etc.</p>\n\n<p>(cb = comboboxname)<br>\n(label = Labelcaption)</p>\n\n<p>How do I populate the form from this <code>Range</code> by opening the file?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1552500182, "post_id": 55147729, "comment_id": 97037384, "body": "Are you sure you want to remove duplicates from each row independently? If so, you have plenty of solutions! Or do the combinations of these columns create your actual duplicates to be removed?"}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1552497625, "creation_date": 1552497625, "answer_id": 55147815, "question_id": 55147729, "link": "https://stackoverflow.com/questions/55147729/excel-macro-loop-removing-duplicates-per-column/55147815#55147815", "title": "Excel Macro Loop - removing duplicates per column", "body": "<p>You need a loop!</p>\n\n<pre><code>Sub RemoveDuplicates()\n    Dim TargetSheet As Worksheet\n    Set TargetSheet = ActiveWorkbook.Worksheets(\"Result\")\n    For i = 1 To 100\n        TargetSheet.Cells(1, i).EntireColumn.RemoveDuplicates Columns:=1, Header:=xlNo\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1552497757, "creation_date": 1552497757, "answer_id": 55147849, "question_id": 55147729, "link": "https://stackoverflow.com/questions/55147729/excel-macro-loop-removing-duplicates-per-column/55147849#55147849", "title": "Excel Macro Loop - removing duplicates per column", "body": "<p>This will perform a column-by-column duplicate removal:</p>\n\n<pre><code>Sub Kleanup()\n    For i = 1 To Columns.Count\n        Columns(i).Cells.RemoveDuplicates Columns:=1, Header:=xlNo\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 263, "user_id": 11185317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92bc2e67c92e584bbf3c3c50fa9397fd?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler N", "link": "https://stackoverflow.com/users/11185317/tyler-n"}, "is_accepted": true, "score": 1, "last_activity_date": 1552498740, "creation_date": 1552498740, "answer_id": 55148131, "question_id": 55147729, "link": "https://stackoverflow.com/questions/55147729/excel-macro-loop-removing-duplicates-per-column/55148131#55148131", "title": "Excel Macro Loop - removing duplicates per column", "body": "<p>This will work if you only care about duplicates per column.</p>\n\n<pre><code>Sub RemoveDuplicates()\n    'Stop the screen from updating to reduce lag\n    Application.ScreenUpdating = False\n\n    'Main loop\n    For i = 1 To 100\n        ActiveWorkbook.Sheets(\"Result\").Columns(i).RemoveDuplicates Columns:=1, Header:=xlNo\n    Next\n\n    'Reset ScreenUpdating\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8482055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409bbd04e140b07f79efc7921d932581?s=128&d=identicon&r=PG&f=1", "display_name": "Panos", "link": "https://stackoverflow.com/users/8482055/panos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 1, "accepted_answer_id": 55148131, "answer_count": 3, "score": 1, "last_activity_date": 1552499078, "creation_date": 1552497305, "last_edit_date": 1552499078, "question_id": 55147729, "link": "https://stackoverflow.com/questions/55147729/excel-macro-loop-removing-duplicates-per-column", "title": "Excel Macro Loop - removing duplicates per column", "body": "<p>I am new to excel macros and would like to create loop that identified a column range and hopefully a row range to remove duplicates. Currently I have taken the long way around that created an excel formula to create the macro script for the below.</p>\n\n<p>Any help with the below would be much appreciated cause I am now at 60 columns and need to add another 40...</p>\n\n<p>Thank you</p>\n\n<pre><code>Sheets(\"Result\").Select\nColumns(\"A:A\").Select\nActiveSheet.Range(\"$A$1:$A$100000\").RemoveDuplicates Columns:=1, Header:=xlNo\nColumns(\"B:B\").Select\nActiveSheet.Range(\"$B$1:$B$100000\").RemoveDuplicates Columns:=1, Header:=xlNo\nColumns(\"C:C\").Select\nActiveSheet.Range(\"$C$1:$C$100000\").RemoveDuplicates Columns:=1, Header:=xlNo\nColumns(\"D:D\").Select\nActiveSheet.Range(\"$D$1:$D$100000\").RemoveDuplicates Columns:=1, Header:=xlNo\nColumns(\"E:E\").Select\nActiveSheet.Range(\"$E$1:$E$100000\").RemoveDuplicates Columns:=1, Header:=xlNo\nColumns(\"F:F\").Select\nActiveSheet.Range(\"$F$1:$F$100000\").RemoveDuplicates Columns:=1, Header:=xlNo\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1552497190, "post_id": 55147522, "comment_id": 97035765, "body": "If you access them using <code>sheet2.buttonname</code> then it&#39;s an activex not Form control and isn&#39;t part of the <code>Buttons</code> collection. Are you sure that user doesn&#39;t have design mode on?"}, {"owner": {"reputation": 142, "user_id": 334857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49a618fdafc80fefc7b323d92bf1a120?s=128&d=identicon&r=PG", "display_name": "Allen Gould", "link": "https://stackoverflow.com/users/334857/allen-gould"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1552497298, "post_id": 55147522, "comment_id": 97035841, "body": "@Rory Good to know on Buttons collection. I remoted into her machine and couldn&#39;t get the buttons to respond in either design or live. Can&#39;t move them, can&#39;t copy, can&#39;t select - they&#39;re drawn on the screen but otherwise Excel doesn&#39;t want to admit they exist."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1552497931, "post_id": 55147522, "comment_id": 97036223, "body": "Can you loop through all the ActiveX controls on the worksheet and see what shows up that way? See <a href=\"https://stackoverflow.com/a/45282180/4717755\">this</a>"}, {"owner": {"reputation": 142, "user_id": 334857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49a618fdafc80fefc7b323d92bf1a120?s=128&d=identicon&r=PG", "display_name": "Allen Gould", "link": "https://stackoverflow.com/users/334857/allen-gould"}, "edited": false, "score": 0, "creation_date": 1552503899, "post_id": 55147522, "comment_id": 97039351, "body": "@peakpeak They tell me they&#39;ve been trying for a few days, so hopefully a restart was part of that."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1552545438, "post_id": 55147522, "comment_id": 97052124, "body": "I suspect you&#39;re running into another update bug like this one: <a href=\"http://excelmatters.com/2014/12/10/office-update-breaks-activex-controls/\" rel=\"nofollow noreferrer\">excelmatters.com/2014/12/10/&hellip;</a> . Do you really need to use ActiveX instead of Form controls? The latter are much more stable."}, {"owner": {"reputation": 142, "user_id": 334857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49a618fdafc80fefc7b323d92bf1a120?s=128&d=identicon&r=PG", "display_name": "Allen Gould", "link": "https://stackoverflow.com/users/334857/allen-gould"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1552678581, "post_id": 55147522, "comment_id": 97117440, "body": "@Rory I don&#39;t recall why our company was on ActiveX, but all the new stuff just uses pictures/shapes instead. (Probably for exactly this reason.)"}], "owner": {"reputation": 142, "user_id": 334857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49a618fdafc80fefc7b323d92bf1a120?s=128&d=identicon&r=PG", "display_name": "Allen Gould", "link": "https://stackoverflow.com/users/334857/allen-gould"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552499122, "creation_date": 1552496650, "last_edit_date": 1552499122, "question_id": 55147522, "link": "https://stackoverflow.com/questions/55147522/excel-displays-buttons-but-says-they-dont-exist", "title": "Excel displays buttons but says they don&#39;t exist", "body": "<p>We have a spreadsheet that is used by a few dozen people, but one person today called up with an issue.</p>\n\n<p>The error that is flagged is:</p>\n\n<pre><code>Sheet2.ButtonName.Caption = \"new text here\"\n</code></pre>\n\n<p>On my machine (and everyone else's), ButtonName is on Sheet2, it's correctly called ButtonName, and the code is running fine.</p>\n\n<p>For this user, if you go to Sheet2, ButtonName is visible, but it's not clickable (nor are any of the other buttons), and Sheet2.Buttons.Count = 0?!?</p>\n\n<p>Already confirmed that macros are running (and other chunks of code are running, so I know it's enabled). User also reports that she has this problem with other sheets.</p>\n\n<p>How do I get a particular copy of Excel to recognize that buttons are a thing? (Excel 2013, if the version matters)</p>\n"}, {"tags": ["excel", "vba", "reference"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552496707, "post_id": 55147400, "comment_id": 97035476, "body": "Did you read the comment behind that line <code>Dim gAvDoc As Acrobat.AcroAVDoc</code>? It tells you to change it to <code>Dim gAvDoc As Object</code>. Since you are using <a href=\"https://support.microsoft.com/en-us/help/245115/using-early-binding-and-late-binding-in-automation\" rel=\"nofollow noreferrer\">Late Binding</a> <code>Set gAvDoc = CreateObject(&quot;AcroExch.AVDoc&quot;)</code> you should not need any references for that."}, {"owner": {"reputation": 7, "user_id": 10787816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869fa56e27a418bdfd9e265fa4885adc?s=128&d=identicon&r=PG&f=1", "display_name": "CircularReference", "link": "https://stackoverflow.com/users/10787816/circularreference"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552496963, "post_id": 55147400, "comment_id": 97035626, "body": "@P\u1d07\u029c, Sorry, that is my comment - I thought changing it to something it would recognize would help.  If I change to object, it returns a different error &#39;Run-Time error &#39;429&#39; ActiveX component can&#39;t create object.  But since that didn&#39;t work I set it back to original"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552498979, "post_id": 55147400, "comment_id": 97036754, "body": "You probably need to create the acrobat app first if you didn&#39;t do this elswhere yet <code>Dim gApp As Object: Set gApp = CreateObject(&quot;AcroExch.App&quot;)</code>, and use <code>Object</code> for the other one as well."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1552499142, "post_id": 55147400, "comment_id": 97036832, "body": "<code>Acrobat.AcroAVDoc</code> is probably from Acrobat (not just Reader)."}, {"owner": {"reputation": 7, "user_id": 10787816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869fa56e27a418bdfd9e265fa4885adc?s=128&d=identicon&r=PG&f=1", "display_name": "CircularReference", "link": "https://stackoverflow.com/users/10787816/circularreference"}, "edited": false, "score": 0, "creation_date": 1552499820, "post_id": 55147400, "comment_id": 97037212, "body": "I believe I&#39;ve tried that, and it returns error: &#39;Run-Time error &#39;429&#39; ActiveX component can&#39;t create object&quot;."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552549643, "post_id": 55147400, "comment_id": 97053804, "body": "Are you sure you have Acrobat installed? I tested it and even <code>CreateObject(&quot;AcroExch.AVDoc&quot;)</code> run out of the box (no need to add any references at all, because it is Late Binding) and created a instance of Acrobat. Cannot test if that works with Reader too but the thread you linked says it should. Do you have the original Adobe Acrobat or Adobe Acrobat Reader properly installed on this computer?"}, {"owner": {"reputation": 7, "user_id": 10787816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869fa56e27a418bdfd9e265fa4885adc?s=128&d=identicon&r=PG&f=1", "display_name": "CircularReference", "link": "https://stackoverflow.com/users/10787816/circularreference"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553535180, "post_id": 55147400, "comment_id": 97411816, "body": "@P\u1d07\u029c, confirmed, I have Adobe Acrobat Reader 2017"}], "owner": {"reputation": 7, "user_id": 10787816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869fa56e27a418bdfd9e265fa4885adc?s=128&d=identicon&r=PG&f=1", "display_name": "CircularReference", "link": "https://stackoverflow.com/users/10787816/circularreference"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1414, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552496797, "creation_date": 1552496246, "last_edit_date": 1552496797, "question_id": 55147400, "link": "https://stackoverflow.com/questions/55147400/excel-vba-user-defined-type-not-defined-cannot-find-reference", "title": "Excel VBA User-defined type not defined cannot find reference", "body": "<p>I have pulled code from a different source to try and search for a specific string in a PDF file. (source of code) <a href=\"https://acrobatusers.com/forum/general-acrobat-topics/search-text-pdf-vba-only-adobe-reader-installed/\" rel=\"nofollow noreferrer\">https://acrobatusers.com/forum/general-acrobat-topics/search-text-pdf-vba-only-adobe-reader-installed/</a> .  I tried this source because I do not have Adobe Professional, and due to the state of my company, requests like this will take atleast one month to process - and may still be denied.  So I have to try and make this work without Adobe Professional.</p>\n\n<p>As of now, when I try to run/test this code, it returns an error </p>\n\n<blockquote>\n  <p>\"Compile error:  User-defined type not defined\"</p>\n</blockquote>\n\n<p>and it highlights the <code>Dim gAvDoc As Acrobat.AcroAVDoc</code> portion of the code.  Which suggests to me that I am missing something in the reference.  I've tried selecting seemingly related references with no success.</p>\n\n<p>Can anyone let me know if the missing reference is the issue?  If so, what reference do I need to select to get the code to work.  These are the references I currently have checked:</p>\n\n<blockquote>\n  <ul>\n  <li>'Visual Basic For Applications'; </li>\n  <li>'Microsoft Excel 14.0 Object Library'; </li>\n  <li>'OLE Automation'; </li>\n  <li>'Microsoft Office 14.0 Object Library'; </li>\n  <li>'Adobe Acrobat Browser Control Type Library 1.0'; </li>\n  <li>'Adobe Reader File Preview Type Library'; </li>\n  <li>'Attachmate_Reflection_Objects'; </li>\n  <li>'Attachmate_Reflection_Objects_Emulation_IbmHosts'; </li>\n  <li>'Attachmate_Reflection_Objects_Emulation_OpenSystems';</li>\n  <li>'Attachmate_Reflection_Objects_Framework'; </li>\n  <li>'Acrobat Access 3.0 Type Library'; 'AcroBrokerLib'; </li>\n  <li>'Active DS Type Library'; </li>\n  <li>'Microsoft ActiveX Data Objects 2.0 Library'; </li>\n  <li>'Microsoft ActiveX Data Objects (Multi-dimensional) 6.0 Library'</li>\n  </ul>\n</blockquote>\n\n<p>I'm also running Windows 10 with Microsoft Excel 2010</p>\n\n<pre><code>Option Explicit\n\nSub SearchPDF_forString()\n\n    Dim gAvDoc As Acrobat.AcroAVDoc                'Robby change, \"Acrobat.AcroAVDoc\" to \"Object\"\n    Dim gPDFPath As String\n    Dim foundText As Integer            'Holds return value from \"FindText\" method\n    Dim Rsp 'For message box responses\n    Dim sText As String                 'Robby Addition\n    Dim sStr As String                  'Robby Addition\n    Dim resp As String                  'Robby Addition\n\n    gPDFPath = \"\\\\DTCHYB-MNMH001\\C_WBGCTS_Users\\U658984\\My Documents\\QC_random\\DuplicateFormProject_ForKevin\\1099DALL_1.pdf\"\n\n    'set AVDoc object for searching\n    Set gAvDoc = CreateObject(\"AcroExch.AVDoc\")\n\n    If gAvDoc.Open(gPDFPath, \"\") Then\n        sText = \"041-3600122117\"\n        'FindText params: StringToSearchFor, caseSensitive (1 or 0), WholeWords (1 or 0), ResetSearchToBeginOfDocument (1 or 0)\n        foundText = gAvDoc.FindText(sText, 1, 0, 1) 'Returns -1 if found, 0 otherwise\n    Else\n        ' if failed, show error message\n        Rsp = MsgBox(\"Cannot open\" &amp; gPDFPath, vbOKOnly)\n    End If\n\n    If foundText = -1 Then\n        'compose a message\n        sStr = \"Found \" &amp; sText\n        resp = MsgBox(sStr, vbOKOnly)\n    Else\n        ' if failed, show error message\n        resp = MsgBox(\"Cannot find\" &amp; sText, vbOKOnly)\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1552495569, "post_id": 55147004, "comment_id": 97034788, "body": "Where is <code>mapifolder</code> assigned? Error 91 means you&#39;re making a member call <code>.Store</code> against an object (<code>mapifolder</code>) that wasn&#39;t <code>Set</code> with a valid object reference, hence its value is <code>Nothing</code>. Consider editing your question to include a self-contained <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11096783"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552496028, "post_id": 55147004, "comment_id": 97035051, "body": "I edited and added the declaration of Mapifolder. the only result I want is to have a pop-up msg containing the active mailbox name everytime i click  reply."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11096783"}, "edited": false, "score": 0, "creation_date": 1552498746, "post_id": 55147910, "comment_id": 97036639, "body": "Thank you for your feedback. I tried to add your suggested code and Error 438 appeared."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1552499552, "post_id": 55147910, "comment_id": 97037055, "body": "Try to cast the parent object to the Folder class first. Where did you get the <code>oItem</code> instance?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11096783"}, "edited": false, "score": 0, "creation_date": 1552499771, "post_id": 55147910, "comment_id": 97037186, "body": "I declare it as a private event `Private WithEvents oItem As MailItem &#39;"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1552497979, "creation_date": 1552497979, "answer_id": 55147910, "question_id": 55147004, "link": "https://stackoverflow.com/questions/55147004/get-mailbox-name-using-vba/55147910#55147910", "title": "Get Mailbox Name using VBA", "body": "<p>The Namespace class doesn't provide the Store property:</p>\n\n<pre><code>Dim mapifolder As Outlook.NameSpace\nSet mapifolder = Application.GetNamespace(\"MAPI\")\nMsgBox mapifolder.Store.Name\n</code></pre>\n\n<p>The <code>mapiFolder</code> is an instance of the <code>Namespace class</code>, not <code>Folder</code>.</p>\n\n<p>To achieve the goal you need to use the following sequence of calls:</p>\n\n<pre><code>MsgBox oItem.Parent.Store.Name\n</code></pre>\n\n<p>Be aware, in case of root folders the <code>Parent</code> property returns an instance of the Namespace class. So, add a check to the final edition of the code. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11096783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 619, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592689016, "creation_date": 1552495133, "last_edit_date": 1592689016, "question_id": 55147004, "link": "https://stackoverflow.com/questions/55147004/get-mailbox-name-using-vba", "title": "Get Mailbox Name using VBA", "body": "<p>I have multiple Mailboxes, I need a msgbox that will pop-up the name of the active mailbox that I use to reply for specific email. </p>\n\n<pre><code>Private Sub oItem_Reply(ByVal Response As Object, Cancel As Boolean)\n    Dim mapifolder As Outlook.NameSpace\n    Set mapifolder = Application.GetNamespace(\"MAPI\")\n    Dim myNamespace As Outlook.Name\n    MsgBox oItem.Parent\n    MsgBox mapifolder.Store.Name\nEnd Sub\n</code></pre>\n\n<p>I got an error 91 on the 2nd msgbox</p>\n\n<p>Any idea what is  missing on this?</p>\n"}, {"tags": ["python", "excel", "vba", "pandas"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 12756163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35da928f8e0446a45732dbea5f6a8af9?s=128&d=identicon&r=PG&f=1", "display_name": "blec", "link": "https://stackoverflow.com/users/12756163/blec"}, "is_accepted": false, "score": 1, "last_activity_date": 1586963428, "last_edit_date": 1586963428, "creation_date": 1586963007, "answer_id": 61232035, "question_id": 55146482, "link": "https://stackoverflow.com/questions/55146482/write-to-an-existing-xlsm-using-pandas-and-xlsxwriter/61232035#61232035", "title": "Write to an existing .xlsm using pandas and XlsxWriter", "body": "<p>I had the same issue using this XlsxWriter workaround. I think you would need to copy/paste already existing sheets into writer.sheets. Maybe one way to fix it is to add a line like </p>\n\n<pre><code>writer.sheets = {ws.title: ws for ws in writer.book.worksheets}\n</code></pre>\n\n<p>but this syntax does not work with engine = 'xlsxwriter'</p>\n\n<p>To add a DataFrame to an xlsm sheet what I did is simply :</p>\n\n<pre><code>import pandas\nimport openpyxl\n\nwriter = pandas.ExcelWriter(excel_file_path, engine='openpyxl')\n\nwriter.book = openpyxl.load_workbook(excel_file_path, keep_vba= True)\nwriter.sheets = {ws.title: ws for ws in writer.book.worksheets}\n\ndataframe_to_insert.to_excel(writer, sheet_name= sheet_destination)\n\nworkbook = writer.book\nworkbook.filename = excel_file_path\n\nwriter.save()\nwriter.close()\n</code></pre>\n\n<p>It seems <code>keep_vba= True</code> is doing the job for me (Python 3.8.x). </p>\n"}], "owner": {"reputation": 102, "user_id": 10775099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ffd588990408afaeeb78241fb8def8?s=128&d=identicon&r=PG&f=1", "display_name": "DMSTA", "link": "https://stackoverflow.com/users/10775099/dmsta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1267, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1586963428, "creation_date": 1552493524, "question_id": 55146482, "link": "https://stackoverflow.com/questions/55146482/write-to-an-existing-xlsm-using-pandas-and-xlsxwriter", "title": "Write to an existing .xlsm using pandas and XlsxWriter", "body": "<p>I would like to write a dataframe to an existing .xlsm file which already has content. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/28169731/write-pandas-dataframe-to-xlsm-file-excel-with-macros-enabled\">Write pandas dataframe to xlsm file (Excel with Macros enabled)</a> describes how to write to a new file but I want to write to add a new sheet to an existing .xlsm file. When I use the following (as in the question): </p>\n\n<pre><code>import pandas as pd\n\ndf = pd.DataFrame({'First' : [5, 2, 0, 10, 4], \n               'Second' : [9, 8, 21, 3, 8]})\n\nwriter = pd.ExcelWriter('test.xlsx', engine='xlsxwriter')\n\ndf.to_excel(writer, sheet_name='Sheet1')\n\nworkbook  = writer.book\nworkbook.filename = 'test.xlsm'\nworkbook.add_vba_project('./vbaProject.bin')\n\ndf.to_excel(writer, sheet_name='Sheet1') #This is the df I'm trying to add to the sheet\nwriter.save()\n</code></pre>\n\n<p>it overwrites the original content and the existing .xlsm file only has the newly added sheet. </p>\n\n<p>I can't quite figure out how to amend the code in the linked question above to consider an existing file.</p>\n\n<p>Thanks</p>\n\n<p>*I have extracted the vbaProject.bin ad described here: <a href=\"https://xlsxwriter.readthedocs.io/working_with_macros.html\" rel=\"nofollow noreferrer\">https://xlsxwriter.readthedocs.io/working_with_macros.html</a> *</p>\n"}, {"tags": ["excel", "vba", "nested-if"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 5, "creation_date": 1552493575, "post_id": 55146461, "comment_id": 97033588, "body": "Yes, you could introduce a loop. If you haven&#39;t already then it is time to study loops."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 1, "creation_date": 1552493779, "post_id": 55146461, "comment_id": 97033728, "body": "Also, might want to look into <code>Select Case</code> as well"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1552493870, "post_id": 55146461, "comment_id": 97033785, "body": "What exactly are you trying to do with these two numbers? There might be a much easier way than either loops or nested if statements."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1552494181, "post_id": 55146461, "comment_id": 97033959, "body": "Besides comparing the numbers, it seems you also need to know how many digits match. Is this correct? Do you also need to know the location of the digits that match? Obviously the more you require to know, the more complex this gets."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1552494597, "post_id": 55146461, "comment_id": 97034214, "body": "@user1992460 do the two numbers inputted always have to be same length, or one can be a 2 digit number and the other 3 digit one?"}, {"owner": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "edited": false, "score": 0, "creation_date": 1552494701, "post_id": 55146461, "comment_id": 97034279, "body": "They will always be 3 digits each."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1552495335, "post_id": 55146461, "comment_id": 97034637, "body": "As an exercise, consider how your code would have to be structured in order to make it support 4-digit, 6-digit, n-digit combintions. The better the design, fewer bugs are potentially introduced by that change. I&#39;d recommend you get your code working as intended, then put it up for review on <a href=\"https://codereview.stackexchange.com\">Code Review</a> - you&#39;ll learn a ton of tricks from reviewers!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1552495702, "post_id": 55146461, "comment_id": 97034860, "body": "If you&#39;re only want matches for three-digit numbers and you&#39;re not afraid of memory consumption: Put all three-digit combinations in a Trie: <a href=\"https://www.geeksforgeeks.org/trie-insert-and-search/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/trie-insert-and-search</a>  It is VERY fast."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1552496998, "post_id": 55146461, "comment_id": 97035647, "body": "How would duplicate digits impact your expected result?  e.g. &quot;007&quot; and &quot;360&quot; - is that <code>1</code> or <code>2</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1552494650, "post_id": 55146778, "comment_id": 97034239, "body": "I think this would fail with <code>digitMatch(032, 053)</code> as the <i>OP</i> still expects 2, but your function would return 1."}, {"owner": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "edited": false, "score": 0, "creation_date": 1552494651, "post_id": 55146778, "comment_id": 97034242, "body": "I think that only checks them in one order though. So, for example if I have 123 and 321 this needs to return 3. This function wouldn&#39;t do that."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1552494685, "post_id": 55146778, "comment_id": 97034265, "body": "@ja72 yeah, question was posted before further information was revealed in comments, in process of editign the answer"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "edited": false, "score": 0, "creation_date": 1552495195, "post_id": 55146778, "comment_id": 97034546, "body": "@user1992460 check the answer now, now it does the digit match regarldess of the order"}, {"owner": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "edited": false, "score": 0, "creation_date": 1552496446, "post_id": 55146778, "comment_id": 97035304, "body": "Yes, I believe this will work for my purpose, thank you!"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "edited": false, "score": 0, "creation_date": 1552496502, "post_id": 55146778, "comment_id": 97035332, "body": "@user1992460 Mark the answer as correct please then, so the question can be closed :) If you need further help, feel free to let me know"}, {"owner": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "edited": false, "score": 0, "creation_date": 1552503780, "post_id": 55146778, "comment_id": 97039297, "body": "@Rawrplus Hey, this doesn&#39;t work for numbers with 2 of the same digits. For example if Num2 = 134 and Num1 = 112, then this will return 2 when it should return 1"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "edited": false, "score": 0, "creation_date": 1552512999, "post_id": 55146778, "comment_id": 97043519, "body": "@user1992460 This depends on which number you want for comparison and which as input. If you want <code>num2 = 134</code> and  <code>num1 = 112</code> to return 1, simply change the <code>ByVal num1</code> and <code>Byval num2</code> in function declaration and it should work"}, {"owner": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "edited": false, "score": 0, "creation_date": 1552517149, "post_id": 55146778, "comment_id": 97044981, "body": "Well that&#39;s just reversing the problem haha anyways I made a small adjustment using string replace to delete the part of the number that matches on each iteration and it works now"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "edited": false, "score": 0, "creation_date": 1552519365, "post_id": 55146778, "comment_id": 97045605, "body": "@user1992460 That&#39;s not reversing the problem. You always need to one value to be compared to and one which you are comparing. It&#39;s mathematically impossible to have both.  But, obviously, you can let user pick which one is which, if you add one extra argument to function. Either way, guess you found your own solution, whatever floats your boat :)"}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": true, "score": 2, "last_activity_date": 1552495167, "last_edit_date": 1552495167, "creation_date": 1552494427, "answer_id": 55146778, "question_id": 55146461, "link": "https://stackoverflow.com/questions/55146461/comparing-2-numbers-in-vba/55146778#55146778", "title": "Comparing 2 Numbers in VBA", "body": "<p>Can be simplified to a <code>function</code> with a simple <code>for</code> loop</p>\n\n<pre><code>Private Function digitMatch(ByVal num1 as String, ByVal num2 as String) As Byte\n ' num1 and num2 are strings, because of presumption they can start with 0\n ' (i.e. 042 is valid 3 digit number format, otherwise they can be integers as well)\n\n  Dim i As Byte\n  Dim matches As Byte: matches = 0\n\n  For i = 1 To Len(num1)\n     If InStr(1, num2, Mid(num1, i, 1)) &lt;&gt; 0 Then\n        matches = matches + 1\n     End If\n  Next i\n\n  digitMatch = matches\n\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p>so eg. <code>digitMatch(023, 053)</code> would return <code>2</code>\n  or <code>digitMatch(123, 321)</code> would return <code>3</code></p>\n</blockquote>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1552495932, "post_id": 55147106, "comment_id": 97035003, "body": "if then else else if else ... Ugly!"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1552496128, "post_id": 55147106, "comment_id": 97035112, "body": "Hey! You&#39;re being very mean!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1552496153, "post_id": 55147106, "comment_id": 97035125, "body": "Can you elaborate on that?"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1552496271, "post_id": 55147106, "comment_id": 97035198, "body": "I though your post was sarcastic, but judging but this reply I guess it wasn&#39;t. You hurt my feelings. It is ugly but it works and took me 2 minutes to write it for someone for free."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1552496395, "post_id": 55147106, "comment_id": 97035271, "body": "@peakpeak  what&#39;s that elitist attitude? He made a valid contribution. Yes the code may not be pretty,  but doesn&#39;t mean he should be shunned for it."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1552496432, "post_id": 55147106, "comment_id": 97035291, "body": "Give him suggestion on how to improve it, rather than just discourage him to code..."}], "tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1552495969, "last_edit_date": 1552495969, "creation_date": 1552495480, "answer_id": 55147106, "question_id": 55146461, "link": "https://stackoverflow.com/questions/55146461/comparing-2-numbers-in-vba/55147106#55147106", "title": "Comparing 2 Numbers in VBA", "body": "<p>Try this (it will only work correctly if both 'curNum' and 'WinningNumber' are 3 digits long):</p>\n\n<pre><code>'straight match\nIf curNum = WinningNumber Then\n    M = 3\n    s = 3\n'matched the first 2 straight\nElseIf InStr(1, WinningNumber, Left(curNum, 2)) &gt; 0 Then\n    M = 2\n    s = 2\n    If InStr(1, WinningNumber, Right(curNum, 1)) &gt; 0 Then M = M + 1\n'matched the last 2 straight\nElseIf InStr(2, WinningNumber, Right(curNum, 2)) &gt; 0 Then\n    M = 2\n    s = 2\n    If InStr(1, WinningNumber, Left(curNum, 1)) &gt; 0 Then M = M + 1\n'any other scenario\nElse\n    s = 0\n    For i = 1 To 3\n        n = Mid(WinningNumber, i, 1)\n        If InStr(1, curNum, n) &gt; 0 Then\n            M = M + 1\n        End If\n    Next\nEnd If\n\nDebug.Print \"Matched digits: \" &amp; M\nDebug.Print \"Straight: \" &amp; s\n</code></pre>\n\n<p>I'm sure there's a better way to do it but this was the easiest way for me to write it up quickly.</p>\n"}, {"comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1552496284, "post_id": 55147137, "comment_id": 97035204, "body": "This is identical to my answer, only with a different output format.of the function"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1552496588, "post_id": 55147137, "comment_id": 97035388, "body": "I was already typing my answer when you edited yours. I upvoted yours for the use of <code>InStr()</code> avoiding an inner loop. That was the only part I took from your answer."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1552496717, "post_id": 55147137, "comment_id": 97035481, "body": "Alright then. Afterall, don&#39;t take my comment as <i>&quot;hey that&#39;s mine answer!&quot;</i>, rather as a suggestion to avoid redundancy. Obviously, I can&#39;t complain given my answer was structured differently prior to the edit"}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 1, "last_activity_date": 1552496713, "last_edit_date": 1552496713, "creation_date": 1552495565, "answer_id": 55147137, "question_id": 55146461, "link": "https://stackoverflow.com/questions/55146461/comparing-2-numbers-in-vba/55147137#55147137", "title": "Comparing 2 Numbers in VBA", "body": "<p>In my answer, I return the digits that match, so you can check if there are any and which ones. Also, it works with any number of digits.</p>\n\n<pre><code>Public Function CheckForMatch(ByVal curNum As String, ByVal winNumber As String) As String\n\n    Dim i As Long, j As Long\n\n     Dim hit As String\n     hit = vbNullString\n\n     For i = 1 To Len(curNum)\n        j = InStr(1, winNumber, Mid(curNum, i, 1), vbTextCompare)\n        If j &gt; 0 Then\n            hit = hit &amp; Mid(curNum, i, 1)\n        End If\n    Next i\n\n    CheckForMatch = hit\nEnd Function\n\nPublic Sub Test()\n\n    Dim check As String\n\n    check = CheckForMatch(\"75214\", \"13672\")\n\n    If Len(check) &gt; 0 Then\n        Debug.Print \"Numbers \" &amp; check &amp; \" are a match.\"\n        ' 721\n    Else\n        Debug.Print \"No match. Sorry.\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><sub>\nNOTE: The use of <code>InStr()</code> here was inspired by the answer <a href=\"https://stackoverflow.com/users/5512705/rawrplus\">Rawplus</a> gave before me.\n</sub></p>\n"}], "owner": {"reputation": 23, "user_id": 1992460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37785ed26990cc83e57c8ad4520b17c?s=128&d=identicon&r=PG", "display_name": "user1992460", "link": "https://stackoverflow.com/users/1992460/user1992460"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1535, "favorite_count": 0, "accepted_answer_id": 55146778, "answer_count": 3, "score": 0, "last_activity_date": 1552496713, "creation_date": 1552493466, "last_edit_date": 1552495715, "question_id": 55146461, "link": "https://stackoverflow.com/questions/55146461/comparing-2-numbers-in-vba", "title": "Comparing 2 Numbers in VBA", "body": "<p>I'm trying to compare 2 3-digit numbers. This is my current code using nested Ifs</p>\n\n<pre><code>If Mid(Num1, 1, 1) = Mid(Num2, 1, 1) Then  \n'Check first number against first number\n\nIf Mid(Num1, 2, 1) = Mid(Num2, 2, 1) Then \n 'Check second number against second number\n\n\n   If Mid(Num1, 3, 1) = Mid(Num2, 3, 1) Then  \n    'Check third number against third number \n\n        Digits = 3\n\n    Else\n\n        Digits = 2\n\n    End If\n</code></pre>\n\n<p>And this is just one small part of it. Also, I need to check the order in which they match as well. So whether it's an exact match, all 3 digits match in any order, or if 1 or 2 digits match in any order.</p>\n\n<p>The problem is I have a lot of If statements using this method as I have to compare every combination of digits to check for a 1 digit, 2 digit, 3 digit, etc, match. Is there a better way?</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "owner": {"reputation": 11, "user_id": 11198269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a235447769393566f8be7dd704ad7ba0?s=128&d=identicon&r=PG&f=1", "display_name": "pieterhaut", "link": "https://stackoverflow.com/users/11198269/pieterhaut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576620956, "creation_date": 1552493283, "last_edit_date": 1576620956, "question_id": 55146398, "link": "https://stackoverflow.com/questions/55146398/pasting-charts-in-order-shown-in-excel-workbook-into-powerpoint-slide", "title": "Pasting charts in order shown in Excel Workbook into PowerPoint Slide", "body": "<p>I am trying to copy and paste charts from a worksheet into a slide in PowerPoint.</p>\n\n<p>These charts are now lined up in two rows and three columns:</p>\n\n<pre><code>Chart 1   Chart 2   Chart 3 \nChart 4   Chart 5   Chart 6\n</code></pre>\n\n<p>I want to paste these charts in the same order in PowerPoint.</p>\n\n<p>When I use my command <code>ws.ChartObjects.Count</code>, it counts the charts vertically, as in:</p>\n\n<pre><code>Chart 1   Chart 3   Chart 5\nChart 2   Chart 4   Chart 6\n</code></pre>\n\n<p>So now this is also the order in which they are pasted in PowerPoint.</p>\n"}, {"tags": ["excel", "vba", "real-time-data", "rtd"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1552493328, "post_id": 55146359, "comment_id": 97033417, "body": "Afaik, no, it&#39;s not. You can only set update time on specific <code>Workbook</code>s"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1552493360, "post_id": 55146359, "comment_id": 97033440, "body": "Furthermore, from practical standpoint, it makes no sense to update only a specific <code>Worksheet</code> while leaving the others unupdated"}, {"owner": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1552493445, "post_id": 55146359, "comment_id": 97033508, "body": "sorry- the use of the word worksheet in the last line was a typo. I meant to say workbook. I only need a different workbooks to pull data at different speeds. I&#39;ll edit"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1552493735, "post_id": 55146359, "comment_id": 97033694, "body": "I guess you could change the <code>RTD.ThrottleInterval</code> property depending on which workbooks are currently open in the <code>Application</code> object, however from practical standpoint, I would say it&#39;s better to simply leave the <code>ThrotteInterval</code> same for every <code>Workbook</code>. Perhaps there is some more elegant solution, but at least I am not aware of one"}], "owner": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552494840, "creation_date": 1552493159, "last_edit_date": 1552494840, "question_id": 55146359, "link": "https://stackoverflow.com/questions/55146359/is-it-possible-to-have-a-different-application-rtd-throttleinterval-for-differen", "title": "Is it possible to have a different Application.RTD.ThrottleInterval for different Workbooks?", "body": "<p>I have two workbooks that have RTD links (Real Time Data). On most of my workbooks, i dont need the data to update faster than once every 4-5 seconds, however - I would need only 1 of my workbooks to update as fast as possible (Application.RTD.ThrottleInterval=0). </p>\n\n<p>Is it possible to have different throttle intervals for different workbook or is it just application wide?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 4, "creation_date": 1552492792, "post_id": 55146161, "comment_id": 97033036, "body": "Why not use Excel&#39;s built in feature (Date -&gt; Data Tools - Remove Duplicates)? If you need this in VBA the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Range.RemoveDuplicates\" rel=\"nofollow noreferrer\"><code>RemoveDuplicates</code></a> method is what you&#39;re looking for"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 2, "creation_date": 1552492926, "post_id": 55146161, "comment_id": 97033139, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31631231/remove-duplicates-from-range-of-cells-in-excel-vba\">Remove Duplicates from range of cells in excel vba</a>"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1552493200, "post_id": 55146161, "comment_id": 97033332, "body": "@cybernetic.nomad Thanks didn&#39;t know it could do that over several columns"}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1552493172, "post_id": 55146274, "comment_id": 97033311, "body": "Thanks I never knew such thing existed was looking around lol"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1552493227, "post_id": 55146274, "comment_id": 97033352, "body": "Fair enough, glad I helped :P"}], "tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": true, "score": 5, "last_activity_date": 1552492909, "creation_date": 1552492909, "answer_id": 55146274, "question_id": 55146161, "link": "https://stackoverflow.com/questions/55146161/how-to-remove-duplicate-rows-across-several-columns-without-too-much-loops/55146274#55146274", "title": "How to remove duplicate rows across several columns without too much loops?", "body": "<p>What stops you from using this?</p>\n\n<pre><code>Range(\"A:E\").RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5), Header:=xlYes\n</code></pre>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 55146274, "answer_count": 1, "score": 0, "last_activity_date": 1552494832, "creation_date": 1552492567, "last_edit_date": 1552494832, "question_id": 55146161, "link": "https://stackoverflow.com/questions/55146161/how-to-remove-duplicate-rows-across-several-columns-without-too-much-loops", "title": "How to remove duplicate rows across several columns without too much loops?", "body": "<p>Most questions focus on single column duplicates which is easier and less computationally extensive.</p>\n\n<p>I created a script that will remove duplicate rows across several columns--meaning if all the columns have the exact same values with another row, then it is a duplicate row and should be deleted. The problem is, it is too inefficient due to nested <code>for-next</code> loops. If the workbook has 1200 rows and 7 columns, there will be 1200 x 1200 x 7 runs which will be equal to around 10 million runs. I know arrays will be faster, but I am more concerned about finding a way to reduce the number of loops more. </p>\n\n<p>The code is shown below:</p>\n\n<pre><code>Option Explicit\nFunction RemoveNonTableDuplicate()\nDim Range_scanned As Range, Range_compared As Range, i As Long, j As Long, x As Long, z As Long, Match As Long, Sheet_name As String, Workbook_name As String, Total_rows As Long\n\nWorkbook_name = InputBox(\"Please Input the Workbook Name\", \"Identify Workbook Name\")\nSheet_name = InputBox(\"Please Input the Worksheet Name\", \"Identify Worksheet Name\")\n\nStart:\nTotal_rows = Workbooks(Workbook_name).Worksheets(Sheet_name).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To Total_rows\n    Match = 0\n    Set Range_scanned = Workbooks(Workbook_name).Worksheets(Sheet_name).Range(\"A\" &amp; i &amp; \":E\" &amp; i)\n    For j = 2 To Total_rows\n        Set Range_compared = Workbooks(Workbook_name).Worksheets(Sheet_name).Range(\"A\" &amp; j &amp; \":E\" &amp; j)\n        For z = 1 To TotalColumnsCount(Workbooks(Workbook_name).Name, Sheet_name)\n            If Range_scanned(z) = Range_compared(z) Then\n                x = x + 1\n            End If\n        Next z\n        If x = TotalColumnsCount(Workbooks(Workbook_name).Name, Sheet_name) Then\n            Match = Match + 1\n        End If\n        x = 0\n        If Match &gt; 1 Then\n            Workbooks(Workbook_name).Worksheets(Sheet_name).Range(\"A\" &amp; j &amp; \":E\" &amp; j).Delete Shift:=xlUp\n            GoTo Start\n        End If\n    Next j\nNext i\nEnd Function\n</code></pre>\n\n<p>To illustrate how the code should work please refer to the images below.</p>\n\n<p>Prior to running the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8bRcq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8bRcq.png\" alt=\"Prior\"></a></p>\n\n<p>After running the code to remove duplicates:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pKnU1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pKnU1.png\" alt=\"After\"></a></p>\n"}, {"tags": ["excel", "vba", "scheduled-tasks"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1552492164, "post_id": 55145978, "comment_id": 97032543, "body": "VBA is single-threaded, so it won&#39;t be running them simultaneously"}, {"owner": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1552492246, "post_id": 55145978, "comment_id": 97032606, "body": "Ok cool - any idea on how will it determine which runs first?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1552492465, "post_id": 55145978, "comment_id": 97032782, "body": "Your question isn&#39;t very clear. You talk about <i>two</i> scheduled functions in the title of the question but then say &quot;One of the macros is scheduled through Application.Ontime and the other is part of a worksheet.calculate function&quot; -- which suggests that only one of the two functions is scheduled (with the trigger of the other one left unspecified). As a default, <code>Application.OnTime</code> will run the procedure when scheduled -- or as soon as it can (as soon as Excel is in ready-mode)."}, {"owner": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1552492624, "post_id": 55145978, "comment_id": 97032909, "body": "Sorry - The 2nd one will always be triggered at 1130 as well."}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "edited": false, "score": 0, "creation_date": 1552492907, "post_id": 55145978, "comment_id": 97033127, "body": "@novawaly As far as I know, VBA would run the macros synchronously. VBA  executes all procedures and /or functions sequentially. In other words, VBA consists of only one thread. There are workarounds like using VBA to create other VBA worker threads, which essentially opening a new instance of Excel and running code there. Check out <a href=\"https://stackoverflow.com/questions/5721564/multi-threading-in-vba\">this</a> post about multi-threading in VBA."}, {"owner": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "edited": false, "score": 0, "creation_date": 1552492989, "post_id": 55145978, "comment_id": 97033188, "body": "ok perfect. Thank you"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1552493069, "post_id": 55145978, "comment_id": 97033238, "body": "I guess you could add a <code>MsgBox &quot;procedure x&#47;y ran&quot;</code>  and you can see which ran first. But as pointed out, since vba is single-threaded, it depends on which procedure has top position in the queue, so you don&#39;t even have a guarantee they always run in the same order. If you want to manipulate them, you can create your own thread"}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "edited": false, "score": 0, "creation_date": 1552493246, "post_id": 55145978, "comment_id": 97033364, "body": "You are most welcome.Just a note that if you have the know how, you could use <code>C# </code> or <code>VB.NET</code> which DO provide the framework to multi-thread, albeit, more abstract."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552493563, "post_id": 55145978, "comment_id": 97033579, "body": "If you want to deterministically schedule one before the other, you need to specify different times for each. The code should be written in such a way that whichever macro runs first, makes no difference. This is textbook <i>temporal coupling</i>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "edited": false, "score": 1, "creation_date": 1552493652, "post_id": 55145978, "comment_id": 97033637, "body": "@rickmanalexander while C# or VB.NET do provide framework for muti-threading, concurrent access on COM objects will throw <code>COMException</code> left &amp; right. COM and .NET have wildly different threading models, so .NET threads need to be synchronized. So yeah, .NET can do MT, but .NET/COM Interop + MT = trouble."}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552494250, "post_id": 55145978, "comment_id": 97034000, "body": "@MathieuGuindon My friend, your comment went over this ole boy&#39;s head, lol. All I know is that they each support multi-threading, but I am woefully ignorant at the deep inner-workings of each. Definitely trying to learn all I can though, so thanks for the info!"}], "owner": {"reputation": 779, "user_id": 10007302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc46e5434cc4cc2b904a82620b44c063?s=128&d=identicon&r=PG&f=1", "display_name": "novawaly", "link": "https://stackoverflow.com/users/10007302/novawaly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552493372, "creation_date": 1552492024, "last_edit_date": 1552493372, "question_id": 55145978, "link": "https://stackoverflow.com/questions/55145978/how-does-vba-handle-two-scheduled-functions-that-run-at-the-same-time", "title": "How does VBA handle two scheduled functions that run at the same time?", "body": "<p>Im just realizing that I have two macros on two different excel sheets that are scheduled to run at certain times throughout the day. They overlap at 1130 and are intended to capture market events at those times. One will run in about 10 seconds while the other can take about 1min to run. Both contain copy and pasting of some sort. Its important that I get the information exactly at 1130 so a delay would not be ideal. </p>\n\n<p>One of the macros is scheduled through Application.Ontime and the other is part of a worksheet.calculate function. </p>\n\n<p>I was wondering how VBA handles this? Will it run the macro all the way through then begin the second or will it try to run at the same time causing the copy/paste not work correctly. </p>\n"}, {"tags": ["excel", "vba", "finance"], "comments": [{"owner": {"reputation": 2041, "user_id": 6321291, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/25f2ca2f73db77b821c5a5ddb8e54203?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6321291/kevin"}, "edited": false, "score": 1, "creation_date": 1552491510, "post_id": 55145555, "comment_id": 97032110, "body": "Are you looking for someone to write you the VBA code?  Or are you asking if there&#39;s an existing function that does what you want?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1552491808, "post_id": 55145555, "comment_id": 97032303, "body": "What date format is that? <code>YYDDMM</code>?"}, {"owner": {"reputation": 33, "user_id": 11197733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AHmpNEUbqAc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIkLcQ_jJpbqol-dIAGvU6kfF1IA/mo/photo.jpg?sz=128", "display_name": "DDN1414", "link": "https://stackoverflow.com/users/11197733/ddn1414"}, "reply_to_user": {"reputation": 2041, "user_id": 6321291, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/25f2ca2f73db77b821c5a5ddb8e54203?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6321291/kevin"}, "edited": false, "score": 0, "creation_date": 1552492232, "post_id": 55145555, "comment_id": 97032597, "body": "@Kevin I&#39;m sorry if I didn&#39;t explain it properly. I am asking for help with the code because I&#39;m new to vba so I cannot do it yet on my own."}, {"owner": {"reputation": 33, "user_id": 11197733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AHmpNEUbqAc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIkLcQ_jJpbqol-dIAGvU6kfF1IA/mo/photo.jpg?sz=128", "display_name": "DDN1414", "link": "https://stackoverflow.com/users/11197733/ddn1414"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1552492258, "post_id": 55145555, "comment_id": 97032618, "body": "@BruceWayne It is YYMM"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1552492312, "post_id": 55145555, "comment_id": 97032659, "body": "You should at least <i>start</i> it on your own, show your code, and discuss problems that you are having with it. As it is, your question seems like a request for others to write the code for you, which isn&#39;t how Stack Overflow works."}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 1, "creation_date": 1552492379, "post_id": 55145555, "comment_id": 97032716, "body": "Don&#39;t always think VBA is the answer. You can do this with a Pivot table, because you can select dates by Quarter (you&#39;ll just need to convert your dates into actual dates"}, {"owner": {"reputation": 33, "user_id": 11197733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AHmpNEUbqAc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIkLcQ_jJpbqol-dIAGvU6kfF1IA/mo/photo.jpg?sz=128", "display_name": "DDN1414", "link": "https://stackoverflow.com/users/11197733/ddn1414"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1552492770, "post_id": 55145555, "comment_id": 97033021, "body": "@JohnColeman Sorry, I didn&#39;t know that I needed to do this. I started off with this code that I saw in class but it&#39;s not working properly. The code is in the edit"}, {"owner": {"reputation": 2041, "user_id": 6321291, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/25f2ca2f73db77b821c5a5ddb8e54203?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6321291/kevin"}, "edited": false, "score": 0, "creation_date": 1552500947, "post_id": 55145555, "comment_id": 97037774, "body": "I gave an answer that will hopefully help you out (though it doesn&#39;t do it in VBA.)  To be honest, I do a <i>LOT</i> of misc analysis/calculation/data-playing in Excel, and I think its ability to work through data analysis is very underrated (last two things I used it for were calculating belt capacities for Factorio and water usage in OxygenNotIncluded.)  If you&#39;re doing freehand calculations, you can usually get the answer faster than simply doing the math on paper, and both faster/easier than actually coding a solution.  Loves me some Excel  :-)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11197733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AHmpNEUbqAc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIkLcQ_jJpbqol-dIAGvU6kfF1IA/mo/photo.jpg?sz=128", "display_name": "DDN1414", "link": "https://stackoverflow.com/users/11197733/ddn1414"}, "edited": false, "score": 0, "creation_date": 1552551617, "post_id": 55148661, "comment_id": 97054769, "body": "thank you very much for your answer, that is indeed helpful. The only problem is that I really need it in vba, so is there any way that you could help me with my code?"}, {"owner": {"reputation": 2041, "user_id": 6321291, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/25f2ca2f73db77b821c5a5ddb8e54203?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6321291/kevin"}, "reply_to_user": {"reputation": 33, "user_id": 11197733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AHmpNEUbqAc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIkLcQ_jJpbqol-dIAGvU6kfF1IA/mo/photo.jpg?sz=128", "display_name": "DDN1414", "link": "https://stackoverflow.com/users/11197733/ddn1414"}, "edited": false, "score": 0, "creation_date": 1552569051, "post_id": 55148661, "comment_id": 97065740, "body": "Well, the last paragraph is what you want, then.  Break the task down into as small of components/tasks/elements as you can.  If you know how to do one of those, great!  If not, google it.  If you somehow find a portion of the problem that <i>hasn&#39;t</i> got an answer (to be honest, its pretty doubtful) then go ahead and ask that specific question on Stackoverflow."}, {"owner": {"reputation": 2041, "user_id": 6321291, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/25f2ca2f73db77b821c5a5ddb8e54203?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6321291/kevin"}, "reply_to_user": {"reputation": 33, "user_id": 11197733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AHmpNEUbqAc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIkLcQ_jJpbqol-dIAGvU6kfF1IA/mo/photo.jpg?sz=128", "display_name": "DDN1414", "link": "https://stackoverflow.com/users/11197733/ddn1414"}, "edited": false, "score": 0, "creation_date": 1552569171, "post_id": 55148661, "comment_id": 97065828, "body": "By the way, that&#39;s generally how you need to approach programming.  Don&#39;t think of it as &quot;I need to write a program that does XYZ.&quot;  Instead, think, &quot;To accomplish XYZ, I&#39;ll need to first do A, then either B or C, finishing up with D and E.  So, how do I do A?&quot;  The smaller you can break apart your tasks, the better you&#39;ll find yourself doing."}], "tags": [], "owner": {"reputation": 2041, "user_id": 6321291, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/25f2ca2f73db77b821c5a5ddb8e54203?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6321291/kevin"}, "is_accepted": false, "score": 1, "last_activity_date": 1552500633, "creation_date": 1552500633, "answer_id": 55148661, "question_id": 55145555, "link": "https://stackoverflow.com/questions/55145555/vba-quarterly-returns/55148661#55148661", "title": "vba quarterly returns", "body": "<p>Okay, so the first point: StackOverflow isn't a code-writing service.  Asking us, \"Hey, can someone write me something that does X?\" is likely to get you ridiculed/scolded/etc.</p>\n\n<p>That said, I'm going to help you with two building-blocks that might help you get to the finish line on your own.</p>\n\n<p>Prereq: VBA is overused within Excel.  Excel has amazingly powerful abilities just within the formulas.  In this case, you can actually get what you want with zero code, and only one additional (calculated) column.  The reason this is probably a better solution is because Excel docs with VBA macros tend to be disabled (for <em>very</em> good reason) and it becomes a lot harder to see what's being done behind the scenes.  With a calculated column, someone interested in digging behind the numbers can easily see what's going on without having to delve into code.</p>\n\n<p><strong>Building Block #1: Year and Month functions.</strong></p>\n\n<p>If you've got a date column (which you don't right now - you need to change that column to something that actually represents a date object), you can actually get the Quarter by assembling something like:</p>\n\n<pre><code>=YEAR(A1)&amp;\"-Q\"&amp;((MONTH(A1)+2)/3)\n</code></pre>\n\n<p>Basically, the YEAR() function gets the year, and the MONTH() function gets the month number.  From there, I just use some basic math and string-combining to get a result like:</p>\n\n<blockquote>\n  <p>2018-Q2</p>\n</blockquote>\n\n<p><strong>Building Block #2 - CountIf/SumIf/AverageIf</strong></p>\n\n<p>Excel has some really great xxxIf() functions, that will get the average/sum/count/etc for a range, <em>but only for the values that meet a certain criteria.</em></p>\n\n<p>So in your case, if you Sum of all the 2018-Q2 records, you simply use the SUMIF() function to add up all the values, where the entry equals '2018-Q2'.</p>\n\n<p>Hope that helps you out on your task.  If not, I'd actually encourage you to break the problem down into smaller subtasks, google those subtasks - and if you can't find anything for a specific task, ask a question about <em>just</em> that part.  Asking, \"Hey, how do I sum three cells in VBA?\" goes over a lot better than \"Hey, write this function for me\"  :-)</p>\n"}], "owner": {"reputation": 33, "user_id": 11197733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AHmpNEUbqAc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIkLcQ_jJpbqol-dIAGvU6kfF1IA/mo/photo.jpg?sz=128", "display_name": "DDN1414", "link": "https://stackoverflow.com/users/11197733/ddn1414"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1552500633, "creation_date": 1552490881, "last_edit_date": 1552494576, "question_id": 55145555, "link": "https://stackoverflow.com/questions/55145555/vba-quarterly-returns", "title": "vba quarterly returns", "body": "<p>Can anybody tell me a VBA Function or button that would calculate quarterly returns only on a quarterly basis (i.e., first quarter return is based on January till March returns) without overlapping observations.</p>\n\n<p>The function that I'm using now is just the AVERAGE of, for example, returns from January until March, but the actual calculation cell is in April.</p>\n\n<p>An example of what I'm asking is in the picture link. I would like the function to run for the time period that I choose.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dw0BU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dw0BU.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you very much!</p>\n\n<p>edit: I'm asking for help with the code because I'm new to vba so I cannot do it yet on my own.</p>\n\n<p>edit2: The code that I adapted from class is this:</p>\n\n<pre><code> Option Explicit\n\n Public Sub QuarterReturns()\n    Dim rng As Range\n    Set rng = Range(\"B2\")\n    Dim i As Long, n As Long\n\n    n = rng.End(x2Down).Column - rng.Row + 1\n    Set rng = rng.Resize(n, 1)\n\n    Dim returns As Variant\n    returns = rng.Value2\n\n    Dim quarter As Variant\n\n    ReDim quarter(1 To n - 1, 1 To 1)\n    For i = 1 To n - 1\n        ror(i, 1) = prices(i + 1, 1) / prices(i, 1) - 2#\n    Next i\n    rng.Offset(1, 2).Resize(n - 1, 2).Value2 = quarter\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "transpose"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1552496696, "post_id": 55145552, "comment_id": 97035467, "body": "I&#39;d use a dictionary object to collect and organize the data."}, {"owner": {"reputation": 5, "user_id": 7157761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b813fb1da6a21e88918bc021aa66f60?s=128&d=identicon&r=PG&f=1", "display_name": "easan", "link": "https://stackoverflow.com/users/7157761/easan"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1552571344, "post_id": 55145552, "comment_id": 97067486, "body": "I definitely overthought this, but a simple sumif actually does the trick. by comparing the title date on the second sheet to the start/end date columns with the expression [&quot;&lt;=&quot;&amp;Sheet2!D$1 ] &amp; [&quot;&gt;=&quot;&amp;Sheet2!D$1 ] I can get what i need. H/o thanks for your help I&#39;ll check out the dictionary object, might prove useful for other comparisons"}], "owner": {"reputation": 5, "user_id": 7157761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b813fb1da6a21e88918bc021aa66f60?s=128&d=identicon&r=PG&f=1", "display_name": "easan", "link": "https://stackoverflow.com/users/7157761/easan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552494379, "creation_date": 1552490873, "last_edit_date": 1552494379, "question_id": 55145552, "link": "https://stackoverflow.com/questions/55145552/how-do-i-transpose-a-list-of-data-over-a-range-of-dates-to-individual-dates-in-e", "title": "How do I transpose a list of data over a range of dates to individual dates in Excel VBA?", "body": "<p><a href=\"https://docs.google.com/spreadsheets/d/1zoP8MhySQW44HptS0pSxgFVsV-kX2sEHNr6xEe3iXE8/edit?usp=sharing\" rel=\"nofollow noreferrer\">Example SSheet</a></p>\n\n<p>Hello, I have a data analysis problem i'm not sure how to tackle, please see example google sheet. I have a list of data for the cost of products over a date range; The date range is specified by a start and end date column. I need to write a macro which identifies the cost of a specific product for each day in the date range, and match it to a unique product list by day (sheet2). I honestly don't know where to start as my knowledge of VBA is limited, but i do have some familiarity with the language. Would anyone be able to help me figure out a way to tackle this problem? I already have a macro which generates Sheet2, I just need a way to populate it with the information from sheet1. Any help would be enormously appreciated.</p>\n"}, {"tags": ["excel", "vba", "collections"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1552490961, "post_id": 55145329, "comment_id": 97031759, "body": "Your function can&#39;t &quot;see&quot; the <code>Collection</code> <i>(it is out of scope)</i>.  Either pass it as an argument or make it <code>Global</code>."}, {"owner": {"reputation": 8568, "user_id": 837722, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/sKLRI.png?s=128&g=1", "display_name": "Si8", "link": "https://stackoverflow.com/users/837722/si8"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1552491348, "post_id": 55145329, "comment_id": 97032019, "body": "So I updated it and moved the Collection inside the <code>popexcel</code> function and I am still getting the same error"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552491481, "post_id": 55145329, "comment_id": 97032091, "body": "Specify <code>Option Explicit</code>, and you&#39;ll want to pass <code>compreplace</code> to <code>popexcel</code> as a parameter (or promote it to module scope)."}, {"owner": {"reputation": 8568, "user_id": 837722, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/sKLRI.png?s=128&g=1", "display_name": "Si8", "link": "https://stackoverflow.com/users/837722/si8"}, "edited": false, "score": 0, "creation_date": 1552491750, "post_id": 55145329, "comment_id": 97032257, "body": "So if I actually pass a (string) it works but when I use Range(row,col).Value I get that error... I am guessing I have to convert the .Value to a String before passing?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1552491882, "post_id": 55145329, "comment_id": 97032346, "body": "<code>Range.Value</code> is a <code>Variant</code> that can contain any data type, and VBA will happily convert them to a <code>String</code> for you - except if the cell contains an <code>Error</code> value, in which case neither implicit nor explicit conversion will work: you get a type mismatch error if you try to use an <code>Error</code> and compare it or assign it to a <code>String</code>. Use the <code>IsError</code> function to verify whether a variant is a <code>Variant&#47;Error</code>."}, {"owner": {"reputation": 8568, "user_id": 837722, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/sKLRI.png?s=128&g=1", "display_name": "Si8", "link": "https://stackoverflow.com/users/837722/si8"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552492588, "post_id": 55145329, "comment_id": 97032881, "body": "@MathieuGuindon Thanks for your direction."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552491774, "post_id": 55145794, "comment_id": 97032275, "body": "You&#39;ll probably want to make <code>popexcel</code> a <code>Private Function</code>, since there&#39;s temporal coupling going on here (using it without having first invoked <code>popdata</code> would throw an error) -- passing the collection as a parameter would remove the temporal coupling."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552492172, "post_id": 55145794, "comment_id": 97032550, "body": "@MathieuGuindon - I agree. In this case I tried to reuse the original code as much as possible to keep focus on the problem."}, {"owner": {"reputation": 8568, "user_id": 837722, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/sKLRI.png?s=128&g=1", "display_name": "Si8", "link": "https://stackoverflow.com/users/837722/si8"}, "edited": false, "score": 0, "creation_date": 1552492460, "post_id": 55145794, "comment_id": 97032779, "body": "This is working for me. Thank you. What is the difference from what I was doing, just for clarification. Thanks."}, {"owner": {"reputation": 8568, "user_id": 837722, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/sKLRI.png?s=128&g=1", "display_name": "Si8", "link": "https://stackoverflow.com/users/837722/si8"}, "edited": false, "score": 0, "creation_date": 1552492534, "post_id": 55145794, "comment_id": 97032836, "body": "Is there anyway to also add a condition if the value that will goto &quot;L&quot;, then don&#39;t insert it... I guess an if statement will suffice there :)"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 8568, "user_id": 837722, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/sKLRI.png?s=128&g=1", "display_name": "Si8", "link": "https://stackoverflow.com/users/837722/si8"}, "edited": false, "score": 0, "creation_date": 1552492805, "post_id": 55145794, "comment_id": 97033047, "body": "@Si8 - Your code, as you posted it, will work if all values match. If not, you will get the error you posted. I added a function that tests if a value is available before trying to retrieve it. If it doesn&#39;t exist, it does not try."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 8568, "user_id": 837722, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/sKLRI.png?s=128&g=1", "display_name": "Si8", "link": "https://stackoverflow.com/users/837722/si8"}, "edited": false, "score": 0, "creation_date": 1552492845, "post_id": 55145794, "comment_id": 97033082, "body": "@Si8 - I don&#39;t understand your second question (goto &quot;L&quot; etc)."}, {"owner": {"reputation": 8568, "user_id": 837722, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/sKLRI.png?s=128&g=1", "display_name": "Si8", "link": "https://stackoverflow.com/users/837722/si8"}, "edited": false, "score": 0, "creation_date": 1552492927, "post_id": 55145794, "comment_id": 97033141, "body": "Nevermind, it&#39;s not appending the value. It&#39;s actually overwriting what&#39;s there already, The <code>L</code> column so please disregard :)"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1552491516, "creation_date": 1552491516, "answer_id": 55145794, "question_id": 55145329, "link": "https://stackoverflow.com/questions/55145329/how-to-use-a-collection-in-vba-to-update-another-cell-comparing-with-a-value-of/55145794#55145794", "title": "How to use a collection in vba to update another cell comparing with a value of one cell", "body": "<p>There are two problems in your code. The first one is that the collection isn't declared in such a way that both methods can access it. The other problem is that you are not taking care of cases where the address isn't found. Have a look below:</p>\n\n<pre><code>Public compreplace As Collection\n\nSub popdata()    \n    Set compreplace = New Collection\n    compreplace.Add \"AA-\", \"test@yahoo.com\"\n    compreplace.Add \"BB-\", \"test2@yahoo.com\"\n    compreplace.Add \"CC-\", \"test3@yahoo.com\"\n    compreplace.Add \"DD-\", \"test4@yahoo.com\"\n    compreplace.Add \"EE-\", \"test5@yahoo.com\"\n\n    popexcel\n\nEnd Sub\n\nFunction popexcel()\n    Dim rc As Integer\n    rc = ActiveSheet.UsedRange.Rows.Count\n    Dim i As Integer\n\n    For i = 2 To rc\n        If ItemExists(compreplace, Range(\"K\" &amp; i).Value) Then\n            Range(\"L\" &amp; i).Value = compreplace.item(Range(\"K\" &amp; i).Value)\n        End If\n    Next i\nEnd Function\n\n\nFunction ItemExists(coll As Collection, item As String) As Boolean\n    On Error Resume Next\n    coll.item item\n    ItemExists = (Err.Number = 0)\nEnd Function\n</code></pre>\n\n<p>The ItemExists function returns true if there is a matching item. The Public declaration at the top makes it available to your pop method. Not the best way, but it works.</p>\n"}], "owner": {"reputation": 8568, "user_id": 837722, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/sKLRI.png?s=128&g=1", "display_name": "Si8", "link": "https://stackoverflow.com/users/837722/si8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 55145794, "answer_count": 1, "score": 0, "last_activity_date": 1552491516, "creation_date": 1552490243, "last_edit_date": 1552491402, "question_id": 55145329, "link": "https://stackoverflow.com/questions/55145329/how-to-use-a-collection-in-vba-to-update-another-cell-comparing-with-a-value-of", "title": "How to use a collection in vba to update another cell comparing with a value of one cell", "body": "<p>My Excel Sheet: </p>\n\n<p><a href=\"https://i.stack.imgur.com/coTY7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/coTY7.png\" alt=\"enter image description here\"></a></p>\n\n<p>My VBA code:</p>\n\n<pre><code>Sub popdata()\n\n    Set compreplace = New Collection\n    compreplace.Add \"AA-\", \"test@yahoo.com\"\n    compreplace.Add \"BB-\", \"test2@yahoo.com\"\n    compreplace.Add \"CC-\", \"test3@yahoo.com\"\n    compreplace.Add \"DD-\", \"test4@yahoo.com\"\n    compreplace.Add \"EE-\", \"test5@yahoo.com\"\n\n    Call popexcel\n\nEnd Sub\n\nFunction popexcel()\n    Dim rc As Integer\n    rc = UsedRange.Rows.Count\n    Dim i As Integer  \n\n    For i = 2 To rc\n        //fill in \"L\" column value respective to the row\n        //example \"L2\" should have \"AA-\" because \"K2\" value is \"test@yahoo.com\"\n        Range(\"L\" &amp; i).Value = compreplace.Item(Range(\"K\" &amp; i).Value)\n    Next i\nEnd Function\n</code></pre>\n\n<p>However I get the following error in VBA:</p>\n\n<blockquote>\n  <p>Run-time error '5':</p>\n  \n  <p>Invalid procedure call or argument</p>\n</blockquote>\n\n<p>Any idea how to resolve this, would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1552490532, "post_id": 55145294, "comment_id": 97031438, "body": "<code>wsTest.Range(wsTest.Cells(1, 2), wsTest.Cells(5, 2))</code> - you need to add the worksheet to both uses of <code>Cells()</code>.  Also, did you change it for ease of reading here on SO, or is the sheet literally called <code>WorkSheetName</code>?"}, {"owner": {"reputation": 3, "user_id": 3523335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14712727ded76d57f2f7788a0470fa8e?s=128&d=identicon&r=PG&f=1", "display_name": "julian", "link": "https://stackoverflow.com/users/3523335/julian"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1552494155, "post_id": 55145294, "comment_id": 97033947, "body": "Thanks, I forgot to add the worksheet to both uses of Cells(). I edited it, but it doesn&#39;t change anything about my problem. In my minimal example (that I also tested), the worksheet is literally called &quot;WorkSheetName&quot;, but I get the same error with any other name."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1552494506, "post_id": 55145294, "comment_id": 97034158, "body": "First, what do you mean by a range of <code>Z1S1:Z2S51</code>??  Also, for a quick test, can you <code>Dim rngFormulaTest as Range &#47;&#47; Set rngFormulaTest = Worksheets(&quot;WorkSheetName&quot;).Range(&quot;A1:A22&quot;) &#47;&#47; ... &#47;&#47; Formula1:= rngFormulaTest</code>. Does that throw an error?"}, {"owner": {"reputation": 3, "user_id": 3523335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14712727ded76d57f2f7788a0470fa8e?s=128&d=identicon&r=PG&f=1", "display_name": "julian", "link": "https://stackoverflow.com/users/3523335/julian"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1552497882, "post_id": 55145294, "comment_id": 97036196, "body": "Thanks to your questions I found the source of the problem. Thanks! The Format of Formula1 needs to be a string and can&#39;t be just the Range object. (<a href=\"https://stackoverflow.com/questions/22956604/how-to-add-data-validation-to-a-cell-using-vba\" title=\"how to add data validation to a cell using vba\">stackoverflow.com/questions/22956604/&hellip;</a>)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1552498209, "post_id": 55145294, "comment_id": 97036358, "body": "I believe <code>Formula1</code> can be a range object.  However, glad to see it was solved. You needed it in <code>R1C1</code> format, which is what you noticed when &quot;translating&quot; it from German."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 3523335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14712727ded76d57f2f7788a0470fa8e?s=128&d=identicon&r=PG&f=1", "display_name": "julian", "link": "https://stackoverflow.com/users/3523335/julian"}, "is_accepted": true, "score": 0, "last_activity_date": 1552497644, "creation_date": 1552497644, "answer_id": 55147822, "question_id": 55145294, "link": "https://stackoverflow.com/questions/55145294/how-to-add-data-validation-from-range-with-numeric-columns-vba/55147822#55147822", "title": "How to add data validation from range with numeric columns VBA", "body": "<p>Thanks to the questions of @BruceWayne I was able to solve my issue.</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>Replace</p>\n\n<pre><code>Formula1:=\"=WorkSheetName!Z1S1:Z22S1\"\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Formula1:=\"=WorkSheetName!R1C1:R22C1\"\n</code></pre>\n\n<p><strong>Source of my Problem:</strong></p>\n\n<p>My office package is in German, so when I reference to Rows and Columns in excel, I reference to <strong>Z</strong>eilen and <strong>S</strong>palten. That's what Z1S1:Z2S51 means. By changing my office package to English I figured out how to reference properly to numerical Columns.</p>\n\n<p><strong>Remark</strong>:\nRange.Adress always gives me alphabetical columns back.</p>\n"}], "owner": {"reputation": 3, "user_id": 3523335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14712727ded76d57f2f7788a0470fa8e?s=128&d=identicon&r=PG&f=1", "display_name": "julian", "link": "https://stackoverflow.com/users/3523335/julian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 55147822, "answer_count": 1, "score": 0, "last_activity_date": 1552497644, "creation_date": 1552490091, "last_edit_date": 1552494616, "question_id": 55145294, "link": "https://stackoverflow.com/questions/55145294/how-to-add-data-validation-from-range-with-numeric-columns-vba", "title": "How to add data validation from range with numeric columns VBA", "body": "<p>I want to add \"data validation\" including a drop down menu to some cells in a Workbook that uses numeric columns. I only managed to do it with alphabetical columns.</p>\n\n<p>When I execute the following code I get the error message \"1004\" and the macro stops at the line with the Formula1 (excel settings to numerical columns):</p>\n\n<pre><code>Sub foo_numeric()\n  Dim rngTest As Range 'Range where the Data validation should be applied\n  Dim wsTest As Worksheet\n\n  Set wsTest = Worksheets(\"WorkSheetName\")\n  Set rngTest = wsTest.Range(wsTest.Cells(1, 2), wsTest.Cells(5, 2))\n\n  With rngTest.Validation\n    .Delete\n    .Add Type:=xlValidateList, _\n       Formula1:=\"=WorkSheetName!Z1S1:Z22S1\"\n  End With\nEnd Sub\n</code></pre>\n\n<p>When I switch the settings to alphabetical columns and execute the following code, I get no error message and the macro works smoothly:</p>\n\n<pre><code>Sub foo_alphabetical()\n    Dim rngTest As Range 'Range where the Data validation should be applied\n    Dim wsTest As Worksheet\n\n    Set wsTest = Worksheets(\"WorkSheetName\")\n    Set rngTest = wsTest.Range(\"B1:B5\")\n\n    With rngTest.Validation\n     .Delete\n     .Add Type:=xlValidateList, _\n         Formula1:=\"=WorkSheetName!$A$1:$A$22\"\n    End With    \nEnd Sub\n</code></pre>\n\n<p>Is there some error in my code that I missed? How can I use data validation with numerical columns?</p>\n\n<p>Remark: To put a String with the possible options into Formula1 is not an option as the string would be too big.</p>\n"}, {"tags": ["excel", "vba", "indentation", "data-cleaning"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1552490167, "post_id": 55145291, "comment_id": 97031163, "body": "Use the <code>IndentLevel</code> property, if they are true indentations."}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1552492544, "post_id": 55145291, "comment_id": 97032846, "body": "In order to count the number of spaces in front of a string, you can calculate the length which is subtracted by the <code>LTrim()</code> worksheet function: <code>Len(S) - Len(LTrim(S))</code>: if <code>S</code> equals `   AA<code>, then </code>Len(S)<code>=5, </code>LTrim(S)<code>=&quot;AA&quot;, </code>Len(LTrim(S))`=2, so the difference is 3."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1552492916, "post_id": 55145291, "comment_id": 97033135, "body": "see  <a href=\"https://professor-excel.com/how-to-return-the-indentation-of-a-cell-in-excel/\" rel=\"nofollow noreferrer\">professor-excel.com/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 11197903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56605d14267c0ee04a059b4c39ad9743?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFarmer", "link": "https://stackoverflow.com/users/11197903/coffeefarmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552491557, "creation_date": 1552490086, "last_edit_date": 1552491557, "question_id": 55145291, "link": "https://stackoverflow.com/questions/55145291/vba-code-to-move-cells-if-they-contain-a-specific-indent", "title": "VBA Code to move cells if they contain a specific indent", "body": "<p>I am looking to write a code in VBA to sort my data into adjacent columns based on their level of indentation. I managed to write a code that works properly based on the number of spaces beginning in the cell, however I cannot seem to find a way to move them based on indentation. Here is the code that I have written so far:</p>\n\n<pre><code>Sub Movecellindent()\nDim row As Long\n\nFor row = 3 To 3000\n    'cells that begin with 15 spaces are moved to column D\n    If Range(\"A\" &amp; row).Value Like \"               *\" Then\n        Range(\"D\" &amp; row).Value = Range(\"A\" &amp; row).Value\n        Range(\"A\" &amp; row).Value = \"\"\n    End If\nNext\nFor row = 3 To 3000\n    'cells beginning with 12 spaces are moved to column C\n    If Range(\"A\" &amp; row).Value Like \"            *\" Then\n        Range(\"C\" &amp; row).Value = Range(\"A\" &amp; row).Value\n        Range(\"A\" &amp; row).Value = \"\"\n    End If\nNext\nFor row = 3 To 3000\n    'cells beginning with 10 spaces are moved to column B\n    If Range(\"A\" &amp; row).Value Like \"          *\" Then\n        Range(\"B\" &amp; row).Value = Range(\"A\" &amp; row).Value\n        Range(\"A\" &amp; row).Value = \"\"\n    End If\nNext\n</code></pre>\n\n<p>Instead of the code written above, I want the code to perform the same action but with 3, 2 and 1 indents, respectively.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "sorting", "random"], "comments": [{"owner": {"reputation": 1, "user_id": 11193167, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bZbsyPAEnyk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcKlN0mU09XcGIMeFs9k9oVuCtdmQ/mo/photo.jpg?sz=128", "display_name": "Borit", "link": "https://stackoverflow.com/users/11193167/borit"}, "edited": false, "score": 0, "creation_date": 1552490039, "post_id": 55145120, "comment_id": 97031076, "body": "I just noticed that the code isn&#39;t working properly yet, I thought it would remove all the duplicate combinations but I still see duplicate combinations when I run the code. Anyone know how to solve this?"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1552490166, "post_id": 55145120, "comment_id": 97031162, "body": "<a href=\"https://stackoverflow.com/questions/55128759/if-cell-a1-is-certain-value-then-b1-is-random-between-two-values\" title=\"if cell a1 is certain value then b1 is random between two values\">stackoverflow.com/questions/55128759/&hellip;</a> looks like similar code..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11193167, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bZbsyPAEnyk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcKlN0mU09XcGIMeFs9k9oVuCtdmQ/mo/photo.jpg?sz=128", "display_name": "Borit", "link": "https://stackoverflow.com/users/11193167/borit"}, "edited": false, "score": 0, "creation_date": 1552490509, "post_id": 55145290, "comment_id": 97031418, "body": "Thank you for this. I want to remove duplicates and I want to order the first column in ascending order, they have to represent test samples so duplicates should be left out, and they have to be in order so that the test sampling happens from start to end. I tried your code and it seems to work! No duplicates and everything is in order."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 0, "last_activity_date": 1552490084, "creation_date": 1552490084, "answer_id": 55145290, "question_id": 55145120, "link": "https://stackoverflow.com/questions/55145120/sorting-random-table-using-vba/55145290#55145290", "title": "Sorting random table using VBA", "body": "<p>You want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid the use of Activate and Select</a> in your macros</p>\n\n<p>Before doing the remove duplicates, you need to convert the result of the formulas into actual values, since sorting <code>RANDBETWEEN</code> formulas will only result in new random numbers:</p>\n\n<pre><code>Range(\"A2:A38\").Formula = \"=RANDBETWEEN(1,12)\"\n\nRange(\"B2:B38\").Formula = \"=RANDBETWEEN(1,INDEX({2,2,8,8,8,8,4,2,8,10,4,8},A2))\"\n\nRange(\"A2:B38\").Value = Range(\"A2:B38\").Value\n\nActiveSheet.Range(\"$A$2:$B$38\").RemoveDuplicates Columns:=Array(1, 2), Header:=xlNo\n</code></pre>\n\n<p>It's also not clear to me if you want to sort the values (as mentioned in the title of your question, or remove duplicates (which is what your code does)</p>\n"}], "owner": {"reputation": 1, "user_id": 11193167, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bZbsyPAEnyk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcKlN0mU09XcGIMeFs9k9oVuCtdmQ/mo/photo.jpg?sz=128", "display_name": "Borit", "link": "https://stackoverflow.com/users/11193167/borit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552490084, "creation_date": 1552489557, "question_id": 55145120, "link": "https://stackoverflow.com/questions/55145120/sorting-random-table-using-vba", "title": "Sorting random table using VBA", "body": "<p>I have a vba code to generate random values and then generate random values to the generated random values. I put these in a table and I want to sort them in ascending order, based on the random values in the first column. However, I have used several codes and tried it but I get an error everytime. Anyone knows how to solve this? My code is as follows:</p>\n\n<pre><code>Sub Button1_Click()\n\nRange(\"A2:A38\").Select\n ActiveSheet.Range(\"$A$2:$A$38\").Value = \"=RANDBETWEEN(1,12)\"\n\n Range(\"B2:B38\").Select\n ActiveSheet.Range(\"$B$2:$B$38\").Value = \"=RANDBETWEEN(1,INDEX({2,2,8,8,8,8,4,2,8,10,4,8},A2))\"\n\nApplication.Calculate\n\nRange(\"A2:B38\").Select\n ActiveSheet.Range(\"$A$2:$B$38\").RemoveDuplicates Columns:=Array(1, 2), Header:=xlNo\n\n\n\n ActiveWorkbook.Save\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "export", "recordset"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1552491306, "post_id": 55145089, "comment_id": 97031980, "body": "If you edit the Excel cell, are the decimals still missing?"}, {"owner": {"reputation": 49, "user_id": 4692182, "user_type": "registered", "profile_image": "https://graph.facebook.com/1043584858989169/picture?type=large", "display_name": "Guilherme Brum", "link": "https://stackoverflow.com/users/4692182/guilherme-brum"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1552494798, "post_id": 55145089, "comment_id": 97034333, "body": "yes. the excel file comes with 2 decimals. in Access is showing 0.3193 if I change format in excel it will be 0.3200"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1552504976, "post_id": 55145089, "comment_id": 97039843, "body": "Do you change the format in Excel before or after the export?"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1552519959, "last_edit_date": 1552519959, "creation_date": 1552519623, "answer_id": 55152662, "question_id": 55145089, "link": "https://stackoverflow.com/questions/55145089/ms-access-openrecordset-rounding-decimals/55152662#55152662", "title": "MS ACCESS OpenRecordset rounding decimals", "body": "<p>Interesting, I can reproduce this. It happens because the columns are of type <code>Currency</code>.</p>\n\n<p>Apparently, Excel as usual wants to be more clever than is good for you, and assumes that Currency always comes with two decimals and rounds to that.</p>\n\n<p>To easily reproduce, use this code:</p>\n\n<pre><code>With xlSheet\n    i = 7\n    .Range(\"F\" &amp; i).Value = CDbl(1.2345)    ' Result: 1.2345\n    .Range(\"G\" &amp; i).Value = CCur(1.2345)    ' Result: 1.23 \u20ac\nEnd With\n</code></pre>\n\n<p>Note that <code>CCur(1.2345)</code> in Access is still <code>1.2345</code>.</p>\n\n<p>To solve it, convert to <code>Double</code> before writing to Excel, and afterwards <strong>format</strong> as Currency in Excel (with 2 or 4 decimals, in both cases the number will actually have all 4 decimals):</p>\n\n<pre><code>        With .Range(\"C\" &amp; i)\n            .Value = CDbl(Nz(rs1!PreviousPrice, 0))\n            .NumberFormat = \"#,##0.0000 $\"\n        End With\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4692182, "user_type": "registered", "profile_image": "https://graph.facebook.com/1043584858989169/picture?type=large", "display_name": "Guilherme Brum", "link": "https://stackoverflow.com/users/4692182/guilherme-brum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 55152662, "answer_count": 1, "score": 1, "last_activity_date": 1552519959, "creation_date": 1552489461, "last_edit_date": 1552519817, "question_id": 55145089, "link": "https://stackoverflow.com/questions/55145089/ms-access-openrecordset-rounding-decimals", "title": "MS ACCESS OpenRecordset rounding decimals", "body": "<p>I have a query that is showing the price for my products and comparing with previous months. The query within Access is showing the prices correctly with 4 decimal places but when I export to Excel with code below the numbers are rounded to 2 decimal places.\nMy code has many formatting lines that I omitted. Please note that I am not formatting the price in the excel. I want to show the entire number.\nI think the Recordset function is somehow rounding the number.\nI appreciate the help. Thank you</p>\n\n<pre><code>            Dim xlApp As Object\n            Dim xlBook As Object\n            Dim xlSheet As Object\n            Dim i As Integer\n\n            Dim SQL As String\n            Dim rs1 As DAO.Recordset\n\n SQL = \"SELECT tblTempCurrentPastRawPrice.ID, tblTempCurrentPastRawPrice.[Raw Material],\" &amp; _\n        \"tblTempCurrentPastRawPrice.Lastbought, tblTempCurrentPastRawPrice.PreviousPrice,\" &amp; _\n        \"tblTempCurrentPastRawPrice.Newdate, tblTempCurrentPastRawPrice.LastPrice,\" &amp; _\n        \"tblTempCurrentPastRawPrice.ReportDate FROM tblTempCurrentPastRawPrice ORDER BY tblTempCurrentPastRawPrice.[Raw Material]\"\n\n\n        Set rs1 = CurrentDb.OpenRecordset(SQL, dbOpenSnapshot)\n\n\n Set xlApp = CreateObject(\"Excel.Application\")\n\n            xlApp.Visible = False\n            Set xlBook = xlApp.Workbooks.Add\n            Set xlSheet = xlBook.Worksheets(1)\n\n    With xlSheet\n\n   i = 7    \n\n            Do While Not rs1.EOF\n\n\n                .Range(\"A\" &amp; i).Value = Nz(rs1![Raw Material], \"\")\n                .Range(\"B\" &amp; i).Value = Nz(rs1!Lastbought, \"\")\n                .Range(\"C\" &amp; i).Value = Nz(rs1!PreviousPrice, 0)\n                .Range(\"D\" &amp; i).Value = Nz(rs1!Newdate, 0)\n                .Range(\"E\" &amp; i).Value = Nz(rs1!LastPrice, 0)\n\n                i = i + 1\n                rs1.MoveNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1552489826, "post_id": 55144965, "comment_id": 97030933, "body": "<code>GoTo Retry</code> isn&#39;t resetting the error state, so a second error would bubble up the call stack and crash the program. Needs to be <code>Resume Retry</code>"}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552490039, "post_id": 55144965, "comment_id": 97031078, "body": "Good catch, Noted Thanks."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552490444, "post_id": 55144965, "comment_id": 97031371, "body": "Does it have to be a &quot;form control&quot;? Looks like what you want is ActiveX controls."}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552491627, "post_id": 55144965, "comment_id": 97032176, "body": "No It is form control, I had Activex control. By Activex control it is pretty simple as I can get the text value of the combo box. I prefer to use form control. The first code is working fine. I just was looking a more direct way if available."}], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552490406, "creation_date": 1552489117, "last_edit_date": 1552490406, "question_id": 55144965, "link": "https://stackoverflow.com/questions/55144965/getting-the-list-values-from-form-controls", "title": "Getting the List values from Form Controls", "body": "<p>I have a dropdown Form Control in my Excel sheet. Its input range is a named range, which contains another named ranges. I wanted after change user be redirected to selected name range. I have difficulties with Directly getting Selected name ranges from dropdown control. All I get is list value of the dronwdown control. I did a workaround thought and select the appropriate cell from the main Named range, but I am wondering there should be a way to directly get the string value of selected item. Here is my code and the one I already tried.   </p>\n\n<blockquote>\n  <p>** this works:</p>\n</blockquote>\n\n<pre><code>Sub GotoNames()\nDim rng As Range, T As Range\n    Set rng = ThisWorkbook.Sheets(\"Panel\").Range(\"NamedRng\")\n    On Error GoTo errr\nRetry:\n    With ThisWorkbook.Sheets(\"Result\").DropDowns(1)\n       Set T = rng(.Value)\n       Application.Goto T.Value2\n    End With\n    Exit Sub\nerrr:\n    If T.Worksheet.Visible = xlSheetHidden Then\n        T.Worksheet.Visible = xlSheetVisible\n        resume Retry\n    End If\nEnd Sub\n</code></pre>\n\n<p>But I wanted: </p>\n\n<pre><code>Sub GotoNames()\n'On Error Resume Next\n    With ThisWorkbook.Sheets(\"Result\").DropDowns(1)\n        Application.Goto .ControlFormat.List(.ControlFormat.ListIndex) 'OR\n        Application.Goto .ListFillRange(.value)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "wildcard", "vb-like-operator"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1552488748, "post_id": 55144780, "comment_id": 97030114, "body": "Boolean condition = Like condition 1 or Like condition 2 or Like condition3 ...etc.  If (condition) EntireRow.Delete."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1552488851, "post_id": 55144780, "comment_id": 97030181, "body": "Note - the way you have this, and perhaps it&#39;s what you need, but If <code>Cells(2,4)</code> has <code>SSI</code>, then it&#39;ll delete the row.  Then it will look <b>again</b> at <code>Cells(2,4)</code>, check if it has <code>Settlement instruction</code> in there, and if so, delete, then look <b>again</b> for the next ...etc."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "edited": false, "score": 0, "creation_date": 1552489606, "post_id": 55144780, "comment_id": 97030767, "body": "there is also the <code>VBA.Filter()</code> function. <a href=\"https://www.tutorialspoint.com/vba/vba_filter_function.htm\" rel=\"nofollow noreferrer\">see here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1552489524, "post_id": 55145045, "comment_id": 97030715, "body": "You could use a range in excel to populate the array <code>a</code> also, and use the <code>r</code> range to populate the start and end of the loops."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1552489354, "creation_date": 1552489354, "answer_id": 55145045, "question_id": 55144780, "link": "https://stackoverflow.com/questions/55144780/vba-how-to-use-like-operator-to-a-list-of-value/55145045#55145045", "title": "VBA: How to use like operator to a list of value?", "body": "<p>You could try something along these lines</p>\n\n<pre><code>Sub del()\n\nDim a As Variant\nDim s As Variant\nDim r As Range\nDim l As Long\n\na = Array(\"*abc*\", \"*def*\", \"efg*\", \"abcdef*hi\")\nSet r = Range(\"a1:a20\")\n\nFor l = r.Rows.Count To 1 Step -1\n\n    For Each s In a\n        If r.Cells(l, 1).Value Like s Then\n                Rows(l).EntireRow.Delete\n                Exit For\n        End If\n    Next s\n\nNext l\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9087660, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtHzoUagaRo/AAAAAAAAAAI/AAAAAAAAAB0/J_g0dx9K3fg/photo.jpg?sz=128", "display_name": "ScJ Mong", "link": "https://stackoverflow.com/users/9087660/scj-mong"}, "edited": false, "score": 0, "creation_date": 1552490914, "post_id": 55145059, "comment_id": 97031726, "body": "How should I define tmpAr? Variant? string? Thank you."}, {"owner": {"reputation": 21, "user_id": 9087660, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtHzoUagaRo/AAAAAAAAAAI/AAAAAAAAAB0/J_g0dx9K3fg/photo.jpg?sz=128", "display_name": "ScJ Mong", "link": "https://stackoverflow.com/users/9087660/scj-mong"}, "edited": false, "score": 0, "creation_date": 1552491894, "post_id": 55145059, "comment_id": 97032356, "body": "and also test? I&#39;m not familiar with range. Thank you"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 21, "user_id": 9087660, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtHzoUagaRo/AAAAAAAAAAI/AAAAAAAAAB0/J_g0dx9K3fg/photo.jpg?sz=128", "display_name": "ScJ Mong", "link": "https://stackoverflow.com/users/9087660/scj-mong"}, "edited": false, "score": 0, "creation_date": 1552493266, "post_id": 55145059, "comment_id": 97033383, "body": "Declarations added in the answer. Create them as <code>Variant</code> and the <code>Split</code> and <code>For each..</code> does the rest."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 2, "last_activity_date": 1552493212, "last_edit_date": 1552493212, "creation_date": 1552489388, "answer_id": 55145059, "question_id": 55144780, "link": "https://stackoverflow.com/questions/55144780/vba-how-to-use-like-operator-to-a-list-of-value/55145059#55145059", "title": "VBA: How to use like operator to a list of value?", "body": "<p>There's lots of ways to do this, but here is one:</p>\n\n<p>Firstly, when deleting rows, always start at the bottom of the range and move up - this prevents row skipping when deletions take place.</p>\n\n<p>I've created an array by splitting the text out using commas. If your data possibly contains a comma, you'll need to change it.</p>\n\n<pre><code>Dim tmpAr As Variant\nDim test As Variant\n\nSet ws = ActiveSheet\ntmpAr = Split(\"SSI,Settlement instruction,delivery Instruction,Request form,Sales to onboarding,Application,Doc Check list,Prime to Credit,Prime to Legal,Prime_Legal,Prime_Credit,LEXIS,Withdrawal Request\", \",\")\nFor i = ws.Range(\"E1\").CurrentRegion.Rows.Count To 2 Step -1\n    For Each test In tmpAr\n        If ws.Cells(i, 4).Value Like \"*\" &amp; test &amp; \"*\" Then\n            ws.Cells(i, 4).EntireRow.Delete\n            Exit For\n        End If\n    Next\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1552555306, "last_edit_date": 1552555306, "creation_date": 1552489428, "answer_id": 55145076, "question_id": 55144780, "link": "https://stackoverflow.com/questions/55144780/vba-how-to-use-like-operator-to-a-list-of-value/55145076#55145076", "title": "VBA: How to use like operator to a list of value?", "body": "<p><strong>Please note:</strong></p>\n\n<ol>\n<li>When row is deleted, cells will shift up so row below will effectively have the same row number, which is why I used do loop instead with <code>i = i - 1</code> after deleting row /e: yes I could have used step -1 or write it differently but wanted to show something different than other answers</li>\n<li>There's no need to use like operator as well, it is not supported in vbs so if you ever decide to learn vbs, it's a good practise to avoid it</li>\n</ol>\n\n<p>Here's my approach, you can keep adding more keywords to the array, or create collection instead:</p>\n\n<pre><code>MyArr = Array(\"SSI\", \"Settlement instruction\", \"delivery Instruction\", \"Request form\", \"Sales to onboarding\", \"Application\", \"Doc Check list\", \"Prime to Credit\", \"Prime to Legal\", \"Prime_Legal\", \"Prime_Credit\", \"LEXIS\", \"Withdrawal Request\")\n\nLastRow = ws.Range(\"E1\").CurrentRegion.Rows.count\ni = 1\nDo Until i &gt; LastRow\n    i = i + 1\n    cVal = ws.Cells(i, 4).Value\n    For Each ma In MyArr\n        If InStr(1, cVal, ma) &gt; 0 Then\n            ws.Cells(i, 4).EntireRow.Delete\n            i = i - 1 'cells below will shift up, so next row will have the same row number\n            Exit For\n        End If\n    Next\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1552489818, "creation_date": 1552489818, "answer_id": 55145209, "question_id": 55144780, "link": "https://stackoverflow.com/questions/55144780/vba-how-to-use-like-operator-to-a-list-of-value/55145209#55145209", "title": "VBA: How to use like operator to a list of value?", "body": "<ol>\n<li>run the loop backwards</li>\n<li>avoid recalculations</li>\n<li>only delete once</li>\n</ol>\n\n<p><br></p>\n\n<pre><code>For i = ws.Range(\"E1\").CurrentRegion.Rows.Count To 2 Step -1\n    DR = False\n    Set r = ws.Cells(i, 4)\n    s = r.Value\n    If s Like (\"*SSI*\") Then DR = True\n    If s Like (\"*Settlement instruction*\") Then DR = True\n    If s Like (\"*delivery Instruction*\") Then DR = True\n    If s Like (\"*Request form*\") Then DR = True\n    If s Like (\"*Sales to onboarding*\") Then DR = True\n    If s Like (\"*Application*\") Then DR = True\n    If s Like (\"*Doc Check list*\") Then DR = True\n    If s Like (\"*Prime to Credit*\") Then DR = True\n    If s Like (\"*Prime to Legal*\") Then DR = True\n    If s Like (\"*Prime_Legal*\") Then DR = True\n    If s Like (\"*Prime_Credit*\") Then DR = True\n    If s Like (\"*LEXIS*\") Then DR = True\n    If s Like (\"*Withdrawal Request*\") Then DR = True\n    If DR Then ws.Cells(i, 4).EntireRow.Delete\nNext i\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9087660, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtHzoUagaRo/AAAAAAAAAAI/AAAAAAAAAB0/J_g0dx9K3fg/photo.jpg?sz=128", "display_name": "ScJ Mong", "link": "https://stackoverflow.com/users/9087660/scj-mong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1553883395, "creation_date": 1552488614, "last_edit_date": 1553883395, "question_id": 55144780, "link": "https://stackoverflow.com/questions/55144780/vba-how-to-use-like-operator-to-a-list-of-value", "title": "VBA: How to use like operator to a list of value?", "body": "<p>Here's part of my code. Is there any way to make it simple? Thank you.</p>\n\n<pre><code>For i = 2 To ws.Range(\"E1\").CurrentRegion.Rows.Count\n\nIf ws.Cells(i, 4).Value Like (\"*SSI*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*Settlement instruction*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*delivery Instruction*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*Request form*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.cells(i, 4).Value Like (\"*Sales to onboarding*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*Application*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*Doc Check list*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*Prime to Credit*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*Prime to Legal*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*Prime_Legal*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*Prime_Credit*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*LEXIS*\") Then ws.Cells(i, 4).EntireRow.Delete\nIf ws.Cells(i, 4).Value Like (\"*Withdrawal Request*\") Then ws.Cells(i, 4).EntireRow.Delete\n\nNext i\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1552488570, "post_id": 55144639, "comment_id": 97029979, "body": "move the <code>taxmount  = ...</code> onto a new line"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1552488712, "post_id": 55144639, "comment_id": 97030084, "body": "See top-voted answer in linked duplicate"}], "answers": [{"tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 0, "last_activity_date": 1552488633, "creation_date": 1552488633, "answer_id": 55144785, "question_id": 55144639, "link": "https://stackoverflow.com/questions/55144639/why-does-my-elseif-function-not-work-errormessage-compile-error-else-without/55144785#55144785", "title": "Why does my Elseif function not work? Errormessage: Compile Error: Else without if", "body": "<p>You forgot some brackets and apparently, the command from the <code>then</code> must be placed at a new line:</p>\n\n<pre><code>If (income &lt;= 12000) Then\n  taxamount = income * 0.12\nElseIf (income &lt;= 20000) Then\n  taxamount = income * 0.15\nElseIf (income &lt;= 30000) Then\n  taxamount = income * 0.2\nElse:\n  taxamount = income * 0.25\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11197793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66bd7e7f5df0db4d6c3f87e522f4d17?s=128&d=identicon&r=PG&f=1", "display_name": "Jesperr", "link": "https://stackoverflow.com/users/11197793/jesperr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "closed_date": 1552488674, "answer_count": 1, "score": 0, "last_activity_date": 1552488633, "creation_date": 1552488237, "last_edit_date": 1552488625, "question_id": 55144639, "link": "https://stackoverflow.com/questions/55144639/why-does-my-elseif-function-not-work-errormessage-compile-error-else-without", "closed_reason": "Duplicate", "title": "Why does my Elseif function not work? Errormessage: Compile Error: Else without if", "body": "<pre><code>Sub exercise2d()\n\nDim taxamount As String\nDim income As String\n\nRange(\"A10:A11\").NumberFormatLocal = \"##.#0,00 ?\"\nincome = Range(\"A10\").Value\n\nIf income &lt;= 12000 Then taxamount = income * 0.12\nElseIf income &lt;= 20000 Then taxamount = income * 0.15\nElseIf income &lt;= 30000 Then taxamount = income * 0.2\nElse: taxamount = income * 0.25\nEnd If\n\nRange(\"A11\").Value = taxamount\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 952, "user_id": 1216790, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/819ce5d5a70cbb57ac2db6854f9d5670?s=128&d=identicon&r=PG", "display_name": "GWD", "link": "https://stackoverflow.com/users/1216790/gwd"}, "edited": false, "score": 3, "creation_date": 1552488643, "post_id": 55144542, "comment_id": 97030036, "body": "Do you maybe have AutoSave running in the background? Also mixing ThisWorkbook and ActiveWorkbook might be an issue \u2026 just educated guesses"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 1, "creation_date": 1552489180, "post_id": 55144542, "comment_id": 97030426, "body": "There might be an issue in Column 9 if any data cant be converted to your number format, such as a header."}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1552489505, "post_id": 55144542, "comment_id": 97030698, "body": "@ZackE &amp; Mathieu, thank you both for these suggestions. I will definitely address the <code>ThisWorkbook</code> vs <code>ActiveWorkbook</code>, and I will make an adjustment to factor in the header. I&#39;m not entirely sure how to determine is AutoSave is running in the background, but I thought the <code>EnableEvents = False</code> would stop that from occurring?"}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553088823, "post_id": 55144542, "comment_id": 97255291, "body": "I have updated to use only <code>ThisWorkbook</code> and not <code>ActiveWorkbook</code>, and I have also factored in the header as @ZackE proposed. So far the issue has not reoccured. I will post an answer with the updated code based on the above comments and mark as answered. If this issue occurs again then I will post a new thread if I cannot figure it out on my own. Thank you both for your advice!"}], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "is_accepted": true, "score": 0, "last_activity_date": 1553089049, "creation_date": 1553089049, "answer_id": 55262052, "question_id": 55144542, "link": "https://stackoverflow.com/questions/55144542/macro-enabled-file-stops-working-and-crashes-when-any-action-taken/55262052#55262052", "title": "Macro-Enabled File Stops Working And Crashes When Any Action Taken", "body": "<p>As Zack &amp; GWD advised in the comments, I updated the VBA to factor in the header row and set all references to <code>ThisWorkbook</code> instead of including <code>ActiveWorkbook</code>. So far the error has not occurred again. If it does happen in the future, I will post a new question if I cannot solve the issue.</p>\n\n<p>Here is the updated code for reference:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nApplication.EnableEvents = False\nCancel = True\n\nDim Lastrow As Integer\nLastrow = ThisWorkbook.Sheets(\"Pending\").Cells(Rows.Count, 9).End(xlUp).Row\n\nThisWorkbook.Sheets(\"Pending\").Range(\"I2:I\" &amp; Lastrow).NumberFormat = \"@\"\nThisWorkbook.Save\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 0, "accepted_answer_id": 55262052, "answer_count": 1, "score": 0, "last_activity_date": 1553089049, "creation_date": 1552487990, "last_edit_date": 1552490255, "question_id": 55144542, "link": "https://stackoverflow.com/questions/55144542/macro-enabled-file-stops-working-and-crashes-when-any-action-taken", "title": "Macro-Enabled File Stops Working And Crashes When Any Action Taken", "body": "<p>So this is strange to me, but I have a macro-enabled excel 2016 file. The only macro in the file is a <code>BeforeSave</code> event, which is stored in <code>ThisWorkbook</code>. After using the blank file once or twice, it gets to the point where opening the file and doing anything at all, like clicking <code>File</code> or <code>Developer</code> or entering data, causes excel to \"Stop Working\" and close.</p>\n\n<p>Below is the <code>BeforeSave</code> event which is the only macro in this file (there are no modules or userforms, nothing else in <code>ThisWorkbook</code>).</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nApplication.EnableEvents = False\nCancel = True\n\nThisWorkbook.Sheets(\"Pending\").Columns(9).NumberFormat = \"@\"\nActiveWorkbook.Save\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>This basic macro event will work perfectly for a few times. Then after some data is in the file, the next time it is opened the issue will occur. This is the only excel file that experiences this crash, I can still open the original backup file with this macro that does not have data in it yet, and it will be okay.</p>\n\n<p>I have tried opening the file in Safe Mode, and I have installed all the latest Microsoft Office updates. </p>\n\n<p>Has anyone else experienced an issue like this? Does it have something to do with the <code>BeforeSave</code> event macro?</p>\n\n<p><strong>UPDATE:</strong>\nI changed the <code>ActiveWorkbook</code> to <code>ThisWorkbook</code>. Also, I have changed from editing the entire column to now finding the last used row and formatting that range excluding the header row.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nApplication.EnableEvents = False\nCancel = True\n\nDim Lastrow As Integer\nLastrow = ThisWorkbook.Sheets(\"Pending\").Cells(Rows.Count, 9).End(xlUp).Row\n\nThisWorkbook.Sheets(\"Pending\").Range(\"I2:I\" &amp; Lastrow).NumberFormat = \"@\"\nThisWorkbook.Save\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1552488095, "post_id": 55144443, "comment_id": 97029634, "body": "If those 350 values are fixed then store them in a sheet and read them into an array and then use that array to compare in a loop instead of writing 350 <code>IF</code> lines"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552490907, "post_id": 55144443, "comment_id": 97031722, "body": "If <code>Cells(i, &quot;AC&quot;).Value</code> is going to be set to <code>EU</code> (or should that be <code>&quot;EU&quot;</code>?) regardless of what the value is, why even have <i>one</i> conditional? Consider using a <i>data validation list</i> in column D, to restrict the values to legal ones (which you store in a separate table with 350 rows, then define a named range to enclose the column that contains the 350 values, and use that named range as your &quot;list&quot; for data validation. Bam, a thousand lines of code gone."}], "answers": [{"tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1552488802, "creation_date": 1552488802, "answer_id": 55144848, "question_id": 55144443, "link": "https://stackoverflow.com/questions/55144443/using-loop-and-if-elseif-resulting-in-message-couldnt-find-what-i-am-looki/55144848#55144848", "title": "Using Loop and If, ElseIf resulting in message: &quot;Couldn&#39;t find &quot;(what I am looking for)&quot;", "body": "<p>Not sure what your questions is, but unless EU is a variable, you are missing brackets. Also you only loop while column AC is not empty, so if AC2 is empty but there's more data after cell AC4 you're not checking it.</p>\n\n<p>And most importantly, 350 elseif statements, wow! :) You will benefit from learning about arrays/collections.</p>\n"}], "owner": {"reputation": 1, "user_id": 11195862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ac8361790d9e7477953cb3122cf09d4?s=128&d=identicon&r=PG&f=1", "display_name": "asf.adv", "link": "https://stackoverflow.com/users/11195862/asf-adv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552489431, "creation_date": 1552487753, "last_edit_date": 1552489431, "question_id": 55144443, "link": "https://stackoverflow.com/questions/55144443/using-loop-and-if-elseif-resulting-in-message-couldnt-find-what-i-am-looki", "title": "Using Loop and If, ElseIf resulting in message: &quot;Couldn&#39;t find &quot;(what I am looking for)&quot;", "body": "<p>Please not that this is one of the first VBA code I have written.\nWhat I wrote was a mixture of a loop and If function. \nThe code was supposed to go through column(\"AC\"), if it finds an empty cell. \nIt looks at the same row but in column D. Column D would have 350 possible values.\nIf the value of Column D is \"one of 350 possible values\" then give \"EU\" ElseIf... this continues for all 350</p>\n\n<pre><code>Dim i As Long\ni = 1\nDo While Cells(i, \"AC\").Value &lt;&gt; \"\"\n    If Cells(i, \"D\").Value = \"OPP-1305-9066\" Then\n        Cells(i, \"AC\").Value = EU\n    ElseIf Cells(i, \"D\").Value = \"OPP-1305-0773\" Then\n        Cells(i, \"AC\").Value = EU\n    ElseIf Cells(i, \"D\").Value = \"another one of 350\" Then\n        Cells(i, \"AC\").Value = EU\n    End If\n    i = i + 1\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 3, "creation_date": 1552487400, "post_id": 55144253, "comment_id": 97029113, "body": "<b><i>P.S. Im aware that the &quot;Paste&quot; method might be adding formats rather than values only, then I tried adding .PasteSpecial xlPasteValues instead of paste but it eventually throw errors that I couldn&#39;t identify</i></b>  So, that&#39;s that? You ask us to trim your code although you know a way of doing it but gave up?"}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 4, "creation_date": 1552487468, "post_id": 55144253, "comment_id": 97029168, "body": "Efficiency wise, there is a very good article on why you shouldn&#39;t be using <code>Select</code>, <code>Active</code> etc <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba/23913882#23913882\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "edited": false, "score": 0, "creation_date": 1552487589, "post_id": 55144253, "comment_id": 97029260, "body": "I did not gave up, still looking for a solution here. I read about this method and found out it is not appropriate for this case. I dont want it to be trimmed, I wanted a suggestion of something similar to .PasteSpecial xlPasteValues which would work in this case based on somebody&#39;s previous experience"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1552487599, "post_id": 55144253, "comment_id": 97029269, "body": "Record a macro to see how to do pastespecial. Also avoid the use of <code>UsedRange</code>. Find the last row and the last column and then identify the range you want to copy"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1552488118, "post_id": 55144460, "comment_id": 97029652, "body": "<code>Columns</code> and <code>Range</code> are members of the <code>Worksheet</code> class; you have them invoked against <code>Workbook</code> objects; that will throw error 438 at run-time, if it compiles at all. The idea is very sound and upvote-worthy though, care to edit?"}, {"owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "edited": false, "score": 0, "creation_date": 1552489247, "post_id": 55144460, "comment_id": 97030486, "body": "Thank you very much! Actually, by doing that and adding the command <code>wbSource.Sheets(1).Range(&quot;A1:C&quot; &amp; lastRow).Copy Destination:=wbTarget.Sheets(&quot;Stock 0001&quot;).Range(&quot;A1&quot;)</code>, I still get the error &quot;copy method of range class failed&quot;"}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1552489506, "post_id": 55144460, "comment_id": 97030699, "body": "Something else is going on then - as that really only occurs when the range is too big for the destination - which they are equal in this case. Post your new code at the bottom of your post as an edit and I&#39;ll have a look"}, {"owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "edited": false, "score": 1, "creation_date": 1552489887, "post_id": 55144460, "comment_id": 97030972, "body": "Code added to the initial post"}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1552489974, "post_id": 55144460, "comment_id": 97031039, "body": "Have a look at the &quot;Edit 3 &quot; on my reply - there should be nothing wrong now"}, {"owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "edited": false, "score": 0, "creation_date": 1552490214, "post_id": 55144460, "comment_id": 97031195, "body": "This is actually how I had it before, the <code>xlApp.Workbooks.Open</code> command is a way I found around opening 15 excels on the user screen."}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1552490700, "post_id": 55144460, "comment_id": 97031557, "body": "Aah. I believe then I may be out of ideas. Hopefully someone else could add a comment helping some more. Apologies."}], "tags": [], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "is_accepted": true, "score": 2, "last_activity_date": 1552489937, "last_edit_date": 1552489937, "creation_date": 1552487793, "answer_id": 55144460, "question_id": 55144253, "link": "https://stackoverflow.com/questions/55144253/excel-file-getting-too-heavy-after-vba-pulling-data-from-other-sheets-routine/55144460#55144460", "title": "Excel file getting too heavy after VBA (pulling data from other sheets) routine added", "body": "<p>Instead of this </p>\n\n<pre><code>'Stock 0001\nSet wbSource = xlApp.Workbooks.Open(pathSource &amp; \"Stoc 0001.xls\")\nwbSource.Sheets(1).UsedRange.Copy\nwbSource.Close\nSet target = wbTarget.Sheets(\"Stock 0001\")\ntarget.UsedRange.Clear\nRange(\"A1\").Select\ntarget.Paste\n</code></pre>\n\n<p>Try this</p>\n\n<pre><code>wbSource.Sheets(1).Columns(\"\").Copy Destination:=wbTarget.Sheets(\"Stock 0001\").Range(\"A1\")\n</code></pre>\n\n<p>Where I've put <code>Columns</code> just replace this with whatever range you are using via <code>Range()</code> or <code>Cells</code> etc\nCopy and Paste takes a while, and has issues if you are already copying something in another location. This just takes the data for you</p>\n\n<p>Also, this piece of code will be your friend forever</p>\n\n<pre><code>With Sheets(\"Sheet1\")\n    LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n</code></pre>\n\n<p>This finds the bottom row of Column A (or whatever your \"always populated\" column will be</p>\n\n<pre><code>Sub LastRow()\n\n    Dim wb As Workbook, ws As Worksheet, LastRow As Long\n\n    Set wb = ThisWorkbook\n    Set ws = Worksheets(\"Data\")\n\n    LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n    With ws.Range(ws.Cells(2, 13), ws.Cells(LastRow, 13))\n        'This is Range M2:M(bottom)\n        .\n        .\n        'etc\n        .\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Edit....3:</p>\n\n<pre><code>Set xlApp = CreateObject(\"Excel.Application\")\nxlApp.DisplayAlerts = False\nApplication.CutCopyMode = False\n\n'Stock 0001\nSet wbSource = xlApp.Workbooks.Open(pathSource &amp; \"Stock 0001.xls\")\n</code></pre>\n\n<p>Instead of all this, please use</p>\n\n<pre><code>Set wbSource = Workbooks.Open(pathSource &amp; \"Stock 0001.xls\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 1, "last_activity_date": 1552489242, "creation_date": 1552489242, "answer_id": 55145009, "question_id": 55144253, "link": "https://stackoverflow.com/questions/55144253/excel-file-getting-too-heavy-after-vba-pulling-data-from-other-sheets-routine/55145009#55145009", "title": "Excel file getting too heavy after VBA (pulling data from other sheets) routine added", "body": "<p>You also need error handling in your code.  When it breaks (file doesn't exist, path is invalid, sheet doesn't exist) between </p>\n\n<pre><code>Application.EnableEvents = False\nApplication.ScreenUpdating = False\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Application.EnableEvents = True\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>you're going to end up with Excel in a bad state where screen updating is off and events will no longer fire.  What you should have is something long the lines of </p>\n\n<pre><code>On Error GoTo ExitErr\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n</code></pre>\n\n<p>Then after your code, you should have</p>\n\n<pre><code>ExitErr:\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "is_accepted": false, "score": 0, "last_activity_date": 1552556529, "creation_date": 1552556529, "answer_id": 55159232, "question_id": 55144253, "link": "https://stackoverflow.com/questions/55144253/excel-file-getting-too-heavy-after-vba-pulling-data-from-other-sheets-routine/55159232#55159232", "title": "Excel file getting too heavy after VBA (pulling data from other sheets) routine added", "body": "<p>I found a way to reduce the file size back to how it used to be by adding the following line to the imports after the <code>paste</code> command</p>\n\n<pre><code>target.Cells.ClearFormats\n</code></pre>\n\n<p>In this case the formats taken from the data were cleared.</p>\n"}], "owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 55144460, "answer_count": 3, "score": 1, "last_activity_date": 1552556529, "creation_date": 1552487197, "last_edit_date": 1552489863, "question_id": 55144253, "link": "https://stackoverflow.com/questions/55144253/excel-file-getting-too-heavy-after-vba-pulling-data-from-other-sheets-routine", "title": "Excel file getting too heavy after VBA (pulling data from other sheets) routine added", "body": "<p>I am working on automating an excel model by copying data from other sheets into a masterfile. I have a bit of an issue that after adding the code the file went from 25mb to 60mb, without changing the content, only adding the code. Below you can find a snippet of how I automated the imports</p>\n\n<pre><code>Sub copytest() 'Procedure for retrieving data from the sourcefiles\n\n    Dim wbTarget, wbSource As Workbook\n    Dim target As Object\n    Dim pathSource, fileName As String\n    Dim xlApp As Application\n    Dim lastRow As Long\n\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n\n    'path where the data source folders are located (please keep all of them in the same directory)\n    pathSource = \"C:\\Users\\vferraz\\Desktop\\crm stock\\RAPOARTE IMPORTANTE\\18.02\\Rapoarte pentru Handsets\\\"\n    Set wbTarget = ThisWorkbook\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    xlApp.DisplayAlerts = False\n    Application.CutCopyMode = False\n\n    'Stock 0001\n    Set wbSource = xlApp.Workbooks.Open(pathSource &amp; \"Stoc 0001.xls\")\n    wbSource.Sheets(1).UsedRange.Copy\n    wbSource.Close\n    Set target = wbTarget.Sheets(\"Stock 0001\")\n    target.UsedRange.Clear\n    Range(\"A1\").Select\n    target.Paste\n\n    xlApp.Quit\n    Set wbSource = Nothing\n    Set xlApp = Nothing\n\n    ThisWorkbook.Sheets(\"Mastersheet\").Activate\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>In the snippet above I only added the parsing of one file (Stock 0001), but the same method is done for other 10-15 files.</p>\n\n<p>Does anyone have any ideas to improve the efficiency/size of this file based on this procedure?</p>\n\n<p>P.S. Im aware that the \"Paste\" method might be adding formats rather than values only, then I tried adding <code>.PasteSpecial xlPasteValues</code> instead of paste but it eventually throw errors that I couldn't identify</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Based on <a href=\"https://stackoverflow.com/a/55144460/8619137\">this</a> solution, this is the new version I tried:</p>\n\n<pre><code>Stock 0001\n    Set wbSource = xlApp.Workbooks.Open(pathSource &amp; \"Stoc 0001.xls\")\n    lastRow = wbSource.Sheets(1).Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    wbTarget.Sheets(\"Stock 0001\").Cells.Clear\n    wbSource.Sheets(1).Range(\"A1:C\" &amp; lastRow).Copy Destination:=wbTarget.Sheets(\"Stock 0001\").Range(\"A1\")\n    wbSource.Clo\n</code></pre>\n\n<p>The line <code>wbSource.Sheets(1).Range(\"A1:C\" &amp; lastRow).Copy Destination:=wbTarget.Sheets(\"Stock 0001\").Range(\"A1\"</code> Throws the \"copy method of range class failed error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1552486734, "post_id": 55144066, "comment_id": 97028564, "body": "Remove the &quot;=&quot; sign <code>&quot;=Active&quot;</code> and use &quot;Active&quot; and so on for others and try it?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1552486838, "post_id": 55144066, "comment_id": 97028642, "body": "<i>UNTESTED</i> Try this <code>Application.WorksheetFunction.CountIfs(.Range(&quot;E2:E&quot; &amp; finRow), &quot;Active&quot;, .Range(&quot;B2:B&quot; &amp; finRow),  Sheets(&quot;Macro&quot;).Range(&quot;$E$3&quot;).Value, .Range(&quot;T2:T&quot; &amp; finRow),  Sheets(&quot;Macro&quot;).Range(&quot;$D$3&quot;).Value)</code>"}, {"owner": {"reputation": 97, "user_id": 10596246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156460817180090/picture?type=large", "display_name": "Matt Lane", "link": "https://stackoverflow.com/users/10596246/matt-lane"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552491556, "post_id": 55144066, "comment_id": 97032138, "body": "Sorry my question wasn&#39;t clear earlier. I have updated it accordingly. Previously I posted an example that worked without the sum function. I am having trouble with the summing within a countif. Thank you for your response"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1552492223, "post_id": 55144066, "comment_id": 97032587, "body": "If you change <code>Array(&quot;Positions - Active Recruitment&quot;, &quot;Positions - Not Actively Recruiting&quot;)</code> to <code>&quot;Positions - *Active*Recruit*&quot;</code> then you can find both via Wildcards without bringing Arrays into it"}, {"owner": {"reputation": 97, "user_id": 10596246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156460817180090/picture?type=large", "display_name": "Matt Lane", "link": "https://stackoverflow.com/users/10596246/matt-lane"}, "edited": false, "score": 0, "creation_date": 1552494308, "post_id": 55144066, "comment_id": 97034036, "body": "Worked like a charm. Thank you Chronocidal"}], "owner": {"reputation": 97, "user_id": 10596246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156460817180090/picture?type=large", "display_name": "Matt Lane", "link": "https://stackoverflow.com/users/10596246/matt-lane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552491480, "creation_date": 1552486639, "last_edit_date": 1552491480, "question_id": 55144066, "link": "https://stackoverflow.com/questions/55144066/vba-excel-sum-countifs-invalid-character", "title": "Vba Excel Sum Countifs - invalid character { }", "body": "<p>I am having trouble with a Sum Countifs formula in VBA. I have tried Brackets and an array . Below is the Array attempt </p>\n\n<pre><code>Dim finRow As String\n\nfinRow = Sheets(\"Sheet1\").Range(\"A500000\").End(xlUp).Row\n\nSheets(\"Macro\").Range(\"B51\") = WorksheetFunction.Sum(WorksheetFunction.CountIfs(.Range(\"E2:E\" &amp; finRow), Array(\"Positions - Active Recruitment\", \"Positions - Not Actively Recruiting\"), .Range(\"B2:B\" &amp; finRow), \"=\" &amp; Sheets(\"Macro\").Range(\"$E$3\").Value, .Range(\"Y2:Y\" &amp; finRow), \"=Contingent Worker\", .Range(\"T2:T\" &amp; finRow), \"=\" &amp; Sheets(\"Macro\").Range(\"$D$3\").Value))\n</code></pre>\n\n<p>Below is the Bracket attempt which gives me invalid character errors in VBA</p>\n\n<pre><code>Sheets(\"Macro\").Range(\"B51\") = WorksheetFunction.Sum(WorksheetFunction.CountIfs(.Range(\"E2:E\" &amp; finRow), {\"\"=Positions - Active Recruitment\"\", \"\"Positions - Not Actively Recruiting\"\"}, .Range(\"B2:B\" &amp; finRow), \"=\" &amp; Sheets(\"Macro\").Range(\"$E$3\").Value, .Range(\"Y2:Y\" &amp; finRow), \"=Contingent Worker\", .Range(\"T2:T\" &amp; finRow), \"=\" &amp; Sheets(\"Macro\").Range(\"$D$3\").Value))\n</code></pre>\n\n<p>Any help would be much appreciated. Thank you! Matt</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1552487226, "post_id": 55144038, "comment_id": 97028977, "body": "Why do you need to do this in VBA? It&#39;s just conditional formatting. If it has to be VBA. Macro record yourself doing the conditional formatting and edit it as needed. But please take heed of the above post, we&#39;re not here to do the work for you"}, {"owner": {"reputation": 31, "user_id": 3677042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/423e6cf22ea4c3bb3f99c51042957003?s=128&d=identicon&r=PG&f=1", "display_name": "user3677042", "link": "https://stackoverflow.com/users/3677042/user3677042"}, "edited": false, "score": 0, "creation_date": 1552487990, "post_id": 55144038, "comment_id": 97029571, "body": "tried the above, sorry forgot to add the code"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1552488568, "post_id": 55144038, "comment_id": 97029976, "body": "Use Match to return the column number, then refer to the range below and count the number of 101s or whatever you want."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31, "user_id": 3677042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/423e6cf22ea4c3bb3f99c51042957003?s=128&d=identicon&r=PG&f=1", "display_name": "user3677042", "link": "https://stackoverflow.com/users/3677042/user3677042"}, "edited": false, "score": 0, "creation_date": 1552838336, "post_id": 55146589, "comment_id": 97153965, "body": "@user3677042 If this solved your question please mark it as solution."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1552493865, "creation_date": 1552493865, "answer_id": 55146589, "question_id": 55144038, "link": "https://stackoverflow.com/questions/55144038/check-for-a-specific-column-name-given-a-string-then-highlight-values-in-the-col/55146589#55146589", "title": "Check for a specific column name given a string then highlight values in the column that doesn&#39;t match given value in VBA", "body": "<p>Use <code>Application.WorksheetFunction.Match</code> to find the column number of the name you are looking for. Then do your checkings for the columns.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ValidateData()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet\")\n\n    Dim ColumnNames() As Variant\n    ColumnNames = Array(\"Filename\", \"FileNumber\", \"Author\") 'add all Column header that you want to check\n\n    Dim Headers As Variant 'read all headers into an array\n    Headers = ws.Range(\"A1\", ws.Cells(1, ws.Columns.Count).End(xlToLeft)).Value\n\n    Dim HeaderColumn As Long 'this is the column number where the header was found\n\n    Dim ColName As Variant\n    For Each ColName In ColumnNames 'loop through your list of names\n        HeaderColumn = 0 'initialize\n        On Error Resume Next 'next line throws error if it does not match\n        HeaderColumn = Application.WorksheetFunction.Match(ColName, Headers, 0)\n        On Error GoTo 0 're-activate error reporting\n\n        If HeaderColumn &lt;&gt; 0 Then\n            'header name was found\n            MsgBox ColName &amp; \" Column found\"\n\n            'perform different checks on each column\n            Select Case ColName\n            Case \"FileNumber\"\n                CheckFileNumberColumn ws.Range(ws.Cells(2, HeaderColumn), ws.Cells(ws.Rows.Count, HeaderColumn).End(xlUp))\n\n            'Case \"Author\"  'add  other cases as needed\n                'CheckAuthorColumn ws.Range(ws.Cells(2, HeaderColumn), ws.Cells(ws.Rows.Count, HeaderColumn).End(xlUp))\n\n            End Select\n        Else\n            'header name was not found\n            MsgBox ColName &amp; \" Column not found\"\n        End If\n    Next ColName\nEnd Sub\n\n'this is the procedure to check the FileNumber column\nPrivate Sub CheckFileNumberColumn(DataToValidate As Range)\n    Dim iRow As Long\n    For iRow = 1 To DataToValidate.Rows.Count\n        If DataToValidate.Cells(iRow, 1).Value &lt;&gt; 101 Then\n            DataToValidate.Cells(iRow, 1).Interior.Color = RGB(255, 0, 0)\n        End If\n    Next iRow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 3677042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/423e6cf22ea4c3bb3f99c51042957003?s=128&d=identicon&r=PG&f=1", "display_name": "user3677042", "link": "https://stackoverflow.com/users/3677042/user3677042"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552493865, "creation_date": 1552486586, "last_edit_date": 1552492217, "question_id": 55144038, "link": "https://stackoverflow.com/questions/55144038/check-for-a-specific-column-name-given-a-string-then-highlight-values-in-the-col", "title": "Check for a specific column name given a string then highlight values in the column that doesn&#39;t match given value in VBA", "body": "<p>I need to look for a given column name for example in the picture look if the column name \"FileNumber\" exists. If it does exist, I want to look in the column to see if the numbers all are a given number (for example it has to be \"101\"); if incorrect I want to highlight that number (here, highlight \"102\")</p>\n\n<p><a href=\"https://i.stack.imgur.com/osz0s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/osz0s.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I achieve this in VBA?</p>\n\n<pre><code>Sub FindColumns()  \n    Dim rngToSearch As Range\n    Dim lookToFind As Variant\n    Dim iCtr As Long\n\n    Set rngToSearch = ThisWorkbook.Worksheets(\"Sheet\").Range(\"A1:C1\")\n\n    lookToFind = Array(\"Filename\", \"FileNumber\", \"Author\") 'add all Column header that you want to check\n\n    With rngToSearch\n        For iCtr = LBound(lookToFind) To UBound(lookToFind)\n            If WorksheetFunction.CountIf(rngToSearch, lookToFind(iCtr)) &gt; 0 Then ' Check if column is preset or not\n                    MsgBox lookToFind(iCtr) &amp; \" Column Found\" ' Pop-up msg if column is exist\n            Else\n                    MsgBox lookToFind(iCtr) &amp; \" Column Not Found\" ' Pop-up msg if column is Not Found\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1552488313, "creation_date": 1552488313, "answer_id": 55144664, "question_id": 55144033, "link": "https://stackoverflow.com/questions/55144033/finding-the-first-occurrence-of-a-specific-value-in-a-row/55144664#55144664", "title": "Finding the first Occurrence of a specific value in a row", "body": "<p>Consider:</p>\n\n<pre><code>Sub IAmSoBlue()\n    For i = 2 To 1054\n        For j = 4 To 154\n            If Cells(i, j).Value = \"B\" Then\n                Cells(i, j).Interior.Color = 65535\n                Exit For\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mpfX8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mpfX8.png\" alt=\"enter image description here\"></a></p>\n\n<p>You could also use <code>FIND()</code> in place of the second loop.</p>\n"}], "owner": {"reputation": 11, "user_id": 11197650, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pVwD6hlFlnY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxpUT74IX-RWawDmygyFFQ8la6kQ/mo/photo.jpg?sz=128", "display_name": "Your Babish", "link": "https://stackoverflow.com/users/11197650/your-babish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552496495, "creation_date": 1552486572, "last_edit_date": 1552496495, "question_id": 55144033, "link": "https://stackoverflow.com/questions/55144033/finding-the-first-occurrence-of-a-specific-value-in-a-row", "title": "Finding the first Occurrence of a specific value in a row", "body": "<p>I have a range of cells I'm working with, <code>D2:EU1054</code>.  Each row contains a set of values <code>a, b, c, d, e</code>.   </p>\n\n<p>These values don't have a distinct pattern, they can go from A to C back to B.    I need to find a way to highlight  the FIRST occurrence of the value B in each of the rows.  </p>\n\n<p>I've been working with conditional formatting, vba code, and formulas to try to figure out how to just get just that that first specific value. Any ideas?  So within the range of <code>D2:EU1054</code>, I'd like to highlight the value B the first time it occurs in each row.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 2, "creation_date": 1552485730, "post_id": 55143687, "comment_id": 97027792, "body": "This is not how data works in any application. You have a date variable and you are trying to assign it a string value. You have to execute a query and then assign the value of your variable to the result of the query."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1552485765, "post_id": 55143687, "comment_id": 97027822, "body": "I don&#39;t &quot;get&quot; your code.  You define a SQL query which presumably will return many records, then you compare that <i>string</i> using the <code>DATEDIFF</code> function."}, {"owner": {"reputation": 23, "user_id": 9346094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd85071a304a51669b5856144e0a111?s=128&d=identicon&r=PG&f=1", "display_name": "Tomer Barzilay", "link": "https://stackoverflow.com/users/9346094/tomer-barzilay"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1552485971, "post_id": 55143687, "comment_id": 97027985, "body": "@TimBiegeleisen, I attempted to use MAX(ReleaseDate), but that didn&#39;t work either.."}, {"owner": {"reputation": 23, "user_id": 9346094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd85071a304a51669b5856144e0a111?s=128&d=identicon&r=PG&f=1", "display_name": "Tomer Barzilay", "link": "https://stackoverflow.com/users/9346094/tomer-barzilay"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1552486001, "post_id": 55143687, "comment_id": 97028008, "body": "@SeanLange, is that not how I execute a query from VBA?"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1552486072, "post_id": 55143687, "comment_id": 97028061, "body": "No. How does VBA know that is a query? It is just a string."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1552486075, "post_id": 55143687, "comment_id": 97028064, "body": "You never execute any query.  You just assign your intended query to a string called <code>SQLVerDate</code>, but you never ran it if I&#39;m not mistaken.  So, you should research how to execute a SQL query from VBA."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1552486600, "post_id": 55143687, "comment_id": 97028477, "body": "Also, your query indicates it is expected to return more than 1 row. Does that mean you should be using top 1? Or maybe MAX? Or if you need to process all the rows then you need some kind of a loop."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1552856693, "last_edit_date": 1552856693, "creation_date": 1552509160, "answer_id": 55150754, "question_id": 55143687, "link": "https://stackoverflow.com/questions/55143687/computed-column-case-output-from-different-database/55150754#55150754", "title": "Computed Column Case Output from Different Database", "body": "<p>Several ways to accomplish this.</p>\n\n<p>If you just want the latest ReleaseDate in table, use Max() function in query:</p>\n\n<pre><code>Dim rs AS DAO.Recordset\nSet rs = CurrentDb.OpenRecordset \"SELECT Max(ReleaseDate) FROM tblVersionReleasesNew\"\nIf Date() - rs!ReleaseDate &lt; 4 Then\n    VerLbl.ForeColor = 0\nElse\n    VerLbl.ForeColor = 10\nEnd If\n</code></pre>\n\n<p>Or use domain aggregate function:</p>\n\n<pre><code>If Date() - DMax(\"ReleaseDate\",\"tblVersionReleasesNew\") &lt; 4 Then\n    VerLbl.ForeColor = 0\nElse\n    VerLbl.ForeColor = 10\nEnd If\n</code></pre>\n\n<p>Or instead of VBA and label control, use textbox and Conditional Formatting with domain aggregate expression in textbox.</p>\n"}], "owner": {"reputation": 23, "user_id": 9346094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd85071a304a51669b5856144e0a111?s=128&d=identicon&r=PG&f=1", "display_name": "Tomer Barzilay", "link": "https://stackoverflow.com/users/9346094/tomer-barzilay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55150754, "answer_count": 1, "score": 0, "last_activity_date": 1552856693, "creation_date": 1552485516, "last_edit_date": 1552486034, "question_id": 55143687, "link": "https://stackoverflow.com/questions/55143687/computed-column-case-output-from-different-database", "title": "Computed Column Case Output from Different Database", "body": "<p>I'm trying to select a specific field from my database (using SQLserver), using Access.\nThe Datatype is a date, and what I want to check is if the date difference between the date I selected and the current date is smaller than 4 days\nI'm writing this in Access, as that is where my software is located.\nI'm receiving an error \"Runtime error 13: type mismatch\".\nThe data type is Date in the column I'm trying to get (ReleaseDate).</p>\n\n<pre><code>Dim SQLVerDate As Date\nSQLVerDate = \"SELECT ReleaseDate FROM tblVersionReleasesNew ORDER BY ReleaseDate DESC\"\nIf DateDiff(\"d\", Date, SQLVerDate) &lt; 4 Then\n    VerLbl.ForeColor = 0\nElse\n    VerLbl.ForeColor = 10\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "copy", "paste"], "comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1552485894, "post_id": 55143582, "comment_id": 97027922, "body": "Read up on Advance Sort - that will make this vba go a lot better. You could even record yourself using it, and go from there as a base"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1552485948, "post_id": 55143582, "comment_id": 97027964, "body": "Also, it&#39;s best to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using <code>.Select</code>/<code>.Activate</code></a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1552486095, "post_id": 55143582, "comment_id": 97028076, "body": "Do you need to format and ask for the start and end dates  each iteration of the loop.?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1552486167, "post_id": 55143582, "comment_id": 97028126, "body": "One thing I see is you are comparing a Date, which excel treats as a number, against a string(text) version of the date that the user inputs."}, {"owner": {"reputation": 101, "user_id": 11197501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQ_jme9he-c/AAAAAAAAAAI/AAAAAAAAAFw/URajxHzL3Is/photo.jpg?sz=128", "display_name": "Cassandra Durell", "link": "https://stackoverflow.com/users/11197501/cassandra-durell"}, "edited": false, "score": 0, "creation_date": 1552490421, "post_id": 55143582, "comment_id": 97031347, "body": "Is there a way to force the user input to come in as a date instead of a string?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 11197501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQ_jme9he-c/AAAAAAAAAAI/AAAAAAAAAFw/URajxHzL3Is/photo.jpg?sz=128", "display_name": "Cassandra Durell", "link": "https://stackoverflow.com/users/11197501/cassandra-durell"}, "edited": false, "score": 0, "creation_date": 1552490258, "post_id": 55144605, "comment_id": 97031222, "body": "Hey Tim the j was something I had been previously using as an indexing variable and it should\u2019ve been deleted!"}, {"owner": {"reputation": 101, "user_id": 11197501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQ_jme9he-c/AAAAAAAAAAI/AAAAAAAAAFw/URajxHzL3Is/photo.jpg?sz=128", "display_name": "Cassandra Durell", "link": "https://stackoverflow.com/users/11197501/cassandra-durell"}, "edited": false, "score": 0, "creation_date": 1552490305, "post_id": 55144605, "comment_id": 97031264, "body": "As far as your version goes, things look good up until it reaches n. When I get to n I get a run time error for \u201cobject variable or with block not set\u201d. Any input on this?"}, {"owner": {"reputation": 48, "user_id": 10950599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-doLO2LY2Dqo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNiGVEIl3V0boGyKtaajn2cZGog2w/mo/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/10950599/tim"}, "reply_to_user": {"reputation": 101, "user_id": 11197501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQ_jme9he-c/AAAAAAAAAAI/AAAAAAAAAFw/URajxHzL3Is/photo.jpg?sz=128", "display_name": "Cassandra Durell", "link": "https://stackoverflow.com/users/11197501/cassandra-durell"}, "edited": false, "score": 0, "creation_date": 1552490552, "post_id": 55144605, "comment_id": 97031461, "body": "It is probably not finding any values populated in column E.  It looked like you were using column E to determine the total number of rows in the worksheet.  Is that what you intended to do?"}, {"owner": {"reputation": 101, "user_id": 11197501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQ_jme9he-c/AAAAAAAAAAI/AAAAAAAAAFw/URajxHzL3Is/photo.jpg?sz=128", "display_name": "Cassandra Durell", "link": "https://stackoverflow.com/users/11197501/cassandra-durell"}, "edited": false, "score": 0, "creation_date": 1552490594, "post_id": 55144605, "comment_id": 97031486, "body": "To see how it would run without n I commented the n assignment line out and had the loop run from 2 to 100 just to try it and when I do that I get an errror with the if statement \u201cobject required\u201d"}, {"owner": {"reputation": 101, "user_id": 11197501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQ_jme9he-c/AAAAAAAAAAI/AAAAAAAAAFw/URajxHzL3Is/photo.jpg?sz=128", "display_name": "Cassandra Durell", "link": "https://stackoverflow.com/users/11197501/cassandra-durell"}, "edited": false, "score": 0, "creation_date": 1552490720, "post_id": 55144605, "comment_id": 97031573, "body": "And yes! E is the proper column. I restructured to test some things and didn\u2019t realize it left E empty. Now I just need the if statement to run"}, {"owner": {"reputation": 101, "user_id": 11197501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQ_jme9he-c/AAAAAAAAAAI/AAAAAAAAAFw/URajxHzL3Is/photo.jpg?sz=128", "display_name": "Cassandra Durell", "link": "https://stackoverflow.com/users/11197501/cassandra-durell"}, "edited": false, "score": 0, "creation_date": 1552490745, "post_id": 55144605, "comment_id": 97031599, "body": "The line that contains the if statement yields the error"}, {"owner": {"reputation": 101, "user_id": 11197501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQ_jme9he-c/AAAAAAAAAAI/AAAAAAAAAFw/URajxHzL3Is/photo.jpg?sz=128", "display_name": "Cassandra Durell", "link": "https://stackoverflow.com/users/11197501/cassandra-durell"}, "edited": false, "score": 0, "creation_date": 1552491018, "post_id": 55144605, "comment_id": 97031802, "body": "I found my issues in the if statement. I have an error in the assignment of fRow now that I am working through. That line is now the issue."}], "tags": [], "owner": {"reputation": 48, "user_id": 10950599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-doLO2LY2Dqo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNiGVEIl3V0boGyKtaajn2cZGog2w/mo/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/10950599/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1552490037, "last_edit_date": 1552490037, "creation_date": 1552488140, "answer_id": 55144605, "question_id": 55143582, "link": "https://stackoverflow.com/questions/55143582/search-for-date-and-copy-and-paste-whole-row-vba/55144605#55144605", "title": "Search for Date and copy and Paste Whole Row: VBA", "body": "<p>I think the below code might be what you are looking for.</p>\n\n<p>However, what is the purpose of your variable \"j\"? Also, are the values in column BB not formatted as dates?  I wasn't sure the purpose of the line that executes Selection.NumberFormat = \"mm/dd/yyyy\"</p>\n\n<pre><code>Dim wb As Workbook\nDim wsSrc As Worksheet\nDim wsDest As Worksheet\nDim n As Long\nDim i As Long\nDim fRow As Long\nDim startDate As Date\nDim endDate As Date\n\nSet wb = ActiveWorkbook\nSet wsSrc = wb.Sheets(\"Source Sheet\")\nSet wsDest = wb.Sheets(\"Dest Sheet\")\n\nn = wsSrc.Range(\"E:E\").Find(what:=\"*\", searchdirection:=xlPrevious).Row\nstartDate = Application.InputBox(\"Enter the start date\")\nendDate = Application.InputBox(\"Enter the end date\")\n\nFor i = 2 To n\n\n    If wsSrc.Range(\"BB\" &amp; i).Value &gt;= startDate And wsSrc.Range(\"BB\" &amp; i).Value &lt;= endDate Then\n\n        fRow = wsDest.Range(\"A:A\").Find(what:=\"\").Row\n        wsSrc.Range(\"BB\" &amp; i).EntireRow.Copy wsDest.Cells(fRow, 1)\n\n    End If\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 11197501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fQ_jme9he-c/AAAAAAAAAAI/AAAAAAAAAFw/URajxHzL3Is/photo.jpg?sz=128", "display_name": "Cassandra Durell", "link": "https://stackoverflow.com/users/11197501/cassandra-durell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 582, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552490037, "creation_date": 1552485260, "last_edit_date": 1552485319, "question_id": 55143582, "link": "https://stackoverflow.com/questions/55143582/search-for-date-and-copy-and-paste-whole-row-vba", "title": "Search for Date and copy and Paste Whole Row: VBA", "body": "<p>I am new to VBA and I am not sure how I can accomplish the following task. </p>\n\n<p>I want to ask the user for a date range and then take that date range and search through column BB of \u201cSource Sheet\u201d for any date in that range. If a date is in that range I want to take the entire row and copy it and then paste it into a different sheet called \u201cDest Sheet\u201d </p>\n\n<p>Any help is appreciated! I have tried many different ways of doing this and nothing I have done is working. Here is what I currently have </p>\n\n<pre><code>Dim N As Integer\nDim i As Integer\nDim StartDate As Date\nDim EndDate As Date\n\nN = Cells(Rows.Count, \"E\").End(xlUp).Row    'determines the last row with data in it\n                                              'uses column E because E should never be Null if not after last active row\n\nDim j As Integer 'declares j for indexing of the rows on the target spreadsheet\nj = 2\n\nDim fRow As Long                                    'is the role of j in an attempt to copy and paste\nfRow = Sheets(\"Dest Sheet\").UsedRange.Rows.Count         'defines the variable\n\nFor i = 2 To N          'indexes 2 to N to begin with row after the title row to the last active ro\nCells(i, \"BB\").Select\n    If Cells(i, \"BB\").Value &lt;&gt; \"\" Then\n\n    Columns(\"BB\").Select\n    Selection.NumberFormat = \"mm/dd/yyyy\"\n\n    Range(\"BB2\").End(xlDown).Select\n\n    StartDate = Application.InputBox(\"Enter the start date\")\n    EndDate = Application.InputBox(\"Enter the end date\")\n\n    'in row i execute the if statement\n\n        If (\"BB\" &gt;= StartDate &amp; \"BB\" &lt;= EndDate) Then\n\n         Sheets(\"Source Sheet\").Cells(i, 1).EntireRow.Copy Destination:=Sheets(\"Dest Sheet\").Cells(fRow, 1).Offset(1, 0)\n         fRow = fRow + 1\n\n        End If\n\n End If  'declares end of the if statements\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "microsoft-graph-api"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 11103916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cmXnP.jpg?s=128&g=1", "display_name": "Paintitblack3k", "link": "https://stackoverflow.com/users/11103916/paintitblack3k"}, "edited": false, "score": 0, "creation_date": 1552489603, "post_id": 55144020, "comment_id": 97030764, "body": "If I remove application in the header than x-www-form-urlencoded will be also removed. Is #2 than still necessary?"}, {"owner": {"reputation": 57, "user_id": 11103916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cmXnP.jpg?s=128&g=1", "display_name": "Paintitblack3k", "link": "https://stackoverflow.com/users/11103916/paintitblack3k"}, "edited": false, "score": 0, "creation_date": 1552489738, "post_id": 55144020, "comment_id": 97030872, "body": "The mail adress in #4 was just an example. All desired are in my tenant. How can I get the Authorization Code or the Implicit OAuth grants (from the tenant administrators?)"}, {"owner": {"reputation": 27872, "user_id": 105518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e47ca9372faad8084cbaf9f90c6a75?s=128&d=identicon&r=PG", "display_name": "Marc LaFleur", "link": "https://stackoverflow.com/users/105518/marc-lafleur"}, "reply_to_user": {"reputation": 57, "user_id": 11103916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cmXnP.jpg?s=128&g=1", "display_name": "Paintitblack3k", "link": "https://stackoverflow.com/users/11103916/paintitblack3k"}, "edited": false, "score": 0, "creation_date": 1552501783, "post_id": 55144020, "comment_id": 97038237, "body": "If they&#39;re in your tenant, you can use Client Credentials. You should only be setting the <code>Content-Type</code> to <code>x-www-form-urlencoded</code> when fetching the token. You should be setting <code>Content-Type</code> as <code>application&#47;json</code> when fetching the photo (you likely could skip it entirely since you&#39;re not posting any content anyway)"}, {"owner": {"reputation": 57, "user_id": 11103916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cmXnP.jpg?s=128&g=1", "display_name": "Paintitblack3k", "link": "https://stackoverflow.com/users/11103916/paintitblack3k"}, "edited": false, "score": 0, "creation_date": 1552506842, "post_id": 55144020, "comment_id": 97040728, "body": "Ok thank, I will try it tomorrow. Do I need the permisson of my administrator of the tenant or can I get them e.g. with a logged-in user without permisson of the administrator?"}, {"owner": {"reputation": 27872, "user_id": 105518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e47ca9372faad8084cbaf9f90c6a75?s=128&d=identicon&r=PG", "display_name": "Marc LaFleur", "link": "https://stackoverflow.com/users/105518/marc-lafleur"}, "reply_to_user": {"reputation": 57, "user_id": 11103916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cmXnP.jpg?s=128&g=1", "display_name": "Paintitblack3k", "link": "https://stackoverflow.com/users/11103916/paintitblack3k"}, "edited": false, "score": 0, "creation_date": 1552507851, "post_id": 55144020, "comment_id": 97041180, "body": "You need Admin Consent to request <code>User.Read.All</code> with Client Credentials. If you&#39;re authenticating a user, then you <i>can</i> fetch a photo using the <code>User.ReadBasic.All</code> delegated scope and avoid the consent issue."}], "tags": [], "owner": {"reputation": 27872, "user_id": 105518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e47ca9372faad8084cbaf9f90c6a75?s=128&d=identicon&r=PG", "display_name": "Marc LaFleur", "link": "https://stackoverflow.com/users/105518/marc-lafleur"}, "is_accepted": false, "score": 3, "last_activity_date": 1552486521, "creation_date": 1552486521, "answer_id": 55144020, "question_id": 55143063, "link": "https://stackoverflow.com/questions/55143063/microsoft-graph-get-user-photos/55144020#55144020", "title": "Microsoft Graph get user photos", "body": "<p>There are several things wrong here:</p>\n\n<ol>\n<li>There isn't an <code>application</code> header in HTTP</li>\n<li><code>x-www-form-urlencoded</code> is an incomplete <code>Content-Type</code> (it should be `application/x-www-form-urlencoded). </li>\n<li>Your <code>Content-Type</code> should be <code>application/json</code></li>\n<li>You cannot use the Client Credentials OAuth grant to access a Microsoft Account (i.e. a personal <code>@Outlook</code> address). Client Credentials can only access data from users within your tenant. In order to access personal account data, you need to have the user authenticate using either the Authorization Code or Implicit OAuth grants. </li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 11103916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cmXnP.jpg?s=128&g=1", "display_name": "Paintitblack3k", "link": "https://stackoverflow.com/users/11103916/paintitblack3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1552656215, "creation_date": 1552656215, "answer_id": 55183625, "question_id": 55143063, "link": "https://stackoverflow.com/questions/55143063/microsoft-graph-get-user-photos/55183625#55183625", "title": "Microsoft Graph get user photos", "body": "<p>I got Admin Consent and now it works. thanks to Marc for improving my code and getting the solution.</p>\n"}], "owner": {"reputation": 57, "user_id": 11103916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cmXnP.jpg?s=128&g=1", "display_name": "Paintitblack3k", "link": "https://stackoverflow.com/users/11103916/paintitblack3k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552656215, "creation_date": 1552483760, "last_edit_date": 1552506840, "question_id": 55143063, "link": "https://stackoverflow.com/questions/55143063/microsoft-graph-get-user-photos", "title": "Microsoft Graph get user photos", "body": "<p>I try to download the profile picture from some users in my organization. I'm getting the access_token, but in the next step  get the error message: </p>\n\n<blockquote>\n  <p>The token contains no permissions, or permissions can not be\n  understood.</p>\n</blockquote>\n\n<p>My app has in my point of view all required <a href=\"https://docs.microsoft.com/en-us/graph/api/profilephoto-get?view=graph-rest-1.0#permissions\" rel=\"nofollow noreferrer\">permissions</a>:\n<a href=\"https://i.stack.imgur.com/zBcAd.png\" rel=\"nofollow noreferrer\">2</a></p>\n\n<p>Here is my used code:</p>\n\n<pre><code>Sub Test_GetToken()\n    Dim xml As New MSXML2.XMLHTTP60\n    Dim url As String\n    Dim Json As Object\n\n    url = \"https://login.microsoftonline.com/tenant_id/oauth2/v2.0/token\"\n\n    xml.Open \"POST\", url, False\n    xml.setRequestHeader \"application\", \"x-www-form-urlencoded\"\n    xml.Send (\"client_id=1234678&amp;scope=https%3A%2F%2Fgraph.microsoft.com%2F.default&amp;client_secret=12345678&amp;grant_type=client_credentials\")\n\n    Set Json = JsonConverter.ParseJson(xml.responseText)\n\n    access_token = Json(\"access_token\")\n    token_type = Json(\"token_type\")\n    expires_in = Json(\"expires_in\")\n    ext_expires_in = Json(\"ext_expires_in\")\n\n\n    ' trying to get the photo\n    url = \"https://graph.microsoft.com/v1.0/users/user1@OUTLOOK.DE/photo/$value\"\n\n    xml.Open \"GET\", url, False\n    xml.setRequestHeader \"application\", \"x-www-form-urlencoded\"\n    xml.setRequestHeader \"Content-Type\", \"text/json\"\n    xml.setRequestHeader \"Authorization\", token_type &amp; \" \" &amp; access_token\n\n    xml.Send (\"\")\n\n    'Debug.Print token_type &amp; \" \" &amp; access_token\n    'Debug.Print xml.getAllResponseHeaders\n    Debug.Print xml.responseText\n\n    Set xml = Nothing\nEnd Sub\n</code></pre>\n\n<p>Does anybody has an ideas where the mistake is? </p>\n"}, {"tags": ["excel", "vba", "long-integer"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1552483530, "post_id": 55142851, "comment_id": 97026222, "body": "Would <code>DestinationSheet.Rows(pasteRow) = Chr(45) &amp; SourceSheet.Rows(c.Row).Value2</code> change this behaviour?"}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1552483594, "post_id": 55142851, "comment_id": 97026270, "body": "What&#39;s the value and type of <code>SourceSheet.Rows(c.Row).Value2</code>?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1552484148, "post_id": 55142851, "comment_id": 97026672, "body": "If you format them as number with 0dp, do they switch to scientific as well?"}, {"owner": {"reputation": 43, "user_id": 10194034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6zIgfpF_8ls/AAAAAAAAAAI/AAAAAAAAANU/S0vvYq9I3bw/photo.jpg?sz=128", "display_name": "Trevor Sutherland", "link": "https://stackoverflow.com/users/10194034/trevor-sutherland"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1552484338, "post_id": 55142851, "comment_id": 97026814, "body": "@jsheeran - c.Row itself is just the row number to be pasted.   Each row consists of 45 columns that are a combination of strings, percents, currencies and dates"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1552484656, "post_id": 55142851, "comment_id": 97027034, "body": "After <code>DestinationSheet.Rows(pasteRow) = SourceSheet.Rows(c.Row).Value2</code> you could try <code>DestinationSheet.Rows(pasteRow).numberformat= SourceSheet.Rows(c.Row).numberformat</code>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10194034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6zIgfpF_8ls/AAAAAAAAAAI/AAAAAAAAANU/S0vvYq9I3bw/photo.jpg?sz=128", "display_name": "Trevor Sutherland", "link": "https://stackoverflow.com/users/10194034/trevor-sutherland"}, "edited": false, "score": 0, "creation_date": 1552485689, "post_id": 55143554, "comment_id": 97027771, "body": "@MKaras- That&#39;s interesting about the apostrophe; I had no clue it was treated like a function, but that makes a lot of sense given how it is evaluated.  That said, I&#39;m getting a type mismatch error on your solution.  I think that it is because i&#39;m copying a row and not a single cell."}, {"owner": {"reputation": 43, "user_id": 10194034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6zIgfpF_8ls/AAAAAAAAAAI/AAAAAAAAANU/S0vvYq9I3bw/photo.jpg?sz=128", "display_name": "Trevor Sutherland", "link": "https://stackoverflow.com/users/10194034/trevor-sutherland"}, "edited": false, "score": 0, "creation_date": 1552486056, "post_id": 55143554, "comment_id": 97028048, "body": "My bad.  Fixed.  Perfect solution.  Thanks!"}, {"owner": {"reputation": 581, "user_id": 11156161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64f10d412b09e1c2c10f1e539c9f4e2?s=128&d=identicon&r=PG&f=1", "display_name": "MKaras", "link": "https://stackoverflow.com/users/11156161/mkaras"}, "reply_to_user": {"reputation": 43, "user_id": 10194034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6zIgfpF_8ls/AAAAAAAAAAI/AAAAAAAAANU/S0vvYq9I3bw/photo.jpg?sz=128", "display_name": "Trevor Sutherland", "link": "https://stackoverflow.com/users/10194034/trevor-sutherland"}, "edited": false, "score": 1, "creation_date": 1552488994, "post_id": 55143554, "comment_id": 97030294, "body": "It stopped working for me, so I did some more research and edited my answer with the findings."}], "tags": [], "owner": {"reputation": 581, "user_id": 11156161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64f10d412b09e1c2c10f1e539c9f4e2?s=128&d=identicon&r=PG&f=1", "display_name": "MKaras", "link": "https://stackoverflow.com/users/11156161/mkaras"}, "is_accepted": true, "score": 1, "last_activity_date": 1552488950, "last_edit_date": 1552488950, "creation_date": 1552485173, "answer_id": 55143554, "question_id": 55142851, "link": "https://stackoverflow.com/questions/55142851/excel-vba-apostrophe-disappears-on-copy/55143554#55143554", "title": "Excel VBA Apostrophe Disappears on Copy", "body": "<p>Edit: The apostroph is not really a part of a formula/value of a cell. It's stored in a PrefixCharacter property (you can access it with <code>?ActiveCell.PrefixCharacter</code> in your Immediate window).\nSource: <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/136277-apostrophe-in-front-of-text\" rel=\"nofollow noreferrer\">https://www.ozgrid.com/forum/forum/help-forums/excel-general/136277-apostrophe-in-front-of-text</a></p>\n\n<p>To be 100% sure that you are copying this character, you would have to copy the value/formula AND the PrefixCharacter. But that's impossible for the whole row at once.</p>\n\n<p>The code below MIGHT work, but might not (for me it worked, but stopped working soon for no particular reason).</p>\n\n<pre><code>Function CopyByCriteria(Criteria As String, FilterRange As Range, SourceSheet As \nWorksheet, DestinationSheet As Worksheet)\n    Dim pasteRow As Integer\n    Dim c As Range\n\n    pasteRow = 1\n\n    For Each c In FilterRange\n        If c = Criteria Then\n            DestinationSheet.Rows(pasteRow).formula = SourceSheet.Rows(c.Row).formula\n            pasteRow = pasteRow + 1\n        End If\n    Next c\nEnd Function\n</code></pre>\n\n<p>To be 100% sure I would suggest using either the Range.Copy method or manually copy (like the OP did with Value) both Formula and PrefixCharacter of each cell in a row seperately. Maybe I will provide code for it when I have some time.</p>\n"}], "owner": {"reputation": 43, "user_id": 10194034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6zIgfpF_8ls/AAAAAAAAAAI/AAAAAAAAANU/S0vvYq9I3bw/photo.jpg?sz=128", "display_name": "Trevor Sutherland", "link": "https://stackoverflow.com/users/10194034/trevor-sutherland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 55143554, "answer_count": 1, "score": 1, "last_activity_date": 1552488950, "creation_date": 1552483132, "last_edit_date": 1552483975, "question_id": 55142851, "link": "https://stackoverflow.com/questions/55142851/excel-vba-apostrophe-disappears-on-copy", "title": "Excel VBA Apostrophe Disappears on Copy", "body": "<p>I am reworking a macro deals with long integers that cannot be coerced into scientific notation (think product ID numbers).  In a normal world I would just transform them into a string, but Excel seems to still see a sting of numbers as a numeric, even when classified as text.</p>\n\n<p>For this reason I have to append an apostrophe to entire column before changing anything else with the following code:</p>\n\n<pre><code>Function CleanColumn(Col As String, ws As Worksheet, Optional wb As Workbook)\n    If wb Is Nothing Then Set wb = ThisWorkbook\n    With ws\n        arr = .Range(.Cells(2, Col), .Cells(.Rows.Count, Col).End(xlUp)).Value2\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            arr(i, 1) = Chr(39) &amp; Replace(arr(i, 1), Chr(45), vbNullString)\n        Next i\n        .Cells(2, Col).Resize(UBound(arr, 1), UBound(arr, 2)) = arr\n    End With\nEnd Function\n</code></pre>\n\n<p>This works well, however I now need to take the dataset and divide it into seperate worksheets based on the value of one column.  For this I used the following:</p>\n\n<pre><code>Function CopyByCriteria(Criteria As String, FilterRange As Range, SourceSheet As Worksheet, DestinationSheet As Worksheet)\n    Dim pasteRow As Integer\n    Dim c As Range\n\n    pasteRow = 1\n\n    For Each c In FilterRange\n        If c = Criteria Then\n            DestinationSheet.Rows(pasteRow) = SourceSheet.Rows(c.Row).Value2\n            pasteRow = pasteRow + 1\n        End If\n    Next c\nEnd Function\n</code></pre>\n\n<p>The problem is that when I use the CopyByCriteria function, the apostrophe that I added in is not present on the new worksheet and the numbers drop into scientific notation.</p>\n\n<p>What is the solution to this?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 4, "last_activity_date": 1552483373, "creation_date": 1552483373, "answer_id": 55142943, "question_id": 55142833, "link": "https://stackoverflow.com/questions/55142833/access-vba-application-quit-closing-multiple-databases/55142943#55142943", "title": "Access VBA Application.Quit Closing Multiple Databases", "body": "<p>The problem is: the newly opened application is just a variable, and like any variable, it gets destroyed once it goes out of scope.</p>\n\n<p>To avoid this from happening, set <code>.UserControl</code> to True, to indicate the user is controlling the application and responsible for closing it.</p>\n\n<pre><code>Dim appAccess As Access.Application\nSet appAccess = CreateObject(\"Access.Application\")\nappAccess.OpenCurrentDatabase \"C:\\Databases\\Database1.accdb\"\nappAccess.Visible = True\nappAccess.UserControl = True\nappAccess.RunCommand acCmdAppMaximize\nSet appAccess = Nothing\nApplication.Quit\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 10950599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-doLO2LY2Dqo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNiGVEIl3V0boGyKtaajn2cZGog2w/mo/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/10950599/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 1, "accepted_answer_id": 55142943, "answer_count": 1, "score": 1, "last_activity_date": 1552483393, "creation_date": 1552483087, "last_edit_date": 1552483393, "question_id": 55142833, "link": "https://stackoverflow.com/questions/55142833/access-vba-application-quit-closing-multiple-databases", "title": "Access VBA Application.Quit Closing Multiple Databases", "body": "<p>I created a launch app for the database users to open the front end of a particular database. For example, the users open the launch app (which is an Access DB on a shared network), which then performs the following actions:</p>\n\n<ul>\n<li>Copies the front end db from the shared network location to the user's local drive</li>\n<li>Opens the local copy of the front end db</li>\n<li>Closes the launch app</li>\n</ul>\n\n<p>This process makes it much easier for me to implement updates to the front end and works great for almost everyone.  However, there are a couple users that are experiencing the same issue.  When they open the launch app, the front end is copied to their local drive and opened but when the \"Application.Quit\" line is called, both the launch app AND the front end close.</p>\n\n<p>Does anyone have any idea what might be causing this and why it would only affect some users and not others?  Below is a sample of the code in the launch app that opens the local db (after it has been copied from the network location) and then closes itself (and is <em>supposed</em> to leave the front end open).</p>\n\n<pre><code>Dim appAccess As Access.Application\n\n    Set appAccess = CreateObject(\"Access.Application\")\n    appAccess.OpenCurrentDatabase \"C:\\Databases\\Database1.accdb\"\n    appAccess.Visible = True\n    appAccess.RunCommand acCmdAppMaximize\n    Set appAccess = Nothing\n\n    Application.Quit\n</code></pre>\n\n<p>Thanks!</p>\n\n<p>Tim</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1552483772, "post_id": 55142790, "comment_id": 97026393, "body": "Have you tried anything yourself - this is a common question?"}, {"owner": {"reputation": 1, "user_id": 11197216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3af01e7e9dd31a24e262acfcf4f48cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Dave T.", "link": "https://stackoverflow.com/users/11197216/dave-t"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1552486874, "post_id": 55142790, "comment_id": 97028662, "body": "Yes, I have looked.  I know nothing about VBA.  I&#39;ve tried multiple solutions that get me close.  You saying it&#39;s a common question without pointing me to valid solution is not helpful."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1552490385, "post_id": 55142790, "comment_id": 97031324, "body": "Dave, SJR&#39;s is a valid remark on this site. You might want to review the guidelines about asking questions here in the <a href=\"https://stackoverflow.com/help\">help center</a>. SO targets answering programmer&#39;s questions about code they&#39;re having problems with. It&#39;s not a code-writing service or a tutorial site - We&#39;re not here to write code for those who ask questions, but to help them solve any problems they encounter. You need to show effort. For example, use the <a href=\"https://stackoverflow.com/posts/55142790/edit\">edit</a> link to add the code that comes closest to what you need and describe <i>how</i> it &quot;doesn&#39;t work&quot;. But in order to understand answers some knowledge of VBA would be useful..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1552490438, "post_id": 55142790, "comment_id": 97031366, "body": "Also, in order to answer someone in comments (&quot;ping&quot; them - put a message in their inbox) you need to precede their name with a <code>@</code>, for example: @DaveT."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1552491113, "post_id": 55145508, "comment_id": 97031860, "body": "Using <i>select</i> is a lazy way of programming. <a href=\"https://www.excelcampus.com/vba/how-to-avoid-the-select-method/\" rel=\"nofollow noreferrer\">excelcampus.com/vba/how-to-avoid-the-select-method</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 11197216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3af01e7e9dd31a24e262acfcf4f48cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Dave T.", "link": "https://stackoverflow.com/users/11197216/dave-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1552490732, "creation_date": 1552490732, "answer_id": 55145508, "question_id": 55142790, "link": "https://stackoverflow.com/questions/55142790/vba-copy-cell-and-paste-down-blank-rows-in-column/55145508#55145508", "title": "VBA - Copy Cell and Paste Down Blank Rows in Column", "body": "<p>Through trial and error, and mashing up different recommendations, this is what works for my purposes:</p>\n\n<p>Public Sub CopyDownRows()</p>\n\n<p>Dim rng As Range\nDim LR As Long</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nLR = Cells(Rows.Count, \"A\").End(xlUp).Row\nSet rng = Range(\"D3:D\" &amp; LR)\nRange(\"D\").Select\nSelection.Copy\nrng.Select\nActiveSheet.Paste\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 11197216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3af01e7e9dd31a24e262acfcf4f48cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Dave T.", "link": "https://stackoverflow.com/users/11197216/dave-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1552490732, "creation_date": 1552482966, "last_edit_date": 1552490522, "question_id": 55142790, "link": "https://stackoverflow.com/questions/55142790/vba-copy-cell-and-paste-down-blank-rows-in-column", "title": "VBA - Copy Cell and Paste Down Blank Rows in Column", "body": "<p>I am making a template for others to paste their data into the file, and for a macro to run and copy formulas down all rows that contain data.  The sheet contains headers.  The formula is in column D (Price). I want the macro to start in cell D2, and copy the formula in cell D2 down all rows in column D.  </p>\n\n<p><img src=\"https://i.stack.imgur.com/DvxrM.png\" alt=\"Example file\"> </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11196949, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GHzCNbeLB9U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfUlgftjl9hYVjzFRVGyaLAcCNxFw/mo/photo.jpg?sz=128", "display_name": "Alina", "link": "https://stackoverflow.com/users/11196949/alina"}, "edited": false, "score": 0, "creation_date": 1552485352, "post_id": 55142908, "comment_id": 97027558, "body": "Hi Greg_D, thx for edit comment, unfortunatelly position of certain config is not defined. e.g. Config A can be in any of the 6 positions(sometimes multiple times)."}], "tags": [], "owner": {"reputation": 148, "user_id": 11092430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af024eb9cd9d2ba1f0f405a6306a781?s=128&d=identicon&r=PG&f=1", "display_name": "Greg_D", "link": "https://stackoverflow.com/users/11092430/greg-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1552484541, "last_edit_date": 1552484541, "creation_date": 1552483282, "answer_id": 55142908, "question_id": 55142640, "link": "https://stackoverflow.com/questions/55142640/hide-unhide-excel-sheets-based-on-multiple-cell-values/55142908#55142908", "title": "Hide/Unhide Excel Sheets based on multiple cell values", "body": "<p>To help optimize the running and have it look better use <code>Application.ScreenUpdating</code>. It will reduce the flickering by not trying to repaint the scrren until the Sub has finished running. If the rest of the program runs with no issue it should be all you need</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim i As Integer\n    Sheets(\"A\").Visible = False\n    Sheets(\"B\").Visible = False\n    Sheets(\"C\").Visible = False\n    Sheets(\"D\").Visible = False\n\n    For i = 3 To 8\n        If InStr(1, Cells(i, 2), \"A\") Then\n        Application.ScreenUpdating = False\n        Sheets(\"A\").Visible = True\n        ElseIf InStr(1, Cells(i, 2), \"B\") Then\n        Application.ScreenUpdating = False\n        Sheets(\"B\").Visible = True\n        ElseIf InStr(1, Cells(i, 2), \"C\") Then\n        Application.ScreenUpdating = False\n        Sheets(\"C\").Visible = True\n        Application.ScreenUpdating = False\n        ElseIf InStr(1, Cells(i, 2), \"D\") Then\n        Sheets(\"D\").Visible = True\n        End If\n    Next i\nApplication.sScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I also agree with 's comment. <code>Ifs</code> would be better. <code>ElseIf</code> assumes only one condition is the correct one when there could be multiple iterations.</p>\n\n<p>edit:\nAlso a though: It looks like the way its set up you intend that any value between B3:B8 that has an \"A\" will show page \"A\". If you dedicate it differently B3 = \"A\" , B4=\"B\" etc and so on, you can change the conditionals to <code>If Target.Address = \"$B$3\"</code> Then and have B# be the on/off to sheet\"A\" with any non-empty value.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.ScreenUpdating = False\n  If Target.Address = \"$B$3\" Then\n    If IsEmpty(Sheet1.Range(\"B3\")) = False Then\n       Sheets(\"A\").Visible = True\n    Else \n       Sheets(\"A\").Visible = False\n    End If\n  End If\n\n\n        ''etc etc and so on\n\n Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 11196949, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GHzCNbeLB9U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfUlgftjl9hYVjzFRVGyaLAcCNxFw/mo/photo.jpg?sz=128", "display_name": "Alina", "link": "https://stackoverflow.com/users/11196949/alina"}, "edited": false, "score": 0, "creation_date": 1552484418, "post_id": 55143051, "comment_id": 97026867, "body": "Thank you. Worked a treat!"}], "tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": true, "score": 1, "last_activity_date": 1552483721, "creation_date": 1552483721, "answer_id": 55143051, "question_id": 55142640, "link": "https://stackoverflow.com/questions/55142640/hide-unhide-excel-sheets-based-on-multiple-cell-values/55143051#55143051", "title": "Hide/Unhide Excel Sheets based on multiple cell values", "body": "<p>I would use this method:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim i As Integer\n    Sheets(\"A\").Visible = xlSheetHidden\n    Sheets(\"B\").Visible = xlSheetHidden\n    Sheets(\"C\").Visible = xlSheetHidden\n    Sheets(\"D\").Visible = xlSheetHidden\n\n    Application.ScreenUpdating = False\n\n    For i = 3 To 8\n        If InStr(1, Cells(i, 2), \"A\") Then Sheets(\"A\").Visible = xlSheetVisible\n        If InStr(1, Cells(i, 2), \"B\") Then Sheets(\"B\").Visible = xlSheetVisible\n        If InStr(1, Cells(i, 2), \"C\") Then Sheets(\"C\").Visible = xlSheetVisible\n        If InStr(1, Cells(i, 2), \"D\") Then Sheets(\"D\").Visible = xlSheetVisible\n    Next i\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 11196949, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GHzCNbeLB9U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfUlgftjl9hYVjzFRVGyaLAcCNxFw/mo/photo.jpg?sz=128", "display_name": "Alina", "link": "https://stackoverflow.com/users/11196949/alina"}, "edited": false, "score": 0, "creation_date": 1552485166, "post_id": 55143274, "comment_id": 97027415, "body": "This works great if tab name matches the cell value, but in my actual workbook it is not the case. Still very useful. Saved for future :)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 27, "user_id": 11196949, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GHzCNbeLB9U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfUlgftjl9hYVjzFRVGyaLAcCNxFw/mo/photo.jpg?sz=128", "display_name": "Alina", "link": "https://stackoverflow.com/users/11196949/alina"}, "edited": false, "score": 0, "creation_date": 1552485224, "post_id": 55143274, "comment_id": 97027465, "body": "@Alina, simply change <code>LookAt:=xlWhole</code> into <code>LookAt:=xlPart</code>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 27, "user_id": 11196949, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GHzCNbeLB9U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfUlgftjl9hYVjzFRVGyaLAcCNxFw/mo/photo.jpg?sz=128", "display_name": "Alina", "link": "https://stackoverflow.com/users/11196949/alina"}, "edited": false, "score": 0, "creation_date": 1552486071, "post_id": 55143274, "comment_id": 97028060, "body": "@Alina, I have also edited the code so it would only trigger if user actually changed a value in your lookup range. To prevent unwanted triggering of your macro."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1552485869, "last_edit_date": 1552485869, "creation_date": 1552484406, "answer_id": 55143274, "question_id": 55142640, "link": "https://stackoverflow.com/questions/55142640/hide-unhide-excel-sheets-based-on-multiple-cell-values/55143274#55143274", "title": "Hide/Unhide Excel Sheets based on multiple cell values", "body": "<p>Another way to do this would be:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim RNG As Range, CL As Range\nDim WS As Worksheet\n\nApplication.ScreenUpdating = False\n\nSet RNG = Sheets(\"Main\").Range(\"B3:B8\")\nIf Not Intersect(Target, RNG) Is Nothing Then\n    Application.ScreenUpdating = False\n    For Each WS In ThisWorkbook.Worksheets\n        If WS.Name &lt;&gt; \"Main\" Then\n            With RNG\n            Set CL = .Find(What:=WS.Name, LookIn:=xlValues, LookAt:=xlWhole)\n                If Not CL Is Nothing Then\n                    WS.Visible = xlSheetVisible\n                Else\n                    WS.Visible = xlSheetHidden\n                End If\n            End With\n        End If\n    Next WS\nEnd If\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>More versatile and more dynamic</p>\n\n<p><strong>EDIT:</strong> To also check if <code>Target</code> intersects with your lookup range to prevent triggering macro unwanted.</p>\n"}], "owner": {"reputation": 27, "user_id": 11196949, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GHzCNbeLB9U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfUlgftjl9hYVjzFRVGyaLAcCNxFw/mo/photo.jpg?sz=128", "display_name": "Alina", "link": "https://stackoverflow.com/users/11196949/alina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "accepted_answer_id": 55143051, "answer_count": 3, "score": 1, "last_activity_date": 1552485869, "creation_date": 1552482466, "last_edit_date": 1552483826, "question_id": 55142640, "link": "https://stackoverflow.com/questions/55142640/hide-unhide-excel-sheets-based-on-multiple-cell-values", "title": "Hide/Unhide Excel Sheets based on multiple cell values", "body": "<p>I have an Excel workbook which contains multiple sheets. I want to hide/unhide sheets based on cell values in Main sheet cells B3:B8. Values in Main sheet are changed by the user from pre-defined list. </p>\n\n<p>Eg. If \"A\" exists in the \"Config\" column, then unhide sheet \"A\" in my workbook.</p>\n\n<p><img src=\"https://i.stack.imgur.com/HCQMf.png\" alt=\"Workbook\"></p>\n\n<p>At the moment I have following code, which works, but looks \nclunky, Excel flickers as the code runs every time a value is changed in \"Config\" column:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim i As Integer\n    Sheets(\"A\").Visible = False\n    Sheets(\"B\").Visible = False\n    Sheets(\"C\").Visible = False\n    Sheets(\"D\").Visible = False\n\n    For i = 3 To 8\n        If InStr(1, Cells(i, 2), \"A\") Then\n        Sheets(\"A\").Visible = True\n        ElseIf InStr(1, Cells(i, 2), \"B\") Then\n        Sheets(\"B\").Visible = True\n        ElseIf InStr(1, Cells(i, 2), \"C\") Then\n        Sheets(\"C\").Visible = True\n        ElseIf InStr(1, Cells(i, 2), \"D\") Then\n        Sheets(\"D\").Visible = True\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>I also tried to run this macro from a button, but it stops with first TRUE value (a sheet becomes unhidden).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 1, "creation_date": 1552483975, "post_id": 55142433, "comment_id": 97026525, "body": "<code>Dim cell as range</code> Then in the loop just add the condition <code>If cell.value &lt;&gt; vbNullString Then  &#39;run code after this event</code>"}, {"owner": {"reputation": 11, "user_id": 7536841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb6b92736de19b3d67b10776ac5b6c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahmed519", "link": "https://stackoverflow.com/users/7536841/ahmed519"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1552486733, "post_id": 55142433, "comment_id": 97028563, "body": "Where should i put the &quot;End If&quot; ?"}, {"owner": {"reputation": 11, "user_id": 7536841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb6b92736de19b3d67b10776ac5b6c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahmed519", "link": "https://stackoverflow.com/users/7536841/ahmed519"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553085743, "post_id": 55142433, "comment_id": 97253398, "body": "I did it by adding:  If Range(&quot;G&quot; &amp; i) &lt;&gt; &quot;&quot; Then                              .Range(&quot;P&quot; &amp; i).Value = DateDiff(&quot;d&quot;, .Range(&quot;G&quot; &amp; i).Value, Date)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7536841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb6b92736de19b3d67b10776ac5b6c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahmed519", "link": "https://stackoverflow.com/users/7536841/ahmed519"}, "edited": false, "score": 0, "creation_date": 1553084075, "post_id": 55144249, "comment_id": 97252293, "body": "both ways are highlighting this line &quot;If cell.Value &lt;&gt; vbNullString Then&quot; and giving me &quot;Object Required&quot; error"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 11, "user_id": 7536841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb6b92736de19b3d67b10776ac5b6c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahmed519", "link": "https://stackoverflow.com/users/7536841/ahmed519"}, "edited": false, "score": 0, "creation_date": 1553086345, "post_id": 55144249, "comment_id": 97253776, "body": "you need to add <code>Dim cell As Range</code>"}], "tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": false, "score": 2, "last_activity_date": 1553086415, "last_edit_date": 1553086415, "creation_date": 1552487189, "answer_id": 55144249, "question_id": 55142433, "link": "https://stackoverflow.com/questions/55142433/skip-blanks-while-running-for-loop/55144249#55144249", "title": "Skip blanks while running &quot;For loop&quot;", "body": "<p>Like this:</p>\n\n<pre><code>Sub overduedate()\n    Dim LastRow  As Long, i As Long\n    Dim cell as range\n\n    With Worksheets(\"sheet1\")\n        LastRow = .Cells(.Rows.Count, \"G\").End(xlUp).Row\n        For i = 9 To LastRow\n            If cell.value &lt;&gt; vbNullString then\n                .Range(\"P\" &amp; i).Value = DateDiff(\"d\", .Range(\"G\" &amp; i).Value, Date)\n            End If\n        Next i\n    End With\nEnd Sub \n</code></pre>\n\n<p>Or you can use the <code>If</code> Statement without the <code>End If</code> like below:</p>\n\n<pre><code>Sub overduedate()\n    Dim LastRow  As Long, i As Long\n    Dim cell as range\n\n    With Worksheets(\"sheet1\")\n        LastRow = .Cells(.Rows.Count, \"G\").End(xlUp).Row\n        For i = 9 To LastRow\n            If cell.Value &lt;&gt; vbNullString then .Range(\"P\" &amp; i).Value = DateDiff(\"d\", .Range(\"G\" &amp; i).Value, Date)\n        Next i\n    End With\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7536841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb6b92736de19b3d67b10776ac5b6c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahmed519", "link": "https://stackoverflow.com/users/7536841/ahmed519"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553086415, "creation_date": 1552481747, "last_edit_date": 1552482693, "question_id": 55142433, "link": "https://stackoverflow.com/questions/55142433/skip-blanks-while-running-for-loop", "title": "Skip blanks while running &quot;For loop&quot;", "body": "<p>Hello i write simple code to compare dates in range:\n\"starting from cell \"G9\" till end of column\" \ncompare dates in this range with today's date and return the difference in days to be placed the corresponding cell in column \"P\"</p>\n\n<p>The problem is: i need to skip blanks while looping so if the cell is blank vba will skip and go to next cell </p>\n\n<pre><code>Sub overduedate()\n    Dim LastRow  As Long, i As Long\n\n    With Worksheets(\"sheet1\")\n        LastRow = .Cells(.Rows.Count, \"G\").End(xlUp).Row\n        For i = 9 To LastRow\n            .Range(\"P\" &amp; i).Value = DateDiff(\"d\", .Range(\"G\" &amp; i).Value, Date)\n        Next i\n    End With\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-project"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1552482732, "post_id": 55142417, "comment_id": 97025658, "body": "What happens, or doesn&#39;t happen? Are there errors?"}, {"owner": {"reputation": 13, "user_id": 11092003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed84023b9440189af98c7078bb0b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "J Lawrence", "link": "https://stackoverflow.com/users/11092003/j-lawrence"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1552483461, "post_id": 55142417, "comment_id": 97026184, "body": "Nothing pastes to the excel document. The Status Date and the Project Title are added and Cell A3 is selected, but nothing pastes. If I manually do a &quot;paste special text&quot; in excel, the information will transfer."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1552484028, "post_id": 55142417, "comment_id": 97026572, "body": "Move the EditCopy statement further down in the code, perhaps all the activity in Excel is causing the copying process to halt. (This happens directly in Excel when something is typed in a cell.) Or add the project headers after pasting."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1552485450, "post_id": 55142417, "comment_id": 97027633, "body": "Actually, EditPaste is addressing Project. It is probably just copying over-pasting the same content. You probably want <code>xlSheet.Paste</code> or  a range.PasteSpecial."}], "answers": [{"tags": [], "owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1552485681, "creation_date": 1552485681, "answer_id": 55143738, "question_id": 55142417, "link": "https://stackoverflow.com/questions/55142417/ms-project-vba-trying-to-paste-copied-tasks-from-mpp-to-excel/55143738#55143738", "title": "MS Project VBA: Trying to Paste Copied Tasks from .MPP to Excel", "body": "<p><code>EditPaste</code> is a Project method so it is likely to be just copying and over-pasting the same content.</p>\n\n<p>Also, activity in Excel could cause the copying process to be cancelled.</p>\n\n<p>Move <code>EditCopy</code> further down and use <code>xlSheet.Paste</code> or the <code>PasteSpecial</code> method of a Range to get the content in Excel.</p>\n\n<pre><code>'EditCopy\n\n'adds new workbook\nSet xlBook = xlApp.Workbooks.Add\nSet xlSheet = xlBook.Worksheets(1)\n\n'Add the project header info in the top 2 rows\nxlSheet.Cells(1, 1).Value = \"Status Date\"\nxlSheet.Cells(1, 2).Value = pj.StatusDate\nxlSheet.Cells(1, 3).Value = \"Project Title\"\nxlSheet.Cells(1, 4).Value = pj.Title\n'here is where the issue is...it is not pasting the selected info here\nxlSheet.Activate\n    Range(\"A3\").Activate\n\nEditCopy    'happens in Project\n    'EditPaste\nxlSheet.Paste    'happens in Excel\n</code></pre>\n\n<p>Additionally, you could add the headers to Excel <em>after</em> pasting. The two steps are not dependent.</p>\n"}], "owner": {"reputation": 13, "user_id": 11092003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed84023b9440189af98c7078bb0b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "J Lawrence", "link": "https://stackoverflow.com/users/11092003/j-lawrence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "accepted_answer_id": 55143738, "answer_count": 1, "score": 0, "last_activity_date": 1593558484, "creation_date": 1552481703, "last_edit_date": 1593558484, "question_id": 55142417, "link": "https://stackoverflow.com/questions/55142417/ms-project-vba-trying-to-paste-copied-tasks-from-mpp-to-excel", "title": "MS Project VBA: Trying to Paste Copied Tasks from .MPP to Excel", "body": "<p>I am trying to copy tasks from a particular filter in MS Project to an Excel document. Here is what I have so far; however, I can't get the tasks to paste to the workbook. Any assistance would be great.</p>\n\n<pre><code>    Public Sub Export_TopbarToExcel()\n\n    Dim xlApp As Excel.Application\n    Dim xlBook As Excel.Workbook\n    Dim xlSheet As Excel.Worksheet\n    Dim t As Task\n    Dim pj As Project\n\n    Set pj = ActiveProject\n    Set xlApp = New Excel.Application\n\n    xlApp.Visible = True\n    'applies filter in project\n    FilterApply Name:=\"TopBarReport\"\n    'selects filtered tasks and copies them\n    SelectAll\n    EditCopy\n\n    'adds new workbook\n    Set xlBook = xlApp.Workbooks.Add\n    Set xlSheet = xlBook.Worksheets(1)\n\n    'Add the project header info in the top 2 rows\n    xlSheet.Cells(1, 1).Value = \"Status Date\"\n    xlSheet.Cells(1, 2).Value = pj.StatusDate\n    xlSheet.Cells(1, 3).Value = \"Project Title\"\n    xlSheet.Cells(1, 4).Value = pj.Title\n    'here is where the issue is...it is not pasting the selected info here\n    xlSheet.Activate\n        Range(\"A3\").Activate\n        EditPaste\n\n    MsgBox \"Done\", vbInformation\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1552480500, "post_id": 55141906, "comment_id": 97024213, "body": "split() on &quot;\\&quot; then the ubound - 1 will be the last date segment."}], "answers": [{"comments": [{"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552482456, "post_id": 55142120, "comment_id": 97025457, "body": "That&#39;s odd, does it highlight any line in particular?"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552483523, "post_id": 55142120, "comment_id": 97026218, "body": "Try now with sub and dims added in case you missed that."}, {"owner": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552486171, "post_id": 55142120, "comment_id": 97028129, "body": "It does not error out now Daniel, however, when I insert mydate into a cell, I only get a 0 (zero)?"}, {"owner": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552486423, "post_id": 55142120, "comment_id": 97028327, "body": "No. Came back as: 12:00:00 AM"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552486465, "post_id": 55142120, "comment_id": 97028361, "body": "What is the path string you are trying to extract the date from?"}, {"owner": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552486798, "post_id": 55142120, "comment_id": 97028610, "body": "I believe the error is that some users have added a date to the filename, as well as the folder path. It must be hitting on the date in the filename."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552487095, "post_id": 55142120, "comment_id": 97028868, "body": "Date in the filename is not an issue at all! Would you like to share an example of bad result? I can&#39;t help you without seeing the path that doesn&#39;t work for you. Everything should work fine and error free. Is the cell you entering data to formatted as &#39;Time&#39;? This would display the date as midnight I suppose. Make sure cell is formatted as date."}, {"owner": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552487944, "post_id": 55142120, "comment_id": 97029536, "body": "The problem was in the naming of the folder - not your logic, Daniel. Once I addressed the folder naming, worked like a charm. Thanks for your patience with a novice. Much appreciated."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552488124, "post_id": 55142120, "comment_id": 97029660, "body": "No prob, the code will work as long as folder name is in &quot;YYYY MM DD&quot; format, otherwise it will return incorrect results. Don&#39;t forget to mark my answer as correct if you&#39;re happy with it :)"}, {"owner": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552500904, "post_id": 55142120, "comment_id": 97037755, "body": "Another issue has come up, Daniel. I do not want to display &#39;thumbs.db&#39; files or other system files. Is there a way to filter?"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552555173, "post_id": 55142120, "comment_id": 97056766, "body": "It might be worth creating separate post with all details as it&#39;s a different issue that needs looking at"}], "tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": true, "score": 2, "last_activity_date": 1552486210, "last_edit_date": 1552486210, "creation_date": 1552480669, "answer_id": 55142120, "question_id": 55141906, "link": "https://stackoverflow.com/questions/55141906/vba-to-extract-date-from-file-path/55142120#55142120", "title": "VBA to Extract Date from File Path", "body": "<p>That will do:</p>\n\n<pre><code>Sub test()\n\nDim MyPath As String, mps As Variant, mps_temp As String, mydate As Date, i As Integer\n\nMyPath = \"G:\\Inbox\\Folder1\\Received\\2019 03 01\\2019 03 02\\2019 03 05\\Final\"\nmps = Split(MyPath, \"\\\")\n\nFor i = LBound(mps) To UBound(mps)\n    mps_temp = mps(UBound(mps) - i)\n    If mps_temp Like \"#### ## ##\" Then\n        mydate = DateSerial(Mid(mps_temp, 1, 4), Mid(mps_temp, 6, 2), Mid(mps_temp, 9, 2))\n        Exit For\n    End If\nNext\n\nmsgbox mydate \n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 1, "creation_date": 1552482802, "post_id": 55142268, "comment_id": 97025721, "body": "BadDogTitan mentioned that path is variable, your code is not going to work if the last folder with date is other than &quot;arr(UBound(arr) - 1)&quot;. I like how you used array in DateSerial, it&#39;s clearer :)"}, {"owner": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552483067, "post_id": 55142268, "comment_id": 97025903, "body": "Fantastic, Gary&#39;s Student. Works great."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1552483198, "post_id": 55142268, "comment_id": 97026000, "body": "@Daniel  <b>You are correct.</b>  I will list the assumptions at the top of the answer and let the Poster decide."}, {"owner": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552484816, "post_id": 55142268, "comment_id": 97027154, "body": "Regarding the assumption, will this still work if there are more folders after &#39;Final&#39;? My sample data set did not include that, but now I see users are submitting files in folders after &#39;Final&#39;. I will always only ever want the last date, however."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 0, "creation_date": 1552484950, "post_id": 55142268, "comment_id": 97027248, "body": "@BadDogTitan  No, it will not work............a different approach must be devised.............please update your question with more examples..............."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "edited": false, "score": 1, "creation_date": 1552485858, "post_id": 55142268, "comment_id": 97027893, "body": "@BadDogTitan the code I wrote will always take the last date no matter where it is, as long as it in &quot;YYYY MM DD&quot; format."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1552483335, "last_edit_date": 1552483335, "creation_date": 1552481159, "answer_id": 55142268, "question_id": 55141906, "link": "https://stackoverflow.com/questions/55141906/vba-to-extract-date-from-file-path/55142268#55142268", "title": "VBA to Extract Date from File Path", "body": "<p><strong><em>ASSUMPTION(s)</em></strong>:</p>\n\n<ol>\n<li>the last date is in the position just before <em>\\Final</em></li>\n</ol>\n\n<p>Consider:</p>\n\n<pre><code>Sub titan()\n    Dim s As String, sDate As String, d As Date\n\n    s = \"G:\\Inbox\\Folder1\\Received\\2019 03 01\\2019 03 02\\2019 03 05\\Final\"\n    arr = Split(s, \"\\\")\n    sDate = arr(UBound(arr) - 1)\n    arr2 = Split(sDate, \" \")\n    d = DateSerial(arr2(0), arr2(1), arr2(2))\n    MsgBox d\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Mt3uZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Mt3uZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Parse the filepath.  Grab the <strong>next-to-last</strong> element.  Convert to date.</p>\n"}], "owner": {"reputation": 79, "user_id": 11143430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411d6b3dc2c4bd1cae9a5dd11b545bdb?s=128&d=identicon&r=PG&f=1", "display_name": "BadDogTitan", "link": "https://stackoverflow.com/users/11143430/baddogtitan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 55142120, "answer_count": 2, "score": 0, "last_activity_date": 1552486210, "creation_date": 1552480038, "last_edit_date": 1552480243, "question_id": 55141906, "link": "https://stackoverflow.com/questions/55141906/vba-to-extract-date-from-file-path", "title": "VBA to Extract Date from File Path", "body": "<p>I have a series of files to track in an excel spreadsheet. They are stored in folders by date. Sometimes the file is changed, then resubmitted, so the file path name is variable. The date format is constant 'YYYY MM DD'.</p>\n\n<p>Examples:</p>\n\n<p>G:\\Inbox\\Folder1\\Received\\2019 03 01\\Final<br>\nG:\\Inbox\\Folder1\\Received\\2019 03 01\\2019 03 02\\2019 03 05\\Final</p>\n\n<p>Using excel VBA, how do I extract only the last date from the file path? </p>\n"}, {"tags": ["excel", "vba", "doevents"], "comments": [{"owner": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "edited": false, "score": 0, "creation_date": 1552480258, "post_id": 55141811, "comment_id": 97024075, "body": "Could you also provide <code>Sub GenerateReport</code>, where the problematic <code>DoEvents</code> method is called?"}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "reply_to_user": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "edited": false, "score": 0, "creation_date": 1552481512, "post_id": 55141811, "comment_id": 97024867, "body": "I can, but I would warn that it is very lengthy and there are many things that would be out of context."}, {"owner": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "edited": false, "score": 0, "creation_date": 1552482822, "post_id": 55141811, "comment_id": 97025736, "body": "Then please create a minimal working example, as described here: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>."}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "reply_to_user": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "edited": false, "score": 0, "creation_date": 1552483607, "post_id": 55141811, "comment_id": 97026278, "body": "@SpringFilip, done. Check out the edit."}, {"owner": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "edited": false, "score": 0, "creation_date": 1552487635, "post_id": 55141811, "comment_id": 97029298, "body": "Thanks. As I am looking at the code you provided, I cannot see the <code>doEvents</code> call in the <code>Sub GenerateReport</code>. Also there isn&#39;t any real error handling using keywords <code>On Error ...</code>, anywhere in the code provided."}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "reply_to_user": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "edited": false, "score": 0, "creation_date": 1552489226, "post_id": 55141811, "comment_id": 97030471, "body": "You&#39;re most welcome. I genuinely appreciate you taking the time. The <code>DoEvents</code> Call is only in the <code>LoopGenrtReport</code> sub. My error handler, in the <code>GenerateReport</code> sub, conditionally exits the sub and is denoted between the asterisk lines. The idea is that if <code>Dict1.Count =  0</code> Then I want to exit the sub."}, {"owner": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "reply_to_user": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "edited": false, "score": 0, "creation_date": 1552508944, "post_id": 55141811, "comment_id": 97041685, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189973/discussion-between-spring-filip-and-rickmanalexander\">continue this discussion in chat</a>."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1552515495, "post_id": 55141811, "comment_id": 97044442, "body": "Why are you calling` DoEvents` in the first place?"}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "reply_to_user": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "edited": false, "score": 0, "creation_date": 1552562465, "post_id": 55141811, "comment_id": 97061396, "body": "@SpringFilip Unfortunately I am on my companies network which blocks Stockoverflow chats. So, I wouldn&#39;t be able  to chat until I get home this evening around 4:30 EST. My apologies."}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1552562601, "post_id": 55141811, "comment_id": 97061491, "body": "@Enigmativity I am using <code>DoEvents</code> to Update the progress bar. If you think I don&#39;t need it though, I would be glad to get rid of it, lol."}], "answers": [{"tags": [], "owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "is_accepted": true, "score": 0, "last_activity_date": 1552565083, "creation_date": 1552565083, "answer_id": 55162111, "question_id": 55141811, "link": "https://stackoverflow.com/questions/55141811/vba-code-pauses-for-varying-lengths-of-time-with-doevents/55162111#55162111", "title": "VBA: Code Pauses For Varying Lengths of Time With DoEvents", "body": "<p>@Enigmativity 's Comment made me question why I am even using <code>DoEvents</code> in the first place, so I said to myself, \"Self, What if you just get rid of <code>DoEvents</code> altogether and use the <code>Sleep</code> Windows API function at a 10ms increment instead of <code>DoEvents</code>?\" Well, that's just what I did, with the addition of <code>FrmProgress.Repaint</code> and it prevents Excel from freezing for extended periods of time all while updating the progress bar like I need it to. </p>\n\n<p>The only issue is that it when the <code>GenerateReport</code> is exited due to my defined error, there is still a bit of a lag, but compared to what it was doing before, I can live with it. </p>\n\n<p>If any one else has a better idea, or if you think my idea will not work like I am hoping it will, then please let me know. I am 100% open to other ideas or solutions. </p>\n\n<p><strong>Amended code:</strong></p>\n\n<pre><code>Private Sub LoopGenrtReport(ByRef InPut_Array As Variant)\n\n Dim ii As Long\n Dim UBTailNum_Array As Long\n Dim Filtered_Array As Variant\n Dim LoopCounter As Long\n Dim pctdone As Single\n\n   Application.ScreenUpdating = False\n   Application.Interactive = False\n\n        UBTailNum_Array = UBound(InPut_Array)\n\n        'Sheet_Array is a public variable as are StartDate and End Date\n        Filtered_Array = SubsetArray(Sheet_Array, StartDate, EndDate)\n\n            If IsEmpty(Filtered_Array) Then\n                MsgBox \"No Transactions were found in the date range selected.\", _\n                vbCritical, \"Error: No Transactions Found\"\n                GoTo ClearVariables\n            End If\n\n        'Release from memory\n        Erase Sheet_Array\n\n    'Show progress bar if more than one report _\n    is being generated\n    If UBTailNum_Array &gt; 0 Then Call ShowPrgssBar\n\n    For ii = LBound(InPut_Array) To UBound(InPut_Array)\n\n            LoopCounter = LoopCounter + 1\n\n            pctdone = LoopCounter / (UBTailNum_Array + 1)\n\n            With FrmProgress\n                .LabelCaption.Caption = \"Generating Report(s) \" &amp; LoopCounter &amp; \" of \" &amp; UBTailNum_Array + 1\n                .LabelProgress.Width = pctdone * (.FrameProgress.Width)\n            End With\n\n            '***********************************\n            'Added these in place of 'DoEvents'\n            FrmProgress.Repaint\n            Call Sleep (10)\n            '***********************************\n\n            Call GenerateReport(Filtered_Array, CStr(InPut_Array(ii)))\n\n    Next ii\n\nClearVariables:\n    StartDate = Empty\n    EndDate = Empty\n\n    ii = Empty\n    InPut_Array = Empty\n    UBTailNum_Array = Empty\n    Filtered_Array = Empty\n    LoopCounter = Empty\n    pctdone = Empty\n\n    Application.Interactive = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Windows API Functions/subs:</strong> </p>\n\n<pre><code>#If VBA7 Then \n    Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal Milliseconds As LongPtr)\n\n#Else\n\n    Public Declare Sub Sleep Lib \"kernel32\" (ByVal Milliseconds As Long)\n\n#End If\n</code></pre>\n"}], "owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55162111, "answer_count": 1, "score": 0, "last_activity_date": 1552565083, "creation_date": 1552479761, "last_edit_date": 1552483542, "question_id": 55141811, "link": "https://stackoverflow.com/questions/55141811/vba-code-pauses-for-varying-lengths-of-time-with-doevents", "title": "VBA: Code Pauses For Varying Lengths of Time With DoEvents", "body": "<p>I have a procedure that generates reports based on user input provided on a user-form. I have implemented error handling, as one should, but one of my error handlers is not playing well with <code>DoEvents</code>. The issue is that my main sub <code>LoopGenrtReport</code>, which loops another sub, <code>GenerateReport</code>, freezes up for varying lengths of time, IF, the <code>GenerateReport</code> sub is exited due to an error. I say varying lengths, because sometimes it's 5 seconds, and other times it never moves to the next iteration of the loop. </p>\n\n<p>I have tested removing the code for the progress bar and <code>Doevents</code>, and in doing so, I found that the procedure works exactly as intended. </p>\n\n<p>I have also tested without <code>Application.Interactive</code>, but WITH the progress bar and <code>Doevents</code> to see if that might be the issue, but the same thing occurs. </p>\n\n<p>Below is the code: </p>\n\n<pre><code>Private Sub LoopGenrtReport(ByRef InPut_Array As Variant)\n\n Dim ii As Long\n Dim UBTailNum_Array As Long\n Dim Filtered_Array As Variant\n Dim LoopCounter As Long\n Dim pctdone As Single\n\n   Application.ScreenUpdating = False\n   Application.Interactive = False\n\n        UBTailNum_Array = UBound(InPut_Array)\n\n        'Sheet_Array is a public variable as are StartDate and End Date\n        Filtered_Array = SubsetArray(Sheet_Array, StartDate, EndDate)\n\n            If IsEmpty(Filtered_Array) Then\n                MsgBox \"No Transactions were found in the date range selected.\", _\n                vbCritical, \"Error: No Transactions Found\"\n                GoTo ClearVariables\n            End If\n\n        'Release from memory\n        Erase Sheet_Array\n\n    'Show progress bar if more than one report _\n    is being generated\n    If UBTailNum_Array &gt; 0 Then Call ShowPrgssBar\n\n    For ii = LBound(InPut_Array) To UBound(InPut_Array)\n\n            LoopCounter = LoopCounter + 1\n\n            pctdone = LoopCounter / (UBTailNum_Array + 1)\n\n            With FrmProgress\n                .LabelCaption.Caption = \"Generating Report(s) \" &amp; LoopCounter &amp; \" of \" &amp; UBTailNum_Array + 1\n                .LabelProgress.Width = pctdone * (.FrameProgress.Width)\n            End With\n            DoEvents\n\n            Call GenerateReport(Filtered_Array, CStr(InPut_Array(ii)))\n\n    Next ii\n\nClearVariables:\n    StartDate = Empty\n    EndDate = Empty\n\n    ii = Empty\n    InPut_Array = Empty\n    UBTailNum_Array = Empty\n    Filtered_Array = Empty\n    LoopCounter = Empty\n    pctdone = Empty\n\n    Application.Interactive = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong> This behavior occurs ONLY when I exit <code>GenerateReport</code> due to an error. The actual error is that no transactions were found for the current <code>InPut_Array(ii)</code> item. Expected behavior would be to just move the next iteration of the loop in the main sub without issue. There is nothing that would affect the main sub if the called sub is exited.</p>\n\n<p>I have spent quite a long time trying to resolve the issue to no avail. Any ideas, suggestions, or answers would be greatly appreciated. </p>\n\n<p>As Per Request of @Spring Filip, a condensed version of the called sub, <code>GenerateReport</code> has been provided below. </p>\n\n<pre><code>Option Explicit\nOption Private Module\n\nSub GenerateReport(ByRef Source_Array As Variant, ByRef KeyTailNum As String)\n\n Dim i As Long\n Dim CompositeKey As String\n Dim Dict1 As Dictionary\n Dim ItemComp_Array As Variant\n\n Dim Coll As Collection\n\n    Set Dict1 = New Dictionary\n        Dict1.CompareMode = TextCompare\n\n    Set Coll = New Collection\n\n            ' Build dictionary that summarizes transactions\n            For i = LBound(Source_Array, 1) To UBound(Source_Array, 1)\n\n                If Source_Array(i, 6) = KeyTailNum Then\n\n                    CompositeKey = vbNullString\n\n                    If Source_Array(i, 5) &lt;&gt; \"MRO VENDOR\" Then\n\n                            If Source_Array(i, 5) = \"ISSUE FROM STOCK\" Then\n                                'buid collection of IFS PNs\n                                Coll.Add Source_Array(i, 1)\n                            End If\n\n                            'CompositeKey = PN,PO,Amount,Exp Type\n                            CompositeKey = Join(Array(Source_Array(i, 1), _             \n                                                Source_Array(i, 4), _\n                                                Abs(Source_Array(i, 3)), _\n                                                Source_Array(i, 5), KeyTailNum), \"~~\")\n\n                            If Dict1.Exists(CompositeKey) Then\n\n                                ItemComp_Array = Split(Dict1.Item(CompositeKey), \"~~\")\n\n                                Dict1.Item(CompositeKey) = Join(Array(ItemComp_Array(0), _\n                                                            ItemComp_Array(1), _\n                                                            (CDbl(ItemComp_Array(2) + CDbl(Source_Array(i, 3)))), _\n                                                            ItemComp_Array(3), _\n                                                            ItemComp_Array(4), 0), \"~~\")\n\n                            Else\n                                'Item = PN, PN Des, Ammount, Exp Cat, Count, Place holder for averages  \n                                Dict1.Add CompositeKey, Join(Array(Source_Array(i, 1), _\n                                                            Source_Array(i, 2), _\n                                                            CDbl(Source_Array(i, 3)), _\n                                                            Source_Array(i, 5), _\n                                                            1, 0), \"~~\")\n\n                            End If\n\n                    Else\n                            'Key = Exp Alpha Name; PN/Exp Remark; Rec Unique ID; Tail Number\n                            CompositeKey = Join(Array(Source_Array(i, 1), _\n                                            Source_Array(i, 2), Source_Array(i, 7), KeyTailNum), \"~~\")\n\n                            If Not Dict1.Exists(CompositeKey) Then\n\n                                'Item = Exp Alpha Name; PN/Exp Remark; Amount; Exp Typ; Account;Rec Unique Id\n                                Dict1.Add CompositeKey, Join(Array(Source_Array(i, 1), _\n                                                            Source_Array(i, 2), _\n                                                            CDbl(Source_Array(i, 3)), _\n                                                            Source_Array(i, 5), _\n                                                            Source_Array(i, 8), _\n                                                            Source_Array(i, 7)), \"~~\")\n\n\n                            End If\n\n                    End If\n\n                End If\n            Next i\n\n                'Errors_Coll is public, BoolExitGenRprt is public\n                '**************************************************************************************************\n                'Conditional Exit of Sub \n                '**************************************************************************************************\n                'If there are no transactions found for this tail then go to the Next Tail Number if there is one\n                If Dict1.Count = 0 Then\n                    Errors_Coll.Add KeyTailNum\n                    BoolExitGenRprt = True\n                    GoTo ClearAllVariables\n                End If\n                '**************************************************************************************************\n                '**************************************************************************************************\n\n\n            'Begin Other code to be executed\n            |\n            |\n            |\n            |\n            |\n            |\n            |\n            |\n            'End Other code to be excuted'\n\n\nClearAllVariables:\n            'Clear Variables\n            i = Empty\n            Set Dict1 = Nothing\n            CompositeKey = Empty\n            ItemComp_Array = Empty\n            Source_Array = Empty\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1552479887, "post_id": 55141777, "comment_id": 97023818, "body": "Remove the nasty statement <code>On Error Resume Next</code> so that when it fails you will see a helpful error message. We should not routinely just ignore errors."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1552479962, "post_id": 55141777, "comment_id": 97023869, "body": "You could also leave the screen updating and display alerts working while debugging. (You are fumbling in the dark otherwise.)"}, {"owner": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1552480021, "post_id": 55141777, "comment_id": 97023909, "body": "That definitely does help. I was so fixated on the sheets thing that I didn&#39;t even think about it. It&#39;s something on line 39.    ActiveWorkbook.Worksheets.Add after:=ActiveWorkbook.Worksheets"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1552480044, "post_id": 55141777, "comment_id": 97023921, "body": "Which is line 39 and what is the error message?"}, {"owner": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1552480080, "post_id": 55141777, "comment_id": 97023945, "body": "Method &#39;Add&#39; of object &#39;Sheets&#39; failed"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "edited": false, "score": 0, "creation_date": 1552480718, "post_id": 55142071, "comment_id": 97024362, "body": "Thanks for that. I made that change, but now i&#39;m getting an error at &quot;ActiveWorkbook.Worksheets(j).Name = thisbook.Worksheets(j).Name&quot; (Subscript out of Range)"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "edited": false, "score": 0, "creation_date": 1552480790, "post_id": 55142071, "comment_id": 97024422, "body": "j is referring to a sheet index that does not exist. If there are 4 sheets and j is 5, it fails."}, {"owner": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "edited": false, "score": 0, "creation_date": 1552480992, "post_id": 55142071, "comment_id": 97024531, "body": "In my main file I have 10 or so tabs. It was my thought that this section should grab sheet j where j=4,5,6,7 from my main file as it loops and put it into my summary file before closing/saving it. Is there another way to look at/accomplish this?"}, {"owner": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "edited": false, "score": 0, "creation_date": 1552481133, "post_id": 55142071, "comment_id": 97024626, "body": "Is there something I could include before the iteration step that creates enough new sheets in the individual workbooks for the iteration to work? Or am I thinking about this wrong."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "edited": false, "score": 0, "creation_date": 1552482020, "post_id": 55142071, "comment_id": 97025192, "body": "Sorry, I am only responding to and answering the initial question. You need to work on solving new issues that have arrived (since removing On Error Resume Next). You can always create a new question if you remain stuck."}, {"owner": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "edited": false, "score": 0, "creation_date": 1552482530, "post_id": 55142071, "comment_id": 97025510, "body": "I actually just got it working. Removing &quot;thisbook.Worksheets(j).Range(&quot;A1&quot;).Select&quot; Seems to have let everything work. As for the tabs thing I forgot that you can just increase the number of tabs in a new workbook by default in excel options. Will Update question with answer."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "edited": false, "score": 0, "creation_date": 1552482636, "post_id": 55142071, "comment_id": 97025585, "body": "Glad you sorted. There is no need to update, or revise, the original question. An answer can just be accepted."}], "tags": [], "owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1552480729, "last_edit_date": 1552480729, "creation_date": 1552480451, "answer_id": 55142071, "question_id": 55141777, "link": "https://stackoverflow.com/questions/55141777/excel-macro-to-break-out-tabs-to-account-specific-workbooks/55142071#55142071", "title": "Excel Macro to break out tabs to account specific workbooks", "body": "<p>In this line</p>\n\n<pre><code>ActiveWorkbook.Worksheets.Add after:=ActiveWorkbook.Worksheets\n</code></pre>\n\n<p>the <code>after</code> parameter is expecting a single sheet reference, not a reference to the entire <code>Worksheets</code> collection.</p>\n\n<p>If, for example, you want to add a sheet to the end then you can use <code>Count</code> to locate the last sheet, using it as the sheet index:</p>\n\n<pre><code>ActiveWorkbook.Worksheets.Add _ \n    after:=ActiveWorkbook.Worksheets(ActiveWorkbook.Worksheets.Count)\n</code></pre>\n\n<hr>\n\n<p>Remove <code>On Error Resume Next</code> unless, and until, the code is fully tested and working. Even then, this should be a last resort and used to circumvent a specific issue that can safely be ignored.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1552482711, "creation_date": 1552482711, "answer_id": 55142713, "question_id": 55141777, "link": "https://stackoverflow.com/questions/55141777/excel-macro-to-break-out-tabs-to-account-specific-workbooks/55142713#55142713", "title": "Excel Macro to break out tabs to account specific workbooks", "body": "<p>After removing the nasty error blocks I had to add <code>(ActiveWorkbook.Worksheets.Count)</code>as referenced above. After that I was getting an error at <code>thisbook.Worksheets(j).Range(\"A1\").Select</code> which I solved by just deleting it since it didn't seem like it was needed. Everything seems to be working appropriately now. Thanks for all the help.</p>\n"}], "owner": {"reputation": 3, "user_id": 11197005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99591991838a7e46e6be1f1928130e2?s=128&d=identicon&r=PG&f=1", "display_name": "Justin C", "link": "https://stackoverflow.com/users/11197005/justin-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55142071, "answer_count": 2, "score": 0, "last_activity_date": 1552482711, "creation_date": 1552479634, "last_edit_date": 1552480168, "question_id": 55141777, "link": "https://stackoverflow.com/questions/55141777/excel-macro-to-break-out-tabs-to-account-specific-workbooks", "title": "Excel Macro to break out tabs to account specific workbooks", "body": "<pre><code>Sub CostCenterMarco2014()\n\nDim xlCalc As XlCalculation\nDim CC As String\nDim i As Integer\nDim j As Integer\nDim k As Integer\nDim ccf As Range\nDim ccl As Range\nDim tt As Integer\n\n    On Error Resume Next\n\n'   Turn off events and screen updating\n    With Application\n        xlCalc = .Calculation\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n    End With\n\n    Set thisbook = ActiveWorkbook\n\n    ' Iteration over SAP cost centers\n    For i = 2 To 30\n        CC = thisbook.Worksheets(1).Cells(i, 1).Value\n        thisbook.Worksheets(\"Summary\").Range(\"B2\").Value = CC\n        thisbook.Worksheets(\"Summary\").Calculate\n        Workbooks.Add\n        thisbook.Worksheets(\"Summary\").Range(\"A1:Z100\").Copy\n        ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial xlPasteFormats\n        ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial xlPasteValues\n        ActiveWorkbook.Worksheets(\"Sheet1\").Columns(\"A:Z\").AutoFit\n\n        ' Iteration over 5 sheets\n        For j = 4 To 7\n            ActiveWorkbook.Worksheets.Add after:=ActiveWorkbook.Worksheets\n            ActiveWorkbook.Worksheets(j).Name = thisbook.Worksheets(j).Name\n\n            'Copy header row\n            thisbook.Worksheets(j).Rows(1).Copy Destination:=ActiveWorkbook.Worksheets(j).Range(\"A1\")\n\n            ' Depending on the format of header row\n            'tt = ActiveWorkbook.Worksheets(j).Range(\"A1\").CurrentRegion.Columns.Count\n            tt = ActiveWorkbook.Worksheets(j).Range(\"IV1\").End(xlToLeft).Column\n            With thisbook.Worksheets(j)\n                Set ccf = .Range(\"A:A\").Find(what:=CC, after:=.Cells(1, 1), LookIn:=xlValues, SearchDirection:=xlNext)\n\n                If Not ccf Is Nothing Then\n                    Set ccl = .Range(\"A:A\").FindPrevious(after:=ccf)\n                    .Range(.Cells(ccf.Row, 1), .Cells(ccl.Row, tt)).Copy Destination:=ActiveWorkbook.Worksheets(j).Range(\"A2\")\n                End If\n            End With\n\n            Application.CutCopyMode = False\n\n            ActiveWorkbook.Worksheets(j).Range(\"A1\").CurrentRegion.Columns.AutoFit\n            thisbook.Worksheets(j).Range(\"A1\").Select\n        Next j\n\n        ActiveWorkbook.Worksheets(\"Sheet1\").Name = \"Summary\"\n        ActiveWorkbook.Worksheets(\"Sheet2\").Delete\n        ActiveWorkbook.Worksheets(\"Sheet3\").Delete\n        ActiveWorkbook.Worksheets(\"Summary\").Select\n        ActiveWorkbook.Worksheets(\"Summary\").Range(\"A1\").Select\n\n\n\n        ActiveWorkbook.SaveAs Filename:=\"\\\\REDACTED\\2.February 2019\\Monthly Expense Report February 2019-\" &amp; CC '&amp; \".xlsx\"\n        ActiveWorkbook.Close\n    Next i\n\n\n'   Turn on events and screen updating\n    With Application\n        .Calculation = xlCalc\n        .EnableEvents = True\n        .ScreenUpdating = True\n        .DisplayAlerts = False\n    End With\n\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>So I won't profess to knowing a whole lot about coding in general. I took a couple classes in college so I feel like I can at least feel my way through this one. This macro was given to me by someone who is no longer at my company. Most of it is working as intended and it worked completely last month.</p>\n\n<p>This month however the Iteration over 5 sheets section just doesn't seem to be working. I tried to step through the macro and it creates a new workbook and pastes the summary info inside, but then when it gets to copying the tabs it doesn't copy any of the 4 details tabs I need or their name even.</p>\n\n<p>What I end up with is all of the individual cost centers in their own file with summary as intended, but the detail tabs are not being copied. Any help is appreciated.</p>\n"}, {"tags": ["excel", "python-3.x", "vba", "win32com"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1552479531, "post_id": 55141688, "comment_id": 97023566, "body": "Is this file-location a parameter to the macro? If so, pass this parameter when you invoke the macro using <code>Application.run</code>. On the other hand, if the macro initializes a dialogue with the user, it is all of a sudden a much harder problem whose simplest solution would involve changing the macro. In general, code which is designed to require user-input (as opposed to passed parameters) is much, much harder to invoke programmatically."}, {"owner": {"reputation": 716, "user_id": 10429891, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M473SUk4uyk/AAAAAAAAAAI/AAAAAAAAABY/uuxCZRmisp4/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/10429891/adrian"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1552480206, "post_id": 55141688, "comment_id": 97024033, "body": "@JohnColeman It is a dialogue with the user. I think I will try to change the macro to make the location of the file a parameter. Thank you for the input!"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1552487151, "post_id": 55141688, "comment_id": 97028915, "body": "You may pass the path via process environment variable, check <a href=\"https://stackoverflow.com/a/34500601/2165759\">this answer</a>."}], "owner": {"reputation": 716, "user_id": 10429891, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M473SUk4uyk/AAAAAAAAAAI/AAAAAAAAABY/uuxCZRmisp4/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/10429891/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552479353, "creation_date": 1552479353, "question_id": 55141688, "link": "https://stackoverflow.com/questions/55141688/pass-arguments-to-a-macro-in-excel-with-python-code", "title": "Pass arguments to a macro in excel with python code", "body": "<p>I have a sheet that contains a macro (.xlsm). When this macro is ran, it requires to select another .csv file and this creates an .xlsx file. So far, I managed to open the .xlsm file and run the macro, but I do not know how to make it choose a specific .csv file and how to save that results.</p>\n\n<p>My code is:</p>\n\n<pre><code>import win32com.client\nimport os\n\ndirectory = \"C:/Users/aprofir/Desktop/\"\nfile = \"CSVDE OPEN.xlsm\"\nmacro = \"Csvde\"\npath = os.path.join(directory, file)\n\nif os.path.exists(path):\n    xlApp = win32com.client.Dispatch(\"Excel.Application\")\n    wb = xlApp.Workbooks.Open(Filename=path, ReadOnly=1)\n    xlApp.Application.Run(macro)\n    xlApp.Application.Run()\n    wb.Close(SaveChanges=1)\n    xlApp.Application.Quit()\n</code></pre>\n\n<p>If I run this code, the macro wants me to choose a file:\n<a href=\"https://i.stack.imgur.com/aUksu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aUksu.png\" alt=\"enter image description here\"></a></p>\n\n<p>How do I make it select the file at a specific location?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1552479221, "post_id": 55141625, "comment_id": 97023369, "body": "Not sure I get you, but <code>ActiveCell.row</code> is the key here, use 3752 and 4990"}], "answers": [{"tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": true, "score": 0, "last_activity_date": 1552483915, "creation_date": 1552483915, "answer_id": 55143109, "question_id": 55141625, "link": "https://stackoverflow.com/questions/55141625/vba-combine-range-with-row-insert-and-merging/55143109#55143109", "title": "VBA : combine range with row insert and merging", "body": "<p>The below code should work: </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Cells(Target.Row + Target.Rows.Count, Target.Item(1, 1).Column).ID = Target.Address\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Item(1, 1).ID &lt;&gt; \"\" Then\n        'Code for if row is deleted\n    Else\n        'Code for if row is inserted\n        If Target.Row &gt;= 3752 And Target.Row &lt;= 4990 Then\n           Range(Cells(Target.Row, \"H\"), Cells(Target.Row, \"L\")).MergeCells = True\n           Range(\"H\" &amp; Target.Row + 1).Resize(, 5).Merge\n        End If\n    End If\n    Target.Item(1, 1).ID = \"\"\n    Cells(Target.Row + Target.Rows.Count, Target.Item(1, 1).Column).ID = Target.Address\nEnd Sub \n</code></pre>\n\n<p>To change what rows you are looking at you can change this line: <code>If Target.Row &gt;= 3752 And Target.Row &lt;= 4990 Then</code>  If you are trying to change the columns you can change this letters in this section: </p>\n\n<pre><code>Range(Cells(Target.Row, \"H\"), Cells(Target.Row, \"L\")).MergeCells = True\nRange(\"H\" &amp; Target.Row + 1).Resize(, 5).Merge\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1552573225, "post_id": 55159399, "comment_id": 97068887, "body": "I am not sure what you mean by when you secure the excel file?  I assume you mean you are protecting the worksheet?  If that is the case then you just need to unlock the sheet at the start of your code and then relock it at the end.  That can be done using <code>Sheets(yourSheetName).unprotect password:=yourPassword</code> and <code>Sheets(yourSheetName).protect password:=yourPassword</code>"}, {"owner": {"reputation": 3, "user_id": 11184692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad0c06c7cbb38094b0c14554f7e32c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony V.", "link": "https://stackoverflow.com/users/11184692/anthony-v"}, "reply_to_user": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1552983539, "post_id": 55159399, "comment_id": 97205822, "body": "yes it&#39;s protecting the file, and thank you i&#39;ve got everything working now."}], "tags": [], "owner": {"reputation": 3, "user_id": 11184692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad0c06c7cbb38094b0c14554f7e32c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony V.", "link": "https://stackoverflow.com/users/11184692/anthony-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1552557060, "creation_date": 1552557060, "answer_id": 55159399, "question_id": 55141625, "link": "https://stackoverflow.com/questions/55141625/vba-combine-range-with-row-insert-and-merging/55159399#55159399", "title": "VBA : combine range with row insert and merging", "body": "<p>works like a charm! but if i secure the excel file i do get an error now :  \"1004 while executing : error defined by the application or object\"</p>\n"}], "owner": {"reputation": 3, "user_id": 11184692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad0c06c7cbb38094b0c14554f7e32c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony V.", "link": "https://stackoverflow.com/users/11184692/anthony-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 55143109, "answer_count": 2, "score": 0, "last_activity_date": 1552557060, "creation_date": 1552479107, "last_edit_date": 1552482628, "question_id": 55141625, "link": "https://stackoverflow.com/questions/55141625/vba-combine-range-with-row-insert-and-merging", "title": "VBA : combine range with row insert and merging", "body": "<p>here you see the lines for merging certain cells when a row is inserted.</p>\n\n<pre><code>Range(Cells(ActiveCell.row, \"H\"), Cells(ActiveCell.row, \"L\")).mergeCells = True\nRange(\"H\" &amp; ActiveCell.row + 1).Resize(, 5).Merge\n</code></pre>\n\n<p>i would like to add a range value but i can't find how or where to add it in the existing code.\nthe range in the excel is <strong>\"H3752\":\"L4990\"</strong>, so only in that range the cells are to be merged, and not in the entire worksheet.</p>\n\n<p>kinds regards.</p>\n"}, {"tags": ["excel", "vba", "if-statement", "copy-paste"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1552478402, "post_id": 55141261, "comment_id": 97022819, "body": "You should use sheet references throughout. Once you activate the January sheet your code will refer to that as it is the active sheet."}, {"owner": {"reputation": 13, "user_id": 11196880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adf1db94590fd31ca1cbef4cf3b3c1d?s=128&d=identicon&r=PG&f=1", "display_name": "S Farrell", "link": "https://stackoverflow.com/users/11196880/s-farrell"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1552479351, "post_id": 55141261, "comment_id": 97023442, "body": "I&#39;ve tried that, unfortunately to no avail."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552479641, "post_id": 55141261, "comment_id": 97023647, "body": "@SFarrell But <b>how</b> did you try that? <i>&quot;no avail&quot;</i> doesn&#39;t help us to understand where your difficulties were. Please <a href=\"https://stackoverflow.com/posts/55141261/edit\">edit</a> your question and update the code. As SJR pointed out the code cannot work as expected as shown in the question. The following might help: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 13, "user_id": 11196880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adf1db94590fd31ca1cbef4cf3b3c1d?s=128&d=identicon&r=PG&f=1", "display_name": "S Farrell", "link": "https://stackoverflow.com/users/11196880/s-farrell"}, "edited": false, "score": 0, "creation_date": 1552479825, "post_id": 55141261, "comment_id": 97023784, "body": "I have updated it. I was using activate sheet any time I was changing sheets, to ensure the correct one was selected."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1552483185, "post_id": 55141261, "comment_id": 97025986, "body": "That change does not address my point. However, the answer might."}, {"owner": {"reputation": 1255, "user_id": 4842504, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/db303b8e370d567c99d98aa8151455d9?s=128&d=identicon&r=PG", "display_name": "Sirmyself", "link": "https://stackoverflow.com/users/4842504/sirmyself"}, "edited": false, "score": 0, "creation_date": 1552483844, "post_id": 55141261, "comment_id": 97026438, "body": "You are basically using the single line syntax.  Add <code>End If</code> at the end of your code block."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552483552, "post_id": 55142812, "comment_id": 97026242, "body": "Note this copies only if the <code>If</code> statement is true, but it pastes <b>always</b> because your <code>If</code> statement is a one-liner and has no <code>End If</code>. Which the OP probably meant to do."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552483880, "post_id": 55142812, "comment_id": 97026458, "body": "Just another thing: <code>Month</code> is already a function in VBA (<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/month-function\" rel=\"nofollow noreferrer\">Month function</a>) and should therefore be forbidden (highly not recommended) as a variable name."}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1552483698, "last_edit_date": 1552483698, "creation_date": 1552483027, "answer_id": 55142812, "question_id": 55141261, "link": "https://stackoverflow.com/questions/55141261/if-statement-will-not-copy-the-results-to-a-seperate-page/55142812#55142812", "title": "If Statement will not copy the results to a seperate page", "body": "<p>As mentioned in the comments above, you need to use sheet references otherwise you are going to jump back and forth between sheets and after the first iteration you are copying and pasting to the same sheet.  You also have to specify where you are going to paste the data and change the destination each time, otherwise you will keep pasting over the same data.</p>\n\n<pre><code>Dim ws1 as Worksheet\nDim ws2 as Worksheet\n\nSet ws1 = Worksheets(\"Project Info\")\nSet ws2 = Worksheets(\"January\")\n\nDim month As Long\nDim t as Long\n\nApplication.ScreenUpdating = False\n\nt=1\nFor month = ws1.Cells(Rows.Count, 23).End(xlUp).Row To 1 Step -1\n    If InStr(1, ws1.Cells(month, 23).Value Like \"1/*\", 1) Then\n       ws1.Cells(month, 23).EntireRow.Copy\n       ws2.Rows(t).PasteSpecial xlPasteAll\n       t=t+1\n    End if\nNext month\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11196880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adf1db94590fd31ca1cbef4cf3b3c1d?s=128&d=identicon&r=PG&f=1", "display_name": "S Farrell", "link": "https://stackoverflow.com/users/11196880/s-farrell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55142812, "answer_count": 1, "score": 0, "last_activity_date": 1552483698, "creation_date": 1552477933, "last_edit_date": 1552479787, "question_id": 55141261, "link": "https://stackoverflow.com/questions/55141261/if-statement-will-not-copy-the-results-to-a-seperate-page", "title": "If Statement will not copy the results to a seperate page", "body": "<p>Creating an If statement, to sort out my data based on the month in a certain column. The code is as such</p>\n\n<pre><code>Worksheets(\"Project Info\").Activate\n\nDim month As Long\nApplication.ScreenUpdating = False\nFor month = Cells(Rows.Count, 23).End(xlUp).Row To 1 Step -1\n    If InStr(1, Cells(month, 23).Value Like \"1/*\", 1) _\n    Then Cells(month, 23).EntireRow.Copy\n    Worksheets(\"January\").Activate\n    ActiveSheet.Paste\nNext month\n</code></pre>\n\n<p>For some reason, it won't copy data into the specified page. It doesn't even actually copy the data at all. Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1552476981, "creation_date": 1552476981, "answer_id": 55140975, "question_id": 55140910, "link": "https://stackoverflow.com/questions/55140910/vba-for-each-in-array-type-mismatch/55140975#55140975", "title": "VBA For Each in Array type mismatch", "body": "<p>This will explain it better</p>\n\n<pre><code>Sub Sample()\n    Dim arr\n\n    lastrow2 = 2\n\n    arr = Range(\"M2:M\" &amp; lastrow2).Value\n\n    lastrow2 = 3\n\n    arr = Range(\"M2:M\" &amp; lastrow2).Value\nEnd Sub\n</code></pre>\n\n<p>When the <code>lastrow2 = 2</code>, <code>arr</code> holds only one cell value and hence it becomes a <code>Variant/(String/Double...etc depending on the value in cell M2)</code></p>\n\n<p>When the <code>lastrow2 &gt; 2</code>, <code>arr</code> becomes a 2D array and hence it becomes a <code>Variant/Variant(1 to 2, 1 to 1)</code></p>\n\n<p>The above can be verified using a <code>Watch</code> on <code>arr</code> in VBA.</p>\n\n<p>This is the reason why your code works when you have more than one cell.</p>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 0, "last_activity_date": 1552477835, "creation_date": 1552477835, "answer_id": 55141232, "question_id": 55140910, "link": "https://stackoverflow.com/questions/55140910/vba-for-each-in-array-type-mismatch/55141232#55141232", "title": "VBA For Each in Array type mismatch", "body": "<p>Because it is not a collection or an array, it is a single value - you can test this by checking <code>IsArray(arr)</code> before you run the <code>For Each</code></p>\n\n<p>There are several ways to fix this, but the fastest would be to include the line <code>If Not IsArray(Arr) Then Arr = Array(Arr)</code> before your <code>For Each</code>, to turn it into a 1-element array.</p>\n\n<h2>Other points to consider:</h2>\n\n<ul>\n<li>What is the purpose of your <code>On Error Resume Next</code>?  </li>\n<li>What is the purpose of your <code>skip:</code> label?  </li>\n<li>Variable <code>myrangename</code> is not defined - consider adding <code>Option Explicit</code> to the top of your Module, so that \"Debug > Compile VBA Project\" will catch those errors for you</li>\n</ul>\n"}], "owner": {"reputation": 7, "user_id": 10552793, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R6rYyyLRbCE/AAAAAAAAAAI/AAAAAAAADiQ/VnTynf_EChI/photo.jpg?sz=128", "display_name": "linkrisz", "link": "https://stackoverflow.com/users/10552793/linkrisz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55141232, "answer_count": 2, "score": 0, "last_activity_date": 1552479700, "creation_date": 1552476742, "last_edit_date": 1552479700, "question_id": 55140910, "link": "https://stackoverflow.com/questions/55140910/vba-for-each-in-array-type-mismatch", "title": "VBA For Each in Array type mismatch", "body": "<p>I have been using the following code to send out emails, but I get a \"run time error 13\" when there is only one value in column M.</p>\n\n<p>It works fine if I have more than two values. Any help please?</p>\n\n<pre><code>Sub testDemo()\n    Dim outlookApp As Object\n    Dim objMail As Object\n    Dim Region\n    Dim rng As Range\n    Dim Mailaddr As String\n    Dim MyRange As String\n    Dim arr As Variant\n    Dim lastrow As Long\n    Dim lastrow2 As Long\n\n\n     ' Create email\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n\n    ' Update with your sheet reference\n    With Sheets(\"Escalate\")\n\n    lastrow = Range(\"A65536\").End(xlUp).Row\n    lastrow2 = Range(\"M65536\").End(xlUp).Row\n    Set rng = .Range(\"A1:I\" &amp; lastrow)\n\n    End With\n\n    arr = Range(\"M2:M\" &amp; lastrow2).Value\n\n\n    For Each Region In arr\n\n    myrangename = Worksheets(\"email\").Range(\"C2:D200\")\n    Mailaddr = WorksheetFunction.VLookup(Region, myrangename, 2, False)\n\n    On Error Resume Next\n\n\n    With outlookApp.CreateItem(0)\n            ' Add table to Email body\n            .SentOnBehalfOfName = \"script Tracking\"\n            .cc = \"Pearson.S@cambridgeenglish.org; Tracking.S@cambridgeenglish.org\"\n            .HTMLBody = \"Dear Team,\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n            \"blahblah  \" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n            GenerateHTMLTable(rng, CStr(Region), True) &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n            \"Many thanks in advance \" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n            \"Kind regards \"\n\n            .To = Mailaddr\n            .Subject = \"Region \" &amp; Region &amp; \" Outstanding scripts -  \" &amp; Range(\"L1\")\n            .Display\n\n        End With\nskip:\n\n    Next Region\n\n\nEnd Sub\n\nPublic Function GenerateHTMLTable(srcData As Range, Region As String, Optional FirstRowAsHeaders As Boolean = True) As String\n    Dim InputData As Variant, HeaderData As Variant\n    Dim HTMLTable As String\n    Dim i As Long\n\n\n\n    ' Declare constants of table element\n    Const HTMLTableHeader As String = \"&lt;table&gt;\"\n    Const HTMLTableFooter As String = \"&lt;/table&gt;\"\n\n    ' Update with your sheet reference\n    If FirstRowAsHeaders = True Then\n        HeaderData = Application.Transpose(Application.Transpose(srcData.Rows(1).Value2))\n        InputData = Range(srcData.Rows(2), srcData.Rows(srcData.Rows.Count)).Value2\n        ' Add Headers to table\n        HTMLTable = \"&lt;tr&gt;&lt;th&gt;\" &amp; Join(HeaderData, \"&lt;/th&gt;&lt;th&gt;\") &amp; \"&lt;/th&gt;&lt;/tr&gt;\"\n\n\n    End If\n\n    ' Loop through each row of data and add selected region to table output\n        For i = LBound(InputData, 1) To UBound(InputData, 1)\n        ' Test Region against chosen option\n        If Region = InputData(i, 9) Then\n            ' Add row to table for output in email\n            HTMLTable = HTMLTable &amp; \"&lt;tr&gt;&lt;td&gt;\" &amp; Join(Application.Index(InputData, i, 0), \"&lt;/td&gt;&lt;td&gt;\") &amp; \"&lt;/td&gt;&lt;/tr&gt;\"\n\n\n        End If\n\n\nNext i\n\n\n    GenerateHTMLTable = HTMLTableHeader &amp; HTMLTable &amp; HTMLTableFooter\n\nEnd Function\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/FzCwV.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba", "if-statement", "character"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552474491, "post_id": 55139931, "comment_id": 97020473, "body": "Ehm how about using Search/Replace? Search for <code>&quot;GUF&quot;</code> reaplace with <code>&quot;&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 0, "creation_date": 1552475410, "post_id": 55140347, "comment_id": 97020978, "body": "How about changing <code>If .Range(&quot;D&quot; &amp; i).Value Like &quot;GUF*&quot; Then</code> to <code>If Left(.Range(&quot;D&quot; &amp; i).Value,3) = &quot;GUF&quot; Then</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 0, "creation_date": 1552475591, "post_id": 55140347, "comment_id": 97021092, "body": "@Yane: May I ask why should I be changing it? :) You can use <code>Left()</code> as well though. many ways to skin a cat..."}, {"owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 0, "creation_date": 1552475721, "post_id": 55140347, "comment_id": 97021168, "body": "bad choice of words, what it should say is &quot; I would use Left() instead...  :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 0, "creation_date": 1552475790, "post_id": 55140347, "comment_id": 97021207, "body": "@Yane: Ah ok... Now that is a personal choice :)"}, {"owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 0, "creation_date": 1552479283, "post_id": 55140347, "comment_id": 97023405, "body": "Thanks for the help but im getting a Runtime error 424 Object necessary the highlighted code is: Set ws = EVA &#39;&lt;~~ Change this to the relevant sheet"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "edited": false, "score": 1, "creation_date": 1552479379, "post_id": 55140347, "comment_id": 97023463, "body": "@Cedric note that in <code>Set ws = Sheet1</code> the <code>Sheet1</code> is the VBA name of the sheet not the name on the tab. If you want to use the name of the tab use <code>Set ws = ThisWorkbook.Worksheets(&quot;EVA&quot;)</code> instead."}, {"owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552480346, "post_id": 55140347, "comment_id": 97024121, "body": "@P\u1d07\u029c Okay Thanks i didnt know that"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1552474968, "creation_date": 1552474968, "answer_id": 55140347, "question_id": 55139931, "link": "https://stackoverflow.com/questions/55139931/if-the-first-characters-of-a-cell-are-guf-then-remove-guf-if-not-leave-it-blank/55140347#55140347", "title": "If the first characters of a cell are GUF then Remove GUF if not leave it blank", "body": "<p>Is this what you are trying?</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim lRow As Long, i As Long\n\n    Set ws = Sheet1 '&lt;~~ Change this to the relevant sheet\n\n    With ws\n        '~~&gt; Find last row in Col D\n        lRow = .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row\n\n        '~~&gt; Loop through cell in Col D\n        For i = 3 To lRow\n            If .Range(\"D\" &amp; i).Value Like \"GUF*\" Then\n                .Range(\"D\" &amp; i).Value = Mid(.Range(\"D\" &amp; i).Value, 4)\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 581, "user_id": 11156161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64f10d412b09e1c2c10f1e539c9f4e2?s=128&d=identicon&r=PG&f=1", "display_name": "MKaras", "link": "https://stackoverflow.com/users/11156161/mkaras"}, "is_accepted": true, "score": 1, "last_activity_date": 1552478645, "last_edit_date": 1552478645, "creation_date": 1552478178, "answer_id": 55141337, "question_id": 55139931, "link": "https://stackoverflow.com/questions/55139931/if-the-first-characters-of-a-cell-are-guf-then-remove-guf-if-not-leave-it-blank/55141337#55141337", "title": "If the first characters of a cell are GUF then Remove GUF if not leave it blank", "body": "<p>Firstly, when you are looping through cells, it's best to use <code>For each cell in cells</code>, no need to change selection then. </p>\n\n<p>Firstly, set a range in which you want it to run.</p>\n\n<pre><code>Sub RemoveGUFfromcellsstartingwithGUF()\n    dim first_cell as Range \n    dim last_cell as Range \n    dim rng as Range\n    set first_cell = ActiveSheet.Range(\"D1\") 'first cell of your range\n    set last_cell = ActiveSheet.Range(\"D5000\") 'last cell of your range\n    set rng = Range(first_cell, last_cell) 'range from first_cell to last_cell\n\n     For Each cell in rng.cells 'looping through cells of the range\n        'What you do here will be done to every cell.\n        if left(cell.value, 3) = \"GUF\" then cell.value = Mid(cell.value,4)\n     Next cell\nEnd Sub\n</code></pre>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 31, "user_id": 11134900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbuXQgb5Oyw/AAAAAAAAAAI/AAAAAAAAADo/8HEpT4C3t88/photo.jpg?sz=128", "display_name": "Cedric", "link": "https://stackoverflow.com/users/11134900/cedric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55141337, "answer_count": 2, "score": 1, "last_activity_date": 1552478645, "creation_date": 1552473713, "last_edit_date": 1552474868, "question_id": 55139931, "link": "https://stackoverflow.com/questions/55139931/if-the-first-characters-of-a-cell-are-guf-then-remove-guf-if-not-leave-it-blank", "title": "If the first characters of a cell are GUF then Remove GUF if not leave it blank", "body": "<p>I am still new to coding so i apologise if i dont understand everything.</p>\n\n<p>I need to check each cell of D3:D5000 if they start with GUF. Then remove the GUF from it. Else dont do anything.</p>\n\n<p>This is what ive been trying to use but im getting an error Do ohne Loop:</p>\n\n<pre><code>Sub RemoveGUFfromcellsstartingwithGUF()\n\nRange(\"D3\").Select\n    Selection.End(xlDown).Offset(1, 0).Select\n    ActiveCell = \"end\"\n\n    Range(\"B1\").Select\n\n    Do Until ActiveCell = \"end\"\n    If ActiveCell = \"GUF*\" Then\n    ActiveCell.Value = Mid(Cell, 4, 999999)\n    End If\n    ActiveCell.Offset(1, 0).Select\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for any help/suggestions</p>\n\n<p><a href=\"https://i.stack.imgur.com/wQbM3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wQbM3.png\" alt=\"Cells with Data\"></a></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1552480753, "post_id": 55139762, "comment_id": 97024388, "body": "Where and how did you create check boxes?"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1552480723, "creation_date": 1552480723, "answer_id": 55142138, "question_id": 55139762, "link": "https://stackoverflow.com/questions/55139762/how-to-associate-code-with-a-checkbox-in-an-outlook-template/55142138#55142138", "title": "How to associate code with a checkbox in an Outlook template?", "body": "<p>Looks like you need to create a new custom Outlook form with a code behind. You can read more about that in the <a href=\"https://docs.microsoft.com/en-us/office/vba/outlook/concepts/outlook-forms/create-an-outlook-form\" rel=\"nofollow noreferrer\">Create an Outlook Form</a> article. </p>\n\n<p>You will not be able to achieve the required functionality with a message body. Any scripts from message bodies can't be run for security matters. </p>\n"}], "owner": {"reputation": 1, "user_id": 11196150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1dc4f1951bcf3185e7233db8afb4c58?s=128&d=identicon&r=PG&f=1", "display_name": "Randy", "link": "https://stackoverflow.com/users/11196150/randy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555660577, "creation_date": 1552473260, "last_edit_date": 1555660577, "question_id": 55139762, "link": "https://stackoverflow.com/questions/55139762/how-to-associate-code-with-a-checkbox-in-an-outlook-template", "title": "How to associate code with a checkbox in an Outlook template?", "body": "<p>I have created an Outlook template with checkboxes included. I want to display a message when a checkbox has been ticked. I have written some basic codes (msgbox etc.) related to each checkbox. </p>\n\n<p>Issue:<br>\n<strong>How</strong> can I include/integrate my codes in the Outlook template?</p>\n"}, {"tags": ["excel", "vba", "wildcard"], "answers": [{"tags": [], "owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "is_accepted": false, "score": 1, "last_activity_date": 1552473210, "creation_date": 1552473210, "answer_id": 55139742, "question_id": 55139621, "link": "https://stackoverflow.com/questions/55139621/grabbing-data-from-other-workbooks-using-wildcards-error/55139742#55139742", "title": "Grabbing data from other workbooks using wildcards ERROR", "body": "<p>You are missing the path when you try to open the workbook.</p>\n\n<pre><code>Set wbSource = xlApp.Workbooks.Open(pathSource &amp; FileName)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": true, "score": 1, "last_activity_date": 1552473288, "creation_date": 1552473288, "answer_id": 55139777, "question_id": 55139621, "link": "https://stackoverflow.com/questions/55139621/grabbing-data-from-other-workbooks-using-wildcards-error/55139777#55139777", "title": "Grabbing data from other workbooks using wildcards ERROR", "body": "<p>I think pathSource is not the current working directory, so you should write:</p>\n\n<pre><code>Set wbSource = xlApp.Workbooks.Open(pathSource &amp; FileName)\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 8619137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38e2f7affa325bea22e99667bbd97775?s=128&d=identicon&r=PG&f=1", "display_name": "vferraz", "link": "https://stackoverflow.com/users/8619137/vferraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 55139777, "answer_count": 2, "score": 0, "last_activity_date": 1552475249, "creation_date": 1552472890, "last_edit_date": 1552475249, "question_id": 55139621, "link": "https://stackoverflow.com/questions/55139621/grabbing-data-from-other-workbooks-using-wildcards-error", "title": "Grabbing data from other workbooks using wildcards ERROR", "body": "<p>I know it might be a silly mistake but I tried many ways of doing that and none of them worked. </p>\n\n<p>I have this code in place for grabbing data from other excel sheets in a folder and pasting it in a master folder. The issue pops up when I try to use wildcards to look for files where part of the name is variable. In the example below, the file name is <code>Stock_RTC_17.02.2019.xlsx</code>. </p>\n\n<p>However, excel returns an error that the file is not found in the folder for the code below, even though you can see <strong>it has found the correct file name</strong>. Anyone got a clue on what I'm doing wrong?</p>\n\n<p><a href=\"https://i.stack.imgur.com/mSMe5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mSMe5.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub copytest() 'Procedure for retrieving data from the sourcefiles\n\n    Dim wbTarget, wbSource As Workbook\n    Dim target As Object\n    Dim pathSource As String\n    Dim xlApp As Application\n\n    'path where the data source folders are located (please keep all of them in the same directory)\n    pathSource = \"C:\\Users\\vferraz\\Desktop\\crm stock\\RAPOARTE IMPORTANTE\\18.02\\Rapoarte pentru Handsets\\\"\n    Set wbTarget = ThisWorkbook\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    xlApp.DisplayAlerts = False\n    Application.CutCopyMode = False\n\n    'Stock RTC\n    Dim FileName As String\n\n    FileName = Dir(pathSource &amp; \"Stock_RTC_*.xlsx\", vbNormal)\n\n    Set wbSource = xlApp.Workbooks.Open(FileName)\n\n    wbSource.Sheets(1).UsedRange.Copy\n    wbSource.Close\n    Set target = wbTarget.Sheets(\"Stock Aberon GW TKR\")\n    target.UsedRange.Clear\n    Range(\"A1\").Select\n    target.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "userform"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1552475707, "post_id": 55139607, "comment_id": 97021158, "body": "The current version of the code is better, but not yet ideal. Especially a problem are the nested <code>If</code> sections. It would be helpful if each level of <code>If</code> were indented successively so that the level is easily recognized. A general code <i>convention</i> is to place all the <code>Dim</code> statements at the beginning. This isn&#39;t strictly necessary and a matter of personal taste, but I find  it&#39;s easier to read the flow of the code if there aren&#39;t <code>Dim</code> lines in between."}, {"owner": {"reputation": 21, "user_id": 11193137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbdf8527bc8a00c1a7e38f08d0d4151e?s=128&d=identicon&r=PG&f=1", "display_name": "LimaWhiskey", "link": "https://stackoverflow.com/users/11193137/limawhiskey"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1552476337, "post_id": 55139607, "comment_id": 97021538, "body": "@CindyMeister Hopefully I&#39;ve understood your comments. Ive put the &#39;If&#39; statements in sections with an indent at each bit. I have also taken on board the comment regarding 2 questions and removed one."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1552480121, "post_id": 55139607, "comment_id": 97023969, "body": "It&#39;s the right idea... I&#39;ve edited the top part of the code to show how it&#39;s done conventionally, up through the first <code>Dim</code> section. What&#39;s very important for the nested If levels is that <code>End If</code> appears at the same level as the partner <code>If</code> (Like I&#39;ve one for <code>Else</code>). Otherwise it&#39;s difficult to recognize which pairs belong together- especially when the code is long, as is the case here. Since we don&#39;t have to trouble-shoot a problem with how the code is running, it&#39;s not a big issue, here, but a good habit :-)"}, {"owner": {"reputation": 21, "user_id": 11193137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbdf8527bc8a00c1a7e38f08d0d4151e?s=128&d=identicon&r=PG&f=1", "display_name": "LimaWhiskey", "link": "https://stackoverflow.com/users/11193137/limawhiskey"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1552492577, "post_id": 55139607, "comment_id": 97032869, "body": "Thank you @CindyMeister that&#39;s useful to know."}], "owner": {"reputation": 21, "user_id": 11193137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbdf8527bc8a00c1a7e38f08d0d4151e?s=128&d=identicon&r=PG&f=1", "display_name": "LimaWhiskey", "link": "https://stackoverflow.com/users/11193137/limawhiskey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552479823, "creation_date": 1552472835, "last_edit_date": 1552479823, "question_id": 55139607, "link": "https://stackoverflow.com/questions/55139607/userform-vba-select-printer-before-printing", "title": "Userform VBA Select Printer before printing", "body": "<p>I have created a userform and have become stuck on the final stage and was wondering if somebody could assist or point me in the right direction.</p>\n\n<p>I have the user selecting checkboxes for the sheets they require to print, however, due to the printers being on a network I need them to select a printer so ideally would need a popup box or print preview. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n'OK = MsgBox(\"Printing\", vbExclamation + vbOKOnly, \"Sucsess\")\n\nIf Me.CheckBox1 = 0 And Me.CheckBox2 = 0 And Me.CheckBox3 = 0 And Me.CheckBox4 = 0 And Me.CheckBox5 = 0 And Me.CheckBox6 = 0 And Me.CheckBox7 = 0 And Me.CheckBox8 = 0 And Me.CheckBox9 = 0 And Me.CheckBox10 = 0 Then\n    MsgBox \"You need to select at least 1 form\", vbCritical + vbOKOnly, \"Error\"\nElse\n    If Me.CheckBox2 = 1 And Me.ComboBox3 = Null Then\n         MsgBox \"Please select the number of witness statements required!\", vbCritical + vbOKOnly, \"Witness Staements\"\n    Else\n        OK = MsgBox(\"Printing\", vbExclamation + vbOKOnly, \"Sucsess\")\n\n        'Print the First Page everytime\n        ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:= _\n          wdPrintDocumentContent, Pages:=\"1\" &amp; p\n        'Inserting Pre info Code into the form\n         Dim Pg1Name As Range\n         Set Pg1Name = ActiveDocument.Bookmarks(\"Pg1Name\").Range\n         Pg1Name.Text = Me.TextBox3.Value\n\nDim S1Name As Range\n    Set S1Name = ActiveDocument.Bookmarks(\"S1Name\").Range\n    S1Name.Text = Me.TextBox3.Value\n\nDim S5Name As Range\n    Set S5Name = ActiveDocument.Bookmarks(\"S5Name\").Range\n    S5Name.Text = Me.TextBox3.Value\n\nDim S6Name As Range\n    Set S6Name = ActiveDocument.Bookmarks(\"S6Name\").Range\n    S6Name.Text = Me.TextBox3.Value\n\nDim Pg1Date As Range\n    Set Pg1Date = ActiveDocument.Bookmarks(\"Pg1Date\").Range\n    Pg1Date.Text = Me.TextBox1.Value\n\nDim S1Date As Range\n    Set S1Date = ActiveDocument.Bookmarks(\"S1Date\").Range\n    S1Date.Text = Me.TextBox1.Value\n\nDim Pg1Time As Range\n    Set Pg1Time = ActiveDocument.Bookmarks(\"Pg1Time\").Range\n    Pg1Time.Text = Me.TextBox2.Value\n\nDim S1Time As Range\n    Set S1Time = ActiveDocument.Bookmarks(\"S1Time\").Range\n    S1Time.Text = Me.TextBox2.Value\n\nDim Pg1Dept As Range\n    Set Pg1Dept = ActiveDocument.Bookmarks(\"Pg1Dept\").Range\n    Pg1Dept.Text = Me.ComboBox2.Value\n\nDim S5Dept As Range\n    Set S5Dept = ActiveDocument.Bookmarks(\"S5Dept\").Range\n    S5Dept.Text = Me.ComboBox2.Value\n\nDim S6Dept As Range\n    Set S6Dept = ActiveDocument.Bookmarks(\"S6Dept\").Range\n    S6Dept.Text = Me.ComboBox2.Value\n\nDim Pg1Site As Range\n    Set Pg1Site = ActiveDocument.Bookmarks(\"Pg1Site\").Range\n    Pg1Site.Text = Me.ComboBox1.Value\n\n\n'Print Section 1 Immediate Response\nIf Accident_Incident_Form_Creator.CheckBox1.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Pages:=\"2\" &amp; p\n        End If\n\n'Print Section 2 Witness Statement\nIf Accident_Incident_Form_Creator.CheckBox2.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Copies:=Me.ComboBox3.Value, Pages:=\"3\" &amp; p\n        End If\n\n'Print Section 3 Information Gathering\nIf Accident_Incident_Form_Creator.CheckBox3.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Pages:=\"4\" &amp; p\n        End If\n\n'Print Section 4 First Aid\nIf Accident_Incident_Form_Creator.CheckBox4.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Pages:=\"5\" &amp; p\n        End If\n\n'Print Section 5 Damage Report\nIf Accident_Incident_Form_Creator.CheckBox5.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Pages:=\"6\" &amp; p\n        End If\n\n'Print Section 6 Environmental Report\nIf Accident_Incident_Form_Creator.CheckBox6.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Pages:=\"7\" &amp; p\n        End If\n\n'Print Section 7 &amp; 8 Manual Handling &amp; MHE\nIf Accident_Incident_Form_Creator.CheckBox7.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Pages:=\"8\" &amp; p\n        End If\n\n'Print Section 9 Root Cause Investigation\nIf Accident_Incident_Form_Creator.CheckBox8.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Pages:=\"9\" &amp; p\n        End If\n\n'Print Section 10 Root Cause Corrective Actions\nIf Accident_Incident_Form_Creator.CheckBox9.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Pages:=\"9\" &amp; p\n        End If\n\n'Print Section 11 Safety Signoff\nIf Accident_Incident_Form_Creator.CheckBox10.Value = True Then\n    ActiveDocument.ActiveWindow.PrintOut Range:=wdPrintRangeOfPages, Item:=wdPrintDocumentContent, Pages:=\"11\" &amp; p\n        End If\n\nIf OK = 1 Then\n\n'Close and don't save\n    Application.DisplayAlerts = False\n\n\n    ActiveDocument.Close\n    ActiveWindow.Close\n\n    Application.DisplayAlerts = True\n\nEnd If\nEnd If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1552472620, "post_id": 55139487, "comment_id": 97019284, "body": "Is the workbook or any worksheet protected?"}, {"owner": {"reputation": 3895, "user_id": 4972716, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a7c5b54d4f13c6bb4d1d4d40ca4d4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Stacey", "link": "https://stackoverflow.com/users/4972716/stacey"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1552472845, "post_id": 55139487, "comment_id": 97019431, "body": "workbook not protected, the sheet I can see is not protected, unsure for the two sheets I can&#39;t see"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1552473367, "post_id": 55139487, "comment_id": 97019765, "body": "Have a looke <a href=\"https://stackoverflow.com/questions/28220765/looped-charts-and-worksheets-as-sheets-unsuccessfully-exactly-what-caused-the-e\">here</a> to see what OP there did to resolve the issue"}, {"owner": {"reputation": 773, "user_id": 11158132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836d70ae291879b732a8bc21190f10a9?s=128&d=identicon&r=PG&f=1", "display_name": "JLCH", "link": "https://stackoverflow.com/users/11158132/jlch"}, "edited": false, "score": 0, "creation_date": 1552474125, "post_id": 55139487, "comment_id": 97020257, "body": "try <code>For Each ws In ThisWorkbook.Sheets     If ws.Visible = xlSheetHidden Then ws.Unprotect</code>     to check if the hidden sheets are protected"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552476472, "post_id": 55139487, "comment_id": 97021626, "body": "Are you 100% sure that the workbook is not protected? Press <code>Alt - T - P - W</code> to check"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552476227, "post_id": 55140679, "comment_id": 97021471, "body": "That should not make a difference :) The value of <code>True</code> is <code>-1</code>.. Try this in immediate window <code>?True=xlSheetVisible</code> or <code>?True=-1</code>"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552477706, "post_id": 55140679, "comment_id": 97022384, "body": "@SiddharthRout I agree.  It shouldn&#39;t make a difference <b>but</b> it does seem to.  Maybe the internal enumeration of <code>xlSheetVisible</code> is wrong and VBA sees it as 0 when it should be -1."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552477823, "post_id": 55140679, "comment_id": 97022451, "body": "Have never see a scenario where VBA intepretted xlSheetVisible as 0 :)"}], "tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 0, "last_activity_date": 1552476009, "creation_date": 1552476009, "answer_id": 55140679, "question_id": 55139487, "link": "https://stackoverflow.com/questions/55139487/excel-workbook-sheets-wont-unhide/55140679#55140679", "title": "Excel workbook sheets won&#39;t unhide", "body": "<p>I don't know why but I've never had any success using <code>ws.Visible = xlSheetVisible</code>.  I always use:</p>\n\n<p><code>ws.Visible = True</code></p>\n\n<p>and it always works!</p>\n"}], "owner": {"reputation": 3895, "user_id": 4972716, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a7c5b54d4f13c6bb4d1d4d40ca4d4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Stacey", "link": "https://stackoverflow.com/users/4972716/stacey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 758, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552852432, "creation_date": 1552472490, "last_edit_date": 1552852432, "question_id": 55139487, "link": "https://stackoverflow.com/questions/55139487/excel-workbook-sheets-wont-unhide", "title": "Excel workbook sheets won&#39;t unhide", "body": "<p>I have an Excel workbook that has three tabs.  Two of which are hidden.  When I try an unhide the hidden worksheets worksheets the unhide option is greyed out.  I have opened the project window in VBA IDE and can see that the Visible options are set to <code>0- xlSheetHidden</code> for the two sheets.  I have tried to change the visibility here to <code>-1 -xlSheetVisable</code> but I get the error:</p>\n\n<p>Unable to set the Visibility property of the Worksheet Class.</p>\n\n<p>I have also tied to unhide the sheets with the following code:</p>\n\n<pre><code>Sub UnhideAllSheets()    \n    'Unhide all sheets in workbook.    \n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets \n        ws.Visible = xlSheetVisible\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>But I get the error:</p>\n\n<blockquote>\n  <p>Run-time 'Visible of object'_Worksheet' failed</p>\n</blockquote>\n\n<p>The worksheets do exist and there are no passwords or any protection anywhere in the workbook.</p>\n"}, {"tags": ["excel", "vba", "date", "excel-formula", "count"], "comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1552471589, "post_id": 55138795, "comment_id": 97018621, "body": "What&#39;s wrong with putting the dates on the rows and making a pivot table? General Excel practice says that your set ranges should go left to right and your variables go up and down. Please check my answer for a better method"}], "answers": [{"tags": [], "owner": {"reputation": 800, "user_id": 6310948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d0VKq.jpg?s=128&g=1", "display_name": "Erjon", "link": "https://stackoverflow.com/users/6310948/erjon"}, "is_accepted": false, "score": 1, "last_activity_date": 1552471660, "creation_date": 1552471660, "answer_id": 55139189, "question_id": 55138795, "link": "https://stackoverflow.com/questions/55138795/excel-counting-specific-words-filtered-by-months/55139189#55139189", "title": "Excel - Counting specific words filtered by months", "body": "<p>In the desired Sheet you have to put your column name like this 1/1/2019, 1/2/2019, 1/3/2019, and format them as \"mmm\", in this way they will look like: Jan, Feb, March</p>\n\n<p>Then you need this formula:</p>\n\n<pre><code> =COUNTIFS($A$1:$F$1,\"&gt;=\"&amp;K$2,$A$1:$F$1,\"&lt;=\"&amp;EOMONTH(K$2,0),$A$2:$F$2,$J3)\n</code></pre>\n\n<p>$A$1:$F$1 is in Sample data, the range that has dates</p>\n\n<p>K$2 is the cell that has Jan</p>\n\n<p>$A$2:$F$2 is in Sample data, the range that has names</p>\n\n<p><a href=\"https://i.stack.imgur.com/EYsNq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EYsNq.png\" alt=\"enter image description here\"></a></p>\n\n<p>in this way you will have the results requested, i just tested it.</p>\n\n<p>Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "is_accepted": false, "score": 0, "last_activity_date": 1552471821, "creation_date": 1552471821, "answer_id": 55139239, "question_id": 55138795, "link": "https://stackoverflow.com/questions/55138795/excel-counting-specific-words-filtered-by-months/55139239#55139239", "title": "Excel - Counting specific words filtered by months", "body": "<p>Just use a pivot table</p>\n\n<p>This then becomes a much better way to go about showing data, as put in my comment:</p>\n\n<blockquote>\n  <p>What's wrong with putting the dates on the rows and making a pivot table? General Excel practice says that your set ranges should go left to right and your variables go up and down. Please check my answer for a better method</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/8JjyL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8JjyL.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/j0pn4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j0pn4.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11196261, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o5xGIifVaXY/AAAAAAAAAAI/AAAAAAAAAIY/OrVBglxtz3c/photo.jpg?sz=128", "display_name": "Ashwin Dhandhania", "link": "https://stackoverflow.com/users/11196261/ashwin-dhandhania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1552472715, "creation_date": 1552470543, "last_edit_date": 1552471268, "question_id": 55138795, "link": "https://stackoverflow.com/questions/55138795/excel-counting-specific-words-filtered-by-months", "title": "Excel - Counting specific words filtered by months", "body": "<p>I'm looking to generate the number of \"Ashwin\" and \"Aron\" in a particular month. The sample data and desired result is as below. </p>\n\n<p>Can't seem to arrive at the right code to achieve the numbers in a table format. Any help will be greatly appretiated! </p>\n\n<p>Sample Data :</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nfz48.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nfz48.png\" alt=\"enter image description here\"></a></p>\n\n<p>Desired Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hoUiX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hoUiX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "vba", "ms-access", "querying"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1552469937, "post_id": 55138477, "comment_id": 97017534, "body": "What do you want to do, this will just put the SQL in the textbox.  A bit more is needed for the results if that&#39;s what you are after?  Also, it&#39;s on the click event, not the change event, not sure if that is intentional."}, {"owner": {"reputation": 50, "user_id": 10817650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eccb5332fcd7825cffcfde370385e61?s=128&d=identicon&r=PG&f=1", "display_name": "HTTP 418", "link": "https://stackoverflow.com/users/10817650/http-418"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1552470334, "post_id": 55138477, "comment_id": 97017811, "body": "@Nathan_Sav I want to query for the prices that are located within column &quot;London&quot;, which is found in the table &quot;table_prices&quot;. The textbox should list all prices found in the column.  I think I need to set the Control Source, but this doesn&#39;t work either: <code>Me.TextBox1.ControlSource = Me.[London].Value&#180; (results in </code>#Name?`).  The reason it is onclick is that you need to click on an item on a dropdown menu before I want the values to be shown - dont know if I am using it how its intended?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1552470396, "post_id": 55138477, "comment_id": 97017844, "body": "Should use AfterUpdate event of Combobox1. Then you also really need a &#39;cascading&#39; combobox to hold the related prices <a href=\"http://www.fmsinc.com/MicrosoftAccess/Forms/combo-boxes/cascading.html\" rel=\"nofollow noreferrer\">fmsinc.com/MicrosoftAccess/Forms/combo-boxes/cascading.html</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1552470958, "post_id": 55138477, "comment_id": 97018242, "body": "You could look at building the sql like so <code>SQL = &quot;SELECT table_prices.[&quot; &amp; me.combobox1.value &amp; &quot;]&quot;          &amp; &quot; FROM tabel_prices &quot;</code> also.  Maybe a listbox would also help, with the SQL set and then use the combobox and <code>.requery</code> ?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1552477049, "post_id": 55138477, "comment_id": 97021939, "body": "If you have a field for each city, then table_prices is not normalized. Do you really have table spelled as tabel?"}, {"owner": {"reputation": 50, "user_id": 10817650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eccb5332fcd7825cffcfde370385e61?s=128&d=identicon&r=PG&f=1", "display_name": "HTTP 418", "link": "https://stackoverflow.com/users/10817650/http-418"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552477982, "post_id": 55138477, "comment_id": 97022548, "body": "@June7 Yes, the spelling is not the problem, although grammar is not correct. I like your idea of cascading combobox, which I might have to go with. The problem is that there is already a current design in which they use textboxes, so management prioritize if I can fit a solution with my first proposed approach. Thanks for the advice still. The table of cities were something I came up with as an example and not the actual data I am working with"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1552478305, "post_id": 55138477, "comment_id": 97022760, "body": "Okay, textbox can be filled with prices by iterating recordset in a VBA loop block and concatenating the values. However, the result is just a string of characters, not a list of selectable items. Is that what you want? Review <a href=\"http://allenbrowne.com/func-concat.html\" rel=\"nofollow noreferrer\">allenbrowne.com/func-concat.html</a>"}, {"owner": {"reputation": 50, "user_id": 10817650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eccb5332fcd7825cffcfde370385e61?s=128&d=identicon&r=PG&f=1", "display_name": "HTTP 418", "link": "https://stackoverflow.com/users/10817650/http-418"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552478699, "post_id": 55138477, "comment_id": 97023032, "body": "@June7 It might be it. I will definitely try it out. Otherwise, I will use the cascading combo boxes, which it feels like I am getting more keen on. So either way, I will probably use one of your solutions. I appreciate the help a lot, so thank you :)"}], "owner": {"reputation": 50, "user_id": 10817650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eccb5332fcd7825cffcfde370385e61?s=128&d=identicon&r=PG&f=1", "display_name": "HTTP 418", "link": "https://stackoverflow.com/users/10817650/http-418"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552469668, "creation_date": 1552469668, "question_id": 55138477, "link": "https://stackoverflow.com/questions/55138477/vba-ms-access-set-text-box-to-query", "title": "VBA, MS Access - Set text box to query", "body": "<p>I have a form, a combobox (dropdown menu) and a textbox.</p>\n\n<p>When a specific value from the combobox is chosen, I want the textbox to query for values in a table.</p>\n\n<p>This is my idea, but it's not working:</p>\n\n<pre><code>Private Sub Combobox1_Click()\nIf Me.Combobox1.Value = \"London\" Then\n\n    Dim SQL As String\n\n    SQL = \"SELECT tabel_prices.[London]\" _\n        &amp; \"FROM tabel_prices \"\n\n    Me.TextBox1.Value = SQL\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1552469005, "post_id": 55137753, "comment_id": 97016930, "body": "It will be the same as you are accessing them to put them in, you are adding the collection item, not the collection, so you are saying bucket 1 is split into 2 buckets.  <code>op3collection.add allcollection</code> would be a collection of collections.  So you would say <code>NewCollection.Item(x)</code> what"}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1552469129, "post_id": 55137753, "comment_id": 97017004, "body": "AllCollection.Add Sheets(&quot;All&quot;).Range(&quot;A2:AL&quot; &amp; LastRow).Value line adds something like AllCollection -&gt; Items 1 (1) .... -&gt; Items (1,1) .... Items (i,1), where Items 1(1) is equal to row in table, and I want to access first cell of that row,"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1552471158, "creation_date": 1552471158, "answer_id": 55139010, "question_id": 55137753, "link": "https://stackoverflow.com/questions/55137753/how-to-read-collection-of-collections-element-in-vba/55139010#55139010", "title": "how to read Collection of Collections element in vba?", "body": "<p><code>Range(\"A2:AL\" &amp; LastRow).Value</code> gives you a 2-dimensional array with all the values you have in the cells of the range. </p>\n\n<p>So when you write <code>AllCollection.Add Sheets(\"All\").Range(\"A2:AL\" &amp; LastRow).Value</code>, you are adding a new item into the collection, holding a 2-dimensional array. </p>\n\n<p>This stays true when you add one of the items from one collection to the second: <code>NewCollection.Add AllCollection.Item(i)</code> will put an d-dimensional array into ? \n<code>NewCollection</code> - but be carefull, it is <em>the same</em> array, not a copy.</p>\n\n<p>You access the single items of the array with\n<code>AllCollection(1)(1,1)</code> or (maybe easier to read) <code>AllCollection.item(1)(1,1)</code></p>\n"}, {"tags": [], "owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "is_accepted": false, "score": 0, "last_activity_date": 1552482144, "creation_date": 1552482144, "answer_id": 55142540, "question_id": 55137753, "link": "https://stackoverflow.com/questions/55137753/how-to-read-collection-of-collections-element-in-vba/55142540#55142540", "title": "how to read Collection of Collections element in vba?", "body": "<p>If anyone wonders about similar problem I wrote different code with arrays, that is much faster. </p>\n\n<pre><code>NewArray = Sheets(\"All\").Range(\"A2:AL\" &amp; LastRow).Value\nOP3Array = Sheets(\"All\").Range(\"A2:AL\" &amp; LastRow).Value\nFor i = 1 To LastRow - 1\n    If NewArray(i, 1) &lt;&gt; \"*\" Then\n        For j = 1 To 38\n            NewArray(i, j) = Empty\n        Next\n    End If\n    If OP3Array(i, 1) &lt;&gt; 3 Then\n        For j = 1 To 38\n            OP3Array(i, j) = Empty\n        Next\n    End If\n    Str = \"Split: Copying data from sheet /All/ to sheets /New/,/OldPop3/ \"\n    Call ProgressOfCode(i, LastRow - 1, Str)\n    Str = \"\"\nNext\n\nArraySize = UBound(NewArray)\nSheets(\"New\").Range(\"A2:AL\" &amp; ArraySize + 1).Value = NewArray\n'Sorts and pushes empty rows to bottom\nSheets(\"New\").Range(\"A2:AL\" &amp; ArraySize + 1).Sort \nKey1:=Sheets(\"New\").Range(\"B2\"), Order1:=xlAscending, Header:=xlNo, _\nOrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\nDataOption1:=xlSortTextAsNumbers\n\nArraySize = UBound(OP3Array)\nSheets(\"OldPop3\").Range(\"A2:AL\" &amp; ArraySize + 1).Value = OP3Array\n'Sorts and pushes empty rows to bottom\nSheets(\"OldPop3\").Range(\"A2:AL\" &amp; ArraySize + 1).Sort \nKey1:=Sheets(\"OldPop3\").Range(\"B2\"), Order1:=xlAscending, Header:=xlNo, _\nOrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\nDataOption1:=xlSortTextAsNumbers\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1552484807, "creation_date": 1552467314, "question_id": 55137753, "link": "https://stackoverflow.com/questions/55137753/how-to-read-collection-of-collections-element-in-vba", "title": "how to read Collection of Collections element in vba?", "body": "<p>I have made collection named AllCollection and assigned data from range in sheet \"All\". Now I'm trying to compare value in collection (i) and element (i,1), however I can't figure out correct syntax. I have tried countless forms, like AllCollection(i)(i, 1) or AllCollection(i(i, 1)) without luck. I'm not using arrays, because I dont know sizes of OP3Collection and NewCollection.</p>\n\n<pre><code>Dim OP3Collection As New Collection\nDim NewCollection As New Collection\nDim AllCollection As New Collection\n...\nsome other code\n...\nAllCollection.Add Sheets(\"All\").Range(\"A2:AL\" &amp; LastRow).Value\nLastRowC = 0\nFor i = 1 To LastRow - 1\n    If AllCollection.Item1(i).Items1(i, 1) = \"*\" Then\n        NewCollection.Add AllCollection.Item(i)\n    ElseIf AllCollection.Item1(i).Items1(i, 1) = 3 Then\n        OP3Collection.Add AllCollection.Item(i)\n    End If\n    Str = \"Split: Copying data from sheet /All/ to sheets /New/,/OldPop3/ \"\n    Call ProgressOfCode(i, LastRow - 1, Str)\n    Str = \"\"\nNext\nLastRowC = NewCollection.Count\nSheets(\"New\").Range(\"A2:AL\" &amp; LastRowC + 1).Value = NewCollection\nLastRowC = OP3Collection.Count\nSheets(\"OldPop3\").Range(\"A2:AL\" &amp; LastRowC + 1).Value = OP3Collection\n...\n</code></pre>\n"}, {"tags": ["excel", "vba", "automation", "rounding"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11174618"}, "edited": false, "score": 0, "creation_date": 1552467167, "post_id": 55137691, "comment_id": 97015792, "body": "ActiveCell should probably be ActiveSheet."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1552479697, "post_id": 55137691, "comment_id": 97023686, "body": "For the error you mention, note that objects need to be <code>Set</code>.  So you should have <code>Set rng = Range(&quot;A1&quot;,...)</code>  Of course, there are other errors in your code as noted in some of the answers below."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1552486109, "post_id": 55137691, "comment_id": 97028084, "body": "Note that VBA&#39;s <code>Round</code> function uses so called <i>bankers&#39; rounding</i> which might return unwanted results; it&#39;s a standard form of rounding used in financial and statistical operations in order to minimize significant rounding errors over multiple rounding operations by consistently rounding midpoint values in a single direction - c.f. <a href=\"https://stackoverflow.com/questions/46850958/how-excel-vba-rounds-doubles-to-integers/48042374#48042374\">How Excel VBA rounds doubles...</a> An alternative would be to use <code>WorkSheetFunction.Round</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 0, "last_activity_date": 1552467591, "creation_date": 1552467591, "answer_id": 55137841, "question_id": 55137691, "link": "https://stackoverflow.com/questions/55137691/rounding-off-any-cell-with-numbers-using-vba/55137841#55137841", "title": "Rounding off any cell with numbers using VBA", "body": "<p>You may this.</p>\n\n<pre><code>Sub RoundValues()\nDim cel As Range, rng As Range\n\nSet rng = Range(\"A1\", Range(\"A1\").End(xlDown).Address)\n\n    For Each cel In rng\n        If cel.Value &lt;&gt; \"\" And IsNumeric(cel.Value) Then\n            cel.Value = Round(cel.Value2, 2)\n        End If\n    Next cel\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1552467797, "creation_date": 1552467797, "answer_id": 55137899, "question_id": 55137691, "link": "https://stackoverflow.com/questions/55137691/rounding-off-any-cell-with-numbers-using-vba/55137899#55137899", "title": "Rounding off any cell with numbers using VBA", "body": "<p>If you just want to set the number format then try this</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim rng As Range\n\n    Set ws = Sheet1 '&lt;~~ Change this to the relevant sheet\n\n    With ws\n        On Error Resume Next\n        Set rng = .Cells.SpecialCells(xlCellTypeConstants, 1)\n        On Error GoTo 0\n\n        If Not rng Is Nothing Then rng.NumberFormat = \"0.00\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>If you want to round it then you do not need to loop through all cells. Use <code>SpecialCells</code> to loop through only cells which have number</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim rng As Range, aCell As Range\n\n    Set ws = Sheet1 '&lt;~~ Change this to the relevant sheet\n\n    With ws\n        On Error Resume Next\n        Set rng = .Cells.SpecialCells(xlCellTypeConstants, 1)\n        On Error GoTo 0\n\n        If Not rng Is Nothing Then\n            For Each aCell In rng\n                aCell.Value = Round(aCell.Value, 2)\n            Next\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 1, "last_activity_date": 1552467853, "creation_date": 1552467853, "answer_id": 55137924, "question_id": 55137691, "link": "https://stackoverflow.com/questions/55137691/rounding-off-any-cell-with-numbers-using-vba/55137924#55137924", "title": "Rounding off any cell with numbers using VBA", "body": "<p>If you're setting a range, you need the <code>SET</code> command, and you should not <code>.Select</code> while setting:</p>\n\n<pre><code>rng = Range(\"A1\", ActiveCell.SpecialCells(xlLastCell)).Select\n</code></pre>\n\n<p>becomes:</p>\n\n<pre><code>Set rng = Range(\"A1\", ActiveCell.SpecialCells(xlLastCell))\n</code></pre>\n\n<p>Also, in your rounding you have specified a negative value.</p>\n\n<pre><code>cell.Value = Round(cell.Value, -2)\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>cell.Value = Round(cell.Value, 2)\n</code></pre>\n\n<p>So the code ends up as so:</p>\n\n<pre><code>Sub roundthissheet()\n    Dim cell As Range, rng As Range\n    Set rng = Range(\"A1\", ActiveCell.SpecialCells(xlLastCell))\n    For Each cell In rng.Cells\n        If cell.Value &lt;&gt; \"\" And IsNumeric(cell.Value) Then\n            cell.Value = Round(cell.Value, 2)\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11195929, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158451566679698/picture?type=large", "display_name": "Shawn We", "link": "https://stackoverflow.com/users/11195929/shawn-we"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1552467853, "creation_date": 1552467054, "last_edit_date": 1552467249, "question_id": 55137691, "link": "https://stackoverflow.com/questions/55137691/rounding-off-any-cell-with-numbers-using-vba", "title": "Rounding off any cell with numbers using VBA", "body": "<p>I have a non fixed set of data that may vary in rows and columns.</p>\n\n<p>I intend to use VBA to search the whole dataset and round off all cells with numbers to a specified decimal place. (or rounded to nearest 100s or 10s too)</p>\n\n<p>I have the following code:</p>\n\n<pre><code>Sub roundthissheet()\nDim cell As Range, rng As Range\n\nrng = Range(\"A1\", ActiveCell.SpecialCells(xlLastCell)).Select\n\nFor Each cell In rng.cells\n    If cell.Value &lt;&gt; \"\" And IsNumeric(cell.Value) Then\n        cell.Value = Round(cell.Value, -2)\n    End If\nNext cell\nEnd Sub\n</code></pre>\n\n<p>However, my if statement does not seem to run at all and I encounter the error message \"Object variable or With block variable not set\"</p>\n\n<p>How shall I proceed with regards to this error?</p>\n"}, {"tags": ["excel", "vba", "search", "exact-match"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552467139, "post_id": 55137527, "comment_id": 97015777, "body": "<code>SearchString = &quot;=*&quot; &amp; mySearch &amp; &quot;*&quot;</code> You are searching for anything that will contain <code>mySearch</code>.. Use <code>SearchString = &quot;=&quot; &amp; mySearch</code>"}, {"owner": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552470449, "post_id": 55137527, "comment_id": 97017880, "body": "Perfect - did the trick....I didn&#39;t realise that I had the search in as such. Please post your answer so that I can tick this off :)"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1552470606, "creation_date": 1552470606, "answer_id": 55138819, "question_id": 55137527, "link": "https://stackoverflow.com/questions/55137527/searching-for-exact-match-in-excel-using-vba/55138819#55138819", "title": "Searching for exact match in excel using VBA", "body": "<p><code>SearchString = \"=*\" &amp; mySearch &amp; \"*\"</code> You are searching for anything that will contain mySearch.</p>\n\n<p>Change it to <code>SearchString = \"=\" &amp; mySearch</code></p>\n"}], "owner": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 55138819, "answer_count": 1, "score": 0, "last_activity_date": 1552470606, "creation_date": 1552466453, "question_id": 55137527, "link": "https://stackoverflow.com/questions/55137527/searching-for-exact-match-in-excel-using-vba", "title": "Searching for exact match in excel using VBA", "body": "<p>I have the below code and am working on creating a search bar with options on a table to filter through. It works perfectly, however I cannot seem to get it to search/filter for exact matches. For example, if I input 'GE' it will return all matches where words include 'GE' whilst I want only those fields where the two letters together are located.</p>\n\n<p>Can anyone help me tweak my code?</p>\n\n<pre><code>  'Filtered Data Range (include column heading cells)\n     'Cell Range\n       Set DataRange = sht.ListObjects(\"Table1\").Range 'Table\n\n'Retrieve User's Search Input\n\n  mySearch = sht.OLEObjects(\"Hello\").Object.Text 'ActiveX Control\n\n\n'Determine if user is searching for number or text\n  If IsNumeric(mySearch) = True Then\n    SearchString = \"=\" &amp; mySearch\n  Else\n    SearchString = \"=*\" &amp; mySearch &amp; \"*\"\n\n'Loop Through Option Buttons\n  For Each myButton In sht.OptionButtons\n    If myButton.Value = 1 Then\n      ButtonName = myButton.Text\n      Exit For\n    End If\n  Next myButton\n\n'Determine Filter Field\n  On Error GoTo HeadingNotFound\n    myField = Application.WorksheetFunction.Match(ButtonName, DataRange.Rows(1), 0)\n  On Error GoTo 0\n\n'Filter Data\n  DataRange.AutoFilter _\n    Field:=myField, _\n    Criteria1:=SearchString, _\n    Operator:=xlAnd\n\n'Clear Search Field\n  'sht.Shapes(\"UserSearch\").TextFrame.Characters.Text = \"\" 'Control Form\n  sht.OLEObjects(\"Hello\").Object.Text = \"\" 'ActiveX Control\n  'sht.Range(\"A1\").Value = \"\" 'Cell Input\n\nExit Sub\n\n'ERROR HANDLERS\nHeadingNotFound:\n  MsgBox \"The column heading [\" &amp; ButtonName &amp; \"] was not found in cells \" &amp; DataRange.Rows(1).Address &amp; \". \" &amp; _\n    vbNewLine &amp; \"Please check for possible typos.\", vbCritical, \"Header Name Not Found!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "google-apps-script", "google-sheets-api"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 9315937, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0YQw3ogyzQo/AAAAAAAAAAI/AAAAAAAAa0A/N_BpGNX9Sy4/photo.jpg?sz=128", "display_name": "Piyush Goel", "link": "https://stackoverflow.com/users/9315937/piyush-goel"}, "is_accepted": false, "score": 2, "last_activity_date": 1552470166, "creation_date": 1552470166, "answer_id": 55138653, "question_id": 55137298, "link": "https://stackoverflow.com/questions/55137298/copy-data-from-google-sheet-to-excel/55138653#55138653", "title": "Copy data from Google Sheet to Excel", "body": "<p>Saving/exporting to an Excel can also be automated (save to Google Drive every few mins using Apps Script Scheduled Triggers and access the file using the Drive API) but since you said you don't seem to want to export to Excel, you could try doing the following:</p>\n\n<ol>\n<li>From VBA, access Google Sheets API 'get values' end-point with the range \nfrom where you want the data (<a href=\"https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/get\" rel=\"nofollow noreferrer\">https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values/get</a>) [<strong>See this thread: <a href=\"https://stackoverflow.com/questions/38246789/how-do-we-use-restful-apis-from-excel-macros-vba\">How do we use restful APIs from Excel macros (vba)?</a></strong>].</li>\n<li>Parse the JSON and save the data in your excel sheet [<strong>See this thread: <a href=\"https://stackoverflow.com/questions/50068973/json-vba-parse-to-excel\">JSON VBA Parse to Excel</a></strong> ].</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 11195814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ih9Fa.jpg?s=128&g=1", "display_name": "Renier Wessels", "link": "https://stackoverflow.com/users/11195814/renier-wessels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2405, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552470166, "creation_date": 1552465591, "last_edit_date": 1552466190, "question_id": 55137298, "link": "https://stackoverflow.com/questions/55137298/copy-data-from-google-sheet-to-excel", "title": "Copy data from Google Sheet to Excel", "body": "<p>I want to essentially run a VBA Macro every few minutes with information from a Google Sheet. I have tried using the \"Publish to web\" option, but it takes more than 5 minutes to refresh due to the size of the data. I also don't want to export or save as an Excel doc every few minutes as this needs to be automated. I also don't want to use RPA.</p>\n\n<p>I merely have a range of data in a Google Sheet that I want to transfer into Excel every few minutes. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1552465146, "post_id": 55137099, "comment_id": 97014710, "body": "With <code>.Offset(-1,0)</code>, you are going up one <code>row</code> from a given range. I&#39;m thinking you&#39;re already at row 1 when the macro tries to go one row up, which results in an error."}, {"owner": {"reputation": 23, "user_id": 11195496, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yg6CPXk0rMk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuG6PrfkWCf3DE5TYpWu98I_qkTA/mo/photo.jpg?sz=128", "display_name": "Martin Himmelboe", "link": "https://stackoverflow.com/users/11195496/martin-himmelboe"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1552465519, "post_id": 55137099, "comment_id": 97014897, "body": "Ah so what you are saying is that, for the first value of p it errors? For the remaining values of p I guess it is OK?"}, {"owner": {"reputation": 23, "user_id": 11195496, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yg6CPXk0rMk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuG6PrfkWCf3DE5TYpWu98I_qkTA/mo/photo.jpg?sz=128", "display_name": "Martin Himmelboe", "link": "https://stackoverflow.com/users/11195496/martin-himmelboe"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1552465695, "post_id": 55137099, "comment_id": 97014986, "body": "I just changed the Offset to refer down instead and it worked! Thank you for the help!!!"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1552465748, "post_id": 55137099, "comment_id": 97015014, "body": "If the range <code>p</code> were to be in row 1, yes. This is not unlikely given how the loop can be any range within column <code>A</code>. Glad to see you figured it out"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1552465870, "post_id": 55137099, "comment_id": 97015090, "body": "A good practice when encountering such errors is using the <code>F8</code> key to step through the code. This allows you to see current variable values and figure out the cause of the error."}, {"owner": {"reputation": 23, "user_id": 11195496, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yg6CPXk0rMk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuG6PrfkWCf3DE5TYpWu98I_qkTA/mo/photo.jpg?sz=128", "display_name": "Martin Himmelboe", "link": "https://stackoverflow.com/users/11195496/martin-himmelboe"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1552482695, "post_id": 55137099, "comment_id": 97025631, "body": "I didn&#39;t know about that feature. Thank you very much!"}], "owner": {"reputation": 23, "user_id": 11195496, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yg6CPXk0rMk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuG6PrfkWCf3DE5TYpWu98I_qkTA/mo/photo.jpg?sz=128", "display_name": "Martin Himmelboe", "link": "https://stackoverflow.com/users/11195496/martin-himmelboe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1579857077, "creation_date": 1552464761, "last_edit_date": 1579857077, "question_id": 55137099, "link": "https://stackoverflow.com/questions/55137099/vba-sub-only-works-once-after-edit", "title": "VBA Sub only works once after edit", "body": "<p>In column A, I have blocks of matching text between which I want to draw borders. The blocks are of different size, so to distinguish between blocks I test if the value of two adjacent cells are different.</p>\n\n<p>First I tried this:</p>\n\n<pre><code>Sub draw_borders()\n\n\n   Dim p As Range, a As Variant, b As Range, c As Range, d As Variant\n   For Each p In Intersect(Range(\"A:A\"), sht.UsedRange)\n      a = p.Value\n      Set c = Range(Cells(p.Row, p.Column), Cells(p.Row, p.Column))\n      b = c.Offset(-1, 0)\n      d = b.Value\n      If a &lt;&gt; d Then\n          Dim DataRange3 As Range\n          Set DataRange3 = Range(Cells(p.Row, 1), Cells(p.Row, 2))\n          DataRange3.Borders(xlEdgeTop).LineStyle = xlContinuous\n      End If\n   Next p\nEnd Sub\n</code></pre>\n\n<p>By the way, \"sht\" is defined earlier as the active worksheet. I kept getting a runtime error at:</p>\n\n<pre><code>b = c.Offset(-1, 0)\n</code></pre>\n\n<p>So I tried to include the offset in the definition of c, deleted the definition of b and edited the definition of d.</p>\n\n<pre><code>Sub draw_borders()\n\n\n   Dim p As Range, a As Variant, b As Range, c As Range, d As Variant\n   For Each p In Intersect(Range(\"A:A\"), sht.UsedRange)\n      a = p.Value\n      Set c = Range(Cells(p.Row, p.Column), Cells(p.Row, p.Column)).Offset(-1,0)\n\n      d = c.Value\n      If a &lt;&gt; d Then\n          Dim DataRange3 As Range\n          Set DataRange3 = Range(Cells(p.Row, 1), Cells(p.Row, 2))\n          DataRange3.Borders(xlEdgeTop).LineStyle = xlContinuous\n      End If\n   Next p\nEnd Sub\n</code></pre>\n\n<p>This worked... but only once. If I run it again, it gives me a runtime error at:</p>\n\n<pre><code>Set c = Range(Cells(p.Row, p.Column), Cells(p.Row, p.Column)).Offset(-1,0)\n</code></pre>\n\n<p>What is wrong with my code?</p>\n\n<p>I only started learning about vba this week and I don't have any experience in programming, so my formatting might be a bit off.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1164, "user_id": 1141944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4100d16b2367fb136799807312dd9f4e?s=128&d=identicon&r=PG", "display_name": "tshimkus", "link": "https://stackoverflow.com/users/1141944/tshimkus"}, "edited": false, "score": 0, "creation_date": 1552464645, "post_id": 55136977, "comment_id": 97014487, "body": "Please add you put your code in a code block and maybe just include that parts that might be helpful in answering the question. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and how to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 2, "creation_date": 1552465329, "post_id": 55136977, "comment_id": 97014796, "body": "Are you sure it is an infinite loop, and not that you have a significantly sizes <code>recordset</code> which just takes a while for VBA to go through?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552465754, "post_id": 55136977, "comment_id": 97015020, "body": "Did you test the query SQL in query designer? The query should not cause infinite loop. The code is repeatedly editing the same record in rcset. Have you step debugged?"}, {"owner": {"reputation": 11, "user_id": 11195700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7899571f7920ce94bd2e69b313267dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Sabricole", "link": "https://stackoverflow.com/users/11195700/sabricole"}, "edited": false, "score": 0, "creation_date": 1552469822, "post_id": 55136977, "comment_id": 97017464, "body": "I test the SQL query in designer and it works fine, the schsql query is very fast under 3 seconds, but when it goes to update in the loop, it takes too much time, maybe i update many times the same lines"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1552471173, "post_id": 55136977, "comment_id": 97018360, "body": "I can&#39;t try this on my computer but I would start with printing some identifiers of rst before retrieving rcset. Maybe editing the records resets the selection query and rst moves to the first record again."}, {"owner": {"reputation": 11, "user_id": 11195700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7899571f7920ce94bd2e69b313267dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Sabricole", "link": "https://stackoverflow.com/users/11195700/sabricole"}, "edited": false, "score": 0, "creation_date": 1552641278, "post_id": 55136977, "comment_id": 97096084, "body": "Thanks i found a solution, by modify a query, because i set a join between the table i want to update and the others tables where data come from, otherwise if i don&#39;t make this join it doesn&quot;t work, thanks for all help :)"}], "owner": {"reputation": 11, "user_id": 11195700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7899571f7920ce94bd2e69b313267dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Sabricole", "link": "https://stackoverflow.com/users/11195700/sabricole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552468546, "creation_date": 1552464225, "last_edit_date": 1552468546, "question_id": 55136977, "link": "https://stackoverflow.com/questions/55136977/infinite-loop-in-my-vba-access-program-why", "title": "Infinite loop in my vba access program why?", "body": "<pre><code>schsql = \"SELECT obi_cl_cde_lig_cad.cpt_cde_cl, obi_cl_cde_lig_cad.no_int_lig_cde_cl, obi_cl_cde_lig_cad.no_int_cde_cad_cl, obi_cl_cde_lig_cad.no_int_ord_fab, obi_cl_cde_lig_cad.dte_liv_conf_cde_cad_cl, obi_cl_cde_lig_cad.dte_hre_exp_prev, obi_cl_cde.pt_bloq, obi_cl_cde_lig.pt_force_sld, obi_cl_cde_lig_cad.pt_sld_cad, obi_cl_cde_lig_cad.qte_liv_cde_cad_cl, obi_cl_cde_lig.pt_att_lig_cde_cl, obi_cl_cde_lig_cad.pt_prev_cde_cad_cl, obi_cl_cde_lig_cad.qte_cde_cad_cl, obi_ordfab.cd_etat_ordfab \" &amp; vbCrLf\nschsql = schsql &amp; \"FROM obi_ordfab RIGHT JOIN (obi_cl_cde INNER JOIN (obi_cl_cde_lig_cad INNER JOIN obi_cl_cde_lig ON (obi_cl_cde_lig_cad.no_ste = obi_cl_cde_lig.no_ste) AND (obi_cl_cde_lig_cad.cpt_cde_cl = obi_cl_cde_lig.cpt_cde_cl) AND (obi_cl_cde_lig_cad.no_int_lig_cde_cl = obi_cl_cde_lig.no_int_lig_cde_cl)) ON (obi_cl_cde.no_ste = obi_cl_cde_lig.no_ste) AND (obi_cl_cde.cpt_cde_cl = obi_cl_cde_lig.cpt_cde_cl)) ON (obi_ordfab.no_int_ord_fab = obi_cl_cde_lig_cad.no_int_ord_fab) AND (obi_ordfab.no_ste = obi_cl_cde_lig_cad.no_ste) \" &amp; vbCrLf\nschsql = schsql &amp; \"WHERE (((obi_cl_cde.pt_bloq)=\"\"0\"\") AND ((obi_cl_cde_lig.pt_force_sld)=\"\"0\"\") AND ((obi_cl_cde_lig_cad.pt_sld_cad)=\"\"0\"\") AND ((obi_cl_cde_lig_cad.qte_liv_cde_cad_cl)&lt;[obi_cl_cde_lig_cad]![qte_cde_cad_cl]) AND ((obi_cl_cde_lig.pt_att_lig_cde_cl)=\"\"0\"\"));\"\n\nSet rst = CurrentDb.OpenRecordset(schsql)\nIf Not rst.RecordCount = 0 Then\n\n    rst.MoveFirst\n    Do Until rst.EOF\n\n        'If rst!no_int_ord_fab = 62432 Then Stop\n        'rcset.FindFirst (\"OF=\" &amp; rst!no_int_ord_fab)\n\n        chsql = \"Select * FROM admin_inventaire_expedition where no_int_cde_cad_cl = \" &amp; rst!no_int_cde_cad_cl &amp; \" AND Emplacement = \"\"\" &amp; \"EXPE\" &amp; \"\"\" \"\n        Set rcset = CurrentDb.OpenRecordset(chsql)\n\n        If Not rcset.EOF Then\n\n            rcset.Edit\n                rcset!cpt_cde_cl = rst!cpt_cde_cl\n                rcset!no_int_lig_cde_cl = rst!no_int_lig_cde_cl\n                rcset(\"Date exp\u00e9\") = rst!dte_hre_exp_prev\n                rcset(\"Date livraison\") = rst!dte_liv_conf_cde_cad_cl\n            rcset.Update\n\n        End If\n        rst.MoveNext\n    Loop\n    rst.Close\n    Set rst = Nothing\nEnd If\n</code></pre>\n\n<p>My program make an infinite loop, i just change my rst recordset query in order to be more fast, but why infinite loop please?</p>\n"}, {"tags": ["ms-access", "combobox", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11195089, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FZYhjT1eCeA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF7trgPniT8CCUymmqT20QdM0Xwg/mo/photo.jpg?sz=128", "display_name": "Danilo", "link": "https://stackoverflow.com/users/11195089/danilo"}, "edited": false, "score": 0, "creation_date": 1552548213, "post_id": 55137067, "comment_id": 97053111, "body": "Thanks but still getting Runtime error 3061 too few parameters expected 3"}, {"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "edited": false, "score": 0, "creation_date": 1552556961, "post_id": 55137067, "comment_id": 97057875, "body": "try creating your sql as a string so you can view exactly what it is creating.        <code>Dim strSQL as string strSQL = &quot;SELECT [Invoice Number] FROM Invoices &quot; &amp; _        &quot;WHERE [Job Invoiced?] = &#39;&quot; &amp; JIstat &amp; &quot;&#39;&quot; &amp; _ &quot; AND [Client Name] = &#39;&quot; &amp; Cname &amp; &quot;&#39;&quot; &amp; _        &quot; AND [Job ID] =&quot; &amp; JID) debug.print strSQL  </code>    The debug.print will show you exactly what the SQL string is and help you work out why it doesn&#39;t think the parameters are there."}, {"owner": {"reputation": 1, "user_id": 11195089, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FZYhjT1eCeA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF7trgPniT8CCUymmqT20QdM0Xwg/mo/photo.jpg?sz=128", "display_name": "Danilo", "link": "https://stackoverflow.com/users/11195089/danilo"}, "edited": false, "score": 1, "creation_date": 1552586129, "post_id": 55137067, "comment_id": 97077620, "body": "Thank you Santosh and Jenny for your kind assistance. After much anguish I just realised my problem is not so much the syntax but the way I had set up the comboboxes to filter the query required more detail than I was providing for the WHERE condition of the script to run the query successfully and return a single record. I think I may now have a solution which I am currently testing. Best regards."}], "tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1552464627, "creation_date": 1552464627, "answer_id": 55137067, "question_id": 55136830, "link": "https://stackoverflow.com/questions/55136830/syntax-error-when-using-combobox-value-to-filter-a-query-in-vba/55137067#55137067", "title": "Syntax Error when using Combobox value to filter a query in VBA", "body": "<p>Added a space on new line of the SQL statement.</p>\n\n<pre><code>JIstat = Forms!Invoices!Combo58.Value\nCname = Forms!Invoices!Combo50.Value\nJID = Forms!Invoices!Combo56.Value\n\n\nSet rs = db.OpenRecordset(\"SELECT [Invoice Number] FROM Invoices \" &amp; _\n\"WHERE [Job Invoiced?] = '\" &amp; JIstat &amp; \"'\" &amp; _\n\" AND [Client Name] = '\" &amp; Cname &amp; \"'\" &amp; _\n\" AND [Job ID] =\" &amp; JID)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11195089, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FZYhjT1eCeA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF7trgPniT8CCUymmqT20QdM0Xwg/mo/photo.jpg?sz=128", "display_name": "Danilo", "link": "https://stackoverflow.com/users/11195089/danilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552464627, "creation_date": 1552463617, "question_id": 55136830, "link": "https://stackoverflow.com/questions/55136830/syntax-error-when-using-combobox-value-to-filter-a-query-in-vba", "title": "Syntax Error when using Combobox value to filter a query in VBA", "body": "<p>Good Day. I'm not a developer and I'm not the sharpest tool in the shed to boot, but this is a simple issue I've been battling with for an inordinate amount of time and I'm hoping someone out there in the ether will be kind enough to help with a menial task. I have scoured the answers and forums but I can't quite locate a solution.</p>\n\n<p>I have 3 comboboxes in an Access form which together filter a query [Invoices] down to a single record. I have a piece of VBA I show below in which I am attempting to run a sql query to return the single record into a recordset, using the values of the comboboxes I have selected as filters in a WHERE clause. I will just append the offending piece:</p>\n\n<pre><code>JIstat = Forms!Invoices!Combo58.Value\nCname = Forms!Invoices!Combo50.Value\nJID = Forms!Invoices!Combo56.Value\n\n\nSet rs = db.OpenRecordset(\"SELECT [Invoice Number] FROM Invoices \" &amp; _\n\"WHERE [Job Invoiced?] = '\" &amp; JIstat &amp; \"'\" &amp; _\n\"AND [Client Name] = '\" &amp; Cname &amp; \"'\" &amp; _\n\"AND [Job ID] =\" &amp; JID)\n</code></pre>\n\n<p>JIstat is a variable that provides a status value (text); Cname provides a client name (text) and JID provides a job identifier (number).</p>\n\n<p>This seems simple enough but when I run it I get Runtime error 3061 too few parameters expected 3. The 3 variables are successfully assigned the correct values but I suspect formatting and syntax are my undoing. I don't have much hair left to lose so any help would be appreciated. Thanks</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 428, "user_id": 10569362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9c61d2dbd18a14e34005ab752e682e?s=128&d=identicon&r=PG&f=1", "display_name": "patel", "link": "https://stackoverflow.com/users/10569362/patel"}, "edited": false, "score": 1, "creation_date": 1552463587, "post_id": 55136788, "comment_id": 97013998, "body": "you have to use AND to exclude both"}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 1, "creation_date": 1552465323, "post_id": 55136788, "comment_id": 97014792, "body": "Unless you&#39;re doing this as an exercise to practise VBA, I suggest using conditional formatting instead."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 3, "last_activity_date": 1552465947, "last_edit_date": 1552465947, "creation_date": 1552465188, "answer_id": 55137199, "question_id": 55136788, "link": "https://stackoverflow.com/questions/55136788/mark-all-cells-which-do-not-include-two-given-words/55137199#55137199", "title": "Mark all cells which do not include two given words", "body": "<p>Note that this task can be solved with <a href=\"https://www.excel-easy.com/data-analysis/conditional-formatting.html\" rel=\"nofollow noreferrer\">Conditional Formatting</a> which has the advantage that it updates automatically if data changes and you don't need to run the procedure over and over again.</p>\n\n<hr>\n\n<p>The following is just to improve your coding:</p>\n\n<ol>\n<li><p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoid using Select in Excel VBA</a>. \u2022 Instead use the range directly and also specify in which worksheet the range is. If you don't do that Excel guesses which sheet you meant to use and it might fail:  </p>\n\n<pre><code>For Each cell In Worksheets(\"MySheet\").Range(\"C2:C49\")\n</code></pre></li>\n<li><p>I recommend always to activate <code>Option Explicit</code> and declare all your variables. This is a very good practice and prevents many errors: In the VBA editor go to <em>Tools</em> \u203a <em>Options</em> \u203a <em><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></em>.</p></li>\n<li><p>Your actual issue is that if you want to exclude both <code>\"bel\"</code> <strong>and</strong> <code>\"hsa\"</code> then (of course) you need to use the <code>And</code> operator.</p>\n\n<pre><code>Cell.Value &lt;&gt; \"bel\" And Cell.Value &lt;&gt; \"hsa\"\n</code></pre>\n\n<p>Note that <code>&lt;&gt;</code> versus <code>=</code> always changes the logic of the operators <code>or/and</code>. Alternatively you could use:</p>\n\n<pre><code>Not (Cell.Value = \"bel\" Or Cell.Value = \"hsa\")\n</code></pre>\n\n<p>\u2026 which would give you the same result. Use the one that is easier to understand for you.</p></li>\n</ol>\n\n<hr>\n\n<p>So you end up with something like:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ValidateAndColorCells()\n    Dim CheckRange As Range\n    Set CheckRange = Worksheets(\"YourSheet\").Range(\"C2:C49\") 'Always specify the sheet!\n\n    Dim Cell As Range '&lt;-- declare ALL your variables\n    For Each Cell In CheckRange \n        If Cell.Value &lt;&gt; \"bel\" And Cell.Value &lt;&gt; \"hsa\" Then\n            Cell.Interior.Color = RGB(255, 0, 0)\n        End If\n    Next Cell \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 10810747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849a7828d038b0ca51a85a52848fbc04?s=128&d=identicon&r=PG&f=1", "display_name": "Marco D.", "link": "https://stackoverflow.com/users/10810747/marco-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555660606, "creation_date": 1552463448, "last_edit_date": 1555660606, "question_id": 55136788, "link": "https://stackoverflow.com/questions/55136788/mark-all-cells-which-do-not-include-two-given-words", "title": "Mark all cells which do not include two given words", "body": "<p>I am writing a code which should mark in a range, in red, all cells which do not include the words <code>\"bel\"</code> and <code>\"hsa\"</code>.</p>\n\n<pre><code>Sub Check()\n    Range(\"c2:c49\").Select\n\n    For Each cell In Selection\n        If (cell.Value &lt;&gt; \"bel\" Or cell.Value &lt;&gt; \"hsa\") Then\n            cell.Interior.Color = RGB(255, 0, 0)\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>It works if I only have one argument. With the two arguments like above, it marks all cells in range red.</p>\n\n<p>Is the <code>Or</code> operator wrong?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552466855, "post_id": 55136760, "comment_id": 97015615, "body": "Not entirely clear to my why listbox is involved. If you want form filtered by single item input to textbox and it needs to be wildcard parameter, use <code>LIKE [txtPartNo] &amp; &quot;*&quot;</code>."}, {"owner": {"reputation": 21, "user_id": 11048470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd3da67821c6429e6556df180653ad1?s=128&d=identicon&r=PG&f=1", "display_name": "diana123", "link": "https://stackoverflow.com/users/11048470/diana123"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552467435, "post_id": 55136760, "comment_id": 97015947, "body": "@June7 I want it to be list box because the user will key in more than 1 item description."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552468360, "post_id": 55136760, "comment_id": 97016505, "body": "Then how would you expect to employ LIKE and wildcard on multiple items? A solution might involve use of a &#39;temp&#39; table - table is permanent but records are temporary - to build a dataset for desired output. Review this tutorial for conventional method of using listbox to filter a form or report <a href=\"http://allenbrowne.com/ser-50.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-50.html</a>. Your question is really too broad."}, {"owner": {"reputation": 21, "user_id": 11048470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd3da67821c6429e6556df180653ad1?s=128&d=identicon&r=PG&f=1", "display_name": "diana123", "link": "https://stackoverflow.com/users/11048470/diana123"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1552553705, "post_id": 55136760, "comment_id": 97055866, "body": "up.............."}], "owner": {"reputation": 21, "user_id": 11048470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd3da67821c6429e6556df180653ad1?s=128&d=identicon&r=PG&f=1", "display_name": "diana123", "link": "https://stackoverflow.com/users/11048470/diana123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552464986, "creation_date": 1552463304, "last_edit_date": 1552464986, "question_id": 55136760, "link": "https://stackoverflow.com/questions/55136760/how-to-filter-subform-using-listbox", "title": "How to filter subform using listbox", "body": "<p>Good day,</p>\n\n<p>I have one form call <strong>Check Router</strong>. In that subform I have one <strong>text box (TxtPartNo)</strong>, one <strong>list box (LstPartNo)</strong> and one <strong>subform (CheckRouteSubform)</strong>.</p>\n\n<p>These are the roles of those function</p>\n\n<ol>\n<li>TxtPartNo --> User will key in the Item Description that they wanted to check its         Route.After that,they will click add button.</li>\n<li>LstPartNo --> its row source type is <strong><em>value list</em></strong>. After the user click Add Button, the Item Description that they key in will insert in this list box. Then they will <strong>select all data list</strong> and <strong>click on check button</strong>. </li>\n<li><p>CheckRouteSubform --> This subform is based on CheckRouteQuery. After check button is click, I wanted it to be filter based on that Item Description. If it <strong>contain</strong> but not exactly <strong>equal</strong> that part_No, it will show in this subform. </p>\n\n<pre><code>      example : user key in = FCLF-8531\n                subform will show data that contain FCLF-8531-RX, FLCF-8531-AX.\n</code></pre></li>\n</ol>\n\n<p>here I attached the picture of the form <a href=\"https://i.stack.imgur.com/flOWD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/flOWD.jpg\" alt=\"CheckRouter\"></a></p>\n\n<p>Below are the picture of query :</p>\n\n<p><a href=\"https://i.stack.imgur.com/fgBGL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fgBGL.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see i create criteria of Item Description based on the listbox. </p>\n\n<p>and in check button I used this code: </p>\n\n<pre><code>  Private Sub CmdCheckRoute_Click()\n  Dim i As Integer\n\n\n  For i = 0 To Forms!CheckRoute!LstPartNo.ListCount - 1\n  Forms!CheckRoute!LstPartNo.Selected(i) = True\n  Next i\n\n DoCmd.RunSQL \"CheckRouteQuery\"\n\n End Sub\n</code></pre>\n\n<p>However, it does not want to show what I need. :( Help me please.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552463344, "post_id": 55136754, "comment_id": 97013893, "body": "You can find the last row and then copy the data there. <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\">Here</a> the code to find last row."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11157684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yABqxzwChpk/AAAAAAAAAAI/AAAAAAAABZA/XetJXZ20bsA/photo.jpg?sz=128", "display_name": "Bahadur Ali", "link": "https://stackoverflow.com/users/11157684/bahadur-ali"}, "edited": false, "score": 0, "creation_date": 1552552917, "post_id": 55136881, "comment_id": 97055406, "body": "Hay this Code is not working for Me on MS Excel, i have done this on Google Sheet but stuck in Microsoft Excel, Below is my Google Sheet Code    &#39; function CopyData(){    var sss = SpreadsheetApp.openById(&#39;10Grh3DBL4sU&#39;);   var ss = sss.getSheetByName(&#39;Database&#39;);   var SRange = ss.getRange(&quot;A3:EO3&quot;);   var SData = SRange.getValues();      var tss = SpreadsheetApp.openById(&#39;17gXnrJUV5_qw&#39;);   var ts = tss.getSheetByName(&#39;CalDatabase&#39;);   ts.getRange(ts.getLastRow()+1,1,SData.length,SData[0].length&zwnj;&#8203;).setValues(SData);    }&#39; @harun24hr"}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 0, "last_activity_date": 1552463839, "creation_date": 1552463839, "answer_id": 55136881, "question_id": 55136754, "link": "https://stackoverflow.com/questions/55136754/copy-data-from-one-excel-workbook-to-another-workbook-in-last-row/55136881#55136881", "title": "Copy Data from one Excel Workbook to Another Workbook in Last row", "body": "<p>Have a try on following sub.</p>\n\n<pre><code>Sub CopyData()\nDim wb As Workbook\nDim sht, shtLocal As Worksheet\nDim rngPaste As Range\nDim rngLastData, wbPath As String\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n    wbPath = \"D:\\dBook.xlsx\"\n    Set wb = Workbooks.Open(wbPath)\n    Set sht = wb.Sheets(1)\n    Set shtLocal = ThisWorkbook.Sheets(\"Sheet1\")\n    Set rngPaste = sht.Cells(Rows.Count, 1).End(xlUp).Offset(1) 'Destination range set after last used cell of column A\n\n    rngLastData = shtLocal.Cells(Rows.Count, \"A\").End(xlUp).Address\n    shtLocal.Range(\"A1:\" &amp; rngLastData).Copy rngPaste\n\n    wb.Save\n    wb.Close\n    Set sht = Nothing\n    Set shtLocal = Nothing\n    Set rngPaste = Nothing\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11157684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yABqxzwChpk/AAAAAAAAAAI/AAAAAAAABZA/XetJXZ20bsA/photo.jpg?sz=128", "display_name": "Bahadur Ali", "link": "https://stackoverflow.com/users/11157684/bahadur-ali"}, "edited": false, "score": 0, "creation_date": 1552552592, "post_id": 55137095, "comment_id": 97055257, "body": "Hello, Thanks for the Help but this code not working still Label not defined error"}, {"owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "reply_to_user": {"reputation": 3, "user_id": 11157684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yABqxzwChpk/AAAAAAAAAAI/AAAAAAAABZA/XetJXZ20bsA/photo.jpg?sz=128", "display_name": "Bahadur Ali", "link": "https://stackoverflow.com/users/11157684/bahadur-ali"}, "edited": false, "score": 0, "creation_date": 1552560625, "post_id": 55137095, "comment_id": 97060216, "body": "This is the line that is causing you the issue, <code>On Error GoTo Errorcatch</code>. Do you have an error handling label defined?  In not try removing this line."}], "tags": [], "owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "is_accepted": false, "score": 0, "last_activity_date": 1552464741, "creation_date": 1552464741, "answer_id": 55137095, "question_id": 55136754, "link": "https://stackoverflow.com/questions/55136754/copy-data-from-one-excel-workbook-to-another-workbook-in-last-row/55137095#55137095", "title": "Copy Data from one Excel Workbook to Another Workbook in Last row", "body": "<p><code>enter code here</code>Here is my adjustment of your code. What I did is declared the workbooks and the worksheets separately. This way it is clear which workbook/sheet is the source and which is the destination.</p>\n\n<pre><code>  Sub CopyData()\n        Dim sBook_t As String\n        Dim sBook_s As String\n        Dim workbook_t As Workbook\n        Dim sSheet_t As Worksheet\n        Dim sSheet_s As Worksheet\n\n\n    Dim sSheet_t As String\n    Dim sSheet_s As String\n\n    On Error GoTo Errorcatch\n\n    sBook_t = \"C:\\Users\\Unknown\\Desktop\\Free\\Calculators.xlsx\"\n      set workbook_t =  Workbooks.Open (sBook_t)\n    sBook_s = \"C:\\Users\\Unknown\\Desktop\\Free\\PRODUCT_35.xlsm\"\n      set workbook_s =  Workbooks.Open (sBook_s)\n\n   set sSheet_t = workbook_t.Sheets(\"cstdatalist\")\n   set sSheet_s = workbook_s.Sheets(\"cstdata\")\n\n    sSheet_s.Range(\"A2\").Copy Destination:=sSheet_t.Range(\"A2\")\n\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11157684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yABqxzwChpk/AAAAAAAAAAI/AAAAAAAABZA/XetJXZ20bsA/photo.jpg?sz=128", "display_name": "Bahadur Ali", "link": "https://stackoverflow.com/users/11157684/bahadur-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552464741, "creation_date": 1552463281, "last_edit_date": 1552464230, "question_id": 55136754, "link": "https://stackoverflow.com/questions/55136754/copy-data-from-one-excel-workbook-to-another-workbook-in-last-row", "title": "Copy Data from one Excel Workbook to Another Workbook in Last row", "body": "<p>I am Trying to run this Code, which will copy the Source sheet Row to Destination Sheet last Row, but my this code giving error 400 while compiling,</p>\n\n<p>Advance Thanks for Help </p>\n\n<pre><code>Sub CopyData()\n    Dim sBook_t As String\n    Dim sBook_s As String\n\n    Dim sSheet_t As String\n    Dim sSheet_s As String\n\n    On Error GoTo Errorcatch\n\n    sBook_t = \"C:\\Users\\Unknown\\Desktop\\Free\\Calculators.xlsx\"\n    Workbooks.Open (sBook_t)\n    sBook_s = \"C:\\Users\\Unknown\\Desktop\\Free\\PRODUCT_35.xlsm\"\n    Workbooks.Open (sBook_s)\n\n    sSheet_t = \"cstdatalist\"\n    sSheet_s = \"cstdata\"\n\n    Sheets(sSheet_s).Range(\"A2\").Copy Destination:=Sheets(sSheet_t).Range(\"A2\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "parameters"], "comments": [{"owner": {"reputation": 23, "user_id": 11001992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8044866a76eeadbbb81b2c08ef45105?s=128&d=identicon&r=PG&f=1", "display_name": "Georg", "link": "https://stackoverflow.com/users/11001992/georg"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1552463328, "post_id": 55136477, "comment_id": 97013888, "body": "Yes my bad, I didn&#39;t quite realize that in the first place, Thanks!"}, {"owner": {"reputation": 186, "user_id": 11047851, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11047851/noodles"}, "edited": false, "score": 0, "creation_date": 1552463582, "post_id": 55136477, "comment_id": 97013996, "body": "<a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-settimer\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/api/winuser/&hellip;</a> for the procedure use <code>AddressOf</code>."}], "owner": {"reputation": 23, "user_id": 11001992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8044866a76eeadbbb81b2c08ef45105?s=128&d=identicon&r=PG&f=1", "display_name": "Georg", "link": "https://stackoverflow.com/users/11001992/georg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1552463343, "answer_count": 0, "score": 0, "last_activity_date": 1552461941, "creation_date": 1552461941, "question_id": 55136477, "link": "https://stackoverflow.com/questions/55136477/vba-excel-application-ontime-passing-paramters-to-procedure", "closed_reason": "Duplicate", "title": "VBA Excel Application.OnTime passing paramters to procedure", "body": "<p>I want to pass parameters to the procedure I am calling with Application.OnTime</p>\n\n<p>As there are more than three timedEvents in the real Code with the same functionality only with diffrent i, it is no option to create a timedEvent for every i.</p>\n\n<p>I have tried the following, those with comments infront didn't work</p>\n\n<pre><code>Sub wait(i As Integer)\n    Application.OnTime Now + TimeValue(\"00:00:10\"), \"timedEvent\" &amp; i\n    'Application.OnTime Now + TimeValue(\"00:00:10\"), \"timedEvent(i)\"\n    'Application.OnTime Now + TimeValue(\"00:00:10\"), \"timedEvent(\" &amp; i &amp; \")\"\nEnd Sub\n\n'At the Moment:\nFunction timedEvent1()\n    Dim i As Integer\n    i = 1\n    Call timedEvent(i)\nEnd Function\n\nFunction timedEvent2()\n    Dim i As Integer\n    i = 2\n    Call timedEvent(i)\nEnd Function\n\nFunction timedEvent3()\n    Dim i As Integer\n    i = 3\n    Call timedEvent(i)\nEnd Function\n\n\n'I want to jump directly to this function\nFunction timedEvent(i As Integer)\n    'some code\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 10799323, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wOaLDFlva3A/AAAAAAAAAAI/AAAAAAAAAHo/lYthhLeSoNQ/photo.jpg?sz=128", "display_name": "transontung90", "link": "https://stackoverflow.com/users/10799323/transontung90"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552453426, "post_id": 55134100, "comment_id": 97010194, "body": "yes , actually i still recommend my peer to do them but in case the data get bigger , i  want to cover them in VBA"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11174618"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552453497, "post_id": 55134100, "comment_id": 97010214, "body": "@SiddharthRout, how does AutoFilter exclude rows with the latest date in column Z for every identifier in column B? The linked example doesn&#39;t seem to cover that."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10799323, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wOaLDFlva3A/AAAAAAAAAAI/AAAAAAAAAHo/lYthhLeSoNQ/photo.jpg?sz=128", "display_name": "transontung90", "link": "https://stackoverflow.com/users/10799323/transontung90"}, "edited": false, "score": 0, "creation_date": 1552452392, "post_id": 55134332, "comment_id": 97009885, "body": "thanks you for your guidance , now i know both the solution and how remove duplicates work . thanks you so much"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11174618"}, "is_accepted": true, "score": 2, "last_activity_date": 1552450819, "creation_date": 1552450819, "answer_id": 55134332, "question_id": 55134100, "link": "https://stackoverflow.com/questions/55134100/how-to-delete-duplicate-row-with-condition-in-vba/55134332#55134332", "title": "How to delete duplicate row with condition in VBA", "body": "<p>It looks like you want to delete duplicates from column B but keep the row with the newest date in column Z.</p>\n\n<p>RemoveDuplicates typically deletes the duplicate with the largest row number (closest to the bottom of the data) so Sort the data with the date descending to leave the latest date at the top and remove duplicates.</p>\n\n<pre><code>Sub Macro1()\n\n    With Worksheets(\"sheet1\")\n        'With .Range(.Cells(1, \"B\"), .Cells(.Rows.Count, \"Z\").End(xlUp))\n        With Intersect(.UsedRange, .Range(\"B:Z\"))\n\n            .Sort key1:=.Columns(1), order1:=xlAscending, _\n                  key2:=.Columns(.Columns.Count), order2:=xlDescending, _\n                  Header:=xlNo\n\n            .RemoveDuplicates Columns:=1, Header:=xlNo\n\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10799323, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wOaLDFlva3A/AAAAAAAAAAI/AAAAAAAAAHo/lYthhLeSoNQ/photo.jpg?sz=128", "display_name": "transontung90", "link": "https://stackoverflow.com/users/10799323/transontung90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 1, "accepted_answer_id": 55134332, "answer_count": 1, "score": 0, "last_activity_date": 1552450819, "creation_date": 1552448986, "last_edit_date": 1552450432, "question_id": 55134100, "link": "https://stackoverflow.com/questions/55134100/how-to-delete-duplicate-row-with-condition-in-vba", "title": "How to delete duplicate row with condition in VBA", "body": "<p>Im completely novice on VBA but i found no solution in google so far. i find 2 seperate code but when combining the solution didnt find out</p>\n\n<p>I have a issue of deleting duplicate row with condition</p>\n\n<pre><code>column b    column z \n  1         22/1/2019 \n  2         22/1/2019 \n  1         23/1/201  \n  2         23/1/2019\n</code></pre>\n\n<p>outcome</p>\n\n<pre><code>column b    column z \n  1         23/1/2019 \n  2         23/1/2019\n</code></pre>\n\n<p>My code ( having problem when nested do while with for )</p>\n\n<pre><code>  Sub Macro1()\nDim RowsToDelete As Range, innerRow As Long\nSet TheRng = Intersect(ActiveSheet.UsedRange, ActiveSheet.Range(\"B:Z\"))\nxx = TheRng.Value\ninnerRow = 1\n\nFor i = UBound(xx) To 2 Step -1\n    Do While ActiveSheet.Range(\"b\" &amp; Row) &lt;&gt; \"\"\n        If ActiveSheet.Range(\"b\" &amp; Row) = ActiveSheet.Range(\"b\" &amp; innerRow) Then\n            For j = i - 1 To 1 Step -1\n         If ActiveSheet.Range(\"Z\" &amp; Row) &lt; ActiveSheet.Range(\"Z\" &amp; innerRow) Then\n       Set RowsToDelete = Union(IIf(RowsToDelete Is Nothing, TheRng.Cells(i, 1), RowsToDelete), TheRng.Cells(i, 1))\nExit For\nEnd If\nNext j\nLoop\nRowsToDelete.EntireRow.Select 'Delete\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1552449258, "post_id": 55134060, "comment_id": 97009128, "body": "Dates are stored as numbers in Excel - what you see in a cell is a formatted version of that - you can use <code>Format()</code> to get a text version if that&#39;s what&#39;s needed."}, {"owner": {"reputation": 3, "user_id": 10318635, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5WzqIAPFJwo/AAAAAAAAAAI/AAAAAAAAAmg/Ogy6FYEfvVg/photo.jpg?sz=128", "display_name": "Adilet Yessaliyev", "link": "https://stackoverflow.com/users/10318635/adilet-yessaliyev"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1552449815, "post_id": 55134060, "comment_id": 97009255, "body": "Sorry but i don&#39;t understand - newcomer to vba))) Where shall I put the Format() function?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1552450494, "creation_date": 1552450494, "answer_id": 55134288, "question_id": 55134060, "link": "https://stackoverflow.com/questions/55134060/textbox-shows-date-as-number-while-vlookuping/55134288#55134288", "title": "textbox shows date as number while vlookuping", "body": "<p>Dates are stored as numbers in Excel - what you see in a cell is a formatted version of that - you can use <code>Format()</code> to get a text version if that's what's needed</p>\n\n<pre><code>Private Sub ListBox_Change()\n\n    Dim lnItem As Long\n    Dim ws, ws2 As Worksheet\n    Dim rn2 As Range, res\n\n    Set ws = Workbooks(\"TOOLS\").Worksheets(\"TOOLS\")\n    Set ws2 = Workbooks(\"TOOLS\").Worksheets(\"CONSOLIDATE\")\n    Set rn2 = ws2.Range(\"JOURNAL1\")\n\n    res = Application.Vlookup(Me.ListBox.List(lnItem, 0), rn2, 3, 0)\n\n    Me.TextPurchaseDate.Value = Format(res, \"mm/dd/yyyy\") 'for example\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10318635, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5WzqIAPFJwo/AAAAAAAAAAI/AAAAAAAAAmg/Ogy6FYEfvVg/photo.jpg?sz=128", "display_name": "Adilet Yessaliyev", "link": "https://stackoverflow.com/users/10318635/adilet-yessaliyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 55134288, "answer_count": 1, "score": 0, "last_activity_date": 1552450494, "creation_date": 1552448742, "last_edit_date": 1552449052, "question_id": 55134060, "link": "https://stackoverflow.com/questions/55134060/textbox-shows-date-as-number-while-vlookuping", "title": "textbox shows date as number while vlookuping", "body": "<p>I've created a userform with listbox that contains several columns and textbox. The textbox value changes when an  item in listbox is selected via Application.WorksheetFunction.Vlookup. but instead of date I get the number in textbox. Can someone help me to fix this problem?</p>\n\n<pre><code>Private Sub ListBox_Change()\n\n    Dim lnItem As Long\n    Dim ws, ws2 As Worksheet\n    Dim rn2 As Range\n\n    Set ws = Workbooks(\"TOOLS\").Worksheets(\"TOOLS\")\n    Set ws2 = Workbooks(\"TOOLS\").Worksheets(\"CONSOLIDATE\")\n    Set rn2 = ws2.Range(\"JOURNAL1\")\n\n    Me.TextPurchaseDate.Value = Application.WorksheetFunction.Vlookup(Me.ListBox.List(lnItem, 0), rn2, 3, 0)\n\n End Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "pandas"], "comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1552449861, "post_id": 55134031, "comment_id": 97009267, "body": "I think you should use VBA for this, and NOT Python.  Just my .02."}, {"owner": {"reputation": 113, "user_id": 6416722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bd68688eb29b44d6a06b31ea4c6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Hyvrt", "link": "https://stackoverflow.com/users/6416722/hyvrt"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1552451154, "post_id": 55134031, "comment_id": 97009591, "body": "The files are huge, also the intention is to merge one particular sheet of the original file to a recent update, say adding this month&#39;s data set to a yearly accumulated data sheet."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6416722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bd68688eb29b44d6a06b31ea4c6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Hyvrt", "link": "https://stackoverflow.com/users/6416722/hyvrt"}, "edited": false, "score": 0, "creation_date": 1552536359, "post_id": 55134481, "comment_id": 97049544, "body": "Thanks for the examples. My use case is inline with the second example you have provided.                                                                                                                            #workbook1  has 10 sheets                                                                                                                                workbook1 = xlsxwriter.Workbook(&#39;C:/your_path/test1.xlsm&#39;)                                                      #workbook2 has 1 sheet which needs to be merged with the corresponding sheet"}, {"owner": {"reputation": 113, "user_id": 6416722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bd68688eb29b44d6a06b31ea4c6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Hyvrt", "link": "https://stackoverflow.com/users/6416722/hyvrt"}, "edited": false, "score": 0, "creation_date": 1552536436, "post_id": 55134481, "comment_id": 97049570, "body": "in first file                                                                                                         workbook2 = xlsxwriter.Workbook(&#39;C:/your_path/test2.xlsm&#39;)                                                   I can actually treat both these files as &quot;xlsx&quot; by pulling vba_project.bin and do the merge. But when add the vba_project.bin back to the merged xlsx file and rename it to &quot;xlsm&quot;, I don&#39;t see the macros. The VBA content didn&#39;t get applied"}, {"owner": {"reputation": 289, "user_id": 8285840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf89da3d058c611bb3634bba1115d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias Arras", "link": "https://stackoverflow.com/users/8285840/matthias-arras"}, "edited": false, "score": 0, "creation_date": 1587728515, "post_id": 55134481, "comment_id": 108630065, "body": "In <code>pandas.read_excel()</code> as of version .21, the option to specify the sheet name, is now <code>sheet_name</code> instead of <code>sheetname</code>."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1552451796, "creation_date": 1552451796, "answer_id": 55134481, "question_id": 55134031, "link": "https://stackoverflow.com/questions/55134031/reading-and-updating-sheets-in-an-xlsm-file-using-pandas-while-preserving-the-vb/55134481#55134481", "title": "Reading and updating sheets in an XLSM file using pandas while preserving the VBA code", "body": "<p>Ah, I see.  I still can't tell what you are doing, but here are a few general samples of code to get Python to communicate with Excel.</p>\n\n<pre><code>Read contents of a worksheet in Excel:\n\nimport pandas as pd\nfrom pandas import ExcelWriter\nfrom pandas import ExcelFile\n\ndf = pd.read_excel('C:\\\\your_path\\\\test.xls', sheetname='Sheet1')\n\n************************************************************************************\n\nUse Python to run Macros in Excel:\nimport os\nimport win32com.client\n\n#Launch Excel and Open Wrkbook\nxl=win32com.client.Dispatch(\"Excel.Application\")  \nxl.Workbooks.Open(Filename=\"C:\\your_path\\excelsheet.xlsm\") #opens workbook in readonly mode. \n\n#Run Macro\nxl.Application.Run(\"excelsheet.xlsm!modulename.macroname\") \n\n#Save Document and Quit.\nxl.Application.Save()\nxl.Application.Quit() \n\n#Cleanup the com reference. \ndel xl\n</code></pre>\n\n<hr>\n\n<pre><code>Write, from Python, to Excel:\n\nimport xlsxwriter\n\n# Create an new Excel file and add a worksheet.\nworkbook = xlsxwriter.Workbook('C:/your_path/ranges_and_offsets.xlsx')\nworksheet = workbook.add_worksheet()\n\n# Widen the first column to make the text clearer.\nworksheet.set_column('A:A', 20)\n\n# Add a bold format to use to highlight cells.\nbold = workbook.add_format({'bold': True})\n\n# Write some simple text.\nworksheet.write('A1', 'Hello')\n\n# Text with formatting.\nworksheet.write('A2', 'World', bold)\n\n# Write some numbers, with row/column notation.\nworksheet.write(2, 0, 123)\nworksheet.write(3, 0, 123.456)\n\n\nworkbook.close()\n</code></pre>\n\n<hr>\n\n<pre><code>from openpyxl import Workbook\nwb = Workbook()\n\n# grab the active worksheet\nws = wb.active\n\n# Data can be assigned directly to cells\nws['A1'] = 42\n\n# Rows can also be appended\nws.append([1, 2, 3])\n\n# Python types will automatically be converted\nimport datetime\nws['A2'] = datetime.datetime.now()\n\n# Save the file\nwb.save(\"C:\\\\your_path\\\\sample.xlsx\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 12660014, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAmHjJZB3LQ2bqFb1W_w1_rKjbEEbv3aKSGtxndvQ=k-s128", "display_name": "Azeez Bello", "link": "https://stackoverflow.com/users/12660014/azeez-bello"}, "is_accepted": false, "score": 1, "last_activity_date": 1603173774, "last_edit_date": 1603173774, "creation_date": 1594321577, "answer_id": 62821969, "question_id": 55134031, "link": "https://stackoverflow.com/questions/55134031/reading-and-updating-sheets-in-an-xlsm-file-using-pandas-while-preserving-the-vb/62821969#62821969", "title": "Reading and updating sheets in an XLSM file using pandas while preserving the VBA code", "body": "<p>You can do this easily with pandas</p>\n<pre><code>import pandas as pd\nimport xlrd\n\n# YOU MUST PUT sheet_name=None TO READ ALL CSV FILES IN YOUR XLSM FILE\ndf = pd.read_excel('YourFile.xlsm', sheet_name=None)\n\n# prints all sheets\nprint(df)\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6416722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bd68688eb29b44d6a06b31ea4c6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Hyvrt", "link": "https://stackoverflow.com/users/6416722/hyvrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11805, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1611119305, "creation_date": 1552448490, "last_edit_date": 1611119305, "question_id": 55134031, "link": "https://stackoverflow.com/questions/55134031/reading-and-updating-sheets-in-an-xlsm-file-using-pandas-while-preserving-the-vb", "title": "Reading and updating sheets in an XLSM file using pandas while preserving the VBA code", "body": "<p>I have a requirement to read an xlsm file and update some of the sheets in the file. I want to use pandas for this purpose.</p>\n<p>I tried answers presented in the following post. I couldn't see the VBA macros when I add the VBA project back.<br />\n<a href=\"https://stackoverflow.com/posts/28170939/revisions\">https://stackoverflow.com/posts/28170939/revisions</a></p>\n<p>Here are the steps I tried,</p>\n<p>Extracted the VBA_project.bin out of the original.xlsm file and then</p>\n<pre><code>writer = pd.ExcelWriter('original.xlsx', engine='xlsxwriter')\nworkbook = writer.book\nworkbook.filename = 'test.xlsm'\nworkbook.add_vba_project('vbaProject.bin')\nwriter.save()\n</code></pre>\n<p>With this I don't see the VBA macros attached to &quot;test.xlsm&quot;. The result is the same even if I write it to the &quot;original.xlsm&quot; file.</p>\n<p>How do I preserve the VBA macros or add them back to the original xlsm file?</p>\n<p>Also, is there a way I can open the &quot;xlsm&quot; file itself rather than the &quot;xlsx&quot; counterpart using <code>pd.ExcelWriter</code>?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1552446593, "post_id": 55133675, "comment_id": 97008586, "body": "Can you add more detail on what is not working? A thought - your inner loop overwrites the same cell - <code>Cells(i, 1)</code> - because <code>i</code> does not increment until the next iteration of the <i>outer</i> loop."}, {"owner": {"reputation": 193, "user_id": 3391693, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/89ff10741fcd628a6c587e60e04f86a4?s=128&d=identicon&r=PG&f=1", "display_name": "Durgaprasad", "link": "https://stackoverflow.com/users/3391693/durgaprasad"}, "edited": false, "score": 0, "creation_date": 1552450829, "post_id": 55133675, "comment_id": 97009513, "body": "Please be clear on what is your requirement, what is the error and in which state its not working."}, {"owner": {"reputation": 33, "user_id": 11194568, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CjW5qARGgOQ/AAAAAAAAAAI/AAAAAAAA6-M/j7A53l3XRZA/photo.jpg?sz=128", "display_name": "Bardia Alavi", "link": "https://stackoverflow.com/users/11194568/bardia-alavi"}, "edited": false, "score": 0, "creation_date": 1552452530, "post_id": 55133675, "comment_id": 97009932, "body": "Dear all the problem is The problem is it returns the name of each sheet 22 times in column, so I would have Sydney in the first column 20 times and then Melbourne in column number 2 20 times.   I want the name of all sheets to come in the first column."}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1552456820, "creation_date": 1552456820, "answer_id": 55135362, "question_id": 55133675, "link": "https://stackoverflow.com/questions/55133675/loop-through-specific-worksheets-and-return-specific-values/55135362#55135362", "title": "Loop Through Specific Worksheets and Return specific Values", "body": "<h1>Through Worksheets to Worksheet</h1>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub FinalGO()\n\n    Application.ScreenUpdating = False\n    ' When using turning ScreenUpdating off, it is wise to use an Error Handler,\n    ' so when an error occurs, it will get turned on again.\n    On Error GoTo ErrorHandler\n\n    Dim ws As Worksheet     ' Current Worksheet\n    Dim i As Long           ' Row (Cell) Counter\n    Dim strName As String   ' New Worksheet Name\n\n    ' Determine New Worksheet Name.\n    strName = \"Summary \" &amp; Day(Now) &amp; \"-\" &amp; Month(Now) &amp; \"-\" &amp; Year(Now)\n\n    ' In This Workbook (The Workbook Containing This Code)\n    With ThisWorkbook\n         ' Check if New Worksheet already exists.\n         On Error Resume Next\n         Set ws = .Worksheets(strName)\n         If Err Then  ' Does NOT exist.\n              On Error GoTo 0\n            Else      ' DOES exist.\n              GoTo AlreadyDoneToday\n         End If\n\n         ' Reenable error handling.\n         On Error GoTo ErrorHandler\n\n        ' Add a New Worksheet to the last position in This Workbook.\n        .Sheets.Add After:=.Sheets(.Sheets.Count)\n        ' In the New Worksheet.\n        With .Sheets(.Sheets.Count)\n            ' Rename New Worksheet. If you already have used this code today,\n            ' this line will produce an error. Delete the sheet or...\n            .Name = strName\n            ' Write to cell A1 in New Worksheet.\n            .Cells(1, 1).Value = \"Project Name\"\n            ' Reset Row (Cells) Counter , because 1st already contains a value.\n            i = 1\n            ' Loop through worksheets of This Workbook (.Parent).\n            For Each ws In .Parent.Worksheets\n                ' Check the Name of the Current Worksheet.\n                Select Case ws.Name\n                    ' Do Nothing.\n                    Case \"Prices\", \"Home Page\", \"Model Digaram\", _\n                            \"Validation &amp; Checks\", \"Model Start--&gt;\", _\n                            \"Input|Assumptions\", \"Cost Assumption\"\n                    Case Else\n                        ' Count Rows (Cells).\n                        i = i + 1\n                        ' Write name of Current Worksheet to cell in current\n                        ' Row and first column of New Worksheet.\n                        .Cells(i, 1).Value = ws.Name\n                End Select\n            Next\n        End With\n    End With\n\nSuccess:\n\n    MsgBox \"The operation finished successfully.\", vbInformation, \"Success\"\n\nSafeExit:\n\n    Application.ScreenUpdating = True\n\nExit Sub\n\nAlreadyDoneToday:\n\n    MsgBox \"You have already done this today.\", vbExclamation, \"Already done.\"\n    GoTo SafeExit\n\nErrorHandler:\n\n    MsgBox \"An unexpected error occurred. Error '\" &amp; Err.Number &amp; \"': \" _\n            &amp; Err.Description, vbCritical, \"Error\"\n    GoTo SafeExit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11194568, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CjW5qARGgOQ/AAAAAAAAAAI/AAAAAAAA6-M/j7A53l3XRZA/photo.jpg?sz=128", "display_name": "Bardia Alavi", "link": "https://stackoverflow.com/users/11194568/bardia-alavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 55135362, "answer_count": 1, "score": 0, "last_activity_date": 1552456820, "creation_date": 1552445963, "last_edit_date": 1552452504, "question_id": 55133675, "link": "https://stackoverflow.com/questions/55133675/loop-through-specific-worksheets-and-return-specific-values", "title": "Loop Through Specific Worksheets and Return specific Values", "body": "<p>I have the following script. It is meant to run through specific sheet and return values. So in summary ignore some of the sheets. I did a nested loop ignoring some of the sheets and return values but it does not work. \\</p>\n\n<p>I want to be able to extract data from some of them and ignore the rest using the sheet names.  The problem is it returns the name of each sheet 22 times in column, so I would have Sydney in the first column 20 times and then Melbourne in column number 2 20 times. </p>\n\n<p>I want the name of all sheets to come in the first column. </p>\n\n<pre><code>Sub FinalGO()\n    Application.ScreenUpdating = False\n\n    Dim i As Integer\n    Dim WS As Worksheet\n    Dim L As Long\n\n    nowMonth = Month(Now)\n    nowYear = Year(Now)\n    Nowday = Day(Now)\n\n    ActiveWorkbook.Sheets.Add After:=Worksheets(Worksheets.Count)\n    ActiveWorkbook.Sheets(Worksheets.Count).Name = \"Summary \" &amp; Nowday &amp; \"-\" &amp; nowMonth &amp; \"-\" &amp; nowYear\n\n    'do nothing\n\n    ActiveSheet.Columns(1).Insert\n\n    For i = 2 To Sheets.Count\n        ActiveSheet.Cells(1, 1).Value = \"Project Name\"\n\n        For Each WS In Worksheets\n            Select Case WS.Name\n                Case \"Prices\", \"Home Page\", \"Model Digaram\", \"Validation &amp; Checks\", \"Model Start--&gt;\", \"Input|Assumptions\", \"Cost Assumption\"\n                Case Else\n                    ActiveSheet.Cells(i, 1).Value = WS.Name\n            End Select\n        Next WS\n    Next i\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1552446144, "post_id": 55133480, "comment_id": 97008487, "body": "Have you tried stepping through the code in the debugger to see why it&#39;s not working as you want?"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11194490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2713bab76e54ea4801062c9e876bd0a1?s=128&d=identicon&r=PG&f=1", "display_name": "bluesky", "link": "https://stackoverflow.com/users/11194490/bluesky"}, "edited": false, "score": 0, "creation_date": 1552502961, "post_id": 55133914, "comment_id": 97038869, "body": "Thank you for reviewing and providing a better solution."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11174618"}, "is_accepted": true, "score": 0, "last_activity_date": 1552447747, "creation_date": 1552447747, "answer_id": 55133914, "question_id": 55133480, "link": "https://stackoverflow.com/questions/55133480/change-number-generation-sequence/55133914#55133914", "title": "Change Number Generation Sequence", "body": "<p>Your method seems overly complicated and loops through every cell instead of looping through groups of the target cells.</p>\n\n<p>To simplify the math in calculating the target, I'd suggest <code>Option Base 1</code> as a compiler directive in the code sheet's declarations area. This changes the default for an array from zero based to one based; i.e. from <code>0 to 4</code> to <code>1 to 5</code>.</p>\n\n<p>By using LBound and UBound, you can change the array without cahnging any of the other code that shapes the target.</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nSub Button1_Click()\n\n    Dim myRows As Long, seq As Variant\n'myValue = InputBox(\"Enter a starting number\")\n    myRows = Application.InputBox(prompt:=\"Enter how times to repeat\", Type:=xlNumbers)\n\n    If IsNumeric(myRows) Then\n\n        seq = Array(1, 2, 3, 4, 5)\n\n        autogen seq, myRows\n\n    End If\n\nEnd Sub\n\nSub autogen(vals As Variant, n As Long)\n\n    Dim k As Long\n\n    For k = LBound(vals) To (n * UBound(vals)) Step UBound(vals)\n        Cells(1, \"F\").Offset(k - 1, 0).Resize(UBound(vals), 1) = _\n            Application.Transpose(vals)\n    Next k\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 11194490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2713bab76e54ea4801062c9e876bd0a1?s=128&d=identicon&r=PG&f=1", "display_name": "bluesky", "link": "https://stackoverflow.com/users/11194490/bluesky"}, "edited": false, "score": 0, "creation_date": 1552502995, "post_id": 55134244, "comment_id": 97038889, "body": "Thank you for your time and response."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1552450187, "creation_date": 1552450187, "answer_id": 55134244, "question_id": 55133480, "link": "https://stackoverflow.com/questions/55133480/change-number-generation-sequence/55134244#55134244", "title": "Change Number Generation Sequence", "body": "<h1>Number Generator (Fast)</h1>\n\n<p>Adjust the constants (<code>Const</code>) to fit your needs.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Button1_Click()\n\n    Dim myRows As Variant\n\n    myRows = InputBox(\"Enter how times to repeat\")\n    If IsNumeric(myRows) Then\n        Repeat CLng(myRows)\n    End If\n\nEnd Sub\n\nSub Repeat(Rows As Long)\n\n    Const cRange As String = \"F1\"   ' First Cell Range Address\n    Const cStart As Long = 1        ' Starting Value\n    Const cEnd As Long = 5          ' Ending Value\n\n    Dim vntT As Variant             ' Target Array\n    Dim i As Long                   ' Rows Counter\n    Dim k As Long                   ' Value Counter\n    Dim m As Long                   ' Target Array Row Counter\n\n    ' Resize Target Array: Number of Values times Rows.\n    ReDim vntT(1 To (cEnd - cStart + 1) * Rows, 1 To 1)\n    ' Loop through Rows.\n    For i = 1 To Rows\n        ' Loop through Values.\n        For k = cStart To cEnd\n            ' Count Target Array Row.\n            m = m + 1\n            ' Write current Value to element in current Target Array Row.\n            vntT(m, 1) = k\n        Next\n    Next\n\n    With Range(cRange)\n        ' Clear contents of Target Column Range from First Cell Range to\n        ' bottom cell.\n        .Resize(.Worksheet.Rows.Count - .Row + 1).ClearContents\n        ' Calculate Target Range: resize First Cell Range by Target Array Rows.\n        ' Copy Target Array to Target Range.\n        .Resize(m) = vntT\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 11194490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2713bab76e54ea4801062c9e876bd0a1?s=128&d=identicon&r=PG&f=1", "display_name": "bluesky", "link": "https://stackoverflow.com/users/11194490/bluesky"}, "edited": false, "score": 0, "creation_date": 1552502989, "post_id": 55134566, "comment_id": 97038883, "body": "Thank you for your time and response."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1552452252, "creation_date": 1552452252, "answer_id": 55134566, "question_id": 55133480, "link": "https://stackoverflow.com/questions/55133480/change-number-generation-sequence/55134566#55134566", "title": "Change Number Generation Sequence", "body": "<p>One more:</p>\n\n<pre><code>Dim myRows As Long, tot As Long\n\nmyRows = Application.InputBox(\"Enter how times to repeat\")\ntot = myRows * 5\n\nWith ActiveSheet.Range(\"K1\").Resize(tot, 1)\n    .FormulaArray = \"=1+MOD(ROW(1:\" &amp; tot &amp; \")-1,5)\"\n    .Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11194490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2713bab76e54ea4801062c9e876bd0a1?s=128&d=identicon&r=PG&f=1", "display_name": "bluesky", "link": "https://stackoverflow.com/users/11194490/bluesky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 55133914, "answer_count": 3, "score": 1, "last_activity_date": 1552463968, "creation_date": 1552444461, "last_edit_date": 1552463968, "question_id": 55133480, "link": "https://stackoverflow.com/questions/55133480/change-number-generation-sequence", "title": "Change Number Generation Sequence", "body": "<p>I am trying to write a VBA script where for every 5 counts of the number, the numbering starts back at 1. I'm taking the user input to loop through how many times the user wants to have the number set. Problem is, the numbers are not restarting from 1. Please help!!</p>\n\n<p>Example: user enters 2 times, expected result is-\n1\n2\n3\n4\n5\n1\n2\n3\n4\n5</p>\n\n<p>Code:</p>\n\n<pre><code>   Dim myValue, myRows As Variant\n   Dim i, j, x, y, m, n, k As Integer\n   Sub Button1_Click()\n   'myValue = InputBox(\"Enter a starting number\")\n   myRows = InputBox(\"Enter how times to repeat\")\n   'Call repeat(myRows)\n   Call repeat2(myRows)\n   End Sub\n\n   Sub repeat2(rep1)\n   m = 0\n   n = 0\n   k = 1\n\n   For k = 1 To myRows\n   'k = k + 1\n    m = m + 5\n    n = n + 5\n   Call autogen2(k)\n\n   Next k\n\n   End Sub\n\n   Sub autogen2(z)\n   For k = 1 To m + 5\n   Range(\"F\" &amp; k).Select\n   ActiveCell.FormulaR1C1 = k\n   ActiveCell.Offset(1, 0).Select\n   Next k\n   End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "consolidation"], "comments": [{"owner": {"reputation": 202, "user_id": 6631457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd506c3bb19b023957060bf6374322b?s=128&d=identicon&r=PG&f=1", "display_name": "J VBA", "link": "https://stackoverflow.com/users/6631457/j-vba"}, "edited": false, "score": 0, "creation_date": 1552444649, "post_id": 55133410, "comment_id": 97008184, "body": "Your <code>Selection.Consolidate</code> methods are threefold! Any reason? To that affect, <code>Consolidate</code> uses an Array, so if your references are manually entered, put them in an Array variable, so you can easily pass it along within your Routine, or other Routines."}, {"owner": {"reputation": 202, "user_id": 6631457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd506c3bb19b023957060bf6374322b?s=128&d=identicon&r=PG&f=1", "display_name": "J VBA", "link": "https://stackoverflow.com/users/6631457/j-vba"}, "edited": false, "score": 1, "creation_date": 1552444757, "post_id": 55133410, "comment_id": 97008203, "body": "And, <code>Dim</code> all your needed variables, and don&#39;t use <code>Selection</code> <i>unless</i> you&#39;re going to pick your ranges manually."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1552461164, "post_id": 55133410, "comment_id": 97012926, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. \u2022 I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>."}, {"owner": {"reputation": 1, "user_id": 11194425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ca410712bcc200484c93d963018561?s=128&d=identicon&r=PG&f=1", "display_name": "syed", "link": "https://stackoverflow.com/users/11194425/syed"}, "edited": false, "score": 0, "creation_date": 1552461872, "post_id": 55133410, "comment_id": 97013241, "body": "thank you and can you please advise how can i get to Dim sheets as at times there can be more than 300 sheets that i would have to consolidate the same array R10C1:R26C2."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11194425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ca410712bcc200484c93d963018561?s=128&d=identicon&r=PG&f=1", "display_name": "syed", "link": "https://stackoverflow.com/users/11194425/syed"}, "edited": false, "score": 0, "creation_date": 1552458025, "post_id": 55133597, "comment_id": 97011650, "body": "Thank you, the reason the &quot;Selection.Consolidate methods are threefold!&quot; due to the fact that i wanted &quot;Department Column&quot; to be copied when table gets consolidated  i don&#39;t know as the R10C1:R26C1 are all headings that repeat without changes and its only R10C2:R26C2 that changes in every sheet (numbers that need to be consolidated,) so i did not know how to run the routine. I have run this macro but it seems not to copy &quot;R10C1&quot;- (which is the  heading &quot;department&quot;) other heading in the column from R11C1 till R26C1 have all been copied."}, {"owner": {"reputation": 1, "user_id": 11194425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ca410712bcc200484c93d963018561?s=128&d=identicon&r=PG&f=1", "display_name": "syed", "link": "https://stackoverflow.com/users/11194425/syed"}, "edited": false, "score": 0, "creation_date": 1552458375, "post_id": 55133597, "comment_id": 97011783, "body": "and how can i get to Dim sheets as at times there can be more than 300 sheets that i would have to consolidate the same array R10C1:R26C2. i will really appreciate  your help as you would know i have very basic vba skills"}], "tags": [], "owner": {"reputation": 202, "user_id": 6631457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd506c3bb19b023957060bf6374322b?s=128&d=identicon&r=PG&f=1", "display_name": "J VBA", "link": "https://stackoverflow.com/users/6631457/j-vba"}, "is_accepted": false, "score": 0, "last_activity_date": 1552445679, "last_edit_date": 1552445679, "creation_date": 1552445358, "answer_id": 55133597, "question_id": 55133410, "link": "https://stackoverflow.com/questions/55133410/consolidate-data-from-multiple-worksheets-into-one-sheet/55133597#55133597", "title": "Consolidate data from multiple worksheets into one sheet", "body": "<p>I will try and answer here, but please fill in gaps for your 'paste' <em>ask</em>.</p>\n\n<pre><code>Option Explicit\n\nSub Macro15()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim ws2 As Worksheet\nDim arrRange()\n\nSet wb = ThisWorkbook\nSet ws = wb.ActiveSheet\n\narrRange = Array(\"Sheet4!R10C1:R26C2\", \"Sheet4 (2)!R10C1:R26C2\", \"Sheet4 (3)!R10C1:R26C2\", _\n\"Sheet4 (4)!R10C1:R26C2\", \"Sheet4 (5)!R10C1:R26C2\", \"Sheet4 (6)!R10C1:R26C2\", \"Sheet4 (7)!R10C1:R26C2\", _\n\"Sheet4 (8)!R10C1:R26C2\", \"Sheet4 (9)!R10C1:R26C2\", \"Sheet4 (10)!R10C1:R26C2\", \"Sheet4 (11)!R10C1:R26C2\", _\n\"Sheet4 (12)!R10C1:R26C2\", \"Sheet4 (13)!R10C1:R26C2\", \"Sheet4 (14)!R10C1:R26C2\")\n\nSet ws2 = wb.Sheets.Add\n\nWith ws2\n    .Range(\"A1\").Consolidate arrRange, xlSum, True, True, False\nEnd With\n\nApplication.ActiveWindow.SmallScroll Down:=-228\nws.Columns(\"A:A\").ColumnWidth = 23.88\nws.Columns(\"A:A\").ColumnWidth = 41.25\nws.Columns(\"A:A\").ColumnWidth = 47.88\nws.Columns(\"B:B\").ColumnWidth = 16.5\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11194425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ca410712bcc200484c93d963018561?s=128&d=identicon&r=PG&f=1", "display_name": "syed", "link": "https://stackoverflow.com/users/11194425/syed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552461118, "creation_date": 1552443815, "last_edit_date": 1552461118, "question_id": 55133410, "link": "https://stackoverflow.com/questions/55133410/consolidate-data-from-multiple-worksheets-into-one-sheet", "title": "Consolidate data from multiple worksheets into one sheet", "body": "<p>I am having trouble with writing a macro that could consolidate specific data range R10C1:R26C2 from multiple sheets in active workbook as i have to write macro physically for lets say 14 sheets as you can see from example. is there a way where the macro can pick any number of sheets within the active workbook within that data range and consolidate the data( i need to sum the data within the data range). And also i have to paste the same formula 3 times to make sure that headings of the tables (top row) and left row gets copied properly. Please help me, any help would be much appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HZFEo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HZFEo.png\" alt=\"this is the data set\"></a>    </p>\n\n<pre><code>Sub Macro15()    \n    Sheets.Add\n\n    ActiveSheet.Select\n    Range(\"A1\").Select\n\n    Selection.Consolidate Sources:=Array(\"Sheet4!R10C1:R26C2\", \"Sheet4 (2)!R10C1:R26C2\", \"Sheet4 (3)!R10C1:R26C2\", \"Sheet4 (4)!R10C1:R26C2\", \"Sheet4 (5)!R10C1:R26C2\", \"Sheet4 (6)!R10C1:R26C2\", \"Sheet4 (7)!R10C1:R26C2\", \"Sheet4 (8)!R10C1:R26C2\", \"Sheet4 (9)!R10C1:R26C2\", \"Sheet4 (10)!R10C1:R26C2\", \"Sheet4 (11)!R10C1:R26C2\", \"Sheet4 (12)!R10C1:R26C2\", \"Sheet4 (13)!R10C1:R26C2\", \"Sheet4 (14)!R10C1:R26C2\"), _\n    Function:=xlSum, TopRow:=True, LeftColumn:=True, CreateLinks:=False\n\n    Selection.Consolidate Sources:=Array(\"Sheet4!R10C1:R26C2\", \"Sheet4 (2)!R10C1:R26C2\", \"Sheet4 (3)!R10C1:R26C2\", \"Sheet4 (4)!R10C1:R26C2\", \"Sheet4 (5)!R10C1:R26C2\", \"Sheet4 (6)!R10C1:R26C2\", \"Sheet4 (7)!R10C1:R26C2\", \"Sheet4 (8)!R10C1:R26C2\", \"Sheet4 (9)!R10C1:R26C2\", \"Sheet4 (10)!R10C1:R26C2\", \"Sheet4 (11)!R10C1:R26C2\", \"Sheet4 (12)!R10C1:R26C2\", \"Sheet4 (13)!R10C1:R26C2\", \"Sheet4 (14)!R10C1:R26C2\"), _\n    Function:=xlSum, TopRow:=True, LeftColumn:=False, CreateLinks:=False\n\n    Selection.Consolidate Sources:=Array(\"Sheet4!R10C1:R26C2\", \"Sheet4 (2)!R10C1:R26C2\", \"Sheet4 (3)!R10C1:R26C2\", \"Sheet4 (4)!R10C1:R26C2\", \"Sheet4 (5)!R10C1:R26C2\", \"Sheet4 (6)!R10C1:R26C2\", \"Sheet4 (7)!R10C1:R26C2\", \"Sheet4 (8)!R10C1:R26C2\", \"Sheet4 (9)!R10C1:R26C2\", \"Sheet4 (10)!R10C1:R26C2\", \"Sheet4 (11)!R10C1:R26C2\", \"Sheet4 (12)!R10C1:R26C2\", \"Sheet4 (13)!R10C1:R26C2\", \"Sheet4 (14)!R10C1:R26C2\"), _\n    Function:=xlSum, TopRow:=True, LeftColumn:=True, CreateLinks:=False\n\n    ActiveWindow.SmallScroll Down:=-228\n    Columns(\"A:A\").ColumnWidth = 23.88\n    Columns(\"A:A\").ColumnWidth = 41.25\n    Columns(\"A:A\").ColumnWidth = 47.88\n    Columns(\"B:B\").ColumnWidth = 16.5\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1552444300, "post_id": 55133326, "comment_id": 97008113, "body": "Can&#39;t reproduce this... you get the same error in a completely new workbook?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1552444423, "post_id": 55133326, "comment_id": 97008136, "body": "Yeah even I can&#39;t reproduce it..."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1552444587, "post_id": 55133326, "comment_id": 97008169, "body": "I&#39;ve tried it in a new worksheet and it works. Could you explain what happened. I&#39;ve encountered this before."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1552444737, "post_id": 55133326, "comment_id": 97008197, "body": "I don&#39;t have an explanation, since I wasn&#39;t able to reproduce it :("}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1552445242, "post_id": 55133326, "comment_id": 97008310, "body": "@BigBen: The new workbook idea did the trick. If you could post it as an answer, I&#39;d gladly accept it. I&#39;ve already overwritten the original workbook, so I can&#39;t produce it either."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1552445522, "post_id": 55133326, "comment_id": 97008359, "body": "Uncertain why the original error but glad a new workbook was an easy solution!"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1552445451, "creation_date": 1552445451, "answer_id": 55133617, "question_id": 55133326, "link": "https://stackoverflow.com/questions/55133326/sub-with-arguments-produces-error-compile-error-constant-expression-required/55133617#55133617", "title": "Sub With Arguments Produces Error (Compile error: Constant expression required)", "body": "<p>I was unable to reproduce this error. The error description does not match the code you've provided; you clearly have Constants. </p>\n\n<p>Perhaps create a new workbook and copy this code into it, that's the only thing I can think of.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12019542, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b766bb219f58a1a2292e28bf41e86832?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/12019542/christian"}, "is_accepted": false, "score": 0, "last_activity_date": 1567597123, "creation_date": 1567597123, "answer_id": 57787598, "question_id": 55133326, "link": "https://stackoverflow.com/questions/55133326/sub-with-arguments-produces-error-compile-error-constant-expression-required/57787598#57787598", "title": "Sub With Arguments Produces Error (Compile error: Constant expression required)", "body": "<p>I just had the same issue: I defined constants at the beginning of a function and used these constants inside said function. I was getting the same error message like the OP.</p>\n\n<p>To resolve the issue, I simply cut the function from the module and pasted it into another module. I immediately was able to run the function as intended without any \"constant req'd\" errors. Finally, I moved the function back into the original module (cut and paste). It still works.</p>\n\n<p>Luckily, I didn't have to create a new workbook. My workbook is full with worksheet designs, various named cells and so on, I would have been a nightmare to reproduce everything from scratch in a new workbook.</p>\n"}], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55133617, "answer_count": 2, "score": 0, "last_activity_date": 1567597123, "creation_date": 1552443052, "question_id": 55133326, "link": "https://stackoverflow.com/questions/55133326/sub-with-arguments-produces-error-compile-error-constant-expression-required", "title": "Sub With Arguments Produces Error (Compile error: Constant expression required)", "body": "<p>I wrote this script which loops through a column and <strong>if</strong> it finds a value in it and a value in another column, changes the value of the other column. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RepChange()\n\n    Const Company As String = \"Kellog's\"\n    Const Representer As String = \"Elite\"\n    Const NewRepresenter As String = \"Core\"\n\n    Const cSheet As Variant = \"Sheet1\"\n    Const cColRep As Variant = \"H\"\n    Const cColComp As Variant = \"I\"\n    Const cFR As Long = 2\n\n    Dim LR As Long\n    Dim i As Long\n\n    With ThisWorkbook.Worksheets(cSheet)\n        LR = .Columns(cColComp).Cells(.Rows.Count).End(xlUp).Row\n        For i = cFR To LR\n            If StrComp(.Cells(i, cColComp), Company, vbTextCompare) = 0 And _\n                    StrComp(.Cells(i, cColRep), Representer, vbTextCompare) _\n                    = 0 Then .Cells(i, cColRep) = NewRepresenter\n        Next\n    End With\n\n    MsgBox \"Operation finished successfully.\", vbInformation, \"Success\"\n\nEnd Sub\n</code></pre>\n\n<p>It works fine. Now I wanted to use the first three constants as arguments of the Sub:</p>\n\n<pre><code>Sub RepChange2(Company As String, Representer As String, _\n        NewRepresenter As String)\n\n    Const cSheet As Variant = \"Sheet1\"\n    Const cColRep As Variant = \"H\"\n    Const cColComp As Variant = \"I\"\n    Const cFR As Long = 2\n\n    Dim LR As Long\n    Dim i As Long\n\n    With ThisWorkbook.Worksheets(cSheet)\n        LR = .Columns(cColComp).Cells(.Rows.Count).End(xlUp).Row\n        For i = cFR To LR\n            If StrComp(.Cells(i, cColComp), Company, vbTextCompare) = 0 And _\n                    StrComp(.Cells(i, cColRep), Representer, vbTextCompare) _\n                    = 0 Then .Cells(i, cColRep) = NewRepresenter\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>so I could use the following:</p>\n\n<pre><code>Sub Kellogs()\n    RepChange2 \"Kellog's\", \"Elite\", \"Core\"\nEnd Sub\n</code></pre>\n\n<p>but it produces the following error:</p>\n\n<blockquote>\n  <p>Compile error: Constant expression required</p>\n</blockquote>\n\n<p>in the line</p>\n\n<pre><code>With ThisWorkbook.Worksheets(cSheet)\n</code></pre>\n\n<p>where <code>cSheet</code> is grayed out. If I replace it with \"Sheet1\", another error occurs in the next line:</p>\n\n<pre><code>LR = .Columns(cColComp).Cells(.Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>where <code>cColComp</code> is grayed out etc. Changing the <code>Variants</code> to <code>Strings</code> doesn't help.</p>\n\n<p>Would appreciate any help.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 202, "user_id": 6631457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd506c3bb19b023957060bf6374322b?s=128&d=identicon&r=PG&f=1", "display_name": "J VBA", "link": "https://stackoverflow.com/users/6631457/j-vba"}, "edited": false, "score": 0, "creation_date": 1552446004, "post_id": 55133017, "comment_id": 97008462, "body": "Please use the <code>Option Explicit</code> statement in your code. You have two <code>Sub</code> but only one <code>End Sub</code>. That alone is bad. But, looks like your <code>.Display</code> method is <i>before</i> your <code>CreateAppointment</code> Sub. Switch out <code>.Display</code> to <code>.Save</code> and see what happens..."}, {"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "reply_to_user": {"reputation": 202, "user_id": 6631457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd506c3bb19b023957060bf6374322b?s=128&d=identicon&r=PG&f=1", "display_name": "J VBA", "link": "https://stackoverflow.com/users/6631457/j-vba"}, "edited": false, "score": 0, "creation_date": 1552482494, "post_id": 55133017, "comment_id": 97025482, "body": "@JVBA The missing End Sub was a result of an error copying the code. As for the <code>.Display</code> and <code>.Save</code>, would switching to Save not automatically save the contact? This is not what I want as the user must type the desired contact information first. Also, what is the advantage of <code>Option Explicit</code> in my case? I already declare all variables."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1552506785, "post_id": 55133017, "comment_id": 97040692, "body": "Option Explicit can indicate typos in variable names as they are not declared. Consider Option Explicit to be mandatory. Microsoft is amiss in allowing it to be optional."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1552588572, "post_id": 55152093, "comment_id": 97078818, "body": "What I want to do is show the modal, have the user input whatever information they desire,  then open a new appointment window with some information pre populated after they&#39;ve saved the contact. I will look more into the items add. Is there a more appropriate event handler specific to the contact item I should be looking at such as Send or AfterWrite?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1552588700, "post_id": 55152093, "comment_id": 97078881, "body": "If you want to show the contact modally, all you have to do is replace Disptay with Display true."}, {"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1552668117, "post_id": 55152093, "comment_id": 97112306, "body": "My issue is not getting the modal to display, my issue is having the appointment sub not be called until the contactitem has been saved by the user hitting save on the modal window after entering any info/fields they wish. I think I am on the right track with using Item_Send event handler, but I am ironing out some more issues and can report back with findings."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1552669270, "post_id": 55152093, "comment_id": 97112938, "body": "I really do not understand - do you want CreateAppointment() to be called <i>before</i> the contact is saved?"}, {"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1552955177, "post_id": 55152093, "comment_id": 97198113, "body": "No - I want the CreateAppointment() to only be called ONCE the contact is saved."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1552959487, "post_id": 55152093, "comment_id": 97198989, "body": "Then Items.ItemAdd event on the folder is the way to go."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1552516013, "creation_date": 1552516013, "answer_id": 55152093, "question_id": 55133017, "link": "https://stackoverflow.com/questions/55133017/create-appointment-after-contact-has-been-saved/55152093#55152093", "title": "Create Appointment After Contact has been Saved", "body": "<p>You can either show the contact modally (<code>.Display(true)</code>), or you can watch the <code>Items.ItemAdd</code> event on the Contacts folder to fire (after the contact is saved) and use the item passed to your event handler. </p>\n"}], "owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592689027, "creation_date": 1552440305, "last_edit_date": 1592689027, "question_id": 55133017, "link": "https://stackoverflow.com/questions/55133017/create-appointment-after-contact-has-been-saved", "title": "Create Appointment After Contact has been Saved", "body": "<p>I am writing a macro to create an appointment after a contact has been created.</p>\n\n<p>A user can click the button, enter the details for the contact, and once saved, it should open a new appointment window.</p>\n\n<p>The issue is the appointment sub being called before the contact has been saved. Thus, the object/contact does not exist to be passed to the sub.</p>\n\n<p>My code:</p>\n\n<pre><code>' Application-level variables \nPublic objOL As Outlook.Application \nPublic objNS As Outlook.NameSpace\n\n' Public Folders \nPublic objPublicFolderRoot As Outlook.Folder \nPublic objCompanyFolder As Outlook.Folder \nPublic objContactFolder As Outlook.Folder \nPublic objCalFolder As Outlook.Folder\n\n' Set the Public Folders \nSet objPublicFolderRoot = objNS.GetDefaultFolder(olPublicFoldersAllPublicFolders) Set objCompanyFolder = objPublicFolderRoot.Folders(\"Company_Shared\") Set objContactFolder = objCompanyFolder.Folders(\"Contacts\") Set objCalFolder = objCompanyFolder.Folders(\"Calendars\")\n\nSub CreateEmptyContact()\n    Dim objContact As Outlook.ContactItem\n    Set objNS = Application.GetNamespace(\"MAPI\")\n\n    ' Build out the contact item\n    Set objContact = objContactFolder.Items.Add(olContactItem)\n\n    With objContact\n        .Display\n    End With\n\n    CreateAppointment(objContact)\n\n    ' Reset vars\n    Set objContact = Nothing\n    Set objPublicFolderRoot = Nothing\n    Set objCompanyFolder = Nothing\n    Set objContactFolder = Nothing\n\nEnd Sub\n\nPublic Sub CreateAppointment(objContact As Outlook.ContactItem)   \n' Create the appointment on the public folder calendar with the passed contact Public Sub CreateAppointment(objContact As Outlook.ContactItem)\n    Dim objCalAppt As Outlook.AppointmentItem\n    Set objCalAppt = Application.CreateItem(olAppointmentItem)  \n\n    ' Add to the Appointment to the existing Calendar items\n    Set objCalAppt = objCalFolder.Items.Add(olAppointmentItem)\n    With objCalAppt\n        .MeetingStatus = olNonMeeting 'Not an invitation\n        .Start = Now\n        .Duration = 120\n        .Save\n        .Display\n    End With\n\n    ' Reset vars\n    Set objCalAppt = Nothing   \nEnd Sub\n</code></pre>\n\n<p>What is my best method moving forward. For example, should I be using something like a WithEvents on the Contact_Send or Contact_AfterWrite?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11174618"}, "edited": false, "score": 2, "creation_date": 1552440586, "post_id": 55132885, "comment_id": 97007399, "body": "Does your version of excel have the MINIFS function?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11194245, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1JOBaTu4AlA/AAAAAAAAAAI/AAAAAAAABw4/rvABdqQUBB0/photo.jpg?sz=128", "display_name": "Mandy1999", "link": "https://stackoverflow.com/users/11194245/mandy1999"}, "edited": false, "score": 0, "creation_date": 1552526959, "post_id": 55133120, "comment_id": 97047518, "body": "Thanks..I used this one since IFERROR was not working when result was 0 =IF(MINIFS(E:E, B:B, B2, E:E, &quot;&gt;&quot;&amp;E2) &lt;&gt; 0, MINIFS(E:E, B:B, B2, E:E, &quot;&gt;&quot;&amp;E2), DATE(2017,1,1))"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11174618"}, "is_accepted": false, "score": 1, "last_activity_date": 1552441632, "last_edit_date": 1552441632, "creation_date": 1552441224, "answer_id": 55133120, "question_id": 55132885, "link": "https://stackoverflow.com/questions/55132885/excel-function-to-find-next-higher-value/55133120#55133120", "title": "Excel function to find next higher value", "body": "<p>Per the sample image, put one if these in this in C2 and drag down.</p>\n\n<pre><code>'xl2003-xl2007\n=MIN(MIN(INDEX(B$2:B$99+((A$2:A$99&lt;&gt;A2)+(B$2:B$99&lt;=B2))*1E+99, , )), DATE(2017, 1, 1))\n'xl2010-xl2013\n=IFERROR(AGGREGATE(15, 7, B$2:B$99/((A$2:A$99=A2)*(B$2:B$99&gt;B2)), 1), DATE(2017, 1, 1))\n'xl2016/Office 365\n=IFERROR(MINIFS(B:B, A:A, A2, B:B, \"&gt;\"&amp;B2), DATE(2017, 1, 1))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NjilF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NjilF.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 11194245, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1JOBaTu4AlA/AAAAAAAAAAI/AAAAAAAABw4/rvABdqQUBB0/photo.jpg?sz=128", "display_name": "Mandy1999", "link": "https://stackoverflow.com/users/11194245/mandy1999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553091898, "creation_date": 1552439132, "last_edit_date": 1553091898, "question_id": 55132885, "link": "https://stackoverflow.com/questions/55132885/excel-function-to-find-next-higher-value", "title": "Excel function to find next higher value", "body": "<p>I have data like below. I am calculating third column (next higher date. For each unique values of created date for data, I need to know what is next higher date available for data. There are duplicates. Also if there is no next higher date then I use generic date of 1/1/2017.  </p>\n\n<p>Last date = 1/1/2017</p>\n\n<p><img src=\"https://i.stack.imgur.com/FzZww.png\" alt=\"Sample data \"></p>\n\n<p>Now my question here is how can I achieve this using INDEX/MATCH or LARGE functions or do I need to use VBA scripting to get my results?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1552435261, "post_id": 55132297, "comment_id": 97006306, "body": "Filter the data on #N/A and you can copy-paste from M-L.  If you record a macro while doing that it will give you a starting point to work from."}, {"owner": {"reputation": 35, "user_id": 11048152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909df7a532a203ded52d72c2e2c783fe?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pandola", "link": "https://stackoverflow.com/users/11048152/michael-pandola"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1552436005, "post_id": 55132297, "comment_id": 97006491, "body": "@Tim Williams I had tried that but I have having trouble getting it to work consistently when the data in the initial table changes"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1552436127, "post_id": 55132297, "comment_id": 97006531, "body": "It&#39;s always a good idea to post your current code, even if it&#39;s not working (and describe exactly <i>how</i> it&#39;s not working)  Questions with no code tend to get closed quickly here..."}, {"owner": {"reputation": 202, "user_id": 6631457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd506c3bb19b023957060bf6374322b?s=128&d=identicon&r=PG&f=1", "display_name": "J VBA", "link": "https://stackoverflow.com/users/6631457/j-vba"}, "edited": false, "score": 1, "creation_date": 1552436419, "post_id": 55132297, "comment_id": 97006604, "body": "Yes, get some code, first. In the meantime, you can read about <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.isna?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaxl10.chm137075)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">WorksheetFunction.IsNA</a> to find #N/A cells..."}, {"owner": {"reputation": 35, "user_id": 11048152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909df7a532a203ded52d72c2e2c783fe?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pandola", "link": "https://stackoverflow.com/users/11048152/michael-pandola"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1552493622, "post_id": 55132297, "comment_id": 97033618, "body": "@TimWilliams @J VBA I have added code and will read up on the link you sent"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11048152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909df7a532a203ded52d72c2e2c783fe?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pandola", "link": "https://stackoverflow.com/users/11048152/michael-pandola"}, "edited": false, "score": 0, "creation_date": 1552500574, "post_id": 55146857, "comment_id": 97037579, "body": "Thanks Dean. I will try this and get back to you!"}, {"owner": {"reputation": 35, "user_id": 11048152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909df7a532a203ded52d72c2e2c783fe?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pandola", "link": "https://stackoverflow.com/users/11048152/michael-pandola"}, "edited": false, "score": 0, "creation_date": 1552507896, "post_id": 55146857, "comment_id": 97041204, "body": "Hello Dean, Your solution worked perfectly. I had to edit it slightly to get the information to past correctly but it did exactly what I needed!"}], "tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": true, "score": 0, "last_activity_date": 1552494695, "creation_date": 1552494695, "answer_id": 55146857, "question_id": 55132297, "link": "https://stackoverflow.com/questions/55132297/find-value-in-table-then-copy-values-in-different-columns-to-a-different-table/55146857#55146857", "title": "Find value in table then copy values in different columns to a different table", "body": "<p>The way I would approach this is to first iterate through column N on sheet 1, when #N/A found then copy the cells and paste in corresponding location on sheet 2. Something like the below:</p>\n\n<pre><code>Sub CopyProcedure()\n\n    Dim i As Long\n    Dim lRow1 As Long, lRow2 As Long\n    Dim wsSheet1 As Worksheet, wsSheet2 As Worksheet\n\n    Set wsSheet1 = Sheets(\"Sheet 1\")\n    Set wsSheet2 = Sheets(\"Sheet 2\")\n\n    lRow1 = wsSheet1.Range(\"N\" &amp; wsSheet1.Rows.Count).End(xlUp).Row\n\n    'assuming your data starts in the first row\n    'iterate to the last row of column n\n    For i = 1 To lRow1\n        'look for the #N/A text\n        If wsSheet1.Range(\"N\" &amp; i).Text = \"#N/A\" Then\n            'adjust this to suit which column in sheet 2 you need\n            lRow2 = wsSheet2.Range(\"A\" &amp; wsSheet2.Rows.Count).End(xlUp).Row + 1\n            'when text found copy required cells\n            wsSheet1.Range(\"L\" &amp; i, \"M\" &amp; i).Copy\n            'paste cell values in required location on sheet 2\n            'NOTE THIS WILL PASTE IN THE LAST ROW SPECIFIED ON SHEET 2 AND IN COLUMN A\n            'adjust as you see fit\n            wsSheet2.Range(\"A\" &amp; lRow2).PasteSpecial xlPasteValues\n            'empty clipboard\n            Application.CutCopyMode = False\n        End If\n    Next i\n\n    Set wsSheet1 = Nothing\n    Set wsSheet2 = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This is by no means the most efficient way to do it, but I am sure it will get the job done if I understand your problem correctly.</p>\n\n<p>Also, caveat, I haven't tested or debugged this. :)</p>\n"}], "owner": {"reputation": 35, "user_id": 11048152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909df7a532a203ded52d72c2e2c783fe?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pandola", "link": "https://stackoverflow.com/users/11048152/michael-pandola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 55146857, "answer_count": 1, "score": 0, "last_activity_date": 1552494695, "creation_date": 1552434104, "last_edit_date": 1552493583, "question_id": 55132297, "link": "https://stackoverflow.com/questions/55132297/find-value-in-table-then-copy-values-in-different-columns-to-a-different-table", "title": "Find value in table then copy values in different columns to a different table", "body": "<p>I have a table in Sheet1 of a workbook and several rows of the table will have #N/A as their value of column N. I would like to find a way to have a vba macro find all rows that have #N/A in column N then copy the values from column M and L of those rows to the bottom of another table on Sheet2 of the same workbook.</p>\n\n<pre><code>ActiveSheet.ListObjects(\"SEC_Data\").Range.AutoFilter Field:=14, Criteria1:= _\n    \"#N/A\"\nRange(\"M88343:M88351\").Select\nSelection.Copy\nSheets(\"LKUP_Client Name\").Select\nRange(\"B2\").Select\nSelection.End(xlDown).Select\nRange(\"B\" &amp; ActiveCell.Row + 1).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSheets(\"company_2018 thru2019_gim\").Select\nRange(\"L88343:L88351\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"LKUP_Client Name\").Select\nRange(\"C\").Select\nSelection.End(xlDown).Select\nRange(\"C\" &amp; ActiveCell.Row + 1).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 243, "user_id": 11150865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876228fe677a2716cf90d310ac35274a?s=128&d=identicon&r=PG&f=1", "display_name": "Ted D.", "link": "https://stackoverflow.com/users/11150865/ted-d"}, "edited": false, "score": 0, "creation_date": 1552433321, "post_id": 55132130, "comment_id": 97005826, "body": "add an example to make it clearer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user628985"}, "edited": false, "score": 0, "creation_date": 1552433724, "post_id": 55132130, "comment_id": 97005941, "body": "Hi, Welcome to StackOverflow. As Ted suggest, an example would help a great deal. Also what have you tried so far? The more information you can give us, the better help we can be to you :-)"}, {"owner": {"reputation": 243, "user_id": 11150865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876228fe677a2716cf90d310ac35274a?s=128&d=identicon&r=PG&f=1", "display_name": "Ted D.", "link": "https://stackoverflow.com/users/11150865/ted-d"}, "edited": false, "score": 0, "creation_date": 1552434190, "post_id": 55132130, "comment_id": 97006063, "body": "Edit your question. There is an <code>edit</code> link above the comments and below the question."}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1552445569, "last_edit_date": 1552445569, "creation_date": 1552441730, "answer_id": 55133183, "question_id": 55132130, "link": "https://stackoverflow.com/questions/55132130/excel-formula-to-search-one-cell-and-replace-text-in-another-cell/55133183#55133183", "title": "Excel Formula to Search One Cell and Replace Text in Another Cell", "body": "<h1>Rep Change</h1>\n\n<h2>Excel</h2>\n\n<p>You could create a unique list of company names and add the representatives. Then you could use an <code>INDEX/MATCH</code> formula in the representative column (<code>H</code>), something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BTYDo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BTYDo.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then you could change <code>Elite</code> in one place only (<code>M7</code>) and it would automatically change in all the cells of the <code>H</code> column, e.g. <code>H4</code>.</p>\n\n<h2>VBA</h2>\n\n<p>If you need it for one time operations, the following code might be helpful. Adjust the constants to fit your needs.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RepChange()\n\n    Const Company As String = \"Kellog's\"\n    Const Representer As String = \"Elite\"\n    Const NewRepresenter As String = \"Core\"\n\n    Const cSheet As Variant = \"Sheet1\"\n    Const cColRep As Variant = \"H\"\n    Const cColComp As Variant = \"I\"\n    Const cFR As Long = 2\n\n    Dim LR As Long\n    Dim i As Long\n\n    With ThisWorkbook.Worksheets(cSheet)\n        LR = .Columns(cColComp).Cells(.Rows.Count).End(xlUp).Row\n        For i = cFR To LR\n            If StrComp(.Cells(i, cColComp), Company, vbTextCompare) = 0 And _\n                    StrComp(.Cells(i, cColRep), Representer, vbTextCompare) _\n                    = 0 Then .Cells(i, cColRep) = NewRepresenter\n        Next\n    End With\n\n    MsgBox \"Operation finished successfully.\", vbInformation, \"Success\"\n\nEnd Sub\n</code></pre>\n\n<p><code>StrComp</code> with <code>vbTextCompare</code> is used to avoid case-sensitivity i.e. AA=Aa=aa. </p>\n\n<p>Or you could use this:</p>\n\n<pre><code>Sub RepChange2(Company As String, Representer As String, _\n        NewRepresenter As String)\n\n    Const cSheet As Variant = \"Sheet1\"\n    Const cColRep As Variant = \"H\"\n    Const cColComp As Variant = \"I\"\n    Const cFR As Long = 2\n\n    Dim LR As Long\n    Dim i As Long\n\n    With ThisWorkbook.Worksheets(cSheet)\n        LR = .Columns(cColComp).Cells(.Rows.Count).End(xlUp).Row\n        For i = cFR To LR\n            If StrComp(.Cells(i, cColComp), Company, vbTextCompare) = 0 And _\n                    StrComp(.Cells(i, cColRep), Representer, vbTextCompare) _\n                    = 0 Then .Cells(i, cColRep) = NewRepresenter\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>where you could write even several statements in a sub like this one:</p>\n\n<pre><code>Sub Kellogs()\n    RepChange2 \"Kellog's\", \"Elite\", \"Core\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11194048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb44c89bae3fe4b811152bf366e70c59?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/11194048/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552463916, "creation_date": 1552433133, "last_edit_date": 1552463916, "question_id": 55132130, "link": "https://stackoverflow.com/questions/55132130/excel-formula-to-search-one-cell-and-replace-text-in-another-cell", "title": "Excel Formula to Search One Cell and Replace Text in Another Cell", "body": "<p>I've been searching all over and found a lot of posts that are almost what I need, but nothing exactly right. Hoping someone here can help. </p>\n\n<p>I have two columns of data, column H contains broker names (Broker1, Broker2, etc). Column I contains the name of the company they rep (ABC, BBC, etc). These affiliations change often so I am looking for a way to setup a formula or macro for quick changes. Essentially what I want to do is say \"If the cell I2 contains company ABC, change H2 to Broker2.\" </p>\n\n<p>All the substitute and replace functions seem to be centered around replace all Broker1 with Broker2, but I need to be able to make this change only when a certain company is involved. Broker2 may rep 20 companies, so I need to be able to limit the find and replace to certain data elements. </p>\n\n<p>Hope this all makes sense, thanks in advance for the help! </p>\n\n<p>Adding details:\nOk, so a real life example. A company named Elite represents Kellogg's. H2 = \"Elite\" and I2 = 'Kellogg's\". However, Kellogg's may change over to another company named Core. So I need to go search I2:I200 and wherever we find \"Kellogg's\" replace H with \"Core\". So if I78 = \"Kellogg's\" I need to change H78 to \"Core\". Trouble is, Elite may rep 20 other companies who don't move, so I can't completely replace all of Elite with Core on my list, only in very certain circumstances</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552450547, "post_id": 55131757, "comment_id": 97009426, "body": "Thank you for you quick answer.  My code was in <code>sheet</code> and it worked <b>manually</b>"}, {"owner": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552451085, "post_id": 55131757, "comment_id": 97009574, "body": "Thank you for you quick answer.  My code was in <code>sheet</code> and it worked <b>manually</b>. As I used your code (not automation part) in <code>Thisworkbook</code> it runs manually only the first part, that is F2+Enter. It stops there. It <b>does not proceed</b> to <code>Private Sub Worksheet_Change(ByVal Target As Range)</code>.  Also please explain how to use <code>Private Sub Workbook_Open()     &#39;call macro test2       test2 End Sub</code>         Thank you in advance."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552456386, "post_id": 55131757, "comment_id": 97011025, "body": "@dgoldi as you made your event for the sheet change.c you click on \u201cThisWorkbook\u201d on the left side of your editor, in the project tree, and you write your code in there."}, {"owner": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552479911, "post_id": 55131757, "comment_id": 97023832, "body": "The same code writen in Sheet1 (not &quot;ThisWorkbook&quot;) manually performs well (not automatically).  The same code writen in &quot;ThisWorkbook&quot; starts performing automatically when file opens, but stops in the middle (as mentions earlier).  There should be some combination. Please help. Thank you."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552480449, "post_id": 55131757, "comment_id": 97024179, "body": "@d.goldi can you explain me in words what you&#39;re trying to do with your macro <code>test2</code>?"}, {"owner": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552480954, "post_id": 55131757, "comment_id": 97024510, "body": "I have scadule with dates in B3:P3 and today function in A1. When opening workbook, I would like to hide colomns that have dates less than in A1."}, {"owner": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552481190, "post_id": 55131757, "comment_id": 97024669, "body": "test2 starts with &quot;pushing&quot; F2 and then Enter, and continues by hiding colomns. it works when writen in Sheet1 and manually lounched"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552482263, "post_id": 55131757, "comment_id": 97025329, "body": "@d.goldi the hiding column is in the <code>Worksheet_Change</code> event. If I only read at <code>test2</code>, you just enter the cell (F2) and confirm the value (Enter). Is this some sort of workaround you apply to call the code in <code>Worksheet_Change</code>?"}, {"owner": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552485100, "post_id": 55131757, "comment_id": 97027366, "body": "@ MatteoNNZ Yes, exactly. &#39;test2&#39; is to call the code &#39;Worksheet_Change&#39;.  I could not find another solution to do it automatically."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1552485651, "post_id": 55131757, "comment_id": 97027747, "body": "@d.goldi ok, so I&#39;m modifying my answer for that."}, {"owner": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1553000314, "post_id": 55131757, "comment_id": 97216050, "body": "Can the code be modified in order to run the same action on all sheets (the ranges are same)?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "edited": false, "score": 0, "creation_date": 1553004238, "post_id": 55131757, "comment_id": 97218687, "body": "@d.goldi yes it can, just wrap your code into an outer loop like <code>For Each sht In ThisWorkbook.Sheets</code> and then use <code>sht</code> every time you call a <code>Range</code> or <code>Cell</code> to make sure it runs into the good sheet."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1552485963, "last_edit_date": 1552485963, "creation_date": 1552430784, "answer_id": 55131757, "question_id": 55131528, "link": "https://stackoverflow.com/questions/55131528/auto-run-two-vba-codes-when-an-excel-workbook-opens/55131757#55131757", "title": "Auto run two vba codes when an Excel workbook opens", "body": "<p>I think you're doing an over-engineering here. \nCurrently you want to: </p>\n\n<ul>\n<li>Call on open <code>Workbook_Open</code></li>\n<li>... the macro <code>test2</code> which simulates a change in the sheet (by pressing F2 and Enter), so that...</li>\n<li>... the code inside <code>Worksheet_Change</code> gets called.</li>\n</ul>\n\n<p>In fact, what you really want is to have the code that is now inside <code>Worksheet_Change</code> inside <code>Workbook_Open</code>. </p>\n\n<p>So: </p>\n\n<ol>\n<li>Remove <code>test2</code></li>\n<li>Remove the code from <code>Worksheet_Change</code></li>\n<li><p>Add your code directly inside <code>Workbook_Open</code> as follows: </p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim xCell As Range\n    Dim Target As Range: Set Target = Sheets(\"yourSheet\").Range(\"A1\")\n    Application.ScreenUpdating = False\n    For Each xCell In Sheets(\"yourSheet\").Range(\"B3:P3\")\n        xCell.EntireColumn.Hidden = (xCell.Value &lt; Target.Value)\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 11193877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114531cb7ab570f97fa2d0ddbd9a300b?s=128&d=identicon&r=PG&f=1", "display_name": "d.goldi", "link": "https://stackoverflow.com/users/11193877/d-goldi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 55131757, "answer_count": 1, "score": -1, "last_activity_date": 1552485963, "creation_date": 1552429521, "last_edit_date": 1552481819, "question_id": 55131528, "link": "https://stackoverflow.com/questions/55131528/auto-run-two-vba-codes-when-an-excel-workbook-opens", "title": "Auto run two vba codes when an Excel workbook opens", "body": "<p>I have two VBA codes I would like to run when the Excel workbook is opened.</p>\n\n<pre><code>Sub test2()\n    Dim c As Range\n    For Each c In Range(\"A1:A1\").Cells\n        c.Select\n        SendKeys \"{F2}\", True\n        SendKeys \"{ENTER}\", True\n    Next\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim xCell As Range\n    If Target.Address &lt;&gt; Range(\"A1\").Address Then Exit Sub\n    Application.ScreenUpdating = False\n    For Each xCell In Range(\"B3:P3\")\n        xCell.EntireColumn.Hidden = (xCell.Value &lt; Target.Value)\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>It runs perfectly manually.</p>\n\n<p>I have tried <code>Sub Workbook_Open</code>, but it does not work.\nI have tried in module, in sheet and in <code>ThisWorkbook</code> too.\nCould not make it work automatically as the workbook opens.   </p>\n\n<p>This code is supposed to F2+Enter cell A1 and then hide some columns depending on value in A1.</p>\n\n<p>I modified code in this way:</p>\n\n<pre><code>Private Sub Workbook_Open()\n     test2\nEnd Sub\nSub test2()\n    Dim c As Range\n    For Each c In Sheets(\"MySheet\").Range(\"A1:A1\").Cells\n        c.Select\n        SendKeys \"{F2}\", True\n        SendKeys \"{ENTER}\", True\n    Next\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim xCell As Range\n    If Target.Address &lt;&gt; Range(\"A1\").Address Then Exit Sub\n    Application.ScreenUpdating = False\n    For Each xCell In Range(\"B3:P3\")\n        xCell.EntireColumn.Hidden = (xCell.Value &lt; Target.Value)\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>When openning worksheet it starts performing, does the first part (F2+Enter), but stops there. Does not perform this part: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n        Dim xCell As Range\n        If Target.Address &lt;&gt; Range(\"A1\").Address Then Exit Sub\n        Application.ScreenUpdating = False\n        For Each xCell In Range(\"B3:P3\")\n            xCell.EntireColumn.Hidden = (xCell.Value &lt; Target.Value)\n        Next\n        Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n\n<p>Code writen in Sheet1 (not \"ThisWorkbook\") manually performs well (not automatically).</p>\n\n<p>The same code writen in \"ThisWorkbook\" starts performing automatically when file opens, but stops in the middle (as mentions earlier).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1552427463, "post_id": 55131029, "comment_id": 97003943, "body": "There are a lot of things <i>wrong</i> with this code - I&#39;ll try to keep this short. <code>Dim NYSID, PLookUpTabRange, IsRR, DidTransfer As String</code> is only declaring <code>DidTransfer</code> as string, the rest are variants. Make all your integers long. Put <code>Option Explicit</code> at the top of your module. Why are you looking for <code>RR          </code>? Use <code>Trim</code> instead. If you&#39;re deleting rows, you need to loop backwards (using <code>Step -1</code>) or you&#39;re going to encounter issues. There are more, but you should cut your question down to something more tangible so that we can help you..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1552427763, "post_id": 55131029, "comment_id": 97004063, "body": "<code>DidTransfer = DidTransfer</code> is useless. <code>.Cells(256, &quot;H&quot;).End(xlUp).Row</code> - why 256? This isn&#39;t always going to give you the right value, depending on your data set. Your <code>IsError</code> snippet at the bottom looks like it&#39;s saying &quot;Whether it&#39;s an error or not, do this anyways&quot;, which makes no sense... I&#39;m not trying to be  mean when I say this, but I genuinely think you should start over and really think about what you&#39;re trying to accomplish - keep it simple!"}, {"owner": {"reputation": 800, "user_id": 6310948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d0VKq.jpg?s=128&g=1", "display_name": "Erjon", "link": "https://stackoverflow.com/users/6310948/erjon"}, "edited": false, "score": 0, "creation_date": 1552433476, "post_id": 55131029, "comment_id": 97005880, "body": "If you are going to delete rows then <code>For TempFirstRow = 2 To TempLastRow</code> is going to be <code>For TempFirstRow = TempLastRow To 2 step -1</code>"}, {"owner": {"reputation": 202, "user_id": 6631457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd506c3bb19b023957060bf6374322b?s=128&d=identicon&r=PG&f=1", "display_name": "J VBA", "link": "https://stackoverflow.com/users/6631457/j-vba"}, "edited": false, "score": 0, "creation_date": 1552436765, "post_id": 55131029, "comment_id": 97006675, "body": "They&#39;re saying when you delete a row, the next one is skipped as the <code>xlShftUp</code> moved the next up to the current iteration. You can either <code>Step - 1</code>, or have your iteration minus 1 -- <code>TempFirstRow = TempFirstRow  - 1</code> to not skip your rows."}, {"owner": {"reputation": 39, "user_id": 9990923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9182b7600f00c009a2aef7ae6d6baf8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9990923/mike"}, "edited": false, "score": 0, "creation_date": 1552484886, "post_id": 55131029, "comment_id": 97027205, "body": "Thanks everyone for your comments. Made the modifications as needed. I need some clarification. Dwirony the Referenced table (256) if the last row with the data of interest. After 256, there is other data that I would like not to include. Erjon, can you clarify more as to how I would structure the loop? Is is just as simple as modifying the loop code that I have and replacing it with the code you have?"}], "owner": {"reputation": 39, "user_id": 9990923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9182b7600f00c009a2aef7ae6d6baf8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9990923/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552427210, "creation_date": 1552426752, "last_edit_date": 1552427210, "question_id": 55131029, "link": "https://stackoverflow.com/questions/55131029/assigning-a-row-range-to-a-variable", "title": "Assigning a row range to a variable", "body": "<p>I have been trying so hard. I cant figure this out. I am working with two sheets. One sheet searches for a criteria \"RR\", ir there is an RR, it assigns a variable a serial to be searched in another sheet. If the serial is found in the other sheet, I would like to determine the row where it is located and assign it to a variable. \"DidTransfer = Sheets(PreviousTabName).Range(\"B\" &amp; thiscell.Row).Value\" The problem when I use thiscell.Row, its giving me so many problems. I need the row number to so I can reference the same row to get information from another cell on the same row. Please help. </p>\n\n<pre><code>Sub TempModifier()\n\nDim NYSID, PLookUpTabRange, IsRR, DidTransfer As String\n\nDim thiscell As Range\n\n'Variable for Temp\nDim TempFirstRow As Integer\nDim TempLastRow As Long\n\n'Variables for the previous\nDim PreviousTabLastRow As Long\nDim PreviousTabFirstRow As Integer\n\n'Initialize the temp variables\nTempLastRow = Sheets(\"Temp\").Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nPreviousTabName = \"February\"\nPreviousTabFirstRow = 7\n\nWith Sheets(PreviousTabName)\n        PreviousTabLastRow = .Cells(256, \"H\").End(xlUp).Row 'Get the last row in the data range\nEnd With\n\n'Create a data-range variable\nPLookUpTabRange = \"H\" &amp; PreviousTabFirstRow &amp; \":\" &amp; \"H\" &amp; PreviousTabLastRow\n\n'Begin looping structure to copy data from the temp tab to the current tab\n\n\n\nFor TempFirstRow = 2 To TempLastRow\n\n    'Assign the value of the housing unit\n    IsRR = Sheets(\"Temp\").Cells(TempFirstRow, 2).Value\n\n    'Check if the value is RR\n    If IsRR = \"RR        \" Then\n        'If the value is RR, then get the NYSID\n        NYSID = Worksheets(\"Temp\").Cells(TempFirstRow, 4).Value\n\n        If Not IsError(Application.Match(NYSID, Worksheets(PreviousTabName).Range(PLookUpTabRange), 0)) Then\n\n        'NYSID is Found on Current Month Sheet, do Nothing\n\n        Else\n\n            DidTransfer = \"\"\n            Set thiscell = Sheets(PreviousTabName).Columns(\"D\").Find(What:=NYSID, LookIn:=xlValues, lookat:=xlWhole)\n\n                DidTransfer = Sheets(PreviousTabName).Range(\"B\" &amp; thiscell.Row).Value\n\n                    Select Case DidTransfer\n\n                        Case \"Transferred\"\n                            DidTransfer = \"Transferred\"\n                        Case Else\n                            DidTransfer = DidTransfer\n\n                    End Select\n\n            If IsError(Application.Match(NYSID, Worksheets(PreviousTabName).Range(PLookUpTabRange), 0)) Or _\n            (Not IsError(Application.Match(NYSID, Worksheets(PreviousTabName).Range(PLookUpTabRange), 0)) And _\n                 DidTransfer = \"Transferred\") Then\n\n                    'Worksheets(\"Temp\").Rows(TempFirstRow).Delete\n                    MsgBox \"Delete\"\n\n            End If\n\n        End If\n\n    End If\n\n\n\n'Go to the next row\nNext TempFirstRow\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1552427124, "post_id": 55130838, "comment_id": 97003800, "body": "The sender of an email message is a <i>property</i> of an Outlook <code>MailItem</code> object. Do you have a <code>MailItem</code> object?"}], "answers": [{"tags": [], "owner": {"reputation": 202, "user_id": 6631457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd506c3bb19b023957060bf6374322b?s=128&d=identicon&r=PG&f=1", "display_name": "J VBA", "link": "https://stackoverflow.com/users/6631457/j-vba"}, "is_accepted": false, "score": 1, "last_activity_date": 1552437772, "creation_date": 1552437772, "answer_id": 55132726, "question_id": 55130838, "link": "https://stackoverflow.com/questions/55130838/how-to-get-a-mail-sender-in-vba-outlook/55132726#55132726", "title": "how to get a mail sender in vba outlook", "body": "<p>I will keep an eye on this when you get some code here. But for now...</p>\n\n<pre><code>Sub GetSendor()\n\nDim oApp As New Outlook.Application\nDim oMail As Outlook.MailItem\nDim nm As Namespace\n\nSet nm = oApp.GetNamespace(\"MAPI\")\nSet oMail = nm.GetDefaultFolder(olFolderInbox).Folders.Item(1).Items.GetLast\n\noMail.SenderEmailAddress\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/BQaye.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BQaye.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 11064351, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yfmGrk9FjVY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNk7Ux2qOqIh2460dyhW1UwAnrLsw/mo/photo.jpg?sz=128", "display_name": "NewMe", "link": "https://stackoverflow.com/users/11064351/newme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1553071195, "answer_count": 1, "score": -2, "last_activity_date": 1594620596, "creation_date": 1552425757, "last_edit_date": 1594620596, "question_id": 55130838, "link": "https://stackoverflow.com/questions/55130838/how-to-get-a-mail-sender-in-vba-outlook", "closed_reason": "Needs details or clarity", "title": "how to get a mail sender in vba outlook", "body": "<p>Is there any function in vba that return the sender of email message?</p>\n"}, {"tags": ["excel", "vba", "filter", "advanced-filter"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7903146, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v_XnEAvcziY/AAAAAAAAAAI/AAAAAAAAAak/fxVznd_COIM/photo.jpg?sz=128", "display_name": "Brittany", "link": "https://stackoverflow.com/users/7903146/brittany"}, "edited": false, "score": 0, "creation_date": 1552425701, "post_id": 55130670, "comment_id": 97003226, "body": "In the criteria? If so that didn&#39;t work. The TRUE in column K is set to =A6=B6"}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 5, "user_id": 7903146, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v_XnEAvcziY/AAAAAAAAAAI/AAAAAAAAAak/fxVznd_COIM/photo.jpg?sz=128", "display_name": "Brittany", "link": "https://stackoverflow.com/users/7903146/brittany"}, "edited": false, "score": 0, "creation_date": 1552515157, "post_id": 55130670, "comment_id": 97044343, "body": "I am a bit confused as to what you are asking, in that case. From your title, it sounds like you want to filter out rows in which A does not equal B."}, {"owner": {"reputation": 5, "user_id": 7903146, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v_XnEAvcziY/AAAAAAAAAAI/AAAAAAAAAak/fxVznd_COIM/photo.jpg?sz=128", "display_name": "Brittany", "link": "https://stackoverflow.com/users/7903146/brittany"}, "edited": false, "score": 0, "creation_date": 1553227171, "post_id": 55130670, "comment_id": 97314035, "body": "Yes, I want to filter out rows in which A does not equal B, while still keeping any rows that have an Event_Name equal to First, Second or Final. I think I might have misunderstood what you were trying to suggest at first. I can add a column as you suggested, however I run into a problem when I try doing this with a macro. (I need to be able to do this for multiple data sets of varying length from hundreds to a couple thousand lines.)The column ends up adding extra rows to the end of my data with the value of TRUE. Thus giving me a ton of essentially &quot;blank&quot; rows when I filter for TRUE."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 5, "user_id": 7903146, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v_XnEAvcziY/AAAAAAAAAAI/AAAAAAAAAak/fxVznd_COIM/photo.jpg?sz=128", "display_name": "Brittany", "link": "https://stackoverflow.com/users/7903146/brittany"}, "edited": false, "score": 0, "creation_date": 1553276392, "post_id": 55130670, "comment_id": 97338631, "body": "Alright, thank you for the clarification! If you want help on a macro then you need to post what you have so far along with whatever errors you are encountering. Alternatively, a formula along the lines of <code>=IF(AND(A13=B13, A13&lt;&gt;&quot;&quot;), &quot;True&quot;, &quot;False&quot;)</code> will return &quot;True&quot; when the two cells are the same and the cells are not blank. Then you can just filter for &quot;True&quot;"}], "tags": [], "owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "is_accepted": false, "score": 0, "last_activity_date": 1552424867, "creation_date": 1552424867, "answer_id": 55130670, "question_id": 55130482, "link": "https://stackoverflow.com/questions/55130482/excel-advanced-filter-keep-rows-with-matching-column-a-and-column-b/55130670#55130670", "title": "excel advanced filter keep rows with matching column a and column b", "body": "<p>Can you add a column with <code>=A13=B13</code> which returns a Boolean and then filter for \"TRUE\"?</p>\n"}], "owner": {"reputation": 5, "user_id": 7903146, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v_XnEAvcziY/AAAAAAAAAAI/AAAAAAAAAak/fxVznd_COIM/photo.jpg?sz=128", "display_name": "Brittany", "link": "https://stackoverflow.com/users/7903146/brittany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552424867, "creation_date": 1552423975, "last_edit_date": 1552424788, "question_id": 55130482, "link": "https://stackoverflow.com/questions/55130482/excel-advanced-filter-keep-rows-with-matching-column-a-and-column-b", "title": "excel advanced filter keep rows with matching column a and column b", "body": "<p>Is there a way to easily use the advanced filter to keep rows with column A == column B?</p>\n\n<p><a href=\"https://i.stack.imgur.com/DCGJ9.png\" rel=\"nofollow noreferrer\">Example of what data and current filter looks like</a></p>\n\n<p>From that, I would expect to get rows with</p>\n\n<pre><code>Event_Name == (First, Second, Final) \n</code></pre>\n\n<p>and rows where</p>\n\n<pre><code>Time_A == Time_B.\n</code></pre>\n\n<p>However, I get this,</p>\n\n<p><a href=\"https://i.stack.imgur.com/qL3ZL.png\" rel=\"nofollow noreferrer\">The output from that data and filter</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1552424473, "post_id": 55130480, "comment_id": 97002721, "body": "Since you know the columns to be copied and their destination locations (the contiguous columns 1, 2, 3, 4, etc.), have you tried using columns(dest).value=columns(source).value for the applicable columns?"}, {"owner": {"reputation": 800, "user_id": 6310948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d0VKq.jpg?s=128&g=1", "display_name": "Erjon", "link": "https://stackoverflow.com/users/6310948/erjon"}, "edited": false, "score": 0, "creation_date": 1552425707, "post_id": 55130480, "comment_id": 97003227, "body": "in which column is set the name of the worksheet that you want to paste the data. How can i determine in which sheet will paste each data, looking at your code you are pasting data only in &quot;Entregas&quot; sheet"}, {"owner": {"reputation": 13, "user_id": 11193560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W911JeKzKcU/AAAAAAAAAAI/AAAAAAAABE4/TTB3CZtXpww/photo.jpg?sz=128", "display_name": "Victor Henrique", "link": "https://stackoverflow.com/users/11193560/victor-henrique"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1552487794, "post_id": 55130480, "comment_id": 97029421, "body": "@Cyril the collumns could be change in each row... i mentioned the collumns trying to be clear, but on that image, for example in row 2 i could or not have an data on collumn K... thats why i cant fix on the code what collumns to select and copy."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1552488497, "post_id": 55130480, "comment_id": 97029910, "body": "@VictorHenrique similar scenario, you could use .Find() for the appropriate named column and save the .column location as a variable for use."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11193560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W911JeKzKcU/AAAAAAAAAAI/AAAAAAAABE4/TTB3CZtXpww/photo.jpg?sz=128", "display_name": "Victor Henrique", "link": "https://stackoverflow.com/users/11193560/victor-henrique"}, "edited": false, "score": 0, "creation_date": 1552487358, "post_id": 55131102, "comment_id": 97029081, "body": "in column A i have the categories (Entregas, Projetos and Demandas), but for &quot;Demandas&quot; i have 4 subcategories (the four ones on the column B)...  So, what i have to do is, use the first collumn to chose the destination sheet, and if the first collumn is &quot;Demandas&quot;, the destination sheet are at collumn B.  After that, take the non-empty cells from that select row and paste on the sheet that was determined as i said."}], "tags": [], "owner": {"reputation": 800, "user_id": 6310948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d0VKq.jpg?s=128&g=1", "display_name": "Erjon", "link": "https://stackoverflow.com/users/6310948/erjon"}, "is_accepted": true, "score": 0, "last_activity_date": 1552427116, "creation_date": 1552427116, "answer_id": 55131102, "question_id": 55130480, "link": "https://stackoverflow.com/questions/55130480/copy-specific-cells-according-to-row-data-and-paste-on-specific-sheet/55131102#55131102", "title": "Copy specific cells according to row data and paste on specific sheet", "body": "<p>Since I'm not clear how will you determine which row belongs to each sheet I have for you this tested code, it works fine. You don't have to do all this copy and pastes, just learn more about loops, it's more simple. Anyway the code is:</p>\n\n<pre><code>Sub test()\n  Dim wb1 As Workbook\n  Dim wb2 As Workbook\n\n  Dim wsh1 As Worksheet\n  Dim wsh2 As Worksheet\n\n Dim lRow As Long\n\n Dim i As Long\n\n i = 1\n\n Set wb1 = ThisWorkbook\n Set wsh1 = wb1.Worksheets(\"Planilha1\")\n\n\n Set wb2 = Application.Workbooks.Open(\"\\\\BBAFSWCORP\\dpt\\DWS\\SPLC\\GerProc_Der_RF_RV\\Renda Fixa\\Equipe\\Metas\\Atividades_RF_2019.xlsm\")\n Set wsh2 = wb2.Worksheets(\"Entregas\")\n\n\n lRow = wsh2.Range(\"A\" &amp; wsh2.Rows.Count).End(xlUp).Row + 1\n\n Dim cell As Range\n\n For Each cell In wsh1.Range(\"A2:L2\").Cells\n\n    If Not cell.Value = \"\" Then\n\n    wsh2.Cells(lRow, i) = cell.Value\n\n    i = i + 1\n    End If\n Next cell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1552490936, "post_id": 55144990, "comment_id": 97031740, "body": "you could take the destination sheet name from cells(i,1) if you&#39;re going to loop from i = 2 to lastrow, then you would copy the values in specific cells to input to your new destination.  I would recommend a possibly simpler approach to sort your source data and copy VISIBLE columns, so you have chunks of data, rather than smaller sections; this would be more similar to my example."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1552494919, "last_edit_date": 1552494919, "creation_date": 1552489207, "answer_id": 55144990, "question_id": 55130480, "link": "https://stackoverflow.com/questions/55130480/copy-specific-cells-according-to-row-data-and-paste-on-specific-sheet/55144990#55144990", "title": "Copy specific cells according to row data and paste on specific sheet", "body": "<p>Example of my suggestion from comments:</p>\n\n<pre><code>dim f as range, c as long, i as long, arr as variant, swb as workbook, dwb as workbook\nset swb = ActiveWorkbook 'source workbook\nset dwb = Workbooks(\"Destination\") 'dest. workbook\narr = array(\"Terma\",\"Beneficio\") 'examples from your prefered column names\nfor i = lbound(arr) to ubound(arr) 'should start on 0\n    with swb.sheets(\"Entregas\")\n        set f = .Find(What:=arr(i), LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        c = f.column\n        dwb.sheets(\"DESTSheet\").Columns(i+1).value = .Columns(c)\n    end with\nnext i\n</code></pre>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>Will add in a way to help with the sorting to better utilize something similar to the above example (where you can sort for a key in column 1 to deal with chunks of data at a time):</p>\n\n<pre><code>dim clt as new collection, i as long, lr as long\nwith sheets(\"Entregas\")\n    lr = .cells(.rows.count,1).end(xlup).row\n    for i = 1 to lr\n        clt.add .cells(i,1).value, .cells(i,1).value 'collections capture UNIQUE values, so this should sort itself, unless you want to use an array of known sheets... either or\n    next i\n    for i = 1 to clt.count\n        'use the item OR key from clt as the sheet name\n        'dest.columns(i).value = source.columns(c).value, and match columns like the initial example\n    next i\nend with\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 11193560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W911JeKzKcU/AAAAAAAAAAI/AAAAAAAABE4/TTB3CZtXpww/photo.jpg?sz=128", "display_name": "Victor Henrique", "link": "https://stackoverflow.com/users/11193560/victor-henrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1552583376, "creation_date": 1552583376, "answer_id": 55168406, "question_id": 55130480, "link": "https://stackoverflow.com/questions/55130480/copy-specific-cells-according-to-row-data-and-paste-on-specific-sheet/55168406#55168406", "title": "Copy specific cells according to row data and paste on specific sheet", "body": "<p>I could solve the problem adapting @Erjons Sub</p>\n\n<p>Need to polish the code here and there, but this works fine.\nif someone's have any tips on how to improve it or if i put some redundant argument, please let me know... Always have one or two things that can improve, in my case, i have a lot to improve.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub Enviar_Dados()\n    Dim wb1 As Workbook\n    Dim wb2 As Workbook\n    Dim wsh1 As Worksheet\n    Dim wsh2 As Worksheet\n    Dim lRow As Long, lRow2 As Long\n    Dim i As Long\n    Dim r As Long\n    Dim rCell As Range\n    Dim rRng As Range\n    Dim a As Range, b As Range\n    Dim c As String\n\n    Set wb1 = ThisWorkbook\n    Set wsh1 = wb1.Worksheets(\"Planilha1\")\n    lRow2 = wsh1.Range(\"A\" &amp; wsh1.Rows.Count).End(xlUp).row\n    Set a = wsh1.Range(\"A2:A\" &amp; lRow2)\n    Set wb2 = Application.Workbooks.Open(\"\\\\BBAFSWCORP\\dpt\\DWS\\SPLC\\GerProc_Der_RF_RV\\Renda Fixa\\Equipe\\Metas\\Atividades_RF_2019.xlsm\")\n    r = 2\n\n    For Each b In a.Rows\n        If b &lt;&gt; \"Demandas\" Then\n            c = b.Value\n            i = 1\n            Set wsh2 = wb2.Worksheets(c)\n            lRow = wsh2.Range(\"A\" &amp; wsh2.Rows.Count).End(xlUp).row + 1\n            Dim cell As Range\n                For Each cell In wsh1.Range(\"B\" &amp; r &amp; \":L\" &amp; r).Cells\n                    If Not cell.Value = \"\" Then\n                        wsh2.Cells(lRow, i) = cell.Value\n                        i = i + 1\n                    End If\n                Next cell\n        ElseIf b = \"Demandas\" Then\n            c = wsh1.Range(\"B\" &amp; r)\n            i = 1\n            Set wsh2 = wb2.Worksheets(c)\n            lRow = wsh2.Range(\"A\" &amp; wsh2.Rows.Count).End(xlUp).row + 1\n                For Each cell In wsh1.Range(\"C\" &amp; r &amp; \":L\" &amp; r).Cells\n                    If Not cell.Value = \"\" Then\n                        wsh2.Cells(lRow, i) = cell.Value\n                        i = i + 1\n                    End If\n                Next cell\n        End If\n\n    r = r + 1\n\n    Next b\n\n    wb2.Save\n    wb2.Close\n    wsh1.Range(\"A2:L\" &amp; lRow2).ClearContents\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11193560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W911JeKzKcU/AAAAAAAAAAI/AAAAAAAABE4/TTB3CZtXpww/photo.jpg?sz=128", "display_name": "Victor Henrique", "link": "https://stackoverflow.com/users/11193560/victor-henrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 55131102, "answer_count": 3, "score": 1, "last_activity_date": 1552820583, "creation_date": 1552423958, "last_edit_date": 1552820583, "question_id": 55130480, "link": "https://stackoverflow.com/questions/55130480/copy-specific-cells-according-to-row-data-and-paste-on-specific-sheet", "title": "Copy specific cells according to row data and paste on specific sheet", "body": "<p>I am new to VBA and I am having trouble with copying a specific row according to its first cell value, and paste it in another workbook into a sheet named as the same of this row.</p>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/l3RUk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l3RUk.png\" alt=\"enter image description here\"></a></p>\n\n<p>The sheets on the another workbook are: </p>\n\n<pre><code>Entregas, Demandas, Cliente, Regulat\u00f3rio, Auditoria/Controle Interno, COP\n</code></pre>\n\n<p>I need to copy row 2 and paste non-empty columns (C, D, E, F, I, J, K and L) on the \"Entregas\" sheet in another workbook on the first empty row.</p>\n\n<p>Do the same with row 3 with the columns C, D, E, F, I, J and K on the \"Auditoria/Controle Interno\" sheet on the first empty row, and so on...</p>\n\n<p>The code i have is this, but it copies and pastes the entire row while I need it to paste just the non-empty cells.</p>\n\n<pre><code>Sub Bot\u00e3o2_Clique()\n    Dim wb1 As Workbook, wb2 As Workbook\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim copyFrom As Range\n    Dim lRow As Long '&lt;~~ Not Integer. Might give you error in higher versions of excel\n    Dim strSearch As String\n\n    Set wb1 = ThisWorkbook\n    Set ws1 = wb1.Worksheets(\"Planilha1\")\n\n    strSearch = \"Entregas\"\n\n    With ws1\n\n        '~~&gt; Remove any filters\n        .AutoFilterMode = False\n\n        '~~&gt; I am assuming that the names are in Col A\n        '~~&gt; if not then change A below to whatever column letter\n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        With .Range(\"A1:A\" &amp; lRow)\n            .AutoFilter Field:=1, Criteria1:=\"=*\" &amp; strSearch &amp; \"*\"\n            Set copyFrom = .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow\n        End With\n\n        '~~&gt; Remove any filters\n        .AutoFilterMode = False\n    End With\n\n    '~~&gt; Destination File\n    Set wb2 = Application.Workbooks.Open(\"\\\\BBAFSWCORP\\dpt\\DWS\\SPLC\\GerProc_Der_RF_RV\\Renda Fixa\\Equipe\\Metas\\Atividades_RF_2019.xlsm\")\n    Set ws2 = wb2.Worksheets(strSearch)\n\n    With ws2\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            lRow = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            lRow = 1\n        End If\n\n        copyFrom.Copy .Rows(lRow)\n    End With\n\n    wb2.Save\n    wb2.Close\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1552423303, "creation_date": 1552423303, "answer_id": 55130328, "question_id": 55130279, "link": "https://stackoverflow.com/questions/55130279/excel-dynamic-list-of-numbers-based-on-input/55130328#55130328", "title": "Excel: Dynamic list of numbers based on input", "body": "<p>You'll need a <code>Worksheet_Change()</code> event:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = \"$A$1\" Then\n\n        Range(\"A2:A1048576\").ClearContents\n\n        For i = 1 To Target.Value\n            Cells(i + 1, 1).Value = i\n        Next i\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 2, "last_activity_date": 1552423508, "creation_date": 1552423508, "answer_id": 55130362, "question_id": 55130279, "link": "https://stackoverflow.com/questions/55130279/excel-dynamic-list-of-numbers-based-on-input/55130362#55130362", "title": "Excel: Dynamic list of numbers based on input", "body": "<p>Using formulas:</p>\n\n<p>in <code>A2</code> use the following formula:</p>\n\n<pre><code>=IFERROR(IF(A1=\"\",\"\",1),\"\")\n</code></pre>\n\n<p>In <code>A3</code> use:</p>\n\n<pre><code>=IFERROR(IF(A2+1&gt;A$1,\"\",A2+1),\"\")\n</code></pre>\n\n<p>And populate down</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 11064199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pilW33bdTQ0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNQsB5rEB77V_E15kXOazbpYCxNiA/mo/photo.jpg?sz=128", "display_name": "Hjalti Sigtryggsson", "link": "https://stackoverflow.com/users/11064199/hjalti-sigtryggsson"}, "edited": false, "score": 0, "creation_date": 1557668318, "post_id": 55132496, "comment_id": 98834406, "body": "Absolute legend! appreciate all the help!"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1552435829, "creation_date": 1552435829, "answer_id": 55132496, "question_id": 55130279, "link": "https://stackoverflow.com/questions/55130279/excel-dynamic-list-of-numbers-based-on-input/55132496#55132496", "title": "Excel: Dynamic list of numbers based on input", "body": "<h1>Numbered</h1>\n\n<h2>Features</h2>\n\n<ul>\n<li>When the value in <code>Source Cell Range</code> is changed by user input or via VBA, the\nprogram is triggered. It will not run if <code>Source Cell Range</code> contains a formula and the value has changed due to another cell changing. For that functionality you have to use the <code>Worksheet Calculate</code> event.</li>\n<li>If the value is not a number, nothing will happen.</li>\n<li>If the value is a decimal number (<code>1.5</code>) it will be rounded to the nearest\ninteger (<code>2</code>).</li>\n<li>If the value exceeds the number of rows in the worksheet, the\nworksheet will be filled to the bottom cell. The rest of the values\nwill be ignored.</li>\n<li>Change the <code>Source Cell Range Address</code> in <code>Worksheet_Change</code> (set to <code>A1</code>) to fit your needs e.g. <code>C17</code>.\n<strong>Only the cells below will be affected.</strong></li>\n</ul>\n\n<h2>The Code</h2>\n\n<p>Copy the following code to a <strong>standard module</strong> (<code>VBE &gt;&gt; Insert &gt;&gt; Module</code>) e.g.</p>\n\n<p><strong>Module1</strong> </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Numbered(CellRange As Range)\n\n    Dim vntT As Variant          ' Target Array/Value\n    Dim srcVal As Variant        ' Value\n    Dim srcMax As Long           ' Maximum Value\n    Dim srcSgn As Long           ' Sign (+-)\n    Dim srcAbs As Long           ' Absolute Value\n    Dim i As Long                ' Target Array Row Counter\n\n    ' In Cell Range\n    With CellRange\n        ' Write value of CellRange to Value.\n        srcVal = .Value\n        ' Calculate Maximum Value.\n        srcMax = .Worksheet.Rows.Count - .Offset(1).Row + 1\n    End With\n\n    ' Check if Value is a number.\n    If IsNumeric(srcVal) Then\n        ' Convert Value to whole number.\n        srcVal = CLng(srcVal)\n        ' Write the sign of Value to Sign.\n        srcSgn = Sgn(srcVal)\n        ' Check if the absolute value of Value is greater than Maximum Value.\n        If Abs(srcVal) &gt; srcMax Then\n            ' Write Maximum Value with (correct) Sign to Value.\n            srcVal = srcSgn * srcMax\n        End If\n        ' Write the absolute value of Value to Absolute Value.\n        srcAbs = Abs(srcVal)\n        ' Check Absolute Value\n        Select Case srcAbs\n            Case Is &gt; 1\n                ' Resize Target Array to Absolute Value rows and one column.\n                ReDim vntT(1 To srcAbs, 1 To 1)\n                ' Loop through rows of Target Array.\n                For i = 1 To srcAbs\n                    ' Write to element at i-th row and 1st column\n                    ' of Target Array.\n                    vntT(i, 1) = srcSgn * i\n                Next\n            Case 1\n                ' If Absolute Value is 1, vntT will not be an array, but a\n                ' variant containing one value.\n                vntT = srcSgn * 1\n            Case 0\n                ' If Absolute Value is 0, vntT will not be an array, but a\n                ' variant containing one value.\n                vntT = 0 ' or \"\"\n        End Select\n    End If\n\n    ' In First Cell of Target Range (Cell Below Cell Range)\n    With CellRange.Offset(1)\n        ' Resize to bottom cell and clear contents.\n        .Resize(srcMax).ClearContents\n        ' Check if vntT is an array.\n        If IsArray(vntT) Then   ' Multiple values\n            ' Calculate Target Range: Resize First Cell of Target Range by\n            ' Absolute Value.\n            ' Copy Target Array to Target Range.\n            .Resize(srcAbs) = vntT\n          Else                  ' One value\n            ' Write Target Value to First Cell of Target Range.\n            .Value = vntT\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Copy the following code into any <strong>sheet module</strong> where you want to run the program e.g.</p>\n\n<p><strong>Sheet1</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Const cSrc As String = \"A1\"  ' Source Cell Range Address\n\n    If Target.Address = Range(cSrc).Address Then\n        Numbered Target\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11064199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pilW33bdTQ0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNQsB5rEB77V_E15kXOazbpYCxNiA/mo/photo.jpg?sz=128", "display_name": "Hjalti Sigtryggsson", "link": "https://stackoverflow.com/users/11064199/hjalti-sigtryggsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "accepted_answer_id": 55132496, "answer_count": 3, "score": 1, "last_activity_date": 1552435829, "creation_date": 1552423083, "question_id": 55130279, "link": "https://stackoverflow.com/questions/55130279/excel-dynamic-list-of-numbers-based-on-input", "title": "Excel: Dynamic list of numbers based on input", "body": "<p>I'm trying to make a list of numbers based on a hard coded input.</p>\n\n<p>let say if I write \"5\" in A1, then I want a  list of numbers 1,2,3,4,5 in a column below. If the input is 25 the list would increase to 1-25 and so on....</p>\n\n<p>Can anyone help me with this ?</p>\n\n<p>Best regards</p>\n"}]