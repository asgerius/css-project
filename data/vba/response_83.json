[{"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1470876787, "post_id": 38885268, "comment_id": 65131986, "body": "What are the Criteria?  Can you post some sample data?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470877665, "post_id": 38885268, "comment_id": 65132132, "body": "Please post an example of your data, and your desired output."}], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1470929137, "post_id": 38885836, "comment_id": 65159790, "body": "Yeah, I noticed the slowness immediately.  I just need ROWS 1:16100, so I&#39;m using just that range.  I decided to use the solution Alexis posted since it&#39;s so much faster.  One final question.  How can I modify this to say, show me everything that matches one criteria, doesn&#39;t match five criteria, and counts the unique.  So, match crit1, don&#39;t match crit2 to crit6, and show uniques in ColumnF?  Maybe it&#39;s just a count of all uniques, by crit1, and subtract out crit2 to crit6.  That would do it!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1470878081, "creation_date": 1470878081, "answer_id": 38885836, "question_id": 38885268, "link": "https://stackoverflow.com/questions/38885268/count-unique-text-based-on-2-criteria/38885836#38885836", "title": "Count Unique Text Based on 2 Criteria", "body": "<p>You can use a <a href=\"http://answers.microsoft.com/en-us/office/wiki/office_2003-excel/count-unique-with-sumproduct-breakdown/1bc18979-4172-4537-993e-3897f74d6a5b\" rel=\"nofollow noreferrer\">standard SUMPRODUCT-based pseudo-COUNTUNIQUE</a> but you need to modify it by adding the criteria in the numerator and also the inverse criteria in the demononator; the latter to avoid <code>#DIV/0!</code> errors. This will generate a pseudo-COUNTIFSUNIQUE.</p>\n\n<pre><code>=SUMPRODUCT(SIGN((B2:B20=\"bee\")*(W2:W20=\"double-you\"))/\n           (COUNTIFS(B2:B20, \"bee\", W2:W20, \"double-you\", F2:F20, F2:F20)+(B2:B20&lt;&gt;\"bee\")+(W2:W20&lt;&gt;\"double-you\")))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/47tC6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/47tC6.png\" alt=\"countifsunique\"></a></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1470888833, "post_id": 38886355, "comment_id": 65134836, "body": "Seems to work well but those full column references slow it down substantially. A warning note recommending cutting the full column references down to the worksheet&#39;s <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840732.aspx\" rel=\"nofollow noreferrer\">.UsedRange</a> might be appropriate."}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1470889418, "post_id": 38886355, "comment_id": 65134997, "body": "Very true. They definitely should be cut down to an appropriate range. I posted them that way for readability and since I don&#39;t know the particular rows OP is using."}], "tags": [], "owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "is_accepted": false, "score": 1, "last_activity_date": 1470882414, "creation_date": 1470882414, "answer_id": 38886355, "question_id": 38885268, "link": "https://stackoverflow.com/questions/38885268/count-unique-text-based-on-2-criteria/38886355#38886355", "title": "Count Unique Text Based on 2 Criteria", "body": "<p>Another solution is to adapt the formula from here: <a href=\"https://exceljet.net/formula/count-unique-text-values-in-a-range\" rel=\"nofollow\">Count Unique Text Values in a Range</a>.</p>\n\n<p>Instead of using <code>F:F</code>, you modify it to match <code>F:F</code> if both <code>Crit1</code> and <code>Crit2</code> hold and <code>\"No Match\"</code> otherwise. That is,</p>\n\n<pre><code>IF((B:B=\"Crit1\")*(W:W=\"Crit2\"),F:F,\"No Match\")\n</code></pre>\n\n<p>Then you do a unique count on that array.</p>\n\n<pre><code>=SUMPRODUCT(--(FREQUENCY(MATCH(IF((B:B=\"Crit1\")*(W:W=\"Crit2\"),F:F,\"No Match\"),\n                               IF((B:B=\"Crit1\")*(W:W=\"Crit2\"),F:F,\"No Match\"),0),\n                         ROW(F:F)-ROW($F$1)+1)&gt;0))\n -NOT(PRODUCT((B:B=\"Crit1\")*(W:W=\"Crit2\")))\n</code></pre>\n\n<p>The <code>-NOT(PRODUCT(...))</code> at the end is to subtract the unique count for the <code>\"No Match\"</code> entry if it exists (this can be replaced by just <code>-1</code> if you know there will always be things that don't match both criteria).</p>\n\n<p>Note that this is an array formula and must be entered using <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>.</p>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1470882414, "creation_date": 1470872951, "question_id": 38885268, "link": "https://stackoverflow.com/questions/38885268/count-unique-text-based-on-2-criteria", "title": "Count Unique Text Based on 2 Criteria", "body": "<p>I was playing around with a couple ideas to count unique text based on two criteria. I was thinking Sumproduct would do it for me, but it doesn't seem to work. I may need some kind of VBA script.  Basically, I want to do the following.</p>\n\n<p>1)  Look at everything in ColumnB and if that matches a criteria</p>\n\n<p>2)  Look at everything in ColumnW and if that matches a criteria</p>\n\n<p>3)  Count unique text in ColumnF.</p>\n\n<p>It's almost like this:</p>\n\n<p>=COUNTIFS(W:W,A1,B:B,B1)</p>\n\n<p>THEN, based on the result of that, count uniques in ColumnF</p>\n\n<p>I was thinking this should be pretty easy, but it's turning out to be really hard!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470873373, "post_id": 38885126, "comment_id": 65131224, "body": "If by &quot;equally divide&quot; you mean that you want the same number of records (of varying types) in each group, could you sort your data by Duration within Sales/NonSales within Crift, and then select every nth record (assuming you have n groups)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1470874352, "post_id": 38885126, "comment_id": 65131478, "body": "Can you provide a sample output?"}, {"owner": {"reputation": 1, "user_id": 6673579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xQIfPPNfwm4/AAAAAAAAAAI/AAAAAAAAAE8/tbHJ_dCiNes/photo.jpg?sz=128", "display_name": "jerandio", "link": "https://stackoverflow.com/users/6673579/jerandio"}, "edited": false, "score": 0, "creation_date": 1470876543, "post_id": 38885126, "comment_id": 65131935, "body": "As much as possible equally divided to each group, although it is possible 1 or 2 groups are different..groupings will depend on the number of Evaluators, but for now lets have n evaluator...Actually on the last part of it, I need to randomly select sample from each group given the duration, sales/NonSales/Crift/Repeats"}, {"owner": {"reputation": 1, "user_id": 6673579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xQIfPPNfwm4/AAAAAAAAAAI/AAAAAAAAAE8/tbHJ_dCiNes/photo.jpg?sz=128", "display_name": "jerandio", "link": "https://stackoverflow.com/users/6673579/jerandio"}, "edited": false, "score": 0, "creation_date": 1470878029, "post_id": 38885126, "comment_id": 65132222, "body": "Example Output: Entries must be unique\t\t\t\t\t \t\t\t\t\t                                         Group n\t\t\t\t\t                    Sales|s\t\t\t                            NonSales\t\t Short\t    Medium\tLong\t    Short\t      Medium\t Long Agent ID&#39;s    Agent ID&#39;s\tAgent ID&#39;s   Agent ID&#39;s   Agent ID&#39;s  Agent ID&#39;s \t\t\t\t\t Total\u2026..\t\t\t\t\t Sample Size\u2026..\t\t\t\t\t \t\t\t\t\t Note: \tFor every columns, Agent ID&#39;s (in cell) maybe in color coded according to its Crift and Repeats (maybe a combination of 6 colors, like red for Promoter-Yes, Blue for Promoted-No, etc.)"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1470885352, "post_id": 38885126, "comment_id": 65133830, "body": "Even though you are a beginner, could you show us what code you have tried so far. You&#39;ve probably already read that this site isn&#39;t a code-writing service, but we&#39;d happily assist you with anything you&#39;ve written already."}, {"owner": {"reputation": 1, "user_id": 6673579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xQIfPPNfwm4/AAAAAAAAAAI/AAAAAAAAAE8/tbHJ_dCiNes/photo.jpg?sz=128", "display_name": "jerandio", "link": "https://stackoverflow.com/users/6673579/jerandio"}, "edited": false, "score": 0, "creation_date": 1470887607, "post_id": 38885126, "comment_id": 65134444, "body": "Here are my initial codes"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6673579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xQIfPPNfwm4/AAAAAAAAAAI/AAAAAAAAAE8/tbHJ_dCiNes/photo.jpg?sz=128", "display_name": "jerandio", "link": "https://stackoverflow.com/users/6673579/jerandio"}, "is_accepted": false, "score": 0, "last_activity_date": 1470887578, "creation_date": 1470887578, "answer_id": 38886988, "question_id": 38885126, "link": "https://stackoverflow.com/questions/38885126/how-to-cluster-equally-several-rows-in-excel-with-5-columns/38886988#38886988", "title": "How to cluster equally several rows in excel with 5 columns", "body": "<pre><code>Private Type Records\nDimension() As Double\nDistance() As Double\nCluster As Integer\n\nEnd Type\n\nDim Table As Range\nDim Record() As Records\nDim Centroid() As Records\n\nSub Run()\n\nIf Not Grouping Then\n    Call MsgBox(\"Error: \" &amp; Err.Description, vbExclamation, \"Clustering Error\")\n End If\n\nEnd Sub\n\nFunction Grouping() As Boolean\nDim Site As String\n\nSite = Application.InputBox(\"VXI Site\")\nWorksheets(\"Data Base\").Activate\nRange(\"B1\").Select\nActiveCell.Offset(2, 0).Value = Site\nCells(2, 1).Font.Bold = True\nCells(2, 2).HorizontalAlignment = xlCenter\n\nDim numClusters As Integer\nnumClusters = Application.InputBox(\"Specify Number of QA Evaluator\", \"Grouping\", Type:=1)\nActiveCell.Offset(3, 0).Value = numClusters\nCells(4, 2).Font.Bold = True\nCells(4, 2).HorizontalAlignment = xlCenter\n\nIf Not numClusters &gt; 0 Or numClusters = False Then\n    Exit Function        'Cancelled\nEnd If\n\nMsgBox Site &amp; \" was an identified site\" &amp; \" with \" &amp; numClusters &amp; \" QA Evaluators.\"\n\nDim dataSheet, groupSheet As Worksheet\nSet groupSheet = Worksheets(\"Grouping\")\nSet dataSheet = Worksheets(\"Data Base\")\n\n\n'dataSheet.Range(\"A7:A100000\").Copy Destination:=dataSheet.Range(\"g:g\")\n\nDim numAgent As Integer\nnumAgent = dataSheet.Range(\"A7:A100000\").End(xlDown).Row\n\nDim startRow As Integer\nstartRow = 2\nDim startCol As Integer\nstartCol = 1\nDim agentNumber As Integer\n\n\nFor i = 1 To numClusters\nFor j = 1 To Round(numAgent / numClusters, 0)\n    agentNumber = Int((numAgent - 1 + 1) * Rnd() + 1)\n    groupSheet.Cells(startRow, startCol).Value = dataSheet.Cells(agentNumber, 7).Value\n    dataSheet.Cells(agentNumber, 7).Delete Shift:=xlUp\n    numAgent = numAgent - 1\n    startRow = startRow + 1\nNext j\n\nIf i &lt; 7 Then\n    startRow = 2\n    startCol = startCol + 1\nElseIf i = 7 Then\n    startRow = 14\n    startCol = 1\nElse\n    startRow = 14\n    startCol = startCol + 1\nEnd If\nNext i\n\n\nGrouping_Error:\nGrouping = (Err.Number = 0)\n\nEnd Function\n\nSub SearchForString()\n\nDim LSearchRow As Integer\nDim LCopyToRow As Integer\n\nOn Error GoTo Err_Execute\n\n'Start search in row 7\n LSearchRow = 7\n\n'Start copying data to row 4 in Grouping (row counter variable)\n LCopyToRow = 4\n\n While Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &lt; 10\n\n  'If value in column E = \"Mail Box\", copy entire row to Sheet2\n  If Range(\"E\" &amp; CStr(LSearchRow)).Value = \"Y\" And \"N\" Then\n\n     'Select row in Sheet1 to copy\n     Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n     Selection.Copy\n\n     'Paste row into Sheet2 in next row\n     Sheets(\"Grouping\").Select\n     Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n     ActiveSheet.Paste\n\n     'Move counter to next row\n     LCopyToRow = LCopyToRow + 1\n\n     'Go back to Sheet1 to continue searching\n     Sheets(\"Data Base\").Select\n\n  End If\n\n  LSearchRow = LSearchRow + 1\n\nWend\n\n'Position on cell A3\n Application.CutCopyMode = False\n Range(\"A\").Select\n\n MsgBox \"All matching data has been copied.\"\n\n Exit Sub\n\n Err_Execute:\n MsgBox \"An error occurred.\"\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6673579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xQIfPPNfwm4/AAAAAAAAAAI/AAAAAAAAAE8/tbHJ_dCiNes/photo.jpg?sz=128", "display_name": "jerandio", "link": "https://stackoverflow.com/users/6673579/jerandio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470887578, "creation_date": 1470871838, "last_edit_date": 1531164843, "question_id": 38885126, "link": "https://stackoverflow.com/questions/38885126/how-to-cluster-equally-several-rows-in-excel-with-5-columns", "title": "How to cluster equally several rows in excel with 5 columns", "body": "<p>I'm a beginner in Excel VBA and I am trying to equally divide the Agent Name/ID into groups where each member are categorized according to its Crift data whether the agent is a Promoter, Neutral or Detractor. Aside from this, those agent with Crift categorization can be identified whether they have sales or no sales...and last thing, the duration of calls (i.e. Short(less than 10 min), Medium(10-20min) and Long(Above 20min)) that was committed by the agent, is equally divide to each group so that in one group there are short, medium and long calls to be evaluate.</p>\n\n<pre><code>Agent Name/ID   Sales/NonSales  Crift (P-N-D)   Call Duration (in min)  Repeats\n152325            N                 N           8.00                     Y\n152336            Y                 N           12.00                    Y\n152040            Y                 P           10.00                    Y\n152041            Y                 P           13.00                    Y\n152046            N                 D           10.00                    N\n152189            N                 N           15.00                    Y\n151794            Y                 P           24.00                    N\n152052            Y                 P           20.00                    Y\n151906            Y                 P           23.50                    N\n151909            N                 D           15.67                    Y\n151893            N                 N           20.36                    N\n152048            Y                 D           21.00                    N\n151903            Y                 N           19.00                    N\n152044            Y                 P           18.25                    N\n152032            N                 P           29.15                    Y\n152290            Y                 N           26.00                    N\n151740            N                 D           10.00                    Y\n168334            N                 D           6.00                     N\n200679            Y                 N           8.00                     Y\n152037            N                 D           7.56                     Y\n152026            Y                 D           8.16                     Y\n152055            Y                 P           9.28                     Y\n152307            N                 P           4.26                     N\n152132            Y                 P           16.64                    N\n152004            N                 D           16.16                    Y\n152017            Y                 P           25.00                    Y\n152021            N                 D           26.00                    Y\n151914            N                 P           29.16                    Y\n151922            N                 N           24.98                    Y\n</code></pre>\n\n<p>I really appreciate your help.</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1470871365, "post_id": 38885012, "comment_id": 65130733, "body": "Try <code>&quot;&#39;Pivot Table&#39;!R3C1&quot;</code> instead of <code>&quot;Pivot Table!R3C1&quot;</code>.  It probably doesn&#39;t like the space in the sheet name."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470932256, "post_id": 38885012, "comment_id": 65161721, "body": "Actually, the missing apostrophes cause a <code>Runtime error &#39;5&#39;: IInvalid procedure call or argument</code>.  I&#39;m not sure now what&#39;s causing the type mismatch.  All I can think of is that it must be something to do with your UsedRange."}, {"owner": {"reputation": 3, "user_id": 6702523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee2c92e71874cf874f7ea79d0fb0e40?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/6702523/steven"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470932682, "post_id": 38885012, "comment_id": 65161973, "body": "Thank you for the response but it is still giving me the error. Is there another solution I may be missing?"}], "owner": {"reputation": 3, "user_id": 6702523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee2c92e71874cf874f7ea79d0fb0e40?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/6702523/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470871627, "creation_date": 1470870972, "last_edit_date": 1531164843, "question_id": 38885012, "link": "https://stackoverflow.com/questions/38885012/vba-pivot-table-error", "title": "VBA Pivot Table Error", "body": "<p>I am trying to create a pivot table with VBA but am getting Runtime Error '13' Type mismatch</p>\n\n<p>I have tried several different solutions to this issue, but nothing seems to work. </p>\n\n<p>My data is a roster with over 80,000 rows. I want to be able to apply the VBA code to different rosters that will have different row counts. There may already be a pivot table in the workbook, so I want to create a new pivot cache to make sure that it does not interfere with the other pivot table if one exists or that it won't pull from a cache that does not exist. </p>\n\n<p>After I open my workbook, my code is as follows: </p>\n\n<pre><code> Sheets.Add\n        ActiveSheet.Name = \"Pivot Table\"\n        Sheets(\"Roster\").Activate\n\n    ActiveWorkbook.PivotCaches.Create _\n    (SourceType:=xlDatabase, SourceData:=ActiveSheet.UsedRange,Version:=xlPivotTableVersion14) _\n    .CreatePivotTable TableDestination:=\"Pivot Table!R3C1\", DefaultVersion:= _\n    xlPivotTableVersion14\n</code></pre>\n\n<p>Thanks for the help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6312138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32332bb278cffafb91c2bff26ce7809c?s=128&d=identicon&r=PG&f=1", "display_name": "spyder3909", "link": "https://stackoverflow.com/users/6312138/spyder3909"}, "edited": false, "score": 0, "creation_date": 1470927296, "post_id": 38884897, "comment_id": 65158381, "body": "Thanks, Slai -- that did work.  The only thing I noticed is that the slicer connected to that pivottable and field does not reflect the filter, but the pivottable itself looks good."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 31, "user_id": 6312138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32332bb278cffafb91c2bff26ce7809c?s=128&d=identicon&r=PG&f=1", "display_name": "spyder3909", "link": "https://stackoverflow.com/users/6312138/spyder3909"}, "edited": false, "score": 0, "creation_date": 1470927750, "post_id": 38884897, "comment_id": 65158770, "body": "I tried it on Excel 2007, so you can try recording the macro on your version to see if the generated code is different."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1470870101, "creation_date": 1470870101, "answer_id": 38884897, "question_id": 38884572, "link": "https://stackoverflow.com/questions/38884572/most-efficient-way-to-filter-a-pivottables-row-field-for-blank-entries/38884897#38884897", "title": "Most efficient way to filter a pivottable&#39;s row field for &quot;(blank)&quot; entries", "body": "<p>If you record a macro of filtering a Row Label with Label Filters > Equals... you get something like </p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Some Field\") _\n    .PivotFilters.Add Type:=xlCaptionEquals, Value1:=\"(blank)\" ' or maybe Value1:=\"\" ?\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6312138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32332bb278cffafb91c2bff26ce7809c?s=128&d=identicon&r=PG&f=1", "display_name": "spyder3909", "link": "https://stackoverflow.com/users/6312138/spyder3909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 709, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470870101, "creation_date": 1470868202, "last_edit_date": 1531161705, "question_id": 38884572, "link": "https://stackoverflow.com/questions/38884572/most-efficient-way-to-filter-a-pivottables-row-field-for-blank-entries", "title": "Most efficient way to filter a pivottable&#39;s row field for &quot;(blank)&quot; entries", "body": "<p>I am looking for the most efficient way (least code) to filter a row field of a pivottable for \"(blank)\" entries.  I know how to set a PageField / Report Filter (hopefully I am speaking correctly here) using the .CurrentPage method:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Some Field\").CurrentPage = \"Something\"\n</code></pre>\n\n<p>To me, this is efficient, but this only works for PageFields not RowFields.  I am also aware of the loop option to set PivotItems.Visible properties as 'True' or 'False':</p>\n\n<pre><code>With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Some Field\")\n    For each PvtItm in .PivotItems\n        If pvtItm.Value = \"(blank)\" Then\n            PvtItm.Visible = True\n        Else\n            PvtItm.Visible = False\n        End If\nEnd With\n</code></pre>\n\n<p>This works for RowFields but is a few extra lines.  I can use this but I was just curious if there was shorter method.  Also, I only want to see \"(blank)\" entries so if I need to set it a different way then using = \"(blank)\" I would be interested to know what to use.  Any suggestions would be appreciated!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "is_accepted": false, "score": 1, "last_activity_date": 1470866292, "creation_date": 1470866292, "answer_id": 38884248, "question_id": 38883898, "link": "https://stackoverflow.com/questions/38883898/executing-a-macro-over-another-excel-file/38884248#38884248", "title": "Executing a macro over another excel file", "body": "<ol>\n<li>Get the path of the workbook you like to perform the macro from FileDialog. You can use </li>\n</ol>\n\n<blockquote>\n  <p><code>Application.FileDialog</code></p>\n</blockquote>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff836226.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff836226.aspx</a></p>\n\n<ol start=\"2\">\n<li>Open the workbook and set a reference for it.</li>\n</ol>\n\n<blockquote>\n  <p>set wb  =Application.Workbooks.Open(filepath)</p>\n</blockquote>\n\n<ol start=\"3\">\n<li>On your current sub <strong>RenameTabs</strong>, replace <strong>Application.ActiveWorkbook</strong>, <strong>ThisWorkBook</strong> with wb. Also, you need to properly reference the Sheets, Worksheets, ... to wb. Alternatively, you should make it sure that wb is the ActiveWorkbook <code>(wb.Activate)</code> (you can break the code if you switch to another excel file when it is still processing)</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 6702110, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153864368365835/picture?type=large", "display_name": "Tony Romero", "link": "https://stackoverflow.com/users/6702110/tony-romero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470866292, "creation_date": 1470864661, "question_id": 38883898, "link": "https://stackoverflow.com/questions/38883898/executing-a-macro-over-another-excel-file", "title": "Executing a macro over another excel file", "body": "<p>I have the following macro\n(Macro than rename the sheet with the value of cell B4 and then create one workbook for each sheet.)</p>\n\n<pre><code>Sub RenameTabs()\n'UpdatebyTony\nFor x = 1 To Sheets.Count\nIf Worksheets(x).Range(\"B4\").Value &lt;&gt; \"\" Then\nSheets(x).Name = Worksheets(x).Range(\"B4\").Value\nEnd If\nNext\nDim xPath As String\nxPath = Application.ActiveWorkbook.Path\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nFor Each xWs In ThisWorkbook.Sheets\n    xWs.Copy\n    Application.ActiveWorkbook.SaveAs Filename:=xPath &amp; \"\\\" &amp; xWs.Name &amp; \".xls\"\n    Application.ActiveWorkbook.Close False\nNext\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>But this means I have to go and copy the macro in each excel file and run it.</p>\n\n<p>I would like to be able to run de macro and it open a dialog where it ask me to choose the excel file that I want to rename the sheets and separate? Is that possible?</p>\n\n<p>I know very little about VBA</p>\n"}, {"tags": ["c++", "excel", "vba", "dll", "com"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470862323, "post_id": 38883236, "comment_id": 65127562, "body": "did you develop that dll yourself? is it in C#, (wishful guess, I can see C++ tag). Anyways, one suggestion, add the COM tag and remove macros. you will get more response, hopefully."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1470867070, "post_id": 38883236, "comment_id": 65129547, "body": "try with Microsoft ActiveX Data Objects 2.8 Library checked in tools&gt;references that is"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1470868616, "post_id": 38883236, "comment_id": 65130004, "body": "Have you tried one of the free code cleaners online?  They&#39;ll export everything into text files and then rebuild the workbook for you. <a href=\"http://www.appspro.com/Utilities/CodeCleaner.htm\" rel=\"nofollow noreferrer\">Excel VBA Code Cleaner</a>"}, {"owner": {"reputation": 41, "user_id": 4200522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7321b51e006006d20bc50f89dfd370bf?s=128&d=identicon&r=PG&f=1", "display_name": "Ronnie", "link": "https://stackoverflow.com/users/4200522/ronnie"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1470921581, "post_id": 38883236, "comment_id": 65153965, "body": "@tom I tried doing that but it did not help. I think this is an issue with the dll file i am trying to add to the references. The 64-bit dll gets named as ScriptHost instead of its actual name. Does anyone know which part is responsible for the naming of this library. (I could not find &quot;ScriptHost&quot; in my C++ source code)."}], "owner": {"reputation": 41, "user_id": 4200522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7321b51e006006d20bc50f89dfd370bf?s=128&d=identicon&r=PG&f=1", "display_name": "Ronnie", "link": "https://stackoverflow.com/users/4200522/ronnie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 422, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1470920507, "creation_date": 1470862023, "last_edit_date": 1470920507, "question_id": 38883236, "link": "https://stackoverflow.com/questions/38883236/how-to-permanently-remove-or-update-a-vba-reference-in-excel", "title": "How to permanently remove or update a VBA reference in excel?", "body": "<p>My application makes use of macros to generate some charts and this uses references to some of the application dlls. I have converted the whole application from 32-bit to 64-bit including the dlls. But one of these references still seems to refer to 32-bit dll which i was using earlier. Now even when i try adding the new dll file in references it gets named differently and hence i am not able to create objects of this dll from the macros code. It gives me an error saying:\n<strong>Automation error: library not registered</strong></p>\n\n<p>Corresponding code:</p>\n\n<pre><code>On Error GoTo errNoDatabase\n       Set server = CreateObject(\"Bemmsdb.Server\")\n       'server.Connect \"SQLOLEDB\", \"BACKUP\", \"\", \"\", \"Trusted_Connection=Yes\"\n       'Set db = server.OpenDatabase(\"BEMMS\")\n       server.Connect \"\", \"\", \"\", \"\", \"\"\n       Set db = server.OpenDatabase(\"\")\n       GoTo errSkip errNoDatabase:\n       MsgBox \"Unable to open database. Be sure to select a database in PowerScape before running the 'Query Enetics Database' macro.\",\n   Title:=\"Query Enetics Database Macro\"\n       Exit Sub\n</code></pre>\n\n<p>This gives me the error message at the bottom since it can not create the Bemmsdb.Server object. Can anyone help me with this?</p>\n\n<p>Excel 2013 64bit\nWindows 10 64bit\nVisual Studio 2008 SP1</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1470861160, "post_id": 38882856, "comment_id": 65126984, "body": "It&#39;s so hard to try to figure what is causing the infinite loop -that&#39;s why Excel freezes, it shouldn&#39;t be out of the loop, you may try to see what is doing by pressing F8 and see where it tends to never-ending, according to the logic it should have exited at the first empty value, but seems it is not. Also, there seems that Destination is an error, are you trying to set a range? if so you need to use Set Destination instead of Destination stand alone"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1470861583, "post_id": 38882856, "comment_id": 65127202, "body": "Once Found is set to True, it is never re-set back to False. This renders it meaningless. Also, why do you need to use Found anyway? It looks like you&#39;re only testing its presence in one place, so why not directly write those lines within the &quot;If ActiveCell.Value = NSName&quot; condition in the first place?"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 2, "creation_date": 1470861725, "post_id": 38882856, "comment_id": 65127269, "body": "Also - all your selection and offsetting is unnecessary. Just work directly from the cells in question, without selecting them :)"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470862251, "post_id": 38882856, "comment_id": 65127532, "body": "It&#39;s an endless loop because of <code>Sheets(&quot;FPS_Report&quot;).Activate</code> which is inside the outer loop. You are never changing <code>Worksheets(&quot;Summary_Report&quot;).Range(&quot;B:B&quot;)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": false, "score": 0, "last_activity_date": 1470862249, "creation_date": 1470862249, "answer_id": 38883295, "question_id": 38882856, "link": "https://stackoverflow.com/questions/38882856/encountering-an-error-freeze-using-countif-in-vba/38883295#38883295", "title": "Encountering an error/freeze using COUNTIF in VBA", "body": "<p>This might help you. It would most likely need to be modified to fit your data. It sets a name range and a lookup range, then looks through the lookup for each name. If it finds it, it keeps tally of it and eventually records it to a separate sheet.</p>\n\n<pre><code>Sub NameSearch()\n\nDim nameSource As range\nDim searchRange As range\nDim name As range\nDim counter As Integer\nDim openRow As Integer\n\n'Keep track of how many times a name is found.\ncounter = 0\n\n'The row where you want to store the data, mine is a blank sheet so I am starting\n'at the first row.\nopenRow = 1\n\n'Get the range that has the names to look for. Modify for your data.\nSet nameSource = Sheets(\"Summary_Report\").range(\"A1\", \"A4\")\n\n'Get the range to search for the name. Modify for your data.\nSet searchRange = Sheets(\"FPS_Report\").range(\"A1\", \"A15\")\n\n'Look through the search range. If a name is found, add one to the counter, and continue\nFor Each name In nameSource\n    Set c = searchRange.Find(name.Value)\n    If Not c Is Nothing Then\n        firstAddress = c.address\n        Do\n            counter = counter + 1\n            Set c = searchRange.FindNext(c)\n        Loop While Not c Is Nothing And c.address &lt;&gt; firstAddress\n    End If\n\n    'If counter isn't 0, then name was found at least once\n    If counter &lt;&gt; 0 Then\n        Sheets(\"Report\").range(\"A\" &amp; openRow).Value = name.Value\n        Sheets(\"Report\").range(\"B\" &amp; openRow).Value = counter\n\n        'increment next row and reset counter\n        openRow = openRow + 1\n        counter = 0\n    End If\n\nNext name\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6636695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44ec3619d46bc834f35a710e1c9bd0e?s=128&d=identicon&r=PG&f=1", "display_name": "Capnindigo", "link": "https://stackoverflow.com/users/6636695/capnindigo"}, "edited": false, "score": 0, "creation_date": 1471181278, "post_id": 38883952, "comment_id": 65240380, "body": "This works perfectly! Thanks so much. I&#39;m still learning all the intricacies of VBA and hopefully I can dig into this and learn a bit more."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 6636695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44ec3619d46bc834f35a710e1c9bd0e?s=128&d=identicon&r=PG&f=1", "display_name": "Capnindigo", "link": "https://stackoverflow.com/users/6636695/capnindigo"}, "edited": false, "score": 0, "creation_date": 1471181339, "post_id": 38883952, "comment_id": 65240401, "body": "You&#39;re welcome so much.  Thanks for accepting my answer!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1470864865, "creation_date": 1470864865, "answer_id": 38883952, "question_id": 38882856, "link": "https://stackoverflow.com/questions/38882856/encountering-an-error-freeze-using-countif-in-vba/38883952#38883952", "title": "Encountering an error/freeze using COUNTIF in VBA", "body": "<p>The reason for the endless loop is that <code>Worksheets(\"Summary_Report\").Range(\"B:B\")</code> will never be empty.</p>\n\n<p><code>Do Until IsEmpty(Worksheets(\"Summary_Report\").Range(\"B:B\"))</code></p>\n\n<p>You could fix it like this:</p>\n\n<p><code>Do Until IsEmpty(ActiveCell.Offset(1, 0))</code></p>\n\n<p>But you should avoid selecting or activating whenever possible.  </p>\n\n<pre><code>Sub NS_FPS_Macro()\n    Dim c As Range, CountRange As Range, NamesRange As Range, DestRange As Range\n    Dim FPSCount As Long\n\n    With Worksheets(\"FPS_Report\")\n        Set CountRange = Intersect(.UsedRange, .Range(\"B:B\"))\n    End With\n\n    With Worksheets(\"Summary_Report\")\n        Set NamesRange = .Range(\"B2\", .Range(\"B\" &amp; Rows.Count).End(xlUp))\n    End With\n\n    For Each c In NamesRange\n\n        FPSCount = Application.WorksheetFunction.CountIf(CountRange, c.Text)\n        If FPSCount &gt; 0 Then\n\n            Set DestRange = Sheets(\"Report\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1)\n            DestRange.Value = c.Value\n            DestRange.Offset(0, 1).Value = FPSCount\n\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6636695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44ec3619d46bc834f35a710e1c9bd0e?s=128&d=identicon&r=PG&f=1", "display_name": "Capnindigo", "link": "https://stackoverflow.com/users/6636695/capnindigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 38883952, "answer_count": 2, "score": -2, "last_activity_date": 1470864865, "creation_date": 1470860570, "last_edit_date": 1531161705, "question_id": 38882856, "link": "https://stackoverflow.com/questions/38882856/encountering-an-error-freeze-using-countif-in-vba", "title": "Encountering an error/freeze using COUNTIF in VBA", "body": "<p>I'm trying to take a list of names on one sheet, check to see if it appears on a second sheet, and if it does, display on a third sheet the name and the number of times it appears.</p>\n\n<p>I found some code elsewhere and attempted to adapt it for my purposes. I've used <em>Do Until IsEmpty</em> to run through the first worksheet and two nested IF statements to check if the name appears on the second sheet, and COUNTIF to tally them. </p>\n\n<p>I thought I'd gotten everything correct, but when I try the macro it runs for a moment then hangs up and freezes. I'm very new at VBA and have probably made some very simple mistakes, but I'm not familiar enough to with VBA to find the error.</p>\n\n<p>Below is the code that I'm using.</p>\n\n<pre><code>Sub NS_FPS_Macro()\nDim NSName As String\nDim FPSCount As String\n\nApplication.ScreenUpdating = False\n\nNSName = Worksheets(\"Summary_Report\").Range(\"B2\").Select\n\nDo Until IsEmpty(Worksheets(\"Summary_Report\").Range(\"B:B\"))\n    Sheets(\"FPS_Report\").Activate\n    If ActiveCell.Value = NSName Then\n        Found = True\n    End If\n\n    If Found = True Then\n        FPSCount = Application.WorksheetFunction.CountIf(Range(Worksheets(\"FPS_Report\").Range(\"B:B\")), NSName)\n        Destination = Sheets(\"Report\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1)\n    End If\nActiveCell.Offset(1, 0).Select\nLoop\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 4928, "user_id": 5314530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/671d5901621bffdfce67c830735f4c97?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mack", "link": "https://stackoverflow.com/users/5314530/chris-mack"}, "is_accepted": false, "score": 1, "last_activity_date": 1470859759, "creation_date": 1470859759, "answer_id": 38882635, "question_id": 38882476, "link": "https://stackoverflow.com/questions/38882476/conditional-formatting-vba-cells-colour-based-on-the-cells-contents/38882635#38882635", "title": "Conditional Formatting VBA Cells Colour based on the Cells contents", "body": "<p>This will do it (you will probably need to change your range - I've used A1:A3 for this example):</p>\n\n<pre><code>Sub ColorCells()\n\n    Dim rng As Range, cell As Range\n\n    Set rng = ActiveSheet.Range(\"A1:A3\")\n\n    For Each cell In rng\n\n        If cell &lt; 100 Then\n            cell.Interior.Color = RGB(0, 255, 0)\n        ElseIf cell &lt; 2500 Then\n            cell.Interior.Color = RGB(255, 255, 0)\n        ElseIf cell &gt;= 2500 Then\n            cell.Interior.Color = RGB(255, 0, 0)\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6702046, "user_type": "registered", "profile_image": "https://graph.facebook.com/1107092159336597/picture?type=large", "display_name": "Ian Murray", "link": "https://stackoverflow.com/users/6702046/ian-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470859759, "creation_date": 1470859174, "question_id": 38882476, "link": "https://stackoverflow.com/questions/38882476/conditional-formatting-vba-cells-colour-based-on-the-cells-contents", "title": "Conditional Formatting VBA Cells Colour based on the Cells contents", "body": "<p>my VBA skills aren't the best so bear with me. I want to format the fill colour of cells based on their values. I know how to do this using Conditional Formatting, however this takes a bit of time to do. Can anyone share some VBA code to automate this process? </p>\n\n<p>I want the cells with values less than 100 to have a green fill colour, \nthe cells greater than 100 but less than 2500 to be yellow \nand anything greater than this to be red? </p>\n\n<p>Your help would be much appreciated. Thanks Ian</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1470859877, "post_id": 38882428, "comment_id": 65126334, "body": "Did you add the shape while the graph was selected?"}], "answers": [{"comments": [{"owner": {"reputation": 1216, "user_id": 4704491, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6beb615acda87df6cd29358a8dd54e5d?s=128&d=identicon&r=PG&f=1", "display_name": "delmalki", "link": "https://stackoverflow.com/users/4704491/delmalki"}, "edited": false, "score": 0, "creation_date": 1470861753, "post_id": 38882769, "comment_id": 65127283, "body": "Thanks but I already tried that. I think it doesn&#39;t work with new graphs from excel 2016. In fact, many features with new graphs such as waterfall are disabled with 2016( saving as a template)."}], "tags": [], "owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "is_accepted": false, "score": 1, "last_activity_date": 1470860276, "creation_date": 1470860276, "answer_id": 38882769, "question_id": 38882428, "link": "https://stackoverflow.com/questions/38882428/make-shape-stick-to-chart-when-moved/38882769#38882769", "title": "Make shape stick to chart when moved", "body": "<p>When adding shapes that you want to stay with a chart, you must:</p>\n\n<ul>\n<li>Select the chart</li>\n<li>Choose the shape to insert</li>\n<li>Draw your shape inside the chart area</li>\n</ul>\n\n<p>To add and existing shape to the chart</p>\n\n<ul>\n<li>Select the shape</li>\n<li>Use Cut on the shape</li>\n<li>Select the chart</li>\n<li>Use Paste on the chart</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13703104, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x7AHUGO58YY/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucm1blov8zpfoXpW_V2XLCQBr_Y-Xg/photo.jpg?sz=128", "display_name": "Kalin Kostadinov", "link": "https://stackoverflow.com/users/13703104/kalin-kostadinov"}, "is_accepted": false, "score": 0, "last_activity_date": 1591577935, "creation_date": 1591577935, "answer_id": 62253546, "question_id": 38882428, "link": "https://stackoverflow.com/questions/38882428/make-shape-stick-to-chart-when-moved/62253546#62253546", "title": "Make shape stick to chart when moved", "body": "<p>With the shape selected, use the Shape Format tab and the 'Group' function in the Arrange menu of the tab. Need to select the chart as well </p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 8272967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dOoO61_eu9A/AAAAAAAAAAI/AAAAAAAAF6k/ZNICXS2_jp8/photo.jpg?sz=128", "display_name": "Andrew G", "link": "https://stackoverflow.com/users/8272967/andrew-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1591710704, "creation_date": 1591710704, "answer_id": 62284257, "question_id": 38882428, "link": "https://stackoverflow.com/questions/38882428/make-shape-stick-to-chart-when-moved/62284257#62284257", "title": "Make shape stick to chart when moved", "body": "<p>Michael Russo's answer is correct. Either create the shape while the chart is selected, or cut the shape, select the chart, and then paste it, and it will paste <em>into</em> the chart. After you've inserted the shape into the chart, you can cut or copy the entire chart and it takes the shape with it. You can even copy the chart and paste the image of it into another Office document.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14158371, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GiW_vIo3k5S-qKB1qVETcXSuVUE5T-hUr6liam9tw=k-s128", "display_name": "user14158371", "link": "https://stackoverflow.com/users/14158371/user14158371"}, "is_accepted": false, "score": 0, "last_activity_date": 1598283012, "creation_date": 1598283012, "answer_id": 63564095, "question_id": 38882428, "link": "https://stackoverflow.com/questions/38882428/make-shape-stick-to-chart-when-moved/63564095#63564095", "title": "Make shape stick to chart when moved", "body": "<p>People facing problem making shape/text stick to the chart with newer versions of Excel (2016 and above), try inserting a shape while the chart is already selected. Then select both the chart and the shape together by pressing Ctrl button.</p>\n<p>After doing this, go to Shape Format and click Group-&gt;Group. It makes them stick together, worked for me. One flaw with this function I experienced is that I couldn't do this for more than one element (text/shape) with the chart.</p>\n"}], "owner": {"reputation": 1216, "user_id": 4704491, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6beb615acda87df6cd29358a8dd54e5d?s=128&d=identicon&r=PG&f=1", "display_name": "delmalki", "link": "https://stackoverflow.com/users/4704491/delmalki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2463, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1598283012, "creation_date": 1470859013, "last_edit_date": 1593967296, "question_id": 38882428, "link": "https://stackoverflow.com/questions/38882428/make-shape-stick-to-chart-when-moved", "title": "Make shape stick to chart when moved", "body": "<p>I tried grouping the shape to the chart but then again, i have to select the chart and the shapes to make them movable.</p>\n<p>Isn't there any easier way to make any shape added really stick to the chart. In some other file I have the shape not only stick when moved but also can't get out of the chart frame.</p>\n<p>Using excel 2016, would prefer a vba free solution. It's a waterfall graph if that makes any difference.</p>\n<p>Thank you</p>\n<p>Theres no good answer, Im closing this sorry</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "edited": false, "score": 0, "creation_date": 1470859114, "post_id": 38882396, "comment_id": 65125922, "body": "What is GarminPin? Where is it defined?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "edited": false, "score": 0, "creation_date": 1470859612, "post_id": 38882396, "comment_id": 65126197, "body": "If you <code>Debug.Print CompPin(Item)</code> you&#39;ll find your error - your For loop is not returning an index - it&#39;s actually returning the value of the string array - you can use it directly - as in <code>What:=Item</code> - but then you&#39;d  need new loop for AutoPin. Better to use loop like @Mister832 suggests - and this explains it better than no explanation"}, {"owner": {"reputation": 217, "user_id": 3461628, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1527f85e6e1883e51bcc572bb2e6f213?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Williams", "link": "https://stackoverflow.com/users/3461628/timothy-williams"}, "reply_to_user": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "edited": false, "score": 0, "creation_date": 1470860668, "post_id": 38882396, "comment_id": 65126737, "body": "@Mister 832 - I edited that, oops"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1470861406, "post_id": 38882396, "comment_id": 65127116, "body": "I think all you need to <code>CStr(Item)</code> for some of the <code>Replace</code> function arguments. They expect string and <code>For Each</code> loop iterates over a <code>Variant</code>. <code>CStr</code> will convert Item into string and you won&#39;t have errors."}], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 3461628, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1527f85e6e1883e51bcc572bb2e6f213?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Williams", "link": "https://stackoverflow.com/users/3461628/timothy-williams"}, "edited": false, "score": 0, "creation_date": 1470860798, "post_id": 38882544, "comment_id": 65126794, "body": "Perfect!  That is what I was looking for."}], "tags": [], "owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "is_accepted": true, "score": 2, "last_activity_date": 1470859411, "creation_date": 1470859411, "answer_id": 38882544, "question_id": 38882396, "link": "https://stackoverflow.com/questions/38882396/iterate-through-for-loop-with-replace-function/38882544#38882544", "title": "Iterate through For Loop with Replace function", "body": "<p>Try this</p>\n\n<pre><code>CompPin() = Split(\"1ARD 2ARD 1RPI 2RPI\")\nAutoPin() = Split(\"PB1A PC1A PF1A PF2B\")\n\nFor n = 0 To UBound(CompPin)\n    Worksheets(\"Demo\").Columns(\"D\").Replace What:=CompPin(n), Replacement:=AutoPin(n), LookAt:=xlPart\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 217, "user_id": 3461628, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1527f85e6e1883e51bcc572bb2e6f213?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Williams", "link": "https://stackoverflow.com/users/3461628/timothy-williams"}, "edited": false, "score": 0, "creation_date": 1470860888, "post_id": 38882707, "comment_id": 65126835, "body": "This is interesting.  I will copy this and explore it a little bit.  Thanks.  This has the added benefit of being able to keep better track of what is replacing what."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 217, "user_id": 3461628, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1527f85e6e1883e51bcc572bb2e6f213?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Williams", "link": "https://stackoverflow.com/users/3461628/timothy-williams"}, "edited": false, "score": 0, "creation_date": 1470864382, "post_id": 38882707, "comment_id": 65128527, "body": "you are welcome. so you may want to up-vote this :-)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1470860074, "creation_date": 1470860074, "answer_id": 38882707, "question_id": 38882396, "link": "https://stackoverflow.com/questions/38882396/iterate-through-for-loop-with-replace-function/38882707#38882707", "title": "Iterate through For Loop with Replace function", "body": "<p>an alternative could be a \"double-split\":</p>\n\n<pre><code>Sub main()\n    Dim CompAutoPin() As String\n    Dim Item As Variant\n\n    CompAutoPin() = Split(\"1ARD-PB1A 2ARD-PC1A 1RPI-PF1A 2RPI-PF2B\")    \n    For Each Item In CompAutoPin\n        Worksheets(\"Demo\").Columns(\"D\").Replace What:=Split(Item, \"-\")(0), Replacement:=Split(Item, \"-\")(1), LookAt:=xlPart\n    Next Item\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 3461628, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1527f85e6e1883e51bcc572bb2e6f213?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Williams", "link": "https://stackoverflow.com/users/3461628/timothy-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 38882544, "answer_count": 2, "score": 0, "last_activity_date": 1470860074, "creation_date": 1470858910, "question_id": 38882396, "link": "https://stackoverflow.com/questions/38882396/iterate-through-for-loop-with-replace-function", "title": "Iterate through For Loop with Replace function", "body": "<p>I have a data set that looks like this:</p>\n\n<p>Pin</p>\n\n<ol>\n<li>2Ard-7</li>\n<li>2Ard-99</li>\n<li>1RPI-35</li>\n<li>1RPI-34</li>\n<li>1RPI-39</li>\n<li>1RPI-38</li>\n</ol>\n\n<p>I am trying to loop through this and replace parts of each cell with a different designation.  Here is the code I have so far:</p>\n\n<pre><code>Dim CompPin() As String\nDim AutoPin() As String\nDim Item As Variant\n\nCompPin() = Split(\"1ARD 2ARD 1RPI 2RPI\")\nAutoPin() = Split(\"PB1A PC1A PF1A PF2B\")\n\nFor Each Item In CompPin\n    Worksheets(\"Demo\").Columns(\"D\").Replace What:=CompPin(Item), Replacement:=AutoPin(Item), LookAt:=xlPart\nNext\n</code></pre>\n\n<p>When I run this code, I get a type mismatch.  Any insight would be helpful.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2388, "user_id": 6481438, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gfYh4.png?s=128&g=1", "display_name": "GCSDC", "link": "https://stackoverflow.com/users/6481438/gcsdc"}, "edited": false, "score": 2, "creation_date": 1470858895, "post_id": 38882321, "comment_id": 65125801, "body": "Why not using <code>Sheets(&quot;Sheet2&quot;).UsedRange.Rows.Count</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1470859011, "post_id": 38882321, "comment_id": 65125862, "body": "See here: <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\" title=\"error in finding last used cell in vba\">stackoverflow.com/questions/11169445/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1470859072, "post_id": 38882321, "comment_id": 65125902, "body": "but in essence <code>Sheets(&quot;Sheet2&quot;).Cells(1,Sheets(&quot;Sheet2&quot;).Rows.Count).End(xl&zwnj;&#8203;Up).Row</code>"}, {"owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1470859123, "post_id": 38882321, "comment_id": 65125928, "body": "I am using a for loop that changes so I want the cell format. Changing a range is difficult for me where having a cell is a lot easier."}, {"owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1470859602, "post_id": 38882321, "comment_id": 65126191, "body": "It return this, &quot;Run-time error &#39;1004&#39;."}, {"owner": {"reputation": 1523, "user_id": 1479132, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/orlXK.jpg?s=128&g=1", "display_name": "hiFI", "link": "https://stackoverflow.com/users/1479132/hifi"}, "edited": false, "score": 0, "creation_date": 1533709354, "post_id": 38882321, "comment_id": 90439661, "body": "<a href=\"https://www.excelcampus.com/vba/find-last-row-column-cell/\" rel=\"nofollow noreferrer\">I found this very valuable and hope you will to</a>"}], "answers": [{"comments": [{"owner": {"reputation": 626, "user_id": 6575856, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QBxNnVp8qBE/AAAAAAAAAAI/AAAAAAAAAGg/AGkLGS7o1JM/photo.jpg?sz=128", "display_name": "Matthew Goheen", "link": "https://stackoverflow.com/users/6575856/matthew-goheen"}, "edited": false, "score": 0, "creation_date": 1532697902, "post_id": 38882823, "comment_id": 90084665, "body": "For both of the ways to find the last row don&#39;t work. I keep getting &quot;Run-Time Error &#39;438&#39;: Object doesn&#39;t support this property or method&quot; with both of them."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1591181021, "post_id": 38882823, "comment_id": 109955447, "body": "this code returns &quot;1&quot; on a blank sheet, how is this possible? I want it to return if there is no value inside."}, {"owner": {"reputation": 289, "user_id": 1403788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcebda8ba97ca45dd49aebaec5836f0f?s=128&d=identicon&r=PG", "display_name": "GeoStoneMarten", "link": "https://stackoverflow.com/users/1403788/geostonemarten"}, "reply_to_user": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1598003300, "post_id": 38882823, "comment_id": 112322759, "body": "@smartini because this m&#233;thode return a row (empty or not) and return by the end the row if it contains value. 2 possibilities : check if A1 = vbnullstring or use find method"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1602446843, "post_id": 38882823, "comment_id": 113716523, "body": "All three are wrong. The first one will return wrong value if the last column is filled, the other two will return wrong value if the last row is filled."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 27, "last_activity_date": 1513071385, "last_edit_date": 1513071385, "creation_date": 1470860446, "answer_id": 38882823, "question_id": 38882321, "link": "https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/38882823#38882823", "title": "Better way to find last used row", "body": "<p>You should use a with statement to qualify both your <code>Rows</code> and <code>Columns</code> counts.  This will prevent any errors while working with older pre 2007 and newer 2007 Excel Workbooks.</p>\n\n<p>Last Column</p>\n\n<pre><code>With Sheets(\"Sheet2\")\n    .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With \n</code></pre>\n\n<p>Last Row</p>\n\n<pre><code>With Sheets(\"Sheet2\")\n    .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nEnd With \n</code></pre>\n\n<p>Or </p>\n\n<pre><code>With Sheets(\"Sheet2\")\n    .Cells(.Rows.Count, 1).End(xlUp).Row\nEnd With \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 10011419, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0S7cT7AjqCI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0SSAIhTbhT3IwPzSqcAOwQ3Aej2Q/mo/photo.jpg?sz=128", "display_name": "Juan Cappuccino", "link": "https://stackoverflow.com/users/10011419/juan-cappuccino"}, "is_accepted": false, "score": 5, "last_activity_date": 1530310821, "last_edit_date": 1530310821, "creation_date": 1530282343, "answer_id": 51103915, "question_id": 38882321, "link": "https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/51103915#51103915", "title": "Better way to find last used row", "body": "<p>How is this?</p>\n\n<pre><code>dim rownum as integer\ndim colnum as integer\ndim lstrow as integer\ndim lstcol as integer\ndim r as range\n\n'finds the last row\n\nlastrow = ActiveSheet.UsedRange.Rows.Count\n\n'finds the last column\n\nlastcol = ActiveSheet.UsedRange.Columns.Count\n\n'sets the range\n\nset r = range(cells(rownum,colnum), cells(lstrow,lstcol))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1532704936, "post_id": 51559438, "comment_id": 90088861, "body": "I&#39;d have to disagree with you there for the reasons you&#39;ve given.  I&#39;ve found either the <code>xlUp&#47;xlLeft</code> method for specific columns/rows or <code>Find(&quot;*&quot;)</code> for last cell on sheet to be the most reliable methods."}, {"owner": {"reputation": 626, "user_id": 6575856, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QBxNnVp8qBE/AAAAAAAAAAI/AAAAAAAAAGg/AGkLGS7o1JM/photo.jpg?sz=128", "display_name": "Matthew Goheen", "link": "https://stackoverflow.com/users/6575856/matthew-goheen"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1532714691, "post_id": 51559438, "comment_id": 90093526, "body": "@DarrenBartrup-Cook I couldn&#39;t get the code in the accepted answer to work for me. But the code I posted works well for me."}, {"owner": {"reputation": 289, "user_id": 1403788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcebda8ba97ca45dd49aebaec5836f0f?s=128&d=identicon&r=PG", "display_name": "GeoStoneMarten", "link": "https://stackoverflow.com/users/1403788/geostonemarten"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1598003953, "post_id": 51559438, "comment_id": 112323033, "body": "@DarrenBartrup-Cook Find method work but you need test if result is nothing in case of all row are vbnullstring and .End(xlUp).Row return last row not empty or the first cell of column"}, {"owner": {"reputation": 193, "user_id": 10186832, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EjE4fYq6KIY/AAAAAAAAAAI/AAAAAAAAAe8/VYsbXTZyuU0/photo.jpg?sz=128", "display_name": "user10186832", "link": "https://stackoverflow.com/users/10186832/user10186832"}, "edited": false, "score": 0, "creation_date": 1617478642, "post_id": 51559438, "comment_id": 118317348, "body": "@MatthewGoheen this answer is the simplest. It works so long as there is no blank cell in the middle of the column. last line should read GetLastRow = row - 1 ?"}], "tags": [], "owner": {"reputation": 626, "user_id": 6575856, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QBxNnVp8qBE/AAAAAAAAAAI/AAAAAAAAAGg/AGkLGS7o1JM/photo.jpg?sz=128", "display_name": "Matthew Goheen", "link": "https://stackoverflow.com/users/6575856/matthew-goheen"}, "is_accepted": false, "score": 1, "last_activity_date": 1532703008, "last_edit_date": 1532703008, "creation_date": 1532699452, "answer_id": 51559438, "question_id": 38882321, "link": "https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/51559438#51559438", "title": "Better way to find last used row", "body": "<p>This is the best way I've seen to find the last cell.</p>\n\n<pre><code>MsgBox ActiveSheet.UsedRage.SpecialCells(xlCellTypeLastCell).Row\n</code></pre>\n\n<p>One of the disadvantages to using this is that it's not always accurate. If you use it then delete the last few rows and use it again, it does not always update. Saving your workbook before using this seems to force it to update though.</p>\n\n<p>Using the next bit of code after updating the table (or refreshing the query that feeds the table) forces everything to update before finding the last row. But, it's been reported that it makes excel crash. Either way, calling this before trying to find the last row will ensure the table has finished updating first. </p>\n\n<pre><code>Application.CalculateUntilAsyncQueriesDone\n</code></pre>\n\n<p>Another way to get the last row for any given column, if you don't mind the overhead.</p>\n\n<pre><code>Function GetLastRow(col, row)\n    ' col and row are where we will start.\n    ' We will find the last row for the given column.\n    Do Until ActiveSheet.Cells(row, col) = \"\"\n        row = row + 1\n    Loop\n    GetLastRow = row\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11798863, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QgAl73bKqGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcHuOJJehV-YbpCPnIV3N2E1SYSBQ/photo.jpg?sz=128", "display_name": "Phil Brewer", "link": "https://stackoverflow.com/users/11798863/phil-brewer"}, "is_accepted": false, "score": 2, "last_activity_date": 1563386902, "creation_date": 1563386902, "answer_id": 57081904, "question_id": 38882321, "link": "https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/57081904#57081904", "title": "Better way to find last used row", "body": "<p>I use this routine to find the count of data rows.  There is a minimum of overhead required, but by counting using a decreasing scale, even a very large result requires few iterations.  For example, a result of 28,395 would only require 2 + 8 + 3 + 9 + 5, or 27 times through the loop, instead of a time-expensive 28,395 times.</p>\n\n<p>Even were we to multiply that by 10 (283,950), the iteration count is the same 27 times.</p>\n\n<pre><code>Dim lWorksheetRecordCountScaler as Long\nDim lWorksheetRecordCount as Long\n\nConst sDataColumn = \"A\"   '&lt;----Set to column that has data in all rows (Code, ID, etc.)\n\n    'Count the data records\n    lWorksheetRecordCountScaler = 100000  'Begin by counting in 100,000-record bites\n    lWorksheetRecordCount = lWorksheetRecordCountScaler\n\n    While lWorksheetRecordCountScaler &gt;= 1\n\n        While Sheets(\"Sheet2\").Range(sDataColumn &amp; lWorksheetRecordCount + 2).Formula &gt; \" \"\n            lWorksheetRecordCount = lWorksheetRecordCount + lWorksheetRecordCountScaler\n        Wend\n\n        'To the beginning of the previous bite, count 1/10th of the scale from there\n        lWorksheetRecordCount = lWorksheetRecordCount - lWorksheetRecordCountScaler\n        lWorksheetRecordCountScaler = lWorksheetRecordCountScaler / 10\n\n    Wend\n\n    lWorksheetRecordCount = lWorksheetRecordCount + 1   'Final answer\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 7253826, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iin3sfIbq_U/AAAAAAAAAAI/AAAAAAAAJVs/trr-Uf_bkas/photo.jpg?sz=128", "display_name": "Brigham Ray", "link": "https://stackoverflow.com/users/7253826/brigham-ray"}, "is_accepted": false, "score": 5, "last_activity_date": 1565896322, "creation_date": 1565896322, "answer_id": 57514946, "question_id": 38882321, "link": "https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/57514946#57514946", "title": "Better way to find last used row", "body": "<p>This function should do the trick if you want to specify a particular sheet. I took the solution from user6432984 and modified it to not throw any errors. I am using Excel 2016 so it may not work for older versions:</p>\n\n<pre><code>Function findLastRow(ByVal inputSheet As Worksheet) As Integer\n    findLastRow = inputSheet.cellS(inputSheet.Rows.Count, 1).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p>This is the code to run if you are already working in the sheet you want to find the last row of:</p>\n\n<pre><code>Dim lastRow as Integer\nlastRow = cellS(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 13398759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217157005183141/picture?type=large", "display_name": "Antanas \u0160ukevi\u010dius", "link": "https://stackoverflow.com/users/13398759/antanas-%c5%a0ukevi%c4%8dius"}, "is_accepted": false, "score": 2, "last_activity_date": 1587733768, "creation_date": 1587733768, "answer_id": 61409162, "question_id": 38882321, "link": "https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/61409162#61409162", "title": "Better way to find last used row", "body": "<p>This gives you last used row in a specified column. </p>\n\n<p>Optionally you can specify worksheet, else it will takes active sheet.</p>\n\n<pre><code>Function shtRowCount(colm As Integer, Optional ws As Worksheet) As Long\n\n    If ws Is Nothing Then Set ws = ActiveSheet\n\n    If ws.Cells(Rows.Count, colm) &lt;&gt; \"\" Then\n        shtRowCount = ws.Cells(Rows.Count, colm).Row\n        Exit Function\n    End If\n\n    shtRowCount = ws.Cells(Rows.Count, colm).Row\n\n    If shtRowCount = 1 Then\n        If ws.Cells(1, colm) = \"\" Then\n            shtRowCount = 0\n        Else\n            shtRowCount = 1\n        End If\n    End If\n\nEnd Function\n\nSub test()\n\n    Dim lgLastRow As Long\n    lgLastRow = shtRowCount(2) 'Column B\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 289, "user_id": 1403788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcebda8ba97ca45dd49aebaec5836f0f?s=128&d=identicon&r=PG", "display_name": "GeoStoneMarten", "link": "https://stackoverflow.com/users/1403788/geostonemarten"}, "is_accepted": false, "score": 0, "last_activity_date": 1598007462, "creation_date": 1598007462, "answer_id": 63521561, "question_id": 38882321, "link": "https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/63521561#63521561", "title": "Better way to find last used row", "body": "<p>I preferred search last blank cell:</p>\n<p>Il you want last empty cell of column you can do that</p>\n<pre><code>Dim sh as Worksheet, r as range\nset sh = ActiveWorksheet 'if you want an other it's possible\n\n'find a value \n'Columns(&quot;A:D&quot;) 'to check on multiple columns \nSet r = sh.Columns(&quot;A&quot;).Find(What:=&quot;*&quot;, SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n'no value return first row\nIf r Is Nothing Then Set r = sh.Cells(1, &quot;A&quot;) Else Set r = sh1.Cells(r.Row + 1, &quot;A&quot;)\n</code></pre>\n<p>If this is to insert new row, find on multiple columns is a good choice because first column can contains less rows than next columns</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14110061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90357466b83e1b098a298a9f02ca22e9?s=128&d=identicon&r=PG", "display_name": "Gavin Lewarne", "link": "https://stackoverflow.com/users/14110061/gavin-lewarne"}, "is_accepted": false, "score": 0, "last_activity_date": 1605366769, "last_edit_date": 1605366769, "creation_date": 1605268586, "answer_id": 64820464, "question_id": 38882321, "link": "https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row/64820464#64820464", "title": "Better way to find last used row", "body": "<p>I use the following function extensively.  As pointed out above, using other methods can sometimes give inaccurate results due to used range updates, gaps in the data, or different columns having different row counts.</p>\n<p>Example of use:</p>\n<pre><code>lastRow=FindRange(&quot;Sheet1&quot;,&quot;A1:A1000&quot;)\n</code></pre>\n<p>would return the last occupied row number of the <strong>entire</strong> range.  You can specify any range you want from single columns to random rows, eg FindRange(&quot;Sheet1&quot;,&quot;A100:A150&quot;)</p>\n<pre><code>Public Function FindRange(inSheet As String, inRange As String) As Long\n    Set fr = ThisWorkbook.Sheets(inSheet).Range(inRange).find(&quot;*&quot;, SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n    If Not fr Is Nothing Then FindRange = fr.row Else FindRange = 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140728, "favorite_count": 5, "accepted_answer_id": 38882823, "answer_count": 8, "score": 15, "last_activity_date": 1614076955, "creation_date": 1470858653, "last_edit_date": 1614076955, "question_id": 38882321, "link": "https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row", "title": "Better way to find last used row", "body": "<p>I am trying to find the last row the same way I found the last column:</p>\n<pre><code>Sheets(&quot;Sheet2&quot;).Cells(1,Sheets(&quot;Sheet2&quot;).Columns.Count).End(xlToLeft).Column\n</code></pre>\n<p>I know this way but it is not as helpful as the prior would be:</p>\n<pre><code>u = Sheets(&quot;Sheet1&quot;).Range(&quot;A65536&quot;).End(xlUp).Row\n</code></pre>\n<p>I tried:</p>\n<pre><code>Sheets(&quot;Sheet2&quot;).Cells(Sheets(&quot;Sheet2&quot;,1).Rowa.Count).End(xlToUP).Column\n</code></pre>\n<p>Synopsis: I would like the below way for last row.</p>\n<pre><code>Sheets(&quot;Sheet2&quot;).Cells(1,Sheets(&quot;Sheet2&quot;).Columns.Count).End(xlToLeft).Column\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1470861041, "post_id": 38882019, "comment_id": 65126925, "body": "(a) Have you tried stepping through the code one line at a time to determine which line of code is causing those cells to be changed to red?  (b) Have you checked that the cells that turned red didn&#39;t turn red due to conditional formatting?  e.g. if there was a conditional format in cell AG16 that set the cell to red if <code>=0=IFERROR(IF(AG15=&quot;XYZ&quot;,0,1),0)</code> then it would become red when the cell moved from AG16 to AG1.  (I&#39;m just making that test up, solely to highlight that shifting cells could cause the conditional format to fire.)"}, {"owner": {"reputation": 73, "user_id": 749468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f08a3952dda762e909cf88c941f415c?s=128&d=identicon&r=PG", "display_name": "jefff", "link": "https://stackoverflow.com/users/749468/jefff"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470862550, "post_id": 38882019, "comment_id": 65127691, "body": "I&#39;ll answer <b>b</b> first. None of the templates&#39; sheets have any conditional formatting rules. I&#39;m glad you mentioned that as I hadn&#39;t checked prior. As for <b>a</b>, I&#39;m trying to do my part before I ask the community for help. Yes, I have traced, I&#39;ll edit my post to include that information so I don&#39;t have a ludicrously long comment. Gotta run, so I&#39;ll edit from home or tomorrow morning. Thanks again."}, {"owner": {"reputation": 73, "user_id": 749468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f08a3952dda762e909cf88c941f415c?s=128&d=identicon&r=PG", "display_name": "jefff", "link": "https://stackoverflow.com/users/749468/jefff"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470862714, "post_id": 38882019, "comment_id": 65127766, "body": "Just before I log out, I see there is an answer. I&#39;ll dig into it tomorrow, but given my tracing, I suspected it had something to do with autofilter."}], "answers": [{"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470862443, "post_id": 38883273, "comment_id": 65127634, "body": "++ for the detailed answer. Great effort."}, {"owner": {"reputation": 73, "user_id": 749468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f08a3952dda762e909cf88c941f415c?s=128&d=identicon&r=PG", "display_name": "jefff", "link": "https://stackoverflow.com/users/749468/jefff"}, "edited": false, "score": 1, "creation_date": 1470940679, "post_id": 38883273, "comment_id": 65166177, "body": "This solution did not work in my case. Hilariously, it red-highlighed the second row, the row of <i>per mille</i> signs. I couldn&#39;t even work out a solution by altering some of it. However, I did like the tidier code, and the removal of the unnecessary use of <code>ColumnLetter</code>. It also helped me better understand my problem. SO points for you."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "reply_to_user": {"reputation": 73, "user_id": 749468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f08a3952dda762e909cf88c941f415c?s=128&d=identicon&r=PG", "display_name": "jefff", "link": "https://stackoverflow.com/users/749468/jefff"}, "edited": false, "score": 1, "creation_date": 1470941743, "post_id": 38883273, "comment_id": 65166798, "body": "@jefff That&#39;s because the the second row was part of the With Object - I expected it to be colored. Code is now edited to take account of this and remove it from the formatting."}], "tags": [], "owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "is_accepted": false, "score": 3, "last_activity_date": 1470941718, "last_edit_date": 1470941718, "creation_date": 1470862171, "answer_id": 38883273, "question_id": 38882019, "link": "https://stackoverflow.com/questions/38882019/excel-vba-script-filters-header-unexpectedly/38883273#38883273", "title": "Excel VBA script filters header unexpectedly", "body": "<p>This edit should fix your problems, hopefully (they did for my remake of your spreadsheet, but we won't know til you try on the real thing)</p>\n\n<pre><code>' Traverse columns applying redding until hitting the row end, Comment, or SpGr: whichever comes first\nFor currIndex = abcDateCol + 1 To lastCol\n    ' Check for exit conditions:\n    If Cells(abcDateRowDesc, currIndex).Value() = \"Comments\" Then Exit For\n\n    If Cells(abcDateRowDesc, currIndex).Value() &lt;&gt; \"\" Then\n        If Cells(abcDateRowDesc, currIndex + 1).Value() = \"process\" Then\n            ' Looks like we have a column of something Red-able\n            'Columns(ColumnLetter(currIndex) &amp; \":\" &amp; ColumnLetter(currIndex + 1)).Select\n            With Range(Cells(abcDateRowDesc, currIndex), Cells(abcDateRowDesc, currIndex + 1).End(xlDown))\n                .AutoFilter 2, \"=1\", xlOr, \"=e\"\n                ' Don't format header\n                With .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count)                         .Font.ColorIndex = 3\n                    .Font.Bold = True\n                    .AutoFilter ' Turn off autofiltering\n                End With\n            End With\n            Columns(currIndex + 1).Delete xlShiftLeft\n        End If\n    End If\nNext currIndex\n</code></pre>\n\n<p>This all starts with a quirk of how the code is choosing its range to autofilter. The selected area is the full column, instead of the area you actually want to format (row 18 to the last entry). It seems that autofiltering on a full column with empty top rows automatically sets the first nonempty row as the header row. So the header is left unfiltered/unhidden by the statement, and it gets colored in as part of the full column selection. So that's why your headers are getting colored.</p>\n\n<p>Now, if you tried to test this by putting data in the above empty rows like \"a\", those values would become the first ones in the column and would be selected as the headers - meaning <em>those</em> values get colored. <em>Whatever is in the first nonempty row of your columns will be the autofilter header and will get colored.</em></p>\n\n<p>But that should only affect the columns you explicitly colored, not the entirety of the first row, right? The problem here is that Excel likes to make assumptions about data in order to save time. So if you have a whole row full of red, bold <strong>\"a\"</strong>'s and right next to them you put in another \"a\" to test whether that cell is formatted or not... well, it automatically gives you a red, bold <strong>\"a\"</strong> despite the cell being previously unformatted! And if you keep going down the row in this way, it'll appear like your whole row got formatted. But, if you were to jump over a few columns (say, 5-ish) and enter in another \"a\", voila, it's unformatted, and any \"a\"s you put in near it will be too. You can also check what Excel by deleting an unformatted \"a\" in a far off column, then continuing to enter <strong>\"a\"</strong>'s all the way down until you reach that same cell - <em>this time, the <strong>\"a\"</strong> will be red and bold because all of the others in the row were, too, even though we just checked that this was an unformatted cell!</em></p>\n\n<p>Basically, having the wrong range for your autofilter made things act very unexpectedly, then trying to test the formatting issue by entering in values just made everything less clear. The code I've provided just autofilters the relevant area (row 17 to the last contiguous row), fixing the core issue.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 749468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f08a3952dda762e909cf88c941f415c?s=128&d=identicon&r=PG", "display_name": "jefff", "link": "https://stackoverflow.com/users/749468/jefff"}, "edited": false, "score": 0, "creation_date": 1470943030, "post_id": 38883810, "comment_id": 65167556, "body": "Winner winner, chicken dinner. This solution worked for my case, and I tested it across all my other spreadsheets with success. I&#39;m still mentally chewing on some of your solution&#39;s details. Your first bullet point I was aware of (I mentioned it in my <b>Let&#39;s Continue</b> section). This autofilter thing feels too weird for my tastes."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 73, "user_id": 749468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f08a3952dda762e909cf88c941f415c?s=128&d=identicon&r=PG", "display_name": "jefff", "link": "https://stackoverflow.com/users/749468/jefff"}, "edited": false, "score": 0, "creation_date": 1470975866, "post_id": 38883810, "comment_id": 65177580, "body": "Yes, weird but quite useful. Glad to see it helped. Good coding!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1470864263, "creation_date": 1470864263, "answer_id": 38883810, "question_id": 38882019, "link": "https://stackoverflow.com/questions/38882019/excel-vba-script-filters-header-unexpectedly/38883810#38883810", "title": "Excel VBA script filters header unexpectedly", "body": "<p>here's a (commented) refactoring of your code that should do:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim abcDateCol As Long, lastCol As Long, abcDateRow As Long, abcDateRowDesc As Long, currIndex As Long\n\n    abcDateCol = 31\n    lastCol = 43\n    abcDateRow = 16 '&lt;--| you can change it to 1 for the last \"scenario\"\n    abcDateRowDesc = 17 '&lt;--| you can change it to 2 for the last \"scenario\"\n\n\n    For currIndex = abcDateCol + 1 To lastCol '&lt;--| loop through columns\n        With Cells(abcDateRow, currIndex) '&lt;--| refer to cell in current column on row abcDateRow\n            If .Value = \"Comments\" Then Exit For '&lt;--| Check for exit conditions on row 'abcDateRow'\n\n            If .Offset(1).Value &lt;&gt; \"\" And .Offset(1, 1).Value = \"process\" Then '&lt;--| Check for processing conditions on row 'abcDateRowDesc'\n                With .Resize(.Offset(, 1).End(xlDown).Row - .Row + 1, 2) '&lt;-- consider the range from current referenced cell 1 column to the right and down to last 'process' number/letter\n                    .AutoFilter Field:=2, Criteria1:=\"=1\", Operator:=xlOr, Criteria2:=\"=e\" '&lt;--| filter on \"process\" field with \"1\" or \"e\"\n                    If Application.WorksheetFunction.Subtotal(103, .Cells.Resize(, 1)) &gt; 1 Then '&lt;--| if any values match...\n                        With .Offset(2).Resize(.Rows.Count - 2, 1).SpecialCells(xlCellTypeVisible).Font '&lt;--|... consider only filtered values skipping headers (2 rows), and apply formatting\n                            .ColorIndex = 3\n                            .Bold = True\n                        End With\n                    End If\n                    .AutoFilter '&lt;-- reset autofilter\n                    .Resize(, 1).Offset(, 1).EntireColumn.Delete Shift:=xlToLeft '&lt;-- delete the \"2nd\" column (i.e. one column offsetted to the right)\n                End With\n            End If\n        End With\n    Next currIndex\nEnd Sub\n</code></pre>\n\n<p>there were two faults in your \"inherited\" code:</p>\n\n<ul>\n<li><p><code>If Cells(abcDateRowDesc, currIndex).Value() = \"Comments\" Then Exit For</code> was to be referred to <code>abcDateRow</code> index row instead</p></li>\n<li><p>the formatting would be applied to all cells, were they filtered (matching) or not</p></li>\n</ul>\n"}], "owner": {"reputation": 73, "user_id": 749468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f08a3952dda762e909cf88c941f415c?s=128&d=identicon&r=PG", "display_name": "jefff", "link": "https://stackoverflow.com/users/749468/jefff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 38883810, "answer_count": 2, "score": 1, "last_activity_date": 1470941718, "creation_date": 1470857514, "last_edit_date": 1531164843, "question_id": 38882019, "link": "https://stackoverflow.com/questions/38882019/excel-vba-script-filters-header-unexpectedly", "title": "Excel VBA script filters header unexpectedly", "body": "<p><strong>Introduction</strong></p>\n\n<p>I have some spreadsheets like the following.</p>\n\n<p><a href=\"https://i.stack.imgur.com/elScd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/elScd.png\" alt=\"original data after script execution\"></a></p>\n\n<p>Here the header is on rows 16 and 17. There is a \"header\" to the left (not shown) among the earlier rows and columns that includes a picture, some non-tabular data, a legend, etc., that is unimportant here. Header text on row 16 is obfuscated because <em>reasons</em>. Data marked in bold red indicates that that sample point has undergone some process. Here is the code snippet from the script that highlights those data points in bold red.</p>\n\n<pre><code>' Traverse columns applying redding until hitting the row end, Comment, or SpGr: whichever comes first\nFor currIndex = abcDateCol + 1 To lastCol\n  ' Check for exit conditions:\n  If Cells(abcDateRowDesc, currIndex).Value() = \"Comments\" Then Exit For\n\n  If Cells(abcDateRowDesc, currIndex).Value() &lt;&gt; \"\" Then\n    If Cells(abcDateRowDesc, currIndex + 1).Value() = \"process\" Then\n      ' Looks like we have a column of something Red-able\n      Columns(ColumnLetter(currIndex) &amp; \":\" &amp; ColumnLetter(currIndex + 1)).Select\n      Selection.AutoFilter ' Turn on autofiltering (hopefully)\n      Selection.AutoFilter Field:=2, Criteria1:=\"=1\", Operator:=xlOr, Criteria2:=\"=e\"\n      Selection.Font.ColorIndex = 3\n      Selection.Font.Bold = True\n      Selection.AutoFilter ' Turn off autofiltering\n      Columns(ColumnLetter(currIndex + 1) &amp; \":\" &amp; ColumnLetter(currIndex + 1)).EntireColumn.Delete Shift:=xlToLeft\n    End If\n  End If\nNext currIndex\n</code></pre>\n\n<p><strong>Context</strong></p>\n\n<p>Here, <code>abcDateCol</code> refers to column AE, <code>lastCol</code> refers to column AQ, <code>abcDateRow</code> (not shown, but available) and <code>abcDateRowDesc</code> refer to the header rows 16 and 17 respectively, and the <code>ColumnLetter</code> function is a user-defined function that returns the human-readable column letter(s) given a column number; this is common functionality you may have seen elsewhere, or even made yourself.</p>\n\n<p><strong>Let's Continue</strong></p>\n\n<p>Never mind that the condition in <code>If Cells(abcDateRowDesc, currIndex).Value() = \"Comments\"</code> is never satisfied because of an oversight (I'm assuming) -- two different rows, guaranteed.</p>\n\n<p>Let's take a look at what the spreadsheet looks like before this script is executed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/F85Et.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F85Et.png\" alt=\"original data before script execution\"></a></p>\n\n<p>So, the script takes pairs of columns, and for each pair of columns it marks data cells bold red if a data cell's right-adjacent cell has a 1 (or an \"e\"?) (as a boolean; answers the question, \"Has this sample point undergone whatever process?\") and then trashes the \"process\" column.</p>\n\n<p><strong>The Problem</strong></p>\n\n<p>A client wants the gratuitous header gone, so they may more easily import the spreadsheet into whatever solution they have. Delete rows 1 through 15, and this is what I get.</p>\n\n<p><a href=\"https://i.stack.imgur.com/R6zBB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R6zBB.png\" alt=\"enter image description here\"></a></p>\n\n<p>What in the bleepity-bleep happened to the header? I don't understand how this first row gets highlighted. It seems too perfectly weird. Now, let's revisit the very first spreadsheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cRf0S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cRf0S.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've filled the \"header\" with some dummy text after the script executed. Wow, there's the first row reddened again, this time <em>ad infinitum</em>! So, this problem has always existed. Oh, and the first column, too! And, it magically stops right above the proper header so we would never see it.</p>\n\n<p><strong>The Questions</strong></p>\n\n<p>Why is this script unexpectedly reddening the first row and column? Can this be easily solved, or am I looking at some sort of a rewrite? If so, please point me in the general direction.</p>\n\n<p>It helps to mention that these spreadsheets are generated from a Windows application and their scripts executed before a user has a copy of their spreadsheet. Also, regarding the second picture (the spreadsheet with the \"process\" columns shown), this spreadsheet is not something that normally exists. I generated it for the sake of this post by skipping the script's <code>for</code> loop. The application uses a chosen spreadsheet template, that looks the same minus the data, fills in the sample data, and then executes several scripts over the data.</p>\n\n<p>I considered using conditional formatting, but there are a few dozen spreadsheet templates. Even if I just change the one I need, I can't change the fact that these common scripts run over it. I feel my best option is to correct the script. And, I wouldn't change the script to account for my edge case. The whole ecosystem feels flaky, but that's just subjective.</p>\n\n<p><strong>Note</strong></p>\n\n<p>I am not the author of this script (or any of my company's VBA!). I'm considering this an inheritance tax levied upon me.</p>\n\n<p><strong>*Update</strong></p>\n\n<p>I was asked if I traced through this code. I apologize that I didn't include that information in my original post. Here is what I know. <code>Selection.Font.ColorIndex = 3</code> turns the cells in the selection that satisfy the autofilter plus the first row (two cells as only two columns are selected at a given time), and <code>Selection.Font.Bold = True</code> makes the same cells bold in the same manner. I suspect it has something to do with the autofilter, so I'm going to take a look at the answers now.</p>\n"}, {"tags": ["vba", "ms-access", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "edited": false, "score": 1, "creation_date": 1470858418, "post_id": 38882071, "comment_id": 65125572, "body": "All I had to do was change the column widths from 0&quot;;2&quot; to 1&quot;:2&quot; and it gave me what I wanted. Other than that perfect!"}], "tags": [], "owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "is_accepted": true, "score": 1, "last_activity_date": 1470858849, "last_edit_date": 1470858849, "creation_date": 1470857710, "answer_id": 38882071, "question_id": 38881988, "link": "https://stackoverflow.com/questions/38881988/return-multiple-different-fields-as-list-item-in-listbox-ms-access-2013-vba/38882071#38882071", "title": "Return multiple different fields as list item in listbox ms-access 2013 VBA", "body": "<p>This is possible, you just need to configure the listbox for this. Under the Property Sheet in the Access form for the listbox change the following:</p>\n\n<ul>\n<li>Change the \"Column Count\" to 2</li>\n<li>Set \"Column Widths\" to 1\";2\"</li>\n<li>Make sure \"Bound Column\" is 1</li>\n</ul>\n"}], "owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 38882071, "answer_count": 1, "score": 1, "last_activity_date": 1470858849, "creation_date": 1470857355, "question_id": 38881988, "link": "https://stackoverflow.com/questions/38881988/return-multiple-different-fields-as-list-item-in-listbox-ms-access-2013-vba", "title": "Return multiple different fields as list item in listbox ms-access 2013 VBA", "body": "<p>I have a listbox called \"lbItems\" which is set to the RowSource property of \"Table/query\". I have an VBA statement which runs a query that selects \"lineItem\" from a table and this populates the listbox with the lineItems as seen below:</p>\n\n<pre><code>Me.lbItems.RowSource = \"SELECT lineItem FROM Table1\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/v6LxK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v6LxK.png\" alt=\"enter image description here\"></a></p>\n\n<p>This doesn't give me any information about the lineItems however, that is found in the field \"description\". I want to use an VBA statement which runs an SQL query like this: </p>\n\n<pre><code>Me.lbItems.RowSource = \"SELECT lineItem, Description FROM Table1\"\n</code></pre>\n\n<p>I would like the above statement to populate my listbox with the lineItem, and right beside it, the description with a pipe \"|\" character in between.</p>\n\n<p>This is the problem though. If you choose a different RowSource for the listbox, then you are able to concatenate strings and put whatever you would like as a list item which is what I want to do. But, with RowSource set to table/query, I can only use queries to set the list items. </p>\n\n<p>Question 1: Is there any way to mix both of the above methods together? So to combine SQL statements and my own operations to populate the listbox?</p>\n\n<p>Question 2: If there isn't a way to do what was asked in Question 1, can I select more than 1 field with my SQL statement and set BOTH of those fields to the list item?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 2, "creation_date": 1470857431, "post_id": 38881866, "comment_id": 65125050, "body": "It sounds like you are going to want to use a VLOOKUP function, not necessarily vba. <a href=\"http://www.gcflearnfree.org/excel-tips/how-to-use-excels-vlookup-function/1/\" rel=\"nofollow noreferrer\">This</a> might help a bit. <a href=\"https://support.office.com/en-us/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1\" rel=\"nofollow noreferrer\">Microsoft Support</a> can help as well."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6701911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02acec57e94535a16e5ca26398a9598?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Ford", "link": "https://stackoverflow.com/users/6701911/henry-ford"}, "edited": false, "score": 0, "creation_date": 1470930687, "post_id": 38882501, "comment_id": 65160793, "body": "Thanks for your answer but using VLOOKUP and copying it downwards would overwrite cells without updates. Lets say D2 down to D5 have updates then D6 does not then D7 down to D10 have updates. If i use VLOOKUP and copy it from D2-D10, D6 would return #NA. Now that seems to be okay but my actual file has approximately 5000 lines so it would generate more #NA cells. Also in this case Col D (the column which updates are put) is the only unprotected cell so all other columns cannot be edited. Again, thanks for your time."}], "tags": [], "owner": {"reputation": 1157, "user_id": 1908616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3109b05827590cceef3d7c87ba31ab42?s=128&d=identicon&r=PG", "display_name": "Ulli Schmid", "link": "https://stackoverflow.com/users/1908616/ulli-schmid"}, "is_accepted": false, "score": 0, "last_activity_date": 1470859291, "creation_date": 1470859291, "answer_id": 38882501, "question_id": 38881866, "link": "https://stackoverflow.com/questions/38881866/updating-specific-cells-based-on-another-file/38882501#38882501", "title": "Updating specific cells based on another file", "body": "<p>Assuming your reference numbers are in column A and \"three to the right\" means column D -</p>\n\n<p>into cell D2 of file a, enter (after adding your own path, filename and sheetname):</p>\n\n<pre><code>=VLOOKUP(A2,'C:\\path\\to\\[file_b.xlsx]sheet_name'!$A$1:$D$1000,4,FALSE)\n</code></pre>\n\n<p>then copy D2 downwards.</p>\n"}], "owner": {"reputation": 1, "user_id": 6701911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02acec57e94535a16e5ca26398a9598?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Ford", "link": "https://stackoverflow.com/users/6701911/henry-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470862773, "creation_date": 1470856873, "last_edit_date": 1470862773, "question_id": 38881866, "link": "https://stackoverflow.com/questions/38881866/updating-specific-cells-based-on-another-file", "title": "Updating specific cells based on another file", "body": "<p>So I have two excel files and file A is the mother file and file B contains updates to some cells. What I want is to update file A with the updates in file B. Each line in the file has a reference number, that reference number is used to identify which line in file A should be updated.</p>\n\n<p>Basically this is the manual process:</p>\n\n<ol>\n<li>Copy the reference number in file B</li>\n<li>find the copied reference in file A</li>\n<li>go back to file B and copy the adjacent cell (three cells to the right)</li>\n<li>paste the copied data in file A in the same cell (three cells to the right)</li>\n<li>go back to file B and copy the next reference number</li>\n<li>repeat step 2 - 5 until last line in file B</li>\n</ol>\n"}, {"tags": ["vba", "string", "fonts", "colors", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6701879, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6ZUqU9gyZ1M/AAAAAAAAAAI/AAAAAAAAAEw/12tDhbCzBdY/photo.jpg?sz=128", "display_name": "Federico Salinas", "link": "https://stackoverflow.com/users/6701879/federico-salinas"}, "edited": false, "score": 0, "creation_date": 1470941641, "post_id": 38882481, "comment_id": 65166732, "body": "Thanks a lot! and what about if text is not equal to HOLA but a value taken from excel: {text=cell.Value}"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 13, "user_id": 6701879, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6ZUqU9gyZ1M/AAAAAAAAAAI/AAAAAAAAAEw/12tDhbCzBdY/photo.jpg?sz=128", "display_name": "Federico Salinas", "link": "https://stackoverflow.com/users/6701879/federico-salinas"}, "edited": false, "score": 0, "creation_date": 1471018879, "post_id": 38882481, "comment_id": 65201702, "body": "@FedericoSalinas you can concatenate HTML parts and the variable value, I added to the answer."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 2, "last_activity_date": 1471000118, "last_edit_date": 1471000118, "creation_date": 1470859207, "answer_id": 38882481, "question_id": 38881713, "link": "https://stackoverflow.com/questions/38881713/how-to-change-font-color-of-a-string-that-im-using-in-an-outlook-message/38882481#38882481", "title": "How to change font color of a string that im using in an outlook message?", "body": "<p>Since you are using HTML, you can put the text into eg <code>&lt;span&gt;</code> node, add <a href=\"http://www.w3schools.com/html/html_styles.asp\" rel=\"nofollow\"><code>style</code> attribute</a>, and set <a href=\"http://www.w3schools.com/cssref/pr_text_color.asp\" rel=\"nofollow\"><code>color</code></a> and <a href=\"http://www.w3schools.com/cssref/pr_font_font.asp\" rel=\"nofollow\"><code>font</code></a> properties:</p>\n\n<pre><code>text = cell.Value\nhtmlcontent = \"&lt;span style='color: red; font: 15px arial, sans-serif;'&gt;\" &amp; text &amp; \"&lt;/span&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6701879, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6ZUqU9gyZ1M/AAAAAAAAAAI/AAAAAAAAAEw/12tDhbCzBdY/photo.jpg?sz=128", "display_name": "Federico Salinas", "link": "https://stackoverflow.com/users/6701879/federico-salinas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3080, "favorite_count": 1, "accepted_answer_id": 38882481, "answer_count": 1, "score": 1, "last_activity_date": 1593416098, "creation_date": 1470856253, "last_edit_date": 1593416098, "question_id": 38881713, "link": "https://stackoverflow.com/questions/38881713/how-to-change-font-color-of-a-string-that-im-using-in-an-outlook-message", "title": "How to change font color of a string that im using in an outlook message?", "body": "<p>I have a string object :</p>\n\n<pre><code>Dim text As String\n\ntext=\"HOLA\"\n</code></pre>\n\n<p>and then im using it in a mail body like this:</p>\n\n<pre><code>Set OutMail = OutApp.CreateItem(0)\n    With OutMail\n        .Display\n        .To = correo\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"greetings\" \n        .HTMLBody = Msg &amp; text &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\" &amp; text2 \n        .Send\n    End With\n</code></pre>\n\n<p>I want to change the font color, style and size of the \"text\" variable.</p>\n\n<p>Thanks a lot, I hope you can help me</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 3, "creation_date": 1470856261, "post_id": 38881634, "comment_id": 65124436, "body": "You should read <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid select</a>. Select causes nothing but headaches. Also, you need to loop in reverse to delete rows."}], "answers": [{"comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 2, "creation_date": 1470856391, "post_id": 38881720, "comment_id": 65124499, "body": "That may be part of the issues, but is not the main culprit. You shouldn&#39;t delete rows looping forward as you will not being doing what you would expect."}, {"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "edited": false, "score": 1, "creation_date": 1470856632, "post_id": 38881720, "comment_id": 65124632, "body": "That actually was my problem, but I could not use that exact fix. I just forgot to add the <code>CRow = 1 + 1</code> in the TRUE scenario as well. I need the variable number because once I delete, I need to go backwards to check  if the cell in B is still blank. If so, it needs to run again. All that to say, <code>cell.text</code> would not work here, but thank you, as it led me to figuring out the issue."}, {"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1470856662, "post_id": 38881720, "comment_id": 65124647, "body": "@Kyle that&#39;s why there&#39;s a <code>crow = crow -1</code>. It accounts for deletions."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1470862013, "post_id": 38881720, "comment_id": 65127414, "body": "@cyboashu Sorry I am trying to help the OP produce better code. Deleting rows in a forward loop is horrible practice, as is using select, and both will only serve to bite the OP in the ass later. Sorry I was trying to be over smart, though."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "edited": false, "score": 1, "creation_date": 1470863881, "post_id": 38881720, "comment_id": 65128276, "body": "@Excellerator I am not a programmer either, just use it to make my job easier. I also produced tons of code early on that used <code>.Select</code> and didn&#39;t immediately cause issues, but later did. I highly recommend not using it regardless of having no consequences here. I will post an answer with the code cleaned up to take out select and loop in reverse. I think you will agree it is easier to read, even if you don&#39;t care at all."}, {"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1470863957, "post_id": 38881720, "comment_id": 65128320, "body": "@Kyle, well that would be greatly appreciated for learning purposes."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1470856288, "creation_date": 1470856288, "answer_id": 38881720, "question_id": 38881634, "link": "https://stackoverflow.com/questions/38881634/vba-selecting-cells-when-it-shouldnt-with-if-range-text-true/38881720#38881720", "title": "VBA Selecting cells when it shouldn&#39;t with IF Range.Text = &quot;True&quot;?", "body": "<p>BECAUSE of this</p>\n\n<pre><code>CRow = 1\nFor Each cell In Range(\"G1:G\" &amp; lastrow)\nIf Range(\"G\" &amp; CRow).Text = \"TRUE\" Then\n</code></pre>\n\n<p>You are assiging 1 to CRow and using that in each iteration. So actually you are always testing Just Row 1.\nChange <code>Range(\"G\" &amp; CRow).Text</code> to  <code>cell.Text</code></p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "edited": false, "score": 0, "creation_date": 1470865589, "post_id": 38883964, "comment_id": 65129007, "body": "You&#39;re definitely right, that is a lot easier to read! I would have a hard time testing it since I changed the code. I have never seen anyone use for <code>T = 1 to lastrow</code> before... That is so much easier than <code>for each cell in</code>. Can I post what I ended up coming up with and after I try to remove all that and see what you think?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "edited": false, "score": 0, "creation_date": 1470867255, "post_id": 38883964, "comment_id": 65129602, "body": "Yes, please do. Happy to answer any questions you have about the code above."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1470864894, "creation_date": 1470864894, "answer_id": 38883964, "question_id": 38881634, "link": "https://stackoverflow.com/questions/38881634/vba-selecting-cells-when-it-shouldnt-with-if-range-text-true/38883964#38883964", "title": "VBA Selecting cells when it shouldn&#39;t with IF Range.Text = &quot;True&quot;?", "body": "<p>See below example to delete the same group of cells using a reverse loop and not selecting. I believe I interpreted, and thus changed, this line properly <code>ActiveCell.Offset(2, 0).Select</code>, but let me know if I'm mistaken and it doesn't function as expected.</p>\n\n<pre><code>Range(\"G1\").FormulaR1C1 = _\n\"=IF(OR(ISNUMBER(SEARCH(\"\"GS \"\",RC[-6])),ISNUMBER(SEARCH(\"\"@\"\",RC[-6]))),\"\"TRUE\"\",\"\"FALSE\"\")\"\nRange(\"G1\").AutoFill Destination:=Range(\"G1:G\" &amp; lastrow)\n\nWith Range(\"G1:G\" &amp; lastrow)\n    .Value = .Value\nEnd With\n\nDim T As Integer\n\nFor T = 1 to lastrow Step -1\n    Set cell = Range(\"G\" &amp; T)\n    If cell.Text = \"TRUE\" Then\n        If cell.offset(0,-5) = \"\" Then\n            cell.Offset(0,-5).Resize(,4).Delete Shift=xlUp\n            Range(\"G\" &amp; T + 2).Insert Shift:=xlDown CopyOrigin:=xlFormatFromLeftOrAbove\n        End If\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 38881720, "answer_count": 2, "score": 0, "last_activity_date": 1470865969, "creation_date": 1470855954, "last_edit_date": 1470856226, "question_id": 38881634, "link": "https://stackoverflow.com/questions/38881634/vba-selecting-cells-when-it-shouldnt-with-if-range-text-true", "title": "VBA Selecting cells when it shouldn&#39;t with IF Range.Text = &quot;True&quot;?", "body": "<p>I have the following code, which is a work in progress, but VBA keeps saying the <code>If Range(\"G\"&amp;CRow).text = \"True\" then</code> is true in the highlighted row, when it obviously isn't. Can anyone help me figure this out?</p>\n\n<p><a href=\"https://i.stack.imgur.com/P4k56.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P4k56.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Range(\"G1\").FormulaR1C1 = _\n\"=IF(OR(ISNUMBER(SEARCH(\"\"GS \"\",RC[-6])),ISNUMBER(SEARCH(\"\"@\"\",RC[-6]))),\"\"TRUE\"\",\"\"FALSE\"\")\"\nRange(\"G1\").AutoFill Destination:=Range(\"G1:G\" &amp; lastrow)\n\nWith Range(\"G1:G\" &amp; lastrow)\n    .Value = .Value\nEnd With\n\nDim T As Integer\nDim CRow As Integer\nCRow = 1\n\nFor Each cell In Range(\"G1:G\" &amp; lastrow)\n    If Range(\"G\" &amp; CRow).Text = \"TRUE\" Then\n        cell.Select\n        ActiveCell.Offset(0, -5).Select\n\n        If Selection.Value = \"\" Then\n            Selection.Resize(, 4).Select\n            Selection.Delete Shift:=xlUp\n            ActiveCell.Offset(2, 0).Select\n            Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n            CRow = CRow - 1\n        End If\n    Else\n        CRow = CRow + 1\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "calendar"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 6692697, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HrLLNAvZ-Y0/AAAAAAAAAAI/AAAAAAAAEf0/Rk9ftIl_E_c/photo.jpg?sz=128", "display_name": "Joshua Bryant", "link": "https://stackoverflow.com/users/6692697/joshua-bryant"}, "is_accepted": true, "score": 0, "last_activity_date": 1553180394, "last_edit_date": 1553180394, "creation_date": 1470861870, "answer_id": 38883193, "question_id": 38881349, "link": "https://stackoverflow.com/questions/38881349/loading-appointments-to-a-non-default-outlook-calendar-from-excel/38883193#38883193", "title": "Loading appointments to a non-default Outlook calendar from Excel", "body": "<p><strong>I figured it out:</strong></p>\n\n<pre><code>Sub Create_Outlook_2()\n\n    Dim oApp As Object\n    Dim oNameSpace As Namespace\n    Dim oFolder As Object\n    Dim wsSrc As Worksheet\n    Set wsSrc = Sheets(\"Leave Table\")\n    ' Start looping at row 3 (first two rows are for readability)\n    r = 3\n    ' Do/while set condition\n    Do Until Trim(wsSrc.Cells(r, 1).Value) = \"\"\n\n        ' Create the Outlook session\n        Set oApp = New Outlook.Application\n        ' Set the namespace\n        Set oNameSpace = oApp.GetNamespace(\"MAPI\")\n        ' Set the folder the appointment will be created in.\n        Set oFolder = oNameSpace.GetFolderFromID(\"Folder ID Number\").Items.Add(olAppointmentItem)\n\n        ' Set with block for the appointment configuration loop\n        With oFolder\n           ' Set Subject line of event\n            .Subject = wsSrc.Cells(r, 1).Value &amp; \" \" &amp; wsSrc.Cells(r, 2).Value\n           ' Set start time\n            .Start = DateValue(wsSrc.Cells(r, 3)) + wsSrc.Cells(r, 8).Value\n           ' Set end time\n            .End = DateValue(wsSrc.Cells(r, 3)) + wsSrc.Cells(r, 9).Value\n           ' Turn reminders off\n            .ReminderSet = False\n           ' Set busy status to free\n            .BusyStatus = 0\n           ' Have the body of the event read as the decription from the leave form in Viewpoint\n            .Body = wsSrc.Cells(r, 4).Value\n           ' Save event in owners calendar\n            .Save\n           ' End with block\n        End With\n       ' Move to next row\n        r = r + 1\n       ' Repeat do/while loop until condition is no longer valid\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>To get Folder ID #:</p>\n\n<p><strong>With the calendar you want to create appointments in selected</strong> (open it in a new window for good measure), press F11 to bring up Outlook macros and run the following code under \"ThisOutlookSession\":</p>\n\n<pre><code>Private Sub GetOutlookFolderID()\n     'Determines the Folder ID of Folder\n    Dim olfolder As Outlook.MAPIFolder\n    Dim olapp As Outlook.Application\n    Set olapp = CreateObject(\"Outlook.Application\")\n    Set olfolder = olapp.GetNamespace(\"MAPI\").PickFolder\n    olfolder.Display\n    MsgBox (olfolder.EntryID)\n    Set olfolder = Nothing\n    Set olapp = Nothing\nEnd Sub\n</code></pre>\n\n<p>Sample spreadsheet - with fake names:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ANNSM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ANNSM.jpg\" alt=\"SPREADSHEET I AM USING\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1471710134, "creation_date": 1471710134, "answer_id": 39056319, "question_id": 38881349, "link": "https://stackoverflow.com/questions/38881349/loading-appointments-to-a-non-default-outlook-calendar-from-excel/39056319#39056319", "title": "Loading appointments to a non-default Outlook calendar from Excel", "body": "<p>If you want to create an appointment in Outlook, using Excel, run the script below.</p>\n\n<pre><code>Private Sub Add_Appointments_To_Outlook_Calendar()\n\n    'Include Microsoft Outlook nn.nn Object Library from Tools -&gt; References\n    Dim oAppt As AppointmentItem\n    Dim Remind_Time As Double\n\n    i = 2\n    Subj = ThisWorkbook.Sheets(1).Cells(i, 1)\n\n    'Loop through entire list of Reminders to be added\n    While Subj &lt;&gt; \"\"\n        Set oAppt = Outlook.Application.CreateItem(olAppointmentItem)\n\n        oAppt.Subject = Subj\n        oAppt.Location = ThisWorkbook.Sheets(1).Cells(i, 2)\n        oAppt.Start = ThisWorkbook.Sheets(1).Cells(i, 3)\n        Remind_Time = ThisWorkbook.Sheets(1).Cells(i, 4) * 1 * 60\n        oAppt.ReminderMinutesBeforeStart = Remind_Time\n        oAppt.AllDayEvent = True\n        oAppt.Save\n\n        i = i + 1\n        Subj = ThisWorkbook.Sheets(1).Cells(i, 1)\n    Wend\n    MsgBox \"Reminder(s) Added To Outlook Calendar\"\n\nEnd Sub\n</code></pre>\n\n<p>' The code comes from this link:\n <a href=\"http://officetricks.com/add-appointment-to-outlook-calendar-through-excel-macro-vba/\" rel=\"nofollow noreferrer\">http://officetricks.com/add-appointment-to-outlook-calendar-through-excel-macro-vba/</a></p>\n\n<p>The script is run from Excel, and as such, you must set a reference to Outlook before you run the code.  Also, notice that the worksheet needs to be setup properly for the script to run.  It should look something like this.  Everything is read from Excel into Outlook.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MtnQs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MtnQs.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7788639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7630ebeb5d2993a344e216e0dd2d10?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/7788639/brett"}, "is_accepted": false, "score": 0, "last_activity_date": 1491499267, "creation_date": 1491499267, "answer_id": 43261893, "question_id": 38881349, "link": "https://stackoverflow.com/questions/38881349/loading-appointments-to-a-non-default-outlook-calendar-from-excel/43261893#43261893", "title": "Loading appointments to a non-default Outlook calendar from Excel", "body": "<p>There's an additional way to access the folder instead of getting the ID:</p>\n\n<pre><code>    Set oFolder = oNameSpace.Folders.Item(\"account address\").Folders.Item(\"Calendar\").Items.Add(olAppointmentItem)\n</code></pre>\n\n<p>Where \"account address\" is the email address of the account</p>\n\n<p>Additionally, I'm working with multiple outlook.com calendars and found that you can do the following to access one of the non-default calendars:</p>\n\n<pre><code>Set oFolder = oNameSpace.Folders.Item(\"account address\").Folders.Item(\"Calendar\").Folders.Item(\"Other calendar name\").Items.Add(olAppointmentItem)\n</code></pre>\n\n<p>Couldn't have done any of this without your post, Joshua.  Thanks!</p>\n"}], "owner": {"reputation": 93, "user_id": 6692697, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HrLLNAvZ-Y0/AAAAAAAAAAI/AAAAAAAAEf0/Rk9ftIl_E_c/photo.jpg?sz=128", "display_name": "Joshua Bryant", "link": "https://stackoverflow.com/users/6692697/joshua-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4722, "favorite_count": 1, "accepted_answer_id": 38883193, "answer_count": 3, "score": 1, "last_activity_date": 1553205402, "creation_date": 1470855091, "last_edit_date": 1553205402, "question_id": 38881349, "link": "https://stackoverflow.com/questions/38881349/loading-appointments-to-a-non-default-outlook-calendar-from-excel", "title": "Loading appointments to a non-default Outlook calendar from Excel", "body": "<p>I have a project to put employees leave schedules into a shared or global calendar.</p>\n\n<p>The appointments save to my default calendar.</p>\n\n<p>I have tried a few different approaches. This is the current approach:</p>\n\n<pre><code>Sub Create_Outlook_2()\n' Create the Outlook session\n\nDim oApp As Object\nDim oNameSpace As Namespace\nDim oFolder As Object\nDim myApt As AppointmentItem\n\nSet oApp = New Outlook.Application\nSet oNameSpace = oApp.GetNamespace(\"MAPI\")\nSet oFolder = oNameSpace.GetFolderFromID(\"000000007CF129E6C6BAA74F9B2AB399FABB280E01006EC36FFC70429B4EAE1875321A4609670078C4FA00320000\").Items.Add(olAppointmentItem)\n\nWith oFolder\n'    Set myOutlook = CreateObject(\"Outlook.Application\")\n'    ' Set data collection to take from \"Leave Table\" sheet\n    Dim wsSrc As Worksheet\n    Set wsSrc = Sheets(\"Leave Table\")\n    ' Start looping at row 3 (first two rows are for readability)\n    r = 3\n    ' Do/while set condition\n    Do Until Trim(wsSrc.Cells(r, 1).Value) = \"\"\n        ' Create event item\n        Set myApt = oApp.CreateItem(1)\n        ' Set the event properties\n        ' Set Subject line of event\n        With myApt\n            .Subject = \"Time Off \" &amp; wsSrc.Cells(r, 1).Value &amp; \" \" &amp; wsSrc.Cells(r, 2).Value\n           ' Set start time\n            .Start = DateValue(wsSrc.Cells(r, 3)) + wsSrc.Cells(r, 8).Value\n           ' Set end time\n            .End = DateValue(wsSrc.Cells(r, 3)) + wsSrc.Cells(r, 9).Value\n           ' Turn reminders off\n            .ReminderSet = False\n           ' Set busy status to free\n            .BusyStatus = 0\n           ' Have the body of the event read as the decription from the leave form in Viewpoint\n            .Body = wsSrc.Cells(r, 4).Value\n           ' Save event in owners calendar\n            .Save\n\n        End With\n       ' Move to next row\n        r = r + 1\n       ' Repeat do/while loop until condition is no longer valid\n    Loop\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1157, "user_id": 1908616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3109b05827590cceef3d7c87ba31ab42?s=128&d=identicon&r=PG", "display_name": "Ulli Schmid", "link": "https://stackoverflow.com/users/1908616/ulli-schmid"}, "edited": false, "score": 4, "creation_date": 1470856500, "post_id": 38881083, "comment_id": 65124554, "body": "Please show at least some effort of trying to solve a problem on your own.."}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "reply_to_user": {"reputation": 1157, "user_id": 1908616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3109b05827590cceef3d7c87ba31ab42?s=128&d=identicon&r=PG", "display_name": "Ulli Schmid", "link": "https://stackoverflow.com/users/1908616/ulli-schmid"}, "edited": false, "score": 0, "creation_date": 1470870431, "post_id": 38881083, "comment_id": 65130501, "body": "Thanks @UlliSchmid"}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1470858551, "post_id": 38881317, "comment_id": 65125635, "body": "@LoganReed To be blunt, it is only because I am not familiar with that method. If it works, then that&#39;s great! I just haven&#39;t used it before."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 1, "creation_date": 1470858724, "post_id": 38881317, "comment_id": 65125726, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Here you go</a>. It is well worth your time!"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1470860611, "post_id": 38881317, "comment_id": 65126704, "body": "Thanks for taking the time to help"}], "tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": true, "score": 2, "last_activity_date": 1470854969, "creation_date": 1470854969, "answer_id": 38881317, "question_id": 38881083, "link": "https://stackoverflow.com/questions/38881083/comparing-3-columns-and-deleting-duplicates-vba/38881317#38881317", "title": "Comparing 3 Columns and Deleting duplicates vba", "body": "<p>This will clear duplicate data if the search column is always in column D and the two other ones are in B and F.</p>\n\n<p>Note: This will simply remove the data in the middle column, not actually fill the gaps left.</p>\n\n<pre><code>Sub deleteThreeColDupes()\n\nDim sourceRange As range\nDim colOne As range\nDim colTwo As range\nDim myCell As range\nDim checkCell As range\n\n'Set the search ranges\nSet colOne = range(\"B2\", Cells(Rows.count, 2).End(xlUp))\nSet colTwo = range(\"F2\", Cells(Rows.count, 6).End(xlUp))\nSet sourceRange = range(\"D2\", Cells(Rows.count, 4).End(xlUp))\n\n'Compare with the first column. If there is a match, clear the value and exit the loop.\n'if no match in first column, compare with the second column.\nFor Each myCell In sourceRange\n    For Each checkCell In colOne\n        If myCell.Value = checkCell.Value Then\n            myCell.Value = \"\"\n            Exit For\n        End If\n    Next checkCell\n    If myCell.Value &lt;&gt; \"\" Then\n        For Each checkCell In colTwo\n            If myCell.Value = checkCell.Value Then\n                myCell.Value = \"\"\n                Exit For\n            End If\n        Next checkCell\n    End If\nNext myCell\n\n'Clear sets\nSet colOne = Nothing\nSet colTwo = Nothing\nSet sourceRange = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1470860618, "post_id": 38882097, "comment_id": 65126709, "body": "Thanks for the help"}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": false, "score": 2, "last_activity_date": 1470858872, "last_edit_date": 1470858872, "creation_date": 1470857823, "answer_id": 38882097, "question_id": 38881083, "link": "https://stackoverflow.com/questions/38881083/comparing-3-columns-and-deleting-duplicates-vba/38882097#38882097", "title": "Comparing 3 Columns and Deleting duplicates vba", "body": "<p>A bit more efficient version using collections. It iterates columns B and F only once and values can be looked up instantly in resulting collections without iteration.</p>\n\n<pre><code>Sub deleteDups()\n\n    ' setup column ranges\n    Dim rngB As Range\n    Dim rngD As Range\n    Dim rngF As Range\n\n    With ActiveSheet\n        Set rngB = .Range(.[b2], .[b2].End(xlDown))\n        Set rngD = .Range(.[d2], .[d2].End(xlDown))\n        Set rngF = .Range(.[f2], .[f2].End(xlDown))\n    End With\n\n    ' store columns B and F in collections with value = key\n    Dim colB As New Collection\n    Dim colF As New Collection\n\n    Dim c As Range\n    For Each c In rngB: colB.Add c, c: Next\n    For Each c In rngF: colF.Add c, c: Next\n\n    ' quickly check if the value in any of the columns\n    For Each c In rngD\n        If contains(colB, CStr(c)) Or contains(colF, CStr(c)) Then\n            Debug.Print \"Duplicate \"\"\" &amp; c &amp; \"\"\" at address \" &amp; c.Address\n            ' c.Clear ' clears the duplicate cell\n        End If\n    Next\n\nEnd Sub\n\nFunction contains(col As Collection, key As String) As Boolean\n    On Error Resume Next\n    col.Item key\n    contains = (Err.Number = 0)\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Duplicate \"cry\" at address $D$4\nDuplicate \"car\" at address $D$5\nDuplicate \"cat\" at address $D$6\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 38881317, "answer_count": 2, "score": -3, "last_activity_date": 1470858872, "creation_date": 1470854094, "last_edit_date": 1592644375, "question_id": 38881083, "link": "https://stackoverflow.com/questions/38881083/comparing-3-columns-and-deleting-duplicates-vba", "title": "Comparing 3 Columns and Deleting duplicates vba", "body": "<p>In this case below I want to compare one column against two columns for duplicates. In the image below column D is compared to both columns B and F and from there I want to be able to delete the duplicates from Column D. I've looked online and I'm not sure how I can do that.</p>\n<p><a href=\"https://i.stack.imgur.com/C9yUD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C9yUD.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["excel", "memory", "copy-paste", "vba"], "owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470854091, "creation_date": 1470854091, "last_edit_date": 1531161705, "question_id": 38881082, "link": "https://stackoverflow.com/questions/38881082/remove-possible-object-relationships-within-pictures-trying-to-xlcopy-with-memo", "title": "Remove possible object relationships within pictures? Trying to xlCopy with memory restrictions", "body": "<p>I have a program that copies the cells and overlaying map. The area that is being copied has color gradient conditionals, lots of data, and overlapping picture objects. using the code:</p>\n\n<pre><code>range.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n</code></pre>\n\n<p>Using xlPicture has caused the code to not be able to paste and have all sorts of excel errors such as memory and resources limits hit. </p>\n\n<pre><code>range.CopyPicture Appearance:=xlScreen, Format:=xlBitmap\n</code></pre>\n\n<p>XlBitmap on the other hand removes this error. </p>\n\n<p>I understand having that many entities to copy is taxing. Does the screenshot take into account the object natures within the range of capture? if so is there a way to reduce the load or remove that calculation? </p>\n"}, {"tags": ["excel", "web", "fetch", "vba"], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "edited": false, "score": 0, "creation_date": 1470854926, "post_id": 38881109, "comment_id": 65123660, "body": "Hey, thank you, works great! now I will have to figure out how to fill that row A:F when error happens, it is causing misalignment between A:F and O columns because A:F are blanks, any simple way to do it?"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "edited": false, "score": 0, "creation_date": 1470856183, "post_id": 38881109, "comment_id": 65124395, "body": "Will you always want the information to be in the same row as the matching cell in Col O? If so, you could add another parameter in RequeryLandings, such as <code>sub RequeryLandings(address As String, rowNum as Long)</code> and when you call it pass it x as the row (<code>Call RequeryLandings(.Cells(x, &quot;O&quot;), x)</code>). Then when setting up the NewRow variable near the bottom, use <code>NewRow = rowNum</code>."}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "edited": false, "score": 0, "creation_date": 1470857487, "post_id": 38881109, "comment_id": 65125090, "body": "@FotoDJ I forgot to mention you earlier. Check my other comment for suggestions."}, {"owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "edited": false, "score": 0, "creation_date": 1470858179, "post_id": 38881109, "comment_id": 65125451, "body": "I am sorry but  I think I am not quite sure about that part: &quot; Then when setting up the NewRow variable near the bottom, use NewRow = rowNum &quot;"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "edited": false, "score": 0, "creation_date": 1470858647, "post_id": 38881109, "comment_id": 65125684, "body": "@FotoDJ near the bottom of your code, you have <code>NewRow = .Range(&quot;D&quot; &amp; Rows.Count).End(xlUp).Row + 1</code>. I would suggest try to change it to <code>NewRow = rowNum</code>"}, {"owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "edited": false, "score": 1, "creation_date": 1470859417, "post_id": 38881109, "comment_id": 65126072, "body": "All is working 100% now. Nice VBA lesson for me. Thank you!"}], "tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": true, "score": 1, "last_activity_date": 1470854221, "creation_date": 1470854221, "answer_id": 38881109, "question_id": 38880919, "link": "https://stackoverflow.com/questions/38880919/fetching-data-from-website/38881109#38881109", "title": "Fetching data from website", "body": "<p>You are going to want to use <code>On Error Resume Next</code>. This doesn't actually fix the error, but it does tell the code to continue. I copied your code into my sheet and ran it with the code snip before you open the connection in the sub RequeryLandings.</p>\n\n<pre><code>'The Error line, after you set ws = activeWorkbook.Sheets(\"Sheet1\")\nOn Error Resume Next\n\nWith ws.QueryTables.Add(Connection:= _\n\"URL;http://www.airport-data.com/aircraft/\" &amp; address &amp; \".html\", Destination:=ws.range( _\n\"$A$1\"))\n.Name = \"N1010W\"\n.FieldNames = True\n.RowNumbers = False\n.FillAdjacentFormulas = False\n.PreserveFormatting = False\n.RefreshOnFileOpen = False\n.BackgroundQuery = True\n.RefreshStyle = xlInsertDeleteCells\n.SavePassword = False\n.SaveData = True\n.AdjustColumnWidth = True\n.RefreshPeriod = 0\n.WebSelectionType = xlSpecifiedTables\n.WebFormatting = xlWebFormattingAll\n.WebTables = \"2\"\n.WebPreFormattedTextToColumns = True\n.WebConsecutiveDelimitersAsOne = True\n.WebSingleBlockTextImport = False\n.WebDisableDateRecognition = False\n.WebDisableRedirections = False\n.Refresh BackgroundQuery:=False\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 38881109, "answer_count": 1, "score": 0, "last_activity_date": 1470859752, "creation_date": 1470853526, "last_edit_date": 1531164843, "question_id": 38880919, "link": "https://stackoverflow.com/questions/38880919/fetching-data-from-website", "title": "Fetching data from website", "body": "<p>This problem is too difficult for me to solve, I've tried and so far nothing works...</p>\n\n<p>The code below runs through values in Column O and changes part of a web address with that values and then fetch the data into excel but sometimes if the certain search returns no results then I am getting error 1004 and loop stops and can not go to next value...</p>\n\n<p>Picture below shows four values in Column O and error message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SWJqJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SWJqJ.jpg\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>O1 = N1010W </li>\n<li>O2 = N22NA</li>\n<li>O3 = N2345I</li>\n<li>O4 = N992AN</li>\n</ul>\n\n<p>on the value O3, error 1004 comes up and loop stops.\nIs there a way to skip/cancel that error and have the search go to next (O4) value ? Because data from every search goes into Range (A1:F1), (B2:F2) and so on when error shows up by O3 value, the allcells in that Range(A3:F3) should be filled with any word, for example, \"not found\" </p>\n\n<pre><code>Option Explicit\n\n Sub Getdata()\n\n\n\nDim lastrow As Long, x As Long\n\nApplication.ScreenUpdating = False\n\n\n With Worksheets(\"Sheet2\")\n\n    lastrow = .Range(\"O\" &amp; Rows.Count).End(xlUp).Row\n\n    For x = 2 To lastrow\n\n\n\n        RequeryLandings .Cells(x, \"O\")\n\n    Next\n\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\nSub RequeryLandings(address As String)\n\nDim ws As Worksheet\n\n\n\nDim NewRow As Long\n\nWith Worksheets(\"Sheet2\")\nSet ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\n\n\n\n   With ws.QueryTables.Add(Connection:= _\n    \"URL;http://www.airport-data.com/aircraft/\" &amp; address &amp; \".html\",            Destination:=ws.Range( _\n    \"$A$1\"))\n    .Name = \"N1010W\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = False\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlSpecifiedTables\n    .WebFormatting = xlWebFormattingAll\n    .WebTables = \"2\"\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\n\n    End With\n     Range(\"A14\").Select\nWith ws.QueryTables.Add(Connection:= _\n    \"URL;http://www.airport-data.com/aircraft/\" &amp; address &amp; \".html\",      Destination:=Sheets(\"Sheet1\").Range( _\n    \"$A$12\"))\n    .Name = \"N1010W_2\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = False\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlSpecifiedTables\n    .WebFormatting = xlWebFormattingAll\n    .WebTables = \"3\"\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\n\nEnd With\n\n\n\n    DoEvents\n\n\n\n    Dim strSplit() As String\nDim cell As Range\n\n\n\nFor Each cell In ws.Range(\"B2:B200\")\n\nIf (cell.Value &lt;&gt; vbNullString) Then\n\n    cell.Value = Split(cell.Value, \"   Search\")(0)\n\nEnd If\n\nNext cell\n\n\n\nEnd With\n\n\n    'Copy to Another Sheet\n\n With Worksheets(\"Sheet2\")\nNewRow = .Range(\"D\" &amp; Rows.Count).End(xlUp).Row + 1\n\n\nIf ws.Range(\"A54\") = \"Notice:\" Then\n    Sheets(\"Sheet1\").Range(\"A54:A55\").EntireRow.Delete\nEnd If\n\n.Range(\"A\" &amp; NewRow) = ws.Range(\"B1\")\n.Range(\"B\" &amp; NewRow) = ws.Range(\"B2\")\n.Range(\"C\" &amp; NewRow) = ws.Range(\"B4\")\n.Range(\"D\" &amp; NewRow) = ws.Range(\"B12\")\n.Range(\"E\" &amp; NewRow) = ws.Range(\"B3\")\n\n\n  If ws.Range(\"A14\") = \"Certification Class:\" Then\n .Range(\"F\" &amp; NewRow) = ws.Range(\"B14\")\n  Else\n     .Range(\"F\" &amp; NewRow) = \"Unknown\"\n End If\n\n\n\n    End With\n\n\n\n\n\n   ActiveWorkbook.Sheets(\"Sheet1\").Range(\"A1:P100\") = Null\n\n   Sheets(\"Sheet2\").Activate\n\n   Sheets(\"Sheet2\").Range(\"G1\").Select\n\n\n\n\n  End Sub\n</code></pre>\n"}, {"tags": ["xml", "excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1470863652, "post_id": 38880757, "comment_id": 65128160, "body": "For &quot;version control&quot;, I usually just export the VBA modules and then store those text files.  Not ideal, but better than nothing."}], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 5, "last_activity_date": 1470853378, "creation_date": 1470853378, "answer_id": 38880877, "question_id": 38880757, "link": "https://stackoverflow.com/questions/38880757/location-of-excel-vba-macros-in-xml/38880877#38880877", "title": "Location of excel vba macros in xml", "body": "<p>If you unzip the <code>*.xslm</code> you will find a <code>/xl/vbaProject.bin</code> within the ZIP archive. This is the binary file which contains the macros.</p>\n"}], "owner": {"reputation": 24567, "user_id": 2761575, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OFx0W.jpg?s=128&g=1", "display_name": "dww", "link": "https://stackoverflow.com/users/2761575/dww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1528, "favorite_count": 1, "accepted_answer_id": 38880877, "answer_count": 1, "score": 1, "last_activity_date": 1470853378, "creation_date": 1470852969, "last_edit_date": 1531161705, "question_id": 38880757, "link": "https://stackoverflow.com/questions/38880757/location-of-excel-vba-macros-in-xml", "title": "Location of excel vba macros in xml", "body": "<p>I have a .xlsm format excel (2013) spreadsheet (containing vba macros) that I wish to convert to .xml (to save in a non-proprietary format in a repository, and to provide version control e.g. automated merging of branches in git).</p>\n\n<p>As explained <a href=\"https://stackoverflow.com/questions/8984254/how-to-view-the-xml-form-of-an-excel-file\">here</a> and <a href=\"https://stackoverflow.com/questions/11082278/how-to-properly-assemble-a-valid-xlsx-file-from-its-internal-sub-components\">here</a>, <code>.xlsx</code> files are zipped <code>xml</code>, so they can be  converted by simply unzipping.</p>\n\n<p>I tried this with a macro-enabled <code>.xlsm</code> file, and I do get an <code>xml</code> structure of the spreadsheet. But I can't find the macros anywhere. Does anyone know where the macros are stored in <code>.xlsm</code> and where to find them in the corresponding unzipped folder.</p>\n"}, {"tags": ["sql", "database", "vba", "ms-access", "sql-update"], "answers": [{"comments": [{"owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "edited": false, "score": 0, "creation_date": 1470854343, "post_id": 38880692, "comment_id": 65123363, "body": "OK, so I managed to apply your code with <code>DoCmd.RunSQL &quot;UPDATE [MASTER TABLE] SET [SERIES ABB] = Left([SERIES ABB], InStr([SERIES ABB], &quot;&quot;-&quot;&quot;) - 1), [# IN SERIES] =  right([SERIES ABB], Len([SERIES ABB]) - InStr([SERIES ABB], &quot;&quot;-&quot;&quot;))&quot;</code>"}, {"owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "edited": false, "score": 0, "creation_date": 1470854451, "post_id": 38880692, "comment_id": 65123414, "body": "Now the problem is that there are about 250 rows where <code>Column1</code> does not have a hyphen. In these the entire <code>Column1</code> field is moved over to <code>Column2</code>. But instead I need these rows left as they are."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "edited": false, "score": 0, "creation_date": 1470855329, "post_id": 38880692, "comment_id": 65123892, "body": "See update to the first part.  Use the &quot;IIf&quot; function."}, {"owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "edited": false, "score": 0, "creation_date": 1470855878, "post_id": 38880692, "comment_id": 65124206, "body": "Great! Thank you for your help. A <code>WHERE</code> statement solved it. See update on your post."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 2, "last_activity_date": 1470855992, "last_edit_date": 1470855992, "creation_date": 1470852751, "answer_id": 38880692, "question_id": 38880570, "link": "https://stackoverflow.com/questions/38880570/access-vba-search-and-repace-in-table/38880692#38880692", "title": "Access VBA Search and Repace in Table", "body": "<p>You don't need VBA for this.</p>\n\n<p>Run this SQL:</p>\n\n<pre><code>SELECT Iif(InStr([Column1],\"-\") = 0, [Column1], left([Column1], InStr([Column1], \"-\") - 1)) As NewCol1\n       , Iif(InStr([Column1],\"-\") = 0, \"\", right([Column1], Len([Column1]) - InStr([Column1], \"-\"))) As NewCol2\n       , [Column1]\n       , [Column2]\nFROM myTable\n</code></pre>\n\n<p>The InStr function finds the value you are looking for and returns the place in the string where it is found (the first position is position 1).  The Left and Right functions return the selected number of characters from the left and right of the string respectively.</p>\n\n<p>this will show you the results (and not overwrite your table).</p>\n\n<p>To overwrite the table do:</p>\n\n<pre><code>UPDATE myTable\nSET Column1 = left([Column1], InStr([Column1], \"-\") - 1)\n   , Column2 =  right([Column1], Len([Column1]) - InStr([Column1], \"-\"))\nWHERE (InStr([Column1], \"-\") &gt; 0 )\n</code></pre>\n\n<p>The VBA code to execute the update query (with your actual table and column names):</p>\n\n<pre><code>DoCmd.RunSQL \n   \"UPDATE [MASTER TABLE] \n    SET [SERIES ABB] = Left([SERIES ABB], InStr([SERIES ABB], \"\"-\"\") - 1), \n        [# IN SERIES] = right([SERIES ABB], Len([SERIES ABB]) - InStr([SERIES ABB], \"\"-\"\"))\n    WHERE (InStr([SERIES ABB], \"\"-\"\") &gt; 0 )\"\n</code></pre>\n"}], "owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 38880692, "answer_count": 1, "score": 1, "last_activity_date": 1470856079, "creation_date": 1470852315, "last_edit_date": 1470856079, "question_id": 38880570, "link": "https://stackoverflow.com/questions/38880570/access-vba-search-and-repace-in-table", "title": "Access VBA Search and Repace in Table", "body": "<p>I have a table in an Access Database that have data filled in. It was filled in over a 25 year period so there are inconsistencies.</p>\n\n<p>There is one column however that is OK. And I want to use this column to fix the data in another column. Sample follows:</p>\n\n<pre><code>Column1     | Column2\nICDS-1      | 01\nICDS-1A     | 1A\nICDS-2      | 02\nICDS-3      | 3\nICDS-4A     | 04\nOTHER       |\n...\n</code></pre>\n\n<p>What I want to do with an Access VBA macro is simply to use the data in <code>Column1</code> and split it at the hyphen. <strong>And if no hyphen the row should be skipped</strong>:</p>\n\n<pre><code>Column1     | Column2\nICDS        | 1\nICDS        | 1A\nICDS        | 2\nICDS        | 3\nICDS        | 4A\nOTHER       |\n...\n</code></pre>\n\n<p>While it seems rather a simple task that I could do in no time in Excel, I cannot seem to be able to get started with the Access VBA, even after googling for some while already.</p>\n\n<p>Or am I on a totally wrong track and should I use some SQL query?</p>\n\n<p>Any help is appreciated. Thanks.</p>\n\n<p><strong>Update:</strong> With OpiesDad answer the following VBA code (now with the actual table and column names) does the replacement, except for it does not skip the rows with no hyphen (I updated this point in my question above):</p>\n\n<pre><code>DoCmd.RunSQL \n   \"UPDATE [MASTER TABLE] \n    SET [SERIES ABB] = Left([SERIES ABB], InStr([SERIES ABB], \"\"-\"\") - 1), \n        [# IN SERIES] = right([SERIES ABB], Len([SERIES ABB]) - InStr([SERIES ABB], \"\"-\"\"))\"\n</code></pre>\n\n<p><strong>Update2:</strong> Solved, see OpiesDad answer with final query and VBA code.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1470852480, "post_id": 38880563, "comment_id": 65122303, "body": "This generated runtime error &#39;424&#39;:  Object Required, at the Application.InputBox line of code."}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "reply_to_user": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1470852907, "post_id": 38880563, "comment_id": 65122543, "body": "Change <code>keywordRange</code> to <code>Variant</code>, you&#39;ll also want to do some checking on what type of answer was entered to avoid errors down the line"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470853460, "post_id": 38880563, "comment_id": 65122854, "body": "It won&#39;t work Michael :) OP says <code>the input box would return a range of &quot;$A$1&quot; if the cell was clicked or a value of &quot;My Key Word&quot; if the user typed it.</code> How will you output what was typed/selected?"}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1470853525, "post_id": 38880563, "comment_id": 65122895, "body": "Still no joy.  With keywordRange set to Variant and the type set to 10 it generates a couple of errors.  If selecting a range, a pop-up message says &quot;Text is not valid.&quot; and allows me to try again.  That&#39;s Excel, not any error handling I built in.  If I enter text, the script throws run-time error 13, Type mismatch."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470853572, "post_id": 38880563, "comment_id": 65122920, "body": "Michael, The dilemma  with <code>Type:10</code> is what would you choose? <code>Set keywordRange = Application..</code> or <code>keywordRange = Application...</code>"}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470854366, "post_id": 38880563, "comment_id": 65123372, "body": "@SiddharthRout, You&#39;re right!  After investigating further, my solution doesn&#39;t work at all.  It seems silly, but I think having an input box to have the user decide which they want to enter then the appropriate type to handle their choice"}], "tags": [], "owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "is_accepted": false, "score": 1, "last_activity_date": 1470852295, "creation_date": 1470852295, "answer_id": 38880563, "question_id": 38880482, "link": "https://stackoverflow.com/questions/38880482/input-box-to-select-a-range-or-enter-text/38880563#38880563", "title": "Input Box to Select a Range or Enter Text", "body": "<p>Change the type from 8 to 10</p>\n\n<p>From Microsoft Docs:</p>\n\n<blockquote>\n  <p>The following table lists the values that can be passed in the Type argument. Can be one or a sum of the values. For example, for an input box that can accept both text and numbers, set Type to 1 + 2.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1471022297, "post_id": 38881532, "comment_id": 65203445, "body": "This worked!  It was my first userform so I had to read up on their workings, but it did the job.  Thanks!"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1470855649, "creation_date": 1470855649, "answer_id": 38881532, "question_id": 38880482, "link": "https://stackoverflow.com/questions/38880482/input-box-to-select-a-range-or-enter-text/38881532#38881532", "title": "Input Box to Select a Range or Enter Text", "body": "<p>What I would recommend is create a <code>Userform</code> and place a <code>RefEdit</code> control as shown in the image below</p>\n\n<p><a href=\"https://i.stack.imgur.com/TGV19.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TGV19.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then use something like this</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim rng As Range\n\n    On Error Resume Next\n    Set rng = Range(RefEdit1.Value)\n    On Error GoTo 0\n\n    If Not rng Is Nothing Then\n        MsgBox \"You selected the range \" &amp; RefEdit1.Value\n    Else\n        MsgBox \"You typed \" &amp; RefEdit1.Value\n    End If\nEnd Sub\n</code></pre>\n\n<p>Now you can type text or select a range as shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/i2PgY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i2PgY.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3046, "favorite_count": 0, "accepted_answer_id": 38881532, "answer_count": 2, "score": 1, "last_activity_date": 1470855649, "creation_date": 1470851996, "last_edit_date": 1531164843, "question_id": 38880482, "link": "https://stackoverflow.com/questions/38880482/input-box-to-select-a-range-or-enter-text", "title": "Input Box to Select a Range or Enter Text", "body": "<p>I have an Excel VBA script that prompts a user for a range of cells containing keywords to be used later:</p>\n\n<pre><code>Dim keywordRange As Range\nSet keywordRange = Application.InputBox(\"Select a range with your keywords.\", \"KEYWORDS\", Type:=8)\n</code></pre>\n\n<p>This code works fine.  A pop-up box appears with a blank text field.  Click on a cell and the text field is filled with a reference to that range, for example, \"$A$1\".</p>\n\n<p>I want the option to type text into that blank text field instead of selecting a range.  For example, the input box would return a range of \"$A$1\" if the cell was clicked or a value of \"My Key Word\" if the user typed it.</p>\n\n<p>Currently, entering text other than a valid range reference generates this error:</p>\n\n<blockquote>\n  <p>The reference you typed is not valid, or you did not provide a reference where one was required.  To enter a reference using the mouse, click in the edit box, and then click the cell in the sheet you want to refer to, or drag through the range you want to select.</p>\n</blockquote>\n\n<p>I tried changing the the 'keywordRange' variable type to String.  That generated a compile error.</p>\n\n<p>Any ideas where to start?  Thanks!</p>\n"}, {"tags": ["vba", "excel", "visual-studio-2012"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 1, "creation_date": 1470855059, "post_id": 38880460, "comment_id": 65123741, "body": "Passing values is always a possibility, but how you&#39;ll be doing it depends on what exactly you want to do with the values. Are two programs running side-by-side, passing values between each other and running in lock step? Or is the one running and storing some output somewhere for the other to pick up whenever it gets run next time? And do they have to run separately, or can you just execute your VBA macro from within your .NET application?"}], "answers": [{"comments": [{"owner": {"reputation": 410, "user_id": 6668207, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/33d3fca7d486e196b1d1ae44360bd12f?s=128&d=identicon&r=PG&f=1", "display_name": "Ruthus99", "link": "https://stackoverflow.com/users/6668207/ruthus99"}, "edited": false, "score": 0, "creation_date": 1470909659, "post_id": 38885508, "comment_id": 65145824, "body": "Thanks so much for the reply, I managed to get it to work after some tinkering. This gives me a basic idea of how variables can be transferred and how to manage excel from VB. I will edit my answer and post the code for other lost people like me. Thanks Again Much Appreciated!!!"}, {"owner": {"reputation": 118, "user_id": 6582616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e2e82179df344624bc3c7ee7484de1?s=128&d=identicon&r=PG&f=1", "display_name": "Busy", "link": "https://stackoverflow.com/users/6582616/busy"}, "reply_to_user": {"reputation": 410, "user_id": 6668207, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/33d3fca7d486e196b1d1ae44360bd12f?s=128&d=identicon&r=PG&f=1", "display_name": "Ruthus99", "link": "https://stackoverflow.com/users/6668207/ruthus99"}, "edited": false, "score": 0, "creation_date": 1470961695, "post_id": 38885508, "comment_id": 65174490, "body": "I&#39;m glad this helped! Especially glad that you updated your post to showcase the actual VB.Net code solution."}], "tags": [], "owner": {"reputation": 118, "user_id": 6582616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e2e82179df344624bc3c7ee7484de1?s=128&d=identicon&r=PG&f=1", "display_name": "Busy", "link": "https://stackoverflow.com/users/6582616/busy"}, "is_accepted": true, "score": 1, "last_activity_date": 1470875057, "creation_date": 1470875057, "answer_id": 38885508, "question_id": 38880460, "link": "https://stackoverflow.com/questions/38880460/share-variables-between-excel-and-visual-basic/38885508#38885508", "title": "Share variables between excel and visual basic", "body": "<p>One way to access variables in another workbook's VBA code is to create functions that return those values to you. Then call those functions from your other app.</p>\n\n<p>For example, let this be code in a module in your Excel file with the macro:</p>\n\n<pre><code>Option Explicit\n\nPrivate strText As String\n\n' Say you have a routine that manipulates strText (or not, even!)\nPublic Sub doSomethingToSTRTEXT()\n    strText = \"Hello World!\"\nEnd Sub\n\n' This is the function to call to retrieve strText\nPublic Function getSTRTEXT() As String\n    getSTRTEXT = strText\nEnd Function\n</code></pre>\n\n<p>And this is code in a VBA project elsewhere (not running .Net on this machine, just microsoft office <em>sad</em>) where you have this:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    ' Declare\n    Dim WBK As Workbook\n    ' Open the workbook in question\n    Set WBK = Workbooks.Open(Filename:=\"C:\\Path\\To\\File\\With\\VBA.xls\")\n\n    ' This code's own variable\n    Dim strText As String\n\n    ' Call the routine (or not) that does something to that workbook's vba's strText\n    Application.Run (WBK.Name &amp; \"!doSomethingToSTRTEXT\")\n\n    ' Now let's retrieve that value via function!\n    strText = Application.Run(WBK.Name &amp; \"!getSTRTEXT\")\n\n    ' Show it to me\n    MsgBox strText\nEnd Sub\n</code></pre>\n\n<p>I would like to leave the conversion of the code right above ^ into VB.Net to you (or do a search here on SO for .Net code to handle Excel objects) and try it out</p>\n"}], "owner": {"reputation": 410, "user_id": 6668207, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/33d3fca7d486e196b1d1ae44360bd12f?s=128&d=identicon&r=PG&f=1", "display_name": "Ruthus99", "link": "https://stackoverflow.com/users/6668207/ruthus99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 38885508, "answer_count": 1, "score": 0, "last_activity_date": 1470909769, "creation_date": 1470851901, "last_edit_date": 1470909769, "question_id": 38880460, "link": "https://stackoverflow.com/questions/38880460/share-variables-between-excel-and-visual-basic", "title": "Share variables between excel and visual basic", "body": "<p>I recently started programming with .NET visual basic using visual basic studio. I am also using excel VBA to make some macros. I would be very appreciative if someone could answer a question I have, apologies if the answer is obvious, I'm just getting started:</p>\n\n<p>Basically, if I have set a variable in excel VBA, for example:</p>\n\n<pre><code>dim text as string\n\ntext = \"hello world\"\n</code></pre>\n\n<p>Would it be possible for me to use that variable when programming in visual basic and have it retain its value from when it was set in the excel VBA macro.</p>\n\n<p>Please comment if you need clarification.</p>\n\n<p>Many thanks.</p>\n\n<p><strong>SOLUTION:</strong></p>\n\n<p>Okay I managed to figure it out with the help of the solutions, the code that works in VB is as follows:</p>\n\n<pre><code>Imports Microsoft.Office.Interop.Excel\nImports Microsoft.Office.Interop\nImports Microsoft.Office.Core\n\nPublic Class Form1\n    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n\n        Dim oxl As excel.application\n        Dim owb As excel.workbook\n        Dim osheet As Excel.worksheet\n        Dim orng As excel.Range\n        Dim strtext As String\n\n\n\n        oxl = CreateObject(\"Excel.application\")\n        owb = oxl.Workbooks.Open(Filename:=\"C:\\Users\\USERNAME\\Documents\\Variable Passing Test.xlsm\")\n\n        oxl.Run(\"dosomethingtostrtext\")\n\n        strtext = oxl.Run(\"getstrtext\")\n\n        MsgBox(strtext)\n\n    End Sub\nEnd Class\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 612, "user_id": 1720808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d473a36e850775c42f3c1d63db25c16?s=128&d=identicon&r=PG", "display_name": "winghei", "link": "https://stackoverflow.com/users/1720808/winghei"}, "is_accepted": true, "score": 0, "last_activity_date": 1470852002, "creation_date": 1470852002, "answer_id": 38880485, "question_id": 38880281, "link": "https://stackoverflow.com/questions/38880281/vba-why-do-i-get-shapes-unknown-member-invalid-request-when-copying-table/38880485#38880485", "title": "VBA: why do I get &quot;Shapes (unknown member): Invalid request&quot; when copying table to power point", "body": "<p>Try change your <strong>ppPastePNG</strong> to <strong>ppPasteEnhancedMetafile</strong>.</p>\n\n<p>e.g.\n<code>PPT.ActivePresentation.Slides(2).Shapes.PasteSpecial ppPasteEnhancedMetafile, msoFalse</code></p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1470853041, "creation_date": 1470853041, "answer_id": 38880777, "question_id": 38880281, "link": "https://stackoverflow.com/questions/38880281/vba-why-do-i-get-shapes-unknown-member-invalid-request-when-copying-table/38880777#38880777", "title": "VBA: why do I get &quot;Shapes (unknown member): Invalid request&quot; when copying table to power point", "body": "<p>Modify the last lines in your code with the piece of code below (using the <strong><em>myShape</em></strong> object, will allow you later to modify the picture parameters easily)</p>\n\n<pre><code>Dim myShape                             As Object\n\nPPT.ActivePresentation.Application.ActiveWindow.Panes(2).Activate\n\nptRg.Select\nSelection.Copy\n\nSet myShape = PPT.ActivePresentation.Slides(2).Shapes.PasteSpecial(ppPastePNG, msoFalse)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10209553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XG7fVQq8Gr8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pnkGyu0kFIKQFMVUEC5tI7XS8cjQ/mo/photo.jpg?sz=128", "display_name": "Diego F Montalvo M", "link": "https://stackoverflow.com/users/10209553/diego-f-montalvo-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1533918965, "last_edit_date": 1533918965, "creation_date": 1533918603, "answer_id": 51790629, "question_id": 38880281, "link": "https://stackoverflow.com/questions/38880281/vba-why-do-i-get-shapes-unknown-member-invalid-request-when-copying-table/51790629#51790629", "title": "VBA: why do I get &quot;Shapes (unknown member): Invalid request&quot; when copying table to power point", "body": "<p>Apparently it sometimes is not copying correctly, then it goes to the pasting part and it has nothing...</p>\n\n<p>I managed to solve this problem by placing Application.CutCopyMode = False before the selection and copy command</p>\n\n<p>Example:</p>\n\n<pre><code>Application.CutCopyMode = False\n\n'Selecting and copying\n\nRange(\"ExportTable\").Copy\n\n' Pasting and giving format\n\nWith PPSlide.Shapes.PasteSpecial(DataType:=2)\n\n                .Align msoAlignLefts, msoTrue\n\n                .Align msoAlignCenters, True\n\n                .Align msoAlignMiddles, True\n\n                .IncrementTop (dist_top)\n\n                .Top = 70\n\n                .Left = 15\n\n                .LockAspectRatio = msoFalse\n\n                .Height = 90\n\n                .Width = 690\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6698052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2723c47b9e74c3b116c20613fa09a38?s=128&d=identicon&r=PG&f=1", "display_name": "Rand360", "link": "https://stackoverflow.com/users/6698052/rand360"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3608, "favorite_count": 0, "accepted_answer_id": 38880485, "answer_count": 3, "score": 0, "last_activity_date": 1533918965, "creation_date": 1470851318, "question_id": 38880281, "link": "https://stackoverflow.com/questions/38880281/vba-why-do-i-get-shapes-unknown-member-invalid-request-when-copying-table", "title": "VBA: why do I get &quot;Shapes (unknown member): Invalid request&quot; when copying table to power point", "body": "<p>So this error seems to come up for a number of reasons, however none of the other solutions seem to address the issue I'm facing. I have a script running from excel that copies a table over to a powerpoint slide, but I keep getting \"Shapes (unknown member): Invalid request\".</p>\n\n<p><strong>What it's <em>not</em> caused from:</strong> <br></p>\n\n<ul>\n<li>It's not a case of not grabbing focus of power point as I'm able to change text on a slide via the script and select different slides.</li>\n<li>It's not a case of not copying table in time. I set it to wait and I've also put a message box in between and have pasted the table manually with what the vba code had copied.</li>\n</ul>\n\n<p><strong>The code:</strong> <br>\nKeep in mind I've omitted paths and unrelated segments of code...</p>\n\n<pre><code>Dim PPT As PowerPoint.Application\nSet PPT = New PowerPoint.Application\nPPT.Visible = True\nPPT.Presentations.Open Filename:= \"#######################\"\n\nSet curWS = Worksheets(\"###############\")\ncurWS.Select\nSet pt = curWS.PivotTables(1)\nSet ptRg = pt.TableRange1\nSet ptRg = Range(curWS.Cells(ptRg.Row - 1, ptRg.Column), _\n                 curWS.Cells(ptRg.Row + ptRg.Rows.Count - 1, ptRg.Columns.Count + ptRg.Column - 1))\nptRg.Select\nSelection.Copy\nDoEvents\nPPT.ActivePresentation.Application.ActiveWindow.Panes(2).Activate\nPPT.ActivePresentation.Application.ActivePresentation.Slides(2).Select\nPPT.ActivePresentation.Application.ActivePresentation.Slides(2).Shapes.PasteSpecial ppPastePNG, msoFalse\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 1, "creation_date": 1470851440, "post_id": 38880260, "comment_id": 65121680, "body": "I think <a href=\"http://www.cpearson.com/Excel/VBAArrays.htm\" rel=\"nofollow noreferrer\">this</a> may help you. See <code>IsArrayAllocated</code> Function."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1470851796, "post_id": 38880260, "comment_id": 65121886, "body": "Would be helpful to show the code for the function <code>Select_File_Or_Files_Windows</code>, so we can see how it creates the return value"}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470852000, "post_id": 38880260, "comment_id": 65122012, "body": "<code>Select_File_Or_Files_Windows</code> is almost definitely returning a non-string array or a non-array. That&#39;s the only thing that I&#39;ve tried that will give a type mismatch - everything else will end up with things like subscript out of range or dimension mismatch. Double check the values in <code>Filenames</code> after it returns and make sure that all the values in it are strings."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470852396, "post_id": 38880260, "comment_id": 65122246, "body": "@Mikegrann It does return all strings for the array. I had that part working before I starting needing to check if there were any filenames in the array."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1470851500, "creation_date": 1470851500, "answer_id": 38880338, "question_id": 38880260, "link": "https://stackoverflow.com/questions/38880260/does-array-contain-data/38880338#38880338", "title": "Does array contain data", "body": "<p>being it a Variant, try</p>\n\n<pre><code>If IsArray(FileNames) Then...\n</code></pre>\n"}], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 38880338, "answer_count": 1, "score": 0, "last_activity_date": 1470851500, "creation_date": 1470851258, "question_id": 38880260, "link": "https://stackoverflow.com/questions/38880260/does-array-contain-data", "title": "Does array contain data", "body": "<p>I am programming in Excel VBA. </p>\n\n<p>I have a file where I open an explorer window and select a file or files and return the names of those files into an array. </p>\n\n<p>I need to check if the array is filled or not. I've tried <code>if FileNames(1) &lt;&gt; \"\" Then</code> which works if there is something in the array. But when the array is empty I get an error of <code>type mismatch</code>. If I try <code>If FileNames &lt;&gt; False Then</code> it works when the array has nothing in it, but gives me the <code>type mismatch</code> error when there is something in the array. I have the array just as a normal variable like <code>Dim FileNames</code>, but I've tried <code>Dim FileNames() as String</code> too without success. Whether I select a file or not I get the <code>type mismatch</code> error. Here's the code I've got:</p>\n\n<pre><code>sub GetUserInfo()\n    Dim FileNames\n\n    FileNames = Select_File_Or_Files_Windows 'This opens the Explorer window and allows you to pick multiple files\n\n    If FileNames(1) &lt;&gt; \"\" Then\n        'Do something\n    Else\n        'Do the last thing\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "formula", "formulas", "vba"], "comments": [{"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 1, "creation_date": 1470851728, "post_id": 38880181, "comment_id": 65121845, "body": "The error is coming from your ending value being negative"}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1470852139, "post_id": 38880181, "comment_id": 65122097, "body": "@pnuts yes I should have been more specific"}], "answers": [{"tags": [], "owner": {"reputation": 1157, "user_id": 1908616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3109b05827590cceef3d7c87ba31ab42?s=128&d=identicon&r=PG", "display_name": "Ulli Schmid", "link": "https://stackoverflow.com/users/1908616/ulli-schmid"}, "is_accepted": false, "score": 0, "last_activity_date": 1470857851, "creation_date": 1470857851, "answer_id": 38882108, "question_id": 38880181, "link": "https://stackoverflow.com/questions/38880181/getting-error-on-cagr-formula/38882108#38882108", "title": "Getting Error on CAGR formula", "body": "<p>This is not an Excel problem. You're trying to compute the root of a negative number and Excel justifiably responds with an error.</p>\n\n<p>You cannot mathematically compute this without using <a href=\"https://en.wikipedia.org/wiki/Imaginary_number\" rel=\"nofollow\">imaginary numbers</a>.  </p>\n\n<p>From a business perspective, only CAGR from -100% to +infinity% make sense. You simply should not try to compute a CAGR for base variables that may change inbetween positive and negative, because that doesn't make sense.</p>\n"}], "owner": {"reputation": 11, "user_id": 6640537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633b2a0b43ef3d578800d085b4bf9caf?s=128&d=identicon&r=PG&f=1", "display_name": "Raw_Geek", "link": "https://stackoverflow.com/users/6640537/raw-geek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 561, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470857851, "creation_date": 1470851012, "last_edit_date": 1531161705, "question_id": 38880181, "link": "https://stackoverflow.com/questions/38880181/getting-error-on-cagr-formula", "title": "Getting Error on CAGR formula", "body": "<p>I have a data file and i'm getting a stupid error like  </p>\n\n<p><a href=\"http://i.stack.imgur.com/ybVz4.png\" rel=\"nofollow\">enter image description here</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/oRJ6J.gif\" rel=\"nofollow\">enter image description here</a></p>\n\n<p>Does anyone news why I'm getting this error. </p>\n\n<p><strong>=((F4/B4)^(1/4))-1</strong></p>\n\n<p>F4 = my ending value\nB4 = My beg value\n4 = Number of year.. (Should 4 year) `\nPlease help..</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1470851210, "post_id": 38880147, "comment_id": 65121541, "body": "<code>xlRight</code> should be <code>xlToLeft</code>"}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 1, "creation_date": 1470851271, "post_id": 38880147, "comment_id": 65121583, "body": "This is probably a duplicate of one of these: <a href=\"http://stackoverflow.com/questions/33545516/finding-last-column-and-then-finding-the-last-row-in-that-column\" title=\"finding last column and then finding the last row in that column\">stackoverflow.com/questions/33545516/&hellip;</a> <a href=\"http://stackoverflow.com/questions/11926972/excel-vba-finding-the-last-column-with-data\" title=\"excel vba finding the last column with data\">stackoverflow.com/questions/11926972/&hellip;</a> <a href=\"http://stackoverflow.com/questions/17730639/how-to-find-and-select-the-last-column-in-vba\" title=\"how to find and select the last column in vba\">stackoverflow.com/questions/17730639/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1470851465, "post_id": 38880289, "comment_id": 65121692, "body": "make sure you qualify the range object with the sheet. <code>Sheets(&quot;Sheet2&quot;).Cells(1,Sheets(&quot;Sheet2&quot;).Columns.Count).End&zwnj;&#8203;(xlToLeft).Column</code>"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1470851563, "post_id": 38880289, "comment_id": 65121751, "body": "True, if the sheet to check the columns is not the active sheet. If it is, qualifying it is not necessary."}, {"owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1470851776, "post_id": 38880289, "comment_id": 65121872, "body": "Would this work as well for rows?"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1470851858, "post_id": 38880289, "comment_id": 65121919, "body": "You can use what you had above for rows. <code>Cells(Rows.Count, 1).End(xlUp).Row</code>"}], "tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": true, "score": 1, "last_activity_date": 1470851360, "creation_date": 1470851360, "answer_id": 38880289, "question_id": 38880147, "link": "https://stackoverflow.com/questions/38880147/excel-vba-column-max/38880289#38880289", "title": "EXCEL-VBA column max", "body": "<p>To get the index of the last column in the sheet, use\n<code>Cells(1,Columns.Count).Column</code></p>\n\n<p>To get the last used Column, it is very similar.</p>\n\n<pre><code>Cells(1,Columns.Count).End(xlToLeft).Column\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1665, "favorite_count": 0, "closed_date": 1470851517, "accepted_answer_id": 38880289, "answer_count": 1, "score": 1, "last_activity_date": 1470851360, "creation_date": 1470850889, "last_edit_date": 1531161705, "question_id": 38880147, "link": "https://stackoverflow.com/questions/38880147/excel-vba-column-max", "closed_reason": "Duplicate", "title": "EXCEL-VBA column max", "body": "<p>What would the equivalent to this be for the horizontal/colum?</p>\n\n<pre><code>v = Sheets(\"Sheet2\").Range(\"A65536\").End(xlUp).Row\n</code></pre>\n\n<p>I am guessing this but do not know how to check</p>\n\n<pre><code>v = Sheets(\"Sheet2\").Range(\"zz1\").End(xlRight).column\n</code></pre>\n\n<p>I am basically trying to figure out the how many columns there are.\nI tried what I guessed but it is wrong</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1470850152, "post_id": 38879821, "comment_id": 65120940, "body": "Getting &quot;Script out of range&quot; error at line For TotUID = LBound(UIDList()) To UBound(UIDList())"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1470850446, "post_id": 38879821, "comment_id": 65121098, "body": "You need to check if the array is initialized. See the updated answer."}, {"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1470853048, "post_id": 38879821, "comment_id": 65122609, "body": "It works, but keeps printing the same data until it finds the next value. I just wanted to print it once for each new value fine."}, {"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1470854052, "post_id": 38879821, "comment_id": 65123187, "body": "Thank You both of you. It works the way it supposed to."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1471290267, "post_id": 38879821, "comment_id": 65278452, "body": "@cyboashu I feel that OP should use option explicit so that All variables are declared. For example oFSO has not been declared and also no reference to Scripting run time library. for experienced persons, no problem but for a newbie it may cause trouble in testing the program while learning. Since you are checking a lot of posts, I wish to have your observation on my view point."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471292970, "post_id": 38879821, "comment_id": 65279847, "body": "Totally agreed, using <code>Option Explicit</code> is always a good idea. No harm what so ever and helps you to catch syntax errors as you type."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 0, "last_activity_date": 1470853784, "last_edit_date": 1470853784, "creation_date": 1470849705, "answer_id": 38879821, "question_id": 38879759, "link": "https://stackoverflow.com/questions/38879759/array-not-getting-the-value/38879821#38879821", "title": "Array not getting the value", "body": "<p>Improper nesting: </p>\n\n<p>change to this:</p>\n\n<pre><code>For intCount = LBound(strarray()) To UBound(strarray())\n    'Erase the array\n     Erase UIDList\n    If InStr(strarray(intCount), \"NAME\") Then\n       UIDList() = Split(strarray(intCount), \"NAME\")\n     End If\n\n'/ Check if UIDList() has any elements\n If Not (Not UIDList()) Then\n    For TotUID = LBound(UIDList()) To UBound(UIDList())\n       Debug.Print UIDList(TotUID)\n    Next\n End If   \nNext\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 38879821, "answer_count": 1, "score": 0, "last_activity_date": 1470853784, "creation_date": 1470849471, "last_edit_date": 1531164843, "question_id": 38879759, "link": "https://stackoverflow.com/questions/38879759/array-not-getting-the-value", "title": "Array not getting the value", "body": "<p>I have the code below to get the value assigned to Array \"UIDList()\". But for what ever reason it is only getting the last value only. Can you please correct what could've been gone wrong. </p>\n\n<pre><code>Dim strTest As String\nDim strarray() As String\nDim UIDList() As String\nDim intCount As Integer\nDim TotUID As Integer\n\nSet oFS = oFSO.OpenTextFile(\"C:\\Pro\\test.txt\")\ntxtpro = oFS.ReadAll\n\nstrTest = txtpro\nstrarray = Split(strTest, \"=\")\n\nFor intCount = LBound(strarray()) To UBound(strarray())\n    If InStr(strarray(intCount), \"NAME\") Then\n       UIDList() = Split(strarray(intCount), \"NAME\")\n     End If\nNext\n\nFor TotUID = LBound(UIDList()) To UBound(UIDList())\nDebug.Print UIDList(TotUID)\nNext\n</code></pre>\n"}, {"tags": ["vba", "windows-10", "synchronization", "ms-project"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471170619, "post_id": 38879602, "comment_id": 65237716, "body": "see my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6701291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5510de3e5872d66e36e0d21d294a8d7?s=128&d=identicon&r=PG&f=1", "display_name": "DavidZero256", "link": "https://stackoverflow.com/users/6701291/davidzero256"}, "edited": false, "score": 0, "creation_date": 1471369476, "post_id": 38940606, "comment_id": 65315279, "body": "Great! looks like this is working well. For anyone who is needing to do the same thing as this... The only problem is that saving across VPN is very connected reliant. With a bad signal, it will sit there and save for a good while. with a great signal, it only takes a few seconds."}, {"owner": {"reputation": 13, "user_id": 6701291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5510de3e5872d66e36e0d21d294a8d7?s=128&d=identicon&r=PG&f=1", "display_name": "DavidZero256", "link": "https://stackoverflow.com/users/6701291/davidzero256"}, "edited": false, "score": 0, "creation_date": 1476221922, "post_id": 38940606, "comment_id": 67253239, "body": "Well, now the problem we are running in to is that they are closing the file after messing something up and assuming it did not save because that didn&#39;t hit save. It didn&#39;t save on their tablet, but it did save to our server. Having this as a BeforeClose event is the problem. I should work fine if we can make it a BeforeSave event that will function properly."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1471164719, "creation_date": 1471164719, "answer_id": 38940606, "question_id": 38879602, "link": "https://stackoverflow.com/questions/38879602/saving-to-two-locations/38940606#38940606", "title": "Saving to two locations", "body": "<p>change your line:</p>\n\n<pre><code>FileCloseEx Save:=pjDoNotSave, noauto:=True\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>prjApp.FileCloseEx pjDoNotSave, True\n</code></pre>\n\n<p>After you declare a variable and set is as a <code>New MsProject,Application</code></p>\n\n<p>The code below worked with the tests I've done on my PC:</p>\n\n<pre><code>Private Sub Project_BeforeClose(ByVal pj As Project)\n\nDim prjApp          As MSProject.Application\nSet prjApp = New MSProject.Application\n\nApplication.DisplayAlerts = False\nIf ActiveProject.ProjectSummaryTask.Flag20 = False Then\n    ActiveProject.ProjectSummaryTask.Flag20 = True\n    ActiveProject.SaveAs Name:=\"c:\\users\\John\\desktop\\backuptest.mpp\"\n    prjApp.FileCloseEx pjDoNotSave, True\nElse\n    ActiveProject.ProjectSummaryTask.Flag20 = False\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6701291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5510de3e5872d66e36e0d21d294a8d7?s=128&d=identicon&r=PG&f=1", "display_name": "DavidZero256", "link": "https://stackoverflow.com/users/6701291/davidzero256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 1, "accepted_answer_id": 38940606, "answer_count": 1, "score": 1, "last_activity_date": 1616679965, "creation_date": 1470848879, "last_edit_date": 1616679965, "question_id": 38879602, "link": "https://stackoverflow.com/questions/38879602/saving-to-two-locations", "title": "Saving to two locations", "body": "<p>I have Project 2016 on a Microsoft Surface pro 3 with the full version of Windows 10 and Office 365.</p>\n<p>I followed instructions from <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-project/can-you-set-up-a-ms-project-file-to-automatically/68847860-3c47-49d5-a4a8-06124dd63196\" rel=\"nofollow noreferrer\">http://answers.microsoft.com/en-us/office/forum/office_2010-project/can-you-set-up-a-ms-project-file-to-automatically/68847860-3c47-49d5-a4a8-06124dd63196</a>. It is based on an older version of Project.</p>\n<p>It saves to the second location, but crashes every time and does not save the original copy.</p>\n<p>I did not change the code except for the file location. I did rename flag20 to yes (is that all I need to do is rename it?)</p>\n<p>It crashes on this line</p>\n<pre><code>FileCloseEx Save:=pjDoNotSave, noauto:=True\n</code></pre>\n<p>This is the program:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub project_beforesave(ByVal pj As Project)\n    Application.DisplayAlerts = False\n    If ActiveProject.ProjectSummaryTask.Flag20 = False Then\n        ActiveProject.ProjectSummaryTask.Flag20 = True\n        ActiveProject.SaveAs Name:=&quot;c:\\users\\John\\desktop\\backuptest.mpp&quot;\n        FileCloseEx Save:=pjDoNotSave, noauto:=True 'Crashes here\n    Else\n        ActiveProject.ProjectSummaryTask.Flag20 = False\n    End If\nEnd Sub\n</code></pre>\n<p>We use a tablet on construction job sites for the superintendent to update the job schedule in Project. Previously, all files were saved to the server and he would access them via VPN. Project opens files very slowly over VPN even though the file is very small. Even with a good 4g connection or wifi.</p>\n<p>I have been trying to find a way to keep the files on the tablet but sync them with the server immediately when saved.</p>\n"}, {"tags": ["excel", "vba", "reference", "skype"], "comments": [{"owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "edited": false, "score": 0, "creation_date": 1470848822, "post_id": 38879564, "comment_id": 65120237, "body": "also if you know how to get the skype toolbar on excel that would help a bunch."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1470870072, "post_id": 38879564, "comment_id": 65130413, "body": "Did you register the DLL?"}, {"owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1471013931, "post_id": 38879564, "comment_id": 65198715, "body": "yes but im not sure of the proper file path. I&#39;ve done c:\\program files (x86)\\skype\\ skype4com.dll and i&#39;ve also did c:\\program files\\common files\\ \\skype\\ skype4com.dll. When i tried to find it in excel com add-in it said something along the lines of &quot;not excel add in&quot;. ."}], "owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 815, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470848736, "creation_date": 1470848736, "question_id": 38879564, "link": "https://stackoverflow.com/questions/38879564/connecting-excel-to-skype-reference-error", "title": "Connecting excel to skype. reference error", "body": "<p>so im trying to pair skype and excel. But i can't seem to make it run. I thought i selected the correct references and even directly selected SkypeComLib.dll but to no avail. I've included a photo of the references i have selected as well as the error. the code i'm trying to run is a sample i found online. The debug highlights \"Set aSkype = New SKYPE4COMLib.Skype\" <a href=\"http://i.stack.imgur.com/LpXqa.jpg\" rel=\"nofollow\">error message</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/JDNnC.jpg\" rel=\"nofollow\">references</a></p>\n\n<pre><code>Sub Test()\n\nDim aSkype As SKYPE4COMLib.Skype\nSet aSkype = New SKYPE4COMLib.Skype\nDim oChat As Chat\nDim skUser As SKYPE4COMLib.User\nSet skUser = aSkype.User(\"user_name\")\nSet oChat = aSkype.CreateChatWith(skUser.Handle)\noChat.OpenWindow\noChat.SendMessage \"automated message\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error", "conditional-formatting"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470848713, "post_id": 38879524, "comment_id": 65120156, "body": "What row gives the error?"}, {"owner": {"reputation": 37, "user_id": 6605427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d47dde2498124a63edcd2ac4ee20062f?s=128&d=identicon&r=PG&f=1", "display_name": "durba138", "link": "https://stackoverflow.com/users/6605427/durba138"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470848750, "post_id": 38879524, "comment_id": 65120187, "body": ".Add Type:=xlExpression, Formula1:=&quot;=&quot; &amp; checkAddress &amp; &quot; = 0&quot;"}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1470849080, "post_id": 38879524, "comment_id": 65120388, "body": "What is the value of <code>checkAddress</code> when it fails?  Is it always the same?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1470849156, "post_id": 38879524, "comment_id": 65120434, "body": "What is your formula supposed to look like? I imagine it&#39;s not what you expect with <code>&quot;=&quot; &amp; checkAddress &amp; &quot; = 0&quot;</code> - that looks like your trying to assign an address to be equal to 0 - but prefacing it with &quot;=&quot; sign. Doesn&#39;t make sense to me - what is it supposed to do?"}, {"owner": {"reputation": 37, "user_id": 6605427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d47dde2498124a63edcd2ac4ee20062f?s=128&d=identicon&r=PG&f=1", "display_name": "durba138", "link": "https://stackoverflow.com/users/6605427/durba138"}, "edited": false, "score": 0, "creation_date": 1470849315, "post_id": 38879524, "comment_id": 65120507, "body": "checkaddress holds the value In the location I gave it, so it differs in each column based on the for loop.. that&#39;s not the issue and its conditional formatting so if checkaddress value is 0, then turn the cell red, if its 15, turn the cell yellow, etc. The check address cell location will hold a value prior to running this sub"}, {"owner": {"reputation": 37, "user_id": 6605427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d47dde2498124a63edcd2ac4ee20062f?s=128&d=identicon&r=PG&f=1", "display_name": "durba138", "link": "https://stackoverflow.com/users/6605427/durba138"}, "edited": false, "score": 0, "creation_date": 1470850038, "post_id": 38879524, "comment_id": 65120878, "body": "checkaddress holds $E$33 but that&#39;s correct and I put r as lowercase"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470851374, "post_id": 38879524, "comment_id": 65121646, "body": "Your code works for me. Perhaps, close and restart excel?"}, {"owner": {"reputation": 37, "user_id": 6605427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d47dde2498124a63edcd2ac4ee20062f?s=128&d=identicon&r=PG&f=1", "display_name": "durba138", "link": "https://stackoverflow.com/users/6605427/durba138"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470851841, "post_id": 38879524, "comment_id": 65121913, "body": "@siddharthRout can I ask what version of excel you are using? I had 2007 when I built this and it worked, and then I switched to 2013 recently. Do you think that could be an issue?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470851862, "post_id": 38879524, "comment_id": 65121922, "body": "If  Excel is running in R1C1 Formula mode then you will get the error. Verify it is not in R1C1 mode"}, {"owner": {"reputation": 37, "user_id": 6605427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d47dde2498124a63edcd2ac4ee20062f?s=128&d=identicon&r=PG&f=1", "display_name": "durba138", "link": "https://stackoverflow.com/users/6605427/durba138"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470851990, "post_id": 38879524, "comment_id": 65122007, "body": "@siddharthrout ah you fixed it thank you"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470852153, "post_id": 38879524, "comment_id": 65122106, "body": "Awesome :) Didn&#39;t see your comment. I was posting an answer lol"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1470852010, "creation_date": 1470852010, "answer_id": 38880487, "question_id": 38879524, "link": "https://stackoverflow.com/questions/38879524/run-time-error-over-conditional-formatting-in-vba/38880487#38880487", "title": "Run time error over conditional formatting in VBA", "body": "<p>There is nothing wrong with your code. You are getting that error because Excel is running in <code>R1C1</code> mode. Switch it off and it will be fine :)</p>\n\n<ol>\n<li>Click on <code>File | Options | Formulas</code></li>\n<li>Un check <code>R1C1 Reference Style</code></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/ev3c0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ev3c0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 37, "user_id": 6605427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d47dde2498124a63edcd2ac4ee20062f?s=128&d=identicon&r=PG&f=1", "display_name": "durba138", "link": "https://stackoverflow.com/users/6605427/durba138"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 38880487, "answer_count": 1, "score": 1, "last_activity_date": 1470852010, "creation_date": 1470848595, "last_edit_date": 1470849022, "question_id": 38879524, "link": "https://stackoverflow.com/questions/38879524/run-time-error-over-conditional-formatting-in-vba", "title": "Run time error over conditional formatting in VBA", "body": "<p>So this was working, highlighting the cells to the right of the checkaddress value. Now it isn't and I cant figure out why. It gives the error \"Run-time error '5': Invalid procedure call or argument\". The error is in the first .Add statement, but commented it out, all the .Add statements error. </p>\n\n<pre><code>Sub Highlight4()\n\nFor i = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).row Step 2\n\n    If Cells(i, 4) = \"Metric\" Then\n        For j = 1 To 15\n\n        Dim r As Range\n        Set r = Range(Cells(i, j * 4 + 2), Cells(i + 1, j * 4 + 4))\n\n        Dim checkAddress As String\n        checkAddress = Cells(i, j * 4 + 1).Address\n\n        With r.FormatConditions\n            .Delete\n\n            .Add Type:=xlExpression, Formula1:=\"=\" &amp; checkAddress &amp; \" = 0\"\n            .Item(.Count).Interior.Color = rgbRed\n\n            .Add Type:=xlExpression, Formula1:=\"=\" &amp; checkAddress &amp; \" = 15\"\n            .Item(.Count).Interior.Color = rgbGold\n\n            .Add Type:=xlExpression, Formula1:=\"=\" &amp; checkAddress &amp; \" = 25\"\n            .Item(.Count).Interior.Color = rgbGreen\n        End With\n\n        Next j\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros", "excel-2010"], "comments": [{"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1470849614, "post_id": 38879469, "comment_id": 65120672, "body": "I&#39;m pretty sure you&#39;ll have to have the file open to paste values in it. You can write the VBA to open it before writing to it though and have it close it once it&#39;s done."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6701085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4401c646a6ec7df434d4550067afe55?s=128&d=identicon&r=PG&f=1", "display_name": "Scionara", "link": "https://stackoverflow.com/users/6701085/scionara"}, "edited": false, "score": 0, "creation_date": 1470853116, "post_id": 38879969, "comment_id": 65122644, "body": "Thank you very much. This works perfectly. How is it saving the destination workbook? I see that it is happening, but I don&#39;t see how it is told to do so in the code you provided."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 7, "user_id": 6701085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4401c646a6ec7df434d4550067afe55?s=128&d=identicon&r=PG&f=1", "display_name": "Scionara", "link": "https://stackoverflow.com/users/6701085/scionara"}, "edited": false, "score": 0, "creation_date": 1470853348, "post_id": 38879969, "comment_id": 65122799, "body": "In <code>destSht.Parent.Close True </code> the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838613.aspx\" rel=\"nofollow noreferrer\"><code>Close()</code></a> method is called passing<code>True</code> to its first parameter that is <i>SaveChanges</i>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1470850311, "creation_date": 1470850311, "answer_id": 38879969, "question_id": 38879469, "link": "https://stackoverflow.com/questions/38879469/copy-and-paste-values-from-a-workbook-into-a-closed-workbook/38879969#38879969", "title": "Copy and paste values from a workbook into a closed workbook", "body": "<p>avoid all that <code>Select</code>/<code>Selection</code> an refer to fully qualified ranges</p>\n\n<p>try this (commented) code:</p>\n\n<pre><code>Option Explicit\n\nSub copytoarchive()\n    Dim destSht As Worksheet\n\n    Workbooks.Open (\"C:\\...\\FileToCopyTo.xlsx\") '&lt;- at opening a workbook it becomes the active one\n    Set destSht = ActiveWorkbook.Worksheets(\"Archive\") '&lt;-- set the destination worksheet in the activeworkbook\n\n    With ThisWorkbook.Worksheets(\"DIC\") '&lt;--refer to your source worksheet in the workbook this macro resides in\n        With .Range(.Range(\"A4:Q4\"), .Range(\"A4:Q4\").End(xlDown)) '&lt;--| refer to your range whose values are to be copied\n            destSht.Cells(destSht.Rows.Count, 1).End(xlUp).Offset(1).Resize(.Rows.Count, .Columns.Count).Value = .Value '&lt;--| copy values in a equally sized range in destination worksheet starting at the first empty cell in column \"A\"\n        End With\n    End With\n\n    destSht.Parent.Close True '&lt;--| close the destination workbook, which is obtained as the Parent object of the destination worksheet\nEnd Sub\n</code></pre>\n\n<p>just change \"C:...\\FileToCopyTo.xlsx\" with your actual destination workbook full path </p>\n\n<p>be aware that such a range as you selected may incur in an error should there be no filled rows below \"A4:B4\"</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1471708880, "creation_date": 1471708880, "answer_id": 39056123, "question_id": 38879469, "link": "https://stackoverflow.com/questions/38879469/copy-and-paste-values-from-a-workbook-into-a-closed-workbook/39056123#39056123", "title": "Copy and paste values from a workbook into a closed workbook", "body": "<p>You can certainly copy a range from a closed workbook.</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s3/win024.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s3/win024.htm</a></p>\n\n<p>I don't believe you can save data to a closed workbook.  I can't even imagine how that would work.</p>\n"}], "owner": {"reputation": 7, "user_id": 6701085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4401c646a6ec7df434d4550067afe55?s=128&d=identicon&r=PG&f=1", "display_name": "Scionara", "link": "https://stackoverflow.com/users/6701085/scionara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5543, "favorite_count": 1, "accepted_answer_id": 38879969, "answer_count": 2, "score": 0, "last_activity_date": 1471708880, "creation_date": 1470848381, "question_id": 38879469, "link": "https://stackoverflow.com/questions/38879469/copy-and-paste-values-from-a-workbook-into-a-closed-workbook", "title": "Copy and paste values from a workbook into a closed workbook", "body": "<p>I'm fairly new to VBA coding, so please pardon any ignorance.\nHow can I copy from one sheet (DIC) in workbook 1 and paste values in a sheet (Archive) in a second workbook starting from the first empty row? I don't have the second worksheet open often, so if it can be done without keeping it open, that would be preferred.</p>\n\n<p>I compiled a code to get it to copy into a second sheet within the same workbook, but I'm stumped when it comes to getting it into the second workbook.</p>\n\n<p>Here's the code that I have so far: </p>\n\n<pre><code>    Sub copytoarchive()\n\n'Copy From DIC\n    Sheets(\"DIC\").Select\n    Range(\"A4:Q4\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n\n'Paste into Archive\n    Sheets(\"Archive\").Select\n     Dim NextRow As Range\n     Set NextRow = Range(\"A65536\").End(xlUp).Offset(1, 0)\n    NextRow.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n'Clear Memory\n    Set NextRow = Nothing\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470848748, "post_id": 38879166, "comment_id": 65120185, "body": "see answer below, you need to set the <code>.InitialFileName</code> to your default path (as a String)"}], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1470848728, "post_id": 38879553, "comment_id": 65120172, "body": "OT: lol, answered at the exact same time with almost the same answer, what are the odds of that?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1470848684, "creation_date": 1470848684, "answer_id": 38879553, "question_id": 38879166, "link": "https://stackoverflow.com/questions/38879166/directing-a-user-to-a-location-of-files-with-vba-excel/38879553#38879553", "title": "directing a user to a location of files with vba excel", "body": "<p>See my code below, it only handles a the part of your code where you add the parameter for default location the File Dialog opens.</p>\n\n<pre><code>Dim strPath As String\n\n' modify to your path here\nstrPath = \"C:\\Test\\\"\n\nSet fdlg = Application.FileDialog(fdlgType)\n\nWith fdlg\n    .Title = IIf(fdlgType = 3, \"Please select an Evidence FILE to link to\", _\n    \"Please select an Evidence FOLDER to link to\")\n    .ButtonName = IIf(fdlgType = 3, \"Select File\", \"Select Folder\")\n\n    ' set default path when opening the File Dialog\n    .InitialFileName = strPath\n    .Show\n\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 2, "last_activity_date": 1470848686, "creation_date": 1470848686, "answer_id": 38879554, "question_id": 38879166, "link": "https://stackoverflow.com/questions/38879166/directing-a-user-to-a-location-of-files-with-vba-excel/38879554#38879554", "title": "directing a user to a location of files with vba excel", "body": "<p>Set the Path were you want to direct the user, consider that it might be different due to user C:/myuser... so use ENVIRON like this:</p>\n\n<pre><code>Const InitialPath = \"\\Documents\"\nWith fdlg\n    .Title = IIf(fdlgType = 3, \"Please select an Evidence FILE to link to\", _\n                               \"Please select an Evidence FOLDER to link to\")\n    .ButtonName = IIf(fdlgType = 3, \"Select File\", \"Select Folder\")\n    .Show\n    .InitialFileName = Environ(\"USERPROFILE\") &amp; InitialPath\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6621972, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6183e694ff738f23fbfc21fc6d9ba436?s=128&d=identicon&r=PG&f=1", "display_name": "cfaidl05", "link": "https://stackoverflow.com/users/6621972/cfaidl05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 38879554, "answer_count": 2, "score": 0, "last_activity_date": 1470848686, "creation_date": 1470847378, "question_id": 38879166, "link": "https://stackoverflow.com/questions/38879166/directing-a-user-to-a-location-of-files-with-vba-excel", "title": "directing a user to a location of files with vba excel", "body": "<p>I am trying to let a user select a folder from pressing a button in a vba form, but when I press the button it directs me to documents. How would I direct my user to a specific location of files?</p>\n\n<p>here is some of my code</p>\n\n<pre><code>   lnkNm = InputBox(\"please enter link description\")\n   Application.ScreenUpdating = False\n   fdlgType = 4\n\n   set fdlg = Application.FileDialog(fdlgType)\n\n    With fdlg\n    .Title = IIf(fdlgType = 3, \"Please select an Evidence FILE to link to\", _\n                               \"Please select an Evidence FOLDER to link to\")\n    .ButtonName = IIf(fdlgType = 3, \"Select File\", \"Select Folder\")\n    .Show\n    For Each itm In .SelectedItems\n        strFileToLink = itm\n          'Checking if file is selected.\n        If strFileToLink = vbNullString Then\n            'Displaying a message if file not choosen in the above step.\n            MsgBox \"No file selected.\", vbExclamation, \"Sorry\"\n            'And exiting from the procedure.\n            Exit Sub\n        Else\n</code></pre>\n\n<p>thank you in advance for anyone with help.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1470846459, "post_id": 38878829, "comment_id": 65118934, "body": "Not sure as to your main question about why <code>Not</code> is being weird. ...but does it work as you expect if you replace that with <code>rng.Characters(iEnd, 1).Font.Italic = False</code>?"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1470846626, "post_id": 38878829, "comment_id": 65119028, "body": "@BruceWayne Yes even when I try setting it False it brings the same result."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1470848570, "post_id": 38879461, "comment_id": 65120077, "body": "So it wasn&#39;t the <code>Not</code> acting funky, but the first part? And I&#39;m surprised you can&#39;t get a boolean value from <code>.underline</code>, kind of counter intuitive since you can with italics/bold"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470848572, "post_id": 38879461, "comment_id": 65120078, "body": "with only <code>xlUnderlineStyleSingle</code> in the loop condition, any entry without without underline will get skipped, whether or not its italic."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470848722, "post_id": 38879461, "comment_id": 65120162, "body": "@cyboashu: If my understanding is correct, OP wants to skip text which is not underlined"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470848881, "post_id": 38879461, "comment_id": 65120263, "body": "ah... OK,. he had first row in his expected data set, so i thought he is looking for w/o underlines too.:)"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 1, "creation_date": 1470849060, "post_id": 38879461, "comment_id": 65120375, "body": "Thanks for the help!"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 4, "last_activity_date": 1470848340, "creation_date": 1470848340, "answer_id": 38879461, "question_id": 38878829, "link": "https://stackoverflow.com/questions/38878829/vba-array-extract-data/38879461#38879461", "title": "VBA Array extract data", "body": "<p><code>.Font.Underline</code> doesn't return a <code>Boolean(True/False)</code> ;) It returns an <code>Long</code></p>\n\n<p>If you add a <code>Watch</code> you can see it for yourself.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GeCoK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GeCoK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Change your code to </p>\n\n<pre><code>Do While rng.Characters(iEnd, 1).Font.Underline = xlUnderlineStyleSingle _\nAnd Not rng.Characters(iEnd, 1).Font.Italic\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 1, "creation_date": 1470849076, "post_id": 38879490, "comment_id": 65120384, "body": "Thanks for the help!"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 2, "last_activity_date": 1470848459, "creation_date": 1470848459, "answer_id": 38879490, "question_id": 38878829, "link": "https://stackoverflow.com/questions/38878829/vba-array-extract-data/38879490#38879490", "title": "VBA Array extract data", "body": "<p>Change while condition to this :</p>\n\n<p>Underline is not <code>boolean</code>.</p>\n\n<pre><code> Do While (rng.Characters(iEnd, 1).Font.Underline = -4142 Or _\n                 (rng.Characters(iEnd, 1).Font.Underline = 2 And _\n                 Not rng.Characters(iEnd, 1).Font.Italic))\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1470852089, "creation_date": 1470852089, "answer_id": 38880502, "question_id": 38878829, "link": "https://stackoverflow.com/questions/38878829/vba-array-extract-data/38880502#38880502", "title": "VBA Array extract data", "body": "<p>Your code is truncating the last character.</p>\n\n<pre><code>Function GetUnderlines(rng As Range) As Variant\n    Dim strng As String\n    Dim iEnd As Long, iIni As Long, strngLen As Long\n\n    strngLen = Len(rng.Value2)\n    iIni = 1\n\n    Do While iEnd &lt;= strngLen\n        Do While rng.Characters(iEnd, 1).Font.Underline = xlUnderlineStyleSingle And Not rng.Characters(iEnd, 1).Font.Italic And rng.Characters(iEnd, 1).Text &lt;&gt; \" \"\n            iEnd = iEnd + 1\n            If iEnd &gt; strngLen Then Exit Do\n        Loop\n\n        If iEnd &gt; iIni Then\n            strng = strng &amp; Mid(rng.Value2, iIni, iEnd - iIni) &amp; \"|\"\n\n        End If\n        iEnd = iEnd + 1\n        iIni = iEnd\n    Loop\n\n    If strng &lt;&gt; \"\" Then GetUnderlines = Split(Left(strng, Len(strng) - 1), \"|\")\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 1, "accepted_answer_id": 38879461, "answer_count": 3, "score": 1, "last_activity_date": 1470852089, "creation_date": 1470846162, "question_id": 38878829, "link": "https://stackoverflow.com/questions/38878829/vba-array-extract-data", "title": "VBA Array extract data", "body": "<p>When the \"Not\" in \"And Not rng.Characters(iEnd, 1).Font.Italic\" is left out the code is able to pull italicized and underlined words but when I place a \"Not\" in the code to pull out the underlined and not italicized words it doesn't work. I'm not exactly sure why the \"Not\" wouldnt work. The pictures below are the source sheet and the new sheet with the extracted data. Im able to use the code to get underlined and italicized but I'm adding the Not so I can  get underlined but not italicized. The data that is supposed to come out is line 5 from the picture labeled 1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yyliY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yyliY.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/yB6S5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yB6S5.png\" alt=\"enter image description here\"></a></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Sub extract()        \r\n    Dim dataRng As Range, cl As Range\r\n    Dim marr As Variant\r\n    \r\n    Set dataRng = Worksheets(\"Sheet1\").Range(\"C1:C10\")\r\n    \r\n    With Worksheets(\"Sheet2\")\r\n        For Each cl In dataRng\r\n            marr = GetUnderlines(cl)\r\n            If IsArray(marr) Then .Cells(.Rows.Count, 4).End(xlUp).Offset(1).Resize(UBound(marr) + 1) = Application.Transpose(marr)\r\n        Next\r\n    End With\r\n    \r\nEnd Sub\r\nFunction GetUnderlines(rng As Range) As Variant\r\n    Dim strng As String\r\n    Dim iEnd As Long, iIni As Long, strngLen As Long\r\n\r\n    strngLen = Len(rng.Value2)\r\n    iIni = 1\r\n    \r\n    Do While iEnd &lt;= strngLen\r\n        Do While rng.Characters(iEnd, 1).Font.Underline And Not rng.Characters(iEnd, 1).Font.Italic\r\n            If iEnd = strngLen Then Exit Do\r\n            iEnd = iEnd + 1\r\n        Loop\r\n        If iEnd &gt; iIni Then strng = strng &amp; Mid(rng.Value2, iIni, iEnd - iIni) &amp; \"|\"\r\n        iEnd = iEnd + 1\r\n        iIni = iEnd\r\n    Loop\r\n    \r\n    If strng &lt;&gt; \"\" Then GetUnderlines = Split(Left(strng, Len(strng) - 1), \"|\")\r\n\r\nEnd Function</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1470844794, "post_id": 38878175, "comment_id": 65117878, "body": "Did you try adding <code>DoEvents</code>? Or even <code>Saving</code> the file before closing? If the calculation is set to automatic then the cells will calculate."}, {"owner": {"reputation": 21, "user_id": 3977650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbaee1e89e5d94a36d59191198e6b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Gr&#246;ndal", "link": "https://stackoverflow.com/users/3977650/elias-gr%c3%b6ndal"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470893723, "post_id": 38878175, "comment_id": 65136407, "body": "Sorry for not giving the full story. Yes, I have tried both DoEvents and Saving. I also have tried Calculate but it still closes too quickly. Since the Cubevalue"}, {"owner": {"reputation": 21, "user_id": 3977650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbaee1e89e5d94a36d59191198e6b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Gr&#246;ndal", "link": "https://stackoverflow.com/users/3977650/elias-gr%c3%b6ndal"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470894965, "post_id": 38878175, "comment_id": 65136861, "body": "Sorry for not giving the full story. Yes, I have tried both DoEvents and Saving. I also have tried Calculate but it still closes too quickly. It seems like Cubevalue is trying to retrieve the information after it has calculated. No matter how long wait time, calculate or doevents I put CubeValue does not calculate properly. However, I have noticed that if I put a manual breakpoint in the code then it calculates properly. So, how can I halt the macro for 10 seconds and have excel function normally in the meantime?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470895029, "post_id": 38878175, "comment_id": 65136892, "body": "See the code that I posted :)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 3977650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbaee1e89e5d94a36d59191198e6b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Gr&#246;ndal", "link": "https://stackoverflow.com/users/3977650/elias-gr%c3%b6ndal"}, "edited": false, "score": 0, "creation_date": 1470896455, "post_id": 38888066, "comment_id": 65137528, "body": "Thank you! That might have worked. I actually just solved it another way, code below!                             <code>Application.CalculateUntilAsyncQueriesDone                                                                                      Do While Application.CalculationState &lt;&gt; xlDone                                 DoEvents                             Loop</code>"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1470894079, "creation_date": 1470894079, "answer_id": 38888066, "question_id": 38878175, "link": "https://stackoverflow.com/questions/38878175/vba-get-cube-update-time-with-formula-need-to-delay-macro-execution/38888066#38888066", "title": "vba Get Cube update time with formula Need to delay macro execution", "body": "<p>Try this Wait code that I wrote many years ago. This will wait for specified seconds and let excel calculate it's formula. Simply change <code>10</code> to whatever number you want.</p>\n\n<pre><code>Sub Sample()\n    '\n    '~~~&gt; Rest of your code\n    '\n    Wait 10 '&lt;~~ Wait for 10 secs\n    '\n    '~~~&gt; Rest of your code\n    '\nEnd Sub\n\nPrivate Sub Wait(ByVal nSec As Long)\n    nSec = nSec + Timer\n    While nSec &gt; Timer\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3977650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbaee1e89e5d94a36d59191198e6b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Gr&#246;ndal", "link": "https://stackoverflow.com/users/3977650/elias-gr%c3%b6ndal"}, "is_accepted": false, "score": 1, "last_activity_date": 1470896728, "creation_date": 1470896728, "answer_id": 38888732, "question_id": 38878175, "link": "https://stackoverflow.com/questions/38878175/vba-get-cube-update-time-with-formula-need-to-delay-macro-execution/38888732#38888732", "title": "vba Get Cube update time with formula Need to delay macro execution", "body": "<p>Just want to share my solution. Found the CalculateUntilAsyncQueriesDone Method which handles OLAP data sources:</p>\n\n<pre><code>                        Application.CalculateUntilAsyncQueriesDone\n\n                        Do While Application.CalculationState &lt;&gt; xlDone\n                            DoEvents\n                        Loop\n</code></pre>\n\n<p>More info here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821008.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff821008.aspx</a></p>\n"}], "owner": {"reputation": 21, "user_id": 3977650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbaee1e89e5d94a36d59191198e6b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Elias Gr&#246;ndal", "link": "https://stackoverflow.com/users/3977650/elias-gr%c3%b6ndal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1558, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1589476451, "creation_date": 1470844234, "last_edit_date": 1470897945, "question_id": 38878175, "link": "https://stackoverflow.com/questions/38878175/vba-get-cube-update-time-with-formula-need-to-delay-macro-execution", "title": "vba Get Cube update time with formula Need to delay macro execution", "body": "<p>I have a cube connected to Pivots in excel.\nIn one cell i display the \"latest updated\" value by this formula:</p>\n\n<pre><code>=CUBEVALUE(\"CUBE NAME\";\"[Measures].[Last Data Update]\")\n</code></pre>\n\n<p>It takes 5-10 seconds for excel to get the time of update from the cube and update the cell. So, if i close the workbook directly after it will just say n/a when I reopen the workbook.</p>\n\n<p>I have scheduled this wb to autoupdate (among other wbs) through another wb that is scheduled to run every day. \nWith that I get the n/a problem.\nI see two solutions which I don\u00b4t know how to get to:</p>\n\n<p>1, Halt the macro for 10 seconds so it can get the date correctly.\n- I have tried both Wait and Sleep Vba but this also pauses calculations.\n- is there any way to only pause the macro from executing?</p>\n\n<p>2, Get the update date by vba and then print it to a cell.\n- I have no idea how to do this. I have searched but not found any alternative.\n- Does anyone know how this could be made possible?</p>\n\n<p>Thanks\nElias</p>\n\n<p>SOLVED:</p>\n\n<p>Just want to share my solution. Found the CalculateUntilAsyncQueriesDone Method which handles OLAP data sources:</p>\n\n<pre><code>                    Application.CalculateUntilAsyncQueriesDone\n\n                    Do While Application.CalculationState &lt;&gt; xlDone\n                        DoEvents\n                    Loop\n</code></pre>\n\n<p>More info here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821008.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff821008.aspx</a></p>\n"}, {"tags": ["vba", "outlook", "ms-word", "html-email"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "edited": false, "score": 0, "creation_date": 1470848437, "post_id": 38879224, "comment_id": 65120021, "body": "I called the .HTMLBody with msg, but it did not input the signature. There was not change on how the email executed in Outlook. Either way, Thanks for the suggestion."}], "tags": [], "owner": {"reputation": 33, "user_id": 3276200, "user_type": "registered", "profile_image": "https://graph.facebook.com/10138546/picture?type=large", "display_name": "mike vervair", "link": "https://stackoverflow.com/users/3276200/mike-vervair"}, "is_accepted": false, "score": 0, "last_activity_date": 1470847561, "creation_date": 1470847561, "answer_id": 38879224, "question_id": 38878070, "link": "https://stackoverflow.com/questions/38878070/how-to-insert-an-existing-signature-block-into-outlook-htmlbody-from-word-vba/38879224#38879224", "title": "How to insert an existing signature block into Outlook .htmlbody from Word VBA", "body": "<p>I think you need to call the .HTMLBody again after you insert msg.</p>\n\n<p>So for example:</p>\n\n<pre><code>.HTMLBody = msg &amp; .HTMLBody\n</code></pre>\n\n<p>Should get the signature. I'm not deep enough into programming to know why though.</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "edited": false, "score": 0, "creation_date": 1470850398, "post_id": 38879804, "comment_id": 65121069, "body": "Dbmitch, I just seen your message. I was doing exactly and posted my answer"}, {"owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "edited": false, "score": 0, "creation_date": 1470850492, "post_id": 38879804, "comment_id": 65121130, "body": "It did not work at first. I had to recall the .HTMLBody with my message as suggested by the first vervair in the first comment to make it all work. Thanks to all for your help."}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1470849654, "creation_date": 1470849654, "answer_id": 38879804, "question_id": 38878070, "link": "https://stackoverflow.com/questions/38878070/how-to-insert-an-existing-signature-block-into-outlook-htmlbody-from-word-vba/38879804#38879804", "title": "How to insert an existing signature block into Outlook .htmlbody from Word VBA", "body": "<p>Do you have <code>Option Explicit</code> set in your module? </p>\n\n<p>I don't see where you've set Signature or declared it so it's probably empty and not giving you an error message.</p>\n\n<p>I think you need to retrieve it first by pulling in the blank Body</p>\n\n<p><strong><em>Something like this should work</em></strong></p>\n\n<pre><code>With EmailItem\n   .Display\n   signature = .body\n   .Subject = \"QFORM\" &amp; \"_\" &amp; JNumber.Value &amp; \"_\" &amp; VName.Value\n' and so on ..\n</code></pre>\n\n<p>`</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "is_accepted": false, "score": 0, "last_activity_date": 1470850212, "creation_date": 1470850212, "answer_id": 38879940, "question_id": 38878070, "link": "https://stackoverflow.com/questions/38878070/how-to-insert-an-existing-signature-block-into-outlook-htmlbody-from-word-vba/38879940#38879940", "title": "How to insert an existing signature block into Outlook .htmlbody from Word VBA", "body": "<p>The code was successful with inputting a with statement to display the EmailItem - along with recalling .HTMLBody following the msg..  Please see full code below. </p>\n\n<pre><code>Private Sub emailbutton_Click()\n    'No-option email sending\n    Dim OL              As Object\n    Dim EmailItem       As Object\n    Dim Doc             As Document\n\n    Application.ScreenUpdating = False\n    Set OL = CreateObject(\"Outlook.Application\")\n    Set EmailItem = OL.CreateItem(olMailItem)\n    Set Doc = ActiveDocument\n\n   With EmailItem\n    .Display\n    End With\n        Signature = EmailItem.body\n\n\n    With EmailItem\n        .Subject = \"QFORM\" &amp; \"_\" &amp; JNumber.Value &amp; \"_\" &amp; VName.Value\n\n        'HTMLbody\n        msg = \"&lt;b&gt;&lt;font face=\"\"Times New Roman\"\" size=\"\"4\"\" color=\"\"blue\"\"&gt;INTEGRATED ASSEMBLY &lt;/font&gt;&lt;/b&gt;&lt;br&gt;\" _\n        &amp; \"   1200 Woodruff Rd.&lt;br&gt;\" _\n        &amp; \"   Suite A12&lt;br&gt;\" _\n        &amp; \"   Greenville, SC 29607&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"We have recently released subject project, which will contain assemblies to be outsourced. You have been selected to build these assemblies according to the attachment. &lt;br&gt;&lt;br&gt;\" _\n        &amp; \"As part of this process, please review the quotation form attached and indicate your acceptance. If adjustments and-or corrections are required, please feel free to contact us for quick resolution. &lt;br&gt;&lt;br&gt;\" _\n        &amp; \"&lt;b&gt;&lt;font face=\"\"Times New Roman\"\" size=\"\"4\"\" color=\"\"Red\"\"&gt;NOTE: &lt;/font&gt;&lt;/b&gt;\" _\n        &amp; \"The information on attached quotation form is not a contract and only an estimate of predetermined costs per hourly rate for outsource assemblies. &lt;br&gt;&lt;br&gt;\" _\n        &amp; \"*******For your records you may wish to print out the completed quote form. &lt;br&gt;&lt;br&gt;\" _\n        &amp; \"Thank you, &lt;br&gt;&lt;br&gt;\" _\n        &amp; \"&lt;b&gt;HARTNESS INTERNATIONAL &lt;/b&gt;&lt;br&gt;\" _\n        &amp; \"H1 Production Control &lt;br&gt;\" _\n        &amp; vbNewLine &amp; Signature\n\n        .HTMLBody = msg &amp; .HTMLBody\n\n        If VName.Value = \"INTEGRATED ASSEMBLY\" Then\n            .To = \"ryan@integratedassembly.com;\"\n            .CC = \"jfournier@hartness.com;\" &amp; \"jmarshone@hartness.com;\"\n            .Importance = olImportanceNormal 'Or olImportanceHigh Or         olImportanceLow\n            .Attachments.Add Doc.FullName\n            .Display\n         ElseIf VName.Value = \"LEWALLEN\" Then\n            .To = \"jessica.andrews@patriot-automation.com;\"\n            .CC = \"jfournier@hartness.com;\" &amp; \"jmarshone@hartness.com;\"\n            .Importance = olImportanceNormal 'Or olImportanceHigh Or         olImportanceLow\n            .Attachments.Add Doc.FullName\n            .Display\n\n         End If\n    End With\n\n\n    If VName.Value = \"\" Then\n        Doc.SaveAs (\"Quotation_Blank 2016\")\n    Else\n       Doc.SaveAs2 (\"QFORM\" &amp; \"_\" &amp; JNumber.Value &amp; \"_\" &amp; VName.Value)\n\n    End If\n\n    Application.ScreenUpdating = True\n\n    Set Doc = Nothing\n    Set OL = Nothing\n    Set EmailItem = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 765, "favorite_count": 0, "closed_date": 1470850609, "answer_count": 3, "score": 1, "last_activity_date": 1593416129, "creation_date": 1470843880, "last_edit_date": 1593416129, "question_id": 38878070, "link": "https://stackoverflow.com/questions/38878070/how-to-insert-an-existing-signature-block-into-outlook-htmlbody-from-word-vba", "closed_reason": "Duplicate", "title": "How to insert an existing signature block into Outlook .htmlbody from Word VBA", "body": "<p>I have completed this code to populate the body of an Outlook email, however, I do not know how I can use my existing signature block already created in Outlook. When I create a new, reply or forward email, my signature is there, but when I create the email with this code it does not appear. What I'm trying to accomplish here is to have my signature (or any signature for that matter) appear into the email created by this code. </p>\n\n<p><a href=\"https://i.stack.imgur.com/cdZgh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cdZgh.jpg\" alt=\"Sample email with desired signature\"></a></p>\n\n<pre><code>    Private Sub emailbutton_Click()\n    'No-option email sending\n    Dim OL              As Object\n    Dim EmailItem       As Object\n    Dim Doc             As Document\n\n    Application.ScreenUpdating = False\n    Set OL = CreateObject(\"Outlook.Application\")\n    Set EmailItem = OL.CreateItem(olMailItem)\n    Set Doc = ActiveDocument\n\n\n    If VName.Value = \"\" Then\n        Doc.SaveAs (\"Quotation_Blank 2016\")\n    Else\n       Doc.SaveAs2 (\"QFORM\" &amp; \"_\" &amp; JNumber.Value &amp; \"_\" &amp; VName.Value)\n\n    End If\n\n\n    With EmailItem\n        .Subject = \"QFORM\" &amp; \"_\" &amp; JNumber.Value &amp; \"_\" &amp; VName.Value\n\n        'HTMLbody\n        msg = \"&lt;b&gt;&lt;font face=\"\"Times New Roman\"\" size=\"\"3\"\" color=\"\"blue\"\"&gt;INTEGRATED ASSEMBLY &lt;/font&gt;&lt;/b&gt;&lt;br&gt;\" _\n        &amp; \"   1200 Woodruff Rd.&lt;br&gt;\" _\n        &amp; \"   Suite A12&lt;br&gt;\" _\n        &amp; \"   Greenville, SC 29607&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"We have recently released subject project, which will contain assemblies to be outsourced. You have been selected to build these assemblies according to the attachment.&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"As part of this process, please review the quotion form attached and inidcate your acceptance. If adjustments and-or corrections are required please feel free to contact us for quick resolution.&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"&lt;b&gt;&lt;font face=\"\"Times New Roman\"\" size=\"\"3\"\" color=\"\"Red\"\"&gt;NOTE: &lt;/font&gt;&lt;/b&gt;\" _\n        &amp; \"The information on attached quotation form is not a contract and only an estimate of predetermined costs per hourly rate for outsource assemblies. &lt;br&gt;&lt;br&gt;\" _\n        &amp; \"*******For your records you may wish to print out the completed quote form. &lt;br&gt;&lt;br&gt;\" _\n        &amp; \"Thank you, &lt;br&gt;&lt;br&gt;\" _\n        &amp; \"&lt;b&gt;HARTNESS INTERNATIONAL &lt;/b&gt;&lt;br&gt;\" _\n        &amp; \"H1 Production Control\" &amp; vbNewLine &amp; Signature\n\n\n        .HTMLBody = msg\n\n        If VName.Value = \"INTEGRATED ASSEMBLY\" Then\n            .To = \"XXX.com;\"\n            .CC = \"XXX.com;\" &amp; \"XXX.com;\"\n            .Importance = olImportanceNormal 'Or olImportanceHigh Or         olImportanceLow\n            .Attachments.Add Doc.FullName\n            .Display\n         ElseIf VName.Value = \"LEWALLEN\" Then\n            .To = \"XXX.com;\"\n            .CC = \"XXX.com;\" &amp; \"XXX.com;\"\n            .Importance = olImportanceNormal 'Or olImportanceHigh Or         olImportanceLow\n            .Attachments.Add Doc.FullName\n            .Display\n\n         End If\n    End With\n\n    Application.ScreenUpdating = True\n\n    Set Doc = Nothing\n    Set OL = Nothing\n    Set EmailItem = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-project"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471173589, "post_id": 38877773, "comment_id": 65238439, "body": "are the projects you are looking to see if they are checked out inside a master project ?"}, {"owner": {"reputation": 368, "user_id": 1200018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8749da21ee69353906da55ae7d41d423?s=128&d=identicon&r=PG", "display_name": "David Welker", "link": "https://stackoverflow.com/users/1200018/david-welker"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1471283920, "post_id": 38877773, "comment_id": 65275113, "body": "No, these are not part of a master project. We currently have master projects disallowed."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1471356256, "post_id": 38877773, "comment_id": 65307003, "body": "@David. I think this snippet from Microsoft might help:  <a href=\"https://msdn.microsoft.com/en-us/library/office/jj820423.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/jj820423.aspx</a>. Basically you want to select the Project from the Projects collection, and check the type of project that it is (enterprise vs not). Then there are some methods at the Project level for checking in and out."}, {"owner": {"reputation": 368, "user_id": 1200018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8749da21ee69353906da55ae7d41d423?s=128&d=identicon&r=PG", "display_name": "David Welker", "link": "https://stackoverflow.com/users/1200018/david-welker"}, "edited": false, "score": 0, "creation_date": 1471368370, "post_id": 38877773, "comment_id": 65314643, "body": "Thanks Ryan, I&#39;ve attempted this code before, and it will only check currently opened projects, but will not look through the enterprise projects."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1471371549, "post_id": 38877773, "comment_id": 65316522, "body": "What Project.Type are being returned iterating through each project in projects collection?"}, {"owner": {"reputation": 368, "user_id": 1200018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8749da21ee69353906da55ae7d41d423?s=128&d=identicon&r=PG", "display_name": "David Welker", "link": "https://stackoverflow.com/users/1200018/david-welker"}, "edited": false, "score": 0, "creation_date": 1471376477, "post_id": 38877773, "comment_id": 65319170, "body": "It does not iterate through the projects, it only returns the Project File that is currently opened. If I am able to set the project object to an enterprise Project file by just passing in a project name, I could make this workable. But I have not seen an example of that anywhere either."}], "answers": [{"tags": [], "owner": {"reputation": 368, "user_id": 1200018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8749da21ee69353906da55ae7d41d423?s=128&d=identicon&r=PG", "display_name": "David Welker", "link": "https://stackoverflow.com/users/1200018/david-welker"}, "is_accepted": true, "score": 1, "last_activity_date": 1472584784, "creation_date": 1472584784, "answer_id": 39235488, "question_id": 38877773, "link": "https://stackoverflow.com/questions/38877773/is-there-vba-code-to-see-if-enterprise-project-2013-file-is-checked-out-before-o/39235488#39235488", "title": "Is there VBA Code to see if Enterprise Project 2013 file is checked out before opening?", "body": "<p>We created a workaround that works for the planners, but we do have to open the file either way. What this will do is open the file in Read Only mode, then attempt to check it out without alerts. Afterwards, if I have it checked out (which means no one else had it checked out), it'll set j=0 and save, then move on to the next project. If someone else has it checked out, then it'll go to 'errorhandler' which tells the project to close without saving, and save the filename in a string to be returned later.</p>\n\n<pre><code>SelectBeginning\nWhile ActiveCell.CellColor &lt;&gt; pjBlack\n   fname = \"&lt;&gt;\\\" &amp; ActiveCell.Task.Name\n   justname = ActiveCell.Task.Name\n   FileOpenEx Name:=fname, ReadOnly=true\n   Set ProjToOpen = Application.Projects.Application.ActiveProject\n   j = 1\n   Application.DisplayAlerts = False\n   ProjToOpen.Checkout Project\n   Application.DisplayAlerts = True\n\n   If Not Application.IsCheckedOut(ProjToOpen.Name) Then\n      GoTo errorhandler\n   End If\n\n   'Perform actions here\n\n   j = 0\n   FileCloseEx Save:=pjSave, CheckIn:=True\n   FileSave\nerrorhandler: \n   If Not j = 0 Then\n      ReDim Preserve skippedfiles(0 to skipped) As String\n      skippedfiles(skipped) = justname\n      skipped = skipped + 1\n      ProjToOpen.Application.FileCloseEx Save:=pjDoNotSave\n      GoTo GoToNextProj\n   End If\n\nGoToNextProj:\n   SelectCell Row:=1\n\nWend\nmsgstring = Join(skippedfiles(), vbCr)\n\nMsgBox \"Here are the files that were already checked out and therefore not changed: \" &amp; vbCr &amp; msgstring\n</code></pre>\n"}], "owner": {"reputation": 368, "user_id": 1200018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8749da21ee69353906da55ae7d41d423?s=128&d=identicon&r=PG", "display_name": "David Welker", "link": "https://stackoverflow.com/users/1200018/david-welker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 39235488, "answer_count": 1, "score": 7, "last_activity_date": 1593559483, "creation_date": 1470843056, "last_edit_date": 1593559483, "question_id": 38877773, "link": "https://stackoverflow.com/questions/38877773/is-there-vba-code-to-see-if-enterprise-project-2013-file-is-checked-out-before-o", "title": "Is there VBA Code to see if Enterprise Project 2013 file is checked out before opening?", "body": "<p>Trying to help our Project 2013 Users out with some VBA code, and we have come to a point where we can't seem to find an answer for finding if a Project 2013 file is checked out on our PWA server using VBA. They basically have a list of Projects set as tasks in a single Project file, and the VBA code loops through the list of tasks to run FileOpenEx, do some changes, and then closes it. However, the need is to be able to check to see if the Project File is checked out prior to running FileOpenEx on each Project in the list. Here is a sample of what I'm going for that doesn't quite do what I want it to.</p>\n\n<pre><code>SelectBeginning\nWhile ActiveCell.CellColor &lt;&gt; pjBlack\n   fname = \"&lt;&gt;\\\" &amp; ActiveCell.Task.Name\n   justname = ActiveCell.Task.Name\n\n   On Error Resume Next\n   If Application.Projects.CanCheckOut(fname) Then '&lt;--This does not work correctly, not checking Enterprise Projects?\n       FileOpenEx Name:=fname, ReadOnly=false\n       'Do Some stuff\n       FileCloseEx Save:=pjSave, CheckIn:=True\n       FileSave\n   Else\n      MsgBox (justname &amp; \" can not be checked out\")\n   End If\n\n   SelectCell Row:=1\nWend\n</code></pre>\n\n<p>If anyone has a better solution, an easy way to check this, or another workaround to finding out if an Enterprise Project is checked out through VBA code, please let me know. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1470843779, "post_id": 38877627, "comment_id": 65117223, "body": "You could push the numbers into an array then bring them out in different order, but what happens if someone leaves or joins?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6700103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2495413ab4db5725a80aa70da1a23842?s=128&d=identicon&r=PG&f=1", "display_name": "Palle Kjellstrand", "link": "https://stackoverflow.com/users/6700103/palle-kjellstrand"}, "edited": false, "score": 0, "creation_date": 1470913419, "post_id": 38887493, "comment_id": 65148274, "body": "Thank you!! It works like a charm, and I really learned something in the process! =)  Many many thanks!"}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "reply_to_user": {"reputation": 5, "user_id": 6700103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2495413ab4db5725a80aa70da1a23842?s=128&d=identicon&r=PG&f=1", "display_name": "Palle Kjellstrand", "link": "https://stackoverflow.com/users/6700103/palle-kjellstrand"}, "edited": false, "score": 0, "creation_date": 1470916163, "post_id": 38887493, "comment_id": 65150048, "body": "You&#39;re welcome. Actually, you could make the code a little less verbose by writing a small counter function which returns the <code>emplCount</code> and <code>tempEmplCount</code> values based on the same rules (conditionals) as the original code, but I&#39;ll leave that up to you ;-)"}, {"owner": {"reputation": 5, "user_id": 6700103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2495413ab4db5725a80aa70da1a23842?s=128&d=identicon&r=PG&f=1", "display_name": "Palle Kjellstrand", "link": "https://stackoverflow.com/users/6700103/palle-kjellstrand"}, "edited": false, "score": 0, "creation_date": 1470945190, "post_id": 38887493, "comment_id": 65168628, "body": "Thanks! I&#39;ll look into it but I thought the code you suggested gave me a good overview of what was going on, so I think I&#39;ll go with that so I can easily go back and look at it again if I encounter some similar problem :)"}], "tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": true, "score": 0, "last_activity_date": 1470892900, "last_edit_date": 1470892900, "creation_date": 1470891165, "answer_id": 38887493, "question_id": 38877627, "link": "https://stackoverflow.com/questions/38877627/sorting-names-for-an-on-call-schedule-using-vba/38887493#38887493", "title": "Sorting names for an on-call schedule using VBA", "body": "<p>Here is an algorithm which will produce the desired results:</p>\n\n<pre><code>Sub createDutyRoster(numOfEmployees As Integer, numOfWeeks As Integer)\n\n    Dim dutyRosterWS As Excel.Worksheet\n    Dim emplCount As Integer, i As Integer, n As Integer, tempEmplCount As Integer\n\n    Set dutyRosterWS = ThisWorkbook.Sheets(\"Duty Roster\")\n\n    With dutyRosterWS\n\n        ' insert headers\n        .Cells(1, 1) = \"Week/day\"\n        .Cells(1, 2) = \"Monday\"\n        .Cells(1, 3) = \"Tuesday\"\n        .Cells(1, 4) = \"Wednesday\"\n        .Cells(1, 5) = \"Thursday\"\n        .Cells(1, 6) = \"Friday\"\n\n        For i = 1 To numOfWeeks\n\n            ' weeks\n            .Cells(i + 1, 1) = i\n\n            ' employee count\n            If emplCount &lt; numOfEmployees Then\n                emplCount = emplCount + 1\n            ElseIf emplCount = numOfEmployees Then\n                emplCount = 1\n            End If\n            tempEmplCount = emplCount\n\n            ' insert for monday to friday\n            For n = 2 To 6\n                .Cells(i + 1, n) = tempEmplCount\n                If tempEmplCount &lt; numOfEmployees Then\n                    tempEmplCount = tempEmplCount + 1\n                ElseIf tempEmplCount = numOfEmployees Then\n                    tempEmplCount = 1\n                End If\n            Next n\n\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>How it works</strong></p>\n\n<ol>\n<li>Add a new worksheet called \"Duty Roster\" (or rename it in the code)</li>\n<li>Call the subroutine with the following parameters: a) the number of employees, b) the number of iso weeks in the given year (some years have 53 iso weeks not just 52). E.g. <code>Call createDutyRoster(15, 52)</code></li>\n</ol>\n\n<p><strong>Example with 15 employees</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/xepm0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xepm0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 6700103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2495413ab4db5725a80aa70da1a23842?s=128&d=identicon&r=PG&f=1", "display_name": "Palle Kjellstrand", "link": "https://stackoverflow.com/users/6700103/palle-kjellstrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 38887493, "answer_count": 1, "score": 0, "last_activity_date": 1470892900, "creation_date": 1470842667, "last_edit_date": 1531164843, "question_id": 38877627, "link": "https://stackoverflow.com/questions/38877627/sorting-names-for-an-on-call-schedule-using-vba", "title": "Sorting names for an on-call schedule using VBA", "body": "<p>I am fairly new to programing in VBA (or programing at all) so excuse me in advance if my question is a little dumb.</p>\n\n<p>I have the problem of trying to create a code that can automatically fill in a schedule at work. The schedule is supposed to be able to take any number of employees and assign their names on a repeating schedule based on monday to friday within all 52 weeks of the year (The schedule excludes holidays, the employers themselves will have to fill in the days when buisness is closed). </p>\n\n<p>What I am trying to do is to ensure that nobody is scheduled two days in a row and that everyone has a rough equal amount of days scheduled. My solution for this is to shuffle the names accordingly:</p>\n\n<p>12345, 23451, 34512, 45123, 51234. </p>\n\n<p>If five people needs to be scheduled it would go from this:\n<a href=\"https://i.stack.imgur.com/8F9h9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8F9h9.png\" alt=\"Unshuffled\"></a></p>\n\n<p>To this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BHfhU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BHfhU.png\" alt=\"Shuffled\"></a></p>\n\n<p>I've been trying this for a while now but can't make it work. The problem is that I don't know how to make the schedule like this with x number of names. if the number was constant it would be easy but I need the schedule to be created automatically based on x names.</p>\n\n<p>One thought I had was to create some sort of loop that enters data throughout the schedule by first entering the names x times (where x = total number of names put into the list of persons to be scheduled), and then skipping the x + 1:th name each time.</p>\n\n<p>With five people it would look like this (with the skipped number within () ):\n12345(1)23451(2)34512(3)45123(4)51234(5) (repeat utnil whole year has been filled in).</p>\n\n<p>The reason I have to do this is because some of our departments have 5 persons in them, and I want to make sure they're not scheduled for the same task on the same day each week.</p>\n\n<p>I would be really thankful if someone has a solution or some helpful input to this problem.</p>\n\n<p>Cheers!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 1, "creation_date": 1470842064, "post_id": 38877322, "comment_id": 65115976, "body": "Where exactly are you stuck or what kind of error do you encounter?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470846459, "post_id": 38877322, "comment_id": 65118933, "body": "you are missing here the <code>End If</code> to <code>If i = InvestorName And Cells(i, 27) = 0 Then</code> ? also the <code>With Sheets(&quot;Current&quot;)</code> ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470846807, "post_id": 38877322, "comment_id": 65119137, "body": "@user6701007 please share a sample of your data in both worksheets, and what is the desired result of the code should be ?"}, {"owner": {"reputation": 1, "user_id": 6701007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01e379bba91d80830e47e99cb18a512?s=128&d=identicon&r=PG&f=1", "display_name": "user6701007", "link": "https://stackoverflow.com/users/6701007/user6701007"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470906073, "post_id": 38877322, "comment_id": 65143188, "body": "@ShaiRado Is there an easy way to share a worksheet? or attach it to my post?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470906666, "post_id": 38877322, "comment_id": 65143598, "body": "@user6701007 you can just print screen the worksheet and add it as an image. Did you see my comment above ? are you missing <code>End If</code> and <code>End With</code>"}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": false, "score": 1, "last_activity_date": 1470847259, "creation_date": 1470847259, "answer_id": 38879129, "question_id": 38877322, "link": "https://stackoverflow.com/questions/38877322/macro-to-match-cells-across-worksheets-and-then-copy-and-paste-relevant-cells/38879129#38879129", "title": "Macro to match cells across worksheets and then copy and paste relevant cells", "body": "<p>Based on the information given, I think this is what you are after. Please double check that I chose the right columns, it was difficult to guess what you were referring to without data to look at.</p>\n\n<pre><code>Sub StackExchangeVlookup()\n\nDim Company As Worksheet\nDim Current As Worksheet\n\n'set worksheets with the names of the sheets to compare\nSet Company = Sheets(\"Company\")\nSet Current = Sheets(\"Current\")\n\nDim myRange As range\nDim myCell As range\n'Set the range to the column you want to replace empty cells in. I think I counted\n'correctly, but maybe not. If AF is not correct, will also need to change the 32\nSet myRange = range(\"AF1\", Cells(Rows.count, 32).End(xlUp))\n\n'if the cell is empty in the column AF (or whichever is the one you want, then use\n'the VLOOKUP function.\nFor Each myCell In myRange\n    If Len(myCell) = 0 Then\n    'VLOOKUP will get the cell in column E of the row of the blank space in AF, compare\n    'it to Column A in Company, and then return the value to the right of the cell found\n    'in the Company sheet.\n        myCell.Value = _\n    \"=VLOOKUP(\" &amp; Current.Name &amp; \"!E\" &amp; myCell.Row &amp; \",\" &amp; Company.Name &amp; \"!A:B, 2, FALSE)\"\n    End If\nNext myCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6701007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01e379bba91d80830e47e99cb18a512?s=128&d=identicon&r=PG&f=1", "display_name": "user6701007", "link": "https://stackoverflow.com/users/6701007/user6701007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2043, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470906992, "creation_date": 1470841933, "last_edit_date": 1531164843, "question_id": 38877322, "link": "https://stackoverflow.com/questions/38877322/macro-to-match-cells-across-worksheets-and-then-copy-and-paste-relevant-cells", "title": "Macro to match cells across worksheets and then copy and paste relevant cells", "body": "<p>I'm trying to make a macro that matches values in column A of Sheet(\"Company\"), to those in Column E of \"Current\". If there is a match, and the cell 28 (\"Current\") to the right of this is empty, then I want to copy the cell to the right of the respective cell in \"Company\" and paste it. It should loop through all values in column A of Sheet(\"Company\"). For added difficulty, I'd love if I could implement a kind of ActiveSheet utility, so that I can apply it to other sheets rather than just \"Company\". Here's what I have...</p>\n\n<pre><code>Option Explicit\n\nSub CopyPaster()\n\nInvestorName As String\n\nInvestorName = ActiveCell.Value\n\nWith Sheets(\"Current\")\n\nFor i = 11 To 500:\n    If i = InvestorName And Cells(i, 27) = 0 Then\n        Sheets(\"Company\").ActiveCell.Offset(0, 3).Copy          \n        Sheets(\"Current\").Cells(i, 28).PasteSpecial                \nNext i\n\nEnd Sub\n</code></pre>\n\n<p>First shows the Current Sheet, and the second image is an example of one of the Company sheets I want to copy from.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 5225700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6wlG2.jpg?s=128&g=1", "display_name": "thisbenroberts", "link": "https://stackoverflow.com/users/5225700/thisbenroberts"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1470842210, "post_id": 38877168, "comment_id": 65116072, "body": "What do you mean by PT?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1470842344, "post_id": 38877168, "comment_id": 65116155, "body": "PT = <code>Pivot Table</code> :)"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1470842918, "post_id": 38877168, "comment_id": 65116595, "body": "<a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a> might be over-kill for this. There&#39;s a couple of formula-based methods suggested below, e.g <code>COUNTIFS</code> and <code>MATCH</code> (my own) both work well."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1470843116, "post_id": 38877168, "comment_id": 65116768, "body": "Nice question, I didn&#39;t realize there&#39;d be so many non-VBA ways to do this. Lots of little tricks in the answers below."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1470843278, "post_id": 38877168, "comment_id": 65116879, "body": "@pnuts... as they say <code>all good programmers are lazy</code> :)"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1470843565, "post_id": 38877168, "comment_id": 65117072, "body": "@pnuts totally agree, they are synonyms.:)"}], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1470842418, "creation_date": 1470842418, "answer_id": 38877518, "question_id": 38877168, "link": "https://stackoverflow.com/questions/38877168/looking-for-a-single-value-in-an-excel-column-with-multiple-matches/38877518#38877518", "title": "Looking for a single value in an Excel column with multiple matches", "body": "<p>I will assume the the table shown in results starts in cell A1, so your formula will be typed in B3 and copied right and down. I will also assume you account list is in a named range <code>Acct</code>. </p>\n\n<pre><code>=IF(MATCH($A3&amp;\" \"&amp;B$14,Acct)&gt;0,\"X\",\"\")\n</code></pre>\n\n<p>Copy this to all cells in B3:E5 in your example.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5225700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6wlG2.jpg?s=128&g=1", "display_name": "thisbenroberts", "link": "https://stackoverflow.com/users/5225700/thisbenroberts"}, "edited": false, "score": 0, "creation_date": 1470843698, "post_id": 38877552, "comment_id": 65117159, "body": "This is exactly what I needed!  I don&#39;t know why the simplest answers elude me.  The VBA solution is definitely overkill."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1470842501, "creation_date": 1470842501, "answer_id": 38877552, "question_id": 38877168, "link": "https://stackoverflow.com/questions/38877168/looking-for-a-single-value-in-an-excel-column-with-multiple-matches/38877552#38877552", "title": "Looking for a single value in an Excel column with multiple matches", "body": "<p>If your Client and Accounts list is in seperate cells, you could use <code>Countifs()</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qLDbE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qLDbE.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 6694804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6fDZj.jpg?s=128&g=1", "display_name": "JetSetJim", "link": "https://stackoverflow.com/users/6694804/jetsetjim"}, "is_accepted": false, "score": 1, "last_activity_date": 1470842569, "creation_date": 1470842569, "answer_id": 38877581, "question_id": 38877168, "link": "https://stackoverflow.com/questions/38877168/looking-for-a-single-value-in-an-excel-column-with-multiple-matches/38877581#38877581", "title": "Looking for a single value in an Excel column with multiple matches", "body": "<p>As @pnuts says, a PivotTable will get you your results table, but it will soon get unwieldy if you have large numbers of clients/accounts. Your VLOOKUP of a CONCATENATEd value is a good way to go unless you don't want to modify the data.</p>\n\n<p>If you're only doing it as a single shot check on a small number of clients/accounts, perhaps just using the auto-filters on the data might be a simpler solution?</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5225700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6wlG2.jpg?s=128&g=1", "display_name": "thisbenroberts", "link": "https://stackoverflow.com/users/5225700/thisbenroberts"}, "edited": false, "score": 0, "creation_date": 1470843193, "post_id": 38877614, "comment_id": 65116823, "body": "They are in separate columns"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1470842643, "creation_date": 1470842643, "answer_id": 38877614, "question_id": 38877168, "link": "https://stackoverflow.com/questions/38877168/looking-for-a-single-value-in-an-excel-column-with-multiple-matches/38877614#38877614", "title": "Looking for a single value in an Excel column with multiple matches", "body": "<p>If you Client and Accounts is in the same column, you can use this which tries to <code>MATCH</code> the concatenation of the row and column header (with space):</p>\n\n<pre><code>=IF(NOT(ISERROR(MATCH($C4&amp;\" \"&amp;D$1,$A$2:$A$11,0))),\"X\",\"\")\n</code></pre>\n\n<p>E.g.:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iZPCd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iZPCd.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1470842758, "creation_date": 1470842758, "answer_id": 38877656, "question_id": 38877168, "link": "https://stackoverflow.com/questions/38877168/looking-for-a-single-value-in-an-excel-column-with-multiple-matches/38877656#38877656", "title": "Looking for a single value in an Excel column with multiple matches", "body": "<p>Here's another way, using <code>Index/Match</code>. Break your <code>217 1008</code> column into two, using Text to Columns, Space Delimiter.  Then say these are in range J1:J10 (<code>217, 218, etc.</code>), and in K1:K10 is <code>1008, 1009, etc.</code>:</p>\n\n<p><code>=IF(NOT(ISERROR(INDEX($J$1:$J$10,MATCH($A2&amp;B$1,$J$1:$J$10&amp;$K$1:$K$10,0)))),\"X\",\"\")</code><br>\n(enter as array with <kbd>CTRL+SHIFT+ENTER</kbd>)</p>\n\n<p>Where A2 is the start of your <code>217</code> numbers going down, and B1 is the <code>1008</code> start going right.</p>\n"}], "owner": {"reputation": 21, "user_id": 5225700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6wlG2.jpg?s=128&g=1", "display_name": "thisbenroberts", "link": "https://stackoverflow.com/users/5225700/thisbenroberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 38877552, "answer_count": 5, "score": 0, "last_activity_date": 1470842758, "creation_date": 1470841534, "last_edit_date": 1531161705, "question_id": 38877168, "link": "https://stackoverflow.com/questions/38877168/looking-for-a-single-value-in-an-excel-column-with-multiple-matches", "title": "Looking for a single value in an Excel column with multiple matches", "body": "<p>I have a list of client numbers and I need to search through a list of account numbers to find out if the client has a particular account number in their file.</p>\n\n<p>My original sheet looks like this </p>\n\n<p><a href=\"http://i.stack.imgur.com/9oh3t.jpg\" rel=\"nofollow\">original</a></p>\n\n<p>My list of account numbers looks like this</p>\n\n<ul>\n<li>217   1008</li>\n<li>218   1008</li>\n<li>219   1008</li>\n<li>217   2009</li>\n<li>218   2009</li>\n<li>219   2009</li>\n<li>218   3015</li>\n<li>219   3015</li>\n<li>217   4017</li>\n<li>219   4017</li>\n</ul>\n\n<p>Expected results look like this</p>\n\n<p><a href=\"http://i.stack.imgur.com/sE3r3.jpg\" rel=\"nofollow\">results</a></p>\n\n<p>Originally, I concatenated the client and account numbers then did a VLOOKUP but I'm sure there's a better way. Maybe using VBA instead of a formula in the worksheet.  Can anyone help me out?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1470840926, "post_id": 38876833, "comment_id": 65115167, "body": "Solution presented <a href=\"http://stackoverflow.com/questions/7239328/how-to-find-numbers-from-a-string\">here</a> should work"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1470841022, "post_id": 38876833, "comment_id": 65115233, "body": "You can also use <a href=\"http://www.excel-easy.com/vba/string-manipulation.html\" rel=\"nofollow noreferrer\">string manipulation functions in Excel VBA</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1470841473, "post_id": 38876833, "comment_id": 65115550, "body": "Do you want to keep the cell value &quot;WWW 12345&quot;?"}, {"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470841935, "post_id": 38876833, "comment_id": 65115881, "body": "@ThomasInzina: no, I type &quot;WWW 12345&quot; and when I press enter (or arrow) to navigate to another cell, I need to text change in &quot;12345&quot;"}, {"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "reply_to_user": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1470842279, "post_id": 38876833, "comment_id": 65116115, "body": "@Michael Russo: it works, but... only if I reselect the cell, or I need on leave cell (press enter or arrows) the text changes"}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1470843330, "post_id": 38876833, "comment_id": 65116910, "body": "Try using <code>Worksheet_Change</code>"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1470843891, "post_id": 38876833, "comment_id": 65117301, "body": "Why not just use Excel&#39;s build in data validation and allow &quot;Whole number&quot;?  If you don&#39;t care about the alpha characters entered, just dis-allow it from the start."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470915626, "post_id": 38877927, "comment_id": 65149684, "body": "Update: when I want to delete a entered value, MS Excel has stopped  working and close it. &quot;A problem caused the program to stop working correctly. Windows will close the program and notify you if a solution is available&quot;.  I tried to put this line &quot;If Len(s) &gt; 0 Then&quot; (and End if to end) before For line in the onltDigits function from link, but doesn&#39;t work. How can I fix that? Please help! Thx."}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "reply_to_user": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470917565, "post_id": 38877927, "comment_id": 65150982, "body": "Try putting the condition in the <code>Worksheet_Change</code> using Target.Value."}, {"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470919592, "post_id": 38877927, "comment_id": 65152481, "body": "SOLVED! But new I have another little problem! I want to validate the entered values to prevent duplicated. &quot;www123&quot; is converted in &quot;123&quot; (which is ok), but when I entered &quot;123&quot; nothing happened (I would like to see the message set in Data Validate)"}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "reply_to_user": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470919833, "post_id": 38877927, "comment_id": 65152654, "body": "Well after your null check, you could grab the converted value, loop through the cells to see if it already exists, if not let it set <code>Target.Value</code>.  Otherwise you can use a message box to show the user that the value exists already."}], "tags": [], "owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "is_accepted": true, "score": 1, "last_activity_date": 1470843455, "creation_date": 1470843455, "answer_id": 38877927, "question_id": 38876833, "link": "https://stackoverflow.com/questions/38876833/shows-only-number-on-entered-value-in-a-cell/38877927#38877927", "title": "Shows only number on entered value in a cell", "body": "<p>Use this in conjunction with the onlyDigits function or regex function from link.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Target.Value = onlyDigits(Target.Value)\nEnd Sub\n</code></pre>\n\n<p>You could add a check to make sure this is only called when data in a certain column is change vs the entire sheet.</p>\n"}], "owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 38877927, "answer_count": 1, "score": -1, "last_activity_date": 1470843455, "creation_date": 1470840702, "last_edit_date": 1531164843, "question_id": 38876833, "link": "https://stackoverflow.com/questions/38876833/shows-only-number-on-entered-value-in-a-cell", "title": "Shows only number on entered value in a cell", "body": "<p>I write \"WWW  12345\" (or \"WWW 12345\" or \"WWW12345\" or \"www 12345\") in a cell.\nWhen I press enter (or arrows), I want to see in a cell only digits (e.g 12345).</p>\n\n<p>In vba, I tried with Workbook_SelectionChange, but doesn't works. I tried to create a custom format cell, but it is available only for digits.</p>\n\n<p>How can I make this? I'm not programmer, so I try to find a simple solution (that I can understand it).</p>\n"}, {"tags": ["vba", "postgresql", "odbc", "ado"], "comments": [{"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1470846012, "post_id": 38876760, "comment_id": 65118661, "body": "Do you see any improvements when using <code>adOpenForwardOnly</code> versus <code>adOpenStatic</code> ?"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1470846158, "post_id": 38876760, "comment_id": 65118767, "body": "Also, when you use a DSN, it has to go to the registry before making the connection and it&#39;s slower.  <a href=\"http://www.techrepublic.com/blog/10-things/-10-ado-best-practices/\" rel=\"nofollow noreferrer\">Check this out for some tips that may help</a>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1470870268, "post_id": 38876760, "comment_id": 65130461, "body": "Try ASynch processing too. See: <a href=\"https://support.microsoft.com/en-ca/kb/190988\" rel=\"nofollow noreferrer\">support.microsoft.com/en-ca/kb/190988</a>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1470870729, "post_id": 38876760, "comment_id": 65130565, "body": "Also try setting RS.CusorLocation = adUseClient, see if that helps."}, {"owner": {"reputation": 453, "user_id": 6434644, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/GQnip.jpg?s=128&g=1", "display_name": "Helge", "link": "https://stackoverflow.com/users/6434644/helge"}, "edited": false, "score": 0, "creation_date": 1470905836, "post_id": 38876760, "comment_id": 65143021, "body": "All four combinations of adOpenStatic/adOpenForwardOnly and adUseServer/adUseClient give the same execution time."}, {"owner": {"reputation": 453, "user_id": 6434644, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/GQnip.jpg?s=128&g=1", "display_name": "Helge", "link": "https://stackoverflow.com/users/6434644/helge"}, "edited": false, "score": 0, "creation_date": 1470906270, "post_id": 38876760, "comment_id": 65143327, "body": "I will now try not using DSN. But how? Can anyone give me a hint or link that can help me go in the right direction?"}], "answers": [{"tags": [], "owner": {"reputation": 453, "user_id": 6434644, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/GQnip.jpg?s=128&g=1", "display_name": "Helge", "link": "https://stackoverflow.com/users/6434644/helge"}, "is_accepted": false, "score": 2, "last_activity_date": 1470911509, "creation_date": 1470911509, "answer_id": 38893846, "question_id": 38876760, "link": "https://stackoverflow.com/questions/38876760/slow-connection-from-excel-vba-to-postgresql-database/38893846#38893846", "title": "Slow connection from Excel VBA to PostgreSQL database", "body": "<p>I found out to use OLE DB. And it is FAST!<br>\nDownloaded PgOleDb: <a href=\"https://www.connectionstrings.com/pgoledb/info-and-download\" rel=\"nofollow\">https://www.connectionstrings.com/pgoledb/info-and-download</a><br>\nCopied the two DLLs to C:\\Windows\\SysWOW64.<br>\nRan \"Regsvr32 PGOLEDB.DLL\".<br>\nConnection string: <a href=\"https://www.connectionstrings.com/pgoledb\" rel=\"nofollow\">https://www.connectionstrings.com/pgoledb</a>  </p>\n\n<pre><code>Provider=PostgreSQL OLE DB Provider;Data Source=myServerAddress;\nlocation=myDataBase;User ID=myUsername;password=myPassword; \n</code></pre>\n\n<p>The command \"timeout=1000;\" does not function.</p>\n"}], "owner": {"reputation": 453, "user_id": 6434644, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/GQnip.jpg?s=128&g=1", "display_name": "Helge", "link": "https://stackoverflow.com/users/6434644/helge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1606026849, "creation_date": 1470840539, "last_edit_date": 1470848891, "question_id": 38876760, "link": "https://stackoverflow.com/questions/38876760/slow-connection-from-excel-vba-to-postgresql-database", "title": "Slow connection from Excel VBA to PostgreSQL database", "body": "<p>I have a view in a PostgreSQL database. Executing the view in pgAdmin is very fast (10,000 records). But executing \"Select * From myView;\" from VBA is VERY slow. I connect to the database using ADO and ODBC. Can anyone give me a hint on how to speed up things?</p>\n\n<p>A small example:</p>\n\n<pre><code>Sub TEST()\n\nDim CN As New ADODB.Connection\nDim RS As New ADODB.Recordset\n\nDim Data   As Variant\nDim SQL    As String\nDim ConStr As String\n\nConStr = \"Server=11.22.33.44;\" &amp; _\n         \"DSN=PostgreSQL35W 32bit;\" &amp; _\n         \"UID=xxx;\" &amp; _\n         \"PWD=xxx;\" &amp; _\n         \"Database=xxx;\" _ &amp;\n         \"Port=5432;\" &amp; _\n         \"CommandTimeout=12\"\n\nSQL = \"Select * From myView;\"\n\nDebug.Print Now()\n\nCN.ConnectionString = ConStr\nCN.Open\nDebug.Print Now()\n\nRS.ActiveConnection = CN\nRS.Source = SQL\nRS.CursorType = adOpenStatic\nRS.LockType = adLockReadOnly\nDebug.Print Now()\n\nRS.Open\nDebug.Print Now()\n\nData = RS.GetRows\nDebug.Print Now()\n\nRS.Close\nCN.Close\nSet RS = Nothing\nSet CN = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This gives output:</p>\n\n<pre><code>10/08/2016 16:14:26 \n10/08/2016 16:14:26\n10/08/2016 16:14:26\n10/08/2016 16:14:38\n10/08/2016 16:18:50\n</code></pre>\n\n<p>That is \"RS.Open\" takes 00:00:12, and \"Data = RS.GetRows\" 00:04:12.\nIn pgAdmin it takes less than a second to show all 10,000 records.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1470841046, "post_id": 38876565, "comment_id": 65115249, "body": "StackOverflow is not a &#39;Code this for me&#39;-site. Try for yourself and ask questions about a specific problem in your code."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1470841248, "post_id": 38876565, "comment_id": 65115388, "body": "@Tom, sometimes the best way to learn is to start with a well done working example. If someone has time to help SqlDude101 - they will, but this question is clearly stated, so I find your comment to be out of place. People come here for help at different levels."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1470841574, "post_id": 38876565, "comment_id": 65115622, "body": "@SqlDude101 Unless you have to use VBA, you can do what you need to do with two applications of <code>Text to Data</code> function in Excel -- it is in the toolbar on <code>Data</code> tab. Split text by <code>(</code> first, transpose and split again by <code>:</code>."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "reply_to_user": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1470841595, "post_id": 38876565, "comment_id": 65115644, "body": "@LoganReed Please read: <a href=\"http://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a>"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1470841710, "post_id": 38876565, "comment_id": 65115715, "body": "I know, @Tom, it is just following that &quot;to the letter&quot; is a bit disheartening..."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1470841726, "post_id": 38876565, "comment_id": 65115730, "body": "I&#39;m not sure I understand your question, but regex could work. <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a> with the pattern <code>:(\\d+)</code>. It looks for a colon and one or more digits after."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "reply_to_user": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1470841943, "post_id": 38876565, "comment_id": 65115885, "body": "@LoganReed I suppose you can start a thread on StackExchange Meta for that. :)"}], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "is_accepted": false, "score": 0, "last_activity_date": 1470841730, "creation_date": 1470841730, "answer_id": 38877244, "question_id": 38876565, "link": "https://stackoverflow.com/questions/38876565/excel-vba-extract-multiple-values-from-a-single-cell-and-associate-values-in-s/38877244#38877244", "title": "Excel VBA - Extract Multiple Values from a Single Cell and Associate Values in Source Cell&#39;s Row", "body": "<p>Without writing it for you, here are some pointers to get you started.</p>\n\n<p>You'll need to loop through each cell in the column that contains the information you're looking for.  For this, look into <code>Worksheet.Range</code>.</p>\n\n<p>As you go through each cell, you'll need to examine the data that is actually entered into that cell.  Using the <code>Worksheet.Range.Value</code> you can extract the contents of the cell.</p>\n\n<p>Use excels string functions to parse the cell value into the values your looking for.  Ex: <code>InStr</code>, <code>InStrRev</code>, etc...  See <a href=\"http://www.techonthenet.com/excel/formulas/index_vba.php\" rel=\"nofollow\">this link</a> for your options and usage for each function.</p>\n\n<p>Finally you'll need to insert a row for each value that you find.  Lookup <code>Worksheet.Rows.Insert</code>.</p>\n\n<p>This should be the basic framework for what you need to do.</p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1471935988, "post_id": 38878302, "comment_id": 65535983, "body": "@SqlDude101: did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1470844614, "creation_date": 1470844614, "answer_id": 38878302, "question_id": 38876565, "link": "https://stackoverflow.com/questions/38876565/excel-vba-extract-multiple-values-from-a-single-cell-and-associate-values-in-s/38878302#38878302", "title": "Excel VBA - Extract Multiple Values from a Single Cell and Associate Values in Source Cell&#39;s Row", "body": "<p>you may want to start with this code:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim myArr As Variant\n    Dim cell As Range\n    Dim iRow As Long, nArr As Long\n\n    With Worksheets(\"batches\").Range(\"A1\").CurrentRegion '&lt;--| change \"batches\" with your actual sheet name\n        For iRow = .Rows.Count To 2 Step -1 '&lt;--|loop through data rows backwards, not to process rows multiple times\n            Set cell = .Cells(iRow, 3) '&lt;--| 3rd column of current row is being processed\n            cell = Mid(cell, 2, Len(cell) - 2) '&lt;--|get the cell value between first and last bracket\n            myArr = Split(cell, \")(\") '&lt;--|parse the resulting string with \")(\" as delimiter and obtain and array\n            nArr = UBound(myArr) '&lt;--| calculate the array size\n            If nArr &gt; 0 Then '&lt;--| if more than one element in array...\n                With .Rows(iRow) '&lt;--|... then refer to entire current row\n                    .Offset(1).Resize(nArr).Insert '&lt;--| ...insert n-1 rows...\n                    .Resize(nArr + 1).Value = .Value '&lt;--|...duplicate current row into newly inserted ones\n                End With\n                cell.Resize(nArr + 1).Value = Application.Transpose(myArr) '&lt;--|fill 3rd column of current and newly inserted rows with array elements\n            End If\n        Next iRow\n\n        For iRow = 2 To .Rows.Count '&lt;--|loop through data rows\n            With .Cells(iRow, 3)  '&lt;--| 3rd column of current is being processed\n                .Value = Right(.Value, Len(.Value) - InStrRev(.Value, \":\")) '&lt;--| \"finish\" it\n            End With\n        Next iRow\n    End With\nEnd Sub\n</code></pre>\n\n<p>As per your example, it assumes that your data start from cell \"A1\" and there's no blank row or column between it and the bottom-right cell of your data</p>\n"}], "owner": {"reputation": 11, "user_id": 6700601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b044773dab506113378d842bd963a1ea?s=128&d=identicon&r=PG&f=1", "display_name": "SqlDude101", "link": "https://stackoverflow.com/users/6700601/sqldude101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2251, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1539249203, "creation_date": 1470840068, "question_id": 38876565, "link": "https://stackoverflow.com/questions/38876565/excel-vba-extract-multiple-values-from-a-single-cell-and-associate-values-in-s", "title": "Excel VBA - Extract Multiple Values from a Single Cell and Associate Values in Source Cell&#39;s Row", "body": "<p>To preface this, I have very little experience in Excel VBA, but have used some VBA in Access. </p>\n\n<p>I have a file which may contain multiple values in a single cell that need to be extracted out onto individual rows, and then have the data in multiple columns from the source row re-associated with the extracted values.</p>\n\n<p>The multiple values in the single cell that need to be extracted are always in a uniform format. The cell may contain any number of sets of (), but the value I need to extract is always between the 2nd : and the closing ). This is the 'Identifier'.</p>\n\n<p>For example:</p>\n\n<p>(00050008009:STC:363711188)(00040022506:NYC:652263975)</p>\n\n<p>Would need to extract these values onto individual rows:</p>\n\n<p>363711188 \n652263975</p>\n\n<p>All remaining values from the Source Row the value was extracted from then need to be re-associated with the value.</p>\n\n<p>For example, my file may look like this:</p>\n\n<p><a href=\"http://i.stack.imgur.com/HufcO.png\" rel=\"nofollow\">Original File Format</a></p>\n\n<p>I then need the file to appear as follows, on a new tab:</p>\n\n<p><a href=\"http://i.stack.imgur.com/Cm3IL.png\" rel=\"nofollow\">New File Format</a></p>\n\n<p>I believe that a module making use of a loop, or multiple loops, is likely what is needed, but I have no idea of how to go about doing this in Excel. I'm open to all solutions. Any help is greatly appreciated! Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1470840735, "post_id": 38876564, "comment_id": 65115038, "body": "Have a look at this: <a href=\"http://stackoverflow.com/questions/14074285/cell-value-not-updated-when-del-key-hit-in-excel\" title=\"cell value not updated when del key hit in excel\">stackoverflow.com/questions/14074285/&hellip;</a>"}], "owner": {"reputation": 7, "user_id": 6700889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/140b368b506489c2c4ed8b5eb14313da?s=128&d=identicon&r=PG", "display_name": "Mohammed Abusaif", "link": "https://stackoverflow.com/users/6700889/mohammed-abusaif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507517860, "creation_date": 1470840068, "last_edit_date": 1507517860, "question_id": 38876564, "link": "https://stackoverflow.com/questions/38876564/application-onkey-delete-vba-excel-2013-to-a-worksheet", "title": "application.onkey = &quot;{DELETE}&quot; VBA excel 2013 to a worksheet", "body": "<p>I want to connect the DELETE key from the keyboard to a VBA code I have, the reason of doing this is that I have many validations in that sheet so when the user select a range from Sheet4 then he press the delete button it will take long time while executing. How to do it? I have this code to be linked to the DELETE key:</p>\n\n<pre><code>    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n    Application.EnableEvents = False\n    ActiveSheet.DisplayPageBreaks = False\n</code></pre>\n\n<p>Worksheets(\"Sheet4\").Range------,clearcontents .how to know the selected range ?\nWorksheets(\"Sheet4\").Range------.Interior.ColorIndex = 0 </p>\n\n<pre><code>    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.EnableEvents = True\n    ActiveSheet.DisplayPageBreaks = True\n</code></pre>\n\n<p>Please help, thanks for any solutions, I am stuck here.</p>\n"}, {"tags": ["windows", "vba", "cmd"], "comments": [{"owner": {"reputation": 75, "user_id": 4467707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199b7046bd179b7fce64b755d9bd0621?s=128&d=identicon&r=PG&f=1", "display_name": "user4467707", "link": "https://stackoverflow.com/users/4467707/user4467707"}, "edited": false, "score": 0, "creation_date": 1470852147, "post_id": 38876518, "comment_id": 65122104, "body": "adding to the confusion, I created a section of code to create a batch file of the shell command and then run that bat file instead of trying to call shell.  It makes the batch file, and the batch file works if I open it from outside VBA, however when I open the batch programmatically from vba I get the same result as before."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1470855424, "post_id": 38876518, "comment_id": 65123947, "body": "Enter <code>where msg</code> at the command prompt and change <code>str_to_pass</code> to the full pathname it prints."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1470866806, "post_id": 38876518, "comment_id": 65129453, "body": "It is likely in Windows\\System32. That&#39;s where mine is, and entering the full path to the .exe still produces the same error message. (I was mad that my boss made me do actual work because this is the thing I wanted to work on today!) This is a really good question."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1470866904, "post_id": 38876518, "comment_id": 65129493, "body": "Oh, btw, I did notice that the environment variables of the cmd window that Shell opens are different than those of a cmd window I manually open."}, {"owner": {"reputation": 75, "user_id": 4467707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199b7046bd179b7fce64b755d9bd0621?s=128&d=identicon&r=PG&f=1", "display_name": "user4467707", "link": "https://stackoverflow.com/users/4467707/user4467707"}, "edited": false, "score": 0, "creation_date": 1470923632, "post_id": 38876518, "comment_id": 65155529, "body": "I tried the where msg suggestion, delivers the same results.  From inside the cmd prompt that vba launches through shell, I cannot access msg, even with the full path name c:\\windows\\system32\\msg.exe"}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 1, "last_activity_date": 1470941073, "last_edit_date": 1470941073, "creation_date": 1470939374, "answer_id": 38903478, "question_id": 38876518, "link": "https://stackoverflow.com/questions/38876518/running-command-com-or-cmd-exe-from-vba-causing-problems-with-msg-command/38903478#38903478", "title": "Running command.com or cmd.exe from VBA causing problems with MSG command", "body": "<p>The problem is with the way 64-bit Windows directs calls to and from 32-bit applications. Windows has a virtual folder called <code>SysNative</code> folder that needs to be used in place of <code>System32</code> when accessing 64-bit executables from 32-bit applications. Here's a great explanation: <a href=\"http://www.samlogic.net/articles/sysnative-folder-64-bit-windows.htm\" rel=\"nofollow\">http://www.samlogic.net/articles/sysnative-folder-64-bit-windows.htm</a></p>\n\n<p>The code needs to be:</p>\n\n<pre><code>str_to_pass = \"c:\\windows\\sysnative\\msg\"\nCall Shell(\"cmd.exe /s /k \" &amp; str_to_pass, vbNormalFocus)\n</code></pre>\n\n<p>And here's the related MSDN page: <a href=\"https://msdn.microsoft.com/en-us/library/aa384187%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa384187%28v=vs.85%29.aspx</a></p>\n"}], "owner": {"reputation": 75, "user_id": 4467707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199b7046bd179b7fce64b755d9bd0621?s=128&d=identicon&r=PG&f=1", "display_name": "user4467707", "link": "https://stackoverflow.com/users/4467707/user4467707"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2062, "favorite_count": 1, "accepted_answer_id": 38903478, "answer_count": 1, "score": 2, "last_activity_date": 1470941073, "creation_date": 1470839969, "last_edit_date": 1470855231, "question_id": 38876518, "link": "https://stackoverflow.com/questions/38876518/running-command-com-or-cmd-exe-from-vba-causing-problems-with-msg-command", "title": "Running command.com or cmd.exe from VBA causing problems with MSG command", "body": "<p>I cannot get msg to work when I open the command prompt from within VBA, however have proved that it works when launching cmd.exe or \"command prompt\" from windows.</p>\n\n<p>My VBA code is as follows:</p>\n\n<pre><code>Sub test()\nDim str_to_pass As String\n\nstr_to_pass = \"msg\"\n\nCall Shell(\"cmd.exe /s /k \" &amp; str_to_pass, vbNormalFocus)\n\nEnd Sub\n</code></pre>\n\n<p>my result from inside command prompt: \"'msg' is not recognized as an internal or external command,...\"</p>\n\n<p>however if I open command prompt, or cmd.exe from windows first, and then type \"msg\" I get the prompt for the syntax of how to use msg.</p>\n\n<p>So, how can I access this usability of the command prompt from vba, and further, why are the commands different depending on how cmd.exe is launched?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6700842, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210620291364510/picture?type=large", "display_name": "Enoch Tsai", "link": "https://stackoverflow.com/users/6700842/enoch-tsai"}, "is_accepted": false, "score": 0, "last_activity_date": 1470929309, "creation_date": 1470929309, "answer_id": 38900536, "question_id": 38876370, "link": "https://stackoverflow.com/questions/38876370/vba-solver-not-resetting/38900536#38900536", "title": "VBA Solver Not Resetting", "body": "<p>Update: Instead of calling SolverReset when you switch workpages, run Application.Run \"SolverReset\"</p>\n"}], "owner": {"reputation": 1, "user_id": 6700842, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210620291364510/picture?type=large", "display_name": "Enoch Tsai", "link": "https://stackoverflow.com/users/6700842/enoch-tsai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 681, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470929309, "creation_date": 1470839620, "question_id": 38876370, "link": "https://stackoverflow.com/questions/38876370/vba-solver-not-resetting", "title": "VBA Solver Not Resetting", "body": "<p>I'm having issues with my solver script not actually solving when I move between worksheets. The solver is supposed to maximize a reference cell up to 1 by changing 5 cells in a column 10 times per sheet.</p>\n\n<pre><code>wslist = Array(\"A\", \"B\", \"C\")\nFor j = LBound(wslist) To UBound(wslist)\nWorksheets(wslist(j)).Activate\nFor i = 0 To 9\n    SolverReset\n    SolverOptions Precision:=0.1\n    SolverOk SetCell:=Cells(7 + i * 4, 49), MaxMinVal:=1, ValueOf:=0, ByChange:=Range(Cells(6, 18 + i), Cells(10, 18 + i)), _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverAdd CellRef:=Cells(7 + i * 4, 49), Relation:=1, FormulaText:=\"1\"\n*Constraints Omitted*\n    Next i\nNext j\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>Solver does not seem to run when I move from worksheet A to B, i.e. the script runs fine on sheet A but when it's suppose to move to sheet B the script \"runs\" but solver does not change anything. If I go through and manually enter the exact same parameters into solver it does run.</p>\n\n<p>Any help is greatly appreciated, thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470839024, "post_id": 38876072, "comment_id": 65113656, "body": "So you have a comma at the end that you want to get rid of in certain cells? Are there commas anywhere else in the string or just one?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1470839093, "post_id": 38876072, "comment_id": 65113722, "body": "Just use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194086.aspx\" rel=\"nofollow noreferrer\">Range.Replace method</a> to remove what you want all at once.  It can even be done in a single line of code: <code>destinRange.Replace(&quot;, &quot;, &quot; &quot;)</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470839194, "post_id": 38876072, "comment_id": 65113805, "body": "Use an array instead of repeatedly writing to cells. See <a href=\"http://stackoverflow.com/a/38797051/4088852\">this answer</a> for some examples. Also <code>ActiveCell.Offset(1, 0).Select</code> and <code>ActiveCell.Value = removed &amp; &quot; &quot;</code> are hands down the slowest thing in your loop."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470839207, "post_id": 38876072, "comment_id": 65113816, "body": "or <code>join(split(cell.value,&quot;, &quot;),&quot; &quot;)</code>"}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470839341, "post_id": 38876072, "comment_id": 65113921, "body": "@Brian I updated a sample data what it&#39;d look like"}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1470839370, "post_id": 38876072, "comment_id": 65113941, "body": "@pnuts basically remove everything after the comma or -"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1470839560, "post_id": 38876072, "comment_id": 65114103, "body": "You can copy the range into <code>Array</code>, iterate over array replacing the values and then paste the array back. Thus you&#39;ll limit Excel recalc calls -- it should be light years faster on 300k, even faster than <code>Range.Replace</code>."}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1470839779, "post_id": 38876072, "comment_id": 65114277, "body": "@pnuts after the first comma/dash"}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470839986, "post_id": 38876072, "comment_id": 65114448, "body": "@Comintern yea definitely slow. let me try array as you and logan suggested."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 3, "creation_date": 1470840945, "post_id": 38876072, "comment_id": 65115184, "body": "@Nathan_Sav I am not sure <code>join&#47;split</code> is faster than VBA&#39;s built-in <code>Replace</code>. Your approach would only be beneficial if you do something else with the split array, otherwise it is suboptimal."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1470842261, "post_id": 38876072, "comment_id": 65116098, "body": "@pnuts has asked some crucial questions. The clue is there :)"}], "answers": [{"comments": [{"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470839447, "post_id": 38876270, "comment_id": 65114008, "body": "let me try but doesn&#39;t this just replace <code>,</code> with no space... so it wouldn&#39;t remove anything after the comma, no?"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470839505, "post_id": 38876270, "comment_id": 65114060, "body": "Yes, it does. It was a little unclear on that point. Please add what you want your examples to look like after replacing."}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470839758, "post_id": 38876270, "comment_id": 65114253, "body": "Yea i just tried it, it just replaces to nothing. I want everything to be removed after the symbol. It&#39;s slightly faster though."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1470840698, "post_id": 38876270, "comment_id": 65115006, "body": "@Brian - why do you do <code>Range.Resize</code>? It is exactly the same size since you copied it into the array. Just reuse the range... I&#39;ve added the example too -- have a look. I also wouldn&#39;t assume it is just one column - see my example -- it will work on any range, even multi-column one."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1470845538, "post_id": 38876270, "comment_id": 65118347, "body": "@LoganReed I just didn&#39;t put <code>Range(&quot;A1:A3&quot;)</code> like I did when I allocated the array. You did via a variable of data type <code>Range</code>. Why would the OP try text to column if he needed it for multiple columns?"}], "tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1470840456, "last_edit_date": 1470840456, "creation_date": 1470839343, "answer_id": 38876270, "question_id": 38876072, "link": "https://stackoverflow.com/questions/38876072/fastest-way-to-remove-characters-from-cell/38876270#38876270", "title": "Fastest way to remove characters from cell", "body": "<p><strong>EDIT</strong></p>\n\n<p>Try this and change your range, accordingly:</p>\n\n<pre><code>Option Explicit\n\nSub FindAndReplace()\n\nDim Arr() As Variant\nArr = Range(\"A1:A3\")\n\nDim x As Integer\n\nFor x = LBound(Arr) To UBound(Arr)\n    Arr(x, 1) = Left(Arr(x, 1), InStr(Arr(x, 1), \",\") - 1)\nNext x\nRange(\"A1\").Resize(UBound(Arr), 1) = Arr\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470841560, "post_id": 38876719, "comment_id": 65115612, "body": "It&#39;s slightly faster but how do i remove everything after the characters? replace doesn&#39;t work"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470841951, "post_id": 38876719, "comment_id": 65115891, "body": "You&#39;d use <code>Left</code> just like you did in your original example, but write it back into array, not the cell. If it is still not fast enough, your next option is to write it in C and reference a DLL..."}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470842214, "post_id": 38876719, "comment_id": 65116076, "body": "yes you are right! it was super fast (blink of an eye). thank you!"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470842865, "post_id": 38876719, "comment_id": 65116545, "body": "@JamAndJammies Yep, &quot;You&#39;ve been holding it wrong!&quot; - Steve Jobs."}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": true, "score": 1, "last_activity_date": 1470840440, "creation_date": 1470840440, "answer_id": 38876719, "question_id": 38876072, "link": "https://stackoverflow.com/questions/38876072/fastest-way-to-remove-characters-from-cell/38876719#38876719", "title": "Fastest way to remove characters from cell", "body": "<p>You can copy the range into <code>Array</code>, iterate over array replacing the values and then paste the array back. Thus you'll limit Excel recalc calls -- it should be light years faster on 300k, even faster than <code>Range.Replace</code>. Here is an example:</p>\n\n<pre><code>Sub fastReplace()\n\n    ' range to run the replace operation on\n    Dim rngRepl As Range\n    Set rngRepl = ActiveSheet.[a1:a4]\n\n    ' read range into array (it is a 2D array)\n    Dim arr()\n    arr = rngRepl\n\n    ' do the replace\n    Dim i As Long\n    Dim j As Long\n    For i = LBound(arr, 1) To UBound(arr, 1)\n        For j = LBound(arr, 2) To UBound(arr, 2)\n            arr(i, j) = Replace(arr(i, j), \"o\", \"a\")\n        Next j\n    Next i\n\n    ' paste array back\n    rngRepl = arr\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1470843019, "post_id": 38877282, "comment_id": 65116688, "body": "I actually re-read the question, thinking that maybe I misunderstood but soon realized that it is a retaliation downvote perhaps :D"}, {"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470844247, "post_id": 38877282, "comment_id": 65117552, "body": "logan&#39;s way was very quick. quicker than what you mentioned."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 4, "last_activity_date": 1470841827, "last_edit_date": 1592644375, "creation_date": 1470841827, "answer_id": 38877282, "question_id": 38876072, "link": "https://stackoverflow.com/questions/38876072/fastest-way-to-remove-characters-from-cell/38877282#38877282", "title": "Fastest way to remove characters from cell", "body": "<blockquote>\n<p>What is the fastest way to remove characters for each cell? I have 300k rows, looping every single cell is not ideal. I tried text to column but i would need to know how many symbols there could be within each cell. Is there a better way to do this?</p>\n<p>@pnuts basically remove everything after the comma or - \u2013 JamAndJammies 42 mins ago</p>\n<p>@pnuts after the first comma/dash \u2013 JamAndJammies 37 mins ago</p>\n</blockquote>\n<p>Based on your question and what you said in the comment, the most simplest and fastest way which will not use VBA is</p>\n<ol>\n<li>Set a single letter delimiter which you feel will not be in the data. Let's say it is <code>|</code>. Or you can choose some other special character? Let's call this <strong>keyword</strong>.</li>\n<li>Press <kbd>Ctrl</kbd> + <kbd>H</kbd> to bring up find and replace dialog box and do a replace. Find <code>,</code>  and replace it with the <strong>keyword</strong>. Similarly replace <code>-</code> with the <strong>keyword</strong>.</li>\n<li>Do <code>Text To columns</code> and split it on the <strong>keyword</strong>.</li>\n<li>Keep the 1st column and delete the rest of the columns</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470925438, "post_id": 38887555, "comment_id": 65156942, "body": "problem with texttocolumns is then you have to figure out the length within the cells and how many commas and other stuff within the cell... also need to insert columns and whatnot... so many more extra steps."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "edited": false, "score": 0, "creation_date": 1470968727, "post_id": 38887555, "comment_id": 65175925, "body": "You would just copy it to a blank sheet, run the split, discard the rest."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1470891533, "creation_date": 1470891533, "answer_id": 38887555, "question_id": 38876072, "link": "https://stackoverflow.com/questions/38876072/fastest-way-to-remove-characters-from-cell/38887555#38887555", "title": "Fastest way to remove characters from cell", "body": "<p>Both methods actually take a similar time for 300,000 data points, around 0.5 seconds on my system. </p>\n\n<p>I did update the array code to handle for the actual replacement required, and more importantly to test for the presence of the string to be replaced (else the code fails).</p>\n\n<p>I didn't play with the extra columns in the other code, I would probably use a copy of the sheet before using this method so that all other columns could be deleted without impacting existing other data.</p>\n\n<p><em>Code to time approaches</em></p>\n\n<pre><code>Sub Overall()\nDim dbTime As Double\nDim lngCalc As Long\n\nWith Application\n .ScreenUpdating = False\n lngCalc = .Calculation\n .EnableEvents = False\nEnd With\n\ndbTime = Timer()\nCall fastReplace\nDebug.Print Timer() - dbTime\ndbTime = Timer()\nCall SD\nDebug.Print Timer() - dbTime\n\nWith Application\n .ScreenUpdating = True\n .Calculation = lngCalc\n .EnableEvents = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><em>Tidied up array</em>   </p>\n\n<pre><code> Sub fastReplace()\n\n    ' range to run the replace operation on\n    Dim rngRepl As Range\n    Dim arr()\n\n    Set rngRepl = ActiveSheet.[a1:a300000]\n\n    arr = rngRepl\n\n    ' do the replace\n    Dim i As Long\n    Dim j As Long\n    For i = LBound(arr, 1) To UBound(arr, 1)\n        For j = LBound(arr, 2) To UBound(arr, 2)\n            If InStr(arr(i, j), \", \") &gt; 0 Then arr(i, j) = Left$(arr(i, j), InStr(arr(i, j), \", \") - 1)\n        Next j\n    Next i\n\n    ' paste array back\n    rngRepl.Value2 = arr\n\nEnd Sub\n</code></pre>\n\n<p><em>Text to Columns</em></p>\n\n<pre><code>Sub SD()\n [a1:a300000].TextToColumns , , , , , , True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1471086996, "creation_date": 1471086996, "answer_id": 38932112, "question_id": 38876072, "link": "https://stackoverflow.com/questions/38876072/fastest-way-to-remove-characters-from-cell/38932112#38932112", "title": "Fastest way to remove characters from cell", "body": "<p>Or a one-line VBA equivalent of using <code>LEFT</code> on each string:</p>\n\n<pre><code>[a1:A300000] = Application.Evaluate(\"=IF(ISERR(FIND(\"\",\"\",A1:a300000)),A1:A300000,LEFT(A1:A300000,FIND(\"\",\"\",A1:A300000)-1))\")\n</code></pre>\n"}], "owner": {"reputation": 1141, "user_id": 3232194, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/e9d620c17e153d59c1fb6ead2b345b11?s=128&d=identicon&r=PG&f=1", "display_name": "jaimers", "link": "https://stackoverflow.com/users/3232194/jaimers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 1, "accepted_answer_id": 38876719, "answer_count": 5, "score": 1, "last_activity_date": 1471087486, "creation_date": 1470838839, "last_edit_date": 1471087486, "question_id": 38876072, "link": "https://stackoverflow.com/questions/38876072/fastest-way-to-remove-characters-from-cell", "title": "Fastest way to remove characters from cell", "body": "<p>What is the fastest way to remove characters for each cell? I have 300k rows, looping every single cell is not ideal. I tried text to column but i would need to know how many symbols there could be within each cell. Is there a better way to do this?</p>\n\n<p>Here's what I have looping 300,000 cell. It takes way too much time. </p>\n\n<pre><code>For Each destineCell In destinRange\n    cellVal = destineCell.Value\n    If (InStr(cellVal, \", \")) Then\n        removed = Left(cellVal, InStr(cellVal, \", \") - 1)\n        ActiveCell.Value = removed &amp; \" \"\n    End If\n    ActiveCell.Offset(1, 0).Select\nNext destineCell\n</code></pre>\n\n<p>[[Update]] \nHere's what a sample data would look like..</p>\n\n<pre><code>New York, NY, USA\nRome, Italy - Tier 1 City\n</code></pre>\n\n<p>the data itself varies. Sometimes it'll have a comma, a dash or both. </p>\n"}, {"tags": ["excel", "shapes", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1470839218, "post_id": 38875858, "comment_id": 65113826, "body": "Change the Text Alignment property to Middle Centered (if it is not already), and you may need to adjust the font size."}, {"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470839547, "post_id": 38875858, "comment_id": 65114092, "body": "in textRectangles.TextFrame how can I make it middle centered, the size is 9 so if i put 5 it will be unreadable"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470840320, "post_id": 38875858, "comment_id": 65114727, "body": "<i>how can I make it middle centered</i> use the macro recorder to get an idea of how to do that?"}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "edited": false, "score": 0, "creation_date": 1470840296, "post_id": 38876386, "comment_id": 65114708, "body": "the radius should be the minimun and dont change , so it looks good Why it&#39;s realisable manually and not programmatically ? 33 is big if I have a lot of points"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "edited": false, "score": 0, "creation_date": 1470840407, "post_id": 38876386, "comment_id": 65114793, "body": "Yes - the best sounding property setting <code>.TextFrame2.AutoSize = msoAutoSizeTextToFitShape</code>won&#39;t work for all configurations :("}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1470839676, "creation_date": 1470839676, "answer_id": 38876386, "question_id": 38875858, "link": "https://stackoverflow.com/questions/38875858/shape-doesnt-show-all-text/38876386#38876386", "title": "Shape doesn&#39;t show all text", "body": "<p>There are a couple of theoretical options, but neither seem like they are going to work with <code>radius = 15</code> and <code>textRectangles.TextFrame.Characters.Font.Size = 9</code>.</p>\n\n<p>First is <code>textRectangles.TextFrame.AutoSize = True</code> which resizes the shape to fix the text - however, this is going to expand the <code>radius</code> significantly.</p>\n\n<p>Second is <code>textRectangles.TextFrame2.AutoSize = msoAutoSizeTextToFitShape</code> - however, this only works if the minimum value is <code>radius = 33</code>.</p>\n\n<p>You may have to consider increasing the radius.</p>\n"}], "owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 38876386, "answer_count": 1, "score": 0, "last_activity_date": 1470839676, "creation_date": 1470838302, "last_edit_date": 1531164843, "question_id": 38875858, "link": "https://stackoverflow.com/questions/38875858/shape-doesnt-show-all-text", "title": "Shape doesn&#39;t show all text", "body": "<p>I need to create shapes labelled with a number but the shape doesn't display the whole number.</p>\n\n<p>For example, where the number is 1 to 9 it displays, but for 10 to 19 it shows just 1.</p>\n\n<p>I don't want to change the radius it have to be the same.</p>\n\n<pre><code>Sheets(xRiS).Select\nDim textRectangles As Shape\nDim radius As Integer\nradius = 15\n\nSet textRectangles = ActiveSheet.Shapes.AddShape(msoShapeOval, (Range(\"D13\").Left - radius / 2), _\n    Range(\"D13\").Top - radius / 2, radius, radius)\n\ntextRectangles.Name = \"Groups \" &amp; i\ntextRectangles.TextFrame.Characters.Text = i\ntextRectangles.TextFrame.VerticalAlignment = xlVAlignCenter\ntextRectangles.TextFrame.HorizontalAlignment = xlHAlignCenter\ntextRectangles.TextFrame.Characters.Font.Size = 9\ntextRectangles.TextFrame.Characters.Font.Name = \"Georgia\"\ntextRectangles.Fill.ForeColor.RGB = RGB(220, 105, 0)\ntextRectangles.Fill.Transparency = 0.5\n</code></pre>\n\n<p>This is the current result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MDjVk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MDjVk.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the result I want:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CZC8V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CZC8V.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I configure the shape to display the number where the number is 10-19?</p>\n"}, {"tags": ["excel", "macros", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 4669824, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/cda0a2d00028a3b3c7c3d90375e15d55?s=128&d=identicon&r=PG&f=1", "display_name": "tapas kumar", "link": "https://stackoverflow.com/users/4669824/tapas-kumar"}, "edited": false, "score": 0, "creation_date": 1470838278, "post_id": 38875793, "comment_id": 65112978, "body": "Kindly click &quot;enter image description here&quot; to preview the sample sheet"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1470839383, "creation_date": 1470839383, "answer_id": 38876284, "question_id": 38875793, "link": "https://stackoverflow.com/questions/38875793/finding-the-cell-position-row-column-by-using-variable/38876284#38876284", "title": "Finding the cell position (row,column) by using variable", "body": "<p>This will work if you look for a <code>String</code> within some larger string:</p>\n\n<pre><code>Sub MacroExample()\n    Dim a As String\n\n    a = Format(Date - 1, \"MM/dd/yyyy\")\n    MsgBox \"The Value of a : \" &amp; a\n    Dim oRange As Range\n    Set oRange = Sheets(1).Range(\"A1:Z10000\").Find(what:=a, lookat:=xlPart)\n    MsgBox oRange.Column\n    MsgBox oRange.Row\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/n53if.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n53if.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>Note:</em></strong></p>\n\n<p>The date includes the desired leading zeros.</p>\n"}, {"tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": false, "score": 2, "last_activity_date": 1470844618, "creation_date": 1470844618, "answer_id": 38878306, "question_id": 38875793, "link": "https://stackoverflow.com/questions/38875793/finding-the-cell-position-row-column-by-using-variable/38878306#38878306", "title": "Finding the cell position (row,column) by using variable", "body": "<p>If I understand what you are asking, I hope this helps. This code should find the first occurrence of today's date in a specified search range.</p>\n\n<pre><code>Sub testDate()\n\nDim a As Variant\nDim column_Position As Variant\nDim row_Position As Variant\n\n'get today's date, formatted m/d/yyyy\na = Format(Date, \"m/d/yyyy\")\n\nDim oRange As range\nDim myCell As range\n\n'set a range to look through\nSet oRange = Worksheets(1).range(\"A1:Z10000\")\n\n'check each cell value if it contains today's date. If so, capture the column and row and\n'exit the loop.\nFor Each myCell In oRange\n\n    If InStr(1, myCell.Value, a) Then\n        column_Position = myCell.column\n        row_Position = myCell.Row\n        Exit For\n    End If\nNext myCell\n\n'display the column and row position, if wanted.\nMsgBox \"Column Position is \" &amp; column_Position &amp; vbNewLine &amp; \"Row Position is \" &amp; row_Position\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/vAwcr.jpg\" rel=\"nofollow\">Code Result</a></p>\n\n<p>I cannot say how efficient this is, but it should work.</p>\n"}], "owner": {"reputation": 21, "user_id": 4669824, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/cda0a2d00028a3b3c7c3d90375e15d55?s=128&d=identicon&r=PG&f=1", "display_name": "tapas kumar", "link": "https://stackoverflow.com/users/4669824/tapas-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21365, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470844618, "creation_date": 1470838122, "last_edit_date": 1531164843, "question_id": 38875793, "link": "https://stackoverflow.com/questions/38875793/finding-the-cell-position-row-column-by-using-variable", "title": "Finding the cell position (row,column) by using variable", "body": "<p>I have an Excel sheet having one column as date as below :</p>\n\n<p><a href=\"https://i.stack.imgur.com/1Mybv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1Mybv.png\" alt=\"enter image description here\"></a></p>\n\n<p>My Job is to find to the position (cell,column) for a today's date</p>\n\n<p>Script I am using :</p>\n\n<pre><code>Sub MacroExample()    \n Dim a As Variant   \n Dim column_Position As Variant  \n Dim row_Position As Variant   \n a = Format(Date - 1, \"MM\\/dd\\/yyyy\")   \n 'MsgBox \"The Value of a : \" &amp; a    \n Dim oRange          As Range   \n Set oRange = Worksheets(1).Range(\"A1:Z10000\").Find(a, lookat:=xlPart)\n\n 'MsgBox oRange.Address    \n MsgBox column_Position   \n MsgBox row_Position    \nEnd Sub\n</code></pre>\n\n<p>My output should be:</p>\n\n<pre><code>column_Position = 5 \nrow_Position = 1\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "formatting", "comma"], "answers": [{"tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": true, "score": 0, "last_activity_date": 1470840275, "creation_date": 1470840275, "answer_id": 38876657, "question_id": 38875723, "link": "https://stackoverflow.com/questions/38875723/vba-re-format-string-with-commas/38876657#38876657", "title": "VBA re-format string with commas", "body": "<p>My solution was to create this function:</p>\n\n<pre><code>Function bIsAlphaNumeric(str As String) As Boolean\nIf (Asc(LCase(str)) &gt;= 97 And Asc(LCase(str)) &lt;= 122) Or IsNumeric(str) Then\n    bIsAlphaNumeric = True\nElse\n    bIsAlphaNumeric = False\nEnd If\nEnd Function\n</code></pre>\n\n<p>My main function now reads:</p>\n\n<pre><code>Function FormatSQL(str As String) As String\nDim x As Double, y As Double\n\nCommas:\ny = Len(str)\nFor x = 1 To y\n    If Mid(str, x, 1) = \",\" Then\n        y = x\n        If Mid(str, x + 1, 1) = \" \" Then\n            'Look at x+2\n            If bIsAlphaNumeric(Mid(str, x + 2, 1)) Then\n                'Convert x+1 to linebreak\n                str = Left(str, x) &amp; vbCrLf &amp; Mid(str, x + 2)\n            End If\n        Else\n            'Look at x+1\n            If bIsAlphaNumeric(Mid(str, x + 1, 1)) Then\n                'Convert x+1 to linebreak\n                str = Left(str, x) &amp; vbCrLf &amp; Mid(str, x + 1)\n                y = y + 1\n            End If\n        End If\n    End If\nNext x\n\nSSelect:\nDo Until InStr(LCase(str), \" select \") = 0\n    str = Replace(LCase(str), \" select \", vbCrLf &amp; \"select \")\nLoop\n\nBSelect:\nDo Until InStr(LCase(str), \"(select \") = 0\n    str = Replace(LCase(str), \"(select \", \"(\" &amp; vbCrLf &amp; \"select \")\nLoop\n\nFrom:\nDo Until InStr(LCase(str), \" from \") = 0\n    str = Replace(LCase(str), \" from \", vbCrLf &amp; \"from \")\nLoop\n\nWhere:\nDo Until InStr(LCase(str), \" where \") = 0\n    str = Replace(LCase(str), \" where \", vbCrLf &amp; \"where \")\nLoop\n\nHaving:\nDo Until InStr(LCase(str), \" having \") = 0\n    str = Replace(LCase(str), \" having \", vbCrLf &amp; \"having \")\nLoop\n\nGroupBy:\nDo Until InStr(LCase(str), \" group by \") = 0\n    str = Replace(LCase(str), \" group by \", vbCrLf &amp; \"group by \")\nLoop\n\nOrderBy:\nDo Until InStr(LCase(str), \" order by \") = 0\n    str = Replace(LCase(str), \" order by \", vbCrLf &amp; \"order by \")\nLoop\n\naand:\nDo Until InStr(LCase(str), \" and \") = 0\n    str = Replace(LCase(str), \" and \", vbCrLf &amp; \"and \")\nLoop\n\noor:\nDo Until InStr(LCase(str), \" or \") = 0\n    str = Replace(LCase(str), \" or \", vbCrLf &amp; \"or \")\nLoop\n\nFormatSQL = str\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 38876657, "answer_count": 1, "score": 0, "last_activity_date": 1470840275, "creation_date": 1470837975, "last_edit_date": 1592644375, "question_id": 38875723, "link": "https://stackoverflow.com/questions/38875723/vba-re-format-string-with-commas", "title": "VBA re-format string with commas", "body": "<p>As part of a larger project I'm developing a form where users can paste SQL into a textbox and click various buttons to change what's there.</p>\n<p>For example, one converts it all to lower case, one removes -- and /* */ comments, one removes line breaks (useful in some scenarios where these aren't handled as well).</p>\n<p>The last one takes an unformatted string (like the one where I've taken the line breaks out) and makes it readable.</p>\n<p>I've so far got the following in a function which works quite well for some of the key words (I'm not after an exhaustive feature here just one which helps users out):</p>\n<pre><code>Function FormatSQL(str As String) As String\n\nSSelect:\nDo Until InStr(LCase(str), &quot; select &quot;) = 0\n    str = Replace(LCase(str), &quot; select &quot;, vbCrLf &amp; &quot;select &quot;)\nLoop\n\nBSelect:\nDo Until InStr(LCase(str), &quot;(select &quot;) = 0\n    str = Replace(LCase(str), &quot;(select &quot;, &quot;(&quot; &amp; vbCrLf &amp; &quot;select &quot;)\nLoop\n\nFrom:\nDo Until InStr(LCase(str), &quot; from &quot;) = 0\n    str = Replace(LCase(str), &quot; from &quot;, vbCrLf &amp; &quot;from &quot;)\nLoop\n\nWhere:\nDo Until InStr(LCase(str), &quot; where &quot;) = 0\n    str = Replace(LCase(str), &quot; where &quot;, vbCrLf &amp; &quot;where &quot;)\nLoop\n\nHaving:\nDo Until InStr(LCase(str), &quot; having &quot;) = 0\n    str = Replace(LCase(str), &quot; having &quot;, vbCrLf &amp; &quot;having &quot;)\nLoop\n\nGroupBy:\nDo Until InStr(LCase(str), &quot; group by &quot;) = 0\n    str = Replace(LCase(str), &quot; group by &quot;, vbCrLf &amp; &quot;group by &quot;)\nLoop\n\nOrderBy:\nDo Until InStr(LCase(str), &quot; order by &quot;) = 0\n    str = Replace(LCase(str), &quot; order by &quot;, vbCrLf &amp; &quot;order by &quot;)\nLoop\n\nFormatSQL = str\nEnd Function\n</code></pre>\n<p>The last thing I want to do is to cope with things like:</p>\n<blockquote>\n<p>select column1, column2, column3, column4 from table;</p>\n</blockquote>\n<p>I'd like it to be:</p>\n<blockquote>\n<p>select column1,</p>\n<p>column2,</p>\n<p>column3,</p>\n<p>column4</p>\n<p>from table;</p>\n</blockquote>\n<p>I'm struggling with commas as potentially these could have a space after or they might go straight into the next alphanumeric value. I'm also conscious there will be some instances like <code>','</code> and <code>&quot;,&quot;</code> where I don't want to insert line breaks.</p>\n<p>It's almost like my instr has to be either <code>&quot;, {anyalphanumeric}&quot;</code> or <code>&quot;,{anyalphanumeric}&quot;</code> but I'm struggling with a good way to achieve that.</p>\n<p>Any ideas / suggestions would be gratefully received.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": false, "score": 0, "last_activity_date": 1470839014, "creation_date": 1470839014, "answer_id": 38876140, "question_id": 38875688, "link": "https://stackoverflow.com/questions/38875688/vba-find-number-of-elements-in-column-assuming-the-length-can-change-in-the-f/38876140#38876140", "title": "VBA - Find number of elements in column, assuming the length can change in the future", "body": "<p>Here is an example that uses <code>Range.End()</code> method to dynamically determine the end of the column. Note that in this particular implementation your column should have more than 1 row and shouldn't have empty cells - <code>End</code> function only goes down till it finds first empty cell. If you are to add more values to this column and re-run the code -- you'll see more values printed in the Immediate console. </p>\n\n<p>Note that you don't really need to know the number of elements in the column, but if you do -- you can use <code>Range.Rows.Count</code> function. </p>\n\n<p><a href=\"https://i.stack.imgur.com/TJ2on.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TJ2on.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub iterateCol()\n\n    Dim w As Worksheet\n    Set w = ActiveSheet\n\n    ' first cell in the column\n    Dim rngColStart As Range\n    Set rngColStart = w.[a1]\n\n    ' this will be the range that contains all cells in the column\n    Dim rngCol As Range\n    Set rngCol = w.Range(rngColStart, rngColStart.End(xlDown))\n\n    ' number of rows in the column\n    Debug.Print rngCol.Rows.Count\n\n    ' iterate through all the cells in the column\n    Dim c As Range\n    For Each c In rngCol\n        Debug.Print c ' prints cell to immediate window\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "is_accepted": false, "score": 0, "last_activity_date": 1470839521, "creation_date": 1470839521, "answer_id": 38876336, "question_id": 38875688, "link": "https://stackoverflow.com/questions/38875688/vba-find-number-of-elements-in-column-assuming-the-length-can-change-in-the-f/38876336#38876336", "title": "VBA - Find number of elements in column, assuming the length can change in the future", "body": "<p>Here I suppose you have columns headers so I start your items list in Row 2, then I use <code>Range.Find</code> to look for the cell where your specific string (which I called <code>MyString</code>) is and keep the row number and finally I calculate the number of iteration needed (<em>Last minus First + 1</em> so they are both taken into account in the loop)</p>\n\n<pre><code>Sub FindNumberOfRowsToLoopThrough()\n\n    Dim MyString As String\n    Dim FirstRow As Long, LastRow As Long\n    Dim NumberOfIteration As Long\n\n    MyString = \"Here it is\"\n\n    FirstRow = 2\n\n    LastRow = Range(\"A:A\").Find(what:=MyString, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True, SearchFormat:=False).Row\n\n    NumberOfIteration = LastRow - FirstRow + 1\n\n    MsgBox NumberOfIteration\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6700578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13fe04b6f04b078d443138a7e572f626?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Newb", "link": "https://stackoverflow.com/users/6700578/vba-newb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470839521, "creation_date": 1470837878, "question_id": 38875688, "link": "https://stackoverflow.com/questions/38875688/vba-find-number-of-elements-in-column-assuming-the-length-can-change-in-the-f", "title": "VBA - Find number of elements in column, assuming the length can change in the future", "body": "<p>I'm very, very new to VBA and am struggling to find the number of elements in a column assuming that the column's length can change in the future.</p>\n\n<p>How do I find the number of rows between the start of the table and a specific string in one of the rows? i.e I would like to be able to use the number of elements as the number of iterations in a loop further in the code.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "macros", "instances"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470838880, "post_id": 38875616, "comment_id": 65113543, "body": "Just create a new <code>Excel.Application</code> instance for them to run in."}], "answers": [{"comments": [{"owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "edited": false, "score": 0, "creation_date": 1470846013, "post_id": 38876654, "comment_id": 65118664, "body": "Thank you for the swift reply! The Events still tie up each other and hang despite the onTime delay. I have also disabled events."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "edited": false, "score": 0, "creation_date": 1470846743, "post_id": 38876654, "comment_id": 65119093, "body": "I&#39;m not sure what you mean by &quot;Events still tie up each other&quot; -- I have tested this with some simple cases and the above revision successfully prints the <code>Debug.Print</code> statement before any code executes in the <code>wb</code> workbook."}, {"owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "edited": false, "score": 1, "creation_date": 1470852973, "post_id": 38876654, "comment_id": 65122575, "body": "Thank you for the example code and reply! Clarified my errors."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1470846697, "last_edit_date": 1470846697, "creation_date": 1470840270, "answer_id": 38876654, "question_id": 38875616, "link": "https://stackoverflow.com/questions/38875616/how-to-run-macro-independently-in-seperate-instance-without-stalling-current-exc/38876654#38876654", "title": "How to Run macro independently in seperate instance without stalling current excel instance?", "body": "<p>You can create a new instance of Excel, but you'll need to use the <code>OnTime</code> method of the new instance. If you simply try to execute them from the current workbook using a <code>.Run</code> statement, that will tie up the thread.</p>\n\n<p>Here is an example, I have tested this for normal called procedures and also included the <code>.EnableEvents</code> to prevent Event Handlers from firing in the second workbook when it is opened. Without this, the event handlers, if any, may fire and pause execution for the duration of their runtime.</p>\n\n<pre><code>Sub main()\nDim oXL As Excel.Application\nDim wb As Workbook\nDim filePath$, fileName$, moduleName$, procName$\n\n'## The locaation of the file you want to open, which contains the macro\nfilePath = \"C:\\debug\\\"\n'## The name of the workbook containing the macro\nfileName = \"book2.xlsm\"\n'## The name of the module containing the macro:\nmoduleName = \"Module1\"\n'## The name of the macro procedure\nprocName = \"foo\"\n'## Create new instance of Excel\nSet oXL = New Excel.Application\noXL.Visible = True 'or True, if you prefer\n'## Open the file containing the macro\noXL.EnableEvents = False\nSet wb = oXL.Workbooks.Open(filePath &amp; \"\\\" &amp; fileName)\noXL.EnableEvents = True\n'## Use the OnTime method to hand the thread to other instance of Excel\noXL.Application.OnTime Now + TimeValue(\"0:00:05\"), fileName &amp; \"!\" &amp; moduleName &amp; \".\" &amp; procName\n'## Inform user that the macro is running in the other workbook/instance of Excel\nDebug.Print \"The procedure \" &amp; procName &amp; \" is running in \" &amp; fileName\n\nwb.Activate\nSet oXL = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2013, "favorite_count": 0, "accepted_answer_id": 38876654, "answer_count": 1, "score": 1, "last_activity_date": 1470846697, "creation_date": 1470837656, "question_id": 38875616, "link": "https://stackoverflow.com/questions/38875616/how-to-run-macro-independently-in-seperate-instance-without-stalling-current-exc", "title": "How to Run macro independently in seperate instance without stalling current excel instance?", "body": "<p>I currently have a macro that creates and opens instances of excel files. I am looking to run macros within these new instances. \nThe thing is the macros are large and take a considerable amount of time to run, which pauses both instances of excel. </p>\n\n<p>Is there a way to run the macro of another instance within the vbeditor of that specific excel app?\nThis way the current macro can continue on while the other instance runs. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1470836323, "post_id": 38875009, "comment_id": 65111456, "body": "<a href=\"https://www.google.com/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=change%20row%20color%20vba\" rel=\"nofollow noreferrer\">GOOGLE &quot;change row color vba&quot;</a> Then cycle through the colors."}, {"owner": {"reputation": 7, "user_id": 6700538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc42ce80f3d6ad17294b6b341da512b?s=128&d=identicon&r=PG&f=1", "display_name": "Louise13", "link": "https://stackoverflow.com/users/6700538/louise13"}, "edited": false, "score": 1, "creation_date": 1470837338, "post_id": 38875009, "comment_id": 65112236, "body": "I&#39;ve tried the facility offered by DATA but this adds a total which I don&#39;t want. I just want to group the rows by a specific column and highlight alternate rows is possible. Adding in a blank row was another of grouping using VBA but as I am not a coder I couldn&#39;t amend to change colour."}, {"owner": {"reputation": 7, "user_id": 6700538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc42ce80f3d6ad17294b6b341da512b?s=128&d=identicon&r=PG&f=1", "display_name": "Louise13", "link": "https://stackoverflow.com/users/6700538/louise13"}, "edited": false, "score": 0, "creation_date": 1470837605, "post_id": 38875009, "comment_id": 65112439, "body": "Heres the VBA I am using if it helps : Sub AddBlankRows() &#39; Dim iRow As Integer, iCol As Integer Dim oRng As Range  Set oRng = Range(&quot;AN2&quot;)  iRow = oRng.Row iCol = oRng.Column  Do &#39; If Cells(iRow + 1, iCol) &lt;&gt; Cells(iRow, iCol) Then     Cells(iRow + 1, iCol).EntireRow.Insert shift:=xlDown     iRow = iRow + 2 Else     iRow = iRow + 1 End If &#39; Loop While Not Cells(iRow, iCol).Text = &quot;&quot; &#39; End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 764, "user_id": 6032284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad8e02c92711dc439c9cdcd2d3da6eed?s=128&d=identicon&r=PG&f=1", "display_name": "David Andrei Ned", "link": "https://stackoverflow.com/users/6032284/david-andrei-ned"}, "is_accepted": true, "score": 0, "last_activity_date": 1470838180, "last_edit_date": 1470838180, "creation_date": 1470837471, "answer_id": 38875537, "question_id": 38875009, "link": "https://stackoverflow.com/questions/38875009/grouping-and-colouring-each-grouping-in-excel-2013/38875537#38875537", "title": "Grouping and colouring each grouping in excel 2013", "body": "<p>You don't need a macro, just run conditional formatting for values equal to the value of the group you are using.</p>\n\n<p><a href=\"http://www.howtogeek.com/howto/45670/how-to-highlight-a-row-in-excel-using-conditional-formatting/\" rel=\"nofollow\">Here</a> is an excellent guide for how to highlight a row using conditional formatting. It does exactly what you asked for without having to write any code. As you can see it works for multiple rows sharing the common set value.</p>\n\n<p>This is assuming that the only reason you wanted them grouped in the first place was for colouring them together, this method is best if you want to preserve the order of your data. </p>\n"}], "owner": {"reputation": 7, "user_id": 6700538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc42ce80f3d6ad17294b6b341da512b?s=128&d=identicon&r=PG&f=1", "display_name": "Louise13", "link": "https://stackoverflow.com/users/6700538/louise13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 38875537, "answer_count": 1, "score": -1, "last_activity_date": 1470838180, "creation_date": 1470836135, "question_id": 38875009, "link": "https://stackoverflow.com/questions/38875009/grouping-and-colouring-each-grouping-in-excel-2013", "title": "Grouping and colouring each grouping in excel 2013", "body": "<p>can you tell me how I can group rows using a value in a specific cell and then highlight the individual groups by alternate colours i.e. one group with white background and one group with a colour in excel? I have macro code which inserts a blank line but I don't know how to colour using macro.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470836212, "post_id": 38874949, "comment_id": 65111366, "body": "Check the <code>.readyState</code>."}], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "is_accepted": false, "score": 1, "last_activity_date": 1470839413, "creation_date": 1470839413, "answer_id": 38876293, "question_id": 38874949, "link": "https://stackoverflow.com/questions/38874949/timeout-on-http-request-in-vba/38876293#38876293", "title": "Timeout on http request in vba", "body": "<p>Before send http query I try to ping server and if I recieve actual responce value pass it to </p>\n\n<pre><code>Dim xht As New ServerXMLHTTP\n    lPng = fn_Ping(sHst)\n    Select Case (lPng &lt; 0)\n        Case True:  lTmo = 500: Debug.Print fn_Err(-lPng)\n        Case False: lTmo = lPng + 100 'Debug.Print \"Ping to \" &amp; sHost &amp; \" = \" &amp; lPng\n    End Select\n    With xht\n        Call .setTimeouts(lTmo, lTmo, lTmo, lTmo) ' Def (10, 10, 10, 10)?\n        Call .Open(sCmd, sURL, False)  ' True ' async\n        lSta = .Status\n        Select Case lSta\n            Case 200'CheckRemoteURL = True\n                ' do something'\n            Case 202, 302\n                Stop\n            Case 404\n                Stop\n            Case Else\n                'CheckRemoteURL = False\n                Debug.Print .getAllResponseHeaders\n                Stop\n        End Select\n    End With\n</code></pre>\n\n<p>.</p>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2401, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470839413, "creation_date": 1470835986, "last_edit_date": 1531164843, "question_id": 38874949, "link": "https://stackoverflow.com/questions/38874949/timeout-on-http-request-in-vba", "title": "Timeout on http request in vba", "body": "<p>It has happened that the server hangs or that there is something wrong with the http request I am sending. So I was wondering if I could add a timeout code to my function to avoid my macro from crashing, but rather return an empty array and then I can use that to display an error message to the user...</p>\n\n<pre><code>Function helpRequest(stringQuery As String) As String()\n    Dim objRequest As MSXML2.XMLHTTP60\n    Dim O As MSHTML.HTMLDocument\n    Dim i As Integer\n\n    Dim asCells() As String\n\n    Dim contentType As String\n    Dim temp As String\n\n    If UCase(Right(stringQuery, 4)) = \".ASP\" Then\n        stringQuery = stringQuery &amp; \"?Cache=\" &amp; CStr(Int(200000000000000# * Rnd))\n    Else\n        stringQuery = stringQuery &amp; \"&amp;Cache=\" &amp; CStr(Int(200000000000000# * Rnd))\n    End If\n    contentType = \"application/x-www-form-urlencoded; charset=UTF-8\"\n\n    Set O = New HTMLDocument\n    Set objRequest = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n\n    With objRequest\n        .Open \"GET\", stringQuery, False\n        .send\n\n    End With\n\n    O.body.innerHTML = objRequest.responseText\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470836002, "post_id": 38874831, "comment_id": 65111213, "body": "How is your code working now?  How is it dysfunctional?"}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470839672, "post_id": 38874831, "comment_id": 65114181, "body": "dysfunction is that current code searches through the whole sheet , even if searched value is in hidden row - it finds it (it shouldn&#39;t be finding it)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470844239, "post_id": 38874831, "comment_id": 65117547, "body": "OK, but I see you have an accepted answer, so I won&#39;t comment further."}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470851621, "post_id": 38874831, "comment_id": 65121780, "body": "I have. Still thanks for good intentions :)"}], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 1, "creation_date": 1470838788, "post_id": 38875019, "comment_id": 65113453, "body": "I guess it doesn&#39;t check formulas , as my only interest is cell color :) Thanks for your help btw :) - Alex , Thomas Inzina"}], "tags": [], "owner": {"reputation": 77, "user_id": 6198644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3855af64bfb099d294f8795dbda9b73d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6198644/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1470836166, "creation_date": 1470836166, "answer_id": 38875019, "question_id": 38874831, "link": "https://stackoverflow.com/questions/38874831/macro-run-only-on-visible-cells/38875019#38875019", "title": "Macro run only on visible cells", "body": "<p>If it's not checking formulas, you can change</p>\n\n<pre><code>ActiveSheet.Cells.SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>ActiveSheet.Cells.SpecialCells(xlCellTypeVisible).SpecialCells(xlCellTypeConstants)\n</code></pre>\n\n<p>or if it's checking formulas, change </p>\n\n<pre><code>ActiveSheet.Cells.SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>ActiveSheet.Cells.SpecialCells(xlCellTypeVisible).SpecialCells(xlCellTypeFormulas)\n</code></pre>\n\n<p>This will keep it from running on blank cells that aren't hidden. </p>\n"}, {"comments": [{"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1470838587, "post_id": 38875269, "comment_id": 65113257, "body": "Yes, but macro doesn&#39;t have to do anything with found cells. It just has to find them and select :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1470841103, "last_edit_date": 1470841103, "creation_date": 1470836776, "answer_id": 38875269, "question_id": 38874831, "link": "https://stackoverflow.com/questions/38874831/macro-run-only-on-visible-cells/38875269#38875269", "title": "Macro run only on visible cells", "body": "<p>This will Activate all visible the cells with a specific format.</p>\n\n<pre><code>Sub Example()\n\n    Dim SearchRange As Range\n    Dim c As Range, FoundRange As Range\n    Dim firstAddress As String\n\n    On Error Resume Next\n\n    Set SearchRange = ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible)\n\n    On Error GoTo 0\n\n    If Not SearchRange Is Nothing Then\n\n        With Application.FindFormat.Interior\n            .PatternColorIndex = xlAutomatic\n            .Color = 16711935\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n\n        Set c = SearchRange.Find(What:=\"\", After:=SearchRange.Cells(1, 1), LookIn:=xlFormulas, LookAt:= _\n                                 xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n              , SearchFormat:=True)\n\n        If Not c Is Nothing Then\n            firstAddress = c.Address\n            Set FoundRange = c\n            Do\n                Set c = SearchRange.Find(What:=\"\", After:=c, LookIn:=xlFormulas, LookAt:= _\n                                         xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n                      , SearchFormat:=True)\n\n                If Not c Is Nothing Then\n                    'Do Something\n\n                    Set FoundRange = Union(FoundRange, c)\n                End If\n            Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n\n            FoundRange.Activate\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1170, "favorite_count": 0, "accepted_answer_id": 38875269, "answer_count": 2, "score": 0, "last_activity_date": 1470841103, "creation_date": 1470835683, "question_id": 38874831, "link": "https://stackoverflow.com/questions/38874831/macro-run-only-on-visible-cells", "title": "Macro run only on visible cells", "body": "<p>I was wondering how do I make macro run only on visible(unhidden) cells?\n what should I add to this code:?</p>\n\n<pre><code>Dim cell As Range \n\nFor Each cell In ActiveSheet.Cells.SpecialCells(xlCellTypeVisible) \n    With Application.FindFormat.Interior \n        .PatternColorIndex = xlAutomatic \n        .Color = 16711935 \n        .TintAndShade = 0 \n        .PatternTintAndShade = 0 \n    End With \n    Cells.Find(What:=\"\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _ \n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _ \n    , SearchFormat:=True).Activate \nNext cell \nExit Sub \n</code></pre>\n"}, {"tags": ["vba", "excel", "search", "user-input"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470836177, "post_id": 38874829, "comment_id": 65111340, "body": "Is there more than one sheet in the workbook? <code>Windows(X).Activate</code> activates the workbook."}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470836281, "post_id": 38874829, "comment_id": 65111419, "body": "There is Workbook A that contains all macros and from where they all run. Windows(X) is the second workbook that the macros do their magic on (Workbook B for example). There is only 1 sheet in Workbook B"}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470836456, "post_id": 38874829, "comment_id": 65111550, "body": "Im still sort of new to Excel VBA and Im not entirely sure what &quot;fully qualify a line&quot; means."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470836709, "post_id": 38874829, "comment_id": 65111741, "body": "Maybe you need to fully qualify this line: <code>If Cells(r, Columns(&quot;W&quot;).Column).Value = myValue Then</code> to <code>If sht.Cells(r, Columns(&quot;W&quot;).Column).Value = myValue Then</code>."}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470836887, "post_id": 38874829, "comment_id": 65111886, "body": "Tried it and it didnt change anything. The macro still finds &quot;NULL&quot; just fine but cannot find &quot;0&quot; or any other number I put in the input box."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1470840933, "post_id": 38874829, "comment_id": 65115176, "body": "you can use <code>If Cells(r, &quot;W&quot;).Text = myValue Then</code> instead of Value"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470837251, "post_id": 38875264, "comment_id": 65112187, "body": "So here is what values column &quot;W&quot; holds - W1 - header, W2 - 0, W3 - 3, W4 - 7, W5 - NULL and so on and so forth. With different numeric values with a couple of NULLs in between. I am certain the column contains 0 when I am searching for it but it just skips it. Where as NULL is found without issue."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470837838, "post_id": 38875264, "comment_id": 65112622, "body": "@ShaiRado May have the right idea here, <code>0</code> is not the same as <code>&quot;0&quot;</code> (as in one is a number and one is a string containing a number). Try as he mentioned <code>CInt(myValue)</code>."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470837913, "post_id": 38875264, "comment_id": 65112689, "body": "You can also drop <code>Cells(r, Columns(&quot;W&quot;).Column).Value</code>,  <code>myValue</code>, and <code>Cells(r, Columns(&quot;W&quot;).Column).Value = myValue</code> into the immediate pane to get an idea of what is happening."}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470838147, "post_id": 38875264, "comment_id": 65112860, "body": "with CInt(myValue)  when I input exactly this &quot;0&quot; i get Run-Time error &#39;13&#39;: Type mismatch when I input exatly this 0 it just doesnt find it in the column when I input exactly this NULL i get Run-Time error &#39;13&#39;: Type mismatch when I input exactly this &quot;NULL&quot; i get Run-Time error &#39;13&#39;: Type mismatch"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470838435, "post_id": 38875264, "comment_id": 65113128, "body": "@Shakdun, try my solution with <code>Autofilter</code>: it picks up text and numbers and zeros"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1470839215, "post_id": 38875264, "comment_id": 65113823, "body": "I think the immediate window will fix this one to help understand why the values are not pairing up but I have updated my answer with a little bit more to see if it helps"}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1470839131, "last_edit_date": 1470839131, "creation_date": 1470836765, "answer_id": 38875264, "question_id": 38874829, "link": "https://stackoverflow.com/questions/38874829/excel-vba-loop-search-for-value-then-color-row/38875264#38875264", "title": "Excel VBA - Loop search for value then color row", "body": "<p>When you say:-</p>\n\n<blockquote>\n  <p>if I try to search for a number in the same column(that i know exists there) it doesn't seem to find the value</p>\n</blockquote>\n\n<p>I assuming you are referring to the below line from your code not returning true and running the code within the If statement.</p>\n\n<pre><code>If Cells(r, Columns(\"W\").Column).Value = myValue Then\n</code></pre>\n\n<p>In short, if its not finding a match then there is not a match, but it can be hard to see sometimes.</p>\n\n<p>Examples of not matching when you think it should are:-</p>\n\n<ul>\n<li>If the cell contains <code>12.12121212</code> but is formatted to show it as <code>12.12</code>, if you search for <code>12.12</code> (as you think that would match) it will not match.</li>\n<li>If the cell contains leading or trailing spaces, <code>'12.12 '</code> (space at the end), if you search for <code>12.12</code> (no space at the end) it will not match. </li>\n</ul>\n\n<p>We can see what you are trying to match or what you think should be a match from your question but the above should be the information needed to work the answer out from your content.</p>\n\n<p>Based on the comments, try altering your code with the below, I've added some debugging lines to help understand why its failing: -</p>\n\n<pre><code>'If the value is null it will skip trying to check it, this mean no type mismatch error\nIf Not IsNull(Cells(r, Columns(\"W\").Column).Value) then\n\n    'This prints the value in the cell, the searched value, and if its seen as a match\n    Debug.Print \"'\" &amp; Cells(r, Columns(\"W\").Column).Value &amp; \"' ,'\" &amp; myValue &amp; \"', \" &amp; (Cells(r, Columns(\"W\").Column).Value = myValue)\n\n    'Compares them both as Long data types\n    If CLng(Cells(r, Columns(\"W\").Column).Value) = CLng(myValue) Then\n       'Your code\n    End If\n\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470837110, "post_id": 38875265, "comment_id": 65112064, "body": "Still misses numeric values but now causes an error when searching for NULL which is necessary from time to time."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470837214, "post_id": 38875265, "comment_id": 65112148, "body": "@Shakdun share the search options you are looking to have , like numeric values range, strings, Null, whatever..."}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470837559, "post_id": 38875265, "comment_id": 65112402, "body": "Numeric values from 1 to 200 without decimals just normal numbers ( cant remember the word, english isnt my main language) and NULL."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1470836766, "creation_date": 1470836766, "answer_id": 38875265, "question_id": 38874829, "link": "https://stackoverflow.com/questions/38874829/excel-vba-loop-search-for-value-then-color-row/38875265#38875265", "title": "Excel VBA - Loop search for value then color row", "body": "<p>Try replacing your <code>For</code> loop with the piece of code below.\nIf you are using Decimal values, or values larger than Integer, make the changes from <strong><em>CInt</em></strong> to your needs:</p>\n\n<pre><code>For r = 1 To LastRow\n    If sht.Cells(r, \"W\").Value = CInt(myValue) Then\n        sht.Rows(r).Select\n        With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .color = 65535\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n    End If\nNext r\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470838561, "post_id": 38875696, "comment_id": 65113231, "body": "works great! Thank you! Works both with NULL and numeric values and numbers like 72.4 and such"}, {"owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "edited": false, "score": 0, "creation_date": 1470839091, "post_id": 38875696, "comment_id": 65113720, "body": "Had to test it out a bunch of ways just because im so happy it works. It took me a couple of hours of searching before I gave up and asked here. Thanks again"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1470838227, "last_edit_date": 1470838227, "creation_date": 1470837902, "answer_id": 38875696, "question_id": 38874829, "link": "https://stackoverflow.com/questions/38874829/excel-vba-loop-search-for-value-then-color-row/38875696#38875696", "title": "Excel VBA - Loop search for value then color row", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow\"><code>Autofilter</code></a>() method of <code>Range</code> object can detect \"23\" both as number and a text:</p>\n\n<pre><code>With sht\n    With .Range(\"W1\", .Cells(.Rows.Count, \"W\").End(xlUp)) '&lt;--| consider column \"W\" values down to its last non empty row\n        .AutoFilter field:=1, Criteria1:=myValue '&lt;--| filter column \"W\" on 'myValue'\n        If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then '&lt;--| if any values match...\n            With .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Interior '&lt;--|... consider only filtered values, and apply formatting\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .Color = 65535\n                .TintAndShade = 0\n                .PatternTintAndShade = 0\n            End With\n        End If\n    End With\n    .ShowAllData '&lt;--| show all rows back...\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1470837911, "creation_date": 1470837911, "answer_id": 38875698, "question_id": 38874829, "link": "https://stackoverflow.com/questions/38874829/excel-vba-loop-search-for-value-then-color-row/38875698#38875698", "title": "Excel VBA - Loop search for value then color row", "body": "<p>Try replacing your loop with this:</p>\n\n<pre><code>Dim tempFind\nSet tempFind = ActiveSheet.Columns(\"W\").Find(What:=myValue, LookIn:=xlValues, LookAt:=xlWhole, _\nSearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\nIf Not tempFind Is Nothing Then\n    With Range(tempFind.Address).Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\nElse\n    MsgBox \"Not Found!\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6439148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed440bd57ef9a3db093749d32104e299?s=128&d=identicon&r=PG&f=1", "display_name": "Shakdun", "link": "https://stackoverflow.com/users/6439148/shakdun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "accepted_answer_id": 38875696, "answer_count": 4, "score": 0, "last_activity_date": 1470839131, "creation_date": 1470835679, "last_edit_date": 1470836095, "question_id": 38874829, "link": "https://stackoverflow.com/questions/38874829/excel-vba-loop-search-for-value-then-color-row", "title": "Excel VBA - Loop search for value then color row", "body": "<p>This macro is supposed to find the value <strong><em>NULL</em></strong> in column \"<strong>W</strong>\" and paint the row it found NULL on in a color. It does that fine however if I try to search for a number in the same column(that i know exists there) it doesn't seem to find the value. Any help would be appreciated.</p>\n\n<pre><code>Sub e()\n\nMsgBox \"some question?\", , \"Marvin The Paranoid Android\"\n\nDim fNameAndPath As Variant, wb As Workbook\nDim LastRow As Long, i As Long, sht As Worksheet\nDim myValue As Variant\n\nfNameAndPath = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.XLSX), *.XLSX\", Title:=\"\u00c8\u00e7\u00e1\u00e5\u00f0\u00e5\u00f2\u00e5 \u00f4\u00e0\u00e9\u00eb \u00f1 \u00e8\u00ec\u00e5 /\u00d0\u00e5\u00e2\u00ee\u00eb\u00e2\u00e8\u00ed\u00e3\u00e8/\")\nIf fNameAndPath = False Then Exit Sub\n\nSet wb = Workbooks.Open(fNameAndPath)\nSet sht = wb.Worksheets(\"Sheet1\")\nX = wb.Name\n\nWindows(X).Activate\n\n'Macro optimization\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.DisplayAlerts = False\nApplication.Calculation = xlCalculationManual\n'000000000\nActiveWindow.Zoom = 85\nRows(\"1:1\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlCenter\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nRange(\"A1:W1\").Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .color = 65535\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nRange(\"A:E,L:N\").EntireColumn.AutoFit\nColumns(\"F:F\").ColumnWidth = 6.14\nColumns(\"G:G\").ColumnWidth = 6.43\nColumns(\"H:K\").ColumnWidth = 5.43\nRange(\"O:R,T:V\").ColumnWidth = 4.71\nColumns(\"S:S\").ColumnWidth = 14.71\nRows(\"1:1\").RowHeight = 54.54\nRange(\"A1\").Select\n\nmyValue = InputBox(\"Give me some input\")\n\nLastRow = sht.Cells(sht.Rows.Count, \"W\").End(xlUp).row\n\nFor r = 1 To LastRow\n    If Cells(r, Columns(\"W\").Column).Value = myValue Then\n        Rows(r).Select\n        With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .color = 65535\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n    End If\nNext r\n\nRange(\"A1\").Select\nApplication.Calculation = xlCalculationAutomatic\n\nwb.Close SaveChanges:=True 'or false\n\n'Reverse macro optimization\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nMsgBox \"\u00ce\u00e1\u00f0\u00e0\u00e1\u00ee\u00f2\u00e8\u00f5 \u00f4\u00e0\u00e9\u00eb /\u00d0\u00e5\u00e2\u00ee\u00eb\u00e2\u00e8\u00ed\u00e3\u00e8/...\", , \"Marvin The Paranoid Android\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "arrays", "excel", "recordset", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1470837686, "post_id": 38875014, "comment_id": 65112510, "body": "If you want the headers, paste to <code>&quot;A2&quot;</code> and add the following:                     <code>With ThisWorkbook.Sheets(1)                         Set Range1 = .Range(.Cells(1, 1), .Cells(1, rst.Fields.Count))                         For Each Cell1 In Range1                             Cell1.Value = rst.Fields(Cell1.Column - 1).Name                             Cell1.Font.Bold = True                         Next Cell1                     End With</code>"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1470837698, "post_id": 38875014, "comment_id": 65112520, "body": "See I was doing that before and I am now in the experimental phase where I try and improve performance, but you make it sound like its &quot;6 of one, half dozen of the other&quot; where the trade offs dont really amount to much."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1470837845, "post_id": 38875014, "comment_id": 65112632, "body": "It seems sort of kludgey to dump the recordset into the worksheet, manipulate, and then pick it back up into your array to do whatever else you are going to do, but... your result set is large, and data transformation within a range is what Excel... excels at... So I would just let it do it&#39;s thing."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1470838117, "post_id": 38875014, "comment_id": 65112837, "body": "Yeah I get that but the thing i was trying to avoid was looping through fields for headers and then dumping recordset per sheet per workbook. Granted no biggy when there is only one recordset and its x-amount. It eats up time when you hitting multiple instances of large queries (My current full code does this about 20 times). I mean it takes 3-4 minutes and thats not bad... but you know how it goes - tinker for fun to see what you can do @JNevill"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1470838959, "post_id": 38875014, "comment_id": 65113598, "body": "I&#39;m all about tinkering. I&#39;ll refactor for hours to save a few lousy seconds. I just added to the answer with a function that I use to grab data from a DB and dump results (optionally with headers) to the workbook. And then an example where I use that function to grab data, dump it, bold the headers,  transpose the data, and stick the results in an array."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1470841411, "post_id": 38875014, "comment_id": 65115513, "body": "Looks pretty similar to what Im already using except for some fancy boldening you got going on there (though I will def save this example and compare notes). I guess here is some &quot;preference&quot; based questions: Why use ADODB versus DAO? Is there any real reason? I would like to legitimately understand why you would use one above the other, o if you have handy link id love some reading material. @JNevill"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1470841751, "post_id": 38875014, "comment_id": 65115745, "body": "I use ADODB because I&#39;m connecting to Teradata (and sometimes SQLServer and, every once in awhile, to an excel sheet) and it&#39;s what I feel comfortable with. It&#39;s fast, well supported, and feels more like a standard outside of Access querying Access through vba. I agree that our code looks very similar. I just wanted to get an example in here that shows a recordset dropped to a worksheet, manipulated, and then shoved into an array. This is one of those fun examples where there a lots of ways to do what needs to be done : )"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1470842384, "post_id": 38875014, "comment_id": 65116188, "body": "A link about the difference between the two. Looks like they both have some pro&#39;s and cons. Might have to use both depending on the project. <a href=\"http://www.utteraccess.com/wiki/index.php/Choosing_between_DAO_and_ADO\" rel=\"nofollow noreferrer\">utteraccess.com/wiki/index.php/Choosing_between_DAO_and_ADO</a>"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 4, "last_activity_date": 1470838842, "last_edit_date": 1470838842, "creation_date": 1470836156, "answer_id": 38875014, "question_id": 38874815, "link": "https://stackoverflow.com/questions/38874815/sql-query-to-vba-array/38875014#38875014", "title": "SQL Query to VBA Array", "body": "<p>I think it would be quicker to just dump the results to the sheet using:</p>\n\n<pre><code>Sheet1.Range(\"A1\").CopyFromRecordset rst\n</code></pre>\n\n<p>And then store the results of that dump (from the range) into an array. If it isn't vertical or horizontal like you like, a quick copy/paste-special transpose will make very quick work of it, before bringing it back into the array. </p>\n\n<p>I'm only suggesting that since it seems like your recordset is rather large (2x10000), so iterating as you are doing is going to be time consuming, where dumping the results to the worksheet, manipulating, and picking them back up should be very very quick.</p>\n\n<hr>\n\n<p>I work with ADODB recordsets a lot in Excel, so I have a module that I just import to any sheet where I'm going to be connecting to a database. In it is a subroutine that I use where I just send it the SQL, a range to which it should drop the data and a flag if it should drop the headers too, and whether or not the function should handle the connection. That last flag is for when I want to open a connection, issue multiple SQL statements, then close it. Otherwise this just opens, runs the SQL, and closes. </p>\n\n<pre><code>Sub getData(strSQL As String, rngDrop As Range, Optional includeHeaders As Boolean = False, Optional handleConnection As Boolean = True)\n\n    Dim rs As New ADODB.Recordset\n\n    'Little error handling\n    On Error GoTo errHandler\n\n    'Open the database (seperate function for creating the connection object)\n    If handleConnection Then openConnection\n\n    'set up the recordset\n    rs.ActiveConnection = adoConn\n    rs.LockType = adLockOptimistic\n    rs.CursorLocation = adOpenKeyset\n    rs.Open strSQL\n\n    'check for data\n    If rs.EOF And rs.BOF Then\n        Debug.Print \"No data returned. Boo.\"\n        Debug.Print \"   Offending SQL:\"\n        Debug.Print \"---------------------------\"\n        Debug.Print strSQL\n        Debug.Print \"---------------------------\"\n    End If\n\n    'clear the range\n    rngDrop.ClearContents\n\n    'If the headers are requested, then dump those and offset(1) to dump the data\n    If includeHeaders Then\n        Dim header As field\n        Dim intCol As Integer: intCol = 0\n\n        For Each header In rs.Fields\n            rngDrop.Cells(1, 1).Offset(0, intCol).value = header.Name\n            intCol = intCol + 1\n       Next header\n       rngDrop.Cells(1, 1).Offset(1, 0).CopyFromRecordset rs\n    Else\n        'otherwise just dump the recordset\n        rngDrop.CopyFromRecordset rs\n    End If\n\n    'clean up\n    rs.Close\n    If handleConnection Then adoConn.Close\n    Exit Sub\nerrHandler:\n    Debug.Print Err.description, vbCritical, \"Error \" &amp; Err.Number\nEnd Sub\n</code></pre>\n\n<p>I use <a href=\"https://support.microsoft.com/en-us/kb/830287\" rel=\"nofollow\">dynamic named ranges</a> for the range I pass into this function so that I can quick dump and then reference the data in the worksheet. This way the range to which we are dropping the data grows/shrinks with the data that is dropped to it. So fetching some data, with a header, bolding the header,  then copying and transposing it elsewhere, and finally sticking it in an array would look like:</p>\n\n<pre><code> Sub test()\n     getData(\"Select f1, f2 FROM table;\", Range(\"MyNamedRange\"), True)\n     Range(\"MyNamedRange\").Rows(1).Font.Bold = True\n     Range(\"MyNamedRange\").Copy \n     Sheet2.Range(\"A1\").pasteSpecial Transpose:=True\n     Arr = Sheet2.Range(\"A1\").Resize(Range(\"myNAmedRange).columns.count, Range(\"MyNamedRange\").Rows.Count)\n End Sub\n</code></pre>\n\n<p>That could probably be cleaned up a bit, but it should work and it should be pretty quick.</p>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8150, "favorite_count": 1, "accepted_answer_id": 38875014, "answer_count": 1, "score": 1, "last_activity_date": 1470838842, "creation_date": 1470835660, "last_edit_date": 1531161705, "question_id": 38874815, "link": "https://stackoverflow.com/questions/38874815/sql-query-to-vba-array", "title": "SQL Query to VBA Array", "body": "<p>As the title suggests I am looking into different ways to store the contents of a query into an array. I have been experimenting with different varieties of doing this, but it seems to be that most of these ways are in correct in their output. This is of course do to my lack of understanding of how this is supposed to be appropriately done, so after a while of experimenting I have decided to ask whats the best approach for this? I will share with you some of my approaches thus far and you can see where my investigation has landed me. </p>\n\n<pre><code>Dim MyArray() As Variant\nMyArray = rst.GetRows(rst.RecordCount)\n</code></pre>\n\n<p>This was <em>ok</em> yet this stored all the information vertically instead of horizontally. Is there a way to flip that? Would that be through the use of ReDim? Or is this due to the fact the rows are getting stored in array dimensions and thus they naturally vertical? </p>\n\n<pre><code>        Index = 0\n        Do While Not rst.EOF\n                ReDim Preserve MyArray(1, Index)\n                MyArray(0, Index) = CStr(rst.Fields(0).Value)\n\n                'Safety check to make sure the value isn't null (was having problems before)\n                If rst.Fields(1).Value &lt;&gt; vbNullString Then\n                    MyArray(1, Index) = CStr(rst.Fields(1).Value)\n                End If\n            Index = Index + 1\n            rst.MoveNext\n        Loop\n\n        sheet.Range(\"a1:ba10000\").Value = MyArray\n</code></pre>\n\n<p>This again stored things vertically, but didnt output the records correctly, and in fact only pull the first two columns of info per record, the rest was output as #N/A#. I think I was closer with my original approach, but decided experimenting might land me somewhere. </p>\n\n<p>Do you peeps have some suggestions or can point me in the right direction?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 5, "last_activity_date": 1470834799, "creation_date": 1470834799, "answer_id": 38874510, "question_id": 38874339, "link": "https://stackoverflow.com/questions/38874339/how-to-change-number-of-decimal-places-stored-in-a-tables-field-ms-access-2013/38874510#38874510", "title": "How to change number of decimal places stored in a table&#39;s field ms-access 2013 VBA?", "body": "<p>Run an UPDATE query like this:</p>\n\n<pre><code>UPDATE myTable\nSET Quantity = Round([Quantity], 2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "is_accepted": false, "score": -2, "last_activity_date": 1470836753, "creation_date": 1470836753, "answer_id": 38875258, "question_id": 38874339, "link": "https://stackoverflow.com/questions/38874339/how-to-change-number-of-decimal-places-stored-in-a-tables-field-ms-access-2013/38875258#38875258", "title": "How to change number of decimal places stored in a table&#39;s field ms-access 2013 VBA?", "body": "<ol>\n<li>There are no 2 dec digits data type in Acs. 4-fixed-digit only is Currency. If you need exactly 2 - you need to have two fields - Long for Integer part, and Byte - for decimal, I guess...  </li>\n<li><p>Please, keep in mind that <strong>proposed Round([Quantity], 2) is\nBanking, not school (standard) rounding!</strong></p>\n\n<p>? Round(12.5)<br>\n12<br>\n? Round(13.5)<br>\n14  </p></li>\n</ol>\n\n<p>.</p>\n"}], "owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 0, "accepted_answer_id": 38874510, "answer_count": 2, "score": 0, "last_activity_date": 1470836753, "creation_date": 1470834398, "question_id": 38874339, "link": "https://stackoverflow.com/questions/38874339/how-to-change-number-of-decimal-places-stored-in-a-tables-field-ms-access-2013", "title": "How to change number of decimal places stored in a table&#39;s field ms-access 2013 VBA?", "body": "<p>I have a macro that formats my table, changes the field names and does a few other formatting operations before I push the data to a MySQL database. Now I want to be able to change the number of decimal places stored in the table to 2 numbers after the decimal. My field name is \"Quantity\". Is there a property I can use to set this in VBA? I have a web page that sits on the MySQL database, so I want to do all of the operations and other fixes in the Access db so that when I push the data, it is all ready to go.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1470833852, "post_id": 38874014, "comment_id": 65109596, "body": "because you code is scoped for a particular worksheet change. So if you have this code in Sheet1, only when you make change in sheet1 this code will come in play. Either add this code behind all the worksheets or just use the workbook level sheet change event <code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)</code> you can access it in the workbook object."}, {"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1470903956, "post_id": 38874014, "comment_id": 65141948, "body": "Did my solution work on your case?"}, {"owner": {"reputation": 21, "user_id": 2908136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e2f3001156e29e8ce163e287d33c98?s=128&d=identicon&r=PG&f=1", "display_name": "linesd", "link": "https://stackoverflow.com/users/2908136/linesd"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1471422834, "post_id": 38874014, "comment_id": 65335350, "body": "@cyboashu, apologies for the late reply (went away). I&#39;ve actually managed to get this working with a combination of both of the replies so thank you both for the input. The workbook_sheet change was the workbook level sheet change event that I was ultimately looking for so if you put that as an answer I will accept it. If it&#39;s not updated in a few days, I&#39;ll accept the current answer.  Again, thanks for the help!"}, {"owner": {"reputation": 21, "user_id": 2908136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e2f3001156e29e8ce163e287d33c98?s=128&d=identicon&r=PG&f=1", "display_name": "linesd", "link": "https://stackoverflow.com/users/2908136/linesd"}, "reply_to_user": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1471422858, "post_id": 38874014, "comment_id": 65335367, "body": "@RCaetano, please see the above comment. Thanks for the input!"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471422934, "post_id": 38874014, "comment_id": 65335412, "body": "@dl00065... awesome..."}, {"owner": {"reputation": 21, "user_id": 2908136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e2f3001156e29e8ce163e287d33c98?s=128&d=identicon&r=PG&f=1", "display_name": "linesd", "link": "https://stackoverflow.com/users/2908136/linesd"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1471425940, "post_id": 38874014, "comment_id": 65337352, "body": "@cyboashu, please put your comment as an answer and I&#39;ll accept it. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "is_accepted": false, "score": 0, "last_activity_date": 1470836039, "creation_date": 1470836039, "answer_id": 38874973, "question_id": 38874014, "link": "https://stackoverflow.com/questions/38874014/excel-dynamically-change-sheet-tag-based-on-cell-value-in-another-sheet/38874973#38874973", "title": "Excel: Dynamically change sheet tag based on cell value in another sheet", "body": "<p>So you <em>have about 20 or so sheets so it would be laborious to click on each sheet when a change is made.</em> Why not to loop through all sheets to refresh the changes? :)</p>\n\n<p>Something like:</p>\n\n<pre><code>Dim sht As Worksheet\nApplication.ScreenUpdating = False\nFor Each sht In Worksheets\n  sht.Activate\nNext\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>HTH ;)</p>\n"}, {"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 0, "last_activity_date": 1471426124, "creation_date": 1471426124, "answer_id": 38992782, "question_id": 38874014, "link": "https://stackoverflow.com/questions/38874014/excel-dynamically-change-sheet-tag-based-on-cell-value-in-another-sheet/38992782#38992782", "title": "Excel: Dynamically change sheet tag based on cell value in another sheet", "body": "<p>As requested</p>\n\n<p>because your code is scoped for a particular worksheet change. So if you have this code in Sheet1, only when you make change in sheet1 this code will come in play. Either add this code behind all the worksheets or just use the workbook level sheet change event Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range) you can access it in the workbook object.</p>\n"}], "owner": {"reputation": 21, "user_id": 2908136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e2f3001156e29e8ce163e287d33c98?s=128&d=identicon&r=PG&f=1", "display_name": "linesd", "link": "https://stackoverflow.com/users/2908136/linesd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 38992782, "answer_count": 2, "score": 0, "last_activity_date": 1471426124, "creation_date": 1470833601, "question_id": 38874014, "link": "https://stackoverflow.com/questions/38874014/excel-dynamically-change-sheet-tag-based-on-cell-value-in-another-sheet", "title": "Excel: Dynamically change sheet tag based on cell value in another sheet", "body": "<p>I am trying to dynamically change the sheet tag name based on a cell value in another sheet, the \"title\" sheet. The dynamic change works well when I am doing the update from the same sheet and changes upon hitting enter after changing the cell value. But when the reference cell is located in another sheet, after hitting enter there is no change to the sheet tag until I actively access the sheet to be updated and click in the sheet. Is there anyway of getting around this? I have about 20 or so sheets so it would be laborious to click on each sheet when a change is made. Here is my code:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n    Set Target = Worksheet(\"Title\").Range(\"A1\")\n    If Target = \"\" Then Exit Sub\n    On Error GoTo Badname\n    ActiveSheet.Name = Left(Target, 31)\n    Exit Sub\nBadname:\n    MsgBox \"Please revise the entry in A1.\" &amp; Chr(13) _\n    &amp; \"It appears to contain one or more \" &amp; Chr(13) _\n    &amp; \"illegal characters.\" &amp; Chr(13)\n    Range(\"A1\").Activate\nEnd Sub\n</code></pre>\n\n<p>My other option is to add an update button to execute changes, but if possible I would like to avoid this.</p>\n\n<p>Any suggestions would be appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 195, "user_id": 3751928, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f2c4db40c072b503d699cfbb79620512?s=128&d=identicon&r=PG&f=1", "display_name": "GEnGEr", "link": "https://stackoverflow.com/users/3751928/genger"}, "edited": false, "score": 0, "creation_date": 1470833037, "post_id": 38873730, "comment_id": 65108939, "body": "Yes you can apply background color to a cell. But can you give a bit more input on what the situation is ? like what do you mean by &quot;I apply a sort the column&quot;"}, {"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "reply_to_user": {"reputation": 195, "user_id": 3751928, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f2c4db40c072b503d699cfbb79620512?s=128&d=identicon&r=PG&f=1", "display_name": "GEnGEr", "link": "https://stackoverflow.com/users/3751928/genger"}, "edited": false, "score": 0, "creation_date": 1470833967, "post_id": 38873730, "comment_id": 65109680, "body": "The column (e.g. D) contains some values (number; e.g. ages). When I sort ascending the values, I need to change the background of D1 (header) in blue."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470834086, "post_id": 38873730, "comment_id": 65109777, "body": "@colombo2003 your post is missing some data, please share a screen-shot of your excel sheet, which cells you want to color. Also you code attempt"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470872119, "post_id": 38874410, "comment_id": 65130917, "body": "Always return FALSE (both if the values are sorted or not). - are not recognized. What is wrong?"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "reply_to_user": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470907909, "post_id": 38874410, "comment_id": 65144504, "body": "This shows <a href=\"http://imgur.com/V0z2NY5\" rel=\"nofollow noreferrer\">Sorted</a> and this shows <a href=\"http://imgur.com/i6JTetV\" rel=\"nofollow noreferrer\">Unsorted</a>. The <a href=\"http://imgur.com/GBRDKMr\" rel=\"nofollow noreferrer\">formula</a> is as shown."}, {"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470918697, "post_id": 38874410, "comment_id": 65151814, "body": "Ok, but return FALSE if a cell in range is blank (or I delete it). How can I fix that?"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "reply_to_user": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470928941, "post_id": 38874410, "comment_id": 65159655, "body": "If the cell in a range is blank or you delete it, it is no longer a sorted column. You now have two sorted ranges, split by a blank row."}, {"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470938672, "post_id": 38874410, "comment_id": 65165076, "body": "And how to do this, when the position of a blank (or deleted) cell is variable?"}, {"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470946677, "post_id": 38874410, "comment_id": 65169273, "body": "I tried this: <code>code</code> Range(&quot;H1&quot;).Select     Selection.AutoFilter<code>code</code>"}, {"owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "edited": false, "score": 0, "creation_date": 1470947098, "post_id": 38874410, "comment_id": 65169466, "body": "I tried this: <code>code</code> Range(&quot;H1&quot;).Select     Selection.AutoFilter<code>code</code>. And I want to attach a counting (variable x). If the value is odd, then the background color of cell is color 1 (filter on), else is color 2 (filter off). My problem is I don&#39;t know how to store the value of x and then use it after the macro is finish. Any idea? Thx"}], "tags": [], "owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "is_accepted": false, "score": 0, "last_activity_date": 1470834571, "creation_date": 1470834571, "answer_id": 38874410, "question_id": 38873730, "link": "https://stackoverflow.com/questions/38873730/background-color-cell-if-sort-is-active/38874410#38874410", "title": "Background color cell if sort is active", "body": "<p>You can put this</p>\n\n<blockquote>\n  <p>=SUMPRODUCT(-(A1:A10>=A2:A11))=-(A11&lt; A10)</p>\n</blockquote>\n\n<p>into a cell - where your range replaces A1:A10 - then use that as a trigger for your \"Am I sorted query\".</p>\n"}], "owner": {"reputation": 121, "user_id": 4389229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ac1c26582284d9b99ddd8fb29533aa4a?s=128&d=identicon&r=PG&f=1", "display_name": "colombo2003", "link": "https://stackoverflow.com/users/4389229/colombo2003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470834571, "creation_date": 1470832829, "last_edit_date": 1531164843, "question_id": 38873730, "link": "https://stackoverflow.com/questions/38873730/background-color-cell-if-sort-is-active", "title": "Background color cell if sort is active", "body": "<p>I need to add a background color to the header cell of a table when:</p>\n\n<ul>\n<li>I apply some sort in that column; </li>\n<li>I apply a filter in that column.</li>\n</ul>\n\n<p>It is possible? If yes, how?</p>\n"}, {"tags": ["vba", "excel", "time"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1470833950, "post_id": 38873633, "comment_id": 65109664, "body": "how does &#39;expected pieces&#39; currently update?"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1470834553, "post_id": 38873633, "comment_id": 65110123, "body": "@tompreston there are a few drop down cells and based on what is in those cells, the expected pieces is calculated"}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1470836405, "post_id": 38874987, "comment_id": 65111504, "body": "is there not any code that could be used to simply freeze the expected pieces cells? as in hold the value there until the sheet is reset?"}, {"owner": {"reputation": 1157, "user_id": 1908616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3109b05827590cceef3d7c87ba31ab42?s=128&d=identicon&r=PG", "display_name": "Ulli Schmid", "link": "https://stackoverflow.com/users/1908616/ulli-schmid"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1470836649, "post_id": 38874987, "comment_id": 65111691, "body": "You could disable calculation, but that would affect the entire sheet. And I&#39;m guessing then you&#39;ll need VBA anyways for recalculating the cells you actually want updating."}, {"owner": {"reputation": 1157, "user_id": 1908616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3109b05827590cceef3d7c87ba31ab42?s=128&d=identicon&r=PG", "display_name": "Ulli Schmid", "link": "https://stackoverflow.com/users/1908616/ulli-schmid"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1470836719, "post_id": 38874987, "comment_id": 65111747, "body": "There is code for what you want; yes; but it is VBA code and not any Excel formula."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1470836823, "post_id": 38874987, "comment_id": 65111832, "body": "I am relatively comfortable writing VBA code so if what i am describing exists id like to do that. what kind of commands would be used to keep a cell from updating based on a criteria"}, {"owner": {"reputation": 1157, "user_id": 1908616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3109b05827590cceef3d7c87ba31ab42?s=128&d=identicon&r=PG", "display_name": "Ulli Schmid", "link": "https://stackoverflow.com/users/1908616/ulli-schmid"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1470839070, "post_id": 38874987, "comment_id": 65113698, "body": "@Vbasic4now i added some suggestions"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1470839174, "post_id": 38874987, "comment_id": 65113788, "body": "is there a way to only disable auto calculation for a specific range of cells? there are claculations going on all over the document that i dont want to disable"}, {"owner": {"reputation": 1157, "user_id": 1908616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3109b05827590cceef3d7c87ba31ab42?s=128&d=identicon&r=PG", "display_name": "Ulli Schmid", "link": "https://stackoverflow.com/users/1908616/ulli-schmid"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1470839406, "post_id": 38874987, "comment_id": 65113967, "body": "afaik only on a per-worksheet-basis. Sheets(&quot;Sheet1&quot;).EnableCalculation = False. You could of course imagine a hidden sheet with disabled calculation, and your special cells referencing exactly that sheet."}], "tags": [], "owner": {"reputation": 1157, "user_id": 1908616, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3109b05827590cceef3d7c87ba31ab42?s=128&d=identicon&r=PG", "display_name": "Ulli Schmid", "link": "https://stackoverflow.com/users/1908616/ulli-schmid"}, "is_accepted": true, "score": 1, "last_activity_date": 1470839031, "last_edit_date": 1470839031, "creation_date": 1470836086, "answer_id": 38874987, "question_id": 38873633, "link": "https://stackoverflow.com/questions/38873633/excel-stopping-a-cell-form-updating-based-on-the-time/38874987#38874987", "title": "excel stopping a cell form updating based on the time", "body": "<p>This has to be coded in VBA. </p>\n\n<p>As the values in your \"drop down cells\" will change, it is not possible for simple Excel formulas to store or access their previous states. </p>\n\n<p>One could, howerver, imagine some quite ugly workaround with a different set of those \"drop down cells\" for every time slot.</p>\n\n<p><strong>Some VBA suggestions:</strong></p>\n\n<p>1) Disable Auto-Calculation</p>\n\n<pre><code>Private Sub Workbook_Open()\n  Application.Calculation = xlCalculateManual\nEnd Sub\n</code></pre>\n\n<p>Then only re-calculate those cells that fulfill your criteria:</p>\n\n<pre><code>Sub foo()\n  If myCriterion Then\n    Range(\"B3:D7\").Calculate\n  End If\nEnd Sub\n</code></pre>\n\n<p>2) If your criterion is met, replace the formula with its current result</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target as Range) \n  If myCriterion Then\n    Range(\"B3\").Value = Range(\"B3\").Value\n  End If        \nEnd Sub\n</code></pre>\n\n<p>Note that if you want to use the same sheet on day2, you will have to restore the previous \"formula\" version of those cells.</p>\n\n<p><em>Please keep in mind user interaction. You should maybe  block some cells from user input to prevent undesired effects.</em></p>\n"}, {"comments": [{"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1470840350, "post_id": 38875694, "comment_id": 65114750, "body": "i think you misunderstood. @Ulli Schmid is on the right track but i need to develop the idea a little more"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1470837894, "creation_date": 1470837894, "answer_id": 38875694, "question_id": 38873633, "link": "https://stackoverflow.com/questions/38873633/excel-stopping-a-cell-form-updating-based-on-the-time/38875694#38875694", "title": "excel stopping a cell form updating based on the time", "body": "<p>The problem with the following method is that the book has to be open; but you could use the application.OnTime method to cut and paste the values based on the time (copy paste values for one cell at a time on the hour every hour).  You'd have to have a formula in the cells to calculate them.  Does it sound like im barking up the right tree with this or am i missing the point?</p>\n"}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 38874987, "answer_count": 2, "score": 1, "last_activity_date": 1470839031, "creation_date": 1470832589, "question_id": 38873633, "link": "https://stackoverflow.com/questions/38873633/excel-stopping-a-cell-form-updating-based-on-the-time", "title": "excel stopping a cell form updating based on the time", "body": "<p>I have a table that calculates the expected number of pieces to be made for each hour based on a hand full of criteria. as time passes a user is entering information into the actual pieces column. when the criteria (located elsewhere on the sheet) is changed the entire expected pieces column updates. the table look as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/W0v1M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W0v1M.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am trying to make it so that if the current time is after the time in the first column the expected pieces column will not update and will keep the previous value. for example if at 8:30 the expected pieces was 20, after it becomes 9:00 the 8:00 and 7:00 row will hold their expected pieces value while the rest of the column updates as the criteria changes.</p>\n\n<p>I can not for the life of me figure out how to accomplish this. is it possible to do on the front end or should I write some VBA code to control this? </p>\n\n<p>How should I approach this problem? thank you!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1470832883, "post_id": 38873678, "comment_id": 65108831, "body": "You can have an hint on this with Excel changing <code>=IsG10(...)</code> to <code>=ISG10(...)</code> with all capitalized letters."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 3, "creation_date": 1470833475, "post_id": 38873678, "comment_id": 65109312, "body": "Will work if fully qualified as <code>=Module1.ISG10(C3)</code> where <code>module1</code> is the module name where the function is stored in. Not really a solution of course."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 1, "creation_date": 1470833598, "post_id": 38873678, "comment_id": 65109406, "body": "Good Catch @Comintern"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1470834266, "post_id": 38873678, "comment_id": 65109896, "body": "FWIW, for a better performance, add <code>: Exit For</code> after <code>Rslt = True</code>. (+1)"}, {"owner": {"reputation": 53, "user_id": 6700217, "user_type": "registered", "profile_image": "https://graph.facebook.com/1031049663678358/picture?type=large", "display_name": "Marc Mignot", "link": "https://stackoverflow.com/users/6700217/marc-mignot"}, "edited": false, "score": 0, "creation_date": 1470834614, "post_id": 38873678, "comment_id": 65110166, "body": "Duly noted! Thanks for the help."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1470875882, "post_id": 38873678, "comment_id": 65131812, "body": "Huh, <i>another</i> reason to avoid cryptic meaningless names with a numeric suffix."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 11, "last_activity_date": 1470832710, "creation_date": 1470832710, "answer_id": 38873678, "question_id": 38873519, "link": "https://stackoverflow.com/questions/38873519/user-defined-function-returns-ref-in-worksheet-works-in-vba/38873678#38873678", "title": "User defined function returns #REF in worksheet, works in VBA", "body": "<p>You need to rename your function.  <code>ISG10</code> is a valid cell address, so when you put a formula in a cell like <code>=ISG10(A1)</code>, Excel can't parse it correctly.  It works just fine when I change it to <code>Function Foobar(Cur As Range) As Boolean</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 6700217, "user_type": "registered", "profile_image": "https://graph.facebook.com/1031049663678358/picture?type=large", "display_name": "Marc Mignot", "link": "https://stackoverflow.com/users/6700217/marc-mignot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1847, "favorite_count": 0, "accepted_answer_id": 38873678, "answer_count": 1, "score": 4, "last_activity_date": 1470832720, "creation_date": 1470832290, "question_id": 38873519, "link": "https://stackoverflow.com/questions/38873519/user-defined-function-returns-ref-in-worksheet-works-in-vba", "title": "User defined function returns #REF in worksheet, works in VBA", "body": "<p>I'm trying to write a simple UDF that tells me whether a currency code is G10 or not. It works fine when I test it in a sub in VBA but when I try to use it in a spreadsheet I get #REF.</p>\n\n<pre><code>Function IsG10(Cur As Range) As Boolean\n\n  Dim G10s As Variant\n  Dim Rslt As Boolean\n  Dim Cross As Variant\n\n Cross = Cur.Value\n Rslt = False\n\n G10s = Array(\"USD\", \"GBP\", \"EUR\", \"CHF\", \"NOK\", \"SEK\", \"AUD\", \"NZD\", \"CAD\", \"JPY\")\n\nIf Not (Application.WorksheetFunction.IsText(Cross)) Or Len(Cross) &gt; 3 Then\n    IsG10 = CVErr(xlErrNA)\nElse\n    For Each i In G10s\n        If Cross = i Then Rslt = True\n    Next i\nEnd If\n\nIsG10 = Rslt\n\nEnd Function\n</code></pre>\n\n<p>This is the Sub I'm using to test:</p>\n\n<pre><code>Sub Test()\n\n Dim TC As Range\n Dim ans As Variant\n Set TC = Range(\"Y53\")\n\n ans = IsG10(TC)\n\nEnd Sub\n</code></pre>\n\n<p>I've tried quite a few things to make it work, removed the error handling, returning a string instead of a bool... Nothing works. I can't see any obvious UDF mistakes.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "macros", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 6700217, "user_type": "registered", "profile_image": "https://graph.facebook.com/1031049663678358/picture?type=large", "display_name": "Marc Mignot", "link": "https://stackoverflow.com/users/6700217/marc-mignot"}, "is_accepted": false, "score": 1, "last_activity_date": 1470832776, "creation_date": 1470832776, "answer_id": 38873706, "question_id": 38873486, "link": "https://stackoverflow.com/questions/38873486/how-to-draw-a-dashed-line-between-two-cells-if-a-condition-is-met-in-excel/38873706#38873706", "title": "How to draw a dashed line between two cells if a condition is met in Excel", "body": "<p>Use conditional formatting with a formula and format the bottom the border. \nYou can't format the inside of a cell, only the outside so keep that in mind.</p>\n"}, {"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 2, "last_activity_date": 1470835651, "creation_date": 1470835651, "answer_id": 38874812, "question_id": 38873486, "link": "https://stackoverflow.com/questions/38873486/how-to-draw-a-dashed-line-between-two-cells-if-a-condition-is-met-in-excel/38874812#38874812", "title": "How to draw a dashed line between two cells if a condition is met in Excel", "body": "<p>Here's an example of how to draw a line between two <code>Range</code>s and format it e.g. red and dashed. You can adjust the test code to select two <code>Range</code>s based on whatever condition is required by your application. Note the test code uses the assumption that <code>rng1</code> is on the left and <code>rng2</code> is on the right:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim rng1 As Range\n    Dim rng2 As Range\n\n    'assume L-&gt;R line where rng1 is left and rng2 is right\n    'you can set these ranges based on any logic you have\n    Set rng1 = Sheet1.Range(\"B2\")\n    Set rng2 = Sheet1.Range(\"G5\")\n\n    DrawLineBetweenCells rng1, rng2\n\nEnd Sub\n\nSub DrawLineBetweenCells(rng1 As Range, rng2 As Range)\n\n    Dim sngBeginX As Single\n    Dim sngBeginY As Single\n    Dim sngEndX As Single\n    Dim sngEndY As Single\n    Dim ws As Worksheet\n    Dim shp As Shape\n\n    'get worksheet of source range (assume target is same sheet...)\n    Set ws = rng1.Parent\n\n    'right middle edge of start cell\n    sngBeginX = rng1.Left + rng1.Width\n    sngBeginY = rng1.Top + (rng1.Height / 2)\n\n    'left middle edge of end cell\n    sngEndX = rng2.Left\n    sngEndY = rng2.Top + (rng1.Height / 2)\n\n    'draw line\n    Set shp = ws.Shapes.AddLine(sngBeginX, sngBeginY, sngEndX, sngEndY)\n\n    'format line\n    shp.Line.ForeColor.RGB = RGB(255, 0, 0)\n    shp.Line.EndArrowheadStyle = msoArrowheadDiamond\n    shp.Line.DashStyle = msoLineDash\n\nEnd Sub\n</code></pre>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/k6Ngu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k6Ngu.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 4453, "user_id": 1253932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c4c0b379a32fb823f73293fbf3dee5bb?s=128&d=identicon&r=PG", "display_name": "sukhvir", "link": "https://stackoverflow.com/users/1253932/sukhvir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1483, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1470835746, "creation_date": 1470832215, "last_edit_date": 1531161705, "question_id": 38873486, "link": "https://stackoverflow.com/questions/38873486/how-to-draw-a-dashed-line-between-two-cells-if-a-condition-is-met-in-excel", "title": "How to draw a dashed line between two cells if a condition is met in Excel", "body": "<p>My Excel file looks like this :</p>\n\n<p><a href=\"https://i.stack.imgur.com/qifDM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qifDM.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>How would I go about drawing a dashed red line between cell (xxxx) and cell (aaa) if a certain condition is met? </p>\n"}, {"tags": ["vba", "excel", "directory", "desktop"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 2, "creation_date": 1470830870, "post_id": 38872968, "comment_id": 65107438, "body": "Try this : <code>MsgBox CreateObject(&quot;WScript.Shell&quot;).specialfolders(&quot;Desktop&quot;)</code>"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 1, "creation_date": 1470831007, "post_id": 38872968, "comment_id": 65107532, "body": "Or : <code>MsgBox Environ(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop&quot;</code> one of them should work"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1470831271, "post_id": 38872968, "comment_id": 65107735, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17551238/vba-how-to-save-excel-workbook-to-desktop-regardless-of-user\">VBA: How to save Excel Workbook to Desktop regardless of user?</a>"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1470831329, "post_id": 38872968, "comment_id": 65107771, "body": "See duplicate question, the code you are trying to use is VB not VBA :)"}, {"owner": {"reputation": 1, "user_id": 6700198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0bc4318250844a463ce5a0ee3232932?s=128&d=identicon&r=PG&f=1", "display_name": "Piemaster", "link": "https://stackoverflow.com/users/6700198/piemaster"}, "edited": false, "score": 0, "creation_date": 1470831364, "post_id": 38872968, "comment_id": 65107800, "body": "Andreas - Both of these worked a charm - thanks!"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1470832003, "post_id": 38872968, "comment_id": 65108220, "body": "<code>Environment.GetFolderPath(Environment.SpecialFolder.Desktop)</code> is <a href=\"https://stackoverflow.com/questions/tagged/vb.net\">vb.net</a> not <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1470887921, "post_id": 38873902, "comment_id": 65134538, "body": "As per the question above, above code will work. <code>Environment.GetFolderPath</code> is not a VBA"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": -1, "last_activity_date": 1470833272, "creation_date": 1470833272, "answer_id": 38873902, "question_id": 38872968, "link": "https://stackoverflow.com/questions/38872968/issues-accessing-the-user-desktop-using-vba/38873902#38873902", "title": "Issues accessing the user desktop using VBA", "body": "<p>Try with below code</p>\n\n<pre><code>Sub TestMacro()\n    Set oWSHShell = CreateObject(\"WScript.Shell\")\n    MsgBox (oWSHShell.SpecialFolders(\"Desktop\"))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6700198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0bc4318250844a463ce5a0ee3232932?s=128&d=identicon&r=PG&f=1", "display_name": "Piemaster", "link": "https://stackoverflow.com/users/6700198/piemaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 595, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1470833272, "creation_date": 1470830669, "question_id": 38872968, "link": "https://stackoverflow.com/questions/38872968/issues-accessing-the-user-desktop-using-vba", "title": "Issues accessing the user desktop using VBA", "body": "<p>I am trying to use VBA in order to save a file on a user's desktop.  I have found people requesting similar things on this site and others and the answers usually recommend using the following function to get the file path of the user's desktop</p>\n\n<p>Environment.GetFolderPath(Environment.SpecialFolder.Desktop)</p>\n\n<p>However, I tried this and all I get is a 424 Object required error.  The spreadsheet I am trying to add this to is long and complex so I created a new sheet with just the section of code I was interested in.</p>\n\n<pre><code>Sub TestMacro()\n\nDim Testy As String\n\nTesty = Environment.GetFolderPath(Environment.SpecialFolder.Desktop)\n\nMsgBox Testy\n\nEnd Sub\n</code></pre>\n\n<p>When I run this macro I still get a 424 object required error.  Am I doing something wrong?  Or is there something locked down in my office environment preventing me from using this command?</p>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470831911, "post_id": 38873125, "comment_id": 65108156, "body": "hi thanks for the quick reply, basicly the field that is populated by #Name? gets populated after the user clicks a selection in the listbox, and this was working fine, i have a few hidden fields to run some working out as its the eaasiest way i know how and im on a bit of a time constraint.   <a href=\"https://gyazo.com/94ddcb420a752711d4bc364fdcb2dc42\" rel=\"nofollow noreferrer\">gyazo.com/94ddcb420a752711d4bc364fdcb2dc42</a>"}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "reply_to_user": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470833250, "post_id": 38873125, "comment_id": 65109130, "body": "Can you post code of the event that gets triggered when you select any list item ?"}, {"owner": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470833354, "post_id": 38873125, "comment_id": 65109206, "body": "Private Sub Combo102_Click() Me.TxtOldReturn = Me.Combo102.Column(5) Me.TxtIssue = Me.Combo102.Column(4) Me.TxtOldPrice = Me.Combo102.Column(6) End Sub   i changed to it a combobox to see if that would help and it threw up the same error"}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "reply_to_user": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470833561, "post_id": 38873125, "comment_id": 65109376, "body": "Debug the code. Put a breakpoint in the line highlited  Me.TxtOldReturn = Me.Combo102.Column(5)  Me.TxtIssue = Me.Combo102.Column(4)  <b>Me.TxtOldPrice = Me.Combo102.Column(6)</b>  and check what is the value that is getting assigned to Me.TxtoldPrice"}, {"owner": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470833641, "post_id": 38873125, "comment_id": 65109439, "body": "it seems to be throwing up the error before it even runs the code,i put break points on all lines"}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "reply_to_user": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470833642, "post_id": 38873125, "comment_id": 65109440, "body": "i&#39;m assuming txtoldprice is the name of the textbox for &quot;price to pay today&quot;"}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "reply_to_user": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470833756, "post_id": 38873125, "comment_id": 65109523, "body": "Wow..okay. Try changing <b>Me</b> with the proper name of the form."}, {"owner": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470833772, "post_id": 38873125, "comment_id": 65109538, "body": "yeah it is, im just so close to finnishing this for my coursework and its driving me mad"}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "reply_to_user": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470834002, "post_id": 38873125, "comment_id": 65109705, "body": "What happens when you try to debug that function ? What error you getting while trying to debug ?"}, {"owner": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470834121, "post_id": 38873125, "comment_id": 65109802, "body": "the same one that i got before <a href=\"https://gyazo.com/5791cbafd05d9db4b906a3197d6add7b\" rel=\"nofollow noreferrer\">gyazo.com/5791cbafd05d9db4b906a3197d6add7b</a>"}, {"owner": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470834628, "post_id": 38873125, "comment_id": 65110173, "body": "nope ive tried both of those solutions and nothing worked."}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "reply_to_user": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470834717, "post_id": 38873125, "comment_id": 65110239, "body": "It would have been much easier if somehow I could see your screen..anyway...when you add a button in your form. Like excel is there <b>ActiveX Control</b> and <b>Form Control</b> ? Or just  one set of controls ?"}, {"owner": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470834941, "post_id": 38873125, "comment_id": 65110411, "body": "no now when i add a button is get this error <a href=\"https://gyazo.com/384b3193b82c69d918d8e3e8bf2a42d8\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "reply_to_user": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470835343, "post_id": 38873125, "comment_id": 65110739, "body": "Do you have any such line in the code ? <code>Screen.ActiveForm</code>"}, {"owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "reply_to_user": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470835451, "post_id": 38873125, "comment_id": 65110835, "body": "hard to figure out. Give me 3-4 hours if you can, I will access to MSOFFICE and I will try your code and everything. Sounds good ?"}, {"owner": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "edited": false, "score": 0, "creation_date": 1470835524, "post_id": 38873125, "comment_id": 65110881, "body": "yeah that sounds great.. thank you so much for helping me :)"}], "tags": [], "owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "is_accepted": false, "score": 0, "last_activity_date": 1470831131, "creation_date": 1470831131, "answer_id": 38873125, "question_id": 38872824, "link": "https://stackoverflow.com/questions/38872824/issues-with-running-a-form-ms-access/38873125#38873125", "title": "Issues with running a form MS Access", "body": "<p>It could be just me but your questions doesn't provide enough details. Anyway I will try to give you something just by looking at your question and screenshot.</p>\n\n<p>The field \"Price To pay today\" is populating <strong>#Name?</strong>. It happens generally when the query which is supposed to populate the field is not correct. Could you please check your query behind that.</p>\n\n<p>Or right click on the field and go to property and check if the name and label is unique for the field or not.</p>\n\n<p>One more thing that comes to my mind is that it is possible that you defined the type of the field as numbers or something but when you are fetching values, it contains some other characters along with numbers like <strong>&amp;</strong> or <strong>.</strong> . Have a look.</p>\n\n<p>Please post details for a better solutions.</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 7, "user_id": 6667916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03d6b64760ff52f4815260aba2cd3344?s=128&d=identicon&r=PG", "display_name": "user6667916", "link": "https://stackoverflow.com/users/6667916/user6667916"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1470837286, "creation_date": 1470830304, "last_edit_date": 1470837286, "question_id": 38872824, "link": "https://stackoverflow.com/questions/38872824/issues-with-running-a-form-ms-access", "title": "Issues with running a form MS Access", "body": "<p>I'm having some issues with running my form, I have very little code for my listbox and it was all working perfectly fine until I added a button to run a query, then it threw an error. I've tried remaking the form and the query but nothing seems to be working.</p>\n\n<p><a href=\"https://gyazo.com/b9b838240504bb90d441329f46c6c829\" rel=\"nofollow\">https://gyazo.com/b9b838240504bb90d441329f46c6c829</a></p>\n\n<p>This is the error I'm getting and I have looked far and wide for a solution for it.</p>\n\n<p>Any help would be much appresiated.</p>\n\n<p>Thanks\nShavedCloaca</p>\n"}, {"tags": ["string", "excel", "vba", "email-attachments"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470830398, "post_id": 38872783, "comment_id": 65107122, "body": "Maybe <a href=\"https://msdn.microsoft.com/en-us/library/office/ff862085.aspx\" rel=\"nofollow noreferrer\">this</a> will help...or <a href=\"http://stackoverflow.com/questions/15675414/add-attachement-to-outlook-with-varying-file-names\">this</a>."}, {"owner": {"reputation": 51, "user_id": 6390876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b0d01a9cb095b52c48ee8fe448ec7c?s=128&d=identicon&r=PG&f=1", "display_name": "hann783", "link": "https://stackoverflow.com/users/6390876/hann783"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1470830986, "post_id": 38872783, "comment_id": 65107519, "body": "@Brian the second link is where I got the code I started with (ie the idea to define as strlocation. The first I&#39;m afraid I do not understand. There is a number of IF/ELSE queries which affect what is in the body of the email, and also whether the email even has an attachement (not all will). Is this example applicable in this scenario?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6390876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b0d01a9cb095b52c48ee8fe448ec7c?s=128&d=identicon&r=PG&f=1", "display_name": "hann783", "link": "https://stackoverflow.com/users/6390876/hann783"}, "edited": false, "score": 0, "creation_date": 1470833095, "post_id": 38873207, "comment_id": 65108988, "body": "Thanks - but still no attachment when I take the open and close brackets out. I will add some additional questions above."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1470831375, "creation_date": 1470831375, "answer_id": 38873207, "question_id": 38872783, "link": "https://stackoverflow.com/questions/38872783/attaching-variable-file-to-vba-generated-email/38873207#38873207", "title": "Attaching variable file to VBA generated email", "body": "<p>provided strfilename  is a valid file name</p>\n\n<pre><code>.Attachment.Add strfilename\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6390876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b0d01a9cb095b52c48ee8fe448ec7c?s=128&d=identicon&r=PG&f=1", "display_name": "hann783", "link": "https://stackoverflow.com/users/6390876/hann783"}, "edited": false, "score": 0, "creation_date": 1470834360, "post_id": 38873421, "comment_id": 65109972, "body": "thank you. I do have option explicit, just not copied in here.  I have now tried taking all the variants out and have just put in a valid filename in the .Attachment.Add and then the file name and still nothing is being attached. This makes me think the error is somewhere else?"}], "tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1470832678, "last_edit_date": 1470832678, "creation_date": 1470832030, "answer_id": 38873421, "question_id": 38872783, "link": "https://stackoverflow.com/questions/38872783/attaching-variable-file-to-vba-generated-email/38873421#38873421", "title": "Attaching variable file to VBA generated email", "body": "<p>Here is my attempt not knowing if your variables are valid:</p>\n\n<pre><code>Sub AttachFile()\n\nDim OutApp As Object\nDim OutMail As Object\nDim DBlocation As Variant 'Not \"variable\"\nDim DBdate As Variant 'Not \"variable\"\nDim strFileName As String\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\n'ActiveWorkbook.Path  &lt;== Maybe use this instead if it is the same as \"this week's dashboard files\"?\nDBlocation = InputBox(\"Please copy file path to this week's dashboard files\")\nDBdate = InputBox(\"Please type date from DB filename\")\n\nstrFileName = DBlocation &amp; \"\\\" &amp; cell &amp; \" \" &amp; DBdate &amp; \".xlsx\"\n\nWith OutMail\n    .To = cell\n    .SentOnBehalfOfName = \"email@email.com\"\n    .Subject = cell &amp; \" Dashboard \" &amp; Format(Date, \"DD-MMM-YY\")\n    .HTMLBody = strBody &amp; vbNewLine &amp; .HTMLBody\n    .Attachment.Add strFileName\n    .display\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I would also strongly suggest that you use <strong>Option Explicit</strong> at the top of your module to make certain you have declared all your variables (i.e. <code>cell</code> and <code>strBody</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 1451, "user_id": 6552776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UiuKq.jpg?s=128&g=1", "display_name": "csabinho", "link": "https://stackoverflow.com/users/6552776/csabinho"}, "edited": false, "score": 0, "creation_date": 1571885882, "post_id": 58533348, "comment_id": 103390219, "body": "Isn&#39;t it case sensitive?"}, {"owner": {"reputation": 3975, "user_id": 6183113, "user_type": "registered", "profile_image": "https://graph.facebook.com/1248564385154034/picture?type=large", "display_name": "Chanaka Weerasinghe", "link": "https://stackoverflow.com/users/6183113/chanaka-weerasinghe"}, "edited": false, "score": 0, "creation_date": 1571886502, "post_id": 58533348, "comment_id": 103390326, "body": "give breif description and provide what you have tried"}], "tags": [], "owner": {"reputation": 11, "user_id": 12266340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f63615ccf77da844fa17eeb5c8a06af1?s=128&d=identicon&r=PG", "display_name": "Japhet Aureo", "link": "https://stackoverflow.com/users/12266340/japhet-aureo"}, "is_accepted": false, "score": 1, "last_activity_date": 1571884499, "creation_date": 1571884499, "answer_id": 58533348, "question_id": 38872783, "link": "https://stackoverflow.com/questions/38872783/attaching-variable-file-to-vba-generated-email/58533348#58533348", "title": "Attaching variable file to VBA generated email", "body": "<p>try adding \"s\" to attachment. Should look like <strong>.attachments.add strFileName</strong></p>\n"}], "owner": {"reputation": 51, "user_id": 6390876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b0d01a9cb095b52c48ee8fe448ec7c?s=128&d=identicon&r=PG&f=1", "display_name": "hann783", "link": "https://stackoverflow.com/users/6390876/hann783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2486, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1571884499, "creation_date": 1470830192, "last_edit_date": 1470837705, "question_id": 38872783, "link": "https://stackoverflow.com/questions/38872783/attaching-variable-file-to-vba-generated-email", "title": "Attaching variable file to VBA generated email", "body": "<p>Thank you for all your help guys :) \nCode is now functioning.</p>\n\n<p>I am still very new to VBA and am having some issues I would welcome advice on.</p>\n\n<p>I have written some code so that dependent upon the value in a cell a varying email will be sent out to a particular person named in the sheet (each person will get one email). However, I would also like to attach a file specific to that person. </p>\n\n<p>The file location will change weekly and the file name too as there is a date in the name. </p>\n\n<p>The file location will be something like:</p>\n\n<p>U:\\My path\\2016-08-08</p>\n\n<p>and the file name</p>\n\n<p>\"Firstname Surname DD-MM-YYYY.xlsx\"</p>\n\n<p>(where Firstname Surname is earlier defined as \"cell\")</p>\n\n<p>I came up with the following code (only relevant parts included):</p>\n\n<pre><code>   Dim DBlocation as variable\n   Dim DBdate as variable\n   Dim strfilename as string\n\n   DBlocation = InputBox(\"Please copy file path to this week's dashboard files\")\n  DBdate = InputBox(\"Please type date from DB filename\")\n\n   strfilename = DBlocation &amp; \"\\\" &amp; cell &amp; \" \" &amp; DBdate &amp; \".xlsx\" \n\n   .display\n   .To = cell\n   .SentOnBehalfOfName = \"email@email.com\"\n   .Subject = cell &amp; \" Dashboard \" &amp; Format(Date, \"DD-MMM-YY\")\n   .HTMLBody = strbody &amp; vbNewLine &amp; .HTMLBody\n\n   .Attachments.Add (strfilename)\n   .display\n</code></pre>\n\n<p>I have a textbox pop up with the filename and it looks right, but nothing is being attached to the email. </p>\n\n<p>Could you advise how I should change the code to get the file attached?</p>\n\n<p>Thank you so much in advance. </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Code is now working as above. </p>\n\n<p>I worked through your advice and made a couple of changes:</p>\n\n<p>.Attachments.Add  - I added an S after Attachment</p>\n\n<p>I also amended an earlier part of code that I didn't list above</p>\n\n<pre><code>   For Each cell In sh.Columns(\"A\").Cells.SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>this was previously xlCellTypeConstants</p>\n\n<p>I have no idea why this worked but it has :)\nOne super happy person here. </p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470838843, "post_id": 38872704, "comment_id": 65113506, "body": "Do you want the average for each record separately? Or the total average over all records?"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470840368, "post_id": 38872704, "comment_id": 65114764, "body": "Hi Andre - The average of all 3"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470841141, "post_id": 38872704, "comment_id": 65115318, "body": "Please read my question again."}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 6518147, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1204875876202728/picture?type=large", "display_name": "Hynek Bernard", "link": "https://stackoverflow.com/users/6518147/hynek-bernard"}, "is_accepted": true, "score": 2, "last_activity_date": 1470837562, "last_edit_date": 1470837562, "creation_date": 1470837172, "answer_id": 38875416, "question_id": 38872704, "link": "https://stackoverflow.com/questions/38872704/average-3-rows-that-contain-mmhhss/38875416#38875416", "title": "Average 3 rows that contain mm:hh:ss", "body": "<p>I hope you are looking for this </p>\n\n<pre><code>Score: Avg(([swim]+[bike]+[run])/3)\n</code></pre>\n\n<p>Using the <code>Avg()</code> funciton, you are making average of every time in column. Adding them together, the resulting time is too huge to show for access. When you average something in one row, you have to add it up and then divide by number of each member.</p>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 38875416, "answer_count": 1, "score": 1, "last_activity_date": 1593988383, "creation_date": 1470829989, "last_edit_date": 1593988383, "question_id": 38872704, "link": "https://stackoverflow.com/questions/38872704/average-3-rows-that-contain-mmhhss", "title": "Average 3 rows that contain mm:hh:ss", "body": "<p>In my table I have 3 colmuns</p>\n\n<pre><code>T1      T2      T3\n</code></pre>\n\n<p>I want to average the time in all 3.</p>\n\n<p>My query in design view is set as follows:</p>\n\n<pre><code>Score: Avg([swim]+[bike]+[run])\n</code></pre>\n\n<p>In total, I have it done as an expression.</p>\n\n<p>When I run the query an example result shows as: <code>8.81406810035843E-02</code></p>\n\n<p>Any ideas how I can get it to show the average time over all 3 correctly?</p>\n\n<p>I have also changed the format to <code>hh:nn:ss</code> - The results looks better but not correct</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1470830022, "post_id": 38872624, "comment_id": 65106892, "body": "<b>You have not defined <i>blank</i></b>"}, {"owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1470830436, "post_id": 38872624, "comment_id": 65107144, "body": "Pardon my ignorance. How do I do that?"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1470832083, "post_id": 38872961, "comment_id": 65108285, "body": "I&#39;ve added unprotect and protect lines to this code, but still the lock status of the cell does not change. Thoughts?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1470833974, "post_id": 38872961, "comment_id": 65109687, "body": "You will need to initialize the process but after a value is changed on the worksheet it should work properly."}, {"owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1470998737, "post_id": 38872961, "comment_id": 65189159, "body": "is the } supposed to be there?  either way, I get a syntax error.  this should be easy but instead, frustrating"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1471001115, "last_edit_date": 1471001115, "creation_date": 1470830658, "answer_id": 38872961, "question_id": 38872624, "link": "https://stackoverflow.com/questions/38872624/data-in-one-cell-unlocks-another/38872961#38872961", "title": "data in one cell unlocks another", "body": "<p>The worksheet needs to be protected for this to work.  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Cells(6, 21).Locked = IsEmpty(Trim(Cells(6, 17))\n\nEnd Sub\n</code></pre>\n\n<p>If you set the <code>UserInterfaceOnly</code> to True when protecting a worksheet you will not have to unprotect the worksheet to programmable make changes.</p>\n\n<p><code>ActiveSheet.Protect UserInterfaceOnly:=True</code></p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1470832107, "post_id": 38872962, "comment_id": 65108300, "body": "I&#39;ve added unprotect and protect lines to this code, but still the lock status of the cell does not change. Thoughts?"}, {"owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "edited": false, "score": 0, "creation_date": 1470925712, "post_id": 38872962, "comment_id": 65157150, "body": "I&#39;m still not getting this right for some reason. It seems like it should be easy enough and very straightforward"}], "tags": [], "owner": {"reputation": 17, "user_id": 6700147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a91dd563a8e89808381a7114be2fb74?s=128&d=identicon&r=PG&f=1", "display_name": "Greig", "link": "https://stackoverflow.com/users/6700147/greig"}, "is_accepted": false, "score": 1, "last_activity_date": 1470834444, "last_edit_date": 1470834444, "creation_date": 1470830659, "answer_id": 38872962, "question_id": 38872624, "link": "https://stackoverflow.com/questions/38872624/data-in-one-cell-unlocks-another/38872962#38872962", "title": "data in one cell unlocks another", "body": "<p>Try it this way without the Range method</p>\n\n<pre><code>If ActiveSheet.Cells(6, 17) = blank Then\n    ActiveSheet.Cells(6, 21).Locked = True\nElse\n    ActiveSheet.Cells(6, 21).Locked = False\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16, "favorite_count": 0, "accepted_answer_id": 38872961, "answer_count": 2, "score": 0, "last_activity_date": 1471001115, "creation_date": 1470829768, "last_edit_date": 1531164843, "question_id": 38872624, "link": "https://stackoverflow.com/questions/38872624/data-in-one-cell-unlocks-another", "title": "data in one cell unlocks another", "body": "<p>I want cell f21 to be locked if there is no entry (its a time entry if that is important) in f17.  If a time is entered into f17, then f21 is subsequentially unlocked.  Here's my code.  It doesn't work at all.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf ActiveSheet.Cells(6, 17) = blank Then\n    ActiveSheet.Range(Cells(6, 21)).Locked = True\nElse\n    ActiveSheet.Range(Cells(6, 21)).Locked = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>What is wrong?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 1, "creation_date": 1470830055, "post_id": 38872108, "comment_id": 65106910, "body": "Just to add further context, you can use <code>Sheets</code> as well. <a href=\"https://blogs.msdn.microsoft.com/frice/2007/12/05/excels-worksheets-and-sheets-collection-whats-the-difference/\" rel=\"nofollow noreferrer\">This</a> explains the difference quite well. For this example though it doesn&#39;t matter."}, {"owner": {"reputation": 21, "user_id": 2908136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e2f3001156e29e8ce163e287d33c98?s=128&d=identicon&r=PG&f=1", "display_name": "linesd", "link": "https://stackoverflow.com/users/2908136/linesd"}, "edited": false, "score": 0, "creation_date": 1470833584, "post_id": 38872108, "comment_id": 65109392, "body": "Thank you for the link Tim"}], "tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": true, "score": 4, "last_activity_date": 1470828253, "creation_date": 1470828253, "answer_id": 38872108, "question_id": 38872040, "link": "https://stackoverflow.com/questions/38872040/excel-name-sheet-tab-from-cell-value-in-another-sheet/38872108#38872108", "title": "Excel: Name sheet tab from cell value in another sheet", "body": "<p>Use this to reference another worksheet</p>\n\n<pre><code>Worksheets(\"Keywords\").Range(\"A1\").Value\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 2908136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e2f3001156e29e8ce163e287d33c98?s=128&d=identicon&r=PG&f=1", "display_name": "linesd", "link": "https://stackoverflow.com/users/2908136/linesd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 38872108, "answer_count": 1, "score": 0, "last_activity_date": 1470828253, "creation_date": 1470828063, "question_id": 38872040, "link": "https://stackoverflow.com/questions/38872040/excel-name-sheet-tab-from-cell-value-in-another-sheet", "title": "Excel: Name sheet tab from cell value in another sheet", "body": "<p>I can successfully name my sheet tab based on a cell reference in the same sheet with the following VBA code:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n    Set Target = Range(\"A1\")\n    If Target = \"\" Then Exit Sub\n    On Error GoTo Badname\n    ActiveSheet.Name = Left(Target, 31)\n    Exit Sub\nBadname:\n    MsgBox \"Please revise the entry in A1.\" &amp; Chr(13) _\n    &amp; \"It appears to contain one or more \" &amp; Chr(13) _\n    &amp; \"illegal characters.\" &amp; Chr(13)\n    Range(\"A1\").Activate\nEnd Sub\n</code></pre>\n\n<p>However, I am struggling to change the sheet tab based on a cell reference in the title sheet. I have tried simply replacing the range with the reference from the desired sheet, <code>Range(\"Keywords!A1\")</code>, but this does not seem to work.</p>\n\n<p>Any suggestions to get around this would be hugely appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1470827602, "post_id": 38871714, "comment_id": 65105236, "body": "In this case, I&#39;d recommend the use of <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">Regular Expressions (RegEx)</a> to remove the unwanted substrings."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1470831673, "post_id": 38871714, "comment_id": 65108014, "body": "Will the &lt;&quot; &quot;&gt; actually be there? Or are you trying to prevent having the same word in a row twice"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1470828999, "creation_date": 1470828999, "answer_id": 38872356, "question_id": 38871714, "link": "https://stackoverflow.com/questions/38871714/excel-vba-how-to-remove-substrings-from-a-cell/38872356#38872356", "title": "Excel VBA: How to remove substrings from a cell?", "body": "<p>Select the cells containing your text and run this short macro:</p>\n\n<pre><code>Sub Kleanup()\n    Dim d As Range, s As String, rng As Range\n    Dim gather As Boolean, L As Long, DQ As String\n    Dim i As Long, s2 As String, CH As String\n\n    Set rng = Selection\n    DQ = Chr(34)\n\n    For Each r In rng\n        s = Replace(r.Text, \"&lt;\" &amp; DQ, Chr(1))\n        s = Replace(s, DQ &amp; \"&gt;\", Chr(2))\n        gather = True\n        L = Len(s)\n        s2 = \"\"\n        For i = 1 To L\n            CH = Mid(s, i, 1)\n            If CH = Chr(1) Then gather = False\n            If CH = Chr(2) Then gather = True\n            If gather And CH &lt;&gt; Chr(2) Then s2 = s2 &amp; CH\n        Next i\n        r.Value = s2\n    Next r\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1470831723, "post_id": 38872575, "comment_id": 65108041, "body": "That&#39;s not what she&#39;s asking at all."}], "tags": [], "owner": {"reputation": 39, "user_id": 6698942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60cba04cb23ba1ed049525c6ecc19b?s=128&d=identicon&r=PG&f=1", "display_name": "Takdir Madhavi", "link": "https://stackoverflow.com/users/6698942/takdir-madhavi"}, "is_accepted": false, "score": -1, "last_activity_date": 1470829590, "creation_date": 1470829590, "answer_id": 38872575, "question_id": 38871714, "link": "https://stackoverflow.com/questions/38871714/excel-vba-how-to-remove-substrings-from-a-cell/38872575#38872575", "title": "Excel VBA: How to remove substrings from a cell?", "body": "<p>U can Use Replace function</p>\n\n<pre><code>ActiveSheet.Cells(1, 1).Value = Replace(ActiveSheet.Cells(1, 1).Value, \"String\", \"Number\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1470904221, "post_id": 38872919, "comment_id": 65142121, "body": "@PatrickLepelletier - regexes are a steep learning curve, but it is worth the effort. The regex in my answer basically says match anything in <code>&lt;&quot;</code> and <code>&quot;&gt;</code> except the characters <code>&lt;</code> <code>&gt;</code> and <code>&quot;</code>. The regex looks a bit more complicated than it needs to because of the doubled <code>&quot;&quot;</code> in the pattern which are required because VBA uses <code>&quot;</code> for strings and the pattern also needs <code>&quot;</code> in its value. The pattern is actually <code>&lt;&quot;[^&lt;&gt;&quot;]*&quot;&gt;</code> without this complication. You can try it <a href=\"http://www.regex101.com\" rel=\"nofollow noreferrer\">regex101.com</a>"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 3, "last_activity_date": 1470830546, "creation_date": 1470830546, "answer_id": 38872919, "question_id": 38871714, "link": "https://stackoverflow.com/questions/38871714/excel-vba-how-to-remove-substrings-from-a-cell/38872919#38872919", "title": "Excel VBA: How to remove substrings from a cell?", "body": "<p>Following up on the suggestion to use regular expressions, here's an example:</p>\n\n<pre><code>Option Explicit\n\nSub RemoveByRegexWithLateBinding()\n\n    Dim strIn As String\n    Dim strOut As String\n    Dim objRegex As Object\n\n    'input\n    strIn = \"This is a &lt;\"\"string\"\"&gt;string, It should be &lt;\"\"changed\"\"&gt;changed to &lt;\"\"a\"\"&gt; a number.\"\n    Debug.Print \"Input:\" &amp; vbCr &amp; strIn\n\n    'create and apply regex\n    Set objRegex = CreateObject(\"VBScript.RegExp\")\n    objRegex.Pattern = \"&lt;\"\"[^&lt;&gt;\"\"]*\"\"&gt;\"\n    objRegex.Global = True\n    strOut = objRegex.Replace(strIn, \"\")\n\n    'test output\n    Debug.Print \"Output:\" &amp; vbCr &amp; strOut\n\nEnd Sub\n</code></pre>\n\n<p>Produces this output:</p>\n\n<pre><code>Input:\nThis is a &lt;\"string\"&gt;string, It should be &lt;\"changed\"&gt;changed to &lt;\"a\"&gt; a number.\nOutput:\nThis is a string, It should be changed to  a number.\n</code></pre>\n\n<p>Diagram of regular expression:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UB7IU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UB7IU.png\" alt=\"enter image description here\"></a></p>\n\n<p>Which can be explained as finding a string that:</p>\n\n<ul>\n<li>begins with <code>&lt;\"</code></li>\n<li>contains anything apart from the characters <code>&lt;</code>, <code>&gt;</code> and <code>\"</code></li>\n<li>ends with <code>\"&gt;</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": true, "score": 2, "last_activity_date": 1470832073, "creation_date": 1470832073, "answer_id": 38873440, "question_id": 38871714, "link": "https://stackoverflow.com/questions/38871714/excel-vba-how-to-remove-substrings-from-a-cell/38873440#38873440", "title": "Excel VBA: How to remove substrings from a cell?", "body": "<p>Assuming the text in cell A1, then try this code</p>\n\n<pre><code>Sub DelDoubleString()\nDim Text As String, Text2Replace As String, NewText As String\nOn Error Resume Next        'Optional, in case there's no double string to be deleted\nText = Cells(1, 1)\n\nDo\n    Text2Replace = Mid$(Text, InStr(Text, \"&lt;\"), InStr(Text, \"&gt;\") - InStr(Text, \"&lt;\") + 1)\n    NewText = Application.WorksheetFunction.Substitute(Text, Text2Replace, vbNullString)\n    Text = NewText\nLoop Until InStr(NewText, \"&lt;\") = 0\n\nCells(1, 1) = NewText\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1287, "user_id": 6680564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a81746e90e80e3243ac8fce0c2943068?s=128&d=identicon&r=PG&f=1", "display_name": "Rita", "link": "https://stackoverflow.com/users/6680564/rita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 2, "accepted_answer_id": 38873440, "answer_count": 4, "score": 4, "last_activity_date": 1470832073, "creation_date": 1470827214, "last_edit_date": 1531164843, "question_id": 38871714, "link": "https://stackoverflow.com/questions/38871714/excel-vba-how-to-remove-substrings-from-a-cell", "title": "Excel VBA: How to remove substrings from a cell?", "body": "<p>I have a cell value like this:</p>\n\n<pre><code>This is a &lt;\"string\"&gt;string, It should be &lt;\"changed\"&gt;changed to &lt;\"a\"&gt; a number.\n</code></pre>\n\n<p>There are some words repeated in this part <code>&lt;\"  \"&gt;</code>. </p>\n\n<p>I want use Excel VBA to change the cell value to:</p>\n\n<pre><code>This is a string, It should be changed to a number.\n</code></pre>\n\n<p>Any help will be appreciated. Thanks.</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 6698942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60cba04cb23ba1ed049525c6ecc19b?s=128&d=identicon&r=PG&f=1", "display_name": "Takdir Madhavi", "link": "https://stackoverflow.com/users/6698942/takdir-madhavi"}, "is_accepted": false, "score": 0, "last_activity_date": 1470827041, "creation_date": 1470827041, "answer_id": 38871627, "question_id": 38871143, "link": "https://stackoverflow.com/questions/38871143/vba-for-excel-can-hyperlinks-add-target-more-than-one-cell-in-another-sheet/38871627#38871627", "title": "VBA for Excel; Can Hyperlinks.Add target more than one cell in another sheet?", "body": "<p>When hyperlink is clicked it goes to below function. Based on hyperlink cell value insert code in below case. that way you can make hyperlink to do more than one task for you</p>\n\n<pre><code>    Private Sub Workbook_SheetFollowHyperlink(ByVal Sh As Object, _\n    ByVal Target As Hyperlink)\n    Application.EnableCancelKey = xlDisabled\n    intColNum = Int(ActiveCell.Column)\n    intRowNum = Int(ActiveCell.Row)\n\n Select Case UCase(ActiveSheet.Cells(intRowNum, intColNum).Value)\n\n Case \"RUN TEST\"\n  'TestRun\nEnd Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1470827155, "creation_date": 1470827155, "answer_id": 38871683, "question_id": 38871143, "link": "https://stackoverflow.com/questions/38871143/vba-for-excel-can-hyperlinks-add-target-more-than-one-cell-in-another-sheet/38871683#38871683", "title": "VBA for Excel; Can Hyperlinks.Add target more than one cell in another sheet?", "body": "<p>For adding hyperlinks with a range as an adress use something like this</p>\n\n<pre><code>Sub stacktest()\nDim wsA As Worksheet\nDim wsB As Worksheet\n\nSet wsA = Worksheets(1)\nSet wsB = Worksheets(2)\n\nwsA.Hyperlinks.Add Cells(i, 12), Address:=\"\", SubAddress:=\"'\" &amp; \"Sheete2\" &amp; \"'!\" &amp; wsB.Range(wsB.Cells(1, 1), wsB.Cells(1, 5)).Address\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1470827971, "creation_date": 1470827971, "answer_id": 38872009, "question_id": 38871143, "link": "https://stackoverflow.com/questions/38871143/vba-for-excel-can-hyperlinks-add-target-more-than-one-cell-in-another-sheet/38872009#38872009", "title": "VBA for Excel; Can Hyperlinks.Add target more than one cell in another sheet?", "body": "<p>You will need to set the <code>External</code> parameter of the <code>Range.Address</code> to equal True.</p>\n\n<pre><code>Sub Example()\n    Dim i\n\n    With Worksheets(\"Sheet2\")\n        For i = 2 To 10\n\n            ActiveSheet.Hyperlinks.Add Cells(i, 12), Address:=\"\", _\n            SubAddress:=Range(.Cells(i, 1), .Cells(i, 11)).Address(External:=True)\n\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6699886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea42dec829e69f668dc60af57d59dfee?s=128&d=identicon&r=PG&f=1", "display_name": "AndyG", "link": "https://stackoverflow.com/users/6699886/andyg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 38871683, "answer_count": 3, "score": 0, "last_activity_date": 1470828864, "creation_date": 1470825734, "last_edit_date": 1470828864, "question_id": 38871143, "link": "https://stackoverflow.com/questions/38871143/vba-for-excel-can-hyperlinks-add-target-more-than-one-cell-in-another-sheet", "title": "VBA for Excel; Can Hyperlinks.Add target more than one cell in another sheet?", "body": "<p>My Code part:</p>\n\n<pre><code>ActiveSheet.Hyperlinks.Add Cells(i, 12), Address:=\"\", SubAddress:=\"'\" &amp; \"Sheet2\" &amp; \"'!\" &amp; Cells(1,1).Address\n</code></pre>\n\n<p>But i dont like to link only to <code>Cells(1,1)</code>. I would like to link <code>Cells(1,1)</code> To <code>Cells(5,1)</code> so that they are selected every time i click the hyperlink.\nIs this possible?</p>\n\n<p>Thank you\nAndy</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1470826278, "post_id": 38871205, "comment_id": 65104384, "body": "Yup :) That&#39;s exactly what I was looking for. Thank you!                   Could you please explain to me why &quot;selection.cells &quot; did not work?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1470826751, "post_id": 38871205, "comment_id": 65104697, "body": "<code>Selection.Cells</code> returns ALL cells in the selection, thus bringing along those that wouldn&#39;t pass the <code>If IsDate</code> check, too! Since you&#39;re looping through and checking every single <code>cell</code> of <code>Selection</code>, then stick to it!"}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1470826900, "post_id": 38871205, "comment_id": 65104778, "body": "Thanks mate. I really appreciate that."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1470825922, "creation_date": 1470825922, "answer_id": 38871205, "question_id": 38871114, "link": "https://stackoverflow.com/questions/38871114/changing-date-within-selection/38871205#38871205", "title": "Changing date within selection", "body": "<pre><code>Sub adddate()\n    Dim cell As Range\n\n    For Each cell In Selection\n        If IsDate(cell.Value) Then cell = DateAdd(\"d\", 28, CDate(cell))\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15, "favorite_count": 0, "accepted_answer_id": 38871205, "answer_count": 1, "score": 1, "last_activity_date": 1470825922, "creation_date": 1470825658, "question_id": 38871114, "link": "https://stackoverflow.com/questions/38871114/changing-date-within-selection", "title": "Changing date within selection", "body": "<p>I'm using a macro to change dates in selected range. It works just fine, but when within selection there is cell with non-date value ( ex. \"abcdef\" or cell is empty) and I run macro it converts this non-date value into date. How should I fix it? </p>\n\n<p>Current code:</p>\n\n<pre><code>Sub adddate()\nDim cell As Range\nDim r As Range\nSet r = Selection\n\nFor Each cell In Selection\nIf IsDate(cell.Value) Then\nSelection.Cells = DateAdd(\"d\", 28, CDate(cell))\nEnd If\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470826319, "post_id": 38870744, "comment_id": 65104410, "body": "Is this one field bound or unbound?"}, {"owner": {"reputation": 57, "user_id": 5652963, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/606a806b580e313cff4be24b6802bf6f?s=128&d=identicon&r=PG&f=1", "display_name": "r.sa", "link": "https://stackoverflow.com/users/5652963/r-sa"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470828213, "post_id": 38870744, "comment_id": 65105671, "body": "Thanks for the response andre .....the field I am talking about is jus a simple text box where the user selects a date and and stores it in the table...so yes its bound i guess"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1470829381, "post_id": 38870744, "comment_id": 65106458, "body": "You can set the controls to prevent editing (Locked = True), rather than the form. It is often quicker if you add a tag."}], "answers": [{"comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1470829514, "post_id": 38872477, "comment_id": 65106549, "body": "They are controls, not fields. : )"}, {"owner": {"reputation": 57, "user_id": 5652963, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/606a806b580e313cff4be24b6802bf6f?s=128&d=identicon&r=PG&f=1", "display_name": "r.sa", "link": "https://stackoverflow.com/users/5652963/r-sa"}, "edited": false, "score": 0, "creation_date": 1471585837, "post_id": 38872477, "comment_id": 65413703, "body": "Thank for your suggestions Andre...I have noted it down incase I need it some other ime...Currently I have locked each and every field individually...did involve a lot of manual work but I needed it quick"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1470829326, "creation_date": 1470829326, "answer_id": 38872477, "question_id": 38870744, "link": "https://stackoverflow.com/questions/38870744/open-a-field-after-allowedits-in-access/38872477#38872477", "title": "open a field after allowedits in access", "body": "<p>Then you can't use a form-level setting.</p>\n\n<p>If this is constant (the fields are <strong>always</strong> locked), simply set all other controls to <code>Locked = True</code>.</p>\n\n<p>If it's dynamic, use a procedure like this:</p>\n\n<pre><code>Private Sub SetEditable(EnableEdit As Boolean)\n\n    Dim ctl As Control\n\n    For Each ctl In Me.Controls\n        ' The main editable control types (add more if they occur on your form)\n        If ctl.ControlType = acTextBox Or ctl.ControlType = acComboBox Or _ \n           ctl.ControlType = acCheckBox Or ctl.ControlType = acSubform Then\n\n            If ctl.Name = \"MySpecialDateField\" Then\n                    ' Always editable\n                    ctl.Locked = False\n                Else\n                    ctl.Locked = Not EnableEdit\n                    ' If you want to provide a visual feedback: \n                    ' 0 = Flat (locked), 2 = Sunken (editable)\n                    ctl.SpecialEffect = IIf(EnableEdit, 2, 0)\n                End If\n            End If\n\n        End If\n    Next ctl\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5652963, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/606a806b580e313cff4be24b6802bf6f?s=128&d=identicon&r=PG&f=1", "display_name": "r.sa", "link": "https://stackoverflow.com/users/5652963/r-sa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 38872477, "answer_count": 1, "score": 2, "last_activity_date": 1470829362, "creation_date": 1470824747, "last_edit_date": 1470829362, "question_id": 38870744, "link": "https://stackoverflow.com/questions/38870744/open-a-field-after-allowedits-in-access", "title": "open a field after allowedits in access", "body": "<p>I have a huge form in access which needs to prevent users from editing the details in it.. I have done that by setting Me.Allowedits to false. But there is one field which I need to keep as open  to editing. To do this I have jus placed the code to open the field after the allowedits part in two places where the allowedit code occurs. the flow on debugging was like this </p>\n\n<pre><code>   Load \nMe.allowedits =false\nif condition=true\nfield.locked=false\nfield.enalble=true\n</code></pre>\n\n<p>The same thing I have replicated in current event of the form.Basically I have just kept the code wherever the allowedits was set to fasle.\nBut my field is still locked and cannot edit it.Is this because once we set allowedits=false the fields in the page cannot be made editable again.\nIs there any other alternative?</p>\n\n<p>Appreciate the help.</p>\n"}, {"tags": ["excel", "vba", "macros"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 5686065, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/702494576519037/picture?type=large", "display_name": "Abhishek Singh", "link": "https://stackoverflow.com/users/5686065/abhishek-singh"}, "edited": false, "score": 0, "creation_date": 1470825203, "post_id": 38870855, "comment_id": 65103683, "body": "I have to change the size of each ad every cell based on their weight which is in column C. Let me know what part confused you?"}, {"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "reply_to_user": {"reputation": 185, "user_id": 5686065, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/702494576519037/picture?type=large", "display_name": "Abhishek Singh", "link": "https://stackoverflow.com/users/5686065/abhishek-singh"}, "edited": false, "score": 0, "creation_date": 1470825391, "post_id": 38870855, "comment_id": 65103815, "body": "I got that your first table had the column reference in Column B and the value in Column C but you then got me confused with Column A and transposing things. I figured your main problem was around column width rather than getting the values so as long as you know where to get the values from the principle should stand."}, {"owner": {"reputation": 185, "user_id": 5686065, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/702494576519037/picture?type=large", "display_name": "Abhishek Singh", "link": "https://stackoverflow.com/users/5686065/abhishek-singh"}, "edited": false, "score": 0, "creation_date": 1470825536, "post_id": 38870855, "comment_id": 65103916, "body": "But if you look at the example not every column would have a unique width. Each and every cell might have a different width and eventually it would look like a stacked graph horizontally."}, {"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "reply_to_user": {"reputation": 185, "user_id": 5686065, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/702494576519037/picture?type=large", "display_name": "Abhishek Singh", "link": "https://stackoverflow.com/users/5686065/abhishek-singh"}, "edited": false, "score": 0, "creation_date": 1470825604, "post_id": 38870855, "comment_id": 65103954, "body": "So you&#39;re looking at having <code>B1</code> having a different width to <code>B2</code>? I don&#39;t think that&#39;s possible."}, {"owner": {"reputation": 185, "user_id": 5686065, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/702494576519037/picture?type=large", "display_name": "Abhishek Singh", "link": "https://stackoverflow.com/users/5686065/abhishek-singh"}, "edited": false, "score": 0, "creation_date": 1470825745, "post_id": 38870855, "comment_id": 65104036, "body": "Yes that is what I meant. I thought may be there is a way to do it. Anyway, can you explain me the Range thingy you did for a unique column width. I am not even able to run that"}, {"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "reply_to_user": {"reputation": 185, "user_id": 5686065, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/702494576519037/picture?type=large", "display_name": "Abhishek Singh", "link": "https://stackoverflow.com/users/5686065/abhishek-singh"}, "edited": false, "score": 1, "creation_date": 1470826375, "post_id": 38870855, "comment_id": 65104451, "body": "As spreadsheets have just two dimensions (up-down &amp; left-right) there&#39;s no scope for having different widths for the same column further down. You could work you way round it by having an increasing number of merged cells to cover all your options but that would be massively messy and difficult to maintain. In terms of what I wrote in the answer, I&#39;m presuming you have the VBE open (Alt+F11)? In Project Explorer double-click your sheet, type <code>Sub test</code>, hit enter and then in the gap between that and <code>End Sub</code> which should appear then paste in <code>Range(&quot;F:F&quot;).ColumnWidth = Range(&quot;C3&quot;).Value</code>."}, {"owner": {"reputation": 185, "user_id": 5686065, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/702494576519037/picture?type=large", "display_name": "Abhishek Singh", "link": "https://stackoverflow.com/users/5686065/abhishek-singh"}, "edited": false, "score": 0, "creation_date": 1470854274, "post_id": 38870855, "comment_id": 65123329, "body": "Sorry Tim. Saw your massage late. Yes, I am aware about shortcut and stuffs for vba. I tried that part and was able to get then I thought for a single column if 2 and 4 are the cell widths then for 2 I can get 1 cell and for 4 I can get 2 cells but if the numbers are so many then the LCM would mess it up as you said. Could this formulae be enhanced to apply like a lcm thingy I just want to see how it turns out to be?"}], "tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1470825023, "creation_date": 1470825023, "answer_id": 38870855, "question_id": 38870664, "link": "https://stackoverflow.com/questions/38870664/change-column-width-based-on-another-cell-value/38870855#38870855", "title": "Change column width based on another cell value", "body": "<p>Not exactly sure what you mean from your wording but it is certainly easy to change column width via vba.</p>\n\n<p>If you want to change column F based on value of C3 then you need:\n<code>Range(\"F:F\").ColumnWidth = Range(\"C3\").Value</code></p>\n\n<p>Obviously qualify your range so it's specific to whatever sheet / workbook you want etc.</p>\n"}], "owner": {"reputation": 185, "user_id": 5686065, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/702494576519037/picture?type=large", "display_name": "Abhishek Singh", "link": "https://stackoverflow.com/users/5686065/abhishek-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2779, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470825023, "creation_date": 1470824571, "question_id": 38870664, "link": "https://stackoverflow.com/questions/38870664/change-column-width-based-on-another-cell-value", "title": "Change column width based on another cell value", "body": "<p>In excel, I have two three columns and after transpose I have some change to make. Let the data be ::</p>\n\n<pre><code>A   B   C\na   K   .2 \na   Q   .23\na   R   .45\nb   L   .3\nb   S   .12\nc   M   .43\nd   N   .54\ne   O   .32\nf   P   .067\n\nAfter transpose::\na K Q R\nb L S\nc M\nd N\ne O\nf P\n</code></pre>\n\n<p>Each row is filled by whatever values I have in column B corresponding to column A. Now the problem is the cell in which I fill K L S Q R i.e. column B values should be of different sized and in ratio of their weight which is column C.For example K should be 0.2, R should be 0.45 or in the same ratio. And since these are written one below the top entire column could not be changed for \"a\" since the next row cells would be again of different sizes each.</p>\n\n<p>I think this could be achievable by macro but I am not sure about that.Please let me know if you need any further information. Thanks!</p>\n"}, {"tags": ["vba", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 6698942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60cba04cb23ba1ed049525c6ecc19b?s=128&d=identicon&r=PG&f=1", "display_name": "Takdir Madhavi", "link": "https://stackoverflow.com/users/6698942/takdir-madhavi"}, "is_accepted": false, "score": 0, "last_activity_date": 1470824625, "creation_date": 1470824625, "answer_id": 38870693, "question_id": 38870517, "link": "https://stackoverflow.com/questions/38870517/returning-second-value-in-vba-vlookup/38870693#38870693", "title": "Returning second value in VBA vlookup", "body": "<p>Below Function May give you idea that how vloopkup works \nFunction f_Apply_VlookupCalculation_Formulas(arrLookupWs, arrlookupRange, lookupColNo)\n        'arrlookupRange = \"$A$2:$E$2413\"\n        'arrLookupWs = Array(\"DD\", \"MM\")\n        'lookupColNo = 5\n        intRowCount = Int(ActiveSheet.UsedRange.Count)\n        On Error Resume Next\n        For x = 2 To intRowCount\n            ActiveSheet.Cells(x, 4).Value = Application.WorksheetFunction.VLookup(ActiveSheet.Cells(x, 1).Value, Sheets(arrLookupWs(0)).Range(arrlookupRange(0)), lookupColNo - 1, 0)\n            ActiveSheet.Cells(x, 5).Value = Application.WorksheetFunction.VLookup(ActiveSheet.Cells(x, 1).Value, Sheets(arrLookupWs(0)).Range(arrlookupRange(0)), lookupColNo, 0)\n            ActiveSheet.Cells(x, 6).Value = Application.WorksheetFunction.VLookup(ActiveSheet.Cells(x, 1).Value, Sheets(arrLookupWs(1)).Range(arrlookupRange(1)), lookupColNo - 1, 0)\n            ActiveSheet.Cells(x, 7).Value = Application.WorksheetFunction.VLookup(ActiveSheet.Cells(x, 1).Value, Sheets(arrLookupWs(1)).Range(arrlookupRange(1)), lookupColNo, 0)\n        Next\n        On Error GoTo 0\n        Erase arrLookupWs\n        Erase arrlookupRange\n        End Function</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6409325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5011cd1bcfb7bdb1fbddf9a64bb827d?s=128&d=identicon&r=PG&f=1", "display_name": "g4cox", "link": "https://stackoverflow.com/users/6409325/g4cox"}, "edited": false, "score": 0, "creation_date": 1470831366, "post_id": 38871088, "comment_id": 65107802, "body": "This is great thanks and works as a formula, I am trying to use it in VB as part of a bigger project is this possible or do i need to use the formula in the spreadsheet instead?"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1470833880, "last_edit_date": 1470833880, "creation_date": 1470825555, "answer_id": 38871088, "question_id": 38870517, "link": "https://stackoverflow.com/questions/38870517/returning-second-value-in-vba-vlookup/38871088#38871088", "title": "Returning second value in VBA vlookup", "body": "<p>This can be done with <strong>array</strong> formula</p>\n\n<p>this will give the 1st, the normal vlookup</p>\n\n<p><code>=INDEX(I$1:I$13,SMALL(IF($A$1:$A$13=$A$15,ROW($A$1:$A$13)),1),1)</code></p>\n\n<p>this will give the 2nd</p>\n\n<p><code>=INDEX(J$1:J$13,SMALL(IF($A$1:$A$13=$A$15,ROW($A$1:$A$13)),**2**),1)</code></p>\n\n<p>this the 3rd, the  starred number incrementing each time, remove the stars</p>\n\n<p><code>=INDEX(K$1:K$13,SMALL(IF($A$1:$A$13=$A$15,ROW($A$1:$A$13)),**3**),1)</code></p>\n\n<p>Wasn't sure if you were using VBA for a worksheet function or not or within a bigger function.</p>\n\n<p>or something like this, where look for is the cell where the data you're doing countif on is, check values is column a, input range is the return you want, your columns 8 to ..... and column is the return, so to get the 2nd value, same data as the formula  id use</p>\n\n<p><code>VLOOKUP_NEW (range(\"a15\"),range(\"a1:a13\"),range(\"i1:k13\"),2)</code></p>\n\n<pre><code>Public Function VLOOKUP_NEW(rngLookFor As Excel.Range, _\n                        rngCheckValues As Excel.Range, _\n                        rngInputRange As Excel.Range, _\n                        colReturn As Integer) As Variant\n\nDim c As Excel.Range\nDim arrRows() As Long\n\nOn Error GoTo eHandle\n\nFor Each c In rngCheckValues.Cells\n    If c.Value = rngLookFor.Value Then\n        arrRows(UBound(arrRows)) = c.Row\n        ReDim Preserve a(UBound(arrRows) + 1)\n    End If\nNext c\n\nVLOOKUP_NEW = WorksheetFunction.Index(rngInputRange, arrRows(colReturn - 1), colReturn)\n\nExit Function\n\neHandle:\n    If Err.Number = 9 Then\n        ReDim arrRows(0)\n        Resume\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470897116, "post_id": 38881723, "comment_id": 65137866, "body": "@g4cox , did you try this?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1470856302, "creation_date": 1470856302, "answer_id": 38881723, "question_id": 38870517, "link": "https://stackoverflow.com/questions/38870517/returning-second-value-in-vba-vlookup/38881723#38881723", "title": "Returning second value in VBA vlookup", "body": "<p>you try this:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim valToSearch As Variant\n    Dim Data As Range\n    Dim nFilt As Long, r As Long, iArea As Long, iCount As Long, iAreaRow As Long\n\n    r = 3 '&lt;-- just for testing purposes\n    Set Data = ThisWorkbook.Sheets(\"Data\").Range(\"A1:N20\") '&lt;-- just for testing purposes\n\n\n    valToSearch = ThisWorkbook.Sheets(\"Sheet2\").Cells(r, 2).Value'&lt;-- store the value to search\n    With Data '&lt;-- refer to 'Data' range \n        .AutoFilter field:=1, Criteria1:=valToSearch '&lt;--| filter first column of Data range on 'valToSearch' \n        nFilt = Application.WorksheetFunction.Subtotal(103, .Cells.Resize(, 1)) - 1 '&lt;--  count filtered values, assuming there's a header row I subtract 1 not to count its always visible row\n        If nFilt &gt; 0 Then '&lt;-- if at least 1 data row filtered\n            With .Offset(1).Resize(.Rows.Count - 1, 1).SpecialCells(xlCellTypeVisible) '&lt;-- refer to 'Data' range filtered values header excluded \n                For iArea = 1 To .Areas.Count '&lt;-- loop through areas\n                    For iAreaRow = 1 To .Areas(iArea).Rows.Count '&lt;-- loop through area rows\n                        ThisWorkbook.Sheets(\"Sheet2\").Cells(r, 9 + iCount) = .Areas(iArea).Cells(iAreaRow, 14) '&lt;-- paste single filtered value in \"Sheet2\" cell starting from column 14 and offsetting one column rightwards at every pasting\n                        iCount = iCount + 1 '&lt;-- update pasted cells counter\n                        If iCount = nFilt Then Exit For '&lt;-- exit if pasted as many cells as filtered\n                    Next iAreaRow\n                    If iCount = nFilt Then Exit For '&lt;-- exit if pasted as many cells as filtered\n                Next iArea\n            End With\n        End If\n        .Parent.AutoFilterMode = False '&lt;-- shows unfiltered (hidden) rows back\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6409325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5011cd1bcfb7bdb1fbddf9a64bb827d?s=128&d=identicon&r=PG&f=1", "display_name": "g4cox", "link": "https://stackoverflow.com/users/6409325/g4cox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 992, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1470856302, "creation_date": 1470824182, "question_id": 38870517, "link": "https://stackoverflow.com/questions/38870517/returning-second-value-in-vba-vlookup", "title": "Returning second value in VBA vlookup", "body": "<p>I am sure this is easy but cannot find a way to do this. I am trying to count the range in column A if &lt;2 then can just the a regular vlookup to return the one answer but if greater than 2 I want the vlookup to return first answer in column 9 then second in column 10 etc can anyone help? hope this makes sense thanks.</p>\n\n<pre><code>    If (Application.WorksheetFunction.CountIf _       \n (data.Range(\"A:A\"), ThisWorkbook.Sheets(\"Sheet2\").Cells(r, 2).Value)) &lt; 2 _\n        Then\n        toh = Application.WorksheetFunction.VLookup _\n        (ThisWorkbook.Sheets(\"Sheet2\").Cells(r, 2).Value, data.Range(\"A:N\"), 14, False)\n        Cells(r, 9) = toh\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470826866, "post_id": 38870970, "comment_id": 65104755, "body": "Thanks for you reply.Is gaving error &quot;invalid or unqualified reference&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470827333, "post_id": 38870970, "comment_id": 65105075, "body": "The <code>.UsedRange</code> is supposed to be in the <code>With Sheets(&quot;Sheet1&quot;)</code> block.  Try changing <code>.UsedRange</code> to <code>Sheets(&quot;Sheet1&quot;).UsedRange</code>."}, {"owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470829860, "post_id": 38870970, "comment_id": 65106790, "body": "Is the one in the post"}, {"owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470831333, "post_id": 38870970, "comment_id": 65107775, "body": "OK, that worked after i changed to&#39; Intersect(Sheets(&quot;Sheet1&quot;).UsedRange, CopyRange).Copy&#39; like you said."}, {"owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470831397, "post_id": 38870970, "comment_id": 65107819, "body": "and to start looking at a cell range, instead of &#39;A&#39;, is the some thing?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470831874, "post_id": 38870970, "comment_id": 65108139, "body": "I&#39;m not sure what you mean. Are you talking about using Cells.PasteSpecial? Sheets(&quot;Sheet2&quot;).Cells(2, 13).PasteSpecial xlValues"}, {"owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470835096, "post_id": 38870970, "comment_id": 65110545, "body": "Thanks, but its no that,"}, {"owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470835225, "post_id": 38870970, "comment_id": 65110643, "body": "With your your help now is copying to the target that i want. And to define the range to be copied from sheet1, now is A, and to change per exemple to B3?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470835957, "post_id": 38870970, "comment_id": 65111185, "body": "I don&#39;t understand.  Do you want to change the data that you are copying? The code copies the entire row.  Do you just want to copy a sub set of the row?  .Range(.Cells(i, 2), .Cells(i, 5))"}, {"owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "edited": false, "score": 0, "creation_date": 1470836648, "post_id": 38870970, "comment_id": 65111688, "body": "No. The copy starts from &#39;With Sheets(&quot;Sheet1&quot;)         lastRow = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row&#39;. I want not to start from &quot;A&quot;, but from Range B2 to last row."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1470837141, "last_edit_date": 1470837141, "creation_date": 1470825295, "answer_id": 38870970, "question_id": 38870380, "link": "https://stackoverflow.com/questions/38870380/change-initial-range-and-destination-range/38870970#38870970", "title": "Change initial range and destination range", "body": "<p>Because <code>CopyRange</code> is a full row wide you'll need to trim it down before pasting into <code>Range(\"B13\")</code>.  As an additional requirement the OP wants to exclude column A from the source range.</p>\n\n<pre><code>Sub Sample()\n    Dim lastRow As Long, i As Long\n    Dim CopyRange As Range\n\n    '~~&gt; Change Sheet1 to relevant sheet name\n    With Sheets(\"Sheet1\")\n        lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        For i = 2 To lastRow\n            If Len(Trim(.Range(\"A\" &amp; i).Value)) &lt;&gt; 0 Then\n                If CopyRange Is Nothing Then\n                    Set CopyRange = .Rows(i)\n                Else\n                    Set CopyRange = Union(CopyRange, .Rows(i))\n                End If\n            End If\n        Next\n\n        If Not CopyRange Is Nothing Then\n            '~~&gt; Change Sheet2 to relevant sheet name\n            Intersect(Sheets(\"Sheet1\").UsedRange, CopyRange).Offset(0, 1).Copy\n            Sheets(\"Sheet2\").Range(\"B13\").PasteSpecial xlValues\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 1, "accepted_answer_id": 38870970, "answer_count": 1, "score": 0, "last_activity_date": 1470837141, "creation_date": 1470823858, "last_edit_date": 1531161705, "question_id": 38870380, "link": "https://stackoverflow.com/questions/38870380/change-initial-range-and-destination-range", "title": "Change initial range and destination range", "body": "<p>I'm a newbie in Excel vba and I'm trying to change a macro from Siddharth Rout (thanks)\u00b4.</p>\n\n<p>I need to specify the range to begin in a cell, like B13, and to copy to another worksheet in C14.\nHow can this be managed?</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\nDim lastRow As Long, i As Long\nDim CopyRange As Range\n\n'~~&gt; Change Sheet1 to relevant sheet name\nWith Sheets(\"Sheet1\")\n    lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n    For i = 2 To lastRow\n        If Len(Trim(.Range(\"A\" &amp; i).Value)) &lt;&gt; 0 Then\n            If CopyRange Is Nothing Then\n                Set CopyRange = .Rows(i)\n            Else\n                Set CopyRange = Union(CopyRange, .Rows(i))\n            End If\n        End If\n    Next\n\n    If Not CopyRange Is Nothing Then\n        '~~&gt; Change Sheet2 to relevant sheet name\n        CopyRange.Copy\n        Sheets(\"Sheet2\").Rows(1).PasteSpecial xlValues\n    End If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1470824363, "post_id": 38870173, "comment_id": 65103120, "body": "I wonder if you values in cells A1 through A5 ? This may confuse the auto-filtering"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1470825690, "post_id": 38870173, "comment_id": 65104005, "body": "you are right... that was the reason. please make a post so i can mark your answer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1470828842, "post_id": 38870173, "comment_id": 65106048, "body": "Thanks for the correction."}], "answers": [{"tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": true, "score": 4, "last_activity_date": 1470828006, "last_edit_date": 1470828006, "creation_date": 1470824208, "answer_id": 38870534, "question_id": 38870173, "link": "https://stackoverflow.com/questions/38870173/excel-vba-autofilter-2-columns-2-criteria-copies-rows-that-dont-match-wit/38870534#38870534", "title": "Excel VBA - Autofilter (2 columns / 2 criteria) copies rows that don&#39;t match with the criteria", "body": "<p>Try this</p>\n\n<pre><code>With Range(\"A6:T\" &amp; lngLastRow)\n    .AutoFilter Field:=6, Criteria1:=\"Alexandra\"\n    .AutoFilter Field:=19, Criteria1:=\"-14\"\n    .SpecialCells(xlCellTypeVisible).Copy AlexSheet.Range(\"A3\")\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1470824547, "post_id": 38870538, "comment_id": 65103235, "body": "select won&#39;t work because the function is much longer and does the same thing for 15 person and 15 sheets"}, {"owner": {"reputation": 39, "user_id": 6698942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60cba04cb23ba1ed049525c6ecc19b?s=128&d=identicon&r=PG&f=1", "display_name": "Takdir Madhavi", "link": "https://stackoverflow.com/users/6698942/takdir-madhavi"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1470824764, "post_id": 38870538, "comment_id": 65103395, "body": "post you existing function..This will help me to understand what is that"}], "tags": [], "owner": {"reputation": 39, "user_id": 6698942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60cba04cb23ba1ed049525c6ecc19b?s=128&d=identicon&r=PG&f=1", "display_name": "Takdir Madhavi", "link": "https://stackoverflow.com/users/6698942/takdir-madhavi"}, "is_accepted": false, "score": 2, "last_activity_date": 1470824216, "creation_date": 1470824216, "answer_id": 38870538, "question_id": 38870173, "link": "https://stackoverflow.com/questions/38870173/excel-vba-autofilter-2-columns-2-criteria-copies-rows-that-dont-match-wit/38870538#38870538", "title": "Excel VBA - Autofilter (2 columns / 2 criteria) copies rows that don&#39;t match with the criteria", "body": "<pre><code>     It's ? like how are you coping autofiltered data..\n     Copy only special rows\n\n     Range(\"A1\").Select''Destination where want to paste\n     'Use below code to paste\n     Selection.PasteSpecial Paste:=xlPasteValue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 6698942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60cba04cb23ba1ed049525c6ecc19b?s=128&d=identicon&r=PG&f=1", "display_name": "Takdir Madhavi", "link": "https://stackoverflow.com/users/6698942/takdir-madhavi"}, "is_accepted": false, "score": 2, "last_activity_date": 1470828960, "creation_date": 1470828960, "answer_id": 38872347, "question_id": 38870173, "link": "https://stackoverflow.com/questions/38870173/excel-vba-autofilter-2-columns-2-criteria-copies-rows-that-dont-match-wit/38872347#38872347", "title": "Excel VBA - Autofilter (2 columns / 2 criteria) copies rows that don&#39;t match with the criteria", "body": "<pre><code>'For each new FilterCombinations criteria call this sub or modify according to your need\nSub Macro()\nRange(\"A1\").Select ''Assuming that 1st row is for header\nActiveCell.Offset(1, 0).Select\n\nDim intSpRowCount As Integer\nintSpRowCount = Range(\"A1\").CurrentRegion.SpecialCells(xlCellTypeVisible).Rows.count\n\nIf Range(\"A1\").CurrentRegion.SpecialCells(xlCellTypeVisible).Rows.count &gt; 1 Then\n'copy only visible range\nRange(ActiveCell.Offset(0, 0), ActiveCell.Offset(intSpRowCount - 1, Int(ActiveSheet.UsedRange.Rows.count) - 1)).Select\nSelection.Copy\n\nSheets(\"Sheet3\").Select\nRange(\"A6\").Select\nActiveSheet.Paste\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "accepted_answer_id": 38870534, "answer_count": 3, "score": 3, "last_activity_date": 1470828960, "creation_date": 1470823352, "last_edit_date": 1470825257, "question_id": 38870173, "link": "https://stackoverflow.com/questions/38870173/excel-vba-autofilter-2-columns-2-criteria-copies-rows-that-dont-match-wit", "title": "Excel VBA - Autofilter (2 columns / 2 criteria) copies rows that don&#39;t match with the criteria", "body": "<p>when I use the following VBA code:</p>\n\n<pre><code>With Range(\"A6:T\" &amp; lngLastRow)\n    .AutoFilter\n    .AutoFilter Field:=6, Criteria1:=\"Alexandra\"\n    .AutoFilter Field:=19, Criteria1:=\"-14\"\n    .Copy AlexSheet.Range(\"A3\")\n    .AutoFilter\nEnd With\n</code></pre>\n\n<p>it copies rows that have the name \"Alexandra\" in autofilter field 6, but also copies 1 or 2 rows that have a different name and a different value in autofilter field 19 (not -14)</p>\n\n<p>I don't know what causes Excel/VBA to copy rows I have never asked for.</p>\n\n<p>I hope somebody can help me.</p>\n\n<p><strong>FULL CODE:</strong></p>\n\n<pre><code>Sub DeleteFilterAndCopy()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\nSheets(\"Alex\").Range(\"A3:T1000\").clearcontents\nSheets(\"Anett Edith\").Range(\"A3:T1000\").clearcontents\nSheets(\"Angela\").Range(\"A3:T1000\").clearcontents\nSheets(\"Dirk\").Range(\"A3:T1000\").clearcontents\nSheets(\"Daniel\").Range(\"A3:T1000\").clearcontents\nSheets(\"Klaus\").Range(\"A3:T1000\").clearcontents\nSheets(\"Konrad\").Range(\"A3:T1000\").clearcontents\nSheets(\"Marion\").Range(\"A3:T1000\").clearcontents\nSheets(\"MartinX\").Range(\"A3:T1000\").clearcontents\nSheets(\"Michael\").Range(\"A3:T1000\").clearcontents\nSheets(\"Mirko\").Range(\"A3:T1000\").clearcontents\nSheets(\"Nils\").Range(\"A3:T1000\").clearcontents\nSheets(\"Ulrike\").Range(\"A3:T1000\").clearcontents\n\nDim lngLastRow As Long\nDim AlexSheet As Worksheet, AnettEdithSheet As Worksheet, AngelaShett As Worksheet, DanielSheet As Worksheet\nDim DirkSheet As Worksheet, KlausSheet As Worksheet, Konradsheet As Worksheet\nDim MarionSheet As Worksheet, MartinSheet As Worksheet, MichaelSheet As Worksheet, MirkoSheet As Worksheet\nDim NilsSheet As Worksheet, Ulrikesheet As Worksheet\n\nSet AlexSheet = Sheets(\"Alex\")\nSet AnettEdithSheet = Sheets(\"Anett Edith\")\nSet AngelaSheet = Sheets(\"Angela\")\nSet DanielSheet = Sheets(\"Daniel\")\nSet DirkSheet = Sheets(\"Dirk\")\nSet KlausSheet = Sheets(\"Klaus\")\nSet Konradsheet = Sheets(\"Konrad\")\nSet MarionSheet = Sheets(\"Marion\")\nSet MartinSheet = Sheets(\"MartinX\")\nSet MichaelSheet = Sheets(\"Michael\")\nSet MirkoSheet = Sheets(\"Mirko\")\nSet NilsSheet = Sheets(\"Nils\")\nSet Ulrikesheet = Sheets(\"Ulrike\")\n\nlngLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nWith Range(\"A6:T\" &amp; lngLastRow)\n    .AutoFilter\n    .AutoFilter Field:=6, Criteria1:=\"Alexandra\"\n    .AutoFilter Field:=19, Criteria1:=\"-14\"\n    .Copy AlexSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Anett / Edith\"\n    .Copy AnettEdithSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Angela\"\n    .Copy AngelaSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Daniel\"\n    .Copy DanielSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Dirk\"\n    .Copy DirkSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Klaus\"\n    .Copy KlausSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Konrad\"\n    .Copy Konradsheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Marion\"\n    .Copy MarionSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Martin\"\n    .Copy MartinSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Michael\"\n    .Copy MichaelSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Mirko\"\n    .Copy MirkoSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Nils\"\n    .Copy NilsSheet.Range(\"A3\")\n    .AutoFilter Field:=6, Criteria1:=\"Ulrike\"\n    .Copy Ulrikesheet.Range(\"A3\")\n    .AutoFilter\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p><strong>SCREENSHOTS OF DATA:</strong></p>\n\n<p>Data that gets filteres and copied from (orange columns = autofilter fields):\n<a href=\"https://i.stack.imgur.com/XRDvc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XRDvc.png\" alt=\"enter image description here\"></a></p>\n\n<p>The problem is, that the macro does not only copies rows which contain the Planner Alexandra and the value -14, it also copies 1-2 rows that have different values in both cells.</p>\n\n<p>Greetings</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470832456, "post_id": 38869999, "comment_id": 65108519, "body": "If your UI is entirely done with UserForms, you can set <code>Application.Visible = False</code> in <code>Workbook_Open()</code> then show your form."}, {"owner": {"reputation": 7, "user_id": 5723242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6fe3cf4d326922e3a5a03f2f0d51370?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh Rao", "link": "https://stackoverflow.com/users/5723242/santhosh-rao"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470882975, "post_id": 38869999, "comment_id": 65133277, "body": "Please let me know why you gave -ve vote."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1470901207, "post_id": 38869999, "comment_id": 65140294, "body": "It&#39;s not me who downvoted, but your question is not very clear, you can improve it by following the guidelines here: <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2492, "user_id": 2883603, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LdFWO.jpg?s=128&g=1", "display_name": "Amit Kohli", "link": "https://stackoverflow.com/users/2883603/amit-kohli"}, "is_accepted": false, "score": 0, "last_activity_date": 1470823575, "creation_date": 1470823575, "answer_id": 38870275, "question_id": 38869999, "link": "https://stackoverflow.com/questions/38869999/anything-better-than-vba/38870275#38870275", "title": "Anything better than VBA", "body": "<p>Are you looking for <code>application.ScreenUpdating=False</code>? This hides all the macro operations while it's running. Or are you trying to make Excel still run while a macro is running? In which case, just open two instances of Excel first, then run macro on one, and work on the other one (but both can't work on the same file).</p>\n"}, {"tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": true, "score": 0, "last_activity_date": 1470824310, "creation_date": 1470824310, "answer_id": 38870567, "question_id": 38869999, "link": "https://stackoverflow.com/questions/38869999/anything-better-than-vba/38870567#38870567", "title": "Anything better than VBA", "body": "<p>It's hard to understand exactly what you mean by background and foreground, but if your macro is taking too long to run (like minuits) try adding the things below from the article here:</p>\n\n<p><a href=\"https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/\" rel=\"nofollow\">https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/</a></p>\n\n<p>Essentially add this at the start of your code:</p>\n\n<pre><code>With Application.Excel\n    .ScreenUpdating = False\n    .DisplayStatusBar = False\n    .Calculation = xlCalculationManual\n    .EnableEvents = False\nEnd With\n</code></pre>\n\n<p>and this at the end:</p>\n\n<pre><code>With Application.Excel\n    .ScreenUpdating = True\n    .DisplayStatusBar = True\n    .Calculation = xlCalculationAutomatic\n    .EnableEvents = True\nEnd With\n</code></pre>\n\n<p>You can also use</p>\n\n<p>ActiveSheet.DisplayPageBreaks = False 'at the beginning and True at the end\nPersonally though I have found that the biggest performance upgrade generally comes with deactivating the calculations.</p>\n"}], "owner": {"reputation": 7, "user_id": 5723242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6fe3cf4d326922e3a5a03f2f0d51370?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh Rao", "link": "https://stackoverflow.com/users/5723242/santhosh-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 38870567, "answer_count": 2, "score": -1, "last_activity_date": 1470883185, "creation_date": 1470822914, "last_edit_date": 1531164843, "question_id": 38869999, "link": "https://stackoverflow.com/questions/38869999/anything-better-than-vba", "title": "Anything better than VBA", "body": "<p>I have had the opportunity to code using VBA. Most of the VBA Script i have done have been with having Excel in foreground, and excel files not being accessible while the code ran.</p>\n\n<p>Now I am curious to know if there is any ways to keep excel in background and do the cell updation in the same way as it is done on foreground. </p>\n\n<hr>\n\n<p>Update 1:-\nBy background i mean that the file is not kept open on the desktop, but is being access by the program.</p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470826869, "post_id": 38869913, "comment_id": 65104759, "body": "can&#39;t you simply select that combobox on the screen and read its name on the up-left textbox?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470827155, "post_id": 38869913, "comment_id": 65104949, "body": "I just had a look at that..it says Drop Down 1. But I am not sure how can I use that name in the code."}], "answers": [{"comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1470824696, "post_id": 38870386, "comment_id": 65103338, "body": "No I tried that before asking the question, but it doesn&#39;t record the changes made in ComboBox. :("}, {"owner": {"reputation": 2492, "user_id": 2883603, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LdFWO.jpg?s=128&g=1", "display_name": "Amit Kohli", "link": "https://stackoverflow.com/users/2883603/amit-kohli"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1470824790, "post_id": 38870386, "comment_id": 65103417, "body": "to prevent this, it&#39;s typically good practice to say what you already tried. Please update your question with all the things you tried, and then you might get a meaningful answer."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1470825134, "post_id": 38870386, "comment_id": 65103641, "body": "I have updated my question now. Suggest if you have any solution for this."}], "tags": [], "owner": {"reputation": 2492, "user_id": 2883603, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LdFWO.jpg?s=128&g=1", "display_name": "Amit Kohli", "link": "https://stackoverflow.com/users/2883603/amit-kohli"}, "is_accepted": false, "score": -1, "last_activity_date": 1470823868, "creation_date": 1470823868, "answer_id": 38870386, "question_id": 38869913, "link": "https://stackoverflow.com/questions/38869913/how-to-access-the-form-control-combobox-on-a-chart-sheet-in-vba/38870386#38870386", "title": "How to access the Form Control Combobox on a Chart Sheet in VBA", "body": "<p>Hrm... my suggestion would be to RECORD a macro wherein you change the value manually. Then STOP the macro, and go look at the code to find the name of that specific item.</p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470844834, "post_id": 38873089, "comment_id": 65117900, "body": "@Mohit, did you get through it?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1470845761, "post_id": 38873089, "comment_id": 65118495, "body": "Yes this is the right way to do , just instead of Worksheets i had to use Charts as I am using these controls on Chart Tab instead of a worksheet. Thanks :)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1470831021, "creation_date": 1470831021, "answer_id": 38873089, "question_id": 38869913, "link": "https://stackoverflow.com/questions/38869913/how-to-access-the-form-control-combobox-on-a-chart-sheet-in-vba/38873089#38873089", "title": "How to access the Form Control Combobox on a Chart Sheet in VBA", "body": "<p>since the name it's not a ComboBox but a DropDown control</p>\n\n<p>you can refer to it via <code>Shapes</code> collection by its name and then by its <code>ControlFormat</code> property that returns the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841173(v=office.15).aspx\" rel=\"nofollow\"><code>ControlFormat</code></a> object, of which you can use properties and methods</p>\n\n<pre><code>With Worksheets(\"MySheet\").Shapes(\"Drop Down 1\").ControlFormat '&lt;--| change \"MySheet\" with your actual worksheet name\n    MsgBox .ListFillRange\n    MsgBox .LinkedCell\n    MsgBox .Value\n    MsgBox .List(.Value)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 1, "accepted_answer_id": 38873089, "answer_count": 2, "score": -2, "last_activity_date": 1564848162, "creation_date": 1470822676, "last_edit_date": 1592644375, "question_id": 38869913, "link": "https://stackoverflow.com/questions/38869913/how-to-access-the-form-control-combobox-on-a-chart-sheet-in-vba", "title": "How to access the Form Control Combobox on a Chart Sheet in VBA", "body": "<p>I am trying to build an interactive Chart in excel, what my problem is that i have included an Form Control Combo Box in my chart but I am not able to get the name of that combobox so that i can access that in my VBA code. I have attached an screenshot of the chart.<a href=\"https://i.stack.imgur.com/9R1as.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9R1as.png\" alt=\"enter image description here\" /></a></p>\n<p>What i want to know is that what code i can use to access the selected value of this combobox in the screenshot.</p>\n<p>I have already tried to record a Macro, but it doesn't record anything related to the Form Control here.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1470820752, "post_id": 38868832, "comment_id": 65100587, "body": "See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/28700020#28700020\">How to avoid using Select in Excel VBA macros</a>."}], "answers": [{"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1470820706, "post_id": 38868933, "comment_id": 65100549, "body": "what do you mean? didn&#39;t get you. replace <code>IsDate(r)</code> with <code>IsDate(cell)</code>, see the answer&#39;s code. Also one edit, for dates, use <code>value2</code> instead of <code>value</code>"}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1470821004, "post_id": 38868933, "comment_id": 65100788, "body": "Right, I got it now :) Thanks cyboashu. There is one more issue though: when I select multiple cells and there is value that is not date within selection, whe I run macro this non-date vlue gets converted into date. How do I fix that?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1470821081, "post_id": 38868933, "comment_id": 65100862, "body": "one more issue, means start another question, one thing at a time.:)"}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1470821250, "post_id": 38868933, "comment_id": 65100996, "body": "Sure thing. Thanks:)"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 0, "last_activity_date": 1470820719, "last_edit_date": 1470820719, "creation_date": 1470820222, "answer_id": 38868933, "question_id": 38868832, "link": "https://stackoverflow.com/questions/38868832/macro-works-only-one-selected-cell-doesnt-work-if-2-or-more-cells-are-selecte/38868933#38868933", "title": "Macro works only one selected cell ( doesn&#39;t work if 2 or more cells are selected)", "body": "<p>You are setting selection in <code>r</code> and then using it. <code>cell</code> variable never comes in play.</p>\n\n<pre><code>Sub adddate()\nDim cell As Range\nDim r As Range\nSet r = Selection\n\nFor Each cell In Selection.Celss\nIf IsDate(cell.Value2) Then 'r = selection, multiple cells can't be evaluated in IsDate, cell is just one single. cell\nSelection.Cells = DateAdd(\"d\", 28, CDate(r))\nEnd If\nNext cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "accepted_answer_id": 38868933, "answer_count": 1, "score": 1, "last_activity_date": 1470820719, "creation_date": 1470820010, "question_id": 38868832, "link": "https://stackoverflow.com/questions/38868832/macro-works-only-one-selected-cell-doesnt-work-if-2-or-more-cells-are-selecte", "title": "Macro works only one selected cell ( doesn&#39;t work if 2 or more cells are selected)", "body": "<p>I have this problem: my code is executed correctly only if 1 cell is selected, it doesn't work with multiple cells selection. What should be changed? Please help.</p>\n\n<p>current code:</p>\n\n<pre><code>Sub adddate()\nDim cell As Range\nDim r As Range\nSet r = Selection\n\nFor Each cell In Selection\nIf IsDate(r.Value) Then\nSelection.Cells = DateAdd(\"d\", 28, CDate(r))\nEnd If\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470820366, "post_id": 38868644, "comment_id": 65100300, "body": "Use ADODB, but you are going to have to change your table to have unique fieldnames first (i.e. you can&#39;t have two fields called &quot;Total&quot;)."}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470820476, "post_id": 38868644, "comment_id": 65100389, "body": "@YowE3K But is it able to do it in VBA? Or putting all data into two column in a virtual space .Then do the calculation?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470820598, "post_id": 38868644, "comment_id": 65100482, "body": "Yes, you can use ADODB in VBA."}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470820897, "post_id": 38868644, "comment_id": 65100687, "body": "@YowE3K Or is it able to do it in VBA without SQL ? because my company is not allowed to use external libraries ."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470821135, "post_id": 38868644, "comment_id": 65100912, "body": "If you really want to perform SQL without an external library (such as Microsoft ActiveX Data Objects), I don&#39;t think you can.  Why do you need SQL?  Why don&#39;t you just loop through each staff member and sum each of the values where the staff number matches?  That would be quite easy to do, but the requirement to use SQL to do it just complicates matters."}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1470820078, "post_id": 38868792, "comment_id": 65100091, "body": "i cant .Here is just a sample picture .Behind is a user form . The admin can select the fromdate to todate .Then ,generate the report"}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1470825016, "post_id": 38868792, "comment_id": 65103553, "body": "i mean any brief idea is okay . I must use VBA instead of Pivot Table  . Anyway , thanks for your ans .I will try and test this later"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1470826168, "post_id": 38868792, "comment_id": 65104316, "body": "@evabb Well, you can transform my alternative answer to VBA code. It should be easy by using <code>.Formula</code> object. That&#39;s an idea."}, {"owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1470876859, "post_id": 38868792, "comment_id": 65131995, "body": "not working for M4:M21 .The first item 179 is okay .it shows the result of 179-1"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "edited": false, "score": 0, "creation_date": 1470883172, "post_id": 38868792, "comment_id": 65133318, "body": "@evabb It works fine. I have tested the formula many times. Have a look my edited answer and download the Excel file that I created for you."}], "tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": false, "score": 1, "last_activity_date": 1470883069, "last_edit_date": 1470883069, "creation_date": 1470819911, "answer_id": 38868792, "question_id": 38868644, "link": "https://stackoverflow.com/questions/38868644/how-to-perform-the-sum-group-by-function-in-vba/38868792#38868792", "title": "How to perform the sum-group by function in VBA?", "body": "<p><strong>Hint :</strong></p>\n\n<p>Use <a href=\"http://www.excel-easy.com/data-analysis/pivot-tables.html\" rel=\"nofollow\">Pivot Table</a> by putting all the data into two columns: column staff and column sales.</p>\n\n<p><strong>Alternatively</strong>, copy ID staff in <code>Range(\"D3:D21\")</code> to <code>Range(\"L3:L21\")</code> and then put this formula in cell M3:</p>\n\n<pre><code>     =E3+INDEX(F$3:G$21,MATCH(L3,F$3:F$21,0),2)+INDEX(H$3:I$21,MATCH(L3,H$3:H21,0),2)\n</code></pre>\n\n<p>then drag cell M3 down to cell M21.</p>\n\n<p>Anyway, you contradict yourself by saying, \"<em>Any idea is okay (no need code)</em>\" and then said \"<em>I must use VBA because</em>\". Which one do you want??</p>\n\n<hr>\n\n<h2>Edit:</h2>\n\n<p>The OP said the formula doesn't work properly, but it does work fine. Have a look <a href=\"https://drive.google.com/open?id=0B7x4BoOdwK8TYXh3T2QxcWQ3UEk\" rel=\"nofollow\">this Excel file</a>. Here is the VBA code that is implementing formula above:</p>\n\n<pre><code>Sub evabb()\nDim i As Long\n\nWith Sheets(\"Sheet1\")\n        For i = 3 To 21\n            .Cells(i, \"L\") = .Cells(i, \"D\")\n            .Cells(i, \"M\").Formula = \"=E\" &amp; i &amp; \"+INDEX(F$3:G$21,MATCH(L\" &amp; i &amp; \",F$3:F$21,0),2)+INDEX(H$3:I$21,MATCH(L\" &amp; i &amp; \",H$3:H21,0),2)\"\n        Next\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 6685357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76e430569edc7bf6a351454b0da688bb?s=128&d=identicon&r=PG&f=1", "display_name": "evabb", "link": "https://stackoverflow.com/users/6685357/evabb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2335, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470883069, "creation_date": 1470819521, "last_edit_date": 1592644375, "question_id": 38868644, "link": "https://stackoverflow.com/questions/38868644/how-to-perform-the-sum-group-by-function-in-vba", "title": "How to perform the sum-group by function in VBA?", "body": "<p><a href=\"https://i.stack.imgur.com/3mbsO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3mbsO.png\" alt=\"enter image description here\" /></a>\nHere is a table record every staff sales record in every months.</p>\n<p>Every responsible staff in every district could be changed .E.g. District A: May :179 -&gt;June: 220</p>\n<p>Now , i want to sum all staff sales records from May-2016 to Jul-2016 .\nThe range should be <code>D3:I21</code>.The range can be hard code.</p>\n<p>Then paste the result on <code>L3:M21</code> .</p>\n<p>The sample output should be</p>\n<blockquote>\n<p>179 1</p>\n<p>186 7</p>\n<p>222 4</p>\n<p>S24 5</p>\n<p>......</p>\n</blockquote>\n<p>How to perform the SQL like <code>select staffid ,sum(total) from table group by staffid</code> in VBA ?</p>\n<h1>Remark :</h1>\n<p>Any idea is okay (no need code) .thank you so much</p>\n<p>Is it able to do it in VBA? Or putting all data into two column in a virtual space .Then do the calculation later?</p>\n<p>I must use VBA because :</p>\n<p>This picture is just a example .Behind the real excel is a user form . The admin can select the fromdate and todate .Then ,generate the report according to the selected range .</p>\n<p>Delete the row 23-Total is okay . Small modifciation of table structure can be considered .</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1470822365, "post_id": 38868643, "comment_id": 65101788, "body": "This is not a duplicate, simply because of its different logic, and concept."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1470822618, "post_id": 38868643, "comment_id": 65101967, "body": "Sorry, I misread this. But please provide some more information, it&#39;s very hard to understand what you have to do exactly."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1470900402, "post_id": 38872055, "comment_id": 65139780, "body": "tnx for the hint. Maybe is better to pull out this rng as global variable because rng is Selection, and I use it often in other functions and Subs?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1470902016, "post_id": 38872055, "comment_id": 65140799, "body": "@Stefan89BEG: Maybe. But it depends on what you really are trying to achieve. From the name <code>ContextMenu</code> I suspect this <code>CommandBar</code> is a context menu. And as of your code the <code>rng</code> is the <code>Selection</code> at the time of <b>setting</b> the new context menu command button. So also the address should be sufficient. If you need the <code>Selection</code> at the time of <b>opening</b> the context menu, why not simply getting it then?"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 0, "last_activity_date": 1470828094, "creation_date": 1470828094, "answer_id": 38872055, "question_id": 38868643, "link": "https://stackoverflow.com/questions/38868643/vba-excel-input-argument-from-contextmenu-controls/38872055#38872055", "title": "VBA EXCEL input argument from ContextMenu.Controls", "body": "<p><code>CommandBarButton.OnAction</code> is a string and cannot contain any objects. The only thing you could do is handover the address of the range as a string:</p>\n\n<pre><code>...\nSet rng = Selection.SpecialCells(xlCellTypeVisible)\nWith ContextMenu.Controls.Add(Type:=msoControlButton, before:=2)\n    .OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"MyFunctionWithParameter(\"\"\" &amp; rng.Address(External:=True) &amp; \"\"\")\" 'Here somehow I need to provide rng as input argument!\n    .FaceId = 59\n    .Caption = \"Spoji R brojeve\"\n    .Tag = \"My_Cell_Control_Tag\"\n End With\nEnd Sub\n\nFunction MyFunctionWithParameter(rng)\n    MsgBox (rng)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1470828094, "creation_date": 1470819518, "question_id": 38868643, "link": "https://stackoverflow.com/questions/38868643/vba-excel-input-argument-from-contextmenu-controls", "title": "VBA EXCEL input argument from ContextMenu.Controls", "body": "<p>How can I pass input argument through CustomMenu item:\n    Sub something()\n    ...variables...</p>\n\n<pre><code>Set rng = Selection.SpecialCells(xlCellTypeVisible).Select\nWith ContextMenu.Controls.Add(Type:=msoControlButton, before:=2)\n    .OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"MyFunctionWithParameter\" 'Here somehow I need to provide rng as input argument!\n    .FaceId = 59\n    .Caption = \"Spoji R brojeve\"\n    .Tag = \"My_Cell_Control_Tag\"\nEnd With\nEnd sub\nFunction MyFunctionWithParameter (rng)\n    MsgBox(rng)\nEnd Function\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "internet-explorer"], "answers": [{"tags": [], "owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "is_accepted": false, "score": 0, "last_activity_date": 1470821396, "creation_date": 1470821396, "answer_id": 38869398, "question_id": 38868574, "link": "https://stackoverflow.com/questions/38868574/click-on-a-button-in-ie-page-from-vba-code/38869398#38869398", "title": "Click on a button in IE page from VBA code", "body": "<p>It's always best to search for elements by id. Try setting the div this way.</p>\n\n<pre><code>Set div = ie.document.body.getElementsById(\"actionContainer\")\n</code></pre>\n\n<p>And retrieve the button the same way</p>\n\n<pre><code>Set Button = div.getElementsById(\"addAcquisitionButton\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6699338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2cb16ca5b8544ca5ec0e350c754468?s=128&d=identicon&r=PG&f=1", "display_name": "Hajar Souldi", "link": "https://stackoverflow.com/users/6699338/hajar-souldi"}, "is_accepted": false, "score": 0, "last_activity_date": 1470825865, "creation_date": 1470825865, "answer_id": 38871190, "question_id": 38868574, "link": "https://stackoverflow.com/questions/38868574/click-on-a-button-in-ie-page-from-vba-code/38871190#38871190", "title": "Click on a button in IE page from VBA code", "body": "<p>I goterror 438,\nObject Doesn't Support This Property or Method</p>\n"}], "owner": {"reputation": 11, "user_id": 6699338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2cb16ca5b8544ca5ec0e350c754468?s=128&d=identicon&r=PG&f=1", "display_name": "Hajar Souldi", "link": "https://stackoverflow.com/users/6699338/hajar-souldi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1470825865, "creation_date": 1470819287, "last_edit_date": 1470822760, "question_id": 38868574, "link": "https://stackoverflow.com/questions/38868574/click-on-a-button-in-ie-page-from-vba-code", "title": "Click on a button in IE page from VBA code", "body": "<p>I am trying to click on the addacquisitionButton but I am not able to do. \nI tried this code </p>\n\n<pre><code>Set div = ie.document.body.getElementsByTagName(\"div\")(0)\nSet div = ie.document.body.getElementsByTagName(\"div\")(1) \nSet Button = div.getElementsByTagName(\"button\")(2)  '\nButton = IEDoc.getElemntsById(\"addAcquisitionButton\")\nButton.Click\n</code></pre>\n\n<p>but It doesn t work</p>\n\n<p>This is the source code from my Html page</p>\n\n<pre><code>enter code here\n&lt;div class=\"common-box blue-box\" id=\"actionsPanel\" style=\"z-index: 100;\"&gt;\n    &lt;div id=\"actionContainer\" class=\"button-container\"&gt;\n        &lt;button class=\"button buttonAction\" id=\"dashboardButton\"&gt;\n            Retour \u00e0 l'aper\u00e7u des demandes\n        &lt;/button&gt;\n\n              &lt;button class=\"button buttonAction\" id=\"addAcquisitionButton\"&gt; \n                 Ajouter acquisition/importation\n              &lt;/button&gt;\n\n\n            &lt;button class=\"button buttonAction\" id=\"attachButton\"&gt;\n                Attacher documents\n            &lt;/button&gt;\n\n\n    &lt;/div&gt;\n</code></pre>\n\n<p>Where I am getting wrong. </p>\n"}, {"tags": ["c#", "excel", "excel-interop", "vba"], "owner": {"reputation": 3804, "user_id": 5014099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Ju1iz.jpg?s=128&g=1", "display_name": "Souvik Ghosh", "link": "https://stackoverflow.com/users/5014099/souvik-ghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470819011, "creation_date": 1470819011, "last_edit_date": 1531164843, "question_id": 38868475, "link": "https://stackoverflow.com/questions/38868475/suppress-excel-compatibility-check-on-macro", "title": "Suppress Excel compatibility check on macro", "body": "<p>I am trying to automate an Excel app. It has some macros which I have managed to trigger from code. The last macro generates a new Excel file which gives a compatibility check message box (97-2003). I tried suppressing it by below approach.</p>\n\n<ul>\n<li>By SendKeys(\"{ENTER}\")</li>\n<li>Setting DisplayAlerts to false for Excel app</li>\n<li>Setting DefaultSaveFormat to xlExcel8</li>\n<li>Setting CheckCompatibility to false</li>\n</ul>\n\n<p>I was able to handle other pop-ups by using SendKeys but this one seems different.</p>\n\n<p>Thanks,\nSouvik</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 2, "creation_date": 1470818867, "post_id": 38868314, "comment_id": 65099301, "body": "you just need or am i missing something?    <code>ActiveCell.FormulaR1C1 = &quot;=INDEX(R1C3:R1C30,MATCH(R[2]C31,R[2]C3:R[2]C30,0))&quot;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1470820217, "post_id": 38868314, "comment_id": 65100182, "body": "Might be <code>=INDEX(R1C3:R1C30, MATCH(RC31, RC3:RC30, 0))</code>"}, {"owner": {"reputation": 2212, "user_id": 330663, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7671de4f582d518177ef518af0cd6cdd?s=128&d=identicon&r=PG", "display_name": "posfan12", "link": "https://stackoverflow.com/users/330663/posfan12"}, "edited": false, "score": 0, "creation_date": 1470820567, "post_id": 38868314, "comment_id": 65100460, "body": "What happens to the target cells? Do your commands fill them with formulas or plain text? I would prefer plain text in fact."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1470821021, "post_id": 38868314, "comment_id": 65100802, "body": "on your button click, put the formula as mentioned in comments above, copy and then paste as value."}], "owner": {"reputation": 2212, "user_id": 330663, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7671de4f582d518177ef518af0cd6cdd?s=128&d=identicon&r=PG", "display_name": "posfan12", "link": "https://stackoverflow.com/users/330663/posfan12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470818551, "creation_date": 1470818551, "question_id": 38868314, "link": "https://stackoverflow.com/questions/38868314/conversion-of-regular-index-formula-to-macro", "title": "Conversion of regular index formula to macro", "body": "<p>Can anyone explain to me how to convert the formula <code>INDEX($C$1:$AD$1,MATCH($AE3,$C3:$AD3,0))</code> to a macro? It needs to only be run when I press a button. It does not need to be recalculated frequently. A single button click should fill all the values in the same column. It is okay if the destination cells end up only containing plain text.</p>\n\n<p>I have included a screenshot of my Excel sheet. I marked the formula in the image.</p>\n\n<p>Thanks!</p>\n\n<p><a href=\"https://i.stack.imgur.com/zKtNp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zKtNp.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["macos", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6698852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8803908b56ba3fa05da75aec6e2c60c3?s=128&d=identicon&r=PG&f=1", "display_name": "L.Cohen", "link": "https://stackoverflow.com/users/6698852/l-cohen"}, "edited": false, "score": 0, "creation_date": 1470822578, "post_id": 38868919, "comment_id": 65101932, "body": "Thanks for the suggestion.  Actually, the exception in my script before getting to this stage of the script. It is shouting for an error when trying to run strFile = Dir(strPath, MacID(&quot;TEXT&quot;))"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1470820189, "creation_date": 1470820189, "answer_id": 38868919, "question_id": 38868182, "link": "https://stackoverflow.com/questions/38868182/running-excel-vba-code-on-multiple-files-on-macintosh/38868919#38868919", "title": "Running excel vba code on multiple files on Macintosh", "body": "<p>In your Multiple code, you are passing a string parameter (the filename) to DoWork, but DoWork is expecting you to pass a Workbook object.</p>\n\n<p>You will need to join strPath and strFile together (in Windows that would be <code>strPath &amp; \"\\\" &amp; strFile</code> - I assume it will be something similar on a Mac) and then open the Workbook.  I would suggest the following code should be used where you currently are just doing <code>DoWork (strFile)</code>:</p>\n\n<pre><code>Set wb = Workbooks.Open(strPath &amp; \"\\\" &amp; strFile)  ' Adjust to suit for Mac filename syntax\nDoWork wb\nwb.Save\nwb.Close False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470859350, "post_id": 38877184, "comment_id": 65126044, "body": "One comment (but unrelated to your current error):  <code>Do While Len(strPath) &gt; 0</code> - this will always be True - you probably want <code>Do While Len(strFile) &gt; 0</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 6698852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8803908b56ba3fa05da75aec6e2c60c3?s=128&d=identicon&r=PG&f=1", "display_name": "L.Cohen", "link": "https://stackoverflow.com/users/6698852/l-cohen"}, "is_accepted": false, "score": 0, "last_activity_date": 1470841592, "creation_date": 1470841592, "answer_id": 38877184, "question_id": 38868182, "link": "https://stackoverflow.com/questions/38868182/running-excel-vba-code-on-multiple-files-on-macintosh/38877184#38877184", "title": "Running excel vba code on multiple files on Macintosh", "body": "<p>Ok. Figured it out :-)</p>\n\n<pre><code>    Sub Multiple()\n\n    Dim SecDir As String\n    Dim MyDir As String\n    Dim wbk As Workbook\n\n\n    MyDir = \"tlv-mpzyw:Users:lcohen:Google Drive:SQA:Projects:vbaBotRegression:\"\n    SecDir = \"files:\"\n    strPath = MyDir &amp; SecDir\n    Debug.Print strPath\n    strFile = Dir(strPath)\n\n    'Loop through each file in the folder\n    Do While Len(strPath) &gt; 0\n        If Right(strFile, 3) = \"csv\" Then\n            Debug.Print strFile\n            Set wbk = Workbooks.Open(Filename:=strPath &amp; strFile)\n            Range(\"E:E,K:K\").Select\n            Range(\"K1\").Activate\n            Selection.Delete Shift:=xlToLeft\n            ActiveSheet.Range(\"b1\").End(xlDown).Select\n            ActiveCell.FormulaR1C1 = \"=AVERAGE(R[-3]C:R[-1]C)/1000\"\n            ActiveSheet.Range(\"b1\").End(xlDown).Select\n            Selection.AutoFill Destination:=Range(ActiveCell, ActiveCell.Offset(0, 2)), Type:=xlFillDefault\n            ActiveSheet.Range(\"e1\").End(xlDown).Select\n            ActiveCell.FormulaR1C1 = \"=AVERAGE(R[-3]C:R[-1]C)\"\n            ActiveSheet.Range(\"e1\").End(xlDown).Select\n            Selection.AutoFill Destination:=Range(ActiveCell, ActiveCell.Offset(0, 4)), Type:=xlFillDefault\n            wbk.Close SaveChanges:=False\n        End If\n\n        strFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Now I have another issue,\nAm getting the following error message:</p>\n\n<blockquote>\n  <p>Run-time error '1004':</p>\n  \n  <p>'TLV-MPZYW:USERS:LCOHEN:GOOGLE\n  DRIVE:SQA:PROJECTS:VBABOTREGRESSION:FILES:SAMPLES_MULTIPLE_FILTERS_QUERIES-STATISTICS.CSV'\n  could not be found.Check the spelling of the file name, and verify\n  that the file location is correct.</p>\n  \n  <p>If you are trying to open the file from your list of most recently\n  used files on the File menu, make sure that the file has not been\n  renamed, moved, or deleted.</p>\n</blockquote>\n\n<p>I am clueless at this point on what might be causing this issue.\nAs you can see in my code, I am printing the file name to verify that it indeed reads it correctly.</p>\n\n<p>Anyone?????</p>\n"}], "owner": {"reputation": 1, "user_id": 6698852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8803908b56ba3fa05da75aec6e2c60c3?s=128&d=identicon&r=PG&f=1", "display_name": "L.Cohen", "link": "https://stackoverflow.com/users/6698852/l-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470841592, "creation_date": 1470818139, "last_edit_date": 1470832571, "question_id": 38868182, "link": "https://stackoverflow.com/questions/38868182/running-excel-vba-code-on-multiple-files-on-macintosh", "title": "Running excel vba code on multiple files on Macintosh", "body": "<p>I have the following code I wrote in Excel:</p>\n\n<pre><code>    Sub Multiple()\n    MyDir = ActiveWorkbook.Path\n        strPath = MyDir &amp; \":\"\n\n        strFile = Dir(strPath, MacID(\"TEXT\"))\n\n        'Loop through each file in the folder\n        Do While Len(strFile) &gt; 0\n            If Right(strFile, 3) = \"csv\" Then\n                Debug.Print strFile\n                DoWork (strFile)\n            End If\n\n            strFile = Dir\n        Loop\nEnd Sub\n\nSub DoWork(wb As Workbook)\n    With wb\n        Range(\"E:E,K:K\").Select\n        Range(\"K1\").Activate\n        Selection.Delete Shift:=xlToLeft\n        ActiveSheet.Range(\"b1\").End(xlDown).Select\n        ActiveCell.FormulaR1C1 = \"=AVERAGE(R[-3]C:R[-1]C)/1000\"\n        ActiveSheet.Range(\"b1\").End(xlDown).Select\n        Selection.AutoFill Destination:=Range(ActiveCell, ActiveCell.Offset(0, 2)), Type:=xlFillDefault\n        ActiveSheet.Range(\"e1\").End(xlDown).Select\n        ActiveCell.FormulaR1C1 = \"=AVERAGE(R[-3]C:R[-1]C)\"\n        ActiveSheet.Range(\"e1\").End(xlDown).Select\n        Selection.AutoFill Destination:=Range(ActiveCell, ActiveCell.Offset(0, 4)), Type:=xlFillDefault\n    End With\nEnd Sub\n</code></pre>\n\n<p>What I am trying to do is run the bottom <code>Sub DoWork()</code> which does some basic editing on an excel file on my macintosh on multiple files.\nFor that I wrote the uper <code>Sub Multiple()</code> which should eventually run the bottom Sub on multiple files.\nThe files type are CSV files.</p>\n\n<p>The bottom code works perfect when running it individually on each Excel file.\nHowever, the top code does not do the trick of running on all multiple files.</p>\n\n<p>Anyone have an idea why?</p>\n"}, {"tags": ["vba", "outlook", "directory"], "comments": [{"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "edited": false, "score": 0, "creation_date": 1470818604, "post_id": 38868038, "comment_id": 65099149, "body": "I&#39;m not expert on the subject but I think you should focus on <b>Mail module</b> of Outlook&#39;s Explorer <b>Navigation Pane</b> and its properties. For example, see <a href=\"http://stackoverflow.com/questions/12935579/outlook-add-folder-to-favorites-group\" title=\"outlook add folder to favorites group\">stackoverflow.com/questions/12935579/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1470842835, "last_edit_date": 1592644375, "creation_date": 1470842835, "answer_id": 38877689, "question_id": 38868038, "link": "https://stackoverflow.com/questions/38868038/outlook-2013-outlook-2016-vba-rearrange-folders-in-folders-tree/38877689#38877689", "title": "Outlook 2013, Outlook 2016 VBA rearrange folders in folders tree", "body": "<p>Starting from Outlook 2013 you can reorder folders however you like and Outlook would remember the order. The key property is <code>PR_SORT_POSITION</code>. Here\u2019s the definition:</p>\n<blockquote>\n<h1>define PR_SORT_POSITION PROP_TAG( PT_BINARY, 0x3020)</h1>\n</blockquote>\n<p>Outlook will use this property as part of it\u2019s sort order when requesting folders from a provider, so it\u2019s important that your provider can handle sorting on a binary property \u2013 or can fake it when asked to sort by this property. Outlook will also use this property directly when deciding where to insert nodes in the visible tree, so it\u2019s also important that your provider can return this property when Outlook looks for it on a folder.</p>\n<p>There\u2019s a second property Outlook will use for custom sort ordering:</p>\n<blockquote>\n<h1>define PR_SORT_PARENTID PROP_TAG( PT_BINARY, 0x3021)</h1>\n</blockquote>\n<p>As the name suggests, this property stores an entry ID which can be used to sort a folder under a different node than it\u2019s natural parent. Normally, a folder will be sorted under the folder represented by <code>PR_PARENT_ENTRYID</code>. This property allows you to suggest a different parent for display.</p>\n<p>By presetting these properties appropriately, you can direct Outlook in how you wish your provider\u2019s folders to be sorted. And if you allow Outlook to write to these properties, you can preserve whatever sort order your users desire.</p>\n<p>So, theoretically you can set these properties from VBA. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869735.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">PropertyAccessor</a> class can help you with such tasks. Also you may consider using a low-level code if you face with any restrictions from OOM, so any wrappers around Extended MAPI allows to bridge the gap (for example, Redemption).</p>\n"}], "owner": {"reputation": 21, "user_id": 3861780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lcaIN.jpg?s=128&g=1", "display_name": "Cheshi Mantu", "link": "https://stackoverflow.com/users/3861780/cheshi-mantu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470842835, "creation_date": 1470817790, "question_id": 38868038, "link": "https://stackoverflow.com/questions/38868038/outlook-2013-outlook-2016-vba-rearrange-folders-in-folders-tree", "title": "Outlook 2013, Outlook 2016 VBA rearrange folders in folders tree", "body": "<p>In Outlook versions after 2007 Microsoft added the possibility to manually arrange folders in folders tree (in Outlook 2007 folders were arranged alphabetically). \nIs there any possibility using VBA to arrange folders in the folders tree, e.g. put folder to the top when it contains new email?\nThanks</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470819564, "post_id": 38867599, "comment_id": 65099762, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/38850333/how-to-filter-by-what-the-user-enters-in-a-textbox-except-show-all-if-its-empt\">How to filter by what the user enters in a textbox, except show all if it&#39;s empty</a>"}, {"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470820287, "post_id": 38867599, "comment_id": 65100238, "body": "Hi @Andre , It is not a dublicate, i have looked into that question. The issue is when the record is Null, not when the textbox is null. Do you have a suggestion?"}, {"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470820460, "post_id": 38867599, "comment_id": 65100379, "body": "BTW, When i use the suggestion you just sent, the search will be with the stars * . The users want a search of 330 to only find 330, not 3300, 3301 etc. That will happend if I do the * &amp; textbox &amp; *   you refer to."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470820734, "post_id": 38867599, "comment_id": 65100574, "body": "The asterisks * are a detail that can be left out in your query. But don&#39;t you want the same thing? 1. If the search text box is empty, return all records. 2. If not, do a search? Then you can use the same concept."}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470825233, "post_id": 38870170, "comment_id": 65103704, "body": "That does not work inside the IIF as far as i can see!"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470825398, "post_id": 38870170, "comment_id": 65103819, "body": "You don&#39;t need <code>IIf</code>, and no <code>Like</code> either. This filters by the search textbox (if not empty) or returns all records."}, {"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470826608, "post_id": 38870170, "comment_id": 65104596, "body": "Yes, you are right. That is working. Thank you very much!"}, {"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470826834, "post_id": 38870170, "comment_id": 65104735, "body": "Nah, i was happy too quick. When i search 33* for example, it just returns #Name? in ALL cells.. Why is that?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470827308, "post_id": 38870170, "comment_id": 65105058, "body": "See edit... I thought you wanted only exact searches."}, {"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470832378, "post_id": 38870170, "comment_id": 65108469, "body": "Its closer, but, when i search for something that does not exist anywhere in the table, it returns the lines with Null cells. It should not..."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470833468, "post_id": 38870170, "comment_id": 65109303, "body": "For what for example? This shouldn&#39;t happen - either you have the criteria wrong (please show the exact criteria you have now), or there is something else going on you haven&#39;t told us about."}, {"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470833721, "post_id": 38870170, "comment_id": 65109500, "body": "As I see your criteria, it lets through <i>keyword</i> OR a cell that is Null (Hence the OR Is Null criteria). So if i search for &quot;mkdlasmdklsa&quot; which is not present, it returns nothing BUT the null cells. The criteria i use is the one exact as you typed it."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470834115, "post_id": 38870170, "comment_id": 65109796, "body": "That&#39;s not possible. The criteria would resolve to: <code>LIKE &quot;mkdlasmdklsa&quot; OR (&quot;mkdlasmdklsa&quot; Is Null)</code>. The part after the OR is always FALSE if the search textbox is not empty. This is very different from <code>OR Is Null</code>."}, {"owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470834944, "post_id": 38870170, "comment_id": 65110417, "body": "The query is very big. I will try and implement the criteria in all levels and get back to you. Should i update the question with the solutions tried and images or just post here?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470835121, "post_id": 38870170, "comment_id": 65110574, "body": "Anything larger than a tiny code snippet isn&#39;t suited well for comments, and should better be edited into the question."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "edited": false, "score": 0, "creation_date": 1470928836, "post_id": 38870170, "comment_id": 65159585, "body": "@EmilOlsen: For multiple search fields, see also here: <a href=\"http://stackoverflow.com/a/38899574/3820271\">stackoverflow.com/a/38899574/3820271</a>"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1470827197, "last_edit_date": 1470827197, "creation_date": 1470823346, "answer_id": 38870170, "question_id": 38867599, "link": "https://stackoverflow.com/questions/38867599/ms-access-2016-vba-is-null-in-combined-query-criteria/38870170#38870170", "title": "MS Access 2016 VBA Is Null in combined Query Criteria", "body": "<p>What I mean is this criteria:</p>\n\n<pre><code>[Forms]![f_form]![txt_box] OR ([Forms]![f_form]![txt_box] Is Null)\n</code></pre>\n\n<p>or if you want to support wildcard searches too (after all):</p>\n\n<pre><code>LIKE [Forms]![f_form]![txt_box] OR ([Forms]![f_form]![txt_box] Is Null)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 443, "user_id": 1045151, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2oguu.jpg?s=128&g=1", "display_name": "Sham Yemul", "link": "https://stackoverflow.com/users/1045151/sham-yemul"}, "is_accepted": false, "score": 1, "last_activity_date": 1486098037, "creation_date": 1486098037, "answer_id": 42017096, "question_id": 38867599, "link": "https://stackoverflow.com/questions/38867599/ms-access-2016-vba-is-null-in-combined-query-criteria/42017096#42017096", "title": "MS Access 2016 VBA Is Null in combined Query Criteria", "body": "<p>I would suggest using NZ instead of IIF and IsNull combination,</p>\n\n<p>SearchField Like Nz([forms]![f_form]![txt_box],'*')</p>\n\n<p>Do you think that the txt_Box can have Zero length string instead of Null or possible that either of one can be there ? if so you can try following</p>\n\n<p>SearchField like iif([forms]![f_form]![txt_box]='','<em>',nz([forms]![f_form]![txt_box],'</em>')</p>\n"}], "owner": {"reputation": 302, "user_id": 4260274, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/db8d607f98c55556fac52afb1d83b8bb?s=128&d=identicon&r=PG", "display_name": "Emil Olsen", "link": "https://stackoverflow.com/users/4260274/emil-olsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593956732, "creation_date": 1470816412, "last_edit_date": 1593956732, "question_id": 38867599, "link": "https://stackoverflow.com/questions/38867599/ms-access-2016-vba-is-null-in-combined-query-criteria", "title": "MS Access 2016 VBA Is Null in combined Query Criteria", "body": "<p>Given a Query with the criteria that uses text boxes in access. It works fine.</p>\n\n<pre><code>Like IIf(IsNull([forms]![f_form]![txt_box]),\"*\",[forms]![f_form]![txt_box])\n</code></pre>\n\n<p>The above criteria works fine when a cell has a value. However, a lot of cells in the table which I search in, is null.</p>\n\n<p>My best and logic shot was:</p>\n\n<pre><code>   Like IIf(IsNull([forms]![f_form]![txt_box]),\"*\",[forms]![f_form]![txt_box])\nOR Like IIf(IsNull([forms]![f_form]![txt_box]),Is Null,[forms]![f_form]![txt_box])\n</code></pre>\n\n<p>However, this does not work.</p>\n\n<p>If i just use \"Or Is Null\" then it returns all records where a cell is null even when i do a specific search.</p>\n\n<p>Any suggestions?</p>\n\n<p>BR, Emil.</p>\n\n<p>Edit: The solution so far was to put in \"-\" in all null cells, but when the users leave a cell blank (Null), the record will never show up in the filter (Query). Hence I do not prefer this solution.</p>\n"}, {"tags": ["oracle", "vba", "excel", "odbc"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470842963, "post_id": 38867577, "comment_id": 65116636, "body": "Please let us know when you succeed with 32bit driver. :)"}, {"owner": {"reputation": 902, "user_id": 6603658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b64a8d63af5dfca2ec635aac587001bb?s=128&d=identicon&r=PG&f=1", "display_name": "astudentofmaths", "link": "https://stackoverflow.com/users/6603658/astudentofmaths"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470906401, "post_id": 38867577, "comment_id": 65143406, "body": "@cyboashu I tried with both 32 and 64bit drivers, I have the same error in any case."}], "answers": [{"comments": [{"owner": {"reputation": 902, "user_id": 6603658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b64a8d63af5dfca2ec635aac587001bb?s=128&d=identicon&r=PG&f=1", "display_name": "astudentofmaths", "link": "https://stackoverflow.com/users/6603658/astudentofmaths"}, "edited": false, "score": 0, "creation_date": 1470830057, "post_id": 38870221, "comment_id": 65106914, "body": "Thanks. Yes I already replaced the <code>SQORA32.dl</code> by the one from the 32 bit version and also tried with the one from de 64 bit version. But I still had the same error. The <code>PATH</code> is fine as well. And I have the right driver in regedit <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBCINST.INI\\ODBC Drivers</code>. Any other idea ?"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "reply_to_user": {"reputation": 902, "user_id": 6603658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b64a8d63af5dfca2ec635aac587001bb?s=128&d=identicon&r=PG&f=1", "display_name": "astudentofmaths", "link": "https://stackoverflow.com/users/6603658/astudentofmaths"}, "edited": false, "score": 0, "creation_date": 1470831684, "post_id": 38870221, "comment_id": 65108022, "body": "No, you have to check <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\ODBC\\ODBCINST.INI\\OD&zwnj;&#8203;BC Drivers</code>! You look at location for 64 bit drivers. You have to install entire Oracle client 32 bit version, you cannot replace single DLL&#39;s this will not work."}, {"owner": {"reputation": 902, "user_id": 6603658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b64a8d63af5dfca2ec635aac587001bb?s=128&d=identicon&r=PG&f=1", "display_name": "astudentofmaths", "link": "https://stackoverflow.com/users/6603658/astudentofmaths"}, "edited": false, "score": 0, "creation_date": 1470906364, "post_id": 38870221, "comment_id": 65143382, "body": "Mea culpa, wrong copy/paste. I checked <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\ODBC\\ODBCINST.INI\\OD&zwnj;&#8203;BC Drivers</code>. I uninstalled my version and download a new one and install it, but I have the same error."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "reply_to_user": {"reputation": 902, "user_id": 6603658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b64a8d63af5dfca2ec635aac587001bb?s=128&d=identicon&r=PG&f=1", "display_name": "astudentofmaths", "link": "https://stackoverflow.com/users/6603658/astudentofmaths"}, "edited": false, "score": 0, "creation_date": 1470908970, "post_id": 38870221, "comment_id": 65145306, "body": "Now it gets difficult. Again check carefully whether your Excel is 32 bit and <b>all</b> installed Oracle components are also 32 bit. Check all folders in <code>PATH</code> environment variable (i.e. Oracle 64 bit folders must not come first - if existing). Maybe something was left when you uninstalled Oracle, see <a href=\"http://stackoverflow.com/questions/8450726/how-to-uninstall-completely-remove-oracle-11g-client\" title=\"how to uninstall completely remove oracle 11g client\">stackoverflow.com/questions/8450726/&hellip;</a>"}, {"owner": {"reputation": 902, "user_id": 6603658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b64a8d63af5dfca2ec635aac587001bb?s=128&d=identicon&r=PG&f=1", "display_name": "astudentofmaths", "link": "https://stackoverflow.com/users/6603658/astudentofmaths"}, "edited": false, "score": 0, "creation_date": 1471878943, "post_id": 38870221, "comment_id": 65514117, "body": "I carefully checked that everything was gone before reinstalling everything. But thank you. I finally did everything in Python (sql connection and excel file filing). But as far as I researched, it seems that Oracle and Excel don&#39;t go along very well."}], "tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": false, "score": 0, "last_activity_date": 1470823430, "creation_date": 1470823430, "answer_id": 38870221, "question_id": 38867577, "link": "https://stackoverflow.com/questions/38867577/vba-odbc-oracle-specified-driver-could-not-be-loaded-due-to-system-error-193-o/38870221#38870221", "title": "VBA ODBC Oracle Specified driver could not be loaded due to system error 193: (Oracle in instant client_11_2, C:\\...\\SQORA32.dll))", "body": "<p>You use 32 bit Excel. You must also install 32 bit Oracle Client, I assume this is the case since folder is named \"C:\\apps\\oracle\\11.2.0.3\\<strong>instant-\n32</strong>\\\". But verify where you downloaded the client, there are only minor visible differences between 32 and 64 bit version.</p>\n\n<p>For example filename is <code>SQORA32.dll</code> for both, 32 and 64 bit version.</p>\n\n<p>However, check registry key <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\ODBC\\ODBCINST.INI\\ODBC Drivers</code> instead of <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBCINST.INI\\ODBC Drivers</code> in order to see the 32 bit ODBC drivers.</p>\n\n<p>Update your registry if needed.</p>\n\n<p>Also check whether folder <code>C:\\apps\\oracle\\11.2.0.3\\instant-32\\</code> is in your <code>PATH</code> environment variable.</p>\n"}], "owner": {"reputation": 902, "user_id": 6603658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b64a8d63af5dfca2ec635aac587001bb?s=128&d=identicon&r=PG&f=1", "display_name": "astudentofmaths", "link": "https://stackoverflow.com/users/6603658/astudentofmaths"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3758, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1470823430, "creation_date": 1470816358, "last_edit_date": 1531164843, "question_id": 38867577, "link": "https://stackoverflow.com/questions/38867577/vba-odbc-oracle-specified-driver-could-not-be-loaded-due-to-system-error-193-o", "title": "VBA ODBC Oracle Specified driver could not be loaded due to system error 193: (Oracle in instant client_11_2, C:\\...\\SQORA32.dll))", "body": "<p>I am trying to create an ODBC connection in a VBA script to an Oracle database, and I get the following error:</p>\n\n<pre><code>Run-time error '-2147467259  (800004005)':\nSpecified driver could not be loaded due to system error 193: (Oracle in instantclient_11_2, C:\\apps\\oracle\\11.2.0.3\\instant-32\\SQORA32.dll)\n</code></pre>\n\n<ul>\n<li><p>When going to <code>%systemdrive%\\Windows\\SysWoW64\\odbcad32.exe</code> I can see my driver \"instantclient_11_2\" and the file \"SQORA32.dll\" and it works perfectly when connecting to the db in Python.</p></li>\n<li><p>When using regedit, in  <code>Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBCINST.INI\\ODBC Drivers</code> I can see the driver too.</p></li>\n<li><p>Here is my code, I tried two different connection strings:</p>\n\n<p>-<code>strCon = \"DRIVER={Oracle in instantclient_11_2};DBQ=MyDBQ;UID=MyID;PWD=MyPWD\"</code></p>\n\n<p>-<code>strCon = \"Driver={Oracle in instantclient_11_2}; \" &amp; _\n             \"CONNECTSTRING=(DESCRIPTION=\" &amp; _\n             \"(ADDRESS=(PROTOCOL=TCP)\" &amp; _\n             \"(HOST=MyServer)(PORT=MyPort))\" &amp; _\n             \"(CONNECT_DATA=(SID=MySID))); uid=MyID;pwd=MyPWD;\"</code></p></li>\n<li><p>My MS Excel version is in 32 bits and so is my driver (SQORA32.dll) so I assume it doesn't have anything to do with a 322/64 versions problem, but I may be wrong.</p></li>\n</ul>\n\n<p>Any help/advice/solution is welcome.</p>\n"}, {"tags": ["excel", "error-handling", "vba"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 2, "creation_date": 1470816554, "post_id": 38867295, "comment_id": 65097967, "body": "@<code>Not having Microsoft Word 16.0 object library</code> This has to do with how you bind, see <a href=\"https://support.microsoft.com/en-gb/kb/245115\" rel=\"nofollow noreferrer\">early binding vs late binding</a> for more information."}, {"owner": {"reputation": 330, "user_id": 3997177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d3cd0795367113b8d0f4b51b87e772e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Davies", "link": "https://stackoverflow.com/users/3997177/bryan-davies"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470869090, "post_id": 38867295, "comment_id": 65130138, "body": "I thought so. I&#39;m usually a big early binder, but I suppose I can change to late for this case."}], "answers": [{"comments": [{"owner": {"reputation": 330, "user_id": 3997177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d3cd0795367113b8d0f4b51b87e772e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Davies", "link": "https://stackoverflow.com/users/3997177/bryan-davies"}, "edited": false, "score": 0, "creation_date": 1470815987, "post_id": 38867422, "comment_id": 65097627, "body": "Haha, that&#39;s pretty much what I was expecting... You can never predict everything, but as long as I get as many as possible I should be good. Thanks for the extras.  Do you know anything about the object library? should I be using late binding instead?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 330, "user_id": 3997177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d3cd0795367113b8d0f4b51b87e772e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Davies", "link": "https://stackoverflow.com/users/3997177/bryan-davies"}, "edited": false, "score": 0, "creation_date": 1470816564, "post_id": 38867422, "comment_id": 65097973, "body": "As far as I know the Object Library travels with the file if you have added a reference to it in the VBE. So I think it wouldn&#39;t matter if it is early or late binding... but I&#39;m not the authority on that topic. Maybe someone else can weigh in on it."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 330, "user_id": 3997177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d3cd0795367113b8d0f4b51b87e772e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Davies", "link": "https://stackoverflow.com/users/3997177/bryan-davies"}, "edited": false, "score": 0, "creation_date": 1470897881, "post_id": 38867422, "comment_id": 65138277, "body": "I checked into this a bit futher. Only the reference travels with the file, not the library itself (as I claimed in my prior comment)."}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 1, "last_activity_date": 1470815848, "creation_date": 1470815848, "answer_id": 38867422, "question_id": 38867295, "link": "https://stackoverflow.com/questions/38867295/error-handling-with-excel-vba-controlling-word-and-pdf/38867422#38867422", "title": "Error Handling with Excel VBA controlling Word and PDF", "body": "<p>Sorry to be writing this - I know it's not the answer your looking for, but my experience has been that it is not possible to create an exhaustive list of errors that might occur... especially user errors.</p>\n\n<p>Nevertheless... here are some more to add to your list:</p>\n\n<ul>\n<li>Check if template or other source document is already opened by someone else</li>\n<li>Check if directory exists (if different to the one being pulled from)</li>\n<li>Try to lock down as much as possible for user... let them only access that which they absolutely need to</li>\n</ul>\n"}], "owner": {"reputation": 330, "user_id": 3997177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d3cd0795367113b8d0f4b51b87e772e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Davies", "link": "https://stackoverflow.com/users/3997177/bryan-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 38867422, "answer_count": 1, "score": 0, "last_activity_date": 1470816464, "creation_date": 1470815467, "last_edit_date": 1531161705, "question_id": 38867295, "link": "https://stackoverflow.com/questions/38867295/error-handling-with-excel-vba-controlling-word-and-pdf", "title": "Error Handling with Excel VBA controlling Word and PDF", "body": "<p>TL DR version: what errors should I specifically look for in a error handler with an excel vba running a word template and saving as word doco and pdf.</p>\n\n<p>For the first time, I am actually giving a macro spreadsheet to someone excel literate, but macro illiterate.</p>\n\n<p>This spreadsheet basically opens a bunch of word templates, changes some bookmarks, saves as a word document and as a PDF.</p>\n\n<p>I cannot afford for this spreadsheet to fail, which brings me to error handling.</p>\n\n<p>I haven't really pushed into error handling too much previously. But I have come up with a list of possible errors the 3rd party could run into</p>\n\n<blockquote>\n  <p>Invalid Inputs (various)<br>\n  Cannot find word templates<br>\n  Cannot find bookmarks<br>\n  Cannot Save As Word (various reasons)<br>\n  Cannot Save As PDF (various reasons)<br>\n  Not having Microsoft Word 16.0 object library  </p>\n</blockquote>\n\n<p>Is there any other errors I should be catching? </p>\n\n<p>how do I deal with the <code>Not having Microsoft Word 16.0 object library</code>?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1470813617, "post_id": 38866513, "comment_id": 65096170, "body": "<code>For R = LBound(GclArr)</code>?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1470818682, "post_id": 38866513, "comment_id": 65099192, "body": "How is your range data placed in the array?  If you are using GclAry = SomeRange.Value and the range is one cell, GclAry will not be an array at all, but a single value"}, {"owner": {"reputation": 51, "user_id": 6698914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c90d6a2c5949cac0efc2a90ee33edf3?s=128&d=identicon&r=PG&f=1", "display_name": "E P", "link": "https://stackoverflow.com/users/6698914/e-p"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1470873133, "post_id": 38866513, "comment_id": 65131155, "body": "@dee Thank you for your suggestion. I have tried this now, but it has not changed the result. Still fails when the array consists of a single value or less."}, {"owner": {"reputation": 51, "user_id": 6698914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c90d6a2c5949cac0efc2a90ee33edf3?s=128&d=identicon&r=PG&f=1", "display_name": "E P", "link": "https://stackoverflow.com/users/6698914/e-p"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1470873520, "post_id": 38866513, "comment_id": 65131254, "body": "@chris neilsen I have a function which establishes used cells in a column then sends the values of that range to an array.  I understand that when the range is only a single value it is practically not an array.  But I was hoping that vba code would still be able to work with this situation."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1470876991, "post_id": 38866513, "comment_id": 65132018, "body": "@EP it will help if you post that code (edit it into your Q)  As others have said, a For loop does not have a problem with a single element array.  As it stands your post has insufficient information to diagnose the problem"}, {"owner": {"reputation": 51, "user_id": 6698914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c90d6a2c5949cac0efc2a90ee33edf3?s=128&d=identicon&r=PG&f=1", "display_name": "E P", "link": "https://stackoverflow.com/users/6698914/e-p"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1470885598, "post_id": 38866513, "comment_id": 65133881, "body": "@chris neilsen I have added the code which specifies the range for the array. Also, below I have posted a work around which makes everything run as intended, though it is implemented in a clumsy way with an additional If statement."}], "answers": [{"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470816650, "post_id": 38867377, "comment_id": 65098031, "body": "valid answer. ++ Just update your answer&#39;s code  to have <code>Lbound</code> to <code>Ubound</code> loop example."}, {"owner": {"reputation": 51, "user_id": 6698914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c90d6a2c5949cac0efc2a90ee33edf3?s=128&d=identicon&r=PG&f=1", "display_name": "E P", "link": "https://stackoverflow.com/users/6698914/e-p"}, "edited": false, "score": 0, "creation_date": 1470873652, "post_id": 38867377, "comment_id": 65131289, "body": "@Cset&#233;nyi Thanks, but as per above, LBound has the same result as my current code - excel crashes."}], "tags": [], "owner": {"reputation": 29, "user_id": 5917863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84068f31c5aa60b7082fe170aec7a122?s=128&d=identicon&r=PG&f=1", "display_name": "Cset&#233;nyi", "link": "https://stackoverflow.com/users/5917863/cset%c3%a9nyi"}, "is_accepted": false, "score": 1, "last_activity_date": 1470816925, "last_edit_date": 1470816925, "creation_date": 1470815676, "answer_id": 38867377, "question_id": 38866513, "link": "https://stackoverflow.com/questions/38866513/for-loop-for-array-with-only-one-element/38867377#38867377", "title": "For Loop for Array with Only One Element", "body": "<p>The for loop has no issue if there is only iteration (see the example)</p>\n\n<pre><code>Sub ForLoopTest()\n\nDim iItem As Long\n\nFor iItem = 1 To 1\n        MsgBox (iItem)\n        Next iItem\n\nEnd Sub\n</code></pre>\n\n<p>Have you considered that VBA array indexes starts by default at 0. So in that case the value of UBound(GclArr, 1) is 0. To eliminate this kind of issues the LBound(GclArr, 1) To UBound(GclArr, 1) syntax can be used.</p>\n\n<pre><code>If GclArr(1, 1) &lt;&gt; 0 Then\nIf Gcl &lt;&gt; 0 Then\n    For R = LBound(GclArr, 1) To UBound(GclArr, 1)\n    GclStr = GclStr &amp; GclArr(R, 1) &amp; \" \" &amp; Gcl &amp; \" \"\n    Next R\nEnd If\nEnd If\n</code></pre>\n\n<p>The  Option Base 1 statement at the start of a module can modify this behavior. In that case the index of the first element of an array will be 1.</p>\n"}, {"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470816848, "post_id": 38867433, "comment_id": 65098124, "body": "works perfectly for just one row in the array. But as OP said, he gets dynamic bounds for his array. So this answer will fail there. Also, it&#39;s a good idea to add some context about your code. Only code in your answer is bit less helpful than an answer with some code + explanation. :)"}], "tags": [], "owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "is_accepted": false, "score": 1, "last_activity_date": 1470817898, "last_edit_date": 1470817898, "creation_date": 1470815883, "answer_id": 38867433, "question_id": 38866513, "link": "https://stackoverflow.com/questions/38866513/for-loop-for-array-with-only-one-element/38867433#38867433", "title": "For Loop for Array with Only One Element", "body": "<pre><code>Private Sub sb_ForTest()\nDim i&amp;\n    For i = 1 To 1\n        Debug.Print i ' I have everything working\n    Next\nEnd Sub\n</code></pre>\n\n<p>Re: cyboashu</p>\n\n<blockquote>\n  <p>works perfectly for just one row in the array. But as OP said, he gets\n  dynamic bounds for his array. So this answer will fail there. Also,\n  it's a good idea to add some context about your code. Only code in\n  your answer is bit less helpful than an answer with some code +\n  explanation. :)</p>\n</blockquote>\n\n<p>OP wrote <strong><em>\"If R = 1 and UBound(GclArr, 1) also = 1, it seems the For Loop gets confused. (It works perfectely if UBound is 2 or greater).\"</em></strong></p>\n\n<p>This statement is incorrect and I hastened to correct him :)\nSorry for didn't quoted him earlier in the head of my message...</p>\n\n<p>Moreover, he has presented it like a problem <strong><em>\"For Loop for Array with Only One Element\"</em></strong> in the question title :)</p>\n\n<p>I wrote about For...Loop functionality only, regardless the real bounds passed to it by other code.\n.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6698914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c90d6a2c5949cac0efc2a90ee33edf3?s=128&d=identicon&r=PG&f=1", "display_name": "E P", "link": "https://stackoverflow.com/users/6698914/e-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1470875989, "creation_date": 1470875989, "answer_id": 38885609, "question_id": 38866513, "link": "https://stackoverflow.com/questions/38866513/for-loop-for-array-with-only-one-element/38885609#38885609", "title": "For Loop for Array with Only One Element", "body": "<p>So I checked what the value of UBound is when I only have one value in the range. It is the cell limit of 1048574.  This is probably the result of my range definition function:</p>\n\n<pre><code>Set GclR = .Range(\"E3\", .Range(\"E3\").End(xlDown))\n</code></pre>\n\n<p>and</p>\n\n<pre><code>GclArr = GclR.Value\n</code></pre>\n\n<p>Given the above, I believe Excel is not actually crashing, but taking a very long time to pointlessly process such a large array.</p>\n\n<p>Based on that, I made the following workaround using an additional If statement:</p>\n\n<pre><code>If Gcl &lt;&gt; 0 Then\n    If GclArr(1, 1) &lt;&gt; 0 Then\n        If GclArr(2, 1) = 0 Then\n        GclStr = GclStr &amp; GclArr(1, 1) &amp; \" \" &amp; Gcl &amp; \" \"\n        Else\n        For R = 1 To UBound(GclArr, 1)\n        GclStr = GclStr &amp; GclArr(R, 1) &amp; \" \" &amp; Gcl &amp; \" \"\n        Next R\n        End If\n    End If\nEnd If\n</code></pre>\n\n<p>The If statement checks what the value of the second row in the very large array is, and if it is zero (implying there is no data after the first row), avoids the For Loop and instead, uses a specific function to deal with the value in the first row of the array.</p>\n\n<p>Having so many If statements isn't very elegant, but it works perfectly.</p>\n\n<p>I would still like to use something more elegant if it exists.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6698914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c90d6a2c5949cac0efc2a90ee33edf3?s=128&d=identicon&r=PG&f=1", "display_name": "E P", "link": "https://stackoverflow.com/users/6698914/e-p"}, "edited": false, "score": 0, "creation_date": 1470955282, "post_id": 38886900, "comment_id": 65172857, "body": "Thank you for your suggestion. Option 2 with method to handle single values is similar to my workaround below. I&#39;ll leave my code as is, since it is working as intended now. Your help has been appreciated."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 51, "user_id": 6698914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c90d6a2c5949cac0efc2a90ee33edf3?s=128&d=identicon&r=PG&f=1", "display_name": "E P", "link": "https://stackoverflow.com/users/6698914/e-p"}, "edited": false, "score": 0, "creation_date": 1470961075, "post_id": 38886900, "comment_id": 65174390, "body": "@ep  The solution i posted is quite different to yours, it avoids creating the inflated array at all, yours simply detects the bloat and works around it"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 3, "last_activity_date": 1470886918, "creation_date": 1470886918, "answer_id": 38886900, "question_id": 38866513, "link": "https://stackoverflow.com/questions/38866513/for-loop-for-array-with-only-one-element/38886900#38886900", "title": "For Loop for Array with Only One Element", "body": "<p>The root of your issue is the line <code>Set GclR = .Range(\"E3\", .Range(\"E3\").End(xlDown))</code>. When there is only a value in <code>E3</code> and no other values below,  your code will return a range down to the bottom of the sheet.  As you said you will then be searching 1,000,000+ empty cells.</p>\n\n<p>To fix it you have two options:</p>\n\n<ol>\n<li><p>If there is no other data in column <code>E</code> below your intended data, find the range from the bottom up.</p>\n\n<pre><code>Set GclR = .Range(\"E3\", .Cells(.Rows.Count, 5).End(xlUp))\n</code></pre></li>\n<li><p>If you must use <code>.End(xlDown)</code> test for a blank cell first</p>\n\n<pre><code>If IsBlank(.Range(\"E4\")) Then\n    Set GclR = .Range(\"E3\")\nElse\n    Set GclR = .Range(\"E3\", .Range(\"E3\").End(xlDown))\nEndIf\n</code></pre></li>\n</ol>\n\n<p>In both cases you may return a single cell range to <code>GclR</code>.  When that happens <code>CclR.Value</code> will <em>not</em> be an array.  To handle this use</p>\n\n<pre><code>If GclR.Cells.Count = 1 Then\n    ReDim GclArr(1 to 1, 1 to 1)\n    GclArr(1, 1) = GclR.Value\nElse\n    GclArr = GclR.Value\nEndIf\n</code></pre>\n\n<p>You can then use your original For loop code</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1471587746, "creation_date": 1471587746, "answer_id": 39032336, "question_id": 38866513, "link": "https://stackoverflow.com/questions/38866513/for-loop-for-array-with-only-one-element/39032336#39032336", "title": "For Loop for Array with Only One Element", "body": "<p>You can avoid a loop and do a direct join (after defning your range and looking up), i.e.</p>\n\n<pre><code>Sub Recut()\nDim Gcl As Long\nDim GclStr  As String\nDim rng1 As Range\n\nGcl = 3\n\nWith Sheets(\"Sheet2\")\nSet rng1 = .Range(.[e3], .Cells(Rows.Count, \"E\").End(xlUp))\nEnd With\n\nIf rng1.Cells.Count &gt; 1 Then GclStr = Join(Application.Transpose(rng1), \" \" &amp; Gcl &amp; \" \")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6698914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c90d6a2c5949cac0efc2a90ee33edf3?s=128&d=identicon&r=PG&f=1", "display_name": "E P", "link": "https://stackoverflow.com/users/6698914/e-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3746, "favorite_count": 3, "answer_count": 5, "score": 4, "last_activity_date": 1471587746, "creation_date": 1470813097, "last_edit_date": 1531164843, "question_id": 38866513, "link": "https://stackoverflow.com/questions/38866513/for-loop-for-array-with-only-one-element", "title": "For Loop for Array with Only One Element", "body": "<p>I have a macro which runs almost how I want it to:</p>\n\n<p>The macro populates strings based on the contents of a combination of cells.</p>\n\n<p>The inputs are ranges which I convert to arrays. Column E3 has values in cells starting at row 3 and below.</p>\n\n<pre><code>With ActiveWorkbook.Worksheets(\"Sheet2\")\nSet GclR = .Range(\"E3\", .Range(\"E3\").End(xlDown))\nEnd With\n\nGclArr = GclR.Value\n</code></pre>\n\n<p>The arrays vary in size from non-existent to half a dozen rows in length.\nMy code loops through the contents and finds each value and places it into it's respective position in a string.</p>\n\n<p>Where it trips up is when when I have less than 2 values in the array. Excel hangs and crashes.</p>\n\n<p>I figure this is due to the For Loop:</p>\n\n<pre><code>If GclArr(1, 1) &lt;&gt; 0 Then\n    If Gcl &lt;&gt; 0 Then\n        For R = 1 To UBound(GclArr, 1)\n        GclStr = GclStr &amp; GclArr(R, 1) &amp; \" \" &amp; Gcl &amp; \" \"\n        Next R\n    End If\nEnd If\n</code></pre>\n\n<p>If R = 1 and UBound(GclArr, 1) also = 1, it seems the For Loop gets confused. (It works perfectly if UBound is 2 or greater).</p>\n\n<p>I used an If statement to handle the case when the array is empty, but can't think of a way to get this to work for an array with a single value.</p>\n\n<p>What other function can I use to achieve the same result, but with the ability to handle single values in arrays?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 441, "user_id": 4522434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0ee16196ead21501b7e79bada556a62a?s=128&d=identicon&r=PG&f=1", "display_name": "Jing He", "link": "https://stackoverflow.com/users/4522434/jing-he"}, "is_accepted": false, "score": 1, "last_activity_date": 1470809530, "creation_date": 1470809530, "answer_id": 38865515, "question_id": 38865514, "link": "https://stackoverflow.com/questions/38865514/how-to-get-the-row-number-of-the-last-row-of-a-range-in-exce-vba/38865515#38865515", "title": "How to get the row number of the last row of a range in Exce VBA?", "body": "<pre><code>Range(\"A2:B4\").Row + Range(\"A2:B4\").rows.count -1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "is_accepted": false, "score": 1, "last_activity_date": 1470815139, "creation_date": 1470815139, "answer_id": 38867181, "question_id": 38865514, "link": "https://stackoverflow.com/questions/38865514/how-to-get-the-row-number-of-the-last-row-of-a-range-in-exce-vba/38867181#38867181", "title": "How to get the row number of the last row of a range in Exce VBA?", "body": "<p>Iterate Selection.Areas to find a bottom row in case of multiple selection and use the method toy posted above.</p>\n"}, {"tags": [], "owner": {"reputation": 174, "user_id": 5223249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lx7fG.jpg?s=128&g=1", "display_name": "Hadi", "link": "https://stackoverflow.com/users/5223249/hadi"}, "is_accepted": false, "score": 1, "last_activity_date": 1470823945, "creation_date": 1470823945, "answer_id": 38870414, "question_id": 38865514, "link": "https://stackoverflow.com/questions/38865514/how-to-get-the-row-number-of-the-last-row-of-a-range-in-exce-vba/38870414#38870414", "title": "How to get the row number of the last row of a range in Exce VBA?", "body": "<p>Another option that returns the row number for a range</p>\n\n<pre><code>Split(MyRange.Rows.Address, \"$\")(4)\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 441, "user_id": 4522434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0ee16196ead21501b7e79bada556a62a?s=128&d=identicon&r=PG&f=1", "display_name": "Jing He", "link": "https://stackoverflow.com/users/4522434/jing-he"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1470823945, "creation_date": 1470809530, "last_edit_date": 1531164843, "question_id": 38865514, "link": "https://stackoverflow.com/questions/38865514/how-to-get-the-row-number-of-the-last-row-of-a-range-in-exce-vba", "title": "How to get the row number of the last row of a range in Exce VBA?", "body": "<p>Is there any method or property by which I can get the row number of last row in a range <strong>no matter if that row is totally empty</strong>? like</p>\n\n<pre><code>Range(\"A2:B4\").Rows.Lastrow\n</code></pre>\n\n<p>will return \"4\" even the row 4 is totally empty.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470810602, "post_id": 38865406, "comment_id": 65094494, "body": "You said you tried to see if it errors but this didn&#39;t work? How did you try this if you unprotected the sheet it should error if the password is not the same."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 3, "creation_date": 1470812325, "post_id": 38865406, "comment_id": 65095476, "body": "no. there isn&#39;t any property/method which returns  the sheet password so that you can match it with another string. <code>Worksheet.Password</code>, it will be cool but defy the whole concept of password :)"}, {"owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470812617, "post_id": 38865406, "comment_id": 65095630, "body": "Thanks I appreciate it @cyboashu that is the answer I was looking for I didn&#39;t there would be another way to check it."}], "answers": [{"comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1470810453, "post_id": 38865719, "comment_id": 65094409, "body": "The OP is asking for a check if the password is changed, not if something is protected."}, {"owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470810733, "post_id": 38865719, "comment_id": 65094564, "body": "@DragonSamu If <code>ws.Unprotect Password:=&quot;Password&quot;</code> works then the password hasn&#39;t changed."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470810872, "post_id": 38865719, "comment_id": 65094653, "body": "I understand that, therefor I am asking OP why he says the code fails while it shouldn&#39;t"}, {"owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "edited": false, "score": 0, "creation_date": 1470811377, "post_id": 38865719, "comment_id": 65094927, "body": "I am checking to see if the password was changed if it was changed the code will throw an error when trying to unprotect the sheet with the original password. The message is just letting me know that the password is not the original I set"}, {"owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "edited": false, "score": 0, "creation_date": 1470812924, "post_id": 38865719, "comment_id": 65095806, "body": "@Trimax Your updated code produces the same result as mine just a different way of doing it the next question is which code is faster?"}, {"owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "reply_to_user": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "edited": false, "score": 0, "creation_date": 1470813681, "post_id": 38865719, "comment_id": 65096210, "body": "@MatthewLozoya The answer to your question <i>&quot;What I am asking is can this be done without having to unprotect the sheet?&quot;</i>  is NO.  But you can protect the sheet again with the same password."}], "tags": [], "owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "is_accepted": false, "score": 1, "last_activity_date": 1470812402, "last_edit_date": 1470812402, "creation_date": 1470810249, "answer_id": 38865719, "question_id": 38865406, "link": "https://stackoverflow.com/questions/38865406/verifying-that-a-set-password-on-a-worksheet-is-correct-though-vba/38865719#38865719", "title": "Verifying that a set password on a worksheet is correct though VBA", "body": "<p>After unprotect the sheet with the password You can verify is the sheet is protected.</p>\n\n<p>Here is the complete code:</p>\n\n<pre><code>Sub CheckSheetPassword()\n    Dim ws As Worksheet\n\n    On Error Resume Next\n    For Each ws In Worksheets\n        ws.Unprotect Password:=\"Password\"\n        If ws.ProtectContents = False Then\n            ' The sheet is unprotected, so password hasn't changed\n        Else\n            ' The sheet is protected, so password has changed\n            MsgBox \"Failed To Verify Password on: \" &amp; ws.Name\n        End If\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1470892299, "creation_date": 1470892299, "answer_id": 38887702, "question_id": 38865406, "link": "https://stackoverflow.com/questions/38865406/verifying-that-a-set-password-on-a-worksheet-is-correct-though-vba/38887702#38887702", "title": "Verifying that a set password on a worksheet is correct though VBA", "body": "<p>This question was answered in the comments stating that the way I proposed was correct. </p>\n"}], "owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 1, "accepted_answer_id": 38887702, "answer_count": 2, "score": 3, "last_activity_date": 1470892299, "creation_date": 1470809060, "last_edit_date": 1470811996, "question_id": 38865406, "link": "https://stackoverflow.com/questions/38865406/verifying-that-a-set-password-on-a-worksheet-is-correct-though-vba", "title": "Verifying that a set password on a worksheet is correct though VBA", "body": "<p>I password protected a worksheet and I would like to verify on open that the password hasn't been changed by a user later. </p>\n\n<p>I have tried setting the password again via VBA on a sheet that the password was changed to see if it would error but it did not provide an error. </p>\n\n<p>The following code is what I am currently using to test this and it works but I don't think you should have to Unprotect a sheet then Protect it to verify the password.  </p>\n\n<pre><code>Sub CheckSheetPassword()\n    Dim ws As Worksheet\n\n    On Error Resume Next\n    For Each ws In Worksheets\n        ws.Unprotect Password:=\"Password\"\n        ws.Protect Password:=\"Password\"\n        If Err &lt;&gt; 0 Then\n            MsgBox \"Failed To Verify Password on: \" &amp; ws.Name\n            Err = 0\n        End If\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p><strong>Explanation of my code:</strong></p>\n\n<p>The above code loops through all the sheets in a workbook and checks to see if the sheet protection password has been changed by unprotecting the current sheet with the original password.</p>\n\n<p>It then protects the sheet the sheet with the original password to prevent it from staying unprotected. (If the current password is different than the original password no error is thrown and nothing happens with this step.)</p>\n\n<p>If the code is unable to unprotect the sheet then it will throw an error and a message box will appear to let me know that the password has been changed on that sheet.</p>\n\n<p>I reset the Error count to zero before the next worksheet is evaluated to determine which sheets still have correct passwords. </p>\n\n<p>What I am asking is can this be done without having to unprotect the sheet?</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 6283909, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f4183a620c413e01d9061bc2648e5745?s=128&d=identicon&r=PG&f=1", "display_name": "Camille", "link": "https://stackoverflow.com/users/6283909/camille"}, "edited": false, "score": 0, "creation_date": 1470818786, "post_id": 38866767, "comment_id": 65099252, "body": "Thank you Jamie. I&#39;m trying this but running the code it&#39;s not detecting there is an error so kips to the Else part."}, {"owner": {"reputation": 203, "user_id": 6283909, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f4183a620c413e01d9061bc2648e5745?s=128&d=identicon&r=PG&f=1", "display_name": "Camille", "link": "https://stackoverflow.com/users/6283909/camille"}, "edited": false, "score": 0, "creation_date": 1470823311, "post_id": 38866767, "comment_id": 65102427, "body": "I have managed to figure out something. Will post completed code tomorrow. !"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1470845136, "post_id": 38866767, "comment_id": 65118094, "body": "Dir$(&quot;c:\\temp\\nofile.jpg&quot;) will return a zero-length string if nofile.jpg doesn&#39;t exist in c:\\temp.  Substitute the path/file name you&#39;re checking for, then use If Len(Dir$(&quot;c:\\temp\\nofile.jpg&quot;)) = 0 to test for a missing file."}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1470813871, "creation_date": 1470813871, "answer_id": 38866767, "question_id": 38864529, "link": "https://stackoverflow.com/questions/38864529/check-if-image-exists-and-if-not-bring-in-no-image-file/38866767#38866767", "title": "Check if Image exists and if not bring in No Image file", "body": "<p>One of several methods could be to try setting a reference to the shape and managing the error that way e.g.</p>\n\n<pre><code>Dim oShp As Shape\nOn Error Resume Next\nSet oShp = myDocument.Shapes(\"PropertyPic\")\nIf Err Then\n  ' set no image\nElse\n  With oShp\n    .Fill.Visible = msoTrue\n    .Fill.UserPicture PicLink &amp; _\n    rs.Fields(\"PropertyName\").Value &amp; a &amp; _ \n    rs.Fields(\"PropertyId\").Value &amp; b\n  End With\nEnd If\nOn Error Goto 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 203, "user_id": 6283909, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f4183a620c413e01d9061bc2648e5745?s=128&d=identicon&r=PG&f=1", "display_name": "Camille", "link": "https://stackoverflow.com/users/6283909/camille"}, "is_accepted": false, "score": 0, "last_activity_date": 1470888898, "creation_date": 1470888898, "answer_id": 38887166, "question_id": 38864529, "link": "https://stackoverflow.com/questions/38864529/check-if-image-exists-and-if-not-bring-in-no-image-file/38887166#38887166", "title": "Check if Image exists and if not bring in No Image file", "body": "<p>This is the final code I used </p>\n\n<p>I ensured my variables I was using not duplicated and declared as global as I put this in another module.. </p>\n\n<pre><code>Sub PropertyPic()\n\nDim oShp As Shape\n\n Set myDocument = ActivePresentation.Slides.Item(1)\n\n'On Error Resume Next\nSet oShp = myDocument.Shapes(\"PropertyPic\")\nOn Error GoTo Err1:\n  With oShp\n    '.Fill.Visible = msoTrue\n    .Fill.UserPicture linkproperty &amp; _\n     rs.Fields(\"PropertyName\").Value &amp; a &amp; _\n    rs.Fields(\"propertyID\").Value &amp; b\nExit Sub\nErr1:\nmyDocument.Shapes(\"PropertyPic\").Fill.UserPicture NoImage\n'Exit Sub\n'If Err.Number &lt;&gt; 0 Then\n\nResume Next\n'Else\n  End With\n'End If\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 6283909, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f4183a620c413e01d9061bc2648e5745?s=128&d=identicon&r=PG&f=1", "display_name": "Camille", "link": "https://stackoverflow.com/users/6283909/camille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1609444136, "creation_date": 1470804853, "last_edit_date": 1609444136, "question_id": 38864529, "link": "https://stackoverflow.com/questions/38864529/check-if-image-exists-and-if-not-bring-in-no-image-file", "title": "Check if Image exists and if not bring in No Image file", "body": "<p>I have this code to bring in the image of a property.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>myDocument.Shapes(&quot;PropertyPic&quot;).Fill.Visible = msoTrue\nmyDocument.Shapes(&quot;PropertyPic&quot;).Fill.UserPicture PicLink &amp; rs.Fields(&quot;PropertyName&quot;).Value &amp; a &amp; rs.Fields(&quot;PropertyId&quot;).Value &amp; b\n</code></pre>\n<p>I need to add code to use the NoImage file if the pic doesn't exist.<br />\nI tried <code>On Error Goto Error handler</code>.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1470807428, "post_id": 38864423, "comment_id": 65092992, "body": "Needs more detail on exactly how you&#39;re currently running the import."}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 1, "creation_date": 1470808080, "post_id": 38864423, "comment_id": 65093252, "body": "What have you tried so far? And you don&#39;t want two columns, you should store the data in one column, always."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1470826190, "last_edit_date": 1470826190, "creation_date": 1470809932, "answer_id": 38865634, "question_id": 38864423, "link": "https://stackoverflow.com/questions/38864423/splitting-a-string-and-converting-into-datetime-in-access-vba/38865634#38865634", "title": "Splitting a string and converting into Datetime in Access VBA", "body": "<p>That's a bit tricky because of the variable length of the string.</p>\n\n<p>But this will do: Chop the milliseconds, replace the separators for the datepart and for the spacing between the datepart and the timepart. Then convert to date or time:</p>\n\n<pre><code>DateColoumn = DateValue(Replace(Replace(Left([DateTimeText], Len([DateTimeText]) - 10), \":\", \"-\", , 2), \":\", \" \", , 1))\nTimeColoumn = TimeValue(Replace(Replace(Left([DateTimeText], Len([DateTimeText]) - 10), \":\", \"-\", , 2), \":\", \" \", , 1))\n</code></pre>\n\n<p>If this is for a database table, <em>Rene's</em> advice is right: Use one field only:</p>\n\n<pre><code>LogTime = CDate(Replace(Replace(Left([DateTimeText], Len([DateTimeText]) - 10), \":\", \"-\", , 2), \":\", \" \", , 1))\n</code></pre>\n\n<p>Edit:</p>\n\n<p>The combined value can also by obtained using <em>Split</em> as shown by User, though I would simplify it a bit:</p>\n\n<pre><code>LogTime = ConvertLog([DateTimeText])\n</code></pre>\n\n<p>using a function like this:</p>\n\n<pre><code>Public Function ConvertLog(ByVal Entry As String) As Date\n\n    Dim Parts   As Variant\n    Dim LogTime As Date\n\n    Parts = Split(Entry, \":\")\n\n    LogTime = DateSerial(Parts(0), Parts(1), Parts(2)) + TimeSerial(Parts(3), Parts(4), Parts(5))\n\n    ConvertLog = LogTime\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470824299, "post_id": 38866613, "comment_id": 65103087, "body": "Normally you round time parts down - the hour is not 8 for a time of 07:59:59, neither 07:59:59.999 (except when <i>displayed</i> by default in Access where milliseconds will be rounded to the nearest second). So you can skip the rounding of nano/milliseconds - after all, 4/5 rounding will only shift all the log recordings by 0.5 second."}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470830152, "post_id": 38866613, "comment_id": 65106973, "body": "Re: Gustav    I&#39;m a newbee and I&#39;m very interesting - is it normal on this community to to take someone else&#39;s code, and paste it on already positive voted solution, thereby crossed out it?    I&#39;m in a fog..."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470832981, "post_id": 38866613, "comment_id": 65108892, "body": "Sorry, I considering adding it to your answer, but some find that offending, so I made a reference instead, as there is nothing special in using Split for tasks like this."}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470834056, "post_id": 38866613, "comment_id": 65109753, "body": "You stole it out and then been sorried :) Please, read &quot;12 chairs&quot; by Ilf &amp; Petrov, 1927.     <i>&quot;The Assistant Warden of the Second Home of Stargorod Social Security Administration was a shy little thief. His whole being protested against stealing, yet it was impossible for him not to steal. He stole and was ashamed of himself. He stole constantly and was constantly ashamed of himself, which was why his smoothly shaven cheeks always burned with a blush of confusion, shame, bashfulness and embarrassment. [...] The world has never seen such a bashful chiseller as Alexander Yakovlevich.&quot;</i>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470834342, "post_id": 38866613, "comment_id": 65109958, "body": "Well, the source is a string, so you cannot avoid string handling. I ran a test on your code, and it runs in 4.4&#181;s. My one-liner runs in 5.7&#181;s, while my  ConvertLog runs in 3.9&#181;s, so not much of a difference."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470834524, "post_id": 38866613, "comment_id": 65110096, "body": "Relax please, you didn&#39;t invent Split, neither DateSerial, nor TimeSerial which all both are very common as well as intended for tasks like this."}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470835419, "post_id": 38866613, "comment_id": 65110803, "body": "Relax yourself :)   ` &#39; |Total, msc  |Cyc, 10^  |Avg, mcs   &#39;     0.087         1        8.674   &#39;     0.682         2        6.819   &#39;     6.716         3        6.716   &#39;    66.762         4        6.676   &#39;   671.204         5        6.712   &#39; END     &#39; |Total, msc  |Cyc, 10^  |Avg, mcs   &#39;     0.224         1        22.398   &#39;     1.876         2        18.756   &#39;    18.973         3        18.973   &#39;   189.256         4        18.926   &#39; 1&#39;880.599         5        18.806   &#39; END`"}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470835847, "post_id": 38866613, "comment_id": 65111110, "body": "6.712 vs 18.806 mcs"}], "tags": [], "owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "is_accepted": false, "score": 0, "last_activity_date": 1470829521, "last_edit_date": 1470829521, "creation_date": 1470813430, "answer_id": 38866613, "question_id": 38864423, "link": "https://stackoverflow.com/questions/38864423/splitting-a-string-and-converting-into-datetime-in-access-vba/38866613#38866613", "title": "Splitting a string and converting into Datetime in Access VBA", "body": "<p>This notation is typical for very large logs and parse it by very slow string functions, like Gustav solution, is not good. More over - <strong>it doesn't take into account fractional seconds part AT ALL</strong>.</p>\n\n<pre><code>Sub sb_SplitDate()\nDim dDate As Date, dDatDat As Date, dDatTim As Date\nDim i&amp;, lArr&amp;(), lLB&amp;, lUB&amp;\nDim sDatInc$, sArr$(), sClm1$, sClm2$\n\n    sDatInc = \"1999:12:31:23:59:59:50000000000000000\"\n    sDatInc = \"1999:12:31:23:59:59:49999999999999999\"\n    sDatInc = \"2016:6:28:10:15:0:49999\"\n    sDatInc = \"2016:6:28:10:15:0:50\"\n    sDatInc = \"2016:6:28:10:15:0:5\"\n    sDatInc = \"2016:6:28:10:15:0:499999999999\"\n    sDatInc = \"2016:6:28:10:15:0:999999999999999999999999999\"\nsDatInc = \"2016:6:28:10:15:0:390000000\" ' Original\n\n    sArr = Split(sDatInc, \":\")\n\n    lLB = LBound(sArr): lUB = UBound(sArr)\n    ReDim lArr(lLB To lUB)\n    For i = lLB To (lUB - 1)\n        lArr(i) = CLng(sArr(i))\n    Next\n   'lArr(6) = CLng(Left$(sArr(6), 1))\n    lArr(6) = CLng(AscW(sArr(6)) - 48) ' significantly faster\n              ' or AscB \n\n    dDatDat = DateSerial(lArr(0), lArr(1), lArr(2))\n    dDatTim = TimeSerial(lArr(3), lArr(4), lArr(5))\n\n    dDate = dDatDat + dDatTim - _\n            CLng(lArr(6) &gt; 4) / 86400\n' standard (school) rounding of the fractional part of seconds\n' may gives increasing time, date, month &amp; year ;)\n\n    sClm1 = Format$(dDate, \"yyyy:mm:dd\")\n    sClm2 = Format$(dDate, \"hh:mm:ss\")\n\n    Debug.Print sDatInc &amp; vbLf &amp; _\n                sClm1 &amp; \" \" &amp; sClm2 &amp; _\n                IIf(lArr(6) &gt; 4, \" ' *** Rounded Up!\", \"\") &amp; _\n                vbLf\n    Stop\nEnd Sub\n</code></pre>\n\n<h2>.</h2>\n\n<p>Re: Gustav</p>\n\n<p><em>> Normally you round time parts down</em><br>\nNormally I round as task is standing.\nIf it's a <strong>time stamp - Down</strong>. If it's a <strong>time diapason</strong> (how much was ticked?) <strong>- Up</strong>.\nMoreover, even in 1st case it may be rounded Up for special purposes like avoiding near clock  zeroes events raising. As task is standing...</p>\n\n<p><em>> 4/5 rounding will only shift ...</em><br>\nWhat means \"only\"? Do you wait any more from rounding above simple shifting of given data to one of boundaries? Any rounding will shift for some value as task was standed by OP: <strong><em>\"hh:mm:ss:ms\" --> \"hh:mm:ss\"</em></strong></p>\n\n<p><em>> ... shift all the log recordings by 0.5 second</em><br>\nAre you sure? What about given original <em>\"2016:6:28:10:15:0:390000000\"</em>?<br>\nIt will be shifted for 0.39-Down or for 0.61-Up...</p>\n\n<p>OP didn't explain which rounding must be applying. But it's not a reason to forget about rounding at all in favor of simple cutting.</p>\n\n<p>I proposed little sophisticated but common solution that easy transformed from one rounding to another. It only needs to add the only '=Chr(39) symbol :)  </p>\n\n<pre><code>dDate = dDatDat + dDatTim ' - CLng(lArr(6) &gt; 4) / 86400\n</code></pre>\n\n<p>It's not difficult, yeah? \nBut it's a visual representation of <strong>one of the this task pitfalls</strong> and its solution.</p>\n\n<p><em>> I believe only one array is needed</em><br>\n- Yeah... I understand. And I'm not surprised, since you believe that string operations are acceptable in such tasks as numbers parsing. <strong>The second array is intended exactly to avoid superslow string operations.</strong> For myself I would not use Split() at all, but only byte arrays parsing...</p>\n\n<p>And, btw, - does the task was to minimize the quantity of used arrays or to try to cram solution in one-two strings of code?..</p>\n\n<p>Sorry, but the stars are not in favor of strings now :)\n.</p>\n"}], "owner": {"reputation": 55, "user_id": 6676984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a982c98bddeb463a7784ed5ee9cf2e21?s=128&d=identicon&r=PG&f=1", "display_name": "Shreyans", "link": "https://stackoverflow.com/users/6676984/shreyans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593958064, "creation_date": 1470804191, "last_edit_date": 1593958064, "question_id": 38864423, "link": "https://stackoverflow.com/questions/38864423/splitting-a-string-and-converting-into-datetime-in-access-vba", "title": "Splitting a string and converting into Datetime in Access VBA", "body": "<p>Hi I have a column in my <code>Access</code> <code>database</code> which I import from a log file. My date and time format in the log file is as follows:\n<code>2016:6:28:10:15:0:390000000</code> which is basically:\n<code>yyyy:mm:dd:hh:mm:ss:ms</code></p>\n\n<p>When I import the log file in access, it reads this as one column as a text. However, I want this to be in two columns and be read as:\ncolumn1: <code>yyyy:mm:dd</code>\ncolumn2: <code>hh:mm:ss</code></p>\n\n<p>And have its format as <code>Datetime</code> instead of text. I need to do this using <code>Excel</code> <code>VBA</code>. I am unable to find a solution to this. Please help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470805685, "post_id": 38863610, "comment_id": 65092407, "body": "see my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470800343, "post_id": 38863730, "comment_id": 65090902, "body": "Thanks. But didn&#39;t work :/  I uploaded the sample file <a href=\"https://dl.dropboxusercontent.com/u/25781093/test.xlsb\" rel=\"nofollow noreferrer\">dl.dropboxusercontent.com/u/25781093/test.xlsb</a>"}, {"owner": {"reputation": 176, "user_id": 6566211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce40841f1a55640d22261334c077d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6566211/jason"}, "reply_to_user": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470800936, "post_id": 38863730, "comment_id": 65091031, "body": "See my edited code above.  I changed integers to long because of the number of rows.  I also changed the for loop to step backwards through the rows so as not to miss anything."}], "tags": [], "owner": {"reputation": 176, "user_id": 6566211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce40841f1a55640d22261334c077d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6566211/jason"}, "is_accepted": false, "score": 1, "last_activity_date": 1470800801, "last_edit_date": 1470800801, "creation_date": 1470799637, "answer_id": 38863730, "question_id": 38863610, "link": "https://stackoverflow.com/questions/38863610/delete-row-if-the-column-contains-text/38863730#38863730", "title": "Delete row if the column contains text", "body": "<p>In the future, please post code you've tried first for the community to help you out.  That being said, try this out:</p>\n\n<pre><code>Sub Test()\n    Dim x as Long\n    Dim i as Long\n\n    x = Sheets(\"SOVI\").Range(\"M\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = x to 2 Step -1 \n        If InStr(1, Range(\"M\" &amp; i).Value, \"water\", vbTextCompare) Or InStr(1, Range(\"M\" &amp; i).Value, \"beer\", vbTextCompare) Or InStr(1, Range(\"M\" &amp; i).Value, \"vodka\", vbTextCompare) Then\n            Range(\"M\" &amp; i).entirerow.delete\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470841924, "post_id": 38864664, "comment_id": 65115871, "body": "If i do not change the line <code>Set sht = ThisWorkbook.Sheets(&quot;Sheet1&quot;)</code>  to <code>Set sht = ThisWorkbook.Sheets(&quot;SOVI&quot;)</code> to  i got <code>Run-time error </code>9<code>:  Subscript out of range</code> And when I change and run the code become really slow"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1470805666, "creation_date": 1470805666, "answer_id": 38864664, "question_id": 38863610, "link": "https://stackoverflow.com/questions/38863610/delete-row-if-the-column-contains-text/38864664#38864664", "title": "Delete row if the column contains text", "body": "<p>I would use a slightly different approach, with the <code>Like</code> and with <code>Select Case</code> - this will give you more versatility in the future if you would want to expand it to more types of drinks.</p>\n\n<pre><code>Sub FindDrink()\n\nDim lRow As Long\nDim i As Long\nDim sht As Worksheet\n\n' always set your sht, modify to your sheet name\nSet sht = ThisWorkbook.Sheets(\"Sheet1\")\nlRow = sht.Cells(sht.Rows.Count, \"M\").End(xlUp).Row\n\nFor i = lRow To 2 Step -1\n    Select Case True\n        Case (sht.Cells(i, \"M\").Value Like \"*beer*\") Or (sht.Cells(i, \"M\").Value Like \"*water*\") Or (sht.Cells(i, \"M\").Value Like \"*vodka*\")\n            Range(\"M\" &amp; i).EntireRow.Delete\n\n        Case Else\n            ' if you decide to do other things in the future for other values\n\n    End Select\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470841735, "post_id": 38865741, "comment_id": 65115736, "body": "thanks! Tried here but just create a blank sheet. I put your code in a module"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 1, "creation_date": 1470841928, "post_id": 38865741, "comment_id": 65115877, "body": "@user1914644 Put the code in worksheet (&quot;SOVI&quot;) code module. If you wanna put it in a module you need change the range reference using <code>With Sheets(&quot;SOVI&quot;) ... End With</code>."}, {"owner": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470842413, "post_id": 38865741, "comment_id": 65116214, "body": "Here <a href=\"https://app.box.com/s/eb8kb6na1amajv53lfztlpt6304qrgkv\" rel=\"nofollow noreferrer\">app.box.com/s/eb8kb6na1amajv53lfztlpt6304qrgkv</a> tried right now put in the SOVI worksheet, but still make a blank new sheet"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470848556, "post_id": 38865741, "comment_id": 65120068, "body": "@user1914644 I think I know the problem. You might forget to disable the filter. Try add this line <code>Sheets(&quot;SOVI&quot;).AutoFilterMode = False</code> between <code>SpeedUp True</code> and <code>Set Sheet_Data = Sheets(&quot;SOVI&quot;)</code>. It should work fine now. By adding that line, you don&#39;t need to disable the filter. Just let me know if there&#39;s still a problem."}], "tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": true, "score": 1, "last_activity_date": 1470810322, "creation_date": 1470810322, "answer_id": 38865741, "question_id": 38863610, "link": "https://stackoverflow.com/questions/38863610/delete-row-if-the-column-contains-text/38865741#38865741", "title": "Delete row if the column contains text", "body": "<p>The following code works less than 4 seconds for processing your sample data on my machine:</p>\n\n<pre><code>Sub QuickDeleteRows()\nDim Sheet_Data As Worksheet, NewSheet_Data As Worksheet, Data As Range\nDim Sheet_Name As String, Text As String, Water As Long, Beer As Long, Vodka As Long\n\nOn Error GoTo Error_Handler\nSpeedUp True\n\nSet Sheet_Data = Sheets(\"SOVI\")\nSheet_Name = Sheet_Data.Name\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nReDim Output(1 To LastRow - 1, 1 To 1) As Long\n\nFor i = 1 To LastRow - 1\n    Text = Cells(i + 1, 13)\n    Water = InStr(Text, \"water\")\n    Beer = InStr(Text, \"beer\")\n    Vodka = InStr(Text, \"vodka\")\n    If Water &gt; 0 Or Beer &gt; 0 Or Vodka &gt; 0 Then Output(i, 1) = 1\nNext\n[S2].Resize(LastRow - 1, 1) = Output\n\nLastColumn = Cells(2, Columns.Count).End(xlToLeft).Column\n\nSet Data = Sheet_Data.Range(Cells(1, 1), Cells(LastRow, LastColumn))\n\nSet NewSheet_Data = Sheets.Add(After:=Sheet_Data)\n\nData.AutoFilter Field:=19, Criteria1:=\"=1\"\nData.Copy\n\nWith NewSheet_Data.Cells\n    .PasteSpecial xlPasteColumnWidths\n    .PasteSpecial xlPasteAll\n    .Cells(1, 1).Select\n    .Cells(1, 1).Copy\nEnd With\n\nSheet_Data.Delete\nNewSheet_Data.Name = Sheet_Name\nNewSheet_Data.Columns(19).Clear\n\nSafe_Exit:\n    SpeedUp False\n    Exit Sub\nError_Handler:\n    Resume Safe_Exit\nEnd Sub\n\nSub SpeedUp(SpeedUpOn As Boolean)\nWith Application\n    If SpeedUpOn Then\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n        .DisplayStatusBar = False\n        .DisplayAlerts = False\n    Else\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n        .DisplayStatusBar = True\n        .DisplayAlerts = True\n    End If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470842156, "post_id": 38866179, "comment_id": 65116043, "body": "Thank you very much s2 I tried to put your code in a module and run the code, but i got <code>Run-time error </code>9<code>:  Subscript out of range</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470843191, "post_id": 38866179, "comment_id": 65116821, "body": "which line throws that error? have you changed &quot;test&quot; and &quot;SOVI&quot; with your actual workbook and worksheet names?"}, {"owner": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470843704, "post_id": 38866179, "comment_id": 65117165, "body": "yes. testing the code in same file here. This line: <code>With Workbooks(&quot;test&quot;).Worksheets(&quot;SOVI&quot;).Range(&quot;A1&quot;).CurrentRegi&zwnj;&#8203;on &#39;&lt;--| this gets the range of all contiguous cells to &quot;A1&quot;</code> And run the code in Module1"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470844752, "post_id": 38866179, "comment_id": 65117857, "body": "that error in that line means that when the macro runs either you don&#39;t have any open workbook named &quot;test&quot; or this latter has no worksheet named &quot;SOVI&quot;"}, {"owner": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470849213, "post_id": 38866179, "comment_id": 65120465, "body": "That strange. Here the Photo of the visual editor <a href=\"https://app.box.com/s/v113tdlk5qezzvwogsui6m0klijgc2l9\" rel=\"nofollow noreferrer\">app.box.com/s/v113tdlk5qezzvwogsui6m0klijgc2l9</a>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1470851205, "post_id": 38866179, "comment_id": 65121535, "body": "strange indeed. I replicated the very same condition of yours, but no error on that line. Try typing in the Immediate Window: <code>?Workbooks(&quot;test&quot;).Name</code> and press return. And then the same with <code>?Worksheets(&quot;SOVI&quot;).Name</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "edited": false, "score": 0, "creation_date": 1471936193, "post_id": 38866179, "comment_id": 65536083, "body": "@user1914644: did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1470811818, "creation_date": 1470811818, "answer_id": 38866179, "question_id": 38863610, "link": "https://stackoverflow.com/questions/38863610/delete-row-if-the-column-contains-text/38866179#38866179", "title": "Delete row if the column contains text", "body": "<p>use excel built in filtering functions for the maximum speed</p>\n\n<p><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow\">Autofilter</a></strong></p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim keysToErase As Variant, key As Variant\n\n    keysToErase = Array(\"water\", \"beer\", \"vodka\") '&lt;--| list your keywords to delete matching column \"M\" rows with\n\n    Application.DisplayAlerts = False '&lt;--| prevent alerts dialog box from appearing at every rows deletion\n    With Workbooks(\"test\").Worksheets(\"SOVI\").Range(\"A1\").CurrentRegion '&lt;--| this gets the range of all contiguous cells to \"A1\"\n        For Each key In keysToErase '&lt;--| loop through keys\n            .AutoFilter field:=13, Criteria1:=\"*\" &amp; key &amp; \"*\" '&lt;--| filter column \"M\" with key\n            If Application.WorksheetFunction.Subtotal(103, .Cells.Resize(, 1)) &gt; 1 Then .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Delete '&lt;--| delete filtered cells, if any\n        Next key\n        .Parent.ShowAllData '&lt;--| .. show all rows back...\n    End With\n    Application.DisplayAlerts = True '&lt;--| allow alerts dialog box back\nEnd Sub\n</code></pre>\n\n<p><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff841242.aspx\" rel=\"nofollow\">AdvancedFilter</a></strong></p>\n\n<pre><code>Option Explicit\n\nSub main2()\n    Application.DisplayAlerts = False '&lt;--| prevent alerts dialog box from appearing at every rows deletion\n    With Workbooks(\"test\").Worksheets(\"SOVI\").Range(\"A1\").CurrentRegion '&lt;--| this gets the range of all contiguous cells to \"A1\"\n        .AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=.Parent.Range(\"U1:U4\") '&lt;--| this filters on all keys you placed in cells \"U2:U4\" with cell \"U1\" with wanted data header\n        If Application.WorksheetFunction.Subtotal(103, .Cells.Resize(, 1)) &gt; 1 Then .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Delete '&lt;--| delete filtered cells, if any\n        .Parent.ShowAllData '&lt;--| .. show all rows back...\n    End With\n    Application.DisplayAlerts = True '&lt;--| allow alerts dialog box back\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1470813720, "creation_date": 1470813720, "answer_id": 38866707, "question_id": 38863610, "link": "https://stackoverflow.com/questions/38863610/delete-row-if-the-column-contains-text/38866707#38866707", "title": "Delete row if the column contains text", "body": "<p>Try with Below code</p>\n\n<pre><code>Sub test()\n    Application.DisplayAlerts = False\n    Dim lastrow As Long\n    Dim i As Long\n    Dim currentrng As Range\n    lastrow = Range(\"M\" &amp; Rows.Count).End(xlUp).Row\n    For i = lastrow To 2 Step -1\n        Set currentrng = Range(\"M\" &amp; i)\n        If ((currentrng Like \"*water*\") Or (currentrng Like \"*beer*\") Or (currentrng Like \"*vodka*\")) Then\n            currentrng.EntireRow.Delete shift:=xlUp\n        End If\n    Next i\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 1914644, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1a89bab97111a695102cd6e38319727?s=128&d=identicon&r=PG&f=1", "display_name": "user1914644", "link": "https://stackoverflow.com/users/1914644/user1914644"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 38865741, "answer_count": 5, "score": 0, "last_activity_date": 1470843478, "creation_date": 1470798445, "last_edit_date": 1470798807, "question_id": 38863610, "link": "https://stackoverflow.com/questions/38863610/delete-row-if-the-column-contains-text", "title": "Delete row if the column contains text", "body": "<p>I known, this question has been asked thousands of times. But every time I picked up a solution appears error when i debug. (error 1004)</p>\n\n<p>I work with a database with about 300000 lines, where more than half do not care. (I know that have  filter, but wanted to erase to reduce the file and speed up the process).</p>\n\n<p>Then if the column M has a keyword like \"water\", \"beer\" or \"vodka\" it will delete the row. I mean, don't need to be the exact word, just the keyword.</p>\n\n<p>OBS: Row 1 it's a table title with the frozen line.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "cell"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1470797948, "post_id": 38863510, "comment_id": 65090420, "body": "Functions used as a UDF can only return a value - by themselves they cannot change anything else about the cells they&#39;re called from or other cells."}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1470798576, "post_id": 38863510, "comment_id": 65090542, "body": "No other way around this? This seems like a massive, and very odd flaw in the application of VBA. There may be a good reason but it seems like an inconsistency in the way VBA treats the range object."}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1470798770, "post_id": 38863510, "comment_id": 65090565, "body": "Could I call a separate sub that does this outside of the function? Or could I approach this from any other way? I&#39;m guessing that this may be to do with the continuous updating that Excel does when the source cell changes value."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1470800172, "post_id": 38863510, "comment_id": 65090851, "body": "Here&#39;s an approach which seems to be usable, but you will need to test to make sure it doesn&#39;t have any unintended consequences:  <a href=\"http://stackoverflow.com/questions/23433096/using-a-udf-in-excel-to-update-the-worksheet/23437280#23437280\" title=\"using a udf in excel to update the worksheet\">stackoverflow.com/questions/23433096/&hellip;</a>"}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1470805543, "post_id": 38863510, "comment_id": 65092361, "body": "@TimWilliams our link is great. A few notes, you can&#39;t use application caller presumably as that refers to other aspects of the sheet and a self-cell reference when used as in the example creates a circular reference which freezes Excel"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1470807281, "post_id": 38863510, "comment_id": 65092936, "body": "If you need to refer to the calling cell (eg using <code>Application.Caller</code> or <code>Application.ThisCell</code>) then you can do that in the UDF itself, and pass the address as an argument to the code called using <code>Evaluate</code>.  To be safe it&#39;s best to have the UDF return a value to the calling cell, and not have the Evaluate&#39;d code update that cell, or you might well end up in a loop."}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1470807739, "post_id": 38863510, "comment_id": 65093105, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/120565/discussion-between-aer-and-tim-williams\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 1926668, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0ad08bfaa7da0a7c9f4e610d9cb7d22?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1926668/andy"}, "edited": false, "score": 0, "creation_date": 1554686129, "post_id": 38865140, "comment_id": 97829741, "body": "Am I right, it isn&#39;t possible to use this technique to return a value and format this value directly? (e.g. generating text as return value of the function and directly format some words in this text with bold/italic/underline) If this isn&#39;t possible, what would be the best workaround for this?"}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "reply_to_user": {"reputation": 89, "user_id": 1926668, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0ad08bfaa7da0a7c9f4e610d9cb7d22?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1926668/andy"}, "edited": false, "score": 0, "creation_date": 1554686448, "post_id": 38865140, "comment_id": 97829798, "body": "@Andy what do you mean by directly &quot;directly&quot;? I got this working 3 years ago, the color copied across, and the value was taken across as well. I used it for marking dodgy answers red and propagating that warning across spreadsheets."}, {"owner": {"reputation": 89, "user_id": 1926668, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0ad08bfaa7da0a7c9f4e610d9cb7d22?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1926668/andy"}, "edited": false, "score": 0, "creation_date": 1554687056, "post_id": 38865140, "comment_id": 97829892, "body": "With &quot;directly&quot; I mean, that the function is returning/building a larger string and I want to format some words of this string and return it to the cell where the formula is stored.  Like: &quot;This <b>is</b> a <i>test</i> string.&quot; Or in other words: Returning text with some formatted words in it."}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "reply_to_user": {"reputation": 89, "user_id": 1926668, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0ad08bfaa7da0a7c9f4e610d9cb7d22?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1926668/andy"}, "edited": false, "score": 0, "creation_date": 1554687568, "post_id": 38865140, "comment_id": 97829986, "body": "@Andy I see, haven&#39;t tried that. As you say, you can&#39;t format the string directly. This uses a source cell format and copies that across. You could try recording a macro and see how text is formatted directly and put that in the <code>Evaluate</code> as that is the only way to &quot;sneak&quot; in formatting."}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "reply_to_user": {"reputation": 89, "user_id": 1926668, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0ad08bfaa7da0a7c9f4e610d9cb7d22?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1926668/andy"}, "edited": false, "score": 0, "creation_date": 1554687579, "post_id": 38865140, "comment_id": 97829989, "body": "Otherwise I&#39;m not sure sorry"}, {"owner": {"reputation": 89, "user_id": 1926668, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0ad08bfaa7da0a7c9f4e610d9cb7d22?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1926668/andy"}, "edited": false, "score": 0, "creation_date": 1554687931, "post_id": 38865140, "comment_id": 97830037, "body": "Basically it would work like this: <a href=\"https://stackoverflow.com/questions/11644566/excel-vba-set-bold-specific-text-of-string-into-the-cell\" title=\"excel vba set bold specific text of string into the cell\">stackoverflow.com/questions/11644566/&hellip;</a> but as it is a return-value, the solution (if it exists) must return the string AND then &quot;trigger&quot; the formatting sub. I&#39;ll try it together with <a href=\"https://support.microsoft.com/en-us/help/213612/how-to-run-a-macro-when-certain-cells-change-in-excel\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/213612/&hellip;</a> and a dynamic named range which covers the cells with the formula."}, {"owner": {"reputation": 89, "user_id": 1926668, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0ad08bfaa7da0a7c9f4e610d9cb7d22?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1926668/andy"}, "edited": false, "score": 1, "creation_date": 1554689703, "post_id": 38865140, "comment_id": 97830323, "body": "Remark: Worksheet_Change isn&#39;t working when the result of a formula is updating. It looks like Worksheet_Calculate should be used (see <a href=\"https://www.extendoffice.com/documents/excel/4618-excel-vba-run-macro-when-cell-formula-result-changes.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "is_accepted": false, "score": 1, "last_activity_date": 1470808444, "last_edit_date": 1495535246, "creation_date": 1470807972, "answer_id": 38865140, "question_id": 38863510, "link": "https://stackoverflow.com/questions/38863510/how-to-create-a-vba-formula-that-takes-value-and-format-from-source-cell/38865140#38865140", "title": "How to create a VBA formula that takes value and format from source cell", "body": "<p>This is the solution I found to the above question using Tim William's <a href=\"https://stackoverflow.com/questions/23433096/using-a-udf-in-excel-to-update-the-worksheet/23437280#23437280\">magic</a>:</p>\n\n<pre><code>Function cq(thisCel As Range, srcCel As Range) As Variant\n    thisCel.Parent.Evaluate \"colorEq(\" &amp; srcCel.Address(False, False) _ \n    &amp; \",\" &amp; thisCel.Address(False, False) &amp; \")\"\n    cq = srcCel.Value\nEnd Function\n\nSub colorEq(srcCell, destCell)\n    destCell.Interior.Color = srcCell.Interior.Color\nEnd Sub\n</code></pre>\n\n<p>The <code>destCell</code> is just a cell reference to the cell in which the function is called.</p>\n\n<p>The <code>interior.color</code> can be exchanged or added to with other formatting rules. Three extra points to note in this solution:</p>\n\n<ol>\n<li>By keeping the value calculation in the formula this stops the possibility for circular referencing when it destCell refers to itself. If placed in the <code>sub</code> then it continually recalculates; and</li>\n<li>If the format is only changed when the source value is changed, not the format as this is the only trigger for a UDF to run and thus change the format;</li>\n<li><code>Application.Caller</code> or <code>Application.ThisCell</code> cannot be integrated as when it refers to itself and returns a value for itself it triggers an infinite loop or \"circular reference\" error. If incorporated with an Address to create a string then this works though as per Tim William's answer.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "edited": false, "score": 0, "creation_date": 1470813551, "post_id": 38865154, "comment_id": 65096141, "body": "To use between worksheets and workbooks include that in <code>CopyFormat</code> as Worksheet and Workbook name objects."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1470808501, "last_edit_date": 1470808501, "creation_date": 1470808040, "answer_id": 38865154, "question_id": 38863510, "link": "https://stackoverflow.com/questions/38863510/how-to-create-a-vba-formula-that-takes-value-and-format-from-source-cell/38865154#38865154", "title": "How to create a VBA formula that takes value and format from source cell", "body": "<p>Here's one approach showing how you can still use <code>ThisCell</code>:</p>\n\n<pre><code>Function CopyFormat(rngFrom, rngTo)\n    rngTo.Interior.Color = rngFrom.Interior.Color\n    rngTo.Font.Color = rngFrom.Font.Color\nEnd Function\n\n\n\nFunction formEq(cellRefd As Range) As Variant\n    cellRefd.Parent.Evaluate \"CopyFormat(\" &amp; cellRefd.Address() &amp; \",\" &amp; _\n                         Application.ThisCell.Address() &amp; \")\"\n    formEq = cellRefd.Value\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "accepted_answer_id": 38865154, "answer_count": 2, "score": 1, "last_activity_date": 1597936357, "creation_date": 1470797557, "question_id": 38863510, "link": "https://stackoverflow.com/questions/38863510/how-to-create-a-vba-formula-that-takes-value-and-format-from-source-cell", "title": "How to create a VBA formula that takes value and format from source cell", "body": "<p>In Excel's VBA I want to create a formula which both takes the value from the source cell and the format. </p>\n\n<p>Currently I have:</p>\n\n<pre><code>Function formEq(cellRefd As Range) As Variant\n    'thisBackCol = cellRefd.Interior.Color\n    'With Application.Caller\n    '    .Interior.Color = thisBackCol\n    'End With\n    formEq = cellRefd.Value\nEnd Function`\n</code></pre>\n\n<p>This returns the current value of the cell. The parts that I have commented out return a <code>#VALUE</code> error in the cell. When uncommented it seems the colour of the reference is saved however the <code>Application.Caller</code> returns a 2023 Error. Does this mean that this is not returning the required Range object?</p>\n\n<p>If so how do I get the range object that refers to the cell that the function is used? [obviously in order to set the colour to the source value].</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1470803659, "post_id": 38864298, "comment_id": 65091695, "body": "looks like we posted at same time.. :-)"}, {"owner": {"reputation": 25, "user_id": 6698247, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e799301b8642fb409feeda8c1c2d22be?s=128&d=identicon&r=PG&f=1", "display_name": "RKVALU", "link": "https://stackoverflow.com/users/6698247/rkvalu"}, "edited": false, "score": 0, "creation_date": 1470810090, "post_id": 38864298, "comment_id": 65094178, "body": "also is there a way to alter original subject line in the way we want while replying. Also can we call some of the text from original email to my template. For eg. I have a field call client and my original email also have client can i get the same name to my template file. I know i am asking too many question.."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1470803498, "creation_date": 1470803498, "answer_id": 38864298, "question_id": 38863457, "link": "https://stackoverflow.com/questions/38863457/how-to-add-address-to-cc-field/38864298#38864298", "title": "How to add address to .CC field?", "body": "<p>It's same as what you did for your body.</p>\n\n<pre><code>Sub Reply_Scripting()\nDim origEmail As MailItem\n\nDim replyEmail As MailItem\n\nDim oRespond As Outlook.MailItem\n\nSet origEmail = Application.ActiveWindow.Selection.Item(1)\n\nSet replyEmail = Application.CreateItemFromTemplate(\"C:\\Users\\ashu\\Desktop\\test.oft\")\n\n'/ Add new CC addresses along with existing addresses.\nreplyEmail.CC = origEmail.CC &amp; \";\" &amp; \"a@b.com;c@d.com\"\n\n\nreplyEmail.BodyFormat = olFormatHTML\nreplyEmail.HTMLBody = replyEmail.HTMLBody &amp; origEmail.Reply.HTMLBody\n\nreplyEmail.Display\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1470803520, "creation_date": 1470803520, "answer_id": 38864300, "question_id": 38863457, "link": "https://stackoverflow.com/questions/38863457/how-to-add-address-to-cc-field/38864300#38864300", "title": "How to add address to .CC field?", "body": "<p>Simply add</p>\n\n<pre><code>replyEmail.CC = \"Om3r@email.com\"\n</code></pre>\n\n<p>Example </p>\n\n<pre><code>Sub Reply_Scripting()\n    Dim origEmail As MailItem\n    Dim replyEmail As MailItem\n    Dim oRespond As Outlook.MailItem\n\n    Set origEmail = Application.ActiveWindow.Selection.Item(1)\n    Set replyEmail = Application.CreateItemFromTemplate(\"C:\\Users\\Test.oft\")\n\n    replyEmail.CC = \"Om3r@email.com\"\n\n    replyEmail.HTMLBody = replyEmail.HTMLBody &amp; origEmail.reply.HTMLBody\n    replyEmail.display\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6698247, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e799301b8642fb409feeda8c1c2d22be?s=128&d=identicon&r=PG&f=1", "display_name": "RKVALU", "link": "https://stackoverflow.com/users/6698247/rkvalu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 38864300, "answer_count": 2, "score": 2, "last_activity_date": 1608500623, "creation_date": 1470797135, "last_edit_date": 1608500623, "question_id": 38863457, "link": "https://stackoverflow.com/questions/38863457/how-to-add-address-to-cc-field", "title": "How to add address to .CC field?", "body": "<p>I have working code where I would like to add CC field with preexisting email id's.</p>\n<p>Tried all ways around, but not able to crack the code</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Reply_Scripting()\n\n    Dim origEmail As MailItem\n\n    Dim replyEmail As MailItem\n\n    Dim oRespond As Outlook.MailItem\n\n    Set origEmail = Application.ActiveWindow.Selection.Item(1)\n\n    Set replyEmail = Application.CreateItemFromTemplate(&quot;C:\\Users\\Test.oft&quot;)\n\n    replyEmail.HTMLBody = replyEmail.HTMLBody &amp; origEmail.Reply.HTMLBody\n\n    replyEmail.Display\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1470800701, "creation_date": 1470800701, "answer_id": 38863863, "question_id": 38863450, "link": "https://stackoverflow.com/questions/38863450/vba-delete-all-slides-in-one-go/38863863#38863863", "title": "VBA delete all slides in one go", "body": "<pre><code>Sub Deleteslides()\n\n    Dim Pre As Presentation, arr(), x As Long, n As Long\n    Set Pre = ActivePresentation\n    ReDim arr(0 To Pre.Slides.Count - 2)\n    n = 0\n    For x = Pre.Slides.Count To 2 Step -1\n        arr(n) = x\n        n = n + 1\n    Next x\n    Pre.Slides.Range(arr).Delete\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 203, "user_id": 6283909, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f4183a620c413e01d9061bc2648e5745?s=128&d=identicon&r=PG&f=1", "display_name": "Camille", "link": "https://stackoverflow.com/users/6283909/camille"}, "edited": false, "score": 0, "creation_date": 1470801819, "post_id": 38863883, "comment_id": 65091216, "body": "Yes, This is an option two. I will think about this.Thank you."}], "tags": [], "owner": {"reputation": 100, "user_id": 3123467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pN0WF.jpg?s=128&g=1", "display_name": "JMcD", "link": "https://stackoverflow.com/users/3123467/jmcd"}, "is_accepted": false, "score": 0, "last_activity_date": 1470800855, "creation_date": 1470800855, "answer_id": 38863883, "question_id": 38863450, "link": "https://stackoverflow.com/questions/38863450/vba-delete-all-slides-in-one-go/38863883#38863883", "title": "VBA delete all slides in one go", "body": "<p>Instead of deleting all of your slides, presumably so you can keep your template, why not just save a template and work from that? Have your application close the presentation and open a new one with the template?</p>\n"}], "owner": {"reputation": 203, "user_id": 6283909, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f4183a620c413e01d9061bc2648e5745?s=128&d=identicon&r=PG&f=1", "display_name": "Camille", "link": "https://stackoverflow.com/users/6283909/camille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1794, "favorite_count": 1, "accepted_answer_id": 38863863, "answer_count": 2, "score": 3, "last_activity_date": 1487629786, "creation_date": 1470797083, "question_id": 38863450, "link": "https://stackoverflow.com/questions/38863450/vba-delete-all-slides-in-one-go", "title": "VBA delete all slides in one go", "body": "<p>I have found a piece of code to delete all ppt slides one by one except the the Active one (Index 1). However, can any one help me in re-writing this code to action the code in one hit. I don't want to loop each and every slide as there will be about 300 slides to delete. This is the code I have:</p>\n\n<pre><code>Sub Deleteslides()\n\n'This deletes all slides except Active Main one.\n\nDim Pre As Presentation\nSet Pre = ActivePresentation\nDim x As Long\nFor x = Pre.Slides.Count To 2 Step -1\n    Pre.Slides(x).delete\nNext x\n\nEnd Sub\n</code></pre>\n"}]