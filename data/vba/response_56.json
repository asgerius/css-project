[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1454547003, "post_id": 35190123, "comment_id": 58098324, "body": "Add <code>Erase Myarray</code> after loading it into myarray2."}], "answers": [{"tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 1, "last_activity_date": 1454575965, "creation_date": 1454575965, "answer_id": 35196423, "question_id": 35190123, "link": "https://stackoverflow.com/questions/35190123/combine-values-from-different-rows-into-single-row/35196423#35196423", "title": "combine values from different rows into single row", "body": "<p>Taking @ScottCarner suggestion, i have shuffled your code and tried, it worked fine.</p>\n\n<pre><code>Sub sprt()\n\n    Dim h As Integer\n    Dim i As Integer\n    Dim j As Integer\n    Dim a As Integer\n    Dim b As Integer\n    Dim MyArray(8) As String\n    Dim MyArray2(100, 8) As String\n    a = 0\n    b = 0\n    Sheets(\"Sheet2\").Activate\n    For i = 1 To 28\n\n        If i = 1 Then b = 1\n        If i &gt; 1 Then\n            If Cells(i, 1) &lt;&gt; Cells(i - 1, 1) Then\n                b = b + 1\n                Erase MyArray\n            End If\n        End If\n\n        For j = 1 To 7\n\n            If Cells(i, j) &lt;&gt; \"\" Then\n                MyArray(j) = Cells(i, j).Value\n            End If\n\n        Next\n\n        For j = 1 To 7\n            MyArray2(b, j) = MyArray(j)\n        Next\n    Next\n\n    For i = 1 To b\n        For j = 1 To 7\n            a = 10\n            Cells(i, j + a) = MyArray2(i, j)\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5878495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e222cff8d0ae67d49f3a4bec70cf34d3?s=128&d=identicon&r=PG&f=1", "display_name": "pcam001", "link": "https://stackoverflow.com/users/5878495/pcam001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454575965, "creation_date": 1454543988, "last_edit_date": 1531164843, "question_id": 35190123, "link": "https://stackoverflow.com/questions/35190123/combine-values-from-different-rows-into-single-row", "title": "combine values from different rows into single row", "body": "<p>I'm combining multiple rows into a single row based on a value in the far left column.\nThis is the table I'm working with: </p>\n\n<pre><code>Example1    1   2                   1\nExample1    1   2   3               2\nExample1            3   4           3\nExample1                4   5       4\nExample1    2               5   6   5\nExample1                        6   6\nExample1                            7\nExample2    7   8                   8\nExample2        8   9               9\nExample2            9   10          10\nExample2                10  11      11\nExample2                    11  12  12\nExample2                        12  13\nExample2                            14\nExample2                            15\nExample2                            16\nExample2                            17\nExample3                            18\nExample4    13  14                  19\nExample4        14  15              20\nExample4            15  16          21\nExample4                16  17      22\nExample4                    17  18  23\nExample4                        18  24\nExample4                            25\nExample4                            26\nExample4                            27\nExample4                            28\n</code></pre>\n\n<p>Here is what I'm getting: </p>\n\n<pre><code>Example1        2   3   4   5   6\nExample2        8   9   10  11  12\nExample3        8   9   10  11  12\nExample4        14  15  16  17  18\n</code></pre>\n\n<p>Here's what I want:</p>\n\n<pre><code>Example1        2   3   4   5   6\nExample2        8   9   10  11  12\nExample3                        \nExample4        14  15  16  17  18\n</code></pre>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub sprt()\n\n    Dim h As Integer\n    Dim i As Integer\n    Dim j As Integer\n    Dim a As Integer\n    Dim b As Integer\n    Dim MyArray(8) As String\n    Dim MyArray2(100, 8) As String\n\n    a = 0\n    b = 0\n\n    For i = 1 To 28\n    For j = 1 To 7\n\n    Sheets(\"Sheet6\").Activate\n\n    If Cells(i, j) &lt;&gt; \"\" Then\n        MyArray(j) = Cells(i, j).value\n    End If\n\n    Next\n\n    If i = 1 Then b = 1\n\n    If i &gt; 1 Then\n\n    If Cells(i, 1) &lt;&gt; Cells(i - 1, 1) Then b = b + 1\n\n    End If\n\n    For j = 1 To 7\n        MyArray2(b, j) = MyArray(j)\n\n    Next\n\n    Next\n    For i = 1 To b\n\n    For j = 1 To 7\n\n    a = 10\n\n    Cells(i, j + a) = MyArray2(i, j)\n\n    Next\n\n    Next \n</code></pre>\n\n<p>What can I change to get the result I want? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1454542583, "post_id": 35189789, "comment_id": 58096816, "body": "Look into the <code>worksheet_change</code> event then you won&#39;t need to lock/protect the worksheet. You can simply prevent changes made to your header row."}, {"owner": {"reputation": 21, "user_id": 5880451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6639b61aa6fec4bdbf01110df08f2ffd?s=128&d=identicon&r=PG&f=1", "display_name": "Travo", "link": "https://stackoverflow.com/users/5880451/travo"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1454605885, "post_id": 35189789, "comment_id": 58129891, "body": "I like this idea the only issue is that I pretty much need the document to stay protected to prevent anyone from copy-pasting Data Validation. I am looking for a solution that works while the document is protected."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5880451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6639b61aa6fec4bdbf01110df08f2ffd?s=128&d=identicon&r=PG&f=1", "display_name": "Travo", "link": "https://stackoverflow.com/users/5880451/travo"}, "edited": false, "score": 0, "creation_date": 1454597515, "post_id": 35189942, "comment_id": 58123876, "body": "I like this idea! However, the sheet unfortunately still needs to stay protected, I have Data Validation lists (drop-down options) on cells and protected sheet prevents people from copy-pasting this data to other cells (I dont want the list to override another list). So maybe if you know how to prevent this as well that could work. I still like this semi-solution and actually will use this for another project of mine, but I am curious if you know a way to do this while keeping the sheet protected?"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1454542966, "creation_date": 1454542966, "answer_id": 35189942, "question_id": 35189789, "link": "https://stackoverflow.com/questions/35189789/i-need-to-be-able-to-sort-a-protected-worksheet-that-has-locked-column-headers-i/35189942#35189942", "title": "I need to be able to sort a protected worksheet that has locked column headers in excel (VBA)", "body": "<p>If you already use VBA, you can plug this code into the Sheet module. This assumes the headers are in row 1. Change to suit. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"1:1\")) Is Nothing Then\n        Application.EnableEvents = False\n        Application.Undo\n        Application.EnableEvents = True\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>The sheet now does not need to be protected. </p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5880451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6639b61aa6fec4bdbf01110df08f2ffd?s=128&d=identicon&r=PG&f=1", "display_name": "Travo", "link": "https://stackoverflow.com/users/5880451/travo"}, "edited": false, "score": 0, "creation_date": 1454597852, "post_id": 35190138, "comment_id": 58124127, "body": "Hm, the only issue with this is that if I disallow the selection of unlocked cells then how will anyone enter in data? It is only the first row (column headers) that I do not want users to change."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 21, "user_id": 5880451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6639b61aa6fec4bdbf01110df08f2ffd?s=128&d=identicon&r=PG&f=1", "display_name": "Travo", "link": "https://stackoverflow.com/users/5880451/travo"}, "edited": false, "score": 0, "creation_date": 1454611691, "post_id": 35190138, "comment_id": 58133567, "body": "Then I&#39;d suggest keeping the cells unlocked and allow selection of the unlocked cells, tap into the <code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</code> or <code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)</code> to prevent selection of the headers."}, {"owner": {"reputation": 21, "user_id": 5880451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6639b61aa6fec4bdbf01110df08f2ffd?s=128&d=identicon&r=PG&f=1", "display_name": "Travo", "link": "https://stackoverflow.com/users/5880451/travo"}, "edited": false, "score": 0, "creation_date": 1454618863, "post_id": 35190138, "comment_id": 58137767, "body": "Do you know if there is a way to make an entire row un-selectable even though the cells are unlocked?"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 21, "user_id": 5880451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6639b61aa6fec4bdbf01110df08f2ffd?s=128&d=identicon&r=PG&f=1", "display_name": "Travo", "link": "https://stackoverflow.com/users/5880451/travo"}, "edited": false, "score": 0, "creation_date": 1454619950, "post_id": 35190138, "comment_id": 58138371, "body": "Not as far as I know with the built in function. I&#39;ve added code which disallows selection of the first row by code."}], "tags": [], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "is_accepted": false, "score": 0, "last_activity_date": 1454620897, "last_edit_date": 1454620897, "creation_date": 1454544045, "answer_id": 35190138, "question_id": 35189789, "link": "https://stackoverflow.com/questions/35189789/i-need-to-be-able-to-sort-a-protected-worksheet-that-has-locked-column-headers-i/35190138#35190138", "title": "I need to be able to sort a protected worksheet that has locked column headers in excel (VBA)", "body": "<p>Borrowing a bit from @Teylyn's and adapted it to disallow selection of the header row, when it is selected, it selects the cell below it directly and displays an error message. The code sits in the sheet module, if it needs to be applied to more sheets, it may be better to use <code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)</code>, in that case, replace all instances of <code>Me</code> with <code>Sh</code> in the code below.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(\"1:1\")) Is Nothing Then\n        Target.Offset(1, 0).Select\n        MsgBox \"You cannot select or edit the headerrow, please use the autofilter button to sort and filter.\", vbCritical, \"Invalid Selection\"\n    End If\nEnd Sub\n</code></pre>\n\n<h2>Note</h2>\n\n<p>Unlocking the cells which is required for the sorting and then allowing unlocked cells to be selected when protecting the worksheet, which is needed to be able to edit the data, makes the worksheet protection effectively useless.<br>\nAlso wit the code above, there is still a loophole through which cells can be edited. If you select an allowed cell, drag it to the header row, and choose to replace the data in the cell then the header cell to which the allowed cell was moved is selected and editable.</p>\n\n<h2>End of note</h2>\n\n<hr>\n\n<p>Select the data range which needs to be sorted and unlock the cells.</p>\n\n<p>When protecting the worksheet, be sure to allow</p>\n\n<ul>\n<li>sort</li>\n<li>autofilter</li>\n</ul>\n\n<p>To prevent users from changing the cell contents, disallow the selection of unlocked cells.</p>\n"}], "owner": {"reputation": 21, "user_id": 5880451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6639b61aa6fec4bdbf01110df08f2ffd?s=128&d=identicon&r=PG&f=1", "display_name": "Travo", "link": "https://stackoverflow.com/users/5880451/travo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1260, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1455246691, "creation_date": 1454542215, "last_edit_date": 1455246691, "question_id": 35189789, "link": "https://stackoverflow.com/questions/35189789/i-need-to-be-able-to-sort-a-protected-worksheet-that-has-locked-column-headers-i", "title": "I need to be able to sort a protected worksheet that has locked column headers in excel (VBA)", "body": "<p>I am working on an excel document at the moment and everything is turning out quite nicely. However, I am coming down to the very last issue that I am having a problem resolving: being able to sort my columns in ascending/descending order while the worksheet is protected and the column headers are locked. I will state some facts about my worksheet first, the goal that I am trying to accomplish, then possible solutions that I have researched and why those solutions do not seem to apply to my situation.</p>\n\n<ol>\n<li>First, I am <strong>NOT</strong> using an excel table object (just plain\nrows/columns).</li>\n<li>The top row has AutoFilter applied (to work as column headers).</li>\n<li>All of the cells in the worksheet are unlocked, <strong>EXCEPT</strong> for the\nentire first row which is locked (aka, the column headers).</li>\n<li>The worksheet will be protected.</li>\n<li>I do NOT want users to be able to edit data in the first row (this\nis important, these must not be editable no matter what).</li>\n<li>For my protected sheet settings, I have \"Select locked\ncells\",\"Select unlocked cells\",\"Insert rows\",\"Delete rows\",\"Sort\",\nand \"AutoFilter\" checked.</li>\n<li>I am using VBA for my worksheet.</li>\n<li>I am using Excel 2013</li>\n</ol>\n\n<p>Now, assuming the worksheet is protected, users are currently able to use the AutoFilter at the top to actually \"filter\" the data as intended. The issue is whenever they try to \"sort\" the data in ascending/descending order that I get an error saying that you must unprotect the sheet first.</p>\n\n<p>After researching I have seen that this is due to the fact that when you sort, the AutoFilter automatically counts the column header as part of the range being sorted... but because this column header (row 1) is locked, it is causing this error. However, this row HAS to be locked, my VBA code specifically reads the values in these column headers and under no circumstances can they be changed.</p>\n\n<p>So filtering works just fine, it is just the sorting I am trying to figure out now. My \"ideal\" solution would be to somehow capture an event when a user clicks on the AutoFilter arrow and selects \"Sort\" where I can then, in VBA, unprotect the sheet, sort according to their selection, then protect the sheet again. However, again upon research, it seems that there really isn't an option when it comes to an event for this AutoFilter button (I could be wrong, sometimes it can be confusing reading other's suggestions).</p>\n\n<p>I am hoping someone out there can help me out with this situation, I would also LIKE to avoid using an excel table object, however if it is the only solution that works that meets all my above criteria then so-be-it.</p>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["vba", "excel", "email", "loops"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1454541587, "post_id": 35189627, "comment_id": 58096447, "body": "Google <code>for</code> loop and <code>lastrow</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4800942, "user_type": "registered", "profile_image": "https://graph.facebook.com/932617026789531/picture?type=large", "display_name": "Dan TheMan", "link": "https://stackoverflow.com/users/4800942/dan-theman"}, "edited": false, "score": 0, "creation_date": 1454547268, "post_id": 35190140, "comment_id": 58098412, "body": "tried this and it gave me an run time error 91 and highlighted the row                     &quot;  .To = &quot;dan***@yahoo.com&quot;   &quot;   Strangely the first time i run the code it will send an email, as it did before the addition (only running the first row) but will give the error and will not send another email the next time i run the code without restarting vba.  tried googling the issue, but admittedly dont really know what im doing. most of this code is copy paste from other folks. Appreciate the help up to this point and any other help you can offer.   Thanks"}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 1, "user_id": 4800942, "user_type": "registered", "profile_image": "https://graph.facebook.com/932617026789531/picture?type=large", "display_name": "Dan TheMan", "link": "https://stackoverflow.com/users/4800942/dan-theman"}, "edited": false, "score": 0, "creation_date": 1454601261, "post_id": 35190140, "comment_id": 58126731, "body": "Update your question with the code as it exists now. An error 91 indicates cdomsg is no longer defined. You can try putting the line &quot;Set cdomsg = nothing&quot; outside the loop and see if that solves it."}, {"owner": {"reputation": 1, "user_id": 4800942, "user_type": "registered", "profile_image": "https://graph.facebook.com/932617026789531/picture?type=large", "display_name": "Dan TheMan", "link": "https://stackoverflow.com/users/4800942/dan-theman"}, "edited": false, "score": 0, "creation_date": 1454716977, "post_id": 35190140, "comment_id": 58185903, "body": "Not sure what happened, but left the cdomsg in the loop and it ran no hiccups, looped like a hot wheel track :) THanks a million for the help!! I can update the working code if any one wants let me know"}], "tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": false, "score": 0, "last_activity_date": 1454544054, "creation_date": 1454544054, "answer_id": 35190140, "question_id": 35189627, "link": "https://stackoverflow.com/questions/35189627/looping-an-if-and-then-statement-with-automated-email-in-vba-ms-excel/35190140#35190140", "title": "Looping an &quot;If..And...Then...&quot; statement with automated email in VBA MS Excel", "body": "<p>You need to create variables for the rows (and columns if needed) and then a loop to process. </p>\n\n<pre><code>dim row as integer\nrow = 2\nwhile cells(row, 1) &lt;&gt; \"\"\n    INSERT YOUR CODE HERE, REPLACE HARD CODED ROW #S WITH VARIABLE \"row\"\n    e.g. if cells(row, 2) + 5...\n    row = row + 1\nwend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4800942, "user_type": "registered", "profile_image": "https://graph.facebook.com/932617026789531/picture?type=large", "display_name": "Dan TheMan", "link": "https://stackoverflow.com/users/4800942/dan-theman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1454544054, "creation_date": 1454541428, "question_id": 35189627, "link": "https://stackoverflow.com/questions/35189627/looping-an-if-and-then-statement-with-automated-email-in-vba-ms-excel", "title": "Looping an &quot;If..And...Then...&quot; statement with automated email in VBA MS Excel", "body": "<p>I'm very new to coding on any platform and have been working hard to get this code up and running. I have a conditional statement that is attached to an automatic email function that sends an email if the condition is met. This portion of the code works, but only for the row of the spreadsheet the code is specific to (row 2). I need it to cycle through all available rows and create a specific email for each row where the condition is met. Here is the code I have</p>\n\n<pre><code>Sub macro1() 'prelim dictation\n\nSet cdomsg = CreateObject(\"CDO.message\")\nWith cdomsg.Configuration.Fields\n.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2 'NTLM method\n.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.gmail.com\"\n.Item(\"http://schemas.microsoft.com/cdo/configuration/smptserverport\") = 587\n.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = 1\n.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = True\n.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpconnectiontimeout\") = 60\n.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"imcool@gmail.com\"\n .Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"imcoolpasscode\"\n .Update\n    End With\n\n    If Cells(2, 2) + 5 &lt;= Cells(2, 17) And Cells(2, 4) = \"INCOMPLETE\" Then\nWith cdomsg\n.To = \"danielcarnam@yahoo.com\"\n.From = \"danielcarnam@gmail.com\"\n.Subject = \"Work to be done\"\n.TextBody = Cells(2, 1) &amp; Space(3) &amp; Cells(1, 3)\n.Send\nEnd With\nSet cdomsg = Nothing\nElse\nEnd If\nEnd Sub\n\n\n\n   A         B     C(x1)     D        E(x2)        F         ............. Q\n 1  Patient  Date       \"Incomplete\"       \"Incomplete\"             =TODAY()\n 2  John Doe 1/25       \"Incomplete\"       \"Incomplete\"\n 3  Jane Doe 1/30       \"Incomplete\"       \"Incomplete\"\n.\n.\n</code></pre>\n\n<p>Above is an example of my spreadsheet.\nWhen the portion of the report is completed I enter that date into column \"C\" and column \"D\" changes to \"complete\". Essentially what my code says is, If todays date is within 5 days of date of service (B2), and column D is \"incomplete\", Then send an email, where the text body is the patients name and the title of column D (\"x1\") (Cells 1,3). The code will have 10+ sections for each patient (Expanding out similar to columns E and F) and at least 30 patients per month. I need a code that loops through the patients to the end of the list and sends a correlating email (patients name and specific section of the report thats delayed (x1,x2...) when conditions are met. \nSo far i have written three sperate modules for each section (x1,x2,x3) and a master to run them all at once. a secondary question i would like to ask is if i can place them all in one module so that i dont crash the computer or have to run the code for an hour to get results. \nI apologize for the length of my query, but i couldnt figure out how to word it more briefly. Any help is hugely appreciated and ill of course be happy to answer any questions you may have. Thanks a million. \n-Dan</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1454540937, "post_id": 35189246, "comment_id": 58096207, "body": "Couldn&#39;t you anchor it, <code>!$C$5</code>? Or does that still change when a new row is added?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454541869, "post_id": 35189246, "comment_id": 58096544, "body": "You only have to do the song and dance about <code>formula to constant &#47; constant back to formula</code> once, to break the column formula."}], "answers": [{"comments": [{"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1454594790, "post_id": 35189822, "comment_id": 58121903, "body": "What about the status column?  It will still need to pull the status from the new sheet..."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1454617505, "last_edit_date": 1454617505, "creation_date": 1454542376, "answer_id": 35189822, "question_id": 35189246, "link": "https://stackoverflow.com/questions/35189246/unique-formulas-in-table-managed-by-code/35189822#35189822", "title": "Unique formulas in table managed by code", "body": "<p>Why don't you add another column where the sheet name is entered.</p>\n\n<p>Then create a formula that references the column in the hyperlink function. When you add a new row, you only need to add the sheet name in the sheet name column. The Excel Table default behavior is to apply formulas to new rows. </p>\n\n<pre><code>=HYPERLINK(INDIRECT(\"'\"&amp;A2&amp;\"'!A1\"),INDIRECT(\"'\"&amp;A2&amp;\"'!C5\"))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KICUn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KICUn.png\" alt=\"![enter image description here\"></a></p>\n\n<p>The VBA code now just needs to add a value in a new row and populate the \"sheet\" column with the sheet name and you don't need to edit the formula at all. </p>\n\n<p>Edit: On the other hand: If the behavior of an Excel Table is causing problems, why do you want to use a table at all? If you don't use a table, there won't be errors. If you are setting the formulas for each row with VBA, then just us a regular range, not a table. </p>\n"}], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454617505, "creation_date": 1454539513, "question_id": 35189246, "link": "https://stackoverflow.com/questions/35189246/unique-formulas-in-table-managed-by-code", "title": "Unique formulas in table managed by code", "body": "<p>I have a workbook with an \"Index\" sheet/tab that maintains a list of all projects tracked in the workbook.  Each project has its own tab.  I'm attempting to manage this programmatically with VBA using the following code:</p>\n\n<pre><code>Dim template As Worksheet\nDim newSheet As Worksheet\nDim newName As String\n\n\nnewName = Application.InputBox(\"Enter Project Name\")        'get name\nWorksheets(\"P0\").Visible = True                             'Unhide template\nSet template = ActiveWorkbook.Sheets(\"P0\")                  'identify template\ntemplate.Copy After:=Sheets(Sheets.Count)                   'create copy\nSet newSheet = ActiveSheet                                  'identify new sheet\nnewSheet.Name = newName                                     'rename sheet\n'deleteNames (newSheet.Name)                                'delete copied named ranges with worksheet scope\nnewSheet.Range(\"C5\").Value = newName                        'Change header on new sheet\nWorksheets(\"P0\").Visible = False                            'Hide template\nWorksheets(\"Dashboard\").Activate                            'switch back to dashboard\n\nDim Tbl As ListObject\nDim StrFormula1, StrFormula2 As String\nDim NewRow As ListRow\nStrFormula1 = \"=HYPERLINK(\"\"#'\" &amp; newName &amp; \"'!A1\"\",'\" &amp; newName &amp; \"'!C5)\"\nStrFormula2 = \"='\" &amp; newName &amp; \"'!C18\"\n\nSet Tbl = Range(\"tblProjects\").ListObject\nSet NewRow = Tbl.ListRows.Add(AlwaysInsert:=True)\nNewRow.Range = Array(StrFormula1, StrFormula2)\n</code></pre>\n\n<p>The probelm is the last line.  It works great the first time. It creates a new row with a formula like this:</p>\n\n<p><code>=HYPERLINK(\"#'Test Project'!A1\",'Test Project'!C5)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/Vyar9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vyar9.png\" alt=\"enter image description here\"></a></p>\n\n<p>But when I add a second one, it changes the previous row:</p>\n\n<p><code>=HYPERLINK(\"#'Another Project'!A1\",'Another Project'!C4)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/xbfmY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xbfmY.png\" alt=\"enter image description here\"></a></p>\n\n<p><strike>It should</strike> I would like it to still be referencing cell C5.  Someone said I could \"enter a constant into one cell of the column. Now change the formula in another cell of the column. Change the first cell back to its original formula.\" but I'm hoping for a cleaner solution.  Is there a setting or something to disable this behavior?</p>\n\n<p>I need (would like) it to be a table so I can easily sort and filter and eventually add functionality to delete projects or manipulate the table in other ways. </p>\n"}, {"tags": ["python", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7729, "user_id": 4718350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-CxgNhC_5nUE/AAAAAAAAAAI/AAAAAAAAP78/9FTapxcd2dY/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/4718350/chris"}, "is_accepted": true, "score": 0, "last_activity_date": 1454538235, "creation_date": 1454538235, "answer_id": 35188940, "question_id": 35188839, "link": "https://stackoverflow.com/questions/35188839/epoch-time-python-and-excel/35188940#35188940", "title": "Epoch time python and excel", "body": "<p>The correct answer is 42058, so there's something wrong w/the excel macro.</p>\n\n<p>My guess is that excel is counting both the start and end date as a day, when really you're only interested in the time <em>between</em> those dates.</p>\n\n<p>It's like saying how many days between today and tomorrow. You could say one, which is what python is doing, or you could say 3 (today, the day between, and tomorrow) which is what I'm guessing your excel macro is doing.</p>\n"}, {"tags": [], "owner": {"reputation": 675, "user_id": 3450049, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/eae5b71f962f720ef0524924e18a6c75?s=128&d=identicon&r=PG&f=1", "display_name": "user3450049", "link": "https://stackoverflow.com/users/3450049/user3450049"}, "is_accepted": false, "score": 0, "last_activity_date": 1516769984, "creation_date": 1516769984, "answer_id": 48415109, "question_id": 35188839, "link": "https://stackoverflow.com/questions/35188839/epoch-time-python-and-excel/48415109#48415109", "title": "Epoch time python and excel", "body": "<p>This is an old thread, but since it came up in google, I wanted to put in an answer. The off-by-two problem is explained like this:</p>\n\n<ol>\n<li><p>One day because 1900-01-01 is day #1, not day #0.  In Excel, if you convert 1900/1/1 into a number, it gives the answer 1, not 0. In python:\n<code>print((datetime.date(1900,1,1)-datetime.date(1900,1,1)).days)</code>  = 0.</p></li>\n<li><p>Another day because Excel implemented a bug in Lotus 1-2-3 for backwards compatibility. Apparently, Lotus 1-2-3 incorrectly assumed that 1900 was a leap year. \n<a href=\"https://support.microsoft.com/en-us/help/214326/excel-incorrectly-assumes-that-the-year-1900-is-a-leap-year\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/214326/excel-incorrectly-assumes-that-the-year-1900-is-a-leap-year</a></p></li>\n</ol>\n"}], "owner": {"reputation": 73, "user_id": 5880304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3999764520da67f51628967b97b37127?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Ngo", "link": "https://stackoverflow.com/users/5880304/jon-ngo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 35188940, "answer_count": 2, "score": 0, "last_activity_date": 1516769984, "creation_date": 1454537806, "last_edit_date": 1531161705, "question_id": 35188839, "link": "https://stackoverflow.com/questions/35188839/epoch-time-python-and-excel", "title": "Epoch time python and excel", "body": "<p>I am trying to automate some data processing on an excel file and in the data processing file I use a macro that I guess converts the date column from \"mm/dd/yyyy\" into the days since January 1, 1900 as per excel convention. So when I try to do a similar thing in Python 2.7.4. It seems to be 2 days off. For example, 2/25/2015 becomes 42060 when done by the excel macro. When I run this code:</p>\n\n<pre><code>import datetime\n\ngotDay = datetime.date(2015,2,25)\nepoch = datetime.date(1900,1,1)\n\nprint((gotDay-epoch).days)\n</code></pre>\n\n<p>I get 42058.</p>\n\n<p>I could totally just add 2 to everything in Python, but I was wondering why this happens.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "time", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1454537059, "post_id": 35188588, "comment_id": 58094467, "body": "You could use a if statement to test if the first is less than the second than add one day or 1 to the first then subtract.  <code>=IF(A1&lt;B1,A1+1,A1)-B1</code>"}, {"owner": {"reputation": 133, "user_id": 4418331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a7706a100ce3fbe2b576b3fd79e5747?s=128&d=identicon&r=PG&f=1", "display_name": "micuzzo", "link": "https://stackoverflow.com/users/4418331/micuzzo"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1454537918, "post_id": 35188588, "comment_id": 58094890, "body": "Thanks for your comment!"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4418331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a7706a100ce3fbe2b576b3fd79e5747?s=128&d=identicon&r=PG&f=1", "display_name": "micuzzo", "link": "https://stackoverflow.com/users/4418331/micuzzo"}, "edited": false, "score": 0, "creation_date": 1454537946, "post_id": 35188691, "comment_id": 58094912, "body": "Thanks for the help. I&#39;m going to use the latter approach :)"}, {"owner": {"reputation": 133, "user_id": 4418331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a7706a100ce3fbe2b576b3fd79e5747?s=128&d=identicon&r=PG&f=1", "display_name": "micuzzo", "link": "https://stackoverflow.com/users/4418331/micuzzo"}, "edited": false, "score": 0, "creation_date": 1454538100, "post_id": 35188691, "comment_id": 58094988, "body": "Actually just to clarify, what does the +1 do? Is it adding a day or hour?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1454538131, "post_id": 35188691, "comment_id": 58095005, "body": "Why retype the <code>-b2</code>.  It is not needed <code>if(c2&gt;b2;c2;c2+1) -b2</code> will work without the extra stress on the fingers."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 133, "user_id": 4418331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a7706a100ce3fbe2b576b3fd79e5747?s=128&d=identicon&r=PG&f=1", "display_name": "micuzzo", "link": "https://stackoverflow.com/users/4418331/micuzzo"}, "edited": false, "score": 1, "creation_date": 1454538150, "post_id": 35188691, "comment_id": 58095016, "body": "@micuzzo it is adding full day"}], "tags": [], "owner": {"reputation": 1882, "user_id": 1396864, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9e291ca58bddd0189d783a865e0086cb?s=128&d=identicon&r=PG", "display_name": "MortenSickel", "link": "https://stackoverflow.com/users/1396864/mortensickel"}, "is_accepted": true, "score": 1, "last_activity_date": 1454538866, "last_edit_date": 1454538866, "creation_date": 1454537151, "answer_id": 35188691, "question_id": 35188588, "link": "https://stackoverflow.com/questions/35188588/midnight-as-2400-not-0000-in-excel/35188691#35188691", "title": "Midnight as 24:00 not 00:00 in Excel", "body": "<p>If you are doing calculations With times going cross midnight, you need to add a date, thereby Excel will know which timestamp that is the latest.</p>\n\n<p>i.e.</p>\n\n<p>00:30 - 23:30 does not work </p>\n\n<p>jan 02 2000 00:30 - jan 01 2000 23:30 Works fine</p>\n\n<p>use the actual date or whatever date is suitable, the important thing is just that 00:30 is the day after 23:30</p>\n\n<p>or if you have the from-time in b2 and the to-time in c2:</p>\n\n<pre><code>if(c2&gt;b2;c2;c2+1)-b2\n</code></pre>\n\n<p>change if and ; to whatever Excel wants in your locale</p>\n"}], "owner": {"reputation": 133, "user_id": 4418331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a7706a100ce3fbe2b576b3fd79e5747?s=128&d=identicon&r=PG&f=1", "display_name": "micuzzo", "link": "https://stackoverflow.com/users/4418331/micuzzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "accepted_answer_id": 35188691, "answer_count": 1, "score": 0, "last_activity_date": 1454538866, "creation_date": 1454536759, "last_edit_date": 1531161705, "question_id": 35188588, "link": "https://stackoverflow.com/questions/35188588/midnight-as-2400-not-0000-in-excel", "title": "Midnight as 24:00 not 00:00 in Excel", "body": "<p>Ok this isn't explicitly a programming question but maybe I can get around it with VBA.</p>\n\n<p>I have some times I'm working with that go over midnight and Excel is not displaying them because they would be 'negative values'. \nEg: 00:30 - 23:30 (or 12:30 am - 11:30pm). This is causing many errors.</p>\n\n<p>Is there a way to get around this? I've tried changing the format to [hh]:mm:ss and this doesn't help. I've also changed the time format to 1904 but this causes problems with other errors I'm using.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["vba", "find", "excel-2010", "lookup"], "comments": [{"owner": {"reputation": 217, "user_id": 1574656, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/KRy3Z.jpg?s=128&g=1", "display_name": "No Body", "link": "https://stackoverflow.com/users/1574656/no-body"}, "edited": false, "score": 0, "creation_date": 1454536686, "post_id": 35188448, "comment_id": 58094266, "body": "I&#39;ve tried formulas but I couldn&#39;t get the nested vlookup to work with index. I&#39;m searching online to see if I can find a similar example to make this work. I&#39;m not very good with vba so any help is appreciated!"}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1454598998, "post_id": 35188448, "comment_id": 58125049, "body": "Do you want one &quot;true&quot; or &quot;false&quot; in the entire column, or do you want one per row, according to that row&#39;s comparative outcome?"}], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 1574656, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/KRy3Z.jpg?s=128&g=1", "display_name": "No Body", "link": "https://stackoverflow.com/users/1574656/no-body"}, "edited": false, "score": 0, "creation_date": 1454540566, "post_id": 35189118, "comment_id": 58096048, "body": "Thanks, I will look through to see if I can make sense of it..  Edit: I added the necessary conditions to the question for a easier view."}, {"owner": {"reputation": 217, "user_id": 1574656, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/KRy3Z.jpg?s=128&g=1", "display_name": "No Body", "link": "https://stackoverflow.com/users/1574656/no-body"}, "edited": false, "score": 1, "creation_date": 1454611793, "post_id": 35189118, "comment_id": 58133649, "body": "Hey Clyde, I used the filter option and managed to do this without any coding. Thank you, hopefully someone else can find this helpful. :)"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 217, "user_id": 1574656, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/KRy3Z.jpg?s=128&g=1", "display_name": "No Body", "link": "https://stackoverflow.com/users/1574656/no-body"}, "edited": false, "score": 0, "creation_date": 1454614639, "post_id": 35189118, "comment_id": 58135308, "body": "oh excellent, glad to &quot;try&quot; to be of assistance. Take Care :D"}], "tags": [], "owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "is_accepted": true, "score": 1, "last_activity_date": 1454598567, "last_edit_date": 1454598567, "creation_date": 1454538964, "answer_id": 35189118, "question_id": 35188448, "link": "https://stackoverflow.com/questions/35188448/how-do-i-compare-values-in-two-columns-and-then-mark-true-false-in-a-third/35189118#35189118", "title": "How do I compare values in two columns and then mark true/false in a third?", "body": "<p>This should match more closely what you're wanting to accomplish, any questions about what's happening here let me know.</p>\n\n<pre><code>Option Base 1\n\nSub testCriteria()\n\n'arrays for criteria r, r2.  Array for T/F r3\nDim r, r2, r3(10, 1)\n\n'iterators for loop and variable for output column\nDim i As Long, j As Long, c As Long\n\n    'column for output of t/f\n    c = 3\n\n    'location of criteria cells h1 through i10\n    r = [h1:i10]\n\n    'location of comparison\n    r2 = [a1:b10]\n\n    'loop through rows of rows to check (r2) and compare with all rows from criteria (r)\n    For i = LBound(r2) To UBound(r2)\n        For j = LBound(r) To UBound(r)\n            If CStr(r(j, 1)) = CStr(r2(i, 1)) _\n            And CStr(r(j, 2)) = CStr(r2(i, 2)) _\n            Then r3(i, 1) = \"TRUE\"\n        Next j\n        If Not r3(i, 1) Then r3(i, 1) = \"FALSE\"\n    Next i\n\n    'reusing iterators for array limits\n    i = LBound(r3): j = UBound(r3)\n\n    'loading t/f array into api\n    Range(Cells(i, c), Cells(j, c)) = r3\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 1574656, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/KRy3Z.jpg?s=128&g=1", "display_name": "No Body", "link": "https://stackoverflow.com/users/1574656/no-body"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "accepted_answer_id": 35189118, "answer_count": 1, "score": -1, "last_activity_date": 1454598871, "creation_date": 1454536218, "last_edit_date": 1454598871, "question_id": 35188448, "link": "https://stackoverflow.com/questions/35188448/how-do-i-compare-values-in-two-columns-and-then-mark-true-false-in-a-third", "title": "How do I compare values in two columns and then mark true/false in a third?", "body": "<p>Can someone please help me create a macro that will search two columns on a worksheet for a list of conditions and mark true/false on the third column. (office 2010)</p>\n\n<p>e.g.</p>\n\n<p>Column A would have the following values: 1111,1,2,3,3,4,...\nColumn B would have the following values: O,A,Y,A,S,3Y,...</p>\n\n<p>If the following matching conditions are met, the column C would mark as TRUE, otherwise FALSE.</p>\n\n<pre><code>A       B\n1111 =  O\n0    =  Y\n1    =  A\n2    =  S\n3    =  3YRY\n4    =  Q\n6    =  B\n12   =  M\n13   =  V\n360  =  D\n</code></pre>\n\n<p>CONDITION RULES:</p>\n\n<pre><code>IF column A = 1111 AND column B = O \nOR \nIF column A = 0 AND column B = Y \nOR \nIF column A = 1 AND column B = A \nOR \nIF column A = 2 AND column B = S \nOR \nIF column A = 3 AND column B = 3YR \nOR \nIF column A = 4 AND column B = Q \nOR \nIF column A = 6 AND column B = B \nOR \nIF column A = 12 AND column B = M \nOR \nIF column A = 13 AND column B = V \nOR \nIF column A = 360 AND column B = D \nTHEN COLUMN C = \"TRUE\" ELSE \"FALSE\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "vsto", "excel-addins"], "answers": [{"tags": [], "owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1454590801, "creation_date": 1454590801, "answer_id": 35201683, "question_id": 35188359, "link": "https://stackoverflow.com/questions/35188359/sub-windows-created-by-an-add-in/35201683#35201683", "title": "Sub-windows created by an add-in", "body": "<p>This technique  is <a href=\"https://msdn.microsoft.com/en-us/library/aa942864.aspx\" rel=\"nofollow\">CustomTaskPanes</a></p>\n"}], "owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 35201683, "answer_count": 1, "score": 0, "last_activity_date": 1454590801, "creation_date": 1454535934, "last_edit_date": 1454539137, "question_id": 35188359, "link": "https://stackoverflow.com/questions/35188359/sub-windows-created-by-an-add-in", "title": "Sub-windows created by an add-in", "body": "<p>I have seen several times that an add-in can create sub-windows in Excel. Here is an exemple:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UYtyL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UYtyL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone know which technique allows the add-in to create the sub-windows on the right hand side?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454536916, "post_id": 35188234, "comment_id": 58094391, "body": "did you create the table with VBA or does it already exist?. Existing tables would have their formulas already set up. New rows will inherit the existing formulas. Are you trying to add new formulas to the table?"}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454537039, "post_id": 35188234, "comment_id": 58094454, "body": "It does already exist.  Background: This table is on a &quot;dashboard&quot; sheet.  This code is part of a function that creates a new worksheet/tab and then adds some things to an &quot;index&quot; of sorts.  That being the case, the formula for the table can&#39;t really be set ahead of time because the tab names could be different.  Hope this makes sense."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1454537105, "post_id": 35188234, "comment_id": 58094497, "body": "the reason the code fails is that <code>StrFormula1</code> is an invalid formula. Correct that and the wode works.  Eg if <code>newName</code> had the value <code>Sheet1</code> then <code>StrFormula1</code> = <code>=HYPERLINK(&quot;#&#39;Sheet1&#39;!A1&quot;,newName &amp; &quot;!A1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454538083, "post_id": 35188748, "comment_id": 58094984, "body": "I corrected my post a few minutes ago. I get no message. File open dialog  appears when a sheet name does not exist and Excel tries to be helpful and wants you to open the file with the sheet it can&#39;t find. Check the sheet name. Use the lower of the two formulas, which will accommodate spaces in sheet names."}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1454538186, "post_id": 35188748, "comment_id": 58095027, "body": "Yeah sorry that went away.  I guess it was trying to save it.  Very strange.  Anyway, column1 StrFormula1 seems to be working consistently.  However, when I write a new value for Formula2 it updates all the previous rows.  I&#39;ll update with screenshots."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1454538478, "post_id": 35188748, "comment_id": 58095177, "body": "The nature of a table is that a formula applies to the whole column. If you overwrite an existing formula that applies to the whole column, the new formula will now be the column formula. To break that behaviour, enter a constant into one cell of the column. Now change the formula in another cell of the column. Change the first cell back to its original formula. Now the column no longer has just one formula and you can add more formulas without affecting the whole column."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1454538652, "post_id": 35188748, "comment_id": 58095257, "body": "What do you mean? I just showed you the workaround you need."}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1454539525, "post_id": 35188748, "comment_id": 58095634, "body": "Follow up, if you&#39;re interested: <a href=\"http://stackoverflow.com/questions/35189246/unique-formulas-in-table-managed-by-code\" title=\"unique formulas in table managed by code\">stackoverflow.com/questions/35189246/&hellip;</a>"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1454537722, "last_edit_date": 1454537722, "creation_date": 1454537437, "answer_id": 35188748, "question_id": 35188234, "link": "https://stackoverflow.com/questions/35188234/add-row-to-table-then-add-formulas-to-multiple-columns-in-row/35188748#35188748", "title": "Add row to table then add formulas to multiple columns in row", "body": "<p>corrected formula:</p>\n\n<pre><code>StrFormula1 = \"=HYPERLINK(\"\"#'\" &amp; newName &amp; \"'!A1\"\",\" &amp; newName &amp; \"!A1)\"\n</code></pre>\n\n<p>You may also want to wrap newName in a single quote in the second reference, in case the newName contains a space.</p>\n\n<pre><code>StrFormula1 = \"=HYPERLINK(\"\"#'\" &amp; newName &amp; \"'!A1\"\",'\" &amp; newName &amp; \"'!A1)\"\n</code></pre>\n"}], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 35188748, "answer_count": 1, "score": 0, "last_activity_date": 1454537722, "creation_date": 1454535455, "last_edit_date": 1495539913, "question_id": 35188234, "link": "https://stackoverflow.com/questions/35188234/add-row-to-table-then-add-formulas-to-multiple-columns-in-row", "title": "Add row to table then add formulas to multiple columns in row", "body": "<pre><code>Dim Tbl As ListObject\nDim StrFormula1, StrFormula2 As String\nDim NewRow As ListRow\nStrFormula1 = \"=HYPERLINK(\"\"#'\" &amp; newName &amp; \"'!A1\"\",newName &amp; \"\"!A1)\"\nStrFormula2 = \"=\" &amp; newName &amp; \"!C9\"\n\nSet Tbl = Range(\"tblProjects\").ListObject\nSet NewRow = Tbl.ListRows.Add(AlwaysInsert:=True)\nNewRow.Range = Array(StrFormula1, StrFormula2)\n</code></pre>\n\n<p>For the last line I keep getting an error. This is based on the question <a href=\"https://stackoverflow.com/questions/12297738/add-new-row-to-excel-table-vba\">Add new row to excel Table (VBA)</a></p>\n\n<p>I've tried a few other options for the last line but none of them work.  I don't know if it's because they're formulas or what.  In another spreadsheet I have I'm using <code>Range(ResultCol &amp; UCRow).Formula = StrFormula</code> but in that case the range is not based on a table but static cell values.</p>\n\n<p>So, how can I apply a couple formulas to <code>NewRow</code>?</p>\n"}, {"tags": ["excel", "for-loop", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1454534990, "post_id": 35187992, "comment_id": 58093349, "body": "There appears to be no attempt at looping through the sheets.  And Rows.count is c\\going to return the max number of rows on the sheet as in all of them, all 1.04 million.  There are plenty of answers on this site alone on how to loop through sheets and find the last row with data.  Have you tried googling those two specifically?"}], "answers": [{"tags": [], "owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "is_accepted": false, "score": 0, "last_activity_date": 1454534903, "creation_date": 1454534903, "answer_id": 35188069, "question_id": 35187992, "link": "https://stackoverflow.com/questions/35187992/how-to-loop-thru-an-excel-workbook-using-vba/35188069#35188069", "title": "How to loop thru an excel workbook using VBA", "body": "<p>This first sub below iterates over each worksheet.  The second is a placeholder for your code.</p>\n\n<pre><code>Sub forEachWs()\n    Dim ws As Worksheet\n    For Each ws In ActiveWorkbook.Worksheets\n        Call calculateValue(ws)\n    Next\nEnd Sub\n\nSub calculateValue(ws As Worksheet)\n    'Worksheets(ws).Activate\n    'iterate over cells\n    'your code goes here\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5880144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9fa62e1682f3c31ceeed7be6972821?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5880144/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454534903, "creation_date": 1454534603, "last_edit_date": 1531161705, "question_id": 35187992, "link": "https://stackoverflow.com/questions/35187992/how-to-loop-thru-an-excel-workbook-using-vba", "title": "How to loop thru an excel workbook using VBA", "body": "<p>I'm attempting to loop thru each sheet in an excel workbook. My code is only running thru the first sheet and it does not recognize where the last row is. Any help would be greatly appreciated. </p>\n\n<pre><code>Private Sub calculateValue()\n\nFor i = 2 To Rows.Count\n\n    If Cells(i, 4).Value &lt; 10 Then\n        Cells(i, 6).Value = 20\n    End If\n\n    If Cells(i, 4).Value &gt; 9 And Range(\"D2\").Value &lt; 40 Then\n        Cells(i, 6).Value = 70\n    End If\n\n    If Cells(i, 4).Value &gt; 39 Then\n        Cells(i, 6).Value = 120\n    End If\n\n\n    If Cells(i, 4).Value = Empty Then Exit For\n\nNext i\n\nCells(i, 6).Value = \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "time"], "answers": [{"comments": [{"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "edited": false, "score": 0, "creation_date": 1454556365, "post_id": 35188346, "comment_id": 58100887, "body": "Thanks for this, I&#39;ll test it tomorrow once I&#39;m back to work and let you know if it does it :) Looks good so far, I didn&#39;t know of this method."}], "tags": [], "owner": {"reputation": 41, "user_id": 5606471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f18aad93b7b83aba933293918e29e7ca?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil G", "link": "https://stackoverflow.com/users/5606471/kamil-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1454537434, "last_edit_date": 1454537434, "creation_date": 1454535881, "answer_id": 35188346, "question_id": 35187887, "link": "https://stackoverflow.com/questions/35187887/vba-due-date-with-hours-and-minutes/35188346#35188346", "title": "VBA - Due Date with Hours and Minutes?", "body": "<p>Try Application.OnTime Method</p>\n\n<pre><code>Sub setAlarm()\n    Application.OnTime Range(\"deadline\").Value - TimeValue(\"01:00:00\"), \"my_Procedure\"\nEnd Sub\n\nSub my_Procedure()\n    MsgBox \"Do that thing cause it is due right now\"\nEnd Sub\n</code></pre>\n\n<p>The msgbox pops up one hour before the deadline</p>\n"}], "owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 35188346, "answer_count": 1, "score": 0, "last_activity_date": 1454537434, "creation_date": 1454534207, "question_id": 35187887, "link": "https://stackoverflow.com/questions/35187887/vba-due-date-with-hours-and-minutes", "title": "VBA - Due Date with Hours and Minutes?", "body": "<p>Let's say I want a msgbox to pop up when something is an hour away from happening, how would this be done?</p>\n\n<p>I'm thinking something along the line:</p>\n\n<pre><code>MyLimit = Now\n\nIf .Value = MyLimit Then\nmsgbox \"Do that thing cause it is due right now\"\n</code></pre>\n\n<p>or </p>\n\n<pre><code>MyLimit = Date\n\nIf .Value = MyLimit Then\nmsgbox \"Do that thing cause it is due right now\"\n</code></pre>\n\n<p>and have the formula refer to cell with a Date Formatting of \"m/d/yy h:mm AM/PM\"</p>\n\n<p>Something like that doesn't work and I wonder why.</p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 5943, "user_id": 2674553, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/r41zt.jpg?s=128&g=1", "display_name": "ste-fu", "link": "https://stackoverflow.com/users/2674553/ste-fu"}, "edited": false, "score": 1, "creation_date": 1454533663, "post_id": 35187630, "comment_id": 58092617, "body": "Try posting your query. In general joining lots of tables will be inefficient if they are large, or if you don&#39;t have indexes on important fields."}, {"owner": {"reputation": 480, "user_id": 3763689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/301ec26cd9460769ca843212b6e136e8?s=128&d=identicon&r=PG", "display_name": "Avi", "link": "https://stackoverflow.com/users/3763689/avi"}, "reply_to_user": {"reputation": 5943, "user_id": 2674553, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/r41zt.jpg?s=128&g=1", "display_name": "ste-fu", "link": "https://stackoverflow.com/users/2674553/ste-fu"}, "edited": false, "score": 0, "creation_date": 1454536542, "post_id": 35187630, "comment_id": 58094188, "body": "I added the SQL query."}, {"owner": {"reputation": 4029, "user_id": 120097, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a34ae0ccd21deeefffc21a1b4a91e10c?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Mallory", "link": "https://stackoverflow.com/users/120097/steve-mallory"}, "edited": false, "score": 1, "creation_date": 1454537004, "post_id": 35187630, "comment_id": 58094431, "body": "@Avi it looks like the where clauses are repeating themselves."}, {"owner": {"reputation": 480, "user_id": 3763689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/301ec26cd9460769ca843212b6e136e8?s=128&d=identicon&r=PG", "display_name": "Avi", "link": "https://stackoverflow.com/users/3763689/avi"}, "reply_to_user": {"reputation": 4029, "user_id": 120097, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a34ae0ccd21deeefffc21a1b4a91e10c?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Mallory", "link": "https://stackoverflow.com/users/120097/steve-mallory"}, "edited": false, "score": 0, "creation_date": 1454537138, "post_id": 35187630, "comment_id": 58094508, "body": "@SteveMallory You are absolutely right!!! My bad!!!!"}], "answers": [{"comments": [{"owner": {"reputation": 480, "user_id": 3763689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/301ec26cd9460769ca843212b6e136e8?s=128&d=identicon&r=PG", "display_name": "Avi", "link": "https://stackoverflow.com/users/3763689/avi"}, "edited": false, "score": 0, "creation_date": 1454536558, "post_id": 35187739, "comment_id": 58094198, "body": "I added the sql query."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2191247"}, "is_accepted": true, "score": 1, "last_activity_date": 1454533726, "creation_date": 1454533726, "answer_id": 35187739, "question_id": 35187630, "link": "https://stackoverflow.com/questions/35187630/access-query-which-is-generated-from-another-query-takes-a-long-time-to-run/35187739#35187739", "title": "Access Query, which is generated from another query, takes a long time to run", "body": "<p>Without knowing the exact queries, can give only generic advice:</p>\n\n<ol>\n<li>add indices to relevant fields in the tables, these depend on the queries</li>\n<li>if the same query is repeated, cache the results and reuse them</li>\n<li>joins of large tables might be optimized, by pre-filtering and caching</li>\n<li>if possible, implement asynchronous queries which can return partial results while still running in the background; this can give the illusion of a faster response</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 480, "user_id": 3763689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/301ec26cd9460769ca843212b6e136e8?s=128&d=identicon&r=PG", "display_name": "Avi", "link": "https://stackoverflow.com/users/3763689/avi"}, "edited": false, "score": 0, "creation_date": 1454548041, "post_id": 35190378, "comment_id": 58098686, "body": "Status bar displays  &quot;Recordset is not updateable&quot; when I removed the GROUP BY clause."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1454545539, "creation_date": 1454545539, "answer_id": 35190378, "question_id": 35187630, "link": "https://stackoverflow.com/questions/35187630/access-query-which-is-generated-from-another-query-takes-a-long-time-to-run/35190378#35190378", "title": "Access Query, which is generated from another query, takes a long time to run", "body": "<ul>\n<li>Since you're not using any aggregate functions, get rid of the <code>GROUP BY</code> clause.</li>\n<li>Make sure there is an index on <code>StudentProgram.fkCohortID</code></li>\n</ul>\n\n<p>But my guess is that the actual complexity is in <code>qryRptJoinAll</code>, so you'd have to show us this query too.</p>\n"}], "owner": {"reputation": 480, "user_id": 3763689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/301ec26cd9460769ca843212b6e136e8?s=128&d=identicon&r=PG", "display_name": "Avi", "link": "https://stackoverflow.com/users/3763689/avi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 35187739, "answer_count": 2, "score": 0, "last_activity_date": 1454551239, "creation_date": 1454533357, "last_edit_date": 1454551239, "question_id": 35187630, "link": "https://stackoverflow.com/questions/35187630/access-query-which-is-generated-from-another-query-takes-a-long-time-to-run", "title": "Access Query, which is generated from another query, takes a long time to run", "body": "<p>I am adding some new features to a MS Access DB for a client. The original DB has several queries. The new features that I need to add require that I re-use these queries and incorporate them in my VBA and SQL code. </p>\n\n<p>For example, I am generating a new query (via VBA and SQL) based one of these previous queries. I then export the result as an excel file. </p>\n\n<p>However, whenever I try to run one of the new queries it takes about 15 minutes to complete. During this time there is message in the bottom right of the screen which says \"running query. \" </p>\n\n<p>Here is one of the SQL queries that I am running. Please note that it ran quickly when there was only one WHERE condition. </p>\n\n<pre><code>SELECT\n   StudentProgram.fkCohortID AS [Cohort],\n   Student.pkStudentID AS [Student ID],\n   Student.EmplID AS [Employee ID],\n   Student.LastName AS [Last Name],\n   Student.FirstName AS [First Name],\n   PostBaccActivity.fkSemesterID AS [Semester],\n   PostBaccActivity.fkPostBaccID AS [PostBacc],\n   PostBaccActivity.fkGradSchoolID AS [GradSchool],\n   PostBaccActivity.ProjectTitle AS [ProjectTitle],\n   PostBaccActivity.fkFacultyID AS [Faculty], \n   PostBaccActivity.BeginDate AS [BeginDate],\n   PostBaccActivity.EndDate AS [EndDate],\n   PostBaccActivity.Status AS [Status] \n\nFROM qryRptJoinAll\nWHERE\n       qryRptJoinAll.StudentProgram.fkCohortID  BETWEEN 1 AND 12 \n    OR qryRptJoinAll.StudentProgram.fkCohortID = 25 \n    OR qryRptJoinAll.StudentProgram.fkCohortID = 28 \n    OR qryRptJoinAll.StudentProgram.fkCohortID = 49 \n    OR qryRptJoinAll.StudentProgram.fkCohortID = 215 \n    OR qryRptJoinAll.StudentProgram.fkCohortID = 220  \n\n GROUP BY StudentProgram.fkCohortID, Student.pkStudentID, Student.EmplID, Student.LastName,\n          Student.FirstName, PostBaccActivity.fkSemesterID, PostBaccActivity.fkPostBaccID,\n          PostBaccActivity.fkGradSchoolID, PostBaccActivity.ProjectTitle, PostBaccActivity.fkFacultyID,\n          PostBaccActivity.BeginDate, PostBaccActivity.EndDate, PostBaccActivity.Status\n</code></pre>\n\n<p>This is the query I am using to generate the other queries:</p>\n\n<pre><code>SELECT \n   Student.pkStudentID, Student.EmplID, Student.OldID, Student.Inactive,\n   Student.InactiveReason, Student.Status, Student.LastName, Student.MarriedName,\n   Student.FirstName, Student.MiddleName, Student.DOB, Student.Sex, Student.SSN,\n   Student.Email, Student.Race, Student.Ethnicity, Student.EmailSecondary,\n   Student.fkSemesterBCStart, Student.fkSemesterGrad, Student.TotalCredits,\n   Student.CreditsAttempted, Student.IndexCredits, Student.QualityPoints,\n   Student.LocalCredits, Student.TransferCredits, Student.OtherCredits,\n   StudentProgram.*, StudentEvent.*, StudentResearch.*, StudentEmployment.*,\n   StudentMajor.*, PostBaccActivity.*, StudentPresentation.*, Presentation.*,\n   StudentNote.*, SemesterGPA.*, StudentPublication.*, Publication.*, StudentCourse.fkCourseID,\n   StudentCourse.fkFacultyID, StudentCourse.fkSemesterID, StudentCourse.Grade, Grade.GradeValue,\n   Grade.NoValue, Course.*, RptCumulativeScienceGPA2.ScienceGPACalc, RptStudentControlList.pkStudentControlID\nFROM \n\n    ((((((((PostBaccActivity RIGHT JOIN ((((((StudentProgram RIGHT JOIN \nStudent ON StudentProgram.fkStudentID = Student.pkStudentID)\nLEFT JOIN Cohort ON StudentProgram.fkCohortID = Cohort.pkCohortID) LEFT JOIN StudentEmployment ON Student.pkStudentID = StudentEmployment.fkStudentID)\nLEFT JOIN StudentNote ON Student.pkStudentID = StudentNote.fkStudentID) LEFT JOIN StudentPresentation ON Student.pkStudentID = StudentPresentation.fkStudentID)\nLEFT JOIN Presentation ON StudentPresentation.fkPresentationID = Presentation.pkPresentationID) ON PostBaccActivity.fkStudentID = Student.pkStudentID) \nLEFT JOIN RptCumulativeScienceGPA2 ON Student.pkStudentID = RptCumulativeScienceGPA2.fkStudentID) \nLEFT JOIN RptStudentControlList ON Student.pkStudentID = RptStudentControlList.fkControlID)\nLEFT JOIN (StudentPublication LEFT JOIN Publication ON StudentPublication.fkPublicationID = Publication.pkPubID) ON Student.pkStudentID = StudentPublication.fkStudentID)\nLEFT JOIN StudentResearch ON Student.pkStudentID = StudentResearch.fkStudentID) LEFT JOIN StudentMajor ON Student.pkStudentID = StudentMajor.fkStudentID)\nLEFT JOIN StudentEvent ON Student.pkStudentID = StudentEvent.fkStudentID) \nLEFT JOIN (Course RIGHT JOIN (Grade RIGHT JOIN StudentCourse ON Grade.Grade = StudentCourse.Grade) ON Course.pkCourseID = StudentCourse.fkCourseID) ON Student.pkStudentID = StudentCourse.fkStudentID) \nLEFT JOIN SemesterGPA ON Student.pkStudentID = SemesterGPA.fkStudentID;\n</code></pre>\n\n<p>Is there anyway in which I can reduce the time it takes for them to run?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1454531910, "post_id": 35187178, "comment_id": 58091562, "body": "Try recording a macro, and doing what you want to do manually .. then look at what it wrote ;) It&#39;ll show you the exact command, you just need to tweak it for your ranges ...  ;)"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "reply_to_user": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1454532905, "post_id": 35187178, "comment_id": 58092175, "body": "is nA and nB a number or a variable? As @Ditto suggested, the recorded code is: Rows(&quot;1:4&quot;).Select so maybe there is something off in how you&#39;re setting the rows to be selected.  Also, .Select is rarely needed.  You may want to give an idea of what you want to do w/ the selected rows to get a better idea of how to go about it.  For instance: Rows(&quot;1:4&quot;).Cells.Interior.Color = 255 will color rows 1 - 4 red.  No select needed."}], "answers": [{"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1454533764, "post_id": 35187517, "comment_id": 58092677, "body": "No need to use Select at all."}], "tags": [], "owner": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "is_accepted": false, "score": 0, "last_activity_date": 1454532944, "creation_date": 1454532944, "answer_id": 35187517, "question_id": 35187178, "link": "https://stackoverflow.com/questions/35187178/excel-row-select/35187517#35187517", "title": "Excel Row Select", "body": "<p>definitely do the record macro like was suggested.</p>\n\n<pre><code>Range(\"B3:C10\").Select\nSelection.Copy\n</code></pre>\n\n<p>another example:</p>\n\n<pre><code>rowstart = 3\nrowend = 10\ncolstart = \"B\"\ncolend = \"C\"\n\nrcstart = colstart &amp; rowstart\nrcend = colend &amp; rowend\n\nRange(rcstart, rcend).Select\n' or you can combine like below\nRange(colstart &amp; rowstart, colend &amp; rowend).Select\n\nSelection.Copy\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 1, "last_activity_date": 1454534896, "creation_date": 1454534896, "answer_id": 35188064, "question_id": 35187178, "link": "https://stackoverflow.com/questions/35187178/excel-row-select/35188064#35188064", "title": "Excel Row Select", "body": "<p>You probably need</p>\n\n<pre><code>Rows(nA &amp; \":\" &amp; nB).Select\n</code></pre>\n\n<p>to match exactly what you want to achieve.</p>\n"}], "owner": {"reputation": 1, "user_id": 5879945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170cf3ed5504f546c7cf97927561c681?s=128&d=identicon&r=PG&f=1", "display_name": "Jack B", "link": "https://stackoverflow.com/users/5879945/jack-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454538678, "creation_date": 1454531730, "last_edit_date": 1531161705, "question_id": 35187178, "link": "https://stackoverflow.com/questions/35187178/excel-row-select", "title": "Excel Row Select", "body": "<p>I'm writing a macro to color code some rows of a data sheet I have.</p>\n\n<p>Part of this macro involves selecting a series of rows, let's say from row <code>nA</code> to row <code>nB</code>. I have tried:</p>\n\n<pre><code>Rows(nA:nB).select\n</code></pre>\n\n<p>which causes</p>\n\n<pre><code>Compile Error:\nExpected: list seperator or )\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Rows(\"nA:nB\").select\n</code></pre>\n\n<p>which causes</p>\n\n<pre><code>runtime error\ntype mismatch\n</code></pre>\n\n<p>Any advice on how to solve this?</p>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 1, "creation_date": 1454532039, "post_id": 35186925, "comment_id": 58091656, "body": ".Refresh BackgroundQuery:=False is where it actually executes that block of code so it could be anything before that. Date and Year are functions so they can&#39;t be used as variable names. Try changing those and see if that helps."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1454532345, "post_id": 35186925, "comment_id": 58091849, "body": "Can you show the actual SQL query - you could have characters in there that need to be escaped in VBA."}], "owner": {"reputation": 53, "user_id": 5393937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cd8fc3a8732fd09b4310d00cc55e3bc?s=128&d=identicon&r=PG&f=1", "display_name": "justinua", "link": "https://stackoverflow.com/users/5393937/justinua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1456451733, "creation_date": 1454530879, "last_edit_date": 1456451733, "question_id": 35186925, "link": "https://stackoverflow.com/questions/35186925/application-defined-or-object-defined-error-on-querytable", "title": "Application Defined or Object Defined Error on QueryTable", "body": "<p>I'm trying to take data from a table in SQL and export it to a worksheet using VBA.</p>\n\n<p>I have been unable to figure out how to do this without creating a new data connection each time. </p>\n\n<p>Here is what I have been doing as of now:</p>\n\n<p>I am putting the SQL query into a cell and giving the variables names like '#ID' and \"Date\". In the macro, I am replacing the data within those variables with the actual information. That has not given me any problems thus far as the query runs without issue when using SQL. To export the data from SQL to my worksheet, I am using code that works in other workbooks; however when I run it in this workbook, I am getting the error \"Application Defined or Object Defined Error\". Here is the full macro: </p>\n\n  \n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub CurrentBreakout()\n\nDim SQLString As String\nDim ID As String\nDim Date As String\nDim year As String\nDim daycount As String\n\nSQLString = Range(\"CurrentBreakout\") 'This is the range where the query is stored \nID = Range(\"ID\")\nDate = Range(\"CurrMonth\")\nyear = Range(\"CurrYear\")\ndaycount = Range(\"CurrDayCount\")\n\nSQLString = Replace(SQLString, \"#ID\", ID)\nSQLString = Replace(SQLString, \"#Date\", Date)\nSQLString = Replace(SQLString, \"#CurrDayCount\", daycount)\nSQLString = Replace(SQLString, \"#CurrYear\", year)\n\n\n With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n   \"ODBC;DSN=____________;UID=________;Trusted_Connection=Yes;APP=Microsoft Office 2010;WSID=________;DATABASE=_______;\" _\n        , Destination:=Range(\"CurrCon\")).QueryTable\n        .CommandText = SQLString\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .ListObject.DisplayName = \"Table_CurrCon\"\n        .Refresh BackgroundQuery:=False\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>I am getting the error at \".Refresh BackgroundQuery:=False\". This is probably not the best way to complete this task, but it is the only way I know.</p>\n"}, {"tags": ["excel", "compiler-errors", "backup", "vba"], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 5504739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3d70cda996c764a28dd62aec3dea537?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5504739/kevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1454530210, "creation_date": 1454530210, "answer_id": 35186728, "question_id": 35186634, "link": "https://stackoverflow.com/questions/35186634/excel-vba-automated-excel-backup-stopped-working-due-to-compile-error-cannot/35186728#35186728", "title": "Excel VBA: Automated Excel Backup Stopped Working due to &quot;Compile Error: Cannot find file or library&quot;", "body": "<p>My experience with Excel VBA is that the code can sometimes corrupt when opening.  It used to be the case with Access as well, but I'm not sure if that was eventually fixed.  </p>\n\n<p>My solution was to either make backup copies after each edit, or use source control for the Excel file.  Its the only way to be sure.</p>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "is_accepted": false, "score": 0, "last_activity_date": 1454530331, "creation_date": 1454530331, "answer_id": 35186767, "question_id": 35186634, "link": "https://stackoverflow.com/questions/35186634/excel-vba-automated-excel-backup-stopped-working-due-to-compile-error-cannot/35186767#35186767", "title": "Excel VBA: Automated Excel Backup Stopped Working due to &quot;Compile Error: Cannot find file or library&quot;", "body": "<p>Found the problem.  <a href=\"https://i.stack.imgur.com/6QqeK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6QqeK.png\" alt=\"Missing reference\"></a></p>\n\n<p>Unchecked this, and it's working now.  </p>\n\n<p><a href=\"https://social.technet.microsoft.com/Forums/office/en-US/09288f15-72a0-4410-84be-cfb5e87908b6/excel-2010-macro-compile-error-cant-find-project-or-library?forum=officesetupdeployprevious\" rel=\"nofollow noreferrer\">Reference</a></p>\n\n<ol>\n<li><p>Open the database or application.</p></li>\n<li><p>Open a module in Design view or press ALT+F11 to switch to the Visual Basic Editor.</p></li>\n<li><p>On the Tools menu, click References.</p></li>\n<li><p>Clear the check box for the type library or object library marked as \"Missing:\" </p></li>\n</ol>\n"}], "owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454530426, "creation_date": 1454529937, "last_edit_date": 1531164843, "question_id": 35186634, "link": "https://stackoverflow.com/questions/35186634/excel-vba-automated-excel-backup-stopped-working-due-to-compile-error-cannot", "title": "Excel VBA: Automated Excel Backup Stopped Working due to &quot;Compile Error: Cannot find file or library&quot;", "body": "<p>I have an inventory xls file, that includes a diagram of the office.  When the xls is opened, the VBA automatically makes a backup of the file before any changes are made.  That has worked for the past year.  Today it has broken.  </p>\n\n<p>Yesterday, the file was working fine.<br>\n1)  I added some info to the xls sheet - nothing unusual; the same sort of info I've added over the past year.   I did NOT edit the VBA. \n2)  I added some objects (shapes-circle, square, etc) to the tab with the office diagram.  </p>\n\n<p>Today, the file is not working.<br>\n1)  The VBA debugger gives an error on open:  \"Compile Error:  Cannot find file or library.\"\n2)  Numerous text boxes/shapes have vanished off the tab with the diagram. I did not remove them.</p>\n\n<p>UPDATE 1:  I moved a shape on the diagram, and all the text boxes reappeared.</p>\n\n<p>Any suggestions to fix this are appreciated.</p>\n\n<pre><code>'Saves an exact copy of the file upon opening it to the \\Back_Tracker location and added today's date to the filename.\nPrivate Sub Workbook_Open()\nDim WBPath As String, WBName As String, TimeStampStr As String, PassW As String\n\nWBPath = ThisWorkbook.Path\nWBName = ThisWorkbook.Name\n'PassW = \"something\"\n\nConst cstrBACKUP As String = \"Backup_Tracker\"\n\nIf InStr(1, WBPath, cstrBACKUP) = 0 Then        'prevent backups from making backups of themselves.\n\n    TimeStampStr = Format(Now(), \"YYYY-MM-DD_hh-mm_\")\n\n     'Application.StatusBar = \"Saving backup...\"\n    ActiveWorkbook.SaveCopyAs Filename:=WBPath &amp; Application.PathSeparator &amp; cstrBACKUP &amp; Application.PathSeparator &amp; TimeStampStr &amp; WBName\n     'Application.DisplayStatusBar = False\n     'Application.DisplayStatusBar = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "calendar"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1454529939, "post_id": 35186534, "comment_id": 58090281, "body": "welcome to SO. I added <code>vba</code> tags because your question concerns vba. That said, please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> to get the most effective from SO. If you post your code and where you are having trouble implementing your solution you will receive much better help."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4681354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97efed948592b134ce3d7116792b09e0?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Stanley", "link": "https://stackoverflow.com/users/4681354/jon-stanley"}, "edited": false, "score": 0, "creation_date": 1455045424, "post_id": 35202725, "comment_id": 58310807, "body": "Thanks for your help, do you know which properties are changed?  Is there a way I could test to see if those properties are what changed, and if so, ignore my ItemChange code?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 4681354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97efed948592b134ce3d7116792b09e0?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Stanley", "link": "https://stackoverflow.com/users/4681354/jon-stanley"}, "edited": false, "score": 0, "creation_date": 1455047052, "post_id": 35202725, "comment_id": 58311782, "body": "Why not do it the other way around? Check the old and new values of the properties that you care about and then decide whether the change can be ignored? You would of course need to store the old values someplace to be able to compare."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1454593625, "creation_date": 1454593625, "answer_id": 35202725, "question_id": 35186534, "link": "https://stackoverflow.com/questions/35186534/handle-itemchange-event-when-outlook-appointments-are-dismissed/35202725#35202725", "title": "Handle ItemChange event when outlook appointments are dismissed", "body": "<p>You cannot do that. When you dismiss a reminder, a couple properties are set and the appointment is saved. A change is a change.</p>\n"}], "owner": {"reputation": 1, "user_id": 4681354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97efed948592b134ce3d7116792b09e0?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Stanley", "link": "https://stackoverflow.com/users/4681354/jon-stanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593307667, "creation_date": 1454529663, "last_edit_date": 1593307667, "question_id": 35186534, "link": "https://stackoverflow.com/questions/35186534/handle-itemchange-event-when-outlook-appointments-are-dismissed", "title": "Handle ItemChange event when outlook appointments are dismissed", "body": "<p>I have created some macros to forward my calendar events from my work email to my personal email.  One component is a ItemChange event that will update my personal calendar when items change on my work calendar.  I am having a problem in that every time I dismiss an appointment reminder in outlook it triggers the \"itemchange\" event.   I am trying to develop something to prevent my item change procedures from running when a reminder is dismissed.  Anyone have an idea how to handle this?   Does anyone know what property of the AppointmentItem changes when a reminder is dismissed?  </p>\n"}, {"tags": ["excel", "vba", "outlook", "exchange-server-2010"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1454529762, "post_id": 35186381, "comment_id": 58090181, "body": "What do you use in OutlookSpy if you click IMAPISession | QueryIdentity? Does the IMailUser window have the PR_EMS_AB_MANAGER tab?"}, {"owner": {"reputation": 13, "user_id": 5879692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf07752635b3d6862c3f89fb511a4fca?s=128&d=identicon&r=PG&f=1", "display_name": "sajthy", "link": "https://stackoverflow.com/users/5879692/sajthy"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1454530208, "post_id": 35186381, "comment_id": 58090453, "body": "I haven&#39;t used OutlookSpy - but i see it has a large amount of options that would help in further development. So to answer your question: i don&#39;t know. Corporate stations have some restrictions and permissions, so i think that such software wouldn&#39;t be allowed to be run on my account anyway."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5879692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf07752635b3d6862c3f89fb511a4fca?s=128&d=identicon&r=PG&f=1", "display_name": "sajthy", "link": "https://stackoverflow.com/users/5879692/sajthy"}, "edited": false, "score": 0, "creation_date": 1454581875, "post_id": 35187456, "comment_id": 58113257, "body": "Unfortunately the code returns only an error: <b>Object variable or With block variable not set</b> I think that i&#39;ve already tried it - or very similar snippet - couple of days ago"}, {"owner": {"reputation": 13, "user_id": 5879692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf07752635b3d6862c3f89fb511a4fca?s=128&d=identicon&r=PG&f=1", "display_name": "sajthy", "link": "https://stackoverflow.com/users/5879692/sajthy"}, "edited": false, "score": 1, "creation_date": 1454587803, "post_id": 35187456, "comment_id": 58117196, "body": "Clarification: it only happens when there&#39;s no manager set on current user. But that&#39;s not a problem ;)  I owe you a beer Om3r!"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1454731278, "last_edit_date": 1454731278, "creation_date": 1454532727, "answer_id": 35187456, "question_id": 35186381, "link": "https://stackoverflow.com/questions/35186381/get-current-user-signed-to-exchange-server-manager-email-address/35187456#35187456", "title": "Get current user - signed to exchange server - manager email address", "body": "<p>To get current User's Manager.</p>\n\n<p>Example on <a href=\"/questions/tagged/outlook-vba\" class=\"post-tag\" title=\"show questions tagged &#39;outlook-vba&#39;\" rel=\"tag\">outlook-vba</a></p>\n\n<pre><code>Option Explicit\nSub GetManager()\n\n    MsgBox CreateObject(\"Outlook.Application\").GetNamespace(\"MAPI\") _\n                    .CurrentUser.AddressEntry.GetExchangeUser.Manager\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>Remember user must have manager setup. </p>\n\n<p>Modify your code this way</p>\n\n<pre><code>    With OutMail ' outlook message details\n        .To = CreateObject(\"Outlook.Application\").GetNamespace(\"MAPI\") _\n                    .CurrentUser.AddressEntry.GetExchangeUser.Manager\n\n        .Subject = \"Sales report - \" &amp; Format(Date, \"dd-mm-yyyy\")\n        .Body = \"Here comes the full sales report from \" &amp; Format(Date, \"dd-mm-yyyy\")\n        .Attachments.Add ActiveWorkbook.FullName 'attachment File \n        .Display\n'        .Send\n    End With\n</code></pre>\n\n<p>Also See on MSDN Example</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/bb646996.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">How to: Get Availability Information for an Exchange User's Manager</a></p>\n"}], "owner": {"reputation": 13, "user_id": 5879692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf07752635b3d6862c3f89fb511a4fca?s=128&d=identicon&r=PG&f=1", "display_name": "sajthy", "link": "https://stackoverflow.com/users/5879692/sajthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1344, "favorite_count": 1, "accepted_answer_id": 35187456, "answer_count": 1, "score": 1, "last_activity_date": 1593519242, "creation_date": 1454529103, "last_edit_date": 1593519242, "question_id": 35186381, "link": "https://stackoverflow.com/questions/35186381/get-current-user-signed-to-exchange-server-manager-email-address", "title": "Get current user - signed to exchange server - manager email address", "body": "<p>How can I retrieve the current user manager email address?\nI'm only able to get my e-mail address by calling the</p>\n\n<blockquote>\n  <p>Application.Session.CurrentUser.AddressEntry.GetExchangeUser</p>\n</blockquote>\n\n<p>while using </p>\n\n<blockquote>\n  <p>Application.Session.CurrentUser.AddressEntry.GetExchangeUser.Manager</p>\n</blockquote>\n\n<p>returns nothing...\nWhat i'm trying to achieve is to send an email to my manager right from excel sheet and automate it on other users computers (because they've other managers)</p>\n\n<pre><code>Sub Mail_workbook_Outlook_1()\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    If IsEmpty(Range(\"A21\").Value) = True Then ' check if cell is empty\n      MsgBox \"Cell is empty!\", vbCritical, \"It would be better to not left it empty...\" ' if so, show user a message\n    Else\n\n    On Error Resume Next\n    With OutMail ' outlook message details\n        .To = \"xyz@xyz.net\"\n        .Subject = \"Sales report - \" &amp; Format(Date, \"dd-mm-yyyy\")\n        .Body = \"Here comes the full sales report from \" &amp; Format(Date, \"dd-mm-yyyy\") &amp; Application.Session.CurrentUser.AddressEntry.GetExchangeUser\n        .Attachments.Add ActiveWorkbook.FullName ' add current file as an attachment to the outlook message\n        .Send\n    End With\n    On Error GoTo 0\n    MsgBox \"File sent \", vbInformation, \"You can now safely close the report\" ' show confirmation message\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n    End If\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/ZSZY2.jpg\" alt=\"Outlook contact with manager\"></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7480, "user_id": 3330348, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/q5U6s.jpg?s=128&g=1", "display_name": "PiotrWolkowski", "link": "https://stackoverflow.com/users/3330348/piotrwolkowski"}, "edited": false, "score": 0, "creation_date": 1454533487, "post_id": 35185946, "comment_id": 58092520, "body": "I&#39;m voting to close this question as off-topic because it&#39;s a request for code review."}], "answers": [{"comments": [{"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1454528365, "post_id": 35186041, "comment_id": 58089317, "body": "Thanks, I figured it was something like that but wanted to be 100% sure before I made some changes to the code."}], "tags": [], "owner": {"reputation": 967, "user_id": 5592955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aAlPK.jpg?s=128&g=1", "display_name": "JJ32", "link": "https://stackoverflow.com/users/5592955/jj32"}, "is_accepted": true, "score": 1, "last_activity_date": 1454528013, "creation_date": 1454528013, "answer_id": 35186041, "question_id": 35185946, "link": "https://stackoverflow.com/questions/35185946/found-some-vba-code-in-a-project-and-im-wondering-what-this-line-does/35186041#35186041", "title": "Found some VBA code in a project and I&#39;m wondering what this line does", "body": "<p>.locked is a boolean that sets whether you can edit the text box.  So it is trying to set it to either true or false based on the logic that follows.</p>\n\n<p>In English, set locked to true if the boolean isLocked is true, or if the value of cboTypeSelect.Column(1) equals \"Regular\".</p>\n"}, {"comments": [{"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1454528533, "post_id": 35186176, "comment_id": 58089399, "body": "Thanks but what I was asking, and I probably should have been more clear, is the &quot;or&quot; statement.  What was actually being assigned to the boolean locked in either of those scenarios."}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1454530659, "post_id": 35186176, "comment_id": 58090720, "body": "True or false. If one of those conditions is true, it will be true. If neither of those conditions are true, it will be false."}], "tags": [], "owner": {"reputation": 11, "user_id": 5879737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53e77399bb0a337400ca07f380b99a0?s=128&d=identicon&r=PG&f=1", "display_name": "jrJohn", "link": "https://stackoverflow.com/users/5879737/jrjohn"}, "is_accepted": false, "score": 1, "last_activity_date": 1454528451, "creation_date": 1454528451, "answer_id": 35186176, "question_id": 35185946, "link": "https://stackoverflow.com/questions/35185946/found-some-vba-code-in-a-project-and-im-wondering-what-this-line-does/35186176#35186176", "title": "Found some VBA code in a project and I&#39;m wondering what this line does", "body": "<p>if you are asking about TextBox.Locked research can be found here (as answered above) <a href=\"https://msdn.microsoft.com/en-us/library/office/ff844765.aspx\" rel=\"nofollow\">TextBox.Locked</a></p>\n\n<p>if you are asking about the equal signs, it is useful to know that the first one is an assignment operator and the second is a comparison operator (like an inline if comparison).  The equal sign is said to be 'overloaded' in vb.</p>\n"}], "owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 35186041, "answer_count": 2, "score": -1, "last_activity_date": 1454528451, "creation_date": 1454527669, "question_id": 35185946, "link": "https://stackoverflow.com/questions/35185946/found-some-vba-code-in-a-project-and-im-wondering-what-this-line-does", "title": "Found some VBA code in a project and I&#39;m wondering what this line does", "body": "<p>I have a question about a line of code in a vba project I am working on.  What does this statement actually mean?  I know there is no context here and I could post more code but I'm not sure if someone could just look at this and let me know what this is doing.  </p>\n\n<pre><code>txtTerminationDate.Locked = (isLocked Or cboTypeSelect.Column(1) = \"Regular\")\n</code></pre>\n"}, {"tags": ["vba", "filepath"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454528489, "post_id": 35185506, "comment_id": 58089377, "body": "Have got tried anything like file:/// ?"}, {"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454528591, "post_id": 35185506, "comment_id": 58089430, "body": "I am not sure what you mean by that."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454529044, "post_id": 35185506, "comment_id": 58089729, "body": "Instead of a web address like http:\\\\ try file:\\\\ maybe?"}, {"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454531184, "post_id": 35185506, "comment_id": 58091049, "body": "Which part of my code contains an implied http? As I stated, the code works fine for all folders except ones with the # symbol, so I&#39;m looking for a way to address that."}, {"owner": {"reputation": 414, "user_id": 5626367, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4a34e7e37e04e2cfc0322bc5225a5a76?s=128&d=identicon&r=PG&f=1", "display_name": "E. Monk", "link": "https://stackoverflow.com/users/5626367/e-monk"}, "edited": false, "score": 0, "creation_date": 1454531614, "post_id": 35185506, "comment_id": 58091379, "body": "Have you tried adding an additional trailing backslash? Just a thought..."}], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "edited": false, "score": 0, "creation_date": 1454542923, "post_id": 35189814, "comment_id": 58096937, "body": "I&#39;ve tried that as well and it didn&#39;t work. I simply replaced their <code>Me.filepath</code> with my path string."}, {"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "edited": false, "score": 0, "creation_date": 1454616300, "post_id": 35189814, "comment_id": 58136270, "body": "Actually it didn&#39;t work because my <code>strEndFilePath</code> contained double backslashes to make it work for the line of code in my question (it is read as a single backslash when the line is run), but Shell cannot have those double backslashes since it interprets it literally"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1454542339, "last_edit_date": 1495541245, "creation_date": 1454542339, "answer_id": 35189814, "question_id": 35185506, "link": "https://stackoverflow.com/questions/35185506/accessing-a-folder-with-a-pound-sign-in-the-folder-name-using-vba/35189814#35189814", "title": "Accessing a folder with a pound sign (#) in the folder name using VBA", "body": "<p>Answer should be the same as for a question with a marginally different title.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/8971744/vba-howto-open-a-file-that-has-characters-in-its-name\">VBA: Howto open a file, that has # -characters in it&#39;s name?</a></p>\n\n<pre><code>Shell \"explorer.exe \" ....\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 35189814, "answer_count": 1, "score": 0, "last_activity_date": 1454542339, "creation_date": 1454526231, "last_edit_date": 1454532027, "question_id": 35185506, "link": "https://stackoverflow.com/questions/35185506/accessing-a-folder-with-a-pound-sign-in-the-folder-name-using-vba", "title": "Accessing a folder with a pound sign (#) in the folder name using VBA", "body": "<p>The code below works for all folder names except ones with a pound sign. For example:</p>\n\n<p>\\\\Filestore2\\2016 JOBS\\CO#2 does not work, but \\\\Filestore2\\2016 JOBS\\CONo2 does. But I need to be able to open the ones with #.</p>\n\n<pre><code>Application.FollowHyperlink \"\" &amp; strStartFilePath &amp; strEndFilePath &amp; \"\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1454534744, "post_id": 35185720, "comment_id": 58093214, "body": "Is there a way to code it in VBA? I was trying to create a VBA code, I&#39;ll try to see if I can create a macro with that"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 1, "creation_date": 1454535670, "post_id": 35185720, "comment_id": 58093728, "body": "Why in VBA? Are you making this part of a macro? Pretty easy, you&#39;ll want to set up some variables then for the lastRow probably. At the very least, you can go to Options --&gt; Formulas --&gt; R1C1 style.  You can then copy the formula and use <code>Cells(1,1).FormulaR1C1 - &quot;=IfError( ...</code>  Or, another way to do it, is start recording a macro, <i>then</i> go in and enter the formula, drag down, etc. and then view the macro to see how the formula is written."}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 1, "creation_date": 1454535796, "post_id": 35185720, "comment_id": 58093786, "body": "Thanks Bruce, yes- making it part of a longer macro - I will try those suggestions :)"}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 1, "creation_date": 1454541627, "post_id": 35185720, "comment_id": 58096461, "body": "Not sure how to make it work... when I paste the data it prompts me for a file location, and when I select the workbook I have open, and to Select a Sheet (it gives me a list of my Groups), but it doesn&#39;t fill in any data. I also tried CTRL+SHIFT+ENTER at various points but that didn&#39;t get anything to change or pop up."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 1, "creation_date": 1454598985, "post_id": 35185720, "comment_id": 58125038, "body": "@sikorloa - Ah, sorry, you&#39;ll want to change/remove/edit the <code>Sheet1!</code> part. Again, if your sheet has been saved, the above should work without any prompts to open a workbook and choose a worksheet."}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1454602146, "post_id": 35185720, "comment_id": 58127386, "body": "Thanks Bruce, still trying to get it to work, I replaced &#39;Sheet1!&#39; with &#39;Script to organize Group&#39;! for every instance in that formula, and pasted it in 2nd worksheet (Stainless Steel) - The first keyword &quot;stainless steel wire&quot; did populate, but I couldn&#39;t get any more to populate. Is there anything I should change &quot;filename&quot; to in the formula? Also, cannot get &#39;CTRL+SHIFT+ENTER&#39; to have any effect."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1454603620, "post_id": 35185720, "comment_id": 58128366, "body": "@sikorloa - Hm - See my edit, good call on the Sheet1 replacement. I downloaded the file and entered the formula exactly as I put in my new edit, in cell A2, of sheet &quot;Stainless Steel&quot;, entered with CTRL+SHIFT+ENTER, then I&#39;m able to drag down to get the different keywords."}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1454612239, "post_id": 35185720, "comment_id": 58133890, "body": "Thanks Bruce for the clarification, I did get it to work when I entered it manually. Tried to record a VBA macro and create a subroutine from it, however I&#39;m getting an error message on one of the lines. (Original post edited to include my attempt at code). Think you could provide any suggestions? :)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1454603683, "last_edit_date": 1454603683, "creation_date": 1454526909, "answer_id": 35185720, "question_id": 35185345, "link": "https://stackoverflow.com/questions/35185345/vba-how-to-assign-a-columns-cell-to-corresponding-group-and-paste-group-cells/35185720#35185720", "title": "(VBA) How To Assign A Columns Cell To Corresponding Group, and Paste Group Cells into Group Sheet?", "body": "<p>In each of your worksheets that is named after a Group, place this in A2:</p>\n\n<p><code>=IFERROR(INDEX(Sheet1!B$2:B$7,SMALL(IF(Sheet1!A$2:A$7=MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255),ROW(Sheet1!A$2:A$7)-ROW(Sheet1!A$2)+1),ROWS(Sheet1!B$2:B2))),\"\")</code></p>\n\n<p>This assumes you have the file saved somewhere.  Enter this as an array (with <kbd>CTRL+SHIFT+ENTER</kbd>) and drag down.  You will have to adjust the ranges of course.  But, as you add Group/Keywords, the lists will update automatically.  Also, to return say Currency or Avg. Month, just change the first Index range from <code>B$2:B$7</code> to whatever new range, i.e. <code>C$2:C$7</code>.</p>\n\n<p>edit: Change \"Sheet1\" to the main sheet with all your data:\n<code>=IFERROR(INDEX('Script to organize Group'!B$2:B$469,SMALL(IF('Script to organize Group'!A$2:A$469=MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255),ROW('Script to organize Group'!A$2:A$469)-ROW('Script to organize Group'!A$2)+1),ROWS('Script to organize Group'!B$2:B2))),\"\")</code> and again, don't just press ENTER, press and hold CTRL+SHIFT, then ENTER.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8x4AC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8x4AC.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454612876, "creation_date": 1454525746, "last_edit_date": 1454612876, "question_id": 35185345, "link": "https://stackoverflow.com/questions/35185345/vba-how-to-assign-a-columns-cell-to-corresponding-group-and-paste-group-cells", "title": "(VBA) How To Assign A Columns Cell To Corresponding Group, and Paste Group Cells into Group Sheet?", "body": "<p>Trying to create a vba script-</p>\n\n<p>Link to workbook <a href=\"https://drive.google.com/file/d/0ByUcHTNcynugWDN2VW5oQ0V6eGc/view?usp=sharing\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>I have a list of Keywords in Column B, and each <strong>Keyword</strong> corresponds to a <strong>Group</strong> in Column A:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vr6Gs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vr6Gs.jpg\" alt=\"input_data\"></a></p>\n\n<p><strong>How do I group each list of Keywords into it's corresponding Group's worksheet, using VBA code?</strong></p>\n\n<p>Examples for Groups \"Stainless Steel\" and \"Glass Dispenser\":\n<br></p>\n\n<p>Group <strong>\"Stainless Steel\"</strong>:\n<a href=\"https://i.stack.imgur.com/ghcbX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ghcbX.jpg\" alt=\"stainless steel\"></a>\n<br><br>\nGroup <strong>\"Glass Dispenser\"</strong>:\n<a href=\"https://i.stack.imgur.com/X7tnh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X7tnh.jpg\" alt=\"glass dispenser\"></a>\n<br><br>\nAny help would be greatly appreciated!</p>\n\n<p><br></p>\n\n<hr>\n\n<p><br>\n<strong>EDIT:</strong><br>\nTrying to create a macro based on @BruceWayne formula.</p>\n\n<p>Getting an error for the line:<br></p>\n\n<pre><code>Selection.FormulaArray = _\n        \"=IFERROR(INDEX('Script to organize Group'!R2C[1]:R469C[1],SMALL(IF('Script to organize Group'!R2C:R469C=MID(CELL(\"\"filename\"\",R[-1]C),FIND(\"\"]\"\",CELL(\"\"filename\"\",R[-1]C))+1,255),ROW('Script to organize Group'!R2C:R469C)-ROW('Script to organize Group'!R2C)+1),ROWS('Script to organize Group'!R2C[1]:RC[1]))),\"\"\"\")\"\n</code></pre>\n\n<p><br>\nNote: Also tried using <code>Range(\"A2\").FormulaArray = _</code> instead of <code>Selection.FormulaArray = _</code>, but still getting the same error.\n<br>\n<br>\nMy attempt at VBA code, using the formula, below:\n<br></p>\n\n<pre><code>Sub CategorizeKeywordsIntoGroups()\n\nDim ws As Worksheet\n\nSet ws = ActiveWorkbook.ActiveSheet     'Set the exact sheet, not just the one that is active _\n                                        'and then you will go through all the sheets\n\n    Range(\"A2\").FormulaArray = _\n        \"=IFERROR(INDEX('Script to organize Group'!R2C[1]:R469C[1],SMALL(IF('Script to organize Group'!R2C:R469C=MID(CELL(\"\"filename\"\",R[-1]C),FIND(\"\"]\"\",CELL(\"\"filename\"\",R[-1]C))+1,255),ROW('Script to organize Group'!R2C:R469C)-ROW('Script to organize Group'!R2C)+1),ROWS('Script to organize Group'!R2C[1]:RC[1]))),\"\"\"\")\"\n    Selection.AutoFill Destination:=Range(\"A2:A9999\"), Type:=xlFillDefault\n    Range(\"A2:A29\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "protected", "udf", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1454525036, "post_id": 35185075, "comment_id": 58087244, "body": "Welcome to SO! Please post the code of the <code>Function</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3305648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae5152eba4d218d349d6e2c99b1c1e2?s=128&d=identicon&r=PG&f=1", "display_name": "aliarshad111", "link": "https://stackoverflow.com/users/3305648/aliarshad111"}, "edited": false, "score": 0, "creation_date": 1454610004, "post_id": 35185833, "comment_id": 58132485, "body": "I do not need application user name. I need only windows username. So can I skip the application.username part. Also, what does application.volatile do."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3, "user_id": 3305648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae5152eba4d218d349d6e2c99b1c1e2?s=128&d=identicon&r=PG&f=1", "display_name": "aliarshad111", "link": "https://stackoverflow.com/users/3305648/aliarshad111"}, "edited": false, "score": 0, "creation_date": 1454611078, "post_id": 35185833, "comment_id": 58133187, "body": "@user3305648  You can omit the part that you do not need......the <code>Application.Volatile</code> forces re-calculation when a different user opens the workbook."}, {"owner": {"reputation": 3, "user_id": 3305648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae5152eba4d218d349d6e2c99b1c1e2?s=128&d=identicon&r=PG&f=1", "display_name": "aliarshad111", "link": "https://stackoverflow.com/users/3305648/aliarshad111"}, "edited": false, "score": 0, "creation_date": 1454617145, "post_id": 35185833, "comment_id": 58136803, "body": "Thanks. As I understand, application.recalculate will work only if any cell in a workbook changes. So will it update when a different user opens the workbook."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1454527330, "creation_date": 1454527330, "answer_id": 35185833, "question_id": 35185075, "link": "https://stackoverflow.com/questions/35185075/user-defined-function-in-ms-excel-2010-for-fetching-environ-variable-user-name-d/35185833#35185833", "title": "User defined function in ms excel 2010 for fetching environ variable user name does not work", "body": "<p>Consider:</p>\n\n<pre><code>Public Function WhoAmI() As String\n   Application.Volatile\n   WhoAmI = \"The NT Logon User is \" &amp; Environ(\"username\")\n   WhoAmI = WhoAmI &amp; vbCrLf &amp; \"The Office Username is \" &amp; Application.UserName\nEnd Function\n</code></pre>\n\n<p>Should work on any <em>Windows</em> system.</p>\n"}], "owner": {"reputation": 3, "user_id": 3305648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae5152eba4d218d349d6e2c99b1c1e2?s=128&d=identicon&r=PG&f=1", "display_name": "aliarshad111", "link": "https://stackoverflow.com/users/3305648/aliarshad111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 35185833, "answer_count": 1, "score": 0, "last_activity_date": 1454527330, "creation_date": 1454524839, "last_edit_date": 1531161705, "question_id": 35185075, "link": "https://stackoverflow.com/questions/35185075/user-defined-function-in-ms-excel-2010-for-fetching-environ-variable-user-name-d", "title": "User defined function in ms excel 2010 for fetching environ variable user name does not work", "body": "<p>I created a user defined function in ms excel 2010 for fetching current logged in user thru environvariable \"USERNAME\".</p>\n\n<p>However, on some machines running ms excel2010 on win7, this function does not update current user name.</p>\n\n<p>I had packaged it in a protected worksheet and distributed to several users.</p>\n\n<p>The udf code goes this way :\nPublic Function UserName()\n    UserName = Environ$(\"UserName\")\nEnd Function</p>\n\n<p>Then  the function is called using the formula:</p>\n\n<p>=Username()</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1455753350, "post_id": 35185067, "comment_id": 58635840, "body": "Do you mean you need to get the GAL container from another Exchange account in your profile?"}, {"owner": {"reputation": 33, "user_id": 2717144, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/be83b6a259861f8099509bc2cf835e67?s=128&d=identicon&r=PG&f=1", "display_name": "user2717144", "link": "https://stackoverflow.com/users/2717144/user2717144"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1455811218, "post_id": 35185067, "comment_id": 58666021, "body": "yes, while searching, always it is searching from one GAL not from the other. To check on other GAL where and what i have to modify in my above code."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1455814713, "creation_date": 1455814713, "answer_id": 35487759, "question_id": 35185067, "link": "https://stackoverflow.com/questions/35185067/addresses-from-non-default-account-distribution-list/35487759#35487759", "title": "Addresses from non-default account distribution list", "body": "<p>Outlook Object Model will not let you resolve a name against a particular AB container. You would need to use Extended MAPI (C++ or Delphi) that by creating a <a href=\"https://msdn.microsoft.com/en-us/library/office/cc839647.aspx\" rel=\"nofollow\">PR_ANR</a> restriction (<code>IMAPITable::Restrict</code>) against the contents table of that container.</p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow\">Redemption</a> is an option, it exposes <a href=\"http://www.dimastr.com/redemption/RDOAddressList.htm\" rel=\"nofollow\">RDOAddressList</a>.<code>ResolveName</code> / <code>ResolveNameEx</code> methods that allow to resolve a name against a given container. The container can either be retrieved from <code>RDOSesion.AddressBook.AddressLists</code> or from <a href=\"http://www.dimastr.com/redemption/RDOAccount.htm#RDOExchangeAccount\" rel=\"nofollow\">RDOExchangeAccount</a>.GAL. <code>RDOExchangeAccount</code> object can be retrieved from the <a href=\"http://www.dimastr.com/redemption/RDOAccounts.htm\" rel=\"nofollow\">RDOSession.Accounts</a> collection.</p>\n"}], "owner": {"reputation": 33, "user_id": 2717144, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/be83b6a259861f8099509bc2cf835e67?s=128&d=identicon&r=PG&f=1", "display_name": "user2717144", "link": "https://stackoverflow.com/users/2717144/user2717144"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593324975, "creation_date": 1454524799, "last_edit_date": 1593324975, "question_id": 35185067, "link": "https://stackoverflow.com/questions/35185067/addresses-from-non-default-account-distribution-list", "title": "Addresses from non-default account distribution list", "body": "<p>I am using MS office 2010. I want the member details from an Outlook distribution list.  </p>\n\n<p>My Outlook is configured with two email IDs. One is client another one is company. </p>\n\n<p>I have a code in Excel to check the distribution list and import the details into Excel.</p>\n\n<p>I am able to import the details from a distribution List for a default mail ID. I am unable to select the distribution list from other email. It is trying to search the DL in default and selecting the wrong name.</p>\n\n<p>Here is my code  </p>\n\n<pre><code> Dim olApp As Outlook.Application  \n Dim olNS As Outlook.Namespace  \n Dim olAL As Outlook.AddressList  \n Dim olEntry As Outlook.AddressEntry  \n Dim olMember As Outlook.AddressEntry  \n Dim lMemberCount As Long  \n Dim objMail As Outlook.MailItem  \n\n Set olApp = Outlook.Application  \n Set olNS = olApp.GetNamespace(\"MAPI\")  \n Set olAL = olNS.AddressLists(\"Global Address List\")  \n\n Set objMail = olApp.CreateItem(olMailItem)  \n\n ' enter the list name  \n Set olEntry = olAL.AddressEntries(\".DL IS Support\")  \n\n ' get count of dist list members  \n lMemberCount = olEntry.Members.Count\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5866783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b84666cb4d9b38d8a9aa79f2bde7d659?s=128&d=identicon&r=PG&f=1", "display_name": "rakesh  seebaruth", "link": "https://stackoverflow.com/users/5866783/rakesh-seebaruth"}, "edited": false, "score": 0, "creation_date": 1454542401, "post_id": 35188380, "comment_id": 58096733, "body": "thanks for  the vba but it&#39;s not working  am getting this      Sol Id\tAcct No\t Name\t  DATE 5\t19\tEED\t   1/10/13 7\t22\tRDS  \t1/1/14                                         suppose to  get  all entries from 16/09/2009 to 31/12/2015 .thanks rakesh"}], "tags": [], "owner": {"reputation": 194, "user_id": 4133779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83f8629d548e974a439b6662f880ba45?s=128&d=identicon&r=PG&f=1", "display_name": "Sorcefyre", "link": "https://stackoverflow.com/users/4133779/sorcefyre"}, "is_accepted": false, "score": 0, "last_activity_date": 1454536007, "creation_date": 1454536007, "answer_id": 35188380, "question_id": 35184946, "link": "https://stackoverflow.com/questions/35184946/using-a-date-range-with-an-input-box-and-selecting-data-to-copy-and-paste/35188380#35188380", "title": "Using a Date Range with an Input Box and Selecting Data to Copy and Paste", "body": "<p>The code below will do what I believe you're trying to do.  Basically you were missing the code to actually paste the values into Sheet2 from Sheet1. </p>\n\n<p>I did the following:</p>\n\n<ul>\n<li>Added error checking to the date variables since clicking \"Cancel\" from the input box returned a False value; this caused the autofilter to error.</li>\n<li>Created <code>wkb</code> and <code>wks</code> variables to make the workbook and worksheet methos easier to follow.</li>\n<li>Added <code>wkb.Worksheets(\"Sheet2\").Range(\"A1\").PasteSpecial</code> to handler pasting the copied values into sheet 2.</li>\n<li><p>Reformatted method properities to follow VBA standards and not the skrewy Excel (\":=\") syntax.</p>\n\n<pre><code>Option Explicit\n\nSub Data_Date_Filter()\n  On Error GoTo ErrHandler\n\n  Dim wkb         As Excel.Workbook\n  Dim wks         As Excel.Worksheet\n  Dim sDate       As Variant\n  Dim eDate       As Variant\n\n  Set wkb = Application.ThisWorkbook\n\n  sDate = Application.InputBox(\"Enter the starting date as mm/dd/yyyy\", , , , , , , vbOKCancel)\n\n  eDate = Application.InputBox(\"Enter the Ending date as mm/dd/yyyy\", , , , , , , vbOKCancel)\n\n  'CHECK IF DATES ARE NULL DUE TO CANCEL BUTTON CLICK\n  If sDate = False Or eDate = False Then Exit Sub\n\n  'TURN OFF SCREEN UPDATING AND COPY/PASTE VALUES FROM SHEET1 TO SHEET2\n  Application.ScreenUpdating = False\n\n  wkb.Worksheets(\"Sheet2\").Cells.ClearContents\n\n  Set wks = wkb.Worksheets(\"Sheet1\"): wks.Activate\n\n  With wks\n     .Range(\"A1:D1\").AutoFilter\n     .Range(\"D1\").AutoFilter 4, \"&gt;=\" &amp; sDate, xlAnd, \"&lt;=\" &amp; eDate\n     .Range(\"D1\").CurrentRegion.SpecialCells(xlCellTypeVisible).Copy\n  End With\n\n  wkb.Worksheets(\"Sheet2\").Range(\"A1\").PasteSpecial\n\n  With Application\n      .CutCopyMode = False\n      .ScreenUpdating = False\n  End With\n\n  Set wks = Nothing: Set wkb = Nothing\n\n  ExitHandler:\n     Exit Sub\n\n  ErrHandler:\n     Stop: Debug.Print Err.Description: Err.Clear: Resume\nEnd Sub\n</code></pre></li>\n</ul>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 71, "user_id": 5866783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b84666cb4d9b38d8a9aa79f2bde7d659?s=128&d=identicon&r=PG&f=1", "display_name": "rakesh  seebaruth", "link": "https://stackoverflow.com/users/5866783/rakesh-seebaruth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1587, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1458605607, "creation_date": 1454524410, "last_edit_date": 1531164843, "question_id": 35184946, "link": "https://stackoverflow.com/questions/35184946/using-a-date-range-with-an-input-box-and-selecting-data-to-copy-and-paste", "title": "Using a Date Range with an Input Box and Selecting Data to Copy and Paste", "body": "<p>I am trying to perform the following sequence of actions:</p>\n\n<ol>\n<li>Open an input box where a start date would be entered, and put that date in a specified cell on a specified sheet.</li>\n<li>Open an input box where an end date would be entered, and put that date in a specified cell on a specified sheet.</li>\n<li>Select rows of data from a large dataset that falls between and/or on these dates.</li>\n<li>Copy that data to another sheet (<code>sheet2</code>).</li>\n</ol>\n\n<p>Sample data:</p>\n\n<pre><code>Sol Id  Acct No Name    DATE\n20  12  JOHN STEVE  16/09/2009\n20  13  ROBERT V    31/07/2011\n4   14  JOHNNY WALKER   30/04/2012\n20  15  LA PRUDENCEE    30/04/2013\n20  16  ddd 30/06/2013\n11  17  DD  16/09/2013\n20  18  EED 30/09/2013\n5   19  EED 01/10/2013\n20  20  DD  30/11/2013\n2   21  RRR 19/12/2013\n7   22  RDS 01/01/2014\n20  23  DSS 24/01/2014\n5   24  223 31/01/2014\n5   25  44  31/01/2014\n20  26  555 31/01/2014\n20  27  666 24/02/2014\n</code></pre>\n\n<p>The dates continue till 31/12/2016. I want to select the start date 16/09/2009, end date 31/12/2015, and paste in <code>sheet2</code>.</p>\n\n<p>My VBA code is:</p>\n\n<pre><code>Option Explicit\n\nSub Data_Date_Filter()\n\nDim sDate As Variant, eDate As Variant\n\nsDate = Application.InputBox(\"Enter the starting date as mm/dd/yyyy\", Type:=1 + 2)\neDate = Application.InputBox(\"Enter the Ending date as mm/dd/yyyy\", Type:=1 + 2)\n\nApplication.ScreenUpdating = False\n\nSheet2.Cells.ClearContents\n\nWith Sheet1\n    .AutoFilterMode = False\n    .Range(\"D1\").CurrentRegion.AutoFilter field:=2, Criteria1:=\"&gt;=\" &amp; sDate, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; eDate\n    .Range(\"D1\").CurrentRegion.SpecialCells(xlCellTypeVisible).Copy Sheet2.Range(\"A1\")\nEnd With\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>It does not copy to sheet 2.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "edited": false, "score": 0, "creation_date": 1454532846, "post_id": 35185120, "comment_id": 58092137, "body": "This works great except I have some tables that are 3 columns and others that are 4. Can we modify so that it looks for the last column in each loop? The above makes every table exactly the same size leaving some data outside of the table."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "edited": false, "score": 0, "creation_date": 1454533033, "post_id": 35185120, "comment_id": 58092251, "body": "@BenSimmons -  Yes, I missed that. Try my edit and see if that works for you in call cases."}, {"owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "edited": false, "score": 0, "creation_date": 1454613927, "post_id": 35185120, "comment_id": 58134873, "body": "@ScottHoltzman- the code above works great- thanks again. I&#39;m running into the issue where there may be a header row that doesn&#39;t have any data in the line right underneath it. So it does the (xlDown) command and takes part of the next table&#39;s data. What would the if/then statement look like to account for this?"}, {"owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "edited": false, "score": 0, "creation_date": 1454615569, "post_id": 35185120, "comment_id": 58135861, "body": "<code>IsEmpty(rngStart.Offset(1).value) then </code>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "edited": false, "score": 0, "creation_date": 1454682539, "post_id": 35185120, "comment_id": 58167569, "body": "@BenSimmons - DId you figure this out? If not, please post another question, and in that question please provide a screenshot sample of your data, as it will help SO understand the exact nuances of the situation."}, {"owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "edited": false, "score": 0, "creation_date": 1455507671, "post_id": 35185120, "comment_id": 58504207, "body": "yes sir- the edited code above was the solution I needed. Thanks for the help"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1454533008, "last_edit_date": 1454533008, "creation_date": 1454524974, "answer_id": 35185120, "question_id": 35184703, "link": "https://stackoverflow.com/questions/35184703/vba-excel-loop-through-worksheet-creating-tables/35185120#35185120", "title": "VBA Excel - Loop through worksheet creating tables", "body": "<p>Give this a shot:</p>\n\n<pre><code>Sub MakeTables()\n\nDim ws As Worksheet\nSet ws = Worksheets(\"Sheet1\") 'change as needed\n\nWith ws\n\n    'find last row of data in column A\n    Dim lRow As Long\n    lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n    Dim rngStart As Range\n    Set rngStart = .Range(\"A3\")\n\n    'set counter variable for naming tables\n    Dim i As Long\n    i = i + 1\n\n    Do\n\n        'create table range\n        Set rngTable = .Range(rngStart, rngStart.End(xlDown))\n\n        'create table\n        .ListObjects.Add(xlSrcRange, rngTable.Resize(rngTable.Rows.Count, rngStart.End(xlToRight).column), , xlYes).Name = \"Table\" &amp; i\n         'set style\n        .ListObjects(\"Table\" &amp; i).TableStyle = \"TableStyleLight9\"\n\n        'find next table range start\n        Set rngStart = rngTable.End(xlDown).Offset(2)\n\n        i = i + 1\n\n    Loop Until rngStart.Row &gt; lRow\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2457, "favorite_count": 0, "accepted_answer_id": 35185120, "answer_count": 1, "score": 0, "last_activity_date": 1454533008, "creation_date": 1454523713, "last_edit_date": 1454524178, "question_id": 35184703, "link": "https://stackoverflow.com/questions/35184703/vba-excel-loop-through-worksheet-creating-tables", "title": "VBA Excel - Loop through worksheet creating tables", "body": "<p>Created this macro to go through the entire worksheet and format each section as a table with a specific format. </p>\n\n<p>I'm trying to loop through the entire worksheet where and format each section as a table.</p>\n\n<p>Each section is separated by one blank row.</p>\n\n<p>Any ideas?    </p>\n\n<pre><code>Sub Macro8()\nRange(\"A3:B4\").Select\nActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$3:$B$4\"), , xlYes).Name = _\n    \"Table6\"\nRange(\"Table6[#All]\").Select\nActiveSheet.ListObjects(\"Table6\").TableStyle = \"TableStyleLight9\"\n\nSelection.End(xlDown).Select\nSelection.End(xlDown).Select\nRange(\"A6:B7\").Select\nActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$6:$B$7\"), , xlYes).Name = _\n    \"Table7\"\nRange(\"Table7[#All]\").Select\nActiveSheet.ListObjects(\"Table7\").TableStyle = \"TableStyleLight9\"\n\nSelection.End(xlDown).Select\nSelection.End(xlDown).Select\nRange(\"A9:D22\").Select\nActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$9:$D$22\"), , xlYes).Name = _\n    \"Table8\"\nRange(\"Table8[#All]\").Select\nActiveSheet.ListObjects(\"Table8\").TableStyle = \"TableStyleLight9\"\n\nSelection.End(xlDown).Select\nSelection.End(xlDown).Select\nRange(\"A24:D37\").Select\nActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$24:$D$37\"), , xlYes).Name = _\n    \"Table9\"\nRange(\"Table9[#All]\").Select\nActiveSheet.ListObjects(\"Table9\").TableStyle = \"TableStyleLight9\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1454525027, "post_id": 35184683, "comment_id": 58087236, "body": "This does the same as what your code does    <code>Sheets(&quot;Sheet1&quot;).Range(Range(&quot;C12&quot;), Sheets(&quot;Sheet1&quot;).Range(&quot;AD&quot; &amp; Sheets(&quot;Sheet1&quot;).UsedRange.Rows.Count)).SpecialCells(xlCellT&zwnj;&#8203;ypeBlanks) = 0</code>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1454525064, "post_id": 35184683, "comment_id": 58087263, "body": "Did you want to loop through column C and see if each row has data in it?"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1454525768, "post_id": 35184683, "comment_id": 58087673, "body": "Yeah b column has some date that is being dumped from another sheet dynamically,so if B column has no date,The data corresponding to date that is being filled from C to AD should also have nothing Only if there is date and no value is there corresponding to each columns then I want those blank cells zero"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454555051, "post_id": 35187434, "comment_id": 58100539, "body": "This is selecting even the rows that have no data in any cell.My code does the same. The columns are fixed from C12:AD12 but the rows are dynamic.I don&#39;t want zeroes for rows with no data."}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454555789, "post_id": 35187434, "comment_id": 58100743, "body": "If {sht.Activate} I do this instead, Range(&quot;c12:ad12&quot;). Select Set rng= Range(Selection,Selection.End(xlDown)) then the for loop,,,, it only fills the C12:AD12 and a row below it with blankspaces with zero.Why it isn&#39;t going going tills the rows down with Atleast a data in one cell?"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454557125, "post_id": 35187434, "comment_id": 58101104, "body": "How can I use a while loop where if the row has date information in b column then all the blank cells corresponding to that row are filled with zero"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454594265, "post_id": 35187434, "comment_id": 58121526, "body": "I want it like From: 03/03/2016 To: 30/03/2016 but the date format isn&#39;t working,its giving numbers like From:  42256 To: 42272,something like this."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1454532662, "creation_date": 1454532662, "answer_id": 35187434, "question_id": 35184683, "link": "https://stackoverflow.com/questions/35184683/filling-of-blank-cells-with-zero-using-vba-code/35187434#35187434", "title": "Filling of blank cells with zero using VBA code", "body": "<p>See how this works,</p>\n\n<pre><code>Sub ZeroStuff()\n    Dim LstRw As Long, rng As Range, sh As Worksheet, c As Range\n\n    Set sh = Sheets(\"Sheet1\")\n\n    With sh\n        LstRw = .Cells(.Rows.Count, \"C\").End(xlUp).Row + 1\n        Set rng = .Range(\"C12:C\" &amp; LstRw).SpecialCells(xlCellTypeBlanks)\n\n        For Each c In rng.Cells\n            .Range(c.Offset(, 1), c.Offset(, 27)) = 0\n        Next c\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10867, "favorite_count": 0, "accepted_answer_id": 35187434, "answer_count": 1, "score": 1, "last_activity_date": 1454532662, "creation_date": 1454523648, "last_edit_date": 1531164843, "question_id": 35184683, "link": "https://stackoverflow.com/questions/35184683/filling-of-blank-cells-with-zero-using-vba-code", "title": "Filling of blank cells with zero using VBA code", "body": "<pre><code>Sub FillEmptyCell()\n    Dim rng As Range\n    Dim i As Long\n    Dim cell As Range\n    Dim sht As Worksheet\n    Set sht = ActiveWorkbook.Sheets(\"Sheet1\")\n    sht.Activate\n\n    Set rng = Range(Range(\"C12\"), Range(\"AD\" &amp; sht.UsedRange.Rows.Count))\n\n    For Each cell In rng\n        If cell.Value = \"\" Then\n            cell.Value = \"0\"\n        End If\n\n    Next\nEnd Sub\n</code></pre>\n\n<p>I am trying to fill my blank spaces in sheet with zero dynamically.However,\nI don't want this to fill zeroes in row that have no data. can someone help please?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1454701985, "post_id": 35184210, "comment_id": 58179396, "body": "Are you still having problem?"}, {"owner": {"reputation": 13, "user_id": 5879292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/793f4df8c4cc0a5ae7009ce128a230dc?s=128&d=identicon&r=PG&f=1", "display_name": "C. Shirley", "link": "https://stackoverflow.com/users/5879292/c-shirley"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1456233336, "post_id": 35184210, "comment_id": 58843505, "body": "No! Finally. LoL. At first it did not work. . . But I retyped it &amp; for some reason that did the trick!  Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1454560761, "creation_date": 1454560761, "answer_id": 35192614, "question_id": 35184210, "link": "https://stackoverflow.com/questions/35184210/avoiding-printing-specific-pages/35192614#35192614", "title": "Avoiding printing specific page(s)", "body": "<p>Try the following</p>\n\n<pre><code>Option Explicit\nSub PagePrint()\n    With ActiveDocument\n        .PrintOut Range:=wdPrintFromTo, _\n            From:=Format(.Sections(1).Headers(1).PageNumbers.StartingNumber + 2), _\n            To:=Format(.Range.Information(wdActiveEndAdjustedPageNumber))\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5879292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/793f4df8c4cc0a5ae7009ce128a230dc?s=128&d=identicon&r=PG&f=1", "display_name": "C. Shirley", "link": "https://stackoverflow.com/users/5879292/c-shirley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 35192614, "answer_count": 1, "score": 0, "last_activity_date": 1454560761, "creation_date": 1454522053, "last_edit_date": 1454550074, "question_id": 35184210, "link": "https://stackoverflow.com/questions/35184210/avoiding-printing-specific-pages", "title": "Avoiding printing specific page(s)", "body": "<p>I have created a document for work. Due to security on the company computers the macro I have on the document is not automatically enabled. </p>\n\n<p>I added directions on Page 1 for how to enable it. Now when someone prints, it prints this instruction page. </p>\n\n<p>I tried to simulate a macro similar to the original one I used below, for not printing Blank Content Control, to print my instruction page as blank however, this was not effective.</p>\n\n<pre><code>Sub PrintReport()\nDim cc As ContentControl\n\nFor Each cc In ThisDocument.ContentControls\n    If Left(cc.Range.Text, 19) = \"Click here to enter\" Then\n        cc.Range.Font.ColorIndex = wdWhite\n    End If\nNext\n\nActiveDocument.PrintOut\n\nFor Each cc In ThisDocument.ContentControls\n   If Left(cc.Range.Text, 19) = \"Click here to enter\" Then\n        cc.Range.Font.ColorIndex = 15\n   End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I also tried to create a macro, using assistance from this site, to only print specific pages (ie. 2-5). This did not work. </p>\n\n<pre><code>Sub SpecialPgOnePrint()\n\nApplication.PrintOut FileName:=\"Visitation Report (Fillable-Final)\", _\n  Range:=wdPrintRangeOfPages, Pages:=\"2-5\"\n\nEnd Sub\n</code></pre>\n\n<p>I would appreciate help identifying a way to either A. not print page1 (preferable) or B. start printing at page2</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "conditional-formatting"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1454521737, "post_id": 35183844, "comment_id": 58085281, "body": "If you&#39;re on Excel 2007 or higher, use <code>COUNTIFS</code> instead of <code>SUMPRODUCT</code>."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1454548951, "post_id": 35183844, "comment_id": 58098938, "body": "What is the ultimate goal of finding the duplicates and marking them with a color? Do you wish to delete them or store them elsewhere or what? It might actually be solved a lot more elegantly."}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1454549107, "post_id": 35183844, "comment_id": 58098983, "body": "No, the solution is much more complicated. Basically, something has to be changed on one of each pair of duplicates (be it changing the Upcharge type or Upcharge level, etc) so they aren&#39;t exactly the same. All upcharges must stay."}], "answers": [{"comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1454521921, "post_id": 35184047, "comment_id": 58085405, "body": "This will not speed up the actual calculation; you turn it to xlCalculationManual and set it back. Excel will only calculate once this happens and then there&#39;s still a 10 min wait. It is true that in general this will speed up macro execution when referencing cells etc."}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1454524607, "post_id": 35184047, "comment_id": 58087009, "body": "This is useful information for me still as I can use it speed up my overall macro (a much bigger project), so thank you. I&#39;ve realized where my issue is and it&#39;s not within the application process of the formula, but when trying to filter that column anytime after the formulas have been applied. I&#39;ve updated my question to reflect this."}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1454548635, "post_id": 35184047, "comment_id": 58098858, "body": "I just realized I may have not implemented the &#39;calcstate = Application.Calculation&#39; code correctly since I just added that line of code and left out what looks like the second part &#39;Application.Calculation = xlCalculationManual&#39;. Even though @RikSportel has a point when talking about turning it off before applying the conditional formatting formula to the range, but would this actually help in my case where it would help the filter go quicker AFTER the conditional formatting formatting has been applied to the range?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4736025"}, "is_accepted": false, "score": 1, "last_activity_date": 1454521460, "creation_date": 1454521460, "answer_id": 35184047, "question_id": 35183844, "link": "https://stackoverflow.com/questions/35183844/how-to-apply-conditional-formatting-formula-to-large-range-faster/35184047#35184047", "title": "How to apply conditional formatting formula to large range faster", "body": "<p>Try turning off some Excel features before your code then turning them back on when it is done.</p>\n\n<pre><code>' turn off unnecessary excel features, put before your code\nscreenUpdateState = Application.ScreenUpdating\nstatusBarState = Application.DisplayStatusBar\ncalcState = Application.Calculation\neventsState = Application.EnableEvents\ndisplayPageBreakState = ActiveSheet.DisplayPageBreaks\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>' Turn features back on\nApplication.ScreenUpdating = screenUpdateState\nApplication.DisplayStatusBar = statusBarState\nApplication.Calculation = calcState\nApplication.EnableEvents = eventsState\nActiveSheet.DisplayPageBreaks = displayPageBreaksState\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1454580143, "creation_date": 1454580143, "answer_id": 35197897, "question_id": 35183844, "link": "https://stackoverflow.com/questions/35183844/how-to-apply-conditional-formatting-formula-to-large-range-faster/35197897#35197897", "title": "How to apply conditional formatting formula to large range faster", "body": "<p>This didn't help me before, but I hope it help you as <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840811.aspx\" rel=\"nofollow\">this link</a> said :</p>\n\n<blockquote>\n  <p>This is particularly useful when condition is applied over a large range as performance can be slow in these cases.</p>\n</blockquote>\n\n<pre><code>ActiveSheet.EnableFormatConditionsCalculation = False\n\n'.....\n\nActiveSheet.EnableFormatConditionsCalculation = True\n</code></pre>\n\n<p>Maybe this not work on MAC.\n<a href=\"http://answers.microsoft.com/en-us/mac/forum/macoffice2011-macexcel/activesheetenableformatconditionscalculation-not/e303f855-4e73-4d27-81c7-95df7131cc2b?db=5&amp;auth=1\" rel=\"nofollow\">ActiveSheet.EnableFormatConditionsCalculation Not Supported in VBA for Excel 2011 on the Mac</a></p>\n"}], "owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1175, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454580143, "creation_date": 1454520824, "last_edit_date": 1454536521, "question_id": 35183844, "link": "https://stackoverflow.com/questions/35183844/how-to-apply-conditional-formatting-formula-to-large-range-faster", "title": "How to apply conditional formatting formula to large range faster", "body": "<p>I created a conditional formatting formula</p>\n\n<pre><code>=AND(SUMPRODUCT(($A$2:$A$\" &amp; lastRow &amp; \"=$A2)*($CT$2:$CT$\" &amp; lastRow &amp; \"=$CT2)*($CU$2:$CU$\" &amp; lastRow &amp; \"=$CU2)*($CV$2:$CV$\" &amp; lastRow &amp; \"=$CV2)*($CW$2:$CW$\" &amp; lastRow &amp; \"=$CW2))&gt;1,$CT2 &lt;&gt; \"\"\"\")\"\n</code></pre>\n\n<p>To find &amp; highlight duplicate upcharges based on multiple criteria:\nProduct's XID (Column A), Upcharge Criteria 1 (Column CT), Upcharge Criteria 2 (Column CU), Upcharge Type (Column CV), and Upcharge Level (Column CW). The formula works like a charm highlighting upcharges that are duplicates; however, much of the time I have to apply it to a large number of rows (upwards of 15000) and it takes 10+ minutes to apply the conditional format formula. I was curious if there is a quicker way of applying this formula to that many cells. My entire code for reference is</p>\n\n<pre><code>'File Complete, highlights duplicate upcharges for products and skips over blank upcharge rows\nSub dupUpchargeCheck()\n\nDim lastRow As Integer\nlastRow = ActiveSheet.Cells(Rows.Count, \"CS\").End(xlUp).Row\nActiveSheet.Range(\"CS2:CS\" &amp; lastRow).Select\nWith ActiveSheet.Range(\"CS2:CS\" &amp; lastRow)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND(SUMPRODUCT(($A$2:$A$\" &amp; lastRow &amp; \"=$A2)*($CT$2:$CT$\" &amp; lastRow &amp; \"=$CT2)*($CU$2:$CU$\" &amp; lastRow &amp; \"=$CU2)*($CV$2:$CV$\" &amp; lastRow &amp; \"=$CV2)*($CW$2:$CW$\" &amp; lastRow &amp; \"=$CW2))&gt;1,$CT2 &lt;&gt; \"\"\"\")\"\n    .FormatConditions(.FormatConditions.Count).Interior.ColorIndex = 3\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Any advice is appreciated!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>After toying around a bit, I've realized my problem isn't with the application of the conditional formatting formula to the range of cells, but actually when I click the drop down to filter on the color (after the code is ran and the conditional formatting is applied) it takes forever for the filter dropdown box to appear (I assume because all of the formulas calculating at that time?). Any idea how I can get around that issue? I've tried one of @Nate suggestions of\n<code>calcState = Application.Calculation</code>, placing it right before the line where I filtered (via vba) in hopes that it would stop the calculations from running as the system attempted to show the filter box, but it still takes forever. With the addition <code>Application.ScreenUpdating = False</code> the processing time takes slightly less time (timed around 551 seconds for 15000 rows). I'm afraid that might be the best I'll be able to get it unless someone else has any suggestions?</p>\n"}, {"tags": ["python", "vba", "excel", "vsto"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1454522435, "post_id": 35183135, "comment_id": 58085713, "body": "Now that I re-read the initial question: &quot;the listener could catch this action, and print on the screen &quot;enter value XXX in cell XXX&quot; --&gt; Do you mean you want messages real time when someone else edits the file?"}, {"owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1454523635, "post_id": 35183135, "comment_id": 58086461, "body": "Yes, I want real time messages... but to simplify a little bit, we can assume just one person is editing the file..."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1454525121, "post_id": 35183135, "comment_id": 58087288, "body": "I doubt the VBA tag is in place here. VBA is slow by definition since it compiles at run time. Using the native tracking functionality you could set it to auto update changes every 5 minutes or so under the advanced options when making the workbook a shared one. Look into this <a href=\"https://support.office.com/en-us/article/Use-a-shared-workbook-to-collaborate-b8207fe9-a613-483f-b804-0ca4658b0c61?CorrelationId=9cd0ec96-6043-41fb-ab92-c49c3572e6e8&amp;ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>  As for truly real time external tracking: You would indeed need a custom application / service that an addin reports to I assume."}, {"owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1454525853, "post_id": 35183135, "comment_id": 58087728, "body": "I have read the links about tracking functionality, but I don&#39;t see how this could be connected to my external application written in Python or .NET. I could imagine that the change history (which can be displayed as a worksheet at the moment) could be useful, but still my external application needs to parse it, and even parsing a text message is easier than that, no?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1454526129, "post_id": 35183135, "comment_id": 58087904, "body": "Use VSTO to write a pre compiled add-in (for speed) that just sends messages to some Service written in any language. This service could then generate the pop-ups you want. However that&#39;s a wholly different question than initially asked.   Is there any purpose in this live-tracking that can not be solved by using the native collaboration functionality (e.g. update every 5 minutes)?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1454526445, "post_id": 35183135, "comment_id": 58088108, "body": "Additionally, in Office 365 there is more extensive collaboration functionality. I don&#39;t really have any experience using this, so I&#39;d advice to read up on the new functionality in the 365 suite and see if this helps you out. Never a great idea to reinvent the wheel."}, {"owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1454526738, "post_id": 35183135, "comment_id": 58088298, "body": "&quot;Use VSTO to write a pre compiled add-in (for speed) that just sends messages&quot; ==&gt; that interests me a lot. Could you please elaborate more? do you want me to open another question?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1454548746, "post_id": 35183135, "comment_id": 58098888, "body": "Basically write a COM addin in C# or something like that. Do some research. You basically create the same type of event logger as described in the answer and have that send messages to a service that generates pop-ups. You will need to create some interface between the two, the service will need to know how to deal with incoming messages being send from your add-in. For details I&#39;d advice indeed a new question. I don&#39;t have an immediate answer on how to program those things available, since it this will largely depend on requirements."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1454573968, "post_id": 35183135, "comment_id": 58108015, "body": "when i&#39;ve used this, the majority of the time its been scoped in the VBA method, and then moved to C#.NET as a VSTO addin, mine generally track a column in a worksheet in a book, so remember it can take a little longer to get new sheets/books added to this.  An XML or Text file i use in the more complex, to allow &quot;superusers&quot; to modify and add a book/sheet etc."}], "answers": [{"comments": [{"owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "edited": false, "score": 0, "creation_date": 1454520756, "post_id": 35183312, "comment_id": 58084651, "body": "So if I understand well, you are using VBA to listen to events, right? Is there a faster way to do so?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1454521164, "post_id": 35183312, "comment_id": 58084926, "body": "You could of course just use the native change tracker. See <a href=\"https://support.office.com/en-us/article/Track-changes-in-a-shared-workbook-22aea671-cac7-4fa3-845d-eeb23725bd15\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1454519118, "creation_date": 1454519118, "answer_id": 35183312, "question_id": 35183135, "link": "https://stackoverflow.com/questions/35183135/which-mechanism-allows-excel-to-communicate-users-manipulations-to-outside/35183312#35183312", "title": "Which mechanism allows Excel to communicate users&#39; manipulations to outside?", "body": "<p>You can event sink the Excel application,(in an addin to control all Excel sheets), via using an class with an Excel application object, using the with events statement</p>\n\n<p>so something like  (not tested as no access to vba at mo)</p>\n\n<p>in a class clsExcelListner </p>\n\n<pre><code>private withevents excelListner as Excel.Application \n\npublic sub initialise(ExcelApp as Excel.Application)\n    set excelListner =ExcelApp\nend sub\n</code></pre>\n\n<p>Then in Workbook Open</p>\n\n<pre><code>public cls_ExcelListner as clsExcelListner\npublic sub Workbook_Open()\n\n    set cls_ExcelListner = new clsExcelListner\n    cls_ExcelLister.Initialise(application)\n\nend sub\n</code></pre>\n\n<p>In the class, you can then use the worksheet change event.  These events that will help you do what you need are already in the workbook, things like worksheet change etc, may just be best to use those, as a listner would need to take into account all documents, and say the user savesAs, then how do you check its a doc to be listened to?</p>\n"}, {"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454521949, "post_id": 35183922, "comment_id": 58085420, "body": "This method, gives no control over the initialisation of the listener though, so if not in list to track then dont use for example, authorised to do so etc, users who need to for example, i&#39;ve used this a lot to track funds, and best to pass in the application object to a class, essentially both answers the same, apart from that :)  Hope we&#39;ve been of help."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454522347, "post_id": 35183922, "comment_id": 58085660, "body": "Essentially yes :) If user tracking is required however, this can still be checked in the class initialization. The EventLogger class should be abled to check who or what it needs to track imho, not the workbook. You could have a range with users to track in some external file and just check <code>application.username</code> against that during initialization. In case such stuff is needed OP should elaborate a bit on the exact scenario."}, {"owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "edited": false, "score": 0, "creation_date": 1454524385, "post_id": 35183922, "comment_id": 58086877, "body": "Guys, I just elaborated a little bit more in OP, what do you say?"}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 0, "last_activity_date": 1454521085, "creation_date": 1454521085, "answer_id": 35183922, "question_id": 35183135, "link": "https://stackoverflow.com/questions/35183135/which-mechanism-allows-excel-to-communicate-users-manipulations-to-outside/35183922#35183922", "title": "Which mechanism allows Excel to communicate users&#39; manipulations to outside?", "body": "<p>Nathan is already pointing in the right direction.\nHowever it could be done cleaner.</p>\n\n<p>First, you're gonna need the Listener class. Place the following in a class module that you call \"EventLogger\"</p>\n\n<pre><code>Private WithEvents ExcelListener As Excel.Application\n\nPrivate Sub Class_Initialize()\n    Set ExcelListener = Application\nEnd Sub\n\nPrivate Sub excelListener_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    MsgBox Sh.Name &amp; \"!\" &amp; Target.Address &amp; \" changed into \" &amp; Target.Value\nEnd Sub\n'Hook into any other events you wish.\n</code></pre>\n\n<p>In the Workbook Module place the following in Workbook_Open()</p>\n\n<pre><code>Public Sub Workbook_Open()\n    Set evLogger = New EventLogger\nEnd Sub\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Set evLogger = Nothing\nEnd Sub\n</code></pre>\n\n<p>Since the Initialize event of the class already sets the application, no more is needed. </p>\n\n<p>Lastly you need a regular module that has the global variable EventLogger:</p>\n\n<pre><code>Public evLogger As EventLogger\n</code></pre>\n\n<p>Now instead of the messagebox you could open a logfile and write every event, just append a huge string in memory and write it to a text file on close, log every single event, or whatever you want. Just expand the class to hold username, etc., be creative :)</p>\n\n<p>Save the whole workbook as an add-in and install in into user's Excel. \nEnjoy!</p>\n\n<p>When you only wish to track changes for a specific workbook, you can always use the native change tracker as documented here: <a href=\"https://support.office.com/en-us/article/Track-changes-in-a-shared-workbook-22aea671-cac7-4fa3-845d-eeb23725bd15\" rel=\"nofollow\">https://support.office.com/en-us/article/Track-changes-in-a-shared-workbook-22aea671-cac7-4fa3-845d-eeb23725bd15</a></p>\n"}], "owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "accepted_answer_id": 35183922, "answer_count": 2, "score": 1, "last_activity_date": 1454524757, "creation_date": 1454518691, "last_edit_date": 1454524757, "question_id": 35183135, "link": "https://stackoverflow.com/questions/35183135/which-mechanism-allows-excel-to-communicate-users-manipulations-to-outside", "title": "Which mechanism allows Excel to communicate users&#39; manipulations to outside?", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/office/bb687829.aspx#sectionSection0\" rel=\"nofollow\">Excel provides several options for developing applications that interface with it</a>.\nBut it seems that all these options permits of controlling Excel workbooks from outside. However, I want the other way around, precisely I would like to \"listen to\" users' manipulations on Excel workbooks. For example, the listener may be an add-in in Excel; when a user enter a value in a cell, the listener could catch this action, and print on the screen \"enter value XXX in cell XXX\". Does anyone know which mechanism is available to realise this?</p>\n\n<p><strong>Edit 1:</strong>\nThanks for the inputs of @Nathan_Sav and @Rik Sportel . So if I understand well, they are using VBA to listen to events and generate messages, and almost all the events can be caught. </p>\n\n<p>Let me elaborate what I really want to do. Actually, I want to have an application outside Excel (e.g., written in Python or .NET), and the application can do some operations according to users' manipulations on workbooks. If the application has to read the messages generated by the VBA listener, then parse them, then do corresponding operations, I am afraid that would be slow. Is there a direct (or inner) way to let the application connected to Excel and listen to users' manipulations.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1454519848, "creation_date": 1454519848, "answer_id": 35183560, "question_id": 35183081, "link": "https://stackoverflow.com/questions/35183081/searching-for-specific-data-and-copying-it-to-current-document/35183560#35183560", "title": "Searching for specific data, and copying it to current document", "body": "<p>This is possible. Just use Workbooks.Open as documented here:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff194819.aspx</a>\nAs a filename, just pass the cell value that holds said filename.</p>\n\n<p>Very basic example: Say cell A1 on Worksheets(1) holds the filepath + filename of the file you want to open.</p>\n\n<pre><code>Sub OpenFile()\nDim wb as WorkBook\nDim fRange as range\n\nSet wb = Application.Workbooks.Open(Worksheets(1).Range(\"A1\").value)\nWith wb\n    set fRange = .Sheets(1).Range(\"1:1\").find(\"Alpha\") 'Assuming Alpha is a header in row 1\n    'Do stuff with the cells below the found range\nEnd With\n\nSet fRange = Nothing\nSet wb = Nothing\nEnd Sub\n</code></pre>\n\n<p>You might want to store the ActiveWorkbook / ActiveSheet / Any reference to your mastersheet in a variable as well in order to make sure you can copy-paste from the right place to the right place.</p>\n"}, {"comments": [{"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1454597704, "post_id": 35183850, "comment_id": 58124011, "body": "Hi Elbert, thanks so much for the help! One question on the code, I understand most of it but was wondering where to alter which cells you take relative to the keywords. Say I find alpha but want to take 2 cells to the right instead? Is it even possible in short to have different conditions for each keyword?"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1454597980, "post_id": 35183850, "comment_id": 58124225, "body": "As you can see <code>c.Address</code> returns the address of the cell that has the <code>&quot;alpha</code> string. Then if you use <code>c.offset(row_Num , col_Num)</code> you can get the cells you want."}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1454600042, "post_id": 35183850, "comment_id": 58125826, "body": "ah, thank you so much! :) how did you get to be so proficient with vba?"}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1454935449, "post_id": 35183850, "comment_id": 58251072, "body": "Hi Elbert, Sorry to bring up an old topic but i have an additional question on how I might be able to adapt your code to alter the output. Would it be possible to specify different output locations for different values of &quot;i&quot; in FindValues(i)? So that for example for &quot;alpha&quot; the output is in column C but then for Bravo, the output is in Column D? I have tried a couple of things but to no success as the target locations are within the loop?"}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": 1, "last_activity_date": 1454598186, "last_edit_date": 1454598186, "creation_date": 1454520849, "answer_id": 35183850, "question_id": 35183081, "link": "https://stackoverflow.com/questions/35183081/searching-for-specific-data-and-copying-it-to-current-document/35183850#35183850", "title": "Searching for specific data, and copying it to current document", "body": "<p>Well, i would like to give another answer but, @RickSportel give a very good advice.</p>\n\n<p>Hope this will help. </p>\n\n<pre><code>Sub findDataIntoFiles()\n\n    Dim r\n    Dim findValues() As String 'heres goes all the values you want to search\n    Dim Wrbk As Workbook 'to store every workbook\n    Dim This As Workbook 'to store this workbook, where you got the macro\n    Dim sht As Worksheet 'to store every sheet of the workbooks\n    Dim i\n    Dim tmp\n    Dim counter\n    Dim c As Range\n    Dim firstAddress\n    Dim rng As Range 'the range with the files full path of the file names\n                     'Not just the names\n                     'or\n                     'if all the files are in the same folder, you can put the path\n                     'on a var, and concatenate the path with each file name\n\n    ReDim findValues(1 To 3) 'here redim the var, but you can declare it with the capacity you want\n    findValues(1) = \"Alpha\"\n    findValues(2) = \"Beta\"\n    findValues(3) = \"Gamma\"\n    counter = 0\n\n    r = Range(\"A1\").End(xlDown).Row 'to search the last row of the data with the workbooks names\n    Set rng = Range(Cells(1, 1), Cells(r, 1)) 'all the data is in column A\n    Set This = ThisWorkbook 'storing this workbook\n\n    For Each tmp In rng 'run this for every cell with the workbooks names\n        Workbooks.Open tmp 'the open the workbook\n        Set Wrbk = ActiveWorkbook 'store it ot use it\n        For Each sht In Wrbk.Worksheets 'here, for every sheet inside the workbook that i opened\n            For i = 1 To 3 'the qty of data inside findValues var'for every data inside the var\n                With sht.Range(Cells(1, 1), Range(\"A1\").SpecialCells(xlCellTypeLastCell))\n                'find inside the cells A1 and the LastCell of the sheet\n                Set c = .Find(findvalue(i), LookIn:=xlFormulas) 'you can chage ir to \"xlValues\"\n                    If Not c Is Nothing Then\n                        firstAddress = c.Address\n                        Do\n                            'This.Activate'go back to the macro workbook and store the data found\n                            tmp.Offset(0, 1).Value = tmp.Value 'the name/fullpath/path of the workbook\n                            tmp.Offset(0, 2).Value = sht.Name &amp; \"\\\" &amp; c.Address 'Sheet and address of the cell\n                            Set c = .FindNext(c) 'go to the next one\n                            counter = counter + 1 'and index for the columns where you will store the data\n                        Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n                    End If\n                End With\n            Next\n        Next sht\n    Next tmp\nEnd Sub\n</code></pre>\n\n<p>And this is basic, you need to itenerate over the cells with the workbooks names, if there is the full path just take that, but if not take the path (directory) where the files are and then concatenate and open the workbooks with <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819.aspx\" rel=\"nofollow\">Workbook.Open</a></p>\n\n<p>And go over every sheet of each worbook, and find the data you want. </p>\n\n<p><strong>Edit #1</strong>\nAs you ask in the comments this could give you the next cells where you found the seach string</p>\n\n<pre><code>c.Address ===&gt; Gives you the address (string) of the found cell ex. $G$4\nc.offset(2,2).address ===&gt; gives you the cell moving two rows and two columns from `c` and returns $I$6. If you put negative numbers you rest rows and columns. \n</code></pre>\n"}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 35183850, "answer_count": 2, "score": -1, "last_activity_date": 1456451721, "creation_date": 1454518528, "last_edit_date": 1456451721, "question_id": 35183081, "link": "https://stackoverflow.com/questions/35183081/searching-for-specific-data-and-copying-it-to-current-document", "title": "Searching for specific data, and copying it to current document", "body": "<p>I have created one macro to list all of the files that I need to grab data from in the first column of an Excel spreadsheet. Is it possible to search each of the files in the column and locate specific data using key words. For example the first column of my master document is:</p>\n\n<pre><code>file1\nfile2\nfile3\n</code></pre>\n\n<p>I want to search file1 then file2... for a keywords \"alpha\" \"beta\" \"gamma\" and then copy the numbers below those cells into a table in the master document. Is this possible, if so what avenue should I go down?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1454517149, "creation_date": 1454517149, "answer_id": 35182561, "question_id": 35182271, "link": "https://stackoverflow.com/questions/35182271/error-400-when-protecting-a-worksheet/35182561#35182561", "title": "Error 400 when protecting a worksheet", "body": "<p>Use the <code>UserInterfaceOnly</code> argument - this protects the sheet, but still allows any programmatic changes to occur without the need to unprotect and reprotect:</p>\n\n<pre><code>Sheets(\"Some Sheet\").Protect Password:=\"Pass123\", UserInterfaceOnly:=True\nSheets(\"Some Sheet\").Range(\"A1\").Value = \"Foo\" '// code runs without error\n</code></pre>\n\n<p>You can use the <code>Workbook_Open</code> event to ensure any required sheets are locked in this way and then there's no need to manage it in any further code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nFor Each ws In ThisWorkbook.Sheets\n    ws.Protect UserInterfaceOnly:=True\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 3510565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69114e62487bbd5e1a1e3fcc23a49a78?s=128&d=identicon&r=PG&f=1", "display_name": "Oil Drum Alley", "link": "https://stackoverflow.com/users/3510565/oil-drum-alley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1188, "favorite_count": 1, "accepted_answer_id": 35182561, "answer_count": 1, "score": 2, "last_activity_date": 1454517149, "creation_date": 1454516472, "question_id": 35182271, "link": "https://stackoverflow.com/questions/35182271/error-400-when-protecting-a-worksheet", "title": "Error 400 when protecting a worksheet", "body": "<p>Based on the value of a particular cell I need to, potentially, unprotect a worksheet, set a range to locked and reprotect the worksheet. Conversely if the value of the cell (in this case cell B4 is equal to \"work\") then I need to unprotect the worksheet, unlock the cells, and then reprotect the worksheet. The reason for this is that I want to stop the user tabbing to cells A8:B19 when cell B4 is not equal to work. When B4 = \"work\" the user can input numbers into cells A8:B19. There are limited options to input when B4 &lt;> \"work\" and I have the setting to only tab between unlocked cells checked which makes input easier.</p>\n\n<p>Currently I have this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"B4\")) Is Nothing Then\nIf Range(\"B4\").Value = \"work\" Then\n    Shapes(\"Rectangle 1\").Visible = False\n    Application.EnableEvents = False\n    ActiveSheet.Unprotect\n    ActiveSheet.Range(\"A8:B19\").Locked = True\n    ActiveSheet.Protect  \u2018When the code hits this line it throws error 400\n    Application.EnableEvents = True\nEnd If\nIf Range(\"B4\").Value &lt;&gt; \"work\" Then\n    Shapes(\"Rectangle 1\").Visible = True\n    Application.EnableEvents = False\n    ActiveSheet.Unprotect\n    ActiveSheet.Range(\"A8:B19\").Locked = True\n    ActiveSheet.Protect \u2018When the code hits this line it throws error 400\n    Application.EnableEvents = True\nEnd If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Clearly it depends on the value of cell B4 as to which \"ActiveSheet.Protect\" causes the error to occur, but it always does. Commenting out the offending line allows the VBA code to run as expected aside however it leaves the worksheet unlocked. I've tried moving the \"ActiveSheet.Protect\" line to further down the sub, calling it in a different sub etcetera and no luck, it always causes error 400. I'm aware that Elseif would no doubt be better practise however I changed from If, ElseIf End If to see if it made any difference. It didn't.</p>\n\n<p>Curiously, I tried a similar thing to prove the principle in another Excel sheet with the following code:</p>\n\n<pre><code>   Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"A1\")) Is Nothing Then\n    Dim i As Integer\n    If Cells(1, 1) = \"unlock\" Then\n        i = 1\n        Shapes(\"Oval 1\").Visible = False\n        Application.EnableEvents = False\n        ActiveSheet.Unprotect\n        For i = 1 To 5\n            Cells(i, 2) = i\n        Next i\n        ActiveSheet.Range(\"C1:C5\").Locked = False\n        ActiveSheet.Protect\n    ElseIf Cells(1, 1) &lt;&gt; \"unlock\" Then\n        i = 1\n        Shapes(\"Oval 1\").Visible = True\n        Application.EnableEvents = False\n        ActiveSheet.Unprotect\n        For i = 1 To 5\n            Cells(i, 2) = \"\"\n            Cells(i, 3) = \"\"\n        Next i\n        ActiveSheet.Range(\"C1:C5\").Locked = True\n        ActiveSheet.Protect\n    End If\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This works exactly as I'd expect, and doing a similar thing. Aside from the different cells and a for loop I can't see any difference between the two samples of code above with regards to the unprotect, change locked variable, protect process.</p>\n\n<p>Baffled, any help much appreciated.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1454516379, "post_id": 35181959, "comment_id": 58081418, "body": "Just do as stated in the <a href=\"http://superuser.com/questions/962710/how-to-make-microsoft-word-selection-behave-like-it-would-in-a-plain-text-editor\">answer</a> while recording the macro and you will get the desired code auto-generated plain and simple"}], "answers": [{"comments": [{"owner": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "edited": false, "score": 0, "creation_date": 1454588275, "post_id": 35183908, "comment_id": 58117528, "body": "Does this solution work on your system? On my Word 2016 it doesn&#39;t seem to work, even if I change Word settings according to <a href=\"http://superuser.com/a/962714/388634\">this post</a>. Your solution itself should do what is is supposed to do; for example, if I change -1 to -2, the last character is unchecked but the new line character is still present when I copy the selection to, say, a  plain text editor."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "edited": false, "score": 0, "creation_date": 1454611851, "post_id": 35183908, "comment_id": 58133684, "body": "It works fine for me, on both Word 2010 and Word 2016. At least as far as selecting properly. Copying to anywhere else is not part of your question or problem description - you really need to include EVERYTHING when you ask a question!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "edited": false, "score": 0, "creation_date": 1454611858, "post_id": 35183908, "comment_id": 58133686, "body": "FWIW this appears to also be the case when you select and copy manually. My best guess would be that this is inherent in how Word MUST put the informaton on the Clipboard for use in other applications. In the underlying, native Word Open XML Word MUST close the w:p (paragraph) tag, it can&#39;t just leave it hanging. If this is a problem for you, you need to work paragraph by paragraph. Then Word can pass just the w:r (text run), no Paragraph information needs to be attached as is the case when additional paragraphs are included."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1454521060, "creation_date": 1454521060, "answer_id": 35183908, "question_id": 35181959, "link": "https://stackoverflow.com/questions/35181959/vba-stop-word-from-adding-new-line-to-selected-text/35183908#35183908", "title": "VBA: Stop Word from adding new line to selected text", "body": "<p>When you work with selections on the keyboard you use Shift + Left/Right Arrow keys to change the extent of the selection. In the Word object model there's an equivalent you can use with the Range object; actually, there's a set of methods: MoveStart, MoveEnd, MoveWhile, MoveUntil</p>\n\n<p>In this case, you need the MoveEnd method. You can move the end point by a specific set of units, such as characters, words, paragraphs - you want to move by one character, going \"backwards\", so:</p>\n\n<pre><code>aRange.MoveEnd wdCharacter, -1\naRange.Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 380, "user_id": 3165682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b2478bc5ca718b37141274c4930109?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Miechowiecki", "link": "https://stackoverflow.com/users/3165682/pawel-miechowiecki"}, "is_accepted": false, "score": 0, "last_activity_date": 1496045363, "creation_date": 1496045363, "answer_id": 44237542, "question_id": 35181959, "link": "https://stackoverflow.com/questions/35181959/vba-stop-word-from-adding-new-line-to-selected-text/44237542#44237542", "title": "VBA: Stop Word from adding new line to selected text", "body": "<p>This should work:</p>\n\n<pre><code>doc.Paragraphs(1).Range.Select\nSelection.MoveEnd wdCharacter, -1\nSelection.Copy\n</code></pre>\n"}], "owner": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1007, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496045363, "creation_date": 1454515669, "last_edit_date": 1490005093, "question_id": 35181959, "link": "https://stackoverflow.com/questions/35181959/vba-stop-word-from-adding-new-line-to-selected-text", "title": "VBA: Stop Word from adding new line to selected text", "body": "<p>Whenever I select a section of text in MS Word using this code:</p>\n\n<pre><code>Dim aRange As Range\nSet aRange = ActiveDocument.Range( _\n Start:=ActiveDocument.Paragraphs(1).Range.Start, _\n End:=ActiveDocument.Paragraphs(3).Range.End)\n  aRange.Select\n</code></pre>\n\n<p>everything is fine except that Word automatically alters the selection to add a new line character at the end of the selection. How to avoid it? Perhaps it is possible to change the selection so that it will not include a new line character.</p>\n\n<p>My question is similar to another <a href=\"https://superuser.com/q/962710/388634\">one already asked</a>, but I would like it to do it using VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454515356, "post_id": 35181523, "comment_id": 58080657, "body": "I&#39;d place your commonly used macros in the Personal.xlsb.  As for removing macros, open the VBEditor (Alt+F11), then look in the workbook modules and worksheets for any code and remove."}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1454515554, "post_id": 35181523, "comment_id": 58080787, "body": "@BruceWayne , thanks bruce, what if I dont have a personal.xlsb or cannot find it?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454518409, "post_id": 35181523, "comment_id": 58083001, "body": "Check out <a href=\"https://support.office.com/en-us/article/Copy-your-macros-to-a-Personal-Macro-Workbook-aa439b90-f836-4381-97f0-6e4c3f5ee566\" rel=\"nofollow noreferrer\">this article</a>. Let me know if you still need some guidance!"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454519299, "post_id": 35181523, "comment_id": 58083684, "body": "@BruceWayne thanks bruce. Is there any chance you know how to change location of where excel loads personal.xlsb upon startup?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454520758, "post_id": 35181523, "comment_id": 58084655, "body": "I highly suggest not changing where <code>Personal.xlsb</code> is. Is there a reason you&#39;d want to move it from the default folder?"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454521389, "post_id": 35181523, "comment_id": 58085072, "body": "@BruceWayne , I have two XLSTART&#39;s. so their is confusion. It loads one locaiton but saves to another."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454522591, "post_id": 35181523, "comment_id": 58085810, "body": "Open the VB Editor and open the Immediate Window (CTRL+G), and type <code>Application.StartupPath</code> and see what it says. It should give you the folder that it&#39;s loading when Excel starts.  Or are you saying that it&#39;s not saving to the Personal.xlsb located there?"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454525379, "post_id": 35181523, "comment_id": 58087430, "body": "@BruceWayne I actually get an error when I type that in. <code>invalid use of property</code> .  To add, I have 2 folders I notice when i type in XLSTART into the search, <code>C:\\Program Files (x86)\\Microsoft Office\\Office14\\XLSTART</code> and <code>C:\\Users\\ladiesman\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454526384, "post_id": 35181523, "comment_id": 58088069, "body": "Ah, so sorry, type <code>?Application.StartupPath</code>.  I believe that it&#39;s going to be looking for the Personal.xlsb in the <code>AppData\\Roaming\\...\\XLSTART</code> folder."}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454526867, "post_id": 35181523, "comment_id": 58088367, "body": "@BruceWayne , I get <code>C:\\Users\\ladiesman\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART</code> , you were right master. but the problem is, it doesnt seem to load."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454526950, "post_id": 35181523, "comment_id": 58088416, "body": "Can you double click the .xlsb in that folder? If it doesn&#39;t load, can you explain how so? Is there an error it gives you?"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454533470, "post_id": 35181523, "comment_id": 58092512, "body": "@BruceWayne , I can open it fine and it loads, seems to save, I guess it just doesn&#39;t automatically load into excel on startup."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454533607, "post_id": 35181523, "comment_id": 58092587, "body": "Does the <i>other</i> Personal.xlsb load? Or none? A quick way to check is to open Excel, go to View -&gt; Macros, and then by &quot;Macros in&quot;, see if Personal.xlsb is a choice. From what it sounds like, any Personal.xlsb is <i>not</i> in that list, correct?"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454534191, "post_id": 35181523, "comment_id": 58092920, "body": "@BruceWayne , niether loads I guess,I only have choices of all open workbooks, this workbook and book1. but I did delete the other personal.xlsb in the <code>C:\\Program Files (x86)\\Microsoft Office\\Office14\\XLSTART</code>   .. also when i try to record a macro under personal macro workbook it doesnt work saying it must be open for recording."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1454535122, "post_id": 35181523, "comment_id": 58093417, "body": "Do you have a Personal.xlsb in the <code>\\AppData\\Roaming\\...\\XLSTART</code> folder?  Does <a href=\"https://forums.techguy.org/threads/solved-personal-xlsb-in-excel-2010-does-not-open-on-starting-excel.1049303/\" rel=\"nofollow noreferrer\">this thread</a> or <a href=\"http://www.mrexcel.com/forum/excel-questions/448694-personal-xlsb-file-not-loading-while-starting-excel.html\" rel=\"nofollow noreferrer\">this one</a> help?"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1454535719, "post_id": 35181523, "comment_id": 58093753, "body": "@BruceWayne , thank you master wayne. the 2nd one was able to solve it, that personal.xlsb was disabled for some reason."}], "owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1456449465, "creation_date": 1454514546, "last_edit_date": 1456449465, "question_id": 35181523, "link": "https://stackoverflow.com/questions/35181523/loading-set-macros-and-removing-set-macros", "title": "Loading Set Macro&#39;s and Removing Set Macros", "body": "<p>When I open Excel, automatically a workbook is loaded containing macros. I think a binary file? or in a personal macro set? How can I edit this? How do I stop these from loading and perhaps load other general macros instead? </p>\n\n<p>My purpose is to load my most common macros across any workbook at any time so I don't have to go hunting for them each time.</p>\n"}, {"tags": ["vba", "outlook", "automation"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1454531185, "post_id": 35181274, "comment_id": 58091051, "body": "What have you started, can we see your code and we will help you modify it"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1454804474, "post_id": 35181274, "comment_id": 58210173, "body": "The order of the items in the folder is whatever it was before. The order is not reliable, otherwise you could pick the first 20 or last 20. &quot;Sort only affects the order of items in a collection. It does not affect the order of items in an explorer view.&quot; This example demonstrates sorting a collection of items (myItems) in myFolder. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866960.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff866960.aspx</a>     Set myItems = myFolder.Items /     myItems.Sort &quot;[DueDate]&quot;, False Once sorted the collection (myItems), not the folder items (myFolder.Items), is used in the For loop.  For Each myItem In myItems"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1454715940, "post_id": 35203862, "comment_id": 58185641, "body": "Not sure this works in this code. I&#39;ve tried adding the line in to sort but it still picked the newest first. Thanks."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1454720415, "post_id": 35203862, "comment_id": 58186709, "body": "You could just take 20 from the other end but do not to that. It is not reliable. As indicated, sort a collection not the folder. Set itemsCol = inboxFolder.Items  / itemsCol.Sort &quot;[ReceivedTime]&quot;, False or True whichever way you need it to be. Again you could take 20 from either end of itemsCol but now it would be consistent."}, {"owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1454794837, "post_id": 35203862, "comment_id": 58207386, "body": "I&#39;ve updated the OP to show what I have now since the comments, but still no joy. No matter how it&#39;s sorted, it still gives the most recently received emails"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 1, "creation_date": 1454795449, "post_id": 35203862, "comment_id": 58207554, "body": "You need to use the itemsCol variable instead of using inboxFolder.Items in the loop."}, {"owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "edited": false, "score": 0, "creation_date": 1454796100, "post_id": 35203862, "comment_id": 58207726, "body": "Solved - Added solution above"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 1, "creation_date": 1454796520, "post_id": 35203862, "comment_id": 58207836, "body": "Also change the &quot;for&quot; line to use the itemsCol variable. Please mark the reply as answer if it answers your question."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1454596626, "creation_date": 1454596626, "answer_id": 35203862, "question_id": 35181274, "link": "https://stackoverflow.com/questions/35181274/how-do-i-create-a-macro-to-move-the-oldest-20-emails-from-the-bottom-of-my-inbox/35203862#35203862", "title": "How do I create a macro to move the oldest 20 emails from the bottom of my inbox to another folder in outlook?", "body": "<p>Sort the Items collection by ReceivedTime property, loop though the last 20 items (use a down loop - step -1) and move the items.</p>\n"}], "owner": {"reputation": 71, "user_id": 5878135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-SWBMidqVRds/AAAAAAAAAAI/AAAAAAAAAIo/L-bfHI8Zbp4/photo.jpg?sz=128", "display_name": "Chris Wakefield", "link": "https://stackoverflow.com/users/5878135/chris-wakefield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 35203862, "answer_count": 1, "score": 0, "last_activity_date": 1593041999, "creation_date": 1454513817, "last_edit_date": 1593041999, "question_id": 35181274, "link": "https://stackoverflow.com/questions/35181274/how-do-i-create-a-macro-to-move-the-oldest-20-emails-from-the-bottom-of-my-inbox", "title": "How do I create a macro to move the oldest 20 emails from the bottom of my inbox to another folder in outlook?", "body": "<p>I'm trying to move the bottom 20 emails to another folder in Outlook to another folder where the macro runs. I'm able to move then when selected but I don't want to have to select 20 from the bottom (oldest) first. I'd like to automate this bit too. </p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Here's what I have so far but it moves the most recent mail only, regardless of how the inbox is sorted:</p>\n\n<pre><code>Public Sub Move_Inbox_Emails()\n\nDim outApp As Object\nDim outNS As Object\nDim inboxFolder As Object\nDim destFolder As Object\nDim outEmail As Object\nDim inboxItems As Object\nDim i As Integer\nDim inputNumber As String\nDim numberToMove As Integer\n\n\n\ninputNumber = InputBox(\"Enter number of emails to move\")\nOn Error Resume Next\nnumberToMove = CInt(inputNumber)\nOn Error GoTo 0\nIf numberToMove &lt; 1 Then Exit Sub\n\nSet outApp = CreateObject(\"Outlook.Application\")\nSet outNS = outApp.GetNamespace(\"MAPI\")\nSet inboxFolder = outNS.GetDefaultFolder(olFolderInbox)\nSet destFolder = inboxFolder.Parent.Folders(\"Mobus\")             'Test folder at same level as Inbox\n\n'Sort Inbox items by Received Time\n\nSet itemsCol = inboxFolder.Items\nitemsCol.Sort \"[ReceivedTime]\", False\n\n'Loop through sorted items for the number entered by the user, up to the number of items in the Inbox\n\nFor i = inboxFolder.Items.Count To inboxFolder.Items.Count - numberToMove + 1 Step -1\n    If inboxFolder.Items(i).Class = OlObjectClass.olMail Then\n        Set outEmail = inboxFolder.Items(i)\n        'Debug.Print outEmail.ReceivedTime, outEmail.subject\n        outEmail.Move destFolder\n        End If\nNext\nEnd Sub\n</code></pre>\n\n<p>I've solved this now with some ideas from the commentors, thanks very much. This code now prompts for how many to move and takes them from the oldest first:</p>\n\n<pre><code>Public Sub Move_Inbox_Emails_From_Excel()\n\nDim outApp As Object\nDim outNS As Object\nDim inboxFolder As Object\nDim destFolder As Object\nDim outEmail As Object\nDim inboxItems As Object\nDim i As Integer\nDim inputNumber As String\nDim numberToMove As Integer\n\ninputNumber = InputBox(\"Enter number of emails to move\")\nOn Error Resume Next\nnumberToMove = CInt(inputNumber)\nOn Error GoTo 0\nIf numberToMove &lt; 1 Then Exit Sub\n\nSet outApp = CreateObject(\"Outlook.Application\")\nSet outNS = outApp.GetNamespace(\"MAPI\")\nSet inboxFolder = outNS.GetDefaultFolder(olFolderInbox)\nSet destFolder = inboxFolder.Parent.Folders(\"Mobus\")             'Test folder at same level as Inbox\n\n'Sort Inbox items by Received Time\n\nSet inboxItems = inboxFolder.Items\n'inboxItems.Sort \"[ReceivedTime]\", False     'ascending order (oldest first)\ninboxItems.Sort \"[ReceivedTime]\", True      'descending order (newest first)\n\n'Loop through sorted items for the number entered by the user, up to the number of items in the Inbox\n\nFor i = inboxFolder.Items.Count To inboxFolder.Items.Count - numberToMove + 1 Step -1\n    Set outEmail = inboxItems(i)\n    'Debug.Print i, outEmail.Subject\n    outEmail.Move destFolder\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "scheduled-tasks"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1454513252, "post_id": 35180965, "comment_id": 58079055, "body": "Have a look at this answer: <a href=\"http://stackoverflow.com/a/35064355/78522\">stackoverflow.com/a/35064355/78522</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": true, "score": 2, "last_activity_date": 1454516347, "creation_date": 1454516347, "answer_id": 35182224, "question_id": 35180965, "link": "https://stackoverflow.com/questions/35180965/programatically-change-criteria-dynamically-in-access/35182224#35182224", "title": "Programatically Change Criteria Dynamically in Access", "body": "<p>Put all the criteria in a table.  Open the table and loop through it.  Something like:</p>\n\n<pre><code>Set rec = CurrentDB.OpenRecordset(\"Select * from MyCriteriaTable\")\n\nDo While rec.EOF = False\n    strSQL = \"Select * From MyTable Where MyField1 = '\" &amp; rec(1) &amp; \"' AND MyField2 = '\" &amp; rec(2) &amp; \"'\"\n    MyReport.RecordSource = strSQL\n\n    rec.MoveNext \nLoop\n</code></pre>\n\n<p>This is \"aircode\" and won't work as written, but that's the general idea.</p>\n"}], "owner": {"reputation": 59, "user_id": 5175169, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d4a089f2685bf73c762344a499b71c94?s=128&d=identicon&r=PG", "display_name": "Don Ritchie", "link": "https://stackoverflow.com/users/5175169/don-ritchie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 35182224, "answer_count": 1, "score": 1, "last_activity_date": 1454516347, "creation_date": 1454512976, "question_id": 35180965, "link": "https://stackoverflow.com/questions/35180965/programatically-change-criteria-dynamically-in-access", "title": "Programatically Change Criteria Dynamically in Access", "body": "<p>I have an Access database that has a series of queries that build a list of inventory items that go into a report.  I have a macro that runs all of the queries and emails the report to one of my company's stores in the middle of the night so that the employees at the store can count the items when they arrive in the morning.  I run the macro automatically from the Windows Task Scheduler at the appropriate time in the middle of the night.</p>\n\n<p>However, this method is a bit clumsy.  I currently have a copy of the database for each store.  Each time I send out counts, I have to manually change the vendors' criteria inside of the queries for each copy for each store.  It is very time consuming.</p>\n\n<p>Is there a way I could programatically change the criteria in each query?  I know I can set up a pop-up to prompt the user to input the data.  I could also build a form that prompts for that information.  In a perfect world, my boss would like me to be able to give me a spreadsheet with a store number, a time and date, and a list of vendors and have a single copy of access spit out the report.  However, even an idea for me to do a quick \"Find and Replace\" would save me a ton of time and the effort of training someone else to dig around in a query.</p>\n\n<p>Any ideas?  Thanks!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 4, "creation_date": 1454512966, "post_id": 35180898, "comment_id": 58078818, "body": "You do realize that x, y and z are just labels in math. They can be renamed to anything and mean the same thing. So <code>z=x+y</code> is the same as <code>a=b+c</code> etc. So like <code>z=x+y</code> IS <code>z=B1+B2</code>. The excel formula IS the real formula."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 1, "creation_date": 1454513105, "post_id": 35180898, "comment_id": 58078937, "body": "You want to get the formula via VBA???"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1454513432, "post_id": 35180898, "comment_id": 58079179, "body": "You could name the ranges: B1 = &quot;x&quot;,B2 = &quot;y&quot;... Then your formula would be <code>=x*y+z</code>"}, {"owner": {"reputation": 8321, "user_id": 1213006, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/utGQE.jpg?s=128&g=1", "display_name": "rhughes", "link": "https://stackoverflow.com/users/1213006/rhughes"}, "edited": false, "score": 0, "creation_date": 1454513694, "post_id": 35180898, "comment_id": 58079369, "body": "You can either select the cell and press <code>F2</code> or simply look in the editor window at the top of Excel. If you are using this formula in multiple places though, you may be better off using a name."}, {"owner": {"reputation": 41, "user_id": 5813406, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf15284158226a61b8797619dc9224ea?s=128&d=identicon&r=PG&f=1", "display_name": "D.Yang", "link": "https://stackoverflow.com/users/5813406/d-yang"}, "edited": false, "score": 0, "creation_date": 1454513706, "post_id": 35180898, "comment_id": 58079378, "body": "@ Elbert Villarreal via VBA would be acceptable, any kind of suggestions are welcomed, just looking for a solution which is best suited for me. re-type all the formula manually would be extremely time consuming."}, {"owner": {"reputation": 41, "user_id": 5813406, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf15284158226a61b8797619dc9224ea?s=128&d=identicon&r=PG&f=1", "display_name": "D.Yang", "link": "https://stackoverflow.com/users/5813406/d-yang"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1454513876, "post_id": 35180898, "comment_id": 58079494, "body": "@ScottCraner Thank you for your comment, I&#39;ve tried your advice, name ranges first , but excel formula remains to be in &quot;reference&quot;-style instead of &quot;name&quot;-style."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454514280, "post_id": 35180898, "comment_id": 58079817, "body": "@D.Yang - just to be clear ... the formula expression in excel is written <code>=B1*B2+B3</code> and what you want to extract is <code>1*2+3</code>? You want to extract the values that the cell references are working with in the actual formula?"}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1454514374, "post_id": 35180898, "comment_id": 58079891, "body": "@ScottCraner Your method would work, but you would have to go re-write all of the formulas with the names instead of cell references. But this could be a solution"}, {"owner": {"reputation": 41, "user_id": 5813406, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf15284158226a61b8797619dc9224ea?s=128&d=identicon&r=PG&f=1", "display_name": "D.Yang", "link": "https://stackoverflow.com/users/5813406/d-yang"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454514550, "post_id": 35180898, "comment_id": 58080011, "body": "@ScottHoltzman what I want to extract is a=x*y+z"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454514793, "post_id": 35180898, "comment_id": 58080223, "body": "@D.Yang - will there always be specific variable / letters associated with the formula? or do you just need the formula structure placed into a <code>a=x*y+z</code>. Also what if the formula is a <code>vlookup</code> or <code>sumif</code> or <code>countif</code>? Better yet, can you place a screenshot with a few of the formulas you want to convert and what you expect to see after the transformation?"}, {"owner": {"reputation": 41, "user_id": 5813406, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf15284158226a61b8797619dc9224ea?s=128&d=identicon&r=PG&f=1", "display_name": "D.Yang", "link": "https://stackoverflow.com/users/5813406/d-yang"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454516144, "post_id": 35180898, "comment_id": 58081220, "body": "@ScottHoltzman  no vlookup,sumif or countif, only ordinary formula <code>+ - * &#47; ^ </code>and <code>sqrt()</code>.  as you can see in the question,  each number has a letter which located next to it, and no duplicate letter allowed in my excel sheet, so yes, there will always be specific letter associated with the formula. What I really need is THE string <code>a=x*y+z</code>, and this string will be be evaluated by a javascript application."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454517704, "post_id": 35180898, "comment_id": 58082475, "body": "@D.Yang - I think VBA is the only way to do what you want. I have provided a solution as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1454514194, "post_id": 35181287, "comment_id": 58079745, "body": "another answer best suited as a comment?"}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 2, "last_activity_date": 1454513860, "creation_date": 1454513860, "answer_id": 35181287, "question_id": 35180898, "link": "https://stackoverflow.com/questions/35180898/how-to-get-real-formula-from-excel-formula/35181287#35181287", "title": "how to get real formula from EXCEL formula", "body": "<p>@Wyatt, you have the first part right, but it's not sufficient: once you have clicked the \"Show Formulas\", you also need to to \"Goto Special, Formulas\" (Ctrl+G, Special, Formulas). As you have clicked the \"Show Formulas\", you now do copy/paste into some text editor, and you have all the formulas, used in your Excel sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 4, "last_activity_date": 1454517672, "creation_date": 1454517672, "answer_id": 35182742, "question_id": 35180898, "link": "https://stackoverflow.com/questions/35180898/how-to-get-real-formula-from-excel-formula/35182742#35182742", "title": "how to get real formula from EXCEL formula", "body": "<p>After defining what it is that you are after, I think a VBA solution is the way to go. And since you noted that it was acceptable, I have provided one for you.</p>\n\n<p>The following Function will return the string <code>a=x*y+z</code> and will work so long as all your formulas are set up exactly in the manner given in your example.</p>\n\n<pre><code>Function ListRealFormula(rng As Range, ws As Worksheet) As String\n\nDim sFormula As String\n\nsFormula = rng.Offset(, -1) &amp; rng.Formula\n\nWith rng\n\n    Dim d As Range\n    For Each d In .DirectPrecedents\n\n        Dim sValue As String, sAdd As String\n        sAdd = d.Address(0, 0)\n        sValue = ws.Range(sAdd).Offset(, -1).Value2\n        sFormula = Replace(sFormula, sAdd, sValue)\n\n    Next\n\nEnd With\n\nListRealFormula = sFormula\n\nEnd Function\n</code></pre>\n\n<p>You can call the function like so:</p>\n\n<pre><code>Sub GrabFormula()\n\nDim s As String\n\ns = ListRealFormula(Sheet1.Range(\"B4\"), Sheet1)\nDebug.Print s\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5813406, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf15284158226a61b8797619dc9224ea?s=128&d=identicon&r=PG&f=1", "display_name": "D.Yang", "link": "https://stackoverflow.com/users/5813406/d-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 35182742, "answer_count": 2, "score": 2, "last_activity_date": 1456978660, "creation_date": 1454512763, "last_edit_date": 1456978660, "question_id": 35180898, "link": "https://stackoverflow.com/questions/35180898/how-to-get-real-formula-from-excel-formula", "title": "how to get real formula from EXCEL formula", "body": "<pre><code>      | A   |  B\n------|-----|--------\n    1 |  x  |   1\n    2 |  y  |   2\n    3 |  z  |   3\n    4 |  a  |   =B1*B2+B3\n</code></pre>\n\n<p>imagine the above stuff is part of an excel sheet, and B4 has a formula <code>=B1*B2+B3</code>.</p>\n\n<p>Is it possible to extract the real formula from excel formula? i.e. in the above example, the real formula is <code>a=x*y+z</code> </p>\n\n<p>the reason why i want to do the \"transformation\" is that I have many excel sheets filled with data and formulas, and now I want to quit Excel and use javascript for calculation, so I want to have the real formulas . </p>\n"}, {"tags": ["excel", "charts", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454511962, "post_id": 35180411, "comment_id": 58078039, "body": "what range do you have selected when you run the code to get the chart? if the active cell is within the chart data range, it will automatically populate the whole range when you add the chart. Try placing this line after <code>Set sh = ..</code> - <code>sh.Range(&quot;A15&quot;).Select</code>"}, {"owner": {"reputation": 137, "user_id": 5689991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4debf3c3c90d84b8f79a8f088674f6?s=128&d=identicon&r=PG&f=1", "display_name": "Michthan", "link": "https://stackoverflow.com/users/5689991/michthan"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454578130, "post_id": 35180411, "comment_id": 58110571, "body": "hello Scott, when I try this, i get a blank chart."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454594453, "post_id": 35180411, "comment_id": 58121673, "body": "this worked for me as is with the exception of having to add a <code>.SeriesCollection.NewSeries</code> before adding the 2nd series. Perhaps try changing the <code>sh.Range(&quot;C1&quot;)</code> line to &quot;=&quot; &amp; sh.Name &amp; &quot;!&quot; &amp; sh.Range(&quot;$C$1&quot;).Address` and follow suit for the other <code>Name, XValues, and Values</code> calls."}, {"owner": {"reputation": 137, "user_id": 5689991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4debf3c3c90d84b8f79a8f088674f6?s=128&d=identicon&r=PG&f=1", "display_name": "Michthan", "link": "https://stackoverflow.com/users/5689991/michthan"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454597516, "post_id": 35180411, "comment_id": 58123877, "body": "Does it also work for you when you have data from A1:F50? Because it allways shows everything and only for the 2 series it is changed to 10 datapoints insted of 50..."}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 5689991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4debf3c3c90d84b8f79a8f088674f6?s=128&d=identicon&r=PG&f=1", "display_name": "Michthan", "link": "https://stackoverflow.com/users/5689991/michthan"}, "is_accepted": false, "score": 0, "last_activity_date": 1454599747, "creation_date": 1454599747, "answer_id": 35204999, "question_id": 35180411, "link": "https://stackoverflow.com/questions/35180411/plotting-the-wanted-ranges-in-xyscatter-graph-with-vba/35204999#35204999", "title": "plotting the wanted ranges in xyscatter graph with VBA", "body": "<pre><code>  Sub grafieken()\n\nDim MySh As Worksheet\nDim chrt As Chart\nDim naaaam As String\n\nnaaam = ActiveWorkbook.ActiveSheet.Name\n\nSet MySh = ActiveWorkbook.Worksheets(naaam)\nSet chrt = MySh.Shapes.AddChart.Chart\n\n With chrt\n'Data?\n.SetSourceData Source:=Sheets(naaam).Range(\"A1:B11\")\n.ChartType = xlXYScatter\n.SeriesCollection.Add Source:=ActiveSheet.Range(\"E1:E11\")\n'.SeriesCollection.NewSeries\n.SeriesCollection(1).Name = ActiveSheet.Range(\"$C$1\")\n.SeriesCollection(1).XValues = ActiveSheet.Range(\"$A$2:$A$11\")\n.SeriesCollection(1).Values = ActiveSheet.Range(\"$C$2:$C$11\")\n\n'Titles?\n.HasTitle = True\n.ChartTitle.Characters.Text = naaam\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I found a way, I first needed to define the source data for the first series, and change them later into the one I want, this way no unwanted series appears. </p>\n"}], "owner": {"reputation": 137, "user_id": 5689991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4debf3c3c90d84b8f79a8f088674f6?s=128&d=identicon&r=PG&f=1", "display_name": "Michthan", "link": "https://stackoverflow.com/users/5689991/michthan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 462, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454599747, "creation_date": 1454511551, "last_edit_date": 1531164843, "question_id": 35180411, "link": "https://stackoverflow.com/questions/35180411/plotting-the-wanted-ranges-in-xyscatter-graph-with-vba", "title": "plotting the wanted ranges in xyscatter graph with VBA", "body": "<p>I am trying to create a xy plot where the x values is the time axis (column A) and the y values are in the other columns. (in the example only C and D)\nWhen I try my code from below, I get a graph with time axis (so column A) and y values all the other columns (B, C, D, E,...) which is unwanted.</p>\n\n<p>I can see that the .seriescollection(1) and (2) overwrite the default y-values (because my range is smaller), but all the others (column B, D, E,...) still remains in the graph.</p>\n\n<p>Any thoughts why? Thanks in advance!</p>\n\n<pre><code>    Sub grafieken()\n'\n' grafieken Macro\n'\nDim sh As Worksheet\nDim chrt As Chart\nDim naaaam As String\n\nnaaam = ActiveWorkbook.ActiveSheet.Name\n\nSet sh = ActiveWorkbook.Worksheets(naaam)\nSet chrt = sh.Shapes.AddChart.Chart\nWith chrt\n    'Data?\n    .ChartType = xlXYScatter\n    .SeriesCollection.NewSeries\n    .SeriesCollection(1).Name = sh.Range(\"$C$1\")\n    .SeriesCollection(1).XValues = sh.Range(\"$A$2:$A$11\")\n    .SeriesCollection(1).Values = sh.Range(\"$C$2:$C$11\")\n    .SeriesCollection(2).Name = sh.Range(\"$D$1\")\n    .SeriesCollection(2).XValues = sh.Range(\"$A$2:$A$11\")\n    .SeriesCollection(2).Values = sh.Range(\"$D$2:$D$11\")\n\n    'Titles?\n    .HasTitle = True\n    .ChartTitle.Characters.Text = naaam\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454511536, "post_id": 35180366, "comment_id": 58077738, "body": "A friend told that the format of the cells is differing.How can I paste the format of one cell in which it is working fine to this cell?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1454511708, "post_id": 35180366, "comment_id": 58077855, "body": "<b>Help us to help you; post your current code.</b>"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1454511752, "post_id": 35180366, "comment_id": 58077879, "body": "Hey I just got my code working.Thanks :)"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1454511772, "post_id": 35180366, "comment_id": 58077897, "body": "The formatting of cells was differing actually."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1454513481, "post_id": 35180366, "comment_id": 58079210, "body": "Then you should either delete the question, or reply yourself and mark your answer as the answer, in order to close the question"}], "answers": [{"tags": [], "owner": {"reputation": 3970, "user_id": 2757925, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a6804067a1c00a041299978a7b580ace?s=128&d=identicon&r=PG&f=1", "display_name": "V.K.", "link": "https://stackoverflow.com/users/2757925/v-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1454512554, "creation_date": 1454512554, "answer_id": 35180815, "question_id": 35180366, "link": "https://stackoverflow.com/questions/35180366/vba-excel-invisibility-if-data-in-cells/35180815#35180815", "title": "Vba excel: invisibility if data in cells", "body": "<p>If you are blaming the wrong format you have two options:</p>\n\n<p>a) clear the format of the destination cells, e.g. <code>Worksheets(\"DestinationSheet\").Range(\"A1:A6\").ClearFormats</code> and then copy the data without formatting</p>\n\n<p>b) copy the format from some cell whose format is correct, e.g. <code>Worksheets(\"DestinationSheet\").Range(\"B1\").Copy Destination:=Worksheets(\"Sheet1\").Range(\"A1:A6\")</code> and then copy the data without formatting (this means you copy good format but wrong data first, but then in the next action you are going to overwrite the wrong data with good data)</p>\n\n<p>Note 1: to copy the data without formatting it is better to use direct assignment <code>Worksheets(\"DestinationSheet\").Range(\"A1:A61\").Value = Worksheets(\"SourceSheet\").Range(\"A1:A6\").Value</code> than Copy function</p>\n\n<p>Note 2: In my view it is always better to avoid using Copy &amp; Paste in two commands because you are messing with the system clipboard, which it dangerous at least. Just imagine the user wants to use the clipboard in another program at the same time you are running the macro in Excel... To my best knowledge, the Copy function above (without being followed by Paste) does not use the system clipboard (please someone do correct me if I am wrong)</p>\n"}], "owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 35180815, "answer_count": 1, "score": -1, "last_activity_date": 1479843833, "creation_date": 1454511407, "last_edit_date": 1531164843, "question_id": 35180366, "link": "https://stackoverflow.com/questions/35180366/vba-excel-invisibility-if-data-in-cells", "title": "Vba excel: invisibility if data in cells", "body": "<p>I am dumping data from one sheet to another using vba code .All cells are getting correctly populated except 6 cells in the beginning.Actually the data us populated in these cells but its not visible until I double click on the cells.What is going wrong.Can someone help?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1454511291, "post_id": 35180279, "comment_id": 58077568, "body": "Show us how wks is declared and set."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 1, "creation_date": 1454511345, "post_id": 35180279, "comment_id": 58077611, "body": "yeah... where did you declare that wks is your worksheet? is wks even declared? If no you should declare it as worksheet and then &quot;WKS = WB.sheets(2)&quot; you don&#39;t have to select it to run a code on it. Avoid selection if possible..."}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1454513628, "post_id": 35180658, "comment_id": 58079320, "body": "This doesn&#39;t really answer the question. Also, whilst rewriting the OP&#39;s code why not combine the with statements and declare <code>WKS</code> next to <code>WB</code> then just use <code>.Activate</code> and <code>.select</code> in the with block. Otherwise this is just inefficient code"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1454513982, "post_id": 35180658, "comment_id": 58079576, "body": "I put comments in my answer, adding the missing part, to explain what is needed. I don&#39;t merge the <code>with</code> because is not part of the question, and try to let the code as the user does. My ansewer acomplish what the user ask. But thanks for your feedback."}, {"owner": {"reputation": 19, "user_id": 5778574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa850ff0a7ded95086ac7374c1ddb77d?s=128&d=identicon&r=PG&f=1", "display_name": "RyszardJ", "link": "https://stackoverflow.com/users/5778574/ryszardj"}, "edited": false, "score": 1, "creation_date": 1454534171, "post_id": 35180658, "comment_id": 58092903, "body": "I had to delete line &#39;Set WB= This workbook &#39;or any other&#39; workbook as WKS was declared earlier in code.  But it WORKS !!"}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": -1, "last_activity_date": 1454513196, "last_edit_date": 1454513196, "creation_date": 1454512152, "answer_id": 35180658, "question_id": 35180279, "link": "https://stackoverflow.com/questions/35180279/why-does-activesheet-fail/35180658#35180658", "title": "Why does ActiveSheet fail", "body": "<p>Here is my answer: </p>\n\n<pre><code>Option Explicit\nSub TestActivesheet()\n    Dim WB As Workbook 'Declare de vars\n    Dim WKS As Worksheet\n\n    Set WB = ThisWorkbook 'Or any other workbook || set the var\n    WB.Sheets(2).Activate\n    WB.Sheets(2).Select\n\n    Set WKS = WB.Sheets(2) 'Again set the var\n\n    With WKS\n        .Range(.Cells(3, 3), .Cells(ClientRows, SavedColumn - 1)).Locked = False\n        .Range(.Cells(3, 3), .Cells(ClientRows, SavedColumn - 1)).FormulaHidden = False\n    End With\n\n    With WKS\n        .Range(.Cells(3, 1), .Cells(ClientRows, 1)).Locked = False\n        .Range(.Cells(3, 1), .Cells(ClientRows, 1)).FormulaHidden = False\n    End With\n\n    'ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n    WKS.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n    'ActiveSheet.EnableSelection = xlUnlockedCells\n    WKS.EnableSelection = xlUnlockedCells\nEnd Sub\n</code></pre>\n\n<p>Always in the top of every module, is a good practice to use this <code>Option Explicit</code>, this way when you use a variable, the compiler ask you to declare it, and avoid this errors. </p>\n"}], "owner": {"reputation": 19, "user_id": 5778574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa850ff0a7ded95086ac7374c1ddb77d?s=128&d=identicon&r=PG&f=1", "display_name": "RyszardJ", "link": "https://stackoverflow.com/users/5778574/ryszardj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 35180658, "answer_count": 1, "score": 0, "last_activity_date": 1454513196, "creation_date": 1454511207, "question_id": 35180279, "link": "https://stackoverflow.com/questions/35180279/why-does-activesheet-fail", "title": "Why does ActiveSheet fail", "body": "<pre><code> WB.Sheets(2).Activate\n        WB.Sheets(2).Select\n\n         With WKS\n            .Range(.Cells(3, 3), .Cells(ClientRows, SavedColumn - 1)).Locked = False\n            .Range(.Cells(3, 3), .Cells(ClientRows, SavedColumn - 1)).FormulaHidden = False\n        End With\n\n        With WKS\n            .Range(.Cells(3, 1), .Cells(ClientRows, 1)).Locked = False\n            .Range(.Cells(3, 1), .Cells(ClientRows, 1)).FormulaHidden = False\n        End With\n\n        ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n        ActiveSheet.EnableSelection = xlUnlockedCells\n</code></pre>\n\n<p>I am looping through a data table and producing multiple Excel worksheets. The attached code works perfectly the first time but the fails with \"Object Variable or With Block variable not set\". Can anyone help.  Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1454520301, "post_id": 35180161, "comment_id": 58084360, "body": "And what does this have to do with Excel? You use Excel and Excel-VBA tags in your question, but Excel doesn&#39;t appear to be involved...?"}, {"owner": {"reputation": 1, "user_id": 5878412, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156506232650442/picture?type=large", "display_name": "Chris Rutter", "link": "https://stackoverflow.com/users/5878412/chris-rutter"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1454686506, "post_id": 35180161, "comment_id": 58170439, "body": "A lot of the formula and code can be used from Excel to Google sheets."}], "owner": {"reputation": 1, "user_id": 5878412, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156506232650442/picture?type=large", "display_name": "Chris Rutter", "link": "https://stackoverflow.com/users/5878412/chris-rutter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1454515284, "creation_date": 1454510896, "last_edit_date": 1592644375, "question_id": 35180161, "link": "https://stackoverflow.com/questions/35180161/google-sheets-adding-multiple-cells-from-1-sheets-referencing-a-list-from-anot", "title": "Google Sheets - Adding multiple cells from 1 sheets referencing a list from another", "body": "<p>So, I've been looking and trying to work this out for a while, but still haven't got anywhere, so asking for help.</p>\n<p>I've got two Google Sheets.</p>\n<ol>\n<li><a href=\"https://goo.gl/J4wkSL\" rel=\"nofollow noreferrer\">Data</a></li>\n<li><a href=\"https://goo.gl/zydPaa\" rel=\"nofollow noreferrer\">The Query</a></li>\n</ol>\n<p>The idea is to total the number in the 2nd column on the example numbers sheet with reference to the list on the example query 2nd tab number list and put the total in the relevant month on the example query data tab.</p>\n<p>As you can see, I've got it working with a query=</p>\n<pre><code>QUERY( ImportRange( &quot;1wgi_Q9wTHvVx37p6qNUyZzaXSeLJsS2Zl7KI1v0xgJo&quot; , A2 &amp; &quot;!A:B&quot;  ) , &quot;select Col2 where Col1 = &quot;&amp;'number list'!$A$2 , 0 )\n</code></pre>\n<p>But, this only looks for the first number in 'number list'!$A$2</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 3623441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf478a27375c1f70408e6b3a5042d2a3?s=128&d=identicon&r=PG&f=1", "display_name": "ArnoldasM", "link": "https://stackoverflow.com/users/3623441/arnoldasm"}, "is_accepted": true, "score": 0, "last_activity_date": 1454511635, "creation_date": 1454511635, "answer_id": 35180445, "question_id": 35179859, "link": "https://stackoverflow.com/questions/35179859/position-picture-horizontally-in-center/35180445#35180445", "title": "Position picture horizontally in center", "body": "<p>Found out answer:</p>\n\n<pre><code>    Sub InsertPictureInRange(PictureFileName As String, TargetCells As Range)\n    Dim p As Object, t As Double, l As Double, r As Double, b As Double\n    Dim aspect\n    Dim w, h\n    If TypeName(ActiveSheet) &lt;&gt; \"Worksheet\" Then Exit Sub\n    If Dir(PictureFileName) = \"\" Then Exit Sub\n    l = 1: r = 22    ' co-ordinates of top-left cell\n    t = 47: b = 88    ' co-ordinates of bottom-right cell\n    Set TargetCells = Range(\"A47:V88\")\n    Set p = ActiveSheet.Pictures.Insert(PictureFileName)\n    With p\n         With .ShapeRange\n              .LockAspectRatio = msoTrue    ' lock the aspect ratio (do not distort picture)\n              aspect = .Width / .Height     ' calculate aspect ratio of picture\n              .Left = Cells(t, l).Left + TargetCells.Width / 2 - p.Width / 2     ' left placement of picture\n              .Top = Cells(t, l).Top        ' top left placement of picture\n         End With\n         w = (Cells(b, r).Left + Cells(b, r).Width - Cells(t, l).Left)  ' width of cell range\n         h = Cells(b, r).Top + Cells(b, r).Height - Cells(t, l).Top     ' height of cell range\n         If (w / h &lt; aspect) Then\n            .ShapeRange.Width = w           ' scale picture to available width\n         Else\n            .ShapeRange.Height = h          ' scale picture to available height\n         End If\n         .Placement = 1\n    End With\n\n    Set p = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 196, "user_id": 3623441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf478a27375c1f70408e6b3a5042d2a3?s=128&d=identicon&r=PG&f=1", "display_name": "ArnoldasM", "link": "https://stackoverflow.com/users/3623441/arnoldasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "accepted_answer_id": 35180445, "answer_count": 1, "score": 0, "last_activity_date": 1548427079, "creation_date": 1454510047, "last_edit_date": 1548427079, "question_id": 35179859, "link": "https://stackoverflow.com/questions/35179859/position-picture-horizontally-in-center", "title": "Position picture horizontally in center", "body": "<p>I want to position picture in center of range, but it just doesn't work for me. Maybe anybody knows how to do it?\nHere is my code:</p>\n\n<pre><code>Sub InsertPictureInRange(PictureFileName As String, TargetCells As Range)\nDim p As Object, t As Double, l As Double, r As Double, b As Double\nDim aspect\nDim w, h\nIf TypeName(ActiveSheet) &lt;&gt; \"Worksheet\" Then Exit Sub\nIf Dir(PictureFileName) = \"\" Then Exit Sub\nl = 1: r = 22    ' co-ordinates of top-left cell\nt = 47: b = 88    ' co-ordinates of bottom-right cell\nSet TargetCells = Range(\"A47:V88\")\nSet p = ActiveSheet.Pictures.Insert(PictureFileName)\nWith p\n     With .ShapeRange\n          .LockAspectRatio = msoTrue    ' lock the aspect ratio (do not distort picture)\n          aspect = .Width / .Height     ' calculate aspect ratio of picture\n          .Left = Cells(t, l).Left      ' left placement of picture\n          .Top = Cells(t, l).Top        ' top left placement of picture\n     End With\n     w = (Cells(b, r).Left + Cells(b, r).Width - Cells(t, l).Left)  ' width of cell range\n     h = Cells(b, r).Top + Cells(b, r).Height - Cells(t, l).Top     ' height of cell range\n     If (w / h &lt; aspect) Then\n        .ShapeRange.Width = w           ' scale picture to available width\n     Else\n        .ShapeRange.Height = h          ' scale picture to available height\n     End If\n     .Placement = 1\nEnd With\n\nSet p = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1454509572, "post_id": 35179684, "comment_id": 58076235, "body": "Please read this before you ask any more questions:  <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>.  We are not going to write your code for you.  You need to show us what you have tried, tell us what <i>specifically</i> is not working, and we may be able to help you."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454510120, "post_id": 35179684, "comment_id": 58076686, "body": "<i>I don&#39;t need anything as complicated as scraping</i> - do you really understand what scraping is and how it works? You are asking exactly for that. However, there is one alternative that may help. see <code>Data &gt; From Web</code> in the Excel Ribbon. Use macro recorder to get started with the code, if you don&#39;t know the code for it."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5878371, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nnRfNPieOhQ/AAAAAAAAAAI/AAAAAAAAAL8/BWEuj80WtFU/photo.jpg?sz=128", "display_name": "Trundle0417", "link": "https://stackoverflow.com/users/5878371/trundle0417"}, "is_accepted": false, "score": 0, "last_activity_date": 1454513860, "creation_date": 1454513860, "answer_id": 35181288, "question_id": 35179684, "link": "https://stackoverflow.com/questions/35179684/excel-vba-script-to-copy-and-paste-data-from-a-predefined-list-of-urls/35181288#35181288", "title": "Excel VBA Script to Copy and Paste Data from a Predefined List of URLs", "body": "<p>Well here's the finished code, if anyone was wondering.</p>\n\n<pre><code>    Sub Macro3()\n'\n' Macro3 Macro\n'\n'\nDim Erw, Frw, Lrw\nDrw = 1\nFrw = 1\nLrw = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor Erw = Frw To Lrw\n\nWith ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;\" &amp; Range(\"A\" &amp; Erw).Value, Destination:=Range(\"G\" &amp; Drw))\n        .Name = \"\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlSpecifiedTables\n        .WebFormatting = xlWebFormattingNone\n        .WebTables = \"6\"\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\n    Drw = Drw + 80\nNext Erw\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5878371, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nnRfNPieOhQ/AAAAAAAAAAI/AAAAAAAAAL8/BWEuj80WtFU/photo.jpg?sz=128", "display_name": "Trundle0417", "link": "https://stackoverflow.com/users/5878371/trundle0417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 749, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454513860, "creation_date": 1454509532, "question_id": 35179684, "link": "https://stackoverflow.com/questions/35179684/excel-vba-script-to-copy-and-paste-data-from-a-predefined-list-of-urls", "title": "Excel VBA Script to Copy and Paste Data from a Predefined List of URLs", "body": "<p>I'm pulling my hair out over this. I've seen other topics that almost address this question, but their methods are normally too specific. I don't need anything as complicated as scraping </p>\n\n<p>I have about 64,000 URLs in column A of my file. I want Excel to go to each URL and once it loads, copy the entire page and then paste it into Excel. I would like all the pasted data in the same workbook and same sheet pasted one after the other.</p>\n"}, {"tags": ["vba", "excel", "csv", "export-to-csv", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5878117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de77bc9e413f6eae3aab8e8faa170d45?s=128&d=identicon&r=PG&f=1", "display_name": "K.Olesen", "link": "https://stackoverflow.com/users/5878117/k-olesen"}, "edited": false, "score": 0, "creation_date": 1454514073, "post_id": 35180226, "comment_id": 58079649, "body": "Thanks for your answer @EngJon. Your code are converting 10 lines into one line. The csv file contain approx 10 lines plus the last line which is empty and have to be deleted. I&#39;m sorry if my question wasn&#39;t clear enough."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "reply_to_user": {"reputation": 33, "user_id": 5878117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de77bc9e413f6eae3aab8e8faa170d45?s=128&d=identicon&r=PG&f=1", "display_name": "K.Olesen", "link": "https://stackoverflow.com/users/5878117/k-olesen"}, "edited": false, "score": 0, "creation_date": 1454514389, "post_id": 35180226, "comment_id": 58079906, "body": "Hmm, it shouldn&#39;t do this. <code>Chr(10)</code> should add line breaks, so the original lines would persist. Please Try <code>vbCrLf</code> instead of <code>Chr(10)</code> and tell me if it works."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "reply_to_user": {"reputation": 33, "user_id": 5878117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de77bc9e413f6eae3aab8e8faa170d45?s=128&d=identicon&r=PG&f=1", "display_name": "K.Olesen", "link": "https://stackoverflow.com/users/5878117/k-olesen"}, "edited": false, "score": 0, "creation_date": 1454514747, "post_id": 35180226, "comment_id": 58080182, "body": "No problem, I&#39;ll edit my answer accordingly. Feel free to accept it as answer then ;)"}], "tags": [], "owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "is_accepted": true, "score": 1, "last_activity_date": 1454514777, "last_edit_date": 1454514777, "creation_date": 1454511036, "answer_id": 35180226, "question_id": 35179431, "link": "https://stackoverflow.com/questions/35179431/how-to-remove-the-empty-line-that-excel-makes-when-creating-a-csv-file-using-vba/35180226#35180226", "title": "How to remove the empty line that excel makes when creating a csv file using vba", "body": "<p>Try calling this Sub to kill the last line of the csv-file. You have to insert the path into the code:</p>\n\n<pre><code>Sub KillLastLine()\n    Dim fso As New FileSystemObject\n    Dim ts As TextStream\n    Dim filecontent As String\n    Dim myFile As File\n\n    Set myFile = fso.GetFile(\"YourCSVPathHere\")\n    Set ts = myFile.OpenAsTextStream(ForReading)\n    While Not ts.AtEndOfStream\n        filecontent = filecontent &amp; ts.ReadLine &amp; vbCrLf\n    Wend\n    Set ts = myFile.OpenAsTextStream(ForWriting)\n    ts.Write Left(filecontent, Len(filecontent) - 1)\n    ts.Close\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6901440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-16uGJIwI47w/AAAAAAAAAAI/AAAAAAAADe8/oEQXr_1XeCg/photo.jpg?sz=128", "display_name": "Ricardo Navas", "link": "https://stackoverflow.com/users/6901440/ricardo-navas"}, "is_accepted": false, "score": 0, "last_activity_date": 1475177344, "creation_date": 1475177344, "answer_id": 39778513, "question_id": 35179431, "link": "https://stackoverflow.com/questions/35179431/how-to-remove-the-empty-line-that-excel-makes-when-creating-a-csv-file-using-vba/39778513#39778513", "title": "How to remove the empty line that excel makes when creating a csv file using vba", "body": "<pre><code>Sub ZUtil_TextFile_FindReplace(FilePath As String, strOld As String, strNew As String)\n'PURPOSE: Modify Contents of a text file using Find/Replace\n'SOURCE: www.TheSpreadsheetGuru.com\nDim TextFile As Integer\nDim FileContent As String\n'Determine the next file number available for use by the FileOpen function\n  TextFile = FreeFile\n'Open the text file in a Read State\n  Open FilePath For Input As TextFile\n'Store file content inside a variable\n  FileContent = Input(LOF(TextFile), TextFile)\n'Clost Text File\n  Close TextFile\n'Find/Replace\n  FileContent = Replace(FileContent, strOld, strNew)\n  FileContent = Replace(FileContent, \"^(?:[\\t ]*(?:\\r?\\n|\\r))+\", \"\")\n  If Right(FileContent, 2) = Chr(13) &amp; Chr(10) Then\n    FileContent = Left(FileContent, Len(FileContent) - 2)\n  End If\n'Determine the next file number available for use by the FileOpen function\n  TextFile = FreeFile\n'Open the text file in a Write State\n  Open FilePath For Output As TextFile\n'Write New Text data to file\n  Print #TextFile, FileContent\n'Close Text File\n  Close TextFile\n  'MsgBox \"ZUtil_TextFile_FindReplace TERMINADO\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5878117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de77bc9e413f6eae3aab8e8faa170d45?s=128&d=identicon&r=PG&f=1", "display_name": "K.Olesen", "link": "https://stackoverflow.com/users/5878117/k-olesen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2262, "favorite_count": 0, "accepted_answer_id": 35180226, "answer_count": 2, "score": 0, "last_activity_date": 1475177344, "creation_date": 1454508833, "last_edit_date": 1454509353, "question_id": 35179431, "link": "https://stackoverflow.com/questions/35179431/how-to-remove-the-empty-line-that-excel-makes-when-creating-a-csv-file-using-vba", "title": "How to remove the empty line that excel makes when creating a csv file using vba", "body": "<p>As some of you probably know, excel creates an empty line at the end of CSV files. I'm looking for a solution that can remove/delete this line because I want to upload the CSV file to a different program, which can't handle this empty line.  </p>\n\n<p>First I thought it was the way I created the CSV file, but after spending hours searching for a solution, I found out that it's a bug.  </p>\n\n<p>Does anybody have a solution to this problem, removing the last line in a CSV file using VBA?</p>\n"}, {"tags": ["sql", "ms-access", "vba", "runtime-error", "mismatch"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1454508780, "post_id": 35179310, "comment_id": 58075615, "body": "Can you tag this with the appropriate programming language?  Think about it...how could anyone answer this without that information?"}, {"owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1454508950, "post_id": 35179310, "comment_id": 58075751, "body": "Thank roryap, didn&#39;t even notice the sql tag was missing"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1454509034, "post_id": 35179310, "comment_id": 58075816, "body": "It&#39;s not sql.  It looks more like VB.  But you can&#39;t assume that people know that.  And what flavor of vb?  VB.NET?  VBA?"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1454509071, "post_id": 35179310, "comment_id": 58075862, "body": "Also, you need to tell us more information: for example, what line is the error occurring on?"}, {"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1454509154, "post_id": 35179310, "comment_id": 58075921, "body": "In the where clause, are you comparing two same data types?"}, {"owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "edited": false, "score": 0, "creation_date": 1454509387, "post_id": 35179310, "comment_id": 58076108, "body": "Thanks roryap, but the database runs both access-vba and sql together. I&#39;m receiving this error on line four after I run a combo box entry to find all records that have a priority 1 status. The combo box has priority indicators 1-5 and pull data within table ASPACAplitInventory."}, {"owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "edited": false, "score": 0, "creation_date": 1454509759, "post_id": 35179310, "comment_id": 58076382, "body": "Thanks sagi, but why would I compare two data types.. I think the issue lies somewhere in ([Severity Indicator] = &#39;&quot; &amp; Me.cboIndicator &amp; &quot;&#39;)&quot;.  It&#39;s set up as a string and I don&#39;t think the &#39;&quot; or &#39;&quot;)&quot; is correct for numerical data types."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1454509881, "post_id": 35179310, "comment_id": 58076498, "body": "<code>&quot;Select * from tbl_ASPACSplitInventorySelect where [Severity Indicator] = &quot; &amp; Me.cboIndicator</code>"}, {"owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "edited": false, "score": 0, "creation_date": 1454510225, "post_id": 35179310, "comment_id": 58076760, "body": "Thank You HansUp! I recognize your name from many posts before. I used the same code posted in the original post for GroupingNumber afterupdate and it worked, but was listed for a text value. Why is the  &amp; &quot;&#39;)&quot; working text versus number?"}, {"owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "edited": false, "score": 0, "creation_date": 1454510643, "post_id": 35179310, "comment_id": 58077103, "body": "So Now I&#39;m receiving Run-Time error &#39;3075&#39; when I select the blank in NULL value in the drop-down. Values 1-5 are working filter values right now. Query Expression &#39;[Severity Indicator] =&#39;"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1454510831, "post_id": 35179310, "comment_id": 58077247, "body": "Welcome to Stack Overflow, @K.D.  Please revise the question to include the code you&#39;re using now ... which gives you error #3075 ... and indicate which line of that code triggers the error."}, {"owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1454511365, "post_id": 35179310, "comment_id": 58077628, "body": "@HansUp ... Just revised the question to include the new code. Line four is triggered."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1454511655, "post_id": 35179310, "comment_id": 58077819, "body": "Thanks!  That is not the query I thought you were using now.  I suggested <code>= &quot; &amp; Me.cboIndicator</code> and you have <code>= &#39;&quot; &amp; Me.cboIndicator</code> instead.  Add a new line after <code>myIndicator = &quot;Select * ...</code> and put this in that new line: <code>Debug.Print myIndicator</code>  Then run the code and examine the statement text in the Immediate window.  (Ctrl+g will take you there.)"}, {"owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1454513902, "post_id": 35179310, "comment_id": 58079516, "body": "@HansUp You are indeed correct with = &quot; &amp; Me.cboIndicator and I placed the Debug.Print myIndicator with nothing return before or after I select the NULL in the combobox."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1454514150, "post_id": 35179310, "comment_id": 58079710, "body": "So when the combobox is Null, doesn&#39;t the Immediate window show you this as the last part of the statement?  <code>where [Severity Indicator] =</code>  (with nothing after the <code>=</code> sign?)  What records should be selected when the combobox is Null?"}, {"owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1454514603, "post_id": 35179310, "comment_id": 58080062, "body": "Correct Nothing after the equals sign. There a blanks within thew column data that should be listed after the NULL value is selected. I learned at little trick consolidate the list of 39,000 record values into NULL, 1-5 by selecting crosstab function within the select query associated with the combobox. @HansUp"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "edited": false, "score": 0, "creation_date": 1454589899, "post_id": 35200765, "comment_id": 58118552, "body": "Thanks for the reply and you indicated what I needed. @HansUp helped me through the answering of this posts. Thank you both for taking time out of your schedules to further improve the development community!!"}, {"owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "reply_to_user": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "edited": false, "score": 0, "creation_date": 1454630938, "post_id": 35200765, "comment_id": 58143550, "body": "In order to keep this site clean, please set your question as answered."}], "tags": [], "owner": {"reputation": 251, "user_id": 5834812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d8e994935ee716b3dccce2eacfb882?s=128&d=identicon&r=PG&f=1", "display_name": "Cisco", "link": "https://stackoverflow.com/users/5834812/cisco"}, "is_accepted": true, "score": 0, "last_activity_date": 1454588093, "creation_date": 1454588093, "answer_id": 35200765, "question_id": 35179310, "link": "https://stackoverflow.com/questions/35179310/run-time-error-3075-syntax-error/35200765#35200765", "title": "run-time error 3075 syntax error", "body": "<p>in the statement</p>\n\n<pre><code>myIndicator = \"Select * from tbl_ASPACSplitInventorySelect where ([Severity Indicator] = '\" &amp; Me.cboIndicator\n</code></pre>\n\n<p>a quote and a ')' are missing. </p>\n\n<p>If the table field <em>Severity Indicator</em> is defined as TEXT:</p>\n\n<pre><code>myIndicator = \"Select * from tbl_ASPACSplitInventorySelect where ([Severity Indicator] = '\" &amp; cstr(Me.cboIndicator) &amp; \"');\"\n</code></pre>\n\n<p>If the table field <em>Severity Indicator</em> is defined as NUMBER:</p>\n\n<pre><code>myIndicator = \"Select * from tbl_ASPACSplitInventorySelect where ([Severity Indicator] = \" &amp; cstr(Me.cboIndicator) &amp; \");\"\n</code></pre>\n\n<p>Please note that before this statement it would be useful to check the value of Me.cboIndicator, with something like:</p>\n\n<pre><code>If not isnull(Me.cboIndicator) and not isempty(Me.cboIndicator) then ...\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5878250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/602e75df3a036d2b16cca47a311a9641?s=128&d=identicon&r=PG&f=1", "display_name": "K.D.", "link": "https://stackoverflow.com/users/5878250/k-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 35200765, "answer_count": 1, "score": 0, "last_activity_date": 1594655531, "creation_date": 1454508498, "last_edit_date": 1594655531, "question_id": 35179310, "link": "https://stackoverflow.com/questions/35179310/run-time-error-3075-syntax-error", "title": "run-time error 3075 syntax error", "body": "<p>I have been struggling with this NUMBER(listed in Table) syntax this morning - I have a form with a combo box [cboIndicator] that looks up the value [Severity Indicator] from a table called tbl_ASPACSplitInventorySelect. Right now Severity Indicators 1-5 are correct, but the NULL value in the combobox box are spitting out an 3075 error.</p>\n\n<pre><code>Private Sub cboIndicator_AfterUpdate()\nDim myIndicator As String\nmyIndicator = \"Select * from tbl_ASPACSplitInventorySelect where ([Severity Indicator] = '\" &amp; Me.cboIndicator\nMe.ASPACSplitInventorySelect_subform1.Form.RecordSource = myIndicator\nMe.ASPACSplitInventorySelect_subform1.Requery\nMe.cboGrouping = Null\nMe.Combo830 = Null\nEnd Sub\n</code></pre>\n\n<p>I'm receiving a run-time error 3075 syntax error. As you can tell there is a subform listed and double checked all source objects. Any help would be greatly appreciated. Line Four appears to be the highlighted for data mismatch.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 437, "user_id": 2765634, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zkNwX.png?s=128&g=1", "display_name": "Jay Claiton", "link": "https://stackoverflow.com/users/2765634/jay-claiton"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1454508557, "post_id": 35179275, "comment_id": 58075481, "body": "Actually I don&#39;t even have an Idea how to start. I could easily do this via MySQL but with Excel it is too much for me"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 2, "creation_date": 1454508822, "post_id": 35179275, "comment_id": 58075647, "body": "See this question here: <a href=\"http://stackoverflow.com/q/33112330/5090027\">stackoverflow.com/q/33112330/5090027</a> What you are asking for is not possible in a single formula; it will require either VBA or a helper column."}], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 2, "last_activity_date": 1454509295, "creation_date": 1454509295, "answer_id": 35179601, "question_id": 35179275, "link": "https://stackoverflow.com/questions/35179275/excel-find-ids-in-list-and-append-them-comma-separated/35179601#35179601", "title": "Excel find IDs in List and append them comma separated", "body": "<p>To do this without VBA, you can use a helper column which will pick up each additional letter to add to the list for a particular number, and then search for the full concanated cell associated with each number, for your result.</p>\n\n<p>Note that I suggest you do your helper column from the bottom and copied up - this will make it easier for you to pull the concanated values at the end, without using an Array Formula.</p>\n\n<p>Put the formula in C21 [assuming 21 is your last data row], and copy it up to the top of your list:</p>\n\n<pre><code>=IFERROR(INDEX($C$22:C22,MATCH(A21,$A$22:A22,0)),\"\")&amp;\",\"&amp;B21\n</code></pre>\n\n<p>What this does is search column C for all rows beneath the current row, to see what the most recent concanated result for that number is. It then pulls that text value [\"\" if there is no prior match], and adds on the value in column B for the current row. As you copy it up, each individual number's 'concanenated text' will continue to grow, adding letters where the number values match.</p>\n\n<p>Then to pull those results into your table on the right, simply do the following in E1 and copy down:</p>\n\n<pre><code>=INDEX(C:C,MATCH(D1,A:A,0))\n</code></pre>\n\n<p>This pulls in the first matching row which has the number value you're searching for, and returns the value on that row from column C. Since the first matching value would be the one which includes all concanenated values before it, this will be a complete listing of matches to that number.</p>\n\n<p>Note also that this method puts the bottom rows' letter values at the begining of the concatenation string.</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 5871610, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CR4qztlg_iU/AAAAAAAAAAI/AAAAAAAAAC8/IcLuTjjJoXs/photo.jpg?sz=128", "display_name": "steve biko", "link": "https://stackoverflow.com/users/5871610/steve-biko"}, "is_accepted": false, "score": 0, "last_activity_date": 1454510910, "creation_date": 1454510910, "answer_id": 35180168, "question_id": 35179275, "link": "https://stackoverflow.com/questions/35179275/excel-find-ids-in-list-and-append-them-comma-separated/35180168#35180168", "title": "Excel find IDs in List and append them comma separated", "body": "<p>A pivot table can be usefull to you if order of your the data is not important.</p>\n\n<p>To create a pivot table label your two columns in row 1 and follow below instructions i got from google. </p>\n\n<p><strong><em>On the Insert tab, in the Tables group, click PivotTable. ...\nIn the Create PivotTable dialog box, make sure that Select a table or range is selected, and then in the Table/Range box, verify the range of cells. ...\nDo one of the following: ...\nClick OK.</em></strong></p>\n\n<p>Choose the ID column for your ROWS(drag drop in the pivottable fiedls) and the data column (column2) for your COLUMNS.</p>\n\n<p>Be refreshing the pivot table (by right click) whenever you modify your data</p>\n"}], "owner": {"reputation": 437, "user_id": 2765634, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zkNwX.png?s=128&g=1", "display_name": "Jay Claiton", "link": "https://stackoverflow.com/users/2765634/jay-claiton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1454510910, "creation_date": 1454508414, "last_edit_date": 1531161705, "question_id": 35179275, "link": "https://stackoverflow.com/questions/35179275/excel-find-ids-in-list-and-append-them-comma-separated", "title": "Excel find IDs in List and append them comma separated", "body": "<p>I am trying to search an ID in a Column (which will have this ID possibly multiple times) and then take the next Column of the found ID and put the text in a field comma separated. I think this Image is showing it better than I can with my broken english.</p>\n\n<p>All this should happen automatically. With VBA or a Formula if possible.<a href=\"https://i.stack.imgur.com/dBwFs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dBwFs.png\" alt=\"enter image description here\"></a></p>\n\n<p>The left list should be translated to the right. Any clues on how to achieve something like this?</p>\n"}, {"tags": ["excel", "vba", "replace", "find"], "comments": [{"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1454509981, "post_id": 35179209, "comment_id": 58076585, "body": "Please tell us how you tried to acomplish this task? What errors you get when you try? We are not a code-makers, we help you with the questions about errors you have when you try. Please read this: <a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 5871610, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CR4qztlg_iU/AAAAAAAAAAI/AAAAAAAAAC8/IcLuTjjJoXs/photo.jpg?sz=128", "display_name": "steve biko", "link": "https://stackoverflow.com/users/5871610/steve-biko"}, "edited": false, "score": 0, "creation_date": 1454917094, "post_id": 35180691, "comment_id": 58240566, "body": "@acquisti  Replace  &quot;wb.Close Save&quot; with &quot; wb.Close true&quot;. This line saves the file after modifications"}], "tags": [], "owner": {"reputation": 161, "user_id": 5871610, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CR4qztlg_iU/AAAAAAAAAAI/AAAAAAAAAC8/IcLuTjjJoXs/photo.jpg?sz=128", "display_name": "steve biko", "link": "https://stackoverflow.com/users/5871610/steve-biko"}, "is_accepted": false, "score": 0, "last_activity_date": 1454917155, "last_edit_date": 1454917155, "creation_date": 1454512272, "answer_id": 35180691, "question_id": 35179209, "link": "https://stackoverflow.com/questions/35179209/find-and-replace-multiple-excel-files-multiple-values/35180691#35180691", "title": "Find and replace multiple excel files multiple values", "body": "<p>Your code looks ok. What you miss is the openining of multiple workbooks in folders and subfolders. So this is the code I add for you.</p>\n\n<p>We are using recursion to iterate your file system using the FileSystemObject so add a reference to Microsoft Scripting Run time to your project/workbook. in Excel code window menus >>tools>>references.</p>\n\n<pre><code>Option Explicit\nPrivate Sub Multi_FindReplace(wb As Workbook)\n    Dim sht As Worksheet\n    Dim fndList As Variant\n    Dim rplcList As Variant\n    Dim x As Long\n\n    fndList = Array(\"Orange 100\", \"Red 12\", \"Green 111\")\n    rplcList = Array(\"Pink 150\", \"Rose 94\", \"Yellow 212\")\n\n    'Loop through each item in Array lists\n      For x = LBound(fndList) To UBound(fndList)\n        'Loop through each worksheet in ActiveWorkbook\n          For Each sht In wb.Worksheets 'changed Active workbook to the workbbok passed as argument\n            sht.Cells.Replace What:=fndList(x), Replacement:=rplcList(x), _\n              LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n              SearchFormat:=False, ReplaceFormat:=False\n          Next sht\n\n      Next x\nEnd Sub\nPublic Sub FindReplace()\n    Dim folderPath As String\n    Dim FSO As New FileSystemObject\n    folderPath = \"C:\\workbooks\\\" 'start folder modify to fit your case\n    recurseFolderReplacing FSO.GetFolder(folderPath)\nEnd Sub\nPrivate Function recurseFolderReplacing(myfolder As Folder)\n    Dim myfile As File, mySubFolder As Folder\n    Dim wb As Workbook\n    For Each myfile In myfolder.Files\n        'filter to ensure we only touch excel files\n        If Right(myfile.Name, 5) = \".xslx\" Or Right(myfile.Name, 4) = \".xsl\" Then\n            Set wb = Workbooks.Open(myfile.Path, False, True)\n            Multi_FindReplace wb\n            wb.Close True\n            Debug.Print \"Processed \" &amp; myfile.Path\n        End If\n    Next\n\n    'the recursive calls to subfolders\n    For Each mySubFolder In myfolder.SubFolders\n        recurseFolderReplacing mySubFolder\n    Next\nEnd Function\n</code></pre>\n\n<p>I have not tested the code so tell me how it goes.</p>\n\n<p>Bikxs</p>\n"}], "owner": {"reputation": 1, "user_id": 5878301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c89cdba3ef05c2d292ea0a67502976?s=128&d=identicon&r=PG&f=1", "display_name": "Acquisti Corti", "link": "https://stackoverflow.com/users/5878301/acquisti-corti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2593, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1454917155, "creation_date": 1454508226, "last_edit_date": 1454509620, "question_id": 35179209, "link": "https://stackoverflow.com/questions/35179209/find-and-replace-multiple-excel-files-multiple-values", "title": "Find and replace multiple excel files multiple values", "body": "<p>I have a lot of xls files in one folder and also in sub folders.\nI'd like a vba that find in every file a word for example:\nOrange 100 and change it to another word, ex. Pink 150\nbut I would like also to change\nRed 12 in Rose 94\nGreen 111 in Yellow 212\netc etc etc\nSo...\nOrange 100 Red 12 Green 111\nrespectively\nin \nPink 150 Rose 94 Yellow 212\nany help please?\nThank you so much.\nSomething like this but in multiple files in folder and subfolders:</p>\n\n<pre><code> Sub Multi_FindReplace()\n\nDim sht As Worksheet\nDim fndList As Variant\nDim rplcList As Variant\nDim x As Long\n\nfndList = Array(\"Orange 100\", \"Red 12\", \"Green 111\")\nrplcList = Array(\"Pink 150\", \"Rose 94\", \"Yellow 212\")\n\n'Loop through each item in Array lists\n  For x = LBound(fndList) To UBound(fndList)\n    'Loop through each worksheet in ActiveWorkbook\n      For Each sht In ActiveWorkbook.Worksheets\n        sht.Cells.Replace What:=fndList(x), Replacement:=rplcList(x), _\n          LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n          SearchFormat:=False, ReplaceFormat:=False\n      Next sht\n\n  Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["android", "vb.net", "vba", "sms"], "answers": [{"tags": [], "owner": {"reputation": 160, "user_id": 5783024, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/481dd15cfe95ec1054cc96cb0ba28dfe?s=128&d=identicon&r=PG&f=1", "display_name": "SiriSch", "link": "https://stackoverflow.com/users/5783024/sirisch"}, "is_accepted": false, "score": 1, "last_activity_date": 1454511978, "last_edit_date": 1495542662, "creation_date": 1454511978, "answer_id": 35180586, "question_id": 35178935, "link": "https://stackoverflow.com/questions/35178935/is-it-possible-to-send-an-sms-from-visual-basic-2013-through-my-smartphone/35180586#35180586", "title": "Is it possible to send an SMS from Visual Basic 2013 through my smartphone?", "body": "<p>I would say that this is not possible directly.</p>\n\n<p>The problem you already found is that your Smartphone is Android and\nVb.Net needs a .net Framework with which it works.</p>\n\n<p>So the possibility I see is to get a connection\nvia USB port to your device and send some specific commands to\nmake your smartphone send SMS. To do this you have to use a serial port from\nmy point of view.</p>\n\n<p>This question has already been asked, so\nplease take a look at:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/21131761/sending-sms-using-vb-net\">Sending SMS with Vb.net</a></p>\n"}, {"tags": [], "owner": {"reputation": 865, "user_id": 1995444, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/e5QXX.jpg?s=128&g=1", "display_name": "TheRyan722", "link": "https://stackoverflow.com/users/1995444/theryan722"}, "is_accepted": false, "score": 1, "last_activity_date": 1454629770, "last_edit_date": 1454629770, "creation_date": 1454520694, "answer_id": 35183800, "question_id": 35178935, "link": "https://stackoverflow.com/questions/35178935/is-it-possible-to-send-an-sms-from-visual-basic-2013-through-my-smartphone/35183800#35183800", "title": "Is it possible to send an SMS from Visual Basic 2013 through my smartphone?", "body": "<p>The .Net framework does not natively run on Android, so no this is not possible.</p>\n\n<p><strong>However,</strong> the <a href=\"https://xamarin.com\" rel=\"nofollow\">Xamarin</a> framework allows you to write android apps in Visual Studio.</p>\n\n<p>Specifically towards your question, Xamarin has an SmsManager class that allows you to send Sms messages, the documentation can be found <a href=\"https://developer.xamarin.com/recipes/android/networking/sms/send_an_sms/\" rel=\"nofollow\">here</a>.</p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 5786815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tj7TO.jpg?s=128&g=1", "display_name": "Howie-", "link": "https://stackoverflow.com/users/5786815/howie"}, "is_accepted": false, "score": 0, "last_activity_date": 1454534045, "creation_date": 1454534045, "answer_id": 35187842, "question_id": 35178935, "link": "https://stackoverflow.com/questions/35178935/is-it-possible-to-send-an-sms-from-visual-basic-2013-through-my-smartphone/35187842#35187842", "title": "Is it possible to send an SMS from Visual Basic 2013 through my smartphone?", "body": "<p>There are several different ways to do this, but the best one is use an api like <a href=\"http://www.twilio.com\" rel=\"nofollow\">Twilio</a>.  You can literally send an sms with one line of code. They have a <a href=\"https://www.nuget.org/packages/Twilio/\" rel=\"nofollow\">nuget package</a> which would get you up and running even faster. </p>\n\n<p>Another is to use carrier mail.  You have to know the users carrier and then you can create an email address that sends as a text ie. 1231234123@txt.att.net.  The issue with using cellular carrier email  is that spammers often use this and one minute there is a message from your site and then next is spam, since it will be coming from the same carrier.email address.</p>\n"}], "owner": {"reputation": 21, "user_id": 5878109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71e6a748e62faf0ac49b552706dfcf3f?s=128&d=identicon&r=PG&f=1", "display_name": "kecske20", "link": "https://stackoverflow.com/users/5878109/kecske20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1804, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1454629770, "creation_date": 1454507495, "question_id": 35178935, "link": "https://stackoverflow.com/questions/35178935/is-it-possible-to-send-an-sms-from-visual-basic-2013-through-my-smartphone", "title": "Is it possible to send an SMS from Visual Basic 2013 through my smartphone?", "body": "<p>I would like to send an SMS from a VB2013 application with my smartphone programmatically. I have already found several solutions how to solve this with Windows Phone (Outlook-Windows Phone). The only problem is, that I have an android device. So my question is, do you know any idea or solution that supports android?</p>\n\n<p>The workflow that I want to implement is the following:</p>\n\n<ul>\n<li>The user types into a textbox the phone number and the text on a VB2013 app.</li>\n<li>He/She clicks to the \"Send\" button, and somehow it sends an SMS from the android phone to the phone number that is given by himself/herself.</li>\n</ul>\n\n<p>Regards,</p>\n\n<p>Roland</p>\n"}, {"tags": ["sql-server", "vba", "ms-access", "odbc"], "comments": [{"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454507161, "post_id": 35178775, "comment_id": 58074441, "body": "what is your table called on the sql server?"}, {"owner": {"reputation": 6697, "user_id": 4540020, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d379c26fafba97e01b5e08b92d729e?s=128&d=identicon&r=PG&f=1", "display_name": "Jes&#250;s L&#243;pez", "link": "https://stackoverflow.com/users/4540020/jes%c3%bas-l%c3%b3pez"}, "edited": false, "score": 0, "creation_date": 1454507362, "post_id": 35178775, "comment_id": 58074584, "body": "In which schema is the view located?  try  <code>&quot;select * from [schemaName].[ViewName]&quot;</code>"}, {"owner": {"reputation": 87, "user_id": 3115084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e106f3d24914f718428026de526f87?s=128&d=identicon&r=PG&f=1", "display_name": "Baris", "link": "https://stackoverflow.com/users/3115084/baris"}, "edited": false, "score": 0, "creation_date": 1454509903, "post_id": 35178775, "comment_id": 58076517, "body": "Schema is dbo - <code>strQry = &quot;select * from [dbo].[ViewMySQL]&quot;</code>doesn&#39;t work"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1454510526, "post_id": 35178775, "comment_id": 58077006, "body": "1. Is the error message the same for <code>[dbo].[viewMySQL]</code> ?  -- 2. Are you sure the user has access rights to the view (i.e. GRANT SELECT) ?"}, {"owner": {"reputation": 87, "user_id": 3115084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e106f3d24914f718428026de526f87?s=128&d=identicon&r=PG&f=1", "display_name": "Baris", "link": "https://stackoverflow.com/users/3115084/baris"}, "edited": false, "score": 0, "creation_date": 1454511026, "post_id": 35178775, "comment_id": 58077383, "body": "I tried: <code>GRANT SELECT ON [ViewMySQL] TO [MyUsername]</code> -  the error remains the same: Invalid object name"}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1454511863, "post_id": 35178775, "comment_id": 58077960, "body": "Make sure the view itself is linked in Access.  When you do this, it will likely change the linked view in Access to dbo_ViewMySQL, but you can change this by renaming the linked view the same way you&#39;d rename any other Access object."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1454513434, "post_id": 35178775, "comment_id": 58079180, "body": "@JohnnyBones: as I understand it (I never use ADO), OP directly connects to SQL Server, as in a Pass-Through query, so linking the view in Access shouldn&#39;t make a difference."}, {"owner": {"reputation": 87, "user_id": 3115084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e106f3d24914f718428026de526f87?s=128&d=identicon&r=PG&f=1", "display_name": "Baris", "link": "https://stackoverflow.com/users/3115084/baris"}, "edited": false, "score": 0, "creation_date": 1454515922, "post_id": 35178775, "comment_id": 58081052, "body": "Linking via the ODBC-Database in database tools directly works, but I can&#39;t imagine why this souldn&#39;t work in vba"}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "edited": false, "score": 0, "creation_date": 1527182207, "post_id": 35178775, "comment_id": 88042173, "body": "Has anyone found an answer on this yet?"}], "owner": {"reputation": 87, "user_id": 3115084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e106f3d24914f718428026de526f87?s=128&d=identicon&r=PG&f=1", "display_name": "Baris", "link": "https://stackoverflow.com/users/3115084/baris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 670, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1454507053, "creation_date": 1454507053, "question_id": 35178775, "link": "https://stackoverflow.com/questions/35178775/connecting-a-sql-server-view-in-ms-access-with-vba", "title": "Connecting a SQL Server View in MS Access with VBA", "body": "<p>I have created a View in SQL Server (<code>dbo.ViewMySQL</code>) and now want to query it from MS Access with ADO, the connection string looks like:</p>\n\n<pre><code>    cs = \"Driver={SQL Server};\"\n    cs = cs &amp; \"Server=IP,port;\"\n    cs = cs &amp; \"Database=database_name;\"\n\ncon.Open cs, \"user\", \"password\"\n</code></pre>\n\n<p>I tried the following SQL-Statements:</p>\n\n<pre><code>strQry = \"select * from dbo_ViewMySQL\"\nstrQry = \"select * from viewMySQL\"\nstrQry = \"select * from [dbo].[viewMySQL]\"\nstrQry = \"select * from [db-name].[dbo].[viewMySQL]\"\n</code></pre>\n\n<p>The error message says that the object-name is invalid</p>\n\n<blockquote>\n  <p>Laufzeitffehler '-2147217865 (80040e37)': [Microsoft][ODBC SQL Server\n  Driver][SQL Server] Ung\u00fcltiger Objektname 'dbo_ViewMySQL'</p>\n</blockquote>\n\n<p>for <code>strQry = \"select * from tbl_Test\"</code> and other tables it works, but not for the view, why is that?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ms-access", "vba", "dao"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454507718, "post_id": 35178774, "comment_id": 58074863, "body": "It shouldnt return any data though.  You need a query after to get the latest, i dont think you can do this way."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1454507782, "creation_date": 1454507782, "answer_id": 35179035, "question_id": 35178774, "link": "https://stackoverflow.com/questions/35178774/access-dao-get-newly-created-record-id-by-using-a-stored-append-query/35179035#35179035", "title": "Access DAO Get newly created record ID by using a stored Append Query", "body": "<p>It shouldnt return any data though.  You need a query after to get the latest, i dont think you can do this way.  Perhaps a select with the same criteria and parameters?</p>\n"}], "owner": {"reputation": 337, "user_id": 5148062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80f2650160209f64e6d1e44898ad4dad?s=128&d=identicon&r=PG&f=1", "display_name": "Rhdr", "link": "https://stackoverflow.com/users/5148062/rhdr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "closed_date": 1454511078, "answer_count": 1, "score": 0, "last_activity_date": 1454509456, "creation_date": 1454507052, "last_edit_date": 1454509456, "question_id": 35178774, "link": "https://stackoverflow.com/questions/35178774/access-dao-get-newly-created-record-id-by-using-a-stored-append-query", "closed_reason": "Duplicate", "title": "Access DAO Get newly created record ID by using a stored Append Query", "body": "<p>I am trying to get the last added Record Id but cant seem to get the recordset to load. I keep on getting \"Runtime Error 3219 Invalid Operation\". What am I doing wrong?</p>\n\n<pre><code>        Dim db As DAO.Database\n        Dim qry As DAO.QueryDef\n        Dim rs As DAO.Recordset\n\n        Set db = CurrentDb\n        Set qry = db.QueryDefs(\"AASourceApp\")\n\n        'qry.Parameters.Refresh\n        qry.Parameters(\"[Forms]![AAAccounts Form]![AASourcDoc Subform].[Form]![cmbUpgradeTo]\") = [Forms]![AAAccounts Form]![AASourcDoc Subform].[Form]![cmbUpgradeTo]\n        qry.Parameters(\"[Forms]![AAAccounts Form]![AASourcDoc Subform].[Form]![SourceID]\") = [Forms]![AAAccounts Form]![AASourcDoc Subform].[Form]![SourceID]\n        'qry.Execute  'if unquoted qry.execute works without a problem\n\n        'Determine newly created record id\n        Set rs = qry.OpenRecordset()   ''''''ERROR - Invalid Operation''''''\n        Debug.Print rs.LastModified\n\n        rs.Close\n        Set rs = Nothing\n        Set db = Nothing\n</code></pre>\n\n<p>Here is the stored SQL for the AASourceApp query:</p>\n\n<pre><code>PARAMETERS [Forms]![AAAccounts Form]![AASourcDoc Subform].[Form]![SourceID] Long, [Forms]![AAAccounts Form]![AASourcDoc Subform].[Form]![cmbUpgradeTo] Short;\n    INSERT INTO [SourcDoc Tbl] ( [SourceID Link], [SubAccount ID], SourcTypeID, SDate )\n    SELECT [SourcDoc Tbl].SourceID, [SourcDoc Tbl].[SubAccount ID], [Forms]![AAAccounts Form]![AASourcDoc Subform].[Form]![cmbUpgradeTo] AS DocType, Date() AS Date1\n    FROM [SourcDoc Tbl]\n    WHERE ((([SourcDoc Tbl].SourceID)=[Forms]![AAAccounts Form]![AASourcDoc Subform].[Form]![SourceID]));\n</code></pre>\n"}, {"tags": ["excel", "vba", "counter", "worksheet"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1454507287, "post_id": 35178704, "comment_id": 58074538, "body": "This isn&#39;t very clear - could you explain what you want a counter for, and how you expect it to work?"}, {"owner": {"reputation": 49, "user_id": 5874322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11ded11b6b0ed1e95b1b923e482062cf?s=128&d=identicon&r=PG&f=1", "display_name": "Dayday", "link": "https://stackoverflow.com/users/5874322/dayday"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1454507561, "post_id": 35178704, "comment_id": 58074747, "body": "count how how times the word in SearchString  is found in the excel worksheet @Grade&#39;Eh&#39;Bacon"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1454508261, "post_id": 35178704, "comment_id": 58075265, "body": "I think it would help if you explained (in words, not in VBA code) what you are trying to accomplish with your program. Right now, I can&#39;t actually tell what&#39;s happening with it, and the way you have laid out the structure starting with &quot;If Not acell&quot;... is confusing to me. As it stands, I don&#39;t expect this to hit more than 1 match before closing [though I may be misinterpreting on a quick read], so it seems that it isn&#39;t doing what you expect."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1454508746, "post_id": 35178704, "comment_id": 58075594, "body": "I honestly don&#39;t understand the 3 DVs. The question and problem are pretty clearly defined. @Grade&#39;Eh&#39;Bacon - the <code>If Not aCell Is Nothing Then</code> is simply saying if the SearchString is found the first time (at <code>Set aCell = ...</code>, then continue the process."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454509474, "post_id": 35178704, "comment_id": 58076167, "body": "@ScottHoltzman It&#39;s not that particular expression I find confusing, it&#39;s the method of the Do While loop, and the lack of explanation as to what the counter is used for - shouldnt have to make even educated guesses about these things..."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1454509935, "post_id": 35178704, "comment_id": 58076548, "body": "@Grade&#39;Eh&#39;Bacon - I will admit the method used is a bit clunkier than what I have seen/used to perform similar functions. :) I just re-read your comment, and see where I missed your point :)"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1454508097, "creation_date": 1454508097, "answer_id": 35179158, "question_id": 35178704, "link": "https://stackoverflow.com/questions/35178704/im-trying-to-add-a-count-to-the-number-of-searches-found-in-my-code/35179158#35179158", "title": "I&#39;m trying to add a count to the number of searches found in my code", "body": "<p>With the current code you have you don't even need to use a counter. Instead you can load <code>FoundAt</code> into an array and then use the <code>Ubound</code> to get the total count. <em>Note you have to add 1 since the array is 0 based.</em></p>\n\n<p>Add these lines before your final <code>Msgbox</code></p>\n\n<pre><code>Dim iCount() as String\niCount = Split(FoundAt,\", \")\n\nMsgBox \"The Search String has been found \" &amp; UBound(iCount)+1 &amp; \" times at these locations: \" &amp; FoundAt\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5874322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11ded11b6b0ed1e95b1b923e482062cf?s=128&d=identicon&r=PG&f=1", "display_name": "Dayday", "link": "https://stackoverflow.com/users/5874322/dayday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 35179158, "answer_count": 1, "score": -4, "last_activity_date": 1454508097, "creation_date": 1454506868, "last_edit_date": 1454507250, "question_id": 35178704, "link": "https://stackoverflow.com/questions/35178704/im-trying-to-add-a-count-to-the-number-of-searches-found-in-my-code", "title": "I&#39;m trying to add a count to the number of searches found in my code", "body": "<p>My code follows:</p>\n\n<pre><code>Dim ws As Worksheet\nDim ExitLoop As Boolean\nDim SearchString As String, FoundAt As String\n\n\nSet ws = Worksheets(\"detail_report\")\n\n\nOn Error GoTo Err\n\n\nSet oRange = ws.Cells\n\nSearchString = \"front input\"\n\nSet aCell = oRange.Find(What:=SearchString, LookIn:=xlValues, _\n            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False)\n\nIf Not aCell Is Nothing Then\n    Set bCell = aCell\n    FoundAt = aCell.Address\n    Do While ExitLoop = False\n        Set aCell = oRange.FindNext(After:=aCell)\n\n        If Not aCell Is Nothing Then\n            If aCell.Address = bCell.Address Then Exit Do\n            FoundAt = FoundAt &amp; \", \" &amp; aCell.Address\n        Else\n            ExitLoop = True\n        End If\n    Loop\nElse\n    MsgBox SearchString &amp; \" not Found\"\nEnd If\n\nMsgBox \"The Search String has been found these locations: \" &amp; FoundAt\nExit Sub\nErr:\nMsgBox Err.Description\n\n\nEnd Sub\n</code></pre>\n\n<p>I added the below code but don't know how to add the counter part:</p>\n\n<pre><code>Dim S As String\nDim count As Integer\n</code></pre>\n"}, {"tags": ["xml", "excel", "vba", "import", "evernote"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454508370, "post_id": 35178517, "comment_id": 58075339, "body": "you will most likely need to wrap the rows in a some format that tells the xml it&#39;s a table."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454508826, "post_id": 35178517, "comment_id": 58075653, "body": "Yes I need that exactly but I don&#39;t know the formatting syntax for the xml?"}], "answers": [{"comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1454519020, "post_id": 35183003, "comment_id": 58083464, "body": "Thanks for the info I just want to <code>Print</code> every line on new line in the note can you help with this I am just so new to this can&#39;t catch up I tried adding <code>&lt;div&gt;</code> tags but I get too many errors."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1454523066, "post_id": 35183003, "comment_id": 58086123, "body": "Thanks . So adding <code>&quot;&lt;br&gt;&quot;</code> : simply as a string in <code>Print #1, &quot;&lt;br&gt;&quot; &amp; CBr(.Cells(iRow, &quot;E&quot;).Value) &amp; &quot;&lt;&#47;br&gt;&quot;</code> prints it on new line and that solves one problem"}], "tags": [], "owner": {"reputation": 1077, "user_id": 733032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221cd77d0d07d1652d115b88cbc5c7a6?s=128&d=identicon&r=PG", "display_name": "akhaku", "link": "https://stackoverflow.com/users/733032/akhaku"}, "is_accepted": true, "score": 2, "last_activity_date": 1454518321, "creation_date": 1454518321, "answer_id": 35183003, "question_id": 35178517, "link": "https://stackoverflow.com/questions/35178517/how-can-i-preserve-the-format-while-exporting-data-from-excel-to-evernote/35183003#35183003", "title": "How can I preserve the format while exporting data from excel to evernote", "body": "<p>The contents for an Evernote note are in <a href=\"https://dev.evernote.com/doc/articles/enml.php\" rel=\"nofollow\">ENML</a>, which is a superset of xHTML. You'll see that the list of <a href=\"https://dev.evernote.com/doc/articles/enml.php#permitted\" rel=\"nofollow\">permitted elements</a> includes tags like <code>&lt;table&gt;</code>, <code>&lt;tr&gt;</code> and <code>&lt;td&gt;</code>, so you can use those to construct an html table for the note content.</p>\n\n<p>An alternative solution would be to do it via CSS. The caveat there is that the CSS will have to go in the <code>style</code> attribute for each element, as an inline style. Note that the <code>&lt;br/&gt;</code> tag is also supported.</p>\n"}, {"tags": [], "owner": {"reputation": 1117, "user_id": 915019, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/05CAz.jpg?s=128&g=1", "display_name": "JMichaelTX", "link": "https://stackoverflow.com/users/915019/jmichaeltx"}, "is_accepted": false, "score": 0, "last_activity_date": 1454722083, "creation_date": 1454722083, "answer_id": 35236246, "question_id": 35178517, "link": "https://stackoverflow.com/questions/35178517/how-can-i-preserve-the-format-while-exporting-data-from-excel-to-evernote/35236246#35236246", "title": "How can I preserve the format while exporting data from excel to evernote", "body": "<p>I'd suggest that you start by manually building a Note in Evernote that looks just like you want it to, and then export that Note to ENEX.  You can then examine the ENEX file to see how things need to be formatted.</p>\n\n<p>One key thing I have noticed is that the Evernote app itself uses the HTML <code>&lt;div&gt;</code> tag extensively, rather than <code>&lt;p&gt;</code> or <code>&lt;br&gt;</code>, to achieve lines without spaces between the lines.</p>\n\n<p>If you want the EN Note to display the data as table, like in Excel, then you will need to use the HTML <code>&lt;table&gt;</code> tags in your output.</p>\n"}], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 35183003, "answer_count": 2, "score": 0, "last_activity_date": 1454722083, "creation_date": 1454506369, "last_edit_date": 1454509363, "question_id": 35178517, "link": "https://stackoverflow.com/questions/35178517/how-can-i-preserve-the-format-while-exporting-data-from-excel-to-evernote", "title": "How can I preserve the format while exporting data from excel to evernote", "body": "<p>I have the following code in excel which imports the data from every row and column into a single note for every row.</p>\n\n<p>But it doesn't formats the data as it is in excel but just prints the cell contents as it is.</p>\n\n<p>This is how it looks now when I impor the .enex file</p>\n\n<p><a href=\"https://i.stack.imgur.com/tZAIx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tZAIx.jpg\" alt=\"Screenshot of the imported data\"></a>\nThis is how it looks in excel.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6kHQA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6kHQA.jpg\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>Code</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nSub OutputNotesXML()\n\nDim iRow As Long\n\nClose #1\nWith ActiveSheet\n    'For iRow = 2 To 2\n    Open ThisWorkbook.Path &amp; \"\\evernote-import.enex\" For Output As #1\n        Print #1, \"&lt;?xml version=\" &amp; Chr(34) &amp; \"1.0\" &amp; Chr(34) &amp; \" encoding=\" &amp; Chr(34) &amp; \"UTF-8\" &amp; Chr(34) &amp; \"?&gt;\"\n        Print #1, \"&lt;!DOCTYPE en-export SYSTEM \" &amp; Chr(34) &amp; \"http://xml.evernote.com/pub/evernote-export.dtd\" &amp; Chr(34) &amp; \"&gt;\"\n        Print #1, \"&lt;en-export export-date=\" &amp; Chr(34) &amp; \"20120202T073208Z\" &amp; Chr(34) &amp; \" application=\" &amp; Chr(34) &amp; \"Evernote/Windows\" &amp; Chr(34) &amp; \" version=\" &amp; Chr(34) &amp; \"4.x\" &amp; Chr(34) &amp; \"&gt;\"\n\n    For iRow = 2 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Print #1, \"&lt;note&gt;&lt;title&gt;\"\n        Print #1, .Cells(iRow, \"A\").Value 'Title\n        Print #1, \"&lt;/title&gt;&lt;content&gt;&lt;![CDATA[&lt;?xml version=\" &amp; Chr(34) &amp; \"1.0\" &amp; Chr(34) &amp; \" encoding=\" &amp; Chr(34) &amp; \"UTF-8\" &amp; Chr(34) &amp; \"?&gt;\"\n        Print #1, \"&lt;!DOCTYPE en-note SYSTEM \" &amp; Chr(34) &amp; \"http://xml.evernote.com/pub/enml2.dtd\" &amp; Chr(34) &amp; \"&gt;\"\n        Print #1, \"&lt;en-note style=\" &amp; Chr(34) &amp; \"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;\" &amp; Chr(34) &amp; \"&gt;\"\n        Print #1, CBr(.Cells(iRow, \"B\").Value) &amp; vbNewLine 'Note\n        Print #1, CBr(.Cells(iRow, \"C\").Value) &amp; vbNewLine 'Note\n        Print #1, CBr(.Cells(iRow, \"D\").Value) &amp; vbNewLine 'Note\n\n        Print #1, CBr(.Cells(iRow, \"E\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"F\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"G\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"H\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"I\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"J\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"K\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"L\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"M\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"N\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"O\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"P\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"Q\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"R\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"S\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"T\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"U\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"V\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"W\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"X\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"Y\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"Z\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"AA\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"AB\").Value) 'Note\n        Print #1, CBr(.Cells(iRow, \"AC\").Value) 'Note\n        Print #1, \"&lt;/en-note&gt;]]&gt;&lt;/content&gt;&lt;created&gt;\"\n\n\n\n\n        'Print #1, .Cells(iRow, \"D\").Text 'Created Date in Evernote Time Format...\n        'To get the evernote time, first convert your time to Zulu/UTC time.\n        'Put this formula in Column D: =C2+TIME(6,0,0) where 6 is the hours UTC is ahead of you.\n        'Then right click on your date column, select format, then select custom. Use this custom code: yyyymmddThhmmssZ\n        Print #1, \"&lt;/created&gt;&lt;updated&gt;201206025T000001Z&lt;/updated&gt;&lt;/note&gt;\"\n    Next iRow\n    Print #1, \"&lt;/en-export&gt;\"\n    Close #1\n\nEnd With\n\nEnd Sub\n\nFunction CBr(val) As String\n    'parse hard breaks into to HTML breaks\n    CBr = Replace(val, Chr(13), \"\")\n    CBr = Replace(CBr, \"&amp;\", \"&amp;amp;\")\nEnd Function\n\n'I modified this code from Marty Zigman's post here: http://blog.prolecto.com/2012/01/31/importing-excel-data-into-evernote-without-a-premium-account/\n</code></pre>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "edited": false, "score": 0, "creation_date": 1454506540, "post_id": 35178413, "comment_id": 58073988, "body": "Do you have an example of what your data looks like? And the way you want it to look?"}], "answers": [{"tags": [], "owner": {"reputation": 208, "user_id": 5615421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/e5Rqn.png?s=128&g=1", "display_name": "Herry Markowitz", "link": "https://stackoverflow.com/users/5615421/herry-markowitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1454507540, "creation_date": 1454507540, "answer_id": 35178953, "question_id": 35178413, "link": "https://stackoverflow.com/questions/35178413/i-need-to-convert-a-tear-range-to-comma-separated-range/35178953#35178953", "title": "I need to convert a tear range to comma separated range", "body": "<p>For example: <a href=\"http://prntscr.com/9yhns8\" rel=\"nofollow\">http://prntscr.com/9yhns8</a></p>\n\n<pre><code>=CONCATENATE(A1;\",\";A2;\",\";A3;\",\";A4;\",\";A5;\",\";A6;\",\";A7;\",\";A8;\",\";A9;\",\";A10;\",\";A11)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 4204590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae17d6d72a1f0d8447f89fc149869fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4204590/tommy"}, "edited": false, "score": 0, "creation_date": 1458769180, "post_id": 35179180, "comment_id": 60013555, "body": "That works to create the range, but half the numbers, it changes the &quot;,&quot; and makes a huge number.  How do you prevent that?"}, {"owner": {"reputation": 19, "user_id": 4204590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae17d6d72a1f0d8447f89fc149869fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4204590/tommy"}, "edited": false, "score": 0, "creation_date": 1458771312, "post_id": 35179180, "comment_id": 60014535, "body": "I figured it out.  Had to uncomment tempCelValue"}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": true, "score": 1, "last_activity_date": 1454508146, "creation_date": 1454508146, "answer_id": 35179180, "question_id": 35178413, "link": "https://stackoverflow.com/questions/35178413/i-need-to-convert-a-tear-range-to-comma-separated-range/35179180#35179180", "title": "I need to convert a tear range to comma separated range", "body": "<p>The below code converts as cell value like '1995-2000' to '1995,1996,1997,1998,1999,2000'. This will continue for all the cells specified in the Range</p>\n\n<pre><code>Sub commaYear()\nDim rng As Range\nDim ws As Worksheet\nDim cellValue As Range\nDim strtYear As Integer\nDim endYear As Integer\nDim tempCelValue As String\nSet rng = Range(\"A1:A10\") 'Specify your Coloumn range\n\nFor Each cellValue In rng.Cells\n    If (cellValue.Value &lt;&gt; \"\") Then\n        strtYear = CInt(Trim(Split(cellValue.Value, \"-\")(0)))\n        endYear = CInt(Trim(Split(cellValue.Value, \"-\")(1)))\n        'tempCelValue = \"'\"\n        While (strtYear &lt;= endYear)\n            If (strtYear = endYear) Then\n                tempCelValue = tempCelValue &amp; strtYear\n                strtYear = strtYear + 1\n            Else\n                tempCelValue = tempCelValue &amp; strtYear &amp; \",\"\n                strtYear = strtYear + 1\n            End If\n        Wend\n        cellValue.Value = tempCelValue\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4204590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae17d6d72a1f0d8447f89fc149869fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4204590/tommy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 35179180, "answer_count": 2, "score": -2, "last_activity_date": 1462523030, "creation_date": 1454506107, "last_edit_date": 1462523030, "question_id": 35178413, "link": "https://stackoverflow.com/questions/35178413/i-need-to-convert-a-tear-range-to-comma-separated-range", "title": "I need to convert a tear range to comma separated range", "body": "<p>I have a single column in my worksheet that has year ranges in each cell. (i.e 1995-2005)  I know formulas pretty well, but I do not know VBA.  Could someone tell me a scripts I can use to change this range into a comma separated year range in a single cell.  (i.e 1995,1995,1997, etc)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454504577, "post_id": 35177793, "comment_id": 58072533, "body": "tried anything? where&#39;s your code? I could write this easily and I&#39;m a newby in vba... ;)"}, {"owner": {"reputation": 61, "user_id": 2750619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4231a354d21c248d4c330ebb255b5895?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/2750619/dominic"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454505087, "post_id": 35177793, "comment_id": 58072879, "body": "Hi Kathara, sure ill update the original post with what i have so far... i am stuck on the bit that identifies the header and finds the same in the other workbook..."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454505157, "post_id": 35177793, "comment_id": 58072929, "body": "Just for the future: always post the code you have here on stackoverflow. Otherwise barely anyone will help... ;)"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 2750619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4231a354d21c248d4c330ebb255b5895?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/2750619/dominic"}, "edited": false, "score": 0, "creation_date": 1454507958, "post_id": 35178654, "comment_id": 58075013, "body": "Hi EranG thank you very much for putting me on the right path. i do know the workbooks (ThisWorkbook) where the code is, and the source is found through an update/prepare file userform. So i have the file name exactly."}, {"owner": {"reputation": 708, "user_id": 3800705, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a456d758ca93ed21dd8f2125c6562290?s=128&d=identicon&r=PG&f=1", "display_name": "EranG", "link": "https://stackoverflow.com/users/3800705/erang"}, "reply_to_user": {"reputation": 61, "user_id": 2750619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4231a354d21c248d4c330ebb255b5895?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/2750619/dominic"}, "edited": false, "score": 0, "creation_date": 1454508999, "post_id": 35178654, "comment_id": 58075788, "body": "You can copy this code to the destination file and run it from there even if you know the file names"}, {"owner": {"reputation": 708, "user_id": 3800705, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a456d758ca93ed21dd8f2125c6562290?s=128&d=identicon&r=PG&f=1", "display_name": "EranG", "link": "https://stackoverflow.com/users/3800705/erang"}, "reply_to_user": {"reputation": 61, "user_id": 2750619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4231a354d21c248d4c330ebb255b5895?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/2750619/dominic"}, "edited": false, "score": 0, "creation_date": 1454582695, "post_id": 35178654, "comment_id": 58113857, "body": "If the solution works for you, ticking the answer is appreciated."}, {"owner": {"reputation": 61, "user_id": 2750619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4231a354d21c248d4c330ebb255b5895?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/2750619/dominic"}, "edited": false, "score": 1, "creation_date": 1454663336, "post_id": 35178654, "comment_id": 58154620, "body": "hey sorry, i was off work yesterday. ticked! thanks again EranG!"}], "tags": [], "owner": {"reputation": 708, "user_id": 3800705, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a456d758ca93ed21dd8f2125c6562290?s=128&d=identicon&r=PG&f=1", "display_name": "EranG", "link": "https://stackoverflow.com/users/3800705/erang"}, "is_accepted": true, "score": 1, "last_activity_date": 1454506707, "creation_date": 1454506707, "answer_id": 35178654, "question_id": 35177793, "link": "https://stackoverflow.com/questions/35177793/automatically-coping-columns-between-workbooks/35178654#35178654", "title": "Automatically Coping Columns between workbooks", "body": "<p>This code works for me. Note the comments.</p>\n\n<pre><code>Sub copyA2B()\nDim wb As Workbook\nDim wbSrc As String\nDim cel As Range\n'assuming you don't know the source workbook name, looping through the workbooks, otherwise no loop needed\nFor Each wb In Workbooks\n    If wb.Name &lt;&gt; ActiveWorkbook.Name Then\n        wbSrc = wb.Name\n        Exit For\n    End If\nNext\nWith Workbooks(wbSrc).ActiveSheet\n    'assuming the column order is different between the two files, looping through the titles, otherwise no loop needed\n    For Each cel In .Rows(1).Cells 'assuming the titles are in the first row in both workbooks\n        If cel &lt;&gt; \"\" And cel(2) &lt;&gt; \"\" Then\n            .Range(cel(2), cel(1).End(xlDown)).Copy Rows(1).Find(cel.Value)(2)\n        End If\n    Next\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 61, "user_id": 2750619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4231a354d21c248d4c330ebb255b5895?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/2750619/dominic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 35178654, "answer_count": 1, "score": -1, "last_activity_date": 1454506707, "creation_date": 1454504363, "question_id": 35177793, "link": "https://stackoverflow.com/questions/35177793/automatically-coping-columns-between-workbooks", "title": "Automatically Coping Columns between workbooks", "body": "<p>I need help creating a piece of code that will.</p>\n\n<ul>\n<li>Identify two separate workbooks: workbook1 (the source file) &amp; workbook2 (active.workbook).</li>\n<li>take the column title in workbook1, find that column title in workbook 2 and copy the content of the column from workbook1 into workbook 2. </li>\n<li>move to the next column in workbook1 until its title is blank.</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1454503194, "post_id": 35177215, "comment_id": 58071552, "body": "Could you please share your code, it would help us to understand even better."}], "answers": [{"tags": [], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "is_accepted": false, "score": 0, "last_activity_date": 1454504008, "creation_date": 1454504008, "answer_id": 35177653, "question_id": 35177215, "link": "https://stackoverflow.com/questions/35177215/excel-vba-clear-contents/35177653#35177653", "title": "Excel VBA Clear Contents", "body": "<p>Please try the below sample code it should work..</p>\n\n<pre><code>Sub test()\n'Assuming your data in column  A from A2\n\nSet Rng = Range(\"A2\", Cells(Rows.Count, 1).End(xlUp))\n\nFor Each cell In Rng\n    If cell.Value = \"\" Then\n    cell.ClearContents\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>And in your formula <code>=If(Cond 1 is TRUE, X, Y)</code> your not giving any output like <strong>\"\"</strong> which will give you blank. Please update it and then try :)</p>\n"}, {"tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1454504092, "creation_date": 1454504092, "answer_id": 35177686, "question_id": 35177215, "link": "https://stackoverflow.com/questions/35177215/excel-vba-clear-contents/35177686#35177686", "title": "Excel VBA Clear Contents", "body": "<p>Try this as well</p>\n\n<pre><code>If (Range(\"A35\").Value = \"\") Then\n    Range(\"A35\").Formula = \"\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5877769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9764adb5622a52c6f5d0d5195aa83204?s=128&d=identicon&r=PG&f=1", "display_name": "Xain Cheema", "link": "https://stackoverflow.com/users/5877769/xain-cheema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4417, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1454504865, "creation_date": 1454502719, "last_edit_date": 1531164843, "question_id": 35177215, "link": "https://stackoverflow.com/questions/35177215/excel-vba-clear-contents", "title": "Excel VBA Clear Contents", "body": "<p>I have a column in excel sheet that contains the IF condition i.e.</p>\n\n<pre><code>=If(Cond 1 is TRUE, X, Y)\n</code></pre>\n\n<p>Now, after using this condition, i get certain values in the column. Following format can be considered (these are actual values):  </p>\n\n<pre><code>4L  \n4L  \n4L  \n\n\n4L \n</code></pre>\n\n<p><strong>Note:</strong> The two empty cells in the above col  are an outcome of the TRUE condition(entry 4 and 5, i entered total 6 entries, two are empty cells ). Therefore, they are valid. (let me call the above col \"A\" for future reference)</p>\n\n<p>Now, these empty cells actually contains formulas (the if condition). I want to <strong>CLEARCONTENT</strong> them using VBA but it is not working. </p>\n\n<p>And I'm trying the below code:</p>\n\n<pre><code>If ActiveSheet.Cells(row_no, col_no) = \"\" Then\nActiveSheet.Cells(row_no, col_no).ClearContents\nEnd If\n</code></pre>\n\n<p>But this does not work. I just want to CLEAR CONTENT those empty cells by running a loop over the whole column. The cells of the column where TEXT exist (i.e. 4L), that should be skipped but as soon the code encounters the EMPTY CELL (which actually have an IF condition), it should CLEAR CONTENT it and complete the loop. So the final result would be again the same as column \"A\", the only difference would be that the empty cells will be BLANK now i.e. they will not have any IF condition.</p>\n\n<p>I do not have problem running the loops but i am not getting how to tell VBA about that empty cell and clear contenting it. Hopefully i was able to post a clear query. Thanking in advance.</p>\n\n<p>Regards\nNayyar</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1454500663, "post_id": 35176379, "comment_id": 58069831, "body": "which line gets marked? well, seems to be line wks.Paste, my mistake. I take a look at it."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1454501034, "post_id": 35176379, "comment_id": 58070052, "body": "First of all: If you state <code>Dim wks, wks2 As Worksheet</code>, only wks2 will be declared as a Worksheet. wks will be a Variant, but this should work nonetheless. Second: It works for me (after adapting sheet and shape names)"}, {"owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "edited": false, "score": 0, "creation_date": 1454501188, "post_id": 35176379, "comment_id": 58070147, "body": "I don&#39;t understand why you would dim the worksheets anyway, unless your code is way longer than this."}], "answers": [{"comments": [{"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1454501143, "post_id": 35176577, "comment_id": 58070106, "body": "Basically, this does the same as the original code."}, {"owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1454501507, "post_id": 35176577, "comment_id": 58070375, "body": "I didn&#39;t know the <code>sheets(1).paste range(&quot;A1&quot;)</code> would work as well. In that case I would suggest the TS to check the names of the worksheets he has set."}], "tags": [], "owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "is_accepted": false, "score": 0, "last_activity_date": 1454501067, "creation_date": 1454501067, "answer_id": 35176577, "question_id": 35176379, "link": "https://stackoverflow.com/questions/35176379/method-paste-failed-but-code-looks-simple-and-have-worked-before/35176577#35176577", "title": "Method Paste failed, but code looks simple (and have worked before)", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub Copy_Images()\n\nDim wks as worksheet, wks2 As Worksheet\n\nSet wks = Sheets(\"export\")\nSet wks2 = Sheets(\"HomePage\")\n\n    wks2.Shapes(\"picture\").Copy\n    wks.range(\"A1\").Paste\n\nEnd Sub \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1454501232, "post_id": 35176605, "comment_id": 58070187, "body": "This also does the same as the original code AND adds an unnecessary Select-statement, which should be avoided completely."}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1454501140, "creation_date": 1454501140, "answer_id": 35176605, "question_id": 35176379, "link": "https://stackoverflow.com/questions/35176379/method-paste-failed-but-code-looks-simple-and-have-worked-before/35176605#35176605", "title": "Method Paste failed, but code looks simple (and have worked before)", "body": "<p>Try below code </p>\n\n<pre><code>Private Sub Copy_Images()\n  Dim wks As Worksheet \n  Dim wks2 As Worksheet        \n  Set wks = Sheets(\"export\")        \n  Set wks2 = Sheets(\"HomePage\")    \n  wks2.Activate    \n  wks2.Shapes(\"picture\").Copy    \n  wks.Activate \n  Range(\"A1\").Select   \n  ActiveSheet.Paste   \nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5659354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c51e42435b9a0207300054c1285ac4?s=128&d=identicon&r=PG&f=1", "display_name": "drummond", "link": "https://stackoverflow.com/users/5659354/drummond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454501140, "creation_date": 1454500561, "last_edit_date": 1454501016, "question_id": 35176379, "link": "https://stackoverflow.com/questions/35176379/method-paste-failed-but-code-looks-simple-and-have-worked-before", "title": "Method Paste failed, but code looks simple (and have worked before)", "body": "<p>What is wrong with this code?:   </p>\n\n<pre><code>Private Sub Copy_Images()\n    Dim wks, wks2 As Worksheet        \n    Set wks = Sheets(\"export\")        \n    Set wks2 = Sheets(\"HomePage\")    \n    wks2.Activate    \n    wks2.Shapes(\"picture\").Copy    \n    wks.Activate    \n    wks.Paste Range(\"A1\")    \nEnd Sub \n</code></pre>\n\n<hr>\n\n<p>Error: Method 'Paste' of object '_Worksheet' failed - 1004</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454501609, "post_id": 35176165, "comment_id": 58070448, "body": "How are you setting the selectall checkbox to be checked, is it clicking chkSelAll?  This would be clicked to select all, and un-checked once another checkbox is selected."}, {"owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454501832, "post_id": 35176165, "comment_id": 58070614, "body": "Yes, clicking the chkSelAll changes the values of the other checkboxes to true or false. I&#39;ve edited the original message with the Sub."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "edited": false, "score": 0, "creation_date": 1454502178, "post_id": 35176868, "comment_id": 58070871, "body": "This is a splendit idea! I can make this work! Thanks for your help! :)"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 2, "last_activity_date": 1454501852, "creation_date": 1454501852, "answer_id": 35176868, "question_id": 35176165, "link": "https://stackoverflow.com/questions/35176165/vba-chkbox-click-event-triggered-by-changing-value-chkbox/35176868#35176868", "title": "VBA: chkbox_click event triggered by changing value chkbox", "body": "<p>Add a public variable, say blnBypassNonUIClick and set this, then when coming from the UI, by a human click set it to false, and when setting the select all the same.  Your select all, shouldnt activate click if you're setting the .value by code.  Something like this....</p>\n\n<pre><code>Public blnNonUI As Boolean\n\nPrivate Sub CheckBox1_Click()\n    If Not blnNonUI Then\n        MsgBox \"hello\"\n    End If\nEnd Sub\n\nPrivate Sub UserForm_Click()\n    blnNonUI = True\n    Me.CheckBox1.Value = 1\n    blnNonUI = False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "is_accepted": false, "score": 0, "last_activity_date": 1454502358, "creation_date": 1454502358, "answer_id": 35177066, "question_id": 35176165, "link": "https://stackoverflow.com/questions/35176165/vba-chkbox-click-event-triggered-by-changing-value-chkbox/35177066#35177066", "title": "VBA: chkbox_click event triggered by changing value chkbox", "body": "<p>Nathan_Sav gave me this idea and it works:</p>\n\n<pre><code>Public blnHumanClick As Boolean\n\nPrivate Sub chkSelAll_Click()\n\nIf blnHumanClick = True Then\n\n    Dim ctrl As Control\n\n        For Each ctrl In Me.Controls\n            If TypeName(ctrl) = \"CheckBox\" And Left(ctrl.Name, 1) = \"M\" Then\n                If chkSelAll.value = True Then\n                    ctrl.value = True\n                Else\n                    ctrl.value = False\n                End If\n            End If\n        Next\n\n    Set ctrl = Nothing\n\n    blnHumanClick = False\n\nEnd If\n\nEnd Sub\n\nPrivate Sub chkSelAll_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\n    blnHumanClick = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 1, "accepted_answer_id": 35176868, "answer_count": 2, "score": 1, "last_activity_date": 1454502358, "creation_date": 1454499904, "last_edit_date": 1454501756, "question_id": 35176165, "link": "https://stackoverflow.com/questions/35176165/vba-chkbox-click-event-triggered-by-changing-value-chkbox", "title": "VBA: chkbox_click event triggered by changing value chkbox", "body": "<p>I have a userform which is dynamically filled by checkboxes. To improve usability I've added a checkbox \"Select all\" which either selects or deselects all checkboxes. This works perfectly. Now I want the \"Select all\" checkbox to be unchecked (value=False) automatically once one of the other checkboxes is unchecked.</p>\n\n<p>In order to achieve this I've created a class module. This class module also does what it's supposed to. But, and here's my problem, once the value of \"Select all\" is changed, the \"Select all\" checkbox_click event is triggered, which means all other checkboxes are being unchecked as well, and that's obviously not what I want! I've already tried to use the MouseDown and MouseUp events instead, but these events behave irregular and often lead to the wrong results.</p>\n\n<p><strong>Question:</strong> How do I stop the Click event from running everytime the value of this checkbox is changed without the checkbox actually being clicked?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Private colTickBoxes As Collection\nPrivate Sub UserForm_Initialize()\n\nDim ChkBoxes As cls_RIRI\nDim ctrl As Control\n\n'Controls are created on run time here\n'Some events to change the height of the userform and the top value of several buttons\n\n    'Make sure click events work\n    Set colTickBoxes = New Collection\n\n    For Each ctrl In Me.Controls\n        If TypeName(ctrl) = \"CheckBox\" And Left(ctrl.Name, 1) = \"M\" Then\n            Set ChkBoxes = New cls_RIRI\n            ChkBoxes.AssignClicks ctrl\n            colTickBoxes.Add ChkBoxes\n        End If\n    Next ctrl\n\nSet ctrlCHK = Nothing\nSet ChkBoxes = Nothing\nSet ctrl = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>And the class module:</p>\n\n<pre><code>Private WithEvents chkBox As MSForms.CheckBox\nPublic Sub AssignClicks(ctrl As Control)\n\n    Set chkBox = ctrl\n\nEnd Sub\nPrivate Sub chkBox_Click()\n\n    If chkBox.value = False Then UserForms(0).Controls(\"chkSelAll\").value = False\n\nEnd Sub\n</code></pre>\n\n<p>And the chkSelAll_Click sub:</p>\n\n<pre><code>Private Sub chkSelAll_Click()\n\nDim ctrl As Control\n\n    For Each ctrl In Me.Controls\n        If TypeName(ctrl) = \"CheckBox\" And Left(ctrl.Name, 1) = \"M\" Then\n            If chkSelAll.value = True Then\n                ctrl.value = True\n            Else\n                ctrl.value = False\n            End If\n        End If\n    Next\n\nSet ctrl = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["r", "vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1454497808, "post_id": 35175343, "comment_id": 58067848, "body": "Do you get any error messages?"}, {"owner": {"reputation": 387, "user_id": 5877411, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23b487ceba26c0381ed36c7e02b41efa?s=128&d=identicon&r=PG&f=1", "display_name": "Bambs", "link": "https://stackoverflow.com/users/5877411/bambs"}, "reply_to_user": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1454498506, "post_id": 35175343, "comment_id": 58068350, "body": "No, nothing. I just can&#39;t open it when it&#39;s done. Excel stops, ans when I can finally open the file, nothing has changed in it (the macro didn&#39;t work)."}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 5877411, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23b487ceba26c0381ed36c7e02b41efa?s=128&d=identicon&r=PG&f=1", "display_name": "Bambs", "link": "https://stackoverflow.com/users/5877411/bambs"}, "edited": false, "score": 0, "creation_date": 1454500022, "post_id": 35176046, "comment_id": 58069390, "body": "Thank you for your answer. pathfile is hardcoded in the vbscript. I changed it in the post so that you don&#39;t have the full path to read. I added On Error Resume Next but now the file is empty..."}, {"owner": {"reputation": 387, "user_id": 5877411, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23b487ceba26c0381ed36c7e02b41efa?s=128&d=identicon&r=PG&f=1", "display_name": "Bambs", "link": "https://stackoverflow.com/users/5877411/bambs"}, "edited": false, "score": 0, "creation_date": 1454510304, "post_id": 35176046, "comment_id": 58076837, "body": "Oh yes, I see what you mean now. I get &quot;Unknown execution error&quot; (translated from French)"}], "tags": [], "owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "is_accepted": false, "score": 1, "last_activity_date": 1454500818, "last_edit_date": 1454500818, "creation_date": 1454499571, "answer_id": 35176046, "question_id": 35175343, "link": "https://stackoverflow.com/questions/35175343/launch-vba-macro-from-r/35176046#35176046", "title": "Launch VBA macro from R", "body": "<p><code>pathfile</code> is not defined in your .vbs:</p>\n\n<pre><code>Set xlBook =     xlApp.Workbooks.Open(pathfile, 0, True)\n</code></pre>\n\n<p>and your EVIL</p>\n\n<pre><code>On Error Resume Next\n</code></pre>\n\n<p>hides all errors.</p>\n\n<p><strong>Update wrt comment:</strong></p>\n\n<p>(\"I added On Error Resume Next but now the file is empty\") - You already <strong>have</strong> an EVIL OERN; you should remove it - and then study the error message - probably concerning the parameters to the <code>.Open</code> call.</p>\n"}, {"comments": [{"owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "edited": false, "score": 0, "creation_date": 1454502926, "post_id": 35177048, "comment_id": 58071377, "body": "<code>xlBook.Close SaveChanges:=False</code> will cause an error in VBScript."}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1454502315, "creation_date": 1454502315, "answer_id": 35177048, "question_id": 35175343, "link": "https://stackoverflow.com/questions/35175343/launch-vba-macro-from-r/35177048#35177048", "title": "Launch VBA macro from R", "body": "<p>You are doing <code>xlApp.Quit</code> without saving and closing the Workbook first.</p>\n\n<p>Add this:</p>\n\n<pre><code>xlBook.Save\nxlBook.Close SaveChanges:=False\n</code></pre>\n\n<p>Before:</p>\n\n<pre><code>xlApp.Quit\n</code></pre>\n\n<p>And remove <code>On Error Resume Next</code> to see errors.</p>\n"}, {"tags": [], "owner": {"reputation": 387, "user_id": 5877411, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23b487ceba26c0381ed36c7e02b41efa?s=128&d=identicon&r=PG&f=1", "display_name": "Bambs", "link": "https://stackoverflow.com/users/5877411/bambs"}, "is_accepted": true, "score": 0, "last_activity_date": 1454577683, "creation_date": 1454577683, "answer_id": 35197019, "question_id": 35175343, "link": "https://stackoverflow.com/questions/35175343/launch-vba-macro-from-r/35197019#35197019", "title": "Launch VBA macro from R", "body": "<p>I found the solution. If some of you are trying to call personnal library from a vbscript, you need to add :</p>\n\n<pre><code>Dim objWorkbook\nSet objWorkbook=xlApp.Workbooks.Open(\"D:\\users\\...\\PERSONAL.XLSB\")\n</code></pre>\n\n<p>before launching the macro.</p>\n"}], "owner": {"reputation": 387, "user_id": 5877411, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23b487ceba26c0381ed36c7e02b41efa?s=128&d=identicon&r=PG&f=1", "display_name": "Bambs", "link": "https://stackoverflow.com/users/5877411/bambs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2839, "favorite_count": 0, "accepted_answer_id": 35197019, "answer_count": 3, "score": 5, "last_activity_date": 1454577683, "creation_date": 1454497619, "last_edit_date": 1531164843, "question_id": 35175343, "link": "https://stackoverflow.com/questions/35175343/launch-vba-macro-from-r", "title": "Launch VBA macro from R", "body": "<p>I am currently trying to launch a very simple VBA macro from R. For that, I am following the procedure found here : <a href=\"https://stackoverflow.com/questions/19404270/run-vba-script-from-r\">Run VBA script from R</a>\nUnfortunately, when I open the Excel file after that, it's corrupted and Excel stops.\nHere is my code :</p>\n\n<p><strong><a href=\"/questions/tagged/r\" class=\"post-tag\" title=\"show questions tagged &#39;r&#39;\" rel=\"tag\">r</a>:</strong></p>\n\n<pre><code>library(XLConnect)\nsaveWorkbook(wb,pathfile)\n# The saveWorkbook part is working\nshell(shQuote(normalizePath(pathtovbs)), \"cscript\", flag = \"//nologo\")\n</code></pre>\n\n<hr>\n\n<p><strong><a href=\"/questions/tagged/vbscript\" class=\"post-tag\" title=\"show questions tagged &#39;vbscript&#39;\" rel=\"tag\">vbscript</a>:</strong></p>\n\n  \n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nOn Error Resume Next\nExcelMacroExample\nSub ExcelMacroExample() \n  Dim xlApp \n  Dim xlBook \n  Set xlApp = CreateObject(\"Excel.Application\") \n  Set xlBook =     xlApp.Workbooks.Open(pathfile, 0, True) \n  xlApp.Run \"PERSONAL.XLSB!MyMacro\"\n  xlApp.Quit \n  Set xlBook = Nothing \n  Set xlApp = Nothing \nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> PESONAL.XLSB!MyMacro:</strong>  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub MyMacro()\n\n Dim ws As Worksheet\n    For Each ws In Sheets\n       ws.Range(\"C:C\").EntireColumn.Delete\n       ws.Range(\"A:A\").EntireColumn.Delete\n   Next ws\nEnd Sub\n</code></pre>\n\n<p>Do you have any idea what is going on ? I have checked the path of each file and they are good.\nThank you very much in advance.</p>\n\n<p><strong>Edit :</strong> Apparently, problem comes from the vbscript. The file opens but it can't find the macro located in my personal library (PERSONAL.XLSB). When I open Excel manually, I can access this macro, but when I open Excel from another program, I can't. Any idea why ?</p>\n\n<p>Pauline</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454497493, "post_id": 35175177, "comment_id": 58067630, "body": "ever heard of the method xlPasteSpecial? if not try google :)"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1454498367, "post_id": 35175177, "comment_id": 58068244, "body": "Welcome to Stack Overflow, please keep in mind this is not a code service. Please have a look at these pages. <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>, <a href=\"https://stackoverflow.com/help/on-topic\">What topics can I ask about</a> and <a href=\"https://stackoverflow.com/help/dont-ask\">What types of questions should I avoid</a>."}, {"owner": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "edited": false, "score": 0, "creation_date": 1454498618, "post_id": 35175177, "comment_id": 58068417, "body": "Sorry I&#39;m really new to VB."}, {"owner": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "edited": false, "score": 0, "creation_date": 1454498870, "post_id": 35175177, "comment_id": 58068588, "body": "Kindly help me modify the above code."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "edited": false, "score": 0, "creation_date": 1454582388, "post_id": 35176687, "comment_id": 58113630, "body": "This works like a charm, thank you. Although none of the table formatting is being retained i.e borders, highlights, indentation."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "edited": false, "score": 0, "creation_date": 1454582850, "post_id": 35176687, "comment_id": 58113983, "body": "Have a look at the various <code>pastespcial</code> options on the msdn site."}], "tags": [], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "is_accepted": true, "score": 1, "last_activity_date": 1454501359, "creation_date": 1454501359, "answer_id": 35176687, "question_id": 35175177, "link": "https://stackoverflow.com/questions/35175177/copy-a-table-from-one-worksheet-to-another-while-maintaining-column-size/35176687#35176687", "title": "Copy a table from one worksheet to another while maintaining column size", "body": "<p>As it seems you're copying all data from the \"Closed\" worksheet and adding it to the bottom of the \"Misc.Dashboard\" Sheet, instead of writing a loop, which becomes very slow if amount of data increases, try to copy the range in one go.</p>\n\n<pre><code>Dim lastRow As Long, lastColumn As Long\n\nWith ThisWorkbook\n    With .Worksheets(\"Closed\")\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        lastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        .Range(.Cells(1, 1), .Cells(lastRow, lastColumn)).Copy\n    End With\n    With .Worksheets(\"Misc.Dashboard\")\n        .Range(.Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0), .Cells(.Rows.Count, lastColumn).End(xlUp).Offset(1 + lastRow, 0)).PasteSpecial (xlPasteColumnWidths)\n        .Range(.Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0), .Cells(.Rows.Count, lastColumn).End(xlUp).Offset(1 + lastRow, 0)).PasteSpecial (xlPasteValues)\n    End With\nEnd With\nApplication.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5826192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91f4e6df7b7be24c97df835a29ed0b9b?s=128&d=identicon&r=PG&f=1", "display_name": "GavinJones", "link": "https://stackoverflow.com/users/5826192/gavinjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 35176687, "answer_count": 1, "score": 0, "last_activity_date": 1454501359, "creation_date": 1454497197, "last_edit_date": 1454500899, "question_id": 35175177, "link": "https://stackoverflow.com/questions/35175177/copy-a-table-from-one-worksheet-to-another-while-maintaining-column-size", "title": "Copy a table from one worksheet to another while maintaining column size", "body": "<p>Copy a table from one worksheet to another where the column size from the original worksheet is to be maintained as the new sheet already has a table with smaller sized columns.</p>\n\n<pre><code>Dim i, lastRow\n\nlastRow = Sheets(\"Closed\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 1 To lastRow\n\nSheets(\"Closed\").Cells(i, \"A\").Copy Destination:=Sheets(\"Misc.Dashboard\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\nSheets(\"Closed\").Cells(i, \"B\").Copy Destination:=Sheets(\"Misc.Dashboard\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1)\nSheets(\"Closed\").Cells(i, \"C\").Copy Destination:=Sheets(\"Misc.Dashboard\").Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1)\nSheets(\"Closed\").Cells(i, \"D\").Copy Destination:=Sheets(\"Misc.Dashboard\").Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1)\nSheets(\"Closed\").Cells(i, \"E\").Copy Destination:=Sheets(\"Misc.Dashboard\").Range(\"E\" &amp; Rows.Count).End(xlUp).Offset(1)\nSheets(\"Closed\").Cells(i, \"F\").Copy Destination:=Sheets(\"Misc.Dashboard\").Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(1)\nSheets(\"Closed\").Cells(i, \"G\").Copy Destination:=Sheets(\"Misc.Dashboard\").Range(\"G\" &amp; Rows.Count).End(xlUp).Offset(1)\nSheets(\"Closed\").Cells(i, \"H\").Copy Destination:=Sheets(\"Misc.Dashboard\").Range(\"H\" &amp; Rows.Count).End(xlUp).Offset(1)\nSheets(\"Closed\").Cells(i, \"I\").Copy Destination:=Sheets(\"Misc.Dashboard\").Range(\"I\" &amp; Rows.Count).End(xlUp).Offset(1)\n\nNext i\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/YjGD0.png\" alt=\"First sheet,table to be copied\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/EdlkV.png\" alt=\"Second sheet, paste table below the table present\"></p>\n"}, {"tags": ["mysql", "vba", "if-statement", "search", "approximate"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "edited": false, "score": 0, "creation_date": 1454500131, "post_id": 35175503, "comment_id": 58069458, "body": "Thanks. I need a single cell so the first piece of code works. What can I do to make VBA spit out a different value if the cell =/= XXX? I tried &quot;Else&quot; and  it doesn&#39;t seem to work."}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "reply_to_user": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "edited": false, "score": 0, "creation_date": 1454500412, "post_id": 35175503, "comment_id": 58069652, "body": "Else should work, but I cannot possibly know what went wrong with your code, when you only tell that &quot;it does not seem to work&quot;."}, {"owner": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "edited": false, "score": 0, "creation_date": 1454501448, "post_id": 35175503, "comment_id": 58070339, "body": "Oh.. sorry, I must have made a mistake. I doublechecked and it works now. Thank you, my question is answered."}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "reply_to_user": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "edited": false, "score": 0, "creation_date": 1454502624, "post_id": 35175503, "comment_id": 58071158, "body": "Perhaps you could mark the answer as accepted then to indicate other readers that the question has already been answered."}, {"owner": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "edited": false, "score": 0, "creation_date": 1454503310, "post_id": 35175503, "comment_id": 58071647, "body": "Sure thing. Thank you again."}], "tags": [], "owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "is_accepted": true, "score": 1, "last_activity_date": 1454498450, "last_edit_date": 1454498450, "creation_date": 1454498028, "answer_id": 35175503, "question_id": 35175153, "link": "https://stackoverflow.com/questions/35175153/is-there-a-mysql-approximation-equivalent-in-vba/35175503#35175503", "title": "Is there a MySQL % (approximation) equivalent in VBA?", "body": "  \n\n<p>If you need to change only 1 cell's value, then use the InStr() function:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If InStr(1, Cells(1, 1).Value, \"xxx\")&gt;0 Then Cells(1, 1).Value=\"xxx\"\n</code></pre>\n\n<p>Obviously, replace <code>Cells(1, 1).Value</code> with your cell reference.</p>\n\n<p>If you need to check multiple cells, then use the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff839746.aspx\" rel=\"nofollow\">Range.Find</a> method:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim firstAddress As String\nWith Worksheets(1).Range(\"a1:a500\") \n    Set c = .Find(\"xxx\", lookin:=xlValues) \n    If Not c Is Nothing Then \n        firstAddress = c.Address \n        Do \n            c.Value = \"xxx\" \n            Set c = .FindNext(c) \n        Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress \n    End If \nEnd With\n</code></pre>\n\n<p>Again, replace <code>Worksheets(1).Range(\"a1:a500\")</code> with your own range reference.</p>\n"}], "owner": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 35175503, "answer_count": 1, "score": 2, "last_activity_date": 1454499242, "creation_date": 1454497108, "last_edit_date": 1454499242, "question_id": 35175153, "link": "https://stackoverflow.com/questions/35175153/is-there-a-mysql-approximation-equivalent-in-vba", "title": "Is there a MySQL % (approximation) equivalent in VBA?", "body": "<p>I want a VBA to look through a cell and determine whether the word <code>XXX</code> appears anywhere in it using the <code>%</code>. If yes I want VBA to change the entire cell to the word <code>YYY</code>.</p>\n\n<p>Can anyone help me with this? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454497257, "post_id": 35175119, "comment_id": 58067471, "body": "wait a second, you have two listboxes (with the same entries or just some same entries?) where when you selected one line you want to select the same line (or entry?) in the second listbox? what are you accomplishing with the line &quot;If Selection.row &gt;= StartRow()&quot;?"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454497554, "post_id": 35175119, "comment_id": 58067667, "body": "No sorry, I have a table, which contains the data, and I have a userform for (CRUD) with a listBox, which shows enough to know which entry you are editing, there you can select a entry. So you don&#39;t have to close and open it all the time"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454497918, "post_id": 35175119, "comment_id": 58067926, "body": "I Changed the Text above, to make it understandable, I try to post some screenshoots after my break =)   StartRow() gives back the first row of actual data in the table (I have some titles and buttons freezed before the actual data)"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454500670, "post_id": 35175119, "comment_id": 58069837, "body": "so each time the form is displayed the selected item in the listbox needs to be updated according to the selection of the excel table. what is your worksheet called? what is your form called?"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454505170, "post_id": 35175119, "comment_id": 58072936, "body": "my Form is called UserFormInput and my Worksheet is called Tabelle1. (Is quite a prototype yet)"}], "answers": [{"comments": [{"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454507142, "post_id": 35178616, "comment_id": 58074424, "body": "First of all thank you for an answer. I understand what you want to do here, but that&#39;s not my problem. It could be a workaround, but I am more interested in the difference between Selection.Row and ActiveCell.Row ? And could it help me to get rid of the strange behaviour ? (as I noted, my method works fine, if it&#39;s not triggered by a doubleclick)"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454507260, "post_id": 35178616, "comment_id": 58074507, "body": "It&#39;s just that I learned to evade .selection as much as possible. where is that code actually located?"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454507318, "post_id": 35178616, "comment_id": 58074555, "body": "in the UserFormInput_Activate()"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454507617, "post_id": 35178616, "comment_id": 58074785, "body": "Just fyi: I tried it by replacing .selection with activecell.row same strange behaviour, works if I give out the value with a msgbox, but not if I don&#39;t do it. going to try your way"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 1, "creation_date": 1454507828, "post_id": 35178616, "comment_id": 58074918, "body": "Hm.. this is really strange... can you once try to put debug.print Selection.row after the if-statement?"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454508960, "post_id": 35178616, "comment_id": 58075757, "body": "Debug.Print yeah something learned ;) (I normaly write in other programming languages) did that for activecell.row selection.row and for StartRow(). All numbers are correct. So I did it for ListBox.listIndex - also correct. Whats extremely strange. Checked for side-effects could not find anything. That&#39;s what happens if you want to write a quick ui for a trivial task ^^"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454509146, "post_id": 35178616, "comment_id": 58075915, "body": "hmm... does it work if you leave the debug.print in?"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454509806, "post_id": 35178616, "comment_id": 58076431, "body": "no, it doesn&#39;t. My idea was that is some sort of focus problem, because I use the activate_routine, and the focus is still on the double clicked form. I tried to move it to the initialize, but same result"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454510030, "post_id": 35178616, "comment_id": 58076624, "body": "Can you once try to write this code into another sub and then just call it from the userform_activate()-sub?"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454510175, "post_id": 35178616, "comment_id": 58076726, "body": "I just realized that my code wouldn&#39;t work because in the listbox the values of the first column are the values of two columns from the worksheet..."}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 1, "creation_date": 1454510290, "post_id": 35178616, "comment_id": 58076826, "body": "yeah but that&#39;s not a problem,  I can get your code to work. These values are also not unique ;). But I want to understand this ^^ writing it to a sub doesn&#39;t work either"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1454511197, "post_id": 35178616, "comment_id": 58077502, "body": "ok, I&#39;m a newby myself so I probably won&#39;t be able to give an explanation to this... :( If my code should work without bugs I believe it has to do something with the .selection. If you get an answer, I will be happy to learn this as well :)"}], "tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": false, "score": 1, "last_activity_date": 1454509206, "last_edit_date": 1454509206, "creation_date": 1454506606, "answer_id": 35178616, "question_id": 35175119, "link": "https://stackoverflow.com/questions/35175119/vba-excel-showing-form-after-double-click-on-a-cell/35178616#35178616", "title": "VBA - Excel Showing form after double click on a Cell", "body": "<p>(I'll write this as an answer but this is only a part of the code... :)</p>\n\n<p>Oh, german ^.^ </p>\n\n<p>I believe each time you call your userform you'll have to compare the selected data to the listbox data. As you have a multicolumn listbox you could do this by the following (I believe, but untested):</p>\n\n<pre><code>Dim ThisRow As Integer\nThisRow = ActiveCell.Row\nDim ThisValue As String\nThisValue = ActiveWorkbook.Sheet(\"Tabelle1\").Cells(ThisRow, 1).Value \n</code></pre>\n\n<p>This \"1\" should be the column which contains the same kind of information as is displayed in the first column of your listbox.</p>\n\n<pre><code>Dim i As Integer\nFor i = 1 to UserFormInput.Listbox1.Listcount\n    If UserFormInput.Listbox1.List(i, 0).Value = ThisValue Then\n        UserFormInput.Listbox1.List(i).Select\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1999, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454511842, "creation_date": 1454496996, "last_edit_date": 1454511842, "question_id": 35175119, "link": "https://stackoverflow.com/questions/35175119/vba-excel-showing-form-after-double-click-on-a-cell", "title": "VBA - Excel Showing form after double click on a Cell", "body": "<p>I've encountered a strange Problem. I have an Input Form for the User in Excel.\nThis Form provides basic CRUD functions to edit a List in a Table. Now this Userform also has a ListBox which shows all the entrys with Id and some basic infos (so you know which entry is which ). Now what I want is, that if you select a row in the normal excel table, and then open the InputForm, the selected row in the table should also be selected in the listBox of the InputForm.</p>\n\n<p>I do this like this:</p>\n\n<pre><code>  If Selection.Row &gt;= StartRow() Then\n      ListBoxAll.listIndex = Selection.Row - StartRow()      \n  Else\n      ListBoxAll.listIndex = 0\n  End If\n</code></pre>\n\n<p>This works great if I open the Ui per Button click. But if I try to open the form with the Before Double Click Event. I got an Offset.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    UserFormInput.Show\nEnd Sub\n</code></pre>\n\n<p>Now for the strange part. If I check what value the Selection.Row has, by showing it with a MessageBox, it all works fine! But as soon as I remove the MessageBox its broken all over again.</p>\n\n<pre><code>    If Selection.Row &gt;= StartRow() Then\n        ListBoxAll.listIndex = Selection.Row - StartRow()\n        MsgBox Selection.Row\n    Else\n        ListBoxAll.listIndex = 0\n    End If\n</code></pre>\n\n<p>It does not matter where in the if I put the Messagebox.</p>\n\n<p>So the <strong>Question</strong> has anybody ever got the same Problem ? And does anybody know a solution or a workaround to it ? (I don't want to show a Messagebox!)</p>\n\n<p>So I added some screenshots to make it easier to understand.</p>\n\n<p><a href=\"https://i.stack.imgur.com/e9fPV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e9fPV.png\" alt=\"Table with example data\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/X6NkD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X6NkD.png\" alt=\"Ui with example data\"></a></p>\n\n<p><strong>Update</strong> I think it has something to do with the Focus after a double click, which is (maybe) on the doubleclicked Cell. And gets changed if I put out a MsgBox</p>\n"}, {"tags": ["excel", "vba", "formula", "haversine"], "comments": [{"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1454503939, "post_id": 35175057, "comment_id": 58072090, "body": "Just a question: why did you choose &quot;Variant&quot; as a data type, and not &quot;double&quot;? Second, did you already try to make a simple Excel file for this, using Excel formulas? That would make it easier to understand what might be going wrong."}], "answers": [{"comments": [{"owner": {"reputation": 498, "user_id": 3649492, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/sW2Cv.jpg?s=128&g=1", "display_name": "Dilnoor Singh", "link": "https://stackoverflow.com/users/3649492/dilnoor-singh"}, "edited": false, "score": 0, "creation_date": 1601671688, "post_id": 35177817, "comment_id": 113488679, "body": "Wow, This was brilliant. Takes an experienced person to know the subtlety."}], "tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": true, "score": 5, "last_activity_date": 1454510932, "last_edit_date": 1495541422, "creation_date": 1454504424, "answer_id": 35177817, "question_id": 35175057, "link": "https://stackoverflow.com/questions/35175057/vba-haversine-formula/35177817#35177817", "title": "VBA haversine formula", "body": "<p>Atan2 is defined back to front in Excel compared to JavaScript i.e. Atan2(x,y) rather than Atan2(y,x).</p>\n\n<p>You need to reverse the order of the two arguments:-</p>\n\n<pre><code>c = 2 * Excel.WorksheetFunction.Atan2(Sqr(1 - a), Sqr(a))\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10718023/atan2-function-behaves-different-in-javascript-and-excellsheet\">this</a></p>\n\n<p>So</p>\n\n<pre><code>=haversine(59.3293371,13.4877472,59.3225525,13.4619422)\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>1.65 km\n</code></pre>\n\n<p>which is the correct distance as the crow flies.</p>\n"}, {"tags": [], "owner": {"reputation": 756, "user_id": 2040023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3781c26eee05ffc874b134ea0e55762f?s=128&d=identicon&r=PG", "display_name": "John Joseph", "link": "https://stackoverflow.com/users/2040023/john-joseph"}, "is_accepted": false, "score": 0, "last_activity_date": 1537389873, "creation_date": 1537389873, "answer_id": 52413962, "question_id": 35175057, "link": "https://stackoverflow.com/questions/35175057/vba-haversine-formula/52413962#52413962", "title": "VBA haversine formula", "body": "<p>Great tool! Just underscoring that the result will be in <strong>kilometers</strong>, so if you want <strong>miles</strong> multiply the result by 0.62137.</p>\n"}], "owner": {"reputation": 65, "user_id": 5876361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dadc10fb00daa80ff6503f87442dcea?s=128&d=identicon&r=PG&f=1", "display_name": "banshe", "link": "https://stackoverflow.com/users/5876361/banshe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4384, "favorite_count": 1, "accepted_answer_id": 35177817, "answer_count": 2, "score": 4, "last_activity_date": 1537389873, "creation_date": 1454496791, "last_edit_date": 1495540446, "question_id": 35175057, "link": "https://stackoverflow.com/questions/35175057/vba-haversine-formula", "title": "VBA haversine formula", "body": "<p>I am trying to implement Haversine formula into excel function. Its looks like this:</p>\n\n<pre><code>Public Function Haversine(Lat1 As Variant, Lon1 As Variant, Lat2 As Variant, Lon2 As Variant)\nDim R As Integer, dlon As Variant, dlat As Variant, Rad1 As Variant\nDim a As Variant, c As Variant, d As Variant, Rad2 As Variant\n\nR = 6371\ndlon = Excel.WorksheetFunction.Radians(Lon2 - Lon1)\ndlat = Excel.WorksheetFunction.Radians(Lat2 - Lat1)\nRad1 = Excel.WorksheetFunction.Radians(Lat1)\nRad2 = Excel.WorksheetFunction.Radians(Lat2)\na = Sin(dlat / 2) * Sin(dlat / 2) + Cos(Rad1) * Cos(Rad2) * Sin(dlon / 2) * Sin(dlon / 2)\nc = 2 * Excel.WorksheetFunction.Atan2(Sqr(a), Sqr(1 - a))\nd = R * c\nHaversine = d\nEnd Function\n</code></pre>\n\n<p>But when im testing it I am getting wrong distance... I dont understand why. For coordinates used in this topic : <a href=\"https://stackoverflow.com/questions/18883601/function-to-calculate-distance-between-two-coordinates-shows-wrong\">Function to calculate distance between two coordinates shows wrong</a>\nI am getting 20013,44 as output. Anyone knows what is wrong here? Cant find my mistake...</p>\n"}, {"tags": ["vba", "ms-word", "office-2007"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1454524958, "creation_date": 1454524958, "answer_id": 35185115, "question_id": 35175004, "link": "https://stackoverflow.com/questions/35175004/create-a-vba-code-to-replace-all-the-headers-of-all-the-word-documents-in-a-fol/35185115#35185115", "title": "Create a vba code to replace all the headers, of all the word documents in a Folder and Subfolders", "body": "<p>In order to pick up the folders (directories) you need to specify the vbDirectory attribute. By default, Dir only \"sees\" things that match vbNormal. </p>\n\n<p>Here's an example that picks up both files and sub-directories. The GetAttr function checks whether the file attribute is vbDirectory. If it's not, then it's a file. </p>\n\n<p>What you can do is save the directory paths in an array, then loop that to get the files in the sub-directories.</p>\n\n<pre><code>Sub GetFilesandSubDir()\n  Dim sPath As String, sPattern As String\n  Dim sSearch As String, sFile As String\n  Dim sPathSub As String, sSearchSub As String\n  Dim aSubDirs As Variant, i As Long\n\n  sPattern = \"*.*\"\n  sPath = \"C:\\Test\\\"\n  sSearch = sPath &amp; sPattern\n  sFile = Dir(sPath, vbNormal + vbDirectory)\n  aSubDirs = TestDirWithSubFolders(sPath, sPattern, sSearch, sFile)\n  For i = LBound(aSubDirs) To UBound(aSubDirs)\n    Debug.Print \"Directory: \" &amp; aSubDirs(i)\n    sPathSub = sPath &amp; aSubDirs(i) &amp; \"\\\"\n    sSearchSub = sPathSub &amp; sPattern\n    sFile = Dir(sPathSub, vbNormal + vbDirectory)\n    TestDirWithSubFolders sPathSub, sPattern, sSearchSub, sFile\n  Next\nEnd Sub\n\nFunction TestDirWithSubFolders(sPath As String, sPattern As String, _\n      sSearch As String, sFile As String) As Variant\n  Dim aSubDirs() As Variant, i As Long\n\n  i = 0\n  Do While sFile &lt;&gt; \"\"\n    If GetAttr(sPath &amp; sFile) = vbDirectory Then\n        'Debug.Print \"Directory: \" &amp; sFile\n        ReDim Preserve aSubDirs(i)\n        aSubDirs(i) = sFile\n        i = i + 1\n    Else\n        Debug.Print \"File: \" &amp; sFile\n    End If\n    sFile = Dir\n  Loop\n  TestDirWithSubFolders = aSubDirs\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5877058, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LGzeEKbkL1E/AAAAAAAAAAI/AAAAAAAAABQ/vKmqlH-laUU/photo.jpg?sz=128", "display_name": "Scroll Lock", "link": "https://stackoverflow.com/users/5877058/scroll-lock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "accepted_answer_id": 35185115, "answer_count": 1, "score": 0, "last_activity_date": 1454524958, "creation_date": 1454496682, "last_edit_date": 1454501617, "question_id": 35175004, "link": "https://stackoverflow.com/questions/35175004/create-a-vba-code-to-replace-all-the-headers-of-all-the-word-documents-in-a-fol", "title": "Create a vba code to replace all the headers, of all the word documents in a Folder and Subfolders", "body": "<pre><code>Sub ReplaceEntireHdr() \n    Dim wrd As Word.Application \n    Set wrd = CreateObject(\"word.application\") \n    wrd.Visible = True \n    AppActivate wrd.Name \n     'Change the directory to YOUR folder's path\n    fName = Dir(\"C:\\Users\\user1\\Desktop\\A\\*.doc\") \n    Do While (fName &lt;&gt; \"\") \n        With wrd \n             'Change the directory to YOUR folder's path\n            .Documents.Open (\"C:\\Users\\user1\\Desktop\\A\\\" &amp; fName) \n            If .ActiveWindow.View.SplitSpecial = wdPaneNone Then \n                .ActiveWindow.ActivePane.View.Type = wdPrintView \n            Else \n                .ActiveWindow.View.Type = wdPrintView \n            End If \n            .ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader \n            .Selection.WholeStory \n            .Selection.Paste \n            .ActiveDocument.Save \n            .ActiveDocument.Close \n        End With \n        fName = Dir \n    Loop \n    Set wrd = Nothing \nEnd Sub\n</code></pre>\n\n<p>I use this vba code to replace all the headers, of all the word documents in a folder 'A'.  However if there is any subfolder in the parent folder 'A' with word documents, the vba code skips those documents. Could anyone please tell me how to include the word documents in the subfolders as well? Perhaps by making some changes in the code or any other vba code which can do the same job. \nThanks in advance.</p>\n"}, {"tags": ["arrays", "vba", "class"], "answers": [{"tags": [], "owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "is_accepted": false, "score": 0, "last_activity_date": 1454545767, "last_edit_date": 1454545767, "creation_date": 1454544230, "answer_id": 35190171, "question_id": 35174781, "link": "https://stackoverflow.com/questions/35174781/how-declare-non-standard-array-belong-to-class/35190171#35190171", "title": "How declare non standard array belong to class?", "body": "<p>You are using the same class as an object and object collection.</p>\n\n<p>I would separate the functionalities into 2 Classes:</p>\n\n<ul>\n<li>Complex </li>\n<li>ComplexCollection - Contains a collection of complex class  </li>\n</ul>\n\n<p>EDIT: There is no duplicate check in ComplexCollection.Add and exists check in ComplexCollection.Retrieve.</p>\n\n<p>Complex</p>\n\n<pre><code>Option Explicit\n\nPublic Re As Double\nPublic Im As Double\n</code></pre>\n\n<p>ComplexCollection</p>\n\n<pre><code>Option Explicit\n\nDim oCol As Collection\n\nPublic Function Create(pRe As Double, pIm As Double) As Complex\n    Dim oResult As Complex\n    Set oResult = New Complex\n    oResult.Re = pRe\n    oResult.Im = pIm\n\n    Set Create = oResult\nEnd Function\n\nPublic Sub Add(pComplex As Complex, pKey As String)\n     oCol.Add pComplex, pKey\nEnd Sub\n\nPublic Function Retrieve(pKey As String) As Complex\n     Set Retrieve = oCol(pKey)\nEnd Function\n\nPrivate Sub Class_Initialize()\n    Set oCol = New Collection\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set oCol = Nothing\nEnd Sub\n</code></pre>\n\n<p>Test.bas</p>\n\n<pre><code>Public Sub TestCollection()\n    Dim oCL As ComplexCollection\n    Dim oC As Complex\n\n    Set oCL = New ComplexCollection\n\n    Set oC = oCL.Create(1, 2)\n    Debug.Print oC.Im, oC.Re\n\n    oCL.Add oC, \"1\"\n\n    Set oC = Nothing\n    Set oC = oCL.Retrieve(\"1\")\n\n    Debug.Print oC.Im, oC.Re\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5826500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6e6e2151242fb6b8c64a617cf2265d?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Gruszel", "link": "https://stackoverflow.com/users/5826500/adam-gruszel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454545767, "creation_date": 1454496098, "question_id": 35174781, "link": "https://stackoverflow.com/questions/35174781/how-declare-non-standard-array-belong-to-class", "title": "How declare non standard array belong to class?", "body": "<p>I have a VBA class:</p>\n\n<pre><code>Option Explicit\n\nPublic Re As Double 'Real\nPublic Im As Double 'Imaginary\n\n\nPublic Function CZ_Sqt(Z As Complex, Exp As Integer) As Variant  \n   Dim Table() As Complex\n   Dim i As Integer\n\n   If Exp &gt; 0 Then\n       ReDim Preserve Table(0 To Exp - 1)\n       Set Table(UBound(Table)) = New Complex\n\n   Else: Exit Function\n   End If\n\n   For i = 0 To UBound(Table)\n      Table(i).Re = 1\n      Table(i).Im = 1\n   Next i\n   set CZ_Sqt = Table \n\nEnd Function\n</code></pre>\n\n<p>In module:</p>\n\n<pre><code>Sub asd()\n    Dim K As Complex\n    Dim A As Variant\n\n    Set K = New Complex\n\n\n    K.Re = 1\n    K.Im = 3\n    Set A = K.CZ_Sqt(Z, 5)\nend sub\n</code></pre>\n\n<ol>\n<li>How \"set\" all variable \"Table\" in on step ?\nIn solution which is in example is set only element Table(4) but other elements are omited.</li>\n<li>How to return this variable \"Table\" to the function name \"CZ_Sqt\" ?\nThis what I proposed doesn't work.</li>\n<li>How pass variable \"CZ_Sqt\" which consider Array Complex type to the variable \"A\"?</li>\n</ol>\n"}, {"tags": ["c#", "vba", "dll"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1454504180, "post_id": 35174557, "comment_id": 58072264, "body": "Oh dear, that is not a helpful answer.  It uses a .NET 1.0 technique, one that did not yet permit determining what CLR version to load.  Selecting the tlb files from the v4.0.30319 folder accomplishes nothing.  That it works for a 3.5 assembly is an accident, a common one today since most machines don&#39;t have a .NET 1.x version installed anymore.  Woe be you if it does.  Don&#39;t do this."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 3909712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/345ca7cc756afdeea29567bcec64c2d9?s=128&d=identicon&r=PG&f=1", "display_name": "quicksilv86", "link": "https://stackoverflow.com/users/3909712/quicksilv86"}, "is_accepted": true, "score": 2, "last_activity_date": 1454508955, "last_edit_date": 1495539912, "creation_date": 1454508955, "answer_id": 35179476, "question_id": 35174557, "link": "https://stackoverflow.com/questions/35174557/vba-c-dll-no-registration/35179476#35179476", "title": "VBA C# DLL no registration", "body": "<p>So, i've found the solution.</p>\n\n<p>By default, Excel uses the 1.1 framework as explained <a href=\"https://stackoverflow.com/a/790589/3909712\">here</a>.\nIf you have a look into the Windows Registry,</p>\n\n<pre><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\Policy\\AppPatch\\YOUR_FRAMEWORK_VERSION\\excel.exe\\\n</code></pre>\n\n<p>you can see the targeted version is v1.1.....\nSo, the solution is to make an Excel.exe.config file that forces Framework version 4, as explained <a href=\"https://stackoverflow.com/a/11473272/3909712\">here</a></p>\n\n<pre><code> &lt;configuration&gt;\n  &lt;startup useLegacyV2RuntimeActivationPolicy=\"true\"&gt;\n    &lt;supportedRuntime version=\"v4.0.30319\"/&gt;\n  &lt;/startup&gt;\n&lt;/configuration&gt;\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 3909712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/345ca7cc756afdeea29567bcec64c2d9?s=128&d=identicon&r=PG&f=1", "display_name": "quicksilv86", "link": "https://stackoverflow.com/users/3909712/quicksilv86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1092, "favorite_count": 0, "accepted_answer_id": 35179476, "answer_count": 1, "score": 1, "last_activity_date": 1454508955, "creation_date": 1454495585, "last_edit_date": 1495542203, "question_id": 35174557, "link": "https://stackoverflow.com/questions/35174557/vba-c-dll-no-registration", "title": "VBA C# DLL no registration", "body": "<p>I have made a C# .NET dll which i would like to run from VBA without register it.\nI've found the solution <a href=\"https://stackoverflow.com/a/13333819\">there</a> and it works perfectly, but only when the assembly is made with the Framework NET 3.5 or older. \nWith Framework 4.0, i'm getting the error \"This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded\"..\nSomeone could help me please?</p>\n"}, {"tags": ["vba", "selection", "shape"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454498401, "post_id": 35174532, "comment_id": 58068268, "body": "ActiveSheet.Shapes.Range(Array(&quot;Oval 2&quot;, &quot;Oval 3&quot;)).Select     Selection.ShapeRange.Group.Select"}, {"owner": {"reputation": 15, "user_id": 5877268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/833bcbbc44eeedf631887ff95f984873?s=128&d=identicon&r=PG&f=1", "display_name": "Nury", "link": "https://stackoverflow.com/users/5877268/nury"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454584700, "post_id": 35174532, "comment_id": 58115263, "body": "Thanks for your comment Siva, but I want to make it into a macro-able code, not one by one"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5877268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/833bcbbc44eeedf631887ff95f984873?s=128&d=identicon&r=PG&f=1", "display_name": "Nury", "link": "https://stackoverflow.com/users/5877268/nury"}, "edited": false, "score": 0, "creation_date": 1454584054, "post_id": 35176475, "comment_id": 58114838, "body": "Thank you for your comment RobK, and sorry for my limited explanation"}], "tags": [], "owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "is_accepted": false, "score": 0, "last_activity_date": 1454500773, "creation_date": 1454500773, "answer_id": 35176475, "question_id": 35174532, "link": "https://stackoverflow.com/questions/35174532/select-multiple-figures-in-a-series-using-excel-visual-basic/35176475#35176475", "title": "select multiple figures in a series using excel visual basic", "body": "<p>Try to avoid selecting anything in your code. This makes your code really slow. It's not entirely clear for me what you're trying to do, but try something like this:</p>\n\n<pre><code>dim objShape as Shape\n\nfor j = 1 To circleCnt\n\n    set objShape = Shapes.AddShape(msoShapeOval, 500, 30, 40, 30)\n\n    With objShape\n        .ShapeRange.Height = minWidth + circleWidth * (circleCnt - j + 1)\n        .ShapeRange.Width = minWidth + circleWidth * (circleCnt - j + 1)\n        .ShapeRange.IncrementLeft circleWidth / 2 * (j - 1) + circleWidth / 2\n        .ShapeRange.IncrementTop circleWidth / 2 * (j - 1) + circleWidth / 2\n    End With\n\nnext\n\nset objShape = Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5877268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/833bcbbc44eeedf631887ff95f984873?s=128&d=identicon&r=PG&f=1", "display_name": "Nury", "link": "https://stackoverflow.com/users/5877268/nury"}, "edited": false, "score": 0, "creation_date": 1454584168, "post_id": 35176907, "comment_id": 58114927, "body": "Thank you so much Nick, I was not familiar with VBA in excel so had no idea about &#39;shaperange&#39; and how to use it - this really helped!"}, {"owner": {"reputation": 15, "user_id": 5877268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/833bcbbc44eeedf631887ff95f984873?s=128&d=identicon&r=PG&f=1", "display_name": "Nury", "link": "https://stackoverflow.com/users/5877268/nury"}, "edited": false, "score": 0, "creation_date": 1454584285, "post_id": 35176907, "comment_id": 58115015, "body": "One more thing, is it possible to select few shapes and group them? say, something like:&lt;br/&gt; &lt;pre&gt;     for n = 3 to 8&lt;br/&gt;         sr = ws.Shapes.Range(arrShapeNames(n))&lt;br/&gt;         next n&lt;br/&gt; &lt;code&gt; to make shapes created at 3rd through 8th into one group? -How can I make line changes? Sorry for the scribbles"}], "tags": [], "owner": {"reputation": 2989, "user_id": 19487, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/856d4b67c1ca2a2307b3dcfd333c0719?s=128&d=identicon&r=PG", "display_name": "CtrlDot", "link": "https://stackoverflow.com/users/19487/ctrldot"}, "is_accepted": true, "score": 0, "last_activity_date": 1454501952, "creation_date": 1454501952, "answer_id": 35176907, "question_id": 35174532, "link": "https://stackoverflow.com/questions/35174532/select-multiple-figures-in-a-series-using-excel-visual-basic/35176907#35176907", "title": "select multiple figures in a series using excel visual basic", "body": "<p>After you add the shapes, you need to iterate over all the shapes on the sheet and store the shape names in an array. Using that, you can create a <code>ShapeRange</code> object and <code>Group</code> the shapes. Here is a code sample:</p>\n\n<pre><code>Sub GroupAllShapes()\n\n    Dim arrShapeNames()     As Variant 'must be Variant to work with Shapes.Range()\n    Dim shp                 As Shape\n    Dim sr                  As ShapeRange\n    Dim ws                  As Worksheet\n    Dim i                   As Integer\n\n    Set ws = ActiveSheet\n\n    ReDim arrShapeNames(ws.Shapes.Count - 1)\n    i = 0\n    For Each shp In ws.Shapes\n        arrShapeNames(i) = shp.Name\n        i = i + 1\n    Next\n\n    Set sr = ws.Shapes.Range(arrShapeNames)\n    sr.Group\n\n    Set sr = Nothing\n    Set ws = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Note: I ported this from some of my C# code and have the arrShapeNames array with a zero-based index. You may need to make it 1-based for VBA.</p>\n"}], "owner": {"reputation": 15, "user_id": 5877268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/833bcbbc44eeedf631887ff95f984873?s=128&d=identicon&r=PG&f=1", "display_name": "Nury", "link": "https://stackoverflow.com/users/5877268/nury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1555, "favorite_count": 0, "accepted_answer_id": 35176907, "answer_count": 2, "score": 0, "last_activity_date": 1454501952, "creation_date": 1454495533, "question_id": 35174532, "link": "https://stackoverflow.com/questions/35174532/select-multiple-figures-in-a-series-using-excel-visual-basic", "title": "select multiple figures in a series using excel visual basic", "body": "<p>Using excel visual basic, I want to select multiple figures and group them, repeatedly.</p>\n\n<p>My code goes like this:</p>\n\n<pre><code>circleCnt = 5\n\nFor j = 1 To circleCnt\n\n    ActiveSheet.Shapes.AddShape(msoShapeOval, 500, 30, 40, 30).Select\n    Selection.ShapeRange.Height = minWidth + circleWidth * (circleCnt - j + 1)\n    Selection.ShapeRange.Width = minWidth + circleWidth * (circleCnt - j + 1)\n    Selection.ShapeRange.IncrementLeft circleWidth / 2 * (j - 1) + circleWidth / 2\n    Selection.ShapeRange.IncrementTop circleWidth / 2 * (j - 1) + circleWidth / 2\n\n    Next j\n</code></pre>\n\n<p>Yep, it's drawing multiple circles and I'm trying to present my data with these codes. The problem is... my full data makes more than a hundred group of circles and it takes forever to transfer all the circles into the powerpoint</p>\n\n<p>I want to make circles from a sample into a group - and how can I select multiple shape objects? I was thinking like</p>\n\n<pre><code>for n = 1 to 5\n\n    select shape #n\n\n    next n\n</code></pre>\n\n<p>but as you can see, this didn't work</p>\n\n<p>Is there any 'cumulative' code for selection? or selecting last object and make them into a group of previously grouped objects?</p>\n\n<p>-I don't want to make 'all circles' into one group - a group for a sample, with multiple samples :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454494416, "post_id": 35173917, "comment_id": 58065492, "body": "Will it be just 1 button?  What code creates the button?  Can it create the button with a name of Worksheet &amp; &quot;_BTN_FOR_UPDATE&quot; for example, then it&#39;s easily found?"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454494729, "post_id": 35173917, "comment_id": 58065725, "body": "Get the Index of the sheet into a variable then change your line to the following: &quot;ActiveSheet.Shapes(&quot;Button&quot; &amp; ShtIndex).Delete"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4906981"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454499165, "post_id": 35173917, "comment_id": 58068778, "body": "@Nathan_Sav Yes it&#39;s only for one button on each worksheet. The button is on a template worksheet. When the template worksheet is copied, it also copies the button. If I&#39;m thinking correctly no matter what the button is called on the template it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4906981"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1454499606, "post_id": 35173917, "comment_id": 58069102, "body": "@Nathan_Sav Continued: will add 1 to whatever the button is called."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4906981"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454499736, "post_id": 35173917, "comment_id": 58069186, "body": "@Kathara I added SheetIndex = ActiveWorkbook.ActiveSheet.Index and &#39;ActiveSheet.Shapes(&quot;Button &quot; &amp; SheetIndex).Delete to the range however it didn&#39;t work as I also have the option to add/remove sheets. If I delete sheet 5 for example then whatever is on sheet 6 will be moved to Index number 5. So the button at that point will still be called Button 6 and the code will return Button 5. Hope that makes sense."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454500389, "post_id": 35173917, "comment_id": 58069629, "body": "ok, well this wasn&#39;t considered. I believe you could search for the button (I don&#39;t know the code for that...) on each worksheet. I believe the answer down below might have a solution to your problem then :)"}], "answers": [{"tags": [], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "is_accepted": false, "score": 0, "last_activity_date": 1454543164, "last_edit_date": 1454543164, "creation_date": 1454499170, "answer_id": 35175884, "question_id": 35173917, "link": "https://stackoverflow.com/questions/35173917/delete-a-procedurally-generated-button/35175884#35175884", "title": "Delete a procedurally generated button", "body": "<h1>EDIT</h1>\n\n<p>After rereading your question more carefully I thought of this.\nIt catches all shapes on a sheet that start with \"Button\" regardless of the number.</p>\n\n<pre><code>Dim frmButton As Shape\nFor Each frmButton In ThisWorkbook.Worksheets(\"Sheet1\").Shapes\n    If frmButton.Name Like \"Button*\" Then\n        frmButton.Delete\n    End If\nNext\n</code></pre>\n\n<p>You could wrap the code above with the code below to go through multiple sheets.</p>\n\n<pre><code>Dim ws As Worksheet\nFor Each ws in ThisWorkbook.Worksheets\n    If Not ws.Name = \"Sheet2\" Then 'Exclude certain sheets \"Sheet2\" is excluded in this case.\n        'Code\n    End If\nNext ws\n</code></pre>\n\n<h1>END OF EDIT</h1>\n\n<p><hr>\nFor an ActiveX control try:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Sheet1\").OLEobjects(\"CommandButton1\").Delete \n</code></pre>\n\n<p>Replace \"Sheet1\" and \"CommandButton1\" with the actual names as found in the properties, do not confuse this with the caption, especially for the button.</p>\n\n<p>For a form control button try:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Sheet1\").Shapes(\"Button 1\").Delete\n</code></pre>\n\n<p>Replace the <code>ThisWorkbook</code> with <code>Workbooks(\"Book1\")</code> if you are referring to a different workbook than the workbook the code resides in. Replace \"Book1\" with the actual name of the workbook.</p>\n\n<p>Since the \"Button 1\" is a string, you can replace it with a variable containing a string, but beware you'll get an error if there is no shape with the name contained by the variable.</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1454502804, "creation_date": 1454502804, "answer_id": 35177240, "question_id": 35173917, "link": "https://stackoverflow.com/questions/35173917/delete-a-procedurally-generated-button/35177240#35177240", "title": "Delete a procedurally generated button", "body": "<p>If you are deleting the button from code called by the button, it would be:</p>\n\n<pre><code>ActiveSheet.Shapes(Application.Caller).Delete\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4906981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1454543164, "creation_date": 1454493994, "question_id": 35173917, "link": "https://stackoverflow.com/questions/35173917/delete-a-procedurally-generated-button", "title": "Delete a procedurally generated button", "body": "<p>I have the following line of code in a VBA project:</p>\n\n<pre><code>ActiveSheet.Shapes(\"Button 1\").Delete\n</code></pre>\n\n<p>Where it says \"Button 1\" I would like it to be linked to a variable of some sort. </p>\n\n<p>The reason I ask is that I have a link on an \"Index\" worksheet that creates a new worksheet (a copy of a separate, template worksheet) using VBA and the newly created worksheet contains the above button. When I click that button on the new, copied worksheet, it should perform an action and then the button should be deleted. </p>\n\n<p>The problem I'm facing is that the button name changes on each individual worksheet that is created. </p>\n\n<p>In worksheet 5, it would be called \"Button 5\", in worksheet 6, it would be called \"Button 6\" etc. Due to this, the line of code above doesn't work as it's still referencing \"Button 1\". </p>\n\n<p>Does anyone have any ideas on how to reference this correctly? </p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454493684, "post_id": 35173748, "comment_id": 58064963, "body": "you could check for the last row which has data. If the lastrow is bigger than 25 or is 25 then do something. The last row can be found by &quot;lastrow = Activeworkbook.Activesheet.Cells(Activeworkbook.ActiveSheet.&zwnj;&#8203;Rows.Count, &quot;a&quot;).End(xlUp).Row&quot;"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454493747, "post_id": 35173748, "comment_id": 58064999, "body": "if you Add &quot;Dim Sht1 As Worksheet   Sht1 = ActiveWorkbook.Sheets(&quot;Sheet1&quot;)&quot; then you could replace the &quot;activeworbook.Activeworksheet&quot; by &quot;Sht1&quot;"}, {"owner": {"reputation": 55, "user_id": 4291041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4db75cb3ea6d6d85bd1c9dc12a7d799f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris S", "link": "https://stackoverflow.com/users/4291041/chris-s"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454493922, "post_id": 35173748, "comment_id": 58065128, "body": "Thanks, I guess my problem is that I want it to copy the entire column from rows 11:25 as opposed to non 0 values only."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454494145, "post_id": 35173748, "comment_id": 58065294, "body": "Correct me if im wrong. Your expecation is to copy a column if the sum of all value in the column is grater than 0. Am i right?"}, {"owner": {"reputation": 55, "user_id": 4291041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4db75cb3ea6d6d85bd1c9dc12a7d799f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris S", "link": "https://stackoverflow.com/users/4291041/chris-s"}, "edited": false, "score": 0, "creation_date": 1454494467, "post_id": 35173748, "comment_id": 58065539, "body": "Hi Siva, yes correct."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454494512, "post_id": 35173748, "comment_id": 58065570, "body": "Ok then you could also check for the last column which contains data &quot;LastCol = Sht1.Cells(1, Sht1.Columns.Count).End(xlToLeft).Column&quot; then loop through the columns &quot;for Col = 1 To LastCol&quot; &quot;If lastrow &gt; 25 Then&quot; &quot;Sht1.Range(&quot;A11:&quot; &amp; Col &amp; &quot;25&quot;).Copy&quot; and then paste it on the other sheet."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1454502683, "post_id": 35173748, "comment_id": 58071205, "body": "Chris u want to check &amp; copy the rows from 11-25 only in the respective columns?"}], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1454499265, "post_id": 35175067, "comment_id": 58068841, "body": "Hi Siva in his code, he also defining range for rows as well 11 to 25, hope your missing it :)"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1454500153, "post_id": 35175067, "comment_id": 58069466, "body": "You are right :). I just thought to have it as dynamic so that even if some new rows are entered, then also code should work."}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1454496814, "creation_date": 1454496814, "answer_id": 35175067, "question_id": 35173748, "link": "https://stackoverflow.com/questions/35173748/vba-copy-from-sheet-to-another-based-on-condition/35175067#35175067", "title": "VBA copy from sheet to another based on condition", "body": "<pre><code>Sub CopyActuals()\nDim ActlSheet As Worksheet\nDim BbgtSheet As Worksheet\nDim rowCount As Integer\nDim SumValue As Integer\nDim rng As Range\nSet ActlSheet = ActiveWorkbook.Sheets(\"Project - Actual (Hours)\")\nSet BbgtSheet = ActiveWorkbook.Sheets(\"Project - Budget (Hours)\")\nrowCount = ActlSheet.UsedRange.Rows.Count\nFor iCol = 8 To 59\n Set rng = Range(Cells(11, iCol), Cells(rowCount, iCol))\n SumValue = Application.WorksheetFunction.Sum(rng)\n If (SumValue &gt; 0) Then\n     rng.Select\n     rng.Copy\n     'put your next action\n Else\n     'put your next action\n End If\nNext iCol\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4291041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4db75cb3ea6d6d85bd1c9dc12a7d799f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris S", "link": "https://stackoverflow.com/users/4291041/chris-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 587, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454496814, "creation_date": 1454493545, "question_id": 35173748, "link": "https://stackoverflow.com/questions/35173748/vba-copy-from-sheet-to-another-based-on-condition", "title": "VBA copy from sheet to another based on condition", "body": "<p>I have a set of data from one table in a sheet range being H11:BG25. I want to run a bit of code to look into each column and if the sum of that col is > 0, then copy the whole range for that column. If the sum is &lt; 0, do nothing. So far I have the following code but it does not copy the range it only copies non 0 values.</p>\n\n<pre><code>Sub CopyActuals()\n\nFor iCol = 8 To 59\nFor iRow = 11 To 25\n\n  With Worksheets(\"Project - Actual (Hours)\").Cells(iRow, iCol)\n    ' Check that cell is not empty.\n\n        If 'Condition to be if there is any data in the rows 11-25 for each column, then copy the whole column\n\n        Else\n                Worksheets(\"Project - Actual (Hours)\").Cells(iRow, iCol).Copy\n                Worksheets(\"Project - Budget (Hours)\").Cells(iRow, iCol).PasteSpecial Paste:=xlPasteValues\n                Worksheets(\"Project - Budget (Hours)\").Cells(iRow, iCol).PasteSpecial Paste:=xlPasteFormats\n\n        End If\n\nEnd With\n\n    Next iRow\nNext iCol\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "merge"], "comments": [{"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454492792, "post_id": 35173170, "comment_id": 58064322, "body": "I&#39;ve tried that but then the formula that relies on lastrow does not work, it just puts the formula into cells AB6 to the bottom as text instead"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1454493657, "post_id": 35173170, "comment_id": 58064943, "body": "If the lastrow has merged cells then it&#39;s possible that the last cell may not be in Col A what is the NAME of the last cell ? Can you share the picture of the worksheet?"}, {"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1454498071, "post_id": 35173170, "comment_id": 58068036, "body": "Sorry, I&#39;ve just been able to add a comment now!  I can&#39;t share sorry as it has confidential data. . Column A is the most complete column, just the last 2 rows in col A are merged. So it&#39;s not picking up that the last row is in fact the last row, it&#39;s picking up the first of the two merged cells as the last one"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454493066, "post_id": 35173317, "comment_id": 58064531, "body": "I&#39;ve tried that but then the formula that relies on lastrow does not work, it just puts the formula into cells AB6 to the bottom as text instead\u2013"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1454494237, "post_id": 35173317, "comment_id": 58065355, "body": "This does not provide an answer to the question. To critique or request clarification from an author, leave a comment below their post. - <a href=\"/review/low-quality-posts/11128307\">From Review</a>"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1454495267, "post_id": 35173317, "comment_id": 58066085, "body": "@Magisch  but the questioner was stuck at identifying the &#39;lastrow&#39;  which if solved entire problem is solved."}, {"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454498204, "post_id": 35173317, "comment_id": 58068138, "body": "I did try the users suggestion but then it resulted in my formulas displaying as text in this line of code: (not sure why it&#39;s not displaying code properly, sorry!)    Range(&quot;AB5&quot;) = &quot;Age Year/Month&quot;     Range(&quot;AB6:AB&quot; &amp; lastrow).Formula =      &quot;=DATEDIF(RC[-2],TODAY(),&quot;&quot;Y&quot;&quot;) &amp; &quot;&quot; Years, &quot;&quot; &amp;      DATEDIF(RC[-2],TODAY(),&quot;&quot;YM&quot;&quot;) &amp; &quot;&quot; Months &quot;&quot;&quot;"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454498961, "post_id": 35173317, "comment_id": 58068641, "body": "Are you sure the formula is correct and working fine when you place in a cell manually. I also have a doubt for month shouldnt it be &quot;M&quot; instead of &quot;YM&quot;"}, {"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454499864, "post_id": 35173317, "comment_id": 58069278, "body": "It works fine in a cell manually. But I just don&#39;t want to keep using today() in the formula, I&#39;d rather reference a cell which has today() in it, and keep using this cell.  My main concern is the merged cells meaning the last row is not identified properly if it is merged"}, {"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454503078, "post_id": 35173317, "comment_id": 58071489, "body": "Actually, the above does work, however it adds the formula for the row below the last row, so it&#39;s counting an extra row for some reason"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454503223, "post_id": 35173317, "comment_id": 58071571, "body": "It also counts blank rows that are formated( borders, cells formating...) even though cells are empty."}, {"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454505963, "post_id": 35173317, "comment_id": 58073550, "body": "Ah. The problem I have is that there is text and a graphic up to row 5. Then row 5 is the column headings, row 6 is where the data starts. Could I modify that code to only count rows that have data either in those cells or to the right in any other column? It&#39;s harder than I thought to do one simple thing :("}, {"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454508508, "post_id": 35173317, "comment_id": 58075447, "body": "Plus the cells that it has counted are not formatted, nor do they have a border?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454508604, "post_id": 35173317, "comment_id": 58075516, "body": "Any cell in that row been formatted, used, borders?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454508838, "post_id": 35173317, "comment_id": 58075661, "body": "Try deleting all the rows below your last row manually and try the code"}, {"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454509687, "post_id": 35173317, "comment_id": 58076333, "body": "No none. I can&#39;t remove the rows below that as this template is for a colleague who will just want to open their data and then the code should run automatically, without them having to manually intervene.  I&#39;ve manually ensured that there is no formatting, no borders etc and then retried and I&#39;m still getting the row below being filled in with my formula.  On another data set, all rows below my last row were filled in :("}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454517667, "post_id": 35173317, "comment_id": 58082446, "body": "What I&#39;m asking is to see if the code is working when deleting the rows below. I&#39;m sure that there got to be something by usedrange is giving+1. Are there any other options to check if formula is placing in correct cell like it&#39;s adjacent should have value"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454518409, "post_id": 35173317, "comment_id": 58083002, "body": "Have one suggestion. Try to use the same last row you tried earlier, but not on A column, instead try on any other column where there are no merge cells"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454518410, "post_id": 35173317, "comment_id": 58083003, "body": "Have one suggestion. Try to use the same last row you tried earlier, but not on A column, instead try on any other column where there are no merge cells"}, {"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454579174, "post_id": 35173317, "comment_id": 58111302, "body": "Hi, sorry for the late response. There are no entire columns that don&#39;t have at least some merged cells unfortunately.  On other data I use the formula is being put in 100s of rows below, not just 1.  I can&#39;t think of any way around this, it&#39;s quite frustrating"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454580829, "post_id": 35173317, "comment_id": 58112487, "body": "If Possible can you please share a sample snap shot of your data. Will have a look and think of other alternatives"}, {"owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "edited": false, "score": 0, "creation_date": 1454585959, "post_id": 35173317, "comment_id": 58116006, "body": "Hi, sorry but I&#39;m unable to as it&#39;s confidential people data. I can try and mock some up? but not sure how I&#39;d share it?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454591451, "post_id": 35173317, "comment_id": 58119559, "body": "I tried the added answer and it worked fine for me. You should check and let me know if your problem is solved or not."}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1454591388, "last_edit_date": 1454591388, "creation_date": 1454492385, "answer_id": 35173317, "question_id": 35173170, "link": "https://stackoverflow.com/questions/35173170/lastrow-not-being-identified-due-to-merged-cells/35173317#35173317", "title": "Lastrow not being identified due to merged cells", "body": "<p>Why not try</p>\n\n<pre><code>lastrow = Sheets(\"UrSheet\").UsedRange.Rows.Count\n</code></pre>\n\n<p>Try the below</p>\n\n<pre><code>Dim cel As Range\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet cel = Cells(lastrow, 1)\nlastrow = lastrow + cel.MergeArea.Rows.Count - 1\nMsgBox lastrow\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5816409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d3f5a4b625f2865223c682cd6a61a1?s=128&d=identicon&r=PG&f=1", "display_name": "dogmum", "link": "https://stackoverflow.com/users/5816409/dogmum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1996, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454668287, "creation_date": 1454491997, "last_edit_date": 1454668287, "question_id": 35173170, "link": "https://stackoverflow.com/questions/35173170/lastrow-not-being-identified-due-to-merged-cells", "title": "Lastrow not being identified due to merged cells", "body": "<p>I have a data set where some cells are merged.</p>\n\n<p>There is not one column where they are not merged, and some columns have no entries.</p>\n\n<p>I want to find the last row so that I can add a formula to a column up until the last row.</p>\n\n<p>At the moment my last row is a merged cell with 2 entries. My formula has been added up until the \nsecond to last row.</p>\n\n<p>This is my code to find the last row, based on column A (which has merged cells).</p>\n\n<pre><code>lastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>IT's just not picking up the last row due to the merged cells. There's no way I can unuse them.</p>\n\n<p>I want to use the last row for the following code:</p>\n\n<pre><code>Range(\"AB5\") = \"Age Year/Month\"\n    Range(\"AB6:AB\" &amp; lastrow).Formula = \n    \"=DATEDIF(RC[-2],TODAY(),\"\"Y\"\") &amp; \"\" Years, \"\" &amp; \n    DATEDIF(RC[-2],TODAY(),\"\"YM\"\") &amp; \"\" Months \"\"\"\n</code></pre>\n\n<p>which works for everything other than my last row which hasn't been picked up.</p>\n\n<p>I would also like to put the today() somewhere on my sheet and reference the cell in the above formula,\nrather than use today() all the time which I know is volatile.</p>\n\n<p>Any advice on the last row with the merged cells issue? Sorry, for some reason it's not letting me add comments.</p>\n\n<p>I can't add a picture as it is confidential data I'm using. Column A is the most complete column, just the last 2 rows in col A are merged. So it's not picking up that the last row is in fact the last row, it's picking up the first of the two merged cells as the last one</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454491540, "post_id": 35172533, "comment_id": 58063434, "body": "Welcome to SO. it will be difficult to code every thing for you and SO don&#39;t provide Code development service. Please start coding and and search in SO for related code if required. Your list of actions are pretty clear. Go ahead by coding step by step."}], "answers": [{"tags": [], "owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "is_accepted": false, "score": 0, "last_activity_date": 1454492815, "last_edit_date": 1495541736, "creation_date": 1454492815, "answer_id": 35173470, "question_id": 35172533, "link": "https://stackoverflow.com/questions/35172533/find-files-in-different-folders-and-gather-info-from-them/35173470#35173470", "title": "Find files in different folders and gather info from them", "body": "<p>I would suggest you look at the Scripting.FileSystemObjects first to see if this is good enough for your requirements.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3233203/how-do-i-use-filesystemobject-in-vba\">How do I use FileSystemObject in VBA?</a></p>\n\n<p>Chances are its what you want.</p>\n"}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456449410, "creation_date": 1454490168, "last_edit_date": 1456449410, "question_id": 35172533, "link": "https://stackoverflow.com/questions/35172533/find-files-in-different-folders-and-gather-info-from-them", "title": "Find files in different folders and gather info from them", "body": "<p>I am starting a project that does the following:</p>\n\n<p>I need to push a button in the current worksheet and it searches all files (with a certain name structure e.g file_date.xls) in all folders within a specific directory. I then need to pull specific numbers from the files (for example find a cell called 'title' and take the cell underneath it). All this info then gets placed in the current workbook in a table. </p>\n\n<p>Basically its searching all files in all folders with a certain name and then taking specific data and putting it in a table in the current worksheet.</p>\n\n<p>I am just looking for ideas/examples on what to look at and where to go with it.</p>\n"}, {"tags": ["excel", "vba", "outlook", "sendkeys"], "comments": [{"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454489966, "post_id": 35172406, "comment_id": 58062374, "body": "Is outlook opened when the mail is being created?"}, {"owner": {"reputation": 1, "user_id": 5876806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2389a0540f4458e7ac04e7b517717054?s=128&d=identicon&r=PG&f=1", "display_name": "Bostin&#39; Job", "link": "https://stackoverflow.com/users/5876806/bostin-job"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454492568, "post_id": 35172406, "comment_id": 58064172, "body": "Hi Kathara, Outlook is already open. Although these reports tend to be the first task of the morning so are generally the first to make use of Outlook, there are times when I have to respond to emails first so will have already used Outlook successfully before running (and getting the failures on) these reports"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454492788, "post_id": 35172406, "comment_id": 58064320, "body": "Ok. Because it once happened to me that I didn&#39;t have Outlook opened but &quot;Send&quot; a mail which then got stuck in the Outbox. Can you once try to exchange &quot;Appliation.SendKeys &quot;%s&quot; &quot; to &quot;.Send&quot; and see if this works? :)"}, {"owner": {"reputation": 1, "user_id": 5876806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2389a0540f4458e7ac04e7b517717054?s=128&d=identicon&r=PG&f=1", "display_name": "Bostin&#39; Job", "link": "https://stackoverflow.com/users/5876806/bostin-job"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1454493280, "post_id": 35172406, "comment_id": 58064682, "body": "Yes, &quot;.Send&quot; works ok everytime since I have to respond to the Outlook prompt which, in effect, clicks &#39;Send&#39; for me. It is because of needing to get round the Outlook pop-up that I am using &quot;Application.SendKeys &quot;%s&quot; &quot;"}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1454505859, "creation_date": 1454505859, "answer_id": 35178308, "question_id": 35172406, "link": "https://stackoverflow.com/questions/35172406/first-sendkeys-automated-email-doesnt-actually-get-sent-from-outlook/35178308#35178308", "title": "First sendkeys automated email doesn&#39;t actually get sent from Outlook", "body": "<p>SendKeys might work only if the inspector is active in the foreground. Why not try other workarounds (ClickYes, Redemption)? See  <a href=\"http://www.outlookcode.com/article.aspx?id=52\" rel=\"nofollow\">http://www.outlookcode.com/article.aspx?id=52</a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5876806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2389a0540f4458e7ac04e7b517717054?s=128&d=identicon&r=PG&f=1", "display_name": "Bostin&#39; Job", "link": "https://stackoverflow.com/users/5876806/bostin-job"}, "edited": false, "score": 0, "creation_date": 1454573673, "post_id": 35178535, "comment_id": 58107864, "body": "Sadly, dding this line gave a 1004 &#39;Programmatic access to Visual Basic Project is not trusted&#39; error&#39;."}], "tags": [], "owner": {"reputation": 208, "user_id": 5615421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/e5Rqn.png?s=128&g=1", "display_name": "Herry Markowitz", "link": "https://stackoverflow.com/users/5615421/herry-markowitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1454506401, "creation_date": 1454506401, "answer_id": 35178535, "question_id": 35172406, "link": "https://stackoverflow.com/questions/35172406/first-sendkeys-automated-email-doesnt-actually-get-sent-from-outlook/35178535#35178535", "title": "First sendkeys automated email doesn&#39;t actually get sent from Outlook", "body": "<p>Add following code before .Display</p>\n\n<pre><code>If Application.VBE.MainWindow.Visible = True Then Application.VBE.MainWindow.Visible = False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5876806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2389a0540f4458e7ac04e7b517717054?s=128&d=identicon&r=PG&f=1", "display_name": "Bostin&#39; Job", "link": "https://stackoverflow.com/users/5876806/bostin-job"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1155, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454506401, "creation_date": 1454489791, "last_edit_date": 1454497338, "question_id": 35172406, "link": "https://stackoverflow.com/questions/35172406/first-sendkeys-automated-email-doesnt-actually-get-sent-from-outlook", "title": "First sendkeys automated email doesn&#39;t actually get sent from Outlook", "body": "<p>this has got me confused... </p>\n\n<p>I have a set of Excel reports I run in the morning that generates six emails each with attachments, plus a seperate report set run on a Wednesday that generates just the one email.</p>\n\n<p>To make these reports fully automated and run without supervision and get past the Outlook security pop-up, I have used the Sendkeys function like this (this is from the 'Wednesday' report):</p>\n\n<pre><code>Dim OutApp As Object\nDim OutMail As Object\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n    With OutMail\n        .To = distlist\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"30+ Days and Early Warning lists for \" &amp; Format(Now, \"dd mmm\")\n        .Body = \"Latest lists attached\"\n        .Attachments.Add (\"C:\\Users\\\" &amp; whoami &amp; \"\\Desktop\\\" &amp; outputdirectoryname &amp; \"\\\" &amp; outputfile1 &amp; \"\")\n        .Attachments.Add (\"C:\\Users\\\" &amp; whoami &amp; \"\\Desktop\\\" &amp; outputdirectoryname &amp; \"\\\" &amp; outputfile2 &amp; \"\")\n        .Display\n        Application.Wait (Now + TimeValue(\"0:00:06\"))\n        Application.SendKeys \"%s\"\nEnd With\nSet OutMail = Nothing\nSet OutApp = Nothing\nSheets(\"Run Buttons\").Select\n</code></pre>\n\n<p>...works nicely. </p>\n\n<p>Now, my issue is not that this code doesn't work as such, but that the first email never actually gets sent by Outlook but remains displayed and 'stuck' in the Outbox. If I fail to manually intervene and 'Send' this first email, then the subsequent ones also get 'stuck', but, if I do manually 'Send' it, the others flow through as expected.</p>\n\n<p>So, for example, the Wednesday scenario goes like this...</p>\n\n<ol>\n<li>Run the Wednesday report - it's email fails to get sent so click 'Send'</li>\n<li>Run the other, usual morning reports - all emails go through automatically</li>\n</ol>\n\n<p>And for the Mon, Tue, Thu, Fri runs...</p>\n\n<ol>\n<li>First email fails to get sent so click 'Send'</li>\n<li>Rest of emails are sent automatically.</li>\n</ol>\n\n<p>If I reverse the running of the reports, so that the Wednesday report is run last, its email goes through automatically as expected.</p>\n\n<p>My laptop is locked down tighter than a.... so any software 'additions' are not going to happen, likewise directly accessing the SMTP/Exchange server so right now Sendkeys is the only email automation available to me. All the occurences of the Sendkeys code is identical.</p>\n\n<p>As I say, confused!</p>\n\n<p>So do I have an issue with Excel or with Outlook?</p>\n\n<p>...and how do I 'fix' it?</p>\n\n<p>Many thanks for your help and time.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 2, "creation_date": 1454519035, "post_id": 35173209, "comment_id": 58083484, "body": "I think this problem is specific to Access and your approach looks like Transact SQL."}], "tags": [], "owner": {"reputation": 527, "user_id": 5804501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wxOqGnlcsdU/AAAAAAAAAAI/AAAAAAAAAAA/J3t5Oeu4FEs/photo.jpg?sz=128", "display_name": "Shukri Gashi", "link": "https://stackoverflow.com/users/5804501/shukri-gashi"}, "is_accepted": false, "score": -1, "last_activity_date": 1454492110, "creation_date": 1454492110, "answer_id": 35173209, "question_id": 35171682, "link": "https://stackoverflow.com/questions/35171682/is-there-a-effective-way-to-get-5-records-to-the-left-and-right-of-a-specific/35173209#35173209", "title": "Is there a (effective) way to get 5 records to the left and right of a specific record with Access SQL?", "body": "<p>I tried to simulate your situation, I created a table variable (you can skip this you have your table) and I used to do the right statement but I dont think this is the best optimized statement. Anyway it worked for my simulated table.     </p>\n\n<pre><code>DECLARE @SearchRecord TABLE (ID BIGINT)    \n\nDECLARE @i INT=1\nWHILE @i&lt;=50\nBEGIN \n    INSERT INTO @SearchRecord SELECT 16020000+@i\n    INSERT INTO @SearchRecord SELECT 16030000+@i\n    SET @i=@i+1\nEND\n</code></pre>\n\n<p>--Your Logic</p>\n\n<pre><code>DECLARE @SearchedID INT= 16020050\nDECLARE @Minid INT\nDECLARE @Maxid INT\nDECLARE @NearID INT\nSET @i=0\nSET @NearID=@SearchedID\nWHILE @i&gt;=-5\nBEGIN\n    IF EXISTS (SELECT * FROM @SearchRecord WHERE id=@nearID)\n    BEGIN\n        set @minid=@nearID\n        PRINT @minid\n        SET @i=@i-1\n    END\n    SET @nearID=@nearID-1\nEND\nSET @i=0\nSET @nearID=@SearchedID\nWHILE @i&lt;=5\nBEGIN\n    IF EXISTS (SELECT * FROM @SearchRecord WHERE id=@nearID)\n    BEGIN\n        set @maxid=@nearID\n        PRINT @maxid\n        SET @i=@i+1\n    END\n    SET @nearID=@nearID+1\nEND\n\nSELECT * FROM @SearchRecord WHERE (ID BETWEEN @minid AND @maxid) OR id=@searchedID  ORDER BY id\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1454518078, "creation_date": 1454518078, "answer_id": 35182921, "question_id": 35171682, "link": "https://stackoverflow.com/questions/35171682/is-there-a-effective-way-to-get-5-records-to-the-left-and-right-of-a-specific/35182921#35182921", "title": "Is there a (effective) way to get 5 records to the left and right of a specific record with Access SQL?", "body": "<p>For a table named [MyTable]</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ID\n--------\n16020493\n16020494\n16020495\n16020496\n16020497\n16020498\n16020499\n16020500\n16030001\n16030002\n16030003\n16030004\n16030005\n16030006\n16030007\n</code></pre>\n\n<p>we can get the starting ID of the range centred around ID=16020500 by using the query</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT MIN(ID) AS StartID\nFROM\n    (\n        SELECT TOP 6 ID \n        FROM MyTable\n        WHERE ID &lt;= 16020500\n        ORDER BY ID DESC\n    )\n</code></pre>\n\n<p>which returns</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>StartID\n--------\n16020495\n</code></pre>\n\n<p>and we can simply use that query as a subquery in the WHERE clause of a query to return the 11 rows (5 before + the main one + 5 after):</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT TOP 11 *\nFROM MyTable\nWHERE \n    ID &gt;= (\n        SELECT MIN(ID) AS StartID\n        FROM\n            (\n                SELECT TOP 6 ID \n                FROM MyTable\n                WHERE ID &lt;= 16020500\n                ORDER BY ID DESC\n            )\n    )\nORDER BY ID\n</code></pre>\n\n<p>returning</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ID\n--------\n16020495\n16020496\n16020497\n16020498\n16020499\n16020500\n16030001\n16030002\n16030003\n16030004\n16030005\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "is_accepted": false, "score": 0, "last_activity_date": 1454523052, "last_edit_date": 1454523052, "creation_date": 1454520427, "answer_id": 35183718, "question_id": 35171682, "link": "https://stackoverflow.com/questions/35171682/is-there-a-effective-way-to-get-5-records-to-the-left-and-right-of-a-specific/35183718#35183718", "title": "Is there a (effective) way to get 5 records to the left and right of a specific record with Access SQL?", "body": "<p>I have to imagine this is won't be fast though it is a fairly elegant way to think about the problem. This was more common when <code>top</code> didn't exist. The initial filter should help restrict the search to a window of ids around the previous two months (assuming there are always at least five records in a month).</p>\n\n<pre><code>select *\nfrom SearchRecord sr1\nwhere\n        id between [Id:] / 10000 * 10000 - 9999 and [Id:] / 10000 * 10000 + 10005 \n    and (select count(*) from SearchRecord sr2 where sr2.id between sr1.id and [Id:]) &lt;= 6\n    and (select count(*) from SearchRecord sr3 where sr3.id between [Id:] and sr1.id) &lt;= 6\n</code></pre>\n"}], "owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 35182921, "answer_count": 3, "score": 2, "last_activity_date": 1454523052, "creation_date": 1454487232, "question_id": 35171682, "link": "https://stackoverflow.com/questions/35171682/is-there-a-effective-way-to-get-5-records-to-the-left-and-right-of-a-specific", "title": "Is there a (effective) way to get 5 records to the left and right of a specific record with Access SQL?", "body": "<p>Like the title says, I am trying to do a SELECT statement where I am selecting 1 specific record (the one the person searched for) but I also want to get 5 records (the 5 that come before and after the specific one) to the right and left of the specific searched record, while keeping the current/focused record on the searched one. </p>\n\n<p>The records ID's (where they search for) consist out of date values combined with numbers. So for example in this month the first created record looks like this <code>1602030001</code> <code>&lt;-- Year(16), month (02), day (03) and first record (0001)</code>. So the second one they create this month will be <code>1602030002</code> and so on. </p>\n\n<p>So if they search for record 16020050 (50th record in February) I want to show records 16020044 to 16020055. </p>\n\n<p>I already did something like this but it has a downside:\nGet the searched record (16020050) and in VBA set a max and min variable (int) to do -5 and + 5 to the searched record number. Then use these variables to do a SELECT like: </p>\n\n<p><code>SELECT * FROM SearchRecord WHERE ID &gt; MinVariable (16020044) AND ID &lt; MaxVariable (16020055)</code></p>\n\n<p>However, the downside to this is that when the month February for example has only 500 records so 16020500 and then march started (16030001) and the person is searching for the 500th record on February it would also search for records that don't exist (up to 505 while that 5 are already in March --> 16030005). </p>\n\n<p>I don't know a more effective/smarter way to get those 5 extra record to each side and also maintain logic that if you search for the last record in a specific month that the 5 records to the right will start in the next month. </p>\n\n<p>I hope it makes sense;)</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454490201, "post_id": 35171554, "comment_id": 58062533, "body": "What error you received or what went wrong exactly?"}], "answers": [{"comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "reply_to_user": {"reputation": 29, "user_id": 5196158, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/973256202718511/picture?type=large", "display_name": "Pandi Muthu", "link": "https://stackoverflow.com/users/5196158/pandi-muthu"}, "edited": false, "score": 0, "creation_date": 1454593639, "post_id": 35176590, "comment_id": 58121046, "body": "Not directly using the Shadow.Visible property, no. But you could use this to hide it:   oShp.Shadow.Transparency = 1"}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "reply_to_user": {"reputation": 29, "user_id": 5196158, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/973256202718511/picture?type=large", "display_name": "Pandi Muthu", "link": "https://stackoverflow.com/users/5196158/pandi-muthu"}, "edited": false, "score": 0, "creation_date": 1454681295, "post_id": 35176590, "comment_id": 58166711, "body": "Thanks Pandi. If you&#39;re happy, could you mark the solution as useful please :-)"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1454681236, "last_edit_date": 1454681236, "creation_date": 1454501107, "answer_id": 35176590, "question_id": 35171554, "link": "https://stackoverflow.com/questions/35171554/remove-outer-shadow-of-powerpoint-table/35176590#35176590", "title": "Remove outer shadow of powerpoint table", "body": "<p>If your table shape object is set to oShp this will return the shadow property for the entire table shape as opposed to individual cells:</p>\n\n<pre><code>oShp.Shadow\n</code></pre>\n\n<p>But it appears that there is a bug (there are many in the latest table object model) writing to this property as this is ignored:</p>\n\n<pre><code>oShp.Shadow = msoFalse\n</code></pre>\n\n<p>I was going to suggest using CommandBars.ExecuteMso but there doesn't appear to be a control ID for shadow = none. As a result, I can't see a workaround for this other than the dreaded SendKeys which is always the least desirable option.</p>\n\n<p>You could use this workaround:</p>\n\n<pre><code>oShp.Shadow.Transparency = 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1454594082, "creation_date": 1454594082, "answer_id": 35202895, "question_id": 35171554, "link": "https://stackoverflow.com/questions/35171554/remove-outer-shadow-of-powerpoint-table/35202895#35202895", "title": "Remove outer shadow of powerpoint table", "body": "<p>You could force the shadow to be turned off by applying a pre-defined Microsoft Style to the Table object:</p>\n\n<pre><code>oShp.Table.ApplyStyle \"{2D5ABB26-0587-4C30-8999-92F81FD0307C}\"\n</code></pre>\n\n<p>Shape style ID's can be found here:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/hh273476%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/hh273476%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n"}], "owner": {"reputation": 29, "user_id": 5196158, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/973256202718511/picture?type=large", "display_name": "Pandi Muthu", "link": "https://stackoverflow.com/users/5196158/pandi-muthu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455974425, "creation_date": 1454486782, "last_edit_date": 1455974425, "question_id": 35171554, "link": "https://stackoverflow.com/questions/35171554/remove-outer-shadow-of-powerpoint-table", "title": "Remove outer shadow of powerpoint table", "body": "<p>I want to remove the outer shadow property of a table.</p>\n\n<p>I have used the below code but it isn't working.</p>\n\n<pre><code>with table.rows(x).columns (x).shape.shadow\n.visible =false\nend with\n</code></pre>\n"}, {"tags": ["vba", "sorting"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "edited": false, "score": 0, "creation_date": 1454515608, "post_id": 35171090, "comment_id": 58080840, "body": "Hi Kathara, thank you for your assistance on this.  I am getting an error in defining sht1. The sheet I am referencing is titled &#39;Template&#39; and ultimately, I will need this to run on which ever sheet is active.  The Error is Run-time error &#39;91&#39; Object variable or With block variable not set."}, {"owner": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "edited": false, "score": 0, "creation_date": 1454516213, "post_id": 35171090, "comment_id": 58081275, "body": "I should mention that the active sheet is already defined in my macro as ws.      Dim ws As Worksheet    Set ws = ActiveSheet"}], "tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": false, "score": 0, "last_activity_date": 1454485113, "creation_date": 1454485113, "answer_id": 35171090, "question_id": 35170965, "link": "https://stackoverflow.com/questions/35170965/sort-column-by-specific-row/35171090#35171090", "title": "Sort Column by Specific Row", "body": "<p>I think you only had a small mistake. I added a little more code as you should always be specific on which workbook and on which sheet you are working. Try this:</p>\n\n<pre><code>Dim lastColumn As Long\nDim lastRow As Long\n\nDim Sht1 As Worksheet\nSht1 = ActiveWorkbook.Sheets(\"Sheet1\")\n\nlastColumn = Sht1.Cells(8, Sht1.Columns.Count).End(xlToLeft).Column\nlastRow = Sht1.Cells(Sht1.Rows.Count, 1).End(xlUp).Row\n\nSht1.Sort.SortFields.Clear\n\nSht1.Sort.SortFields.Add Key:=Range( _\n    \"E14:Z\" &amp; lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith Sht1.Sort\n    .SetRange Range(\"E8:I\" &amp; lastRow)\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlLeftToRight\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454854447, "creation_date": 1454484687, "last_edit_date": 1454854447, "question_id": 35170965, "link": "https://stackoverflow.com/questions/35170965/sort-column-by-specific-row", "title": "Sort Column by Specific Row", "body": "<p>I would like to sort Columns E though \"lastColumn\" in ascending order. \nThe values to be used for sorting are in Row 14.<br>\nThe data set is located in cells E8 to \"lastColumn\" \"lastRow\".</p>\n\n<p>Below is what I have thus far, but I am getting an error that the reference is not valid. I'm guessing I am not using &amp;lastRow&amp; correctly, let alone trying to plug in the value for \"lastColumn\".</p>\n\n<p>I am using lastColumn and lastRow as a means to ignore blank cells.</p>\n\n<pre><code>Sub SortColumns()\n\nDim lastColumn As Long\nDim lastRow As Long\n\nlastColumn = Sheet1.Cells(8, Columns.Count).End(xlToLeft).Column\nlastRow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n\nActiveWorkbook.ActiveSheet.Sort.SortFields.Clear\n\nActiveWorkbook.ActiveSheet.Sort.SortFields.Add Key:=Range( _\n    \"E14:Z\" &amp; lastRow&amp;), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.ActiveSheet.Sort\n    .SetRange Range(\"E8:I\" &amp; lastRow)\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlLeftToRight\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "declaration", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1454488440, "post_id": 35170625, "comment_id": 58061414, "body": "You can&#39;t pass an array to <code>Trim</code>. Given that you are splitting on spaces, I assume you should be using <code>Trim</code> first: <code>SNmae = Split(Trim(Name), &quot; &quot;)</code>"}, {"owner": {"reputation": 451, "user_id": 2768400, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f830ed8684c7b41049f87564670eeb8d?s=128&d=identicon&r=PG&f=1", "display_name": "srt", "link": "https://stackoverflow.com/users/2768400/srt"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1454489465, "post_id": 35170625, "comment_id": 58062066, "body": "Thanks, I need to trim after splitting with space. Would that be incorrect technically? Say like &quot;asha  gamage&quot; needs to be &quot;asha&quot; and &quot;gamage&quot;. There&#39;s two space between these two strings."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1454489579, "post_id": 35170625, "comment_id": 58062127, "body": "There&#39;s no point to that. Splitting on spaces will remove all spaces from the data anyway, but it will give you empty array elements. You could work around that using: <code>SNmae = Split(Application.Trim(Name), &quot; &quot;)</code>"}, {"owner": {"reputation": 451, "user_id": 2768400, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f830ed8684c7b41049f87564670eeb8d?s=128&d=identicon&r=PG&f=1", "display_name": "srt", "link": "https://stackoverflow.com/users/2768400/srt"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1454490095, "post_id": 35170625, "comment_id": 58062448, "body": "Thanks a lot for this information."}], "answers": [{"tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1454484901, "creation_date": 1454484901, "answer_id": 35171031, "question_id": 35170625, "link": "https://stackoverflow.com/questions/35170625/type-mismatch-trim-and-split-in-same-line-and-use-of-array/35171031#35171031", "title": "Type mismatch : Trim and Split in same line and use of array", "body": "<p>I guess the problem is with Array Declaration part.</p>\n\n<p>Try below. Hope should work.</p>\n\n<pre><code> Dim SNmae() As String\n Dim dNmae() As String\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 2768400, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f830ed8684c7b41049f87564670eeb8d?s=128&d=identicon&r=PG&f=1", "display_name": "srt", "link": "https://stackoverflow.com/users/2768400/srt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 857, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454484901, "creation_date": 1454483389, "last_edit_date": 1531164843, "question_id": 35170625, "link": "https://stackoverflow.com/questions/35170625/type-mismatch-trim-and-split-in-same-line-and-use-of-array", "title": "Type mismatch : Trim and Split in same line and use of array", "body": "<pre><code>Sub matchid()\nDim Coun, anncount, dcoun, danncount, i, j, Tcount As Integer\nDim orange As Range\nDim Name, dName As String\nDim SNmae(), dNmae() As String\nDim osheet As Worksheet\nFor Coun = 2 To 157\nSet osheet = Sheets(\"Sheet1\")\nSet orange = osheet.Range(\"H\" &amp; Coun)\nIf WorksheetFunction.IsNA(orange) Then\nName = osheet.Range(\"G\" &amp; Coun).Value\nSNmae = Trim(Split(Name, \" \"))\n</code></pre>\n\n<p>In the code above, I have declared an array and tried to put values by splitting a string with space and trimming the same. In the line I does this gives me a Type mismatch error.\nHave I declared the array wrong? Should I \"set\" the array values?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5876413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z5WG7Zl2CAE/AAAAAAAAAAI/AAAAAAAAABA/-w-TB61XWwg/photo.jpg?sz=128", "display_name": "Ramon Scorgie", "link": "https://stackoverflow.com/users/5876413/ramon-scorgie"}, "edited": false, "score": 0, "creation_date": 1454672786, "post_id": 35176681, "comment_id": 58160715, "body": "Mr. Burns, thank you very much indeed for your kind assistance herewith. I&#39;ve followed your instructions above which has sorted my problem. Much appreciated!"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 13, "user_id": 5876413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z5WG7Zl2CAE/AAAAAAAAAAI/AAAAAAAAABA/-w-TB61XWwg/photo.jpg?sz=128", "display_name": "Ramon Scorgie", "link": "https://stackoverflow.com/users/5876413/ramon-scorgie"}, "edited": false, "score": 0, "creation_date": 1454680315, "post_id": 35176681, "comment_id": 58166016, "body": "@Ramon Scorgie , Great to hear that this helped, there is a tick,just below the up and down arrorw on the left side of the answer, to accept the answer as an answer"}, {"owner": {"reputation": 13, "user_id": 5876413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z5WG7Zl2CAE/AAAAAAAAAAI/AAAAAAAAABA/-w-TB61XWwg/photo.jpg?sz=128", "display_name": "Ramon Scorgie", "link": "https://stackoverflow.com/users/5876413/ramon-scorgie"}, "edited": false, "score": 0, "creation_date": 1455171897, "post_id": 35176681, "comment_id": 58372197, "body": "This site has really benefited over the past two weeks while completing a project. Thanks to everyone who so willingly contribute to it."}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 13, "user_id": 5876413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z5WG7Zl2CAE/AAAAAAAAAAI/AAAAAAAAABA/-w-TB61XWwg/photo.jpg?sz=128", "display_name": "Ramon Scorgie", "link": "https://stackoverflow.com/users/5876413/ramon-scorgie"}, "edited": false, "score": 0, "creation_date": 1455270656, "post_id": 35176681, "comment_id": 58424914, "body": "GLad to hear that SO has beena ble to help, hope we see you more!"}], "tags": [], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1454501346, "creation_date": 1454501346, "answer_id": 35176681, "question_id": 35170496, "link": "https://stackoverflow.com/questions/35170496/attachments-dont-delete-after-sending-email-when-looping/35176681#35176681", "title": "Attachments don&#39;t delete after sending email when looping", "body": "<p><code>.Attachments.Remove 1</code> May work\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff868839.aspx\" rel=\"nofollow\">MSDN</a> says that \"The 1-based index value of the object within the collection.\" or in laymans speach you need to tell it which attachment to remove</p>\n\n<p>Not sure if you are using outlook but in your VBA you can try going to \"Tools\" > \"References\" and add Microsoft Outlook SharePoint social Provider, Social Provider Extensibility and View Control</p>\n\n<p>If you need further clarification of anything just leave a comment and i'll get back to you when I can</p>\n"}], "owner": {"reputation": 13, "user_id": 5876413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z5WG7Zl2CAE/AAAAAAAAAAI/AAAAAAAAABA/-w-TB61XWwg/photo.jpg?sz=128", "display_name": "Ramon Scorgie", "link": "https://stackoverflow.com/users/5876413/ramon-scorgie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 35176681, "answer_count": 1, "score": 0, "last_activity_date": 1454501346, "creation_date": 1454482934, "last_edit_date": 1531164843, "question_id": 35170496, "link": "https://stackoverflow.com/questions/35170496/attachments-dont-delete-after-sending-email-when-looping", "title": "Attachments don&#39;t delete after sending email when looping", "body": "<p>The below code is used to send out an email with an attachment and does that fine. The problem I have is:</p>\n\n<ol>\n<li><p>that the code is called again to perform the same function, but the attachments don't delete after sending, hence, it will keep adding the new attachment to an existing batch of those already sent. I've tried to add \".Attachments.Remove\" just before the add attachment, but keep getting an error on this line.</p></li>\n<li><p>The second thing I would really appreciate assistance with, is to tell the code when to 'stop' if lets say, the next email has previously been sent, hence, move on the next email, etc., and when to stop if all emails have already been sent.</p></li>\n</ol>\n\n<hr>\n\n<pre><code>Sub email_PO()\n\n\nApplication.DisplayAlerts = False\nFile_name = Sheet2.Cells(3, 10)\nattach_name = Sheet2.Cells(28, 10)\nattach_file = Sheet2.Cells(60, 10)\npasteAt = Sheet2.Cells(62, 10)\n\nWindows(File_name).Activate\nSheets(\"Control\").Select\nBodytosend = Sheet2.Range(\"A581:E596\")\n\nmail_to_ATTA = Sheet2.Cells(58, 10)\nmail_cc_ATTA = Sheet2.Cells(59, 10)\nSubject = Sheet2.Cells(57, 10)\n\nSheets(\"Control\").Select\nRange(\"A39\").Select\nActiveSheet.Hyperlinks.Add ANCHOr:=Selection, Address:= _\nattach_link, TextToDisplay:= _\n\"\"\n\nDim Sendrng As Range\nApplication.DisplayAlerts = False\nWith Application\n.ScreenUpdating = False\n.EnableEvents = False\nEnd With\nSheets(\"Control\").Select\nRange(\"A581:H604\").Select\nSet Sendrng = Selection\nWith Sendrng\nActiveWorkbook.EnvelopeVisible = True\nWith .Parent.MailEnvelope\n.Introduction = \"\"\n\nWith .Item\n\n\n.To = mail_to_ATTA\n.Cc = mail_cc_ATTA\n.Subject = Subject\n.Attachments.Remove\n.Attachments.Add (attach_file)\n.VotingOptions = \"Purchased Order Acknowledged &amp; Agree to T&amp;C's;Purchase Order Declined\"\n.SEND\nEnd With\nEnd With\n\nEnd With\n\nStopMacro:\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nActiveWorkbook.EnvelopeVisible = False\n\n\nWindows(File_name).Activate\n\nSheets(\"Control\").Select\nRange(\"J61\").Select\nSelection.Copy\nSheets(\"PO Tracker\").Select\nRange(pasteAt).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n\nRange(\"A1\").Select\n\nCall email_PO\n\n\nExit Sub\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454479010, "post_id": 35169319, "comment_id": 58056905, "body": "First that there should &#39;()&#39; after FillEmptyCell."}, {"owner": {"reputation": 2094, "user_id": 5508728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3gtR.jpg?s=128&g=1", "display_name": "jeff carey", "link": "https://stackoverflow.com/users/5508728/jeff-carey"}, "edited": false, "score": 0, "creation_date": 1454479186, "post_id": 35169319, "comment_id": 58056981, "body": "In your non-dynamic version you are checking if the cell contains a space, cell.value = &quot; &quot;.  You most likely don&#39;t want that.  Try changing that part to If Trim(cell.value) = &quot;&quot;   As for your dynamic part I&#39;m not really sure what you&#39;re trying to accomplish"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454479700, "post_id": 35169319, "comment_id": 58057224, "body": "Sorry those are the typing errors,I do have function bracket and there is not any space,yet its not running,the code isn&#39;t running the Then cell.value= &quot;0&quot;."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454479898, "post_id": 35169319, "comment_id": 58057298, "body": "When  i try your code it gave me an error &#39;End If without If block&#39; so i removed End If it worked well for me. see my second answer."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454480030, "post_id": 35169684, "comment_id": 58057343, "body": "It gives error as Select method of range class failed fir rng.Select"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454480172, "post_id": 35169684, "comment_id": 58057408, "body": "That may be beacuse the sheet is not activated. Try the edited code"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454480246, "post_id": 35169684, "comment_id": 58057438, "body": "I tested it, Worked perfectly for me"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1454480949, "post_id": 35169684, "comment_id": 58057715, "body": "Why, why, <i>why</i> use activate/select/selection? Pointless and spoils an otherwise good answer"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1454481243, "post_id": 35169684, "comment_id": 58057858, "body": "@chris neilsen Im sorry if that is wrong. I guess the sheet should be active before the code go ahead and select when there are multiple sheets and if the control is in not in the sheet  where i need to perform selection. I guess your suggestion is directly use rng.Replace... Am i right?"}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1454480147, "last_edit_date": 1454480147, "creation_date": 1454479701, "answer_id": 35169684, "question_id": 35169319, "link": "https://stackoverflow.com/questions/35169319/vba-code-filling-the-blank-cells-with-zero-dynamically/35169684#35169684", "title": "Vba code: Filling the blank cells with zero dynamically", "body": "<p>I also have one more suggestion for you.</p>\n\n<pre><code>  Sub FillEmptyCell()\n  Dim rng as Range\n  Dim i as Long\n  Dim cell as Range\n  Set rng= Sheets(\"Mysheet\").Range(\"C12:H35\")\n  Sheets(\"Mysheet\").Activate\n  rng.Select\n  Selection.Replace What:=\"\", Replacement:=\"0\", LookAt:=xlWhole, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n\n  End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454480710, "post_id": 35169749, "comment_id": 58057623, "body": "Ya it did .Thanks. Also the code I have mentioned above is for selecting the dynamic range,so instead of fixing the range as c12:h35 if I use the dynamic range above it doesn&#39;t work."}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454480735, "post_id": 35169749, "comment_id": 58057628, "body": "Dim sht as Worksheet Set sht = This Workbook.Sheets(&quot;MySheet&quot;) sht.Range(sht.cells(C12:3),sht.cells(12,Columns.count).End(x&zwnj;&#8203;lToLeft)).Select"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454481003, "post_id": 35169749, "comment_id": 58057743, "body": "Please tell your expected start position of cell. I guess the end cell is dynamic value"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454481173, "post_id": 35169749, "comment_id": 58057824, "body": "The sheet starts filling from cell(12,3).And as the data us dynamic ,some values have data some are blank where I need to fill it with zero.It starts from &#39;C&#39; column and goes till &quot;AI&quot;column,there can be dynamic rows."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454481369, "post_id": 35169749, "comment_id": 58057920, "body": "So starting from C coloumn 12 row , and ends in AI coloumn but could be any Row. Am i right?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454482349, "post_id": 35169749, "comment_id": 58058364, "body": "I have edited the answer. Hope this should help you.If the code is working fine please mark it as answered."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454484383, "post_id": 35169749, "comment_id": 58059317, "body": "Np... Welcome. Please mark the Question as Answered. So that it will be a ready to use answer"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454484431, "post_id": 35169749, "comment_id": 58059343, "body": "Am new to this ,how do we do that?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454484650, "post_id": 35169749, "comment_id": 58059453, "body": "I guess you should have a Accept option for this answer."}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454486373, "post_id": 35169749, "comment_id": 58060310, "body": "Siva ,the code only goes one row down,it should be filling all rows down with zero.Also I guess because of the range (&quot;c12:ad12&quot;).select,it highlights that entire 12th row from c to ad"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454487487, "post_id": 35169749, "comment_id": 58060885, "body": "It worked once fine,I have no clue wat is suddenly going wrong"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454488304, "post_id": 35169749, "comment_id": 58061348, "body": "in Your Excel sheet what was the available range. Manully select c12 to ad12 and then presSHIFT+CTRL+DOWN key. See what is the range available.Please note that even after Set rng line the sheet shows only 12 row as selected where as rng contains all the below rows as well."}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454489201, "post_id": 35169749, "comment_id": 58061863, "body": "I just don&#39;t know y it isn&#39;t working.It did for once .Then I closed and now it isn&#39;t :("}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454489349, "post_id": 35169749, "comment_id": 58061969, "body": "Okay Try debugging the code step by step you can figure out where exactly it is going wrong. Try to see it."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454489652, "post_id": 35169749, "comment_id": 58062173, "body": "Let me know where exactly it is going wrong. I could see it working flawlessly for me"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454489747, "post_id": 35169749, "comment_id": 58062235, "body": "It highlights the range from c12:ad12 and fill zeroes in that row and a row below it.It doesn&#39;t goes to rows down.Not showing any error.Just that it&#39;s not spanning the entire rows"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454490151, "post_id": 35169749, "comment_id": 58062491, "body": "Try the edited code an see what is happening. Please check what is happening after the control comes to Set rng = Range(Selection, Selection.End(xlDown))"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454490378, "post_id": 35169749, "comment_id": 58062651, "body": "So now its highlighting the range c12: ad13 and filling them with zeroes,not going down the rows."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454490540, "post_id": 35169749, "comment_id": 58062759, "body": "Do you have any rows which are below that row where you need to fill with zeros. That selection will only select those rows which were used. Like any one of cell in below rows should  have been used. Then only the selection will go to next rows."}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454490650, "post_id": 35169749, "comment_id": 58062828, "body": "Yeah I do,like a 13 rows below with 4-5 cells in each row filled,still ita not parsing. Even the syntax is all correct.I  can&#39;t figure out what&#39;s going wrong. also I told you na,it worked perfectly once,but now it isnt :("}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454490727, "post_id": 35169749, "comment_id": 58062883, "body": "Okay tell me whether the selection is happening when you try manually"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454491324, "post_id": 35169749, "comment_id": 58063298, "body": "Im not sure what went wrong with previous code. I have edited the answer and tried in other way. Give a try."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454492563, "post_id": 35169749, "comment_id": 58064167, "body": "Np ... Try closing the sheet and running it againg as well :-)"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454522163, "post_id": 35169749, "comment_id": 58085551, "body": "Siva just one issue,the updated code fills the entire sheet with zero,even for rows where there is no data in any cell.Is it working the same way for u?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454523712, "post_id": 35169749, "comment_id": 58086501, "body": "No. One reason could be due to that usedrange.rows.count. usedrange will consider all the cells that are used once.it&#39;s not necessary to have data. So for example a in last row is formated, or applied, but no value in cell also, usedrange.rows.count will give last row."}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454523881, "post_id": 35169749, "comment_id": 58086590, "body": "Hey Siva I have reposted your answer to see if someone can help.So you mean that I should remove the formatting? I can&#39;t do that.Cause I need data to be populated in the sheet in formatted way only.Is there no way out then?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454524758, "post_id": 35169749, "comment_id": 58087094, "body": "Other way is instead of using used range, setting the range by using the lines I have commented."}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454525607, "post_id": 35169749, "comment_id": 58087557, "body": "Hm that also isn&#39;t working fine in my sheet Anyways,Thankyou so much :)"}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": true, "score": 0, "last_activity_date": 1454491274, "last_edit_date": 1454491274, "creation_date": 1454479964, "answer_id": 35169749, "question_id": 35169319, "link": "https://stackoverflow.com/questions/35169319/vba-code-filling-the-blank-cells-with-zero-dynamically/35169749#35169749", "title": "Vba code: Filling the blank cells with zero dynamically", "body": "<p>This Code worked alright for me</p>\n\n<pre><code>Sub FillEmptyCell()\n  Dim rng As Range\n  Dim i As Long\n  Dim cell As Range\n  Dim sht As Worksheet\n  Set sht = ActiveWorkbook.Sheets(\"Sheet1\")\n  sht.Activate\n  'Range(\"C12:AL12\").Select\n  'Range(Selection, Selection.End(xlDown)).Select\n  Set rng = Range(Range(\"C12\"), Range(\"AD\" &amp; sht.UsedRange.Rows.Count))\n  For Each cell In rng\n    If cell.Value = \"\" Then cell.Value = \"0\"\n  Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454489225, "post_id": 35172095, "comment_id": 58061881, "body": "What kind of dynamic range? I didn&#39;t understand in your question"}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454489332, "post_id": 35172095, "comment_id": 58061953, "body": "The range can vary depending upon the data. Currently am just doing for C12:H35.but there can be any number of rows spanning the columns from C to AD.so for that I need to modify my code"}, {"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454489416, "post_id": 35172095, "comment_id": 58062027, "body": "And you want all blank cells in that range to say 0? Let me have a look"}, {"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454490799, "post_id": 35172095, "comment_id": 58062937, "body": "I think with the amount of variation inn the ranges, your only option would to be to loop through all cells in each column and fill them out one column at a time. It might take a while to run, but I&#39;ll have a go for you anyway."}, {"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454493270, "post_id": 35172095, "comment_id": 58064673, "body": "See my edited answer, should be what you&#39;re looking for."}, {"owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454522088, "post_id": 35172095, "comment_id": 58085510, "body": "Josh what is the type of lastrow and colRef and x? I put it as long,range and int respectively .Am I correct?"}, {"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "reply_to_user": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "edited": false, "score": 0, "creation_date": 1454574920, "post_id": 35172095, "comment_id": 58108541, "body": "I find <code>lastrow as long</code> <code>colRef as long</code> and <code>x as integer</code> works nicely"}], "tags": [], "owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "is_accepted": false, "score": 0, "last_activity_date": 1454493294, "last_edit_date": 1454493294, "creation_date": 1454488825, "answer_id": 35172095, "question_id": 35169319, "link": "https://stackoverflow.com/questions/35169319/vba-code-filling-the-blank-cells-with-zero-dynamically/35172095#35172095", "title": "Vba code: Filling the blank cells with zero dynamically", "body": "<p>Your code is fine, but your if statement was off, I also changed the quotation marks to not have a space in them. When that's the case, VBA looks for a space in a cell, not an empty cell.</p>\n\n<pre><code>Sub FillEmptyCell()\nDim rng As Range\nDim i As Long\nDim cell As Range\n\n    Range(\"C1\").Select\n    colRef = ActiveCell.Column\n    lastrow = Cells(Rows.Count &amp; colRef).End(xlUp).Row\n    Do Until ActiveCell.Column = 31\n        colRef = ActiveCell.Column\n        lastrow = Cells(Rows.Count &amp; colRef).End(xlUp).Row\n        For x = 1 To lastrow\n            If ActiveCell.Value = \"\" Then\n                ActiveCell.Value = \"0\"\n                ActiveCell.Offset(1).Select\n            Else\n                ActiveCell.Offset(1).Select\n            End If\n        Next\n        ActiveCell.Offset(-lastrow, 1).Select\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 4897055, "user_type": "registered", "profile_image": "https://graph.facebook.com/871015412960574/picture?type=large", "display_name": "Shashiraju", "link": "https://stackoverflow.com/users/4897055/shashiraju"}, "is_accepted": false, "score": 0, "last_activity_date": 1580385768, "creation_date": 1580385768, "answer_id": 59985644, "question_id": 35169319, "link": "https://stackoverflow.com/questions/35169319/vba-code-filling-the-blank-cells-with-zero-dynamically/59985644#59985644", "title": "Vba code: Filling the blank cells with zero dynamically", "body": "<p>Select a range in sheet and try running this code</p>\n\n<pre><code>Sub FillBlanksWithZero()\n    Dim rng As Range\n\n    Set rng = Range(Selection.Address)\n    Selection.SpecialCells(xlCellTypeBlanks).Select\n    Selection.FormulaR1C1 = \"0\"\nEnd Sub\n</code></pre>\n\n<p>I hope this will helps you :)</p>\n"}], "owner": {"reputation": 65, "user_id": 5829156, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7114256f099975a1fc5b5cc7e3bc485?s=128&d=identicon&r=PG&f=1", "display_name": "Sunaina", "link": "https://stackoverflow.com/users/5829156/sunaina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16131, "favorite_count": 0, "accepted_answer_id": 35169749, "answer_count": 4, "score": -1, "last_activity_date": 1580385768, "creation_date": 1454478052, "last_edit_date": 1531164843, "question_id": 35169319, "link": "https://stackoverflow.com/questions/35169319/vba-code-filling-the-blank-cells-with-zero-dynamically", "title": "Vba code: Filling the blank cells with zero dynamically", "body": "<p>I need to fill my blank cells in a worksheet with zero. Currently I was doing it for C12:H35. Can someone please tell what's wrong in my code.Its not even giving any error.Also I need to do it dynamically .  So I was trying to do as</p>\n\n<p><code>Dim sht as Worksheet\n  Set sht = This Workbook.Sheets(\"MySheet\")\nsht.Range(sht.cells(C12:3),sht.cells(12,Columns.count).End(xlToLeft)).Select</code></p>\n\n<p>None is working :(</p>\n\n<p>This code is for non dynamic range,which again isn't working</p>\n\n<pre><code>  Sub FillEmptyCell\n      Dim rng as Range\n      Dim i as Long\n      Dim cell as Range\n  Set rng= Sheets(\"Mysheet\").Range(\"C12:H35\")\n\nFor each cell in rng\n  If cell.value = \" \" Then cell.value= \"0\"\n  End if \nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454482774, "post_id": 35169213, "comment_id": 58058548, "body": "Sorry. Can you please be a little more clear. Are you expecting &#39;pvtbl.TableStyle2&#39; to change every time this macro run?"}, {"owner": {"reputation": 89, "user_id": 4110415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bb4ee582db446c66ab2cec144b600d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Dharmendra", "link": "https://stackoverflow.com/users/4110415/dharmendra"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454487744, "post_id": 35169213, "comment_id": 58061050, "body": "yes, here we can change the last number i.e. 2 @siva"}, {"owner": {"reputation": 89, "user_id": 4110415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bb4ee582db446c66ab2cec144b600d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Dharmendra", "link": "https://stackoverflow.com/users/4110415/dharmendra"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454488407, "post_id": 35169213, "comment_id": 58061390, "body": "yes, in excel we have 28 table style in medium table (pivotstylemedium1 to pivotstylemedium28) and dark table (pivotstyledark1 to pivotstyledark28), now i wanted to change every time whenever new (i.e. next dashboard run time) pivot create it use different style from medium1 to dark28 (total 56 styles) @Siva"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454489150, "post_id": 35169213, "comment_id": 58061825, "body": "I understand it a bit changing the style wan be achieved by replacing static text with variable pvtbl.TableStyle2 = &quot;PivotStyleDark&quot; &amp; i or pvtbl.TableStyle2 = varPivotStyle (this can be changed) My question is The line of code you gave is it a common fucntion you call every time you want to create a new table or it is part of main sub where these lines are inside any loops. Will be great helpful if you can put entire code and clear scenario for us to help"}, {"owner": {"reputation": 89, "user_id": 4110415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bb4ee582db446c66ab2cec144b600d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Dharmendra", "link": "https://stackoverflow.com/users/4110415/dharmendra"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454899815, "post_id": 35169213, "comment_id": 58235507, "body": "This part of main code, the code is too big so i am unable to to put it @Siva"}], "owner": {"reputation": 89, "user_id": 4110415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bb4ee582db446c66ab2cec144b600d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Dharmendra", "link": "https://stackoverflow.com/users/4110415/dharmendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1454488868, "creation_date": 1454477597, "last_edit_date": 1454479471, "question_id": 35169213, "link": "https://stackoverflow.com/questions/35169213/change-pivotstyle-every-next-time-of-macro-run", "title": "Change PivotStyle every next time of Macro Run", "body": "<p>I want to change the pivot stayle every next time when run dashboard, please suggest for the same coding is:</p>\n\n<pre><code>Set rng = ws.Range(\"A1:\" &amp; Split(Cells(, lastcol).Address, \"$\")(1) &amp; lastrow)\nsrcdata = rng.Address(ReferenceStyle:=xlR1C1)\nSet pvtch = ActiveWorkbook.PivotCaches.Create(xlDatabase, srcdata)\nSet pvtbl = pvtch.CreatePivotTable(tableDestination:=ptws.Range(\"A3\"), tablename:=\"PivotTable1\")\npvtbl.PivotFields(\"TAT Status\").Orientation = xlRowField\npvtbl.PivotFields(\"RequestType\").Orientation = xlRowField\npvtbl.PivotFields(\"Case Owner\").Orientation = xlColumnField\npvtbl.AddDataField pvtbl.PivotFields(\"Reference no\"), \"Count_Ticket_ID\", xlCount\nptws.Range(\"A4\").Value = \"Ticket Type with TAT\"\npvtbl.TableStyle2 = \"PivotStyleDark1\" 'Here I want to change the style every next time when pivot table create.\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "edited": false, "score": 0, "creation_date": 1454552927, "post_id": 35169160, "comment_id": 58099984, "body": "I have edited my question to be more understandable. Thanks! :)"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454555557, "post_id": 35169160, "comment_id": 58100686, "body": "Thanks for the update, are you still facing any issue? And also, you are expecting message to be displayed on click of a button of User Form am I right."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "edited": false, "score": 0, "creation_date": 1454556868, "post_id": 35169160, "comment_id": 58101025, "body": "Yes @Siva, and issue is still the same .. Thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "edited": false, "score": 0, "creation_date": 1454563972, "post_id": 35169160, "comment_id": 58103363, "body": "Thank You so much @Siva for your great help! :) It really works!"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1454565051, "post_id": 35169160, "comment_id": 58103787, "body": "Np... Welcome.. Please mark the question as answered so that others can get a readily use this solution if they encounter similar issue."}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": true, "score": 1, "last_activity_date": 1454570636, "last_edit_date": 1454570636, "creation_date": 1454477304, "answer_id": 35169160, "question_id": 35169065, "link": "https://stackoverflow.com/questions/35169065/display-the-result-of-an-optionbutton-in-a-messagebox/35169160#35169160", "title": "Display the result of an optionButton in a messageBox", "body": "<p>Assuming you have a user form with some option like below...</p>\n\n<p><a href=\"https://i.stack.imgur.com/dBMQO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dBMQO.png\" alt=\"enter image description here\"></a></p>\n\n<p>On Click of OK button message box will be displayed for my below code based on the user selection option.</p>\n\n<pre><code> Private Sub CommandButton1_Click()\n        Dim amt As Integer\n        If (opt750) Then\n          amt = 750\n        ElseIf (opt1000) Then\n          amt = 1000\n          Else\n          amt = 0\n        End If\n        MsgBox \"Received the amount of :\" &amp; amt\n\n End Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 35169160, "answer_count": 1, "score": 0, "last_activity_date": 1454570636, "creation_date": 1454476793, "last_edit_date": 1454552820, "question_id": 35169065, "link": "https://stackoverflow.com/questions/35169065/display-the-result-of-an-optionbutton-in-a-messagebox", "title": "Display the result of an optionButton in a messageBox", "body": "<p>I have a problem in displaying the selected option in the user form. I have 2 option buttons named <code>opt750</code> and the value is 750 and the other one is <code>opt1000</code> and the value is 1000.After selecting from the options, it should be displayed in the msg box. The code I've tried is as follows, this is the whole message to be displayed when the user click the ok button:</p>\n\n<pre><code>MsgBox \"Date Received : \" &amp; vbTab + vbTab + date.Value + vbNewLine &amp; _\n\"Amount Received : \" &amp; vbTab + amount.Value + vbNewLine &amp; _\n\"Received Type: \" &amp; vbTab + vbTab + acnType.Value + vbNewLine &amp; _\nvbNewLine &amp; _\n\"Received the amount of : \" 'this is where I should \n'call the result of the selected option button\n</code></pre>\n\n<p>I like the result to be displayed in the msgbox as:</p>\n\n<pre><code>Date Received : 01/01/2011\nAmount Received: 10000\nReceived Type: ATM\nReceived the total amount of : 750 'if the button selected is 750 otherwise, 1000\n</code></pre>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["sql-server", "excel", "ms-access", "mdf", "vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1454474834, "post_id": 35168503, "comment_id": 58055491, "body": "LocalDB does this: <a href=\"https://msdn.microsoft.com/en-us/library/hh510202.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/hh510202.aspx</a>"}, {"owner": {"reputation": 1013, "user_id": 3448932, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jBnU6.jpg?s=128&g=1", "display_name": "ptownbro", "link": "https://stackoverflow.com/users/3448932/ptownbro"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1454601128, "post_id": 35168503, "comment_id": 58126623, "body": "Hm. I suspected but couldn&#39;t quitr figure out how to use (or get to) localdb after I installed express. So wasn&#39;t sure. I&#39;ll check it out in more detail. Thanks"}], "owner": {"reputation": 1013, "user_id": 3448932, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jBnU6.jpg?s=128&g=1", "display_name": "ptownbro", "link": "https://stackoverflow.com/users/3448932/ptownbro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1454473543, "creation_date": 1454473543, "last_edit_date": 1531161705, "question_id": 35168503, "link": "https://stackoverflow.com/questions/35168503/using-local-sql-server-database-vs-access-with-excel-addin", "title": "Using local SQL Server Database vs Access with Excel Addin", "body": "<p>I have an Excel addin which reads/writes from/to a MS access db that is installed on the user's local machine. So each user that installs the addin also needs their own stand alone Access db as well.</p>\n\n<p>I'd like to do this with a SQL server db instead. How can I do that without needing to install SQL server instance on every computer. Is that possible?</p>\n\n<p>I jsut want to add the mdf file on the local/client machine as well as any drivers and then via vba read/write from/to that mdf file</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 1, "creation_date": 1454467352, "post_id": 35167540, "comment_id": 58053322, "body": "Seek and Ye shall find :) <a href=\"http://stackoverflow.com/questions/22051960/vba-winhttp-to-download-file-from-password-proteced-https-website\" title=\"vba winhttp to download file from password proteced https website\">stackoverflow.com/questions/22051960/&hellip;</a>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1454467551, "post_id": 35167540, "comment_id": 58053378, "body": "If you asked the right question (which is how to download a file from a password-protected site in VBA) you would have found the linked post yourself. Your question has absolutely nothing to do with importing a CSV file into Excel; it&#39;s all about being able to download the file. Ask the question you need an answer to, instead of confusing and convoluting everything with non-relevant information. You&#39;ll get help much quicker (if you don&#39;t find an existing question that provides the answer already).  :-)"}, {"owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "edited": false, "score": 0, "creation_date": 1454471561, "post_id": 35167540, "comment_id": 58054477, "body": "Thanks for the help Ken! I very specifically need to not download the file however. I need to import it directly into Excel. Even temporarily saving it, importing it, and deleting it, won&#39;t work."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1454472124, "post_id": 35167540, "comment_id": 58054636, "body": "Why won&#39;t that work? Don&#39;t have access to local folders or is there a security issue? You basically need to find some kind of COM HTTP library that will let you load a text stream into a variable. Maybe this library has a method you can use: <a href=\"http://stackoverflow.com/questions/3119207/sending-http-requests-with-vba-from-word\" title=\"sending http requests with vba from word\">stackoverflow.com/questions/3119207/&hellip;</a>"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1454472237, "post_id": 35167540, "comment_id": 58054669, "body": "Here&#39;s more info on it - maybe you can use responsestream or responsetext. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384106(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454474274, "post_id": 35167540, "comment_id": 58055312, "body": "Have you tried that using your url? Is there any error message?"}, {"owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "edited": false, "score": 0, "creation_date": 1454557197, "post_id": 35167540, "comment_id": 58101124, "body": "Jules, Yes I got an Automation Error message."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454625971, "post_id": 35167540, "comment_id": 58141447, "body": "@MikeK What is the actual error message? tag my id or I won&#39;t see your reply."}, {"owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454634564, "post_id": 35167540, "comment_id": 58144647, "body": "@Jules   <i>Run-time error &#39;-2147012858 (80072f06)&#39;:</i> <i>Automation Error</i>  I really appreciate the help!"}, {"owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454635319, "post_id": 35167540, "comment_id": 58144840, "body": "@Jules I tried to capture more detail on the error... the code that causes the error is &quot;WHTTP.Send&quot;. If I use On Error Resume Next before that line, and then MsgBox the ErrDescription, I get &quot;The host name in the certificate is invalid or does not match&quot;"}, {"owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454635736, "post_id": 35167540, "comment_id": 58144934, "body": "@Jules The search continues... from more Googling, and inspecting the certificate of the website, the certificate is for &quot;portal.website.com&quot; but I&#39;m trying to access &quot;webservices.website.com&quot;. Is there anyway to get around this? I don&#39;t care if the certificates don&#39;t match."}, {"owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454637455, "post_id": 35167540, "comment_id": 58145326, "body": "@Jules More Googling, but now I believe I&#39;m at an impasse... I set WinHTTP to ignore Ssl error flags, and now I get this error: &quot;The connection with the server was terminated abnormally&quot;. Sorry for sending so many messages... I believe I&#39;m at the root of the problem now."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454640333, "post_id": 35167540, "comment_id": 58146100, "body": "@mikek Is the server intranet or internet?  When using winhttp, it uses IE setting proxy, etc.  I would guess php ignore IE setting and connect directly to the server."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454641092, "post_id": 35167540, "comment_id": 58146322, "body": "@mikek, sorry I was wrong WinHTTP does not use IE proxy settings. XMLHTTPRequest does.  So if you use proxy from your machine, you have to set up the proxy in the code."}, {"owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454642553, "post_id": 35167540, "comment_id": 58146705, "body": "@Jules I actually got it working using &#39;SetCredentials&#39; instead!"}], "owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1240, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1454642859, "creation_date": 1454467042, "last_edit_date": 1495541246, "question_id": 35167540, "link": "https://stackoverflow.com/questions/35167540/import-a-csv-file-into-excel-requires-login-pass", "title": "Import A CSV File into Excel (Requires Login/Pass)", "body": "<p>I've looked at dozens of similar topics here without finding what I'm looking for. If I was doing it manually, I would navigate to the URL, given some parameters:</p>\n\n<blockquote>\n  <p><a href=\"https://the.website.com/mobile/rest/reportservice/exportReport?name=shared%2FMV+Report.ppr&amp;format=csv&amp;showTotals=false&amp;valueDate=Today\" rel=\"nofollow noreferrer\">https://the.website.com/mobile/rest/reportservice/exportReport?name=shared%2FMV+Report.ppr&amp;format=csv&amp;showTotals=false&amp;valueDate=Today</a></p>\n</blockquote>\n\n<p>When I go there, it requests a username and password in a pop-up box, which I enter, and it downloads the CSV.</p>\n\n<p>This Python code works perfectly:</p>\n\n<pre><code>import requests\nfrom requests.auth import HTTPBasicAuth\n\nUSERNAME = \"i_cant_tell_you_guys\"\nPASSWORD = \"definitely_cant_share_this\"\n\nauth = HTTPBasicAuth(USERNAME, PASSWORD)\n\nURL = \"https://the.website.com/mobile/rest/reportservice/exportReport?name=shared%2FMV+Report.ppr&amp;format=csv&amp;showTotals=false&amp;valueDate=Today\"\n\nresp = requests.get(URL.format(USERNAME, PASSWORD), auth=auth, verify=False)\n\nprint resp.content\n</code></pre>\n\n<p>But I can't seem to replicate it in VBA. Is it possible? If not, could I have Excel and Python work together somehow?</p>\n\n<p>Thanks!</p>\n\n<p>Edit: Several people suggested this approach: <a href=\"https://stackoverflow.com/questions/22051960\">VBA WinHTTP to download file from password proteced https website</a> but since the URL I'm pulling isn't the actual file URL, it won't work.</p>\n\n<p>Edit:\nFinally got it working. The website had a certificate mismatch, so I had to tell WinHTTP to ignore SSL errors. Here's the new code:</p>\n\n<pre><code>Sub SaveFileFromURL()\n\n    Const Option_SSLErrorIgnoreFlags = 4\n    Const SslErrorFlag_Ignore_All = 13056\n    Const HTTPREQUEST_SETCREDENTIALS_FOR_SERVER = 0\n\n    Dim FileNum As Long\n    Dim FileData() As Byte\n    Dim WHTTP As Object\n\n    mainUrl = \"https://website.com\"\n    fileUrl = \"https://website.com/myfile.csv\"\n    filePath = \"C:\\myfile.csv\"\n\n    myuser = \"login\"\n    mypass = \"pass\"\n\n    Set WHTTP = CreateObject(\"WinHTTP.WinHTTPrequest.5.1\")\n\n\n    WHTTP.Open \"POST\", mainUrl, False\n    WHTTP.SetCredentials myuser, mypass, HTTPREQUEST_SETCREDENTIALS_FOR_SERVER\n    WHTTP.SetRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n    WHTTP.Option(Option_SSLErrorIgnoreFlags) = SslErrorFlag_Ignore_All\n\n    WHTTP.Send\n\n    WHTTP.Open \"GET\", fileUrl, False\n    WHTTP.Send\n\n    FileData = WHTTP.ResponseBody\n    Set WHTTP = Nothing\n\n    FileNum = FreeFile\n\n    Open filePath For Binary Access Write As #FileNum\n        Put #FileNum, 1, FileData\n    Close #FileNum\n\n    MsgBox \"File has been saved!\", vbInformation, \"Success\"\n\nEnd Sub\n</code></pre>\n\n<p>Now I'm getting \"Run-time error '75': Path/File access error\"</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454466277, "post_id": 35167264, "comment_id": 58053064, "body": "search and you will find <a href=\"http://stackoverflow.com/questions/16138831/getting-current-directory-in-vbscript\" title=\"getting current directory in vbscript\">stackoverflow.com/questions/16138831/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "edited": false, "score": 1, "creation_date": 1454477661, "post_id": 35167406, "comment_id": 58056384, "body": "<code>.GetAbsolutePathName(&quot;.&quot;)</code> gives the current directory not the path to the script."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "edited": false, "score": 0, "creation_date": 1454479960, "post_id": 35167406, "comment_id": 58057320, "body": "@Ekkehard.Horner true, but my assumption is the opus running the script from a command prompt so its directory <i>is</i> current"}, {"owner": {"reputation": 35, "user_id": 5875538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3408f034d3e4f12acb2ed8566cc5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5875538/ben"}, "edited": false, "score": 0, "creation_date": 1454529893, "post_id": 35167406, "comment_id": 58090256, "body": "I am running it from a batch file which is actually located one step up the file directory, however I was able to implement this code and make it work so thank you very much."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1454465979, "creation_date": 1454465979, "answer_id": 35167406, "question_id": 35167264, "link": "https://stackoverflow.com/questions/35167264/relative-paths-for-vbscript-file/35167406#35167406", "title": "Relative paths for VBScript file", "body": "<p>You can use the <code>FileSystemObject</code> to get the path to the script file, like this</p>\n\n<pre><code>Sub ExcelMacroExample()\n\n   Dim xlApp\n   Dim xlBook\n   Dim fso\n   Set fso = CreateObject(\"Scripting.FileSystemObject\")\n   Dim fullpath\n   fullpath = fso.GetAbsolutePathName(\".\")\n   Set fso = Nothing\n   Set xlApp = CreateObject(\"Excel.Application\")\n   Set xlBook = xlApp.Workbooks.Open(fullpath &amp; \"\\GeocodingStart.xlsm\")\n   xlApp.Run \"Export\"\n   xlApp.Quit\n\n   Set xlBook = Nothing\n   Set xlApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1618, "user_id": 1576463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbdbaa95e88b6a73c6bd113398817b3c?s=128&d=identicon&r=PG", "display_name": "Jakob Sternberg", "link": "https://stackoverflow.com/users/1576463/jakob-sternberg"}, "edited": false, "score": 0, "creation_date": 1525269037, "post_id": 35167458, "comment_id": 87290663, "body": "You should use this answer."}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 3, "last_activity_date": 1454466407, "creation_date": 1454466407, "answer_id": 35167458, "question_id": 35167264, "link": "https://stackoverflow.com/questions/35167264/relative-paths-for-vbscript-file/35167458#35167458", "title": "Relative paths for VBScript file", "body": "<p>Try this...</p>\n\n<pre><code>   Dim oFSO\n  Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n  sScriptDir =     oFSO.GetParentFolderName(WScript.ScriptFullName)               \n   Set xlBook = xlApp.Workbooks.Open( sScriptDir &amp;  \"\\GeocodingStart.xlsm\")     \n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5875538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3408f034d3e4f12acb2ed8566cc5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5875538/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4008, "favorite_count": 0, "accepted_answer_id": 35167406, "answer_count": 2, "score": 0, "last_activity_date": 1456448858, "creation_date": 1454465120, "last_edit_date": 1531161705, "question_id": 35167264, "link": "https://stackoverflow.com/questions/35167264/relative-paths-for-vbscript-file", "title": "Relative paths for VBScript file", "body": "<p>I have a VBScript file to open an Excel file and run a macro. This Excel file is located in the same folder as the VBScript file. I would like to use relative paths to call it, so that I can move that folder around without rewriting the paths in the script. Right now my VBScript looks like this:</p>\n\n<pre><code>    Option Explicit\n\n    On Error Resume Next\n\n    ExcelMacroExample\n\n    Sub ExcelMacroExample() \n\n      Dim xlApp \n      Dim xlBook\n\n      Set xlApp = CreateObject(\"Excel.Application\") \n      Set xlBook = xlApp.Workbooks.Open(\"C:\\Users\\Ben\\Desktop\\GeocodingBatchFile\\Files\\GeocodingStart.xlsm\") \n      xlApp.Run \"Export\"\n      xlApp.Quit \n\n      Set xlBook = Nothing \n      Set xlApp = Nothing \n\n    End Sub \n</code></pre>\n\n<p>Rather than using the full file path, it would be great if I could do something like this: </p>\n\n<pre><code>    Set xlBook = xlApp.Workbooks.Open(\".\\GeocodingStart.xlsm\") \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454465608, "post_id": 35167033, "comment_id": 58052864, "body": "That can&#39;t have been recorded. Any formula used while the macro recorder is running will use the R1C1 syntax, not A1. The recorded formula looks like this  <code>&quot;=IFERROR(IF(R[1]C[3]=&quot;&quot;Sgl&quot;&quot;,R[1]C[9],R[1]C[10]),&quot;&quot;&quot;&quot;)&quot;</code>. I think someone edited it to change the R1C1 notation to A1 and took out the &quot;extra&quot; quotes in the process."}, {"owner": {"reputation": 337, "user_id": 1719216, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2ea36f880dd879ce9663f47c36499f0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1719216/chris"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454469747, "post_id": 35167033, "comment_id": 58053986, "body": "I changed it to take out the RC as I thought that might fix it initially, but it didn&#39;t"}], "answers": [{"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 3, "last_activity_date": 1454463972, "creation_date": 1454463972, "answer_id": 35167075, "question_id": 35167033, "link": "https://stackoverflow.com/questions/35167033/excel-vba-formula-as-text-issue/35167075#35167075", "title": "Excel VBA formula as text issue", "body": "<p>I think you just need to add the extra quote at the end.  Because the quote denotes a string, you need to make two of them to yield one -- which means you need four to yield two.</p>\n\n<pre><code>Range(\"M2\").Formula = \"=IFERROR(IF(E2=\"\"Sgl\"\",K2,L2),\"\"\"\")\"\n</code></pre>\n\n<p>Other notes of interest:</p>\n\n<ul>\n<li>You don't need to <code>Range().Select</code> and then work against <code>ActiveCell</code>.  Just invoke the methods/properties directly on the Range Object</li>\n<li>I think in your case <code>Formula</code> will work.  <code>R1C1</code> is handy when the formulas are relative, but in this case, you are referencing actual cells.  There is nothing wrong with what you did, but FYI</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 337, "user_id": 1719216, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2ea36f880dd879ce9663f47c36499f0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1719216/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1454465438, "creation_date": 1454465438, "answer_id": 35167317, "question_id": 35167033, "link": "https://stackoverflow.com/questions/35167033/excel-vba-formula-as-text-issue/35167317#35167317", "title": "Excel VBA formula as text issue", "body": "<p>I fixed this by removing the IFERROR part as if there was no value in the proceeding columns it simply left it blank anyway rather than showing an error message:</p>\n\n<pre><code>Columns(\"M:P\").Select\nSelection.NumberFormat = \"General\"\nRange(\"M2\").Select\nActiveCell.FormulaR1C1 = \"=IF(RC[-8]=\"\"SGL\"\",RC[-2],RC[-1])\"\nRange(\"M2\").Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 1, "last_activity_date": 1454648273, "creation_date": 1454648273, "answer_id": 35216546, "question_id": 35167033, "link": "https://stackoverflow.com/questions/35167033/excel-vba-formula-as-text-issue/35216546#35216546", "title": "Excel VBA formula as text issue", "body": "<p>To generate the two double quotes (\"\") in IFERROR, you need to put 4 double quotes (\"\"\"\") in the vba string literal. </p>\n"}], "owner": {"reputation": 337, "user_id": 1719216, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2ea36f880dd879ce9663f47c36499f0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1719216/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3510, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1462527565, "creation_date": 1454463580, "last_edit_date": 1462527565, "question_id": 35167033, "link": "https://stackoverflow.com/questions/35167033/excel-vba-formula-as-text-issue", "title": "Excel VBA formula as text issue", "body": "<p>In my Excel 2016 VBA I have this code:</p>\n\n<pre><code>Range(\"M2\").Select\nActiveCell.FormulaR1C1 = \"=IFERROR(IF(E2=\"\"Sgl\"\",K2,L2),\"\")\"\n</code></pre>\n\n<p>when it gets placed in the cell it is the formula not the result.  To manually fix this I have to change from Text to General and also the actual code needs changing:</p>\n\n<p>Cell M2 says: <code>=IFERROR(IF(E2=\"Sgl\",K2,L2),\")</code>\nIt should say: <code>=IFERROR(IF(E2=\"Sgl\",K2,L2),\"\")</code>\nwith the extra \" at the end before the closing parenthesis</p>\n\n<p>This was recorded (I removed the RC to the absolute cell reference initially when it wouldn't work), so I'm not sure what caused this or how to resolve it.\nAny help would be appreciated.\nThanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1454462676, "post_id": 35166857, "comment_id": 58052037, "body": "Put your variables assignment in Class_Initialize().  I hope this is just a test class not a production one :)"}, {"owner": {"reputation": 79, "user_id": 2797368, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bcfac62786ca79e4730821c7dcb2e3c9?s=128&d=identicon&r=PG&f=1", "display_name": "kevincicero", "link": "https://stackoverflow.com/users/2797368/kevincicero"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 1, "creation_date": 1454477153, "post_id": 35166857, "comment_id": 58056211, "body": "this is my first foray into VBA. I usually stick with Python or PHP but the client has a specific need that VBA just works for. I&#39;m just having trouble getting my head around the syntax and setup. Thanks for your help!"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 1, "creation_date": 1454477279, "post_id": 35166857, "comment_id": 58056261, "body": "You may want to use module not class."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1454520192, "post_id": 35166857, "comment_id": 58084272, "body": "You can assign values to variables at the &quot;top level&quot; if you precede them with the keyword CONST (for &quot;constant&quot;). This means you won&#39;t be able to change the values during code execution. Example Private Const pdb_file As String = &quot;abc.xlsx&quot;. And typically Const values are written in upper case, so PDB_FILE."}, {"owner": {"reputation": 79, "user_id": 2797368, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bcfac62786ca79e4730821c7dcb2e3c9?s=128&d=identicon&r=PG&f=1", "display_name": "kevincicero", "link": "https://stackoverflow.com/users/2797368/kevincicero"}, "edited": false, "score": 0, "creation_date": 1454526459, "post_id": 35166857, "comment_id": 58088115, "body": "Thanks Cindy, that actually makes sense."}], "owner": {"reputation": 79, "user_id": 2797368, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bcfac62786ca79e4730821c7dcb2e3c9?s=128&d=identicon&r=PG&f=1", "display_name": "kevincicero", "link": "https://stackoverflow.com/users/2797368/kevincicero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 616, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1454465229, "creation_date": 1454462415, "last_edit_date": 1454465229, "question_id": 35166857, "link": "https://stackoverflow.com/questions/35166857/vba-class-with-static-variables", "title": "VBA Class with Static Variables", "body": "<p>I'm running into an issue. I'm trying to define a couple variables that are used in several methods in a class module. </p>\n\n<p>I keep getting an <code>invalid outside procedure</code> error. <br><br>\nCan anyone point me in the right direction? I feel like it is a scope issue but, I'm unsure on how to validate this.</p>\n\n<pre><code>' class file_ops\n' attributes\n\nPrivate pdb_file As String\nPrivate pdb_path As String\n\npdb_file = \"db.xlsx\"\npdb_path = ThisWorkbook.Path + \"\\\"\n\nPublic Sub open_db(pdb_file, pdb_path)\n\n    Workbooks.Open Filename:=pdb_path + pdb_file\n\nEnd Sub\n\nPublic Sub close_db(pdb_file)\n\n    pdb_file.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "filter", "pivot-table"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454468876, "post_id": 35166799, "comment_id": 58053735, "body": "have you considered looping through all pivot tables on the sheet?"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454468938, "post_id": 35166799, "comment_id": 58053758, "body": "somehow I&#39;ve managed to never use loops before could you elaborate a little?"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1454508712, "post_id": 35167865, "comment_id": 58075577, "body": "this code partially works however for some reason, certain pivot tables throw and error at <code>pt.PivotFields(&quot;count&quot;).ClearAllFilters</code> and others at <code>pt.PivotFields(&quot;count&quot;).ShowAllItems = True</code>. runtime 1004 unable to get the PivotFeilds property of the PivotTable class."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1454469298, "creation_date": 1454469298, "answer_id": 35167865, "question_id": 35166799, "link": "https://stackoverflow.com/questions/35166799/excel-2010-vba-pivot-table-report-filter-update/35167865#35167865", "title": "excel 2010 vba pivot table report filter update", "body": "<p>Something along the lines of (not tested, just typed into here)</p>\n\n<pre><code>    dim ws as Worksheet\n    set ws = ThisWorkbook.Worksheets(\"Analytics Admin\")\n    dim pt as PivotTable\n        For Each pt In ws.PivotTables\n'            Debug.Print Pivot.Name\n            pt.PivotFields(\"count\").ClearAllFilters\n            pt.PivotFields(\"count\").ShowAllItems = True\n\n            With pt.PivotFields(\"count\")\n              .PivotItems(\"0\").Visible = False\n              .PivotItems(\"(blank)\").Visible = False\n            End With\n            pt.PivotCache.Refresh\n            pt.refreshTable\n            pt.Update\n        Next\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1454508523, "post_id": 35172992, "comment_id": 58075458, "body": "I like this idea. I am using 2010 but so far I&#39;ve only been able to connect 2 pivot tables and that was mostly by accident. I cannot seem to connect all the tables on the page thru any means."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1454521395, "post_id": 35172992, "comment_id": 58085076, "body": "I forgot to mention that Slicers can only be connected to PivotTables that share the same PivotCache (i.e. they share the exact same data source). I&#39;ll add that to my answer. If <i>most</i> of your pivots do share the same data source, add the slicer to one of those, connect it to the others, and then use code to sync one of those to pivots on other caches. Otherwise, Teylyn&#39;s code will be the best way to go."}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1454531021, "post_id": 35172992, "comment_id": 58090947, "body": "ok that makes sense, the slicer that did have multiple pivots was on the one pivot table using dummy data from another data set. I will try and merge the source data, and give this another go"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1454521482, "last_edit_date": 1454521482, "creation_date": 1454491495, "answer_id": 35172992, "question_id": 35166799, "link": "https://stackoverflow.com/questions/35166799/excel-2010-vba-pivot-table-report-filter-update/35172992#35172992", "title": "excel 2010 vba pivot table report filter update", "body": "<p>If you have Excel 2010 or later, and most (hopefully all) of these Pivots share the exact same data source, you can do this with little or no looping. Simply set up a Slicer on the \"count\" field and then connect it to all the PivotTables (right click on the Slicer, and select \"Report Connections\". Then you only need to run the code on one of those PivotTables, and all the others will update automatically.</p>\n\n<p>You can hide the Slicer somewhere if you don't want users to click it.</p>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1059, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454521482, "creation_date": 1454462016, "question_id": 35166799, "link": "https://stackoverflow.com/questions/35166799/excel-2010-vba-pivot-table-report-filter-update", "title": "excel 2010 vba pivot table report filter update", "body": "<p>I have 16 pivot tables on the same sheet, \"Analytics Admin\", I recorded and cleaned up the macro below (the code right before updates the info the pivot tables source). It's basically the same code 16 times, the only thing that changes is the pivot table name ( MSP, MSP30, FSP, FSP30, etc). Is it possible to change the report filter for all the pivot tables at once?    </p>\n\n<pre><code>Worksheets(\"Analytics Admin\").Activate\n\n'refreshes all data, clears all filters then filters 0 and blanks out of all custom range pareto pivot tables\n\nActiveSheet.PivotTables(\"MSP\").PivotCache.Refresh\n    ActiveSheet.PivotTables(\"MSP\").PivotFields(\"count\").ClearAllFilters\n    ActiveSheet.PivotTables(\"MSP\").PivotFields(\"count\").ShowAllItems = True\n\n    With ActiveSheet.PivotTables(\"MSP\").PivotFields(\"count\")\n        .PivotItems(\"0\").Visible = False\n        .PivotItems(\"(blank)\").Visible = False\n    End With\n    ActiveSheet.PivotTables(\"MSP\").PivotCache.Refresh\n\nActiveSheet.PivotTables(\"FSP\").PivotCache.Refresh\n    ActiveSheet.PivotTables(\"FSP\").PivotFields(\"count\").ClearAllFilters\n    ActiveSheet.PivotTables(\"FSP\").PivotFields(\"count\").ShowAllItems = True\n\n    With ActiveSheet.PivotTables(\"FSP\").PivotFields(\"count\")\n        .PivotItems(\"0\").Visible = False\n        .PivotItems(\"(blank)\").Visible = False\n    End With\n    ActiveSheet.PivotTables(\"FSP\").PivotCache.Refresh\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454462929, "post_id": 35166782, "comment_id": 58052101, "body": "Did you step through the code and check what it does? Once you get to a point where you think it should do something and it doesn&#39;t, did you check the variables? Which line is the problem?"}, {"owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454463835, "post_id": 35166782, "comment_id": 58052362, "body": "Yes.It seems like never go through the steps for the command below:erow = Range(&quot;C&quot; &amp; Rows.Count).End(xlUp).Row + 1         SheetB.Range(&quot;A&quot; &amp; j &amp; &quot;:C&quot; &amp; j).Copy Destination:=SheetA.Range(&quot;C&quot; &amp; erow &amp; &quot;:E&quot; &amp; erow)"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454464135, "post_id": 35166782, "comment_id": 58052438, "body": "When you step through, do you realize why not? What is the value of the match variable at that time? When was the variable last set? Do you see where it goes wrong? The variable is still TRUE. Do you see why?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1454465637, "post_id": 35167083, "comment_id": 58052873, "body": "Hi teylyn, thank you very much. Your code runs and give results. However, it only copies the last row from fortest.xlsx to the 8th rows but not all other non-matched values. What I want to achieve is if the column D in fortest1.xlsx with column F in tested.xlsm are matched, then do nothing. If they are not matched, then copy Column A to C in fortest.xlsx to Column C to E in tested.xlsm."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1454466007, "post_id": 35167083, "comment_id": 58052973, "body": "Not when I run it. It copies rows 2 to 7 in the first i loop, and row 1 and 3 to 7 in the second i loop. I typed the data from your screenshot exactly and that is what I expect the code to do. I realize that is not what you want. Get your logic straightened out and untangle the loops. Step through and think about every step. I think the outer loop should go through fortest and the inner loop through tested, but that&#39;s just a haunch. You need to define the business logic. Then pretend you are a computer and look at each row of code and determine what to do."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1454464017, "creation_date": 1454464017, "answer_id": 35167083, "question_id": 35166782, "link": "https://stackoverflow.com/questions/35166782/how-to-compare-columns-for-unique-data-between-two-workbooks/35167083#35167083", "title": "How to compare columns for unique data between two workbooks", "body": "<p>I'm not quite sure I understand what you really want to achieve, but the code has several problems. </p>\n\n<p>Proper indenting is one of the issues. It is not obvious at first glance how the code is nested. </p>\n\n<ul>\n<li>when the comparison is not true, the match variable is not reset to false, so it still shows as True. Fix: move <code>match = False</code> into the j loop, so it is set to False at the beginning of the j loop</li>\n<li>The match variable is set and then overwritten seven times in the j loop before it is evaluated and something is done with it. </li>\n</ul>\n\n<p>The suggestions above applied to the code result in this:</p>\n\n<pre><code>For i = 1 To eRowA\n    Set r1 = SheetA.Range(\"F\" &amp; i)\n'    match = False ' move this into the j loop\n    For j = 1 To eRowB\n        match = False\n        Set r2 = SheetB.Range(\"D\" &amp; j)\n        If r1 = r2 Then\n            match = True\n        End If\n'        Next j   ' this loops too early and overwrites the match variable\n        If Not match Then\n            erow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\n            SheetB.Range(\"A\" &amp; j &amp; \":C\" &amp; j).Copy Destination:=SheetA.Range(\"C\" &amp; erow &amp; \":E\" &amp; erow)\n        End If\n    Next j\nNext i\n</code></pre>\n\n<p>The code now runs through the i loop twice and in each i loop runs through the j loop seven times. If that is not what you want to achieve, pipe up.</p>\n"}], "owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454464017, "creation_date": 1454461903, "last_edit_date": 1531164843, "question_id": 35166782, "link": "https://stackoverflow.com/questions/35166782/how-to-compare-columns-for-unique-data-between-two-workbooks", "title": "How to compare columns for unique data between two workbooks", "body": "<p>I want to compare data from column D in fortest1.xlsx with column F in tested.xlsm. If they are matched, then do nothing. If they are not matched, then copy Column A to C in fortest.xlsx to Column C to E in tested.xlsm. May I know how can I achieve this? My code is running without error, however, it doesn't generate any result.</p>\n\n<p>Thanks in advanced.</p>\n\n<pre><code>Sub test()\n</code></pre>\n\n<p>'Application.ScreenUpdating = True\n    Dim WbA As Workbook\n    Set WbA = thisworkbook</p>\n\n<pre><code>Dim WbB As Workbook\nSet WbB = Workbooks.Open(Filename:=\"C:\\Users\\maggie\\Desktop\\fortest1.xlsx\")\n\nDim SheetA As Worksheet\nDim SheetB As Worksheet\nSet SheetA = WbA.Sheets(\"up\")\nSet SheetB = WbB.Sheets(\"up\")\n\nDim eRowA As Integer\nDim eRowB As Integer\neRowA = SheetA.Range(\"F\" &amp; Rows.Count).End(xlUp).Row 'Last line with data in Workbook A (ActiveWorkbook)\neRowB = SheetB.Range(\"D\" &amp; Rows.Count).End(xlUp).Row  'Last line with data in Workbook B (Opened Workbook)\n\nDim match As Boolean\nDim erow As Long\nDim i, j As Long\nDim r1, r2 As Range\nFor i = 1 To eRowA\n    Set r1 = SheetA.Range(\"F\" &amp; i)\n    match = False\n    For j = 1 To eRowB\n        Set r2 = SheetB.Range(\"D\" &amp; j)\n        If r1 = r2 Then\n            match = True\n        End If\n        Next j\n        If Not match Then\n        erow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\n        SheetB.Range(\"A\" &amp; j &amp; \":C\" &amp; j).Copy Destination:=SheetA.Range(\"C\" &amp; erow &amp; \":E\" &amp; erow)\nEnd If\nNext i\nWbB.Close (False)\n</code></pre>\n\n<p>End Sub\n<a href=\"http://i.stack.imgur.com/SAEl4.jpg\" rel=\"nofollow\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1454486885, "post_id": 35165990, "comment_id": 58060572, "body": "Could you please share your code.."}, {"owner": {"reputation": 949, "user_id": 5807922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-64uvAcnDdQ0/AAAAAAAAAAI/AAAAAAAAACo/pHFh1EE9yNQ/photo.jpg?sz=128", "display_name": "Suraj Nagabhushana Ponnaganti", "link": "https://stackoverflow.com/users/5807922/suraj-nagabhushana-ponnaganti"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1454590835, "post_id": 35165990, "comment_id": 58119182, "body": "SolverReset          SolverOk SetCell:=&quot;$B$18&quot;, MaxMinVal:=2, ValueOf:=0, _     ByChange:=&quot;$M$5:$T$12&quot;, Engine:=2, EngineDesc:=&quot;Simplex LP&quot;          SolverAdd CellRef:=&quot;$U$5:$U$12&quot;, Relation:=1, FormulaText:=&quot;$V$5:$V$12&quot;          SolverAdd CellRef:=&quot;$M$13:$T$13&quot;, Relation:=2, FormulaText:=&quot;$M$14:$T$14&quot;     SolverSolve"}], "answers": [{"comments": [{"owner": {"reputation": 949, "user_id": 5807922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-64uvAcnDdQ0/AAAAAAAAAAI/AAAAAAAAACo/pHFh1EE9yNQ/photo.jpg?sz=128", "display_name": "Suraj Nagabhushana Ponnaganti", "link": "https://stackoverflow.com/users/5807922/suraj-nagabhushana-ponnaganti"}, "edited": false, "score": 0, "creation_date": 1454681815, "post_id": 35202559, "comment_id": 58167052, "body": "Thank you for your reply. Great advice!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1454593168, "creation_date": 1454593168, "answer_id": 35202559, "question_id": 35165990, "link": "https://stackoverflow.com/questions/35165990/vba-solver-code-issue/35202559#35202559", "title": "VBA Solver code issue", "body": "<p>The <a href=\"http://www.solver.com/excel-solver-solversolve-function\" rel=\"nofollow\">documentation</a> at Solver.com (the website of the company that made the Solver add-in) contains:</p>\n\n<blockquote>\n  <p>SolverSolve(UserFinish, ShowRef)</p>\n  \n  <p>UserFinish   Optional Variant. True to return the results without\n  displaying the Solver Results dialog box. False or omitted to return\n  the results and display the Solver Results dialog box.</p>\n  \n  <p>ShowRef   Optional Variant. You can pass the name of a macro (as a\n  string) as the ShowRef argument. This macro is then called, in lieu of\n  displaying the Show Trial Solution dialog box, whenever Solver pauses\n  for any of the reasons listed below.</p>\n</blockquote>\n\n<p>Thus it seems that you need to replace the line <code>SolverSolve</code> by</p>\n\n<pre><code>SolverSolve True\n</code></pre>\n\n<p>But -- it is probably a better idea to read the rest of the documentation about the return value of <code>SolverSolve</code> and perhaps do something like</p>\n\n<pre><code>retValue = SolverSolve(True)\n</code></pre>\n\n<p>and then check <code>retValue</code> with some error-handling if it isn't one of the values which correspond to a successful run. People can be optimistic. Code should be pessimistic. </p>\n"}], "owner": {"reputation": 949, "user_id": 5807922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-64uvAcnDdQ0/AAAAAAAAAAI/AAAAAAAAACo/pHFh1EE9yNQ/photo.jpg?sz=128", "display_name": "Suraj Nagabhushana Ponnaganti", "link": "https://stackoverflow.com/users/5807922/suraj-nagabhushana-ponnaganti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 637, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454593168, "creation_date": 1454456720, "last_edit_date": 1454590866, "question_id": 35165990, "link": "https://stackoverflow.com/questions/35165990/vba-solver-code-issue", "title": "VBA Solver code issue", "body": "<p>I am currently using a loop is which I access the excel solver. But every time the solver solves an optimization problem, I have to click ok. I tried record macro, but no code came up when I click the OK button. I will always accept the solution suggested by the solver.I do not want to keep pressing Ok button all the time. There could potentially be 2000+ optimization problems being solved. Is there a way of making this work?</p>\n\n<p>Also, is there a way of solving unbalanced transportation problem is a solver without having to make dummy supplies or demand nodes?</p>\n\n<p>Thank you.</p>\n\n<p>The codes is as follows:\nSolverReset</p>\n\n<pre><code>SolverOk SetCell:=\"$B$18\", MaxMinVal:=2, ValueOf:=0, _\nByChange:=\"$M$5:$T$12\", Engine:=2, EngineDesc:=\"Simplex LP\"\n\nSolverAdd CellRef:=\"$U$5:$U$12\", Relation:=1, FormulaText:=\"$V$5:$V$12\"\n\nSolverAdd CellRef:=\"$M$13:$T$13\", Relation:=2, FormulaText:=\"$M$14:$T$14\"\nSolverSolve\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1454455023, "post_id": 35165613, "comment_id": 58049705, "body": "Look up loops and if statements."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5870116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3397487a9f4670d181481fdc381b5c23?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Deangelo", "link": "https://stackoverflow.com/users/5870116/shay-deangelo"}, "edited": false, "score": 0, "creation_date": 1454511475, "post_id": 35165859, "comment_id": 58077703, "body": "Thanks! That is grabbing the blocks but I cannot figure out how to copy each block to its own unique destination on sheet 2. For example, I would like the first block to go to B13 and the second to go to B28 on sheet 2. Any advice?"}, {"owner": {"reputation": 906, "user_id": 2485248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IzdaY.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/2485248/roland"}, "reply_to_user": {"reputation": 5, "user_id": 5870116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3397487a9f4670d181481fdc381b5c23?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Deangelo", "link": "https://stackoverflow.com/users/5870116/shay-deangelo"}, "edited": false, "score": 0, "creation_date": 1454843960, "post_id": 35165859, "comment_id": 58218108, "body": "Judging from your example, the destination address is the same as the source address - only on another sheet. Why not just copy the whole columns instead of grabbing blocks"}, {"owner": {"reputation": 5, "user_id": 5870116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3397487a9f4670d181481fdc381b5c23?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Deangelo", "link": "https://stackoverflow.com/users/5870116/shay-deangelo"}, "edited": false, "score": 0, "creation_date": 1455055229, "post_id": 35165859, "comment_id": 58316410, "body": "The destination cells on the second sheet will always be B13, B31, B45, and B53. This is due to the headers above these cells. There is enough space to accommodate any of the blocks from the data sets and then the extra rows are set to delete."}, {"owner": {"reputation": 906, "user_id": 2485248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IzdaY.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/2485248/roland"}, "reply_to_user": {"reputation": 5, "user_id": 5870116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3397487a9f4670d181481fdc381b5c23?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Deangelo", "link": "https://stackoverflow.com/users/5870116/shay-deangelo"}, "edited": false, "score": 0, "creation_date": 1455132871, "post_id": 35165859, "comment_id": 58357415, "body": "You could store the mapping in a Dictionary Object with the key being an increment. As you grab the blocks, you increment a counter and look up the destination with the help of a function. On the other hand, you could also store the mapping in a separate worksheet."}, {"owner": {"reputation": 5, "user_id": 5870116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3397487a9f4670d181481fdc381b5c23?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Deangelo", "link": "https://stackoverflow.com/users/5870116/shay-deangelo"}, "edited": false, "score": 0, "creation_date": 1455206139, "post_id": 35165859, "comment_id": 58395180, "body": "I was able to use the first loop and then repeat it with four if statements. Thanks so much for you help!                                                                                                            <code>If cFirst &lt;&gt; &quot;&quot; Then           Do While Not cLast.Offset(1, 0) = &quot;&quot;         Set cLast = cLast.Offset(1, 0)     Loop          Range(cFirst.Address &amp; &quot;:&quot; &amp; cLast.Address).Copy Destination:=Sheets(&quot;Sheet 2&quot;).Range(&quot;B13&quot;)      End If  Set cFirst = cLast.Offset(3, 0) Set cLast = cFirst</code> (repeat for next cell destination)"}], "tags": [], "owner": {"reputation": 906, "user_id": 2485248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IzdaY.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/2485248/roland"}, "is_accepted": true, "score": 0, "last_activity_date": 1454456052, "creation_date": 1454456052, "answer_id": 35165859, "question_id": 35165613, "link": "https://stackoverflow.com/questions/35165613/excel-vba-how-to-copy-and-paste-groups-of-data-following-blank-cells/35165859#35165859", "title": "Excel VBA - How to copy and paste groups of data following blank cells?", "body": "<p>If you know the pattern of blocks (block - 2 spaces - block) you can do a nested loop.</p>\n\n<pre><code>Sub grabBlocks()\n\nDim cFirst As Range, cLast As Range\nDim sh As Worksheet\n\nSet sh = ThisWorkbook.Sheets(1)\nSet cFirst = sh.Range(\"B6\") 'First Cell of each new block\nSet cLast = cFirst 'This becomes last cell of the block\n\nDo While Not cFirst = \"\"\n\n    'Get Last Cell of Block\n    Do While Not cLast.Offset(1, 0) = \"\"\n        Set cLast = cLast.Offset(1, 0)\n    Loop\n\n    'Do copy with this address\n    Debug.Print Range(cFirst.Address &amp; \":\" &amp; cLast.Address).Address\n    '... copy code goes here...\n\n    'Go to next block\n    Set cFirst = cLast.Offset(3, 0) 'First cell of new block is 2 + 1 cells below the last\n    Set cLast = cFirst\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>This code will terminate when the next block is more than 2 cells away, expecting no more blocks to come.</p>\n\n<p>Beware that these loops can become nasty if your termination condition can not be satisfied (e.g. your cells contain 'invisible' data like spaces)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5874202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dd2ab86c0cfbcc695ffee958a31d8e?s=128&d=identicon&r=PG&f=1", "display_name": "M. Bonini", "link": "https://stackoverflow.com/users/5874202/m-bonini"}, "is_accepted": false, "score": 0, "last_activity_date": 1454457108, "creation_date": 1454457108, "answer_id": 35166058, "question_id": 35165613, "link": "https://stackoverflow.com/questions/35165613/excel-vba-how-to-copy-and-paste-groups-of-data-following-blank-cells/35166058#35166058", "title": "Excel VBA - How to copy and paste groups of data following blank cells?", "body": "<pre><code>Sub copynPaste()\nDim i As Integer, j As Integer\nj = 1\n   'loops from 1 to the last filled cell in column 2 or \"B\"\n    For i = 1 To Sheets(\"Sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\n       'checks if the cell has anything in it\n        If IsEmpty(Sheets(\"Sheet1\").Range(\"B\" &amp; i)) = False Then\n            'this is where the copying and pasting happens (well basically)\n            Sheets(\"Sheet2\").Range(\"B\" &amp; j).Value = Sheets(\"Sheet1\").Range(\"B\" &amp; i).Value\n            Sheets(\"Sheet2\").Range(\"M\" &amp; j).Value = Sheets(\"Sheet1\").Range(\"M\" &amp; i).Value\n            j = j + 1\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5870116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3397487a9f4670d181481fdc381b5c23?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Deangelo", "link": "https://stackoverflow.com/users/5870116/shay-deangelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 35165859, "answer_count": 2, "score": 0, "last_activity_date": 1454457108, "creation_date": 1454454762, "question_id": 35165613, "link": "https://stackoverflow.com/questions/35165613/excel-vba-how-to-copy-and-paste-groups-of-data-following-blank-cells", "title": "Excel VBA - How to copy and paste groups of data following blank cells?", "body": "<p>I have data in B6 and M6 that correspond directly with each other. The data goes from B6:B12 and then there are two blank cells in B13:B14. The data then goes on from B15:B23 and then there are two blank cells and this pattern repeats down the page...(the same goes for column M).</p>\n\n<p>I researched finding blank cells and was able to use this code to grab that first set of data from B6:B12 and M6:M12 and paste it on to a new worksheet in the location I wanted. Here is the code:</p>\n\n<pre><code>Sub CopyandPaste()\n\nNextFree = Range(\"B6:B\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\nRange(\"B\" &amp; NextFree).Select\n\nNextFree2 = Range(\"M6:M\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\nRange(\"M\" &amp; NextFree2).Select\n\nSheets(\"Sheet 1\").Range(\"B6:B\" &amp; NextFree).Copy Destination:=Sheets(\"Sheet 2\").Range(\"B13\")\n\nSheets(\"Sheet 1\").Range(\"M6:M\" &amp; NextFree2).Copy Destination:=Sheets(\"Sheet 2\").Range(\"J13\")\n\nEnd Sub\n</code></pre>\n\n<p>This works to grab the first group before the blank the two blank cells but I cannot find a way to grab the second, third, and so on groups that follow two blank cells. Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "bloomberg"], "answers": [{"tags": [], "owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "is_accepted": false, "score": 1, "last_activity_date": 1454489030, "creation_date": 1454489030, "answer_id": 35172161, "question_id": 35165434, "link": "https://stackoverflow.com/questions/35165434/update-bloomberg-api-static-data/35172161#35172161", "title": "Update Bloomberg API static data", "body": "<p>Ah, Bloomberg API... many an issue.</p>\n\n<p>So, when you do a Bloomberg request using a function call, the cell call site receives a call back and refreshes the data. </p>\n\n<p><strong>The problem is, w.r.t. automation, the data can come back in parts and you have to wait till it completes before continuing to process your data.</strong></p>\n\n<p>So, there are 3 approaches to this solution.</p>\n\n<ol>\n<li>Last time I looked, this is the one that Bloomberg recommends. Have a routine that refreshes the call to the cell formula. <strong>This has a timer and recursively invokes itself</strong> until the data has been retrieved. The trick to this is to know when the data has been retrieved correctly. The data area is checked for errors which say it hasn't been completed yet. </li>\n<li>The other solution is to invoke the call using Application.Run where you build the formula in code and invoke with VBA. This allows you to not deal with functions as such in the worksheet. But is effectively the same thing as 1.</li>\n<li>You can set a reference to the Bloomberg API and use COM to do the request. This is a much cleaner approach and you can easier integrate this into your code effectively creating a Bloomberg data call API.</li>\n</ol>\n\n<p>I would suggest, if possible going for option 3. Although a little more effort, te code becomes much cleaner. Options 1. and 2. can be tricky to debug when your workbooks become more complex in terms of structure etc.</p>\n\n<p>If you search your Bloomberg help (the ever tremendous old 'F1 F1' help service should be able to point you in the right direction. Simply the most impressive help system ever done in my opinion!) Bloomberg does have some examples which demonstrate the methods highlighted above.</p>\n\n<p>So, with the issue at hand and to finally answer your question :)\nI would restructure your code to actually do function call that initially does a Calcuation (which will invoke your requests to Bloomberg). Then enter into a recursive function which calls itself until there are no errors in the data. After this you then copy your data.</p>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 195, "user_id": 2808362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/898b092580422b0b16bf4690301262f4?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie", "link": "https://stackoverflow.com/users/2808362/eddie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454489030, "creation_date": 1454453966, "last_edit_date": 1454459531, "question_id": 35165434, "link": "https://stackoverflow.com/questions/35165434/update-bloomberg-api-static-data", "title": "Update Bloomberg API static data", "body": "<p>I want to copy and paste data from one sheet to another sheet. The original data is from Bloomberg API function. I found the Bloomberg data cell only updates after the macro finishes running. I tried to build a private function to let the static data update before I copy it. Here is my code:</p>\n\n<pre><code>Private Sub ProcesData()\n\nApplication.Run\n\nCall Application.OnTime(Now + TimeValue(\"00:00:01\"), \"ProcessData\")\n\nEnd Sub\n\n\nSub Macro3()\n\nDim i As Integer\ni = 1\n\nDo Until i &gt; 2\n    Sheets(\"Sheet1\").Activate\n\n    Cells(1, 3).Value = Cells(i, 1)\n\n    i = i + 1\n\n    Call Application.OnTime(Now + TimeValue(\"00:00:01\"), \"ProcessData\")\n\n    Range(\"C4:E181\").Select\n\n    Selection.Copy\n\n    Sheets(\"Sheet2\").Select\n    Range(\"A1\").Select\n    lMaxRows = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Range(\"A\" &amp; lMaxRows + 1).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 2, "creation_date": 1454454115, "post_id": 35165290, "comment_id": 58049391, "body": "What have you tried? Why VBA? Why not use the Remove duplicates command? Why not use the macro recorder while using that command? This is not a code writing service."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1454454338, "post_id": 35165290, "comment_id": 58049488, "body": "Isn&#39;t <code>468.00</code> the latest for <code>10060</code>?"}, {"owner": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1454515901, "post_id": 35165290, "comment_id": 58081034, "body": "@findwindow You are right. Sorry about that."}, {"owner": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454517024, "post_id": 35165290, "comment_id": 58081952, "body": "@teylyn I sorted by Dates, from newest to oldest, I then used Remove duplicates command. I think it automatically keep the first one, which is the newest one! Please forgive my ignorance. I never used the Remove Duplicates command before and do not know Excel can do that. I am glad I learned something new! BTW, I do not use &quot;macro recorder while using that command&quot;, can you give some hint on that? Thank you so much."}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "is_accepted": false, "score": 0, "last_activity_date": 1454531506, "creation_date": 1454531506, "answer_id": 35187117, "question_id": 35165290, "link": "https://stackoverflow.com/questions/35165290/how-to-select-rows-with-duplicate-content-with-criteria-in-excel/35187117#35187117", "title": "how to select rows with duplicate content with criteria in excel?", "body": "<p>I sorted by Dates, from newest to oldest, I then used Remove duplicates command. I think it automatically keep the first one, which is the newest one</p>\n"}], "owner": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1454531506, "creation_date": 1454453246, "last_edit_date": 1454515870, "question_id": 35165290, "link": "https://stackoverflow.com/questions/35165290/how-to-select-rows-with-duplicate-content-with-criteria-in-excel", "title": "how to select rows with duplicate content with criteria in excel?", "body": "<p>As you can see in the Data table, the ID is not unique, I would like to select the unique ID and Value with the latest date. The results looks like the Results table. Can anyone provide some VBA codes in excel to help with? Any help will be greatly appreciated. </p>\n\n<p>Data Table  </p>\n\n<pre><code>ID      Dates       Value  \n10021   1/1/2012    591.00  \n10021   1/1/2014    591.00  \n10021   8/1/2015    621.00  \n10060   1/1/2006    240.00  \n10060   1/1/2011    385.00  \n10060   1/1/2014    446.00  \n10060   8/1/2015    468.00  \n10061   1/1/2006    501.00  \n10061   1/1/2011    658.00  \n10061   1/1/2014    796.00  \n10061   8/1/2015    836.00  \n</code></pre>\n\n<p>Results Table  </p>\n\n<pre><code>ID  Dates   Value  \n10021   8/1/2015    621.00  \n10060   1/1/2014    468.00  \n10061   8/1/2015    836.00 \n</code></pre>\n"}, {"tags": ["excel", "imacros", "vba"], "answers": [{"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454454677, "post_id": 35165313, "comment_id": 58049601, "body": "that copies only cell contents, no formatting, no named ranges, no column width, etc."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454454933, "post_id": 35165313, "comment_id": 58049678, "body": "So substitute <code>usedrange</code> with <code>range(&quot;A1:Z10&quot;)</code> or whatever the used range is. Or find last row and last column first then plug those in. OP didn&#39;t really show much effort so I am not going to expend much on my end."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454455080, "post_id": 35165313, "comment_id": 58049727, "body": "The point is that copying a range is different to copying a sheet."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454455297, "post_id": 35165313, "comment_id": 58049795, "body": "Technically sure. Materialistically, there&#39;s a difference?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1454455768, "post_id": 35165313, "comment_id": 58049955, "body": "Yes. Formatting like column width, range names, formulas referencing sheets in the original workbook, none of these survive a range copy but will survive a sheet copy."}, {"owner": {"reputation": 5, "user_id": 4830308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0a16a9bb5b85faf2286a3e3b26e201?s=128&d=identicon&r=PG&f=1", "display_name": "Bonan Zhang", "link": "https://stackoverflow.com/users/4830308/bonan-zhang"}, "edited": false, "score": 0, "creation_date": 1454530254, "post_id": 35165313, "comment_id": 58090485, "body": "@findwindow ha! this works! i imagine i can further replace usedrange with the lastcolumn and lastrow type of things. This is definitely really helpful! though i lost my formatting, it&#39;s much better than dealing with deleting a sheet or add a new line to select to my current sheet for my own preference in this case. Thank you for your help!"}, {"owner": {"reputation": 5, "user_id": 4830308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0a16a9bb5b85faf2286a3e3b26e201?s=128&d=identicon&r=PG&f=1", "display_name": "Bonan Zhang", "link": "https://stackoverflow.com/users/4830308/bonan-zhang"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1454530358, "post_id": 35165313, "comment_id": 58090542, "body": "@teylyn    you are totally right it. but i guess for my own purpose this solution works well enough."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": true, "score": 1, "last_activity_date": 1454453394, "creation_date": 1454453394, "answer_id": 35165313, "question_id": 35165259, "link": "https://stackoverflow.com/questions/35165259/how-to-copy-sheets-to-another-specific-workbook-using-vba/35165313#35165313", "title": "How to copy sheets to another *specific* workbook using vba?", "body": "<p>Have you tried?</p>\n\n<pre><code>wb.WorkSheets(1).UsedRange.Copy activeWB.WorkSheets(\"Sheet1\").Range(\"A1\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 4830308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0a16a9bb5b85faf2286a3e3b26e201?s=128&d=identicon&r=PG&f=1", "display_name": "Bonan Zhang", "link": "https://stackoverflow.com/users/4830308/bonan-zhang"}, "edited": false, "score": 0, "creation_date": 1454530461, "post_id": 35165664, "comment_id": 58090595, "body": "this is definitely a good alternative! for this project i have, i don&#39;t require much as of formatting. but for other projects, this method is definitely the go to solution! Thank you @teylyn!"}, {"owner": {"reputation": 5, "user_id": 4830308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0a16a9bb5b85faf2286a3e3b26e201?s=128&d=identicon&r=PG&f=1", "display_name": "Bonan Zhang", "link": "https://stackoverflow.com/users/4830308/bonan-zhang"}, "edited": false, "score": 0, "creation_date": 1454530964, "post_id": 35165664, "comment_id": 58090899, "body": "i wish i could give 2 upvotes. both are really good solutions to solve my problem."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1454455042, "creation_date": 1454455042, "answer_id": 35165664, "question_id": 35165259, "link": "https://stackoverflow.com/questions/35165259/how-to-copy-sheets-to-another-specific-workbook-using-vba/35165664#35165664", "title": "How to copy sheets to another *specific* workbook using vba?", "body": "<p>Don't overthink this. Copy the sheet. Delete the existing Sheet1. Rename the copied sheet to Sheet1</p>\n\n<pre><code>wb.Worksheets(1).Copy Before:=activeWB.Worksheets(1)\nApplication.DisplayAlerts = False\nactiveWB.Worksheets(\"Sheet1\").Delete\nApplication.DisplayAlerts = True\nactiveWB.Worksheets(1).Name = \"Sheet1\"\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4830308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0a16a9bb5b85faf2286a3e3b26e201?s=128&d=identicon&r=PG&f=1", "display_name": "Bonan Zhang", "link": "https://stackoverflow.com/users/4830308/bonan-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4683, "favorite_count": 1, "accepted_answer_id": 35165313, "answer_count": 2, "score": 0, "last_activity_date": 1454455042, "creation_date": 1454453115, "last_edit_date": 1531164843, "question_id": 35165259, "link": "https://stackoverflow.com/questions/35165259/how-to-copy-sheets-to-another-specific-workbook-using-vba", "title": "How to copy sheets to another *specific* workbook using vba?", "body": "<p>So I know the answer to the question How to copy sheets to another  workbook using vba? And here is the code I used: </p>\n\n<pre><code>    wb.Worksheets(1).Copy Before:=activeWB.Worksheets(\"Sheet1\")\n</code></pre>\n\n<p>So from this workbook called \"wb\", I copy the worksheet within \"wb\" to a new workbook called\"activeWB\". The before function place this sheet in front of \"Sheet1\".</p>\n\n<p>However, I want to place the sheet from \"Wb\" to \"Sheet1\", not before or after it. I tried many many methods, but couldn't get this to work. :( </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 238, "user_id": 6822528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9qdwoKJelAI/AAAAAAAAAAI/AAAAAAAAADY/n0BjP2CuCZQ/photo.jpg?sz=128", "display_name": "Malan Kriel", "link": "https://stackoverflow.com/users/6822528/malan-kriel"}, "edited": false, "score": 0, "creation_date": 1591627398, "post_id": 41105927, "comment_id": 110120190, "body": "I get the same error when my function is returning a user-defined class (not a string). The above fixed it for me too!"}], "tags": [], "owner": {"reputation": 46, "user_id": 7286270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2fa13feaf5909b302c3908a754afaa9?s=128&d=identicon&r=PG", "display_name": "llugn", "link": "https://stackoverflow.com/users/7286270/llugn"}, "is_accepted": true, "score": 3, "last_activity_date": 1481562413, "creation_date": 1481562413, "answer_id": 41105927, "question_id": 35165094, "link": "https://stackoverflow.com/questions/35165094/vba-excel-step-over-debug-and-crash-down-with-application-run/41105927#41105927", "title": "VBA (Excel): Step Over debug and crash down with application.run", "body": "<p>I have been experiencing the same problem you mentioned and I tested creating an Application object to do the Run method, which solved the crash.</p>\n\n<p>An example:</p>\n\n<pre><code>Function AddSpace(val1) As String\n    AddSpace = val1 &amp; \" \"\nEnd Function\n\nSub TestRunAnotherFunction()\n    Dim result, o\n    Set o = Application()\n    result = o.Run(\"AddSpace\", \"One\")\n    result = result &amp; \"detail\"\nEnd Sub\n</code></pre>\n\n<p>But I was not satisfied and wanted to figure out why this was happening in both Excel 2013 and 2016. What I found was if you explicitly set a function to return a <strong>String</strong>, Excel will crash when you either Reset while in that function or an error is thrown in there (provided you do not utilise the Application object methodology above).</p>\n\n<p>Coders more hard-core than me might be able to elaborate more thoroughly on what is happening behind the scenes to cause this. I do not want to speculate further. :-)</p>\n"}], "owner": {"reputation": 71, "user_id": 3364595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed460652809f4e6ef57b53c4341ecce3?s=128&d=identicon&r=PG", "display_name": "Fabio Lucchini", "link": "https://stackoverflow.com/users/3364595/fabio-lucchini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 41105927, "answer_count": 1, "score": -1, "last_activity_date": 1481562413, "creation_date": 1454452426, "last_edit_date": 1531164843, "question_id": 35165094, "link": "https://stackoverflow.com/questions/35165094/vba-excel-step-over-debug-and-crash-down-with-application-run", "title": "VBA (Excel): Step Over debug and crash down with application.run", "body": "<p>I'm working with VBA Excel.\nI have the following function:</p>\n\n<p>Function (...)\n...\nApplication.run \"subname\"...\n...\nend Function</p>\n\n<p><strong>First question:</strong>\nWhile I'm debugging with Step Over (shift F8) at Application.run line, the debugger go to \"subname\" sub that's it do a Step Into debug (F8 alone) instead of a Step Over (shift F8).</p>\n\n<p>So the question is: is possible to do Step Over debug with Application-run?</p>\n\n<p><strong>Second question:</strong>\nIf I stop the macro during the execution of the Application.run command then Excel automatically close!</p>\n\n<p>So the question is: there is an alternative to application.run command?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "do-while"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1454452343, "post_id": 35165039, "comment_id": 58048627, "body": "You would need to use public variables and the worksheet_change event."}], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1454456415, "last_edit_date": 1454456415, "creation_date": 1454456094, "answer_id": 35165870, "question_id": 35165039, "link": "https://stackoverflow.com/questions/35165039/convert-inputbox-data-entry-to-cell-data-entry/35165870#35165870", "title": "Convert inputbox data entry to cell data entry", "body": "<p>Put this behind Sheet1(Sheet1), if that's the sheet you're using: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Guess As Integer, Secret As Integer\nThisColumn = Target.Column\nThisRow = Target.Row\nIf IsNumeric(Target.Cells.Value) Then\n    Guess = Target.Cells.Value\nElse: Guess = 0\nEnd If\nRandomize\nSecret = Int(10 * Rnd) + 1\n\nIf ThisColumn = 1 Then\n    If Guess = Secret Then\n        Cells(ThisRow, 3).Value = \"Right\"\n    Else\n        Cells(ThisRow, 3).Value = \"Wrong\"\n    End If\n       Cells(ThisRow, 4).Value = Secret\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5875121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2c646abe6eaafbc222b91018e61e8b3?s=128&d=identicon&r=PG&f=1", "display_name": "DimSub", "link": "https://stackoverflow.com/users/5875121/dimsub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454460676, "creation_date": 1454452130, "last_edit_date": 1454460676, "question_id": 35165039, "link": "https://stackoverflow.com/questions/35165039/convert-inputbox-data-entry-to-cell-data-entry", "title": "Convert inputbox data entry to cell data entry", "body": "<p>I want to create a guessing game without using input boxes. I want the code to read my guesses on column A and then tell me if it was right or wrong in column C. The macro is for numbers 1 - 10 and the macro should go through each guess.</p>\n\n<p>Here's my code - </p>\n\n<pre><code>Sub VBAGuessingGame()\nDim Secret As Integer\nDim Guess As Integer\nDim Tries As Integer\n\nRandomize  'Initializes random-number generator\n\nSecret = Int((10 * Rnd) + 1) 'Generates a random number between 1 and 10\n\nGuess = 0\nTries = 0\n\nDo While Guess &lt;&gt; Secret\n    Guess = InputBox(\"Guess a number between 1 and 10.\")\n    If Guess = Secret Then\n        Tries = Tries + 1\n        MsgBox (\"You guessed the number!\")\n        MsgBox (\"It took you \" &amp; Tries &amp; \" to guess the number\")\n\n    ElseIf Guess &gt; Secret Then\n        Tries = Tries + 1\n        MsgBox (\"Wrong. Too high. Try again.\")\n    Else\n        Tries = Tries + 1\n        MsgBox (\"Wrong. Too low. Try again.\")\n    End If\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1454456662, "post_id": 35164908, "comment_id": 58050287, "body": "My guess is it breaks if the first checkbox is false so your array doesn&#39;t get filled starting from <code>0</code>."}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1454457040, "post_id": 35164908, "comment_id": 58050416, "body": "@findwindow been testing with first one as true - hadn&#39;t tried the first one being un-checked (false) so far. That&#39;s a good thing to remember though (I wouldn&#39;t have thought of that immediately, and would&#39;ve had to troubleshoot it later)."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1454507081, "post_id": 35164908, "comment_id": 58074378, "body": "You need to <code>Redim</code> the array to set the index bounds first. That&#39;s why you&#39;re getting the &quot;subscript out of range&quot; error. If you&#39;re only storing the captions for the checked controls, you probably have to loop through the controls and count the number of checks first, then <code>Redim</code>, then capture the captions."}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1454512545, "post_id": 35164908, "comment_id": 58078465, "body": "@PeterT I&#39;ll keep that in mind, thank you. As a follow-up to this: if I loop through them to get the number of checked boxes, is there a way to avoid looping through them again to assign said boxes to the array? I&#39;m trying to keep things smaller and faster, and I (think I&#39;m) adding time looping/counting looping/adding vs just using the string and plugging that into the array (or am I wrong about that?)."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1454512694, "post_id": 35164908, "comment_id": 58078590, "body": "Alternatively to populating an array, you can use a <code>Collection</code> or a <code>Dictionary</code> and get it done in a single loop."}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1454522184, "post_id": 35164908, "comment_id": 58085571, "body": "@PeterT thank you for the input - I edited my response above with the result of your comment. TYVM"}], "owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1454522524, "creation_date": 1454451648, "last_edit_date": 1531164843, "question_id": 35164908, "link": "https://stackoverflow.com/questions/35164908/macro-populating-dynamic-array-from-userform-checkbox-selections", "title": "Macro populating dynamic array (from userform checkbox selections)", "body": "<p>I have an array (I will have 4 of these) that is populated based on the user selecting between 1 and 4 checkboxes. </p>\n\n<p>My question is: why can't I populate the array directly from looping through the checkboxes and finding the selected ones?</p>\n\n<p>This doesn't work:</p>\n\n<pre><code>Dim chkBox As Control\nDim sectArr() As Variant\nDim s as long\ns = 0\n\nFor Each chkBox In Me.SectorsFrame.Controls 'Sector-level frame\nIf TypeName(chkBox) = \"CheckBox\" And chkBox.Value = True Then\n   sectArr(s) = chkBox.Caption\n   s = s + 1        \nEnd If\nNext\n</code></pre>\n\n<p>This works:</p>\n\n<pre><code>Dim chkBox As Control\nDim sectArr As Variant, sectStr As String\nsectStr = \"\"\n\nFor Each chkBox In Me.SectorsFrame.Controls 'Sector-level frame\n    If TypeName(chkBox) = \"CheckBox\" And chkBox.Value = True Then\n        sectStr = sectStr &amp; \"|\" &amp; chkBox.Caption\n    End If\nNext\nsectStr = Right(sectStr, Len(sectStr) - 1)\nsectArr = Split(sectStr, \"|\")\n</code></pre>\n\n<p>I get either \"subscript out of range\" (with parenthesis on the array) or type mismatch (without parenthesis).</p>\n\n<p>I'd like to not deal with strings and then chopping them up and filling my arrays with them (do I have to deal with them??). I don't understand enough about this to know what I can and can't do, though. </p>\n\n<p>My next 3 arrays can have 1 - 6 options, and a two-dimensional array with multiple options possible.</p>\n\n<p>=====================EDIT 2/3/2016 @ 1800z==========================</p>\n\n<p>This looks promising - I took what you said, <a href=\"https://stackoverflow.com/users/4717755/petert\">PeterT</a>, and played with it some, coming up with the following (probably still clumsy) code:</p>\n\n<pre><code>Dim chkBox As Control\nDim sectArr() As Variant\nDim sec As Long\n\n sec = 0\n    For Each chkBox In Me.SectorsFrame.Controls 'Sector-level frame\n        If TypeName(chkBox) = \"CheckBox\" And chkBox.Value = True Then\n            ReDim Preserve sectArr(sec)\n            sectArr(sec) = chkBox.Caption\n            sec = sec + 1\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "edited": false, "score": 0, "creation_date": 1454452499, "post_id": 35164883, "comment_id": 58048702, "body": "Scott, thank you for your assistance! Can I nest this function inside another Macro? I actually need to do this three time... search for &quot;A&quot; &quot;B&quot; &amp; &quot;Z&quot; and each time copy the function from column F to E.  I am also getting a run time error with the &#39;If rng = &quot;A&#39; then line&#39;  More specifically, the error state &#39;Object variable or With block variable not set&#39;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "edited": false, "score": 0, "creation_date": 1454452741, "post_id": 35164883, "comment_id": 58048783, "body": "@CARoll you take what ever you want from this and add whatever is needed.  I have added the checks for B and Z to this loop.  You can add more just put an Or between."}, {"owner": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "edited": false, "score": 0, "creation_date": 1454453047, "post_id": 35164883, "comment_id": 58048920, "body": "For some reason I am getting a run-time error &#39;13&#39;: Type mismatch  error occurs on line:    If rng.Value = &quot;A&quot; Or rng.Value = &quot;B&quot; Or rng.Value = &quot;Z&quot; Then"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "edited": false, "score": 0, "creation_date": 1454454431, "post_id": 35164883, "comment_id": 58049515, "body": "@CARoll You must have errors in column A such as &quot;#N/A&quot; or &quot;#Value&quot;  That is the only reason it would do that."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "edited": false, "score": 0, "creation_date": 1454454665, "post_id": 35164883, "comment_id": 58049595, "body": "@CARoll i have added another if statement to deal with the cells that are errors.  See edit."}, {"owner": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "edited": false, "score": 0, "creation_date": 1454459110, "post_id": 35164883, "comment_id": 58051091, "body": "Thank you again Scott! Greatly appreciate the help :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "edited": false, "score": 0, "creation_date": 1454459393, "post_id": 35164883, "comment_id": 58051178, "body": "@CARoll please mark as correct.  It is something only you can do.  Click the green check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1454454639, "last_edit_date": 1454454639, "creation_date": 1454451558, "answer_id": 35164883, "question_id": 35164791, "link": "https://stackoverflow.com/questions/35164791/excel-vba-search-for-value-in-column-a-select-row-value-is-found-and-column-f-as/35164883#35164883", "title": "Excel VBA Search for Value in Column A Select Row Value is Found and Column F as Active Cell", "body": "<p>In my opinion, if you are going to use vba then avoid using worksheet functions unless totally necessary.</p>\n\n<pre><code>Sub caroll()\n    Dim ws As Worksheet\n    Dim A_row As Long\n    Dim rng As Range\n\n    Set ws = ActiveSheet\n    'Loop through column A\n    For Each rng In ws.Range(ws.Cells(1, 1), ws.Cells(ws.Rows.Count, 1).End(xlUp))\n        'Test whether cell = \"A\",\"B\", or \"Z\"\n        If VarType(rng) &lt;&gt; vbError Then\n            If rng.Value = \"A\" Or rng.Value = \"B\" Or rng.Value = \"Z\" Then\n                'If true copy column F of that row into Column E\n                rng.Offset(, 5).Copy rng.Offset(, 4)\n            End If\n        End If\n    'loop\n    Next rng\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5875091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad1196b7444b4e45200cc71ec0a9928?s=128&d=identicon&r=PG&f=1", "display_name": "CA Roll", "link": "https://stackoverflow.com/users/5875091/ca-roll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1805, "favorite_count": 0, "accepted_answer_id": 35164883, "answer_count": 1, "score": 0, "last_activity_date": 1454454639, "creation_date": 1454451208, "question_id": 35164791, "link": "https://stackoverflow.com/questions/35164791/excel-vba-search-for-value-in-column-a-select-row-value-is-found-and-column-f-as", "title": "Excel VBA Search for Value in Column A Select Row Value is Found and Column F as Active Cell", "body": "<p>I am a VBA newbie...</p>\n\n<p>I am looking for value \"A\" in column A. I would then like to use the row number which value \"A\" is located at, and copy the existing function in Column F into Column E. </p>\n\n<p>This is what I tried and which clearly does not work...</p>\n\n<pre><code>Dim A_Row As Long\nA_Row = Application.WorksheetFunction.Match(\"A\", Range(\"A:A\"), 0)\nRange(\"E\" &amp; A_Row).Select\nActiveCell.Select\nActiveCell.Offset(0, 5).Select\nSelection.Copy\nActiveCell.Offset(0, -1).Select\nActiveSheet.Paste\n</code></pre>\n\n<p>Thank you in advance for your help!</p>\n"}, {"tags": ["excel", "vba", "outlook", "appointment"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1454456058, "post_id": 35164727, "comment_id": 58050072, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/9076634/get-reference-to-additional-inbox\">Get reference to additional Inbox</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 1, "last_activity_date": 1454526676, "creation_date": 1454526676, "answer_id": 35185651, "question_id": 35164727, "link": "https://stackoverflow.com/questions/35164727/how-to-schedule-meeting-using-non-default-calendar/35185651#35185651", "title": "How to schedule meeting using non-default calendar?", "body": "<p>If you want to create an Outlook item in a non-default folder you need to use the Items.Add method for the Folder.Items collection in the folder where you want it created.  If that folder is a default folder in a non-default account, use Store.GetDefaultFolder.</p>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1454584566, "creation_date": 1454584566, "answer_id": 35199576, "question_id": 35164727, "link": "https://stackoverflow.com/questions/35164727/how-to-schedule-meeting-using-non-default-calendar/35199576#35199576", "title": "How to schedule meeting using non-default calendar?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff862207.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Organizer</a> property of the AppointmentItem class is read-only. So, the only possible way is to re-create appointment in the appropriate calendar/folder. </p>\n\n<p>See <a href=\"https://www.add-in-express.com/creating-addins-blog/2011/11/04/outlook-create-appointment-item/\" rel=\"nofollow\">How To: Create a new Outlook Appointment item</a> for possible ways.</p>\n"}], "owner": {"reputation": 388, "user_id": 5416229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/860076956b11e5862e0a521af20f4722?s=128&d=identicon&r=PG&f=1", "display_name": "MWsan", "link": "https://stackoverflow.com/users/5416229/mwsan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 35199576, "answer_count": 2, "score": 0, "last_activity_date": 1596270209, "creation_date": 1454450982, "last_edit_date": 1596270209, "question_id": 35164727, "link": "https://stackoverflow.com/questions/35164727/how-to-schedule-meeting-using-non-default-calendar", "title": "How to schedule meeting using non-default calendar?", "body": "<p>What is the property in an AppointmentItem (MeetingStatus = olMeeting), to change the Calendar I'm using to schedule a meeting?</p>\n<p>It is using the default account no matter what. I need to alternate between accounts configured in Outlook.</p>\n<p>I tested these properties:</p>\n<pre><code>.SendUsingAccount\n\n.Organizer\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "dao", "recordset"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1454454292, "post_id": 35164317, "comment_id": 58049466, "body": "rst.Edit, rst.Update (see Online help)"}, {"owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1454510637, "post_id": 35164317, "comment_id": 58077099, "body": "@Andre, thank you.  You&#39;re right."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "edited": false, "score": 0, "creation_date": 1454510614, "post_id": 35168442, "comment_id": 58077079, "body": "Thank you @JJ32 for your answer and for correcting my code.  You&#39;ve helped me greatly.  I&#39;m learning, brother, but it&#39;s not easy.  Thank you, again."}], "tags": [], "owner": {"reputation": 967, "user_id": 5592955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aAlPK.jpg?s=128&g=1", "display_name": "JJ32", "link": "https://stackoverflow.com/users/5592955/jj32"}, "is_accepted": true, "score": 1, "last_activity_date": 1454473122, "creation_date": 1454473122, "answer_id": 35168442, "question_id": 35164317, "link": "https://stackoverflow.com/questions/35164317/insert-calculated-field-in-table-as-one-string-vba-ms-access/35168442#35168442", "title": "Insert Calculated Field in Table as one String VBA - MS Access", "body": "<pre><code>Dim db As DAO.Database\nDim tdf As DAO.TableDef\nDim fld As DAO.Field\nDim Hertz As String\nDim rst As DAO.Recordset\n\nSet db = CurrentDb()\nSet tdf = db.TableDefs(\"Unmatched\")\nSet fld = tdf.CreateField(\"ID\", dbText, 255)\ntdf.Fields.Append fld\n\nSet rst = db.OpenRecordset(\"Unmatched\")\n\nDo Until rst.EOF\n    Hertz = rst![Accounting Document Item] &amp; Mid(rst![JE Line Description], 20, 2) &amp; Round(Abs(rst![Transaction Amount]), 0)\n    Debug.Print Hertz\n    rst.Edit\n    rst!ID = Hertz\n    rst.Update\n    rst.MoveNext\nLoop\n\nrst.Close\nSet rst = Nothing\nSet db = Nothing\n</code></pre>\n\n<p>This is how I would do it in code.  An update query would be easier if you did not need to create the field on the fly.</p>\n"}], "owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 35168442, "answer_count": 1, "score": 0, "last_activity_date": 1454473122, "creation_date": 1454449317, "last_edit_date": 1454450216, "question_id": 35164317, "link": "https://stackoverflow.com/questions/35164317/insert-calculated-field-in-table-as-one-string-vba-ms-access", "title": "Insert Calculated Field in Table as one String VBA - MS Access", "body": "<p>I need to open a Table(Unmatched); Create a New Field (ID); Use existing Fields to create a new unique String (hertz); then, finally, insert this new string Back into the Table's New Field.  I'm stuck 'cause I'm new.  Any nudge forward would be greatly appreciated.</p>\n\n<pre><code>Dim db As DAO.Database\nDim tdf As DAO.TableDef\nDim fld As DAO.Field\nDim Hertz As String\nDim rst As DAO.Recordset\n\nSet db = CurrentDb()\nSet tdf = db.TableDefs(\"Unmatched\")\nSet fld = tdf.CreateField(\"ID\")\nSet rst = db.OpenRecordset(\"Unmatched\", dbOpenTable)\n\nDo Until rst.EOF\nhertz = rst![Accounting Document Item] &amp; Mid(rst![JE Line Description], 20, 2) &amp; Round(Abs(rst![Transaction Amount]), 0)\n\nDebug.Print hertz 'immediate window check\n---&gt; DoCmd.RunSQL \"?!?!?\"\nrst.MoveNext\nLoop\n\nApplication.RefreshDatabaseWindow\n\nSet fld = Nothing\nSet tdf = Nothing\nSet db = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "type-mismatch"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1454449330, "post_id": 35164131, "comment_id": 58047107, "body": "Have a look at the <a href=\"http://www.cpearson.com/excel/ReturningErrors.aspx\" rel=\"nofollow noreferrer\"><code>CVErr()</code> method</a>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1454449710, "post_id": 35164131, "comment_id": 58047308, "body": "Because you have typed your parameter as <code>Double</code> any attempt to call <code>myFunction</code> with a non-numeric value will fail, and <code>myFunction</code> will not be called.  When used as a UDF this will result in a <code>#VALUE!</code> error.  If you must handle the error inside <code>myFunction</code> declare <code>mynum</code> as <code>Variant</code> and use <code>TypeName</code> to determine the actual type passed."}, {"owner": {"reputation": 1013, "user_id": 3448932, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jBnU6.jpg?s=128&g=1", "display_name": "ptownbro", "link": "https://stackoverflow.com/users/3448932/ptownbro"}, "edited": false, "score": 0, "creation_date": 1454457246, "post_id": 35164131, "comment_id": 58050494, "body": "That makes sense thanks"}], "owner": {"reputation": 1013, "user_id": 3448932, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jBnU6.jpg?s=128&g=1", "display_name": "ptownbro", "link": "https://stackoverflow.com/users/3448932/ptownbro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 632, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1454448595, "creation_date": 1454448595, "question_id": 35164131, "link": "https://stackoverflow.com/questions/35164131/excel-vba-how-to-prevent-trap-data-type-mismatch-error-in-arguement", "title": "Excel VBA How to Prevent/Trap Data Type Mismatch Error in Arguement", "body": "<p>I have an Excel VBA user defined function where I've declared a datatype for one of the function's arguments.  I want to be able to trap potential errors in case \nsomeone doesn't put in the right datatype. Seems like it should be simple, but unable to figure it out.</p>\n\n<p>See sample below where I've used a sub procedure to demonstrate the issue.</p>\n\n<pre><code>Sub MyTest()\n    MsgBox myfunction(\"123a\")\nEnd Sub\n\nFunction myfunction(mynum As Double) As String\n    On Error Resume Next\n\n    If IsNumeric(mynum) Then\n        myfunction = \"ok\"\n    Else\n        myfunction = \"not ok\"\n    End If\nEnd Function\n</code></pre>\n\n<p>Extra Note: Though I'm using a sub procedure to demonstrate the issue, in reality I'm using a user defined function and calling the function from my worksheet. So it's not a simple as just adding protection in the \"MyTest\" procedure before calling the \"MyFunction\" procedure.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 2, "creation_date": 1454447410, "post_id": 35163778, "comment_id": 58046113, "body": "@Lerenard The key here is that you must state that you are using a native Excel function in VBA - with WorksheetFunction.{Function Name}. Note that it is generally poor practice to rely on these worksheet functions; if you are in VBA already, it is often more efficient to create functions yourself / use native VBA functions instead. In a pinch, sometimes it&#39;s best just to use these, however."}, {"owner": {"reputation": 1438, "user_id": 4714742, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-Dwa9zxapmSo/AAAAAAAAAAI/AAAAAAAAALs/3hWYYMrST1I/photo.jpg?sz=128", "display_name": "Jon McClung", "link": "https://stackoverflow.com/users/4714742/jon-mcclung"}, "edited": false, "score": 0, "creation_date": 1454447463, "post_id": 35163778, "comment_id": 58046136, "body": "That works! Except I actually had a second error I didn&#39;t notice until you solved the first one: The second line should read <code>If Selection.Areas.Count &lt;&gt; 1 Then Exit Sub</code> I&#39;ll edit my question so that part is correct."}, {"owner": {"reputation": 1438, "user_id": 4714742, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-Dwa9zxapmSo/AAAAAAAAAAI/AAAAAAAAALs/3hWYYMrST1I/photo.jpg?sz=128", "display_name": "Jon McClung", "link": "https://stackoverflow.com/users/4714742/jon-mcclung"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1454448030, "post_id": 35163778, "comment_id": 58046456, "body": "@Grade&#39;Eh&#39;Bacon I wasn&#39;t aware that wasn&#39;t proper practice. I&#39;ll go ahead and implement my own LCM function using Euclid&#39;s algorithm, but it&#39;s good to know why it didn&#39;t like my code."}, {"owner": {"reputation": 1438, "user_id": 4714742, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-Dwa9zxapmSo/AAAAAAAAAAI/AAAAAAAAALs/3hWYYMrST1I/photo.jpg?sz=128", "display_name": "Jon McClung", "link": "https://stackoverflow.com/users/4714742/jon-mcclung"}, "edited": false, "score": 0, "creation_date": 1454448206, "post_id": 35163778, "comment_id": 58046568, "body": "@RohanK, why not <code>If Selection.Areas.Count &lt; 1 Then Exit Sub</code>?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 1438, "user_id": 4714742, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-Dwa9zxapmSo/AAAAAAAAAAI/AAAAAAAAALs/3hWYYMrST1I/photo.jpg?sz=128", "display_name": "Jon McClung", "link": "https://stackoverflow.com/users/4714742/jon-mcclung"}, "edited": false, "score": 0, "creation_date": 1454448553, "post_id": 35163778, "comment_id": 58046736, "body": "@lerenard It&#39;s not that it is necessarily a bad thing to use a worksheet function, but there are 2 problems with it: (1) any particular function optimized to be used as an Excel native function is likely either inefficient or not as accurate as what you could do if you used a VBA function [either built-in or self-created] (2) Relying on Excel native functions will deprive you of the learning gained by finding the &#39;VBA way&#39; to do it. Soon, you may find that you have grown little in terms of programming knowledge, and don&#39;t have the tools to solve complex problems."}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": true, "score": 2, "last_activity_date": 1454447060, "creation_date": 1454447060, "answer_id": 35163778, "question_id": 35163746, "link": "https://stackoverflow.com/questions/35163746/excel-vba-lcm-sub-or-function-not-defined/35163778#35163778", "title": "Excel VBA - LCM - Sub or Function not defined", "body": "<p>Try this:</p>\n\n<pre><code>Sub lcm_()\n\n    If Selection.Areas &lt;&gt; 1 Then Exit Sub\n\n    Dim a As Range\n    Set a = Selection.Areas(1)\n    a.Item(1).Value = WorksheetFunction.Lcm(a.Item(1).Value, a.Item(2).Value)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1438, "user_id": 4714742, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-Dwa9zxapmSo/AAAAAAAAAAI/AAAAAAAAALs/3hWYYMrST1I/photo.jpg?sz=128", "display_name": "Jon McClung", "link": "https://stackoverflow.com/users/4714742/jon-mcclung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 35163778, "answer_count": 1, "score": 1, "last_activity_date": 1454447478, "creation_date": 1454446945, "last_edit_date": 1454447478, "question_id": 35163746, "link": "https://stackoverflow.com/questions/35163746/excel-vba-lcm-sub-or-function-not-defined", "title": "Excel VBA - LCM - Sub or Function not defined", "body": "<p>The following code:</p>\n\n<pre><code>Sub lcm_()\n\n    If Selection.Areas.Count &lt;&gt; 1 Then Exit Sub\n\n    Dim a As Range\n    Set a = Selection.Areas(1)\n    a.Item(1).Value = Lcm(a.Item(1).Value, a.Item(2).Value)\n\nEnd Sub\n</code></pre>\n\n<p>produces the error: <code>Compile error: Sub or Function not defined</code>, and I cannot figure out why. I have looked at similar problems, and it seems like the issue is that Excel cannot find the builtin function LCM, but the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197286(v=office.15).aspx\" rel=\"nofollow\">documentation</a> makes it seem like it doesn't require any special libraries. I am very new to VBA, so it is entirely possible that this is something very simple, but I cannot figure out what.</p>\n\n<p>EDIT:</p>\n\n<p>It is worth noting that if I simply click on a cell and type <code>=LCM(A8,A9)</code>, then it works fine.</p>\n"}, {"tags": ["excel", "listbox", "vba"], "owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1454446203, "creation_date": 1454446203, "last_edit_date": 1531161705, "question_id": 35163527, "link": "https://stackoverflow.com/questions/35163527/listbox-item-selection-based-on-other-listbox-item-selection", "title": "Listbox Item selection based on other Listbox item selection", "body": "<p>There two (ActiveX) listboxes on sheet (Monthlist &amp; Yearlist).  Each is populated with unique values from columns H(months) and I(years) (see code below).  The user will select month(s) available in Monthlist.  I would like the available items in \u2018Yearlist\u2019 to reflect the selection in \u2018Monthlist\u2019. For example, if there is data on sheet for May, 2015 and June, 2016, and the user selects \u2018May\u2019 from Monthlist, \u20182015\u2019 should only be available on \u2018Yearlist\u2019 for selection. (\u20182016\u2019 should be grayed out or not present).</p>\n\n<p>The obvious solution is to apply filter to column H that would reflect the selection in Monthlist, then collect unique visible values from column I into an array and display them in Yearlist. Perhaps there is more elegant solution to this problem? Thanks for your help.</p>\n\n<pre><code>    Sub UniqueMonthsAndYears(ByVal ws As Object)\n\n    Dim LastRow, i, j, k As Long\n    Dim c As Range\n    Dim MyArUniqVal() As Variant\n\n    Dim i2, j2, k2 As Long\n    Dim c2 As Range\n    Dim MyArUniqVal2() As Variant\n\n    Dim MonthList As MSForms.ListBox\n    Dim YearList As MSForms.ListBox\n\n    ReDim MyArUniqVal(0)\n    ReDim MyArUniqVal2(0)\n\n\n    Dim rng As Range\n    Dim cl As Range\n\n\n        LastRow = ActiveSheet.Range(\"H\" &amp; Rows.Count).End(xlUp).Row\n\n         Set rng = Range(\"H9:H\" &amp; LastRow)\n\n    With ThisWorkbook.ActiveSheet\n\n        For Each cl In rng\n            If cl.EntireRow.Hidden = False Then '//Use Hidden property to check if filtered or not\n                  Debug.Print cl\n                If cl.Value &lt;&gt; cl.Offset(1, 0).Value Then '~~~~~MonthArray\n\n                    MyArUniqVal(UBound(MyArUniqVal)) = cl.Value\n                    ReDim Preserve MyArUniqVal(UBound(MyArUniqVal) + 1)\n                End If\n\n                If cl.Offset(0, 1).Value &lt;&gt; cl.Offset(1, 1).Value Then 'Year Array\n                    MyArUniqVal2(UBound(MyArUniqVal2)) = cl.Offset(0, 1).Value\n                    ReDim Preserve MyArUniqVal2(UBound(MyArUniqVal2) + 1)\n                End If\n\n           End If\n        Next cl\n\n        ReDim Preserve MyArUniqVal(UBound(MyArUniqVal) - 1)\n        ReDim Preserve MyArUniqVal2(UBound(MyArUniqVal2) - 1)\n\n    End With\n\n'Fill the listbox\n ws.YearList.Clear\n\nFor k2 = 0 To UBound(MyArUniqVal2)\n\n    ws.YearList.AddItem (MyArUniqVal2(k2))\n\nNext k2\n\nws.MonthList.Clear\n\nFor k = 0 To UBound(MyArUniqVal)\n\n    ws.MonthList.AddItem (MyArUniqVal(k))\n\nNext k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "trim"], "comments": [{"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1454446084, "post_id": 35163246, "comment_id": 58045393, "body": "About how many cells are you changing with this code?  I just tested it on ~1.7 million cells and I didn&#39;t get any errors"}, {"owner": {"reputation": 51, "user_id": 5874440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r8Nhe.jpg?s=128&g=1", "display_name": "Joseph Delli Gatti", "link": "https://stackoverflow.com/users/5874440/joseph-delli-gatti"}, "reply_to_user": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1454446249, "post_id": 35163246, "comment_id": 58045465, "body": "8,106,860 cells on my practice document.  That&#39;s 161,363 rows."}, {"owner": {"reputation": 51, "user_id": 5874440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r8Nhe.jpg?s=128&g=1", "display_name": "Joseph Delli Gatti", "link": "https://stackoverflow.com/users/5874440/joseph-delli-gatti"}, "reply_to_user": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1454446905, "post_id": 35163246, "comment_id": 58045841, "body": "It seems to work up to about 70k rows.  Too much more than that, it just sets the value of every cell in the selected range to #VALUE."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 4, "creation_date": 1454449106, "post_id": 35163246, "comment_id": 58046997, "body": "What about copying the range (or at least sections of it) into a memory-based array, performing the trim, then copy that block back to the spreadsheet? Would probably be faster too."}, {"owner": {"reputation": 51, "user_id": 5874440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r8Nhe.jpg?s=128&g=1", "display_name": "Joseph Delli Gatti", "link": "https://stackoverflow.com/users/5874440/joseph-delli-gatti"}, "edited": false, "score": 0, "creation_date": 1454449492, "post_id": 35163246, "comment_id": 58047191, "body": "I also tried setting MyRange = Selection (where I select the same range as the FirstCell to LastCell), and it works about half the time without giving me the same error."}, {"owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "edited": false, "score": 0, "creation_date": 1456261007, "post_id": 35163246, "comment_id": 58862365, "body": "Maybe a DoEvents <a href=\"http://stackoverflow.com/questions/11277034/wait-until-application-calculate-has-finished\">using this method</a> might help? Have you also tried moving <code>ScreenUpdating</code> after you set the calculation property?"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "edited": false, "score": 0, "creation_date": 1456553673, "post_id": 35163246, "comment_id": 59012578, "body": "Perhaps try iterating through all columns in the range and performing the action on each column successively?"}], "answers": [{"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457345786, "post_id": 35840573, "comment_id": 59348028, "body": "Links can be broken in the future. Please copy-paste the information needed to answer the question into your post.Use the link only as a reference."}, {"owner": {"reputation": 599, "user_id": 5552821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/654c2b29525bf736594901fcfaffb585?s=128&d=identicon&r=PG&f=1", "display_name": "TrtlBoy", "link": "https://stackoverflow.com/users/5552821/trtlboy"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457392095, "post_id": 35840573, "comment_id": 59377445, "body": "I have updated the answer to make it more clear that the link was for reference only, the answer is included above"}], "tags": [], "owner": {"reputation": 599, "user_id": 5552821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/654c2b29525bf736594901fcfaffb585?s=128&d=identicon&r=PG&f=1", "display_name": "TrtlBoy", "link": "https://stackoverflow.com/users/5552821/trtlboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1457394437, "last_edit_date": 1457394437, "creation_date": 1457344285, "answer_id": 35840573, "question_id": 35163246, "link": "https://stackoverflow.com/questions/35163246/vba-and-excel-why-does-my-trim-script-results-in-value-on-large-data-sets/35840573#35840573", "title": "VBA and Excel: Why does my TRIM script results in #VALUE on large data sets?", "body": "<p>I managed to replicate your issue, and using a variant array as shown below overcomes the issue for large data sets</p>\n\n<pre><code>Dim FirstCell As Range, LastCell As Range, MyRange As Range\nDim DataRange() As Variant\nDim lRows As Long\nDim lCols As Long\nDim i As Long, j As Long\nDim value As String\n\nSet LastCell = Cells(Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n      SearchDirection:=xlPrevious, LookIn:=xlValues).Row, _\n      Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, _\n      SearchDirection:=xlPrevious, LookIn:=xlValues).Column)\n\nSet FirstCell = Cells(Cells.Find(What:=\"*\", After:=LastCell, SearchOrder:=xlRows, _\n      SearchDirection:=xlNext, LookIn:=xlValues).Row, _\n      Cells.Find(What:=\"*\", After:=LastCell, SearchOrder:=xlByColumns, _\n      SearchDirection:=xlNext, LookIn:=xlValues).Column)\n\nSet MyRange = Range(FirstCell, LastCell)\n  MyRange.Select\n  If MyRange Is Nothing Then Exit Sub\n  Application.ScreenUpdating = False\n  Application.Calculation = xlCalculationManual\n  lRows = MyRange.Rows.Count\n  lCols = MyRange.Columns.Count\n  ReDim DataRange(1 To lRows, 1 To lCols)\n  DataRange = MyRange.value\n  For j = 1 To lCols\n    For i = 1 To lRows\n      DataRange(i, j) = Trim(DataRange(i, j))\n    Next i\n  Next j\n\n  MyRange.value = DataRange\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nMsgBox \"Finished trimming \" &amp; vbCrLf &amp; \"excess spaces\", 64\n</code></pre>\n\n<p>For reference, I used this article to help come up with the answer: <a href=\"https://blogs.office.com/2008/10/03/what-is-the-fastest-way-to-scan-a-large-range-in-excel/\" rel=\"nofollow\">https://blogs.office.com/2008/10/03/what-is-the-fastest-way-to-scan-a-large-range-in-excel/</a>  </p>\n"}], "owner": {"reputation": 51, "user_id": 5874440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r8Nhe.jpg?s=128&g=1", "display_name": "Joseph Delli Gatti", "link": "https://stackoverflow.com/users/5874440/joseph-delli-gatti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1457394437, "creation_date": 1454445140, "question_id": 35163246, "link": "https://stackoverflow.com/questions/35163246/vba-and-excel-why-does-my-trim-script-results-in-value-on-large-data-sets", "title": "VBA and Excel: Why does my TRIM script results in #VALUE on large data sets?", "body": "<p>The following script works on smaller data sets (less than 30k rows or so), but results in \"#VALUE\" errors for every cell in the selected range when the range is larger than that.</p>\n\n<pre><code>Dim FirstCell As Range, LastCell As Range, MyRange As Range\n\nSet LastCell = Cells(Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n      SearchDirection:=xlPrevious, LookIn:=xlValues).Row, _\n      Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, _\n      SearchDirection:=xlPrevious, LookIn:=xlValues).Column)\n\nSet FirstCell = Cells(Cells.Find(What:=\"*\", After:=LastCell, SearchOrder:=xlRows, _\n      SearchDirection:=xlNext, LookIn:=xlValues).Row, _\n      Cells.Find(What:=\"*\", After:=LastCell, SearchOrder:=xlByColumns, _\n      SearchDirection:=xlNext, LookIn:=xlValues).Column)\n\nSet MyRange = Range(FirstCell, LastCell)\n      MyRange.Select\n      If MyRange Is Nothing Then Exit Sub\n      Application.ScreenUpdating = False\n      Application.Calculation = xlCalculationManual\n    With Selection\n        .Value = Evaluate(\"if(row(\" &amp; .Address &amp; \"),clean(trim(\" &amp; .Address &amp; \")))\")\n    End With\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    MsgBox \"Finished trimming \" &amp; vbCrLf &amp; \"excess spaces\", 64\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2HpNp.jpg\" rel=\"noreferrer\">VBA TRIM Error</a></p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 4630, "user_id": 2994412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gnXJp.jpg?s=128&g=1", "display_name": "Horaciux", "link": "https://stackoverflow.com/users/2994412/horaciux"}, "edited": false, "score": 1, "creation_date": 1454442399, "post_id": 35162222, "comment_id": 58043266, "body": "if you select all cells that need to contain any data or formula and press F2 for edit, type or past content, and then CTRL+ENTER it will past in all selected cells."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1454443917, "post_id": 35162222, "comment_id": 58044122, "body": "I was going to say this is easily solved with drag down as well....however a1 would need to be $A$1"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1454442405, "creation_date": 1454442405, "answer_id": 35162531, "question_id": 35162222, "link": "https://stackoverflow.com/questions/35162222/vba-how-to-make-formula-into-macro/35162531#35162531", "title": "VBA, How to make formula into Macro", "body": "<pre><code>Sub qwerty()\n   ActiveCell.Formula = \"=LEFT(A1,FIND(\"\".\"\",A1)-1)\"\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE:</strong></p>\n\n<p>We double-up on the double-quotes!</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1454514582, "post_id": 35165035, "comment_id": 58080041, "body": "Wow thanks, this is really good, was looking for this actually."}], "tags": [], "owner": {"reputation": 68, "user_id": 3920011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a602365ddaafdde3e9bbfb533cebfa57?s=128&d=identicon&r=PG&f=1", "display_name": "macejd", "link": "https://stackoverflow.com/users/3920011/macejd"}, "is_accepted": false, "score": 2, "last_activity_date": 1454452121, "creation_date": 1454452121, "answer_id": 35165035, "question_id": 35162222, "link": "https://stackoverflow.com/questions/35162222/vba-how-to-make-formula-into-macro/35165035#35165035", "title": "VBA, How to make formula into Macro", "body": "<p>You can also create custom function:</p>\n\n<pre><code>     Function MyLeft(my_Cell_String) As String\n         MyLeft = Left(my_Cell_String, InStr(1, my_Cell_String, \".\") - 1)\n     End Function\n</code></pre>\n\n<p>Then your formula in the cell will be:</p>\n\n<pre><code>     =MyLeft(A1)\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 35162531, "answer_count": 2, "score": 0, "last_activity_date": 1454452121, "creation_date": 1454441388, "question_id": 35162222, "link": "https://stackoverflow.com/questions/35162222/vba-how-to-make-formula-into-macro", "title": "VBA, How to make formula into Macro", "body": "<p>I have the following basic formula,</p>\n\n<pre><code>=LEFT(A1,FIND(\".\",A1)-1)\n</code></pre>\n\n<p>How can I make this into a macro, so on my selected cell it pastes this formula? Just instead of copying and pasting over and over it may be easier to make this a shortcut to a macro. Also is this something that can be applied among-st any formulas?</p>\n\n<p>Thanks</p>\n"}]