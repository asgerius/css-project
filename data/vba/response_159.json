[{"tags": ["vba", "excel", "while-loop", "overflow"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1516838479, "post_id": 48433606, "comment_id": 83858628, "body": "Try using <code>Dim x As Double</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1516838525, "post_id": 48433606, "comment_id": 83858640, "body": "@0m3r That is unlikely to be the issue"}, {"owner": {"reputation": 11, "user_id": 9054631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aec230884b7c1ef5b0ad917bedb0f72?s=128&d=identicon&r=PG&f=1", "display_name": "Bibi", "link": "https://stackoverflow.com/users/9054631/bibi"}, "edited": false, "score": 0, "creation_date": 1516838825, "post_id": 48433606, "comment_id": 83858738, "body": "No that&#39;s not the problem"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1516838981, "post_id": 48433606, "comment_id": 83858783, "body": "<code>While x &lt; 160</code> isn&#39;t a line which can trigger an overflow error. The code is on the convoluted side so it is hard to see where the issue is. Can you give a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516839301, "post_id": 48433606, "comment_id": 83858875, "body": "Are you sure the overflow isn&#39;t occurring on the line <b>after</b> <code>While x &lt; 160</code> - I can see ways that that could happen."}, {"owner": {"reputation": 11, "user_id": 9054631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aec230884b7c1ef5b0ad917bedb0f72?s=128&d=identicon&r=PG&f=1", "display_name": "Bibi", "link": "https://stackoverflow.com/users/9054631/bibi"}, "edited": false, "score": 0, "creation_date": 1516839358, "post_id": 48433606, "comment_id": 83858895, "body": "I always get the fault when I change the number 160 to a higher number"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516839933, "post_id": 48433606, "comment_id": 83859070, "body": "But does the error occur on the <code>While x &lt; 160</code> line, or on the line after that?"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 11, "user_id": 9054631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aec230884b7c1ef5b0ad917bedb0f72?s=128&d=identicon&r=PG&f=1", "display_name": "Bibi", "link": "https://stackoverflow.com/users/9054631/bibi"}, "edited": false, "score": 0, "creation_date": 1516839878, "post_id": 48433749, "comment_id": 83859058, "body": "@Bibi <code>b + a</code> is probably exceeding 32768.  By making it <code>Long</code> instead of <code>Integer</code>, you will be able to handle any row in the worksheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "edited": false, "score": 2, "creation_date": 1516839960, "post_id": 48433749, "comment_id": 83859080, "body": "Declare them as Long! Please read about VBA variable types. Integer is max 32,768"}, {"owner": {"reputation": 11, "user_id": 9054631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aec230884b7c1ef5b0ad917bedb0f72?s=128&d=identicon&r=PG&f=1", "display_name": "Bibi", "link": "https://stackoverflow.com/users/9054631/bibi"}, "edited": false, "score": 0, "creation_date": 1516840126, "post_id": 48433749, "comment_id": 83859128, "body": "If I declare them as Long Excel is not responding anymore"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "edited": false, "score": 3, "creation_date": 1516840444, "post_id": 48433749, "comment_id": 83859237, "body": "Because it is looping, this is then reason. it will eventually stop after a long time. You have a logic issue obviously. Please review your Do...Loop"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 11, "user_id": 9054631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aec230884b7c1ef5b0ad917bedb0f72?s=128&d=identicon&r=PG&f=1", "display_name": "Bibi", "link": "https://stackoverflow.com/users/9054631/bibi"}, "edited": false, "score": 0, "creation_date": 1516840565, "post_id": 48433749, "comment_id": 83859266, "body": "@Bibi The error 1004 will have occurred when <code>b + a</code> was equal to 1048577, because Excel doesn&#39;t have a row 1048577."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 11, "user_id": 9054631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aec230884b7c1ef5b0ad917bedb0f72?s=128&d=identicon&r=PG&f=1", "display_name": "Bibi", "link": "https://stackoverflow.com/users/9054631/bibi"}, "edited": false, "score": 0, "creation_date": 1516840693, "post_id": 48433749, "comment_id": 83859301, "body": "@Bibi My guess is that you got to a row <code>b</code> which is empty, and every row after it is empty."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "edited": false, "score": 0, "creation_date": 1516840706, "post_id": 48433749, "comment_id": 83859304, "body": "Exactly. Please review the logic. What I would suggest: first get the last row number and store it in a variable. Check if you didn&#39;t exceed this value."}, {"owner": {"reputation": 11, "user_id": 9054631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aec230884b7c1ef5b0ad917bedb0f72?s=128&d=identicon&r=PG&f=1", "display_name": "Bibi", "link": "https://stackoverflow.com/users/9054631/bibi"}, "edited": false, "score": 0, "creation_date": 1516840964, "post_id": 48433749, "comment_id": 83859374, "body": "Yes that&#39;s true, the table is not endless. That&#39;s possibly the problem. I will change that and let you know if this is working."}, {"owner": {"reputation": 11, "user_id": 9054631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aec230884b7c1ef5b0ad917bedb0f72?s=128&d=identicon&r=PG&f=1", "display_name": "Bibi", "link": "https://stackoverflow.com/users/9054631/bibi"}, "edited": false, "score": 0, "creation_date": 1516841670, "post_id": 48433749, "comment_id": 83859541, "body": "It is working! Thank you so much. I just addes While x &lt; 1000 And b &lt;= celast  (celast is the variable for the last row)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "edited": false, "score": 1, "creation_date": 1516888737, "post_id": 48433749, "comment_id": 83880669, "body": "Great it worked! Please mark this question as answered."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "is_accepted": false, "score": 2, "last_activity_date": 1516839428, "creation_date": 1516839428, "answer_id": 48433749, "question_id": 48433606, "link": "https://stackoverflow.com/questions/48433606/overflow-fault-6-vba-while-loop/48433749#48433749", "title": "Overflow fault 6 VBA While-loop", "body": "<p>Change the declarations as follows:</p>\n\n<pre><code> Dim a As Long\n Dim b As Long\n Dim c As Long\n</code></pre>\n\n<p>Do not declare these variables as Integer</p>\n"}], "owner": {"reputation": 11, "user_id": 9054631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aec230884b7c1ef5b0ad917bedb0f72?s=128&d=identicon&r=PG&f=1", "display_name": "Bibi", "link": "https://stackoverflow.com/users/9054631/bibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516848185, "creation_date": 1516838286, "last_edit_date": 1531164843, "question_id": 48433606, "link": "https://stackoverflow.com/questions/48433606/overflow-fault-6-vba-while-loop", "title": "Overflow fault 6 VBA While-loop", "body": "<p>First of all thanks for helping me.\nI programmed a Sub and I always get an Overflow fault 6. Its in the line where it says <code>While x&lt;160</code>. I cannot do more then 160. E.g. If I do 170 Ill get the fault. But I would like to <code>do While x&lt;1000</code></p>\n\n<p>The goal is to sum up duration times. Eg. On 1/2/2017 we had 2 downtime for electrical reason, first was 2 minutes, second was 10 minutes. </p>\n\n<p>This macro is making a summary for the 1/2/17 saying that we had 12min downtime because electrical reasons.</p>\n\n<p>I don't do that in a professional way, but this would make my work so much easier! Its working. I only get this annoying Overflow fault if I want to write in large numbers.</p>\n\n<pre><code>Sub sumuptheduration()\n\n\n    'Then sum up all the duration times\n\n   Dim a As Integer\n   Dim b As Integer\n   Dim c As Integer\n   Dim x As Long\n   Dim summe As Variant\n   Dim valuecells As Range\n\n\n   a = 1\n   b = 2\n   c = 0\n   x = 1\n\n   Set valuecells = Worksheets(1).Range(\"P2\")\n\n\n   Do While Worksheets(1).Range(\"C\" &amp; b).Value = Worksheets(1).Range(\"C\" &amp; b+a).Value And Worksheets(1).Range(\"J\" &amp; b).Value = Worksheets(1).Range(\"J\" &amp; b + a).Value\n\n        Set valuecells = Worksheets(1).Range(\"P\" &amp; b &amp; \":P\" &amp; a + b)\n        a = a + 1\n\n\n    Loop\n\n\n    Worksheets(1).Range(\"S\" &amp; a + (b - 1)).Value = Application.WorksheetFunction.Sum(valuecells)\n\n\n\n\n    b = a + 2\n    c = a + 2\n    a = 1\n\n\n\n\n    Dim y As Integer\n    y = 0\n\n\n\n\n\n\n   While x &lt; 160\n\n\n    Do While Worksheets(1).Range(\"C\" &amp; b).Value = Worksheets(1).Range(\"C\" &amp; b + a).Value And Worksheets(1).Range(\"J\" &amp; b).Value = Worksheets(1).Range(\"J\" &amp; b + a).Value\n\n        Set valuecells = Worksheets(1).Range(\"P\" &amp; b &amp; \":P\" &amp; c + a)\n\n        a = a + 1\n\n    Loop\n\n\n\n\n\n    Worksheets(1).Range(\"S\" &amp; c + (a - 1)).Value = Application.WorksheetFunction.Sum(valuecells) 'Writes the Sum into the correct Cell (last one of combination)\n\n\n        'This if clause checks if there are \"Single combinations\" because single combinations do not go through the do while at the top\n\n\n        If Worksheets(1).Range(\"J\" &amp; b).Value &lt;&gt; Worksheets(1).Range(\"J\" &amp; b + a).Value And Worksheets(1).Range(\"J\" &amp; b).Value &lt;&gt; Worksheets(1).Range(\"J\" &amp; b + (a - 2)).Value Or Worksheets(1).Range(\"C\" &amp; b).Value &lt;&gt; Worksheets(1).Range(\"C\" &amp; b + a).Value And Worksheets(1).Range(\"C\" &amp; b).Value &lt;&gt; Worksheets(1).Range(\"C\" &amp; b + (a - 2)).Value Then\n\n\n            Worksheets(1).Range(\"S\" &amp; b).Value = Worksheets(1).Range(\"P\" &amp; b).Value\n\n        Else\n\n        End If\n\n\n    'Change the variables into correct way for the next passing of the do while clause\n    x = x + 1 'causes that do while is not just one time passes\n    b = c + a\n    c = c + a 'temporary variable to not forget the old b during the next passing of the do while\n    a = 1 'at the end of every passing a tells you how much times you needed to pass the do while, so you have to reset it every time\n\n\n\n    Wend\n\n      End Sub\n\n\n\n\n\nhere\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1516837376, "post_id": 48433259, "comment_id": 83858296, "body": "is the code in a module, form module, or worksheet module?  Which Object does it state is not defined?"}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1516837539, "post_id": 48433259, "comment_id": 83858339, "body": "@Sorceri The code is in a module. It doesn&#39;t tell me what object is not defined."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1516838814, "post_id": 48433259, "comment_id": 83858736, "body": "Which line is the error?"}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1516838916, "post_id": 48433259, "comment_id": 83858767, "body": "@0m3r I only get an error when I click the button to run the macro. It&#39;s the &quot;user defined&quot; error. It doesn&#39;t highlight anything within my code. If I step through the whole sub, I don&#39;t get the &quot;user defined&quot; error, just the &quot;Exception from HRESULT: 0x800A03EC&quot; error."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 1, "creation_date": 1516839242, "post_id": 48433259, "comment_id": 83858857, "body": "Normally, after you get a &quot;User-defined type not defined.&quot; error, you should see the problematic declaration highlighted in blue."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516844958, "post_id": 48433259, "comment_id": 83860362, "body": "<code>.ChartTitle.Text = Range(&quot;=Functions!T17&quot;).Value</code> this looks off"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516850679, "post_id": 48433259, "comment_id": 83861649, "body": "@TimWilliams Strangely, that won&#39;t give an error - it is equivalent to <code>.ChartTitle.Text = Worksheets(&quot;Functions&quot;).Range(&quot;T17&quot;).Value</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516850723, "post_id": 48433259, "comment_id": 83861662, "body": "@YowE3K - huh, new to me..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516850828, "post_id": 48433259, "comment_id": 83861684, "body": "@TimWilliams Ditto - but I tested it when I saw your comment.  Was wondering whether in fact it was actually some weird way of writing <code>.ChartTitle.Text = ActiveSheet.Range(Worksheets(&quot;Functions&quot;).Range(&quot;T17&quot;).Value&zwnj;&#8203;).Value</code>, but it wasn&#39;t that sophisticated."}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 1, "creation_date": 1516851008, "post_id": 48433259, "comment_id": 83861729, "body": "Yeah the <code>Range</code> property accepts an optional leading equals sign. It allows calling some functions (amazingly). E.g. <code>Range(&quot;=IF(A3,A1,A2)&quot;)</code> returns a reference to A1 if A3 is True, or a reference to A2 otherwise."}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 2, "creation_date": 1516851286, "post_id": 48433259, "comment_id": 83861796, "body": "A search for the HRESULT code finds other issues that seem unrelated. Perhaps this code is generic from some sort of internal error, or is a catch all for different errors (and for some reason the actual error message is unhelpfully not displayed). Can you try putting a breakpoint in the code and when you click the button see if it reaches the breakpoint before failing? Then try moving the breakpoint around to see if you can deduce where it is failing."}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1516898287, "post_id": 48433259, "comment_id": 83887973, "body": "Wasn&#39;t aware of breakpoints so thanks for pointing me in that direction for my know-how. However, when I set a breakpoint as early on as my lastrow variable or the displayalerts, I still got the User-defined error upon clicking the button. I then tried to step through it and as usual, it works. I then figured the button must not be mapped to the right macro. It said ....graph.graph which from what I remember in the past, sometimes would display that way. I decided to click on the option that only said &quot;graph&quot; and voila, it worked! I still have the HRESULT error though."}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1516899111, "post_id": 48433259, "comment_id": 83888512, "body": "I pasted the &quot;copy details&quot; and it provided me a bunch of info I don&#39;t understand. Is there a way to clear this message? It doesn&#39;t look like the standard error box so it makes me think this is a MS issue, not VBA/Excel?"}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "reply_to_user": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 0, "creation_date": 1516904334, "post_id": 48433259, "comment_id": 83891589, "body": "@andrew I&#39;ve tried a new workbook with the macro: Sub Graph()  Dim Chart As Chart  Set Chart = Charts.Add  End Sub  I still get the HRESULT error."}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 0, "creation_date": 1517022065, "post_id": 48433259, "comment_id": 83938240, "body": "@Craig - can you paste the error details into the question?"}], "owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1517239851, "creation_date": 1516835740, "last_edit_date": 1517239851, "question_id": 48433259, "link": "https://stackoverflow.com/questions/48433259/user-defined-type-not-defined-macro-runs-stepping-through-but-not-when-ran-as-a", "title": "User-Defined type not defined. Macro runs stepping through but not when ran as a button", "body": "<p>I have a macro that takes data from one sheet then adds a graph to another sheet. The macro works when I step through it but when I use a form button to call the macro, I get </p>\n\n<blockquote>\n  <p><strong><code>User-defined type not defined.</code></strong> </p>\n</blockquote>\n\n<p>Most these errors, from my research, are related to references for outside programs which my code has none of. Also, my code used to work without issue but upon coming back to it months later, I now also get an </p>\n\n<blockquote>\n  <p><strong><code>\"unexpected error / Exception from HRESULT: 0x800A03EC\"</code></strong> </p>\n</blockquote>\n\n<p>alert when this new sheet gets added. It's not in the typical format, either. It allows for a link to be clicked: \"Copy Details\" (does nothing), Send a Frown (alerts MS), or close. Display alerts = false didn't fix this, I'm guessing because it's more a bug than an issue with the macro?</p>\n\n<pre><code>Option Explicit\n\nSub Graph()\nApplication.DisplayAlerts = False\nDim Chart As Chart\nDim LastRow As Long\nDim srs1 As Series\nDim srs3 As Series\nDim srs4 As Series\nDim srs5 As Series\nDim srs6 As Series\nDim srs7 As Series\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'data to be turned into graph\nRange(\"A36:H\" &amp; LastRow).Select\n\nWith Selection\n    Set Chart = Charts.Add\nEnd With\n\nWith Chart\n    .HasTitle = True\n\n'determine which chart title to add\n    If Worksheets(\"Margin View\").Range(\"R1\").Value = 2 Then\n        .ChartTitle.Text = Range(\"=Functions!T17\").Value\n        .PlotBy = xlColumns\n    Else\n        .ChartTitle.Text = Range(\"=Functions!S17\").Value\n        .ChartType = xlColumnClustered\n    End If\n\n'name series in legend\n    Set srs1 = ActiveChart.SeriesCollection(1)\n    srs1.Name = \"Margin\"\n    Set srs3 = ActiveChart.SeriesCollection(3)\n    srs3.Name = \"Less than 30 days\"\n    Set srs4 = ActiveChart.SeriesCollection(4)\n    srs4.Name = \"30 - 59 days\"\n    Set srs5 = ActiveChart.SeriesCollection(5)\n    srs5.Name = \"60 - 89 days\"\n    Set srs6 = ActiveChart.SeriesCollection(6)\n    srs6.Name = \"90 - 364 days\"\n    Set srs7 = ActiveChart.SeriesCollection(7)\n    srs7.Name = \"365 days +\"\n\n'delete 2nd series, name axes, change chart type\n    .FullSeriesCollection(2).Delete\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Number of Reservations\"\n    .SeriesCollection(1).AxisGroup = xlSecondary\n    'next line was replaced with above line\n    'ActiveChart.FullSeriesCollection(1).AxisGroup = 2\n    .FullSeriesCollection(1).ChartType = xlLineMarkers\n    .Axes(xlValue, xlSecondary).HasTitle = True\n    .Axes(xlValue, xlSecondary).AxisTitle.Characters.Text = \"Margin Percentage\"\n    .FullSeriesCollection(1).ApplyDataLabels\nEnd With\n\n    ActiveSheet.Buttons.Add(0, 0, 100, 50).Select\n\n    With Selection\n        .OnAction = \"DeleteGraph\"\n        .Name = \"GraphButton\"\n        .Text = \"Return to Margin View\"\n    End With\n\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p><b>Edit:</b>\nHere's the code I get for the unexpected HRESULT error.</p>\n\n<pre><code>Feedback Type:\nFrown (Error)\n\nError Message:\nException from HRESULT: 0x800A03EC\n\nFeedback Type:\nFrown (Error)\n\nError Message:\nException from HRESULT: 0x800A03EC\n\nStack Trace:\nMicrosoft.Mashup.Client.Excel.Shim.NativeExcelException: Exception from HRESULT: 0x800A03EC ---&gt; System.Runtime.InteropServices.COMException: Exception from HRESULT: 0x800A03EC\n--- End of inner exception stack trace ---\nat Microsoft.Mashup.Client.Excel.NativeExcelFunctionsBase.ValidateResult(Int32 result, Int32[] expectedValues)\nat Microsoft.Mashup.Client.Excel.NativeExcelFunctionsC2R.Microsoft.Mashup.Client.Excel.INativeExcelFunctions.TryGetActiveListObject(IntPtr uiFrame, String&amp; listObjectName)\nat Microsoft.Mashup.Client.Excel.Shim.NativeWindowContext.TryGetActiveListObject(String&amp; listObjectName)\nat Microsoft.Mashup.Client.Excel.ActiveQueryCache.ActiveListObjectDescriptor.GetActive(IWindowContext windowContext, IWorkbookServices workbookServices)\nat Microsoft.Mashup.Client.Excel.ActiveQueryCache.GetOrCreateCacheEntry(IWindowContext windowContext)\nat Microsoft.Mashup.Client.Excel.CustomTaskPaneManagers.UpdateQueriesTaskPaneVisibility(IWindowContext windowContext)\nat Microsoft.Mashup.Client.Excel.ExcelEventHandler.PerformPeriodicUpdate(IEnumerable`1 queriesTaskPaneVisibilityUpdateWindows)\nat Microsoft.Mashup.Client.Excel.NativeEventHandler.&lt;OnIdle&gt;b__0()\nat Microsoft.Mashup.Host.Document.ExceptionHandlerExtensions.HandleExceptions(IExceptionHandler exceptionHandler, Action action)\n\nInvocation Stack Trace:\nat Microsoft.Mashup.Host.Document.ExceptionExtensions.GetCurrentInvocationStackTrace()\nat Microsoft.Mashup.Client.ClientShared.StackTraceInfo..ctor(String exceptionStackTrace, String invocationStackTrace)\nat Microsoft.Mashup.Client.ClientShared.FeedbackErrorInfo..ctor(String message, Exception exception)\nat Microsoft.Mashup.Client.Excel.Native.NativeUserFeedbackServices.ReportException(IWin32Window activeWindow, WindowsHost windowsHost, FeedbackPackageInfo feedbackPackageInfo, Exception e)\nat Microsoft.Mashup.Client.ClientShared.UnexpectedExceptionHandler.&lt;&gt;c__DisplayClass1.&lt;HandleException&gt;b__0()\nat Microsoft.Mashup.Host.Document.SynchronizationContextExtensions.SendAndMarshalExceptions(SynchronizationContext context, Action callback)\nat Microsoft.Mashup.Client.ClientShared.UnexpectedExceptionHandler.HandleException(Exception e)\nat Microsoft.Mashup.Host.Document.ExceptionHandlerExtensions.HandleExceptions(IExceptionHandler exceptionHandler, Action action)\nat Microsoft.Mashup.Client.Excel.NativeEventHandler.OnIdle()\nat Microsoft.Mashup.Client.Excel.NativeExcelConnectorBase.&lt;OnIdleCallback&gt;b__37()\nat Microsoft.Mashup.Client.Excel.ExcelCallbackManager.InvokeAndReturnHResult(Action action)\nat Microsoft.Mashup.Client.Excel.NativeExcelConnectorBase.OnIdleCallback()\n\nSupports Premium Content:\nFalse\n\nFormulas:\n\nsection Section1;\n\n    shared MarginalReportAnd2015 = let\n    Source = Excel.Workbook(File.Contents(\"M:\\Report Writing\\Accounting-RAD\\MARGINAL REPORT and 2015.xlsx\"), null, true),\n    Table2_Table = Source{[Item=\"Table2\",Kind=\"Table\"]}[Data],\n    #\"Changed Type\" = Table.TransformColumnTypes(Table2_Table,{{\"Arrival Date\", type any}, {\"Reservation\", Int64.Type}, {\"Margin\", type number}, {\"Requested By\", type text}, {\"Billing Name\", type any}, {\"Length of Stay (days)\", type any}})\nin\n    #\"Changed Type\";\n\nshared SPIDE = let\n    Source = Excel.Workbook(File.Contents(\"M:\\Report Writing\\Accounting-RAD\\SPIde.xlsx\"), null, true),\n    SPIDE_Table = Source{[Item=\"SPIDE\",Kind=\"Table\"]}[Data],\n    #\"Changed Type\" = Table.TransformColumnTypes(SPIDE_Table,{{\"Arrival Date\", type date}, {\"Reservation\", Int64.Type}, {\"Margin\", type number}, {\"Requested By\", type text}, {\"Billing Name\", type any}}),\n    #\"Column From Examples\" = Table.AddColumn(#\"Changed Type\", \"Literal\", each \"=INDEX('[TMR All Reservations.xlsx]Sheet1'!$D:$F,MATCH($B2,'[TMR All Reservations.xlsx]Sheet1'!$D:$D,0),3)\", type text),\n    #\"Removed Columns\" = Table.RemoveColumns(#\"Column From Examples\",{\"Literal\"}),\n    #\"Column From Examples1\" = Table.AddColumn(#\"Removed Columns\", \"Literal\", each \"REPLACE\", type text),\n    #\"Renamed Columns\" = Table.RenameColumns(#\"Column From Examples1\",{{\"Literal\", \"Length of Stay (days)\"}}),\n    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns\",{\"Length of Stay (days)\"})\nin\n    #\"Removed Columns1\";\n\n[ Description = \"Joins the SPIde report that must be ran and the 2015/Margin Report (2016)\" ]\nshared Append1 = let\n    Source = Table.Combine({MarginalReportAnd2015, SPIDE})\nin\n    Source;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1516835623, "post_id": 48433219, "comment_id": 83857794, "body": "<b>ALL</b> range objects, these include the <code>Cells()</code> inside the <code>Range</code> needs to have their parent set, otherwise it is looking for the active sheet.  <code>Set rngItemRange = SourceWb.Sheets(&quot;Quality&quot;).Range(SourceWb.Sheets(&quot;Quality&quot;).&zwnj;&#8203;Cells(3, i), SourceWb.Sheets(&quot;Quality&quot;).Cells((intItemCount + 2), i)</code>"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1516835913, "post_id": 48433219, "comment_id": 83857882, "body": "You can go by <code>With SourceWb.Sheets(&quot;Quality&quot;) _ Set rngItemRange = .Range(.Cells(3, i), .Cells((intItemCount + 2), i)) _ End With</code>"}, {"owner": {"reputation": 31, "user_id": 2898340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad9daf67e6b896b383eec515609f0ae?s=128&d=identicon&r=PG&f=1", "display_name": "mecasull", "link": "https://stackoverflow.com/users/2898340/mecasull"}, "edited": false, "score": 0, "creation_date": 1516836053, "post_id": 48433219, "comment_id": 83857925, "body": "you guys are beautiful.  Thank you!  ive been trying like hell to figure out whats going on.  Also, my follow on was &quot;is there a more elegant way to type it...&quot; the with makes sense."}], "owner": {"reputation": 31, "user_id": 2898340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad9daf67e6b896b383eec515609f0ae?s=128&d=identicon&r=PG&f=1", "display_name": "mecasull", "link": "https://stackoverflow.com/users/2898340/mecasull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1516842277, "creation_date": 1516835465, "last_edit_date": 1516842277, "question_id": 48433219, "link": "https://stackoverflow.com/questions/48433219/sheet-not-found-via-codename", "title": "Sheet not found via codename", "body": "<p>I'm running across and error that appears sporadically.  Essentially, a master .xlsm file is used by multiple people to populate data for aggregation.  I then use another .xlsm file with macros to pull the data and aggregate it into a single source file.</p>\n\n<p>The code generally works quite well, with one exception:</p>\n\n<pre><code>'define range based on count'\nSet rngItemRange = SourceWb.Sheets(\"Quality\").Range(Cells(3, i), Cells((intItemCount + 2), i))\n\n'write concatenated range'\ntargetwb.Sheets(\"Raw Data\").Cells(pintDest_row, pintCol).Value = concatRange(rngItemRange)\n</code></pre>\n\n<p>It cannot find the tab \"Quality\" on some work books (but not all).  Okay, maybe someone renamed the tab?  checked that, thats not true.  One thing that works as a work around: on the open source workbook, when debug throws an error, if i manually click the quality tab, then resume the macro, it will continue.</p>\n\n<p>I also said, okay, well maybe there's some weird character recognition issue, so I started to refer to the sheet by the codename as shown in the vba editor.  I experience the same behaviors.</p>\n\n<p>This affects maybe 50% of the workbooks, and I cant find any root cause.  I have similar code elsewhere, for different sheets, but this is the only one where i define a range to pass into a function using the \"set\" command.  Again, this only happens sometimes on some workbooks, and i can continue to execute when i manually click on the tab i'm pulling data from.</p>\n\n<p>I'll also add, there is only one workbook open with this sheet name, at any given time, so i dont think it's choking trying to figure which sheet is relevant.  Plus sourceWb is a set variable.</p>\n\n<p>Does someone have any clue whats going on? anything to try? solutions? help!\n(Forgive any typos, I'm working on a broken thumb right now.)</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "is_accepted": true, "score": 1, "last_activity_date": 1516834559, "last_edit_date": 1516834559, "creation_date": 1516833764, "answer_id": 48432920, "question_id": 48432863, "link": "https://stackoverflow.com/questions/48432863/track-on-then-delete-selection-then-track-off/48432920#48432920", "title": "Track On then Delete Selection then Track Off", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/VBA/Word-VBA/articles/document-trackrevisions-property-word\" rel=\"nofollow noreferrer\"><code>Document.TrackRevisions</code> property</a> is a Boolean, so you can simply write:</p>\n\n<pre><code>ActiveDocument.TrackRevisions = True\nSelection.Delete Unit:=wdCharacter, Count:=1\nActiveDocument.TrackRevisions = False\n</code></pre>\n\n<p>Note that you may want instead to put the TR back to its original state:</p>\n\n<pre><code>Dim tr As Boolean\ntr = ActiveDocument.TrackRevisions\n\nActiveDocument.TrackRevisions = True\nSelection.Delete Unit:=wdCharacter, Count:=1\nActiveDocument.TrackRevisions = tr\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9264578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a097796d5257d9c483d346b642c8e426?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rice", "link": "https://stackoverflow.com/users/9264578/ron-rice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "accepted_answer_id": 48432920, "answer_count": 1, "score": 1, "last_activity_date": 1516835215, "creation_date": 1516833459, "last_edit_date": 1516835215, "question_id": 48432863, "link": "https://stackoverflow.com/questions/48432863/track-on-then-delete-selection-then-track-off", "title": "Track On then Delete Selection then Track Off", "body": "<p>Can anyone provide a Microsoft Word VBA or macro that does this. I want to make a selection of simple text, then I want to run a macro the does this:</p>\n\n<p><strong>Track Changes - On >> Delete Selection >> Track Changes - Off</strong></p>\n\n<p>This following macro does not work because lines 1 and 3 simply toggles the Track Changes from its current status. Therefore, if TC is currently ON, the macro begins by switching TC to OFF (bad result).</p>\n\n<pre><code>  ActiveDocument.TrackRevisions = Not ActiveDocument.TrackRevisions\n  Selection.Delete Unit:=wdCharacter, Count:=1\n  ActiveDocument.TrackRevisions = Not ActiveDocument.TrackRevisions\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1516831771, "post_id": 48432464, "comment_id": 83856154, "body": "Is the number always five digits long (no more, no less)?"}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "reply_to_user": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1516831817, "post_id": 48432464, "comment_id": 83856175, "body": "I think so, but if possible, I&#39;d like to look for 4 or 6 just in case, but if you have a solution that works with 5 that is ok"}, {"owner": {"reputation": 3238, "user_id": 7486612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc85993039d8b9241a72ca5ceb4c4a4?s=128&d=identicon&r=PG&f=1", "display_name": "Sidney", "link": "https://stackoverflow.com/users/7486612/sidney"}, "edited": false, "score": 0, "creation_date": 1516831825, "post_id": 48432464, "comment_id": 83856178, "body": "Based on those examples, the regex isn&#39;t too hard: <a href=\"https://regexr.com/3jnk1\" rel=\"nofollow noreferrer\">regexr.com/3jnk1</a> unfortunately I only really know JavaScript&#39;s Regex, so it might need to be adapted to your language."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1516831845, "post_id": 48432464, "comment_id": 83856186, "body": "Use <code>.Pattern = &quot;&#47;([0-9]{3,7})&#47;&quot;</code> and grab <code>match.SubMatches.Item(0)</code>"}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1516831922, "post_id": 48432464, "comment_id": 83856220, "body": "@WiktorStribi\u017cew not sure how to use the second part, but let me see if that works"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1516831945, "post_id": 48432464, "comment_id": 83856231, "body": "Do you always  expect one single match in each case?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1516831954, "post_id": 48432464, "comment_id": 83856234, "body": "A simple split on <code>&quot;&#47;&quot;</code> together with using <code>IsNumeric()</code> and perhaps <code>Len()</code> on the returned items should suffice."}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1516832316, "post_id": 48432464, "comment_id": 83856402, "body": "@WiktorStribi\u017cew yes"}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516832339, "post_id": 48432464, "comment_id": 83856418, "body": "@JohnColeman I really don&#39;t know VBScript all that well so not sure how to use that"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1516833033, "post_id": 48432464, "comment_id": 83856770, "body": "Your code isn&#39;t VBScript in the first place. Most likely it&#39;s VBA. Anyway, please clarify what you need to match. Are they always 5 digits? More? Less? What&#39;s the range? Can there be other occurrences of such numbers in the same string? Can there be URLs like <code>&#47;foo&#47;12345&#47;?action=something&amp;listingid=54321</code> or <code>&#47;foo&#47;some12345bar&#47;54321&#47;</code>?"}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1516887281, "post_id": 48432464, "comment_id": 83879638, "body": "@AnsgarWiechers they are always 5 digits, yes the urls you posted are all possible"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1516887762, "post_id": 48432464, "comment_id": 83879949, "body": "Then which of the numbers do you want to extract? The first? The last? All? Any? Some? Also, why did you accept an answer that can&#39;t possibly work for VBA or VBScript?"}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516887883, "post_id": 48432464, "comment_id": 83880027, "body": "I&#39;m using regular expressions with VBA or VBScript or whatever it is.His mostly works. I just need to modify it a little"}], "answers": [{"comments": [{"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516831988, "post_id": 48432547, "comment_id": 83856248, "body": "That&#39;s it! You are so fast, I can&#39;t even mark it correct yet. Give me 8 minutes"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1516887991, "post_id": 48432547, "comment_id": 83880109, "body": "Positive lookahead is <code>(?=...)</code>, not <code>(?&lt;...</code>). <code>(?&lt;=...)</code> is a positive lookBEHIND, which neither VBA nor VBScript support."}], "tags": [], "owner": {"reputation": 3034, "user_id": 6101071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b1da77c00202a8477bee1a68950824f?s=128&d=identicon&r=PG&f=1", "display_name": "Srdjan M.", "link": "https://stackoverflow.com/users/6101071/srdjan-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1516833056, "last_edit_date": 1516833056, "creation_date": 1516831886, "answer_id": 48432547, "question_id": 48432464, "link": "https://stackoverflow.com/questions/48432464/how-to-get-numbers-between-two-in-a-url-in-excel/48432547#48432547", "title": "How to get numbers between two / in a URL in Excel", "body": "<p>Numbers are at the end of the string and behind <code>/?</code>. So:</p>\n\n<p><strong>Regex</strong>: <code>(?&lt;=\\/)\\d+(?=\\/\\?|\\/$)|(?&lt;=listingid=)\\d+</code></p>\n\n<p><strong>Details:</strong></p>\n\n<ul>\n<li><code>+</code> Matches between one and unlimited times</li>\n<li><code>(?&lt;)</code> and <code>(?&lt;=)</code> Positive Lookahead</li>\n<li><code>$</code> asserts position at the end of the string</li>\n<li><code>|</code> or</li>\n</ul>\n\n<p><a href=\"https://regex101.com/r/os06Ab/6\" rel=\"nofollow noreferrer\">RegEx demo</a></p>\n"}, {"comments": [{"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516832299, "post_id": 48432587, "comment_id": 83856397, "body": "because it&#39;s not always in the same spot, also I now have to find listingid= too"}], "tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": false, "score": 1, "last_activity_date": 1516832060, "creation_date": 1516832060, "answer_id": 48432587, "question_id": 48432464, "link": "https://stackoverflow.com/questions/48432464/how-to-get-numbers-between-two-in-a-url-in-excel/48432587#48432587", "title": "How to get numbers between two / in a URL in Excel", "body": "<p>If you're looking for the numbers, why don't you simply match digits between 2 forward slashes as a capturing group and then extract that group?</p>\n\n<pre><code>Set re = New RegExp\nre.Pattern = \"/(\\d{3,7})/\"\n\nFor Each m In re.Execute(s)\n    listNum = m.Submatches(0)\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516891348, "post_id": 48432961, "comment_id": 83882665, "body": "once again, you are the master"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1516833977, "creation_date": 1516833977, "answer_id": 48432961, "question_id": 48432464, "link": "https://stackoverflow.com/questions/48432464/how-to-get-numbers-between-two-in-a-url-in-excel/48432961#48432961", "title": "How to get numbers between two / in a URL in Excel", "body": "<p>As a formula solution, this should work for you:</p>\n\n<pre><code>=--MID(A1,MATCH(TRUE,INDEX(ISNUMBER(--MID(SUBSTITUTE(A1,\"-\",\"|\"),ROW(INDIRECT(\"1:\"&amp;LEN(A1)-4)),5)),),0),5)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1516841425, "creation_date": 1516841425, "answer_id": 48433997, "question_id": 48432464, "link": "https://stackoverflow.com/questions/48432464/how-to-get-numbers-between-two-in-a-url-in-excel/48433997#48433997", "title": "How to get numbers between two / in a URL in Excel", "body": "<p>Without <strong><em>Regex</em></strong>:</p>\n\n<pre><code>Public Function GetNumber(s As String) As String\n    Dim a, L As Long\n    ary = Split(s, \"/\")\n    For Each a In ary\n        L = Len(a)\n        If L &gt; 3 And L &lt; 7 And IsNumeric(a) Then\n            GetNumber = a\n            Exit Function\n        End If\n    Next a\n    GetNumber = \"\"\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FD7eD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FD7eD.png\" alt=\"enter image description here\"></a></p>\n\n<p>will extract numbers with 4, 5, or 6 digits.</p>\n"}], "owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "closed_date": 1516883273, "accepted_answer_id": 48432961, "answer_count": 4, "score": -1, "last_activity_date": 1516841425, "creation_date": 1516831556, "last_edit_date": 1531161705, "question_id": 48432464, "link": "https://stackoverflow.com/questions/48432464/how-to-get-numbers-between-two-in-a-url-in-excel", "closed_reason": "Needs more focus", "title": "How to get numbers between two / in a URL in Excel", "body": "<p>I am trying to extract 4, 5, or 6 numbers in a URL. The number don't always appear in the same place in the URL, sometimes they are in the fourth position, sometimes the fifth, and sometimes, they have a bunch of gobbledygook behind them. Some examples are below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xDo4O.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xDo4O.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have some VBA that I hacked together from a <a href=\"https://stackoverflow.com/questions/48427343/how-to-extract-ad-sizes-from-a-string-with-excel-regex/48429300\">previous post</a>, but as you can see it breaks down on some URLs (image above). How can I modify this, or is there a formula I can use, to always return the highlighted number in the right column?</p>\n\n<pre><code>Public Function listNum(Myrange As Range) As String\n    Dim regEx           As Object\n    Dim inputMatches    As Object\n    Dim regExString     As String\n    Dim strInput        As String\n    Dim a               As Byte\n\n    Set regEx = CreateObject(\"VBScript.RegExp\")\n\n    With regEx\n        .Pattern = \"([0-9]{3,7})\"\n        .IgnoreCase = True\n        .Global = True\n        s = Myrange.Value\n        Set inputMatches = .Execute(s)\n\n        If regEx.Test(s) Then\n            listNum = .Replace(s, \"~\")\n            a = InStr(1, listNum, \"~\", vbTextCompare)\n            listNum = Mid(s, a, Len(s) - (Len(listNum) - 1))\n        Else\n            listNum = \"\"\n            'listNum = s 'takes entire contents of cell and puts it in, we do not want that\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<p>UPDATE: Apparently, they are not always between two slashes, but it looks like they are always 5 characters here are two more URLs. We're back open for business!</p>\n\n<pre>\n/listings/?action=display&listingid=31221\n/es-gl/listings/?action=display&listingid=30931&menuid=706&hit=1\n</pre>\n"}, {"tags": ["excel", "vba", "substring"], "comments": [{"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 1, "creation_date": 1516831324, "post_id": 48432364, "comment_id": 83855941, "body": "Can you please add the code you&#39;ve tried so far so we can see what kind of variables, data, etc. that you&#39;re working with?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1516831753, "post_id": 48432364, "comment_id": 83856142, "body": "If your code isn&#39;t working, it&#39;s hard for us to help you without seeing it. Please <a href=\"https://stackoverflow.com/posts/48432364/edit\">edit</a> your question to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that reliably reproduces the specific problem you&#39;re facing."}, {"owner": {"reputation": 21, "user_id": 1228614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f34982e0419fec3050c4cca482edcd?s=128&d=identicon&r=PG", "display_name": "Jornum", "link": "https://stackoverflow.com/users/1228614/jornum"}, "edited": false, "score": 0, "creation_date": 1516831754, "post_id": 48432364, "comment_id": 83856144, "body": "FindSt = thisSheet.Range(&quot;B3&quot;).Value\t&#39;&quot;but also need rendering provider first name &quot; ReplaceSt = thisSheet.Range(&quot;B4&quot;).Value\t&#39;&lt;&lt;&lt;!Renderingproviderfirstname&gt;&zwnj;&#8203;&gt;&gt; ... currentString = dStep.StepExpectedResult stPosition = InStr(currentString, FindSt)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1516831777, "post_id": 48432364, "comment_id": 83856156, "body": "Please edit the question itself to show the code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516832287, "post_id": 48432364, "comment_id": 83856386, "body": "Thanks for editing, but what you&#39;re trying to achieve is still unclear. Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516832779, "post_id": 48432364, "comment_id": 83856646, "body": "What&#39;s wrong with <code>Replace()</code>?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516832826, "post_id": 48432364, "comment_id": 83856664, "body": "And I believe your issue with <code>InStr()</code> is that the 1st argument is an integer"}, {"owner": {"reputation": 21, "user_id": 1228614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f34982e0419fec3050c4cca482edcd?s=128&d=identicon&r=PG", "display_name": "Jornum", "link": "https://stackoverflow.com/users/1228614/jornum"}, "edited": false, "score": 0, "creation_date": 1516834221, "post_id": 48432364, "comment_id": 83857280, "body": "the first int is optional. it happens with replace also. Although the below works just fine. I&#39;m stumped  Sub test() Dim FindSt, currentString As String Dim test, stposition As Integer FindSt = &quot;but also need rendering provider first name&quot; currentString = &quot;All fields populate from the correctly populated provider&lt;&lt;&lt;!Renderingproviderlastname&gt;&gt;&gt;, but also need rendering provider first name&quot; stposition = InStr(currentString, FindSt) End Sub"}, {"owner": {"reputation": 345, "user_id": 2249155, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4jbea.png?s=128&g=1", "display_name": "neophlegm", "link": "https://stackoverflow.com/users/2249155/neophlegm"}, "edited": false, "score": 1, "creation_date": 1516834526, "post_id": 48432364, "comment_id": 83857406, "body": "You really need to clarify this. It&#39;s almost impossible to unpack what you&#39;re asking with in-line code in comments and more than 80 lines of code in your original post."}], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": false, "score": 0, "last_activity_date": 1516834405, "creation_date": 1516834405, "answer_id": 48433035, "question_id": 48432364, "link": "https://stackoverflow.com/questions/48432364/finding-a-phrase-in-a-string-variable/48433035#48433035", "title": "Finding a phrase in a string variable", "body": "<p>Try this:</p>\n\n<pre><code>    Sub replace_string()\n\n    FindSt = \"but also need rendering provider first name\"\n    ReplaceString = \"I LIKE BANANAS\"\n\n    currentString = \"All fields populate from the correctly populated provider&lt;&lt;&lt;\\!Renderingproviderlastname&gt;&gt;&gt;, but also need rendering provider first name\"\n    stPosition = Replace(currentString, FindSt, ReplaceString)\n\n    MsgBox stPosition\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 1228614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f34982e0419fec3050c4cca482edcd?s=128&d=identicon&r=PG", "display_name": "Jornum", "link": "https://stackoverflow.com/users/1228614/jornum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516847516, "creation_date": 1516831182, "last_edit_date": 1516847516, "question_id": 48432364, "link": "https://stackoverflow.com/questions/48432364/finding-a-phrase-in-a-string-variable", "title": "Finding a phrase in a string variable", "body": "<p>I am trying to find a phrase inside of a variable that contains html. I then want to replace it with a new phrase.</p>\n\n<p>I tried InStr but the phrase is not found. I also tried using wildcards at tht beginning and end of the phrase. I also tried doing an if  like  also with and without wildcards.</p>\n\n<p>The purpose is to allow a tester to do a batch change on expected results and/or test steps by entering a sentence or phrase they want changed. </p>\n\n<p>The only problem I'm having is being able to programmatically find the sentence within the variable. \nProblem area is in bold</p>\n\n<pre><code>Dim qcURL As String\nDim qcID As String\nDim qcPWD As String\nDim qcDomain As String\nDim qcProject As String\nDim preActVal As String\nDim postActVal As String\nDim FindSt As String\nDim currentString As String\nDim thisSheet As Worksheet\n'Toggle debugging mode'\nDim isDebugOn As Boolean\nisDebugOn = True   'set to true to turn off Active X\n''On Error GoTo ErrHandler:\nFOLDER_PATH = \"BAT\\PC2P - Claims - Med\"\nSet thisSheet = ThisWorkbook.Sheets(\"ShellUpdater\")\nTestID = thisSheet.Range(\"B1\").Value\nstField = thisSheet.Range(\"B2\").Value\n**FindSt = thisSheet.Range(\"B3\").Value**\nReplaceSt = thisSheet.Range(\"B4\").Value\ntestLocation = thisSheet.Range(\"B5\").Value\n\n'ActiveX Forms\n   If isDebugOn = False Then\n       'qcURL = GetOptionMetric(\"qcURL\", 1, \"Enter ALM URL\")   ''popup to get url from user\n       qcURL = \"&lt;&lt;URL&gt;&gt;\"\n    'qcDomain = GetOptionMetric(\"qcDomain\", 1, \"Enter your ALM Domain\")     \n''popup to get domain from user\n       qcDomain = \"&lt;&lt;DOMAIN&gt;&gt;\"\n    'qcProject = GetOptionMetric(\"qcProject\", 1, \"Enter your ALM Project\")      \n''popup to get project from user\n       qcProject = \"&lt;&lt;PROJECT&gt;&gt;\"\n       qcID = GetOptionMetric(\"qcID\", 1, \"Enter your ALM MSID\")\n       qcPWD = GetOptionPassword(\"qcPWD\", 1, \"Enter your ALM Password\")\n   Else\n       qcURL = \"&lt;&lt;URL&gt;&gt;\"\n       qcID = \"&lt;&lt;USERNAME&gt;&gt;\"\n       qcDomain = \"&lt;&lt;DOMAIN&gt;&gt;\"\n       qcProject = \"&lt;&lt;PROJECT&gt;&gt;\"\n       qcPWD = InputBox(\"THIS IS IN DEEBUG MODE\")\n       If qcPWD = vbNullString Then Exit Sub\n       If qcPWD = \"\" Then Exit Sub\n   End If\n'END ActiveX Forms\n\n'Connect to ALM\nSet tdConnection = CreateObject(\"TDApiOle80.TDConnection\")\ntdConnection.InitConnectionEx qcURL\ntdConnection.Login qcID, qcPWD\ntdConnection.Connect qcDomain, qcProject\n\n''Check if batch updating or single case\nDim testObject As ITest\n\n   If InStr(TestID, \"All\") &gt; 0 Then\n       Dim TestFact As testFactory\n       Set tMng = tdConnection.TreeManager\n       Set srcFolder = tMng.NodeByPath(\"Subject\\\" &amp; testLocation)\n       Set tstFact = srcFolder.testFactory\n       Set tstList = tstFact.NewList(\"\")\n\n       For Each shellTest In tstList\n           Set DSFact = shellTest.DesignStepFactory.NewList(\"\")\n\n           For Each dStep In DSFact\n\n               Select Case stField\n                   Case \"StepExpectedResult\"\n                    **currentString = dStep.StepExpectedResult**\n                    **stposition = InStr(currentString, FindSt)**\n                       If stposition &gt; 0 Then\n                           dStep.StepExpectedResult = preActVal &amp; Replace(currentString, FindSt, ReplaceSt) &amp; postActVal\n                       End If\n                   Case \"StepDescription\"\n                       currentString = dStep.StepDescription\n                       stposition = InStr(currentString, FindSt)\n                       If stposition &gt; 0 Then\n                           dStep.StepDescription = preActVal &amp; Replace(currentString, FindSt, ReplaceSt) &amp; postActVal\n                       End If\n               End Select\n\n            dStep.Post\n        Next dStep\n\n    Next shellTest\n\nElse\n    Dim myTest\n    'Find the Test in test plan\n    Set thisTest = GetTest(Trim(TestID), testLocation, \"\\\")\n    Set myTest = tdConnection.testFactory.Item(TestID)\nEnd If\n</code></pre>\n\n<p></p>\n"}, {"tags": ["vba", "excel", "loops", "range", "formula"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1516831168, "post_id": 48432331, "comment_id": 83855862, "body": "Not that it will speed up your code, but your line <code>lrow = 1</code> is 100% redundant."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1516831662, "creation_date": 1516831662, "answer_id": 48432492, "question_id": 48432331, "link": "https://stackoverflow.com/questions/48432331/loop-through-a-range-populating-with-a-dynamic-formula/48432492#48432492", "title": "Loop through a range populating with a dynamic formula", "body": "<p>get rid of the loop all together:</p>\n\n<pre><code>Dim lrow as long\nlrow = 100\nRange(\"g1:g\" &amp; lrow).Formula = \"=IF(A1=\"\"SC\"\",(IF(LEN(E1)=3,\"\"SC\"\",IF(LEN(E1)=4,LEFT(E1,1),LEFT(E1,2)))),\"\"LB\"\")\"\nRange(\"h1:h\" &amp; lrow).Formula = \"=IF(D1=\"\" \"\",RIGHT(E1,3),CONCATENATE(RIGHT(E1,3),F1))\"\n</code></pre>\n\n<p>This will fill all the cels from row 1 to row 100 in one step no loop needed.</p>\n\n<p>By using the loop you are filling an ever increasing range with the formula.  The first loop does row 1, the second doew row 1 to row 2 and so forth.</p>\n\n<p>Row 1 get populated <code>lrow</code> times.  That is what is slowing down your code.</p>\n\n<p>Any relative references (no <code>$</code> before the row number), will automatically be updated to the relative row.</p>\n"}], "owner": {"reputation": 1, "user_id": 9264458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/564171de9caa174c2ee7d29c68e17372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9264458/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516831662, "creation_date": 1516831055, "last_edit_date": 1516831112, "question_id": 48432331, "link": "https://stackoverflow.com/questions/48432331/loop-through-a-range-populating-with-a-dynamic-formula", "title": "Loop through a range populating with a dynamic formula", "body": "<p>Does anybody have a suggestion on how to speed up this loop?   Our file has 9,000+ rows and the macro is taking too long.   In the range is it going back to <code>G1</code> every time it loops and do you have a suggestion of how to write the range more efficiently while still keeping the formula dynamic?</p>\n\n<pre><code>Dim lrow As Long\nlrow = 1\nFor lrow = 1 To lastrow3\n   Range(\"g1:g\" &amp; lrow).Formula = \"=IF(A1=\"\"SC\"\",(IF(LEN(E1)=3,\"\"SC\"\",IF(LEN(E1)=4,LEFT(E1,1),LEFT(E1,2)))),\"\"LB\"\")\"\n   Range(\"h1:h\" &amp; lrow).Formula = \"=IF(D1=\"\" \"\",RIGHT(E1,3),CONCATENATE(RIGHT(E1,3),F1))\"\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "row"], "comments": [{"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1516828395, "post_id": 48431606, "comment_id": 83854433, "body": "Are you sure you meant <code>.Rows</code> and not <code>.Row</code> fam?"}, {"owner": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "reply_to_user": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1516828723, "post_id": 48431606, "comment_id": 83854578, "body": "The current code is correct. It does move the selected row up when the button is selected.  I would like the button to stop functioning before the selected row reaches row 6."}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1516831313, "post_id": 48431606, "comment_id": 83855933, "body": "The current code only works when selecting one row and, in that case, <code>.rows.count</code> will always be 1, that&#39;s why I asked."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "edited": false, "score": 0, "creation_date": 1516830921, "post_id": 48432200, "comment_id": 83855711, "body": "Genius! Thank you!"}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "reply_to_user": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "edited": false, "score": 0, "creation_date": 1516831013, "post_id": 48432200, "comment_id": 83855758, "body": "Glad I could help!"}], "tags": [], "owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "is_accepted": true, "score": 0, "last_activity_date": 1516830593, "creation_date": 1516830593, "answer_id": 48432200, "question_id": 48431606, "link": "https://stackoverflow.com/questions/48431606/moving-row-range-up-but-not-above-a-certain-row/48432200#48432200", "title": "Moving Row/Range Up But Not Above A Certain Row", "body": "<p>This code will cut the entire row where your <code>Selection</code> lives, and then insert it one row up. It stops doing this once your data is in Row 6. It isn't a loop, so if that's what you're looking for (e.g. to click the button once and for the row to keep moving until it hits Row 6), you'll need some modification.</p>\n\n<pre><code>Sub Rowsup1()\nDim myRow As Integer\n\n Application.ScreenUpdating = False\n\n   With Selection\n'   find the currently selected row\n    myRow = .Row\n\n'   While myRow doesn't = 6, cut and paste the entire _\n    row one row higher than its current location\n    If myRow = 6 Then\n      'Do nothing\n    Else\n      .EntireRow.Cut\n      Range(\"A\" &amp; myRow - 1).Insert\n      .Select\n    End If\n   End With\n\n   With Application\n    .CutCopyMode = False\n    .ScreenUpdating = True\n   End With\n\nEnd Sub\n</code></pre>\n\n<p>I'd recommend changing it to <code>If myRow &lt;= 6 Then</code> only so nothing will happen if you've already - for some reason - passed Row 6.</p>\n"}], "owner": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 48432200, "answer_count": 1, "score": 0, "last_activity_date": 1516830593, "creation_date": 1516828065, "last_edit_date": 1516829594, "question_id": 48431606, "link": "https://stackoverflow.com/questions/48431606/moving-row-range-up-but-not-above-a-certain-row", "title": "Moving Row/Range Up But Not Above A Certain Row", "body": "<p>I have the following sub:</p>\n\n<pre><code>Sub Rowsup1()\n\nWith Selection.EntireRow\n    .Cut\n    .Offset(.Rows.count - 2).Insert\n    .Select\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I would like to prevent the selected row from moving above row 6.  I'm not exactly sure the best way to do this.  Any help would be much appreciated.</p>\n"}, {"tags": ["vba", "excel", "compiler-errors"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1516828610, "post_id": 48431332, "comment_id": 83854525, "body": "There is no such type as <code>Sheet</code> hence the error."}, {"owner": {"reputation": 3, "user_id": 9264171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7adaf35aca3eec1b572a30a29916162a?s=128&d=identicon&r=PG&f=1", "display_name": "J. Miller", "link": "https://stackoverflow.com/users/9264171/j-miller"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516830791, "post_id": 48431332, "comment_id": 83855642, "body": "Correct, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": -1, "last_activity_date": 1516827276, "creation_date": 1516827276, "answer_id": 48431418, "question_id": 48431332, "link": "https://stackoverflow.com/questions/48431332/private-sub-user-defined-type-not-defined-range-sheet/48431418#48431418", "title": "Private Sub User-Defined Type Not Defined Range Sheet", "body": "<p>Change <code>rangeSheet As Sheet</code> to <code>rangeSheet As Worksheet</code></p>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516829220, "post_id": 48431420, "comment_id": 83854846, "body": "FYI - <code>rangeSheet</code> can&#39;t be a <code>Sheet</code>, because there is no such object type as <code>Sheet</code>."}, {"owner": {"reputation": 3, "user_id": 9264171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7adaf35aca3eec1b572a30a29916162a?s=128&d=identicon&r=PG&f=1", "display_name": "J. Miller", "link": "https://stackoverflow.com/users/9264171/j-miller"}, "edited": false, "score": 0, "creation_date": 1516830765, "post_id": 48431420, "comment_id": 83855629, "body": "Thanks! Looking back that was really obvious and I can&#39;t believe I spent several hours trying to figure it out"}], "tags": [], "owner": {"reputation": 6686, "user_id": 9086466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JI5yN.png?s=128&g=1", "display_name": "Ctznkane525", "link": "https://stackoverflow.com/users/9086466/ctznkane525"}, "is_accepted": true, "score": 2, "last_activity_date": 1516827284, "creation_date": 1516827284, "answer_id": 48431420, "question_id": 48431332, "link": "https://stackoverflow.com/questions/48431332/private-sub-user-defined-type-not-defined-range-sheet/48431420#48431420", "title": "Private Sub User-Defined Type Not Defined Range Sheet", "body": "<p>You have two different data types:</p>\n\n<pre><code>Private Sub whyDoesntThisWork(rangeSheet As Sheet, rangeTable As Range)\n</code></pre>\n\n<p>rangeSheet is a Sheet, but when you call it, you pass:</p>\n\n<pre><code>Call whyDoesntThisWork(sht, rng)\n\nsht is of type WorkSheet\n</code></pre>\n\n<p>That's your inconsistency.  I recommend you change your definition to:</p>\n\n<pre><code>Private Sub whyDoesntThisWork(rangeSheet As WorkSheet, rangeTable As Range)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9264171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7adaf35aca3eec1b572a30a29916162a?s=128&d=identicon&r=PG&f=1", "display_name": "J. Miller", "link": "https://stackoverflow.com/users/9264171/j-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 48431420, "answer_count": 2, "score": 0, "last_activity_date": 1516827284, "creation_date": 1516826869, "last_edit_date": 1516827056, "question_id": 48431332, "link": "https://stackoverflow.com/questions/48431332/private-sub-user-defined-type-not-defined-range-sheet", "title": "Private Sub User-Defined Type Not Defined Range Sheet", "body": "<p>First post. I have the relatively simple code below and am getting a</p>\n\n<blockquote>\n  <p>User-defined type not defined</p>\n</blockquote>\n\n<p>error. I know that the stand alone code works when I place it into one Sub but for various reasons I want to split it out so that in my larger workbook I can just call on the second sub rather than having to copy and paste the whole loop multiple times. The purpose of the code is to autosize the specified range in excel.</p>\n\n<pre><code>Sub letsGo()\nDim rng As Range\nDim sht As Worksheet\nSet rng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"Range1\")\nSet sht = ThisWorkbook.Sheets(\"Sheet1\")\nCall whyDoesntThisWork(sht, rng)\nEnd Sub\n\nPrivate Sub whyDoesntThisWork(rangeSheet As Sheet, rangeTable As Range)\nDim Col As Range\nDim reSize As Range\nFor Each Col In rangeTable.Columns\n    If Col.Hidden = False Then\n        Set reSize = rangeSheet.Range(rangeSheet.Cells(rangeTable.Row, Col.Column), rangeSheet.Cells(rangeTable.Rows.Count, Col.Column)) reSize.Columns.autoFit\n    End If\nNext Col\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1516826839, "post_id": 48431313, "comment_id": 83853650, "body": "And that&#39;s what a loop is for :). Place all your FIND values in an array and iterate through that."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1516827032, "post_id": 48431313, "comment_id": 83853741, "body": "Create an array containing the different values you&#39;ll be looking for <code>MyArray = Array(&quot;New Food Price&quot;, &quot;New Wine Price&quot;)</code>, and then loop through the array <code>For i = LBound(MyArray) to UBound(MyArray)</code> performing your operations and substituting the hard coded values with your current array value <code>MyArray(i)</code>.  Give it a try and come back if you get stuck."}, {"owner": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516829854, "post_id": 48431313, "comment_id": 83855180, "body": "Hi Tigeravatar - I was able to get that to work! I am now stuck on something slightly more difficult and cannot figure out any work arounds. I am trying to do a vlookup based on my array. For example if MyArray is &quot;New Food&quot;, I am trying to do a vlookup with col_Index_Number based on &quot;Food Type&quot; from a different workbook. If MyArray is &quot;Price&quot;, I am trying to do a vlookup with col_Index_Number based on &quot;Price&quot; from a different workbook... do you know how I could accomplish this?"}], "answers": [{"comments": [{"owner": {"reputation": 2306, "user_id": 3437608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Wif9E.jpg?s=128&g=1", "display_name": "Cullub", "link": "https://stackoverflow.com/users/3437608/cullub"}, "edited": false, "score": 0, "creation_date": 1516827480, "post_id": 48431433, "comment_id": 83853966, "body": "A little explanation would be nice to go along."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1516827668, "last_edit_date": 1516827668, "creation_date": 1516827310, "answer_id": 48431433, "question_id": 48431313, "link": "https://stackoverflow.com/questions/48431313/replicating-code-30-times-with-slight-differences/48431433#48431433", "title": "Replicating code 30+ times with slight differences?", "body": "<p>Here you go!</p>\n\n<pre><code>Sub SearchAll()\n    Dim SearchTerms As Variant\n    SearchTerms = Array(\"US\", \"UK\", \"BR\")\n\n    For Each SearchTerm In SearchTerms\n        Search SearchTerm\n    Next\n\nEnd Sub\n\nSub Search(SearchTerm)\n    Dim rng As Range\n    Dim LR As Long\n    LR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    With Range(\"A1:FF1\")\n        Set rFind = .Find(What:=SearchTerm, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        If Not rFind Is Nothing Then\n            LastColumn = rFind.Column\n        End If\n    End With\n    ...\n    ...\nEnd Sub\n</code></pre>\n\n<p>And a short explanation, as requested:</p>\n\n<p>The first Sub creates an array of search terms. It is then stepped through, using a For Each. For each value the Search method is called with one parameter. This parameter is then used in the Find call.</p>\n"}], "owner": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 48431433, "answer_count": 1, "score": 0, "last_activity_date": 1516827949, "creation_date": 1516826776, "last_edit_date": 1516827949, "question_id": 48431313, "link": "https://stackoverflow.com/questions/48431313/replicating-code-30-times-with-slight-differences", "title": "Replicating code 30+ times with slight differences?", "body": "<p>I am wondering if it is possible to replicate my code 30 times with slight variations to FIND function, finding different items \"New Food Price, New Pizza Price, New Seafood Price.. Etc\" \nIf I was to copy the whole code 34 times it would be extremely long, and if anything changed I would have to change it 34 times. Is it at all possible to repeat majority of the code 34 times and just change the FIND word &amp; Formulas that are pasted? </p>\n\n<pre><code>Dim rng As Range\n  Dim LR As Long\nLR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nWith Range(\"A1:FF1\")\n    Set rFind = .Find(What:=\"US\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    If Not rFind Is Nothing Then\n        LastColumn = rFind.Column\n    End If\nEnd With\nSet rng = Range(Cells(2, LastColumn), Cells(2, LastColumn + 7))\nfinal_Column = Application.Match(\"New Food Price\", rng, 0)\nLastColumn = LastColumn + final_Column\nColumns(LastColumn).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nActiveSheet.Cells(2, LastColumn).Select\nActiveCell.Value = \"New Food Price\"\nActiveCell.Interior.ColorIndex = 22\n    Range(Cells(3, (LastColumn)), Cells(LR, (LastColumn))).Formula = \"=(5)\"\n    LastColumn = LastColumn + 1\n    Columns(LastColumn).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    ActiveSheet.Cells(2, LastColumn).Select\nActiveCell.Value = \"Difference\"\nActiveCell.Interior.ColorIndex = 22\n    Range(Cells(3, (LastColumn)), Cells(LR, (LastColumn))).Formula = \"=(6)\"\n\n\nSet rng = Range(Cells(2, LastColumn), Cells(2, LastColumn + 7))\nfinal_Column2 = Application.Match(\"New Wine Price\", rng, 0)\nLastColumn = LastColumn + final_Column2\nColumns(LastColumn).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nActiveSheet.Cells(2, LastColumn).Select\nActiveCell.Value = \"New Wine Price\"\nActiveCell.Interior.ColorIndex = 22\n    Range(Cells(3, (LastColumn)), Cells(LR, (LastColumn))).Formula = \"=(5)\"\n    LastColumn = LastColumn + 1\n    Columns(LastColumn).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    ActiveSheet.Cells(2, LastColumn).Select\nActiveCell.Value = \"Difference\"\nActiveCell.Interior.ColorIndex = 22\n    Range(Cells(3, (LastColumn)), Cells(LR, (LastColumn))).Formula = \"=(6)\"\n</code></pre>\n"}, {"tags": ["excel", "filter", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1516829861, "post_id": 48431259, "comment_id": 83855182, "body": "Yo should use a Table, with all your data, and then add a totals row (an option the Table Design Ribbon). That Totals Row will be always down."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1516831071, "post_id": 48431259, "comment_id": 83855790, "body": "Nope, I&#39;m not redesigning the whole thing into a table for your &quot;should&quot;.  The question is: 1) how can I exclude that row from sorting as it is and 2) Why is it including it in the sort in the first place?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1516848698, "post_id": 48431259, "comment_id": 83861204, "body": "I don&#39;t know how you are sorting, but when you delete the row your Total row is added to the data so when you sort it includes the Total row. If you just hide the row it will sort without the Total row.  Or you can set the specific range to sort."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "edited": false, "score": 0, "creation_date": 1517067736, "post_id": 48431259, "comment_id": 83947963, "body": "Thanks GMalc59 - that&#39;s precisely what I ended up doing, hiding the row.  If you add this as an answer to my question I will accept it as the solution."}], "owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516826581, "creation_date": 1516826581, "last_edit_date": 1531161705, "question_id": 48431259, "link": "https://stackoverflow.com/questions/48431259/excel-vba-after-row-delete-workheet-sorts-outside-of-filter", "title": "Excel VBA - After Row Delete Workheet Sorts Outside of Filter", "body": "<p>In the worksheet I'm currently working on I set up a filter to include all rows excluding the total row (I've red-boxed the blue numbers on the left that seem to identify the rows that are included in the filter range):</p>\n\n<p><a href=\"https://i.stack.imgur.com/EBktI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EBktI.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then after deleting the row between the total and the end of the worksheet (row 20) with:</p>\n\n<pre><code>Rows(iLastWizardRow - 1).EntireRow.Delete\n</code></pre>\n\n<p>the row deletes and it still appears to not be included in the filter:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fx3ld.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fx3ld.png\" alt=\"enter image description here\"></a></p>\n\n<p>However when I then sort the worksheet it includes row \"21\", which isn't even blue and appears not to be included in the filter:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KrJBq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KrJBq.png\" alt=\"enter image description here\"></a></p>\n\n<p>How do I exclude the total row from being sorted with the rest of the rows?  It looks like the filter already stops at row 20 so I don't know how to proceed.  Any help would be awesome.</p>\n"}, {"tags": ["vba", "excel", "csv", "userform"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9264083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4404fed493511a4fb5d7c887af090e3?s=128&d=identicon&r=PG&f=1", "display_name": "Hassen", "link": "https://stackoverflow.com/users/9264083/hassen"}, "edited": false, "score": 0, "creation_date": 1516885693, "post_id": 48431298, "comment_id": 83878588, "body": "Sam, Thank you for your response. I tried &amp; but it didn&#39;t work"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1516826718, "creation_date": 1516826718, "answer_id": 48431298, "question_id": 48430939, "link": "https://stackoverflow.com/questions/48430939/opening-csv-files-from-textbox/48431298#48431298", "title": "Opening CSV files from textbox", "body": "<p>Replace <code>+</code> with <code>&amp;</code> and it'll hopefully work better. The concatenation operator is &amp; in VBA </p>\n"}], "owner": {"reputation": 3, "user_id": 9264083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4404fed493511a4fb5d7c887af090e3?s=128&d=identicon&r=PG&f=1", "display_name": "Hassen", "link": "https://stackoverflow.com/users/9264083/hassen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516826718, "creation_date": 1516825206, "last_edit_date": 1516826141, "question_id": 48430939, "link": "https://stackoverflow.com/questions/48430939/opening-csv-files-from-textbox", "title": "Opening CSV files from textbox", "body": "<p>I am developing a user form as you can see below \n<a href=\"https://i.stack.imgur.com/buDqe.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>the code in the Browse Button is </p>\n\n<pre><code>Private Sub Browse_Click()\n\n    Dim fName As String\n        fName = Application.GetOpenFilename(\"CSV File (*.csv), *.csv\", , \"Import .CSV File\", , False)\n\n    If Not fName = \"False\" Then\n        TextBox1.Value = fName\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Next step is to choose some of these options and the code behind it is </p>\n\n<pre><code>Private Sub Start_Click()\n\n    Dim Actsheet As String\n    Dim wkbCrntWorkBook As Workbook\n    Dim wkbSourceBook As Workbook\n    Dim rngSourceRange As Range\n    Dim rngDestination As Range\n    Set wkbCrntWorkBook = ActiveWorkbook\n    Set rngDestination = wkbCrntWorkBook.ActiveSheet.Range(\"A1:A1\")\n\n\n    If myBeforeImprovements = True Then\n        Actsheet = \"Before \"\n    ElseIf AfterImprovements = True Then\n        Actsheet = \"After \"\n    Else\n        MsgBox (\"Select Type of Analysis\")\n        Exit Sub\n    End If\n\n\n    If Westbound = True Then\n        Actsheet = Actsheet &amp; \"WB\"\n    ElseIf Northbound = True Then\n        Actsheet = Actsheet &amp; \"NB\"\n    ElseIf Eastbound = True Then\n        Actsheet = Actsheet &amp; \"EB\"\n    ElseIf Southbound = True Then\n        Actsheet = Actsheet &amp; \"SB\"\n    Else\n        MsgBox (\"Select Traffic Bound\")\n        Exit Sub\n    End If\n</code></pre>\n\n<p>my problem is I can't take the CSV file to its write sheet which are\nBefore EB\nBefore WB\nBefore NB\nBefore SB\nAfter EB\nAfter WB\nAfter NB\nAfter SB</p>\n\n<p>maybe the following code will refer to the selected CSV file but it gives me an error</p>\n\n<pre><code>Workbooks.OpenText Filename:=TextBox1.Text + \",\" + ComboBox1.Value + \".txt\", _\nDataType:=xlDelimited, Tab:=True\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1516825214, "post_id": 48430888, "comment_id": 83852805, "body": "Thats not VB.NET and not even VB6 - it is Access-VBA"}, {"owner": {"reputation": 1172, "user_id": 5212157, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-Q_5hxD9mHKs/AAAAAAAAAAI/AAAAAAAAHBo/iiS12tFEHPQ/photo.jpg?sz=128", "display_name": "Chris Rutherford", "link": "https://stackoverflow.com/users/5212157/chris-rutherford"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1516825968, "post_id": 48430888, "comment_id": 83853195, "body": "oh gah..... sorry editing now."}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1516827057, "post_id": 48430888, "comment_id": 83853757, "body": "Yes, it runs a stored procedure in the database. <code>.CommandType = adCmdStoredProc         .CommandText = &quot;dbo.qryCfCorrespndMerge&quot;</code>. If 0 is not returned (0 is success for the sproc) then throw some errors. If successful then open the report form. Most of the other code changes UI elements to show the status or prevent the user from running the procedure multiple times or to reset the buttons after it runs. Difficult to troubleshoot what&#39;s going on in the sproc without the code."}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1516897770, "post_id": 48430888, "comment_id": 83887670, "body": "I would create a new question for your stored procedure issue. 1) This question has answers to the original question so most likely no one is going to see your addon, 2) each question on SO should be a single question anyway"}], "answers": [{"comments": [{"owner": {"reputation": 1172, "user_id": 5212157, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-Q_5hxD9mHKs/AAAAAAAAAAI/AAAAAAAAHBo/iiS12tFEHPQ/photo.jpg?sz=128", "display_name": "Chris Rutherford", "link": "https://stackoverflow.com/users/5212157/chris-rutherford"}, "edited": false, "score": 0, "creation_date": 1516831170, "post_id": 48431590, "comment_id": 83855866, "body": "yeah, this is not my own code. this is a custom app from a vendor, and I don&#39;t trust their skills. They&#39;re developing in Access FGS...."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1172, "user_id": 5212157, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-Q_5hxD9mHKs/AAAAAAAAAAI/AAAAAAAAHBo/iiS12tFEHPQ/photo.jpg?sz=128", "display_name": "Chris Rutherford", "link": "https://stackoverflow.com/users/5212157/chris-rutherford"}, "edited": false, "score": 0, "creation_date": 1516892246, "post_id": 48431590, "comment_id": 83883347, "body": "To debug, I would just comment out the on &quot;On Error&quot; lines and let it fly. I would imagine the database is tossing an error that isn&#39;t being sent back in the parameter(0) of the command return, but is like &quot;That object doesn&#39;t exist&quot; or &quot;Your credentials are wrong&quot; and it&#39;s being lost in all the poor attempts at error handling that are in here."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1172, "user_id": 5212157, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-Q_5hxD9mHKs/AAAAAAAAAAI/AAAAAAAAHBo/iiS12tFEHPQ/photo.jpg?sz=128", "display_name": "Chris Rutherford", "link": "https://stackoverflow.com/users/5212157/chris-rutherford"}, "edited": false, "score": 0, "creation_date": 1516892332, "post_id": 48431590, "comment_id": 83883416, "body": "Also, if this is vendor supplied code, you might want to consider deleting the question since they may claim it as copyrighted and cause a legal issue depending on how much of a pain in the ass they are."}, {"owner": {"reputation": 1172, "user_id": 5212157, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-Q_5hxD9mHKs/AAAAAAAAAAI/AAAAAAAAHBo/iiS12tFEHPQ/photo.jpg?sz=128", "display_name": "Chris Rutherford", "link": "https://stackoverflow.com/users/5212157/chris-rutherford"}, "edited": false, "score": 0, "creation_date": 1516892841, "post_id": 48431590, "comment_id": 83883766, "body": "Good Point. I&#39;m the sole dev, so if it&#39;s alright, I&#39;ll keep it up until I get what I need to resolve the issue..... There is no longer a relationship with that vendor, and the org I work for owns the code, from my understanding. (We were the reason they wrote it, poorly....)"}, {"owner": {"reputation": 1172, "user_id": 5212157, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-Q_5hxD9mHKs/AAAAAAAAAAI/AAAAAAAAHBo/iiS12tFEHPQ/photo.jpg?sz=128", "display_name": "Chris Rutherford", "link": "https://stackoverflow.com/users/5212157/chris-rutherford"}, "edited": false, "score": 0, "creation_date": 1516893761, "post_id": 48431590, "comment_id": 83884443, "body": "yeah, doesn&#39;t look like the SQL is going through. working with the SP, and it&#39;s failing with looking at the source table."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1172, "user_id": 5212157, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-Q_5hxD9mHKs/AAAAAAAAAAI/AAAAAAAAHBo/iiS12tFEHPQ/photo.jpg?sz=128", "display_name": "Chris Rutherford", "link": "https://stackoverflow.com/users/5212157/chris-rutherford"}, "edited": false, "score": 0, "creation_date": 1516894115, "post_id": 48431590, "comment_id": 83884713, "body": "That&#39;s good news. At least it&#39;s not the VBA that is failing :)"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1516828011, "creation_date": 1516828011, "answer_id": 48431590, "question_id": 48430888, "link": "https://stackoverflow.com/questions/48430888/how-to-debug-a-vb-file-thats-supposed-to-perform-sql-server-operations/48431590#48431590", "title": "How to debug a VB file that&#39;s supposed to perform SQL Server operations?", "body": "<p>Here's my attempt at making sense of this thing. Basically many of the errors are being caught and then either ignored or lost inside of variables that are never used. It's a hot mess of spaghetti.</p>\n\n<pre><code>Private Sub btnOK_Click()\n    On Error GoTo btnOK_Click_Err\n\n    'Declare a bunch of variables\n    Dim result\n    Dim sql As String\n    Dim mc As Integer   '* metercount\n    Dim mca As Integer  '* meter accumulator\n    Dim PostWhat As Integer\n    Dim CurPd As Integer, CurYr As Integer, NumSumHist As Integer\n    Dim i As Integer\n    Dim conPost As Connection\n    Dim sParam As String, userId As String, WrkStnId As String\n\n    'Not sure we why we are redim'ing an undim'd array...?\n    ReDim MsgLog(10) As String\n    Dim qn As Integer\n    Dim adocom As ADODB.Command\n    Dim gCurrencyId As String\n    Dim gLocId As String\n\n\n    'make an hourglass?\n    DoCmd.Hourglass True\n    'disable button to prevent multiple executions\n    Me!HaveYou.SetFocus\n    Me!BtnOk.Enabled = False\n\n\n\n    'Call the \"Preprocessing()\" function and get a boolean back\n    If Not Preprocessing() Then\n        DoCmd.Hourglass False\n        GoTo btnOK_Click_Exit\n    End If\n\n\n\n    'Here's the stuff you care about\n    'Make a new ADO command. ADO is the library we use to interact\n    'with databases in VBA.\n    Set adocom = New ADODB.Command\n    With adocom\n\n        'Using the adocom command obect\n        'Open a connection using the GetADOConnection() function (elsewhere in the vba I presume)\n        .ActiveConnection = GetADOConnection()\n        'Tell the command we will be running a proc on sql server\n        .CommandType = adCmdStoredProc\n\n        'This is the procedure we will be running\n        .CommandText = \"dbo.qryCfCorrespndMerge\"\n\n        'Don't timeout ever.\n        .CommandTimeout = 0\n\n        'Refresh the params... not sure here\n        .Parameters.Refresh\n\n        'Execute the command \n        .Execute , , adAsyncExecute\n\n        'Wait for it to finish. Not sure why you would call the proc\n        '   in async mode and then wait for it to finish... whatevs\n        Do While .State = adStateExecuting\n            DoEvents\n        Loop\n\n        'Check the result and if the first parameter is anything besides 0 then\n        ' something bad happened so raise a message box and call whatever\n        ' that GenGetMsg is (I assume another function/subroutine that isn'that\n        ' shared with this code dump)\n        If .Parameters(0) &lt;&gt; 0 Then\n            'Post Failed\n            Set adocom = Nothing\n            Call GenGetMsg(\"XXGenOpFailRef\", Me.Caption &amp; \"|\" &amp; .Parameters(0), \" \")\n            Call MsgBox(\"Correspondents Merge Failed\", gMsgType, gMsgTitle)\n            GoTo btnOK_Click_Exit\n        End If\n\n\n    End With\n\n    'Turn off the db connection\n    Set adocom = Nothing\n\n\nFinish_Post:\n\n    'If there is an error on the next block of code then\n    ' then go to the label called \"btnOK_Click_Err\"\n    On Error GoTo btnOK_Click_Err\n\n    'Call subroutine Lock_Cleanup which isn't shared in this\n    '    code dump\n    Lock_Cleanup\n\n    'Turn off the hourglass\n    DoCmd.Hourglass False\n\n    'Set the variable called \"result\" to whatever this message box is returning...\n    ' which makes no sense. The \"result = \" part can be removed probably\n    result = MsgBox(\"Correspondents merge  successfully finished !\", , gMsgTitle)\n    DoEvents\n\n\n    '* Open Report Form\n    DoCmd.OpenForm \"frmCfCorrMergeRpt\"\n    DoEvents\n\n\n\nbtnOK_Click_Exit:\n\n    'If there is an error in the next block of code\n    '   then continue on as if nothing bad happened\n    '   OP... this is a bad idea. Literally if your\n    '   app throws an error you will never know\n    '   which might be part of the problem?\n    '   remove this line and see if it throws an error\n    On Error Resume Next\n    'ensure that everything gets shut down/unlocked/reset/etc.\n    DoCmd.Hourglass False\n\n    'reenable buttons\n    Me!BtnOk.Enabled = True\n    Me!BtnOk.SetFocus\n\n    'End this routine\n    Exit Sub\n\n\nbtnOK_Click_Err:\n\n    'You are only here because there was an error\n    '   thrown after the Finish_Post label above\n    Select Case Err\n        'Not sure what this case statement is doing\n        'But.. assuming ELSE then collect the error\n        'into a bunch of variables.\n        Case Else\n            gErrMod = Me.Name\n            gErrProc = \"BtnOk_Click\"\n            gErrDesc = Error$\n            gErrCloseForm = Me.Name\n            gErrResult = GenErr(adocom.ActiveConnection)\n    End Select\n\n    'And go back up to this btnOK_Click_Exit\n    ' label. But.. then we don't do anything\n    ' with the variables we just collected\n    ' so the error is lost on Exit Sub up in that label\n    ' Perhaps a line like:\n    ' msgbox \"Error: \" &amp; gErrMod &amp; \"; Description: \" &amp; gerrDesc\n    ' would be illuminating here....\n    Resume btnOK_Click_Exit\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1172, "user_id": 5212157, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-Q_5hxD9mHKs/AAAAAAAAAAI/AAAAAAAAHBo/iiS12tFEHPQ/photo.jpg?sz=128", "display_name": "Chris Rutherford", "link": "https://stackoverflow.com/users/5212157/chris-rutherford"}, "edited": false, "score": 0, "creation_date": 1516831128, "post_id": 48432106, "comment_id": 83855831, "body": "Yeah I figured the VB wasn&#39;t doing the heavy lifting, I have access to get the SP but I&#39;m a little fuzzy on debugging and grokking the code. I&#39;m an amateur DB Admin only so I know how to query, but logic in SQL isn&#39;t my strong suit...... I&#39;m going to modify the question tomorrow when I&#39;m back in the office."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1516830230, "creation_date": 1516830230, "answer_id": 48432106, "question_id": 48430888, "link": "https://stackoverflow.com/questions/48430888/how-to-debug-a-vb-file-thats-supposed-to-perform-sql-server-operations/48432106#48432106", "title": "How to debug a VB file that&#39;s supposed to perform SQL Server operations?", "body": "<p>The main thing you need to debug likely is the stored procedure.</p>\n\n<p>These lines:</p>\n\n<pre><code>.CommandType = adCmdStoredProc\n.CommandText = \"dbo.qryCfCorrespndMerge\"\n</code></pre>\n\n<p>Specify that you're running a stored procedure, and which one it is.</p>\n\n<p>Then this section:</p>\n\n<pre><code>If .Parameters(0) &lt;&gt; 0 Then\n'Post Failed\n    Set adocom = Nothing\n    Call GenGetMsg(\"XXGenOpFailRef\", Me.Caption &amp; \"|\" &amp; .Parameters(0), \" \")\n    Call MsgBox(\"Correspondents Merge Failed\", gMsgType, gMsgTitle)\n    GoTo btnOK_Click_Exit\nEnd If\n</code></pre>\n\n<p>Checks an output parameter, and displays an error if it fails.</p>\n\n<p>All the more relevant code probably is inside that stored procedure. The code you shared is pretty much only calling it, waiting, and then displaying an error if it didn't run correctly.</p>\n\n<p>There are a lot of unused variables, commented out function calls, and other junk in there. You could try something like <a href=\"http://rubberduckvba.com/\" rel=\"nofollow noreferrer\">RubberDuckVBA</a> (open source, not affiliated) to refactor your code</p>\n"}], "owner": {"reputation": 1172, "user_id": 5212157, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-Q_5hxD9mHKs/AAAAAAAAAAI/AAAAAAAAHBo/iiS12tFEHPQ/photo.jpg?sz=128", "display_name": "Chris Rutherford", "link": "https://stackoverflow.com/users/5212157/chris-rutherford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 48432106, "answer_count": 2, "score": 0, "last_activity_date": 1516892744, "creation_date": 1516824962, "last_edit_date": 1592644375, "question_id": 48430888, "link": "https://stackoverflow.com/questions/48430888/how-to-debug-a-vb-file-thats-supposed-to-perform-sql-server-operations", "title": "How to debug a VB file that&#39;s supposed to perform SQL Server operations?", "body": "<p>I have a VB script that is part of an Access App that interfaces with a SQL Server database. I know what it's supposed to do, but I don't really understand VB (I'm more of a C-like language guy).</p>\n<p>Here is the function, from what I can tell:</p>\n<pre><code>Private Sub btnOK_Click()\n    On Error GoTo btnOK_Click_Err\n\n    Dim result\n    Dim sql As String\n    Dim mc As Integer   '* metercount\n    Dim mca As Integer  '* meter accumulator\n    Dim PostWhat As Integer\n    Dim CurPd As Integer, CurYr As Integer, NumSumHist As Integer\n    Dim i As Integer\n    Dim conPost As Connection\n    Dim sParam As String, userId As String, WrkStnId As String\n    ReDim MsgLog(10) As String\n    Dim qn As Integer\n    Dim adocom As ADODB.Command\n    Dim gCurrencyId As String\n    Dim gLocId As String\n    \n    \n    DoCmd.Hourglass True\n    'disable button to prevent multiple executions\n    Me!HaveYou.SetFocus\n    Me!BtnOk.Enabled = False\n    \n    \n    \n\n    If Not Preprocessing() Then\n        DoCmd.Hourglass False\n        GoTo btnOK_Click_Exit\n    End If\n    \n    \n    \n    \n    Set adocom = New ADODB.Command\n    With adocom\n        .ActiveConnection = GetADOConnection()\n        .CommandType = adCmdStoredProc\n        .CommandText = &quot;dbo.qryCfCorrespndMerge&quot;\n        .CommandTimeout = 0\n        .Parameters.Refresh\n        '  If Not gDevYn Then Application.Run &quot;StartServerStatus&quot;, &quot;EDI Create SO Transaction &quot;, 1000\n        .Execute , , adAsyncExecute\n        Do While .State = adStateExecuting\n            DoEvents\n        Loop\n        'If Not gDevYn Then Application.Run &quot;StopServerStatus&quot;, &quot;EDI Create SO Transaction &quot;\n     \n        If .Parameters(0) &lt;&gt; 0 Then\n            'Post Failed\n            Set adocom = Nothing\n            Call GenGetMsg(&quot;XXGenOpFailRef&quot;, Me.Caption &amp; &quot;|&quot; &amp; .Parameters(0), &quot; &quot;)\n            Call MsgBox(&quot;Correspondents Merge Failed&quot;, gMsgType, gMsgTitle)\n            GoTo btnOK_Click_Exit\n        End If\n    End With\n    Set adocom = Nothing\n   \n   \nFinish_Post:\n    On Error GoTo btnOK_Click_Err\n   \n    \n    Lock_Cleanup\n    \n    DoCmd.Hourglass False\n    'result = GenGetMsg(&quot;ArPostTransComplete&quot;, &quot; &quot;, &quot; &quot;)\n    result = MsgBox(&quot;Correspondents merge  successfully finished !&quot;, , gMsgTitle)\n    DoEvents\n    \n   \n    '* Open Report Form\n    DoCmd.OpenForm &quot;frmCfCorrMergeRpt&quot;\n    DoEvents\n\n    \n\nbtnOK_Click_Exit:\n    On Error Resume Next\n    'ensure that everything gets shut down/unlocked/reset/etc.\n    DoCmd.Hourglass False\n    \n    'reenable buttons\n    Me!BtnOk.Enabled = True\n    Me!BtnOk.SetFocus\n    Exit Sub\n\n\nbtnOK_Click_Err:\n    Select Case Err\n        Case Else\n            gErrMod = Me.Name\n            gErrProc = &quot;BtnOk_Click&quot;\n            gErrDesc = Error$\n            gErrCloseForm = Me.Name\n            gErrResult = GenErr(adocom.ActiveConnection)\n    End Select\n    Resume btnOK_Click_Exit\n\nEnd Sub\n</code></pre>\n<p>What's supposed to happen is the user clicks the print button and the app gathers all the data that is needed to print from the SQL Server database, however, it either goes nowhere, does nothing, or throws an error stating there is nothing to print. Aside from the potential for this to be a database procedure issue, What is this code doing? Is there any pull from a DB somewhere?</p>\n<h2>Update:</h2>\n<p>After some analysis it's been determined that the issue is stemming from the SP on the SQL Database, the SP is as follows: (commented out code has been removed for brevity)</p>\n<pre><code>ALTER           proc [dbo].[qryCfCorrespndMerge]\nas\ndeclare @i int\ndeclare @x int\ndeclare @j int\ndeclare @k int\ndeclare @kk int\ndeclare @InmateId varchar (10) \ndeclare @Gender char (1) \ndeclare @Language varchar (2)\ndeclare @Region varchar(2)\nset nocount on\n\ncreate table #tmpOutsider\n (\n    id int identity(1,1) not null  primary key,\n    PersonId varchar (10) NOT NULL ,\n    Gender char (1) NULL ,\n    Language varchar (2) NULL ,\n    NumAvailCont int null default 0,\n    AreaRegion varchar (2) NULL,\n    LastUpdated datetime ,\n    MergeCount int default(0)\n    \n    \n) \ncreate table #tmpInmate\n (\n    id int identity(1,1) not null  primary key,\n    PersonId varchar (10) NOT NULL ,\n    Gender char (1) NULL ,\n    Language varchar (2) NULL ,\n    NumAvailCont int null default 0,\n    AreaRegion varchar (2) NULL, \n    LastUpdated datetime,\n    MergeCount int default(0)   \n    \n) \nbegin tran\n    set @i=0\n    \n    -- Outsiders (insert list of outsides who still write to fewer inmates than requested)\n    insert into  #tmpOutsider(PersonId,Gender ,Language  ,NumAvailCont,AreaRegion,LastUpdated,MergeCount)\n    \n    select  p.PersonId,Gender ,Language ,(MaxContactNum -isnull(c.ContactNum,0)) as availCont ,AreaRegion ,ISNULL(c.LastUpdateDate,p.DateCreated),isnull(ContactNum,0)\n    \n    from  dbo.tblCfPerson p left outer join \n        (select CorrespId,count(CorrespId)ContactNum , Max(LastUpdateDate) LastUpdateDate \n        from dbo.tblCfContacts \n            group by CorrespId) c -- number of inmates already linked\n        on p.personid=c.CorrespId\n        where Type='O' and p.MaxContactNum&gt;isnull(c.ContactNum,0)\n    order by isnull(c.ContactNum,0) ,ISNULL(c.LastUpdateDate,p.DateCreated) -- use last merged date if null use date added\n\n    -- if no outsiders than return\n    select @i=count(*) from #tmpOutsider\n    if  @i=0\n        begin\n        return 10 -- no outsiders\n    end\n\n    \n\n        -- INMATES (insert list of insiders who still write to fewer outsiders than requested\n    insert into  #tmpInmate(PersonId,Gender ,Language ,NumAvailCont,AreaRegion,LastUpdated,MergeCount)\n    select p.PersonId,Gender ,Language  ,(MaxContactNum -isnull(c.ContactNum,0)) as availCont ,AreaRegion,ISNULL(c.LastUpdateDate,p.DateCreated),isnull(c.ContactNum,0) \n    from  dbo.tblCfPerson p left outer join \n        (select InmateId,count(InmateId) as ContactNum ,Max(LastUpdateDate) LastUpdateDate from dbo.tblCfContacts group by InmateId) c\n    on p.personid=c.InmateId\n    where Type='I' and p.MaxContactNum&gt;isnull(c.ContactNum,0)\n    order by isnull(c.ContactNum,0),isnull(c.LastUpdateDate,p.DateCreated)\n\n    -- if no insiders than return\n    select @i=0\n    select @i=count(*) from #tmpInmate\n    if  @i=0\n        begin\n        return 20 -- no inmates\n    end\n\n\n    WHILE (SELECT COUNT(*) FROM #tmpInmate) &gt; 0\n            BEGIN\n        SELECT @I=0\n            SELECT @I=(SELECT TOP 1 [ID] FROM (SELECT TOP 100 PERCENT [ID] FROM #tmpInmate ORDER BY MergeCount, LastUpdated) x)\n        \n        SELECT @gender=gender,@language=language,@region=arearegion,@InmateId=personid\n        FROM #tmpInmate where [ID]=@i    \n        SELECT @I=ISNULL(@I,0)      \n\n            SELECT @j=0         \n        SELECT @j=(SELECT TOP 1 [ID] FROM   \n              (SELECT TOP 100 PERCENT [ID] FROM #tmpOutsider t\n               WHERE t.gender=@gender\n               and t.language=@language\n               and t.arearegion &lt;&gt; @region\n               and t.personid not in (select distinct CorrespId from tblCfContacts where inmateid=@inmateid)        \n               ORDER BY t.MergeCount,t.LastUpdated) x)\n\n                SELECT @j=ISNULL(@J,0)  \n        \n        IF @j&lt;&gt; 0 \n            BEGIN\n             INSERT into dbo.tblCfContacts(InmateId,CorrespId,LastUpdateDate,Lang)\n             select @inmateid,t.personid,getDate(),@language\n             from #tmpoutsider t where id=@j            \n              \n             UPDATE #tmpInmate SET NumAvailCont=NumAvailCont-1, MergeCount=MergeCount+1,LastUpdated=GetDate() WHERE [ID]=@I\n             UPDATE #tmpOutsider SET NumAvailCont=NumAvailCont-1,MergeCount=MergeCount+1, LastUpdated=GetDate() WHERE [ID]=@J           \n\n                 DELETE #tmpInmate WHERE NumAvailCont=0\n             DELETE #tmpOutsider WHERE NumAvailCont=0\n\n            END\n        ELSE\n            BEGIN\n              DELETE FROM #tmpInmate WHERE [Id]=@I     \n            END             \n        \n            \n        END \n\ncommit tran\nreturn 0\n</code></pre>\n<p>Is there anything in this SQL script that could potentially cause problems? What kind of parameters is this expecting? I know it's setting two temporary tables, then running some calculations. (I've never debugged someone else's SQL before either. Any resources for that?</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 21519, "user_id": 639716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/NN38X.png?s=128&g=1", "display_name": "pete", "link": "https://stackoverflow.com/users/639716/pete"}, "edited": false, "score": 1, "creation_date": 1516824094, "post_id": 48430573, "comment_id": 83852222, "body": "Could you possibly add some relevant macro code to your question (so we might see <i>which</i> subscript is out of range)?"}, {"owner": {"reputation": 13, "user_id": 9264054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d639c780b3623030abd1a24ba6d0cda?s=128&d=identicon&r=PG&f=1", "display_name": "drstrangequark", "link": "https://stackoverflow.com/users/9264054/drstrangequark"}, "reply_to_user": {"reputation": 21519, "user_id": 639716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/NN38X.png?s=128&g=1", "display_name": "pete", "link": "https://stackoverflow.com/users/639716/pete"}, "edited": false, "score": 0, "creation_date": 1516824344, "post_id": 48430573, "comment_id": 83852379, "body": "Yup, just added it."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9264054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d639c780b3623030abd1a24ba6d0cda?s=128&d=identicon&r=PG&f=1", "display_name": "drstrangequark", "link": "https://stackoverflow.com/users/9264054/drstrangequark"}, "edited": false, "score": 0, "creation_date": 1516826057, "post_id": 48430965, "comment_id": 83853236, "body": "That did it! Thanks so much!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1516825308, "creation_date": 1516825308, "answer_id": 48430965, "question_id": 48430573, "link": "https://stackoverflow.com/questions/48430573/adding-macros-in-a-csv-file/48430965#48430965", "title": "Adding macros in a CSV file", "body": "<pre><code>Sub Insert_StartDate()\n\n    With Workbooks(\"Activity File (White Collar 1).csv\").Sheets(1).Range(\"J2:J13\")\n        .Value = Date\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9264054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d639c780b3623030abd1a24ba6d0cda?s=128&d=identicon&r=PG&f=1", "display_name": "drstrangequark", "link": "https://stackoverflow.com/users/9264054/drstrangequark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 48430965, "answer_count": 1, "score": -1, "last_activity_date": 1516870745, "creation_date": 1516823511, "last_edit_date": 1516870745, "question_id": 48430573, "link": "https://stackoverflow.com/questions/48430573/adding-macros-in-a-csv-file", "title": "Adding macros in a CSV file", "body": "<p>I have a CSV file where I need to add a macro to insert the current date. I know you can't add a macro into a CSV so I stored it in a separate macro enabled .xlsm file. However when I try to run the macro I get a \"Subscript out of range\" error. How can I make this work?</p>\n\n<p>Here is the code that is run:</p>\n\n<pre><code>Sub Insert_StartDate()\n'\n' Insert_StartDate Macro\n' Inserts the current date into the StartDate fields\n'\n' Keyboard Shortcut: Ctrl+d\n'\n    Windows(\"Book1\").Activate\n    Range(\"J2\").Select\n    Windows(\"Activity File (White Collar 1).csv\").Activate\n    Range(\"J2\").Select\n    ActiveCell.FormulaR1C1 = \"=TODAY()\"\n    Range(\"J2\").Select\n    Selection.Copy\n    Range(\"J2:J13\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 8, "creation_date": 1516819919, "post_id": 48429625, "comment_id": 83849894, "body": "You should close your <code>If</code> with <code>End If</code>. <a href=\"//stackoverflow.com/q/37564915\">If then Else Excel VBA - &quot;End If&quot; needed?</a>"}, {"owner": {"reputation": 1275, "user_id": 3597095, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/60709793/picture?type=large", "display_name": "obizues", "link": "https://stackoverflow.com/users/3597095/obizues"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1516819995, "post_id": 48429625, "comment_id": 83849929, "body": "Yep, that was it.  Not sure how I missed that."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516820316, "post_id": 48429625, "comment_id": 83850082, "body": "What does this do? <code>Range(&quot;Ai+1&quot;).Select</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516823102, "post_id": 48429625, "comment_id": 83851623, "body": "&quot;I assume that my &#39;If&#39; statement doesn&#39;t know that it&#39;s done&quot; - precisely: you begin an <code>If</code> block but never terminate it - hence the compiler &quot;thinks&quot; <code>Next</code> is part of the <code>If</code> block, can&#39;t find a corresponding <code>For</code> statement, and blows up saying exactly that: there&#39;s a <code>Next</code> statement that shouldn&#39;t be there. All block syntax work the same way, and they can&#39;t be intertwined (i.e. you can&#39;t start a <code>For</code> loop, begin an <code>If</code> block, then close the <code>For</code> loop with a <code>Next</code>, and then somewhere further down close the <code>If</code> block with <code>End If</code>)"}, {"owner": {"reputation": 531, "user_id": 6254149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1UvBh.jpg?s=128&g=1", "display_name": "Moreno", "link": "https://stackoverflow.com/users/6254149/moreno"}, "edited": false, "score": 0, "creation_date": 1516825434, "post_id": 48429625, "comment_id": 83852904, "body": "There should be questions that result interesting and useful for this community and this could be avoided by checking the code 2 more seconds"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 3, "last_activity_date": 1516820328, "creation_date": 1516820328, "answer_id": 48429771, "question_id": 48429625, "link": "https://stackoverflow.com/questions/48429625/excel-vba-next-without-for-error/48429771#48429771", "title": "Excel VBA Next without For error", "body": "<p>As commented, you need <code>End IF</code>, but I also made some slight improvements:</p>\n\n<pre><code>Sub test()\nnumRows = 11\nFor i = 0 To numRows\n    If Cells(i + 1, 2) &gt;= 0 Then\n        With Sheets(\"Sheet1\")\n            .Range(.Cells(1, i + 1), .Cells(2, i + 1)).Copy\n        End With\n        Sheets(\"PasteLocation\").Range(\"A\" &amp; i + 1).Paste\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong> Change <code>Sheets(\"Sheet1\")</code> to the appropriate sheet name.</p>\n"}, {"tags": [], "owner": {"reputation": 1275, "user_id": 3597095, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/60709793/picture?type=large", "display_name": "obizues", "link": "https://stackoverflow.com/users/3597095/obizues"}, "is_accepted": true, "score": 0, "last_activity_date": 1517855066, "creation_date": 1517855066, "answer_id": 48629081, "question_id": 48429625, "link": "https://stackoverflow.com/questions/48429625/excel-vba-next-without-for-error/48629081#48629081", "title": "Excel VBA Next without For error", "body": "<p>The answer is in the first comment under my original question by user <a href=\"https://stackoverflow.com/users/669576/johnny-mopp\">Johnny Mopp</a></p>\n\n<blockquote>\n  <p>You should close your If with End If. If then Else Excel VBA - \"End If\" needed?</p>\n</blockquote>\n"}], "owner": {"reputation": 1275, "user_id": 3597095, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/60709793/picture?type=large", "display_name": "obizues", "link": "https://stackoverflow.com/users/3597095/obizues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 48629081, "answer_count": 2, "score": 0, "last_activity_date": 1517855066, "creation_date": 1516819706, "question_id": 48429625, "link": "https://stackoverflow.com/questions/48429625/excel-vba-next-without-for-error", "title": "Excel VBA Next without For error", "body": "<p>I am getting a \"Next Without for Error on the following code:</p>\n\n<pre><code>sub test()\n  numRows = 11\n  For i = 0 To numRows\n    If Cells(i + 1, 2) &gt;= 0 Then\n        Range((Cells(A, i + 1)), Cells(B, i + 1)).Select\n        Selection.Copy\n        Sheets(\"PasteLocation\").Activate\n        Range(\"Ai+1\").Select\n        Selection.Paste\n  Next\nEnd Sub\n</code></pre>\n\n<p>I assume that my \"If\" statement doesnt know that it's done and that the \"Next\" command thinks there should be another nested \"for\" in the \"if\" statement but I do not know where.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 3, "creation_date": 1516819681, "post_id": 48429580, "comment_id": 83849783, "body": "<code>= &#39;C*&#39;</code> looks for the exact string <code>&quot;C*&quot;</code> instead use <code>LIKE &#39;C*&#39;</code> which looks for anything beginning with <code>C</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1516819825, "post_id": 48429580, "comment_id": 83849852, "body": "Thank you. Typed in  LIKE &#39;C*&#39;  and got ODBC Call falied.  Incorrect syntax near &#39;C&#39;   LIKE C* returns nothing.  Thanks"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1516821316, "post_id": 48429580, "comment_id": 83850590, "body": "If you did it right it should have worked: <code>Select ItemCode, ItemDescription From MyTable Where ItemType LIKE &#39;C*&#39;</code>. The only other thing (and it is very unlikely) is that the way you connect your tables from SQL server means you have to use SQL server wildcard <code>%</code> instead of MS Access wildcard <code>*</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "edited": false, "score": 0, "creation_date": 1516826575, "post_id": 48429580, "comment_id": 83853533, "body": "I see, thank you. I was trying to type it in the combo box. Is there any way to do that?  They don&#39;t want to change the way the report works now. It still needs to be able to look it up on an item by item basis.  It is in SQL Server."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1516827683, "post_id": 48429580, "comment_id": 83854085, "body": "Why are you filtering the RowSource? Let the combobox AutoExpand property work for you. Do you want to allow input of values not in the list?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "edited": false, "score": 0, "creation_date": 1516830254, "post_id": 48429580, "comment_id": 83855376, "body": "Why are you filtering the RowSource?  - I didn&#39;t create this app.  Do you want to allow input of values not in the list? - It&#39;s just pulling a report, so I don&#39;t see why not?  Let the combobox AutoExpand property work for you. - I&#39;ll have to look into that. I don&#39;t work much in Access so I&#39;m not sure what you mean. Thanks."}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 2, "creation_date": 1516844695, "post_id": 48429580, "comment_id": 83860298, "body": "I believe the comments above are confusing the RowSource with the value of the combo-box and how it is being used. The RowSource just populates the combo-box list. What you type into the combo-box is used elsewhere (you said it filters a report). What is the ControlSource of the combo-box? How is the report referencing this combo-box value? E.g. is a report using a filter like <code>Field1 = Forms!Form1!Combo1</code>? Typing <code>Like &#39;C*&#39;</code> can&#39;t work in that case. But you can change it to <code>Field1 LIKE Forms!Form1!Combo1</code> and it will now accept criteria such as <code>C*</code>."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 1, "creation_date": 1516847788, "post_id": 48429580, "comment_id": 83860994, "body": "It would be best to update the actual question with complete and correct details.  It is confusing to provide the details only in the comments, and Stack Overflow is best when the questions are updated so they can help others without trudging through the comments.  The question says &quot; It&#39;s passing parameters&quot;, but there is no indication of parameters in the SQL statements.  What parameters?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "edited": false, "score": 0, "creation_date": 1517000930, "post_id": 48429580, "comment_id": 83932848, "body": "Thank you. I updated the original question. I&#39;m sorry I thought someone told me not to do that."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1517516931, "creation_date": 1517516931, "answer_id": 48571202, "question_id": 48429580, "link": "https://stackoverflow.com/questions/48429580/allowing-wildcards-in-access-query/48571202#48571202", "title": "Allowing Wildcards in Access Query", "body": "<p>Something like this should do it:</p>\n\n<pre><code>\"Like '*'\"\n</code></pre>\n\n<p>OR . . . </p>\n\n<pre><code>If IsNull(Me.txtFirstName.Value) Then\n    strFirstName = \"Like '*'\"\nElse\n    SelectCase Me.fraFirstName.Value\n        Case 1\n            strFirstName = \"Like '\" &amp; Me.txtFirstName.Value &amp; \"*'\"\n        Case 2\n            strFirstName = \"Like '*\" &amp; Me.txtFirstName.Value &amp; \"*'\"\n        Case 3\n            strFirstName = \"Like '*\" &amp; Me.txtFirstName.Value &amp; \"'\"\n        Case 4\n            strFirstName = \"= '\" &amp; Me.txtFirstName.Value &amp; \"'\"\n    End Select\nEnd If\n</code></pre>\n\n<p>FINALLY . . . \nThe link below should help you a lot!</p>\n\n<p><a href=\"https://www.fontstuff.com/access/acctut19.htm\" rel=\"nofollow noreferrer\">https://www.fontstuff.com/access/acctut19.htm</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517516931, "creation_date": 1516819516, "last_edit_date": 1517000958, "question_id": 48429580, "link": "https://stackoverflow.com/questions/48429580/allowing-wildcards-in-access-query", "title": "Allowing Wildcards in Access Query", "body": "<p>I was wondering if someone could help me with this. I have a form in Access that has a combo box to look up an item number. Right now the Row Source is something like </p>\n\n<pre><code>  Select ItemCode, ItemDescription From MyTable Where ItemType = 'G'\n</code></pre>\n\n<p>I would like to change it to allow a wild card.  So right now if you type in C* it will not work. How do I make that work?  Do I just update it to say </p>\n\n<pre><code>Select ItemCode From MyTable Where ItemType = 'G' \n</code></pre>\n\n<p>or is there more to it?  </p>\n\n<p>It's calling a query which is calling a SQL database.  It's passing parameters like the date and itemcode.   </p>\n\n<p>It's calling a pass-through query to the database That looks like this...</p>\n\n<p>pt_JobAnalysis '12/26/2017' , '01/26/2018' , '' , '10516' , ''</p>\n\n<p>sSQL = sProcedureName &amp; \" '\" &amp; Me.txtFrom &amp; \"' , '\" &amp; Me.txtTo &amp; \"'\"</p>\n\n<p>Thank you so much. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1516820078, "post_id": 48429575, "comment_id": 83849977, "body": "If the xltm file didn&#39;t already have sheets with the same names, you could simply use <code>xlWkb.Worksheets.Copy After:=xlWkb2.Worksheets(1)</code> - no need for a loop"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 3, "last_activity_date": 1516820678, "last_edit_date": 1516820678, "creation_date": 1516819660, "answer_id": 48429620, "question_id": 48429575, "link": "https://stackoverflow.com/questions/48429575/copying-all-sheets-from-one-workbook-to-another/48429620#48429620", "title": "Copying all sheets from one workbook to another", "body": "<p>First of all, remove the lines that have <code>Activate</code> and <code>Select</code> on them and restructure it more like this:</p>\n\n<pre><code>For k = 1 To xlWkb.Worksheets.Count\n    xlWkb.WorkSheets(k).Cells.Copy\n    xlWkb2.WorkSheets(\"Sheet\" &amp; k).Range(\"A1\").Paste \n    xlWkb2.WorkSheets(\"Sheet\" &amp; k).Name = xlWkb.WorkSheets(k).Name\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 4376511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86534c0e4dfe0ae1b2c7b876d3b20c53?s=128&d=identicon&r=PG&f=1", "display_name": "brz", "link": "https://stackoverflow.com/users/4376511/brz"}, "is_accepted": false, "score": 2, "last_activity_date": 1516819999, "creation_date": 1516819999, "answer_id": 48429693, "question_id": 48429575, "link": "https://stackoverflow.com/questions/48429575/copying-all-sheets-from-one-workbook-to-another/48429693#48429693", "title": "Copying all sheets from one workbook to another", "body": "<p>Please, find next <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/sheets-copy-method-excel\" rel=\"nofollow noreferrer\">API</a></p>\n\n<pre><code>Sheets(\"SheetName\").Copy Before:=Workbooks(\"WorkbookName\").Sheets(1)\nWorkbooks(\"WorkbookName\").Sheets(1).Name = Sheets(\"SheetName\").Name\n</code></pre>\n\n<p>This method Copy entire Worksheet with formatting, range names, values, formulas.. etc.</p>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 48429620, "answer_count": 2, "score": 0, "last_activity_date": 1516820678, "creation_date": 1516819479, "last_edit_date": 1531164843, "question_id": 48429575, "link": "https://stackoverflow.com/questions/48429575/copying-all-sheets-from-one-workbook-to-another", "title": "Copying all sheets from one workbook to another", "body": "<p>I have an XLTM Template and an xlsx workbook.</p>\n\n<p>The XLSX workbook has around 300-400 sheets. </p>\n\n<p>I am looking to copy sheets from XLSX to XLSM Template.</p>\n\n<p>What is the fastest way to do it?</p>\n\n<p>I would like to have the same <strong>sheet name and formats along with the values</strong>.</p>\n\n<p>Here is a copy of the code that I am using,</p>\n\n<pre><code>For k = 1 To xlWkb.Worksheets.Count\n    xlWkb.Activate\n    xlWkb.Sheets(k).Select\n    xlWkb.Sheets(k).Cells.Copy\n\n    xlWkb2.Activate\n    xlWkb2.Sheets(\"Sheet\" &amp; k).Select\n    xlWkb2.Sheets(\"Sheet\" &amp; k).Range(\"A1\").Select\n    xlWkb2.ActiveSheet.Paste ' changes the column width and all, I want those formats\n\n    xlWkb2.Sheets(\"Sheet\" &amp; k).Name = xlWkb.Sheets(k).Name\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516818172, "post_id": 48429138, "comment_id": 83848982, "body": "You only need to use <code>Scripting.Dictionary</code> for late binding. They are indeed the same thing."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516819568, "post_id": 48429138, "comment_id": 83849719, "body": "@braX - Not entirely true. Late binding syntax would be different <code>Dim dict as Object</code> then <code>Set dict = CreateObject(&quot;Scripting.Dictionary&quot;)</code>. Think it&#39;s important to clarify that."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 1, "creation_date": 1516819821, "post_id": 48429138, "comment_id": 83849851, "body": "you have to include the MS Scripting run time in your project for dictionary usage.  Early and late binding have different behaviors, such as the use of intellisense (early binding) in the VB editor.  There is also something about coding with early binding for development and then late binding before deployment to users with different versions of the application, may not be applicable here. <a href=\"http://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-dictionary</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1516820589, "post_id": 48429138, "comment_id": 83850209, "body": "FWIW that <i>literal joke</i> is up on GitHub. Feel free to improve it!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1516829203, "post_id": 48429138, "comment_id": 83854835, "body": "IMO, your <i>&#39;really great resource&#39;</i> is a good place to pick up tips and a bad place to learn how to write code."}, {"owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516830467, "post_id": 48429138, "comment_id": 83855472, "body": "@Mat&#39;sMug Hmm... As an excel-jockey in over his head posting anything to the ivory tower of MSDN feels wrong to me. I may add some examples or something though..."}, {"owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516830827, "post_id": 48429138, "comment_id": 83855663, "body": "@Rory I agree, but that&#39;s <a href=\"http://www.snb-vba.eu/index_en.html\" rel=\"nofollow noreferrer\">by design</a>.  They just write the minimum code to illustrate the principle, it&#39;s up to you to adapt it to your situation learn coding standards."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1516830929, "post_id": 48429138, "comment_id": 83855717, "body": "Yes but he actually codes like that too..."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1516820707, "post_id": 48429685, "comment_id": 83850272, "body": "<code>Range</code> won&#39;t confuse VBA at all; it might confuse <i>the reader</i> - VBA just resolves <code>Range</code> as it&#39;s told, i.e. accordingly with the priority order defined by the <i>tools/references</i> dialog. +1 for everything else :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1516821970, "post_id": 48429685, "comment_id": 83850975, "body": "Thanks for the clarification @Mat&#39;sMug. I edited to say what I was really trying to say :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 4, "last_activity_date": 1516821958, "last_edit_date": 1516821958, "creation_date": 1516819970, "answer_id": 48429685, "question_id": 48429138, "link": "https://stackoverflow.com/questions/48429138/are-as-dictionary-and-as-scripting-dictionary-equivalent-for-vba-early-bind/48429685#48429685", "title": "Are &quot;As Dictionary&quot; and &quot;As Scripting.Dictionary&quot; equivalent (for VBA early binding)?", "body": "<p>As @braX said in your specific use case (early binding) it's the same thing and thus the <code>Scripting.</code> can be left off. </p>\n\n<p>However, there are cases where it may be helpful (or even needed). For example, if you were manipulating Excel in another Office app, you would (using early binding) write </p>\n\n<pre><code>Dim XL as Excel.Application\n</code></pre>\n\n<p>because you need to tell VBA which application, specifically, to use.</p>\n\n<p>But you could go on to write </p>\n\n<pre><code>Dim myWB as Workbook\n</code></pre>\n\n<p>and VBA will know it's excel work. However, it may be more user-friendly to write</p>\n\n<pre><code>Dim myWB as Excel.Workbook\n</code></pre>\n\n<p>That way it's <em>totally clear</em> what is going on. </p>\n\n<p>Now, in the case of a workbook, to most programmers, it's already clear, and that's fine, but what if you are in programming in Word and want to manipulate a Range object in Excel. Writing </p>\n\n<pre><code>Dim myRange as Range\n</code></pre>\n\n<p>may not work as you think it will because VBA will resolve it as a Word Range Object (since you are writing in Word - see MatMug's answer for better explanation), which will then lead to errors further down the code line when you refer to <code>myRange.Offset(1)</code>, for example, because there is no <code>Offset</code> method of Word Range Object. So in this case, it's both necessary and user-friendly.</p>\n"}, {"comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 6, "creation_date": 1516826094, "post_id": 48429809, "comment_id": 83853255, "body": "Note that the qualification can lead to a different behavior in some cases. For instance <code>VBA.Array()</code> is always Base 0 while <code>Array()</code> takes the base defined by <code>Option Base</code> which is zero by default."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 3, "creation_date": 1516826243, "post_id": 48429809, "comment_id": 83853342, "body": "@FlorentB. that&#39;s correct, but IMO also a bloody evil &quot;feature&quot; - I don&#39;t see <i>legitimate</i> reasons to hate VBA (99% of the time it&#39;s about the VBIDE), but <b>this</b> is definitely one of them =)"}, {"owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 0, "creation_date": 1516826586, "post_id": 48429809, "comment_id": 83853538, "body": "Very well explained. I will probably go with <code>As Dictionary</code> because I think it&#39;s easier to <i>read</i> function declarations that fit on your screen, and if I ever decide to write a class named <code>Dictionary</code> I will probably <i>want it</i> to supersede Scripting.Dictionary. Your answer inspired me to speed test, and it looks like there&#39;s a tiny but consistent speed improvement with <code>Scripting.Dictionary</code>; I assume this is b/c VBA doesn&#39;t have to check libraries for a dictionary object. Are there any other (common) libraries w/ a dictionary object that could mess up my code in the future?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 2, "creation_date": 1516826815, "post_id": 48429809, "comment_id": 83853634, "body": "@nateAtwork that speed test can&#39;t possibly be conclusive - the binding occurs at compile time, not run-time; that would be <i>late</i> binding, and late binding should be expected to be somewhat slower, although I doubt it would be observable (hint: anything declared <code>As Object</code> or <code>As Variant</code> will be bound at run-time, that&#39;s why you don&#39;t get intellisense on anything that returns <code>Object</code> or <code>Variant</code>). As for common libs, not that I know of. ADO and DAO have very similar types, and Word&#39;s <code>Range</code> famously clashes with Excel&#39;s."}, {"owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 0, "creation_date": 1516827068, "post_id": 48429809, "comment_id": 83853765, "body": "@Mat&#39;sMug Usually, yes.  But sometimes it can be useful.  In the case of <code>Application.InputBox</code> and <code>InputBox</code> <a href=\"https://stackoverflow.com/questions/42015700/what-are-the-benefits-and-risks-of-using-the-strptr-function-in-vba\">you can only differentiate between the user clicking cancel and entering nothing with the latter (thanks to an error by Microsoft)</a> ."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1516827441, "post_id": 48429809, "comment_id": 83853943, "body": "<code>InputBox</code> is an entirely different thing - one is a function defined in the <code>VBA.Interaction</code> module from the standard library (which is always top-priority), the other is a function defined in the <code>Excel.Application</code> class, defined in the Excel type library (which is always 2nd priority) - so far we were talking about <i>qualifying types</i>, but <code>Application.InputBox</code> is a <i>member call</i> - <code>Application</code> being a property of the <code>Excel.Global</code> hidden module, returning an <code>Excel.Application</code> instance. <a href=\"https://i.stack.imgur.com/l80Q7.png\" rel=\"nofollow noreferrer\">My Rubberduck add-in can tell you this</a>"}, {"owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 1, "creation_date": 1516832298, "post_id": 48429809, "comment_id": 83856395, "body": "@Mat&#39;sMug I think I follow what you&#39;re saying here, but can you fix the link in your comment (it sounds like a great tool...) &amp;/or recommend another resource that explains the general construction of the VBA language?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 1, "creation_date": 1516832409, "post_id": 48429809, "comment_id": 83856460, "body": "@nateAtwork the link merely points to a screenshot of the Rubberduck command bar showing details about the current selection; see <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">rubberduckvba.com</a> and/or the links in my profile. I don&#39;t know of any other tool that has as deep an understanding of the code in the VBIDE, but I&#39;m possibly biased ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "edited": false, "score": 1, "creation_date": 1516833103, "post_id": 48429809, "comment_id": 83856805, "body": "@nateAtwork FWIW the project is extremely active, don&#39;t hesitate to <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/new\" rel=\"nofollow noreferrer\">create a new issue</a> if you have feature ideas, bug reports, or just to give props to the team =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 14, "last_activity_date": 1600630820, "last_edit_date": 1600630820, "creation_date": 1516820479, "answer_id": 48429809, "question_id": 48429138, "link": "https://stackoverflow.com/questions/48429138/are-as-dictionary-and-as-scripting-dictionary-equivalent-for-vba-early-bind/48429809#48429809", "title": "Are &quot;As Dictionary&quot; and &quot;As Scripting.Dictionary&quot; equivalent (for VBA early binding)?", "body": "<blockquote>\n<p><em>I don't see why I should be doing extra typing just to make my function declarations more crowded [...]</em></p>\n</blockquote>\n<p>That would be what we call <em>fully qualifying</em> a type (or function/procedure call, depending on context). When you do this:</p>\n<pre><code>Dim foo As Range\n</code></pre>\n<p>The type <code>Range</code> gets resolved in a very specific order, determined by the <em>priority</em> order, in the <em>references</em> dialog:</p>\n<p><img src=\"https://i.stack.imgur.com/VkY0a.png\" alt=\"Tools/References dialog\" /></p>\n<p>If the top-most type library that exposes a <code>Range</code> type is the <code>Excel</code> type library, then <code>Range</code> stands for <code>Excel.Range</code>.</p>\n<p>If you meant that to be <code>Word.Range</code>, then you have a bug, and fully-qualifying the declared types prevents this.</p>\n<p>The <code>Scripting</code> library exposes a <code>Dictionary</code> class. So when you reference the <code>Scripting</code> type library and do this:</p>\n<pre><code>Dim foo As Dictionary\n</code></pre>\n<p>You have all rights to expect that type to resolve to <code>Scripting.Dictionary</code>. But then if you add a class module and name it <code>Dictionary</code>, suddenly all these unqualified declarations are now referring to this custom class, because VBA type resolution will always prioritize types defined in the current project before looking at external references.</p>\n<p>There are pros and cons to both approaches:</p>\n<ul>\n<li>Fully-qualifying types avoids ambiguity when referencing type libraries that expose same-name classes: it enhances readability.</li>\n<li><em>Not</em> qualifying types makes it easier to swap a class for another, e.g. replacing <code>Scripting.Dictionary</code> with a <a href=\"https://github.com/timhall/VBA-Dictionary\" rel=\"nofollow noreferrer\">portable <code>Dictionary</code> implementation</a> that works on a Mac.</li>\n</ul>\n<p>Rule of thumb, programming isn't about <em>writing</em> code, it's... mostly about <em>reading</em> code! Write code that's easy to read, not code that's quick to write - your future self will thank you later!</p>\n"}, {"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1576111820, "post_id": 59296026, "comment_id": 104796677, "body": "On my system <i>none</i> of this is true.  For me, <code>Dictionary</code> and <code>Scripting.Dictionary</code> are completely interchangeable"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1576115084, "post_id": 59296026, "comment_id": 104797310, "body": "@chrisneilsen tested &amp; seconded. The only way to get a type mismatch is to have a <code>Dictionary</code> user class in the <code>VBAProject</code>."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576129758, "post_id": 59296026, "comment_id": 104800459, "body": "May be he uses Word? Or has a Word reference on top of Scripting.A watch would reveal the type."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576129771, "post_id": 59296026, "comment_id": 104800464, "body": "@mat or as per your A, a higher priority reference to a type with a Dictionary definition.   Maybe that&#39;s what&#39;s going on here.   VTD (as misinformation)?"}], "tags": [], "owner": {"reputation": 361, "user_id": 4342523, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/prlew.jpg?s=128&g=1", "display_name": "Mathematician", "link": "https://stackoverflow.com/users/4342523/mathematician"}, "is_accepted": false, "score": -3, "last_activity_date": 1576110179, "creation_date": 1576110179, "answer_id": 59296026, "question_id": 48429138, "link": "https://stackoverflow.com/questions/48429138/are-as-dictionary-and-as-scripting-dictionary-equivalent-for-vba-early-bind/59296026#59296026", "title": "Are &quot;As Dictionary&quot; and &quot;As Scripting.Dictionary&quot; equivalent (for VBA early binding)?", "body": "<p>All these answers say right things but are ultimately wrong.  Let's find out why.  Here are some reasons why you might say that Scripting.Dictionary and Dictionary are the same:</p>\n\n<ul>\n<li>Both are provided by the Microsoft Scripting Runtime reference.</li>\n<li>Both are managed dictionaries and have similar interfaces</li>\n</ul>\n\n<p>Why might we say they're different?  Consider:</p>\n\n<pre><code>Sub frontEnd()\n    Dim dictA As Scripting.Dictionary\n    Dim dictB As Dictionary\n\n    Set dictA = backEnd()\n    Set dictB = backEnd()\nEnd Sub\n\n\nFunction backEnd() As Scripting.Dictionary\n    Dim myDict As Scripting.Dictionary\n    Set myDict = New Scripting.Dictionary\n\n    myDict(\"foo\") = \"bar\"\n    myDict(\"bar\") = \"foo\"\n\n    Set backEnd = myDict\nEnd Function\n</code></pre>\n\n<p>Run this code and you'll find that VBA gives you a \"type mismatch\" error.  So, apparently, one cannot assign a Scripting.Dictionary to a variable of type Dictionary.  That alone is reason for me to regard these two types as different.  Note this is transparent for those of us who use Variant for everything under the sun, but for those of us who program with Option Explicit, this is a strong reason why we should regard these two types as different.</p>\n\n<p>Furthermore, the interfaces may be similar, but they are definitely not the same!  Consider:</p>\n\n<pre><code>Sub frontEnd()\n    Dim dictA As Scripting.Dictionary\n    Dim dictB As Dictionary\n\n    Set dictA = backEnd()\n    Set dictB = altBackEnd()\nEnd Sub\n\n\nFunction backEnd() As Scripting.Dictionary\n    Dim myDict As Scripting.Dictionary\n    Set myDict = New Scripting.Dictionary\n\n    myDict(\"foo\") = \"bar\"\n    myDict(\"bar\") = \"foo\"\n\n    Set backEnd = myDict\nEnd Function\n\n\nFunction altBackEnd() As Dictionary\n    Dim myDict As Dictionary\n    Set myDict = New Dictionary\n\n    myDict(\"foo\") = \"bar\"\n    myDict(\"bar\") = \"foo\"\n\n    Set altBackEnd = myDict\nEnd Function\n</code></pre>\n\n<p>Oh, oh!  There's a \"Key not found\" error in the altBackEnd() function.  Apparently, a Scripting.Dictionary will allow you to create a Key/Item pair implicitly using the dict(\"foo\") = \"bar\" semantic, but a Dictionary requires you to use the dict.add() method.  Like this:</p>\n\n<pre><code>Sub frontEnd()\n    Dim dictA As Scripting.Dictionary\n    Dim dictB As Dictionary\n\n    Set dictA = backEnd()\n    Set dictB = altBackEnd()\nEnd Sub\n\n\nFunction backEnd() As Scripting.Dictionary\n    Dim myDict As Scripting.Dictionary\n    Set myDict = New Scripting.Dictionary\n\n    myDict(\"foo\") = \"bar\"\n    myDict(\"bar\") = \"foo\"\n\n    Set backEnd = myDict\nEnd Function\n\n\nFunction altBackEnd() As Dictionary\n    Dim myDict As Dictionary\n    Set myDict = New Dictionary\n\n    myDict.Add Key:=\"foo\", Value:=\"bar\"\n    myDict.Add Key:=\"bar\", Value:=\"foo\"\n\n    Set altBackEnd = myDict\nEnd Function\n</code></pre>\n\n<p>As a last demonstration why these types are different, try replace backEnd() with this version and see what happens:</p>\n\n<pre><code>Function backEnd() As Scripting.Dictionary\n    Dim myDict As Scripting.Dictionary\n    Set myDict = New Scripting.Dictionary\n\n    myDict.Add Key:=\"foo\", Value:=\"bar\"\n    myDict.Add Key:=\"bar\", Value:=\"foo\"\n\n    Set backEnd = myDict\nEnd Function\n</code></pre>\n\n<p>Hint: apparently a Dictionary uses a Key/Value pair, but a Scripting.Dictionary uses a Key/Item pair.</p>\n\n<p>As a final homework assignment, get the program to work, post a breakpoint, and use the VBE to look at the structure of both your Scripting.Dictionary and your Dictionary.  Notice that they are implemented differently!</p>\n\n<p>Conclusions: Dictionary and Scripting.Dictionary...</p>\n\n<ol>\n<li>are not compatible in VBA call semantics.</li>\n<li>do not have the same external interface.</li>\n<li>do not have the same internal interface.</li>\n</ol>\n\n<p>Ergo, despite the fact that both are provided by the Microsoft Scripting Runtime reference, they are different.</p>\n\n<p>You're better off using Scripting.Dictionary because it has a much richer interface than Dictionary (e.g. a Scripting.Dictionary has a Remove() and RemoveAll() method, while the Dictionary does not.)</p>\n"}], "owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2928, "favorite_count": 1, "accepted_answer_id": 48429809, "answer_count": 3, "score": 3, "last_activity_date": 1600630820, "creation_date": 1516817928, "last_edit_date": 1531164843, "question_id": 48429138, "link": "https://stackoverflow.com/questions/48429138/are-as-dictionary-and-as-scripting-dictionary-equivalent-for-vba-early-bind", "title": "Are &quot;As Dictionary&quot; and &quot;As Scripting.Dictionary&quot; equivalent (for VBA early binding)?", "body": "<p>When creating a dictionary object using early binding and the Microsoft Scripting Runtime Library, it looks like there are 2 equivalent type names for the same thing:</p>\n\n<pre><code>Dim dict as Dictionary\nSet dict = New Dictionary\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Dim dict as Scripting.Dictionary\nSet dict = new Scripting.Dictionary\n</code></pre>\n\n<p>appear to do the same thing (at least so far).</p>\n\n<p>I see the <code>As Scripting.Dictionary</code> syntax used <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">by this resource</a>, and I see the <code>As Dictionary</code> syntax used <a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html#L_22.2\" rel=\"nofollow noreferrer\">by this (really great) resource</a>, but I haven't seen a comparison anywhere.  And the MSDN documentation on dictionaries is either <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/dictionary-object\" rel=\"nofollow noreferrer\">a literal joke</a>, or <a href=\"https://msdn.microsoft.com/en-us/library/xfhwa508(v=vs.110).aspx\" rel=\"nofollow noreferrer\">not explicitly related to VBA</a>.</p>\n\n<p>I don't see why I should be doing extra typing just to make my function declarations more crowded if I can just use <code>As Dictionary</code>, but I have learned that some things in VBA that look like they are equivalent can actually have subtle but significant differences (<code>Application.InputBox</code> vs. <code>InputBox</code> for example).</p>\n\n<p>Is there is really no difference between these, or are there subtle differences that I should be aware of?</p>\n"}, {"tags": ["vba", "web-scraping"], "comments": [{"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1516817177, "post_id": 48428895, "comment_id": 83848437, "body": "I would suggest searching for something called fiddler web debugger. It will allow you to see all the requests and responses that occur. Hopefully one of them will contain the information you want. Then you can try to write some code to send the request to get that information."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516817267, "post_id": 48428895, "comment_id": 83848485, "body": "If you&#39;re using VBA then automating IE might be a good approach.  Likely you&#39;re not seeing the content you expect because the page is built dynamically after loading the original response."}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516817315, "post_id": 48428895, "comment_id": 83848515, "body": "Can we do it using selenium? Or can we not get all the tags (nodes) and go through it one by one ? just a thought but I wouldn&#39;t know how to go about it. I most probably be wrong."}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516817468, "post_id": 48428895, "comment_id": 83848602, "body": "@Tim I am using IE automation it doesn&#39;t give me the actual page content as I believe its hidden by Script."}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "reply_to_user": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1516817685, "post_id": 48428895, "comment_id": 83848720, "body": "@garbb I don&#39;t think I can get access to this app as I work in office. But definitely can give it a go at my house. but for now I need the real solution using only what I got which is excel."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516817803, "post_id": 48428895, "comment_id": 83848787, "body": "What content are you trying to obtain specifically? It appears pretty scrapable to me."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516817921, "post_id": 48428895, "comment_id": 83848855, "body": "If you should your current code someone may have suggestions.  Without knowing what you&#39;re <i>actually doing</i> it&#39;s pretty difficult to offer anything."}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516818387, "post_id": 48428895, "comment_id": 83849103, "body": "I am using very basic code to get the source code, &#39;internetdata.body.innerHTML = .responseText&#39;                                           Try to find  &quot;Strong and silent&quot; which is available on the page but not in source page."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516818456, "post_id": 48428895, "comment_id": 83849137, "body": "It is available in the source code under the class name <code>wc-rich-content-description</code>"}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516818686, "post_id": 48428895, "comment_id": 83849265, "body": "@ Davis Yes in element you could find it, but is not available in source code. I have certain keywords which I want to look in the whole page so I cannot just look into some specific class or id or paragraph. Any suggestion? Am I missing anything here? or is there anyways to go through all the class and ID one by one to look for the keywords?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1516821473, "post_id": 48428895, "comment_id": 83850696, "body": "Where is your code with which you have tried and failed? At least post here something to get a refined one @Suman Kumar."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1516821740, "post_id": 48428895, "comment_id": 83850836, "body": "Btw, every single element of that page can easily be accessed using IE. All you need to do is put a little delay to let the webpage load it&#39;s content. That&#39;s it.."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516825036, "post_id": 48428895, "comment_id": 83852720, "body": "&quot;I am using very basic code to get the source code&quot; - maybe that&#39;s your problem, but if you refuse to post it we&#39;ll all lose interest..."}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516826685, "post_id": 48428895, "comment_id": 83853586, "body": "@william sorry william for the hassel I have added the code above for the source code that I am using..is there any other way to go through all the contents of web page?"}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1516833333, "post_id": 48432720, "comment_id": 83856902, "body": "In comment <code>8</code> you requested about the text within <code>&quot;Strong and silent&quot;</code>. Now going through your post again I can see that you expect all the content. What do you wanna grab actually. Btw, to execute the above code make sure to add reference to the library: <code>Microsoft Internet Controls</code> and <code>Microsoft HTML Object Library</code>."}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516833881, "post_id": 48432720, "comment_id": 83857143, "body": "@ Sahin Thanks for the effort Sahin, but when I say whole content it actually meant all of it...including heading paragraphs...etc whatever we can see on the page.I wanna look for keywords (I have got around 500 keywords) to look into the web page, I wanna find if that keyword is available on the page, if not available I want to flag that keyword."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516834204, "post_id": 48432720, "comment_id": 83857272, "body": "Do you want to get all the content within this class <code>wc-rich-content-description</code>? Be specific man!! Your earlier comment is too broad."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516834605, "post_id": 48432720, "comment_id": 83857435, "body": "See the update. I&#39;ve already edited. Btw, did you execute the earlier one?"}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516835593, "post_id": 48432720, "comment_id": 83857777, "body": "sorry if I am sounding too vague, the class name that you have mentioned is too specific I have got multiple web pages, Anyways I am logging out from office, I will get back to you tomorrow. If the class name is consistent (which I didn&#39;t notice..oops) with all URLs. I will sign off and rate it answered. Thanks for all the time you gave here:)"}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516882858, "post_id": 48432720, "comment_id": 83876694, "body": "Hi Shahin, Yes I executed the code and it works, this question came out because of my negligence, I would like to thank Shahin for feeding the answer to me by spoon :p. I am an idiot PERIOD!"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1516883121, "post_id": 48432720, "comment_id": 83876875, "body": "No offense meant. Thanks."}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 1, "last_activity_date": 1516834541, "last_edit_date": 1516834541, "creation_date": 1516832695, "answer_id": 48432720, "question_id": 48428895, "link": "https://stackoverflow.com/questions/48428895/how-to-scrape-data-from-web-when-source-file-doesnt-have-the-content-of-web-pag/48432720#48432720", "title": "How To Scrape data from web when source file doesn&#39;t have the content of web page", "body": "<p>Try this. It should fetch you all the description of each product:</p>\n\n<pre><code>Sub Web_Data()\n    Dim IE As New InternetExplorer, html As HTMLDocument\n    Dim topic As Object\n\n    With IE\n        .Visible = True\n        .navigate \"http://www.webcollage.net/MainApp/preview-ppp?module=dellbtoc&amp;site=epartner&amp;wcpc=1512144817149&amp;view=live&amp;rcpName=Webcollage\"\n        While .Busy = True Or .readyState &lt; 4: DoEvents: Wend\n        Set html = .document\n    End With\n\n    Application.Wait Now + TimeValue(\"00:00:05\") ''if you haven't found your data already, just increase the time\n\n    For Each topic In html.getElementsByClassName(\"wc-rich-content-description\")\n        r = r + 1: Cells(r, 1) = topic.innerText\n    Next topic\n\n    IE.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 48432720, "answer_count": 1, "score": 1, "last_activity_date": 1516834541, "creation_date": 1516816896, "last_edit_date": 1516826605, "question_id": 48428895, "link": "https://stackoverflow.com/questions/48428895/how-to-scrape-data-from-web-when-source-file-doesnt-have-the-content-of-web-pag", "title": "How To Scrape data from web when source file doesn&#39;t have the content of web page", "body": "<p>I tried to scrape data from <a href=\"http://www.webcollage.net/MainApp/preview-ppp?module=dellbtoc&amp;site=epartner&amp;wcpc=1512144817149&amp;view=live&amp;rcpName=Webcollage\" rel=\"nofollow noreferrer\">here</a>, but problem I am facing is that its source code doesn't contain the content which are available on web page. I believe its scripted.</p>\n\n<p>How do I get it? I got the suggestion that to use selenium? Any other suggestion I could get from you guys it would be very helpful. Thanks.</p>\n\n<pre><code>With xhr\n\n            .Open \"GET\", URL, False\n            .send\n\n            If .readyState = 4 And .Status = 200 Then\n                Set internetdata = New MSHTML.HTMLDocument\n                internetdata.body.innerHTML = .responseText\n                htmlT = internetdata.body.outerHTML\n\n\n            Else\n                MsgBox \"Error\" &amp; vbNewLine &amp; \"Ready state: \" &amp; .readyState &amp; _\n                vbNewLine &amp; \"HTTP request status: \" &amp; .Status\n            End If\n\n        End With\n</code></pre>\n\n<p>from this code (string) I am trying to get all the text available on web page. But not getting all the content here.</p>\n"}, {"tags": ["vba", "ms-word", "wildcard", "boolean-logic"], "comments": [{"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1516818028, "post_id": 48428538, "comment_id": 83848908, "body": "So you have a macro you&#39;re running in Word?  You should share the code so we can understand what you&#39;re really doing."}, {"owner": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 1, "creation_date": 1516818309, "post_id": 48428538, "comment_id": 83849063, "body": "Excellent point. Adding it to the OP now."}, {"owner": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1516818630, "post_id": 48428538, "comment_id": 83849232, "body": "Everything works, I get the highlights and later the exports I want. The only problem I&#39;m having is writing the wildcard string to capture all words within quotes that are within parentheses. So far I can return everything in quotes, or I can return everything within parenthesis, but not both!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516820011, "post_id": 48429573, "comment_id": 83849940, "body": "Hmm that&#39;s a clever approach! I can&#39;t seem to format it in a way that doesn&#39;t throw errors. I&#39;m not a regex expert and I&#39;m certainly not a word advanced search expert but it seems like this should be possible just in one string!. Setting a variable for true and then highlighting words with both true would work too I&#39;m sure, but probably sends me down the road towards further syntax problems as this is definitely not my arena.   Mostly just wanted to say thanks for your contribution. I&#39;d be so stoked to get this working!"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516820233, "post_id": 48429573, "comment_id": 83850046, "body": "It may be possible in a single command but it&#39;s harder to isolate issue when you attempt to accomplish more than one thing per step."}, {"owner": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516821470, "post_id": 48429573, "comment_id": 83850695, "body": "For sure, I&#39;m open to whatever actually gets the result. I just don&#39;t know how to begin making your suggestion actually work in practice, though I concede it&#39;s a great approach. Maybe someone can come along and help me turn that into syntactically solid code.  Thanks again for your help!"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516823954, "post_id": 48429573, "comment_id": 83852160, "body": "When you said &quot;So far I can return everything in quotes, or I can return everything within parenthesis, but not both!&quot; I assumed that you could apply the two strings that yielded this comment."}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 0, "last_activity_date": 1516820162, "last_edit_date": 1516820162, "creation_date": 1516819474, "answer_id": 48429573, "question_id": 48428538, "link": "https://stackoverflow.com/questions/48428538/microsoft-word-vba-wildcard-string/48429573#48429573", "title": "Microsoft Word VBA Wildcard String", "body": "<p>Maybe run your function twice in your sub:</p>\n\n<pre><code>Sub findfunction()\n  found = False\n  If findHL(ActiveDocument.Content, [wildcard string for condition A]) = True Then found = True\n  If findHL(ActiveDocument.Content, [wildcard string for condition B]) = True Then found = True\n  If found = True Then MsgBox \"Done\", vbInformation + vbOKOnly, \"Result\"\nEnd Sub\n</code></pre>\n\n<p>I don't see how any of this exports to Excel though</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516826751, "post_id": 48430167, "comment_id": 83853613, "body": "OUTSTANDING. Thank you so much! Since it&#39;s now clear that you are absurdly awesome at this. Would it be possible to only do it up to a certain page number somehow? Specifically after some point page numbers change from 1,2,3, to F-1, F-2, F-3; Is there a way I can program it to ignore those?   Either way you are absolutely amazing and just made my day!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516826830, "post_id": 48430167, "comment_id": 83853648, "body": "I take it the page numbering changes with Section Breaks? So you could test which section the Range is in?"}, {"owner": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516828582, "post_id": 48430167, "comment_id": 83854515, "body": "Theoretically it would, but I plan on using this on many different documents with different numbers of sections between them, in a different order, titled differently etc, but only for sure thing I know after the pages switch to F-#, I&#39;m not interested in reviewing them haha.   I can&#39;t thank you enough for your help! It&#39;s amazing! I have a follow up question but at this point I feel like I&#39;m taking advantage!"}, {"owner": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516829076, "post_id": 48430167, "comment_id": 83854760, "body": "Come to think of it, forget the page numbers - I can manually just take care of that. If you had 5 minutes to help me craft one that highlights words that are capitalized but are not the first word of a sentence and highlight those, that would be amazing (as in forgetting about the quotes and parenthesis, just a new question). Can&#39;t thank you enough, you&#39;ve been so helpful!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516830639, "post_id": 48430167, "comment_id": 83855561, "body": "Well, don&#39;t forget to mark &quot;the answer&quot; before you ask your new question :-) But remember this is StackOverflow - it&#39;s not a free coding service. Writing code is actually what I get paid for... And it usually takes longer than five minutes!"}, {"owner": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516831594, "post_id": 48430167, "comment_id": 83856073, "body": "So now I have a different problem: Your fantastic code indeed highlights my content according to the rule. Later I use a different code to export that content into Excel, which seems to no longer pull the highlights made by the new code. I&#39;m not very experienced with VBA or Word, but does your code highlight things &#39;differently&quot; than mine did?   Provide me some contact info as well, I have many little projects like this I&#39;d be happy to hire someone to help with."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "edited": false, "score": 0, "creation_date": 1516832427, "post_id": 48430167, "comment_id": 83856468, "body": "I don&#39;t think  my code highlights any differently than yours did.. but at 11 pm local time I can&#39;t do any investigating. You can find my contact information in my mvp profile: <a href=\"https://mvp.microsoft.com/en-us/PublicProfile/7287?fullName=Cindy%20%20Meister\" rel=\"nofollow noreferrer\">mvp.microsoft.com/en-us/PublicProfile/&hellip;</a>"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1516821911, "creation_date": 1516821911, "answer_id": 48430167, "question_id": 48428538, "link": "https://stackoverflow.com/questions/48428538/microsoft-word-vba-wildcard-string/48430167#48430167", "title": "Microsoft Word VBA Wildcard String", "body": "<p>The following works for me. But I don't believe it can be done with a \"simple\" Find/Replace. What I had to do was locate each instance, then \"walk\" the range backwards to see if I can find an opening parenthesis, then forwards to find a closing parenthesis - always checking that no intervening closing resp. opening parenthesis is present. Only then can the highlighting be applied.</p>\n\n<p>In order to do this, three separate Range objects are required: one for the search, one for the found range and one to test going backwards/forwards.</p>\n\n<pre><code>Sub findfunction()\n  If (findHL(ActiveDocument.content, _\n      \"(\" &amp; ChrW(8220) &amp; \")(*)(\" &amp; ChrW(8221) &amp; \")\")) = True Then\n     MsgBox \"Done\", vbInformation + vbOKOnly, \"Result\"\n  End If\nEnd Sub\n\nFunction findHL(r As Range, s As String) As Boolean\n    Dim success As Boolean\n    Dim foundRange As word.Range\n    Dim testRange As word.Range\n    Dim moved As Long\n\n  success = False\n  Set foundRange = r.Duplicate\n  Options.DefaultHighlightColorIndex = wdYellow\n  r.Find.Replacement.Highlight = True\n  Do\n    success = foundRange.Find.Execute(findText:=s, MatchWildcards:=True, _\n                 wrap:=wdFindStop, Format:=True)\n    If success Then\n        r.Start = foundRange.End\n        Set testRange = foundRange.Duplicate\n        moved = testRange.MoveStartUntil(\"()\", wdBackward)\n        If moved &lt; 0 Then\n            testRange.MoveStart wdCharacter, -1\n            If Left(testRange, 1) = \"(\" Then\n                moved = testRange.MoveEndUntil(\")\", wdForward)\n                If moved &gt; 0 Then\n                    testRange.MoveEnd wdCharacter, 1\n                    If Right(testRange, 1) = \")\" Then\n                      foundRange.HighlightColorIndex = wdYellow\n                    End If\n                End If\n            End If\n        End If\n    End If\n  Loop While success = True\n  findHL = True\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9253473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcdd1a9188f2fa1a277fff46b5c393d?s=128&d=identicon&r=PG&f=1", "display_name": "clearlynotstefan", "link": "https://stackoverflow.com/users/9253473/clearlynotstefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 1, "accepted_answer_id": 48430167, "answer_count": 2, "score": 0, "last_activity_date": 1516821911, "creation_date": 1516815447, "last_edit_date": 1516819354, "question_id": 48428538, "link": "https://stackoverflow.com/questions/48428538/microsoft-word-vba-wildcard-string", "title": "Microsoft Word VBA Wildcard String", "body": "<p>long story short I'm using a script that highlights words that use a certain format and then exporting them to excel. I can't seem to use Word's built in wildcard system to get the results I'm looking for (I'm not very familiar with it), but I am close! </p>\n\n<p>I'm looking to extract definitions that fall in a certain format inline:</p>\n\n<p>This is the sample text (the \"sample\") for you (\"helpful person\" or \"HP\") to use, this \"should be\" possible.</p>\n\n<p>My string should capture sample, helpful person, and HP above (but not \"should be\"). Which is to say all text in quotes between parenthesis. </p>\n\n<p>Currently I can manage to pull everything between smart or straight quotes with this:</p>\n\n<pre><code>    (\" &amp; ChrW(8220) &amp; \")(*)(\" &amp; ChrW(8221) &amp; \") \n</code></pre>\n\n<p>[the char numbers are for angled quotes]</p>\n\n<p>This of course returns strings that are in quotes even without those quotes being nested in parenthesis. </p>\n\n<p>Can anyone get me on the right track? Thanks so much! </p>\n\n<p>Note that the rest of the script is using MSwords wildcard system, <em>not</em> regex, so changing to regex is out :(. </p>\n\n<p>The full script here just highlights the words that match the string:</p>\n\n<pre><code>Sub findfunction()\n  If (findHL(ActiveDocument.Content, \"(\" &amp; ChrW(8220) &amp; \")(*)(\" &amp; ChrW(8221) &amp; \")\")) = True Then _\n     MsgBox \"Done\", vbInformation + vbOKOnly, \"Result\"\nEnd Sub\n\nFunction findHL(r As Range, s As String) As Boolean\n  Options.DefaultHighlightColorIndex = wdYellow\n  r.Find.Replacement.Highlight = True\n  r.Find.Execute FindText:=s, MatchWildcards:=True, _\n                 Wrap:=wdFindContinue, Format:=True, _\n                 replacewith:=\"\", Replace:=wdReplaceAll\n  findHL = True\nEnd Function\n</code></pre>\n\n<p>Thanks again. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1516818565, "post_id": 48428158, "comment_id": 83849203, "body": "Why can&#39;t you just format column 1 to Wrap Text?"}, {"owner": {"reputation": 101, "user_id": 3214807, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22bbcf90abbb8c3685d96e395ee2849d?s=128&d=identicon&r=PG&f=1", "display_name": "CJanon", "link": "https://stackoverflow.com/users/3214807/cjanon"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1516848004, "post_id": 48428158, "comment_id": 83861045, "body": "I did but I wanted to eliminate the extra spaces created when autofit and wrap is applied, so I added line breaks to control the output when printed"}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 1, "last_activity_date": 1516819031, "creation_date": 1516819031, "answer_id": 48429444, "question_id": 48428158, "link": "https://stackoverflow.com/questions/48428158/inserting-line-break-to-the-nearest-space-after-a-set-of-character-length-is-set/48429444#48429444", "title": "Inserting Line Break to the nearest space after a set of character length is set", "body": "<p>Try this</p>\n\n<pre><code>With Columns(1)\n    .ColumnWidth = 75\n    .Font.Name = \"Arial\"\n    .Font.Size = 9\n    .WrapText = True\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5246919, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5egZccCYgLk/AAAAAAAAAAI/AAAAAAAAAAA/Liw56vo5WsE/photo.jpg?sz=128", "display_name": "Amit Chauhan", "link": "https://stackoverflow.com/users/5246919/amit-chauhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1576539155, "creation_date": 1576539155, "answer_id": 59365677, "question_id": 48428158, "link": "https://stackoverflow.com/questions/48428158/inserting-line-break-to-the-nearest-space-after-a-set-of-character-length-is-set/59365677#59365677", "title": "Inserting Line Break to the nearest space after a set of character length is set", "body": "<p>below code will break string to two line on occurrence of space after 20 character.</p>\n\n<pre><code>dim inputstr as string = \"This is my test input string. I hope it helps!\"\ndim breakafter as integer= 20\ndim line1 as string,line2 as string\ndim found as integer=InStr(breakafter, inputstr, \" \", vbTextCompare) ' KNOW WHERE IS 1st space after 20 char(s)\nline1= Left(inputstr,found )  ' get 1st part of text\nline2 =  Replace(inputstr, \" \", environment.newline() , found, 1, vbTextCompare) ' get remaining text \nmsgbox line1 + iif(isnothing(line2),\"\",line2)\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 3214807, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22bbcf90abbb8c3685d96e395ee2849d?s=128&d=identicon&r=PG&f=1", "display_name": "CJanon", "link": "https://stackoverflow.com/users/3214807/cjanon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1576539155, "creation_date": 1516814140, "last_edit_date": 1516814967, "question_id": 48428158, "link": "https://stackoverflow.com/questions/48428158/inserting-line-break-to-the-nearest-space-after-a-set-of-character-length-is-set", "title": "Inserting Line Break to the nearest space after a set of character length is set", "body": "<p>I have come across this code(not mine), what it actually does is insert a Line break after a character length has been determined.</p>\n\n<pre><code>Public Function LFNearSpace(InputStr As String, CharCnt As Long)\n\nDim SplitStrArr() As Variant\nDim SplitCnt As Long\nDim c As Long\nDim i As Long\nDim Lcnt As Long\nDim Rcnt As Long\nDim OutputStr As String\n\n'Split string into Array\nReDim SplitStrArr(Len(InputStr) - 1)\nFor i = 1 To Len(InputStr)\n    SplitStrArr(i - 1) = Mid$(InputStr, i, 1)\nNext\n\nSplitCnt = 0\nFor c = LBound(SplitStrArr) To UBound(SplitStrArr)\n    SplitCnt = SplitCnt + 1\n    If SplitCnt = CharCnt Then\n        'get count to space nearest to the left and right of word\n        For i = c To LBound(SplitStrArr) Step -1\n            If SplitStrArr(i) = \" \" Then\n                Lcnt = i\n                Exit For\n            End If\n        Next i\n        For i = c To UBound(SplitStrArr)\n            If SplitStrArr(i) = \" \" Then\n                Rcnt = i\n                Exit For\n            End If\n        Next i\n        'add line feed to nearest space\n        If (Rcnt - c) &lt; (c - Lcnt) Then\n            SplitStrArr(Lcnt) = Chr(10)\n            SplitCnt = c - Lcnt\n        ElseIf (Rcnt - c) = (c - Lcnt) Then\n            SplitStrArr(Rcnt) = Chr(10)\n            SplitCnt = c - Rcnt\n        End If\n    End If\nNext c\n\n'Finalize the output into a single string\nLFNearSpace = Join(SplitStrArr, \"\")\n\nEnd Function\n</code></pre>\n\n<p><strong>So here's my condition:\nColumn Width: 75\nFont Name: Arial\nFont Size: 9</strong></p>\n\n<p>I am customizing it for a while to fit my conditions,as far as I can think of</p>\n\n<p>Unfortunately, the function cuts(inserts line break) the word not in natural way for example: \nI call it like this, well if I change the 105 value the output changes but <strong><em>I wanted to create a solution why the output is similar to the image below.</em></strong></p>\n\n<pre><code>SomeStr = LFNearSpace(SomeStr, 105)\nWorksheets(\"Sheet1\").Range(\"A1\").Value = SomeStr\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TIBG4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TIBG4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any thoughts? Thanks</p>\n"}, {"tags": ["excel", "excel-2010", "ms-office", "office365", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1516813844, "post_id": 48427909, "comment_id": 83846461, "body": "Unable to replicate this using Excel 2016. Is there a reason you&#39;re using ActiveX controls instead of normal Form controls?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1516813932, "post_id": 48427909, "comment_id": 83846519, "body": "because i need the checkboxes to hide if the rows it resides on are hidden."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1516814346, "post_id": 48427909, "comment_id": 83846780, "body": "Noted. Seems to be a bug that has gone unpatched since 2010. See here for some workarounds: <a href=\"https://answers.microsoft.com/en-us/office/forum/office_2010-excel/disappearing-activex-checkboxes-when-hidden-then/0e3fcbed-3156-44f5-a036-4c6cc6f07864?db=5\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/office/forum/office_2010-excel/&hellip;</a>"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1516820325, "post_id": 48427909, "comment_id": 83850084, "body": "curious as to why microsoft has not patched this yet."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1516820337, "post_id": 48427909, "comment_id": 83850091, "body": "Take it up with microsoft :D"}], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516831838, "creation_date": 1516813299, "last_edit_date": 1531161705, "question_id": 48427909, "link": "https://stackoverflow.com/questions/48427909/activex-checkbox-blank-after-copying-from-another-workbook", "title": "ActiveX Checkbox blank after copying from another workbook", "body": "<p>I'm using Office 2016, and when copying a sheet from workbook to workbook, my checkboxes seem to disappear, but really they are still there. The checkboxes only look like they disappear because the rows they reside in are initially hidden. Then once the rows are unhidden, the checkboxes still do not appear.  </p>\n\n<p>Using 2007 does not have this effect. If I resize the checkbox it will reappear. Anyone know of any compatibility issues between the versions?  Here's a screen shot:</p>\n\n<p>Suppose to look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CTGCf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CTGCf.png\" alt=\"enter image description here\"></a></p>\n\n<p>After copying sheet to another workbook:</p>\n\n<p><a href=\"https://i.stack.imgur.com/46kf2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/46kf2.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 344, "user_id": 1445609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba139f5c8152aeb92705236e7faa53d0?s=128&d=identicon&r=PG", "display_name": "davidmneedham", "link": "https://stackoverflow.com/users/1445609/davidmneedham"}, "edited": false, "score": 2, "creation_date": 1516813988, "post_id": 48427907, "comment_id": 83846558, "body": "Is <code>primaryAOB</code> defined elsewhere in your code? Or does &quot;primaryAOB&quot; appear literally in column E?"}, {"owner": {"reputation": 1344, "user_id": 8521346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5adedecc5904449d9b448df60d69f5fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bigbob556677", "link": "https://stackoverflow.com/users/8521346/bigbob556677"}, "edited": false, "score": 1, "creation_date": 1516814773, "post_id": 48427907, "comment_id": 83847045, "body": "Is the IF statement passing? Set a breakpoint in the if block and see if it hits."}, {"owner": {"reputation": 1, "user_id": 9258658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4485bd0fdee0520e5f24fed56cc12ee?s=128&d=identicon&r=PG&f=1", "display_name": "kme09", "link": "https://stackoverflow.com/users/9258658/kme09"}, "edited": false, "score": 0, "creation_date": 1516827514, "post_id": 48427907, "comment_id": 83853992, "body": "Thank you guys! you really helped me! But I have a question. If i want to &quot;delete&quot; the added line how do I do that? I mean if I press the button new lines are added over the already added line. How can i re-start from the beginning?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9258658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4485bd0fdee0520e5f24fed56cc12ee?s=128&d=identicon&r=PG&f=1", "display_name": "kme09", "link": "https://stackoverflow.com/users/9258658/kme09"}, "edited": false, "score": 0, "creation_date": 1516827393, "post_id": 48428959, "comment_id": 83853918, "body": "Reverus THANK YOU! it worked! But I have a question. If i want to &quot;delete&quot; the added line how do I do that?"}, {"owner": {"reputation": 1, "user_id": 9258658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4485bd0fdee0520e5f24fed56cc12ee?s=128&d=identicon&r=PG&f=1", "display_name": "kme09", "link": "https://stackoverflow.com/users/9258658/kme09"}, "edited": false, "score": 0, "creation_date": 1516827445, "post_id": 48428959, "comment_id": 83853946, "body": "I mean if I press the button new lines are added over the already added line. How can i re-start from the beginning?"}, {"owner": {"reputation": 113, "user_id": 4922815, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Inyg6B1IuPc/AAAAAAAAAAI/AAAAAAAAAAA/RHpNXto_PRA/photo.jpg?sz=128", "display_name": "Reverus", "link": "https://stackoverflow.com/users/4922815/reverus"}, "reply_to_user": {"reputation": 1, "user_id": 9258658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4485bd0fdee0520e5f24fed56cc12ee?s=128&d=identicon&r=PG&f=1", "display_name": "kme09", "link": "https://stackoverflow.com/users/9258658/kme09"}, "edited": false, "score": 0, "creation_date": 1516900950, "post_id": 48428959, "comment_id": 83889672, "body": "At work now, but I&#39;ll work that option into the code by this evening ;)"}, {"owner": {"reputation": 1, "user_id": 9258658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4485bd0fdee0520e5f24fed56cc12ee?s=128&d=identicon&r=PG&f=1", "display_name": "kme09", "link": "https://stackoverflow.com/users/9258658/kme09"}, "edited": false, "score": 0, "creation_date": 1516906573, "post_id": 48428959, "comment_id": 83892754, "body": "It is ok Reverus. I figured it out! Thanks for your help!"}], "tags": [], "owner": {"reputation": 113, "user_id": 4922815, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Inyg6B1IuPc/AAAAAAAAAAI/AAAAAAAAAAA/RHpNXto_PRA/photo.jpg?sz=128", "display_name": "Reverus", "link": "https://stackoverflow.com/users/4922815/reverus"}, "is_accepted": false, "score": 0, "last_activity_date": 1516817620, "last_edit_date": 1516817620, "creation_date": 1516817169, "answer_id": 48428959, "question_id": 48427907, "link": "https://stackoverflow.com/questions/48427907/insert-copied-cells-from-one-sheet-to-another-sheet/48428959#48428959", "title": "Insert copied cells from one sheet to another sheet", "body": "<p>I copied your code into a new module in a blank workbook, then made the necessary mods to make it run (which it did). It looks the same as yours:</p>\n\n<pre><code>Sub Question()\nDim k As long, lastRow As Long\nDim primaryAOB As String\n\nlastRow = Sheets(1).Range(\"E\" &amp; (ActiveSheet.Rows.Count)).End(xlUp).Row\nprimaryAOB = Sheets(2).Range(\"A1\").Text\nFor k = 2 To lastRow\n    If Worksheets(\"owssvr\").Range(\"E\" &amp; k).Value = primaryAOB Then\n    Worksheets(\"owssvr\").Rows(k).Copy\n    Worksheets(\"AOB Approval Form\").Rows(k + 27).Insert Shift:=xlDown\n    Application.CutCopyMode = False\n    End If\nNext k\nEnd Sub\n</code></pre>\n\n<p>Since this worked, you may have just had some little syntax error somewhere while defining the variables. show us more of your procedure, that may reveal the issue! Also, have you run your code line by line? (F8)</p>\n"}], "owner": {"reputation": 1, "user_id": 9258658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4485bd0fdee0520e5f24fed56cc12ee?s=128&d=identicon&r=PG&f=1", "display_name": "kme09", "link": "https://stackoverflow.com/users/9258658/kme09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516817620, "creation_date": 1516813297, "question_id": 48427907, "link": "https://stackoverflow.com/questions/48427907/insert-copied-cells-from-one-sheet-to-another-sheet", "title": "Insert copied cells from one sheet to another sheet", "body": "<p>I want to copy all rows that have a specific value in column E and then insert them (NOT PASTE! so i want to insert new rows start at cell A29) on another sheet.</p>\n\n<p>The sheet I want to copy from is called \"owssvr\" and the one I want to copy to is called \"AOB Approval Form\". I want to insert the copied rows starting Cell A29 in the \"AOB Approval Form\". </p>\n\n<p>When i run the code, nothing happens. No error message pops up. </p>\n\n<p>Few definition of my code below:\nLastRow: The last row of the \"owssvr\" sheet </p>\n\n<p>PrimaryAOB: value that i want to lookup for in column 5. It is on the \"AOB Approval Form\" sheet</p>\n\n<p>Here is my code:</p>\n\n<pre><code>For k = 2 To lastRow\n    If Worksheets(\"owssvr\").Range(\"E\" &amp; k).Value = primaryAOB Then\n    Worksheets(\"owssvr\").Rows(k).Copy\n    Worksheets(\"AOB Approval Form\").Rows(k + 27).Insert Shift:=xlDown\n    Application.CutCopyMode = False\n    End If\nNext k\n</code></pre>\n\n<p>THANK YOU!</p>\n"}, {"tags": ["excel", "vba", "grouping", "shape"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1516814245, "post_id": 48427838, "comment_id": 83846712, "body": "Have you tried <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">stepping through the code</a>?  You can use the locals window (View &gt;&gt; Locals Window) to check values held in <code>ShapeArr</code> at various points during execution.  This should help narrow down the error."}, {"owner": {"reputation": 41, "user_id": 6934693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae01dbd66948bafbb6ea6728951bb610?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ahmad", "link": "https://stackoverflow.com/users/6934693/ammar-ahmad"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1516814839, "post_id": 48427838, "comment_id": 83847097, "body": "Great suggestion I just did that. I created a shape and changed the status to &quot;In Prog&quot; and &quot;Done&quot;, ShapeArray seems to have both shape names stored as ShapeArray(0) = &quot;TestBox86&quot; and ShapeArray(1) = &quot;Rectangle83&quot;. But the error persists that Shape Range object must include two items. Not sure why."}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1516832434, "post_id": 48427838, "comment_id": 83856472, "body": "See if this link can help you, specifically the accepted answer referencing <code>Application.Transpose</code>. <a href=\"https://stackoverflow.com/questions/33161371/writing-an-array-to-a-range-only-getting-first-value-of-array?answertab=votes#tab-top\" title=\"writing an array to a range only getting first value of array\">stackoverflow.com/questions/33161371/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 6934693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae01dbd66948bafbb6ea6728951bb610?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ahmad", "link": "https://stackoverflow.com/users/6934693/ammar-ahmad"}, "edited": false, "score": 0, "creation_date": 1517256664, "post_id": 48427838, "comment_id": 84013260, "body": "I tried transposing the array, not sure why that would matter because I am not printing it onto a column but i did it anyways, the problem persists. Any more suggestions would be appreciated"}], "owner": {"reputation": 41, "user_id": 6934693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae01dbd66948bafbb6ea6728951bb610?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ahmad", "link": "https://stackoverflow.com/users/6934693/ammar-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516813097, "creation_date": 1516813097, "question_id": 48427838, "link": "https://stackoverflow.com/questions/48427838/unable-to-group-two-shapes-then-group-resulting-shape", "title": "Unable to group two shapes then group resulting shape", "body": "<p>I am recieving an error when I attempt to run this program. It is a userform which pops up from double clicking a shape in excel. The userform allows u to change the status of the box from normal to \"in progress\" to \"done\". This change creates a box inside the original and adds a border as shown.<a href=\"https://i.stack.imgur.com/vg94u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vg94u.png\" alt=\"enter image description here\"></a></p>\n\n<p>This works fine the first time you change. But once you change the status to in prog or done you cannot change it again or you receive the following error:\n<a href=\"https://i.stack.imgur.com/JIRGt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JIRGt.png\" alt=\"enter image description here\"></a></p>\n\n<p>I was able to repeatedly change the status by using two buttons but once I merged into a combobox in the userform I started experiencing this the code is shown below for the Userform and the line where the error occurs will be bolded. Thanks in advance for the help.</p>\n\n<pre><code>  Private Sub UserForm_Initialize()\n\n'fill combobox catagory\nMe.cmbCAT.AddItem \"L1U\"\nMe.cmbCAT.AddItem \"L1L\"\nMe.cmbCAT.AddItem \"IN\"\nMe.cmbCAT.AddItem \"SC\"\nMe.cmbCAT.AddItem \"GE\"\nMe.cmbCAT.AddItem \"TE\"\nMe.cmbCAT.AddItem \"ExD\"\n\n\n'fill combobox resources\nMe.cmbResource.AddItem \"Item1\"\nMe.cmbResource.AddItem \"Item2\"\n\n'fill combobox Status\nMe.cmbStatus.AddItem \"\"\nMe.cmbStatus.AddItem \"In Prog\"\nMe.cmbStatus.AddItem \"Done\"\n\nEnd Sub\n\nPrivate Sub btnSubmit_Click()\n\nDim AShape As Shape\nDim USelection As Variant\nDim ShapeArray(0 To 1) As String\nDim ShapeArr(0 To 1) As String\n\n\n        'Pull-in what is selected on screen\nSet USelection = ActiveWindow.Selection\n\n        'Determine if selection is a shape\nSet AShape = ActiveSheet.Shapes(Sheet4.Range(\"B1\"))\n\n\n\nIf cmbCAT.Text = \"L1U\" Then\n   ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Fill.ForeColor.RGB = RGB(255, 180, 18)\nElseIf cmbCAT.Text = \"L1L\" Then\n    ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Fill.ForeColor.RGB = RGB(147, 196, 22)\nElseIf cmbCAT.Text = \"SC\" Then\n    ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Fill.ForeColor.RGB = RGB(147, 196, 22)\nElseIf cmbCAT.Text = \"IN\" Then\n    ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Fill.ForeColor.RGB = RGB(255, 255, 70)\nElseIf cmbCAT = \"GE\" Then\n    ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Fill.ForeColor.RGB = RGB(255, 173, 203)\nElseIf cmbCAT = \"TE\" Then\n    ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Fill.ForeColor.RGB = RGB(114, 163, 255)\nElse\n    ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Fill.ForeColor.RGB = RGB(159, 2, 227)\nEnd If\n\nSheet4.Range(\"A3\").Value = tbSP.Value\nSheet4.Range(\"A4\").Value = tbDROP.Value\nSheet4.Range(\"A5\").Value = cmbCAT.Text\nSheet4.Range(\"A6\").Value = tbUS.Value\nSheet4.Range(\"A7\").Value = tbTITLE.Text\nSheet4.Range(\"A8\").Value = cmbResource.Text\nSheet4.Range(\"A9\").Value = tbDES.Text\nSheet4.Range(\"A10\").Value = cmbStatus.Text\n\n\n\nActiveSheet.Shapes(Sheet4.Range(\"B1\")).TextFrame.Characters.Caption = tbSP &amp; \"-\" &amp; tbDROP &amp; \".\" &amp; cmbCAT &amp; \".\" &amp; tbUS &amp; vbNewLine &amp; _\n\"Resource: \" &amp; cmbResource &amp; vbNewLine &amp; _\n\"Description: \" &amp; tbDES &amp; vbNewLine\n\n\n'Update if status is \"In progress\"\n\nIf Sheet4.Range(\"A10\") = \"In Prog\" Then\n    With ActiveSheet.Shapes(Sheet4.Range(\"B1\")).line\n        .Weight = 5\n        .ForeColor.RGB = RGB(2, 199, 6)\n    End With\n\n    Dim Box1 As Shape\n    Set Box1 = Sheet1.Shapes.AddTextbox(msoTextOrientationHorizontal, ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Left + ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Width - 50, ActiveSheet.Shapes(Sheet4.Range(\"B1\")).TOP + ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Height - 20, 50, 20)\n\n    Box1.Fill.ForeColor.RGB = RGB(2, 199, 6)\n    Box1.OLEFormat.Object.Caption = \"In Prog\"\n\n                'Group the two boxes together\n\n\n\n    ShapeArray(0) = Box1.Name\n    ShapeArray(1) = ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Name\n\n    **ActiveSheet.Shapes.Range(Array(ShapeArray(0), ShapeArray(1))).Group**\n\n'Update if Status is \"done\"\nElseIf Sheet4.Range(\"A10\") = \"Done\" Then\n     With ActiveSheet.Shapes(Sheet4.Range(\"B1\")).line\n        .Weight = 5\n        .ForeColor.RGB = RGB(61, 134, 212)\n    End With\n\n    Dim Box2 As Shape\n    Set Box2 = Sheet1.Shapes.AddTextbox(msoTextOrientationHorizontal, ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Left + ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Width - 50, ActiveSheet.Shapes(Sheet4.Range(\"B1\")).TOP + ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Height - 20, 50, 20)\n\n    Box2.Fill.ForeColor.RGB = RGB(61, 134, 212)\n    Box2.OLEFormat.Object.Caption = \"Done\"\n\n                   'Group the two boxes together\n\n\n\n\n    ShapeArr(0) = Box2.Name\n    ShapeArr(1) = ActiveSheet.Shapes(Sheet4.Range(\"B1\")).Name\n\n    **ActiveSheet.Shapes.Range(Array(ShapeArr(0), ShapeArr(1))).Group**\n\n\n\n\n\nEnd If\n\nUnload UF2\n\nEnd Sub\n</code></pre>\n\n<p>It seems the array is not being setup right. Does this have to do with the original shape already being in a group? I tried ungrouping but this causes another error for the first time status change as it ungroup the shape but it hasn't belonged to a group yet. I didn't experience this when i used two separate buttons to change status. </p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1516813132, "post_id": 48427794, "comment_id": 83845997, "body": "The third optional parameter of the <code>DoCmd.TransferSpreadsheet</code> is the table name. See this: <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-transferspreadsheet-method-access\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/access-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 83, "user_id": 9230639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8727ff626eca971a0176e7e521628baa?s=128&d=identicon&r=PG&f=1", "display_name": "MC12", "link": "https://stackoverflow.com/users/9230639/mc12"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1516813947, "post_id": 48427794, "comment_id": 83846529, "body": "I tried removing the table name parameter but the code would throw me error saying &quot; Table Name argument required&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 9230639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8727ff626eca971a0176e7e521628baa?s=128&d=identicon&r=PG&f=1", "display_name": "MC12", "link": "https://stackoverflow.com/users/9230639/mc12"}, "edited": false, "score": 0, "creation_date": 1516813393, "post_id": 48427848, "comment_id": 83846172, "body": "This still adds the extensions of the files."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1516815118, "post_id": 48427848, "comment_id": 83847277, "body": "What about <code>.xlsm</code>? :)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516815176, "post_id": 48427848, "comment_id": 83847311, "body": "OP says it&#39;s adding <code>.xls</code> - not <code>.xlsm</code> - But that would be a matter of just adding another <code>Replace</code>."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516815369, "post_id": 48427848, "comment_id": 83847410, "body": "I see no <code>.xlsm</code> but i&#39;ll add it in just for you since it wont hurt anything."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1516815603, "post_id": 48427848, "comment_id": 83847534, "body": "Good man. Just for reference &quot;...Like A.xls has sheet &quot;A&quot; and B.xlsm has sheet &quot;B&quot;...&quot; :)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516815697, "post_id": 48427848, "comment_id": 83847581, "body": "Ah I see it now, but since this line of code <code>iFile = Dir(iPath &amp; &quot;*.xls&quot;)</code> ignores all <code>xlsm</code> files, it&#39;s a pointless addition."}, {"owner": {"reputation": 83, "user_id": 9230639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8727ff626eca971a0176e7e521628baa?s=128&d=identicon&r=PG&f=1", "display_name": "MC12", "link": "https://stackoverflow.com/users/9230639/mc12"}, "edited": false, "score": 1, "creation_date": 1516817246, "post_id": 48427848, "comment_id": 83848475, "body": "Ah I see it now, but since this line of code <code>iFile = Dir(iPath &amp; &quot;*.xls&quot;)</code> ignores all xlsm files, it&#39;s a pointless addition. - This adds the .xlsm files too since I am linking that file but @braX the latest code works and removes the extensions."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 2, "last_activity_date": 1516816109, "last_edit_date": 1516816109, "creation_date": 1516813130, "answer_id": 48427848, "question_id": 48427794, "link": "https://stackoverflow.com/questions/48427794/set-table-name-dynamically-when-importing-into-access/48427848#48427848", "title": "Set table name dynamically when importing into access", "body": "<p>This is the line where you are specifying the table name</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acLink, , _\niFileList(intFile), iPath &amp; iFileList(intFile), True 'Set your range here.\n</code></pre>\n\n<p>The 3rd argument is the TableName argument, so change it to this:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acLink, , _\nReplace(Replace(iFileList(intFile), \".xlsm\", \"\"), \".xls\", \"\"), _\niPath &amp; iFileList(intFile), True\n</code></pre>\n\n<p>That should remove the extension. </p>\n"}], "owner": {"reputation": 83, "user_id": 9230639, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8727ff626eca971a0176e7e521628baa?s=128&d=identicon&r=PG&f=1", "display_name": "MC12", "link": "https://stackoverflow.com/users/9230639/mc12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "accepted_answer_id": 48427848, "answer_count": 1, "score": 0, "last_activity_date": 1516816109, "creation_date": 1516812946, "last_edit_date": 1516815064, "question_id": 48427794, "link": "https://stackoverflow.com/questions/48427794/set-table-name-dynamically-when-importing-into-access", "title": "Set table name dynamically when importing into access", "body": "<p>I have the below code which links Excel files to Access 2016. However, it creates the table names copying from the file name. How do I edit the code to copy the sheet names and create tables with those names. </p>\n\n<p>Like A.xls has sheet \"A\" and B.xlsm has sheet \"B\". Currently, it creates A.xls as table name and not A.</p>\n\n<pre><code>   Option Compare Database\n\n   Option Explicit\n\n   'code will link to excel and pull site files into access tables\n\n   'Setting the path for the directory\n\n    Sub LinkExcel()\n    Dim iFile As String 'Filename\n    Dim iFileList() As String 'File Array\n    Dim intFile As Integer 'File Number\n\n    Dim iPath As String\n\n    iPath = \"C:\\Users\\mchattopad004\\Documents\\Files\\\" 'Directory Path\n\n   'Loop through the folder &amp; build file list\n    iFile = Dir(iPath &amp; \"*.xls\")\n    While iFile &lt;&gt; \"\"\n    'add files to the list\n    intFile = intFile + 1\n    ReDim Preserve iFileList(1 To intFile)\n    iFileList(intFile) = iFile\n    iFile = Dir()\n    Wend\n\n   'see if any files were found\n    If intFile = 0 Then\n    MsgBox \"No files found\"\n    Exit Sub\n    End If\n\n   'cycle through the list of files &amp; link to Access\n   For intFile = 1 To UBound(iFileList)\n   DoCmd.TransferSpreadsheet acLink, , _\n   iFileList(intFile), iPath &amp; iFileList(intFile), True \n   Next\n\n   MsgBox UBound(iFileList) &amp; \" Files were Linked\"\n\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 8484321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/711257ebb0efafb0c3e391e28eb3b987?s=128&d=identicon&r=PG&f=1", "display_name": "kazzi", "link": "https://stackoverflow.com/users/8484321/kazzi"}, "edited": false, "score": 0, "creation_date": 1516819139, "post_id": 48428570, "comment_id": 83849508, "body": "It didn&#39;t work. I might have placed it wrong. Can you share with the full macros?"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1516819219, "last_edit_date": 1516819219, "creation_date": 1516815546, "answer_id": 48428570, "question_id": 48427681, "link": "https://stackoverflow.com/questions/48427681/add-exclusion-to-excel-macros/48428570#48428570", "title": "Add exclusion to Excel macros", "body": "<p>You can use <code>Select Case</code> to specify sheetnames to ignore, as shown.  Simply replace the \"IgnoreSheet1\", \"IgnoreSheet2\" with the actual sheet names you want skipped.  It's just a comma delimited list, so add as many as you want.</p>\n\n<pre><code>Sub SaveWorksheetsAsPDFs()\nDim sFile       As String\nDim sPath       As String\nDim wks         As Worksheet\n\nWith ActiveWorkbook\n    sPath = .Path &amp; \"\\\"\n    For Each wks In .Worksheets\n        Select Case wks.Name\n            Case \"IgnoreSheet1\", \"IgnoreSheet2\"     'Do nothing\n            Case Else\n                'Code here to run on the other sheets\n                sFile = wks.Name &amp; \".pdf\"\n                wks.ExportAsFixedFormat Type:=xlTypePDF, _\n                                        Filename:=sPath &amp; sFile, _\n                                        Quality:=xlQualityStandard, _\n                                        IncludeDocProperties:=False, _\n                                        IgnorePrintAreas:=False, _\n                                        OpenAfterPublish:=False\n        End Select\n    Next wks\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 474, "user_id": 8484321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/711257ebb0efafb0c3e391e28eb3b987?s=128&d=identicon&r=PG&f=1", "display_name": "kazzi", "link": "https://stackoverflow.com/users/8484321/kazzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 48428570, "answer_count": 1, "score": 0, "last_activity_date": 1516819219, "creation_date": 1516812567, "last_edit_date": 1531161705, "question_id": 48427681, "link": "https://stackoverflow.com/questions/48427681/add-exclusion-to-excel-macros", "title": "Add exclusion to Excel macros", "body": "<p>So I'm using this macro to save individual excel worksheets as their own PDF when run:</p>\n\n<pre><code>Sub SaveWorksheetsAsPDFs()\nDim sFile       As String\nDim sPath       As String\nDim wks         As Worksheet\n\nWith ActiveWorkbook\n    sPath = .Path &amp; \"\\\"\n    For Each wks In .Worksheets\n            sFile = wks.Name &amp; \".pdf\"\n            wks.ExportAsFixedFormat Type:=xlTypePDF, _\n                                    Filename:=sPath &amp; sFile, _\n                                    Quality:=xlQualityStandard, _\n                                    IncludeDocProperties:=False, _\n                                    IgnorePrintAreas:=False, _\n                                    OpenAfterPublish:=False\n    Next wks\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I would just like to add to it to not start from a certain worksheet or to exclude certain worksheets. Any clue how?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1516812122, "post_id": 48427507, "comment_id": 83845292, "body": "Your new column is <code>lastColumn + 2</code>"}, {"owner": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1516812207, "post_id": 48427507, "comment_id": 83845350, "body": "when I do that in Range((lastColumn + 2) &amp; LR).Formula = &quot;=(5)&quot; I get an error mismatch"}, {"owner": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516812414, "post_id": 48427507, "comment_id": 83845500, "body": "how would i create that for Range? I am trying to fill down to the last row of the new column.."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1516812707, "post_id": 48427507, "comment_id": 83845716, "body": "Let&#39;s say &quot;US&quot; is found in Range(&quot;<b><i>D4</i></b>&quot;). You <code>Insert</code> a column in position F, pushing all beyond that one column to the right. What formula are you hoping to put into column F in this example?"}, {"owner": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516812807, "post_id": 48427507, "comment_id": 83845769, "body": "&quot;=VLOOKUP(RC[2],&#39;[ABC.xlsx]Sheet1&#39;!C1,1,FALSE)&quot;"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1516812926, "post_id": 48427507, "comment_id": 83845862, "body": "To avoid error mistmatch you should use <code>Cells(1, (lastColumn + 2)).Formula = &quot;=(5)&quot;</code> however I am quite sure that is not your ultimate goal :)"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1516813051, "post_id": 48427507, "comment_id": 83845939, "body": "Okay, I&#39;ve posted an answer using that formula (with a tweak to the R1C1)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516813214, "post_id": 48427814, "comment_id": 83846054, "body": "I tried using this solution however, it leaves the cells blank. Even if I just add (5) to test they stay blank"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516871490, "post_id": 48427814, "comment_id": 83869502, "body": "Looks (from the accepted answer) that I&#39;ve misinterpreted your request. Glad you&#39;ve got it working."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1516812999, "creation_date": 1516812999, "answer_id": 48427814, "question_id": 48427507, "link": "https://stackoverflow.com/questions/48427507/adding-formula-in-created-column-which-you-do-not-know-the-column-value/48427814#48427814", "title": "Adding formula in Created column which you do not know the column value", "body": "<p>The following will put that formula (in the example it would go in column F), referring back to column D for the lookup key:</p>\n\n<pre><code>rFind.Offset(0, 2).Formula = \"=VLOOKUP(RC[-2],'[ABC.xlsx]Sheet1'!C1,1,FALSE)\"\n</code></pre>\n\n<p>PS. <code>C1</code> is not much of a table to perform a <code>VLOOKUP</code> on but okay..</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516813626, "post_id": 48427890, "comment_id": 83846309, "body": "Is it possible to ask one additional question for assistance? I am currently just looking for 1 field - &quot;US&quot; In RowA1:Z1 -- How would I go about looking for two specific fields? EX) &quot;US&quot; in Row A1:Z1 AND &quot;New Price&quot; In Row A2:Z2?"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "reply_to_user": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516814977, "post_id": 48427890, "comment_id": 83847188, "body": "Please note that this is quite rough and volatile solution. Hardcoded ranges are almost always not a good idea. However, knowing how to approach the problem you may be able to upgrade the code by yourself."}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "reply_to_user": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516815294, "post_id": 48427890, "comment_id": 83847370, "body": "Type mismatch sometimes means that Match have not returned any value. This means that you do not have proper data in your sheet. Above solution works only if you have &quot;US&quot; and &quot;New Price&quot; in the same column. In my test worksheet I have &quot;US&quot; in cell D1 and &quot;New Price&quot; in cell D2 and it works flawlessly."}, {"owner": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516815428, "post_id": 48427890, "comment_id": 83847433, "body": "ohh, no the issue is the headers in Row A1:Z1 are merged to be 7 cells each. And the headers in Row A2:Z2 might not be directly under the first merged cell. So excel would likely show that &#39;New Price&#39; will be 3 rows to the right of &quot;US&quot;"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "reply_to_user": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 2, "creation_date": 1516816753, "post_id": 48427890, "comment_id": 83848216, "body": "Edited. Don&#39;t forget to mark/upviote answers if you find them helpfull :)"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "reply_to_user": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "edited": false, "score": 0, "creation_date": 1516817219, "post_id": 48427890, "comment_id": 83848462, "body": "For example <code>row_no = 2</code> then <code>Range(Cells(row_no, (lastColumn + 2)), Cells(row_no, (lastColumn + 2))).Select</code>"}], "tags": [], "owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "is_accepted": true, "score": 1, "last_activity_date": 1516816706, "last_edit_date": 1516816706, "creation_date": 1516813248, "answer_id": 48427890, "question_id": 48427507, "link": "https://stackoverflow.com/questions/48427507/adding-formula-in-created-column-which-you-do-not-know-the-column-value/48427890#48427890", "title": "Adding formula in Created column which you do not know the column value", "body": "<p>My answer:</p>\n\n<pre><code>Sub test()\n\nWith Range(\"A1:Z1\")\n    Set rFind = .Find(What:=\"US\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    If Not rFind Is Nothing Then\n        lastColumn = rFind.Column\n    Columns(lastColumn + 2).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(Cells(1, (lastColumn + 2)), Cells(123, (lastColumn + 2))).Formula = \"=(5)\"\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Replace 123 with last row number.</p>\n\n<p>Per request for multiple conditions finding (requieres that \"US\" and \"New Price\" are in the same column):</p>\n\n<pre><code>Sub test()\n\n    lastColumn = Evaluate(\" Match(\"\"US\"\" &amp; \"\"New Price\"\", A1:Z1 &amp; A2:Z2, 0)\")\n    Columns(lastColumn + 2).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(Cells(1, (lastColumn + 2)), Cells(123, (lastColumn + 2))).Formula = \"=(5)\"\n\nEnd Sub\n</code></pre>\n\n<p>In case of described issue:</p>\n\n<pre><code>Sub test2()\n\nDim rng As Range\n\nWith Range(\"A1:Z1\")\n    Set rFind = .Find(What:=\"US\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    If Not rFind Is Nothing Then\n        lastColumn = rFind.Column\n    End If\nEnd With\n\nSet rng = Range(Cells(2, lastColumn), Cells(2, lastColumn + 7))\n\nfinal_Column = Application.Match(\"New Price\", rng, 0)\n\nlastColumn = lastColumn + final_Column\n\nColumns(lastColumn + 2).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(Cells(1, (lastColumn + 2)), Cells(123, (lastColumn + 2))).Formula = \"=(5)\"\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8935315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a5ca9e1ca0c49074586028584ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8935315/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 48427890, "answer_count": 2, "score": 0, "last_activity_date": 1516816706, "creation_date": 1516812012, "last_edit_date": 1516812027, "question_id": 48427507, "link": "https://stackoverflow.com/questions/48427507/adding-formula-in-created-column-which-you-do-not-know-the-column-value", "title": "Adding formula in Created column which you do not know the column value", "body": "<p>I have performed a find function in Excel that looks for a specific value and inserts a new column 2 places to the right, As this value can be anywhere, I am not sure of the column value(A,B,C,D,etc.) How do I add a formula to this newly created column if I am unsure of the value? </p>\n\n<p>This is what I have so far: </p>\n\n<pre><code> With Range(\"A1:Z1\")\n    Set rFind = .Find(What:=\"US\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    If Not rFind Is Nothing Then\n        lastColumn = rFind.Column\n    Columns(lastColumn + 2).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range((lastColumn + 2) &amp; LR).Formula = \"=(5)\"\n    End If\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1516817761, "post_id": 48427343, "comment_id": 83848760, "body": "In your provided sample data, it looks like the ad size is <i>always</i> surrounded by an underscore (<code>_</code>).  Is that always the case?  If so this would be pretty easy."}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1516821799, "post_id": 48427343, "comment_id": 83850878, "body": "no not always, sometimes it&#39;s a dash or space"}], "answers": [{"comments": [{"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516815530, "post_id": 48427753, "comment_id": 83847494, "body": "Unfortunately it&#39;s not alwasy the same, that&#39;s what makes this so difficult"}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516822548, "post_id": 48427753, "comment_id": 83851292, "body": "can you update your answer and I&#39;ll mark it. you need the cred more right?"}], "tags": [], "owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "is_accepted": false, "score": 1, "last_activity_date": 1516812799, "creation_date": 1516812799, "answer_id": 48427753, "question_id": 48427343, "link": "https://stackoverflow.com/questions/48427343/how-to-extract-ad-sizes-from-a-string-with-excel-regex/48427753#48427753", "title": "How to extract ad sizes from a string with excel regex", "body": "<p>This formula could work if it's always 3 characters, then x, and it's always between underscores - adjust accordingly.</p>\n\n<pre><code>=iferror(mid(A1,search(\"_???x*_\",A1)+1,search(\"_\",A1,search(\"_???x*_\",A1)+1)-(search(\"_???x*_\",A1)+1)),\"No match\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516815359, "post_id": 48428045, "comment_id": 83847406, "body": "This would work great if I could make the regex pull exactly the pattern instead of the opposte."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516815438, "post_id": 48428045, "comment_id": 83847440, "body": "@garek007 - was trying for about 10 minutes to make it, did not succeed. Will try again tomorrow, but hopefully someone will manage to do it before. If anyone finds a way to do it, feel free to edit the post."}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516815506, "post_id": 48428045, "comment_id": 83847480, "body": "I will thanks. If I could figure out how to use the regex to just pull the pattern, this would be perfect"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1516815945, "post_id": 48428045, "comment_id": 83847718, "body": "With this, you could change <code>regExSampler = .Replace(s, vbNullString)</code> to replace with an unused character, like a tilde. Then, you can just count the characters before and after the tilde and do a <code>MID</code>. It&#39;s not elegant but oh well."}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1516816644, "post_id": 48428045, "comment_id": 83848148, "body": "If you dim <code>a</code> as a byte and change what&#39;s inside @Vityata &#39;s <code>IF</code> with this, it gets what you want.  <code>regExSampler = .Replace(s, &quot;~&quot;)</code>  <code>a = InStr(1, regExSampler, &quot;~&quot;, vbTextCompare)</code>  <code>regExSampler = Mid(s, a, Len(s) - (Len(regExSampler) - 1))</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 1, "creation_date": 1516909129, "post_id": 48428045, "comment_id": 83894159, "body": "@FernandoJ.Rivera - take a look here, 2 answers of the problem - <a href=\"https://stackoverflow.com/questions/48447265/get-the-non-matching-part-of-the-pattern-through-a-regex\" title=\"get the non matching part of the pattern through a regex\">stackoverflow.com/questions/48447265/&hellip;</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516909155, "post_id": 48428045, "comment_id": 83894176, "body": "@garek007 - take a look here, 2 answers of the problem - <a href=\"https://stackoverflow.com/questions/48447265/get-the-non-matching-part-of-the-pattern-through-a-regex\" title=\"get the non matching part of the pattern through a regex\">stackoverflow.com/questions/48447265/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1516897548, "last_edit_date": 1516897548, "creation_date": 1516813754, "answer_id": 48428045, "question_id": 48427343, "link": "https://stackoverflow.com/questions/48427343/how-to-extract-ad-sizes-from-a-string-with-excel-regex/48428045#48428045", "title": "How to extract ad sizes from a string with excel regex", "body": "<p>I have managed to make about 95% of the required answer - the RegEx below will remove the <code>DDDxDD</code> size and would return the rest.</p>\n\n<pre><code>Option Explicit\n\nPublic Function regExSampler(s As String) As String\n\n    Dim regEx           As Object\n    Dim inputMatches    As Object\n    Dim regExString     As String\n\n    Set regEx = CreateObject(\"VBScript.RegExp\")\n\n    With regEx\n        .Pattern = \"(([0-9]+)x([0-9]+))\"\n        .IgnoreCase = True\n        .Global = True\n\n        Set inputMatches = .Execute(s)\n\n        If regEx.test(s) Then\n            regExSampler = .Replace(s, vbNullString)\n        Else\n            regExSampler = s\n        End If\n\n    End With\n\nEnd Function\n\nPublic Sub TestMe()\n\n    Debug.Print regExSampler(\"uni3uios3_300x250_ASDF.html\")\n    Debug.Print regExSampler(\"uni3uios3_34300x25_ASDF.html\")\n    Debug.Print regExSampler(\"uni3uios3_8x4_ASDF.html\")\n\nEnd Sub\n</code></pre>\n\n<p>E.g. you would get:</p>\n\n<pre><code>uni3uios3__ASDF.html\nuni3uios3__ASDF.html\nuni3uios3__ASDF.html\n</code></pre>\n\n<p>From here you can continue trying to find a way to reverse the display.</p>\n\n<p><strong>Edit:</strong>\nTo go from the 95% to the 100%, <a href=\"https://stackoverflow.com/questions/48447265/get-the-not-matching-part-of-the-pattern-through-a-regex\">I have asked a question here</a> and it turns out that the conditional block should be changed to the following:</p>\n\n<pre><code>If regEx.test(s) Then\n    regExSampler = InputMatches(0)\nElse\n    regExSampler = s\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516821888, "post_id": 48429300, "comment_id": 83850943, "body": "Sorry it isn&#39;t. I&#39;ve updated my question to note that."}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 1, "creation_date": 1516825868, "post_id": 48429300, "comment_id": 83853148, "body": "That Select logic is so sexy I wish I could upvote twice."}, {"owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516828732, "post_id": 48429300, "comment_id": 83854584, "body": "Ok I&#39;m going to mark this correct because it&#39;s the most all in one solution. How can I modify this to look for /12345/ numbers between two slashes like that? This doesn&#39;t use regex right?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "edited": false, "score": 0, "creation_date": 1516828863, "post_id": 48429300, "comment_id": 83854647, "body": "@garek007 That&#39;s a fundamentally different question and really should be in a new post.  Would the numbers always be between two <code>&#47;</code>s?  If so you, you can use the same split logic I originally showed or you could get it via formula.  I do recommend creating a new question for that though."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1516826087, "last_edit_date": 1516826087, "creation_date": 1516818538, "answer_id": 48429300, "question_id": 48427343, "link": "https://stackoverflow.com/questions/48427343/how-to-extract-ad-sizes-from-a-string-with-excel-regex/48429300#48429300", "title": "How to extract ad sizes from a string with excel regex", "body": "<p><strong>EDIT:</strong> Since it's not actually underscore delimited we can't use <code>Split</code>.  We can however iterate over the string and extract the \"<em>#x#</em>\" manually.  I have updated the code to reflect this and verified that it works successfully.</p>\n\n<pre><code>Public Function ExtractAdSize(ByVal arg_Text As String) As String\n\n    Dim i As Long\n    Dim Temp As String\n    Dim Ad As String\n\n    If arg_Text Like \"*#x#*\" Then\n        For i = 1 To Len(arg_Text) + 1\n            Temp = Mid(arg_Text &amp; \" \", i, 1)\n            If IsNumeric(Temp) Then\n                Ad = Ad &amp; Temp\n            Else\n                If Temp = \"x\" Then\n                    Ad = Ad &amp; Temp\n                Else\n                    If Ad Like \"*#x#*\" Then\n                        ExtractAdSize = Ad\n                        Exit Function\n                    Else\n                        Ad = vbNullString\n                    End If\n                End If\n            End If\n        Next i\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Alternate version of the same function using Select Case boolean logic instead of nested If statements:</p>\n\n<pre><code>Public Function ExtractAdSize(ByVal arg_Text As String) As String\n\n    Dim i As Long\n    Dim Temp As String\n    Dim Ad As String\n\n    If arg_Text Like \"*#x#*\" Then\n        For i = 1 To Len(arg_Text) + 1\n            Temp = Mid(arg_Text &amp; \" \", i, 1)\n\n            Select Case Abs(IsNumeric(Temp)) + Abs((Temp = \"x\")) * 2 + Abs((Ad Like \"*#x#*\")) * 4\n                Case 0: Ad = vbNullString       'Temp is not a number, not an \"x\", and Ad is not valid\n                Case 1, 2, 5: Ad = Ad &amp; Temp    'Temp is a number or an \"x\"\n                Case 4, 6: ExtractAdSize = Ad   'Temp is not a number, Ad is valid\n                           Exit Function\n            End Select\n        Next i\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 388, "user_id": 2275025, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/es7Uv.jpg?s=128&g=1", "display_name": "garek007", "link": "https://stackoverflow.com/users/2275025/garek007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 48429300, "answer_count": 3, "score": 1, "last_activity_date": 1518795603, "creation_date": 1516811518, "last_edit_date": 1518795603, "question_id": 48427343, "link": "https://stackoverflow.com/questions/48427343/how-to-extract-ad-sizes-from-a-string-with-excel-regex", "title": "How to extract ad sizes from a string with excel regex", "body": "<p>I am trying to extract ad sizes from string. The ad sizes are all set standard sizes. So while I'd prefer to have a regex that looks for a pattern, IE 3 numbers followed by 2 or 3 numbers, hard coding it will also work, since we know what the sizes will be. Here's an example of some of the ad sizes:</p>\n\n<p>300x250</p>\n\n<p>728x90</p>\n\n<p>320x50</p>\n\n<p>I was able to find some VBScript that I modified that almost works, but because my strings that I'm searching are inconsistent, it's pulling too much in some cases. For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fhIzS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fhIzS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>You see how it's not matching correctly in every instance.</p>\n\n<p>The VB code I found is actually matching everything EXCEPT that ad sizes. I don't know enough about VBScript to reverse it to just look for ad sizes and pull them. So instead it looks for all other text and removes it. </p>\n\n<p>The code is below. Is there a way to fix the Regex so that it just returns the ad sizes?</p>\n\n<pre><code>Function getAdSize(Myrange As Range) As String\n    Dim regEx As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim strReplace As String\n    Dim strOutput As String\n\n    strPattern = \"([^300x250|728x90])\"\n\n    If strPattern &lt;&gt; \"\" Then\n        strInput = Myrange.Value\n        strReplace = \"\"\n\n        With regEx\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = True\n            .Pattern = strPattern\n        End With\n\n        If regEx.Test(strInput) Then\n            getAdSize = regEx.Replace(strInput, strReplace)\n        Else\n            getAdSize = \"Not matched\"\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>NOTE, THE DATA IS NOT ALWAYS PRECEDED BY AN UNDERSCORE, SOMETIMES IT IS A DASH OR A SPACE BEFORE AND AFTER.</p>\n"}, {"tags": ["excel", "vba", "com"], "comments": [{"owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "edited": false, "score": 3, "creation_date": 1516816056, "post_id": 48426974, "comment_id": 83847791, "body": "Whether the intended behavior of not, it certainly is not the most natural way to read the documentation, currently available at <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbooks-open-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>, which states that the returned value is &quot;A Workbook object that represents the opened workbook.&quot;."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "edited": false, "score": 0, "creation_date": 1516817223, "post_id": 48426974, "comment_id": 83848465, "body": "Key word: &quot;the&quot;."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1516817253, "post_id": 48426974, "comment_id": 83848478, "body": "Somewhere in .Open() there is code to match the file name to a workbook already in the workbooks collection and if one is found to return the same reference. It seems that this code is bugged and it always effectively &quot;falls through&quot; &amp; erroneously returns the last opened workbook reference for any workbook already open (i.e. within workbooks)."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1516866117, "post_id": 48426974, "comment_id": 83866702, "body": "It&#39;s certainly not a COM bug, issue is only related to Excel. Not sure it&#39;s a &quot;bug&quot; either. Excel is not a programming library, it&#39;s an end-user tool. You should see the object model as live thing, resulting of the UI, not the reverse. Anything can happen on it depending on the UI/user context, SDI/MDI, also 3rd parties, macro, etc. It can also vary if you run from Excel or from outside (more async, move living), if its UI is visible or not and on its version (2013+). This is an old story: <a href=\"https://stackoverflow.com/questions/13019981/workbooks-open-returns-different-file-than-filename\" title=\"workbooks open returns different file than filename\">stackoverflow.com/questions/13019981/&hellip;</a>"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1516867948, "post_id": 48426974, "comment_id": 83867552, "body": "&quot;It&#39;s not a bug. It&#39;s a feature.&quot; ?"}, {"owner": {"reputation": 11788, "user_id": 2360169, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/x8M06.jpg?s=128&g=1", "display_name": "Michael Gunter", "link": "https://stackoverflow.com/users/2360169/michael-gunter"}, "edited": false, "score": 0, "creation_date": 1516899987, "post_id": 48426974, "comment_id": 83889064, "body": "The problem is worse than the original post, even. When multiple calls to <code>Workbooks.Open()</code> happen for the same workbook, previous references are completely invalidated by the later calls. <a href=\"https://gist.github.com/Neuroboy23/bec84b82dc37568c79434a2f0b215a35\" rel=\"nofollow noreferrer\">gist.github.com/Neuroboy23/bec84b82dc37568c79434a2f0b215a35</a>"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 11788, "user_id": 2360169, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/x8M06.jpg?s=128&g=1", "display_name": "Michael Gunter", "link": "https://stackoverflow.com/users/2360169/michael-gunter"}, "edited": false, "score": 0, "creation_date": 1516952320, "post_id": 48426974, "comment_id": 83907248, "body": "@MichaelGunter Can&#39;t reproduce. The code you link to works as expected at my end. (However, something like you describe does happen when opening workbooks from the Immediate window.)"}], "answers": [{"comments": [{"owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "edited": false, "score": 2, "creation_date": 1516815743, "post_id": 48427733, "comment_id": 83847619, "body": "It seems more complicated than that: I tried opening workbooks <code>a.xlsx</code>, <code>b.xlsx</code>, <code>c.xlsx</code>, activating <code>a</code>, and opening <code>c.xlsx</code> again. In this case, <code>Open</code> returned the <code>b</code> workbook which was neither the active workbook, nor the most recently opened one."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516818701, "post_id": 48427733, "comment_id": 83849272, "body": "Definitely worth an Excel UserVoice issue."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1516868505, "post_id": 48427733, "comment_id": 83867836, "body": "I agree, this is not correct behaviour. Though I stand by my comment that you should be testing whether the workbook isn&#39;t already open and act accordingly."}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1538279284, "post_id": 48427733, "comment_id": 92084865, "body": "I couldn&#39;t reproduce this in <code>pywin32</code> with Excel 2007. When I <code>Workbooks.Open</code> <code>1.xlsx</code>, <code>2.xlsx</code>, <code>3.xlsx</code>, then <code>1.xlsx</code> again, the order of workbooks in <code>Workbooks</code> changes from 1-2-3 to 2-3-1, but <code>Open</code> returns the correct workbook."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 1, "last_activity_date": 1516814639, "last_edit_date": 1516814639, "creation_date": 1516812741, "answer_id": 48427733, "question_id": 48426974, "link": "https://stackoverflow.com/questions/48426974/com-bug-opening-a-workbook-twice-leads-to-broken-reference/48427733#48427733", "title": "COM bug? Opening a workbook twice leads to broken reference", "body": "\n\n<p>This is a bug indeed. Apparently this line:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set a2 = Application.Workbooks.Open(\"H:\\a.xlsx\") \n</code></pre>\n\n<p>(unexpectedly) works the same as </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Application.Workbooks.Open \"H:\\a.xlsx\"\nSet a2 = ActiveWorkbook\n</code></pre>\n\n<p>Because a.xlsx is already open b.xlsx is (and remains) the activeworkbook, so then a2 gets a reference to b.xlsx.</p>\n\n<p>In order to prevent the problem from happening you should test whether a workbook is already open in Excel before trying to open it again.</p>\n"}], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1538279082, "creation_date": 1516810441, "last_edit_date": 1538279082, "question_id": 48426974, "link": "https://stackoverflow.com/questions/48426974/com-bug-opening-a-workbook-twice-leads-to-broken-reference", "title": "COM bug? Opening a workbook twice leads to broken reference", "body": "<p>Credit to <a href=\"https://stackoverflow.com/users/5085211/fuglede\">fuglede</a> for bringing this to my attention:</p>\n\n<p>Is this a COM bug? </p>\n\n<p>I open Excel workbook A, then open workbook B (both of which have a bit of identifying text in cell A1). </p>\n\n<p>Then I attempt to open workbook A again and save that reference in a new variable <code>a2</code>. But <code>a2</code> now points to workbook B! </p>\n\n<p>This exact same behavior is reproduced in Python using win32com. So this isn't a VBA issue specifically, bur rather a COM issue more generally. (i.e. presumably also in C# etc., though not confirmed yet.)</p>\n\n<p>What is going on?</p>\n\n<p>VBA code:  (Python win32com code is similar.)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Open a couple of workbooks\nDim a As Workbook, b As Workbook, a2 As Workbook\nDebug.Print \"Set a = a.xlsx...\"\nSet a = Application.Workbooks.Open(\"H:\\a.xlsx\")\nDebug.Print \"a:  \" &amp; a.Name\nDebug.Print \"Set b = b.xlsx...\"\nSet b = Application.Workbooks.Open(\"H:\\b.xlsx\")\nDebug.Print \"b:  \" &amp; b.Name\nDebug.Print \"a:  \" &amp; a.Name\n\n'Attempt to re-open workbook a.xlsx and keep reference in a new variable\nDebug.Print \"Set a2 = a.xlsx...\"\nSet a2 = Application.Workbooks.Open(\"H:\\a.xlsx\") '&lt;---- should open A, right?\nDebug.Print \"a2: \" &amp; a2.Name '&lt;------------------------------------------------ !!!\nDebug.Print \"b:  \" &amp; b.Name\nDebug.Print \"a:  \" &amp; a.Name\n\n'Read workbook content\nDebug.Print \"Contents of cell A1...\"\nDebug.Print \"From a:  \" &amp; a.Sheets(\"Sheet1\").Range(\"A1\").Value\nDebug.Print \"From b:  \" &amp; b.Sheets(\"Sheet1\").Range(\"A1\").Value \nDebug.Print \"From a2: \" &amp; a2.Sheets(\"Sheet1\").Range(\"A1\").Value '&lt;------------- !!!\n</code></pre>\n\n<p>Resulting output in the Immediate window: (similar in Python console)</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Set a = a.xlsx...\na:  a.xlsx\nSet b = b.xlsx...\nb:  b.xlsx\na:  a.xlsx\nSet a2 = a.xlsx...\na2: b.xlsx           &lt;--------------- WTF?!\nb:  b.xlsx\na:  a.xlsx\nContents of cell A1...\nFrom a:  I'm in A\nFrom b:  I'm in B\nFrom a2: I'm in B    &lt;--------------- WTF?!\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516810475, "post_id": 48426913, "comment_id": 83844137, "body": "Where are you using <code>AutoFill</code>?"}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516810528, "post_id": 48426913, "comment_id": 83844175, "body": "Auto fill will be used at the active cell."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1516811597, "post_id": 48426913, "comment_id": 83844946, "body": "Have yo tried <code>Selection.AutoFill Destination:=Range(&quot;$A$1:$AI$80000&quot;)</code> ??"}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1516811848, "post_id": 48426913, "comment_id": 83845114, "body": "The active cell after filtering that I select is in AI and the first row after filtering is AI2345. that cell gets the formula but it dosnt fill the formula down to the end of the filtered rows."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1516818201, "post_id": 48426913, "comment_id": 83849000, "body": "I would be careful using autofill if the row numbers are not consecutive. After filtering, where row numbers are not consecutive, I&#39;ve filled in <b>every</b> row from first row used to last row used !"}], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1516814067, "post_id": 48427977, "comment_id": 83846605, "body": "Thank you so much. it fixed the problem"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1516813518, "creation_date": 1516813518, "answer_id": 48427977, "question_id": 48426913, "link": "https://stackoverflow.com/questions/48426913/auto-fill-not-working/48427977#48427977", "title": "Auto fill not working", "body": "<p>How about something like below, instead of .FillDown, specify the range for the last column of visible data, and offset to the next column to enter the formula in there:</p>\n\n<pre><code>Sub Cal()\nDim LastRow As Long\n    With Worksheets(\"Data\")\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        .Range(\"$A$1:$AI$\" &amp; LastRow).AutoFilter Field:=1, Criteria1:=\"Actual\"\n        .Range(\"$A$1:$AI$\" &amp; LastRow).AutoFilter Field:=2, Criteria1:=\"2018\"\n        'filter according to values specified\n        Set fltrdrng = .Range(\"$AI$2:$AI$\" &amp; LastRow).SpecialCells(xlCellTypeVisible)\n        'set the range of visible data on last column with data on your data-set\n        fltrdrng.Offset(0, 1).FormulaR1C1 = \"=SUM(RC[-12]:RC[-1])\"\n        'add the formula to the adjacent column by offsetting\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 1, "last_activity_date": 1516820450, "creation_date": 1516820450, "answer_id": 48429801, "question_id": 48426913, "link": "https://stackoverflow.com/questions/48426913/auto-fill-not-working/48429801#48429801", "title": "Auto fill not working", "body": "<p>This should do what you want.  Autofilling is very dangerous with filtered data.  This gets the activecell address and then creates the last cell address(row 80000 from your code), and then adds the formula to every cell in the range that is visible.</p>\n\n<pre><code>Start = ActiveCell.address\narow = ActiveCell.Row\nalen = Len(arow)\nlcell = Left(Start, Len(Start) - alen) &amp; \"80000\"\nRange(Start &amp; \":\" &amp; lcell).SpecialCells(xlCellTypeVisible).Formula = \"=SUM(RC[-12]:RC[-1])\"\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 48427977, "answer_count": 2, "score": 1, "last_activity_date": 1516820450, "creation_date": 1516810276, "last_edit_date": 1531164843, "question_id": 48426913, "link": "https://stackoverflow.com/questions/48426913/auto-fill-not-working", "title": "Auto fill not working", "body": "<p>I am working on my code and I have this to filter rows and insert a formula in the first filter row. with that formula I want it to fill down, but it only insert the formula in the first filtered row and doesn't fill down.</p>\n\n<pre><code>Sub Cal()\ndim LastRow as long\nWith Worksheets(\"Data\")\n.Range(\"$A$1:$AI$80000\").AutoFilter Field:=1, Criteria1:= _\n    \"Actual\"\n.Range(\"$A$1:$AI$80000\").AutoFilter Field:=2, Criteria1:=\"2018\"\nLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n.AutoFilter.Range.Offset(2).SpecialCells(xlCellTypeVisible).Cells(1, 35).Select 'SELECTS THE FIRST cell in A after deleting\nActiveCell.FormulaR1C1 = \"=SUM(RC[-12]:RC[-1])\"\n.AutoFilter.Range.Offset(2).SpecialCells(xlCellTypeVisible).Cells(1, 35).Select\nSelection.FillDown\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "user-interface", "user-controls"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516809008, "post_id": 48426349, "comment_id": 83843038, "body": "What is the value of the <code>ShowModal</code> property of <code>LoadBox</code>?"}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516809684, "post_id": 48426349, "comment_id": 83843520, "body": "@Rory I don&#39;t see a ShowModal property for LoadBox. I believe the default is True (making the userform modal)."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516809908, "post_id": 48426349, "comment_id": 83843689, "body": "Every form has a ShowModal property. If you show it modally, then your modeless form will unload when the modal one does, so I suggest you show LoadBox modelessly too."}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516810118, "post_id": 48426349, "comment_id": 83843858, "body": "Ok that did fix the original issue, but now the baseUF doesn&#39;t update until another action is performed. However, I have a different userform that is activated after a double-click in a textbox that is modal and I do not have the same issue (the baseUF closing) with that one, so I feel like there is something else going on."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516810212, "post_id": 48426349, "comment_id": 83843926, "body": "In the absence of any other code, I&#39;ll have to guess; do you unload or hide the other form?"}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516810378, "post_id": 48426349, "comment_id": 83844052, "body": "Both of the other userforms are closed using Unload Me after a button click performs a piece of code."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1516811023, "post_id": 48426349, "comment_id": 83844549, "body": "Do you have <code>_Initialize()</code> event for some of the user forms?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516811081, "post_id": 48426349, "comment_id": 83844584, "body": "<code>Unload Me</code> means you have self-destructing objects, and that can&#39;t be good. See <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">this article</a> I wrote."}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1516811321, "post_id": 48426349, "comment_id": 83844752, "body": "@Vityata  added the _Initialize() codes."}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516811357, "post_id": 48426349, "comment_id": 83844774, "body": "@Mat&#39;sMug I saw something similar in Vityata&#39;s answer and I have started looking into that. Thank you for the insight."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1516811687, "post_id": 48426349, "comment_id": 83845004, "body": "@user2731076 - can you try the following - run <code>Sub TryMe: End: End Sub</code> code, close your excel file, open it again and see whether the issue still exists. Or put a stop debugging sign on all <code>Unload Me</code> parts of the code and see whether it gets triggered."}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1516811987, "post_id": 48426349, "comment_id": 83845204, "body": "@Vityata That did the trick. Not sure what that did though. Would you mind explaining what that tells you in an answer?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1516812308, "post_id": 48426349, "comment_id": 83845425, "body": "@user2731076 - if the <code>End</code> did the trick, then I have some bad news for you - you should consider refactoring the whole code, because the problem was that some of instance of a form was not properly released and was messing around."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "edited": false, "score": 0, "creation_date": 1516810801, "post_id": 48427044, "comment_id": 83844376, "body": "@user2731076 - <code>Sub Button1_Click()</code> is in a module?"}, {"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "edited": false, "score": 1, "creation_date": 1516812757, "post_id": 48427044, "comment_id": 83845746, "body": "Thank you for your help. I&#39;m glad this was caught before the workbook/code was shared with others and it seems I will be able to learn quite a bit more about User Forms :)  I didn&#39;t like how the forms were handled currently but I hadn&#39;t dug enough to find these methods. Plus, it was working (for the most part...) so....  &quot;If it isn&#39;t broken, don&#39;t fix it&quot;. I just had to keep trying to break it :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "edited": false, "score": 0, "creation_date": 1516813154, "post_id": 48427044, "comment_id": 83846017, "body": "@user2731076 - welcome. The &quot;trick&quot; with the userform is something really viable &amp; interesting, it can save you a lot of problems in the long term."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1516815244, "last_edit_date": 1516815244, "creation_date": 1516810623, "answer_id": 48427044, "question_id": 48426349, "link": "https://stackoverflow.com/questions/48426349/userform-closes-after-end-sub-without-ever-calling-unload-me/48427044#48427044", "title": "Userform closes after &quot;End Sub&quot; without ever calling &quot;Unload Me&quot;", "body": "<p>Whenever something unexpected happens with forms, consider writing <code>End</code> in the immediate window and pressing enter. It will kill all the unkilled instances of a form and generally any variable, thus it would be like a cold restart to the VBA program.</p>\n\n<p>After doing this, it is a good idea to consider a cleaner solution, concerning VBA &amp; UserForms, using some OOP. (Disclaimer - the first article is mine):</p>\n\n<ul>\n<li><a href=\"http://www.vitoshacademy.com/vba-the-perfect-userform-in-vba/\" rel=\"nofollow noreferrer\">http://www.vitoshacademy.com/vba-the-perfect-userform-in-vba/</a> </li>\n<li><a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/</a></li>\n<li><a href=\"https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form\">https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form</a></li>\n</ul>\n\n<p>Although it may seem that you are achieving the same results with more code, the benefits of using this approach are quite a lot in the long term. </p>\n\n<hr>\n\n<p>This is a small example of the OOP model. Imagine you have a user form like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kqc5G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kqc5G.png\" alt=\"enter image description here\"></a></p>\n\n<p>It has only the following controls:</p>\n\n<ul>\n<li>btnRun</li>\n<li>btnExit</li>\n<li>lblInfo</li>\n<li>frmMain (the class)</li>\n</ul>\n\n<p>The code withing the form is the following:</p>\n\n<pre><code>Option Explicit\n\nPublic Event OnRunReport()\nPublic Event OnExit()\n\nPublic Property Get InformationText() As String    \n    InformationText = lblInfo.Caption    \nEnd Property\n\nPublic Property Let InformationText(ByVal value As String)    \n    lblInfo.Caption = value    \nEnd Property\n\nPublic Property Get InformationCaption() As String    \n    InformationCaption = Caption    \nEnd Property\n\nPublic Property Let InformationCaption(ByVal value As String)    \n    Caption = value    \nEnd Property\n\nPrivate Sub btnRun_Click()    \n    RaiseEvent OnRunReport    \nEnd Sub\n\nPrivate Sub btnExit_Click()    \n    RaiseEvent OnExit    \nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)    \n    If CloseMode = vbFormControlMenu Then\n        Cancel = True\n        Hide\n    End If    \nEnd Sub\n</code></pre>\n\n<p>The form is with two events, getting caught by the clsSummaryPresenter. The <code>clsSummaryPresenter</code> looks like this:</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents objSummaryForm As frmMain\n\nPrivate Sub Class_Initialize()        \n    Set objSummaryForm = New frmMain    \nEnd Sub\n\nPrivate Sub Class_Terminate()        \n    Set objSummaryForm = Nothing        \nEnd Sub\n\nPublic Sub Show()    \n    If Not objSummaryForm.Visible Then\n        objSummaryForm.Show vbModeless\n        Call ChangeLabelAndCaption(\"Press Run to Start\", \"Starting\")\n    End If    \n    With objSummaryForm\n        .Top = CLng((Application.Height / 2 + Application.Top) - .Height / 2)\n        .Left = CLng((Application.Width / 2 + Application.Left) - .Width / 2)\n    End With    \nEnd Sub\n\nPrivate Sub Hide()    \n    If objSummaryForm.Visible Then objSummaryForm.Hide    \nEnd Sub\n\nPublic Sub ChangeLabelAndCaption(strLabelInfo As String, strCaption As String)    \n    objSummaryForm.InformationText = strLabelInfo\n    objSummaryForm.InformationCaption = strCaption\n    objSummaryForm.Repaint    \nEnd Sub\n\nPrivate Sub objSummaryForm_OnRunReport()    \n    MainGenerateReport\n    Refresh    \nEnd Sub\n\nPrivate Sub objSummaryForm_OnExit()    \n    Hide    \nEnd Sub    \n\nPublic Sub Refresh()        \n    With objSummaryForm\n        .lblInfo = \"Ready\"\n        .Caption = \"Task performed\"\n    End With    \nEnd Sub\n</code></pre>\n\n<p>Finally, we have the modMain, which is the so-called business logic of the form:</p>\n\n<pre><code>Option Explicit\n\nPrivate objPresenter   As clsSummaryPresenter\n\nPublic Sub MainGenerateReport()    \n    objPresenter.ChangeLabelAndCaption \"Starting and running...\", \"Running...\"\n    GenerateNumbers    \nEnd Sub\n\nPublic Sub GenerateNumbers()    \n    Dim lngLong         As Long\n    Dim lngLong2        As Long    \n    tblMain.Cells.Clear    \n    For lngLong = 1 To 10\n        For lngLong2 = 1 To 10\n            tblMain.Cells(lngLong, lngLong2) = lngLong * lngLong2\n        Next lngLong2\n    Next lngLong    \nEnd Sub\n\nPublic Sub ShowMainForm()    \n    If (objPresenter Is Nothing) Then\n        Set objPresenter = New clsSummaryPresenter\n    End If    \n    objPresenter.Show    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3109, "favorite_count": 2, "accepted_answer_id": 48427044, "answer_count": 1, "score": 3, "last_activity_date": 1516815244, "creation_date": 1516808630, "last_edit_date": 1516811268, "question_id": 48426349, "link": "https://stackoverflow.com/questions/48426349/userform-closes-after-end-sub-without-ever-calling-unload-me", "title": "Userform closes after &quot;End Sub&quot; without ever calling &quot;Unload Me&quot;", "body": "<p>I have a userform (baseUF) that has multiple pages and buttons that all do different things. I have this baseUF being modeless because I want the user to be able to play with the sheet without closing the userform and losing all of the data they input. However, I started having a problem that might be due to the modeless nature of the baseUF. </p>\n\n<p>There are other userforms that can be called from the baseUF. One executes with no issue by double clicking a textbox. However, the other userform is loaded after a button click. Once that button click sub is finished, the baseUF closes after the Exit Sub OR End Sub line. I don't remember this happening in the past and it doesn't happen with any other button click subs.</p>\n\n<p>Does anybody have an idea what the issue could be? I'm pretty lost because I don't have a command to close the baseUF anywhere in that sub. Below is some code to show what is happening:</p>\n\n<p>This sub is connected to a button on the spreadsheet to open the baseUF (the code is in a module).</p>\n\n<pre><code>Sub Button1_Click()\n\n' show the userform\nbaseUF.Show vbModeless\n\nEnd Sub\n</code></pre>\n\n<p>And this is the sub in the baseUF that calls an additional userform (LoadBox) which seems to be the issue.</p>\n\n<pre><code>Private Sub LoadQuery_Click()\n\n' I Dim a bunch of stuff here\n\n' if there are no saved queries, alert the user\nIf saveSht.Range(\"B3\").Value = \"\" Then\n    MsgBox \"No saved queries!\"\n    Exit Sub\n' if there is only one saved query, add it to the array and pop up the userform that allows for the user to select which save to load\nElseIf saveSht.Range(\"B4\").Value = \"\" Then\n    save_names = saveSht.Range(\"B3\").Value\n    LoadBox.Show\n' otherwise, add all of the save names to the array and pop up that userform\nElse\n    save_names = saveSht.Range(saveSht.Range(\"B3\"),saveSht.Range(\"B3\").End(xlDown)).Value\n    LoadBox.Show\nEnd If\n\n' if the user didn't select a save to load, stop trying to make stuff happen\nIf load_name = \"\" Then\n    ' the userform will also close here if this turns out to be true\n    Exit Sub\nEnd If\n\n' do a bunch of stuff with the selected name here\n\n' and after this line, the userform that contains this code closes\nEnd Sub\n</code></pre>\n\n<p>EDIT: here is some code showing the two other userforms</p>\n\n<p>This one is the userform with no issue that is called after a textbox is double clicked</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n' On start up of this form, populate the listbox with the relevant column names\n\n' Set position\nMe.StartUpPosition = 0\nMe.Top = baseUF.Top + 0.5 * baseUF.Height - 0.5 * Me.Height\nMe.Left = baseUF.Left + 0.5 * baseUF.Width - 0.5 * Me.Width\n\nWith FilterSelectionBox\n    ' First grab all of the column names from the main selected table\n    For i = 0 To baseUF.SelectionBox.ListCount - 1\n        .AddItem baseUF.SelectionBox.List(i)\n    Next i\n    ' Then grab all of the column names from the additional tables to be joined\n    If Not IsVariantEmpty(join_table_cols) Then\n        For n = 0 To UBound(join_table_cols)\n            If Not IsEmpty(join_table_cols(n)) Then\n                For Each col_name In join_table_cols(n)\n                    .AddItem col_name\n                Next\n            End If\n        Next n\n    End If\nEnd With\n\nEnd Sub\n\nPrivate Sub OkButton_Click()\n\n' Initialize the variables\nDim tb As MSForms.TextBox\nDim arr() As String\nDim str As String\n\n' tb is the textbox object that the column names will be pasted in to\nSet tb = baseUF.MultiPage1.Pages(baseUF.MultiPage1.Value).Controls(Me.Tag)\n\n' sets the str according to some logic\n\n' This is actually where it gets sent\ntb.Value = str\n\n' And close the form\nUnload Me\n\nEnd Sub\n</code></pre>\n\n<p>And this is the code in the userform with an issue</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n' On initialization, populate the combobox with all of the save names present in the spreadsheet\n\n' Set position\nMe.StartUpPosition = 0\nMe.Top = baseUF.Top + 0.5 * baseUF.Height - 0.5 * Me.Height\nMe.Left = baseUF.Left + 0.5 * baseUF.Width - 0.5 * Me.Width\n\nWith LoadComb\n    ' If there is more than one save present, go through the array and add each one\n    If IsArray(save_names) Then\n        For Each saved_name In save_names\n            .AddItem saved_name\n        Next\n    ' Otherwise just add the one\n    Else\n        .AddItem save_names\n    End If\nEnd With\n\nEnd Sub\n\nPrivate Sub LoadButton_Click()\n\n' When the user hits the load button, first check if they actually selected anything\nIf LoadComb.Value = \"\" Then\n    ' If they didn't, yell at them\n    MsgBox \"No saved query selected!\"\nElse\n    ' Otherwise, save the name to a global variable\n    load_name = LoadComb.Value\nEnd If\n\n' Close the form\nUnload Me\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516808710, "post_id": 48426285, "comment_id": 83842814, "body": "You can use the Find method, and then record a macro for the rest, or Google it - there&#39;s lots of material out there. Come back once you&#39;ve tried some code and got stuck - people here are generally not inclined to write code from scratch."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516808869, "post_id": 48426285, "comment_id": 83842941, "body": "With all the inserting of cells in the rows, wont you be offshifting a lot of your data?"}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516809477, "post_id": 48426460, "comment_id": 83843381, "body": "He might also need cells inserted at those locations as well (just going off his post)"}, {"owner": {"reputation": 3, "user_id": 5106273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac63136ea016a1b5df03b138096a263c?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/5106273/carl"}, "edited": false, "score": 0, "creation_date": 1516900463, "post_id": 48426460, "comment_id": 83889367, "body": "Thank you, I&#39;ll try this at work tomorrow Left columns are fabrics hung on rods. A few of the samples share 1 rod.  Right columns are rod locations.  Left columns are longer than right due to doubled fabrics.  Inserting rows equalizes the left and right columns. ie: Left column lists fabrics 1, 2, and 3. Right column lists locations 1, 2, and 3.  Fabrics 1 and  2 share a location.  I need for the right columns to reflect locations 1, 1A, and 2.  Shifting the cells in the right columns down and adding the data will equalize the columns and allow me to sort the file by location or by fabric."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1516901014, "post_id": 48426460, "comment_id": 83889714, "body": "I don&#39;t understand how many cells you are trying to insert, and when you insert a cell you want the other cells to move to the right? I&#39;ve updated my answer to show you how to insert a cell, you will need to amend this to add as many cells as you require..."}, {"owner": {"reputation": 3, "user_id": 5106273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac63136ea016a1b5df03b138096a263c?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/5106273/carl"}, "edited": false, "score": 0, "creation_date": 1517436376, "post_id": 48426460, "comment_id": 84100751, "body": "Thank you SO much!  I made a few slight modifications and it is perfect."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 5106273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac63136ea016a1b5df03b138096a263c?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/5106273/carl"}, "edited": false, "score": 0, "creation_date": 1517436419, "post_id": 48426460, "comment_id": 84100779, "body": "@Carl, please could you accept my response as an answer if it has helped you? Thanks :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1516914043, "last_edit_date": 1516914043, "creation_date": 1516808973, "answer_id": 48426460, "question_id": 48426285, "link": "https://stackoverflow.com/questions/48426285/insert-cells-when-condition-met/48426460#48426460", "title": "Insert cells when condition met", "body": "<p>I don't understand why you would want to add a space into the cells and then copy the details from the row above, so the code below simply copies the values from the row above:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\nLastRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n'get the last row with data on Column B\nFor i = 1 To LastRow 'loop from first row to last\n    If UCase(ws.Cells(i, 2)) = \"RIGHT\" Then 'check if the word \"Right\" is in cell regardless of it being uppercase or lowercase\n        ws.Range(\"D\" &amp; i &amp; \":F\" &amp; i).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n        ws.Cells(i, 3) = ws.Cells(i - 1, 3) 'get values from row above\n        ws.Cells(i, 4) = ws.Cells(i - 1, 4)\n        ws.Cells(i, 5) = ws.Cells(i - 1, 5)\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5106273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac63136ea016a1b5df03b138096a263c?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/5106273/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "accepted_answer_id": 48426460, "answer_count": 1, "score": 0, "last_activity_date": 1516914043, "creation_date": 1516808447, "last_edit_date": 1531164843, "question_id": 48426285, "link": "https://stackoverflow.com/questions/48426285/insert-cells-when-condition-met", "title": "Insert cells when condition met", "body": "<p>My Excel sheet has 6 columns as follows:\nColumn A: New Row,\nColumn B: New Dup,\nColumn C: New Fabric,\nColumn D: Location,\nColumn E: True Sort,\nColumn F: Excel Sort,</p>\n\n<p>I would like to know how to write a macro that searches column B and in every occurrence of the word \"Right\" in column B, a blank space is inserted in the corresponding row in columns D, E, and F, then the results from the corresponding columns in the row above are duplicated into those cells.</p>\n\n<p>ie:  First occurrence of the word \"Right\" is in B187.  The macro will insert a blank cell in D187, E187, and F187, then will copy the data in D186 into D187, the data from E186 into E187, and the data from F186 into F 187.</p>\n\n<p>The file has 750 rows.\nThanks for any insight!\nCarl</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1516808967, "post_id": 48426005, "comment_id": 83843013, "body": "Please use the <a href=\"https://stackoverflow.com/posts/48426005/edit\">edit</a> link and add to your problem description the Word field code that&#39;s generating the error. You might also trying searching with the special character for picking up fields: ^d"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1516810763, "post_id": 48426005, "comment_id": 83844345, "body": "You have added the VBA tag. Are you using this search in VBA or not?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1516813198, "post_id": 48426005, "comment_id": 83846044, "body": "@WiktorStribi\u017cew The person is not using RegEx, but Word&#39;s built-in search functionality. I&#39;m going to edit RegEx out of the question."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1516816249, "post_id": 48426005, "comment_id": 83847913, "body": "@WiktorStribizew Based on the screen shots: Everything between [SP] and [/SP], inclusive. But I&#39;m guessing the field code (bad cross-ref) is getting in the way with the Wildcards."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1516816281, "post_id": 48426005, "comment_id": 83847928, "body": "Beside searching the field code (^d) you might also try turning on the display of field codes before running the Find (Alt+F9)."}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1516816558, "post_id": 48426005, "comment_id": 83848094, "body": "It is not possible to find fields using a wildcard search in Word. You can either unlink all fields beforehand (using Ctrl+A followed by Ctrl+Shift+F9) or do the job using a VBA macro."}, {"owner": {"reputation": 67, "user_id": 1683620, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/abd8cd31a142b44ce9eef8ce768b68a2?s=128&d=identicon&r=PG", "display_name": "user1683620", "link": "https://stackoverflow.com/users/1683620/user1683620"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1516867685, "post_id": 48426005, "comment_id": 83867435, "body": "@Cindy I will try to turn on the display of fields and get back to you"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 1683620, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/abd8cd31a142b44ce9eef8ce768b68a2?s=128&d=identicon&r=PG", "display_name": "user1683620", "link": "https://stackoverflow.com/users/1683620/user1683620"}, "edited": false, "score": 0, "creation_date": 1516878273, "post_id": 48440513, "comment_id": 83873770, "body": "After various trials, I came to the same conclusion as you. Thanks"}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": true, "score": 0, "last_activity_date": 1516875652, "creation_date": 1516875652, "answer_id": 48440513, "question_id": 48426005, "link": "https://stackoverflow.com/questions/48426005/regular-expression-not-working-in-ms-word/48440513#48440513", "title": "Regular expression not working in MS Word", "body": "<p>It is impossible to find fields via wildcard search. I also cannot find an error field by searching for ^d without wildcard.</p>\n\n<p>Therefore: use two loops in your code. Before searching for [SP], iterate over all fields, identify those with error and delete / Replace with a space:</p>\n\n<pre><code>Dim fld As Field, ran As Range\n\nFor Each fld In ActiveDocument.Fields\n    If InStr(1, fld.Result.text, \"Erreur\u00a0!\") &gt;= 0 Then\n        Set ran = fld.Result\n        fld.Delete\n        ran.InsertAfter \" \"\n    End If\nNext fld\n</code></pre>\n\n<p>After that, run your normal wildcard search/replace for [SP]...[/SP] and you should be fine.</p>\n"}], "owner": {"reputation": 67, "user_id": 1683620, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/abd8cd31a142b44ce9eef8ce768b68a2?s=128&d=identicon&r=PG", "display_name": "user1683620", "link": "https://stackoverflow.com/users/1683620/user1683620"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 48440513, "answer_count": 1, "score": 0, "last_activity_date": 1516875652, "creation_date": 1516807538, "last_edit_date": 1516867631, "question_id": 48426005, "link": "https://stackoverflow.com/questions/48426005/regular-expression-not-working-in-ms-word", "title": "Regular expression not working in MS Word", "body": "<p>I have markups enclosing text in a word document.\nIf the markups enclose valid text or any <strong>valid</strong> dynamic field, the regular expression works :</p>\n\n<p><a href=\"https://i.stack.imgur.com/YOkFu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YOkFu.png\" alt=\"enter image description here\"></a></p>\n\n<p>But the second line, which contains an invalid cross-reference is not found by the search engine... whereas I need to find and delete it actually.</p>\n\n<p><strong>Edit on the 25/01/2018 :</strong></p>\n\n<p>Thanks for your answer.</p>\n\n<ol>\n<li>I run the search from a macro, that is right. I have no error from the macro, the sequence [SP]<em>invalid reference</em>[\\SP] is just not found</li>\n<li>I actually want to select <em>anything</em> between the two markups (table, image, text, reference, fields ...) <em>including</em> the markups</li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516808249, "post_id": 48426002, "comment_id": 83842444, "body": "Do you mean you want to delete the row if AY=X or Y? It&#39;s not clear."}, {"owner": {"reputation": 33, "user_id": 5317897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea00d465015d17f7d7283fe83aeedd48?s=128&d=identicon&r=PG&f=1", "display_name": "JesseE", "link": "https://stackoverflow.com/users/5317897/jessee"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516808790, "post_id": 48426002, "comment_id": 83842878, "body": "I want to delete the row if the value in AY does not equal X or Y."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1516808891, "post_id": 48426002, "comment_id": 83842958, "body": "Would you care to edit your question then, as it says the complete opposite."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5317897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea00d465015d17f7d7283fe83aeedd48?s=128&d=identicon&r=PG&f=1", "display_name": "JesseE", "link": "https://stackoverflow.com/users/5317897/jessee"}, "edited": false, "score": 0, "creation_date": 1516808945, "post_id": 48426278, "comment_id": 83842996, "body": "I tried it. Its past the mismatch error but it is still deleting value Y"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 33, "user_id": 5317897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea00d465015d17f7d7283fe83aeedd48?s=128&d=identicon&r=PG&f=1", "display_name": "JesseE", "link": "https://stackoverflow.com/users/5317897/jessee"}, "edited": false, "score": 0, "creation_date": 1516809054, "post_id": 48426278, "comment_id": 83843083, "body": "I&#39;ve updated my answer as I&#39;ve just noticed you want to keep the rows that contain either X or Y..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516809450, "post_id": 48426278, "comment_id": 83843360, "body": "The question has been confusingly worded, but I don&#39;t think this will do as the OP wants. E.g if the cell equals X then <code>.Value &lt;&gt; &quot;Y&quot;</code> will be true and the row will be deleted."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1516810022, "post_id": 48426278, "comment_id": 83843779, "body": "@SJR thanks for the insight, I&#39;ve updated my answer to AND instead or OR,.. I think this should resolve the issue."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1516809660, "last_edit_date": 1516809660, "creation_date": 1516808416, "answer_id": 48426278, "question_id": 48426002, "link": "https://stackoverflow.com/questions/48426002/macro-delete-row-if-value-does-not-match-this-or-that/48426278#48426278", "title": "Macro: Delete row if value does not match this or that", "body": "<p>How about the code below::</p>\n\n<pre><code>For Lrow = Lastrow To Firstrow + 1 Step -1\n     With .Cells(Lrow, \"AY\")\n        If Not IsError(.Value) Then\n            If .Value &lt;&gt; \"X\" AND .Value &lt;&gt; \"Y\" Then .EntireRow.Delete\n        End If\n    End With\nNext Lrow\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1516809599, "last_edit_date": 1516809599, "creation_date": 1516809292, "answer_id": 48426554, "question_id": 48426002, "link": "https://stackoverflow.com/questions/48426002/macro-delete-row-if-value-does-not-match-this-or-that/48426554#48426554", "title": "Macro: Delete row if value does not match this or that", "body": "<p>Be very careful using <code>AND</code>s and <code>OR</code>s around <code>Not</code> - you have to think it through:</p>\n\n<p>NOTE. <code>NOT(a</code><strong><em><code>OR</code></em></strong><code>b)</code> is the same as <code>NOT(a)</code><strong><em><code>AND</code></em></strong><code>NOT(b)</code></p>\n\n<p>The following code will do what you need:</p>\n\n<pre><code>For Lrow = Lastrow To Firstrow + 1 Step -1\n    With ActiveSheet.Cells(Lrow, \"AY\")\n        If Not (.Text = \"X\" Or .Text = \"Y\") Then .EntireRow.Delete\n    End With\nNext Lrow\n</code></pre>\n\n<p>The following line would also work instead:</p>\n\n<pre><code>       If Not (.Text = \"X\") And Not(.Text = \"Y\") Then .EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5317897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea00d465015d17f7d7283fe83aeedd48?s=128&d=identicon&r=PG&f=1", "display_name": "JesseE", "link": "https://stackoverflow.com/users/5317897/jessee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1244, "favorite_count": 0, "accepted_answer_id": 48426554, "answer_count": 2, "score": 0, "last_activity_date": 1516809660, "creation_date": 1516807529, "last_edit_date": 1531164843, "question_id": 48426002, "link": "https://stackoverflow.com/questions/48426002/macro-delete-row-if-value-does-not-match-this-or-that", "title": "Macro: Delete row if value does not match this or that", "body": "<p>I am trying to modify the following code that if it does not match \"X\" or \"Y\" then delete the entire row. I tried to add just '\"Or \"Y\"' but I get a type mismatch</p>\n\n<pre><code>For Lrow = Lastrow To Firstrow + 1 Step -1\n     With .Cells(Lrow, \"AY\")\n        If Not IsError(.Value) Then\n            If Not .Value Like \"X\" Then .EntireRow.Delete\n        End If\n    End With\nNext Lrow\n</code></pre>\n\n<p>Any thoughts? Or suggestions for replacement?</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516808243, "post_id": 48425938, "comment_id": 83842437, "body": "See if <a href=\"https://stackoverflow.com/q/28511508/1188513\">this Q&amp;A helps</a>"}, {"owner": {"reputation": 155, "user_id": 5612361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/131fde059bc2b0f37850dff0cc0ad0a9?s=128&d=identicon&r=PG&f=1", "display_name": "Hsmith", "link": "https://stackoverflow.com/users/5612361/hsmith"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516811273, "post_id": 48425938, "comment_id": 83844721, "body": "Nice link.  Created the class.  Added     <code>Dim myClass1 As Class1     Set myClass1 = New Class1     Class1.ScreenUpdating = False</code> before my update and save and then True after. Same behaviour.  Tried reversing the true and false.  Same."}], "owner": {"reputation": 155, "user_id": 5612361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/131fde059bc2b0f37850dff0cc0ad0a9?s=128&d=identicon&r=PG&f=1", "display_name": "Hsmith", "link": "https://stackoverflow.com/users/5612361/hsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516807636, "creation_date": 1516807291, "last_edit_date": 1516807636, "question_id": 48425938, "link": "https://stackoverflow.com/questions/48425938/powerpoint-linked-object-update-flickers", "title": "powerpoint linked object update flickers", "body": "<p>After much hunting the last couple days, I've managed to get my powerpoint to update its excel link (which itself has data from an autoupdate query off our SQL db).<br>\nI open the excel file, then the powerpoint.\nI have Excel autosaving every minute (will be every 10 when go live).\nthe powerpoint has this in module 1</p>\n\n<pre><code>Sub SlideShowNextSlide(ByVal Wn As SlideShowWindow)\n\n    ActivePresentation.UpdateLinks\n\n    With Application.ActivePresentation\n        If Not .Saved And .Path &lt;&gt; \"\" Then .Save\n    End With\n\nEnd Sub\n\nSub OnSlideShowPageChange(ByVal objWindow As SlideShowWindow)\n\n    ActivePresentation.UpdateLinks\n\n    With Application.ActivePresentation\n        If Not .Saved And .Path &lt;&gt; \"\" Then .Save\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I set the slideshow to loop until <kbd>ESC</kbd>.\nthe VBA does (almost all the time) run.  </p>\n\n<p>But when it runs, it loads the slide with the refreshed data.. <strong>and then in the last instant before the slide changes to the next one, you see the old data flicker onto the screen.</strong></p>\n\n<p>That's why I put that save after the updatelinks, hoping it would make the update stick for the next cycle.. but no joy.\nIs there some sort of cache it uses while the slideshow is running?  Can it be updated?  Somehow have the running slideshow 'reload' from the now saved file.</p>\n\n<p>If I have to I'll have the slideshow stop every hour and restart using some sort of Windows macro.. but that would be pretty ducktape-y.</p>\n"}, {"tags": ["excel", "vba", "recursion", "path-finding"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9262567, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W-XL7NDs7Ao/AAAAAAAAAAI/AAAAAAAAD-w/qvlbpUxv5l0/photo.jpg?sz=128", "display_name": "Lucas Moraes Abarca", "link": "https://stackoverflow.com/users/9262567/lucas-moraes-abarca"}, "edited": false, "score": 0, "creation_date": 1516870005, "post_id": 48428543, "comment_id": 83868614, "body": "I tried that too, but that makes Excel crash/not respond. I tried making the <code>used</code> argument being <code>ByVal</code>, but that results in the same problem."}, {"owner": {"reputation": 13, "user_id": 9262567, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W-XL7NDs7Ao/AAAAAAAAAAI/AAAAAAAAD-w/qvlbpUxv5l0/photo.jpg?sz=128", "display_name": "Lucas Moraes Abarca", "link": "https://stackoverflow.com/users/9262567/lucas-moraes-abarca"}, "edited": false, "score": 0, "creation_date": 1516872563, "post_id": 48428543, "comment_id": 83870172, "body": "Apparently you were right, the only problem was the size of the database i was dealing with. I tried the example one and it worked great. Not to find a way to make this work with a 120 connections list!"}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": false, "score": 0, "last_activity_date": 1516815470, "creation_date": 1516815470, "answer_id": 48428543, "question_id": 48425628, "link": "https://stackoverflow.com/questions/48425628/finding-all-available-paths-with-a-location-connection-list-on-excel-using-vba/48428543#48428543", "title": "Finding all available paths with a location connection list on Excel using VBA", "body": "<p>It's not that <code>used</code> is being treated as a global variable - it's that you're changing it before calling the recursive function. Try deleting <code>used = used &amp; target &amp; \"|\"</code> and changing the next line to <code>Call worm(target, vend, (vlvl + 1), used &amp; target &amp; \"|\")</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9262567, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W-XL7NDs7Ao/AAAAAAAAAAI/AAAAAAAAD-w/qvlbpUxv5l0/photo.jpg?sz=128", "display_name": "Lucas Moraes Abarca", "link": "https://stackoverflow.com/users/9262567/lucas-moraes-abarca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1516815470, "creation_date": 1516806341, "last_edit_date": 1516807492, "question_id": 48425628, "link": "https://stackoverflow.com/questions/48425628/finding-all-available-paths-with-a-location-connection-list-on-excel-using-vba", "title": "Finding all available paths with a location connection list on Excel using VBA", "body": "<p>Currently, I have a list of connected locations like the following example:  </p>\n\n<pre><code>A|B  \nA|C  \nB|C  \nB|E  \nC|D    \nC|Z  \n</code></pre>\n\n<p>Which would mean a network like <strong><a href=\"https://i.imgur.com/kXoiOWA.png\" rel=\"nofollow noreferrer\">this</a></strong></p>\n\n<p>The goal would be, given a Start and End location, list all possible paths. So for example, given Start = A &amp; End = Z, we'd have:</p>\n\n<pre><code>A-C-Z  \nA-B-C-Z\n</code></pre>\n\n<p>Right now, I have the following code set up:</p>\n\n<pre><code>Sub run_report()\n    Set euh = Sheets(\"Input\")\n    'B5 and D5 are the two locations to be connected\n    If euh.Range(\"B5\").Value &lt;&gt; \"\" And euh.Range(\"D5\").Value &lt;&gt; \"\" Then\n        Call worm(euh.Range(\"B5\").Value, euh.Range(\"D5\").Value, 1,  euh.Range(\"B5\").Value &amp; \"|\")\n        ' \"Hops\" is where the available paths will be displayed\n        Sheets(\"Hops\").Activate\n    Else\n        MsgBox \"Both locations need to be selected!\"\n    End If\nEnd Sub\n\n'Starting/Current location, End/Goal location, current number of connections used so far, used nodes/locations in this path\nSub worm(vstart As String, vend As String, vlvl As Integer, used As String)\n    ' \"DB\" is the connection list database\n    Set sdb = Sheets(\"DB\")\n    Set sh = Sheets(\"Hops\")\n    Dim target As String\n    Dim vline As Integer\n\n    ' Iterates through all available connections looking for the next step\n    For a = 1 To sdb.Range(\"A1\").End(xlDown).Row\n        If sdb.Range(\"A\" &amp; a).Value = vstart Or sdb.Range(\"B\" &amp; a).Value = vstart Then\n            If sdb.Range(\"A\" &amp; a).Value = vstart Then\n                target = sdb.Range(\"B\" &amp; a).Value\n            Else\n                target = sdb.Range(\"A\" &amp; a).Value\n            End If\n\n\n            If target = vend Then\n                'Add successfull connection\n                used = used &amp; target\n                vline = IIf(sh.Range(\"A2\").Value &lt;&gt; \"\", sh.Range(\"A1\").End(xlDown).Row + 1, 2)\n                sh.Range(\"A\" &amp; vline).Value = vlvl\n                sh.Range(\"C\" &amp; vline).Value = used\n            'If the current node/location hasn't been used so far\n            ElseIf InStr(used, target) = 0 Then\n                used = used &amp; target &amp; \"|\"\n                Call worm(target, vend, (vlvl + 1), used)\n            End If\n        End If\n    Next a\nEnd Sub\n</code></pre>\n\n<p>Right now the code works <em>mostly</em> as it should, <strong>but I think the problem is that instead of the sub [worm] passing the arguments as temporary for each next recursion, the variables <em>vlvl</em> and <em>used</em> are being treated as a global</strong>, so even when the code reaches a dead end path, the nodes that were used to get there are still being added for the next iterations, so the previous example would print out as:</p>\n\n<p>A-B-C-[D] <em>(dead end)</em>-Z<br>\n<em>[<strong>the entire previous line</strong>]</em> + A-C- <em>[B-E](dead end 1)</em> <em>-[D](dead end 2)</em> - Z</p>\n\n<p>Any ideas on how that could be fixed?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1516807127, "post_id": 48425508, "comment_id": 83841565, "body": "I don&#39;t think late binding will give you <i>that much</i> of a decrease in performance. If your code is small, you won&#39;t even notice it."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1516808400, "post_id": 48425508, "comment_id": 83842568, "body": "Late binding is going to work best for you, as when a new version of Excel comes out, you wont have to change your code. It will just work. Why do you not want to use late binding?"}, {"owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516813480, "post_id": 48425508, "comment_id": 83846235, "body": "@braX my code is quite large, and currently takes between 2-6 minutes to complete depending on the size of the file I&#39;m working with. I&#39;ve done as much optimizing as I can to reduce it to this size. Late binding was an option I explored a while back but it slowed the program down significantly..."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516819405, "post_id": 48425508, "comment_id": 83849655, "body": "The only reason I can think of for it to slow you down that much is if you had your <code>CreateObject</code> call inside of a loop, which would not be the right way to structure the code in the first place."}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 0, "creation_date": 1516859461, "post_id": 48425508, "comment_id": 83864121, "body": "I couldn&#39;t find a complete list. You might just have to try different versions to get them all. It does leave you in the position that you will have to maintain the list though. If you&#39;re really against late binding, and don&#39;t want to maintain the list, you could obtain the CLSID dynamically using <code>clsid = CreateObject(&quot;WScript.Shell&quot;).RegRead(&quot;HKCR\\Excel.Applicatio&zwnj;&#8203;n\\CLSID\\&quot;)</code>."}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 0, "creation_date": 1516859533, "post_id": 48425508, "comment_id": 83864146, "body": "FYI - the CLSID for Excel 2016 is <code>{00024500-0000-0000-C000-000000000046}</code>. Maybe if everyone puts theirs you&#39;ll end up with your list :)."}, {"owner": {"reputation": 2401, "user_id": 12695027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i74ZG.png?s=128&g=1", "display_name": "Scratte", "link": "https://stackoverflow.com/users/12695027/scratte"}, "edited": false, "score": 0, "creation_date": 1615458248, "post_id": 48425508, "comment_id": 117698835, "body": "<a href=\"https://stackoverflow.com/users/15373669\">Christoph Damoser</a> wrote an <a href=\"https://stackoverflow.com/a/66577873\">Answer</a> saying &quot;Maybe this post help: <a href=\"https://social.msdn.microsoft.com/Forums/en-US/d0daa06d-c6ac-4582-afc9-92df27ab98d3/how-to-get-programmatically-a-list-of-all-available-references-of-a-vba-project?forum=isvvba&amp;amp;prof=required\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a> There is a macro from Peter Thornton which list all references GUID, path and name (-&gt;; .Reference.Description)&quot;"}], "owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1615446519, "creation_date": 1516805995, "question_id": 48425508, "link": "https://stackoverflow.com/questions/48425508/a-list-of-all-possible-excel-guid", "title": "A list of all possible Excel GUID", "body": "<p>I'm currently trying to implement something in the office that runs from powerpoint and goes into excel, but to do so I need to add a reference to Excel (unless I do late binding, which I don't want to do.) This is the code that will be adding the GUID reference:</p>\n\n<pre><code>'Activate Excel Library (version 2.0)\n    Application.VBE.ActiveVBProject.References.AddFromGuid _\n      GUID:=\"{00020813-0000-0000-C000-000000000046}\", _\n      Major:=0, Minor:=0\n</code></pre>\n\n<p>The issue here is that not everyone in the office has the same version of Excel. I need to be able to add a reference to anyone's Excel. Is there a list out there somewhere of all possible GUIDs since like office 2003?\nOr maybe there's a different way I'm not thinking of to do this?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1516804997, "post_id": 48425122, "comment_id": 83839950, "body": "on the second, change <code>FormulaLocal</code> to <code>Formula</code>"}, {"owner": {"reputation": 85, "user_id": 9131274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff3271092d269820727d577654ed8aa?s=128&d=identicon&r=PG&f=1", "display_name": "Claus Maier", "link": "https://stackoverflow.com/users/9131274/claus-maier"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516805245, "post_id": 48425122, "comment_id": 83840136, "body": "wow, that was quick and easy - I&#39;m impressed - thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 9131274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff3271092d269820727d577654ed8aa?s=128&d=identicon&r=PG&f=1", "display_name": "Claus Maier", "link": "https://stackoverflow.com/users/9131274/claus-maier"}, "edited": false, "score": 0, "creation_date": 1516805414, "post_id": 48425239, "comment_id": 83840250, "body": "Hey Leo, that does the trick - I&#39;m going to read the exact differences for those - thanks a million!"}], "tags": [], "owner": {"reputation": 3021, "user_id": 9208197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e545ac8c6a4f6c5cad3832d7463c15?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o R.", "link": "https://stackoverflow.com/users/9208197/l%c3%a9o-r"}, "is_accepted": true, "score": 3, "last_activity_date": 1516805229, "creation_date": 1516805229, "answer_id": 48425239, "question_id": 48425122, "link": "https://stackoverflow.com/questions/48425122/language-independent-formulas/48425239#48425239", "title": "Language independent formulas", "body": "<p>VBA is very EN-US-centric. VBA's .Formula and .FormulaR1C1 expect the ROW function. To use regional language function 'flavors' like SUMME then the Range.FormulaLocal property or Range.FormulaR1C1Local property should be employed instead.</p>\n\n<p>So instead of use <code>.FormulaLocal</code> just use <code>.Formula</code> with EN language, your code will be interpreted in every language.</p>\n"}], "owner": {"reputation": 85, "user_id": 9131274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff3271092d269820727d577654ed8aa?s=128&d=identicon&r=PG&f=1", "display_name": "Claus Maier", "link": "https://stackoverflow.com/users/9131274/claus-maier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "accepted_answer_id": 48425239, "answer_count": 1, "score": 1, "last_activity_date": 1516807439, "creation_date": 1516804892, "last_edit_date": 1516807439, "question_id": 48425122, "link": "https://stackoverflow.com/questions/48425122/language-independent-formulas", "title": "Language independent formulas", "body": "<p>I'd like to prepare an overview tab with some formulas, though not all colleagues use an en-us version of Excel - I currently use de-at languages pack. Therefore I started using .FormulaLocal but it doesn't quite work in my case</p>\n\n<p>In this example I try to prepare a formula that sums up all \"light\" errors from various tabs. I have two versions</p>\n\n<p><strong>Version 1</strong> (does work with de-at Excel)</p>\n\n<pre><code>Sub count_light_errors(tabName)\nDim element As Variant\nDim formula As String\nDim temp As Variant\n\nFor Each element In tabName\n    temp = temp &amp; \"z\u00e4hlenwenn(\" &amp; element &amp; \"!E:E;\"\"light\"\");\"\nNext element\n\nformula = \"=summe(\" &amp; Left(temp, Len(temp) - 1) &amp; \")\"\nWorksheets(\"Overview\").Range(\"C8\").FormulaLocal = formula\n\nEnd Sub\n</code></pre>\n\n<p><strong>Version 2</strong> (does not work with de-at Excel)</p>\n\n<pre><code>Sub count_light_errors(tabName)\nDim element As Variant\nDim formula As String\nDim temp As Variant\n\nFor Each element In tabName\n    temp = temp &amp; \"countif(\" &amp; element &amp; \"!E:E,\"\"light\"\"),\"\nNext element\n\nformula = \"=sum(\" &amp; Left(temp, Len(temp) - 1) &amp; \")\"\nWorksheets(\"Overview\").Range(\"C8\").FormulaLocal = formula\n\nEnd Sub\n</code></pre>\n\n<p>The difference between those two is just using the German words for</p>\n\n<ul>\n<li>SUM() -> SUMME()</li>\n<li>COUNTIF() -> Z\u00c4HLENWENN()</li>\n</ul>\n\n<p>and\n; instead of , as seperator</p>\n\n<p>How do I prepare formulas correctly, so they are independent from the user language pack?</p>\n\n<p>Thanks a million!<br>\n-Claus</p>\n"}, {"tags": ["excel", "vba", "multidimensional-array", "constants"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7803350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69b6f2d0e1442cbef1c97ab53d72e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "alosc", "link": "https://stackoverflow.com/users/7803350/alosc"}, "edited": false, "score": 0, "creation_date": 1516805009, "post_id": 48424978, "comment_id": 83839959, "body": "Thanks, i do not know why i was under the impression that ReDim didn&#39;t work when working with multidimensional arrays"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 51, "user_id": 7803350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69b6f2d0e1442cbef1c97ab53d72e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "alosc", "link": "https://stackoverflow.com/users/7803350/alosc"}, "edited": false, "score": 0, "creation_date": 1516805049, "post_id": 48424978, "comment_id": 83839983, "body": "You are thinking of <code>Redim Preserve</code> which only allows the expansion of the last dimension."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1516804501, "creation_date": 1516804501, "answer_id": 48424978, "question_id": 48424931, "link": "https://stackoverflow.com/questions/48424931/declaring-multidimensional-array-size-through-a-variable/48424978#48424978", "title": "Declaring multidimensional array size through a variable", "body": "<p>First delare the array then redim it to the size.</p>\n\n<pre><code>Dim Data() as Double\nRedim Data(1 to YearAmount,1 to 12,1 to 31,0 to 23) as Double\n</code></pre>\n\n<p>The dim statement can be with the other declarations. </p>\n"}], "owner": {"reputation": 51, "user_id": 7803350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69b6f2d0e1442cbef1c97ab53d72e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "alosc", "link": "https://stackoverflow.com/users/7803350/alosc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1614, "favorite_count": 0, "accepted_answer_id": 48424978, "answer_count": 1, "score": 2, "last_activity_date": 1594153420, "creation_date": 1516804373, "last_edit_date": 1594153420, "question_id": 48424931, "link": "https://stackoverflow.com/questions/48424931/declaring-multidimensional-array-size-through-a-variable", "title": "Declaring multidimensional array size through a variable", "body": "<p>I do have a large data set which has hourly data for some amount of years:\nI want to make a 4 dimensional array which has the following form:</p>\n\n<p>To get the amount of years i have to find the last observed data and then compare it to the first one, to do so i need the amount of used rows.</p>\n\n<pre><code>Dim YearAmount As Integer\n\nConst Lastrow As Long = Sheets(1).Cells(Sheets(1).Rows.Count,\"A\").End(xlUp).Row\n\n'This returns an error, saying \"Constant expression required\"\n\nYearAmount=Datediff(\"yyyy\", Range(\"A2\").Value , Range(\"A\" &amp; Lastrow ).Value) + 1\n\nDim Data(1 to YearAmount,1 to 12,1 to 31,0 to 23) as Double\n</code></pre>\n\n<p>I don't know how to get arround properly dimensioning my Data array, should i initialize it as a variant array and then use the ReDim method?, and if so, how would i go about resizing to more dimensions?</p>\n\n<p>Trying to declare LastRow and YearAmount as constants didn't work, since vba yells that i'm trying to set a function return value as the constant, this I do not know how to get around. </p>\n"}, {"tags": ["vba", "excel", "enumeration", "pivot-chart"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516803625, "post_id": 48424549, "comment_id": 83838850, "body": "Google <code>Enum msoTrue</code> and <code>Enum msoPatternDarkUpwardDiagonal</code> to find out the values, then just replace using the values."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516804161, "post_id": 48424549, "comment_id": 83839280, "body": "That&#39;s what you get for writing tired; I could not, for the life of me, figure this out. Thanks @braX"}], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1516804320, "creation_date": 1516803228, "last_edit_date": 1516804320, "question_id": 48424549, "link": "https://stackoverflow.com/questions/48424549/formatting-pivotchart-series", "title": "Formatting PivotChart Series", "body": "<p>I have a pivot chart and I'm trying to format certain dataseries in my chart with a pattern. I recorded a macro to see how Excel would do that. This gave me:</p>\n\n<pre><code>With Selection.Format.Fill\n    .Visible = msoTrue\n    .Patterned msopatternDarkUpwardDiagonal\nEnd With\n</code></pre>\n\n<p>Which I've adapted to:</p>\n\n<pre><code>With chrt1Overview 'chart object codename\n    (....)\n    With .FullSeriesCollection(i) 'iterating through series\n        .ChartType = xlColumnStacked\n        If .Name Like \"FORECAST\" Then\n            With .Format.Fill\n                .Visible = msoTrue\n                .Patterned msoPatternDarkUpwardDiagonal\n            End With\n        End If\n    End with\nEnd with\n</code></pre>\n\n<p>This gives me the error below and highlights both <code>msoTrue</code> and <code>msoPatternDarkupwardDiagonal</code> in my code</p>\n\n<blockquote>\n  <p>Compile error:</p>\n  \n  <p>Variable not defined</p>\n</blockquote>\n\n<p>Running the macro as created by the recorder does not work either, the <code>mso</code> \"variables\" are empty and gives an error that the specified value is out of range but does not give me a compile error because the <code>Option Explicit</code> is not set on this module.</p>\n\n<p>What is the correct way to set a pattern fill on a data series?</p>\n"}, {"tags": ["excel", "vba", "delete-row"], "comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 1, "creation_date": 1516803347, "post_id": 48424411, "comment_id": 83838653, "body": "Also if your File is dynamic/big, I would put LastRow as Long instead of Integer"}], "answers": [{"comments": [{"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 1, "creation_date": 1516803084, "post_id": 48424441, "comment_id": 83838483, "body": "shouldn&#39;t it be <code>LastRow &gt; 6</code> Mark&#39;s header ends at <code>B6:M6</code>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1516803147, "post_id": 48424441, "comment_id": 83838526, "body": "@R.Roe Yup - Good catch."}, {"owner": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "edited": false, "score": 1, "creation_date": 1516803401, "post_id": 48424441, "comment_id": 83838689, "body": "That did it! Thank you!"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1516803405, "last_edit_date": 1516803405, "creation_date": 1516802901, "answer_id": 48424441, "question_id": 48424411, "link": "https://stackoverflow.com/questions/48424411/deleting-last-row-of-table-prevent-header-deletion/48424441#48424441", "title": "Deleting Last Row of Table / Prevent Header Deletion", "body": "<p>Use an <code>If</code> statement to check the value of LastRow before you delete it. (Also, you will want to fully qualify your objects using the Sheet)</p>\n\n<pre><code>Sub DeleteRow()\n      Dim LastRow As Long\n      LastRow = Worksheets(\"MTO\").Range(\"J\" &amp; Worksheets(\"MTO\").Rows.count).End(xlUp).Row\n      If LastRow &gt; 6 Then\n          Worksheets(\"MTO\").Rows(LastRow &amp; \":\" &amp; LastRow).Delete shift:=xlUp\n      End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/if-then-else-statement\" rel=\"nofollow noreferrer\">If Statements</a></p>\n\n<p>Or simplify it using a <code>With</code></p>\n\n<pre><code>Sub DeleteRow()\n  Dim LastRow As Long\n  With Worksheets(\"MTO\")\n      LastRow = .Range(\"J\" &amp; .Rows.count).End(xlUp).Row\n      If LastRow &gt; 6 Then\n          .Rows(LastRow &amp; \":\" &amp; LastRow).Delete shift:=xlUp\n      End If\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1516803437, "creation_date": 1516803437, "answer_id": 48424617, "question_id": 48424411, "link": "https://stackoverflow.com/questions/48424411/deleting-last-row-of-table-prevent-header-deletion/48424617#48424617", "title": "Deleting Last Row of Table / Prevent Header Deletion", "body": "<p>It's always better to declare worksheet variable to make the code more readable.</p>\n\n<p>You may try something like this...</p>\n\n<pre><code>Sub DeleteRow()\n    Dim ws As Worksheet\n    Dim LastRow As Integer\n    Set ws = Worksheets(\"MTO\")\n    LastRow = ws.Range(\"J\" &amp; Rows.Count).End(xlUp).Row\n    If LastRow &gt; 6 Then ws.Rows(LastRow).Delete\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 48424441, "answer_count": 2, "score": 1, "last_activity_date": 1516803437, "creation_date": 1516802784, "last_edit_date": 1516802797, "question_id": 48424411, "link": "https://stackoverflow.com/questions/48424411/deleting-last-row-of-table-prevent-header-deletion", "title": "Deleting Last Row of Table / Prevent Header Deletion", "body": "<p>I have the following code which is assigned to a button.  When pressed, the button will delete the last row in a table.  The table's top row is a header.  I'm trying to figure out how to prevent/protect the header (B6:M6) and the rows above it from being deleted accidentally if the \"delete row\" button is clicked one too many times.  Any help would be much appreciated.  Thank you.</p>\n\n<pre><code>Sub DeleteRow()\n\nDim LastRow As Integer\n\n          LastRow = Worksheets(\"MTO\").Range(\"J\" &amp; Rows.count).End(xlUp).Row\n          Worksheets(\"MTO\").Rows(LastRow &amp; \":\" &amp; LastRow).Delete shift:=xlUp\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "runtime-error"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516801756, "post_id": 48423957, "comment_id": 83837546, "body": "So where exactly does the error occur? Headline says &quot;<i>when creating checkboxes</i>&quot; text says &quot;<i>where it deletes the checkboxes</i>&quot;. Please be clear about which line throws the error."}, {"owner": {"reputation": 137, "user_id": 5860060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1746576902242715/picture?type=large", "display_name": "Cody Pace", "link": "https://stackoverflow.com/users/5860060/cody-pace"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516801920, "post_id": 48423957, "comment_id": 83837665, "body": "It&#39;s when it deletes the checkboxes. I finally figured out why. It&#39;s not letting me edit the checkboxes when the workbook is shared. i.e. i can&#39;t manually select or delete them either. But i don&#39;t know how to fix it"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516802159, "post_id": 48423957, "comment_id": 83837847, "body": "Can you define &quot;shared workbook&quot;? Are you using sharepoint? Is it a network share? And do you use any workbook or worksheet protection?"}, {"owner": {"reputation": 137, "user_id": 5860060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1746576902242715/picture?type=large", "display_name": "Cody Pace", "link": "https://stackoverflow.com/users/5860060/cody-pace"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516802822, "post_id": 48423957, "comment_id": 83838297, "body": "I&#39;m sharing the workbook on a shared drive over the network and using the &quot;Shared Workbook&quot; feature in excel 2016"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516803379, "post_id": 48423957, "comment_id": 83838671, "body": "Then this might be a workbook protection issue. In the dialog of the shared workbook feature you should find a button like &quot;workbook protection \u2026&quot; (I can&#39;t tell the exact wording because I use a german Excel). There you can allow the editing of objects. Then everybody should be able to delete the checkboxes. But I&#39;m not 100% sure if it is possible at all that someone can delete the checkboxes in a shared workbook."}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 5860060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1746576902242715/picture?type=large", "display_name": "Cody Pace", "link": "https://stackoverflow.com/users/5860060/cody-pace"}, "is_accepted": true, "score": 1, "last_activity_date": 1516813722, "creation_date": 1516813722, "answer_id": 48428038, "question_id": 48423957, "link": "https://stackoverflow.com/questions/48423957/shared-workbook-error-when-deleting-checkboxes/48428038#48428038", "title": "Shared workbook error when deleting checkboxes", "body": "<p>I was able to get around this error finally by making the workbook exclusive and then sharing the workbook again once i was done adding the buttons. </p>\n\n<pre><code>Sub MakeExclusive()\n\n    If ActiveWorkbook.MultiUserEditing Then\n        Application.DisplayAlerts = False\n        ActiveWorkbook.ExclusiveAccess\n        Application.DisplayAlerts = True\n    End If\n\nEnd Sub\n\nSub MakeShared()\n\n    If Not ActiveWorkbook.MultiUserEditing Then\n        Application.DisplayAlerts = False\n        ActiveWorkbook.SaveAs ActiveWorkbook.Name, accessmode:=xlShared\n        Application.DisplayAlerts = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I <code>call Sub MakeExclusive(</code>) on the first line of my sub and i <code>call MakeShared()</code> on the last line. </p>\n"}], "owner": {"reputation": 137, "user_id": 5860060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1746576902242715/picture?type=large", "display_name": "Cody Pace", "link": "https://stackoverflow.com/users/5860060/cody-pace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 48428038, "answer_count": 1, "score": 0, "last_activity_date": 1516813722, "creation_date": 1516801436, "last_edit_date": 1516802383, "question_id": 48423957, "link": "https://stackoverflow.com/questions/48423957/shared-workbook-error-when-deleting-checkboxes", "title": "Shared workbook error when deleting checkboxes", "body": "<p>Can Someone please tell me why the following code will run fine until I share the workbook? It runs until the point where it deletes the checkboxes. I can't figure out what's going on. As far as i know I'm not using any unsupported feature.</p>\n\n<p>I get </p>\n\n<blockquote>\n  <p>runtime error 1004 </p>\n</blockquote>\n\n<p>when deleting checkboxes</p>\n\n<pre><code>   Private Sub RunMe()\n\n    Const BOX_SIZE As Integer = 16\n    Dim ws As Worksheet\n    Dim cell As Range\n    Dim cbox As CheckBox\n    Dim i As Integer, j As Integer\n    Dim boxLeft As Double, boxTop As Double\n\n    'Select Worsheet\n    Set ws = ThisWorkbook.Worksheets(\"Sunday\")\n\n    'Clear Ranges that will be changed when CheckBoxes are clicked\n    Worksheets(\"Sunday\").Range(\"F2:G116\").ClearContents\n    Worksheets(\"Sunday\").Range(\"I2:K116\").ClearContents\n    'Call FillDown\n\n    'Delete checkboxes\n    For Each cbox In ws.CheckBoxes\n        cbox.Delete\n    Next\n\n    'Add checkboxes\n    For i = 2 To 116\n        For j = 8 To 8\n            Set cell = ws.cells(i, j)\n            With cell\n                boxLeft = .Width / 2 - BOX_SIZE / 2 + .Left\n                boxTop = .Height / 2 - BOX_SIZE / 2 + .Top\n            End With\n            Set cbox = ws.CheckBoxes.Add(boxLeft, boxTop, BOX_SIZE, BOX_SIZE)\n            With cbox\n                .Name = \"CB\" &amp; i &amp; j\n                .Caption = \"\"\n                .OnAction = \"CheckBox_Clicked\"\n                .Placement = xlFreeFloating\n            End With\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516801484, "post_id": 48423862, "comment_id": 83837380, "body": "That was easy. I attempted to use the <code>Characters</code> property but couldn&#39;t successfully call it on those cells (since those strings don&#39;t support RTF?) so I overlooked the other properties involving characters. I&#39;ll accept this when the requisite time has elapsed. Thanks."}], "tags": [], "owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "is_accepted": true, "score": 6, "last_activity_date": 1516801129, "creation_date": 1516801129, "answer_id": 48423862, "question_id": 48423744, "link": "https://stackoverflow.com/questions/48423744/determining-if-a-string-has-been-entered-with-a-leading-single-quote/48423862#48423862", "title": "Determining if a string has been entered with a leading single quote", "body": "<p>You can use the <code>PrefixCharacter</code> property of <code>Range</code> to access the apostrophe.</p>\n\n<pre><code>Debug.Print [A1].PrefixCharacter ' prints blank line\nDebug.Print [A2].PrefixCharacter ' prints apostrophe\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516801909, "post_id": 48423868, "comment_id": 83837656, "body": "Good answer (+1)  but the other answer was first by about 10 seconds. There is still a potentially interesting question about how to programmatically access the displayed string in the formula bar."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516802129, "post_id": 48423868, "comment_id": 83837811, "body": "@JohnColeman  I have never attempted to get the Formula Bar as a text string."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516802692, "post_id": 48423868, "comment_id": 83838190, "body": "It was actually your comment to this question that got me wondering about that: <a href=\"https://stackoverflow.com/q/41596316/4996248\">stackoverflow.com/q/41596316/4996248</a>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1516801145, "creation_date": 1516801145, "answer_id": 48423868, "question_id": 48423744, "link": "https://stackoverflow.com/questions/48423744/determining-if-a-string-has-been-entered-with-a-leading-single-quote/48423868#48423868", "title": "Determining if a string has been entered with a leading single quote", "body": "<p>Consider:</p>\n\n<pre><code>Sub SingleQuoteTest()\n    MsgBox ActiveCell.PrefixCharacter = \"'\"\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aIHTC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aIHTC.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 48423862, "answer_count": 2, "score": 3, "last_activity_date": 1516801145, "creation_date": 1516800759, "last_edit_date": 1531164843, "question_id": 48423744, "link": "https://stackoverflow.com/questions/48423744/determining-if-a-string-has-been-entered-with-a-leading-single-quote", "title": "Determining if a string has been entered with a leading single quote", "body": "<p>This question arose in my attempt to answer <a href=\"https://stackoverflow.com/q/48421941/4996248\">this question</a>:</p>\n\n<p>In a blank workbook, format <code>A1:A2</code> as text. In <code>A1</code> type <code>123</code> and in A2 type <code>'123</code>. Both result in the string <code>\"123\"</code> being the cell value:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rqzuV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rqzuV.png\" alt=\"enter image description here\"></a></p>\n\n<p>But -- the <em>formula bar</em> displays the text <code>'123</code> when <code>A2</code> is selected but only displays <code>123</code> when <code>A1</code> is selected, so Excel retains the information about how the strings were entered. Can this information be accessed from VBA?</p>\n\n<p>A quick test which shows what <em>doesn't</em> work:</p>\n\n<pre><code>Sub test()\n    Dim R As Range, S As Range\n    Set R = Range(\"A1\")\n    Set S = Range(\"A2\")\n    Debug.Print R.Value = S.Value\n    Debug.Print R.Value2 = S.Value2\n    Debug.Print R.Text = S.Text\n    Debug.Print R.Formula = S.Formula\n    Debug.Print R.FormulaLocal = S.FormulaLocal\n    Debug.Print R.FormulaR1C1 = S.FormulaR1C1\n    Debug.Print R.FormulaR1C1Local = S.FormulaR1C1Local\nEnd Sub \n</code></pre>\n\n<p>This does nothing but repeatedly print <code>True</code>. I can't think of any other range properties that would be relevant. I don't see any application or worksheet level object which allows one to access the text displayed in the formula bar. Any ideas?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 0, "creation_date": 1517206060, "post_id": 48423734, "comment_id": 83983569, "body": "Where is the variable <code>X</code> set?"}], "answers": [{"comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1516883356, "post_id": 48424233, "comment_id": 83877026, "body": "Also - you need some way of allowing you, as developer, in to the database, have you considered how you would achieve that once this code is run?"}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 0, "creation_date": 1517206667, "post_id": 48424233, "comment_id": 83983770, "body": "I suggest adding this to the answer as well: an error will occur if you Append a property that already exists, so you have to try setting its value and catch the error and create/append it if it does not exist."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1516802246, "creation_date": 1516802246, "answer_id": 48424233, "question_id": 48423734, "link": "https://stackoverflow.com/questions/48423734/disable-specialkeys/48424233#48424233", "title": "Disable SpecialKeys", "body": "<p>These properties are loaded before the AutoExec macro fires, and set for the <em>next</em> startup. You need to restart your database before they take effect.</p>\n\n<p>Furthermore, they are boolean properties, which means: <code>db.CreateProperty(\"StartUpShowDBWindow\", 1, False)</code>, not <code>db.CreateProperty(\"StartUpShowDBWindow\", 1, 1)</code> if you want to disable certain functionality.</p>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 48424233, "answer_count": 1, "score": 0, "last_activity_date": 1516802246, "creation_date": 1516800723, "question_id": 48423734, "link": "https://stackoverflow.com/questions/48423734/disable-specialkeys", "title": "Disable SpecialKeys", "body": "<p>Afternoon</p>\n\n<p>I am looking to disable special keys such as CTRL+Break, F11 etc.</p>\n\n<p>The code below is in a macros which is my AutoExec - It doesn't debug but also doesn't seem to work at all:</p>\n\n<p>Any help is appreciated</p>\n\n<p><strong>Code:</strong> </p>\n\n<pre><code>Dim prp As DAO.Property\nSet db = CurrentDb()\nSelect Case X\n    Case 1\n    Set prp = db.CreateProperty(\"StartUpShowDBWindow\", 1, 1)\n        db.Properties.Append prp\n    Case 2\n    Set prp = db.CreateProperty(\"AllowBreakIntoCode\", 1, 1)\n        db.Properties.Append prp\n    Case 3\n    Set prp = db.CreateProperty(\"AllowSpecialKeys\", 1, 1)\n        db.Properties.Append prp\n    Case 4\n    Set prp = db.CreateProperty(\"AllowToolbarChanges\", 1, 1)\n        db.Properties.Append prp\n    Case 5\n    Set prp = db.CreateProperty(\"AllowFullMenus\", 1, 1)\n        db.Properties.Append prp\n    Case 6\n    Set prp = db.CreateProperty(\"AllowBuiltInToolbars\", 1, 1)\n        db.Properties.Append prp\n    Case 7\n    Set prp = db.CreateProperty(\"AllowByPassKey\", 1, 1)\n        db.Properties.Append prp\n    Case Else\n    'do nothing\n</code></pre>\n"}, {"tags": ["vba", "web-scraping"], "comments": [{"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1516801291, "post_id": 48423726, "comment_id": 83837252, "body": "You could simply pull the href from the control every time rather than having a static address. Alternatively, check the <code>InnerText</code> for the anchor tag (if it is an anchor tag) or the <code>Value</code> attribute if it is an <code>Input</code> tag."}, {"owner": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "reply_to_user": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1516801610, "post_id": 48423726, "comment_id": 83837455, "body": "It doesn&#39;t have an InnerText or  Value."}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1516801646, "post_id": 48423726, "comment_id": 83837478, "body": "Is the button assigned by JavaScript?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1516801890, "post_id": 48423726, "comment_id": 83837641, "body": "Can you navigate IE to the href text? Would that open what you need?"}, {"owner": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "edited": false, "score": 0, "creation_date": 1516802195, "post_id": 48423726, "comment_id": 83837869, "body": "I actually don&#39;t know Paul. And Ryan, I also don&#39;t know, can you acess the page and see ? It would help me a lot"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "edited": false, "score": 0, "creation_date": 1516808278, "post_id": 48424398, "comment_id": 83842463, "body": "My code already does that. The thing I need is after that, in the link that apears"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "edited": false, "score": 0, "creation_date": 1516898347, "post_id": 48424398, "comment_id": 83888021, "body": "Some explanatory notes <a href=\"http://exceldevelopmentplatform.blogspot.co.uk/2018/01/vba-webscraping-jquery-selectors.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.co.uk/2018/01/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1516897299, "last_edit_date": 1516897299, "creation_date": 1516802734, "answer_id": 48424398, "question_id": 48423726, "link": "https://stackoverflow.com/questions/48423726/clicking-on-a-link-without-id-or-class/48424398#48424398", "title": "Clicking on a link without Id or class", "body": "<p>I have revisited this and made it tighter.</p>\n\n<pre><code>Option Explicit\n\nSub teses2()\n\n    Dim pesquisa As String\n    Dim ie As InternetExplorer\n\n\n    '*SUSPENDED * pesquisa = InputBox(\"Digite os termos que quer pesquisar: \", \"\", \"\")\n    pesquisa = \"icms base de calculo pis cofins\"\n\n    Set ie = New InternetExplorer\n    ie.Visible = True\n    ie.navigate \"http://www.stj.jus.br/SCON/\"\n\n    While ie.Busy\n        DoEvents\n    Wend\n\n    While ie.Document.ReadyState = \"complete\"\n        DoEvents\n    Wend\n    'Stop\n    Application.Wait (Now + TimeSerial(0, 0, 3))\n    ie.Document.getElementById(\"pesquisaLivre\").innerText = pesquisa\n\n    Dim oHtml As MSHTML.HTMLDocument '* gives intellisense\n    Set oHtml = ie.Document\n\n    Dim oSelectors As MSHTML.IHTMLDOMChildrenCollection\n    Set oSelectors = oHtml.querySelectorAll(\"div.blocoCampos input\")\n\n    Dim lSelectorResultList As Long\n    lSelectorResultList = oSelectors.Length\n\n    Dim lSelectorResultLoop As Long\n    For lSelectorResultLoop = 0 To lSelectorResultList - 1\n\n        Dim objInputCheckbox As Object\n        Set objInputCheckbox = oSelectors.Item(lSelectorResultLoop)\n\n        If Not objInputCheckbox Is Nothing Then\n            Dim sLabel As String\n            sLabel = objInputCheckbox.Value\n\n            If VBA.InStr(1, \"|SUMU|DTXT|INFJ|\", \"|\" &amp; sLabel &amp; \"|\", vbTextCompare) &gt; 0 Then\n                objInputCheckbox.Click\n            End If\n\n        End If\n    Next\n    '* release references\n    Set objInputCheckbox = Nothing\n    Set oSelectors = Nothing\n    Set oHtml = Nothing\n\n    Dim elemns As MSHTML.IHTMLDOMChildrenCollection\n    'Set elemns = ie.Document.getElementsByTagName(\"input\")\n    Set oHtml = ie.Document\n    Set elemns = oHtml.querySelectorAll(\"div#botoesPesquisa input:nth-child(1)\")\n    Debug.Assert elemns.Length = 1\n\n    Dim elem As Object\n    Set elem = elemns.Item(0)\n\n    'For Each elem In elemns\n        If elem.Value = \"Pesquisar\" Then\n            elem.Click\n        End If\n    'Next\n\n\n    '* release references\n    Set elem = Nothing\n    Set elemns = Nothing\n\n\n    While ie.Busy\n        DoEvents\n    Wend\n\n    'While ie.Document.ReadyState = \"complete\"\n    '    DoEvents\n    'Wend\n\n    '* POST NAVIGATION\n    'Stop\n    Application.Wait (Now + TimeSerial(0, 0, 10))\n\n\n    Set oHtml = ie.Document\n    Dim objResultList As MSHTML.IHTMLDOMChildrenCollection\n    Set objResultList = oHtml.querySelectorAll(\"div#itemlistaresultados span:nth-child(2) a\")\n\n    Dim lResultCount As Long\n    lResultCount = objResultList.Length\n\n    Debug.Print\n    Dim lResultLoop As Long\n    For lResultLoop = 0 To lResultCount - 1\n\n        Dim anchorLoop As MSHTML.HTMLAnchorElement\n        Set anchorLoop = objResultList.Item(lResultLoop)\n\n        Debug.Print anchorLoop.href\n\n    Next\n\n    ie.Quit\n    Set ie = Nothing\n\n    'Stop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516897299, "creation_date": 1516800670, "last_edit_date": 1516801520, "question_id": 48423726, "link": "https://stackoverflow.com/questions/48423726/clicking-on-a-link-without-id-or-class", "title": "Clicking on a link without Id or class", "body": "<p>I have a code that does a research for the user in a website and then get the information from that research.\nIn the process of acessing the information, I need to click o a link inside the website. This link can change everytime the user makes a different research, so I can't use it's href to acess it. I have no clue about what to do.</p>\n\n<p>Here's my code until now: it goes until the webpage where the link is.\nSteps of the code:</p>\n\n<ol>\n<li>user insert his research. example: \"icms base de calculo pis cofins\"</li>\n<li>open ie in: <a href=\"http://www.stj.jus.br/SCON/\" rel=\"nofollow noreferrer\">http://www.stj.jus.br/SCON/</a></li>\n<li>insert the research </li>\n<li>click on: \"sumulas\", \"decis\u00f5es monocromaticas\" and \"informativos de jurisprudencia\". That way I acess only the \"acord\u00e3os\".</li>\n<li>click on \"pesquisar\"</li>\n<li>I need to click on the link in front of \"Ac\u00f3rd\u00e3os\"</li>\n</ol>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub teses2()\n\n    Dim pesquisa As String\n    Dim ie As InternetExplorer\n    Dim elemns As Object\n    Dim elem As Object\n    Dim elemns2 As Object\n    Dim elem2 As Object\n    Dim elem3 As Object\n    Dim obj As Object \n\n    pesquisa = InputBox(\"Digite os termos que quer pesquisar: \", \"\", \"\")\n    Set ie = New InternetExplorer\n    ie.Visible = True\n    ie.navigate \"http://www.stj.jus.br/SCON/\"\n    Application.Wait (Now + TimeSerial(0, 0, 20))\n    ie.document.getElementById(\"pesquisaLivre\").innerText = pesquisa\n\n    Set elemns2 = ie.document.getElementsByTagName(\"input\")\n    For Each elem2 In elemns2\n        If elem2.Value = \"SUMU\" Then\n            elem2.Click\n        End If\n        If elem2.Value = \"DTXT\" Then\n            elem2.Click\n        End If\n        If elem2.Value = \"INFJ\" Then\n            elem2.Click\n        End If\n    Next\n\n    Set elemns = ie.document.getElementsByTagName(\"input\")\n    For Each elem In elemns\n        If elem.Value = \"Pesquisar\" Then\n            elem.Click\n        End If    \n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 409, "user_id": 1484738, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/603cc3826de11811898cb1890c3e8286?s=128&d=identicon&r=PG&f=1", "display_name": "James MacAdie", "link": "https://stackoverflow.com/users/1484738/james-macadie"}, "is_accepted": false, "score": 0, "last_activity_date": 1516864961, "last_edit_date": 1516864961, "creation_date": 1516800598, "answer_id": 48423685, "question_id": 48423684, "link": "https://stackoverflow.com/questions/48423684/invert-filter-selection-in-excel/48423685#48423685", "title": "Invert filter selection in Excel", "body": "<p>I've written a bit of VBA that extends Excel and provides this functionality. It adds a new context menu (right-click menu) option off the Filter sub-menu (see screenshot).</p>\n\n<p>You need to call the <code>AddToCellMenu</code> subroutine to make the menu item appear. If you want to make that permament for all your Excel sessions, you'll need to put this code in a personal workbook or add-in you have running and then call <code>AddToCellMenu</code> on the <code>Workbook_Open</code> event, or something similar.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qXV0a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qXV0a.png\" alt=\"enter image description here\"></a></p>\n\n<p>Anyway here's the code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPublic Sub AddToCellMenu(dummy As Byte)\n\nDim FilterMenu As CommandBarControl\n\n    ' Delete the controls first to avoid duplicates\n    Call DeleteFromCellMenu\n\n    ' Set ContextMenu to the Cell context menu\n    ' 31402 is the filter sub-menu of the cell context menu\n    Set FilterMenu = Application.CommandBars(\"Cell\").FindControl(ID:=31402)\n\n    ' Add one custom button to the Cell context menu\n    With FilterMenu.Controls.Add(Type:=msoControlButton, before:=3)\n        .OnAction = \"'\" &amp; ThisWorkbook.name &amp; \"'!\" &amp; \"InvertFilter\"\n        .FaceId = 1807\n        .Caption = \"Invert Filter Selection\"\n        .Tag = \"My_Cell_Control_Tag\"\n    End With\n\nEnd Sub\n\nPrivate Sub DeleteFromCellMenu()\n\nDim FilterMenu As CommandBarControl\nDim ctrl As CommandBarControl\n\n    ' Set ContextMenu to the Cell context menu\n    ' 31402 is the filter sub-menu of the cell context menu\n    Set FilterMenu = Application.CommandBars(\"Cell\").FindControl(ID:=31402)\n\n    ' Delete the custom controls with the Tag : My_Cell_Control_Tag\n    For Each ctrl In FilterMenu.Controls\n        If ctrl.Tag = \"My_Cell_Control_Tag\" Then\n            ctrl.Delete\n        End If\n    Next ctrl\n\nEnd Sub\n\nPublic Sub InvertFilter()\n\nDim cell As Range\nDim af As AutoFilter\nDim f As Filter\nDim i As Integer\n\nDim arrCur As Variant\nDim arrNew As Variant\nDim rngCol As Range\nDim c As Range\nDim txt As String\nDim bBlank As Boolean\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' INITAL CHECKS\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n    Set cell = ActiveCell\n\n    If cell.parent.AutoFilterMode = False Then\n        MsgBox \"No filters on current sheet\"\n        Exit Sub\n    End If\n\n    Set af = cell.parent.AutoFilter\n\n    If Application.Intersect(cell, af.Range) Is Nothing Then\n        MsgBox \"Current cell not part of filter range\"\n        Exit Sub\n    End If\n\n    i = cell.Column - af.Range.cells(1, 1).Column + 1\n    Set f = af.Filters(i)\n\n    If f.On = False Then\n        MsgBox \"Current column not being filtered. Nothing to invert\"\n        Exit Sub\n    End If\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' GET CURRENT FILTER DATA\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n    ' Single value criteria\n    If f.Operator = 0 Then\n        If f.Criteria1 = \"&lt;&gt;\" Then ArrayAdd arrNew, \"=\"\n        If f.Criteria1 = \"=\" Then ArrayAdd arrNew, \"&lt;&gt;\"\n        ArrayAdd arrCur, f.Criteria1\n    ' Pair of values used as criteria\n    ElseIf f.Operator = xlOr Then\n        ArrayAdd arrCur, f.Criteria1\n        ArrayAdd arrCur, f.Criteria2\n    ' Multi list criteria\n    ElseIf f.Operator = xlFilterValues Then\n        arrCur = f.Criteria1\n    Else\n        MsgBox \"Current filter is not selecting values. Cannot process inversion\"\n        Exit Sub\n    End If\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' COMPUTE INVERTED FILTER DATA\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n    ' Only process if new list is empty\n    ' Being non-empty implies we're just toggling blank state and new list is already determined for that\n    If IsEmpty(arrNew) Then\n\n        ' Get column of data, ignoring header row\n        Set rngCol = af.Range.Resize(af.Range.Rows.Count - 1, 1).Offset(1, i - 1)\n        bBlank = False\n\n        For Each c In rngCol\n\n            ' Ignore blanks for now; they get special processing at the end\n            If c.Text &lt;&gt; \"\" Then\n\n                ' If the cell text is in neither the current filter list ...\n                txt = \"=\" &amp; c.Text\n                If Not ArrayContains(arrCur, txt) Then\n\n                    ' ... nor the new proposed list then add it to the new proposed list\n                    If Not ArrayContains(arrNew, txt) Then ArrayAdd arrNew, txt\n\n                End If\n\n            Else\n                ' Record that we have blank cells\n                bBlank = True\n            End If\n\n        Next c\n\n        ' Process blank options\n        ' If we're not currently selecting for blanks ...\n        ' ... and there are blanks ...\n        ' ... then filter for blanks in new selection\n        If (Not arrCur(UBound(arrCur)) = \"=\" And bBlank) Then ArrayAdd arrNew, \"=\"\n\n    End If\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' APPLY NEW FILTER\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n    Select Case UBound(arrNew)\n        Case 0:\n            MsgBox \"Didn't find any values to invert\"\n            Exit Sub\n        Case 1:\n            af.Range.AutoFilter _\n                Field:=i, _\n                Criteria1:=arrNew(1)\n        Case 2:\n            af.Range.AutoFilter _\n                Field:=i, _\n                Criteria1:=arrNew(1), _\n                Criteria2:=arrNew(2), _\n                Operator:=xlOr\n        Case Else:\n            af.Range.AutoFilter _\n                Field:=i, _\n                Criteria1:=arrNew, _\n                Operator:=xlFilterValues\n    End Select\n\nEnd Sub\n\nPrivate Sub ArrayAdd(ByRef a As Variant, item As Variant)\n\nDim i As Integer\n\n    If IsEmpty(a) Then\n        i = 1\n        ReDim a(1 To i)\n    Else\n        i = UBound(a) + 1\n        ReDim Preserve a(1 To i)\n    End If\n\n    a(i) = item\n\nEnd Sub\n\nPrivate Function ArrayContains(a As Variant, item As Variant) As Boolean\n\nDim i As Integer\n\n    If IsEmpty(a) Then\n        ArrayContains = False\n        Exit Function\n    End If\n\n    For i = LBound(a) To UBound(a)\n        If a(i) = item Then\n            ArrayContains = True\n            Exit Function\n        End If\n    Next i\n\n    ArrayContains = False\n\nEnd Function\n\n' Used to find the menu IDs\nPrivate Sub ListMenuInfo()\n\nDim row As Integer\nDim Menu As CommandBarControl\nDim MenuItem As CommandBarControl\nDim SubMenuItem As CommandBarControl\n\n    row = 1\n    On Error Resume Next\n    For Each Menu In CommandBars(\"cell\").Controls\n        For Each MenuItem In Menu.Controls\n            For Each SubMenuItem In MenuItem.Controls\n                cells(row, 1) = Menu.Caption\n                cells(row, 2) = Menu.ID\n                cells(row, 3) = MenuItem.Caption\n                cells(row, 4) = MenuItem.ID\n                cells(row, 5) = SubMenuItem.Caption\n                cells(row, 6) = SubMenuItem.ID\n                row = row + 1\n            Next SubMenuItem\n        Next MenuItem\n    Next Menu\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 409, "user_id": 1484738, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/603cc3826de11811898cb1890c3e8286?s=128&d=identicon&r=PG&f=1", "display_name": "James MacAdie", "link": "https://stackoverflow.com/users/1484738/james-macadie"}, "edited": false, "score": 0, "creation_date": 1540487375, "post_id": 52990987, "comment_id": 92894371, "body": "The redundant argument from AddToCellMenu was put in to &#39;hide&#39; the routine from the Run Macro (ALT + F8) dialog. It&#39;s a trick I often use. Thanks for documenting properly how to add it permanently to your Excel application"}], "tags": [], "owner": {"reputation": 11, "user_id": 10557667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32aee0b854ca8601d4a14d9915763247?s=128&d=identicon&r=PG&f=1", "display_name": "Trymzet", "link": "https://stackoverflow.com/users/10557667/trymzet"}, "is_accepted": false, "score": 1, "last_activity_date": 1540475416, "creation_date": 1540475416, "answer_id": 52990987, "question_id": 48423684, "link": "https://stackoverflow.com/questions/48423684/invert-filter-selection-in-excel/52990987#52990987", "title": "Invert filter selection in Excel", "body": "<p>I've turned off screen updating to speed this up. Also removed the redundant argument from AddToCellMenu as it caused errors when calling from my Personal.xlsb.</p>\n\n<p>Quick full instruction to permanently add the inverse filter option to your Excel:</p>\n\n<ol>\n<li>Read up on how to create your Personal.xlsb</li>\n<li><p>Paste this code to your Personal's ThisWorkbook object (Developer -> Visual Basic -> double click ThisWorkbook):</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Windows(\"Personal.xlsb\").Visible = False\n    Call AddToCellMenu\nEnd Sub\n</code></pre></li>\n<li><p>Paste James' updated code in a new module inside your Personal.xlsb:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AddToCellMenu()\n\nDim FilterMenu As CommandBarControl\n\n    ' Delete the controls first to avoid duplicates\n    Call DeleteFromCellMenu\n\n    ' Set ContextMenu to the Cell context menu\n    ' 31402 is the filter sub-menu of the cell context menu\n    Set FilterMenu = Application.CommandBars(\"Cell\").FindControl(ID:=31402)\n\n    ' Add one custom button to the Cell context menu\n    With FilterMenu.Controls.Add(Type:=msoControlButton, before:=3)\n        .OnAction = \"'\" &amp; ThisWorkbook.name &amp; \"'!\" &amp; \"InvertFilter\"\n        .FaceId = 1807\n        .Caption = \"Invert Filter Selection\"\n        .Tag = \"My_Cell_Control_Tag\"\n    End With\n\nEnd Sub\n\nPrivate Sub DeleteFromCellMenu()\n\nDim FilterMenu As CommandBarControl\nDim ctrl As CommandBarControl\n\n    ' Set ContextMenu to the Cell context menu\n    ' 31402 is the filter sub-menu of the cell context menu\n    Set FilterMenu = Application.CommandBars(\"Cell\").FindControl(ID:=31402)\n\n    ' Delete the custom controls with the Tag : My_Cell_Control_Tag\n    For Each ctrl In FilterMenu.Controls\n        If ctrl.Tag = \"My_Cell_Control_Tag\" Then\n            ctrl.Delete\n        End If\n    Next ctrl\n\nEnd Sub\n\nPublic Sub InvertFilter()\n\nApplication.ScreenUpdating = False\n\nDim cell As Range\nDim af As AutoFilter\nDim f As Filter\nDim i As Integer\n\nDim arrCur As Variant\nDim arrNew As Variant\nDim rngCol As Range\nDim c As Range\nDim txt As String\nDim bBlank As Boolean\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' INITAL CHECKS\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n    Set cell = ActiveCell\n\n    If cell.parent.AutoFilterMode = False Then\n        MsgBox \"No filters on current sheet\"\n        Exit Sub\n    End If\n\n    Set af = cell.parent.AutoFilter\n\n    If Application.Intersect(cell, af.Range) Is Nothing Then\n        MsgBox \"Current cell not part of filter range\"\n        Exit Sub\n    End If\n\n    i = cell.Column - af.Range.cells(1, 1).Column + 1\n    Set f = af.Filters(i)\n\n    If f.On = False Then\n        MsgBox \"Current column not being filtered. Nothing to invert\"\n        Exit Sub\n    End If\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' GET CURRENT FILTER DATA\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n    ' Single value criteria\n    If f.Operator = 0 Then\n        If f.Criteria1 = \"&lt;&gt;\" Then ArrayAdd arrNew, \"=\"\n        If f.Criteria1 = \"=\" Then ArrayAdd arrNew, \"&lt;&gt;\"\n        ArrayAdd arrCur, f.Criteria1\n    ' Pair of values used as criteria\n    ElseIf f.Operator = xlOr Then\n        ArrayAdd arrCur, f.Criteria1\n        ArrayAdd arrCur, f.Criteria2\n    ' Multi list criteria\n    ElseIf f.Operator = xlFilterValues Then\n        arrCur = f.Criteria1\n    Else\n        MsgBox \"Current filter is not selecting values. Cannot process inversion\"\n        Exit Sub\n    End If\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' COMPUTE INVERTED FILTER DATA\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n    ' Only process if new list is empty\n    ' Being non-empty implies we're just toggling blank state and new list is already determined for that\n    If IsEmpty(arrNew) Then\n\n        ' Get column of data, ignoring header row\n        Set rngCol = af.Range.Resize(af.Range.Rows.Count - 1, 1).Offset(1, i - 1)\n        bBlank = False\n\n        For Each c In rngCol\n\n            ' Ignore blanks for now; they get special processing at the end\n            If c.Text &lt;&gt; \"\" Then\n\n                ' If the cell text is in neither the current filter list ...\n                txt = \"=\" &amp; c.Text\n                If Not ArrayContains(arrCur, txt) Then\n\n                    ' ... nor the new proposed list then add it to the new proposed list\n                    If Not ArrayContains(arrNew, txt) Then ArrayAdd arrNew, txt\n\n                End If\n\n            Else\n                ' Record that we have blank cells\n                bBlank = True\n            End If\n\n        Next c\n\n        ' Process blank options\n        ' If we're not currently selecting for blanks ...\n        ' ... and there are blanks ...\n        ' ... then filter for blanks in new selection\n        If (Not arrCur(UBound(arrCur)) = \"=\" And bBlank) Then ArrayAdd arrNew, \"=\"\n\n    End If\n\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    ' APPLY NEW FILTER\n    ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n    Select Case UBound(arrNew)\n        Case 0:\n            MsgBox \"Didn't find any values to invert\"\n            Exit Sub\n        Case 1:\n            af.Range.AutoFilter _\n                Field:=i, _\n                Criteria1:=arrNew(1)\n        Case 2:\n            af.Range.AutoFilter _\n                Field:=i, _\n                Criteria1:=arrNew(1), _\n                Criteria2:=arrNew(2), _\n                Operator:=xlOr\n        Case Else:\n            af.Range.AutoFilter _\n                Field:=i, _\n                Criteria1:=arrNew, _\n                Operator:=xlFilterValues\n    End Select\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\nPrivate Sub ArrayAdd(ByRef a As Variant, item As Variant)\n\nDim i As Integer\n\n    If IsEmpty(a) Then\n        i = 1\n        ReDim a(1 To i)\n    Else\n        i = UBound(a) + 1\n        ReDim Preserve a(1 To i)\n    End If\n\n    a(i) = item\n\nEnd Sub\n\nPrivate Function ArrayContains(a As Variant, item As Variant) As Boolean\n\nDim i As Integer\n\n    If IsEmpty(a) Then\n        ArrayContains = False\n        Exit Function\n    End If\n\n    For i = LBound(a) To UBound(a)\n        If a(i) = item Then\n            ArrayContains = True\n            Exit Function\n        End If\n    Next i\n\n    ArrayContains = False\n\nEnd Function\n\n' Used to find the menu IDs\nPrivate Sub ListMenuInfo()\n\nDim row As Integer\nDim Menu As CommandBarControl\nDim MenuItem As CommandBarControl\nDim SubMenuItem As CommandBarControl\n\n    row = 1\n    On Error Resume Next\n    For Each Menu In CommandBars(\"cell\").Controls\n        For Each MenuItem In Menu.Controls\n            For Each SubMenuItem In MenuItem.Controls\n                cells(row, 1) = Menu.Caption\n                cells(row, 2) = Menu.ID\n                cells(row, 3) = MenuItem.Caption\n                cells(row, 4) = MenuItem.ID\n                cells(row, 5) = SubMenuItem.Caption\n                cells(row, 6) = SubMenuItem.ID\n                row = row + 1\n            Next SubMenuItem\n        Next MenuItem\n    Next Menu\n\nEnd Sub\n</code></pre></li>\n<li><p>Still in your Personal.xslb, go to View tab, then hit \"hide\", and it won't bother you anymore, ever. :)</p></li>\n</ol>\n\n<p>Save the file and restart your Excel. The inverse filter option will be added automatically each time you open any Excel file.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11798867, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f9ba92257b8ee58932c8223f3994aed3?s=128&d=identicon&r=PG", "display_name": "R Douglass", "link": "https://stackoverflow.com/users/11798867/r-douglass"}, "is_accepted": false, "score": 1, "last_activity_date": 1563382888, "creation_date": 1563382888, "answer_id": 57080933, "question_id": 48423684, "link": "https://stackoverflow.com/questions/48423684/invert-filter-selection-in-excel/57080933#57080933", "title": "Invert filter selection in Excel", "body": "<p>I've been trying to solve this issue for some time and think I just discovered a pretty easy way to inverse the filter.  Just highlight the current cells, then remove the filter.  Now filter again by everything not highlighted and there you go.  Hope that helps, it certainly worked for what I needed.</p>\n"}], "owner": {"reputation": 409, "user_id": 1484738, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/603cc3826de11811898cb1890c3e8286?s=128&d=identicon&r=PG&f=1", "display_name": "James MacAdie", "link": "https://stackoverflow.com/users/1484738/james-macadie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13217, "favorite_count": 2, "answer_count": 3, "score": 0, "last_activity_date": 1603204807, "creation_date": 1516800598, "last_edit_date": 1531161705, "question_id": 48423684, "link": "https://stackoverflow.com/questions/48423684/invert-filter-selection-in-excel", "title": "Invert filter selection in Excel", "body": "<p>I'm asking a question that I plan to answer so I can document this problem in a lasting way. More than happy for others to pitch in with other suggestions / corrections.</p>\n\n<p>I often have an issue in Excel where I'm using filters and then want to invert the selection i.e. unpick all the items that have been picked and pick all the items that are not currently picked. For example, see screenshots below:</p>\n\n<p>There's no easy way to do this (that I know of!) other than clicking through the list, which laborious and error prone. How can we get this functionality automated in Excel?</p>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yOFVq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yOFVq.png\" alt=\"Initial selection\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8Qmrk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Qmrk.png\" alt=\"Inverted selection\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516800551, "post_id": 48423592, "comment_id": 83836760, "body": "Highlight the column and then select <code>Format</code> and select <code>Custom</code> and enter <code>hh:mm</code> - To get the code for it, turn on your macro recorder before you do it and it will give you the code."}, {"owner": {"reputation": 249, "user_id": 7085252, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3a9258dcda166c4d807c30dd850fd17b?s=128&d=identicon&r=PG&f=1", "display_name": "pottolom", "link": "https://stackoverflow.com/users/7085252/pottolom"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516800645, "post_id": 48423592, "comment_id": 83836826, "body": "I have tried that. The problem is that the code is set up to add a new time stamp whenever new data is added to the neighbouring columns on the same row. The data is added sequentially, so the new stamp ends up including the date every time it is added."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516800704, "post_id": 48423592, "comment_id": 83836866, "body": "<code>Me.Cells(Target.Row, 1).NumberFormat = &quot;hh:mm&quot;</code>"}, {"owner": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "edited": false, "score": 0, "creation_date": 1516800929, "post_id": 48423592, "comment_id": 83837014, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25160717/print-dates-in-proper-format\">Print dates in proper format</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 2, "last_activity_date": 1516800708, "creation_date": 1516800708, "answer_id": 48423728, "question_id": 48423592, "link": "https://stackoverflow.com/questions/48423592/hhmm-time-stamping-in-excel-worksheet/48423728#48423728", "title": "HH:MM time stamping in Excel worksheet", "body": "<p>you may set format by your macro.</p>\n\n<pre><code>Cells(target.Row, 1).NumberFormat = \"hh:mm\"\n</code></pre>\n"}], "owner": {"reputation": 249, "user_id": 7085252, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3a9258dcda166c4d807c30dd850fd17b?s=128&d=identicon&r=PG&f=1", "display_name": "pottolom", "link": "https://stackoverflow.com/users/7085252/pottolom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 48423728, "answer_count": 1, "score": 1, "last_activity_date": 1516826355, "creation_date": 1516800317, "last_edit_date": 1516826355, "question_id": 48423592, "link": "https://stackoverflow.com/questions/48423592/hhmm-time-stamping-in-excel-worksheet", "title": "HH:MM time stamping in Excel worksheet", "body": "<p>I am using the following code to put a time stamp in column 1 whenever new values are added to a row of data within a worksheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 1 Or Target.Column &gt; 11 Then Exit Sub\n    With Application\n        .EnableEvents = False\n        Me.Cells(Target.Row, 1) = Now\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>I am a bit of a VBA beginner, can anyone tell me how I can ensure the time-stamped data is in hh:mm format? At present it is including the date.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "edited": false, "score": 0, "creation_date": 1516800912, "post_id": 48423619, "comment_id": 83837000, "body": "I need to refresh formulas for the workbook I&#39;m using macro in and not the one that is being opened."}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "edited": false, "score": 0, "creation_date": 1516801162, "post_id": 48423619, "comment_id": 83837154, "body": "if so, use ThisWorkbook.RefreshAll"}, {"owner": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "edited": false, "score": 0, "creation_date": 1516802156, "post_id": 48423619, "comment_id": 83837843, "body": "It turns out that EnableCalculation doesn&#39;t work in Excel 2010. Also opening workbook it the same application as original workbook automatically refreshes all the formulas referencing workbook. Thanks for help though."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 1, "last_activity_date": 1516801214, "last_edit_date": 1516801214, "creation_date": 1516800405, "answer_id": 48423619, "question_id": 48423542, "link": "https://stackoverflow.com/questions/48423542/opening-workbook-from-file-and-updating-link-in-original-workbook/48423619#48423619", "title": "Opening workbook from file and updating link in original workbook", "body": "<p>I think Set book = app.Workbooks.Open(FilePath) shall be enough, but if not refresh the workbook:</p>\n\n<pre><code>book.RefreshAll\n</code></pre>\n\n<p>for opened workbook. For the workbook that contains the macro, use</p>\n\n<pre><code>ThisWorkbook.RefreshAll\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1516801214, "creation_date": 1516800170, "last_edit_date": 1516800223, "question_id": 48423542, "link": "https://stackoverflow.com/questions/48423542/opening-workbook-from-file-and-updating-link-in-original-workbook", "title": "Opening workbook from file and updating link in original workbook", "body": "<p>I'm trying to write a macro in VBA, that will open another Workbook using a PathFile specified in a cell (this works), updates link in workbook in which macro is used (doesn't work) and closes the PathFile workbook (works)\nThis is a code:</p>\n\n<pre><code>Sub UpdateRaw()\n\nDim CurrWb As Workbook    \nDim FilePath As String\nDim book As Excel.Workbook\n\nSet CurrWb = ActiveWorkbook\nFilePath = Range(\"I1\").Value\n\nDim app As New Excel.Application\napp.Visible = True 'so we can see whether correct file is being opened\n\nSet book = app.Workbooks.Open(FilePath)\n\nCurrWb.Activate\nWorksheets(\"Raw_vs_Actual\").EnableCalculation = False\nWorksheets(\"Raw_vs_Actual\").EnableCalculation = True\n\nbook.Close SaveChanges:=False\napp.Quit\nSet app = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Going step by step I found that command CurrWb.Activate doesn't take me back to my original Workfile. My suspicion is that by opening new Excel Application I can't get back to the CurrWb (ActiveWorkbook). Is there a workaround? I need this so my INDIRECT function doesn't return #REF.</p>\n\n<p>I'm using Excel 2010 in case it's important.</p>\n"}, {"tags": ["excel", "pdf", "ms-word", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 3762, "user_id": 1392490, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8abc9ba3fc894ddce9e4da8f579fc9f4?s=128&d=identicon&r=PG", "display_name": "rollstuhlfahrer", "link": "https://stackoverflow.com/users/1392490/rollstuhlfahrer"}, "edited": false, "score": 0, "creation_date": 1516800600, "post_id": 48423432, "comment_id": 83836803, "body": "Can you please add at least on which line you get the error message? Here are some ressources to help you ask a great question: <a href=\"http://idownvotedbecau.se/nodebugging/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/nodebugging</a> - <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> - <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 1, "user_id": 9262223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405b5a1f8d01f2f0e7e8b415e92c6a9a?s=128&d=identicon&r=PG&f=1", "display_name": "DJKAPA", "link": "https://stackoverflow.com/users/9262223/djkapa"}, "reply_to_user": {"reputation": 3762, "user_id": 1392490, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8abc9ba3fc894ddce9e4da8f579fc9f4?s=128&d=identicon&r=PG", "display_name": "rollstuhlfahrer", "link": "https://stackoverflow.com/users/1392490/rollstuhlfahrer"}, "edited": false, "score": 0, "creation_date": 1516801644, "post_id": 48423432, "comment_id": 83837476, "body": "Windows(MainDoc).Activate     Next i"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1516818954, "post_id": 48423432, "comment_id": 83849397, "body": "My guess is that <code>MainDoc</code> no longer exists, because you&#39;ve saved as <code>docname</code>. You should <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">read this</a> about how to avoid using <code>Activate</code> and <code>Select</code>. If you make an object variable reference to the document, you can avoid the error."}], "owner": {"reputation": 1, "user_id": 9262223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405b5a1f8d01f2f0e7e8b415e92c6a9a?s=128&d=identicon&r=PG&f=1", "display_name": "DJKAPA", "link": "https://stackoverflow.com/users/9262223/djkapa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516818601, "creation_date": 1516799759, "last_edit_date": 1531161705, "question_id": 48423432, "link": "https://stackoverflow.com/questions/48423432/macro-for-excel-to-produce-word-and-pdf-invoice", "title": "macro for excel to produce word and pdf invoice", "body": "<p>I would like to find out if anyone can help me. I am not completely computer literate so if responding please make it as simple as possible. </p>\n\n<p>I was using macro on an excel spreadsheet (windows 7) to produce invoices; which when run produced a word and pdf file. I have just changed to a windows 10 laptop and it is no longer working and I cant contact the person who initially wrote the code for me (below): </p>\n\n<pre><code>Sub merge1record_at_a_time() '\n' merge1record_at_a_time Macro\n'\n'\n    Dim fd As FileDialog\n\n        'Create a FileDialog object as a Folder Picker dialog box.\n    Set fd = Application.FileDialog(msoFileDialogFolderPicker)\n    With fd\n\n\n        'Use the Show method to display the Folder Picker dialog box and return the user's action.\n        'The user pressed the button.\n        If .Show = -1 Then\n                For Each vrtSelectedItem In .SelectedItems\n\n\n                'vrtSelectedItem is aString that contains the path of each selected item.\n                'You can use any file I/O functions that you want to work with this path.\n                'This example displays the path in a message box.\n        SelectedPath = vrtSelectedItem\n\n        Next vrtSelectedItem\n\n        Else\n        MsgBox (\"No Directory Selected.  Exiting\")\n        Exit Sub\n        End If\n    End With\n\n\n    'Set the object variable to Nothing.\n    Set fd = Nothing\n\n\nApplication.ScreenUpdating = False\n\n\nMainDoc = ActiveDocument.Name\n    'ChangeFileOpenDirectory SelectedPath\n    For i = 1 To ActiveDocument.MailMerge.DataSource.RecordCount\n        With ActiveDocument.MailMerge\n            .Destination = wdSendToNewDocument\n            .SuppressBlankLines = True\n            With .DataSource\n                .FirstRecord = i\n                .LastRecord = i\n                .ActiveRecord = i\n                docname = .DataFields(\"PATIENT_NAME_\").Value &amp; \" \" &amp; .DataFields(\"Company_name\").Value _\n            &amp; \" \" &amp; .DataFields(\"Invoice_Number\").Value &amp; \".docx\"     ' ADDED CODE - Use \".docx\" for Word Documents\n                docname2 = .DataFields(\"PATIENT_NAME_\").Value &amp; \" \" &amp; .DataFields(\"Company_name\").Value _\n                &amp; \" \" &amp; .DataFields(\"Invoice_Number\").Value &amp; \".pdf\"\n            End With\n            .Execute Pause:=False\n    Application.ScreenUpdating = False\n\n        End With\n    '*****************************************************************\n    '** NOTE: \\/\\/\\/\\/ BELOW IS TO SAVE AS A WORD DOCUMENT \\/\\/\\/\\/ **\n    '*****************************************************************\n    ActiveDocument.SaveAs FileName:=docname, FileFormat:= _\n        wdFormatXMLDocument, LockComments:=False, Password:=\"\", AddToRecentFiles _\n        :=True, WritePassword:=\"\", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _\n        :=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _\n        SaveAsAOCELetter:=False\n    'ActiveDocument.Close\n\n    '*****************************************************************\n    '** NOTE: \\/\\/\\/\\/ BELOW IS TO SAVE AS A PDF \\/\\/\\/\\/           **\n    '*****************************************************************\n    'set OpenAfterExport to False so the PDF files won't open after mail merge\n    ActiveDocument.ExportAsFixedFormat OutputFileName:=docname2, _\n    ExportFormat:=wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:= _\n        wdExportOptimizeForPrint, Range:=wdExportAllDocument, From:=1, To:=1, _\n        Item:=wdExportDocumentContent, IncludeDocProps:=True, KeepIRM:=True, _\n        CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _\n        BitmapMissingFonts:=True, UseISO19005_1:=False\n\n\n    ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\n\n\n    Windows(MainDoc).Activate\n    Next i\n\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The error I am getting is <code>Run-Time Error 5941 - requested members of the collection does not exist</code>.</p>\n\n<p>Please let me know if you can help or can see an error in the code? The line that is showing the error is:</p>\n\n<p>Windows(MainDoc).Activate</p>\n\n<p>Kind Regards, </p>\n\n<p>Joseph </p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "edited": false, "score": 0, "creation_date": 1517219104, "post_id": 48423680, "comment_id": 83989698, "body": "Thank ryguy - but I think this will just login to the page - I have taken some pointers from this to improve my code, however I am trying to get my code to click something that is on the page that is loaded after the login page.  I think (and don&#39;t quote me on it) the problem lies in my code with IE being a new Internet Explorer medium, and when the 2nd page loads I am using IE.Document."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1516800577, "creation_date": 1516800577, "answer_id": 48423680, "question_id": 48423332, "link": "https://stackoverflow.com/questions/48423332/automate-clicking-buttons-on-one-page-and-then-another-page-using-vba/48423680#48423680", "title": "Automate clicking buttons on one page and then another page using vba", "body": "<p>The program requires references to the following:</p>\n\n<pre><code>1 Microsoft Internet Controls\n2. Microsoft HTML Object Library\n</code></pre>\n\n<p>The Internet control is used to browse the webpage and the HTML Objects are used to identify the username and password textboxes and submit the text using the control button.</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim oBrowser As InternetExplorer\nSub Login_2_Website()\n\nDim oHTML_Element As IHTMLElement\nDim sURL As String\n\nOn Error GoTo Err_Clear\nsURL = \"https://www.google.com/accounts/Login\"\nSet oBrowser = New InternetExplorer\noBrowser.Silent = True\noBrowser.timeout = 60\noBrowser.navigate sURL\noBrowser.Visible = True\n\nDo\n' Wait till the Browser is loaded\nLoop Until oBrowser.readyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = oBrowser.Document\n\nHTMLDoc.all.Email.Value = \"sample@vbadud.com\"\nHTMLDoc.all.passwd.Value = \"*****\"\n\nFor Each oHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\nIf oHTML_Element.Type = \"submit\" Then oHTML_Element.Click: Exit For\nNext\n\n' oBrowser.Refresh ' Refresh If Needed\nErr_Clear:\nIf Err &lt;&gt; 0 Then\nDebug.Assert Err = 0\nErr.Clear\nResume Next\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 733, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516800577, "creation_date": 1516799435, "last_edit_date": 1531164843, "question_id": 48423332, "link": "https://stackoverflow.com/questions/48423332/automate-clicking-buttons-on-one-page-and-then-another-page-using-vba", "title": "Automate clicking buttons on one page and then another page using vba", "body": "<p>I am trying to work on something that clicks a button\\line on a page, then clicks on others when the new page loads. I can get my vba to click the first button/link, but then when trying to click the next I am getting the error </p>\n\n<blockquote>\n  <p>Run-time error 91: Object variable or With block variable not set</p>\n</blockquote>\n\n<p>Now I have to be honest, the code I do have is from research, and by no means do I understand it fully, I have searched all over trying to rectify the 2nd click, but nothing seems to be working. </p>\n\n<p>the code I have so far is </p>\n\n<pre><code>Public Sub SHAREREPORTING()\n\nDim IE As SHDocVw.InternetExplorer\nDim Button As Object\nDim Button2 As Object\n\n\nSet IE = New InternetExplorerMedium\nIE.Visible = True\nIE.navigate \"URL\"\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy: DoEvents: Loop\n\nSet Button = IE.Document.getElementById(\"b1_pki\")\nButton.Click\n\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\n\nSendKeys \"mypassword\" , True\nSendKeys \"{ENTER}\", True\n\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy: DoEvents: Loop\n\nSet Button2 = IE.Document.getElementById(\"seite-itm-2\")\n\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\n\nButton2.Click\n\nEnd Sub\n</code></pre>\n\n<p>the code for the 2 buttons ( I am calling them buttons/links, because I'm not too sure what they are, I don't understand javascript) I am trying to click at the moment is</p>\n\n<p>Button1/Link1</p>\n\n<pre><code>&lt;A onclick=loginViaPKI(); onkeypress=loginViaPKI(); id=b1_pki title=\"Log on with PKI - Button - To activate, press spacebar.\" class=urBtnEmph hideFocus style=\"WHITE-SPACE: nowrap\" href=\"javascript:void(0);\" ct=\"Button\"&gt;Log on with PKI&lt;/A&gt;\n</code></pre>\n\n<p>Button2/Link2</p>\n\n<pre><code>&lt;TD onclick=\"return htmlbSL(this,7,'seite:sel_tab_2','','3','sel_tab_2')\" id=seite-itm-2 class=urTbsLabelOff onkeydown=\"if (sapUrMapi_checkKey(event,'keydown',new Array('32'))){return htmlbSL(this,7,'seite:sel_tab_2','','3','sel_tab_2')};sapUrMapi_TabStrip_keySelect('seite',2,4,event);\" noWrap&gt;&lt;SPAN id=seite-itm-2-txt title=\"Bookmarks     \" class=urTbsTxtOff&gt;Bookmarks &lt;/SPAN&gt;&lt;/TD&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1516800421, "post_id": 48423135, "comment_id": 83836665, "body": "Good question, puzzled as to why someone downvoted."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1516893553, "post_id": 48423135, "comment_id": 83884290, "body": "Is it actually registered?  I mean you say Tools-&gt;References and do you check a checkbox or do you navigate to file and select the file?  To register an exe requires  <code>&lt;Full path of the EXE file&gt; &#47;RegServer</code>  <a href=\"https://www.razorleaf.com/2009/11/registering-dlls/\" rel=\"nofollow noreferrer\">razorleaf.com/2009/11/registering-dlls</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "edited": false, "score": 0, "creation_date": 1516799847, "post_id": 48423226, "comment_id": 83836313, "body": "i have object like in my module but with your reply i understood should i put it to ThisWorkbook ?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1516799042, "creation_date": 1516799042, "answer_id": 48423226, "question_id": 48423135, "link": "https://stackoverflow.com/questions/48423135/adding-type-library-automatically-in-excel/48423226#48423226", "title": "Adding type library automatically in Excel", "body": "<p>You need a late binding of the variable, which uses the <code>simpackcomslv.exe</code> library.</p>\n\n<p>Something like:</p>\n\n<pre><code>  Dim specificVariable As Object\n  Set specificVariable = CreateObject(\"simpackcomslv-or try a few names here\")\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/1836237/late-binding-an-object-in-vba\">Late binding an Object in VBA</a></p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/245115/using-early-binding-and-late-binding-in-automation\" rel=\"nofollow noreferrer\">MSDN Late Binding</a></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "edited": false, "score": 0, "creation_date": 1516873729, "post_id": 48423616, "comment_id": 83870903, "body": "i&#39;m deploying the users who has this program on their machines. Also i have this program but as i said it&#39;s missing when i reboot my computer and then try to run macro from Excel."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1516800395, "creation_date": 1516800395, "answer_id": 48423616, "question_id": 48423135, "link": "https://stackoverflow.com/questions/48423135/adding-type-library-automatically-in-excel/48423616#48423616", "title": "Adding type library automatically in Excel", "body": "<p>I agree with Vitaya's answer.  If you need to go further then one can programmatic ally add references with this type library.</p>\n\n<pre><code>VBIDE  \nMicrosoft Visual Basic for Applications Extensibility 5.3   \nC:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VBA\\VBA6\\VBE6EXT.OLB\n</code></pre>\n\n<p>but questions have to be asked about why the reference has gone missing.  If you deploy a workbook from a machine that has the referenced software onto to one that doesn't then you are asking for trouble.</p>\n\n<p>I suggest you review your deployment strategy.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 659, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516800395, "creation_date": 1516798774, "last_edit_date": 1516799285, "question_id": 48423135, "link": "https://stackoverflow.com/questions/48423135/adding-type-library-automatically-in-excel", "title": "Adding type library automatically in Excel", "body": "<p>I'm writing a macro in Excel 2013 for automate some tasks for program named Simpack. This program has a COM-Interface support for scripting.</p>\n\n<p>But there's a problem occurs when i'm close and open the excel, i should select the COM-Server from</p>\n\n<p>VBA > Tools > References > SIMPACK.DIR > simpackcomslv.exe </p>\n\n<p>and then macro works</p>\n\n<p>Otherwise it gives an error in available references list like that:</p>\n\n<blockquote>\n  <p>MISSING: simpackcomslv Type Library</p>\n</blockquote>\n\n<p>Is there any way to fix that ? </p>\n"}, {"tags": ["windows", "oracle", "excel", "oracle-apex", "vba"], "comments": [{"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 3, "creation_date": 1516802058, "post_id": 48423042, "comment_id": 83837753, "body": "Is there any chance that the web page is not fully loading before trying to &quot;input&quot; ? To check it out try this line just after <code>do while objIE.busy</code>  which just adds a 5 second wait time. <code>Application.Wait (Now + TimeValue(&quot;0:00:05&quot;))</code> If you still get the same results, step through the code using F8 to make sure where it&#39;s erroring out."}, {"owner": {"reputation": 291, "user_id": 9259753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7207f19162660433529f7f726ae62f3b?s=128&d=identicon&r=PG&f=1", "display_name": "Katherine Reed", "link": "https://stackoverflow.com/users/9259753/katherine-reed"}, "reply_to_user": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1516813654, "post_id": 48423042, "comment_id": 83846329, "body": "Thank you for your response. I finally got it to work by creating an instance of InternetExplorerMedium instead of Internet Explorer."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1516900233, "post_id": 48423042, "comment_id": 83889224, "body": "I&#39;m not familiar with the &quot;medium&quot; thing. I tried it out on one of my scripts, but it didn&#39;t work. I did run across this though. <code>Dim ie As SHDocVw.InternetExplorer</code> and then <code>Set ie = CreateObject(&quot;InternetExplorer.Application&quot;)</code>. I&#39;ve been using <code>Set ie = New SHDocVw.InternetExplorer</code>. Not sure if there&#39;s a difference, they both work about the same. Good luck."}, {"owner": {"reputation": 291, "user_id": 9259753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7207f19162660433529f7f726ae62f3b?s=128&d=identicon&r=PG&f=1", "display_name": "Katherine Reed", "link": "https://stackoverflow.com/users/9259753/katherine-reed"}, "reply_to_user": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1516913134, "post_id": 48423042, "comment_id": 83896138, "body": "Great, thank you for your help!!"}], "owner": {"reputation": 291, "user_id": 9259753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7207f19162660433529f7f726ae62f3b?s=128&d=identicon&r=PG&f=1", "display_name": "Katherine Reed", "link": "https://stackoverflow.com/users/9259753/katherine-reed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 618, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526413667, "creation_date": 1516798524, "last_edit_date": 1531161705, "question_id": 48423042, "link": "https://stackoverflow.com/questions/48423042/i-am-having-trouble-automating-internet-explorer-with-microsoft-excel-vba", "title": "I am having trouble automating Internet Explorer with Microsoft Excel VBA", "body": "<p>I am trying to automate data input into a text field on a website on Internet Explorer 11 with Microsoft Excel VBA and my code is working for every site I have tested it on (Google, Yahoo, etc) except for the one website I need it to work on. The website I need the code to work on is Apex on the front-end and Oracle on the back-end. Strangely, the same code will work for the Apex website when then website is opened on a computer running Windows 7, but not when it is opened on a computer running Windows 10. The problem is that I need the code to work on the computer running Windows 10. When I run the code on a computer running Windows 10 I get the following error:</p>\n\n<pre><code>     Run-time error '-2147467259(80004005)':\n\n     Automation error\n     Unspecified error\n</code></pre>\n\n<p>Could anyone please give me any ideas on how to resolve this problem?</p>\n\n<p>This is my VBA code:</p>\n\n<pre><code>Sub Test()\n\nDim objIE As Object \n\n'initiating a new instance of Internet Explorer and asigning it to objIE\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n\n'make IE browser visible\nobjIE.Visible = True\n\n'navigate IE to this web page \nobjIE.navigate \"This is where I put the website address\"\n\n'wait here a few seconds while the browser is busy\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n'in the Apex web page search textbox put \"test\"\nobjIE.document.getElementById(\"P101_USERNAME\").Value = \"test\"\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1516798186, "post_id": 48422728, "comment_id": 83835178, "body": "To get the names, read the property <code>rs.Fields</code>. For an example, have a look <a href=\"https://stackoverflow.com/questions/35877042/vba-reconciliation-of-large-datasets/35879567#35879567\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 2, "last_activity_date": 1516798841, "creation_date": 1516798841, "answer_id": 48423156, "question_id": 48422728, "link": "https://stackoverflow.com/questions/48422728/getting-the-header-with-data-from-access-database/48423156#48423156", "title": "Getting the header with data from access database", "body": "<p>You must add field names in separate piece of code.</p>\n\n<pre><code>Dim field\nDim lCol As Long\n\nlCol = 0\nFor Each field In rs.Fields\n    ws.Range(\"A2\").Offset(, lCol) = field.Name\n    lCol = lCol + 1\nNext field\n</code></pre>\n\n<p>and not forget to move rest of data one row down:</p>\n\n<pre><code>If Not rs.EOF Then\n    ws.Range(\"A3\").CopyFromRecordset rs\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "is_accepted": false, "score": 1, "last_activity_date": 1516799040, "creation_date": 1516799040, "answer_id": 48423225, "question_id": 48422728, "link": "https://stackoverflow.com/questions/48422728/getting-the-header-with-data-from-access-database/48423225#48423225", "title": "Getting the header with data from access database", "body": "<p>You can iterate over the fields in your query like this</p>\n\n<pre><code>Dim qtQueryDefs As QueryDef\nDim rsRs As Recordset\nDim fField As Field\n\nFor Each qtQueryDefs In CurrentDb.QueryDefs\n    Set rsRs = qtQueryDefs.OpenRecordset()\n    For Each fField In rsRs.Fields\n        Debug.Print fField.Name\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 48423156, "answer_count": 2, "score": 0, "last_activity_date": 1516818626, "creation_date": 1516797551, "last_edit_date": 1516818626, "question_id": 48422728, "link": "https://stackoverflow.com/questions/48422728/getting-the-header-with-data-from-access-database", "title": "Getting the header with data from access database", "body": "<p>I have written a piece of VBA code that loops through a list of access database queries and copies them into one excel workbook. The code is working perfectly, but I can not figure out how to include the headers into the data when copied to excel workbook. </p>\n\n<pre><code>Sub AccessQuerie()\n\n    Dim A As Object\n    Application.DisplayAlerts = False\n    Set A = CreateObject(\"Access.Application\")\n\n    Dim wkb As Excel.Workbook\n    Dim wks As Excel.Worksheet\n    Dim sheetNum As Integer\n    Dim queryList\n\n    Set wkb = Excel.Workbooks(\"macro.xlsm\")\n\n    A.Visible = False\n    A.OpenCurrentDatabase (\"C:\\accessdb\") 'Access database file path\n\n    queryList = wkb.Sheets(\"settings\").Range(\"K28:K43\").Value\n\n    sheetNum = 3\n\n    For Each Item In queryList\n        A.DoCmd.OpenQuery (Item)\n        Application.DisplayAlerts = True\n\n        Set ws = ThisWorkbook.Sheets(sheetNum)\n\n        Dim rs As Object\n        Set rs = A.CurrentDb().QueryDefs(Item).OpenRecordset()\n\n        ws.Range(\"A1\").Value = Item\n\n        If Not rs.EOF Then\n            ws.Range(\"A2\").CopyFromRecordset rs\n        End If\n\n        rs.Close\n\n        sheetNum = sheetNum + 1\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>my output data looks like this</p>\n\n<pre><code>10  10  10  10  10\n10  10  10  10  10\n10  10  10  10  10\n</code></pre>\n\n<p>but Im looking to get this output</p>\n\n<pre><code>NumData NumData NumData NumData NumData\n10  10  10  10  10\n10  10  10  10  10\n10  10  10  10  10\n</code></pre>\n\n<p>Thank you for your help :)</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 1, "creation_date": 1516797774, "post_id": 48422652, "comment_id": 83834922, "body": "In which row do you receive this error?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1516797890, "post_id": 48422652, "comment_id": 83834984, "body": "A list box is a weird place to store a list of users. You usually use a table for this. Furthermore, this is all pseudosecurity, what happens when a user enters using the bypass key? Or disables VBA altogether?"}, {"owner": {"reputation": 7, "user_id": 9262029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5473408a4ac41747f6e3e930bebfa2?s=128&d=identicon&r=PG&f=1", "display_name": "Chas_C", "link": "https://stackoverflow.com/users/9262029/chas-c"}, "edited": false, "score": 0, "creation_date": 1516801952, "post_id": 48422652, "comment_id": 83837687, "body": "A list box in a form was used as a potential workaround.  The underlying list of users sit in a query.  Security is probably too strong a word here, what I&#39;ve really after is just a detterent."}], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1516797860, "creation_date": 1516797860, "answer_id": 48422831, "question_id": 48422652, "link": "https://stackoverflow.com/questions/48422652/how-do-i-compare-the-result-of-a-function-to-values-in-a-list-box-to-determine-w/48422831#48422831", "title": "How do I compare the result of a function to values in a list box to determine which form to open on start up?", "body": "<p>Try this:</p>\n\n<pre><code>Set c = Forms!Users_Form!lst_Users\n\nFor i = 0 To c.ListCount - 1\n    If c.Column(0, i) = ThisUserName() Then\n        y = True\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9262029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5473408a4ac41747f6e3e930bebfa2?s=128&d=identicon&r=PG&f=1", "display_name": "Chas_C", "link": "https://stackoverflow.com/users/9262029/chas-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 48422831, "answer_count": 1, "score": 0, "last_activity_date": 1516797860, "creation_date": 1516797354, "question_id": 48422652, "link": "https://stackoverflow.com/questions/48422652/how-do-i-compare-the-result-of-a-function-to-values-in-a-list-box-to-determine-w", "title": "How do I compare the result of a function to values in a list box to determine which form to open on start up?", "body": "<p>I'm trying to employ a basic level of security to my Access db.</p>\n\n<p>I have a list of valid users and want to compare them to user name from advapi32.dll.</p>\n\n<p>The code below is where I've got to with my AutoExec macro:</p>\n\n<pre><code>Function UserCompare()\n\nDim c As Control\nDim i As Integer\nDim y As Boolean\n\nDoCmd.OpenForm (\"Users_Form\")\n\nSet c = Forms!Users_Form!lst_Users\n\nFor i = 0 To c.lst_Users.ListCount - 1\n    If c.lst_Users.Column(0, i) = ThisUserName() Then\n        y = True\n    End If\nNext i\n\nIf y = True Then\n    DoCmd.OpenForm (\"Login Screen - Authorised\")\n    Else\n    DoCmd.OpenForm (\"Login Screen - Unauthorised\")\nEnd If\n\nDoCmd.Close acForm, \"Users_Form\", acSaveNo\n\nEnd Function\n</code></pre>\n\n<p>This is resulting in a run-time error 438 (Object doesn't support this property or method).</p>\n\n<p>Can someone point me in the right direction?</p>\n\n<p>Many thanks,\nChas</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 153, "user_id": 8046765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6nIxg.jpg?s=128&g=1", "display_name": "ppijnenburg", "link": "https://stackoverflow.com/users/8046765/ppijnenburg"}, "edited": false, "score": 0, "creation_date": 1516797562, "post_id": 48422627, "comment_id": 83834772, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39967118/excel-vba-code-to-select-non-empty-cells\">Excel VBA code to select non empty cells</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 1, "last_activity_date": 1516797827, "last_edit_date": 1516797827, "creation_date": 1516797523, "answer_id": 48422719, "question_id": 48422627, "link": "https://stackoverflow.com/questions/48422627/ignore-blanks-in-a-range/48422719#48422719", "title": "Ignore blanks in a range", "body": "<p>Add conditional instruction: </p>\n\n<pre><code>If cl &lt;&gt; \"\" Then wkb1.Sheets(cell.Value).Copy After:=Workbooks _\n(\"ASE RTU Addressing with Automation.xlsm\").Sheets(4)\n</code></pre>\n\n<p>And remove:</p>\n\n<pre><code>If cell = \"\" Then Exit Sub   \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 9209543, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/509e07313eb5e78d1069ad828c460a5b?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Hannigan", "link": "https://stackoverflow.com/users/9209543/richard-hannigan"}, "edited": false, "score": 0, "creation_date": 1516798627, "post_id": 48422949, "comment_id": 83835457, "body": "brilliant thank you so much that works a treat i am fairly new to VBA and think i may off bitten off more than i can chew its all a learning curve"}], "tags": [], "owner": {"reputation": 1, "user_id": 9262103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/468822968456141c762f8f7f539d7ad5?s=128&d=identicon&r=PG&f=1", "display_name": "BigFish", "link": "https://stackoverflow.com/users/9262103/bigfish"}, "is_accepted": false, "score": 0, "last_activity_date": 1516798266, "creation_date": 1516798266, "answer_id": 48422949, "question_id": 48422627, "link": "https://stackoverflow.com/questions/48422627/ignore-blanks-in-a-range/48422949#48422949", "title": "Ignore blanks in a range", "body": "<p>Your error occurs most probably because you try to copy before you do the check. So, at the end, you try to get a sheet with no name. :) </p>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 6518593, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c9021dcc8346db25bb44645fba5c70fc?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer", "link": "https://stackoverflow.com/users/6518593/spencer"}, "is_accepted": false, "score": 0, "last_activity_date": 1516807708, "creation_date": 1516807708, "answer_id": 48426069, "question_id": 48422627, "link": "https://stackoverflow.com/questions/48422627/ignore-blanks-in-a-range/48426069#48426069", "title": "Ignore blanks in a range", "body": "<p>It is better practice to use dynamic ranges since it's likely going to change at some point in the future. There are multiple ways of doing this, but my go to method is something like this:</p>\n\n<pre><code>Dim rn As Range\nSet rn = Range(Range(\"A1\"), Range(\"A1\").End(xlDown))\n</code></pre>\n\n<p>So your issue would be resolved (assuming the blank cells are truly empty) and you will not have to test for blank cells.</p>\n\n<p>Regardless, you should mark one of the above answers are correct if they fixed your issue.</p>\n"}], "owner": {"reputation": 51, "user_id": 9209543, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/509e07313eb5e78d1069ad828c460a5b?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Hannigan", "link": "https://stackoverflow.com/users/9209543/richard-hannigan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1516807708, "creation_date": 1516797287, "last_edit_date": 1516799799, "question_id": 48422627, "link": "https://stackoverflow.com/questions/48422627/ignore-blanks-in-a-range", "title": "Ignore blanks in a range", "body": "<p>Can some one help with the last bit of this code please, I have a range maximum (\"A1:A54\")  when i set to this range and only (A1:A10) have a cell value which is the name of a sheet in another workbook. </p>\n\n<p>This code is working but returns a </p>\n\n<blockquote>\n  <p>runtime 9 error</p>\n</blockquote>\n\n<p>I really want to add if blank ignore if I change to range I have set to A1:A10 then no error.  I think it might be there is no worksheets in the other workbook this is why I get an error on this loop.</p>\n\n<p>Have looked how to ignore blanks but none of the answers i have found have worked.</p>\n\n<p>I really want a if cell = \"\" then ignore currently I thought exit sub would work\n     Sub Iedextraction()</p>\n\n<pre><code> Dim wkb As Excel.Workbook, wkb1 As Excel.Workbook\n Dim wks As Excel.Worksheet, wks1 As Excel.Worksheet\n Dim cell As Range\n Dim rng As Range\n\nWorkbooks.Open Filename:= _\n \"D:\\Projects\\ASE Templates\\ASE Template White Book.xlsx\"\n\nSet wkb = Excel.Workbooks(\"ASE RTU Addressing with Automation.xlsm\")\nSet wks = wkb.Worksheets(\"Tab Names from White book\")\nSet wkb1 = Excel.Workbooks(\"ASE Template White Book.xlsx\")\n\nSet rng = wks.Range(\"A1:A54\")\n\n\nFor Each cell In rng\n\nwkb1.Sheets(cell.Value).Copy After:=Workbooks_\n(\"ASE RTU Addressing with Automation.xlsm\").Sheets(4)\n\nIf cell = \"\" Then Exit Sub\n\n Next\n\n' On Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "range"], "comments": [{"owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "edited": false, "score": 1, "creation_date": 1516798610, "post_id": 48422477, "comment_id": 83835441, "body": "Is the worksheets protected? Or might the VBA code be on the sheet as opposed to be in a module?"}, {"owner": {"reputation": 323, "user_id": 7667649, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/831275645/picture?type=large", "display_name": "Mauro", "link": "https://stackoverflow.com/users/7667649/mauro"}, "reply_to_user": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "edited": false, "score": 0, "creation_date": 1516807245, "post_id": 48422477, "comment_id": 83841645, "body": "The code is in Thisworkbook instead of a module, Would you explain me why that fact could make this code not to work?"}, {"owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "edited": false, "score": 0, "creation_date": 1516876292, "post_id": 48422477, "comment_id": 83872527, "body": "I can&#39;t give you a detailed explanation. But I have experienced this in my VBA Projects."}], "answers": [{"tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 0, "last_activity_date": 1516799502, "creation_date": 1516799502, "answer_id": 48423349, "question_id": 48422477, "link": "https://stackoverflow.com/questions/48422477/1004-application-defined-or-object-defined-error-when-setting-a-range-as-a-vari/48423349#48423349", "title": "1004, Application-defined or Object-defined error when setting a Range as a variable with `.End(xlDown)` function", "body": "<p>The problem likely has to do with the implicit reference to <code>ActiveSheet</code>:</p>\n\n<pre><code>                        ' Right here\nSet r = ws3.Range(\"E20\", Range(\"E20\").End(xlDown))\n</code></pre>\n\n<p>Try this instead:</p>\n\n<pre><code>Set r = ws3.Range(\"E20\", ws3.Range(\"E20\").End(xlDown))\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 7667649, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/831275645/picture?type=large", "display_name": "Mauro", "link": "https://stackoverflow.com/users/7667649/mauro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 48423349, "answer_count": 1, "score": 0, "last_activity_date": 1516799502, "creation_date": 1516796820, "last_edit_date": 1516797459, "question_id": 48422477, "link": "https://stackoverflow.com/questions/48422477/1004-application-defined-or-object-defined-error-when-setting-a-range-as-a-vari", "title": "1004, Application-defined or Object-defined error when setting a Range as a variable with `.End(xlDown)` function", "body": "<p>I've wrote a code to delete rows which cell in column five has a value of 0:</p>\n\n<pre><code>Sub deletedata()\n\nDim i As Integer\nDim n As Integer\nDim ws3 As Worksheet\nSet ws3 = ThisWorkbook.Worksheets(\"3.Calidad CREDITICIA\")\nDim r As Range\nSet r = ws3.Range(\"E20\", Range(\"E20\").End(xlDown))\nn = r.Cells.Count\n\nWith ws3\n         For i = n + 20 To 20\n            If IsNumeric(.Cells(i, 5)) And .Cells(i, 5) = 0 Then\n                .Rows(i &amp; \":\" &amp; i).Delete\n            End If\n            Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>When it arrives to the instruction in which I set r range: <code>Set r = ws3.Range(\"E20\", Range(\"E20\").End(xlDown))</code> I get the 1004 error:</p>\n\n<blockquote>\n  <p>1004, Application-defined or Object-defined</p>\n</blockquote>\n\n<p>I've tried so many things, between them I tried a MyCell loop, but I get still the error when setting range\n\u00bfCould someone tell me what am I doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516796426, "post_id": 48422323, "comment_id": 83834103, "body": "first of all &quot;VB Script&quot; is not &quot;VBA&quot;! Secondly Stack Overflow is not a code writing service therefore please add the code you already have and tell what is working already and what is going wrong. Also read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 6583296, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0a6a9f8bec52b1f6818a88bee0e5355b?s=128&d=identicon&r=PG", "display_name": "Harshad Holkar", "link": "https://stackoverflow.com/users/6583296/harshad-holkar"}, "edited": false, "score": 0, "creation_date": 1516801861, "post_id": 48423165, "comment_id": 83837625, "body": "Showing Subscript out of range error on this line x.Sheets(SheetName).Range(&quot;A1:B9&quot;).Copy"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 413, "user_id": 6583296, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0a6a9f8bec52b1f6818a88bee0e5355b?s=128&d=identicon&r=PG", "display_name": "Harshad Holkar", "link": "https://stackoverflow.com/users/6583296/harshad-holkar"}, "edited": false, "score": 0, "creation_date": 1516801931, "post_id": 48423165, "comment_id": 83837674, "body": "@HarshadHolkar did you amend <code>SheetName = &quot;Sheet1&quot;</code> to your actual Sheet&#39;s name?"}, {"owner": {"reputation": 413, "user_id": 6583296, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0a6a9f8bec52b1f6818a88bee0e5355b?s=128&d=identicon&r=PG", "display_name": "Harshad Holkar", "link": "https://stackoverflow.com/users/6583296/harshad-holkar"}, "edited": false, "score": 0, "creation_date": 1516802647, "post_id": 48423165, "comment_id": 83838159, "body": "Thanks @Xabier the above issue is resolved however its showing now Run time error 1004 File could not be accessed at the same line"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 413, "user_id": 6583296, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0a6a9f8bec52b1f6818a88bee0e5355b?s=128&d=identicon&r=PG", "display_name": "Harshad Holkar", "link": "https://stackoverflow.com/users/6583296/harshad-holkar"}, "edited": false, "score": 0, "creation_date": 1516803129, "post_id": 48423165, "comment_id": 83838511, "body": "@HarshadHolkar, I&#39;m not having any issue with my testing, if you are using Option Explicit, then you would have to declare all your variables beforehand."}, {"owner": {"reputation": 413, "user_id": 6583296, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0a6a9f8bec52b1f6818a88bee0e5355b?s=128&d=identicon&r=PG", "display_name": "Harshad Holkar", "link": "https://stackoverflow.com/users/6583296/harshad-holkar"}, "edited": false, "score": 0, "creation_date": 1516803436, "post_id": 48423165, "comment_id": 83838713, "body": "Its creating a new file with desired results however instead of saving as with the name and the location which I am giving its taking the same file name as original one and opening it also the above error persists while execution"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 413, "user_id": 6583296, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0a6a9f8bec52b1f6818a88bee0e5355b?s=128&d=identicon&r=PG", "display_name": "Harshad Holkar", "link": "https://stackoverflow.com/users/6583296/harshad-holkar"}, "edited": false, "score": 0, "creation_date": 1516803759, "post_id": 48423165, "comment_id": 83838950, "body": "@HarshadHolkar did you change <code>Savepath = &quot;C:\\Users\\Me\\Desktop\\&quot;</code> to your desired save path? Did you also change <code>NewFilename = &quot;New Report&quot;</code> to whatever name you wanted? Also did you check that the file is not open at the time of running the code?"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1516799176, "last_edit_date": 1516799176, "creation_date": 1516798867, "answer_id": 48423165, "question_id": 48422323, "link": "https://stackoverflow.com/questions/48422323/copy-specific-content-from-one-excel-workbook-to-another-workbook/48423165#48423165", "title": "copy specific content from one excel workbook to another workbook", "body": "<p>How about something like this, you will have to change a number of variables in the code to match the names of your sheets, etc.:</p>\n\n<pre><code>Sub BrowseForJ3File()\nDim x As Workbook\n    j3ExcelSheet = Application.GetOpenFilename(FileFilter:=\"Excel Workbooks (*.xls*),*.xls*\", Title:=\"Open Excel File\")\n    If fileToOpen &lt;&gt; False Then\n        MsgBox \"Open \" &amp; fileToOpen\n    End If\n\n    ActiveSheet.Range(\"H9\") = j3ExcelSheet\n\n    Pos = InStrRev(j3ExcelSheet, \"\\\")\n    Filename = Mid(j3ExcelSheet, Pos + 1)\n    'above get the filename\n\n    Pos = InStrRev(Filename, \".\")\n    Extension = Mid(Filename, Pos + 1)\n    'above get the extension\n\n    Savepath = \"C:\\Users\\Me\\Desktop\\\"\n    'get the path to save the new file\n\n    NewFilename = \"New Report\"\n    'above new filename\n\n    Application.DisplayAlerts = False\n    SheetName = \"Sheet1\" 'change this to the original Sheet Name\n\n    Set x = Workbooks.Open(j3ExcelSheet)\n    With x\n        x.Sheets(SheetName).Range(\"A1:B9\").Copy 'copy range to paste headers\n        x.Sheets.Add().Name = \"Header\" 'add sheet Header\n        x.Sheets(\"Header\").Paste 'paste the copied range\n        x.Sheets.Add().Name = \"Detail\" 'add details sheet\n        LastRow = x.Sheets(SheetName).Cells(x.Sheets(SheetName).Rows.Count, \"A\").End(xlUp).Row 'get the last row with data from original sheet\n        x.Sheets(SheetName).Range(\"A11:Q\" &amp; LastRow).Copy 'copy range\n        x.Sheets(\"Detail\").Paste 'paste into Detail\n        x.Sheets(\"Detail\").Range(\"D:D,F:N\").Select 'select columns to delete\n        Selection.Delete Shift:=xlToLeft\n        x.Sheets(SheetName).Delete 'delete original Sheet\n\n        .SaveAs Savepath &amp; NewFilename &amp; \".\" &amp; Extension 'save with new name\n        .Close\n    End With\n    Application.DisplayAlerts = True\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 413, "user_id": 6583296, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0a6a9f8bec52b1f6818a88bee0e5355b?s=128&d=identicon&r=PG", "display_name": "Harshad Holkar", "link": "https://stackoverflow.com/users/6583296/harshad-holkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 48423165, "answer_count": 1, "score": 0, "last_activity_date": 1516799176, "creation_date": 1516796286, "last_edit_date": 1516796715, "question_id": 48422323, "link": "https://stackoverflow.com/questions/48422323/copy-specific-content-from-one-excel-workbook-to-another-workbook", "title": "copy specific content from one excel workbook to another workbook", "body": "<p>I am new to VB and developing a VB script that will take a input excel file and convert to another excel file (new Excel File) with some changes to it.</p>\n\n<p>I have created a macro file which is taking and input file and and creating the new excel file exactly same as the original one but with a new name and at a given location.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eySUa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eySUa.png\" alt=\"Conversion Tool Macro File\"></a></p>\n\n<p>Convert J3 to Phase 1 button is converting the selected excel workbook to new workbook with same content. </p>\n\n<p>Here is my code till now. Sorry If coding standards are not followed as I am very new to VB.</p>\n\n<pre><code>Sub convertJ3ToPhase1()\nj3ExcelSheet = Application.GetOpenFilename(FileFilter:=\"Excel Workbooks (*.xls*),*.xls*\", Title:=\"Open Database File\")\nDim SourceFile, DestinationFile\nSourceFile = j3ExcelSheet\nDestinationFile = \"C:\\Test\\ABC.xlsx\" ' Define target file name.\nFileCopy SourceFile, DestinationFile ' Copy source to target.\nEnd Sub\n</code></pre>\n\n<p>ABC.xlsx contains the same data as the original excel workbook.</p>\n\n<p>However my requirement is something different.</p>\n\n<p>Here is my original Excel file</p>\n\n<p><a href=\"https://i.stack.imgur.com/dq9AJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dq9AJ.png\" alt=\"Original Excel File\"></a></p>\n\n<p>Now what I want is from the first cell to 9th cell(i.e from Site to All partial transfer) the content should be copied to 1st sheet (named Header Sheet) of newly created Workbook while for other data after 10th row(i.e the table data) I only want specific columns in my new workbook (i.e I want 10/19 columns present) that too in the separate sheet (Details Sheet) of the workbook.</p>\n\n<p>Here is the snapshots of how I want data in my new Workbook.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LInPl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LInPl.png\" alt=\"New WorkBook Header Sheet\"></a></p>\n\n<p>In the above image I want top 9 rows data in Header Tab</p>\n\n<p><a href=\"https://i.stack.imgur.com/UlMgV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UlMgV.png\" alt=\"Table Detils Sheet\"></a></p>\n\n<p>In Second Sheet (Details Sheet) I want only particular columns from the original workbook.</p>\n\n<p>Can Anyone Please Help me in writing the VB script as I don't have much knowledge of Syntax and Method of VB Scripting?</p>\n"}, {"tags": ["excel", "ms-word", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1516796628, "post_id": 48422322, "comment_id": 83834207, "body": "If you remove the library reference then <code>wdStory</code> is an unknown value, replace it with its true literal value (add a reference temporarily and ?wdStory in the immediate window to see what it is).  Adding <code>option explicit</code> to the top of your modules would highlight this error)"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1516800781, "creation_date": 1516800781, "answer_id": 48423753, "question_id": 48422322, "link": "https://stackoverflow.com/questions/48422322/issue-with-late-binding/48423753#48423753", "title": "Issue with late binding", "body": "<p>If you don't know the numerical equivalent then:  </p>\n\n<ul>\n<li>Open the application in question (in your case <code>Word</code>)</li>\n<li>Open the VBE (Alt + F11)</li>\n<li>Open the Immediate window (Ctrl + G)</li>\n<li>Enter the keyword in the immediate window preceded by a ? (<code>?wdStory</code>)</li>\n<li>Use the number it returns in your code.  </li>\n</ul>\n\n<p>In this case you need to replace <code>wdStory</code> with the number <code>6</code>.<br>\n(and just read the middle line of @AlexK comment - <em>add a reference temporarily and ?wdStory in the immediate window to see what it is</em>)<br>\nNever thought of adding the referencing and using the immediate window in the current app.  I know I'd forget to remove it again though.</p>\n"}], "owner": {"reputation": 67, "user_id": 1683620, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/abd8cd31a142b44ce9eef8ce768b68a2?s=128&d=identicon&r=PG", "display_name": "user1683620", "link": "https://stackoverflow.com/users/1683620/user1683620"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 48423753, "answer_count": 1, "score": 0, "last_activity_date": 1516800781, "creation_date": 1516796285, "last_edit_date": 1531164843, "question_id": 48422322, "link": "https://stackoverflow.com/questions/48422322/issue-with-late-binding", "title": "Issue with late binding", "body": "<p>I have a macro launched from Excel to control a Word document.</p>\n\n<p>In order to prevent issues with references (<strong>Microsoft Word 15.0 Object Library</strong> or <strong>Microsoft Word 16.0 Object Library</strong> for example) I use late binding in the main macro :</p>\n\n<pre><code>Public appWord as Object\nSub MainSub()\n Set appWord = GetObject(, \"Word.Application\")\n If appWord Is Nothing Then\n     Set appWord = CreateObject(\"Word.Application\")\n End If\n 'Create temp file'\n '...'\n 'Open temp file = strTempWordFile'\n Set docWord = appWord.Documents.Open(strTempWordFile)\n 'Launch function to search text and remove it from the word document\n SearchAndRemove rgCell2.Text, docWord\nEnd Sub\n</code></pre>\n\n<p>Here is an extract of the function (in another module)</p>\n\n<pre><code>Sub SearchAndRemove(ByVal strSearchWord As String, ByRef docWord As Word.Document)\n   Set selWordSelection = appWord.Selection 'That works\n   selWordSelection.HomeKey Unit:=wdStory   'line with issue\n   'do the search and remove'\nEnd Sub\n</code></pre>\n\n<p>If the Sub is called via declaring docWord as Word.Document (which requires reference to <strong>Microsoft Word 1X.0 Library</strong>, this line works OK :</p>\n\n<pre><code>selWordSelection.HomeKey Unit:=wdStory\n</code></pre>\n\n<p>If the Sub is called via declaring docWord as Object (which <strong><em>does not</em></strong>  require reference to <strong>Microsoft Word 1X.0 Library</strong>, this line does not work anymore.</p>\n"}, {"tags": ["vba", "catia"], "comments": [{"owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "edited": false, "score": 1, "creation_date": 1516812056, "post_id": 48422105, "comment_id": 83845254, "body": "Do you have KT1 license active?"}, {"owner": {"reputation": 17, "user_id": 9261780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee380257f2ed21d0b3d0dd116e30704?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/9261780/sebastian"}, "reply_to_user": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "edited": false, "score": 0, "creation_date": 1516945557, "post_id": 48422105, "comment_id": 83905372, "body": "Hello, there was some issue with our licenses now with KT1 license code works.  Any one of you knows how to ON/OFF licenses (Shareable) by macro ? Or there is any other way to do that automatically ?"}, {"owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "edited": false, "score": 0, "creation_date": 1516960410, "post_id": 48422105, "comment_id": 83910791, "body": "There is no way of activating licenses using Catia API. But, you can achieve it by using WinAPI using handles (It is not easy)"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9261780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee380257f2ed21d0b3d0dd116e30704?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/9261780/sebastian"}, "edited": false, "score": 0, "creation_date": 1517490758, "post_id": 48500075, "comment_id": 84122882, "body": "Thank you for this tip, I will add it to my code."}, {"owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "reply_to_user": {"reputation": 17, "user_id": 9261780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee380257f2ed21d0b3d0dd116e30704?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/9261780/sebastian"}, "edited": false, "score": 0, "creation_date": 1517836882, "post_id": 48500075, "comment_id": 84243592, "body": "Did this fix your problem? If so please mark it as the answer."}], "tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": true, "score": 0, "last_activity_date": 1517224885, "creation_date": 1517224885, "answer_id": 48500075, "question_id": 48422105, "link": "https://stackoverflow.com/questions/48422105/instantiate-powercopy-in-catia-v5r24-using-vba-macros/48500075#48500075", "title": "Instantiate PowerCopy in CATIA V5R24 using VBA macros", "body": "<p>Once an instance factory is opened with BeginInstanceFactory, it must be closed by a corresponding EndInstanceFactory. </p>\n\n<p>Now what happens, particularly in development, is you do an BeginInstanceFactory, then somewhere before the call to EndInstanceFactory something breaks, and you have to try again. </p>\n\n<p>However the Instance Factory is still open in your CATIA session, and if you try your macro again right away you will get an error at BeginInstanceFactory. </p>\n\n<p>So what I ALWAYS do just as a best practice, is call EndInstanceFactory BEFORE BeginInstanceFactory is called (and of course at the end as well). If the call is not required it will be ignored. But if it is required  (If the factory is still open in your session because of a previous failed run) it should put everything back into the expected state for the factory to be opened again. </p>\n\n<p>So to summarize, try this:</p>\n\n<pre><code>...\nSet factory = PartDest.GetCustomerFactory(\"InstanceFactory\")\nfactory.EndInstanceFactory\nfactory.BeginInstanceFactory \"SurfacicHoles\",\"C:\\PowerCopyReference.CATPart\"\n...\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9261780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee380257f2ed21d0b3d0dd116e30704?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/9261780/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 0, "closed_date": 1518094238, "accepted_answer_id": 48500075, "answer_count": 1, "score": 0, "last_activity_date": 1518094308, "creation_date": 1516795551, "last_edit_date": 1518094308, "question_id": 48422105, "link": "https://stackoverflow.com/questions/48422105/instantiate-powercopy-in-catia-v5r24-using-vba-macros", "closed_reason": "Duplicate", "title": "Instantiate PowerCopy in CATIA V5R24 using VBA macros", "body": "<p>I would like to create macro for power copy. I took code and models from this <a href=\"http://catiadoc.free.fr/online/cfyugpkt_C2/cfyugpktpwc0001.htm\" rel=\"nofollow noreferrer\">link</a>\nunfortunately it doesn't work (I have made small modifications). Similar problem I have found in this <a href=\"https://stackoverflow.com/questions/40081560/instantiate-powercopy-in-catia-v5r19-using-vba-macros\">subject</a>, and in his case it works. </p>\n\n<pre><code> Private Sub CommandButton1_Click()\n' Instantiation of a PowerCopy Reference \"SurfacicHoles\"\n' SurfacicHoles is stored in the CATPart \"e:\\tmp\\PowerCopyReference.CATPart\"\n' It has\n' 3 inputs: FirstHole, Support,and SecondHole\n' 2 published parameters: Radius1 and Radius2\n'------------------------------------------------------------------\n\n'------------------------------------------------------------------\nDim CATIA As Object\nSet CATIA = GetObject(, \"CATIA.Application\")\nDim SysS As Object\nSet SysS = CATIA.SystemService\n\nDim SpassString As String\n\n'CATIA.SystemService.Print (\"Retrieve the current part\")\nSpassString = SysS.Print(\"Retrive the current part\")\n\nDim PartDocumentDest As PartDocument\nSet PartDocumentDest = CATIA.ActiveDocument\n\nDim PartDest As Part\nSet PartDest = PartDocumentDest.Part\n\n'------------------------------------------------------------------\n'CATIA.SystemService.Print \"Retrieve the factory of the current part\"\nSpassString = SysS.Print(\"Retrieve the factory of the current part\")\n\n\nDim factory As InstanceFactory\nSet factory = PartDest.GetCustomerFactory(\"InstanceFactory\")\n'Debug.Print factory.Name\n\n'------------------------------------------------------------------\n'CATIA.SystemService.Print \"BeginInstanceFactory\"\nSpassString = SysS.Print(\"BeginInstanceFactory\")\n\n\nfactory.BeginInstanceFactory \"SurfacicHoles\", \"C:\\PowerCopyReference.CATPart\"\n'------------------------------------------------------------------\n'CATIA.SystemService.Print \"Begin Instantiation\"\nSpassString = SysS.Print(\"Begin Instantiation\")\n\nfactory.BeginInstantiate\n'------------------------------------------------------------------\n'CATIA.SystemService.Print \"Set Inputs\"\nSpassString = SysS.Print(\"Set Inputs\")\n\nDim FirstHole As Object\nSet FirstHole = PartDest.FindObjectByName(\"Point.1\")\n\nDim Support As Object\nSet Support = PartDest.FindObjectByName(\"Surface.1\")\n\nDim SecondHole As Object\nSet SecondHole = PartDest.FindObjectByName(\"Point.2\")\n\nfactory.PutInputData \"FirstHole\", FirstHole\nfactory.PutInputData \"Support\", Support\nfactory.PutInputData \"SecondHole\", SecondHole\n'------------------------------------------------------------------\n'CATIA.SystemService.Print \"Modify Parameters\"\nSpassString = SysS.Print(\"Modify Parameters\")\n\nDim param1 As Parameter\nSet param1 = factory.GetParameter(\"Radius1\")\nparam1.ValuateFromString (\"25mm\")\n\nDim param2 As Parameter\nSet param2 = factory.GetParameter(\"Radius2\")\nparam2.ValuateFromString (\"15mm\")\n'------------------------------------------------------------------\n'CATIA.SystemService.Print \"Instantiate\"\nSpassString = SysS.Print(\"Instantiate\")\n\nDim Instance As ShapeInstance\nSet Instance = factory.Instantiate\n'------------------------------------------------------------------\n'CATIA.SystemService.Print \"End of Instantiation\"\nSpassString = SysS.Print(\"End of Instantiation\")\n\n\nfactory.EndInstantiate\n'------------------------------------------------------------------\n'CATIA.SystemService.Print \"Release the reference document\"\nSpassString = SysS.Print(\"Release the reference document\")\n\nfactory.EndInstanceFactory\n'------------------------------------------------------------------\n'CATIA.SystemService.Print \"Update\"\nSpassString = SysS.Print(\"Update\")\n\nPartDest.Update\n\nEnd Sub\n</code></pre>\n\n<p>At this step appears an error</p>\n\n<pre><code>factory.BeginInstanceFactory \"SurfacicHoles\", \"C:\\PowerCopyReference.CATPart\"\n</code></pre>\n\n<blockquote>\n  <p>Run-time error '-2147467259(80004005)': Automation error. Unspecified\n  error</p>\n</blockquote>\n\n<p>Windows 7 64bit</p>\n\n<p>Today I have got new information from my management... that some of our factories doesn't have access to KT1 license... In that case is there any other way to use automatic power copy ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1516795587, "post_id": 48421981, "comment_id": 83833568, "body": "Could you have a read of these links please and reword your question:   <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1516795698, "post_id": 48421981, "comment_id": 83833656, "body": "Have you tried anything at all?  Maybe recording a macro while activating sheet2, unprotecting it, doing things then protecting it again and moving to another sheet?"}], "answers": [{"tags": [], "owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1516807408, "creation_date": 1516807408, "answer_id": 48425972, "question_id": 48421981, "link": "https://stackoverflow.com/questions/48421981/encrypt-particular-excel-sheet/48425972#48425972", "title": "encrypt particular excel sheet", "body": "<p>A simple google search provided the following code from Microsoft..</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\nDim MySheets As String, Response As String\nMySheet = \"Sheet1\"\nIf ActiveSheet.Name = MySheet Then\nActiveSheet.Visible = False\nResponse = InputBox(\"Enter password to view sheet\")\n    If Response = \"MyPass\" Then\n        Sheets(MySheet).Visible = True\n        Application.EnableEvents = False\n        Sheets(MySheet).Select\n        Application.EnableEvents = True\n    End If\n   End If\n  Sheets(MySheet).Visible = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4241396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000239705022/picture?type=large", "display_name": "Mamed Aliyev", "link": "https://stackoverflow.com/users/4241396/mamed-aliyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516807408, "creation_date": 1516795224, "last_edit_date": 1531161705, "question_id": 48421981, "link": "https://stackoverflow.com/questions/48421981/encrypt-particular-excel-sheet", "title": "encrypt particular excel sheet", "body": "<p>I have excel workbook with 3 sheets and want to protect only second sheet(sheet2) with password. \nI would like to when I switch to sheet2 from sheet1 or sheet3, it will ask a password and all cells of sheet2 are invisible unless password is confirmed. </p>\n\n<p>Could you help me to do this task?\nThanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516795304, "post_id": 48421941, "comment_id": 83833407, "body": "Are you sure that the value is the 4-element string <code>&quot;&#39;123&quot;</code> rather than the 3-element string <code>&quot;123&quot;</code> which has been entered as <code>&#39;123</code> at the user interface (where a leading single quote causes Excel to interpret the rest of what you type as a string)? In any event, a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would help."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1516795740, "post_id": 48421941, "comment_id": 83833694, "body": "(Actual question: How to get raw cell value from VBA?)"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1516795781, "post_id": 48421941, "comment_id": 83833724, "body": "What&#39;s your current code?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516796839, "post_id": 48421941, "comment_id": 83834343, "body": "If in A2 you enter the formula <code>=LEN(A1)</code> do you get 3 or 4? I suspect that you will get 3 rather than 4. Perhaps the real question is how to enter the value <code>&#39;123</code> into a cell. One answer is to type <code>&#39;&#39;123</code> (with 2 single quote marks, the first causing Excel to interpret the rest, including the second quote mark, as text)."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 3, "last_activity_date": 1516804886, "creation_date": 1516804886, "answer_id": 48425119, "question_id": 48421941, "link": "https://stackoverflow.com/questions/48421941/how-to-get-excel-cell-value-in-vba-with-single-quote-if-in-the-starting-of-text/48425119#48425119", "title": "How to get Excel cell Value in VBA with single quote if in the starting of text", "body": "<p>As <a href=\"https://stackoverflow.com/a/48423862/4996248\">this answer</a> shows, you can use <code>.PrefixCharacter</code> to get the initial single quote mark (if any), which then be concatenated with the value of the cell:</p>\n\n<pre><code>Range(\"A1\").PrefixCharacter &amp; Range(\"A1\").Value\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9038612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WVZpi.jpg?s=128&g=1", "display_name": "Arvind6014", "link": "https://stackoverflow.com/users/9038612/arvind6014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "accepted_answer_id": 48425119, "answer_count": 1, "score": 2, "last_activity_date": 1516804886, "creation_date": 1516795074, "last_edit_date": 1516799556, "question_id": 48421941, "link": "https://stackoverflow.com/questions/48421941/how-to-get-excel-cell-value-in-vba-with-single-quote-if-in-the-starting-of-text", "title": "How to get Excel cell Value in VBA with single quote if in the starting of text", "body": "<p>How to get Excel cell Value in VBA with single quote if in the starting of text.</p>\n\n<p>For Eg.\nCell A1 has Value '123. I get value 123 only in VBA. I need '123.</p>\n"}, {"tags": ["vba", "excel", "automation"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1516795115, "post_id": 48421923, "comment_id": 83833283, "body": "What have you tried so far, and where are you stuck? We can&#39;t help if you don&#39;t show us the exact problem you are facing."}, {"owner": {"reputation": 1, "user_id": 9261854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02df9fa22b60a6936e63e9fb474fbd83?s=128&d=identicon&r=PG&f=1", "display_name": "NedShneeb", "link": "https://stackoverflow.com/users/9261854/nedshneeb"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1516795890, "post_id": 48421923, "comment_id": 83833797, "body": "I only have experience with Recording macros, which does not help with this since it is not a repeatable process on the range of cells included. If this is too basic a question, perhaps I am in the wrong place as I have no idea where to begin."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9261854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02df9fa22b60a6936e63e9fb474fbd83?s=128&d=identicon&r=PG&f=1", "display_name": "NedShneeb", "link": "https://stackoverflow.com/users/9261854/nedshneeb"}, "edited": false, "score": 0, "creation_date": 1516798329, "post_id": 48422239, "comment_id": 83835259, "body": "Sorry, I do not think I know enough to implement this solution. I need to do some more learning I think and it will make more sense. Thank you!"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 1, "user_id": 9261854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02df9fa22b60a6936e63e9fb474fbd83?s=128&d=identicon&r=PG&f=1", "display_name": "NedShneeb", "link": "https://stackoverflow.com/users/9261854/nedshneeb"}, "edited": false, "score": 0, "creation_date": 1516799139, "post_id": 48422239, "comment_id": 83835819, "body": "I&#39;ve added a little more information as to where the code should go, please could you also mark my response as an answer if it has helped? Thanks."}, {"owner": {"reputation": 1, "user_id": 9261854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02df9fa22b60a6936e63e9fb474fbd83?s=128&d=identicon&r=PG&f=1", "display_name": "NedShneeb", "link": "https://stackoverflow.com/users/9261854/nedshneeb"}, "edited": false, "score": 0, "creation_date": 1516799843, "post_id": 48422239, "comment_id": 83836311, "body": "Got it now! Thanks very much for your help!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1516799098, "last_edit_date": 1516799098, "creation_date": 1516796065, "answer_id": 48422239, "question_id": 48421923, "link": "https://stackoverflow.com/questions/48421923/i-would-like-to-copy-data-into-a-new-row-on-excel-and-create-a-new-input-row/48422239#48422239", "title": "I would like to copy data into a new row on excel and create a new input row", "body": "<p>I'm not sure how you are calculating the value for Processed, but the code below will add a new row and populate every field apart from that one, simply put the code under the Sheet you are using.</p>\n\n<p>This also assumes that your Percentage is calculated with a formula, which will get dropped into the new row without having to explicitly add it.</p>\n\n<p>It will check for changes in cell K10 and if something has changed it will take them values and add a row to your table:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$K$10\" Then\n        Dim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n        'declare and set your worksheet, amend as required\n        LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n        'get the last row with data on Column A\n        ws.Cells(LastRow + 1, 1).Value = ws.Cells(LastRow, 1) + 1 'add one to the Week Number\n        ws.Cells(LastRow + 1, 2).Value = ws.Cells(LastRow, 2) + 7 'add 7 to the Week Beginning Date\n        ws.Cells(LastRow + 1, 3).Value = ws.Range(\"K9\").Value + ws.Range(\"K10\").Value 'get the Total\n        ws.Cells(LastRow + 1, 4).Value = ws.Range(\"K9\").Value 'copy the Passes\n        ws.Cells(LastRow + 1, 5).Value = ws.Range(\"K10\").Value 'copy the Fails\n    End If\nEnd Sub\n</code></pre>\n\n<p>All you need to do is, open your Workbook, press Alt+F11, then the VBA environment will open up, then double-click on the Sheet you are using and paste it there, like in the image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/89XY7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/89XY7.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9261854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02df9fa22b60a6936e63e9fb474fbd83?s=128&d=identicon&r=PG&f=1", "display_name": "NedShneeb", "link": "https://stackoverflow.com/users/9261854/nedshneeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "closed_date": 1516835700, "accepted_answer_id": 48422239, "answer_count": 1, "score": -2, "last_activity_date": 1516799098, "creation_date": 1516795021, "last_edit_date": 1516796868, "question_id": 48421923, "link": "https://stackoverflow.com/questions/48421923/i-would-like-to-copy-data-into-a-new-row-on-excel-and-create-a-new-input-row", "closed_reason": "Needs more focus", "title": "I would like to copy data into a new row on excel and create a new input row", "body": "<p>I am new to VBA on excel and I am trying to automate a spreadsheet as much as possible.</p>\n\n<p>I have attached an image of an example sheet. What I am trying to do is copy the data in cells K9/K10 into a new row on the table on the left. This table increases in number of rows every week and I want to be able to automate this process, so I can click a button and the data is inputted in the correct columns automatically and everything autofills with it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cQMa6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cQMa6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I hope this makes sense!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "conditional", "conditional-formatting", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516794896, "post_id": 48421803, "comment_id": 83833142, "body": "It stops because that is how you have set up the loop. Why not use a For loop?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516794973, "post_id": 48421803, "comment_id": 83833188, "body": "why don&#39;t you use conditional formatting for that? There is no need to use VBA. Add a new conditional formatting rule with this formula <code>=AND(A2&lt;TODAY(),E2&lt;=98,A2+14&gt;TODAY())</code> to cell D2 and copy format down to the other cells in D"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 8648643, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tY89x.jpg?s=128&g=1", "display_name": "rbonac", "link": "https://stackoverflow.com/users/8648643/rbonac"}, "edited": false, "score": 0, "creation_date": 1516797422, "post_id": 48422190, "comment_id": 83834673, "body": "Worked like a charm thank you so much, this was really helpful. However it also colors the column title (ISIN), how do I get rid of that?"}, {"owner": {"reputation": 125, "user_id": 8648643, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tY89x.jpg?s=128&g=1", "display_name": "rbonac", "link": "https://stackoverflow.com/users/8648643/rbonac"}, "edited": false, "score": 0, "creation_date": 1516798457, "post_id": 48422190, "comment_id": 83835357, "body": "Never mind, found the issue, did not delete my previous colorings, sorry.. Thanks any way for your solution, really appreciate it!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1516796276, "last_edit_date": 1516796276, "creation_date": 1516795889, "answer_id": 48422190, "question_id": 48421803, "link": "https://stackoverflow.com/questions/48421803/excel-vba-coloring-cells-under-multiple-conditions/48422190#48422190", "title": "Excel VBA: Coloring cells under multiple conditions", "body": "<h3>The issue</h3>\n\n<p>Your loop stops because it runs only until <strong>one</strong> of the 3 conditions is false. And your condition</p>\n\n<pre><code>CDate(DateAdd(\"d\", 14, ws.Cells(2 + count, 1).Value)) &gt; CDate(Now())\n</code></pre>\n\n<p>is false for the second data row already. That means everything after the second row is skipped.</p>\n\n<hr>\n\n<h3>VBA Solution</h3>\n\n<p>So you need a loop that loops through <strong>all</strong> data rows and checks with an <code>if</code> statement if the conditions are fulfilled. If true then color it if not move on to the next row.</p>\n\n<pre><code>Public Sub Button1_Click()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim count As Long 'we need to use Long instead of Integer\n                      'Excel has more rows than Integer can handle\n    Set wb = ThisWorkbook 'ThisWorkbook = the wb where this code runs .. is better than\n                          'ActiveWorkbook = any workbook that is in focus at the moment\n    Set ws = wb.Sheets(\"Sheet1\")\n    'if wb is other than the active workbook\n    wb.Activate 'this is not needed to run the code\n    ws.Select 'this is not needed to run the code\n\n    count = 0\n    Do While ws.Cells(2 + count, 1).Value &lt;&gt; vbNullString 'do while first cell contains data\n        If CDate(ws.Cells(2 + count, 1).Value) &lt;= CDate(Now()) And _\n           ws.Cells(2 + count, 5).Value &lt;= 98 And _\n           CDate(DateAdd(\"d\", 14, ws.Cells(2 + count, 1).Value)) &gt; CDate(Now()) Then\n\n            'color it\n            ws.Range(\"D\" &amp; count + 1).Interior.Color = RGB(250, 50, 50)\n        End If\n\n        count = count + 1 'next row\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Note: Have a look at the comments I made which improve the code.</p>\n\n<hr>\n\n<h3>Conditional Formatting Solution</h3>\n\n<p>As an alternative to VBA I suggest to use conditional formatting.</p>\n\n<p>Add a new conditional formatting rule with this formula</p>\n\n<pre><code>=AND(A2&lt;TODAY(),E2&lt;=98,A2+14&gt;TODAY())\n</code></pre>\n\n<p>to cell D2 and copy format down to the other cells in column D.\nConditional formatting changes instantly as you change data values and you don't need to run a VBA code for this.</p>\n"}], "owner": {"reputation": 125, "user_id": 8648643, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tY89x.jpg?s=128&g=1", "display_name": "rbonac", "link": "https://stackoverflow.com/users/8648643/rbonac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 933, "favorite_count": 0, "accepted_answer_id": 48422190, "answer_count": 1, "score": 0, "last_activity_date": 1516796276, "creation_date": 1516794526, "last_edit_date": 1531164843, "question_id": 48421803, "link": "https://stackoverflow.com/questions/48421803/excel-vba-coloring-cells-under-multiple-conditions", "title": "Excel VBA: Coloring cells under multiple conditions", "body": "<p>I am currently altering some prewritten code, so I created a test dummyfile. I am experiencing misbehaviours, where I am unable to find the culprit of. First of all here is my sample Excel datasheet:</p>\n\n<pre><code>Issue Date  Maturity    Status  ISIN            Price\n19/01/2018  06/01/2020  Issued  XS2375645421    97\n25/01/2013  01/01/2020  Issued  XS0879579182    88\n12/01/2015  07/01/2020  Issued  XS4158674165    92\n20/01/2018  05/01/2020  Issued  XS5458614653    98\n31/01/2018  03/01/2020  Traded  XS5445656466    87\n06/02/2018  02/01/2020  In Sub  XS1515113535    99\n</code></pre>\n\n<p>Furthermore, you'll find my code used below:</p>\n\n<pre><code>Sub Button1_Click()\n\n\nDim wb As Workbook\nDim ws As Worksheet\nDim count As Integer\nSet wb = ActiveWorkbook\nSet ws = wb.Sheets(\"Sheet1\")\n'if wb is other than the active workbook\nwb.Activate\nws.Select\n\n\n'Colorizing The ISIN with the following 3 conditions:\n\n'1.) Issue Date &lt;= today\n'2.) Issue Date + 14d &gt; today\n'3.) Price &lt;= 98\n'So in summary the conditions mean that today has to be in between the Issue Date\n'and 14 days after the Issue Date and the price has to be lower than 98\n\ncount = 0\nDo While CDate(ws.Cells(2 + count, 1).Value) &lt;= CDate(Now()) And _\nws.Cells(2 + count, 5).Value &lt;= 98 And _\nCDate(DateAdd(\"d\", 14, ws.Cells(2 + count, 1).Value)) &gt; CDate(Now())\n\ncount = count + 1\n\nws.Range(\"D\" &amp; count + 1).Interior.Color = RGB(250, 50, 50)\n\nLoop\n\n\n\nEnd Sub\n</code></pre>\n\n<p>The code works partially, the first ISIN value gets colored, however afterwards if not all conditions are met, the loop suddenly stops. If it would continue, the ISIN in row 5 should also be colored, because all conditions are satisfied. See screenshot below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/AKheL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AKheL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can anyone help me with this problem?</p>\n\n<p>Thanks in advance!</p>\n\n<p>Kind regards</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1516794210, "creation_date": 1516794210, "answer_id": 48421705, "question_id": 48421598, "link": "https://stackoverflow.com/questions/48421598/copying-only-formats-from-a-cell-to-other-cells/48421705#48421705", "title": "Copying only formats from a cell to other cells", "body": "<p>No need to select, just do:</p>\n\n<pre><code>With ActiveSheet\n    .Range(\"C\" &amp; SelRowNumber).Copy\n    .Range(\"A\" &amp; SelRowNumber &amp; \":B\" &amp; SelRowNumber).PasteSpecial ...\nend with\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 48421705, "answer_count": 1, "score": 1, "last_activity_date": 1516801933, "creation_date": 1516793888, "last_edit_date": 1531164843, "question_id": 48421598, "link": "https://stackoverflow.com/questions/48421598/copying-only-formats-from-a-cell-to-other-cells", "title": "Copying only formats from a cell to other cells", "body": "<p>I am trying to copy the formats from a cell into two other cells.</p>\n\n<pre><code>.ActiveSheet.Range(\"C\" &amp; SelRowNumber).Select\n.Selection.Copy\n.ActiveSheet.Range(\"A\" &amp; SelRowNumber &amp; \":B\" &amp; SelRowNumber).Select\n.Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>I don't want to use Select or Selection because it is not being considered as a best practice.</p>\n\n<p>I know how to assign activesheet to an worksheet object, but I need some clarity on simplifying the other parts of the code.</p>\n"}, {"tags": ["vba", "excel", "loops", "excel-2010"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1516793402, "post_id": 48421368, "comment_id": 83832263, "body": "Can you give us more detail than &quot;but it is not working&quot;?"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1516794440, "post_id": 48421368, "comment_id": 83832870, "body": "You could try selecting the top left cell of the data and thwen select the current region. In this case &quot;A2&quot; is the top left cell in my data.  ...<code>Range(&quot;A2&quot;).Select  Selection.CurrentRegion.Select</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1516794823, "last_edit_date": 1516794823, "creation_date": 1516794503, "answer_id": 48421795, "question_id": 48421368, "link": "https://stackoverflow.com/questions/48421368/getting-cell-value-by-looping-through-entire-column/48421795#48421795", "title": "Getting cell value by looping through entire column", "body": "<p>How about something like below:</p>\n\n<pre><code>Dim ws As Worksheet\nDim ws2 As Worksheet\nDim arr2() As String\nDim i As Long\n\nSet ws = Sheets(\"Main\")\nSet ws2 = Sheets(\"Sheet2\")\nSet Tbl = ws2.ListObjects(\"DataTable\")\n\nLastCol = ws2.Cells(1, ws2.Columns.Count).End(xlToLeft).Column\n'above will give you the last column number in row one of sheet ws2\nReDim Preserve arr2(1 To LastCol) 're-size the array\n'Set rng = Range(\"A1:A\" &amp; LastCol) 'set your range from column 1 to last\n\n\nFor i = 1 To LastCol 'loop through columns\n    arr2(i) = ws2.Cells(1, i).Value 'add value to array\n    'above number 1 represents Row 1, and i will loop through columns\nNext i\n\nTbl.Range.AutoFilter Field:=12, Criteria1:=arr2, Operator:=xlFilterValues\n'above will filter table column 12 with array values?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9262004, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w-BBM5WT-DU/AAAAAAAAAAI/AAAAAAAACXE/azBtmytPCK8/photo.jpg?sz=128", "display_name": "S&#233;rgio Mesti Samorano", "link": "https://stackoverflow.com/users/9262004/s%c3%a9rgio-mesti-samorano"}, "is_accepted": false, "score": 0, "last_activity_date": 1516797290, "last_edit_date": 1516797290, "creation_date": 1516796534, "answer_id": 48422386, "question_id": 48421368, "link": "https://stackoverflow.com/questions/48421368/getting-cell-value-by-looping-through-entire-column/48422386#48422386", "title": "Getting cell value by looping through entire column", "body": "<p>I do not know if I understood your question well, but just replace:</p>\n\n<pre><code>Set rng = Range(\"A1:AG1\")\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>Set rng = ws.range(ws.cells(1 , 1) , ws.cells(1 , ws.Cells.Columns.Count).End(xlToLeft).Column\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "accepted_answer_id": 48421795, "answer_count": 2, "score": 0, "last_activity_date": 1516801955, "creation_date": 1516793196, "last_edit_date": 1516801955, "question_id": 48421368, "link": "https://stackoverflow.com/questions/48421368/getting-cell-value-by-looping-through-entire-column", "title": "Getting cell value by looping through entire column", "body": "<p>I would like to apply filter on a table based the values presented in cells A1:AG1. But the problem is when my data gets updated, sometimes i have values in other cells like AH,AI etc., The values available only on first row. </p>\n\n<p>So i tried to add a loop for every cell, but it is not working. How to change my code to loop through every column in a single row. Help me</p>\n\n<pre><code>Dim ws As Worksheet\nDim str2 As Variant\nDim arr2() As String\nDim j As Long\nDim rng As Range\n\nSet ws = Sheets(\"Main\")\nSet Tbl = Sheet2.ListObjects(\"DataTable\")\nSet rng = Range(\"A1:AG1\") 'Need to change\n\nj = 1\nFor Each cell In rng\n    str2 = cell.Value\n    ReDim Preserve arr2(j)\n    arr2(j) = str2\n    j = j + 1\nNext cell\n\nTbl.Range.AutoFilter Field:=12, Criteria1:=arr2, Operator:=xlFilterValues\n\nEnd sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "permission-denied"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1516790127, "post_id": 48420251, "comment_id": 83830181, "body": "Maybe your antivirus is analyzing the file while you are trying to delete it. Do you still get the same error if retry to delete it after a while?"}, {"owner": {"reputation": 69, "user_id": 8537905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b1bb24d504c3cead2e7d33091f5e61?s=128&d=identicon&r=PG&f=1", "display_name": "heaton124", "link": "https://stackoverflow.com/users/8537905/heaton124"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1516790432, "post_id": 48420251, "comment_id": 83830362, "body": "I just noticed, that when I&#39;m trying to open the file manually, a popup window shows up telling me that the file is currently open by me. No clue why. I&#39;ll try setting macro to close sOutputFile first."}, {"owner": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "edited": false, "score": 1, "creation_date": 1516790738, "post_id": 48420251, "comment_id": 83830548, "body": "Can you delete the file through windows explorer?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1516792148, "post_id": 48420251, "comment_id": 83831439, "body": "Take a look for some ideas here - <a href=\"https://stackoverflow.com/questions/9373082/detect-whether-excel-workbook-is-already-open\" title=\"detect whether excel workbook is already open\">stackoverflow.com/questions/9373082/&hellip;</a>"}, {"owner": {"reputation": 69, "user_id": 8537905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b1bb24d504c3cead2e7d33091f5e61?s=128&d=identicon&r=PG&f=1", "display_name": "heaton124", "link": "https://stackoverflow.com/users/8537905/heaton124"}, "edited": false, "score": 0, "creation_date": 1516798467, "post_id": 48420251, "comment_id": 83835365, "body": "I can&#39;t currently delete the file at all for some reason. I&#39;m quite busy doing some other work right now but I also can&#39;t come up with any idea of force closing it through VBA or even manually. After closing excel processes I finally were able to delete it, but that&#39;s not the thing I&#39;d like to do on everyday basis."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "is_accepted": false, "score": 1, "last_activity_date": 1516832732, "creation_date": 1516832732, "answer_id": 48432730, "question_id": 48420251, "link": "https://stackoverflow.com/questions/48420251/kill-filecopy-leads-to-permission-denied/48432730#48432730", "title": "&quot;Kill&quot; / &quot;FileCopy&quot; leads to permission denied", "body": "<p>The logic is not quite right in my opinion, please try the following (FileCopy should be inside an If...End If):</p>\n\n<pre><code>sOutputFile = CurrentProject.Path &amp; \"\\Output Files\\Recon\\\" &amp; sDate &amp; \" \" &amp; \nsClient &amp; \" Cash Recon.xlsx\"\nsTemplateFile = CurrentProject.Path &amp; \"\\Temp Files\\Template_Listed.xlsx\"\nIf FileExists(sOutputFile) Then \n  Kill sOutputFile\n  FileCopy sTemplateFile, sOutputFile\nEnd If\n</code></pre>\n\n<p>And this is the FileExists function:</p>\n\n<pre><code>Public Function FileExists_1(sFileName As String) As Boolean\n  Dim obj_fso As Object\n\n  Set obj_fso = CreateObject(\"Scripting.FileSystemObject\")\n  FileExists_1 = obj_fso.fileExists(sFileName)\n\n  Set obj_fso = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 8537905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b1bb24d504c3cead2e7d33091f5e61?s=128&d=identicon&r=PG&f=1", "display_name": "heaton124", "link": "https://stackoverflow.com/users/8537905/heaton124"}, "is_accepted": true, "score": 0, "last_activity_date": 1518091123, "creation_date": 1518091123, "answer_id": 48684967, "question_id": 48420251, "link": "https://stackoverflow.com/questions/48420251/kill-filecopy-leads-to-permission-denied/48684967#48684967", "title": "&quot;Kill&quot; / &quot;FileCopy&quot; leads to permission denied", "body": "<p>What was the issue in my case, was that I previously used the macro, but the full ran failed. After trying to run it again after few adjustments (not related to the code I posted here), the above issue was happening. All just because I had the file still open somewhere in my excel's memory, hence the file couldn't be deleted.</p>\n\n<p>Thanks for all the contributions guys. You're amazing as always!</p>\n"}], "owner": {"reputation": 69, "user_id": 8537905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b1bb24d504c3cead2e7d33091f5e61?s=128&d=identicon&r=PG&f=1", "display_name": "heaton124", "link": "https://stackoverflow.com/users/8537905/heaton124"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3063, "favorite_count": 0, "accepted_answer_id": 48684967, "answer_count": 2, "score": 0, "last_activity_date": 1593955915, "creation_date": 1516789892, "last_edit_date": 1593955915, "question_id": 48420251, "link": "https://stackoverflow.com/questions/48420251/kill-filecopy-leads-to-permission-denied", "title": "&quot;Kill&quot; / &quot;FileCopy&quot; leads to permission denied", "body": "<p>I'm having a problem with my Access VBA macro which for some reason is breaking on those lines with error \"Permission Denied [Run-time error 70]:</p>\n\n<pre><code>sOutputFile = CurrentProject.Path &amp; \"\\Output Files\\Recon\\\" &amp; sDate &amp; \" \" &amp; sClient &amp; \" Cash Recon.xlsx\"\nsTemplateFile = CurrentProject.Path &amp; \"\\Temp Files\\Template_Listed.xlsx\"\nIf Dir(sOutputFile) &lt;&gt; \"\" Then Kill sOutputFile\nFileCopy sTemplateFile, sOutputFile\n</code></pre>\n\n<p>What's getting \"pointed out\" directly is the \"Kill sOutputFile\" phrase.</p>\n\n<p>It is worth to mention, that I do not have any of the files open, I have full access to the directories, and not long ago (before declaring sOutputFile and sTemplateFile) they've been both cleared. </p>\n\n<p>Any help is much appreciated and I'm willing to share more of my code if needed.</p>\n\n<p>Edit: Also, from time to time, the macro goes to the next line and breaks at the FileCopy instead.</p>\n"}, {"tags": ["excel", "runtime-error", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9167318"}, "edited": false, "score": 1, "creation_date": 1516789251, "post_id": 48419844, "comment_id": 83829588, "body": "After the <code>Dim ws As Worksheet</code> you are directly using <code>ws.Cells</code> in your <code>Do While</code> Loop. Do you have any code in between?"}, {"owner": {"reputation": 125, "user_id": 8648643, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tY89x.jpg?s=128&g=1", "display_name": "rbonac", "link": "https://stackoverflow.com/users/8648643/rbonac"}, "edited": false, "score": 0, "creation_date": 1516790512, "post_id": 48419844, "comment_id": 83830415, "body": "No I don&#39;t, however the answer below provided by bilpor worked. thanks anyway for your effort."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 8648643, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tY89x.jpg?s=128&g=1", "display_name": "rbonac", "link": "https://stackoverflow.com/users/8648643/rbonac"}, "edited": false, "score": 0, "creation_date": 1516790460, "post_id": 48420020, "comment_id": 83830373, "body": "Worked, thanks! However I get an overflow error. How do I stop the loop if a blank field in my excel sheet occurs?"}, {"owner": {"reputation": 2267, "user_id": 5135610, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1fc09e29dbb05d102453542ca1947b15?s=128&d=identicon&r=PG&f=1", "display_name": "bilpor", "link": "https://stackoverflow.com/users/5135610/bilpor"}, "reply_to_user": {"reputation": 125, "user_id": 8648643, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tY89x.jpg?s=128&g=1", "display_name": "rbonac", "link": "https://stackoverflow.com/users/8648643/rbonac"}, "edited": false, "score": 1, "creation_date": 1516791038, "post_id": 48420020, "comment_id": 83830714, "body": "you need to introduce an error handler. At the top of your code <code>on error goto errorRoutine</code> then at the bottom of your code <code>exit sub</code> followed by <code>errorRoutine:</code> now you handle the various error that you might get in there. Google VBA Error Handling, there are plenty of examples"}], "tags": [], "owner": {"reputation": 2267, "user_id": 5135610, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1fc09e29dbb05d102453542ca1947b15?s=128&d=identicon&r=PG&f=1", "display_name": "bilpor", "link": "https://stackoverflow.com/users/5135610/bilpor"}, "is_accepted": true, "score": 1, "last_activity_date": 1516789287, "creation_date": 1516789287, "answer_id": 48420020, "question_id": 48419844, "link": "https://stackoverflow.com/questions/48419844/error-91-object-variable-or-with-block-variable-not-set/48420020#48420020", "title": "Error &#39;91&#39;: Object variable or With block variable not set", "body": "<p>After the declaration you need to do something like:</p>\n\n<pre><code>Set wb = ActiveWorkbook\nSet ws = wb.Sheets(\"name\")\n' if wb is other than the active workbook\n wb.activate\n ws.Select\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 8648643, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tY89x.jpg?s=128&g=1", "display_name": "rbonac", "link": "https://stackoverflow.com/users/8648643/rbonac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2832, "favorite_count": 0, "accepted_answer_id": 48420020, "answer_count": 1, "score": 0, "last_activity_date": 1516789287, "creation_date": 1516788822, "last_edit_date": 1531164843, "question_id": 48419844, "link": "https://stackoverflow.com/questions/48419844/error-91-object-variable-or-with-block-variable-not-set", "title": "Error &#39;91&#39;: Object variable or With block variable not set", "body": "<p>I am currently trying to alter some prewritten code and therefore created a dummy file. As I am trying to run some test samples I encounter the following error:</p>\n\n<p>Run-time error '91': Object variable or With block variable not set</p>\n\n<p>You find the code extract below.</p>\n\n<pre><code>Sub Button1_Click()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim count As Integer\n\ncount = 0\nDo While CDate(ws.Cells(2 + count, 1).Value) &lt;= CDate(DateAdd(\"d\", 14, Now()))\n    count = count + 1\n    ws.Range(\"A\" &amp; count + 1).Interior.Color = RGB(250, 50, 50)\n    If CDate(ws.Cells(1 + count, 1).Value) &lt;&gt; CDate(ws.Cells(1 + count, 2).Value) Then\n        If ws.Range(\"C\" &amp; count + 1) &lt;&gt; \"In Sub\" Then\n            ws.Range(\"C\" &amp; count + 1).Interior.Color = RGB(250, 50, 50)\n        Else\n            ws.Range(\"C\" &amp; count + 1).Interior.ColorIndex = 44\n        End If\n    End If\nLoop\n...\n\nEnd Sub\n</code></pre>\n\n<p>The datasheet looks as follows:</p>\n\n<pre><code>Issue Date  Maturity    Status  ISIN            Price\n25/01/2013  01/01/2020  Issued  XS0879579182    88\n06/02/2018  02/01/2020  In Sub  XS1515113535    99\n31/01/2018  03/01/2020  Traded  XS5445656466    87\n18/01/2018  04/01/2020  Issued  XS0254521554    100\n20/01/2018  05/01/2020  Issued  XS5458614653    98\n19/01/2018  06/01/2020  Issued  XS2375645421    97\n12/01/2015  07/01/2020  Issued  XS4158674165    92\n</code></pre>\n\n<p>I guess I did not define the objects correctly, may anyone please help me with this problem?</p>\n\n<p>Thanks in advance!\nKind regards</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 3, "creation_date": 1516788979, "post_id": 48419832, "comment_id": 83829392, "body": "When working with more than one workbook it is best to fully qualify your references, so instead of <code>Worksheets(&quot;Sheet4&quot;)</code> you could write it like <code>ThisWorkbook.Worksheets(&quot;Sheet4&quot;)</code>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1516789628, "post_id": 48419832, "comment_id": 83829840, "body": "Furthermore, instead of using <code>ThisWorkbook.Worksheets(&quot;Sheet4&quot;)</code> you could use the Sheet Object Name which you can find underneath <code>Microsoft Excel Objects</code> in the VBA Editor. e.g. <code>ThisWorkbook.Worksheets(&quot;Sheet4&quot;).Range...</code> would be <code>Sheet4.Range...</code>. Any code inside the sheet object, the sheet can be referred to using <code>Me</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516789749, "post_id": 48419832, "comment_id": 83829933, "body": "Also <code>Rows(&quot;2:2&quot;).Delete</code> does not specify on which sheet you like to delete row 2 so Excel makes a guess and probably fails here. Another thing is that you use <code>Sheets(4)</code> which means the 4th sheet so if you re-order them another sheet is the 4th sheet. It&#39;s often more stable to use names like <code>Worksheets(&quot;Sheet4&quot;)</code> which does not depend on the order number but only on its name."}], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 7085252, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3a9258dcda166c4d807c30dd850fd17b?s=128&d=identicon&r=PG&f=1", "display_name": "pottolom", "link": "https://stackoverflow.com/users/7085252/pottolom"}, "edited": false, "score": 0, "creation_date": 1516798629, "post_id": 48420267, "comment_id": 83835458, "body": "Thank you - that seems to have worked. However, I did have to change .Rows(&quot;2:2&quot;) to Rows(&quot;2:2&quot;)"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 249, "user_id": 7085252, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3a9258dcda166c4d807c30dd850fd17b?s=128&d=identicon&r=PG&f=1", "display_name": "pottolom", "link": "https://stackoverflow.com/users/7085252/pottolom"}, "edited": false, "score": 0, "creation_date": 1516798839, "post_id": 48420267, "comment_id": 83835605, "body": "Sorry, missed the Sheet reference. Are those rows on Sheet1 or Sheet4?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 249, "user_id": 7085252, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3a9258dcda166c4d807c30dd850fd17b?s=128&d=identicon&r=PG&f=1", "display_name": "pottolom", "link": "https://stackoverflow.com/users/7085252/pottolom"}, "edited": false, "score": 0, "creation_date": 1516799022, "post_id": 48420267, "comment_id": 83835729, "body": "You should change it to: <code>.Sheets(1).Rows(&quot;2:2&quot;)</code> or <code>.Sheets(4).Rows(&quot;2:2&quot;)</code> - depending on which sheet it is. But it should start with a <code>.</code>"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1516789931, "creation_date": 1516789931, "answer_id": 48420267, "question_id": 48419832, "link": "https://stackoverflow.com/questions/48419832/run-time-error-9-if-i-open-another-workbook/48420267#48420267", "title": "Run-time error &#39;9&#39; if I open another workbook", "body": "<p>So, as @Xabier mentions, you're not fully qualifying your ranges. You can also create a loop to copy your data as there is a pattern there.</p>\n\n<hr>\n\n<p>In <code>CopyValues()</code>, replace</p>\n\n<pre><code>RowNo = Sheets(4).Cells(Rows.Count, 4).End(xlUp).Row + 1\n\nSheets(4).Cells(RowNo, 2) = Sheets(1).Cells(14, 2)\nSheets(4).Cells(RowNo, 3) = Sheets(1).Cells(14, 3)\nSheets(4).Cells(RowNo, 4) = Sheets(1).Cells(14, 4)\nSheets(4).Cells(RowNo, 5) = Sheets(1).Cells(15, 2)\nSheets(4).Cells(RowNo, 6) = Sheets(1).Cells(15, 3)\nSheets(4).Cells(RowNo, 7) = Sheets(1).Cells(15, 4)\nSheets(4).Cells(RowNo, 8) = Sheets(1).Cells(16, 2)\nSheets(4).Cells(RowNo, 9) = Sheets(1).Cells(16, 3)\nSheets(4).Cells(RowNo, 10) = Sheets(1).Cells(16, 4)\nSheets(4).Cells(RowNo, 11) = Sheets(1).Cells(17, 2)\nIf RowNo &gt; 1440 Then\n    Rows(\"2:2\").Delete Shift:=xlUp\nEnd If\n</code></pre>\n\n<p>with the following:</p>\n\n<pre><code>With ThisWorkbook\n    RowNo = .Sheets(4).Cells(Rows.Count, 4).End(xlUp).Row + 1\n    For t = 2 To 11\n        .Sheets(4).Cells(RowNo, t) = .Sheets(1).Cells(((t - 2) \\ 3) + 14, 2 + ((t - 2) Mod 3))\n    Next\n    If RowNo &gt; 1440 Then .Rows(\"2:2\").Delete Shift:=xlUp\nEnd With\n</code></pre>\n\n<hr>\n\n<p>in the <code>BeforeClose()</code> replace:</p>\n\n<pre><code>Worksheets(\"Sheet4\").Range(\"A2:K\" &amp; z).Delete Shift:=xlUp\n</code></pre>\n\n<p>with</p>\n\n<pre><code>ThisWorkBook.Worksheets(\"Sheet4\").Range(\"A2:K\" &amp; z).Delete Shift:=xlUp\n</code></pre>\n\n<hr>\n\n<p>Lastly, for <code>Worksheet_Change</code>, as it's in a Sheet, you just need to change</p>\n\n<pre><code>Cells(Target.Row, 1) = Now\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Me.Cells(Target.Row, 1) = Now\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1516790197, "post_id": 48420316, "comment_id": 83830228, "body": "you&#39;re not fully qualifying <code>Sheet1</code> in <code>CopyValues</code>."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1516790264, "post_id": 48420316, "comment_id": 83830264, "body": "Where am I not? I&#39;m referring to the Object name which is local to the workbook"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1516790589, "post_id": 48420316, "comment_id": 83830455, "body": "Ah yes, I see that now. Didn&#39;t realise you could do it like that."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1516790052, "creation_date": 1516790052, "answer_id": 48420316, "question_id": 48419832, "link": "https://stackoverflow.com/questions/48419832/run-time-error-9-if-i-open-another-workbook/48420316#48420316", "title": "Run-time error &#39;9&#39; if I open another workbook", "body": "<p>Have a look at this. You will need to check your sheet names in the VBA Editor match. Doing it this way will ensure that you're targeting the correct sheet (even if someone changes the sheet name in the front end)</p>\n\n<pre><code>Sub Auto_Open()\n    Call CopyValues\nEnd Sub\n\nSub CopyValues()\n    Dim RowNo As Long\n\n    With Sheet4\n        RowNo = .Cells(.Rows.Count, 4).End(xlUp).Row + 1\n\n        .Cells(RowNo, 2) = Sheet1.Cells(14, 2)\n        .Cells(RowNo, 3) = Sheet1.Cells(14, 3)\n        .Cells(RowNo, 4) = Sheet1.Cells(14, 4)\n        .Cells(RowNo, 5) = Sheet1.Cells(15, 2)\n        .Cells(RowNo, 6) = Sheet1.Cells(15, 3)\n        .Cells(RowNo, 7) = Sheet1.Cells(15, 4)\n        .Cells(RowNo, 8) = Sheet1.Cells(16, 2)\n        .Cells(RowNo, 9) = Sheet1.Cells(16, 3)\n        .Cells(RowNo, 10) = Sheet1.Cells(16, 4)\n        .Cells(RowNo, 11) = Sheet1.Cells(17, 2)\n\n        If RowNo &gt; 1440 Then\n             .Rows(\"2:2\").Delete Shift:=xlUp\n        End If\n\n        Application.OnTime Now + TimeValue(\"00:01:00\"), \"CopyValues\"\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Option Explicit\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Dim z As Long\n    z = 1440\n\n    Sheet4.Range(\"A2:K\" &amp; z).Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 1 Or Target.Column &gt; 11 Then Exit Sub\n    With Application\n        .EnableEvents = False\n        Me.Cells(Target.Row, 1) = Now\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 249, "user_id": 7085252, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3a9258dcda166c4d807c30dd850fd17b?s=128&d=identicon&r=PG&f=1", "display_name": "pottolom", "link": "https://stackoverflow.com/users/7085252/pottolom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 48420267, "answer_count": 2, "score": 0, "last_activity_date": 1516790052, "creation_date": 1516788790, "question_id": 48419832, "link": "https://stackoverflow.com/questions/48419832/run-time-error-9-if-i-open-another-workbook", "title": "Run-time error &#39;9&#39; if I open another workbook", "body": "<p>I have a workbook in which I am running some VBA code successfully. However, if I leave this workbook open in the background and then open a second workbook to work on something else, the code in first workbook stops running and I get a \"Run-time error '9': Subscript out of range\" message.</p>\n\n<p>Does anyone know why this might be occurring? I am a real novice (I only began delving into VBA this week!) but suspect it might be because my code perhaps refers to the 'active' workbook and is therefore now trying to run on the second workbook I opened. This is the main 'module' code I am using:</p>\n\n<pre><code>Sub Auto_Open()\n\nCall CopyValues\n\nEnd Sub\n\n    Sub CopyValues()\n\n    Dim RowNo As Long\nRowNo = Sheets(4).Cells(Rows.Count, 4).End(xlUp).Row + 1\n\n    Sheets(4).Cells(RowNo, 2) = Sheets(1).Cells(14, 2)\n    Sheets(4).Cells(RowNo, 3) = Sheets(1).Cells(14, 3)\n    Sheets(4).Cells(RowNo, 4) = Sheets(1).Cells(14, 4)\n    Sheets(4).Cells(RowNo, 5) = Sheets(1).Cells(15, 2)\n    Sheets(4).Cells(RowNo, 6) = Sheets(1).Cells(15, 3)\n    Sheets(4).Cells(RowNo, 7) = Sheets(1).Cells(15, 4)\n    Sheets(4).Cells(RowNo, 8) = Sheets(1).Cells(16, 2)\n    Sheets(4).Cells(RowNo, 9) = Sheets(1).Cells(16, 3)\n    Sheets(4).Cells(RowNo, 10) = Sheets(1).Cells(16, 4)\n    Sheets(4).Cells(RowNo, 11) = Sheets(1).Cells(17, 2)\n\nIf RowNo &gt; 1440 Then\n     Rows(\"2:2\").Delete Shift:=xlUp\nEnd If\n\nApplication.OnTime Now + TimeValue(\"00:01:00\"), \"CopyValues\"\n\nEnd Sub \n</code></pre>\n\n<p>I am also running this on the workbook:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Dim z As Integer\n    z = 1440\n\n    Worksheets(\"Sheet4\").Range(\"A2:K\" &amp; z).Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n\n<p>And this on 'Sheet4':</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 1 Or Target.Column &gt; 11 Then Exit Sub\n    Application.EnableEvents = False\n    Cells(Target.Row, 1) = Now\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "catia"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1516795743, "post_id": 48420750, "comment_id": 83833696, "body": "Debug.Print TypeName(Selection.Item2(i).Value) always returns &quot;DrawingView&quot; for me.    How did you manage to have it return &quot;Circle2D&quot; or &quot;Line2D&quot;?"}, {"owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "reply_to_user": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1516800284, "post_id": 48420750, "comment_id": 83836594, "body": "You can always check the objects in the <code>Locals</code> windows, it allows you to verify its properties and inner objects. I replicated your example and checked for all existing collections on the <code>View</code> object."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1516804729, "post_id": 48420750, "comment_id": 83839749, "body": "Ooh yea that&#39;s a great window to have access to, I hadn&#39;t found that one yet. It&#39;s more user friendly than using &quot;Watches&quot;. Anyway the only way I can replicate a return of &quot;Line2D&quot; or &quot;Circle2D&quot; is by drawing a slot manually. However, I&#39;m asking about lines and circles that were generated onto the drawing by using &quot;Front View&quot; or a similar command on a 3D part or product. I can&#39;t find anything that identifies these generated items. I see that a manually drawn line is a &quot;Variant/Object/Line2D&quot;, however a line generated shows in that exact same spot &quot;Variant/Object/DrawingView&quot;."}, {"owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "reply_to_user": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1516807713, "post_id": 48420750, "comment_id": 83841981, "body": "Right... Well, in that case, if there is a way of doing that, I&#39;m not aware of how it can be done. Also, creating the Axis itself using the <code>Catia.StartCommand</code> won&#39;t work. I&#39;m not sure if what you want to do can be done."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 1, "creation_date": 1516862708, "post_id": 48420750, "comment_id": 83865327, "body": "That&#39;s unfortunate. ugh why does Catia drafting have to be such a pain!"}], "tags": [], "owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "is_accepted": false, "score": 1, "last_activity_date": 1516791377, "creation_date": 1516791377, "answer_id": 48420750, "question_id": 48419371, "link": "https://stackoverflow.com/questions/48419371/catia-vba-macro-for-inserting-axis-lines-for-slotted-holes-drafting/48420750#48420750", "title": "CATIA VBA Macro for inserting axis lines for slotted holes (drafting)", "body": "<p>The kind of Line and Circle you are trying to get are probably <code>Line2D</code> and <code>Circle2D</code>.</p>\n\n<p>The code bellow will retrieve from selection on arrays <code>Circles</code> and <code>Lines</code> two of each of those kinds of elements on indexes <code>1</code> and <code>2</code>, if more or less than 2 of each were selected the code will be interrupted.</p>\n\n<pre><code>Sub CreateAxes()\n\n    Dim Document As DrawingDocument\n    Set Document = CATIA.ActiveDocument\n\n    Dim Selection As Selection\n    Set Selection = Document.Selection\n\n    Dim Circles(2) As Circle2D\n    Dim Lines(2) As Line2D\n\n    Dim i As Integer\n\n    Dim CircleCount As Integer\n    Dim LineCount As Integer\n\n    CircleCount = 0\n    LineCount = 0\n\n    For i = 1 To Selection.Count2\n        Select Case TypeName(Selection.Item2(i).Value)\n            Case \"Circle2D\"\n                CircleCount = CircleCount + 1\n                If CircleCount &gt; 2 Then\n                    MsgBox \"More than 2 Circles were selected!\", vbCritical\n                    Exit Sub\n                End If\n                Set Circles(CircleCount) = Selection.Item2(i).Value\n\n            Case \"Line2D\"\n                LineCount = LineCount + 1\n                If LineCount &gt; 2 Then\n                    MsgBox \"More than 2 Lines were selected!\", vbCritical\n                    Exit Sub\n                End If\n                Set Lines(LineCount) = Selection.Item2(i).Value\n\n        End Select\n    Next\n\n    If LineCount &lt; 2 Or CircleCount &lt; 2 Then\n        MsgBox \"This operation requires 2 circles and 2 lines to be selected\", vbCritical\n        Exit Sub\n    End If\n\n\n    'Lines(1) = First Line\n    'Lines(2) = Second Line\n    'Circles(1) = First Circle\n    'Circles(2) = Second Circle\n\nEnd Sub\n</code></pre>\n\n<p>Unfortunatly <code>Catia.StartCommand</code> does not work well for commands that needs 2 selections, and I could not make <code>Catia.StartCommand(\"Axis Line\")</code> work.</p>\n\n<p>There may be some other way to create an <code>Axis Line</code> using automation, but I couldn't find it myself.</p>\n"}], "owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516791377, "creation_date": 1516787465, "question_id": 48419371, "link": "https://stackoverflow.com/questions/48419371/catia-vba-macro-for-inserting-axis-lines-for-slotted-holes-drafting", "title": "CATIA VBA Macro for inserting axis lines for slotted holes (drafting)", "body": "<p>I decided to make a macro because my colleagues and I are sick of having to click the mouse many times to create the desired axis lines for every slotted hole on a drawing.<br>\nHere is the desired result:<br>\n<a href=\"https://i.stack.imgur.com/1eI7u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1eI7u.png\" alt=\"https://i.imgur.com/ENErDRX.png\"></a></p>\n\n<p>The context is a generated drawing view in the drafting environment.<br>\nCurrently we accomplish this by:  </p>\n\n<ul>\n<li>double clicking the axis line command  </li>\n<li>selecting a circle &amp; selecting a line  </li>\n<li>selecting the other circle &amp; selecting a line  </li>\n<li>selecting the 2 axis lines that were just created</li>\n<li>selecting both circles  </li>\n</ul>\n\n<p>This is quite a lot of clicks.  </p>\n\n<p>(Yes I realize there is a thing called \"Center Line\" and also \"Axis and Center Line\" but we prefer not to use these for slotted holes)</p>\n\n<p>For now I'm starting simple and I'd like to make a macro that will add the first 2 axis lines (as in the sequence above). The user will have to select the 2 circles and 2 lines of the slotted hole by dragging a box over them with the mouse before running the macro.</p>\n\n<p>So far this is what I've gotten:  </p>\n\n<pre><code>Sub CATMain()\n\nDim drawingDocument1 As DrawingDocument\nSet drawingDocument1 = CATIA.ActiveDocument\n\nDim SelectionsAll As selection\nSet SelectionsAll = drawingDocument1.selection\n\nDim Selection1\nSet Selection1 = SelectionsAll.Item(1)\n\nDim Selection2\nSet Selection2 = SelectionsAll.Item(2)\n\nDim Selection3\nSet Selection3 = SelectionsAll.Item(3)\n\nDim Selection4\nSet Selection4 = SelectionsAll.Item(4)\n\nDim circle1 As selection\nDim circle2 As selection\nDim line As selection\n\nIf Selection1 = \"circle\" Then\n    circle1.Add.SelectionsAll.Item (1)\nElse\n    line.Add.SelectionsAll.Item (1)\nEnd If\n\nIf Selection2 = \"circle\" Then\n    circle2.Add.SelectionsAll.Item (2)\nElse\n    line.Add.SelectionsAll.Item (2)\nEnd If\n\nIf Selection3 = \"circle\" Then\n    If circle1 Is Nothing Then\n        circle1.Add.SelectionsAll.Item (3)\n    Else\n        circle2.Add.SelectionsAll.Item (3)\n    End If\nElse\n    line.Add.SelectionsAll.Item (3)\nEnd If\n\nIf circle2 Is Nothing Then circle2.Add.SelectionsAll.Item (4)\n\nSelectionsAll.Clear\n\nCATIA.StartCommand \"Axis Line\"\n\nSelectionsAll.Add circle1\nSelectionsAll.Add line\n\nCATIA.StartCommand \"Axis Line\"\n\nSelectionsAll.Add circle2\nSelectionsAll.Add line\n\nEnd Sub\n</code></pre>\n\n<p>As you can see my first problem arises on this line:<br>\n(\"circle\" is of course filler nonsense)</p>\n\n<pre><code>If Selection1 = \"circle\" Then\n</code></pre>\n\n<p>I can't find a way to distinguish between a selected line or a selected circle.<br>\nI've used the watch tool on Selection1, Selection2, Selection3 and Selection4 to try and find differences between a generated circle and a generated line but so far it's proven unsuccessful.  </p>\n\n<p>If anyone knows how I could distinguish between a circle and a line then I'd be very grateful for the answer indeed.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9167318"}, "edited": false, "score": 0, "creation_date": 1516788050, "post_id": 48419361, "comment_id": 83828788, "body": "<code>I cannot see it. Maybe it is another error... Can anyone have a look?</code> Do you know that there is a code review site? <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 2934, "user_id": 746674, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/7bb83e111a90fa717af1dac727d1884b?s=128&d=identicon&r=PG", "display_name": "Phil Cooper", "link": "https://stackoverflow.com/users/746674/phil-cooper"}, "edited": false, "score": 3, "creation_date": 1516788278, "post_id": 48419361, "comment_id": 83828944, "body": "Good luck to the next person that has to maintain this.  Perhaps it&#39;s worth refactoring this out into methods to make it more readable <code>AddValue(int index, bool fixQuote, bool fixNull)</code> - in doing so, you&#39;ll probably find (or fix) where the syntax error is."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1516792135, "post_id": 48419361, "comment_id": 83831431, "body": "&quot;My God, It&#39;s full of sta.. quotes!&quot;"}, {"owner": {"reputation": 1, "user_id": 7115175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af3d4415632dcf6b3220e7fa442b8bb?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7115175/vincent"}, "edited": false, "score": 0, "creation_date": 1516800971, "post_id": 48419361, "comment_id": 83837039, "body": "Thanks guys, I didn&#39;t know there was a code review site."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1516787640, "creation_date": 1516787640, "answer_id": 48419435, "question_id": 48419361, "link": "https://stackoverflow.com/questions/48419361/string-delimiters-in-vba/48419435#48419435", "title": "String delimiters in VBA", "body": "<ol>\n<li>Write <code>Stop</code> after the you have written;</li>\n<li>Run the code;</li>\n<li>It will stop on the <code>Stop</code> word;</li>\n<li>Press <kbd>Ctrl</kbd>+<kbd>G</kbd></li>\n<li>Write <code>?QryInsertTracks</code> and press Enter</li>\n<li>Take a look at the result - it should be visible;</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 7115175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af3d4415632dcf6b3220e7fa442b8bb?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7115175/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516787640, "creation_date": 1516787435, "question_id": 48419361, "link": "https://stackoverflow.com/questions/48419361/string-delimiters-in-vba", "title": "String delimiters in VBA", "body": "<p>I'm new to VBA and I'm writing a query within a module.\nAt the moment I'm getting a syntax error. I believe it is because I have misplaced an \" to implicate a string.\nHowever, I cannot see it. Maybe it is another error... Can anyone have a look?</p>\n\n<p>Code: </p>\n\n<pre><code>        QryInsertTracks = \"INSERT INTO IMP_TRACK_GLOBAL_INFO VALUES (\" &amp; recTracksMissing(0) &amp; \", \" &amp; recTracksMissing(1) &amp; \", \" &amp; recTracksMissing(2) &amp; \", \" &amp; recTracksMissing(3) &amp; \", \" &amp; _\n            recTracksMissing(4) &amp; \", \" &amp; \"'\" &amp; fixQuotes(recTracksMissing(5)) &amp; \"' , \" &amp; \"'\" &amp; recTracksMissing(6) &amp; \"' , \" &amp; \"'\" &amp; recTracksMissing(7) &amp; \"' , \" &amp; _\n            \"'\" &amp; recTracksMissing(8) &amp; \"', \" &amp; _\n            fixNull(recTracksMissing(9)) &amp; \", \" &amp; _\n            \"'\" &amp; fixQuotes(recTracksMissing(10)) &amp; \"' , \" &amp; _\n            recTracksMissing(11) &amp; \", \" &amp; _\n            fixNullAgain(\"'\" &amp; fixQuotes(fixNull(recTracksMissing(12))) &amp; \"'\") &amp; \", \" &amp; _\n            \"'\" &amp; recTracksMissing(13) &amp; \"'\" &amp; \", '\" &amp; recTracksMissing(14) &amp; \"', '\" &amp; recTracksMissing(15) &amp; \"', '\" &amp; recTracksMissing(16) &amp; \"', \" &amp; fixNullAgain(\"'\" &amp; fixQuotes(fixNull(recTracksMissing(17))) &amp; \"'\") &amp; \", \" &amp; _\n            \"'\" &amp; fixQuotes(recTracksMissing(18)) &amp; \"' , \" &amp; _\n            fixNull(recTracksMissing(19)) &amp; \", \" &amp; _\n            \"'\" &amp; fixQuotes(fixNull(recTracksMissing(20))) &amp; \"' , \" &amp; _\n            fixNullAgain(\"'\" &amp; fixQuotes(fixNull(recTracksMissing(21))) &amp; \"'\") &amp; \", \" &amp; _\n            fixNullAgain(\"'\" &amp; fixQuotes(fixNull(recTracksMissing(22))) &amp; \"'\") &amp; \", \" &amp; _\n            fixNullAgain(\"'\" &amp; fixQuotes(fixNull(recTracksMissing(23))) &amp; \"'\") &amp; \", \" &amp; _\n            fixNullAgain(\"'\" &amp; fixQuotes(fixNull(recTracksMissing(24))) &amp; \"'\") &amp; \", \" &amp; _\n            fixNullAgain(\"'\" &amp; fixQuotes(fixNull(recTracksMissing(25))) &amp; \"'\") &amp; \", \" &amp; _\n            \"'\" &amp; recTracksMissing(26) &amp; \"' , \" &amp; _\n            \"'\" &amp; recTracksMissing(27) &amp; \"' , \" &amp; _\n            fixNull(recTracksMissing(28)) &amp; \", \" &amp; _\n            fixNull(recTracksMissing(29)) &amp; \", \" &amp; _\n            \"'\" &amp; recTracksMissing(30) &amp; \"' , \" &amp; _\n            fixNull(recTracksMissing(31)) &amp; \", \" &amp; _\n            \"'\" &amp; recTracksMissing(32) &amp; \"' , \" &amp; _\n            \"'\" &amp; fixQuotes(recTracksMissing(33)) &amp; \"' , \" &amp; _\n            \"'\" &amp; recTracksMissing(34) &amp; \"', '\" &amp; Now &amp; \"', \" &amp; fixNullAgain(\"'\" &amp; fixQuotes(fixNull(recTracksMissing(35))) &amp; \"'\") &amp; \", \" &amp; fixNull(recTracksMissing(36)) &amp; \", \" &amp; fixNull(recTracksMissing(37)) &amp; \")\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1516787456, "post_id": 48419201, "comment_id": 83828420, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16943003/vba-to-copy-a-file-from-one-directory-to-another\">VBA to copy a file from one directory to another</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9167318"}, "edited": false, "score": 0, "creation_date": 1516788415, "post_id": 48419201, "comment_id": 83829036, "body": "You are selecting the file in variable <code>j3ExcelSheet</code> and checking the selection in <code>fileToOpen</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1516787347, "creation_date": 1516787347, "answer_id": 48419318, "question_id": 48419201, "link": "https://stackoverflow.com/questions/48419201/copying-selected-excel-file-using-macro-to-the-different-location-along-with-its/48419318#48419318", "title": "Copying selected Excel File using macro to the different location along with its content", "body": "<p>Use <code>FileCopy</code></p>\n\n<pre><code>FileCopy j3ExcelSheet, \"C:\\Users\\IamWhoIam\\GloriousSubfolder\\Test.xls\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1516788652, "last_edit_date": 1516788652, "creation_date": 1516788226, "answer_id": 48419637, "question_id": 48419201, "link": "https://stackoverflow.com/questions/48419201/copying-selected-excel-file-using-macro-to-the-different-location-along-with-its/48419637#48419637", "title": "Copying selected Excel File using macro to the different location along with its content", "body": "<p>How about something like below, this will open the file and Save As whatever filename you want, the other answers will copy the files, the difference with this option, is that you can also manipulate the data in the workbook (if you want to before saving it):</p>\n\n<pre><code>Sub BrowseForJ3File()\nDim x As Workbook\n    j3ExcelSheet = Application.GetOpenFilename(FileFilter:=\"Excel Workbooks (*.xls*),*.xls*\", Title:=\"Open Excel File\")\n\n    ActiveSheet.Range(\"H9\") = j3ExcelSheet\n\n    Pos = InStrRev(j3ExcelSheet, \"\\\")\n    Filename = Mid(j3ExcelSheet, Pos + 1)\n    'above get the filename\n\n    Pos = InStrRev(Filename, \".\")\n    Extension = Mid(Filename, Pos + 1)\n    'above get the extension\n\n    Savepath = \"C:\\Users\\Me\\Desktop\\\"\n    'get the path to save the new file\n\n    NewFilename = \"New Report\"\n    'above new filename\n\n    Application.DisplayAlerts = False\n\n    Set x = Workbooks.Open(j3ExcelSheet)\n    With x\n        .SaveAs Savepath &amp; Format(Date, \"yyyymm\") &amp; \" \" &amp; NewFilename &amp; \".\" &amp; Extension\n        .Close\n    End With\n    Application.DisplayAlerts = True\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 413, "user_id": 6583296, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0a6a9f8bec52b1f6818a88bee0e5355b?s=128&d=identicon&r=PG", "display_name": "Harshad Holkar", "link": "https://stackoverflow.com/users/6583296/harshad-holkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516802012, "creation_date": 1516787013, "last_edit_date": 1516802012, "question_id": 48419201, "link": "https://stackoverflow.com/questions/48419201/copying-selected-excel-file-using-macro-to-the-different-location-along-with-its", "title": "Copying selected Excel File using macro to the different location along with its content", "body": "<p>I am working on macro and I want to write a VBA code to select a file from a particular directory and create a Exact copy of that file with the new name to a particular location.</p>\n\n<p>This is my code to browse and select a file and I want to create a Excel file with same content (including sheets and data present inside those sheets) to a new directory.</p>\n\n<pre><code>Sub BrowseForJ3File()\n    j3ExcelSheet = Application.GetOpenFilename(FileFilter:=\"Excel Workbooks (*.xls*),*.xls*\", Title:=\"Open Excel File\")\n    If fileToOpen &lt;&gt; False Then\n        MsgBox \"Open \" &amp; fileToOpen\n    End If\n    ActiveSheet.Range(\"H9\") = j3ExcelSheet\n End Sub\n</code></pre>\n\n<p>I want to create exact copy of j3ExcelSheet but with a new name and with the same contents present in j3ExcelSheet to a particular location.</p>\n"}, {"tags": ["c++", "vb.net", "vba", "interop", "dllimport"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1516789732, "post_id": 48419139, "comment_id": 83829923, "body": "You probably need to define a typed array. Try with <code>Dim RealLev1() As Single = Array.CreateInstance(GetType(Single), 1, 1) </code>"}, {"owner": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 2, "creation_date": 1516790929, "post_id": 48419139, "comment_id": 83830657, "body": "The VB.NET equivalent of C++&#39;s <code>int</code> is <code>Integer</code>, not <code>Long</code>. Change the first two parameters and the return type of the VB.NET declaration."}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1516797250, "post_id": 48419139, "comment_id": 83834575, "body": "Used the combination of your comments and changed the code accordingly. Now the value of <code>PolAvg</code> is always the same, wrong one"}, {"owner": {"reputation": 1280, "user_id": 2659161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29e7a0497c9070fbb0b9df262eef3dbd?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/2659161/craig"}, "edited": false, "score": 0, "creation_date": 1516808977, "post_id": 48419139, "comment_id": 83843020, "body": "Have you updated your .NET-side logic to account for the change in arrays from column-major in VBA to row-major in .NET?"}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "reply_to_user": {"reputation": 1280, "user_id": 2659161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29e7a0497c9070fbb0b9df262eef3dbd?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/2659161/craig"}, "edited": false, "score": 0, "creation_date": 1516862888, "post_id": 48419139, "comment_id": 83865406, "body": "@Craig No, I didn&#39;t. <code>FindPolarization</code> is a function written in C++ that should already take care of that (updated the question, so the code shows), shouldn&#39;t it? What I am giving to it are pointers to the 2 dimensional arrays, and what I get back is an <code>Integer</code>."}, {"owner": {"reputation": 1280, "user_id": 2659161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29e7a0497c9070fbb0b9df262eef3dbd?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/2659161/craig"}, "edited": false, "score": 0, "creation_date": 1516889243, "post_id": 48419139, "comment_id": 83881086, "body": "The issue is that if you directly copied your VBA code into VB.NET, you may need to transpose the arrays.  Nothing changed on the C++ side, rather on the VB side: arrays in VBA are column-major (most-rapidly varying index is the leftmost index) whereas arrays in .NET are row-major (most-rapidly varying index is the rightmost index).  I would imagine that PInvoke can account for this, but I&#39;m not sure of the exact incantations required.  It&#39;s something you need to account for in some form or fashion."}], "answers": [{"tags": [], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "is_accepted": true, "score": 0, "last_activity_date": 1516952869, "creation_date": 1516952869, "answer_id": 48457442, "question_id": 48419139, "link": "https://stackoverflow.com/questions/48419139/translating-the-passage-of-a-reference-to-a-dll-from-vba-to-vb-net/48457442#48457442", "title": "Translating the passage of a reference to a DLL from VBA to VB.NET", "body": "<p>I have to give all the credit to @Craig here.\nVBA and VB.NET have indeed different matrix addressing logics (column major vs. row major), so I had to transpose all the 2D arrays, without swapping <code>FFThetaPoints</code> and <code>FFPhiPoints</code>.</p>\n\n<p>It is worth mentioning that I tried using the <code>Excel.Application</code> <code>Worksheetfunction.Transpose</code> method, which didn't work as expected. So I had to write my own piece of code to transpose the matrices.</p>\n"}], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 48457442, "answer_count": 1, "score": 0, "last_activity_date": 1516952869, "creation_date": 1516786796, "last_edit_date": 1516863627, "question_id": 48419139, "link": "https://stackoverflow.com/questions/48419139/translating-the-passage-of-a-reference-to-a-dll-from-vba-to-vb-net", "title": "Translating the passage of a reference to a DLL from VBA to VB.NET", "body": "<p>I'm trying to rewrite a piece of code that includes C++ dll calls from VBA to VB.NET.<br>\nIn particular there is a C++ function I'm calling in the dll that performs some actions on a couple of bidimensional arrays of <code>float</code> is:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>int __stdcall FindPolarization(int PointsTheta, int PointsPhi, float* Real1, float* Imag1 = nullptr)\n{\n    double Max[4] = { -999, -999, -999, -999 };         // Max values\n    long MaxPos[4][2] = { -999, -999,                   // Max Theta and Max Phi\n        -999, -999,\n        -999, -999,\n        -999, -999 };\n    float* Pointers[4][2];\n    double DeltaTheta = static_cast&lt;double&gt;(180.0 / PointsTheta);\n    double DeltaPhi = static_cast&lt;double&gt;(360.0 / PointsPhi);\n    vector&lt;vector&lt;vector&lt;double&gt;&gt;&gt; Ampl;\n\n    // Setup\n    Pointers[0][0] = Real1;\n    Pointers[0][1] = Imag1;\n    Pointers[1][0] = Real2;\n    Pointers[1][1] = Imag2;\n    Pointers[2][0] = Real3;\n    Pointers[2][1] = Imag3;\n    Pointers[3][0] = Real4;\n    Pointers[3][1] = Imag4;\n    if (Real3 != nullptr &amp;&amp; Real4 != nullptr &amp;&amp; Imag3 != nullptr &amp;&amp; Imag4 != nullptr)\n    {\n        Ampl.resize(4, vector&lt;vector&lt;double&gt;&gt;(PointsTheta + 1, vector&lt;double&gt;(PointsPhi, 0)));\n        Real3 = nullptr; Imag3 = nullptr; Real4 = nullptr; Imag4 = nullptr;\n    }\n    else\n    {\n        Ampl.resize(2, vector&lt;vector&lt;double&gt;&gt;(PointsTheta + 1, vector&lt;double&gt;(PointsPhi, 0)));\n    }\n    Real1 = nullptr; Imag1 = nullptr; Real2 = nullptr; Imag2 = nullptr;\n\n    // Coordinates transformation + Maximum storage\n    Concurrency::parallel_for(0, PointsPhi, [&amp;](int j)\n    {\n\n        double PhiRad = j * DeltaPhi * Deg2Rad;\n        double CosPhi = cos(PhiRad);\n        double SinPhi = sin(PhiRad);\n        int ind;\n        pair&lt;double, double&gt; AmplCoCr;\n\n        for (int i = 0; i &lt;= PointsTheta; i++)\n        {\n\n            ind = j * (PointsTheta + 1) + i;\n\n            for (int k = 0; k &lt; static_cast&lt;int&gt;(Ampl.size()); k = k + 2)\n            {\n                AmplCoCr = AmplCalc(ind, Pointers[k][0], Pointers[k][1], Pointers[k + 1][0], Pointers[k + 1][1], CosPhi, SinPhi);\n                Ampl[k][i][j] = AmplCoCr.first;\n                Ampl[k + 1][i][j] = AmplCoCr.second;\n\n                if (Ampl[k][i][j] &gt; Max[k])\n                {\n                    Max[k] = Ampl[k][i][j];\n                    MaxPos[k][0] = i;\n                    MaxPos[k][1] = j;\n                }\n                if (Ampl[k + 1][i][j] &gt; Max[k + 1])\n                {\n                    Max[k + 1] = Ampl[k + 1][i][j];\n                    MaxPos[k + 1][0] = i;\n                    MaxPos[k + 1][1] = j;\n                }\n            }\n        }\n\n    });\n\n    double A = max(max(Max[0], Max[1]), max(Max[2], Max[3]));\n    if (A &gt; Max[1] &amp;&amp; A &gt; Max[2] &amp;&amp; A &gt; Max[3]) return 45;\n    else if (A &gt; Max[0] &amp;&amp; A &gt; Max[2] &amp;&amp; A &gt; Max[3]) return 135;\n    else if (A &gt; Max[0] &amp;&amp; A &gt; Max[1] &amp;&amp; A &gt; Max[3]) return 90;\n    return 0; // else if (A &gt; Max[0] &amp;&amp; A &gt; Max[1] &amp;&amp; A &gt; Max[2]) \n\n}\n\n\npair&lt;double, double&gt; AmplCalc(int index, float* RealCo, float* ImagCo, float* RealCr, float* ImagCr, double CosPhi, double SinPhi)\n{\n    double A, B;\n\n    const double RealCoij = static_cast&lt;double&gt;(RealCo[index]);\n    const double RealCrij = static_cast&lt;double&gt;(RealCr[index]);\n    const double ImagCoij = static_cast&lt;double&gt;(ImagCo[index]);\n    const double ImagCrij = static_cast&lt;double&gt;(ImagCr[index]);\n\n    A = RealCoij * CosPhi + RealCrij * SinPhi;\n    B = ImagCoij * CosPhi + ImagCrij * SinPhi;\n    double Co = 10 * log10(A * A + B * B);\n\n    A = (RealCoij * SinPhi * (-1) + RealCrij * CosPhi);\n    B = (ImagCoij * SinPhi * (-1) + ImagCrij * CosPhi);\n    double Cr = 10 * log10(A * A + B * B);\n\n    return make_pair(Co, Cr);\n}\n</code></pre>\n\n<p>which in the VBA environment is imported with:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Declare Function FindPolarization Lib \"EvalFunc.dll\" (ByVal PointsTheta As Long, ByVal PointsPhi As Long, ByRef RealLev1 As Single, ByRef ImagLev1 As Single = 0) As Long\n</code></pre>\n\n<p>and called in the code through:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim RealLev1() As Single, ImagLev1() As Single\nDim PolMax As Long, FFThetaPoints As Long, FFPhiPoints As Long\n\n' Arrays are filled here through a function that determines their dimensions and values\nFFThetaPoints = UBound(RealLev1, 1)\nFFPhiPoints = UBound(RealLev1, 2)\nPolMax = FindPolarization(FFThetaPoints, FFPhiPoints, RealLev1(0, 0), ImagLev1(0, 0))\n</code></pre>\n\n<p>This works on VBA, but I've been trying to translate it into VB.NET and failed miserably.</p>\n\n<p>Provided that <strong>I can't change the C++ code inside the dll</strong>, I have stopped at  the following code.<br>\nThe import of the function looks like:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> &lt;DllImport(\"myDll.dll\", SetLastError:=True, CharSet:=CharSet.Unicode, CallingConvention:=CallingConvention.StdCall)&gt; _\n\nPublic Shared Function FindPolarization(ByVal PointsTheta As Integer, ByVal PointsPhi As Integer, ByRef RealLev1 As Single, _\nOptional ByRef ImagLev1 As Single = Nothing) As Integer\nEnd Function\n</code></pre>\n\n<p>And the code calling it would be:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim FFThetaPoints As Integer, FFPhiPoints As Integer, PolMax As Integer\nDim RealLev1(,) As Single = Array.CreateInstance(GetType(Single), 1, 1)\nDim ImagLev1(,) As Single = Array.CreateInstance(GetType(Single), 1, 1)\n\nFFThetaPoints = UBound(RealLev1, 1)\nFFPhiPoints = UBound(RealLev1, 2)\nPolMax = ImportDll.FindPolarization(FFThetaPoints, FFPhiPoints, RealLev1(0, 0), ImagLev1(0, 0))\n</code></pre>\n\n<p>Now, those array are <code>System.Array</code> type because of a particular function that requires them to be so. </p>\n\n<p>While in VBA I get some result, in VB.NET I obtain other ones. I think this has something to do with how I declare the <code>Single</code> arrays, but I am not sure.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1516787913, "post_id": 48418980, "comment_id": 83828702, "body": "Sheet14.Range(&quot;Automation&quot;) looks strange try Sheet(&quot;Your sheet name&quot;).Range(&quot;Automation&quot;)"}, {"owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1516788303, "post_id": 48418980, "comment_id": 83828959, "body": "Tried it, still the same error, I think it has something to do with how I am calling the function, maybe a syntax error. Not sure"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1516789487, "post_id": 48418980, "comment_id": 83829743, "body": "Your GetMap refers to first column and GetRow to second column. If you try firstly use GetRow and then GetMap it will probably work. Please try: <code>initial = GetRow(GetMap(wkb.Sheets(SourceName)))</code>"}, {"owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1516790258, "post_id": 48418980, "comment_id": 83830261, "body": "Hi Tom, tried that as well. Still the same error: &#39;Run-time error &#39;438&#39; Object doesn&#39;t support this Property or method&#39;"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1516790481, "post_id": 48418980, "comment_id": 83830392, "body": "I have recreated your code and it worked for me (with the abovementioned change). Are sure that <code>wkb.Sheets(SourceName)</code> returns proper string?"}, {"owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1516790726, "post_id": 48418980, "comment_id": 83830541, "body": "when I click on Debug and then on SourceName within the parenthesis, it shows my source sheet name, the source and destination workbooks are different, if I haven&#39;t mentioned this earlier. SourceName is the sheet name in my source workbook and DestName is my current sheet where I need the data."}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1516791261, "post_id": 48418980, "comment_id": 83830862, "body": "Ok but you are feeding your function with an object (<code>wkb.Sheets(SourceName)</code>) instead of string. Replace for testing purposes <code>wkb.Sheets(SourceName)</code> with <code>&quot;MCLU&quot;</code>"}, {"owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1516792462, "post_id": 48418980, "comment_id": 83831641, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/163787/discussion-between-shettyrish-and-tomjohnriddle\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "is_accepted": false, "score": 0, "last_activity_date": 1516822676, "creation_date": 1516822676, "answer_id": 48430365, "question_id": 48418980, "link": "https://stackoverflow.com/questions/48418980/row-header-mapping-to-paste-data/48430365#48430365", "title": "Row header mapping to paste data", "body": "<p>So after a lot of trial and error and help from @tomjohnriddle, here is the function and the correct code:</p>\n\n<p>1) Function:</p>\n\n<pre><code> Function GetSourceKey(destinationKey As String) As String\n Dim refRange As Range: Set refRange = Sheet14.Range(\"Mapping table name\")\n On Error GoTo errProc\n GetSourceKey = WorksheetFunction.VLookup(destinationKey, \n ThisWorkbook.Sheets(\"Sheet name in which mapping table is present\").[Mapping table name], 2, 0)\n\nExit Function\n\nerrProc:\n If Err.Number = 1004 Then\n Err.Raise \"5000\", \"Something bad happened\", \"Value \" &amp; destinationKey &amp; \" \n not found!!\"\n Else\n Err.Raise Err.Number, Err.Source, Err.Description\n  End If\n\n  End Function\n</code></pre>\n\n<p>2) Code :</p>\n\n<pre><code>   Option Explicit\n\n   Sub CopyRange(fromRange As Range, toRange As Range, completed As Double)\n   fromRange.Copy\n   toRange.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, \n   SkipBlanks:=False, Transpose:=False\n\n   Application.StatusBar = \"Copying In progress...\" &amp; Round(completed, 0) &amp; \"% \n   completed\"\n   DoEvents\n    End Sub\n\n    Sub Header()\n\n    DestName = \"x\"    'Name of destination sheet\n    SourceName = \"y\"             'Name of Source sheet\n    MyDir = \"\\Path\\\"              'Default directory path\"\n    Const steps = 22              'Number of rows copied\n    ref = 13      'row in Estimate sheet in which 'Grand Total' is present\n\n    Set DestWb = ThisWorkbook            'Setting Destination workbook\n\n    Dim DestSheet As Worksheet\n    Dim SrcSheet As Worksheet\n\n\n    ' disable certain excel features to speed up the process    \n\n    Application.DisplayAlerts = False\n    'Application.EnableEvents = False\n    ActiveSheet.DisplayPageBreaks = False\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n\n        MyFile = Dir(MyDir &amp; \"Estimate*.xls*\")    'change file extension\n        ChDir MyDir\n\n        Set SrcWb = Workbooks.Open(MyDir + MyFile, UpdateLinks:=0)\n\n        completed = 0\n        Application.StatusBar = \"Copying In progress...\" &amp; Round(completed, \n        0) &amp; \"% completed\"\n\n\n        'Find the last non-blank cell in row ref\n        lnCol = SrcWb.Sheets(SourceName).Cells(ref, \n        Columns.Count).End(xlToLeft).Column\n\n        last = lnCol - 1                        'To get penultimate column\n\n\n        Set DestSheet = DestWb.Sheets(DestName)\n        Set SrcSheet = SrcWb.Sheets(SourceName)\n\n        destTotalRows = DestSheet.Cells(Rows.Count, 1).End(xlUp).Row            'Finding last non-blank cell in Column 1 in Destination sheet\n        MsgBox \"Last row is: \" &amp; destTotalRows\n\n\n        For i = 1 To destTotalRows\n\n            destKey = DestSheet.Cells(i, 1)\n            If destKey = \"\" Then GoTo endFor\n\n            sourceKey = GetSourceKey(destKey)\n            If sourceKey = \"\" Then GoTo endFor\n\n            Debug.Print \"DestKey\", destKey, \"SourceKey\", sourceKey\n\n            k = DestSheet.Cells(1, 1).EntireColumn.Find(What:=destKey, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False).Row\n            j = SrcSheet.Cells(1, 2).EntireColumn.Find(What:=sourceKey, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False).Row\n\n            Debug.Print j, k\n\n            Call CopyRange(SrcSheet.Range(Cells(j, 3), Cells(j, 3).End(xlToRight)), DestSheet.Cells(k, 2), completed)\n            completed = completed + (100 / steps)\n   endFor:\n        Next i\n\n        SrcWb.Close\n\n\n        Application.StatusBar = \"Copying is complete\"\n\n\n  DoEvents\n\n  MyFile = Dir()\n\n    Dim x As Long\n    'Find the last non-blank cell in row 1\n        DestColCount = Cells(1, Columns.Count).End(xlToLeft).Column\n\n        DestWb.Sheets(DestName).Columns(2).Copy\n            For x = 3 To DestColCount\n                Columns(x).PasteSpecial Paste:=xlPasteFormats\n            Next\n\n\n   'Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    'Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    ActiveSheet.DisplayPageBreaks = True\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516822676, "creation_date": 1516786277, "last_edit_date": 1516792439, "question_id": 48418980, "link": "https://stackoverflow.com/questions/48418980/row-header-mapping-to-paste-data", "title": "Row header mapping to paste data", "body": "<p>I have attached the image of my mapping table and written these two functions referring to the mapping table that I created : (Table name is \"Automation\")</p>\n\n<p>1) </p>\n\n<pre><code>Function GetRow(rowName As String) As String\nDim refRange As Range: Set refRange = Sheet14.Range(\"Automation\")\nOn Error GoTo errProc\nGetRow = WorksheetFunction.VLookup(rowName, refRange, 2, 0)\n\n\nExit Function\n\n\nerrProc:\nIf Err.Number = 1004 Then\nErr.Raise \"5000\", \"Something bad happened\", \"Value \" &amp; rowName &amp; \" not \nfound!!\"\nElse\nErr.Raise Err.Number, Err.Source, Err.Description\nEnd If\n\n\nEnd Function\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>Function GetMap(rowName As String) As String\nDim refRange As Range: Set refRange = Sheet14.Range(\"Automation\")\nOn Error GoTo errProc\nGetMap = WorksheetFunction.VLookup(rowName, refRange, 1, 0)\n\nExit Function\n\nerrProc:\nIf Err.Number = 1004 Then\nErr.Raise \"5000\", \"Something bad happened\", \"Value \" &amp; rowName &amp; \" not \nfound!!\"\nElse\nErr.Raise Err.Number, Err.Source, Err.Description\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>And this is the entire updated code :</p>\n\n<pre><code>Sub CopyRange(fromRange As Range, toRange As Range, completed As Double)\nfromRange.Copy\ntoRange.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, \nSkipBlanks:=False, Transpose:=False\n\nApplication.StatusBar = \"Copying In progress...\" &amp; Round(completed, 0) &amp; \"% \ncompleted\"\nDoEvents\nEnd Sub\n\nSub Header()\n\n\nDestName = \"Data Cost Estimate\"              'Name of destination sheet\nSourceName = \"EST Actuals\"                   'Name of Source sheet                                              \nMyDir = \"\\Path\\\"            'Default directory path\"\nConst steps = 22            'Number of rows copied\nref = 13              'row in Estimate sheet in which 'Grand Total' is \npresent\n\nSet Wb = ThisWorkbook\n\n' disable certain excel features to speed up the process\n\n\nApplication.DisplayAlerts = False\n'Application.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\nApplication.Calculation = xlCalculationManual\n\nMyFile = Dir(MyDir &amp; \"Estimate.xlsm\")    'change file extension\nChDir MyDir\n\nSet wkb = Workbooks.Open(MyDir + MyFile, UpdateLinks:=0)\n\nDim lnCol As Long\nDim last As Long  'Find the last non-blank cell in row 1\nlnCol = wkb.Sheets(SourceName).Cells(ref, \nColumns.Count).End(xlToLeft).Column\n\nlast = lnCol - 1\nMsgBox \"Last but one column is: \" &amp; last\n\nDim from, dest As String\nfrom = GetRow(GetMap(wkb.Sheets(SourceName)))         \nj = Wb.Sheets(DestName).Cells(1, 1).EntireColumn.Find(What:=from, \nLookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, \nSearchDirection:=xlNext, MatchCase:=False).Row\n\n\nCall CopyRange(Sheets(SourceName).Range(\"C18:R18\"), \n Wb.Sheets(DestName).Cells(j, 2), completed)\ncompleted = completed + (100 / steps)\n\nCall CopyRange(Sheets(SourceName).Range(\"C20:R20\"), \n Wb.Sheets(DestName).Cells(j, 2), completed)\ncompleted = completed + (100 / steps)\n\nCall CopyRange(Sheets(SourceName).Range(\"C27:R27\"), \nWb.Sheets(DestName).Cells(j, 2), completed)\ncompleted = completed + (100 / steps)\n\nwkb.Close\n\n MyFile = Dir()\n\n 'Application.ScreenUpdating = True\n Application.DisplayAlerts = True\n 'Application.EnableEvents = True\n Application.Calculation = xlCalculationAutomatic\n ActiveSheet.DisplayPageBreaks = True\n</code></pre>\n\n<p>When I try the code, I get an error saying \"Object doesn't support this property\" for the part where I want the function to return a value. I can't figure out how to correct this. CopyRange is another sub that I use for my Progress bar.<a href=\"https://i.stack.imgur.com/QjL9u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QjL9u.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516786264, "post_id": 48418859, "comment_id": 83827651, "body": "Create an array of filenames first, <b>then</b> use your <code>check_existence</code> function on each of the elements of the array.  (You can&#39;t perform one <code>Dir</code> within another <code>Dir</code> - only the latest one&#39;s file specification is kept for use in the <code>myFile = Dir</code> statement which gets the next match.)  Otherwise, use the File Scripting Object."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9167318"}, "is_accepted": false, "score": 0, "last_activity_date": 1516787876, "creation_date": 1516787876, "answer_id": 48419504, "question_id": 48418859, "link": "https://stackoverflow.com/questions/48418859/checking-if-a-file-is-already-saved-in-a-different-folder/48419504#48419504", "title": "Checking if a file is already saved in a different folder", "body": "<p>You haven't created an array for looping the files from. Below is the code for checking file existance</p>\n\n<pre><code>Sub checkExistance()\n    'setup\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(\"Your Folder Path Here\")\n\n    'file\n    Dim myFile As String\n    Dim FileName As String\n    Dim FileExtension As String\n    FileName = \"Your File Name\"\n    FileExtension = \".xls\"\n    myFile = FileName &amp; FileExtension\n\n    'Loop through each file in folder\n    For Each objFile In objFolder.Files\n        If objFile.Name = Replace(myFile, \".xls\", \".xlsb\") Then\n            MsgBox objFile.Name &amp; \" Ci sta\"\n        Else\n            MsgBox objFile.Name &amp; \" Nun Ci sta\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1516788916, "creation_date": 1516788916, "answer_id": 48419882, "question_id": 48418859, "link": "https://stackoverflow.com/questions/48418859/checking-if-a-file-is-already-saved-in-a-different-folder/48419882#48419882", "title": "Checking if a file is already saved in a different folder", "body": "<p>There is a function on another answer <a href=\"https://stackoverflow.com/a/31428399/7446760\">HERE</a> that returns an array of files within a folder. If you grab that, you can get what you need with:</p>\n\n<pre><code>Dim myFile As Variant\nDim folder_containing_xls As String\nDim folder_containing_xlsb As String\n\nfolder_containing_xls = \"FOLDER PATH HERE\"\nfolder_containing_xlsb = Application.ActiveWorkbook.Path 'or \"OTHER OR SAME FOLDER PATH HERE\"\n\nIf Right(folder_containing_xls, 1) &lt;&gt; \"\\\" Then folder_containing_xls = folder_containing_xls &amp; \"\\\"\nIf Right(folder_containing_xlsb, 1) &lt;&gt; \"\\\" Then folder_containing_xlsb = folder_containing_xlsb &amp; \"\\\"\n\nFor Each myFile In listfiles(folder_containing_xls)\n    If myFile Like \"*.xls\" Then\n        If Dir(folder_containing_xlsb &amp; Replace(myFile, \".xls\", \".xlsb\")) &lt;&gt; \"\" Then\n            Debug.Print myFile &amp; \" is in the folder\"\n        Else\n            Debug.Print myFile &amp; \" is not in the folder\"\n        End If\n    End If\nNext\n</code></pre>\n\n<p>I couldn't work out if you were looking for both files to be in the same folder, or if they were in different folders, so I've built it to cope with either.</p>\n"}], "owner": {"reputation": 19, "user_id": 8053051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c8c76510f96a632421fe3b2533cd4db?s=128&d=identicon&r=PG&f=1", "display_name": "Donats", "link": "https://stackoverflow.com/users/8053051/donats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516802054, "creation_date": 1516785859, "last_edit_date": 1531164843, "question_id": 48418859, "link": "https://stackoverflow.com/questions/48418859/checking-if-a-file-is-already-saved-in-a-different-folder", "title": "Checking if a file is already saved in a different folder", "body": "<p>Dears I have this piece of code that checks if a file .xls in a target folder is already saved under format .xlsb in the ActiveWorkbook folder. this works properly for the first file but the loop stops after that and doesn't checks the remaining ones.  </p>\n\n<pre><code>myFile = Dir(myPath &amp; myExtension)\n\n'check if the file .xls is in the current folder in format .xlsb\nDo While myFile &lt;&gt; \"\"\n    If Dir(Application.ActiveWorkbook.Path &amp; \"\\\" &amp; Replace(myFile, \".xls\", \".xlsb\")) &lt;&gt; \"\" Then\n        Debug.Print myFile &amp; \" is in the folder\"\n    Else\n        Debug.Print myFile &amp; \" is not in the folder\"\n    End If\n\n'next file\nmyFile = Dir\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1516796100, "post_id": 48421058, "comment_id": 83833908, "body": "Unfortunately it doesn&#39;t proceed with renaming the file (no error message), I also tried switching the <code>Then GoTo Quit</code> to <code>Then Resume Next</code> after <code>vbOK</code> but it still doesn&#39;t work.  My variables are all over the place, as I use global variables across multiple modules, and I just copied this module and tried renaming the variables, but thank you for pointing it out!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1516796260, "post_id": 48421058, "comment_id": 83834000, "body": "did you debug the code step-by-step (running it with F8)? What happens? Also comment out <code>On Error GoTo Quit</code> to debug, otherwise you won&#39;t see any errors."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1516796927, "post_id": 48421058, "comment_id": 83834384, "body": "Yeah, it was a &quot;File Not Found&quot; error, was an issue with the date format in the filename. Now the code works perfectly! I left &#39;Then Resume Next&#39; in after <code>vbOK</code>, otherwise it would just jump to the <code>Quit:</code> line right? Thank you so much for the help either way."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1516800455, "post_id": 48421058, "comment_id": 83836695, "body": "@Rhyfelwr It will <code>GoTo Quit</code> only if the user presses <code>Cancel</code> or the <code>X</code> (see the <code>If NOT \u2026 = vbOK</code>) so if it is ok then the code continues to the next line. What you did <code>Then Resume Next</code> dosen&#39;t work."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1516800923, "post_id": 48421058, "comment_id": 83837012, "body": "Ah ok I see, so it&#39;s just error handling. Thought it was necessary to proceed for some reason.  Thanks for clarifying! (still learning you see)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1516801183, "post_id": 48421058, "comment_id": 83837170, "body": "@Rhyfelwr It is necessary for NOT to proceed (when user clicks something else than OK, like Cancel or X. So you can get out of this without throwing an error."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1516792247, "creation_date": 1516792247, "answer_id": 48421058, "question_id": 48418797, "link": "https://stackoverflow.com/questions/48418797/continue-running-the-code-after-folder-interaction/48421058#48421058", "title": "Continue running the code after folder interaction", "body": "<p>This is not possible without user interaction. I can imagine 2 possible solutions.</p>\n\n<ol>\n<li>User has to press a button for renaming which calls another sub for the renaming part.</li>\n<li>We let pop up a message box which halts the code until the user confirms that he unzipped the file.</li>\n</ol>\n\n<p>Here is the example for the second solution:</p>\n\n<pre><code>Option Explicit 'see note below\n\nPublic Sub Extract_Rename()\n    Dim FolderPath As String\n    Dim OldName As String\n    Dim NewName As String\n\n    OldName = \"REPORTS2xxxx.SCR0400.\" &amp; mGlobalDate &amp; \".txt\" 'define default file name\n    NewName = \"123456_GR_xxxx_ALL_xxxx_modules_\" &amp; mGlobalDate &amp; \".txt\" 'define new file name\n    FolderPath = \"C:\\Users\\\" 'define source folder path\n\n    Shell \"C:\\WINDOWS\\explorer.exe \"\"\" &amp; Foldername &amp; \"\", vbNormalFocus 'open source folder to extract the file from .zip archive\n\n    'this msgbox stops the code until the user presses OK\n    If Not MsgBox(\"Please unzip the file, when finished press OK to proceed.\", _\n      vbOKCancel + vbExclamation) = vbOK Then GoTo Quit\n\n    On Error GoTo Quit\n    Name \"C:\\Users\\\" &amp; OldName As \"C:\\Users\\\" &amp; NewName 'rename file\n\nQuit:\n\nEnd Sub\n</code></pre>\n\n<p>Note: You should use <code>Option Explicit</code>. Your variable <code>Foldername</code> is not declared but you probably meant to use <code>FolderPath</code> instead. If you use <code>Option Explicit</code> these issues cannot happen anymore.</p>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 48421058, "answer_count": 1, "score": 0, "last_activity_date": 1516802092, "creation_date": 1516785659, "last_edit_date": 1516802092, "question_id": 48418797, "link": "https://stackoverflow.com/questions/48418797/continue-running-the-code-after-folder-interaction", "title": "Continue running the code after folder interaction", "body": "<p>I  have a short procedure that renames a file before uploading it to our processing tool, unfortunately the file is in a password protected .zip file (we can't use the standard extraction, it's company policy that we must use SecureZip) so I need to extract it before the script can interact with it. I know how to open a folder with vba, but how would I go about continuing the code after I close the folder? I have the following code so far: </p>\n\n<pre><code>Sub Extract_Rename()\nDim FolderPath As String\nDim OldName As String\nDim NewName As String\n\nOldName = \"REPORTS2xxxx.SCR0400.\" &amp; mGlobalDate &amp; \".txt\" 'define default file name\nNewName = \"123456_GR_xxxx_ALL_xxxx_modules_\" &amp; mGlobalDate &amp; \".txt\" 'define new file name\nFolderPath = \"C:\\Users\\\" 'define source folder path\n\n    Shell \"C:\\WINDOWS\\explorer.exe \"\"\" &amp; Foldername &amp; \"\", vbNormalFocus 'open source folder to extract the file from .zip archive\n\n    On Error GoTo Quit\n\n        Name \"C:\\Users\\\" &amp; OldName As \"C:\\Users\\\" &amp; NewName 'rename file\n\nQuit:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1516784048, "post_id": 48418248, "comment_id": 83826181, "body": "You have to use the Set keyword while setting the range. Try it like <code>Set rng = Worksheets(&quot;Q Matrix&quot;).Range(Cells(i, 5), Cells(i, 8))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8730951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ikf8O.png?s=128&g=1", "display_name": "P.Schlegel", "link": "https://stackoverflow.com/users/8730951/p-schlegel"}, "edited": false, "score": 0, "creation_date": 1516784161, "post_id": 48418324, "comment_id": 83826265, "body": "I just tried, it works, the error reporting is gone, thanks a lot!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 1, "creation_date": 1516784380, "post_id": 48418324, "comment_id": 83826428, "body": "@MarcinSzaleniec Actually, you missed one - it needs to be <code>Set rng = Worksheets(&quot;Q Matrix&quot;).Range(Worksheets(&quot;Q Matrix&quot;).Cells(i, 5), Worksheets(&quot;Q Matrix&quot;).Cells(i, 8))</code>"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 53, "user_id": 8730951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ikf8O.png?s=128&g=1", "display_name": "P.Schlegel", "link": "https://stackoverflow.com/users/8730951/p-schlegel"}, "edited": false, "score": 0, "creation_date": 1516785390, "post_id": 48418324, "comment_id": 83827078, "body": "@P.Schlegel If it works, please consider marking it as answer to close the question. (Tick mark left of the question.) Also, take the <a href=\"https://stackoverflow.com/tour\">SO tour</a>."}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 0, "last_activity_date": 1516784041, "creation_date": 1516784041, "answer_id": 48418324, "question_id": 48418248, "link": "https://stackoverflow.com/questions/48418248/set-range-with-variables/48418324#48418324", "title": "Set range with variables", "body": "<p>You need to use the Set keyword to set the value of an object variable.:</p>\n\n<pre><code>set rng = Worksheets(\"Q Matrix\").Range(Cells(i, 5), Cells(i, 8))\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8730951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ikf8O.png?s=128&g=1", "display_name": "P.Schlegel", "link": "https://stackoverflow.com/users/8730951/p-schlegel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 48418324, "answer_count": 1, "score": 0, "last_activity_date": 1516784041, "creation_date": 1516783742, "last_edit_date": 1516783980, "question_id": 48418248, "link": "https://stackoverflow.com/questions/48418248/set-range-with-variables", "title": "Set range with variables", "body": "<p>I'm building a worksheet of qualified persons which search the each range in row (each row is a person, columns are different qualifications), to find out if the the range is empty, if not, the name of the person will be added into the list.</p>\n\n<p>The question is why <code>rng = Worksheets(\"Q Matrix\").Range(Cells(i, 5), Cells(i, 8))</code> is not taken by the program and reported as error 1004?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim rng As Range\nDim lastr As Long, lastr1 As Long\nDim i As Integer\n\nApplication.ScreenUpdating = False\n\nlastr = Worksheets(\"Auditorenliste\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\nlastr1 = Worksheets(\"Q Matrix\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n\nFor i = 6 To lastr1\nrng = Worksheets(\"Q Matrix\").Range(Cells(i, 5), Cells(i, 8)) 'range(\"E\" &amp; i &amp; \":G\" &amp; i)\n    If WorksheetFunction.CountA(rng) &gt; 0 Then\n    Worksheets(\"Auditorenliste\").Cells(lastr1, 2).Value = Worksheets(\"Q Matrix\").Cells(i, 2).Value\n    End If\nNext\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "web", "web-scraping"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1516780244, "post_id": 48417220, "comment_id": 83824205, "body": "Please <a href=\"https://stackoverflow.com/posts/48417220/edit\">edit</a> your original question and add the VBA code you already have. You might also read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> Then tell what is going wrong in your code and where you got errors or got stuck. Also don&#39;t post code as images, instead add the code formatted as code block. Other users cannot do anything with a code image. Also we might need to see a code example with at least 2 different <code>TitleName</code>s."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516780560, "post_id": 48417348, "comment_id": 83824363, "body": "I think this doesn&#39;t answer the question at all: How are you able to select a specific edit button by <code>class=&quot;title&quot;&gt;TitleName</code> here? This is only an example of how to loop through the buttons and find the edit button (which is just a small part of the original task). Also there are many edit buttons and this code always grabs the first one."}, {"owner": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "edited": false, "score": 0, "creation_date": 1516781004, "post_id": 48417348, "comment_id": 83824573, "body": "Yes, exactly. Thank you K.Davis for the code above, but it only selects the first edit button. I need a TitleName specific edit button, if you consider that there are many titles."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516781027, "post_id": 48417348, "comment_id": 83824581, "body": "I&#39;ll take a look at it"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "edited": false, "score": 0, "creation_date": 1516781234, "post_id": 48417348, "comment_id": 83824662, "body": "@Shiwers it&#39;s almost impossible to answer that question without seeing the <b>continuous</b> HTML code that contains at least 2 different <code>class=&quot;title&quot;&gt;TitleName</code>. Please add this <b>to your original question</b> as code not as image. Also add the VBA code you already tired."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "edited": false, "score": 0, "creation_date": 1516781540, "post_id": 48417348, "comment_id": 83824816, "body": "@Shiwers see if that works. If not, more html code will need to be provided."}, {"owner": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "edited": false, "score": 0, "creation_date": 1516782264, "post_id": 48417348, "comment_id": 83825210, "body": "@K.D\u1d00\u1d20\u026as it seems like it might work, however, if i try to call the sub, error  &quot;wrong number of arguments or invalid property assignment&quot; appears and .tagName(&quot;p&quot;) is highlighted... what may be causing this?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "edited": false, "score": 1, "creation_date": 1516782502, "post_id": 48417348, "comment_id": 83825313, "body": "@Shiwers updated it. Maybe there is another class name <code>content</code> that doesn&#39;t contain a tag of <code>p</code>. Also changed it to <code>getElements...</code> rather than using that property (I tried to set a property as an object - which is not allowed)."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1516782415, "last_edit_date": 1516782415, "creation_date": 1516780397, "answer_id": 48417348, "question_id": 48417220, "link": "https://stackoverflow.com/questions/48417220/access-class-inside-a-class/48417348#48417348", "title": "Access Class inside a Class", "body": "<p>This should work for you.</p>\n\n<p>Grab the collection of the tagName of <code>button</code>, then iterate through them until you find the one with your className of <code>edit</code>.</p>\n\n<p>Code:</p>\n\n<pre><code>Sub pressBtn()\n\n    'your html declarations &amp; navigation\n\n    'Grab the content class that contains your titlename\n    Dim contentClassColl As Object, contentClass As Object\n    Set contentClassColl = ie.document.getElementsByClassName(\"content\")\n\n    Dim TitleName As String, pColl As Object, p As Object, exitFlag As Boolean\n    TitleName = \"YourTitleNameHere\"\n\n    'Grab the correct class by looking at each tagname within the class for your title\n    For Each contentClass In contentClassColl\n        On Error Resume Next 'in case there are no tag name 'P' in class\n        Set pColl = contentClass.getElementsByTagName(\"p\")\n        For Each p In pColl\n            If p.innerHTML Like \"*\" &amp; TitleName &amp; \"*\" Then\n                exitFlag = True\n                Exit For\n            End If\n        Next p\n        On Error GoTo 0\n        If exitFlag = True Then Exit For\n    Next contentClass\n\n    Dim btnColl As IHTMLElementCollection, btn As IHTMLElement\n    Set btnColl = contentClass.getElementsByTagName(\"button\")\n    For Each btn In btnColl\n        If btn.className = \"edit\" Then\n            Exit For\n        End If\n    Next btn\n    btn.Click\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 48417348, "answer_count": 1, "score": 1, "last_activity_date": 1516802129, "creation_date": 1516779811, "last_edit_date": 1531164843, "question_id": 48417220, "link": "https://stackoverflow.com/questions/48417220/access-class-inside-a-class", "title": "Access Class inside a Class", "body": "<p>I'm trying to create a simple Excel VBA web scraping macro. At one point, I need the macro to click a button (in the enclosed image lower - <code>button class=\"edit\"</code>), which is inside a specific <code>class=\"title\"&gt;TitleName</code>. On the webpage, there are more than one <code>TitleName</code>, and I always need to go to a specific <code>TitleName</code> and click a <code>TitleName</code> specific edit button. </p>\n\n<p>Can someone please help with the macro? The HTML code is in the following image:\n<a href=\"https://i.stack.imgur.com/4ZNwR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4ZNwR.png\" alt=\"Html image\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "edited": false, "score": 0, "creation_date": 1516778863, "post_id": 48416909, "comment_id": 83823502, "body": "So what do you want to achieve? And what does not work? What is your question? When you want to hide a textbox you can simply change the <code>Visible</code> attribute to <code>False</code>"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1516780895, "post_id": 48416909, "comment_id": 83824529, "body": "You cannot hide control that you have focus on. And you have if you typed value into it."}, {"owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1516781659, "post_id": 48416909, "comment_id": 83824881, "body": "I want to hide text soon as I enter a value is entered in it. The current value displayed in the Textbox is 0. The  but the problem is, when users update the database, instead of adding say 1, they end up adding 10."}, {"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 2, "creation_date": 1516781797, "post_id": 48416909, "comment_id": 83824955, "body": "Use <code>TextBox.value = &quot;&quot;</code> to clear the textbox"}], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1516792575, "creation_date": 1516792575, "answer_id": 48421168, "question_id": 48416909, "link": "https://stackoverflow.com/questions/48416909/hiding-a-textbox-value/48421168#48421168", "title": "Hiding a TextBox value", "body": "<p>If you want to use the value again, store it temporarily in the control's <code>Tag</code> property and restore on <code>Exit</code>.</p>\n\n<pre><code>Private Sub TextBox_Enter()\n     With TextBox\n        .Tag = .Value\n        .Value = Null\n    End With\nEnd Sub\n</code></pre>\n\n<p>To restore it if the value is Null:</p>\n\n<pre><code>Private Sub TextBox_Exit(Cancel As Integer)\n     With TextBox\n        If IsNull(.Value) Then .Value = .Tag\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 48421168, "answer_count": 1, "score": 0, "last_activity_date": 1594638066, "creation_date": 1516778560, "last_edit_date": 1594638066, "question_id": 48416909, "link": "https://stackoverflow.com/questions/48416909/hiding-a-textbox-value", "title": "Hiding a TextBox value", "body": "<p>This is what I thought of.</p>\n\n<pre><code>Private Sub TextBox_Enter()\n     TextBox.value.Visible = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1516808646, "post_id": 48416594, "comment_id": 83842754, "body": "I don&#39;t understand why you&#39;re putting the text in the Clipboard, then pasting it into the document - it makes no sense. Why not write the text directly to the document? Most likely, the odd characters are coming from this process (from the DataObject), possibly from round-tripping the Chr(13)."}, {"owner": {"reputation": 53, "user_id": 6014422, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74871664cd7cbe2c1c43dd682d0d3a36?s=128&d=identicon&r=PG&f=1", "display_name": "s2016", "link": "https://stackoverflow.com/users/6014422/s2016"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1516810959, "post_id": 48416594, "comment_id": 83844505, "body": "No doubt you are correct when you say: &quot;write the text directly to the document?&quot;.  I&#39;m not a VBA expert.  Can you suggest the relevant code?  Thanks."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1516814289, "post_id": 48416594, "comment_id": 83846740, "body": "Normally, StackOverflow isn&#39;t for &quot;tutorials&quot;, but learning to insert text correctly into Word is very important. You&#39;d have gotten a good start, though, if you&#39;d used the macro recorder while inserting and formatting content..."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6014422, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74871664cd7cbe2c1c43dd682d0d3a36?s=128&d=identicon&r=PG&f=1", "display_name": "s2016", "link": "https://stackoverflow.com/users/6014422/s2016"}, "edited": false, "score": 0, "creation_date": 1516816966, "post_id": 48428187, "comment_id": 83848324, "body": "Thanks for this code which works.  My &quot;More text&quot; is a long string (its multiple paragraphs of manually formatted text typically).  How would I set the &quot;More text&quot; to this?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 53, "user_id": 6014422, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74871664cd7cbe2c1c43dd682d0d3a36?s=128&d=identicon&r=PG&f=1", "display_name": "s2016", "link": "https://stackoverflow.com/users/6014422/s2016"}, "edited": false, "score": 0, "creation_date": 1516817808, "post_id": 48428187, "comment_id": 83848791, "body": "Use the EDIT link below your question in order to add more detail. You need to describe more exactly what you need to do - that&#39;s the only way you&#39;re going to get a useful answer... Based on just what you say here, you insert each bit that has a specific format, format it, then the next bit - until you have it all. There might be another way to bring in the text - in your question, tell us what the SOURCE is. Or would BuildingBlocks (look it up) help you?"}, {"owner": {"reputation": 53, "user_id": 6014422, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74871664cd7cbe2c1c43dd682d0d3a36?s=128&d=identicon&r=PG&f=1", "display_name": "s2016", "link": "https://stackoverflow.com/users/6014422/s2016"}, "edited": false, "score": 0, "creation_date": 1516820764, "post_id": 48428187, "comment_id": 83850302, "body": "Cindy, I\u2019ve added example \u201cMore Text\u201d to the OP.  (e.g. Normal style text with a few manually bolded words.  Multiple paragraphs).  My generated DOCX will have typically 50 styled parts."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 53, "user_id": 6014422, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74871664cd7cbe2c1c43dd682d0d3a36?s=128&d=identicon&r=PG&f=1", "display_name": "s2016", "link": "https://stackoverflow.com/users/6014422/s2016"}, "edited": false, "score": 0, "creation_date": 1516821997, "post_id": 48428187, "comment_id": 83850991, "body": "@s2016 where is this text coming from? Are you picking it up from a source, or do you just know this is what you need? Have you looked at the concept of BuildingBlocks, as I suggested?"}, {"owner": {"reputation": 53, "user_id": 6014422, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74871664cd7cbe2c1c43dd682d0d3a36?s=128&d=identicon&r=PG&f=1", "display_name": "s2016", "link": "https://stackoverflow.com/users/6014422/s2016"}, "edited": false, "score": 0, "creation_date": 1516824168, "post_id": 48428187, "comment_id": 83852272, "body": "The &quot;More Text&quot; is stored in the system clipboard (to retain rich text format).  Using an external program the process is: 1) set clipboard and its corresponding external style variable 2) run VBA 3) reset clipboard and its corresponding external style variable 4) run VBA again, etc....."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 53, "user_id": 6014422, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74871664cd7cbe2c1c43dd682d0d3a36?s=128&d=identicon&r=PG&f=1", "display_name": "s2016", "link": "https://stackoverflow.com/users/6014422/s2016"}, "edited": false, "score": 0, "creation_date": 1517055989, "post_id": 48428187, "comment_id": 83944738, "body": "@s2016 OK... if you use <code>rng.Paste</code> instead of setting the .Text = t does that work?"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1516814208, "creation_date": 1516814208, "answer_id": 48428187, "question_id": 48416594, "link": "https://stackoverflow.com/questions/48416594/getting-weird-box-characters-prefixed-postfixed-to-word-vba-generated-text/48428187#48428187", "title": "Getting weird &quot;box&quot; characters prefixed/postfixed to Word VBA-generated text", "body": "<p>It's usually best to use the Range object, something like as follows. The macro recorder uses the Selection object, which is less reliable and less efficient.</p>\n\n<p>I've used Word's Builtin styles constants, since you only use built-in styles in your question. You can find a list in the VB Editor object browser (F2) if you type wdStyle in the search box.</p>\n\n<pre><code>Sub WriteAndFormatTextToWord()\n  Dim doc As word.Document\n  Dim rng As word.Range\n  Dim newText As String\n\n  newText = \"Text to insert.\"\n\n  Set doc = ActiveDocument\n  Set rng = doc.content\n  InsertTextAndFormat newText &amp; vbCr, rng, wdStyleHeading1\n  newText = \"More text\"\n  InsertTextAndFormat newText &amp; vbCr, rng, wdStyleNormal\nEnd Sub\n\nSub InsertTextAndFormat(t As String, rng As word.Range, _\n                        styl As word.WdBuiltinStyle)\n  rng.Text = t\n  rng.Style = styl\n  rng.Collapse wdCollapseEnd\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6014422, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74871664cd7cbe2c1c43dd682d0d3a36?s=128&d=identicon&r=PG&f=1", "display_name": "s2016", "link": "https://stackoverflow.com/users/6014422/s2016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 48428187, "answer_count": 1, "score": 0, "last_activity_date": 1516820281, "creation_date": 1516777308, "last_edit_date": 1516820281, "question_id": 48416594, "link": "https://stackoverflow.com/questions/48416594/getting-weird-box-characters-prefixed-postfixed-to-word-vba-generated-text", "title": "Getting weird &quot;box&quot; characters prefixed/postfixed to Word VBA-generated text", "body": "<p>How do I get rid of the weird \"box\" characters that have appeared prefixed to the Word VBA-generated \"Heading 2\" style text (likewise the weird boxes added both before and after the \"Normal\" style text)?</p>\n\n<p>Screenshot of the Word DOCX is attached.\nIt shows 2 views of same DOCX.  One showing special characters and one without.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qhpyf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qhpyf.png\" alt=\"DOCX showing errors\"></a>\n<a href=\"https://i.stack.imgur.com/3STNO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3STNO.png\" alt=\"same DOCX with special chars showing\"></a></p>\n\n<pre><code>Public theStyle As String\nPublic OldContent As String\nPublic Normal As Style\nPublic head1 As Style\nPublic head2 As Style\n\nSub Build_DOCX()\n\nOldContent = \"Welcome to XYZ!\" &amp; Chr(13)\nOldContent = OldContent\ntheStyle = \"head1\"\nKM_Insert_Styled_Text_Use_Vars\n\nOldContent = \"Overview\" &amp; Chr(13)\ntheStyle = \"head2\"\nKM_Insert_Styled_Text_Use_Vars\n\nOldContent = \"When you compile your application\" &amp; Chr(13)\ntheStyle = \"normal\"\nKM_Insert_Styled_Text_Use_Vars\n\nEnd Sub\n\nSub KM_Insert_Styled_Text_Use_Vars()\n\nDebug.Print \"OldContent = \"; OldContent\nDebug.Print \"theStyle = \"; theStyle\n\nIf theStyle = \"normal\" Then\n    Clipboard_Paste_With_Style_Normal\nElseIf theStyle = \"head1\" Then\n    Clipboard_Paste_With_Style_Heading1\nElseIf theStyle = \"head2\" Then\n    Clipboard_Paste_With_Style_Heading2\nEnd If\n\nEnd Sub\n\nSub Clipboard_Paste_With_Style_Normal()\n    Dim MyRange As Object\n    Dim clipboard As MSForms.DataObject\n    Set clipboard = New MSForms.DataObject\n    clipboard.SetText OldContent\n    clipboard.PutInClipboard\n    Set MyRange = Selection.Range\n    Selection.Paste\n    MyRange.Collapse Direction:=wdCollapseStart\n    MyRange.Style = wdStyleNormal\nEnd Sub\n\nSub Clipboard_Paste_With_Style_Heading1()\n    Dim MyRange As Object\n    Dim clipboard As MSForms.DataObject\n    Set clipboard = New MSForms.DataObject\n    clipboard.SetText OldContent\n    clipboard.PutInClipboard\n    Set MyRange = Selection.Range\n    Selection.Paste\n    MyRange.Collapse Direction:=wdCollapseStart\n    MyRange.Style = wdStyleHeading1\nEnd Sub\n\nSub Clipboard_Paste_With_Style_Heading2()\n    Dim MyRange As Object\n    Dim clipboard As MSForms.DataObject\n    Set clipboard = New MSForms.DataObject\n    clipboard.SetText OldContent\n    clipboard.PutInClipboard\n    Set MyRange = Selection.Range\n    Selection.Paste\n    MyRange.Collapse Direction:=wdCollapseStart\n    MyRange.Style = wdStyleHeading2\nEnd Sub\n</code></pre>\n\n<p>Example of 1 Normal Text (\"More Text\" in Cindy's code) is in the image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qphVy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qphVy.png\" alt=\"Normal Text with some manually bolded words\"></a></p>\n"}, {"tags": ["sql", "vba", "excel", "ms-access-2013"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1516775382, "post_id": 48415694, "comment_id": 83821778, "body": "I don&#39;t understand.  <code>NAME2</code> is blank in both your <i>&quot;working&quot;</i> <i>*and</i> your <i>&quot;non-working&quot;</i> examples, and neither has the &quot;blanks being bottom&quot;.  Also, what does &quot;not working&quot; mean -- on which line of code do you get the error?  Please see &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;."}, {"owner": {"reputation": 193, "user_id": 3391693, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/89ff10741fcd628a6c587e60e04f86a4?s=128&d=identicon&r=PG&f=1", "display_name": "Durgaprasad", "link": "https://stackoverflow.com/users/3391693/durgaprasad"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1516776305, "post_id": 48415694, "comment_id": 83822192, "body": "In the first scenario, date present in the first row. so ms access considers the whole column as date and uploads without error. but in the second scenario date is blank in the first row and ms access considers the whole column as text and it throws me data type mismatch error while uploading JOINING_DATE FIELD into msaccess.   I am not sure, whether ms access considering the column data type based on the first row?"}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1516778983, "last_edit_date": 1516778983, "creation_date": 1516778656, "answer_id": 48416931, "question_id": 48415694, "link": "https://stackoverflow.com/questions/48415694/uploading-date-column-to-ms-access-from-excel-using-sql-vba/48416931#48416931", "title": "Uploading Date Column to ms access from excel using sql vba", "body": "<p>Developers often try to re-write functionality that's already built-in to Access (via either a UI or VBA functions), and as far as I can tell that's the case here.</p>\n\n<p>One line of code will handle your import, including flexibility with issues like you describe.</p>\n\n<p>This code:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, _\n    \"TBL_EXCEL_DATA\", \"C:\\tmp-xlimport.xlsm\", True, \"SHEET1!A:B\"\n</code></pre>\n\n<p>...worked fine for me, error-free, like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/A4jc1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A4jc1.png\" alt=\"example screen shot\"></a></p>\n\n<p>...and would replace all of your code except for deleting the existing records -- which, personally, I use the clean &amp; simple:</p>\n\n<pre><code>DoCmd.RunSQL (\"DELETE FROM TBL_EXCEL_DATA\")\n</code></pre>\n\n<p>...or to avoid the \"<strong><em>x</em> records will be deleted</strong>\" warning:</p>\n\n<pre><code>DoCmd.SetWarnings False\nDoCmd.RunSQL (\"DELETE FROM TBL_EXCEL_DATA\")\nDoCmd.SetWarnings True\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3391693, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/89ff10741fcd628a6c587e60e04f86a4?s=128&d=identicon&r=PG&f=1", "display_name": "Durgaprasad", "link": "https://stackoverflow.com/users/3391693/durgaprasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559930876, "creation_date": 1516773401, "last_edit_date": 1559930876, "question_id": 48415694, "link": "https://stackoverflow.com/questions/48415694/uploading-date-column-to-ms-access-from-excel-using-sql-vba", "title": "Uploading Date Column to ms access from excel using sql vba", "body": "<p>I am trying to upload all the columns in excel sheet to msaccess using sql with adodb. Everything works fine except the date columns where some of the rows will have blanks. Suppose If i wanted to upload 5 rows to ms access from excel sheet and any of the date column is blank in the first row, then its throwing me an data type mismatch error. but if i sort the date column in excel by rows with dates being top and blanks being bottom and if i try to upload, it uploads fine.</p>\n\n<p>So my concern is ms access considering the column datatype based on the first row value in excel, even though i declared as proper data type in ms access.</p>\n\n<p>Here is the code i am using </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Upload_Data_from_excel()\nSet cn = CreateObject(\"ADODB.Connection\")\ndbPath = ThisWorkbook.Path &amp; \"\\db.accdb\"\ndbWb = ThisWorkbook.FullName\ndbWs_shtname = \"SHEET1\"\ntbl_name = \"TBL_EXCEL_DATA\"\nscn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; dbPath &amp; \";Jet OLEDB:Database Password=123456\"\ncn.Open scn\n\n' Delete existing records\nssql = \"DELETE * FROM \" &amp; tbl_name\ncn.Execute ssql\n\ndsh = \"[\" &amp; dbWs_shtname &amp; \"$]\"\nssql = \"INSERT INTO \" &amp; tbl_name &amp; \" \"\nssql = ssql &amp; \"SELECT * FROM [Excel 8.0;HDR=YES;DATABASE=\" &amp; dbWb &amp; \"].\" &amp; dsh\ncn.Execute ssql\nSet cn = Nothing\nApplication.StatusBar = \"\"\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qCrQR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qCrQR.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>any support is much appreciated</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516772911, "post_id": 48415566, "comment_id": 83820773, "body": "There are much easier ways to find the last column in a worksheet."}, {"owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516773952, "post_id": 48415566, "comment_id": 83821165, "body": "As I said, any help would be appreciated, if you have an easier way could you please share it? Thank you @K.D\u1d00\u1d20\u026as"}, {"owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516774274, "post_id": 48415566, "comment_id": 83821292, "body": "I think this is what you meant :lCol = Cells(1, Columns.Count).End(xlToLeft).Column      MsgBox  &quot;Last Column: &quot; &amp; lCol"}, {"owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516775298, "post_id": 48415566, "comment_id": 83821750, "body": "I figured it out, thanks.   Dim CopyRng As Range             Set CopyRng = Wb.Sheets(DestName).Range(&quot;B1:B57&quot;)             CopyRng.Copy                              For j = 2 To lCol                                  Wb.Sheets(DestName).Cells(1, j).PasteSpecial xlPasteFormats                                      Next j"}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "is_accepted": false, "score": 2, "last_activity_date": 1516776776, "last_edit_date": 1516776776, "creation_date": 1516776005, "answer_id": 48416271, "question_id": 48415566, "link": "https://stackoverflow.com/questions/48415566/paste-column-format-only-through-iteration/48416271#48416271", "title": "Paste column format only through iteration", "body": "<p>This is the solution :</p>\n\n<pre><code>lCol = Cells(1, Columns.Count).End(xlToLeft).Column\nMsgBox \"Last Column: \" &amp; lCol\n\nDim x As Long \nColumns(2).Copy \nFor x = 3 To LastCol \n    Columns(x).PasteSpecial Paste:=xlPasteFormats \nNext \n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8860294, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a5956d756c2d5eeea420933bf1cf8ae7?s=128&d=identicon&r=PG&f=1", "display_name": "shettyrish", "link": "https://stackoverflow.com/users/8860294/shettyrish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516776776, "creation_date": 1516772735, "last_edit_date": 1516776749, "question_id": 48415566, "link": "https://stackoverflow.com/questions/48415566/paste-column-format-only-through-iteration", "title": "Paste column format only through iteration", "body": "<p>I have a code that copies data from one workbook to another. Now, the 2nd column in my destination workbook has a certain color format that I need to be applied till the last column with data in it.</p>\n\n<p>This is the code snippet to find the last non-empty column  :</p>\n\n<pre><code>Dim rLastCell As Range\nSet ws = ThisWorkbook.Sheets(DestName)\n\nSet rLastCell = ws.Cells.Find(What:=\"*\", After:=ws.Cells(1, 1), LookIn:=xlValues, _\nLookAt:= xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False)\n\nDim LastCol As Long        \nLastCol = rLastCell.Column      \nMsgBox LastCol\n</code></pre>\n\n<p>So, now I want to iterate and paste the format from the 2nd column to all the columns until <code>LastCol</code>. Any help would be appreciated.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516770950, "post_id": 48415179, "comment_id": 83820185, "body": "If using VBA, use the <code>Val</code> function (which will take everything prior to the first non-numeric character and return the value of the numbers)"}], "answers": [{"comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "reply_to_user": {"reputation": 5, "user_id": 8620753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f2807ce9cf3d6567c8676cdffdf9555d?s=128&d=identicon&r=PG", "display_name": "user8620753", "link": "https://stackoverflow.com/users/8620753/user8620753"}, "edited": false, "score": 0, "creation_date": 1516779412, "post_id": 48416170, "comment_id": 83823802, "body": "It probably comes from the &quot;;&quot; that are in your computer &quot;,&quot; I edited my answer, does it work now?"}], "tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": true, "score": 0, "last_activity_date": 1516779434, "last_edit_date": 1516779434, "creation_date": 1516775621, "answer_id": 48416170, "question_id": 48415179, "link": "https://stackoverflow.com/questions/48415179/how-to-separate-the-numbers-and-text-in-excel/48416170#48416170", "title": "how to separate the numbers and text in excel?", "body": "<p>If all of your texts start with an uppercase, then with a formula you could do it like this: </p>\n\n<pre><code>=MID(A2,MIN(FIND({\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"},A2&amp;\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\")),LEN(A2))\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8620753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f2807ce9cf3d6567c8676cdffdf9555d?s=128&d=identicon&r=PG", "display_name": "user8620753", "link": "https://stackoverflow.com/users/8620753/user8620753"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 48416170, "answer_count": 1, "score": -3, "last_activity_date": 1516779434, "creation_date": 1516770414, "last_edit_date": 1531161705, "question_id": 48415179, "link": "https://stackoverflow.com/questions/48415179/how-to-separate-the-numbers-and-text-in-excel", "title": "how to separate the numbers and text in excel?", "body": "<p>How could i separate the numbers that are on the left side of the text in excel?</p>\n\n<p><a href=\"https://i.stack.imgur.com/XRj5k.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XRj5k.jpg\" alt=\"Example\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516774567, "post_id": 48415175, "comment_id": 83821405, "body": "Can you load the first into a dictionary and then use that to populate the 2nd dimension of the array holding the second table? If Dept is not unique in table 1 you can simply add to existing value. Are these set up as proper excel tables (as you appear to be reading from sheets named tableX? If there is a repeat of the dept in table 2 do you want the number repeated? e.g. IT 20, IT 20? And will you be writing this back out to the sheet? If so, where will the numbers go? And you could do this simply with a VLOOKUP, any reason why not?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516774697, "post_id": 48415175, "comment_id": 83821465, "body": "Expressions such as  .Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row should be in a variable so save revisiting the sheet and avoid ReDim if possible as you are making copies of the array which is expensive."}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516774749, "post_id": 48415175, "comment_id": 83821488, "body": "@QHarr 1. These are not proper table, only add auto filter. 2. If there is a repeat of the dept in table 2 I want the number to be repeated. 3. Yes, the value will be right back to the sheets, under <b>Others Column</b>. 4. I did these because I will send the sheet using <code>.MailEnvelope</code>. These are temporatery sheets, they will be deleted after the mail is sent."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516774912, "post_id": 48415175, "comment_id": 83821574, "body": "Do you need the first two  ReDim ?"}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516774974, "post_id": 48415175, "comment_id": 83821594, "body": "@QHarr Yes, In case in the future there&#39;s increase in the department. Seems like I had alot of problems need to solve one by one..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516775128, "post_id": 48415175, "comment_id": 83821674, "body": "I would probably go with my first comment and use a dictionary to hold the values from sheet 1 (looping from start row to endrow adding to dictionary dept, count). Then read the second sheet into a 2D array. Simply loop the second array and use something like array2(x,2) = dict(array2(x,1)) to access and set the values."}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516775429, "post_id": 48415175, "comment_id": 83821810, "body": "@QHarr Thank you for showing the right direction! I would go and read the doc for dictionary, and continue from there."}], "answers": [{"comments": [{"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1516779491, "post_id": 48416313, "comment_id": 83823832, "body": "Hi, can you explain what does this mean <code>table1Arr = ws1.Range(&quot;A2:B&quot; &amp; lastRowT1).Value &#39;1 to 4, 1 to 2</code>? I only know that it is a 2D array"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 1, "creation_date": 1516781222, "post_id": 48416313, "comment_id": 83824656, "body": "This table1Arr = ws1.Range(&quot;A2:B&quot; &amp; lastRowT1).Value reads the range from sheet Table1 into an array (from first row under header to last row in column A). This creates the 2d array. The &#39;1 to 4 , 1 to 2 was just a comment showing what the resulting array dimensions are for the example you have i.e. 2 dimensions, the first is 1 to 4 and the second is 1 to 2, ie 4 rows, 2 columns. When reading in direct from worksheet to an array the base option is 1 not 0 i.e. the array starts at 1 not at 0."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1516861956, "last_edit_date": 1525816189, "creation_date": 1516776205, "answer_id": 48416313, "question_id": 48415175, "link": "https://stackoverflow.com/questions/48415175/compare-2-1-d-dynamic-array/48416313#48416313", "title": "Compare 2 1-D dynamic array", "body": "<p>Here is an example of what I was describing, you probably want some error handling in case a dept appears in sheet <code>Table2</code> that is not in <code>Table1</code>:</p>\n\n<pre><code>Public Sub getTable1()\n\n  Dim wb As Workbook\n  Dim ws1 As Worksheet\n  Dim ws2 As Worksheet\n\n  Set wb = ThisWorkbook\n  Set ws1 = wb.Worksheets(\"Table1\")\n  Set ws2 = wb.Worksheets(\"Table2\")\n\n  Dim lastRowT1 As Long\n  lastRowT1 = ws1.Cells(Rows.Count, \"A\").End(xlUp).Row 'find last row in column A of first sheet\n\n  Dim lastRowT2 As Long\n  lastRowT2 = ws2.Cells(Rows.Count, \"A\").End(xlUp).Row 'find last row in column A of second sheet\n\n  Dim table1Arr()\n  table1Arr = ws1.Range(\"A2:B\" &amp; lastRowT1).Value '1 to 4, 1 to 2  'read the range from A2:B to last used row in A e.g. A2:B6 into array creating a 2D array that starts at index 1. The table is now held in the array.\n\n  Dim table2Arr()\n  table2Arr = ws2.Range(\"A2:B\" &amp; lastRowT2).Value '1 to 3, 1 to 2 'read used range containing table 2 into an array.\n\n  Dim table1Dict As New Scripting.Dictionary 'required reference to MS Scripting Runtime\n\n  Dim i As Long\n\n  For i = LBound(table1Arr, 1) To UBound(table1Arr, 1) 'loop the first dimension of array 1 i.e. the depts.\n\n      If table1Dict.Exists(table1Arr(i, 1)) Then\n\n        table1Dict(table1Arr(i, 1)) = table1Dict(table1Arr(i, 1)) + table1Arr(i, 2)   'if dept exists as a key in the dict then add the number of people from array 1 (i.e. from table 1) to the existing value. This handles potentially repeating depts in table1.\n\n    Else\n\n       table1Dict.Add table1Arr(i, 1), table1Arr(i, 2) 'if dept not already in dict, add the dept as a key to the dict and the number of people as the value.\n\n    End If\n\n Next i\n\n For i = LBound(table2Arr, 1) To UBound(table2Arr, 1)  'next loop your table 2 array depts\n\n     table2Arr(i, 2) = table1Dict(table2Arr(i, 1))  'as department names are spelt the same across both tables you can use the table2 dept names as the key to retrieve the dictionary values for that dept in the dictionary i.e. from table1. Then simply assign that to the Others column i.e.  table2Arr(i, 2) \n\n Next i\n\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">Chip Pearson</a>'s article on working with arrays. From that article you can see how to write back out to Table2 sheet the second array:</p>\n\n<blockquote>\n  <p>Writing A Two Dimensional VBA Array To The Worksheet</p>\n  \n  <p>If you have a 2 dimensional array, you need to use Resize to resize\n  the destination range to the proper size. The first dimension is the\n  number of rows and the second dimension is the number of columns. The\n  code below illustrates writing an array (..table2Arr..) out to the worksheet\n  starting at cell (..A2..).</p>\n</blockquote>\n\n<pre><code>Dim Destination As Range\nSet Destination = ws2.Range(\"A2\")\nDestination.Resize(UBound(table2Arr, 1), UBound(table2Arr, 2)).Value = table2Arr\n</code></pre>\n"}], "owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 48416313, "answer_count": 1, "score": 2, "last_activity_date": 1517817855, "creation_date": 1516770390, "last_edit_date": 1517817855, "question_id": 48415175, "link": "https://stackoverflow.com/questions/48415175/compare-2-1-d-dynamic-array", "title": "Compare 2 1-D dynamic array", "body": "<p>I had 2 tables. The 1st table contains the department name and number of people, the other contains department name and some other information. I'm trying to copy the number of people from the 1st table to the 2nd table based on the department name.</p>\n\n<p>However, the size of the table are not equal as for the 2nd table, the department name can appear more than once or even not at all. </p>\n\n<p>Tables are from different worksheets.</p>\n\n<p><strong>Example of Table 1</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/t0lil.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t0lil.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Example of Table 2</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/41xRf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/41xRf.png\" alt=\"enter image description here\"></a></p>\n\n<p>I had successfully get the data from the column using dynamic array and pass between subs, but unable to compare when copy the value when match.</p>\n\n<p>My codes structure</p>\n\n<pre><code>Sub getTable1()\n\n    Dim dept, getNum As Variant\n    Dim i,x As Long\n    x = 0\n\n    ReDim dept(1 To 1)\n    ReDim getNum(1 To 1)\n\n    With ThisWorkbook.Sheets(\"Table1\")\n            For i= 1 To .Cells(Rows.Count, \"A\").End(xlUp).Row\n            x = x + 1\n            ReDim Preserve dept(1 To x)\n            ReDim Preserve getNum(1 To x)\n\n            dept(x) = .Cells(i, \"A\").Value\n            getNum(x) = .Cells(i, \"B\").Value\n\n            Next x\n    End With\n\n    For i = 1 to x\n        Call passValue(dept(i), getNum(i))\n    Next\n\nEnd Sub\n\nSub passValue(ByVal dept, getNum As Variant)\n\n    Dim target As Variant\n    ReDim target(1 To 1)\n\n    Dim i, cnt, rowCnt As Long\n    cnt = 0\n\n    With ThisWorkbook.Sheets(\"Table2\")\n    For i = 2 To .Cells(Rows.Count, \"D\").End(xlUp).Row\n\n                cnt = cnt + 1\n                ReDim Preserve target(1 To cnt)\n                target(cnt) = .Cells(i, \"D\").Value\n    Next i\n    End With\n\n    For i = 1 To cnt\n        If target(i) = dept Then ' If match print result\n            With ThisWorkbook.Sheets(\"Table2\")\n                For rowCnt = 2 To .Cells(Rows.Count, \"D\").End(xlUp).Row\n                .Cells(rowCnt, \"E\").Value = getNum ' Only print the last result\n                Next\n            End With\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1516778066, "post_id": 48415025, "comment_id": 83823071, "body": "Have a look at this: <a href=\"https://stackoverflow.com/questions/44965938/vba-creating-nested-class/44968814#44968814\" title=\"vba creating nested class\">stackoverflow.com/questions/44965938/vba-creating-nested-cla&zwnj;&#8203;ss/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 9260144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1895862c1503c150b1c266720e9011b?s=128&d=identicon&r=PG&f=1", "display_name": "Soggy", "link": "https://stackoverflow.com/users/9260144/soggy"}, "edited": false, "score": 0, "creation_date": 1516927325, "post_id": 48415738, "comment_id": 83901426, "body": "Thanks for the quick response, I&#39;ll try to work through what you have shown me and understand it better. But it sounds like this is exactly what I am after.  Thanks!"}, {"owner": {"reputation": 85, "user_id": 9260144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1895862c1503c150b1c266720e9011b?s=128&d=identicon&r=PG&f=1", "display_name": "Soggy", "link": "https://stackoverflow.com/users/9260144/soggy"}, "edited": false, "score": 0, "creation_date": 1516928998, "post_id": 48415738, "comment_id": 83901898, "body": "Turns out I&#39;m very confused. Is the main code you have provided within the class clsTeachers?  Are you able to explain to me the following lines of code? I&#39;m struggling to understand what is happening.  Private pTeachers as New Collection &#39; Debate: New in the declaration, or New in Class_Initialise?  Sub AddTeacher(NewTeacher as clsTeacher)  &#39; enforces type.      pTeachers.Add(NewTeacher) End Sub"}, {"owner": {"reputation": 85, "user_id": 9260144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1895862c1503c150b1c266720e9011b?s=128&d=identicon&r=PG&f=1", "display_name": "Soggy", "link": "https://stackoverflow.com/users/9260144/soggy"}, "edited": false, "score": 0, "creation_date": 1516932013, "post_id": 48415738, "comment_id": 83902624, "body": "I think, if I&#39;m not mistaken the Addteacher sub should require a variable input like a string? I.e. AddTeacher(NewTeacher as String). This works well, it requires me to make a collection for every property. Is it possible to set a collection item as a class?"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 85, "user_id": 9260144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1895862c1503c150b1c266720e9011b?s=128&d=identicon&r=PG&f=1", "display_name": "Soggy", "link": "https://stackoverflow.com/users/9260144/soggy"}, "edited": false, "score": 0, "creation_date": 1516939646, "post_id": 48415738, "comment_id": 83904214, "body": "@Soggy Yes: main code is illustrative of what can go in <code>clsTeachers</code>. <code>AddTeacher</code> in my example takes a object of <code>clsTeacher</code> (your code) - in other words you create a teacher and then add it to the collection. There are ways of getting <code>clsTeachers</code> to add a <code>clsTeacher</code> given a string input but I left that out in this simple example mainly because as classes get more complex, nested creation also gets more complex. Again, my code above was illustrative and you can create whatever methods you need in your class."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 1, "last_activity_date": 1516773587, "creation_date": 1516773587, "answer_id": 48415738, "question_id": 48415025, "link": "https://stackoverflow.com/questions/48415025/how-do-i-use-class-modules-to-set-up-parent-and-child-variables/48415738#48415738", "title": "How do I use class modules to set up parent and child variables?", "body": "<p>You can create a class (<code>clsTeachers</code>) which hides a collection of <code>clsTeacher</code>s. Below is a sample of some of the things that can be done - effectively adding to what a Collection can do.</p>\n\n<pre><code>Private pTeachers as New Collection ' Debate: New in the declaration, or New in Class_Initialise?\n\nProperty Get Count() as Long\n  Count = pTeachers\nEnd Property\n\nSub AddTeacher(NewTeacher as clsTeacher)  ' enforces type. \n    pTeachers.Add(NewTeacher)\nEnd Sub\n\nFunction SortTeachers1() as clsTeachers\nDim tNewTColl as clsTeachers\n    'some sort routine using the existing collection and adding in order to a new class\n    Set SortTeachers =  tNewColl\nEnd Function\n\nSub SortTeachers2()\nDim tNewColl as New Collection\n        'some sort routine using the existing collection and the new one\n    Set pTeachers = tNewColl\nEnd Sub\n\nSub PrintTeachers()\nDim tTchr as clsTeacher\n    For each tTchr in pTeachers\n        'valid print command or add to string for later printing\n    Next 'tTchr\nEnd Sub\n</code></pre>\n\n<p>The methods are only limited by your imagination. The one drawback I have found is no easy way to use this in a 'For Each' loop. The standard <code>For I = 1 to MyTeachers.Count</code> is a useful fallback - just not as neat. In the class you can have:</p>\n\n<pre><code>Property Get Teacher(Index as Long) as clsTeacher\n    'error check here to ensure Index exists\n    if tIndexValid then\n        Teacher = pTeachers(Index)\n    else\n        Teacher = Nothing 'or however you want to handle this\n    end if\nEnd Property\n</code></pre>\n\n<p>I have found this way of doing collections useful because you can do validation and tailored outputs hidden from the main code view. As you can see by the signatures, you can also enforce types (i.e. your chosen collection cannot have anything but Teachers in it).</p>\n\n<p>** some references for doing a for-each with custom collections:</p>\n\n<ul>\n<li><a href=\"https://www.mrexcel.com/forum/excel-questions/466141-use-custom-class-each-loop.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/466141-use-custom-class-each-loop.html</a></li>\n<li><a href=\"https://stackoverflow.com/questions/20194919/how-to-implement-custom-iterable-class-in-vba\">How to implement custom iterable class in VBA</a>\nwhich includes other links.</li>\n</ul>\n"}], "owner": {"reputation": 85, "user_id": 9260144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1895862c1503c150b1c266720e9011b?s=128&d=identicon&r=PG&f=1", "display_name": "Soggy", "link": "https://stackoverflow.com/users/9260144/soggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1516773587, "creation_date": 1516769466, "question_id": 48415025, "link": "https://stackoverflow.com/questions/48415025/how-do-i-use-class-modules-to-set-up-parent-and-child-variables", "title": "How do I use class modules to set up parent and child variables?", "body": "<p>First of all, excuse my explanation of my problem if I use incorrect terminology, I'm not experienced and self-taught.</p>\n\n<p>I am learning to use class modules to set up \"Objects\" to easier reference variables and to run common functions. The issue I'm having is that I can't find information on how to set up a class module which can act as a collection to make use of the add function inherent in a collection.</p>\n\n<p>For Example, I have my parent class module named clsSchool</p>\n\n<p>in this class module, I have defined an object so that I can set a \"child\" class, clsTeacher</p>\n\n<p>In my class module for clsTeacher, I have set a string variable Name. This is how my 2 class modules look.</p>\n\n<p><em>clsSchool</em></p>\n\n<pre><code>Public Student As Object\n</code></pre>\n\n<p><em>clsTeacher</em></p>\n\n<pre><code>Public Name as String\n</code></pre>\n\n<p>In my module I have</p>\n\n<p><em>modSchool</em></p>\n\n<pre><code>Set mySchool = New clsSchool\nSet mySchool.Teacher = New clsTeacher\n\nmySchool.Teacher.Name = \"Jim\"\n</code></pre>\n\n<p>At this point, my code is exactly what I want it is very easy to use the variable mySchool.Teacher.Name to recall \"Jim\", I can also use a while loop with mySchool.Teacher to recall various variables I have defined in my clsTeacher</p>\n\n<p>I problem is that I want to add multiple teachers without having to set multiple classes at the top of my code as the number of teachers can vary. I.e. the following does work but has limitations.</p>\n\n<p><em>modSchool</em></p>\n\n<pre><code>Set mySchool = New clsSchool\nSet mySchool.Teacher1 = New clsTeacher\nSet mySchool.Teacher2 = New clsTeacher\nSet mySchool.Teacher3 = New clsTeacher\n\nmySchool.Teacher1.Name = \"Jim\"\nmySchool.Teacher2.Name = \"Jack\"\nmySchool.Teacher3.Name = \"John\"\n</code></pre>\n\n<p>What I would like is something similar to how collections work. I.e. I want to find the total number of teachers (which varies) and create a for loop to create a new clsTeacher for each unique teacher. What I want is something like the following, but I'm stuck and I can't find any resources which help explain how to set up the following.</p>\n\n<p><em>modSchool</em></p>\n\n<pre><code>Set mySchool.Teacher = New clsTeacher\n\nn_teachers = 6\n\nfor i=1 to n_teachers\n    mySchool.Teacher(i).Name = Range(\"A1\").Offset(i,0)\nNext i\n</code></pre>\n\n<p>This way I can easily recall the name of teacher 1 or teacher 2 and use while/for loops to do so.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "edited": false, "score": 0, "creation_date": 1516767020, "post_id": 48414673, "comment_id": 83819174, "body": "Sorry, I should clarify that the code errors out on line 3 i.e. it doesn&#39;t clear contents..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1516767893, "post_id": 48414673, "comment_id": 83819383, "body": "Just remove <code>.Select</code> - there is no reason to have that there - just use <code>Sheets(&quot;2017 Forecast&quot;).Range(&quot;D5:D53&quot;).ClearContents</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516785240, "post_id": 48414673, "comment_id": 83826987, "body": "You mention &quot;row A&quot;.  Do you mean column A, or row 1?  Your code (once you fix the error of the <code>Select</code>) is looking at column A.  Is that what you want?  If it isn&#39;t, that might explain why, when you change your code to just look at cell A4, it doesn&#39;t work - because you have the &quot;Forecast&quot; in cell D1."}], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1516774761, "creation_date": 1516774761, "answer_id": 48415972, "question_id": 48414673, "link": "https://stackoverflow.com/questions/48414673/using-loop-to-clear-contents/48415972#48415972", "title": "Using Loop to Clear contents", "body": "<p>Maybe this works for you?</p>\n\n<pre><code>Option explicit\n\nSub Compare skies()\n\nDim k As long\nDim ValueRead as variant\n\nWith Sheets(\"2017 Forecast\")\nFor k = 1 To 13\n\nValueRead = .Cells(k, 1).Value\n\n' Slow, case insensitive string comparison '\nIf strcomp(ValueRead,\"Forecast\",vbtextcompare) = 0 Then\n    .Range(\"D5:D53\").ClearContents ' You want to clear the exact same range 13 times? '\nElseif strcomp(ValueRead,\"Actual\",vbtextcompare) &lt;&gt; 0 then\nMsgbox(\"VLOOKUP returned a value outside of Actual and Forecast\")\n\nEnd if\n\nNext k\nEnd with\n\nEnd sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1516775669, "creation_date": 1516775669, "answer_id": 48416186, "question_id": 48414673, "link": "https://stackoverflow.com/questions/48414673/using-loop-to-clear-contents/48416186#48416186", "title": "Using Loop to Clear contents", "body": "<p>There's no need to use <code>Select</code> before you use <code>ClearContents</code>.</p>\n\n<p>Also, try adding <code>UCase</code> to make sure you don't have any CAPITAL letter in the middle of your text.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Dim k As Integer\n\nWith ThisWorkbook.Sheets(\"2017 Forecast\")\n    For k = 1 To 13\n        If UCase(.Cells(k, 1).Value2) = \"FORECAST\" Then\n            .Range(\"D5:D53\").ClearContents\n        End If\n    Next k\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516775724, "creation_date": 1516766948, "last_edit_date": 1516775724, "question_id": 48414673, "link": "https://stackoverflow.com/questions/48414673/using-loop-to-clear-contents", "title": "Using Loop to Clear contents", "body": "<p>I've written the following code to check if values in row A equal to \"Forecast\" then <code>Range D5:D53</code> should have its contents cleared.</p>\n\n<p>Row 1 is a vlookup so there's a formula that derives \"Actual\" or \"Forecast\"</p>\n\n<pre><code>Dim k As Integer\n\nFor k = 1 To 13\n    If Sheets(\"2017 Forecast\").Cells(k, 1).Value = \"Forecast\" Then\n        Sheets(\"2017 Forecast\").Range(\"D5:D53\").Select.ClearContents\n    End If\nNext k\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516765939, "post_id": 48414471, "comment_id": 83818910, "body": "Are you sure you have no other code running after the posted code which is clearing the values from column M and N again?  Try putting a breakpoint on the <code>Cells(i, 8).Value = ...</code> line and see what the sheet looks like once you get there.  But be careful, your code is writing to whatever the active sheet is, so make sure you always switch back to that sheet (I assume it is meant to be the &quot;Stocks Strategy&quot; sheet that is active) prior to continuing execution."}, {"owner": {"reputation": 903, "user_id": 917151, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e165769d9d04f80c156f2b44ecdd7a50?s=128&d=identicon&r=PG", "display_name": "Ben Daggers", "link": "https://stackoverflow.com/users/917151/ben-daggers"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516766341, "post_id": 48414471, "comment_id": 83819009, "body": "I am sure that no other codes running. no other codes clearing the column M and N. I have added a break point and it really not writing what it suppose to input. I also have modified It to wsx.Cells(i, 13).Value = Sheets(wsx.Cells(i, 1).Value).Range(&quot;S1048576&quot;).End(xlUp).Value to make it specific. but I still get the same result. nothing is being written."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516767317, "post_id": 48414471, "comment_id": 83819237, "body": "Based on the screenshots, it is correctly doing the <code>wsx.Cells(i, 15).Value = ...</code> statement, so it is just the last and second-last values that is causing an issue, which is .... <b>weird</b>.  FWIW, I just created some dummy data and it worked OK for me."}, {"owner": {"reputation": 121, "user_id": 9086188, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/038d12c507d0067c56dc6ea8cd28330f?s=128&d=identicon&r=PG", "display_name": "AmBo", "link": "https://stackoverflow.com/users/9086188/ambo"}, "edited": false, "score": 0, "creation_date": 1516769147, "post_id": 48414471, "comment_id": 83819686, "body": "Isn&#39;t it just because of hidden columns ? The volume is in column (i,19) not (i,8) ? /// My bad.... looked too fast"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516769481, "post_id": 48414471, "comment_id": 83819783, "body": "You don&#39;t have any events active, do you? Such as <code>Worksheet_Change</code> or something along those lines? Regardless, it wouldn&#39;t hurt to disable events at the top of the procedure and see what happens."}, {"owner": {"reputation": 903, "user_id": 917151, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e165769d9d04f80c156f2b44ecdd7a50?s=128&d=identicon&r=PG", "display_name": "Ben Daggers", "link": "https://stackoverflow.com/users/917151/ben-daggers"}, "edited": false, "score": 0, "creation_date": 1516772385, "post_id": 48414471, "comment_id": 83820616, "body": "I am not sure why or how. but when I restarted my excel, everything worked properly. I didn&#39;t edit anything. :D not sure what happens. anyway, thank you every one who made an effort to take a look at my issue."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1516775926, "post_id": 48415380, "comment_id": 83822013, "body": "you are using <code>SourceSheet</code> getting the <code>lastrow</code> 2-4 rows before you actualy <code>Dim</code> it and <code>Set</code> it, this will result with a run-time error"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1516776589, "post_id": 48415380, "comment_id": 83822338, "body": "True, <code>SourceSheet</code> should have been <code>DestinationSheet</code>. Can&#39;t test as am on mobile."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1516776681, "post_id": 48415380, "comment_id": 83822384, "body": "So next time, at least mention in your answer that it&#39;s (UnTested)"}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 1, "last_activity_date": 1516776295, "last_edit_date": 1516776295, "creation_date": 1516771721, "answer_id": 48415380, "question_id": 48414471, "link": "https://stackoverflow.com/questions/48414471/vba-macro-loop-unable-to-copy-numbers-from-another-sheet/48415380#48415380", "title": "VBA Macro Loop unable to copy numbers from another sheet", "body": "<p>Nothing sticks out as being wrong in your code. In any case, does the below also not work for you?</p>\n\n<pre><code>    Option Explicit\n\n    Sub pback()\n\n    Dim i As long\nDim LastRow as long\n\n    Dim DestinationSheet As Worksheet \n    Set DestinationSheet = workSheets(\"Stocks Strategy\")\n\n    lastrow = DestinationSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\n    Dim SourceSheet as Worksheet\n    Dim LastCellInColumn as range\n\n    For i = 3 To lastrow \n\n    Set SourceSheet = worksheets(wsx.Cells(i, 1).Value)\n\n    With sourcesheet\n\n    'Close '\n    Set LastCellInColumn = .cells(.rows.count,\"E\").end(xlup)\n\n    If LastCellInColumn.row &gt; 2 then\n    DestinationSheet.Cells(i, 4).Value = LastCellInColumn.Value\n    DestinationSheet.Cells(i, 5).Value =  lastcellincolumn.offset(-1,0).Value\n    DestinationSheet.Cells(i, 6).Value = lastcellincolumn.Offset(-2, 0).Value\n\n    Else\n    Msgbox(\"Last cell on worksheet \" &amp; .name &amp; \" detected as being on row \" &amp; LastCellInColumn.row)\n    End if\n\n    'Volume - not sure why its not working'\n\n    Set LastCellInColumn = .cells(.rows.count,\"S\").end(xlup)\n\n    If LastCellInColumn.row &gt; 2 then\n    DestinationSheet.Cells(i, 13).Value = LastCellInColumn.Value\n    DestinationSheet.Cells(i, 14).Value = LastCellInColumn.Offset(-1, 0).Value\n    DestinationSheet.Cells(i, 15).Value = LastCellInColumn.Offset(-2, 0).Value\n\n    Else\n    Msgbox(\"Last cell on worksheet \" &amp; .name &amp; \" detected as being on row \" &amp; LastCellInColumn.row)\n    End if\n\n\n    'ADX'\n\n    Set LastCellInColumn = .cells(.rows.count,\"Q\").end(xlup)\n\n    If LastCellInColumn.row &gt; 2 then\n\n    DestinationSheet.Cells(i, 8).Value = LastCellInColumn.Value\n    DestinationSheet.Cells(i, 9).Value = LastCellInColumn.Offset(-1, 0).Value\n\n    DestinationSheet.Cells(i, 10).Value = LastCellInColumn.Offset(-2, 0).Value\n\n    Else\n    Msgbox(\"Last cell on worksheet \" &amp; .name &amp; \" detected as being on row \" &amp; LastCellInColumn.row)\n    End if\n\n    End with\n\n    Set Lastcellincolumn = nothing\n    Set Sourcesheet = nothing\n\n    Next i\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 903, "user_id": 917151, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e165769d9d04f80c156f2b44ecdd7a50?s=128&d=identicon&r=PG", "display_name": "Ben Daggers", "link": "https://stackoverflow.com/users/917151/ben-daggers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1516776295, "creation_date": 1516765211, "last_edit_date": 1516766454, "question_id": 48414471, "link": "https://stackoverflow.com/questions/48414471/vba-macro-loop-unable-to-copy-numbers-from-another-sheet", "title": "VBA Macro Loop unable to copy numbers from another sheet", "body": "<p>I have this For loop vba code wherein I have a summary sheet (Stock Strategy sheet) where it summarizes all the numbers I need from different sheets. </p>\n\n<p>I have grouped the codes that suppose to copy the numbers through comments for everyone's reference.</p>\n\n<p>Anyway, what seems to be not working is the \"VOLUME\" portion. The other two (ADX and Close) is working perfectly but the \"Volume\" is not. Which is weird because the code execution is the same with the other two.</p>\n\n<pre><code>Private Sub pback()\n\nDim i As Integer\nDim wsx As Worksheet\nlastrow = Sheets(\"Stocks Strategy\").Cells(Rows.Count, 1).End(xlUp).Row\n\nSet wsx = Sheets(\"Stocks Strategy\")\n\nFor i = 3 To lastrow\n\n'Close\nwsx.Cells(i, 4).Value = Sheets(wsx.Cells(i, 1).Value).Range(\"E1048576\").End(xlUp).Value\nwsx.Cells(i, 5).Value = Sheets(wsx.Cells(i, 1).Value).Range(\"E1048576\").End(xlUp).Offset(-1, 0).Value\nwsx.Cells(i, 6).Value = Sheets(wsx.Cells(i, 1).Value).Range(\"E1048576\").End(xlUp).Offset(-2, 0).Value\n\n\n'Volume - not sure why its not working\nwsx.Cells(i, 13).Value = Sheets(wsx.Cells(i, 1).Value).Range(\"S1048576\").End(xlUp).Value\nwsx.Cells(i, 14).Value = Sheets(wsx.Cells(i, 1).Value).Range(\"S1048576\").End(xlUp).Offset(-1, 0).Value\nwsx.Cells(i, 15).Value = Sheets(wsx.Cells(i, 1).Value).Range(\"S1048576\").End(xlUp).Offset(-2, 0).Value\n\n'ADX\nwsx.Cells(i, 8).Value = Sheets(wsx.Cells(i, 1).Value).Range(\"Q1048576\").End(xlUp).Value\nwsx.Cells(i, 9).Value = Sheets(wsx.Cells(i, 1).Value).Range(\"Q1048576\").End(xlUp).Offset(-1, 0).Value\nwsx.Cells(i, 10).Value = Sheets(wsx.Cells(i, 1).Value).Range(\"Q1048576\").End(xlUp).Offset(-2, 0).Value\n\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>Screenshots of my sheets:</p>\n\n<p><strong>Stocks Strategy</strong></p>\n\n<p><em>(Column A represents the Sheet Names where it will get the numbers \"Close\", \"ADX\" &amp; \"Volume\") )</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/rzpf0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rzpf0.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Sample Source Sheets</strong> <em>(sheets where Stocks Strategy will get the numbers)</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/kwpk3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kwpk3.jpg\" alt=\"image here\"></a></p>\n\n<p><strong>Just a note:</strong> All the sheets are in the same workbook.</p>\n\n<p>Would any one point out what's wrong? I would appreciate if anyone could also suggest a better way of coding this task?</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "edited": false, "score": 0, "creation_date": 1516763576, "post_id": 48414227, "comment_id": 83818343, "body": "Look into the <code>Range.Find</code> function.. you can then find the cell in your Name column that corresponds with the &quot;selected&quot; cell from which you can pull the row and thus target your increment/decrement/default routine."}, {"owner": {"reputation": 23, "user_id": 9078402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aecfe4cd9d16ad79001e709de6d4107?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9078402/alex"}, "reply_to_user": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "edited": false, "score": 0, "creation_date": 1516763761, "post_id": 48414227, "comment_id": 83818388, "body": "Will do. Thanks for the help!"}], "answers": [{"tags": [], "owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "is_accepted": false, "score": 0, "last_activity_date": 1516765482, "creation_date": 1516765482, "answer_id": 48414502, "question_id": 48414227, "link": "https://stackoverflow.com/questions/48414227/how-to-use-buttons-in-excel-to-edit-one-of-several-possible-cells/48414502#48414502", "title": "How to use buttons in Excel to edit one of several possible cells", "body": "<p>Assumptions:</p>\n\n<ol>\n<li>Selected cell text is in \"G3\"</li>\n<li>Won't be more than 34 names in the \"Name\" column</li>\n</ol>\n\n<p>Furthermore, we assume you assign the appropriate <code>Sub</code> to the buttons.</p>\n\n<pre><code>Sub IncrementButton_Click()\n    TakeAction \"Increment\"\nEnd Sub\nSub DecrementButton_Click()\n    TakeAction \"Decrement\"\nEnd Sub\nSub ResetButton_Click()\n    TakeAction \"Reset\"\nEnd Sub\n\nSub TakeAction(ByVal action As String)\n\n    Dim r As Integer\n    Dim foundCell As Range\n    Set foundCell = Range(\"a2\", \"a35\").Find(Cells(3, 7).Text)\n    If Not (foundCell Is Nothing) Then\n        r = foundCell.Row\n    Else\n        MsgBox \"Couldn't find the current selection.\"\n        Exit Sub\n    End If\n\n    Select Case LCase(action)\n        Case \"increment\"\n            Cells(r, 3) = Cells(r, 3) + 1\n        Case \"decrement\"\n            Cells(r, 3) = Cells(r, 3) - 1\n        Case \"reset\"\n            Cells(r, 3) = Cells(r, 2)\n    End Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9078402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aecfe4cd9d16ad79001e709de6d4107?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9078402/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516765482, "creation_date": 1516763413, "last_edit_date": 1516763704, "question_id": 48414227, "link": "https://stackoverflow.com/questions/48414227/how-to-use-buttons-in-excel-to-edit-one-of-several-possible-cells", "title": "How to use buttons in Excel to edit one of several possible cells", "body": "<p>I am working on an Excel 2016 document and I have a table of names and points, as well as a default value, formatted like this:</p>\n\n<pre><code>Name   Default   Points\nBill     50        10            Jim &lt;-- This is a cell outside of the table,\nJim      16        32                   that displays the name that is \"selected.\"\nSam       5         8\n</code></pre>\n\n<p>Currently, I have three buttons (one to increment the number in the Points column, one to decrement the number, and one to reset to the value in the Default column) set up for each name using this basic VBA code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Range(\"C3\").Value = Range(\"C3\").Value + 1   &lt;-- for the increment button\nEnd Sub\n                      [OR]\nPrivate Sub CommandButton2_Click()\n    Range(\"C3\").Value = Range(\"C3\").Value - 1   &lt;-- for the decrement button\nEnd Sub\n                      [OR]\nPrivate Sub CommandButton3_Click()\n    Range(\"C3\").Value = Range(\"B3\").Value       &lt;-- for the reset button\nEnd Sub\n</code></pre>\n\n<p>Is there a way to introduce just three buttons, and set them up so that each button could work for the point values of any one name from the list?</p>\n\n<p>For example, if I have Jim selected (like in the table example above), the button will recognize that Jim is selected, find the points value associated with Jim (32), and edit that value)?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1516766902, "post_id": 48413840, "comment_id": 83819144, "body": "What is your reason to check for &quot;yes&quot; in column 13?"}, {"owner": {"reputation": 83, "user_id": 9256962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa07c63e6732b121a31d30073bc92e56?s=128&d=identicon&r=PG", "display_name": "jnjustice", "link": "https://stackoverflow.com/users/9256962/jnjustice"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1516766994, "post_id": 48413840, "comment_id": 83819167, "body": "@GMalc59 I&#39;m sorry, that excerpt was from the link where I got the code. I adapted what I could and missed that part. I have removed it now."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 9256962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa07c63e6732b121a31d30073bc92e56?s=128&d=identicon&r=PG", "display_name": "jnjustice", "link": "https://stackoverflow.com/users/9256962/jnjustice"}, "edited": false, "score": 0, "creation_date": 1516802820, "post_id": 48415308, "comment_id": 83838294, "body": "The code you sent works without any issues but I&#39;m just trying to copy cells A through G from &quot;active&quot; to &quot;term&quot; not the entire row"}, {"owner": {"reputation": 83, "user_id": 9256962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa07c63e6732b121a31d30073bc92e56?s=128&d=identicon&r=PG", "display_name": "jnjustice", "link": "https://stackoverflow.com/users/9256962/jnjustice"}, "edited": false, "score": 0, "creation_date": 1516806425, "post_id": 48415308, "comment_id": 83841032, "body": "That works perfectly too. So I can process the termination fairly easily now. One of the spreadsheets I have after pasting the data there is a final column for termination date. I just need to add &quot;todays&quot; date at the end of the row I just pasted that data in (in a particular column)"}, {"owner": {"reputation": 83, "user_id": 9256962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa07c63e6732b121a31d30073bc92e56?s=128&d=identicon&r=PG", "display_name": "jnjustice", "link": "https://stackoverflow.com/users/9256962/jnjustice"}, "edited": false, "score": 0, "creation_date": 1529354870, "post_id": 48415308, "comment_id": 88834494, "body": "@k.davis now we&#39;ve actually got the columns split in the empDataArr and they don&#39;t match.   I&#39;m not sure how to copy the particular cells from empDataArr and paste them accordingly.   I&#39;m trying to copy cells A thru D of empDataArr and also what was E thru G and is now G thru I of empDataArr and paste them as A thru G on the term worksheet."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1516806814, "last_edit_date": 1516806814, "creation_date": 1516771323, "answer_id": 48415308, "question_id": 48413840, "link": "https://stackoverflow.com/questions/48413840/copy-partial-row-identified-by-id/48415308#48415308", "title": "Copy Partial Row Identified by ID", "body": "<p>I know this basically rewrote your code, but I added a few checks to ensure you want to delete your employee. I made the assumption that the employee's name is in column B, so if not you can change this line:</p>\n\n<pre><code>If MsgBox(\"Are you sure you want to terminate \" &amp; wsActive.Cells(rngEmployee.Row, _\n                2) &amp; \"?\", vbYesNo) Then\n</code></pre>\n\n<p>by replacing the <code>2</code> in the second row with whatever column number you would like. (or you can simply delete this check altogether).</p>\n\n<p>I also added minimal error handling.</p>\n\n<pre><code>Option Explicit\n\nConst Err_EmpNotFound = 1000\n\nPublic Function NextRow(ByVal ws As Worksheet, Optional ByVal col As Variant = 1) As Long\n    With ws\n        NextRow = .Cells(.Rows.Count, col).End(xlUp).Row + 1\n    End With\nEnd Function\n\nSub EmployeeTermination()\n    'On Error GoTo ErrHandler\n\n    Dim wsActive As Worksheet, wsTerm As Worksheet\n    Set wsActive = ThisWorkbook.Worksheets(\"Active\")\n    Set wsTerm = ThisWorkbook.Worksheets(\"Term\")\n\n    'Locate the employee\n    Dim rngEmployee As Range, sEmployeeID As String, empDataArr As Variant\n    sEmployeeID = Application.InputBox(\"Enter Employee ID\")\n    Set rngEmployee = wsActive.Range(\"A:A\").Find(sEmployeeID, Lookat:=xlWhole)\n    If rngEmployee Is Nothing Then\n        Err.Raise vbObjectError + Err_EmpNotFound, Description:=\"Employee Not Found\"\n    End If\n\n    'Prompt before termination (assume's employee's name is column 2 (col B)\n    If MsgBox(\"Are you sure you want to terminate \" &amp; wsActive.Cells(rngEmployee.Row, _\n            2) &amp; \"?\", vbYesNo) = vbNo Then\n        Exit Sub\n    End If\n    empDataArr = rngEmployee.Columns(\"A:G\").Value\n\n    'Delete the data\n    rngEmployee.EntireRow.Delete\n\n    'Add employee to termination sheet (and date column \"H\")\n    With wsTerm.Rows(NextRow(wsTerm))\n        .Columns(\"A:G\") = empDataArr\n        .Columns(\"H\") = Date\n    End With\n\n    'Notify user of completion\n    MsgBox \"Employee was successfully terminated!\"\n    Exit Sub\n\nErrHandler:\n    Dim errBox As Long\n    Select Case Err.Number - vbObjectError\n        Case Err_EmpNotFound\n            errBox = MsgBox(Err.Description, vbRetryCancel)\n            If errBox = vbRetry Then\n                Err.Clear\n                EmployeeTermination\n                End\n            End If\n        Case Else\n            MsgBox Err.Description, Title:=Err.Number\n    End Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 9256962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa07c63e6732b121a31d30073bc92e56?s=128&d=identicon&r=PG", "display_name": "jnjustice", "link": "https://stackoverflow.com/users/9256962/jnjustice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516806814, "creation_date": 1516760283, "last_edit_date": 1516797721, "question_id": 48413840, "link": "https://stackoverflow.com/questions/48413840/copy-partial-row-identified-by-id", "title": "Copy Partial Row Identified by ID", "body": "<p>I have two Excel sheets in a workbook that I am wanting to copy data between and I can't figure it out. I am trying to adapt the code from a prior answer <a href=\"https://stackoverflow.com/questions/37327727/excel-2010-vba-copy-row-to-another-sheet-exclude-previously-copied-based-on-id\">here</a> but I can't get it to function how I want. </p>\n\n<p>In short the two sheets are \"Active\" and \"Term\" for if an employee is active with the company or not. I am trying to get a pop-up when I run the macro to request entry of the employee ID. Once entered I want to find that unique ID in column A and then select a portion of the cells (cells A to G) in that row (of the unique value) then cut and paste it in the next empty row in the \"term\" sheet. Once that is done I want to delete the entire row from the active sheet.</p>\n\n<p>I've used the match function nested within an index function to reference the unique value and return data from the sheets and others but I can't figure out if those will somehow help and how to implement them. What I am asking may not be possible. I can record a macro but the values are static and would only work that one exact time. Thank you in advance.</p>\n\n<pre><code>Sub EmployeeTermination()\n    Dim x As Long\n    Dim iCol As Integer\n    Dim MaxRowList As Long\n    Dim S As String\n    Dim fVal As String\n    Dim fRange As Range\n\n\n    Set wssource = Worksheets(\"Active\")\n    Set wstarget = Worksheets(\"Term\")\n\n    iCol = 1\n    MaxRowList = wssource.Cells(Rows.Count, iCol).End(xlUp).Row\n\n    For x = MaxRowList To 1 Step -1\n        S = wssource.Cells()\n        If S = \"Yes\" Or S = \"yes\" Then\n\n            fVal = InputBox(Enter employee ID:)\n\n            Set fRange = wstarget.Columns(\"A:A\").Find(What:=fVal, LookIn:=xlFormulas, LookAt _\n                :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n                False, SearchFormat:=False)\n\n            If fRange Is Nothing Then\n\n                AfterLastTarget = wstarget.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n                wssource.Rows(x).Copy\n                wstarget.Rows(AfterLastTarget).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n            End If\n\n        End If\n    Next\n\n   Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1516760543, "post_id": 48413783, "comment_id": 83817680, "body": "By <i>put the macro button</i> on the row means manually moving the button with a mouse (or keyboard) to align with the row?"}, {"owner": {"reputation": 1, "user_id": 2924919, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000119301404/picture?type=large", "display_name": "Matthew Ocampo", "link": "https://stackoverflow.com/users/2924919/matthew-ocampo"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1516760835, "post_id": 48413783, "comment_id": 83817737, "body": "Actually Im in the process of learning how to turn a into a pseudo button, where in if i double click a specific cell, say cell B2, it runs the OpenFolder macro"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1516761134, "post_id": 48413783, "comment_id": 83817806, "body": "You can actually move the button in the row (or specific cell) you selected and then run the sub routine based on the cell by using <code>Worksheet Events</code>."}], "answers": [{"tags": [], "owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "is_accepted": false, "score": 0, "last_activity_date": 1516761052, "creation_date": 1516761052, "answer_id": 48413929, "question_id": 48413783, "link": "https://stackoverflow.com/questions/48413783/changing-target-cell-on-vba-excel/48413929#48413929", "title": "Changing target cell on VBA Excel", "body": "<p>You could create few <code>Subs</code> (one for each button) that would call your <code>Main Sub</code> (that's the code that you posted) and pass to it variable containing your cell variable. Like this:</p>\n\n<pre><code>Sub ButtonForRow1()\n    MainSub \"A1\"\nEnd Sub\n\nSub ButtonForRow2()\n    MainSub \"A2\"\nEnd Sub\n\nSub MainSub(TargetCell as String)\n    (...)\n    JobNumber = Right(Range(TargetCell), Len(Range(TargetCell)) - 3)\n    (...)\nEnd Sub\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1516764893, "last_edit_date": 1516764893, "creation_date": 1516764546, "answer_id": 48414373, "question_id": 48413783, "link": "https://stackoverflow.com/questions/48413783/changing-target-cell-on-vba-excel/48414373#48414373", "title": "Changing target cell on VBA Excel", "body": "<p>As commented, you can try something like this. Here are the things you need?</p>\n\n<ol>\n<li><em>Form Button</em> named <strong>Button 1</strong> (or any other name you want just make sure you assign it correctly in below code).</li>\n<li><p>Code to position your button every time you select a cell and then assign the action it will execute when clicked. Below code that goes in the <em>Sheet Module</em> (Sheet where you process your data) will do just that.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    On Error GoTo sureexit\n    Dim myButton As Shape, myAction As String\n\n    Application.EnableEvents = False\n    Set myButton = Me.Shapes(\"Button 1\") '/* used a form control button */\n\n    If Not Intersect(Target, Me.Range(\"B1:B10\")) Is Nothing Then\n        '/* target cell is on B1:B10, to get A1:A10 offset by -1 */\n        myAction = \"'OpenFolder(Evaluate(\"\"\" &amp; _\n                   Target.Offset(, -1).Address &amp; \"\"\"))'\"\n        '/* move the button to the selected cell */\n        With myButton\n            .Top = Target.Top\n            .Height = Target.Height\n            .Left = Target.Left\n            .Width = Target.Width\n            .OnAction = myAction\n            .TextFrame.Characters.Text = \"Follow\"\n            .Visible = msoCTrue\n        End With\n\n    Else\n        '/* hide button if selected cell is not between B1:B10 */\n        myButton.Visible = msoFalse\n    End If\n\nsureexit:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre></li>\n<li><p>Of course you need a procedure in the regular module that you will assign in your <em>Button 1</em> on the fly. Below is a simple procedure which expects 1 range argument.</p>\n\n<pre><code>Sub OpenFolder(r As Range)\n\n    MsgBox r.Address &amp; \": \" &amp; r.Value2\n\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>You can incorporate this with your procedure changing all <code>Range(\"A1\")</code> with the variable <code>r</code> which is passed every time the button is clicked. Hope this gets you going.</p>\n"}], "owner": {"reputation": 1, "user_id": 2924919, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000119301404/picture?type=large", "display_name": "Matthew Ocampo", "link": "https://stackoverflow.com/users/2924919/matthew-ocampo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1048, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516764893, "creation_date": 1516759717, "last_edit_date": 1516760377, "question_id": 48413783, "link": "https://stackoverflow.com/questions/48413783/changing-target-cell-on-vba-excel", "title": "Changing target cell on VBA Excel", "body": "<p>I'm just trying to figure out if there is a way to change the target cell to run the same code. This code basically opens a directory folder based on the cell <em>A1</em> but what I want to happen is add a macro button on the same row that uses the value of the cell on that row. (For example, this my code uses the data on <em>A1</em>, I want the code to do that same for <em>A2</em> if I put the macro button on row 2)</p>\n\n<pre><code>Sub OpenFolder()\n\n    Dim MyFolder As String\n    Dim JobNumber As String\n    Dim JobYearLeft As String\n    Dim JobYear As String\n    Dim FolderNumber As String\n    Dim i As Integer\n    Dim FirstFolder As String\n\n    JobNumber = Right(Range(\"A1\"), Len(Range(\"A1\")) - 3)\n    JobYearLeft = Right(Range(\"A1\"), Len(Range(\"A1\")) - 1)\n    JobYear = Left(JobYearLeft, Len(JobYearLeft) - 4)\n\n    i = CInt(JobNumber)\n\n    Select Case i\n        Case 0 To 500\n        FolderNumber = \"0001_0500\"\n            Case 500 To 1000\n            FolderNumber = \"0501_1000\"\n                Case 1000 To 1500\n                FolderNumber = \"1001_1500\"\n                    Case 1500 To 2000\n                    FolderNumber = \"1501_2000\"\n    End Select\n\n\n    If (JobYear = 17) Then\n        FirstFolder = \"M:\\2017\\\" &amp; FolderNumber &amp; \"\\\" '&amp; Range(\"A1\").Value &amp; \"*\" &amp; \"\\\"\n    Else\n        MyFolder = \"M:\\2016\\\" &amp; FolderNumber &amp; \"\\\" '&amp; Range(\"A1\").Value &amp; \"*\" &amp; \"\\\"\n    End If\n\n    If (JobYear = 17) Then\n        MyFolder = \"M:\\2017\\\" &amp; FolderNumber &amp; \"\\\" &amp; Range(\"A1\").Value &amp; \"*\" '&amp; \"\\\"\n    Else\n        MyFolder = \"M:\\2016\\\" &amp; FolderNumber &amp; \"\\\" &amp; Range(\"A1\").Value &amp; \"*\" '&amp; \"\\\"\n    End If\n\n    MyFolder = Replace(MyFolder, \" \", \"\")\n\n    Dim OpenThisFolder As String\n    Dim GoToFolder As String\n\n    MyFolder = Dir(MyFolder, vbDirectory)\n\n    GoToFolder = FirstFolder &amp; MyFolder &amp; \"\\\"\n    GoToFolder = Replace(GoToFolder, \" \", \"\")\n    ActiveWorkbook.FollowHyperlink GoToFolder\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "filter"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9259595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b909ff42d789920262332b9b4cf7fa74?s=128&d=identicon&r=PG&f=1", "display_name": "Vakovich", "link": "https://stackoverflow.com/users/9259595/vakovich"}, "edited": false, "score": 0, "creation_date": 1516762187, "post_id": 48413799, "comment_id": 83818041, "body": "Wow thank you! Worked like a charm. Can you give a simple explanation on how the code works? Most of it are new to me.  Also, if you have the time, how can I use the code above to find the last row?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 13, "user_id": 9259595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b909ff42d789920262332b9b4cf7fa74?s=128&d=identicon&r=PG&f=1", "display_name": "Vakovich", "link": "https://stackoverflow.com/users/9259595/vakovich"}, "edited": false, "score": 0, "creation_date": 1516762336, "post_id": 48413799, "comment_id": 83818072, "body": "<code>lr = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row</code> This line of code actually gets the last row (lr). Now, which part of it is not clear? Already provided comments to guide you on how to use it :)"}, {"owner": {"reputation": 13, "user_id": 9259595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b909ff42d789920262332b9b4cf7fa74?s=128&d=identicon&r=PG&f=1", "display_name": "Vakovich", "link": "https://stackoverflow.com/users/9259595/vakovich"}, "edited": false, "score": 0, "creation_date": 1516779218, "post_id": 48413799, "comment_id": 83823700, "body": "Hello sir. I&#39;ve made a more manual approach in getting to the bottom row. ActiveCell.Select ActiveCell.FormulaR1C1 = &quot;=RC[-1]&quot; ActiveCell.Select Selection.Copy ActiveCell.Offset(0, -1).Select Selection.End(xlDown).Select ActiveCell.Offset(0, 1).Select  Will continue on my next comment"}, {"owner": {"reputation": 13, "user_id": 9259595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b909ff42d789920262332b9b4cf7fa74?s=128&d=identicon&r=PG&f=1", "display_name": "Vakovich", "link": "https://stackoverflow.com/users/9259595/vakovich"}, "edited": false, "score": 0, "creation_date": 1516779225, "post_id": 48413799, "comment_id": 83823704, "body": "My next step involves getting back up to the uppermost row (minus the header, which is Cell AV1)  How do I make use of the code to make sure that every row is covered, when there are lots of cells with data/and are blank on the way up? (e.g. row 555 is blank, row 450 has data, row 240 is blank, etc) When I run it, nothing happens (and I&#39;m most definitely sure that I&#39;m doing something wrong). Tried analyzing for hours on why this is happening, but i just can&#39;t get it :/"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 13, "user_id": 9259595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b909ff42d789920262332b9b4cf7fa74?s=128&d=identicon&r=PG&f=1", "display_name": "Vakovich", "link": "https://stackoverflow.com/users/9259595/vakovich"}, "edited": false, "score": 0, "creation_date": 1516785185, "post_id": 48413799, "comment_id": 83826959, "body": "@Vakovich You can find a lot of <a href=\"https://stackoverflow.com/questions/42078473/last-used-cell-in-sheet\">examples</a> here. You can try either and post another question when you stumble on some issue."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1516759909, "creation_date": 1516759909, "answer_id": 48413799, "question_id": 48413423, "link": "https://stackoverflow.com/questions/48413423/filtering-dropdown-box-to-untick-current-month-then-tick-following-months/48413799#48413799", "title": "Filtering dropdown box to untick current month, then tick following months", "body": "<p>You got quite a lot of questions in a single post. But anyways, for your 1 &amp; 2, you can try something like below:</p>\n\n<pre><code>Sub ject()\n\n    Dim lr As Long\n    Dim myRange As Range, selMonth As String\n\n    '*/ Below selects 1 month ahead of current month\n    'to select 2 months ahead, add 2 on Month(Date) */\n    selMonth = Format(DateSerial(Year(Date), Month(Date) + 1, 1), _\n                      \"m/d/yyyy\")\n\n    With Sheet1 '/* change to your actual sheet */\n        .AutoFilterMode = False '/* reset all filters */\n        '/* reference last row to column A */\n        lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        Set myRange = .Range(\"A1:AY\" &amp; lr)\n        myRange.AutoFilter 36, \"&gt;=\" &amp; selMonth\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>For number 3, you can use the same routine as above to find the <em>last row</em> (and column) and then paste data there. You can also <a href=\"https://stackoverflow.com/questions/4872512/last-not-empty-cell-in-row-excel-vba\">check this out</a> to learn more about finding your destination ranges (cells).</p>\n"}], "owner": {"reputation": 13, "user_id": 9259595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b909ff42d789920262332b9b4cf7fa74?s=128&d=identicon&r=PG&f=1", "display_name": "Vakovich", "link": "https://stackoverflow.com/users/9259595/vakovich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 48413799, "answer_count": 1, "score": 1, "last_activity_date": 1516759909, "creation_date": 1516756635, "last_edit_date": 1516759416, "question_id": 48413423, "link": "https://stackoverflow.com/questions/48413423/filtering-dropdown-box-to-untick-current-month-then-tick-following-months", "title": "Filtering dropdown box to untick current month, then tick following months", "body": "<p>Good day all. I'm fairly new to VBA and I have certain questions at hand.\nI'm currently automating a report in my line of work, and most of it has to do with filtering data to show current month, next month onward, and the next 2 months onward.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>How do you filter a drop down box for it to un-tick the previous months, tick the next month (with respect to the current month), and to tick the following months ahead (without having to hard code that it would have to end at a certain month. Just coding it to available months ahead)? For example, my data is for November 2017. I would have to un-tick the previous months, including November, then tick December 2017 and the following months ahead</p>\n\n<p><strong>From recorded macro:</strong></p></li>\n</ol>\n\n<p>November as current month (manually filtered)</p>\n\n<pre><code>   ActiveSheet.Range(\"$A$1:$AY$18103\").AutoFilter Field:=37, Operator:= _\n        xlFilterValues, Criteria2:=Array(0, \"10/18/2018\", 1, \"12/28/2017\")\n</code></pre>\n\n<p>The current month code that I use in a different process. Can I incorporate this also?</p>\n\n<pre><code> ActiveSheet.Range(\"$A$1:$AY$18103\").AutoFilter Field:=36, Operator:=xlAnd, _\n    Criteria1:=\"&gt;\" &amp; Application.EoMonth(Now, -1), _\n    Criteria2:=\"&lt;=\" &amp; Application.EoMonth(Now, 0)\n</code></pre>\n\n<ol start=\"2\">\n<li><p>Similar to no.1, un-tick the previous months, tick the 2nd month from the current month, and to tick the following months ahead? (e.g. My data is for November 2017. I would have to un-tick the previous months, including November, then tick January 2018 and the following months ahead)</p></li>\n<li><p>One of the processes that I have to do is to copy the formula from the cell to the left, then paste it to the current cell. What I do is I copy the left cell first, then use <kbd>Ctrl+Down</kbd> to go to the bottom row. Then click the right button (to go back to the original column) then <kbd>Ctrl+Shift+Up</kbd> again to paste to the whole column. The code that I use is:</p>\n\n<pre><code>Range(Selection, Selection.End(xlUp)).Select\n</code></pre></li>\n</ol>\n\n<p>The problem is that there are certain cells in the original column that's already filled up with data (from my previous process) and I would have to at least write that code 4 times just for the cell to reach the uppermost cell. How do I code it so that it would reach the top (minus the row with the cell header) while taking note that these rows are filtered?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1516755105, "post_id": 48413202, "comment_id": 83816320, "body": "Why doesn&#39;t this work? <code>STARTCELL = &quot;A4&quot; : ENDCOLUMN = &quot;V&quot; : Set DatenBereich = .Range(STARTCELL &amp; &quot;:&quot; &amp; ENDCOLUMN &amp; .Cells(.Rows.Count, 1).End(xlUp).Row)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1516756005, "creation_date": 1516756005, "answer_id": 48413345, "question_id": 48413202, "link": "https://stackoverflow.com/questions/48413202/enable-customization-using-constants-in-vba-excel/48413345#48413345", "title": "Enable &quot;customization&quot; using constants in VBA (Excel)", "body": "<p>Unknown to me as to why you would want a <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/declaring-constants\" rel=\"nofollow noreferrer\">constant</a> for this purpose, but it would look something like this:</p>\n\n<pre><code>Sub test()\n\n    Const STARTCELL$ = \"A4\"\n    Const ENDCOLUMN$ = \"V\"\n\n    '...\n\n    Set DatenBereich = .Range(STARTCELL &amp; \":\" &amp; ENDCOLUMN &amp; _\n        .Cells(.Rows.Count, 1).End(xlUp).row)\n\nEnd Sub\n</code></pre>\n\n<p>But as you may (or may not) be aware, constants do not change value upon runtime.</p>\n\n<p>You can include the cell separator with the <code>ENDCOLUMN</code> if you so choose:  </p>\n\n<pre><code>Sub test()\n\n    Const STARTCELL As String = \"A4\"\n    Const ENDCOLUMN As String = \":V\"\n\n    '...\n\n    Set DatenBereich = .Range(STARTCELL &amp; ENDCOLUMN &amp; _\n        .Cells(.Rows.Count, 1).End(xlUp).row)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9259613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5fa71bb4e41c4f2bbcfcd07151ca01c?s=128&d=identicon&r=PG&f=1", "display_name": "Ma Me", "link": "https://stackoverflow.com/users/9259613/ma-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 48413345, "answer_count": 1, "score": 2, "last_activity_date": 1516756005, "creation_date": 1516754941, "last_edit_date": 1531164843, "question_id": 48413202, "link": "https://stackoverflow.com/questions/48413202/enable-customization-using-constants-in-vba-excel", "title": "Enable &quot;customization&quot; using constants in VBA (Excel)", "body": "<p>I want to enable some kind of user customization in my VBA Excel tool. Therefore i try to use constants in the beginning of the code. For most use cases that works already fine but for the following lines of code i did not find any solution yet.</p>\n\n<pre><code>Set DatenBereich = .Range(\"A4:V\" &amp; _\n                .Cells(.Rows.Count, 1).End(xlUp).Row)\n</code></pre>\n\n<p>What I am looking for is a way to replace \"A4:V\" by two constants called for example STARTCELL and ENDCOLUMN.</p>\n\n<p>Do you guys have any idea how I can easily realize that? Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 615, "user_id": 1928082, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7baf74767d6a6213527d318ad62edb4?s=128&d=identicon&r=PG", "display_name": "Maadh", "link": "https://stackoverflow.com/users/1928082/maadh"}, "edited": false, "score": 0, "creation_date": 1516754638, "post_id": 48413127, "comment_id": 83816197, "body": "I did not understand what you want to do ! can you demonstrate that by example with data ?"}, {"owner": {"reputation": 49, "user_id": 7175054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3625e4b58aa7f72c8d6bfaa682673e49?s=128&d=identicon&r=PG&f=1", "display_name": "Tyson Moyes", "link": "https://stackoverflow.com/users/7175054/tyson-moyes"}, "reply_to_user": {"reputation": 615, "user_id": 1928082, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7baf74767d6a6213527d318ad62edb4?s=128&d=identicon&r=PG", "display_name": "Maadh", "link": "https://stackoverflow.com/users/1928082/maadh"}, "edited": false, "score": 0, "creation_date": 1516755148, "post_id": 48413127, "comment_id": 83816335, "body": "<a href=\"https://imgur.com/a/2xogY\" rel=\"nofollow noreferrer\">imgur.com/a/2xogY</a>  This is some mock data. In the &quot;Total Remaining&quot; section, I want it to exclude the data in the 3rd row (because it&#39;s &quot;gone&quot;)."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 1, "creation_date": 1516755287, "post_id": 48413127, "comment_id": 83816377, "body": "Would it not be easier to change the <code>x</code> to something once it has been collected, say <code>c</code>for example, and use another formula similar to your countif x but with c?"}, {"owner": {"reputation": 615, "user_id": 1928082, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7baf74767d6a6213527d318ad62edb4?s=128&d=identicon&r=PG", "display_name": "Maadh", "link": "https://stackoverflow.com/users/1928082/maadh"}, "edited": false, "score": 0, "creation_date": 1516755599, "post_id": 48413127, "comment_id": 83816475, "body": "@TysonMoyes from the picture you sent do you want to exclude item2 at row 3 from the total ? or what do you want to exclude ? from my understanding you want to exclude 3rd row (any row with name is green ) IS that right ?"}, {"owner": {"reputation": 49, "user_id": 7175054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3625e4b58aa7f72c8d6bfaa682673e49?s=128&d=identicon&r=PG&f=1", "display_name": "Tyson Moyes", "link": "https://stackoverflow.com/users/7175054/tyson-moyes"}, "edited": false, "score": 0, "creation_date": 1516755606, "post_id": 48413127, "comment_id": 83816476, "body": "Ideally, yes. But my boss wants a total count of everything we receive, including what has already been sent out, so I need both numbers."}, {"owner": {"reputation": 49, "user_id": 7175054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3625e4b58aa7f72c8d6bfaa682673e49?s=128&d=identicon&r=PG&f=1", "display_name": "Tyson Moyes", "link": "https://stackoverflow.com/users/7175054/tyson-moyes"}, "reply_to_user": {"reputation": 615, "user_id": 1928082, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7baf74767d6a6213527d318ad62edb4?s=128&d=identicon&r=PG", "display_name": "Maadh", "link": "https://stackoverflow.com/users/1928082/maadh"}, "edited": false, "score": 0, "creation_date": 1516755658, "post_id": 48413127, "comment_id": 83816497, "body": "@MuadhProgrammer that&#39;s exactly right! I&#39;d like to exclude the whole row from the count"}, {"owner": {"reputation": 615, "user_id": 1928082, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7baf74767d6a6213527d318ad62edb4?s=128&d=identicon&r=PG", "display_name": "Maadh", "link": "https://stackoverflow.com/users/1928082/maadh"}, "edited": false, "score": 0, "creation_date": 1516756230, "post_id": 48413127, "comment_id": 83816655, "body": "@TysonMoyes OK Cool ! thank you for the explanation... you could add a button with vba code that count the sum of the items (using for loop ) with if statement to exclude the green rows. that is if you want to use excel macros ! I am not sure if it is possible to write a formula to do that for you ."}], "answers": [{"tags": [], "owner": {"reputation": 615, "user_id": 1928082, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d7baf74767d6a6213527d318ad62edb4?s=128&d=identicon&r=PG", "display_name": "Maadh", "link": "https://stackoverflow.com/users/1928082/maadh"}, "is_accepted": true, "score": 1, "last_activity_date": 1516758906, "last_edit_date": 1516758906, "creation_date": 1516758548, "answer_id": 48413647, "question_id": 48413127, "link": "https://stackoverflow.com/questions/48413127/edited-why-wont-this-formula-do-what-i-think-it-should/48413647#48413647", "title": "EDITED: Why Won&#39;t This Formula Do What I think It Should", "body": "<p>I would suggest to add a new column next to the last name for example ( let name it as include/exclude ) and set this column to 0 or 1 based on the color of the lastname background color.</p>\n\n<p>you can read the color of the cell by going to Excel's Name Manager ( under formula ) and create new and give it a name ( lastnamecolor). Then \nin the refers to field  insert the following formula : \n=GET.CELL(63,INDIRECT(\"rc[-1]\",FALSE))</p>\n\n<p>where 63 mean the background color of cell and rc[-1] means of the previous column .\nnow in the include/exclude column we inserted (next to the last name) put the following formula for all the rows: </p>\n\n<p>=(IF(lastnamecolor=10,0,1))</p>\n\n<p>this will check the color of the last name of each row and if it is green (=10) then it show 0 otherwise it show 1 .</p>\n\n<p>now you should get 0 or 1 next to the last names and you can include this values in the formula that calculate the total by multiplying each item with this value before adding it to the total.</p>\n"}], "owner": {"reputation": 49, "user_id": 7175054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3625e4b58aa7f72c8d6bfaa682673e49?s=128&d=identicon&r=PG&f=1", "display_name": "Tyson Moyes", "link": "https://stackoverflow.com/users/7175054/tyson-moyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1516776813, "accepted_answer_id": 48413647, "answer_count": 1, "score": 1, "last_activity_date": 1516902438, "creation_date": 1516754296, "last_edit_date": 1531164843, "question_id": 48413127, "link": "https://stackoverflow.com/questions/48413127/edited-why-wont-this-formula-do-what-i-think-it-should", "closed_reason": "Needs more focus", "title": "EDITED: Why Won&#39;t This Formula Do What I think It Should", "body": "<p>EDITED THIS QUESTION:</p>\n\n<p>Earlier I asked a question about excluding rows from a count if a cell is coloured. I think I've been able to figure out a function that will do what I want it to, but when I call the function in my spreadsheet it returns a #VALUE error and I'm not sure why.</p>\n\n<pre><code>Function CountRemaining(nameRange As Range, countRange As Range) As Integer\nDim TotalCount As Integer\nSet nameCell = nameTarget\nFor Each nameCell In nameRange\n    If nameCell.Interior.ColorIndex &lt;&gt; 12 Then\n        Set countCell = countRange\n        For Each countCell In countRange\n            If countCell.Value = \"x\" Then\n                TotalCount = TotalCount + 1\n            End If\n        Next countCell\n    End If\n    Next nameCell\n\nCountRemaining = TotalCount\nEnd Function\n</code></pre>\n\n<p>I give name range the range of people's names (the cells I color in manually when the item is received) and the range of the item goes into count range (denoted by an x for the item that they have). </p>\n\n<p>Logically this function makes sense to me but I can't see the flaw. Any help would be much appreciated. </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 61, "user_id": 7544724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adf19a98886b10036ca7142e16f059d6?s=128&d=identicon&r=PG&f=1", "display_name": "bballboy8", "link": "https://stackoverflow.com/users/7544724/bballboy8"}, "edited": false, "score": 0, "creation_date": 1516754209, "post_id": 48412956, "comment_id": 83816083, "body": "It&#39;s a fraction of what it was now."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516754566, "post_id": 48412956, "comment_id": 83816180, "body": "&quot;There are comments to explain what is going on.&quot; - there are?"}, {"owner": {"reputation": 61, "user_id": 7544724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adf19a98886b10036ca7142e16f059d6?s=128&d=identicon&r=PG&f=1", "display_name": "bballboy8", "link": "https://stackoverflow.com/users/7544724/bballboy8"}, "edited": false, "score": 0, "creation_date": 1516755431, "post_id": 48412956, "comment_id": 83816419, "body": "The comments are restored."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516755760, "post_id": 48412956, "comment_id": 83816528, "body": "What possible reason is there for creating 200 aliases for one array?"}, {"owner": {"reputation": 61, "user_id": 7544724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adf19a98886b10036ca7142e16f059d6?s=128&d=identicon&r=PG&f=1", "display_name": "bballboy8", "link": "https://stackoverflow.com/users/7544724/bballboy8"}, "edited": false, "score": 0, "creation_date": 1516755800, "post_id": 48412956, "comment_id": 83816536, "body": "In the case of creating 200 separate lineups of 6 players each."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516755853, "post_id": 48412956, "comment_id": 83816552, "body": "But that is exactly what you are <i>not</i> doing. There is only a single &quot;inner array&quot;. Why not use a two-dimensional array?"}, {"owner": {"reputation": 61, "user_id": 7544724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adf19a98886b10036ca7142e16f059d6?s=128&d=identicon&r=PG&f=1", "display_name": "bballboy8", "link": "https://stackoverflow.com/users/7544724/bballboy8"}, "edited": false, "score": 0, "creation_date": 1516755891, "post_id": 48412956, "comment_id": 83816564, "body": "Could you explain further? This is my first VBA project."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1516756062, "post_id": 48412956, "comment_id": 83816603, "body": "<code>lineups(i) = players</code> doesn&#39;t produce a <i>copy</i> of <code>players</code>. There is only a single declared array named <code>players</code>, which you are referring to 200 times. It would make more sense to do something like <code>Dim lineups(1 to 200, 1 to 6)</code> As String`"}, {"owner": {"reputation": 61, "user_id": 7544724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adf19a98886b10036ca7142e16f059d6?s=128&d=identicon&r=PG&f=1", "display_name": "bballboy8", "link": "https://stackoverflow.com/users/7544724/bballboy8"}, "edited": false, "score": 0, "creation_date": 1516756184, "post_id": 48412956, "comment_id": 83816642, "body": "Ok and I would reference a spot in that array by using something like lineups(1)(1)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1516756226, "post_id": 48412956, "comment_id": 83816653, "body": "You would use <code>lineups(i,j)</code> to refer to player <code>j</code> in lineup <code>i</code>."}, {"owner": {"reputation": 61, "user_id": 7544724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adf19a98886b10036ca7142e16f059d6?s=128&d=identicon&r=PG&f=1", "display_name": "bballboy8", "link": "https://stackoverflow.com/users/7544724/bballboy8"}, "edited": false, "score": 0, "creation_date": 1516756343, "post_id": 48412956, "comment_id": 83816678, "body": "Thank you so much! Is it possible to make a comparison between two arrays or does that need to be done iteratively?"}, {"owner": {"reputation": 61, "user_id": 7544724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adf19a98886b10036ca7142e16f059d6?s=128&d=identicon&r=PG&f=1", "display_name": "bballboy8", "link": "https://stackoverflow.com/users/7544724/bballboy8"}, "edited": false, "score": 0, "creation_date": 1516757575, "post_id": 48412956, "comment_id": 83816982, "body": "I receive wrong number of dimensions when doing what John Coleman recommends? Why is that?"}], "owner": {"reputation": 61, "user_id": 7544724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/adf19a98886b10036ca7142e16f059d6?s=128&d=identicon&r=PG&f=1", "display_name": "bballboy8", "link": "https://stackoverflow.com/users/7544724/bballboy8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516755407, "creation_date": 1516753040, "last_edit_date": 1516755407, "question_id": 48412956, "link": "https://stackoverflow.com/questions/48412956/vba-array-within-arrays", "title": "VBA Array within Arrays", "body": "<p>I am currently trying to use vba to check whether a solver solution has been found already and if so generate a new one. Below is my code. There are comments to explain what is going on.</p>\n\n<pre><code>Sub Button1_Click()\nDim i As Integer\nDim j As Integer\none = 1\nmin_cell = Range(\"BF6\").Value\nmax_cell = Range(\"BF7\").Value\ngamer = Range(\"BF10\").Value\nDim players(1 To 200) As String 'here is the inner array\nDim lineups(1 To 200) As Variant 'here is the outer array\nFor i = 1 To 200\n    lineups(i) = players 'assigning the players array to each spot in the lineup array\nNext i\nIf gamer = 0 Then\n    spot = \"AZ3\"\n    accuracy = 0.00000001\nElseIf gamer = 1 Then\n    spot = \"BA3\"\n    accuracy = 0.001\nEnd If\nDim variable As Integer\nlineup_quantity = Range(\"BF8\").Value 'denotes how many different solutions the solver should generate\nmax_value = 1000\nDim counter As Integer\nDim count As Integer\nlineup_number = 1 'denotes the current lineup number\nDim occurences(1 To 201) As Integer\nFor count = lineup_number To lineup_quantity 'running solver\n    Dim positions(1 To 201) As String\n    Dim cell_numbers(1 To 201)\n    track = 1\n    Worksheets(\"Draftkings Lookup\").Range(\"AI1:AI500\").Copy\n    Worksheets(\"Draftkings Lookup\").Range(\"DZ1:DZ500\").PasteSpecial Paste:=xlPasteValues\n    SolverReset\n    solverok setcell:=spot, maxminval:=1, bychange:=\"AL\" + CStr(min_cell) + \":AL\" + CStr(max_cell), engine:=2\n    SolverOptions Precision:=accuracy\n    solveradd cellref:=\"AL\" + CStr(min_cell) + \":AL\" + CStr(max_cell), relation:=5\n    solveradd cellref:=spot, relation:=1, formulatext:=max_value\n    solveradd cellref:=\"BA6:BA11\", relation:=2, formulatext:=\"AY6\"\n    solversolve userfinish:=True\n    Range(\"BM\" + CStr(count + 1)).Value = Range(spot).Value\n    For counter = min_cell To max_cell\n        If Range(\"AL\" + CStr(counter)).Value = 1 Then\n            players(track) = Range(\"B\" + CStr(counter)).Value 'stores the result to of the solver and is working properly\n            positions(track) = Range(\"C\" + CStr(counter)).Value\n            cell_numbers(track) = counter\n            track = track + 1\n        End If\n    Next counter\n    For counter = 1 To lineup_number 'my attempt at comparing players to each array in lineups which is not working\n        For i = 1 To 8\n            If lineups(counter)(i) &lt;&gt; players(i) Then\n                GoTo hi\n            End If\n        Next i\n        count = count - 1 'causes program to repeat current lineup\n        GoTo line\nhi:\n    Next counter\n    For i = 1 To 8\n        lineups(lineup_number)(i) = players(i) 'adding the current players as an array in lineups since they don't match any prior lineups\n    Next i\nline:\nWorksheets(\"Draftkings Lookup\").UsedRange.Columns(\"AI:AI\").Calculate\nNext count\nEnd Sub\n</code></pre>\n\n<p>I am still getting duplicates when I run it for a large number of lineups like 40. Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "inputbox"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516745696, "post_id": 48411649, "comment_id": 83813188, "body": "Is your total row the last row in the worksheet?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1516745742, "post_id": 48411649, "comment_id": 83813210, "body": "if there is no data below then you can use  Worksheet.UsedRange.Rows"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1516746502, "post_id": 48411649, "comment_id": 83813558, "body": "Why do you want to offer the user a choice of where to add a row? You should find the last used row and add 1, then put the data on that row. Perhaps you should expand your question to explain more about what you actually want to do. Often, when you&#39;re new to VBA (as I once was!) you find yourself trying to make something work - but where there&#39;d actually be a much better solution if you approached the problem a different way. What triggers the sub in the first place?"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1516746902, "creation_date": 1516746902, "answer_id": 48411959, "question_id": 48411649, "link": "https://stackoverflow.com/questions/48411649/how-to-limit-inputbox-response-to-specific-range/48411959#48411959", "title": "How to limit inputbox response to specific range", "body": "<p>To swap 22 with the value of <code>lastrow</code>:</p>\n\n<pre><code>Sub Test()\n\nDim varUserInput As Variant, sht As Worksheet, lastrow As Long\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\") 'specify sheet here\nlastrow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row 'referencing column A\n\nvarUserInput = InputBox(\"Please enter the row number where you'd like to add a row:\", _\n\"What Row?\")\n\nIf varUserInput = \"\" Then Exit Sub\n\nIf Not IsNumeric(varUserInput) Or varUserInput &lt; 12 Or lastrow &lt; varUserInput Then 'If value out of specified range\n\n    varUserInput = lastrow 'Default value\n    MsgBox \"You Entered a wrong value, using default\", vbOKOnly\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1516757569, "last_edit_date": 1516757569, "creation_date": 1516756840, "answer_id": 48413444, "question_id": 48411649, "link": "https://stackoverflow.com/questions/48411649/how-to-limit-inputbox-response-to-specific-range/48413444#48413444", "title": "How to limit inputbox response to specific range", "body": "<p>You can try setting the default argument while calling the <code>InputBox</code> to the <em>last row</em> (or whatever).<br> Then change the prompt guiding the users what set of numbers are accepted.<br> Something like below:</p>\n\n<pre><code>Sub marine()\n    Dim varUserInput As Variant\n    Dim lr As Long, myprompt As String\n\n    With Sheet1 '/* change to your actual sheet */\n        lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row '/* checks column A, change to suit*/\n        myprompt = \"Please enter the row number where you'd like to add a row:\"\n        Do\n            '/* enter your last row as default */\n            varUserInput = InputBox(myprompt, \"What Row?\", lr)\n            myprompt = \"You entered an invalid row number.\" &amp; vbNewLine &amp; _\n                       \"Please enter row number between 12 and \" &amp; lr\n            If varUserInput = \"\" Then Exit Do '/* if user cancels */\n            If Not IsNumeric(varUserInput) Then\n                myprompt = \"Invalid entry, numeric value expected.\" &amp; vbNewLine &amp; _\n                           \"Please enter numbers between 12 and \" &amp; lr &amp; \".\"\n            End If\n        Loop Until varUserInput &lt;= lr And varUserInput &gt;= 12\n    End With\nEnd Sub\n</code></pre>\n\n<p>I can't quite get what you want done since you said you are allowed to enter values greater than the total rows? Well this will restrict users to add rows within the bounds of your data (row 12 and the last row). If this is not what you need, tweak the condition on the <code>Loop Until</code> line to suit your needs. Hope this gets you going.</p>\n"}], "owner": {"reputation": 13, "user_id": 9259122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ca6f255bfe5d07a562adec3021105f?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole13310", "link": "https://stackoverflow.com/users/9259122/nicole13310"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 48411959, "answer_count": 2, "score": 1, "last_activity_date": 1516757569, "creation_date": 1516745417, "last_edit_date": 1531164843, "question_id": 48411649, "link": "https://stackoverflow.com/questions/48411649/how-to-limit-inputbox-response-to-specific-range", "title": "How to limit inputbox response to specific range", "body": "<p>New to the VBA world. A different thread was helpful in creating an <code>InputBox</code> and setting a specific range but not quite what I need.</p>\n\n<p>I'm having users enter the row number into an <code>InputBox</code> where they'd like to add a row but I want to restrict the value they enter from row 12 (where my data starts) to the row above the total row. How do I reference the total row since it will change as rows are added? and how to make the default the row above the total row? (Currently my total row is row 22)</p>\n\n<pre><code>Dim varUserInput As Variant\nvarUserInput = InputBox(\"Please enter the row number where you'd like to add a row:\", _\n\"What Row?\")\nIf varUserInput = \"\" Then Exit Sub\nIf Not IsNumeric(varUserInput) Or varUserInput &lt; 12 Or 22 &lt; varUserInput \nThen 'If value out of specified range\n    varUserInput = 22 'Default value\n    MsgBox \"You Entered a wrong value, using default\", vbOKOnly\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1516746130, "post_id": 48411576, "comment_id": 83813393, "body": "<code>Function</code> is meant to return you something. <code>Sub</code> is a procedure to do things for you. What you are doing falls into a Sub."}, {"owner": {"reputation": 134, "user_id": 3286402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e02bb2c3902a05ceaefb099523f564?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan.s", "link": "https://stackoverflow.com/users/3286402/ivan-s"}, "edited": false, "score": 0, "creation_date": 1516772243, "post_id": 48411576, "comment_id": 83820578, "body": "Your function calculate result as function of cells(rcNumber,1), Thus when it place in cell(1,1) and value of cell(1,1) is 0 result was 0. That result place in cells(1,1). If you need function calculates f(x) you must save x in one colunm, then place function in another colunm in that function you refer on colunm contain value x. That is not in same cells x and F(X), how you write in your example."}], "answers": [{"tags": [], "owner": {"reputation": 595, "user_id": 1237786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f88fc95f445f0659730a2ad63c45f16a?s=128&d=identicon&r=PG", "display_name": "anefeletos", "link": "https://stackoverflow.com/users/1237786/anefeletos"}, "is_accepted": true, "score": 1, "last_activity_date": 1516745855, "last_edit_date": 1516745855, "creation_date": 1516745410, "answer_id": 48411647, "question_id": 48411576, "link": "https://stackoverflow.com/questions/48411576/excel-macro-for-loop-printing/48411647#48411647", "title": "Excel Macro For Loop Printing", "body": "<p>Use <code>Sub</code> instead of <code>Function</code> in order to change other cells. You can't call a function from formula textbox (=...) that alters other cells. Of course functions can make changes to cells but not when called by a cell. Here you don't need a method that returns something.</p>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 3, "last_activity_date": 1516749539, "last_edit_date": 1516749539, "creation_date": 1516747792, "answer_id": 48412132, "question_id": 48411576, "link": "https://stackoverflow.com/questions/48411576/excel-macro-for-loop-printing/48412132#48412132", "title": "Excel Macro For Loop Printing", "body": "<p>I think it would be more logical to change your function to:</p>\n\n<pre><code>Function EXPSIN(i As Long) As Double\n    EXPSIN = Exp(-i) * Sin(i)\nEnd Function\n</code></pre>\n\n<p>And then populate your target cells using the formula:</p>\n\n<pre><code>=EXPSIN(ROW()-1)\n</code></pre>\n"}], "owner": {"reputation": 1275, "user_id": 3597095, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/60709793/picture?type=large", "display_name": "obizues", "link": "https://stackoverflow.com/users/3597095/obizues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 48411647, "answer_count": 2, "score": 0, "last_activity_date": 1516751481, "creation_date": 1516745018, "last_edit_date": 1516751481, "question_id": 48411576, "link": "https://stackoverflow.com/questions/48411576/excel-macro-for-loop-printing", "title": "Excel Macro For Loop Printing", "body": "<p>I am having trouble creating a very basic macro that prints out a value down a column.</p>\n\n<p>The values are generated by the function: \nf(x) = Exp (-x) * sin(x), where x = 0 through 9 in a for loop.</p>\n\n<p>Current code:</p>\n\n<pre><code>Function calculateFunction()\n  MaxNumber = 9\n  rowNumber = 1\n    For i = 0 To MaxNumber\n      Cells(rowNumber, 1) = Exp(-i) * Sin(i)\n      rowNumber = rowNumber + 1\n    Next\nEnd Function\n</code></pre>\n\n<p>The code is put in \"Module 1\" and run with the text:</p>\n\n<pre><code>=calculateFunction()\n</code></pre>\n\n<p>In a cell. The only cell that populates is cell (1,1) which says \"0.00\"  There is no error.</p>\n"}, {"tags": ["vba", "excel", "format", "cells"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1516745293, "post_id": 48411482, "comment_id": 83813014, "body": "Sounds like you need codes for Worksheet_Change event targeting that column. Or if it&#39;s just for visual change, use custom NumberFormat <code>ddmmyy</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516746513, "post_id": 48411482, "comment_id": 83813568, "body": "Sounds like you want these cells to have a <code>NumberFormat</code>. Select the cells, press Ctrl+1, go to the <i>Number</i> tab, and put in your format, e.g. <code>000000</code>. That said this question isn&#39;t a proper fit for this site (not sure why it&#39;s getting answers) - see <a href=\"https://stackoverflow.com/help/on-topic\">help center</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4568903, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206379034339105/picture?type=large", "display_name": "Mat257", "link": "https://stackoverflow.com/users/4568903/mat257"}, "edited": false, "score": 0, "creation_date": 1516807801, "post_id": 48411757, "comment_id": 83842065, "body": "hi, thanks for help. i need excel self convert the data on typing, in real time and not after running a macro; thereby changed afterward"}, {"owner": {"reputation": 33, "user_id": 4568903, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206379034339105/picture?type=large", "display_name": "Mat257", "link": "https://stackoverflow.com/users/4568903/mat257"}, "edited": false, "score": 0, "creation_date": 1516986149, "post_id": 48411757, "comment_id": 83925550, "body": "hi, let me clarify:"}, {"owner": {"reputation": 33, "user_id": 4568903, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206379034339105/picture?type=large", "display_name": "Mat257", "link": "https://stackoverflow.com/users/4568903/mat257"}, "edited": false, "score": 0, "creation_date": 1516986502, "post_id": 48411757, "comment_id": 83925763, "body": "hi, let me clarify: input data may concurrently vary from 4 digit number (thousand, ### without leading zero, i dont need) or a date (31/12/18, ddmmyy).   thereby if in range A1 i input 3112 as number, i want it to hold fomat number itself but if i input as 31/12/18 i need it to convert to thousands number format returning 3112, same as earlier input. i tried     [&gt;40000]gmm;#####     because date number expression are always over than 40000. however in case of date input it holds date format instead convert. any idea? thanks"}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "reply_to_user": {"reputation": 33, "user_id": 4568903, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206379034339105/picture?type=large", "display_name": "Mat257", "link": "https://stackoverflow.com/users/4568903/mat257"}, "edited": false, "score": 0, "creation_date": 1517246228, "post_id": 48411757, "comment_id": 84007555, "body": "I dont have an answer right now using formatting but with vba or Excel worksheet functions you can accomplish what you&#39;re looking for."}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": false, "score": 0, "last_activity_date": 1516745869, "creation_date": 1516745869, "answer_id": 48411757, "question_id": 48411482, "link": "https://stackoverflow.com/questions/48411482/vba-customize-cells-format/48411757#48411757", "title": "vba customize cells format", "body": "<p>Have you tried simply pasting only the cell value with:</p>\n\n<pre><code>Selection.PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>Or just clear the cell format and format it again with your desired format.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4568903, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206379034339105/picture?type=large", "display_name": "Mat257", "link": "https://stackoverflow.com/users/4568903/mat257"}, "edited": false, "score": 0, "creation_date": 1517415267, "post_id": 48411853, "comment_id": 84088926, "body": "hello guys, i have solved out: 1) i customize cell settings as follow: [&gt;40000] ddmm 2) then copy and pste xlValuesAndNumberFormats. thanks"}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1516746377, "creation_date": 1516746377, "answer_id": 48411853, "question_id": 48411482, "link": "https://stackoverflow.com/questions/48411482/vba-customize-cells-format/48411853#48411853", "title": "vba customize cells format", "body": "<p>Try:</p>\n\n<ol>\n<li>Selecting the range</li>\n<li>Home > Number > Number Format (or Ctrl+1 I think) > Custom</li>\n<li>Enter ddmmyy</li>\n<li>Okay</li>\n</ol>\n\n<p>Can be done programmatically e.g.</p>\n\n<pre><code>Thisworkbook.worksheets(\"Sheet1\").range(\"A1:A50\").numberformat = \"ddmmyy\"\n</code></pre>\n\n<p>The above would only be a visual/cosmetic change and the internal value of each cell would still be a date (technically a number) for calculation purposes.</p>\n\n<p>However, if I've misunderstood and you instead want to go from the date 21 Jan 2018 to the number 210118, I think you would need to get the range's value(s), format as DDMMYY string, then <code>clng()</code> - or maybe (DD*10000) + (MM*100) + (YY) might work, then format as \"000000\" to preserve leading zeros.</p>\n"}], "owner": {"reputation": 33, "user_id": 4568903, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206379034339105/picture?type=large", "display_name": "Mat257", "link": "https://stackoverflow.com/users/4568903/mat257"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 639, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1516746377, "creation_date": 1516744659, "last_edit_date": 1531164843, "question_id": 48411482, "link": "https://stackoverflow.com/questions/48411482/vba-customize-cells-format", "title": "vba customize cells format", "body": "<p>I am needing to customize cells with simple thousands format, like <code>1000</code>, without any separator or decimal.</p>\n\n<p>However, I wish to remove text fonts other than a number when they are input.  </p>\n\n<p>For example, I want to input <code>120118</code>, however in my paper from which I am copying that figures, it is formatted as a date, thereby <code>12/01/18</code>. I am needing Excel to  simply keep it as <code>120118</code> after typing, removing the slash (/). I have seen similar settings in access queries.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1747, "user_id": 1671226, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/424cffebe51ea2bf919404a22185ec18?s=128&d=identicon&r=PG", "display_name": "Black.Jack", "link": "https://stackoverflow.com/users/1671226/black-jack"}, "edited": false, "score": 0, "creation_date": 1516744449, "post_id": 48411418, "comment_id": 83812620, "body": "which excel are u using?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516744545, "post_id": 48411418, "comment_id": 83812668, "body": "Hm...does <code>Set ws = Worksheets.Add(after:=Sheets(Worksheets.Count))</code> work?"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1516744833, "post_id": 48411418, "comment_id": 83812809, "body": "Your code works verbatim for me.  I am using Excel 2016"}, {"owner": {"reputation": 293, "user_id": 5366091, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/1029941630378984/picture?type=large", "display_name": "Robert Kendall", "link": "https://stackoverflow.com/users/5366091/robert-kendall"}, "edited": false, "score": 0, "creation_date": 1516744920, "post_id": 48411418, "comment_id": 83812854, "body": "I changed to set ws =Worksheet.add, and the error changed to &quot;object required&quot;"}, {"owner": {"reputation": 293, "user_id": 5366091, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/1029941630378984/picture?type=large", "display_name": "Robert Kendall", "link": "https://stackoverflow.com/users/5366091/robert-kendall"}, "edited": false, "score": 0, "creation_date": 1516745166, "post_id": 48411418, "comment_id": 83812960, "body": "I&#39;m using Excel 2016"}], "answers": [{"tags": [], "owner": {"reputation": 1747, "user_id": 1671226, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/424cffebe51ea2bf919404a22185ec18?s=128&d=identicon&r=PG", "display_name": "Black.Jack", "link": "https://stackoverflow.com/users/1671226/black-jack"}, "is_accepted": false, "score": 1, "last_activity_date": 1516744683, "creation_date": 1516744683, "answer_id": 48411488, "question_id": 48411418, "link": "https://stackoverflow.com/questions/48411418/adding-a-worksheet-using-vba/48411488#48411488", "title": "Adding a worksheet using VBA", "body": "<p>Try this VBA Macro:</p>\n\n<pre><code> Sub Add()\nSet wb = Application.ActiveWorkbook\nwb.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count)).Name =  \"For Export\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 5366091, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/1029941630378984/picture?type=large", "display_name": "Robert Kendall", "link": "https://stackoverflow.com/users/5366091/robert-kendall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1516744683, "creation_date": 1516744330, "last_edit_date": 1531161705, "question_id": 48411418, "link": "https://stackoverflow.com/questions/48411418/adding-a-worksheet-using-vba", "title": "Adding a worksheet using VBA", "body": "<p>Trying to add a worksheet and name it \"For Export\" Throwing error on the set WS line, \"Method 'Add' of object 'Sheets' failed\"  Thanks in advance.</p>\n\n<pre><code>Dim WS As Worksheet\n'Add sheet named \"For Export\"\nSet WS = Sheets.Add(After:=Sheets(Worksheets.Count))\nWS.Name = \"For Export\"\nSheets(\"For Export\").Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1516744950, "post_id": 48411366, "comment_id": 83812869, "body": "Have you tried using Record Macro?"}], "answers": [{"comments": [{"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1516746044, "post_id": 48411583, "comment_id": 83813350, "body": "What this does is simply pull what is loaded in the pivottable. What I need is all the selections possible. For example, if you had not selected [Product] above, but need to pull it."}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1516746408, "post_id": 48411583, "comment_id": 83813516, "body": "No. This will print ALL columns which are part of the pivot table irrespective of their selection status. Check image in the answer - I did not select <code>place</code> and still it was printed in the debug window"}, {"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1516746558, "post_id": 48411583, "comment_id": 83813582, "body": "Perhaps a better question is, if the item has not been selected, how can I pull a list of any and all items that are possible to be selected?"}, {"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1516746735, "post_id": 48411583, "comment_id": 83813661, "body": "<b>From your image added update</b> I see, however it appears I am only getting what is selected. Is there a special setting that you have selected?"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1516746770, "post_id": 48411583, "comment_id": 83813679, "body": "Nop ..its simple pivot with all default settings"}, {"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1516746820, "post_id": 48411583, "comment_id": 83813705, "body": "My pivot table sources from an Azure Analysis Services Tabular model"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1516746925, "post_id": 48411583, "comment_id": 83813745, "body": "Can you check on a blank workbook with a small pivot to see if my code works on that. If that works then it would mean that your pivot got some special condition/settings"}, {"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1516747427, "post_id": 48411583, "comment_id": 83813962, "body": "Yes, your code works when I built out a small PivotTable. The question now become, how to pull all the fields, if we can view them in the item selection, we should be able to pull each one"}], "tags": [], "owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "is_accepted": false, "score": 0, "last_activity_date": 1516746537, "last_edit_date": 1516746537, "creation_date": 1516745057, "answer_id": 48411583, "question_id": 48411366, "link": "https://stackoverflow.com/questions/48411366/iterating-over-all-pivot-table-objects/48411583#48411583", "title": "Iterating over all pivot table objects", "body": "<p>Assuming PivotTable1 is the name of your pivot table</p>\n\n<pre><code>For Each objPivotField In Worksheets(\"Sheet1\").PivotTables(\"PivotTable1\").PivotFields\n    Debug.Print objPivotField.Name\nNext\n</code></pre>\n\n<p>Will enable you to traverse all pivot fields</p>\n\n<p><a href=\"https://i.stack.imgur.com/5GH7N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5GH7N.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516746537, "creation_date": 1516744079, "last_edit_date": 1531164843, "question_id": 48411366, "link": "https://stackoverflow.com/questions/48411366/iterating-over-all-pivot-table-objects", "title": "Iterating over all pivot table objects", "body": "<p>Currently have a list of hundreds of pivot table measures:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pNQSk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pNQSk.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I iterate over all the objects possible in VBA?</p>\n\n<p>For example, pulling [Salesperson], then [Product], then [Region], etc </p>\n\n<p>(I know it will be a For Each loop on a PivotTable command...)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "edited": false, "score": 0, "creation_date": 1516749980, "post_id": 48411284, "comment_id": 83814850, "body": "Hey Micha, however your code looks ingenious, every time I run it a Compile Error: Expected Array message turns out pointing to the Field:=lastCol(ws) part"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "edited": false, "score": 0, "creation_date": 1516750605, "post_id": 48411284, "comment_id": 83815060, "body": "@SouzaSauloSaulo That&#39;s because you didn&#39;t delete <code>Dim LastCol As Integer</code> from your code. You also need to delete: <code>LastCol = .Cells(1, .Columns.Count).End(xlToLeft).column</code>"}, {"owner": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "edited": false, "score": 0, "creation_date": 1516758901, "post_id": 48411284, "comment_id": 83817283, "body": "You&#39;re right. I did as recommeded and the code works like a charm. Well done."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "edited": false, "score": 1, "creation_date": 1595183956, "post_id": 48411284, "comment_id": 111379900, "body": "@SouzaSaulo Your commented: &quot;Works like a charm&quot;. - Feel free to accept by ticking the green checkmark if you found a helpful answer and/or to upvote such answers. See <a href=\"https://stackoverflow.com/help/someone-answers\">&quot;Someone answers&quot;</a>"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1516744826, "last_edit_date": 1516744826, "creation_date": 1516743649, "answer_id": 48411284, "question_id": 48411092, "link": "https://stackoverflow.com/questions/48411092/find-and-filter-last-column-with-values/48411284#48411284", "title": "Find and filter last column with values", "body": "<p>First, I would recommend that you declare your worksheet object. I turned your <code>LastCol</code> into a function.</p>\n\n<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nFunction lastCol(ByVal ws As Worksheet, Optional ByVal row As Variant = 1) As Long\n    With ws\n        lastCol = .Cells(row, .Columns.Count).End(xlToLeft).Column\n    End With\nEnd Function\n\nSub test()\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(1)\n\n    With ws.UsedRange\n        .AutoFilter Field:=lastCol(ws), Criteria1:=Array(\"Age*\", \"Weight*\"), Operator:=xlFilterValues\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Using <code>ActiveSheet</code>, <code>ActiveCell</code>, <code>.Select</code>, <code>.Selection</code>, <code>.Activate</code>, etc is rarely good for your code. In minimal cases it's useful, but the vast majority of the time it can be a debugging nightmare.</p>\n"}], "owner": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516744826, "creation_date": 1516742754, "last_edit_date": 1531164843, "question_id": 48411092, "link": "https://stackoverflow.com/questions/48411092/find-and-filter-last-column-with-values", "title": "Find and filter last column with values", "body": "<p>I need a code that will find the last column with values and filter that column by multiple criteria. Here\u2019s what I\u2019ve come up with so far.</p>\n\n<pre><code>Dim LastCol As Integer\nWith ActiveSheet\n    LastCol = .Cells(1, .Columns.Count).End(xlToLeft).column\nEnd With\nWith ActiveSheet\n    AutoFilter Field:=1, Criteria1:=Array(\"Age*\", \"Weight*\"), \nOperator:=xlFilterValues\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1516741746, "post_id": 48410764, "comment_id": 83811387, "body": "Since you are dealing with more than one sheet, you may want to explicitly use each workbook, like you did with Sheets(&quot;MTO&quot;).range, but not with rows.count (this is on the activesheet.)  Also, is your &quot;dropdown&quot; menu a data validation, filter, combobox, ........."}, {"owner": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1516741973, "post_id": 48410764, "comment_id": 83811494, "body": "It&#39;s a data validation list."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1516742153, "post_id": 48410764, "comment_id": 83811594, "body": "Can&#39;t you simply assign between the .Value members of the two cells, or iterate over them if it is a range? You could also use Copy then PasteSpecial if it is a range, but that uses the clipboard."}], "answers": [{"tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": false, "score": 0, "last_activity_date": 1516743136, "creation_date": 1516743136, "answer_id": 48411180, "question_id": 48410764, "link": "https://stackoverflow.com/questions/48410764/pastespecial-format-and-value/48411180#48411180", "title": "PasteSpecial (Format and Value)", "body": "<p>You can use <code>PasteSpecial</code> with the <code>xlPasteValuesAndNumberFormats</code> option.</p>\n\n<pre><code>Range(\"B5:M6\").Copy\nSheets(\"MTO\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial _\n                Paste:=xlPasteValuesAndNumberFormats, _\n                Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>After a copy operation, I sometimes want to clear the clipboard so the copied range isn't accidentially pasted again.  I use this procedure:</p>\n\n<pre><code>Private Declare Function OpenClipboard Lib \"user32\" (ByVal hwnd As Long) As Long\nPrivate Declare Function EmptyClipboard Lib \"user32\" () As Long\nPrivate Declare Function CloseClipboard Lib \"user32\" () As Long\n\nPublic Sub ClearClipboard()\n    OpenClipboard (0&amp;)\n    EmptyClipboard\n    CloseClipboard\nEnd Sub\n</code></pre>\n\n<p>You can add this at the top of a regular code module and then call it from any of your procedures with this line of code:</p>\n\n<pre><code>ClearClipboard\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "edited": false, "score": 0, "creation_date": 1516745688, "post_id": 48411208, "comment_id": 83813185, "body": "Thanks, BruceWayne.  This works. I had some merged cells but I fixed that.  It does the copy and paste job but when it copies the border it places them a row below the values in the cells. The cell values are spot on aside from the fact that there are way more sig figs than I need.  This using the simplier version."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "edited": false, "score": 0, "creation_date": 1516747112, "post_id": 48411208, "comment_id": 83813817, "body": "@Mark - D&#39;oh, see my edit.  It was adding the formatting to a row below, because when you added data to the <code>MTO</code> sheet, it re-ran the <code>...End(xlUp)</code> on <i>that</i> data, so had an extra row.  It should work now."}, {"owner": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "edited": false, "score": 0, "creation_date": 1516751149, "post_id": 48411208, "comment_id": 83815239, "body": "Amazing! Thank you! Works perfectly!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "edited": false, "score": 0, "creation_date": 1516751460, "post_id": 48411208, "comment_id": 83815332, "body": "@Mark glad it worked! You can mark it as the answer by clicking the check mark left of the post, below the up/down arrows."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1516760907, "last_edit_date": 1516760907, "creation_date": 1516743289, "answer_id": 48411208, "question_id": 48410764, "link": "https://stackoverflow.com/questions/48410764/pastespecial-format-and-value/48411208#48411208", "title": "PasteSpecial (Format and Value)", "body": "<p>Here's a simple way to do that. You can do values, then format. I used two variables (perhaps overkill, yes), but it will show you how you could use ranges to set the copy/destination range which would help in the long run.</p>\n\n<pre><code>Sub copy_val_format()\n    Dim copyRng As Range\n    Dim destRng As Range\n    Set copyRng = Sheets(\"Sheet1\").Range(\"B5:M6\")\n    Set destRng = Sheets(\"MTO\").Range(\"B\" &amp; rows.Count).End(xlUp).Offset(1, 0)\n\n    copyRng.Copy\n    destRng.PasteSpecial (xlPasteValues)\n    copyRng.Copy\n    destRng.PasteSpecial (xlPasteFormats)\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>or the simpler version:</p>\n\n<pre><code>Sub simpler()\n    Dim lastCell as Range\n    Set lastCell = Sheets(\"MTO\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n\n    Sheets(\"Sheet1\").Range(\"B5:M6\").Copy\n    lastCell.PasteSpecial (xlPasteValues)\n\n    Sheets(\"Sheet1\").Range(\"B5:M6\").Copy\n    lastCell.PasteSpecial (xlPasteFormats)\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 9257554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-_XECyP0xoZ4/AAAAAAAAAAI/AAAAAAAAAbs/Vfh2zZa_LkU/photo.jpg?sz=128", "display_name": "Mark ", "link": "https://stackoverflow.com/users/9257554/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8689, "favorite_count": 0, "accepted_answer_id": 48411208, "answer_count": 2, "score": 0, "last_activity_date": 1516760907, "creation_date": 1516741412, "last_edit_date": 1516743423, "question_id": 48410764, "link": "https://stackoverflow.com/questions/48410764/pastespecial-format-and-value", "title": "PasteSpecial (Format and Value)", "body": "<p>I have an excel program/button that creates a table.  The inputs are in a single row/multiple columns on sheet 1. The outputs are the same but on a sheet 2.  The headings on both sheets of the columns are the same.  On the input sheet, one of the column headings has a drop down menu and others have formulas.  When I click a button, the row is copied/pasted to the output sheet. I can repeat the process by selecting different items from the drop down box and pushing the button to run the program to populate the table on sheet 2.  The problem is the I only want to copy and paste values.  Changing the drop down box on sheet 1 changes all of the information on to the same item on sheet 2. </p>\n\n<p>The code is as follow:</p>\n\n<pre><code>Sub AddHardware()\n    Range(\"b5:m6\").Copy Sheets(\"MTO\").Range(\"B\" &amp; rows.Count).End(xlUp).Offset(1, 0)                \nEnd Sub\n</code></pre>\n\n<p>How do I only paste the values and the formatting (no formulas or drop downs)?</p>\n"}]