[{"tags": ["excel", "charts", "series", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431565028, "post_id": 30227007, "comment_id": 48558909, "body": "I don&#39;t have 2013 for testing, but did you try: <code>MySeries.IsFiltered = True</code>  I&#39;m not sure what the <code>Select Case</code> is doing there?"}, {"owner": {"reputation": 3, "user_id": 4897774, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101053664046001/picture?type=large", "display_name": "Vitor.T", "link": "https://stackoverflow.com/users/4897774/vitor-t"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431625553, "post_id": 30227007, "comment_id": 48588771, "body": "Hi Tim, thanks for the reply. Yes, i&#39;ve tried that at the beggining, and it did not work. To clarify, the chart has 9 xvalues names. one of them, if present in the series, should hide. the great problem here seems to be having the variable check each series name, which it doesnt, it only checks one name, and it exits sub."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431627026, "post_id": 30227007, "comment_id": 48589625, "body": "What type of chart is it?  Seems like your XValues are categorical, not continuous?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4897774, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101053664046001/picture?type=large", "display_name": "Vitor.T", "link": "https://stackoverflow.com/users/4897774/vitor-t"}, "edited": false, "score": 0, "creation_date": 1431626030, "post_id": 30240264, "comment_id": 48589047, "body": "Hi Byron, thanks for the reply. your If code should be correct but it has one thing that we need to correct and that is the whole issue here.I&#39;ve tried your suggestion and it did not work as i expected. To clarify, the chart has 9 xvalues names. one of them, if present in the series, should hide. the great problem here seems to be to check each series name inside the series collection list of names. if you try to run your code, you will get it to check one name and then exit code. Any Suggestions how can we get the code to check all the series names in the x-axis?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 3, "user_id": 4897774, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101053664046001/picture?type=large", "display_name": "Vitor.T", "link": "https://stackoverflow.com/users/4897774/vitor-t"}, "edited": false, "score": 0, "creation_date": 1431627432, "post_id": 30240264, "comment_id": 48589864, "body": "I added the code to handle a category.  I think you can either hide a category or a series but not an individual bar that is specific to a single series and single category."}, {"owner": {"reputation": 3, "user_id": 4897774, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101053664046001/picture?type=large", "display_name": "Vitor.T", "link": "https://stackoverflow.com/users/4897774/vitor-t"}, "edited": false, "score": 0, "creation_date": 1431628313, "post_id": 30240264, "comment_id": 48590383, "body": "Thanks Byron, that works perfectly. I guess i was stuck looking for something too specific and i did not see any related items to my question. Thanks once again for the help."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1431627397, "last_edit_date": 1495540260, "creation_date": 1431614644, "answer_id": 30240264, "question_id": 30227007, "link": "https://stackoverflow.com/questions/30227007/excel-vba-unselect-a-specific-value-form-a-chart-series/30240264#30240264", "title": "excel vba unselect a specific value form a chart series", "body": "<p>The main issue with your code is that you are using a <code>Select Case</code> when you seem to just need a simple <code>If</code>.</p>\n\n<p>The corrected code for that is</p>\n\n<pre><code>Sub exmpl()\n\n    Dim MySeries As Series\n    ActiveSheet.ChartObjects(\"Chart 3\").Activate\n\n    For Each MySeries In ActiveChart.SeriesCollection\n      If MySeries.Name = \"NotThisSeries\" Then\n          ActiveChart.SeriesCollection(MySeries.Name).IsFiltered = True\n        End If\n    Next MySeries\n\nEnd Sub\n</code></pre>\n\n<p>If you want to use the <code>Select Case</code> to handle other names, here is the correct way to do that:</p>\n\n<pre><code>Sub exmpl()\n\n    Dim MySeries As Series\n    ActiveSheet.ChartObjects(\"Chart 3\").Activate\n\n    For Each MySeries In ActiveChart.SeriesCollection\n        Select Case MySeries.Name\n            Case \"NotThisSeries\"\n              ActiveChart.SeriesCollection(MySeries.Name).IsFiltered = True\n        End Select\n    Next MySeries\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong>, here is the corresponding code to hide a category instead of a series.</p>\n\n<pre><code>Sub exmpl()\n\n    Dim MySeries As Series\n    ActiveSheet.ChartObjects(\"Chart 3\").Activate\n\n    Dim i As Integer\n    Dim cat As ChartCategory\n\n    For i = 1 To ActiveChart.ChartGroups(1).FullCategoryCollection.Count\n\n        Set cat = ActiveChart.ChartGroups(1).FullCategoryCollection(i)\n\n        If cat.Name = \"NotThisSeries\" Then\n            cat.IsFiltered = True\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Here is another SO question that helped with the second part.  See comments to the question.  <a href=\"https://stackoverflow.com/questions/25896074/set-an-excel-chart-filter-with-vba\">Set an excel chart filter with VBA</a></p>\n"}], "owner": {"reputation": 3, "user_id": 4897774, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101053664046001/picture?type=large", "display_name": "Vitor.T", "link": "https://stackoverflow.com/users/4897774/vitor-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3828, "favorite_count": 0, "accepted_answer_id": 30240264, "answer_count": 1, "score": 0, "last_activity_date": 1431627397, "creation_date": 1431560565, "last_edit_date": 1531164843, "question_id": 30227007, "link": "https://stackoverflow.com/questions/30227007/excel-vba-unselect-a-specific-value-form-a-chart-series", "title": "excel vba unselect a specific value form a chart series", "body": "<p>this should be pretty basic for many participants here. Also, this is my first question here so I'm sorry if i make something wrong.</p>\n\n<p>I am trying to unselect a specific value from charts. Unselecting the category from the chart is the problem. Basically, from all the series in that chart. if one of the series name(Value) is iqual \"NotThisSeries\" then unselect it.</p>\n\n<pre><code>Sub exmpl()\n\nDim MySeries As Variant\n\nActiveSheet.ChartObjects(\"Chart 3\").Activate\n\nFor Each MySeries In ActiveChart.SeriesCollection\n\n  Select Case MySeries.XValues\n\n    Case MySeries.Name = \"NotThisSeries\"\n\n      ActiveChart.SeriesCollection(MySeries.Name).IsFiltered = True\n\n    Case Else\n\n  End Select\n\nNext MySeries\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1433531181, "post_id": 30673726, "comment_id": 49409777, "body": "both the subform and the main form is pulled from the same recordset. Both can add and delete records from the same recordset."}, {"owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1433531388, "post_id": 30673726, "comment_id": 49409879, "body": "even though the link child fields and master fields are set, the main form does not requery when add and delete commands are given from the subform."}, {"owner": {"reputation": 68, "user_id": 4430215, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uNDLCB7M50o/AAAAAAAAAAI/AAAAAAAADjs/VSgwAmJqn-0/photo.jpg?sz=128", "display_name": "Anthony A Gaff", "link": "https://stackoverflow.com/users/4430215/anthony-a-gaff"}, "reply_to_user": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1433531920, "post_id": 30673726, "comment_id": 49410132, "body": "Sorry, I misunderstood that.Perhaps you should use a separate query to pull the subform data."}, {"owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1433533328, "post_id": 30673726, "comment_id": 49410840, "body": "It is, I think. The record source (a query in itself right?) for the subform is different from the record source of the main form. It is just that they both pull from the same table, PartDetails."}, {"owner": {"reputation": 68, "user_id": 4430215, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uNDLCB7M50o/AAAAAAAAAAI/AAAAAAAADjs/VSgwAmJqn-0/photo.jpg?sz=128", "display_name": "Anthony A Gaff", "link": "https://stackoverflow.com/users/4430215/anthony-a-gaff"}, "reply_to_user": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1433533574, "post_id": 30673726, "comment_id": 49410967, "body": "Okay. Shucks. Are you dealing with confidential stuff, or are you able to send a copy of the file(s)?"}], "tags": [], "owner": {"reputation": 68, "user_id": 4430215, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uNDLCB7M50o/AAAAAAAAAAI/AAAAAAAADjs/VSgwAmJqn-0/photo.jpg?sz=128", "display_name": "Anthony A Gaff", "link": "https://stackoverflow.com/users/4430215/anthony-a-gaff"}, "is_accepted": false, "score": 0, "last_activity_date": 1433530143, "creation_date": 1433530143, "answer_id": 30673726, "question_id": 30226921, "link": "https://stackoverflow.com/questions/30226921/deleting-adding-records-on-a-subform-that-has-a-similar-record-source-of-the-mai/30673726#30673726", "title": "Deleting/Adding records on a subform that has a similar record source of the main form", "body": "<p>Maybe I'm not understanding the situation correctly, but there shouldn't be any need for VBA to achieve this. If the subform is using the Link Master Fields and the Link Child Fields with your subform, those IDs would work automatically. And if you have a relationship set up between the two tables, if you delete the Order record (and have Enforce Referential Integrity: Cascade Delete) selected, it should clear out the line items automatically to avoid orphan records.</p>\n"}], "owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433530143, "creation_date": 1431560092, "last_edit_date": 1431714590, "question_id": 30226921, "link": "https://stackoverflow.com/questions/30226921/deleting-adding-records-on-a-subform-that-has-a-similar-record-source-of-the-mai", "title": "Deleting/Adding records on a subform that has a similar record source of the main form", "body": "<p>I am trying to make a subform that works similarly to a splitform. </p>\n\n<p>I would use splitform but, as far as I could tell, I can't filter only the results of the datasheet portion of the split form, and not the results of the rest.\nSee here...<img src=\"https://i.stack.imgur.com/tzZEy.png\" alt=\"Part Details Form as img\"> </p>\n\n<p>The subformPartDetail only returns records where the OrderID is equal to the mainform's OrderID. There is no filter in the mainform so it returns all partDetail Records regardless of the OrderID. In this particular instance, the main form has 21 records to cycle where as the subform only has four.</p>\n\n<p>An issue occured when I use the subform for adding or deleting records. When I try to use the main form to cycle through the records, the added ones were skipped and the deleted ones threw an error telling me that the record I was attempting to go to has been deleted.\nI corrected it like this by putting these on the subform events... </p>\n\n<pre><code>Private Sub Form_AfterInsert()\nDim frm As Form\nDim rst As Recordset\nSet frm = Forms!PartDetails\nSet rst = frm.Recordset\n\nrst.Requery\nEnd Sub\n\nPrivate Sub Form_Delete(Cancel As Integer)\nDim frm As Form\nDim rst As Recordset\nSet frm = Forms!PartDetails\nSet rst = frm.Recordset\n\nrst.Requery\nEnd Sub\n</code></pre>\n\n<p>But say I try to delete the record the mainform is displaying from the subform. That code does not work and will not requery. It throws an error when I cycle away from and then back to that record.</p>\n\n<p>How can I fix this?</p>\n\n<p>I know I can move the record from the deleted one before it deletes by using</p>\n\n<pre><code> rst.move\n</code></pre>\n\n<p>I don't know where to began for testing whether the record that is being deleted is the same one that the main form is displaying.</p>\n"}, {"tags": ["vba", "excel", "url"], "answers": [{"comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1431554669, "post_id": 30225951, "comment_id": 48555834, "body": "@TimVilliams Hey Tim, the .Focus() gives syntax error, that&#39;s only for VB.net maybe?"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1431554806, "post_id": 30225951, "comment_id": 48555891, "body": "@TimVilliams I edited with .Focus() = True, which removes the syntax error but the password field is still empty"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1431555872, "post_id": 30225951, "comment_id": 48556360, "body": "I can&#39;t make any more suggestions without seeing the complete page source."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1431556459, "post_id": 30225951, "comment_id": 48556557, "body": "Thanks Tim, I wish I can show you more but unfortunately I cannot do it.  Thanks for your input anyways"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1431621833, "post_id": 30225951, "comment_id": 48586569, "body": "If I had the page in front of me, I would drill into the <b>Inspect Element</b> and use the console to investigate the <i>class=&quot;password&quot;</i> in the CSS to see just what made that special."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1431702025, "post_id": 30225951, "comment_id": 48625289, "body": "@Jeeped thanks I will look into that, but there shouldn&#39;t be much except a bunch of javascripts (that doesn&#39;t affects the password)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431707115, "post_id": 30225951, "comment_id": 48628714, "body": "&quot;except a bunch of javascripts&quot; - those are probably <i>why</i> your code is not doing what you want..."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1431720797, "post_id": 30225951, "comment_id": 48635724, "body": "So Tim do you mean it is possible to have javascript that prevents assigning value to the element, or in any ways preventing us from targetting the correct element?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431724308, "post_id": 30225951, "comment_id": 48637345, "body": "Yes - that could be done, but without the full source it&#39;s impossible to verify.  I did have a thought that it might be not possible to set the value of a &quot;password&quot; type input from VBA, but I just tested (IE9) and it worked fine, so something else is blocking your attempt."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1431554532, "creation_date": 1431554532, "answer_id": 30225951, "question_id": 30225843, "link": "https://stackoverflow.com/questions/30225843/vba-document-all-item-only-works-on-username-but-not-password/30225951#30225951", "title": "VBA document.all.item only works on username but not password", "body": "<p>Try:</p>\n\n<pre><code>With .Document.getElementById(\"os_password\")\n    .Focus()\n    .Value = \"abc\"\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1431614790, "post_id": 30226788, "comment_id": 48582062, "body": "Hi Jeeped thanks for your answer.  I did a search on the entire source page and those 4 &#39;os_password&#39; shown on the question are the only match.  Also, both os_username/os_pasword are under the same form &quot;loginform&quot;.  I used your code and it gives me error 438 - Obj doesn&#39;t support this property or method on the .Value lines"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1431620847, "post_id": 30226788, "comment_id": 48585980, "body": "Oh well - that was my 2&#162;. On rare occasions even a blind man can hit a bullseye but this isn&#39;t one of them."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1431621147, "post_id": 30226788, "comment_id": 48586164, "body": "no your approach is definitly correct - to target the correct group before assigning."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1431559754, "last_edit_date": 1431559754, "creation_date": 1431559349, "answer_id": 30226788, "question_id": 30225843, "link": "https://stackoverflow.com/questions/30225843/vba-document-all-item-only-works-on-username-but-not-password/30226788#30226788", "title": "VBA document.all.item only works on username but not password", "body": "<p>I don't believe that the focus has anything to do with your problem. That would be like saying that you could not <code>Range(\"B1\") = \"abc\"</code> if A1 was the <em>ActiveCell</em>. As long as you are directly transferring the string to the <code>.Value</code> property, focus should not be an issue. If you were sending keystrokes then perhaps focus becomes important but we aren't going to do that.</p>\n\n<p>I have run into a similar situation which a login page that was multiple purpose. The same 'landing page' had separate login forms for both buyers and sellers. I suspect that a close examination of the HTML behind that page will show that there are in fact two elements with identical Names/IDs (e.g. <em>os_password</em>). Further to all that, the <code>.Document.all.Item(\"something\")</code> method can be used for either names or IDs; not the most definitive method of assigning a value. It would seem that you are setting something identified as <em>os_password</em>; just not the right <em>os_password</em>.</p>\n\n<p>If this is the situation, you will have to address the password input as a child of the form you want to process, not of the entire document body. If your form had an ID of <em>Second_Form</em> then you would access the input fields like this:</p>\n\n<pre><code>    dim eFRM as MSHTML.IHTMLElement\n    set eFRM  = ieApp.document.getElementById(\"Second_Form\")\n    eFRM.getElementById(\"os_username\").Value = \"guest\"\n    eFRM.getElementById(\"os_password\").Value = \"abc\"\n    'don't use names to locate elements - horribly unreliable\n    eFRM.submit\n</code></pre>\n"}], "owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4152, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432910287, "creation_date": 1431554082, "last_edit_date": 1432910287, "question_id": 30225843, "link": "https://stackoverflow.com/questions/30225843/vba-document-all-item-only-works-on-username-but-not-password", "title": "VBA document.all.item only works on username but not password", "body": "<p>First, here's the code:  (the code are no different from standard codes for vba-open-website if that save you time reading, I placed a <strong>&lt;---------HERE</strong> to indicate where I put my password)</p>\n\n<pre><code>Sub Login_2Wiki()\n\nDim ieApp As InternetExplorer\n Dim ieDoc As Object\n Dim ieTable As Object\n Dim clip As DataObject\n Dim iusr As Object\n Dim ipwd As Object\n Dim iform As Object\n\n'create a new instance of ie\n Set ieApp = New InternetExplorer\n\n'you don\u2019t need this, but it\u2019s good for debugging\n ieApp.Visible = True\n\n'assume we\u2019re not logged in and just go directly to the login page\n ieApp.Navigate \"https://xxx.xxxxx.com/login.action?\"\n Do While ieApp.Busy: DoEvents: Loop\n Do Until ieApp.ReadyState = READYSTATE_COMPLETE: DoEvents: Loop\n\nSet ieDoc = ieApp\n\n'fill in the login form \u2013 View Source from your browser to get the control names\n With ieDoc\n Set iform = .Document.getElementById(\"login-container\")\n Set iusr = iform.Document.getElementById(\"os_username\")\n iusr.Value = \"guest\"\n Set ipwd = iform.Document.getElementById(\"os_password\")\n ipwd.Value = \"abc\"\n\n .Document.getelementsbyname(\"loginButton\")(0).Click\n End With\n Do While ieApp.Busy: DoEvents: Loop\n Do Until ieApp.ReadyState = READYSTATE_COMPLETE: DoEvents: Loop\n\n\n'close 'er up\n ieApp.Quit\n Set ieApp = Nothing\n\nEnd Sub  \n</code></pre>\n\n<p>and Here's part of the source code on the webpage (it is a <strong>Atlassian Confluence</strong> page if that matters):  </p>\n\n<pre><code>&lt;div class=\"field-group\n\"\n    &gt;\n&lt;label id=\"os_username-label\" for=\"os_username\"&gt;\nUsername\n    &lt;/label&gt;\n\n            &lt;input type=\"text\" name=\"os_username\" id=\"os_username\" class=\"text   \" placeholder=\"Username\" data-focus=\"0\"     /&gt;\n                  &lt;/div&gt;                        \n\n&lt;div class=\"field-group\"&gt;\n&lt;label id=\"os_password-label\" for=\"os_password\"&gt;\nPassword\n    &lt;/label&gt;\n&lt;input type=\"password\" name=\"os_password\" id=\"os_password\"  class=\"password \" placeholder=\"Password\"  /&gt;\n              &lt;/div&gt;                        \n</code></pre>\n\n<p>Problem: the code only filled the username but not password on the webpage.  It gives no errors.  Also I notice there is a <strong>data-focus = \"0\"</strong> in the source view of the webpage, and wonder if that's the thing causing the problem.</p>\n\n<blockquote>\n  <p>EDIT: I've replace <strong>.Document.all.Item</strong>  with\n  <strong>.Document.getElementById</strong> method, althought the code <em>can</em> find the element os_password (no errors), it fails to assign value to it.  os_username is working as before.</p>\n</blockquote>\n"}, {"tags": ["vba", "user-interface", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "edited": false, "score": 0, "creation_date": 1431555581, "post_id": 30225190, "comment_id": 48556248, "body": "Thank you so much! This saved me :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1431551130, "last_edit_date": 1495540714, "creation_date": 1431551130, "answer_id": 30225190, "question_id": 30225126, "link": "https://stackoverflow.com/questions/30225126/how-to-make-user-form-output-at-the-end-of-a-column-in-excel-vba/30225190#30225190", "title": "How to make User Form Output at the end of a column in Excel VBA", "body": "<p>You need to find the last row in that column and then write to it. Here is an example (<strong>Untested</strong>). You can read more about finding the last row <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">Here</a></p>\n\n<pre><code>Dim ws As Worksheet\nDim lRow As Long\nDim rng As Range\n\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\n\nWith ws\n    '~~&gt; We add 1 so that we get the next empty cell\n    lRow = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row + 1\n\n    Set rng = .Range(\"E\" &amp; lRow)\n\n    If opt1 Then\n        rng.Value = \"None\"\n    ElseIf opt2 Then\n        rng.Value = \"3/8 Plain\"\n    ElseIf opt3 Then\n        rng.Value = \"1/2 Plain\"\n    ElseIf opt4 Then\n        rng.Value = \"1/2 Herringbone\"\n    ElseIf opt5 Then\n        rng.Value = \"1/2 Diamond\"\n    End If\nEnd With\nUnload frmLagging\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1431555538, "post_id": 30225581, "comment_id": 48556232, "body": "Adjusted code to place value in next empty cell in column A"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1431555506, "last_edit_date": 1431555506, "creation_date": 1431552917, "answer_id": 30225581, "question_id": 30225126, "link": "https://stackoverflow.com/questions/30225126/how-to-make-user-form-output-at-the-end-of-a-column-in-excel-vba/30225581#30225581", "title": "How to make User Form Output at the end of a column in Excel VBA", "body": "<p>Also,\nHere is one of my favorite iif statements,</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim Rws As Long, Rng As Range, x\n    Rws = Cells(Rows.Count, \"E\").End(xlUp).Row\n\n    Set Rng = Cells(Rws + 1, \"E\")\n\n    x = IIf(Opt1, \"None\", IIf(Opt2, \"3/8 Plain\", IIf(Opt3, \"1/2 Plain\", IIf(Opt4, \"1/2 Herringbone\", IIf(Opt5, \"1/2 Diamond\", \"Nada\")))))\n    Rng = x\n\n    Unload Me\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 30225190, "answer_count": 2, "score": 1, "last_activity_date": 1431555506, "creation_date": 1431550945, "question_id": 30225126, "link": "https://stackoverflow.com/questions/30225126/how-to-make-user-form-output-at-the-end-of-a-column-in-excel-vba", "title": "How to make User Form Output at the end of a column in Excel VBA", "body": "<p>I'm trying to make this user form output option button results at the end of a column. Originally I tried using the same i in the for next loop that I have in my main module, but the user form wouldn't recognize the variable, even after dimensioning it as public. Any ideas?</p>\n\n<pre><code>Private Sub cmdOk_Click()\n\nIf opt1 Then\n    Range(Range(\u201cE3\u201d), Range(\u201cE3\u201d).End(xlDown)) = \"None\"\nElseIf opt2 Then\n    Range(Range(\u201cE3\u201d), Range(\u201cE3\u201d).End(xlDown)) = \"3/8 Plain\"\nElseIf opt3 Then\n    Range(Range(\u201cE3\u201d), Range(\u201cE3\u201d).End(xlDown)) = \"1/2 Plain\"\nElseIf opt4 Then\n    Range(Range(\u201cE3\u201d), Range(\u201cE3\u201d).End(xlDown)) = \"1/2 Herringbone\"\nElseIf opt5 Then\n    Range(Range(\u201cE3\u201d), Range(\u201cE3\u201d).End(xlDown)) = \"1/2 Diamond\"\nEnd If\n\nUnload frmLagging\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 3762977, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/suRLj.jpg?s=128&g=1", "display_name": "user3762977", "link": "https://stackoverflow.com/users/3762977/user3762977"}, "edited": false, "score": 0, "creation_date": 1431552546, "post_id": 30225372, "comment_id": 48554908, "body": "Yep, I had come up with something sort of similar before coming back and seeing this. Since there&#39;s something that the button deletes anyway, I can just make the conditional statement look for that. Thanks."}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 0, "last_activity_date": 1431551953, "creation_date": 1431551953, "answer_id": 30225372, "question_id": 30224857, "link": "https://stackoverflow.com/questions/30224857/vba-in-word-code-to-delete-or-change-code-from-thisdocument/30225372#30225372", "title": "VBA in Word code to delete or change code from ThisDocument", "body": "<p>A simpler way would be to have a variable of type Boolean. When the button is clicked change the value of the Boolean, and then use a conditional statement to re-enable saving</p>\n"}, {"tags": [], "owner": {"reputation": 541, "user_id": 3762977, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/suRLj.jpg?s=128&g=1", "display_name": "user3762977", "link": "https://stackoverflow.com/users/3762977/user3762977"}, "is_accepted": false, "score": 0, "last_activity_date": 1431570657, "last_edit_date": 1431570657, "creation_date": 1431552429, "answer_id": 30225466, "question_id": 30224857, "link": "https://stackoverflow.com/questions/30224857/vba-in-word-code-to-delete-or-change-code-from-thisdocument/30225466#30225466", "title": "VBA in Word code to delete or change code from ThisDocument", "body": "<p>I got this to work a different way, making the code that disables save an If statement:</p>\n\n<pre><code>Sub FileSave()\nIf ActiveDocument.Bookmarks.Exists(\"table\") = True Then\n    MsgBox \"Save is Disabled.\" &amp; vbNewLine &amp; \"\" &amp; vbNewLine &amp; \"To save changes, use Save As and overwrite your file.\"\n\nElse:\nIf ActiveDocument.Saved = False Then ActiveDocument.Save\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It looks for a bookmark that gets deleted on the button click event, and if it exists then save is blocked. Once the bookmark has been deleted, users can save again.</p>\n\n<p>I'd still be curious to know how to delete code if anyone knows but this is a simpler approach I guess.</p>\n"}], "owner": {"reputation": 541, "user_id": 3762977, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/suRLj.jpg?s=128&g=1", "display_name": "user3762977", "link": "https://stackoverflow.com/users/3762977/user3762977"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 30225372, "answer_count": 2, "score": -1, "last_activity_date": 1431570657, "creation_date": 1431549867, "last_edit_date": 1431550329, "question_id": 30224857, "link": "https://stackoverflow.com/questions/30224857/vba-in-word-code-to-delete-or-change-code-from-thisdocument", "title": "VBA in Word code to delete or change code from ThisDocument", "body": "<p>I have some code in a Microsoft Word .docm file that disables the save function and pops up a message:</p>\n\n<pre><code>Sub FileSave()\nMsgBox \"Save is Disabled.\" &amp; vbNewLine &amp; \"\" &amp; vbNewLine &amp; \"To save changes, use Save As.\"\nEnd Sub\n</code></pre>\n\n<p>This might be tricky but what I want to do now is disable <em>that</em> code, that is, to enable saving again, on a certain trigger event (when a user clicks a button).</p>\n\n<p>When the document is first opened I have it so only save as is enabled, not save. After a certain event, I want save to work again. </p>\n\n<p>I've gotten things like this to work, to programmatically <strong><em>add</em></strong> code to ThisDocument:</p>\n\n<pre><code> ThisDocument.VBProject.VBCompontents(\"ThisDocument\").CodeModule.AddFromString \"Private Sub Document_Close(): ActiveDocument.Saved = True: End Sub\"\n</code></pre>\n\n<p>However I don't know if there is a way to edit or delete code, using other code.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "edited": false, "score": 0, "creation_date": 1431704270, "post_id": 30232408, "comment_id": 48626806, "body": "Thanks. I did not realize any filtering set by the user triggers an update to the form&#39;s filter property. (Which makes sense)"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1505984955, "post_id": 30232408, "comment_id": 79639327, "body": "The <code>Filter</code> might contain a value but if <code>FilterOn</code> is False, it is not applied"}], "tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": true, "score": 1, "last_activity_date": 1431591020, "creation_date": 1431591020, "answer_id": 30232408, "question_id": 30224699, "link": "https://stackoverflow.com/questions/30224699/access-vba-able-to-detect-forms-filter-settings/30232408#30232408", "title": "Access VBA able to detect form&#39;s filter settings?", "body": "<p>That is fairly easy. The form's <code>Filter</code>-Property contains the filter expression. You should be able to use it directly in the where-condition of the report.</p>\n"}], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "accepted_answer_id": 30232408, "answer_count": 1, "score": 0, "last_activity_date": 1594644663, "creation_date": 1431549299, "last_edit_date": 1594644663, "question_id": 30224699, "link": "https://stackoverflow.com/questions/30224699/access-vba-able-to-detect-forms-filter-settings", "title": "Access VBA able to detect form&#39;s filter settings?", "body": "<p>Is there a way to determine what filter settings a user has selected in order to translate them into SQL?</p>\n\n<p>I have a form in continuous form view that a user can switch to data sheet view, set filters on any of the columns, then flip back to the continuous form view to see the results. I have a companion report with the same format as the continuous form and want to filter it by passing it the criteria in SQL.</p>\n\n<p>I am thinking I can use the recordset clone property to identify the records based on key value, but wondered if there was a way to detect what the user actually filtered on?</p>\n\n<p>Ideas?</p>\n"}, {"tags": ["macos", "vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1431549178, "post_id": 30224556, "comment_id": 48553168, "body": "<code>Sub</code>? Or did you want it as <code>Public Function FindABV(temperature)</code>?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549344, "post_id": 30224556, "comment_id": 48553238, "body": "You may want to see <a href=\"http://www.excel-easy.com/vba/function-sub.html\" rel=\"nofollow noreferrer\">This</a>"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549364, "post_id": 30224556, "comment_id": 48553248, "body": "@SiddharthRout is correct.  You have to define it as a function if you want to use in a <code>Formula</code>.  However, you&#39;re cell references are hard-coded so it probably won&#39;t work as you intend."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1431549502, "post_id": 30224556, "comment_id": 48553314, "body": "You are not going to be able have a fully functioning UDF that changes values in cells other than the cell in which it resides."}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1431549869, "last_edit_date": 1431549869, "creation_date": 1431549518, "answer_id": 30224765, "question_id": 30224556, "link": "https://stackoverflow.com/questions/30224556/that-name-is-not-valid-for-my-vba-function-in-excel-mac/30224765#30224765", "title": "&quot;That name is not valid&quot; for my VBA function in Excel/Mac", "body": "<blockquote>\n  <p>The Sub procedure performs a task and then returns control to the calling code, but it does not return a value to the calling code.</p>\n</blockquote>\n\n<p>See more <a href=\"https://msdn.microsoft.com/en-us/library/831f9wka.aspx\" rel=\"nofollow\">here</a>.</p>\n\n<p>This said, you cannot set a procedure equal to something: </p>\n\n<pre><code>FindABV = .Range(\"B28\").Value\n</code></pre>\n\n<p>because <em>that name is not valid</em> (you cannot say that a procedure is equal to a certain value, it doesn't make sense). You probably wanted to use a <a href=\"https://msdn.microsoft.com/en-us/library/sect4ck6.aspx\" rel=\"nofollow\">Function</a> to return the value of that cell calculated by the Goal Seeker depending on the input <code>temperature</code> that you pass by the function:</p>\n\n<pre><code>Function FindABV(temperature)\nWith Worksheets(\"Sheet1\")\n    .Range(\"C28\").GoalSeek _\n    Goal:=temperature, _\n    ChangingCell:=.Range(\"B28\")\nEnd With\nFindABV = .Range(\"B28\").Value '&lt;-- return the value\nEnd Function\n</code></pre>\n\n<p>However, be careful: if <code>=FindABV(temperature)</code> lies on <code>Sheet1.Range(\"B28\")</code>, you will have a circular reference because your function will try to have the value of itself. </p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 3238181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/27daabe8dc76105ce5968fe497761cea?s=128&d=identicon&r=PG&f=1", "display_name": "user3238181", "link": "https://stackoverflow.com/users/3238181/user3238181"}, "edited": false, "score": 0, "creation_date": 1431558221, "post_id": 30225328, "comment_id": 48557082, "body": "Thanks for that insight! I wasn&#39;t aware that a Function can&#39;t change a value in a cell. That would appear to mean that what I&#39;m trying for is hopeless. Is there some other way to make GoalSeek work as a callable function?"}, {"owner": {"reputation": 105, "user_id": 3238181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/27daabe8dc76105ce5968fe497761cea?s=128&d=identicon&r=PG&f=1", "display_name": "user3238181", "link": "https://stackoverflow.com/users/3238181/user3238181"}, "edited": false, "score": 0, "creation_date": 1431558647, "post_id": 30225328, "comment_id": 48557198, "body": "Interestingly, Excel is perfectly happy to change cell values when called by AppleScript. But I was hoping to create a calculator that I could share even with Windows users."}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "reply_to_user": {"reputation": 105, "user_id": 3238181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/27daabe8dc76105ce5968fe497761cea?s=128&d=identicon&r=PG&f=1", "display_name": "user3238181", "link": "https://stackoverflow.com/users/3238181/user3238181"}, "edited": false, "score": 0, "creation_date": 1431608321, "post_id": 30225328, "comment_id": 48577538, "body": "You could always perform the operation that Excel performs in <code>GoalSeek</code> yourself by stepping up to the value in very small increments until you overshoot and then return the closest value."}, {"owner": {"reputation": 105, "user_id": 3238181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/27daabe8dc76105ce5968fe497761cea?s=128&d=identicon&r=PG&f=1", "display_name": "user3238181", "link": "https://stackoverflow.com/users/3238181/user3238181"}, "edited": false, "score": 0, "creation_date": 1431616820, "post_id": 30225328, "comment_id": 48583437, "body": "Yes, I actually searched for some code I could borrow to do this kind of iterative solution, but wasn&#39;t able to find anything. Seems like it ought to be available somewhere. I don&#39;t know VBA well enough to try it myself without extensive study. (Can you pass a function as a parameter to a VBA routine?) I&#39;ve seen mention of something called &quot;Solver&quot;\u2014is that potentially usable?"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "reply_to_user": {"reputation": 105, "user_id": 3238181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/27daabe8dc76105ce5968fe497761cea?s=128&d=identicon&r=PG&f=1", "display_name": "user3238181", "link": "https://stackoverflow.com/users/3238181/user3238181"}, "edited": false, "score": 0, "creation_date": 1431618313, "post_id": 30225328, "comment_id": 48584424, "body": "If the function you are solving is always the same you can use Newton&#39;s Method to solve it.  If the function changes you&#39;ll have to devise an approach with events and macros."}], "tags": [], "owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "is_accepted": false, "score": 0, "last_activity_date": 1431551733, "creation_date": 1431551733, "answer_id": 30225328, "question_id": 30224556, "link": "https://stackoverflow.com/questions/30224556/that-name-is-not-valid-for-my-vba-function-in-excel-mac/30225328#30225328", "title": "&quot;That name is not valid&quot; for my VBA function in Excel/Mac", "body": "<p>Your code will not deliver the results you want.  If you want to have the <code>Function</code> work for different values than the ones stored in <code>B28</code> and <code>C28</code> you'll have to write it more like this:</p>\n\n<pre><code>Public Function FindABV(goalCell As Range, changeCell As Range, temperature As Double)\n\n    goalCell.GoalSeek Goal:=temperature, ChangingCell:=changeCell\n\n    FindABV = changeCell\nEnd Function\n</code></pre>\n\n<p>But this doesn't matter in any case because <code>GoalSeek</code> actually changes the value in the <code>ChangingCell</code> which <code>Excel</code> will not do if it is called from within a <code>Function</code>.</p>\n"}], "owner": {"reputation": 105, "user_id": 3238181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/27daabe8dc76105ce5968fe497761cea?s=128&d=identicon&r=PG&f=1", "display_name": "user3238181", "link": "https://stackoverflow.com/users/3238181/user3238181"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 844, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1431551733, "creation_date": 1431548702, "question_id": 30224556, "link": "https://stackoverflow.com/questions/30224556/that-name-is-not-valid-for-my-vba-function-in-excel-mac", "title": "&quot;That name is not valid&quot; for my VBA function in Excel/Mac", "body": "<p>A simple VBA function. When I try to use it in my worksheet, all I get, no matter what I do, is \"That name is not valid\". I'm out of ideas. </p>\n\n<pre><code>Sub FindABV(temperature)\nWith Worksheets(\"Sheet1\")\n    .Range(\"C28\").GoalSeek _\n    Goal:=temperature, _\n    ChangingCell:=.Range(\"B28\")\nEnd With\nFindABV = .Range(\"B28\").Value\nEnd Sub\n</code></pre>\n\n<p>I've tried creating a new Module to put it in. No change. \nAnd no error indications from the code editor. </p>\n"}, {"tags": ["arrays", "excel", "replace", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1431548954, "post_id": 30224542, "comment_id": 48553044, "body": "Can you post a screenshot of your data? Also I see few errors. <code>1</code> dOllar is a variable but you ar eusing it as a string object when you say  \u201cdOllar\u201d &amp; \u201clRepl\u201d <code>2</code> RangeforRepl is a range object but you are not using <code>Set</code> to assign range to it..."}, {"owner": {"reputation": 11, "user_id": 3893169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eab790b65896ec0d2094cf0e8268b3?s=128&d=identicon&r=PG&f=1", "display_name": "jchrb", "link": "https://stackoverflow.com/users/3893169/jchrb"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431574151, "post_id": 30224542, "comment_id": 48560980, "body": "Thank you, it seems to be working (no bugs) but cannot see any changes in active sheet.  I cannot add my screen shot here. How do I do this? Thank you again."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431584987, "post_id": 30224542, "comment_id": 48564476, "body": "upload it to wikisend.com and share the ink here :)"}, {"owner": {"reputation": 11, "user_id": 3893169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eab790b65896ec0d2094cf0e8268b3?s=128&d=identicon&r=PG&f=1", "display_name": "jchrb", "link": "https://stackoverflow.com/users/3893169/jchrb"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431599825, "post_id": 30224542, "comment_id": 48572281, "body": "here is the screen shot <a href=\"http://wikisend.com/download/440070/Screen\" rel=\"nofollow noreferrer\">wikisend.com/download/440070/Screen</a> Shot 2015-05-14 at 12.26.12.JPG"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3893169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eab790b65896ec0d2094cf0e8268b3?s=128&d=identicon&r=PG&f=1", "display_name": "jchrb", "link": "https://stackoverflow.com/users/3893169/jchrb"}, "edited": false, "score": 0, "creation_date": 1432058144, "post_id": 30224621, "comment_id": 48760188, "body": "Hi, many thanks again. I did apply the changes and to make it work I had to name the range (&#39;test&#39;).  Then it worked perfectly."}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 1, "last_activity_date": 1431548954, "creation_date": 1431548954, "answer_id": 30224621, "question_id": 30224542, "link": "https://stackoverflow.com/questions/30224542/why-is-this-not-working-vba-select-variable-active-ranges-for-multiple-find-and/30224621#30224621", "title": "Why is this not working VBA? Select variable active ranges for multiple find and replace", "body": "<p>Change <code>RangeforRepl = ActiveSheet.Range(cells(2, 2),cells(26.3).Offset(0, \"lCol\").Select</code></p>\n\n<p>to</p>\n\n<p><code>Set RangeforRepl = ActiveSheet.Range(cells(2, 2),cells(26.3).Offset(0,\"lCol\")</code></p>\n\n<p><code>Range</code>s are objects, and need to be defined using the <code>Set</code> keyword.</p>\n\n<p>Also <code>cOntentRpl = \u201cdOllar\u201d &amp; \u201clRepl\u201d</code> should be <code>cOntentRpl = dOllar &amp; lRepl</code></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3893169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eab790b65896ec0d2094cf0e8268b3?s=128&d=identicon&r=PG&f=1", "display_name": "jchrb", "link": "https://stackoverflow.com/users/3893169/jchrb"}, "is_accepted": false, "score": 1, "last_activity_date": 1432058480, "creation_date": 1432058480, "answer_id": 30332896, "question_id": 30224542, "link": "https://stackoverflow.com/questions/30224542/why-is-this-not-working-vba-select-variable-active-ranges-for-multiple-find-and/30332896#30332896", "title": "Why is this not working VBA? Select variable active ranges for multiple find and replace", "body": "<p>Based on the help I received, here is the code that solved my problem: </p>\n\n<pre><code>Dim lCount, lCol, lRepl As Integer\nDim fFind, dOllar, cOntentRpl As String\nDim rAngeforRepl As Range\n\nlCol = 0\nlRepl = 10\nfFind = \"$3\"\ndOllar = \"$\"\n\nFor lCount = 1 To 10 Step 1\n\nlCol = lCol + 2\nlRepl = lRepl + 1\n\ncOntentRpl = dOllar &amp; lRepl\n\nSet rAngeforRepl = ActiveSheet.Range(\"Basis\").Offset(0, lCol)\n\nrAngeforRepl.Replace fFind, cOntentRpl, xlPart\n\nNext lCount\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3893169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eab790b65896ec0d2094cf0e8268b3?s=128&d=identicon&r=PG&f=1", "display_name": "jchrb", "link": "https://stackoverflow.com/users/3893169/jchrb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432058480, "creation_date": 1431548641, "last_edit_date": 1531164843, "question_id": 30224542, "link": "https://stackoverflow.com/questions/30224542/why-is-this-not-working-vba-select-variable-active-ranges-for-multiple-find-and", "title": "Why is this not working VBA? Select variable active ranges for multiple find and replace", "body": "<p>For 400 successive and contiguous ranges of two columns (from line 2 to 26), I need to make 400 different changes.  All ranges contain \"$3\" within strings in many of the cell, part that needs to be replaced by \"$x\" and where x increases by 1 unit after each find and replace iteration (\"each jump to the next two columns to the right, each ranges are 2 column wide). </p>\n\n<p>This is the first time I use VBA have looked in many place within and outside stackoverflow and tried different routines all day. The routine below has a bug with Active Sheet and Replace functions. Thank you for your help.</p>\n\n<pre><code> Dim lCount, lCol, lRepl As Integer\n Dim fFind, dOllar, cOntentRpl As String\n Dim RangeforRepl As Range\n\n lCol = 0\n lRepl = 4\n fFind = \"$3\"\n dOllar = \"$\"\n\n For lCount = 1 To 400 Step 1\n\n    lCol = lCol + 2            'jump of two columns each time\n    lRepl = lRepl + 1            'adjust variable element of replacement value\n\n    cOntentRpl = \u201cdOllar\u201d &amp; \u201clRepl\u201d  'replacement value, starts with \"$5\"\n\n      RangeforRepl = ActiveSheet.Range(cells(2, 2),cells(26.3).\n      Offset(0, \"lCol\").Select      ' Select range where find &amp; replace should take place\n\n      Worksheets(\"Sheet1\").RangeforRepl.Replace _ \n      What:=\"fFind\", Replacement:=\"cOntentRpl\", _ \n      LookAt:=2                                   'find and replace\n\n\n Next lCount\n</code></pre>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "string", "outlook"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1431551013, "post_id": 30224508, "comment_id": 48554085, "body": "Use the <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">InStr function</a> . Find the first and use that as the starting position to find the second."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4879567, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-RCVtW_2H240/AAAAAAAAAAI/AAAAAAAAAHc/jcPxrRIZfnI/photo.jpg?sz=128", "display_name": "san-jrel Sy", "link": "https://stackoverflow.com/users/4879567/san-jrel-sy"}, "edited": false, "score": 0, "creation_date": 1431554380, "post_id": 30225562, "comment_id": 48555699, "body": "Hi, thank you for your response. But, I can&#39;t understand the language you&#39;re using, I tried translating it but google translate doesn&#39;t translate it right."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 9, "user_id": 4879567, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-RCVtW_2H240/AAAAAAAAAAI/AAAAAAAAAHc/jcPxrRIZfnI/photo.jpg?sz=128", "display_name": "san-jrel Sy", "link": "https://stackoverflow.com/users/4879567/san-jrel-sy"}, "edited": false, "score": 0, "creation_date": 1431554627, "post_id": 30225562, "comment_id": 48555816, "body": "The text is unimportant. It is simply to provide some text that had your <i>keywords</i> inserted into it so that you could see the options from pulling out portions of text. If you are curios then look up <a href=\"http://lipsum.com/\" rel=\"nofollow noreferrer\">Lorum Ipsem</a> placeholder text for a brief history."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1431552834, "creation_date": 1431552834, "answer_id": 30225562, "question_id": 30224508, "link": "https://stackoverflow.com/questions/30224508/how-to-set-same-string-as-start-and-end-reference-to-copy-the-message-within-t/30225562#30225562", "title": "How to set same &quot;STRING&quot; as start and end reference to copy the message within those references?", "body": "<p>Consider the following approximation of an email's 'body text'</p>\n\n<blockquote>\n  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque fringilla mi et aliquam ornare. Sed et dolor posuere, feugiat mi ac, mattis augue. <strong>Good day!</strong> Ut lorem sem, pulvinar a erat a, tempus congue lorem. Nulla semper cursus ante ac euismod. Sed rutrum odio a nulla consectetur, scelerisque lacinia risus consectetur. <strong>Good day!</strong>  Fusce sit amet vulputate lorem, eu aliquam diam.</p>\n</blockquote>\n\n<p>Pass that text as a string through this function.</p>\n\n<pre><code>Function partial_body(sBDY As String, Optional sFND As String = \"Good day!\", Optional bINCL As Boolean = False)\n    Dim s As Long, f As Long\n    s = InStr(1, sBDY, sFND, vbTextCompare) - ((Not bINCL) * Len(sFND))\n    f = InStr(s + 1, sBDY, sFND, vbTextCompare) + (bINCL * Len(sFND))\n    partial_body = Trim(Mid(sBDY, s, f - s - (bINCL * Len(sFND)) * 2))\nEnd Function\n</code></pre>\n\n<p>Result for <code>partial_body(&lt;body&gt;)</code></p>\n\n<blockquote>\n  <p>Ut lorem sem, pulvinar a erat a, tempus congue lorem. Nulla semper cursus ante ac euismod. Sed rutrum odio a nulla consectetur, scelerisque lacinia risus consectetur.</p>\n</blockquote>\n\n<p>Result for <code>partial_body(&lt;body&gt;, \"Good day!\", True)</code></p>\n\n<blockquote>\n  <p>Good day! Ut lorem sem, pulvinar a erat a, tempus congue lorem. Nulla semper cursus ante ac euismod. Sed rutrum odio a nulla consectetur, scelerisque lacinia risus consectetur. Good day!</p>\n</blockquote>\n"}], "owner": {"reputation": 9, "user_id": 4879567, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-RCVtW_2H240/AAAAAAAAAAI/AAAAAAAAAHc/jcPxrRIZfnI/photo.jpg?sz=128", "display_name": "san-jrel Sy", "link": "https://stackoverflow.com/users/4879567/san-jrel-sy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593305938, "creation_date": 1431548542, "last_edit_date": 1593305938, "question_id": 30224508, "link": "https://stackoverflow.com/questions/30224508/how-to-set-same-string-as-start-and-end-reference-to-copy-the-message-within-t", "title": "How to set same &quot;STRING&quot; as start and end reference to copy the message within those references?", "body": "<p>I have an email that has a long body. I want to send part of the email body by setting a starting \"STRING\" reference and an ending same \"STRING\" reference.</p>\n\n<p>Let's say the \"STRING\" = \"Good day!\"</p>\n\n<p>Whenever the macro set the first string \"Good day!\" in the email body, I want the next \"Good day!\" string to be the ending reference without searching/finding another \"Good day!\" string so that the message within those two references can be copied to be sent as a new mail.</p>\n\n<p>I found this code that uses a UNIQUE string but I need the next string occurrence only after the first string reference. </p>\n\n<p><a href=\"http://www.outlookcode.com/codedetail.aspx?id=985\" rel=\"nofollow\">http://www.outlookcode.com/codedetail.aspx?id=985</a></p>\n\n<ul>\n<li>With this on hand, I'm thinking just to replace the 2nd \"Good day!\" with a UNIQUE string so that I can use this code but I still don't know how to search/find for the 2nd occurrence of the same string.</li>\n</ul>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 1, "creation_date": 1431548599, "post_id": 30224368, "comment_id": 48552880, "body": "The code you posted doesn&#39;t give enough information to answer this, but it sounds like it should go to <a href=\"http://codereview.stackexchange.com/\">Code Review</a> anyway."}, {"owner": {"reputation": 57830, "user_id": 2792531, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/teNzk.gif?s=128&g=1", "display_name": "nhgrif", "link": "https://stackoverflow.com/users/2792531/nhgrif"}, "edited": false, "score": 0, "creation_date": 1431548823, "post_id": 30224368, "comment_id": 48552979, "body": "Is this code working as intended or not?"}, {"owner": {"reputation": 41, "user_id": 4897246, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-lnmyIw4yVP8/AAAAAAAAAAI/AAAAAAAACWo/ezU8H-Bulgk/photo.jpg?sz=128", "display_name": "Sagar S", "link": "https://stackoverflow.com/users/4897246/sagar-s"}, "edited": false, "score": 1, "creation_date": 1431549246, "post_id": 30224368, "comment_id": 48553204, "body": "Thanks, I posted the question in Code Review with more code.  Please let me know if that helps."}, {"owner": {"reputation": 4495, "user_id": 1186165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/A0tKf.jpg?s=128&g=1", "display_name": "Kittoes0124", "link": "https://stackoverflow.com/users/1186165/kittoes0124"}, "edited": false, "score": 0, "creation_date": 1431549314, "post_id": 30224368, "comment_id": 48553225, "body": "You could aggregate the data for all pay periods at the same time instead of pulling it 1 by 1. You&#39;ll need to add payperiod to the SELECT in your SQL and GROUP BY it. Use the ADO you&#39;ve already written to dump the results to your desired cell range."}, {"owner": {"reputation": 41, "user_id": 4897246, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-lnmyIw4yVP8/AAAAAAAAAAI/AAAAAAAACWo/ezU8H-Bulgk/photo.jpg?sz=128", "display_name": "Sagar S", "link": "https://stackoverflow.com/users/4897246/sagar-s"}, "reply_to_user": {"reputation": 57830, "user_id": 2792531, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/teNzk.gif?s=128&g=1", "display_name": "nhgrif", "link": "https://stackoverflow.com/users/2792531/nhgrif"}, "edited": false, "score": 0, "creation_date": 1431549331, "post_id": 30224368, "comment_id": 48553231, "body": "Yes @nhgrif, the code is working as intended.  I am trying to &quot;condense&quot; the code if possible so it can populate values based on the range.  Hope I am making sense?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4897246, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-lnmyIw4yVP8/AAAAAAAAAAI/AAAAAAAACWo/ezU8H-Bulgk/photo.jpg?sz=128", "display_name": "Sagar S", "link": "https://stackoverflow.com/users/4897246/sagar-s"}, "edited": false, "score": 0, "creation_date": 1431551718, "post_id": 30224876, "comment_id": 48554495, "body": "I am having a hard time with the destination, I guess.  The range right now says H20:H45 but only populates H20.  My current code is: Sheets(2).Range(H20:H45).CopyFromRecordset rs"}, {"owner": {"reputation": 4495, "user_id": 1186165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/A0tKf.jpg?s=128&g=1", "display_name": "Kittoes0124", "link": "https://stackoverflow.com/users/1186165/kittoes0124"}, "reply_to_user": {"reputation": 41, "user_id": 4897246, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-lnmyIw4yVP8/AAAAAAAAAAI/AAAAAAAACWo/ezU8H-Bulgk/photo.jpg?sz=128", "display_name": "Sagar S", "link": "https://stackoverflow.com/users/4897246/sagar-s"}, "edited": false, "score": 0, "creation_date": 1431551912, "post_id": 30224876, "comment_id": 48554573, "body": "I forgot to add the payperiod column and a <code>GROUP BY</code> to the query. Without these changes the query will return a single result for all periods instead of a result for each period. Answer has been updated."}, {"owner": {"reputation": 41, "user_id": 4897246, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-lnmyIw4yVP8/AAAAAAAAAAI/AAAAAAAACWo/ezU8H-Bulgk/photo.jpg?sz=128", "display_name": "Sagar S", "link": "https://stackoverflow.com/users/4897246/sagar-s"}, "edited": false, "score": 0, "creation_date": 1431552753, "post_id": 30224876, "comment_id": 48555005, "body": "Sorry, @kittoes, that did not work.  I had to modify the code because it gave me a type mismatch error.  Here&#39;s what I have:  <code>Set rs = conn.Execute(&quot;SELECT sum(Hours)&#47;80 &quot; &amp; _           &quot;FROM payroll2015_rif &quot; &amp; _           &quot;WHERE DepartmentCode = &#39;&quot; &amp; Range(&quot;$E$6&quot;) &amp; &quot;&#39; &quot; &amp; _           &quot;AND payperiod IN (&quot; &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; &quot;)&quot; &amp; _           &quot;AND paycode IN (&#39;REG1&#39;, &#39;REG2&#39;) &quot; &amp; _           &quot;GROUP BY payperiod;&quot;)                       &#39; Transfer result. Sheets(2).Range(&quot;$F20:F45&quot;).CopyFromRecordset rs</code>"}], "tags": [], "owner": {"reputation": 4495, "user_id": 1186165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/A0tKf.jpg?s=128&g=1", "display_name": "Kittoes0124", "link": "https://stackoverflow.com/users/1186165/kittoes0124"}, "is_accepted": false, "score": 0, "last_activity_date": 1431553512, "last_edit_date": 1431553512, "creation_date": 1431549935, "answer_id": 30224876, "question_id": 30224368, "link": "https://stackoverflow.com/questions/30224368/sql-vba-populating-data-in-cell-range/30224876#30224876", "title": "SQL + VBA Populating Data in Cell Range", "body": "<p>Let's break this up and try some pseudo code. First we'll tackle the SQL portion of your problem:</p>\n\n<pre><code>SELECT payperiod\n     , calc = SUM(Hours) / 80\nFROM payroll2015_rif\nWHERE DepartmentCode = &lt;DepartmentCode&gt;\n  AND payperiod IN (&lt;PayPeriods&gt;)\n  AND paycode IN ('REG1', 'REG2')\nGROUP BY payperiod\n</code></pre>\n\n<p>Now we need to replace anything wrapped in &lt; > with a value from Excel. You've figured out <strong>DepartmentCode</strong> already so we'll work on pay period. SQL is expecting something like <code>'Period 1', 'Period 2', 'Period 3'</code> to be passed to the <code>IN</code> clause here.</p>\n\n<p>A very naive approach would be:</p>\n\n<pre><code>Set strValues = Range(\"C21\") &amp; ', ' &amp; Range(\"C22\") &amp; ', ' &amp; Range(\"C23\")\n</code></pre>\n\n<p>This is tedious but could easily be refactored into a loop or something. Putting this together with the example you already have should give you what you want.</p>\n"}, {"tags": [], "owner": {"reputation": 384, "user_id": 1472991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/651af54b4c588d70efc49cdc2249bad8?s=128&d=identicon&r=PG", "display_name": "maciej", "link": "https://stackoverflow.com/users/1472991/maciej"}, "is_accepted": true, "score": 0, "last_activity_date": 1431555535, "creation_date": 1431555535, "answer_id": 30226154, "question_id": 30224368, "link": "https://stackoverflow.com/questions/30224368/sql-vba-populating-data-in-cell-range/30226154#30226154", "title": "SQL + VBA Populating Data in Cell Range", "body": "<p>Something like this could do the trick? Basically I would take the relevant values from the Excel ranges and put them into arrays in VBA, create an array of results by looping through the variables, and then throw the array back into the excel Range. </p>\n\n<p>Note I didn't include the ADODB connection and recordset declarations which I assume you have somewhere in your code.</p>\n\n<pre><code>Sub myLoop()\n\n    Dim dept As String\n    Dim payperiod As Variant\n    Dim result As Variant\n    Dim i As Integer\n\n    dept = Range(\"E6\")\n    payperiod = Range(\"C20:C45\")\n    ReDim result(1 To UBound(payperiod), 1 To 1)\n\n    'don't forget to set your ADODB stuff somewhere\n\n    For i = 1 To UBound(payperiod)\n        Set rs = conn.Execute(\"SELECT sum(Hours)/80 FROM payroll2015_rif WHERE DepartmentCode = '\" &amp; dept &amp; \"' AND payperiod = '\" &amp; payperiod(i,1) &amp; \"' and paycode IN ('REG1', 'REG2');\")\n        result(i, 1) = rs(0)\n        rs.Close\n    Next i\n\n    Range(\"H20:H45\") = result\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4897246, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-lnmyIw4yVP8/AAAAAAAAAAI/AAAAAAAACWo/ezU8H-Bulgk/photo.jpg?sz=128", "display_name": "Sagar S", "link": "https://stackoverflow.com/users/4897246/sagar-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2573, "favorite_count": 0, "accepted_answer_id": 30226154, "answer_count": 2, "score": 0, "last_activity_date": 1431555535, "creation_date": 1431548019, "question_id": 30224368, "link": "https://stackoverflow.com/questions/30224368/sql-vba-populating-data-in-cell-range", "title": "SQL + VBA Populating Data in Cell Range", "body": "<p>I currently have a code that is connecting to SQL database in VBA.  The data is populating correctly as I would like however, I was wondering if there is a way to condense the code below.  I have 4 different columns and 26 rows and I feel like if I go this route, I will be wasting a lot of time.  I want the range to go from C20:C45 and the results to show from cells H20:H45.  Can some one help?  Thanks!</p>\n\n<pre><code>    ' Open the connection and execute data for WFTEs.\n   Set rs = conn.Execute(\"SELECT sum(Hours)/80 FROM payroll2015_rif WHERE DepartmentCode = '\" &amp; Range(\"$E$6\") &amp; \"' AND payperiod = '\" &amp; Range(\"C20\") &amp; \"' and paycode IN ('REG1', 'REG2');\")\n        ' Transfer result.\n        Sheets(2).Range(\"$H20\").CopyFromRecordset rs\n    ' Close the recordset\n        rs.Close\n\n\n' Open the connection and execute data for WFTEs.\n   Set rs = conn.Execute(\"SELECT sum(Hours)/80 FROM payroll2015_rif WHERE DepartmentCode = '\" &amp; Range(\"$E$6\") &amp; \"' AND payperiod = '\" &amp; Range(\"C21\") &amp; \"' and paycode IN ('REG1', 'REG2');\")\n        ' Transfer result.\n        Sheets(2).Range(\"$H21\").CopyFromRecordset rs\n    ' Close the recordset\n        rs.Close\n</code></pre>\n"}, {"tags": ["vba", "list", "excel", "comparison"], "comments": [{"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1431548369, "post_id": 30224355, "comment_id": 48552770, "body": "If you used <code>For</code> loops you could use <code>Exit For</code> to shorten the execution time greatly."}, {"owner": {"reputation": 1, "user_id": 4897317, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LJSDc2-xCww/AAAAAAAAAAI/AAAAAAAACWU/zdN-Hf_bC5g/photo.jpg?sz=128", "display_name": "Puzoni", "link": "https://stackoverflow.com/users/4897317/puzoni"}, "reply_to_user": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1431548648, "post_id": 30224355, "comment_id": 48552901, "body": "Never used &quot;for&quot; to loop. How would it be?"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1431548727, "post_id": 30224355, "comment_id": 48552938, "body": "Check <a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">this</a> out."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1431548837, "post_id": 30224355, "comment_id": 48552988, "body": "Wait what exactly is the desired result here?"}, {"owner": {"reputation": 1, "user_id": 4897317, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LJSDc2-xCww/AAAAAAAAAAI/AAAAAAAACWU/zdN-Hf_bC5g/photo.jpg?sz=128", "display_name": "Puzoni", "link": "https://stackoverflow.com/users/4897317/puzoni"}, "edited": false, "score": 0, "creation_date": 1431548974, "post_id": 30224355, "comment_id": 48553058, "body": "Nice Mr Mascaro, I&#39;ll check it out!"}, {"owner": {"reputation": 1, "user_id": 4897317, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LJSDc2-xCww/AAAAAAAAAAI/AAAAAAAACWU/zdN-Hf_bC5g/photo.jpg?sz=128", "display_name": "Puzoni", "link": "https://stackoverflow.com/users/4897317/puzoni"}, "edited": false, "score": 0, "creation_date": 1431549009, "post_id": 30224355, "comment_id": 48553075, "body": "chancea, show how many different columns I have"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1431549102, "post_id": 30224355, "comment_id": 48553121, "body": "So you want another column with a numeric value of the unique number of values pertaining to that row?  or are you saying just <i>one</i> value all together?"}, {"owner": {"reputation": 1, "user_id": 4897317, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LJSDc2-xCww/AAAAAAAAAAI/AAAAAAAACWU/zdN-Hf_bC5g/photo.jpg?sz=128", "display_name": "Puzoni", "link": "https://stackoverflow.com/users/4897317/puzoni"}, "edited": false, "score": 0, "creation_date": 1431563805, "post_id": 30224355, "comment_id": 48558612, "body": "Something that says &quot;list 1 = list 2, list 3 = list 4&quot;, or anything near this"}, {"owner": {"reputation": 1, "user_id": 4897317, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LJSDc2-xCww/AAAAAAAAAAI/AAAAAAAACWU/zdN-Hf_bC5g/photo.jpg?sz=128", "display_name": "Puzoni", "link": "https://stackoverflow.com/users/4897317/puzoni"}, "edited": false, "score": 0, "creation_date": 1431618031, "post_id": 30224355, "comment_id": 48584217, "body": "Ok, I did it with the &quot;For&quot;. I&#39;ll post the code later, but to clarify:  - it compares the first list, checking if the first cell is equal to any other cell in list 2, and to this to all other rows in list 1 - after it&#39;s ok, it starts again with the second, comparing to all in front of it (e.g. if 5 lists, compare 2 with 3, 4 and 5)  Now I&#39;m working on a way to skip to start comparison between equal lists (e.g. if list 1 = list 2, it&#39;s not necessary to compare list 2 with 3, 4 and 5)  is it confusing or am I clear?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4897317, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LJSDc2-xCww/AAAAAAAAAAI/AAAAAAAACWU/zdN-Hf_bC5g/photo.jpg?sz=128", "display_name": "Puzoni", "link": "https://stackoverflow.com/users/4897317/puzoni"}, "is_accepted": false, "score": 0, "last_activity_date": 1431690597, "creation_date": 1431690597, "answer_id": 30258810, "question_id": 30224355, "link": "https://stackoverflow.com/questions/30224355/comparing-data-in-different-columns-via-vba-in-excel/30258810#30258810", "title": "Comparing data in different columns via VBA in Excel", "body": "<p>Well, managed to do it after a couple hours trying. Thanks for the suggestions!</p>\n\n<pre><code>    ref = Sheets(\"Ref\").Cells(1, 1)\n\n    cres = ref + 5\n\n    lformula = 2\n    cformula = ref + 2\n    cformulacomp = ref + 3\n\n    For cref = 1 To ref\n    Dim lastrow As Long\n    lastrow = Cells(Rows.Count, cref).End(xlUp).Row\n    For ccomp = cref + 1 To ref\n\n    For lref = 2 To lastrow 'substituir por 5 para testes / lastrow para solu\u00e7\u00e3o final\n\n    For lcomp = 2 To lastrow 'substituir por 5 para testes / lastrow para solu\u00e7\u00e3o final\n\n    If ActiveSheet.Cells(1, cres) = \"\" Then\n    ActiveSheet.Cells(1, cres).Value = cref &amp; \" x \" &amp; ccomp\n    lformula = lformula + 1\n    End If\n\n    If Cells(lref, cref) = Cells(lcomp, ccomp) Then\n    Cells(lref, cres) = \"OK\"\n    End If\n\n    Next lcomp\n\n\n    Next lref\n\n    If ActiveSheet.Cells(lformula, cformula) = \"\" Then\n    ActiveSheet.Cells(lformula, cformula).Value = cref &amp; \" x \" &amp; ccomp\n    Cells(lformula, cformula + 1).FormulaR1C1 = _\n        \"=IF(COUNTA(R2C\" &amp; cref &amp; \":R1200C\" &amp; cref &amp; \")=COUNTIF(R2C\" &amp; cres &amp; \":R1200C\" &amp; cres &amp; \",\"\"OK\"\"),\"\"Iguais\"\",\"\"Diferentes\"\")\" 'Trocar R5C por R1200C\n\n    End If\n\n    cres = cres + 1\n\n    Next ccomp\n\n\n    While Cells(linhaverif, cformula + 1).Value = \"Iguais\"\n    cref = cref + 1\n    linhaverif = linhaverif + 1\n    Wend\n\n     Next cref\n\n    Application.CutCopyMode = False\n'\n'Apagar bot\u00f5es e pintar c\u00e9lulas\n'\n    Dim botoes As Integer\n\n    On Error Resume Next\n        For botoes = 1 To 200\n            ActiveWorkbook.Sheets(botoes).Buttons.Delete\n        Next botoes\n\n        Range(Columns(ref + 5), Selection.End(xlToRight)).Select\n    Selection.SpecialCells(xlCellTypeBlanks).Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 255\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4897317, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LJSDc2-xCww/AAAAAAAAAAI/AAAAAAAACWU/zdN-Hf_bC5g/photo.jpg?sz=128", "display_name": "Puzoni", "link": "https://stackoverflow.com/users/4897317/puzoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1432912200, "creation_date": 1431547971, "last_edit_date": 1432912200, "question_id": 30224355, "link": "https://stackoverflow.com/questions/30224355/comparing-data-in-different-columns-via-vba-in-excel", "title": "Comparing data in different columns via VBA in Excel", "body": "<p>First topic here after reading many, solving many doubts and opening my mind! Thanks everyone for this hahaha</p>\n\n<p>I found many topics about how to compare numbers/texts/etc between 2 columns, either by macro or formula.<br><br>\nMy problem is that I will have an undefined number of columns with different number of lines.</p>\n\n<p>Each column stands for one list of codes, that are in the format as this sheet:</p>\n\n<pre><code>List 1  List 2  List 3  List 4\n1A      1A      1B      1B\n3F      3F      3F      3F\n8B      8B      8B      8B\n10B     10B     10B     10B\n11A     11A     11A     11A\n14Q     14Q     14Q     14Q\n17TX    17TX    17TX    17TX\n20A     20A     20C     20C\n21BM    21BM    21BM    21BM\n22AX    22AX    22AX    22AX\n24A     24A     25C     25C\n</code></pre>\n\n<p>Here comes the problem: these numbers go up to 6500, the letters can have many combinations.</p>\n\n<p>I need to compare and have results for:<br>\n- first to second, third and fourth<br>\n- then second to third and fourth<br>\n- then third to fourth.<br></p>\n\n<p>Here comes another problem: I can have two of these lists and I can have 90 of these lists. There is no precise number.</p>\n\n<p>I can't use conditional formatting to highlight unique or duplicate values because I can have 4 lists, being first=second and third=fourth, that wouldn't highlight anything. This would only work if the maximum was 3.</p>\n\n<p>1=2 and 3=4=5 would result the same, and so on.</p>\n\n<p>I used this code to create a loop, but it already takes too long to compare two lists, for many it would take the whole day:</p>\n\n<pre><code>Sub LOOPING()\n    colunavazia = Sheets(\"Ref\").Cells(1, 1) + 2\n    ActiveSheet.Cells(2, colunavazia).Select\n\n    linha_1 = 2\n    linha_2 = 2\n    coluna_1 = 1\n    coluna_2 = 2\n    coluna_3 = colunavazia\n\n    While Cells(1, coluna_2) &lt;&gt; \"\"\n        While ActiveSheet.Cells(linha_1, coluna_1) &lt;&gt; \"\"\n            While ActiveSheet.Cells(linha_2, coluna_1) &lt;&gt; \"\"\n                If ActiveSheet.Cells(linha_1, coluna_1) = Sheet2.Cells(linha_2, coluna_2) Then\n                        ActiveSheet.Cells(linha_2, coluna_3) = \"OK\"\n                        Else\n                        ActiveSheet.Cells(linha_2, coluna_3) = \"NOOOOOOO\"\n                End If\n                linha_2 = linha_2 + 1\n            Wend\n            linha_2 = 2\n            linha_1 = linha_1 + 1\n        Wend\n        linha_1 = 2\n        linha_2 = 2\n        coluna_1 = 1\n        coluna_2 = coluna_2 + 1\n        coluna_3 = coluna_3 + 1\n    Wend\n</code></pre>\n\n<p>It searches the code of line 1 on first column in the whole second column and returns OK if true. That would be a good idea if it didn't take like forever to show the results.</p>\n\n<p>Do anyone have any other suggestion? Thanks from now!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4892030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2829824ae705c0d3b80a779b11b2ff18?s=128&d=identicon&r=PG&f=1", "display_name": "AgBanker", "link": "https://stackoverflow.com/users/4892030/agbanker"}, "edited": false, "score": 0, "creation_date": 1431715010, "post_id": 30224323, "comment_id": 48632964, "body": "So i would have to name all 27 sheets with if then statements in the working example?  Surely there is an easier way rather manually doing it this way?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 1, "user_id": 4892030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2829824ae705c0d3b80a779b11b2ff18?s=128&d=identicon&r=PG&f=1", "display_name": "AgBanker", "link": "https://stackoverflow.com/users/4892030/agbanker"}, "edited": false, "score": 0, "creation_date": 1431718599, "post_id": 30224323, "comment_id": 48634724, "body": "Yes there is a simpler way rather than dimming the array before hand. Updated the post"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1431718578, "last_edit_date": 1431718578, "creation_date": 1431547854, "answer_id": 30224323, "question_id": 30224063, "link": "https://stackoverflow.com/questions/30224063/script-out-of-range-error-help-needed/30224323#30224323", "title": "script out of range error help needed", "body": "<p>The reason is pretty simple actually. You are redimming your array in the beginning and your line <code>WkstNames(y) = Sheets(iCount).Name</code> is not executing and hence you are getting at least one blank value in the array.</p>\n\n<p>Try and loop through the array after it is created. Use this code</p>\n\n<pre><code>For i = LBound(WkstNames) To UBound(WkstNames)\n    Debug.Print WkstNames(i)\nNext i\nWorksheets(WkstNames).Select\n</code></pre>\n\n<p>You will notice at least one value is blank and hence Excel cannot find the sheet.</p>\n\n<p>A working example would be something like</p>\n\n<pre><code>Dim WkstNames(1 To 2) As String\nWkstNames(1) = \"Sheet1\"\nWkstNames(2) = \"Sheet2\"\nWorksheets(WkstNames).Select\n</code></pre>\n\n<p><strong>Example (Followup from comments)</strong></p>\n\n<p>This is just an example to show how you can select sheet(s) without declaring an array beforehand.</p>\n\n<pre><code>Sub Sample()\n    Dim Ar\n    Dim wsName As String, sDelim As String\n\n    sDelim = \"|\"\n\n    With ThisWorkbook\n        For i = 1 To .Sheets.Count\n            If .Sheets(i).Name Like \"Sheet*\" Then\n                If wsName = \"\" Then\n                    wsName = .Sheets(i).Name\n                Else\n                    wsName = wsName &amp; sDelim &amp; .Sheets(i).Name\n                End If\n            End If\n        Next i\n\n        If InStr(1, wsName, sDelim) Then\n            Ar = Split(wsName, sDelim)\n        Else\n            Ar = wsName\n        End If\n\n        .Sheets(Ar).Select\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4892030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2829824ae705c0d3b80a779b11b2ff18?s=128&d=identicon&r=PG&f=1", "display_name": "AgBanker", "link": "https://stackoverflow.com/users/4892030/agbanker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431761455, "creation_date": 1431546924, "last_edit_date": 1531164843, "question_id": 30224063, "link": "https://stackoverflow.com/questions/30224063/script-out-of-range-error-help-needed", "title": "script out of range error help needed", "body": "<p>I have this snip of code that will not populate worksheet names for printing in a PDF.  I get a subscript out of range compiling error.  Any ideas?</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nSheets(\"Macros\").Select\n\nDim strPath As String, strFileName As String\nDim i As Integer, y As Integer, x As Integer\nDim WkstNames() As Variant\nDim iCount As Integer, iWkstCount As Integer\nDim printrange As Range\nSet printrange = Range(\"P222:P248\")\nDim p() As Variant\n\niCount = 1\niWkstCount = ThisWorkbook.Sheets.Count\n\nReDim WkstNames(1 To iWkstCount)\nReDim p(1 To 27)\n\nFor y = 1 To iWkstCount\n    For x = 1 To 27\n    printrange.Rows(p(x)).Select\n    If ActiveCell = \"True\" Then WkstNames(y) = Sheets(iCount).Name\n    iCount = iCount + 1\n    Next x\nNext y\n\nSheets(WkstNames).Select ' error occurs here\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1431547980, "post_id": 30224014, "comment_id": 48552567, "body": "<i>&quot;This isn&#39;t something a linked table can fix, please don&#39;t suggest it.&quot;</i> - Please <a href=\"https://stackoverflow.com/posts/30224014/edit\">edit</a> your question to explain why you believe that you cannot use a linked table."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1431561486, "post_id": 30224014, "comment_id": 48557975, "body": "Would you consider just copying your entire .MDB file as a backup? Then the file copy either works or it doesn&#39;t. When you start getting complex backup and archiving strategies against an access database that might indicate it&#39;s time to consider moving to SQL Server"}, {"owner": {"reputation": 411, "user_id": 4691343, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/82436a10fd2462bbf8918b594c511a75?s=128&d=identicon&r=PG&f=1", "display_name": "arsarc", "link": "https://stackoverflow.com/users/4691343/arsarc"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1431609197, "post_id": 30224014, "comment_id": 48578081, "body": "@Nick.McDermaid: I have that option already, but this one is to, I guess, &quot;Slim down&quot; the database in use. It backs up to a specified Date and then deletes it from the original database. It was just a requested tool and I was trying to comply. Also, yes sql server is what I want, but I don&#39;t really have a say in what database programs we can and can&#39;t use. I&#39;m just following orders."}], "answers": [{"comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1431555418, "post_id": 30225068, "comment_id": 48556175, "body": "There&#39;s also the <code>SELECT * FROM [;Database=C:\\folder\\otherDb.mdb].[tableName];</code> trick to create a temporary link &quot;on the fly&quot;."}], "tags": [], "owner": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "is_accepted": true, "score": 2, "last_activity_date": 1431550726, "creation_date": 1431550726, "answer_id": 30225068, "question_id": 30224014, "link": "https://stackoverflow.com/questions/30224014/opening-a-table-from-another-mdb-file-with-ado-in-msaccess/30225068#30225068", "title": "Opening a table from another mdb file with ADO in MSAccess", "body": "<p>First of all: exactly like Gord already said in his comment, I can't see a reason against using a linked table either.</p>\n\n<p>But in the end it doesn't really matter if you create a linked table and open a local <code>Recordset</code> on it, or if you open a <code>Recordset</code> directly on the table in the other Access database.</p>\n\n<p>So I'll show solutions for both ways:</p>\n\n<hr>\n\n<h2>1. The approach from your question</h2>\n\n<p>Your connection string works for me, but there are mistakes in the rest of your code:</p>\n\n<ul>\n<li>An <code>ADODB.Recordset</code> doesn't have a property <code>ConnectionString</code>...it's called <code>ActiveConnection</code> instead.</li>\n<li>You need to actually create a new <code>ADODB.Recordset</code> before you try to set the connection string or open the Recordset</li>\n</ul>\n\n<p>The following code works for me:</p>\n\n<pre><code>Dim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\nrs.ActiveConnection = \"Driver={Microsoft Access Driver (*.mdb)};\" &amp; _\n                 \"Dbq=Backup.mdb;DefaultDir=C:\\Fish;\"\n\nrs.Open \"select * from foo\"\n</code></pre>\n\n<hr>\n\n<h1>2. Using a linked table</h1>\n\n<p>Create it:</p>\n\n<pre><code>DoCmd.TransferDatabase acLink, \"ODBC\", \";DATABASE=C:\\Fish\\Backup.mdb\", acTable, \"TableName\", \"TableNameLocal\", False\n</code></pre>\n\n<p><em>Note: <code>TableName</code> is the original name of the source table, and <code>TableNameLocal</code> is the name that the linked table will have in your local database. (You can use the same names if you want, of course)</em></p>\n\n<p>Delete it: </p>\n\n<pre><code>DoCmd.DeleteObject acTable, \"TableNameLocal\"\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 4691343, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/82436a10fd2462bbf8918b594c511a75?s=128&d=identicon&r=PG&f=1", "display_name": "arsarc", "link": "https://stackoverflow.com/users/4691343/arsarc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 1, "accepted_answer_id": 30225068, "answer_count": 1, "score": 1, "last_activity_date": 1431550726, "creation_date": 1431546745, "last_edit_date": 1431548413, "question_id": 30224014, "link": "https://stackoverflow.com/questions/30224014/opening-a-table-from-another-mdb-file-with-ado-in-msaccess", "title": "Opening a table from another mdb file with ADO in MSAccess", "body": "<p>I'm trying to access a table from another mdb file. This isn't something a linked table can fix, please don't suggest it.</p>\n\n<p>Edit: This is part of an archive tool that creates a backup file of the backend of the database from a certain date range, and then deletes the data. Before I delete the data, it was suggested that I check and make sure all the data copied over to the created backup. (IE, if the worst case scenario happened and the share folder lost connection or something, and not all the data copied over, but the access database deleted that data anyway)</p>\n\n<p>If there's a way to create a linked table in access and then delete the link in the end WITH VBA, not manually, maybe that would work(?) but I was hoping to do it this way so hopefully it wouldn't cause the database to bloat up as much as it has been in the past.</p>\n\n<p>I'm trying to check if all my data copied over to a backup file before I delete the ones in the current database.</p>\n\n<pre><code>Dim rs as ADODB.Recordset\nrs.ConnectionString = \"Driver={Microsoft Access Driver (*.mdb)};\" &amp; _\n                 \"Dbq=Backup.mdb;DefaultDir=C:\\Fish;\"\n</code></pre>\n\n<p>I'm having trouble here with the syntax. I know it works with currentdb, but what if the table is in a different mdb file? I tried with DefaultDir=C:\\Fish and DefaultDir=C:\\Fish\\ Is there something I'm missing or is this a lot more complicated then what I should attempt?</p>\n\n<p>The rest of it I think I understand how to get the fieldvalues to compare, but trying to connect to a table in a different mdb file is giving me trouble.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 380, "user_id": 4047978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda385c94249ae8a9ed36ee7ec5bd90b?s=128&d=identicon&r=PG&f=1", "display_name": "DyRuss", "link": "https://stackoverflow.com/users/4047978/dyruss"}, "edited": false, "score": 0, "creation_date": 1431546263, "post_id": 30223773, "comment_id": 48551652, "body": "ignore my previous comment.. you need to add a second For Loop nested inside the For RowNdx loop... I will write out an answer"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4897183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c2b1e1cd10683a5ae783254494b6ccc?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/4897183/sarah"}, "edited": false, "score": 0, "creation_date": 1431555061, "post_id": 30224093, "comment_id": 48556013, "body": "This works perfectly!! Thank you so much user4897144."}], "tags": [], "owner": {"reputation": 3457, "user_id": 4897144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9772adabbde494edcd403e4f2d349a7c?s=128&d=identicon&r=PG&f=1", "display_name": "shruti1810", "link": "https://stackoverflow.com/users/4897144/shruti1810"}, "is_accepted": true, "score": 0, "last_activity_date": 1507009482, "last_edit_date": 1507009482, "creation_date": 1431547032, "answer_id": 30224093, "question_id": 30223773, "link": "https://stackoverflow.com/questions/30223773/excel-vba-how-to-insert-rows-and-add-string-of-text/30224093#30224093", "title": "Excel VBA: How to insert rows and add string of text", "body": "<p>Try this macro:</p>\n\n<pre><code>Sub CommandButton21_Click()\n    Dim LastRow As Long\n    Dim RowNdx As Long\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For RowNdx = 1 To LastRow Step 96\n        Rows(RowNdx).Insert\n        Rows(RowNdx).Insert\n        Cells(RowNdx, 1).Value = \"textAdded5\"\n        Rows(RowNdx).Insert\n        Cells(RowNdx, 1).Value = \"textAdded4\"\n        Rows(RowNdx).Insert\n        Cells(RowNdx, 1).Value = \"textAdded3\"\n        Rows(RowNdx).Insert\n        Cells(RowNdx, 1).Value = \"textAdded2\"\n        Rows(RowNdx).Insert\n        Cells(RowNdx, 1).Value = \"textAdded1\"\n    Next RowNdx\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1431548726, "creation_date": 1431548726, "answer_id": 30224563, "question_id": 30223773, "link": "https://stackoverflow.com/questions/30223773/excel-vba-how-to-insert-rows-and-add-string-of-text/30224563#30224563", "title": "Excel VBA: How to insert rows and add string of text", "body": "<p>Typically, when inserting or deleting rows in a loop you would start at the bottom and work up so that the inserted/deleted rows do not interfere with your iteration count.</p>\n\n<pre><code>Sub insert_6_every_90()\n    Dim rw As Long, lr As Long, stp As Long\n\n    stp = 90\n\n    With ActiveSheet   'set worksheet properly like With Sheets(\"Sheet1\")!\n        lr = Int(.Cells(Rows.Count, 1).End(xlUp).Row / stp) * stp + 1\n        For rw = lr To 1 Step -stp\n            .Cells(rw, 1).Resize(6, 1).EntireRow.Insert\n            .Cells(rw, 1).Resize(5, 1).Formula = \"=text(row(1:1), \"\"\\t\\e\\x\\t\\a\\d\\d\\e\\d0\"\")\"\n            .Cells(rw, 1).Resize(5, 1) = .Cells(rw, 1).Resize(5, 1).Value\n        Next rw\n    End With\nEnd Sub\n</code></pre>\n\n<p>I'm not sure how close to the truth the <em>Textadded0, Textadded1, etc</em> was. This populates the five cells at once. If individual text was more appropriates, that portion would likely have to be adjusted.</p>\n"}], "owner": {"reputation": 33, "user_id": 4897183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c2b1e1cd10683a5ae783254494b6ccc?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/4897183/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7665, "favorite_count": 0, "accepted_answer_id": 30224093, "answer_count": 2, "score": 2, "last_activity_date": 1507009482, "creation_date": 1431545836, "last_edit_date": 1431776277, "question_id": 30223773, "link": "https://stackoverflow.com/questions/30223773/excel-vba-how-to-insert-rows-and-add-string-of-text", "title": "Excel VBA: How to insert rows and add string of text", "body": "<p>I am trying to write a macro for a simple Excel spreadsheet with only one column. Basically I have a long list (5000 rows or more). It is a list of numbered object IDs such as follows:</p>\n\n<pre><code>object_0001\nobject_0002\nobject_0003\n...\nobject_5000\n</code></pre>\n\n<p>My goal is to add 5 rows of text and one blank row before each group of 90 objects. So it would look like this:</p>\n\n<pre><code>textadded1\ntextadded2\ntextadded3\ntextadded4\ntextadded5\n(blank row here)\nobject_0001\nobject_0002\nobject_0003\nobject_0004\n...\nobject_0090\ntextadded1\ntextadded2\ntextadded3\ntextadded4\ntextadded5\n(blank row)\nobject_0091\nobject_0092\n...\nobject_0180\ntextadded1\ntextadded2\ntextadded3\ntextadded4\ntextadded5\n(blank row)\n</code></pre>\n\n<p>The 5 strings of text I want to add are all just a single word and will be the same string added between each block of 90 objects. Right now I have a macro that will insert blank rows and I am manually going through and copy/pasting the 5 cells of text in manually after I run it. This is the macro code I'm using that does that:</p>\n\n<pre><code>Sub CommandButton21_Click()\nDim LastRow As Long\nDim RowNdx As Long\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nFor RowNdx = 95 To LastRow Step 95\n    Rows(RowNdx).Insert\n    Rows(RowNdx).Insert\n    Rows(RowNdx).Insert\n    Rows(RowNdx).Insert\n    Rows(RowNdx).Insert\nNext RowNdx\n'make sure the first FOUR lines are blank'\nEnd Sub\n</code></pre>\n\n<p>Please help me modify the code to add in the text strings I want. This is all for a spreadsheet using only column A. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431548704, "post_id": 30223446, "comment_id": 48552927, "body": "I don&#39;t think that is possible, although I can&#39;t find a good reference one way or the other.  One option includes creating a different function for each type of measurement.  You could have those handful of functions all call the same underlying function (like C# overloading)."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431552347, "post_id": 30223446, "comment_id": 48554802, "body": "Does the native CONVERT function not do what you need?"}, {"owner": {"reputation": 313, "user_id": 873107, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb4972981be109001db97c17ee4ebe82?s=128&d=identicon&r=PG", "display_name": "Justin Kauffman", "link": "https://stackoverflow.com/users/873107/justin-kauffman"}, "edited": false, "score": 0, "creation_date": 1431617606, "post_id": 30223446, "comment_id": 48583921, "body": "Byron, thanks for the comment. I may end up using the approach you suggest if I cannot find an alternate solution. However, the goal was to make the tool general purpose so that users could define additional measurement types and they would be immediately useful.  Rory, the CONVERT function is useful, but does not support all of the units or dimensions that I would like to support."}], "owner": {"reputation": 313, "user_id": 873107, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb4972981be109001db97c17ee4ebe82?s=128&d=identicon&r=PG", "display_name": "Justin Kauffman", "link": "https://stackoverflow.com/users/873107/justin-kauffman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1431544496, "creation_date": 1431544496, "question_id": 30223446, "link": "https://stackoverflow.com/questions/30223446/excel-vba-udf-custom-help-macrooptions-conditional-based-upon-argument-values", "title": "excel vba udf custom help macrooptions conditional based upon argument values", "body": "<p>I have a user-defined function in VBA to calculate unit conversions from input units to output units. The function accepts four arguments:</p>\n\n<ul>\n<li>measurement type (e.g. \"Mass\", \"Temperature\", \"Pressure\", etc.) </li>\n<li>input units (e.g. \"kg\", \"\u00b0C\", etc.)</li>\n<li>output units (e.g. \"lbm\", \"\u00b0F\", etc.)</li>\n<li>input value (numerical value in input units)</li>\n</ul>\n\n<p>I am familiar with using the MacroOptions method to assign custom help text, but I am curious if there is a way to change the help text based upon the value of an argument. For instance, if the user specifies \"Mass\" as the measurement type, is it possible for the input units argument help text to only show mass related units (e.g. kg, gram, lbm, etc.)? </p>\n\n<p>If this is possible I would assume that I would need to catch events from the \"Function Arguments\" form that is presented to users in order to enter arguments. Any tips on catching events from that form?</p>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Thanks,\nJustin</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4203, "user_id": 2119523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fkQjy.jpg?s=128&g=1", "display_name": "Netloh", "link": "https://stackoverflow.com/users/2119523/netloh"}, "is_accepted": true, "score": 0, "last_activity_date": 1431544034, "creation_date": 1431544034, "answer_id": 30223303, "question_id": 30223237, "link": "https://stackoverflow.com/questions/30223237/pass-a-string-value-to-a-range-object/30223303#30223303", "title": "Pass a string value to a range object", "body": "<p>You've made a very minor mistake. You need to enclose the sheet name in \"'\", like:</p>\n\n<pre><code>sAddress = \"'Output Averages'!$C$23:$C$\" &amp; (23 + total)\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4867576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/68f54406e68a9348ca8c120a770d0d41?s=128&d=identicon&r=PG&f=1", "display_name": "Stuart Allan", "link": "https://stackoverflow.com/users/4867576/stuart-allan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 30223303, "answer_count": 1, "score": 1, "last_activity_date": 1431544132, "creation_date": 1431543779, "last_edit_date": 1531161705, "question_id": 30223237, "link": "https://stackoverflow.com/questions/30223237/pass-a-string-value-to-a-range-object", "title": "Pass a string value to a range object", "body": "<p>Simple question I need a hand on: How do I pass a string into a range object in Excel VBA?</p>\n\n<p>Example code:</p>\n\n<pre><code>Dim Trange As Range\nDim sAddress As String\nSub example\nsAddress = \"Output Averages!$C$23:$C$\" &amp; (23 + total)\nSet Trange = Range(sAddress)\nEnd Sub\n</code></pre>\n\n<p><strong>Error Received:</strong> Method 'Range' of object _Global failed. Run time error 1004</p>\n"}, {"tags": ["vba", "excel", "spreadsheet"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 2, "creation_date": 1431544243, "post_id": 30223202, "comment_id": 48550545, "body": "I do not believe it is possible.  I was going to recommend your last sentence based on the title as the best way to do this."}, {"owner": {"reputation": 12273, "user_id": 1048539, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b2bfeca28ec73556f395bed4668f9e16?s=128&d=identicon&r=PG", "display_name": "enderland", "link": "https://stackoverflow.com/users/1048539/enderland"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431548278, "post_id": 30223202, "comment_id": 48552723, "body": "@Byron I added that as an answer (which is how I am currently doing this, it&#39;s just ugly)"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431548668, "post_id": 30223202, "comment_id": 48552907, "body": "Unfortunately, you often have to settle for ugly in VBA."}], "answers": [{"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431548453, "post_id": 30224437, "comment_id": 48552813, "body": "You could probably get away with iterating through the <code>UsedRange</code> : <code>For Each rng_col in UsedRange.Columns &#47; rng_col.ColumnWidth = rng_col.ColumnWidth * 1.05 &#47; Next rng_col</code>."}, {"owner": {"reputation": 12273, "user_id": 1048539, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b2bfeca28ec73556f395bed4668f9e16?s=128&d=identicon&r=PG", "display_name": "enderland", "link": "https://stackoverflow.com/users/1048539/enderland"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431548499, "post_id": 30224437, "comment_id": 48552834, "body": "@Byron I&#39;ve had way, way, way too many issues with <code>UsedRange</code> over my life - it too easily misses areas (if you have a blank column) etc."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431548637, "post_id": 30224437, "comment_id": 48552893, "body": "Never seen it come up short, but I have been burned by it including &quot;extra&quot; cells with stray formatting."}], "tags": [], "owner": {"reputation": 12273, "user_id": 1048539, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b2bfeca28ec73556f395bed4668f9e16?s=128&d=identicon&r=PG", "display_name": "enderland", "link": "https://stackoverflow.com/users/1048539/enderland"}, "is_accepted": false, "score": 2, "last_activity_date": 1431548260, "creation_date": 1431548260, "answer_id": 30224437, "question_id": 30223202, "link": "https://stackoverflow.com/questions/30223202/autosize-columns-slightly-larger-in-spreadsheet/30224437#30224437", "title": "Autosize columns slightly larger in spreadsheet?", "body": "<p>This will do it with column iteration:</p>\n\n<pre><code>    Dim i As Integer\n    For i = 1 To 6\n        ThisWorkbook.Sheets(1).Columns(i).ColumnWidth = _\n             ThisWorkbook.Sheets(1).Columns(i).ColumnWidth * 1.05\n    Next i\n</code></pre>\n\n<p>Note that you need to use <code>ColumnWidth</code> vs <code>Width</code> if you use this sort of strategy.</p>\n"}], "owner": {"reputation": 12273, "user_id": 1048539, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b2bfeca28ec73556f395bed4668f9e16?s=128&d=identicon&r=PG", "display_name": "enderland", "link": "https://stackoverflow.com/users/1048539/enderland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431548260, "creation_date": 1431543660, "last_edit_date": 1531164843, "question_id": 30223202, "link": "https://stackoverflow.com/questions/30223202/autosize-columns-slightly-larger-in-spreadsheet", "title": "Autosize columns slightly larger in spreadsheet?", "body": "<p>I have consistently used the <code>Columns.AutoFit</code> function in VBA.</p>\n\n<p>Is there any way to make it effectively \"Autofit to 105% size?\"</p>\n\n<p>I know I can loop through the columns to do this and just set each size to its current size times 1.05, but this seems like a poor way to do this.</p>\n"}, {"tags": ["excel", "vba", "sum", "range", "target"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431544174, "post_id": 30223039, "comment_id": 48550487, "body": "Will <code>Target</code> always be a single-cell range?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1431544222, "post_id": 30223039, "comment_id": 48550530, "body": "Since Target is a range object, you can use the Row property to determine your row to Sum."}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1431545598, "post_id": 30223467, "comment_id": 48551318, "body": "If the user were to change &gt;1 cell then this could return misleading results by summing multiple rows."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431545901, "post_id": 30223467, "comment_id": 48551474, "body": "Good point, @TimWilliams.  I read your comment above and assumed the answer was &quot;Yes&quot;.  I guess really he has no control over how many cells are changed... so it&#39;s worth checking.  See edit."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 0, "last_activity_date": 1431546189, "last_edit_date": 1431546189, "creation_date": 1431544596, "answer_id": 30223467, "question_id": 30223039, "link": "https://stackoverflow.com/questions/30223039/how-can-i-use-target-address-to-get-sum-of-a-range-of-cells/30223467#30223467", "title": "How can I use target address to get sum of a range of cells?", "body": "<p>You can use <code>Intersect</code> and <code>EntireRow</code> to figure out which cells to sum.  I would give them to <code>Application.Sum</code> to do the math.  Another call to <code>Intersect</code> will let you know if the changed cell is in the \"boxed\" area.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim sum As Double\n    Dim rng_match As Range\n\n    Set rng_match = Range(\"H:W\")\n\n    If Target.Cells.Count = 1 Then\n        If Not Intersect(Target, rng_match) Is Nothing Then\n            sum = Application.sum(Intersect(Target.EntireRow, rng_match))\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong> added a check on <code>Target.Cells.Count</code> per @Tim Williams to ensure that the sum is not affected by a multi-cell edit.  The <code>Else</code> would need to address what to do next if this is an issue.</p>\n"}], "owner": {"reputation": 3, "user_id": 4897139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101363121016375/picture?type=large", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4897139/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "closed_date": 1431606653, "accepted_answer_id": 30223467, "answer_count": 1, "score": 0, "last_activity_date": 1431546189, "creation_date": 1431543101, "question_id": 30223039, "link": "https://stackoverflow.com/questions/30223039/how-can-i-use-target-address-to-get-sum-of-a-range-of-cells", "closed_reason": "Needs more focus", "title": "How can I use target address to get sum of a range of cells?", "body": "<p>I have target.address (or just target) from a worksheet_change sub. I'd like to use the row from target.address and a range of columns (H:W), and get a sum of that range. So, for instance, if I have $100 in H10 and I add $50 in J10, I'd like to get the sum of $150 since my target.address row is 10 and I'm within my desired column range H:W. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 1, "creation_date": 1431544182, "post_id": 30222963, "comment_id": 48550494, "body": "what line causes the error?"}, {"owner": {"reputation": 64, "user_id": 3616591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e966760a9f7b0c0de3ba7c93e1102d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3616591/matt"}, "reply_to_user": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1431545141, "post_id": 30222963, "comment_id": 48551050, "body": "@SeanCheshire It errors out here, around the 15th line of code:  <code>Rows(&quot;5:&quot; + (5 + NumRows)).Select                   &#39; Insert X rows above...It should at least... Errors out before here   ActiveCell.EntireRow.Insert    WS.Range(&quot;A1:U&quot; + NumRows).Select.Copy              &#39; Copy and paste ???   Rows(&quot;4:&quot; + (4 + NumRows)).Select.Paste</code>"}], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 3616591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e966760a9f7b0c0de3ba7c93e1102d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3616591/matt"}, "edited": false, "score": 0, "creation_date": 1431545415, "post_id": 30223624, "comment_id": 48551195, "body": "Thanks for the reply, I&#39;m still getting the same error message with your updated code."}, {"owner": {"reputation": 64, "user_id": 3616591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e966760a9f7b0c0de3ba7c93e1102d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3616591/matt"}, "edited": false, "score": 0, "creation_date": 1431547517, "post_id": 30223624, "comment_id": 48552331, "body": "It errors out when attempting to copy from the second workbook into the new one - these lines are the issue: <code>WS.Range(&quot;A1:U&quot; + NumRows).Copy   WS.Paste Destination:=Range(&quot;A4:U&quot; + (4 + NumRows))</code> Thank you for the help"}, {"owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "reply_to_user": {"reputation": 64, "user_id": 3616591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e966760a9f7b0c0de3ba7c93e1102d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3616591/matt"}, "edited": false, "score": 0, "creation_date": 1431616533, "post_id": 30223624, "comment_id": 48583272, "body": "Yeah, looks like you already got your answer, but the problem is with the concatenate operator. You need <code>&amp;</code> instead of <code>+</code>."}], "tags": [], "owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1431545246, "creation_date": 1431545246, "answer_id": 30223624, "question_id": 30222963, "link": "https://stackoverflow.com/questions/30222963/type-mismatch-when-copying-and-pasting-from-second-workbook-with-vba/30223624#30223624", "title": "Type Mismatch when copying and pasting from second workbook with VBA", "body": "<p>Replace this:</p>\n\n<pre><code>Rows(\"5:\" + (5 + NumRows)).Select \nActiveCell.EntireRow.Insert\nWS.Range(\"A1:U\" + NumRows).Select.Copy\nRows(\"4:\" + (4 + NumRows)).Select.Paste\n</code></pre>\n\n<p>With this:</p>\n\n<pre><code>Rows(\"5:\" &amp; (5 + NumRows)).EntireRow.Insert\nWS.Range(\"A1:U\" + NumRows).Copy\nWS.Paste Destination:=Range(\"D1\")\n</code></pre>\n\n<p>Let me know how that works.</p>\n"}, {"comments": [{"owner": {"reputation": 64, "user_id": 3616591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e966760a9f7b0c0de3ba7c93e1102d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3616591/matt"}, "edited": false, "score": 0, "creation_date": 1431548528, "post_id": 30224319, "comment_id": 48552841, "body": "Thanks you so much for your help! Not sure how I even got this far using the incorrect concat operator..."}], "tags": [], "owner": {"reputation": 418, "user_id": 4645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/228705acd43eb2c65b8ee34bf81a3a8c?s=128&d=identicon&r=PG&f=1", "display_name": "hpf", "link": "https://stackoverflow.com/users/4645385/hpf"}, "is_accepted": true, "score": 1, "last_activity_date": 1431547839, "creation_date": 1431547839, "answer_id": 30224319, "question_id": 30222963, "link": "https://stackoverflow.com/questions/30222963/type-mismatch-when-copying-and-pasting-from-second-workbook-with-vba/30224319#30224319", "title": "Type Mismatch when copying and pasting from second workbook with VBA", "body": "<p>The short answer is that this line is incorrect:</p>\n\n<pre><code>Rows(\"5:\" + (5 + NumRows)).Select\n</code></pre>\n\n<p>Instead, you need to use the \"concatenate\" operator which is \"&amp;\":</p>\n\n<pre><code>Rows(\"5:\" &amp; (5 + NumRows)).Select\n</code></pre>\n\n<p>You need to fix the other lines where you do the same thing.  \"&amp;\" combines two strings.</p>\n\n<p>The long answer is that your code can be cleaned up quite a bit to make it faster and easier to read.  My major advice is not to \"select\" things and then \"do\" actions -- just attach the action to the range itself (edits marked with **):</p>\n\n<pre><code>Sub Pop_Sheet()\n\n  Dim WB As Workbook                                  ' Declare variables and types\n  Dim WS As Worksheet\n  Dim NumRows As Integer\n  Dim BadCols As Range\n  Dim BadRow As Range\n\n\n  Set WB = Get_File()                                 ' Get file from user\n  Set WS = WB.Sheets(1)                               ' Select first sheet in workbook\n\n                                                      ' Delete unneeded rows/columns\n  Set BadCols = WS.Range(\"A:B,D:D,G:M,P:S,V:X,AA:AA,AC:AC,AE:AI,AL:AL,AO:AP,AV:BG\")   'Can select multiple adjacent columns by using start and end columns\n  Set BadRow = WS.Rows(1)      ' ** This function can just take a number rather than the range string\n\n  BadCols.Delete\n  BadRow.Delete\n\n  WS.Columns(\"N:N\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove                           ' ** Combine two steps\n\n  NumRows = WS.UsedRange.Rows.Count        ' ** Count number of rows used in raw data\n\n  WS.Range(WS.Rows(5),WS.Rows(5 + NumRows)).Insert                   ' ** Should work better\n\n  WS.Range(\"A1\",WS.Cells(NumRows,21)).Copy destination:=Range(Rows(4),Rows(4+NumRows))              ' Copy and paste ???\n\n  Close_File (WB)                                     ' Clean up, free memory\n  Set WB = Nothing\n  Set WS = Nothing\n  Set BadCols = Nothing\n  Set BadRow = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 64, "user_id": 3616591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e966760a9f7b0c0de3ba7c93e1102d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3616591/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1169, "favorite_count": 0, "accepted_answer_id": 30224319, "answer_count": 2, "score": 0, "last_activity_date": 1431547839, "creation_date": 1431542883, "question_id": 30222963, "link": "https://stackoverflow.com/questions/30222963/type-mismatch-when-copying-and-pasting-from-second-workbook-with-vba", "title": "Type Mismatch when copying and pasting from second workbook with VBA", "body": "<p>I have two excel files, and I need to copy only necessary rows from a raw data sheet into my new workbook.</p>\n\n<p>The code I have so far is:</p>\n\n<pre><code>Sub Pop_Sheet()\n\n  Dim WB As Workbook                                  ' Declare variables and types\n  Dim WS As Worksheet\n  Dim NumRows As Integer\n  Dim BadCols As Range\n  Dim BadRow As Range\n\n\n  Set WB = Get_File()                                 ' Get file from user\n  Set WS = WB.Sheets(1)                               ' Select first sheet in workbook\n\n                                                      ' Delete unneeded rows/columns\n  Set BadCols = WS.Range(\"A:A,B:B,D:D,G:G,H:H,I:I,J:J,K:K,L:L,M:M,P:P,Q:Q,R:R,S:S,V:V,W:W,X:X,AA:AA,AC:AC,AE:AE,AF:AF,AG:AG,AH:AH,AI:AI,AL:AL,AO:AO,AP:AP,AV:AV,AW:AW,AX:AX,AY:AY,AZ:AZ,BA:BA,BB:BB,BC:BC,BD:BD,BE:BE,BF:BF,BG:BG\")\n  Set BadRow = WS.Rows(\"1:1\")\n\n  BadCols.Delete\n  BadRow.Delete\n\n  WS.Columns(\"N:N\").Select                            ' Insert empty column at N\n  Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\n  NumRows = WS.Range(\"A1048576\").End(xlUp).Row        ' Count number of rows used in raw data\n\n  Rows(\"5:\" + (5 + NumRows)).Select                   ' Insert X rows above...It should at least... Errors out before here\n  ActiveCell.EntireRow.Insert\n\n  WS.Range(\"A1:U\" + NumRows).Select.Copy              ' Copy and paste ???\n  Rows(\"4:\" + (4 + NumRows)).Select.Paste\n\n  Close_File (WB)                                     ' Clean up, free memory\n  Set WB = Nothing\n  Set WS = Nothing\n  Set BadCols = Nothing\n  Set BadRow = Nothing\n\nEnd Sub\n\nPrivate Function Get_File() As Workbook\n\n  Dim FPath As Variant                                ' Declare variable for filepath\n                                                      ' Get path from file picker\n  FPath = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.xlsx), *.xlsx\", Title:=\"Select File To Import\")\n\n  If Not FPath = False Then                           ' If a file was chosen\n    Set Get_File = Workbooks.Open(FPath)              ' Open file\n  Else\n    Set Get_File = Nothing                            ' Otherwise do nothing\n  End If\n\n  Set FPath = Nothing                                 ' Free Memory\n\nEnd Function\n\nPrivate Sub Close_File(ByRef WB As Workbook, Optional Save As Boolean = False)\n\n  WB.Close (Save)                                     ' Close raw data workbook\n\nEnd Sub\n</code></pre>\n\n<p>I get a \"Type Mismatch\" error when I run this however. I believe it has to do with copying and pasting into cells of a different size, which is why I have attempted to insert the number needed, select those, and paste into them.</p>\n\n<p>Any help or guidance in general is really appreciated. Thank you!</p>\n"}, {"tags": ["vba", "internet-explorer", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1431542971, "post_id": 30222885, "comment_id": 48549727, "body": "Your bold has been lost in the formatting. Please copy and paste the offending line of code into your question as an edit."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1431545812, "post_id": 30222885, "comment_id": 48551420, "body": "What line causes above error message?"}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 1472991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/651af54b4c588d70efc49cdc2249bad8?s=128&d=identicon&r=PG", "display_name": "maciej", "link": "https://stackoverflow.com/users/1472991/maciej"}, "is_accepted": true, "score": 1, "last_activity_date": 1431548448, "creation_date": 1431548448, "answer_id": 30224480, "question_id": 30222885, "link": "https://stackoverflow.com/questions/30222885/select-drop-down-from-web-page-with-ie-object/30224480#30224480", "title": "Select Drop Down from Web Page with IE object", "body": "<p>It seems that the \"Do Until Not ie.Busy And ie.readyState = 4\" loop doesn't really do what it's supposed to do. After getting the error, if you press Debug and then Continue the code, it will complete successfully. So, what is happening is that the element you're searching for still doesn't exist when the line first executes. You could patch this up with something like the following before the problem line:</p>\n\n<pre><code>Do While ie.Document.getElementById(\"ctl00_ContentBody_searchCDPList_ddlFieldName\") Is Nothing\n    DoEvents\nLoop\n</code></pre>\n\n<p>This will loop until the element is found, then the code continues successfully.</p>\n"}], "owner": {"reputation": 1, "user_id": 4897126, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1b81ea3fa67b7c3e8e1f5c7fdde6639a?s=128&d=identicon&r=PG&f=1", "display_name": "Harikrishnan R", "link": "https://stackoverflow.com/users/4897126/harikrishnan-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4509, "favorite_count": 0, "accepted_answer_id": 30224480, "answer_count": 1, "score": 0, "last_activity_date": 1432912541, "creation_date": 1431542613, "last_edit_date": 1432912541, "question_id": 30222885, "link": "https://stackoverflow.com/questions/30222885/select-drop-down-from-web-page-with-ie-object", "title": "Select Drop Down from Web Page with IE object", "body": "<p>Have the below code for a drop down selection in VBA .</p>\n\n<p>When I run this I get the error on the bold line saying \"Runtime error 91 - Object variable or with block variable not set \" ..New to VBA ....</p>\n\n<pre><code>Sub NACDP()\n' open IE, navigate to the desired page and loop until fully loaded\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    my_url = \"https://cdeployna.cognizant.com/\"\n\n    With ie\n        .Visible = True\n        .Navigate my_url\n        .Top = 50\n        .Left = 530\n        .Height = 400\n        .Width = 400\n\n    Do Until Not ie.Busy And ie.readyState = 4\n        DoEvents\n    Loop\n\n    End With\n\n' Input the userid and password\n    ie.Document.getElementById(\"loginControl_UserName\").Value = \"\"\n    ie.Document.getElementById(\"loginControl_Password\").Value = \"\"\n\n' Click the \"Login\" button\n    ie.Document.getElementById(\"loginControl_LoginButton\").Click\n\n    Do Until Not ie.Busy And ie.readyState = 4\n        DoEvents\n    Loop\n\n    ie.Document.getElementById(\"ctl00_ddlRoles\").selectedindex = 1\n    ie.Document.getElementById(\"ctl00_ddlRoles\").FireEvent (\"onchange\")\n\n     Do Until Not ie.Busy And ie.readyState = 4\n        DoEvents\n    Loop\n\n    ie.Document.getElementById(\"ctl00_ContentBody_searchCDPList_ddlFieldName\").selectedindex = 1\n    ie.Document.getElementById(\"ctl00_ContentBody_searchCDPList_ddlFieldName\").FireEvent (\"onchange\")\n    ie.Document.getElementById(\"ctl00_ContentBody_searchCDPList_txtValue\").Value = \"Java\"\n\n    ' Click the \"Search\" button\n\n    ie.Document.getElementById(\"ctl00_ContentBody_searchCDPList_btnSearch\").Click\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1431545653, "post_id": 30222768, "comment_id": 48551347, "body": "What code causes displaying above messages? You have do improve your question."}, {"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1431549011, "post_id": 30222768, "comment_id": 48553076, "body": "Maciej Los - I&#39;ve included my code"}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 1, "creation_date": 1431550153, "post_id": 30224901, "comment_id": 48553644, "body": "Plus there should be a test on whether the file is open by somefine else, I guess that was OP&#39;s main concern."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1431550594, "post_id": 30224901, "comment_id": 48553870, "body": "@user3819867 - Good point. That is going to require a bit more code than a single line. Knowing if Excel 2013 with its special way of handing application instances and application windows would be helpful on that front."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1431550681, "post_id": 30224901, "comment_id": 48553910, "body": "I&#39;m just monitoring as it&#39;s going to be a helluva <code>While ... Wend</code> loop."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1431550380, "last_edit_date": 1431550380, "creation_date": 1431550069, "answer_id": 30224901, "question_id": 30222768, "link": "https://stackoverflow.com/questions/30222768/access-excel-vba-remove-display-alerts-and-messages/30224901#30224901", "title": "Access/Excel VBA - Remove display alerts and messages", "body": "<p>You can start with the following option adjustment.</p>\n\n<pre><code>DoCmd.SetWarnings False\n</code></pre>\n\n<p>More at: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837275.aspx\" rel=\"nofollow\">DoCmd.SetWarnings Method (Access)</a> and <a href=\"https://msdn.microsoft.com/en-us/library/bb214103(v=office.12).aspx\" rel=\"nofollow\">DoCmd.SetWarnings Method (Access Developer Reference)</a>.</p>\n\n<p>For the Excel.Application object you may have to use that instance's equivalent.</p>\n\n<pre><code>ExcelApp.DisplayAlerts = false\n</code></pre>\n\n<p>The reference documentation for Excel's <strong>DisplayAlerts</strong> is at <a href=\"https://msdn.microsoft.com/en-us/library/bb177478(v=office.12).aspx\" rel=\"nofollow\">Application.DisplayAlerts Property</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4901206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c0a50efd2499a2677499661e651a4a?s=128&d=identicon&r=PG&f=1", "display_name": "ikervb", "link": "https://stackoverflow.com/users/4901206/ikervb"}, "is_accepted": false, "score": 0, "last_activity_date": 1431731145, "creation_date": 1431731145, "answer_id": 30270030, "question_id": 30222768, "link": "https://stackoverflow.com/questions/30222768/access-excel-vba-remove-display-alerts-and-messages/30270030#30270030", "title": "Access/Excel VBA - Remove display alerts and messages", "body": "<p>You can try with Docmd.setwarnings False</p>\n"}], "owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8969, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1431731145, "creation_date": 1431542221, "last_edit_date": 1495540691, "question_id": 30222768, "link": "https://stackoverflow.com/questions/30222768/access-excel-vba-remove-display-alerts-and-messages", "title": "Access/Excel VBA - Remove display alerts and messages", "body": "<p>I have a macro/vba in access that saves several excel workbooks after editing. However sometimes other users might be using one of the excel files in read/write mode.</p>\n\n<p>The below message box appears, what i do is keep clicking no till the user  has finished using the Excel file</p>\n\n<p><img src=\"https://i.stack.imgur.com/f3Iy9.png\" alt=\"enter image description here\"></p>\n\n<p>Once the file is free below message box appears , I click on 'read-write' and my code resumes from where it stopped (Image example)</p>\n\n<p><img src=\"https://i.stack.imgur.com/Fn80D.jpg\" alt=\"enter image description here\"></p>\n\n<p>Question - How do I get Access VBA or Excel VBA to click 'No' for me?</p>\n\n<p>Note: I've used <code>Application.DisplayAlerts</code> and <code>DoCmd.SetWarnings</code> both default was <code>Yes</code>. (Or it might be me not implementing them correctly).</p>\n\n<p>Code:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30174395/access-excel-vba-time-delay?noredirect=1#comment48456242_30174395\">Access/Excel VBA - Time delay</a></p>\n\n<pre><code>Function RefreshExcelTables()\n\nOn Error GoTo Error\n\nDim ExcelApp As Object\nSet ExcelApp = CreateObject(\"Excel.Application\")\n\nExcelApp.workbooks.Open \"c:\\test\\Test_Sheet1.xlsb\"\nExcelApp.ActiveWorkbook.refreshall\nExcelApp.ActiveWorkbook.Save\nExcelApp.ActiveWindow.Close\n\n\nExcelApp.workbooks.Open \"c:\\test\\Test_Sheet2.xlsb\"\nExcelApp.ActiveWorkbook.refreshall\nExcelApp.ActiveWorkbook.Save\nExcelApp.ActiveWindow.Close\n\n\nExcelApp.workbooks.Open \"c:\\test\\Test_Sheet3.xlsb\"\nExcelApp.ActiveWorkbook.refreshall\nExcelApp.ActiveWorkbook.Save\nExcelApp.ActiveWindow.Close\n\nError:\n\nIf Err.Number = 1004 Then\n\ncall pause(5)\n\nResume\n\nEnd If\n\nSet ExcelApp = Nothing\n\n\nEnd Function\n\n\n\nPublic Function Pause(intSeconds As Integer)\n\nDim dblStart As Double\n\nIf intSeconds &gt; 0 Then\n\ndblStart = Timer()\n\nDo While Timer &lt; dblStart + intSeconds\n\nLoop\n\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1431542094, "post_id": 30222577, "comment_id": 48549246, "body": "Welcome to stackoverflow, what have you tried so far ? do you have any code snippets you wrote ?"}, {"owner": {"reputation": 33, "user_id": 4897027, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZKaBxFHbav4/AAAAAAAAAAI/AAAAAAAAAFU/zZg4t1buMEw/photo.jpg?sz=128", "display_name": "Tonatiuh Dansie", "link": "https://stackoverflow.com/users/4897027/tonatiuh-dansie"}, "reply_to_user": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1431542628, "post_id": 30222577, "comment_id": 48549542, "body": "I have updated the question with the code I am trying to use. Thanks for your quick response!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4897027, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZKaBxFHbav4/AAAAAAAAAAI/AAAAAAAAAFU/zZg4t1buMEw/photo.jpg?sz=128", "display_name": "Tonatiuh Dansie", "link": "https://stackoverflow.com/users/4897027/tonatiuh-dansie"}, "edited": false, "score": 0, "creation_date": 1431543976, "post_id": 30222939, "comment_id": 48550366, "body": "Thank you so much for the response, this works except I would need the information to be split into cells across one row. My question was unclear on that part and i apologize for that. I would also need the header of each cell to be removed when it is added to sheet 2. So &quot;priority: xxxx&quot; when it is added to sheet 2 would just be &quot;xxxx&quot;. Does that make any sense? Thanks again for your help."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 33, "user_id": 4897027, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZKaBxFHbav4/AAAAAAAAAAI/AAAAAAAAAFU/zZg4t1buMEw/photo.jpg?sz=128", "display_name": "Tonatiuh Dansie", "link": "https://stackoverflow.com/users/4897027/tonatiuh-dansie"}, "edited": false, "score": 0, "creation_date": 1431546030, "post_id": 30222939, "comment_id": 48551541, "body": "You are welcome. Please check edited answer. Please accept the reply if you are satisfied with it"}, {"owner": {"reputation": 33, "user_id": 4897027, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZKaBxFHbav4/AAAAAAAAAAI/AAAAAAAAAFU/zZg4t1buMEw/photo.jpg?sz=128", "display_name": "Tonatiuh Dansie", "link": "https://stackoverflow.com/users/4897027/tonatiuh-dansie"}, "edited": false, "score": 0, "creation_date": 1431550089, "post_id": 30222939, "comment_id": 48553616, "body": "Actually that works really well! The last thing is that when i paste new info into sheet A and run the macro, it inserts the information into the same row on sheet 2. We would need it to go into the next available row. Would that be possible? Thanks again for all of your help, i am learning a lot from your code!"}, {"owner": {"reputation": 33, "user_id": 4897027, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZKaBxFHbav4/AAAAAAAAAAI/AAAAAAAAAFU/zZg4t1buMEw/photo.jpg?sz=128", "display_name": "Tonatiuh Dansie", "link": "https://stackoverflow.com/users/4897027/tonatiuh-dansie"}, "edited": false, "score": 0, "creation_date": 1431552760, "post_id": 30222939, "comment_id": 48555010, "body": "Thanks again for the quick response! This time it adds two rows in sheet 2 with the top row being the header info, such as &quot;Priority&quot; and in the second row it adds the header AND the information after the header. It would be great to only have the second row add to sheet 2 while removing the header of each cell."}, {"owner": {"reputation": 33, "user_id": 4897027, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZKaBxFHbav4/AAAAAAAAAAI/AAAAAAAAAFU/zZg4t1buMEw/photo.jpg?sz=128", "display_name": "Tonatiuh Dansie", "link": "https://stackoverflow.com/users/4897027/tonatiuh-dansie"}, "edited": false, "score": 0, "creation_date": 1431552958, "post_id": 30222939, "comment_id": 48555123, "body": "I changed the 2 in the trg cells portion to 1 and it fixed the issue of the header and the following information from adding to the row but it is still adding a row above that with just the header info. Thoughts?"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1431552084, "last_edit_date": 1431552084, "creation_date": 1431542796, "answer_id": 30222939, "question_id": 30222577, "link": "https://stackoverflow.com/questions/30222577/vba-macro-to-move-cells-to-a-new-sheet-and-removing-cell-headers-in-excel/30222939#30222939", "title": "VBA macro to move cells to a new sheet and removing cell headers in Excel", "body": "<p>This will work for you</p>\n\n<pre><code>Sub SpecialCopy()\n    Dim trg As Worksheet\n    Set trg = ThisWorkbook.Worksheets(2)\n    Dim i As Long, j As Long\n    Dim lastRow As Long: lastRow = Cells(Cells.Rows.Count, 1).End(xlUp).Row\n    Dim lastRow2 As Long: lastRow2 = trg.Cells(Cells.Rows.Count, 1).End(xlUp).Row + 1\n    For i = 1 To lastRow ' assuming we starting from second row\n        trg.Cells(lastRow2, i).Value = Split(Cells(i, 1).Value, \":\")(0)\n        For j = 1 To UBound(Split(Cells(i, 1).Value, \":\"))\n            trg.Cells(lastRow2 + 1, i).Value = trg.Cells(2, i).Value &amp; Split(Cells(i, 1).Value, \":\")(j)\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p>EDIT: I have edited the code, please let me know if this works for you.</p>\n"}], "owner": {"reputation": 33, "user_id": 4897027, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZKaBxFHbav4/AAAAAAAAAAI/AAAAAAAAAFU/zZg4t1buMEw/photo.jpg?sz=128", "display_name": "Tonatiuh Dansie", "link": "https://stackoverflow.com/users/4897027/tonatiuh-dansie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432912440, "creation_date": 1431541601, "last_edit_date": 1495539825, "question_id": 30222577, "link": "https://stackoverflow.com/questions/30222577/vba-macro-to-move-cells-to-a-new-sheet-and-removing-cell-headers-in-excel", "title": "VBA macro to move cells to a new sheet and removing cell headers in Excel", "body": "<p>I am trying to create a VBA macro to move contents on sheet 1 to rows on sheet 2. This is very similar to a question posted on here but I am unable to get the macro to work for me as I am not understanding the variable portion of the answer. <a href=\"https://stackoverflow.com/questions/25069593/vba-macro-to-move-cells-to-a-new-sheet-excel-based-on-cell-content#\">Previously Answered Question</a>\n<br>\nWe will be pasting a block of info into sheet one that looks like this, with all data in column A across multiple cells:<br><Br>\nIssue Description: Testing.</p>\n\n<p>Priority: Standard</p>\n\n<p>Person Number:       xxxxxxx</p>\n\n<p>Encounter Number: xxxxxxx</p>\n\n<p>Reported By: John CC X. Smith May 12 2015 11:40AM TSTEST2 (jsmith)</p>\n\n<p>Template Name: fts_clinical_guide_8310\n<br><br>\nSo what we would like is for the information in the Issue Description cell to move to a row on Sheet 2 with the text after the \":\" only and so on for the other cells. I also need all of the cell information to stay in 1 row when it gets moved to sheet 2. I hope this makes sense and I would really appreciate any help on this. Thanks.</p>\n\n<p><br> Edit: Here is the code I am trying to modify. It mentions the original answers \"headers\" that I would change later. For example it mentions MyID=\"\" and I have no idea how to put info into the quotes to make it work.\n<br></p>\n\n<pre><code>Sub MoveOver() \n\nCells(1, 1).Activate \n\nmyId = \"\"\nmyTitle = \"\"\nmyAuthor = \"\"\n\nWhile Not ActiveCell = \"\"\n\nIf UCase(Left(ActiveCell, 4)) Like \"*ID*\" Then myId = Trim(Mid(ActiveCell, InStr(1, ActiveCell, \":\") + 1, Len(ActiveCell)))\n\nIf UCase(Left(ActiveCell, 4)) = \"TITL\" Then myTitle = Trim(Mid(ActiveCell, InStr(1, ActiveCell, \":\") + 1, Len(ActiveCell)))\n\nIf UCase(Left(ActiveCell, 4)) = \"AUTH\" Then myAuthor = Trim(Mid(ActiveCell, InStr(1, ActiveCell, \":\") + 1, Len(ActiveCell)))\n\nIf ActiveCell Like \"*---*\" Then\n    'NOW, MOVE TO SHEET2!\n    toRow = Sheets(2).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Row\n    Sheets(2).Cells(toRow, 1) = myId\n    Sheets(2).Cells(toRow, 2) = myTitle\n    Sheets(2).Cells(toRow, 3) = myAuthor\n    myId = \"\"\n    myTitle = \"\"\n    myAuthor = \"\"\nEnd If\n\nActiveCell.Offset(1, 0).Activate\n\nWend\n</code></pre>\n"}, {"tags": ["vba", "loops", "excel"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1431541143, "post_id": 30222387, "comment_id": 48548694, "body": "Right now <code>counter</code> and <code>counter2</code> are doing the exact same thing.  Should <code>counter2</code> be outside the for loop?  And I am guessing you want to reset the counters to 1 for each sheet"}, {"owner": {"reputation": 81, "user_id": 3242245, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/686748789a42197c05c3e2ffb59de5a2?s=128&d=identicon&r=PG&f=1", "display_name": "user3242245", "link": "https://stackoverflow.com/users/3242245/user3242245"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1431541609, "post_id": 30222387, "comment_id": 48548965, "body": "Yes, guess I don&#39;t need the second counter at all."}], "answers": [{"tags": [], "owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "is_accepted": true, "score": 0, "last_activity_date": 1431541867, "creation_date": 1431541867, "answer_id": 30222650, "question_id": 30222387, "link": "https://stackoverflow.com/questions/30222387/loop-over-2-sets-of-worksheets-perform-calculations-and-populate-3rd-set-of-wo/30222650#30222650", "title": "loop over 2 sets of worksheets, perform calculations, and populate 3rd set of worksheets", "body": "<p>Move the initialization of <code>counter</code> to inside the <code>for each</code> loop so that it gets reset each time you get to a new sheet.  Also get rid of that second counter since you don't need it.</p>\n\n<pre><code>Sub DataSubtract()\n    Application.ScreenUpdating = False\n    Dim sheet_name As Range\n    Dim sheet_name2 As Range\n    Dim sheet_name3 As Range\n    Set sheet_name2 = Sheets(\"WS_QA\").Range(\"B:B\")\n    Set sheet_name3 = Sheets(\"WS_QA\").Range(\"C:C\")\n\n    'Counter 1\n    Dim counter As Long\n\n    For Each sheet_name In Sheets(\"WS_QA\").Range(\"A:A\")\n        counter = 1\n        If sheet_name.Value = \"\" Then\n            Exit For\n        Else\n            With Sheets(sheet_name.Value)\n            'Column C\n                For r = 14 To 39\n                .Cells(r, 3).Value = Sheets(sheet_name2(counter, 1).Value).Cells(r, 3).Value - Sheets(sheet_name3(counter, 1).Value).Cells(r, 3).Value\n                counter = counter + 1\n                Next r\n            End With\n        End If\n    Next sheet_name\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 3242245, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/686748789a42197c05c3e2ffb59de5a2?s=128&d=identicon&r=PG&f=1", "display_name": "user3242245", "link": "https://stackoverflow.com/users/3242245/user3242245"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 30222650, "answer_count": 1, "score": 0, "last_activity_date": 1432912362, "creation_date": 1431540894, "last_edit_date": 1432912362, "question_id": 30222387, "link": "https://stackoverflow.com/questions/30222387/loop-over-2-sets-of-worksheets-perform-calculations-and-populate-3rd-set-of-wo", "title": "loop over 2 sets of worksheets, perform calculations, and populate 3rd set of worksheets", "body": "<p>I'm trying to compare data across worksheets. I have values from <code>C14</code> to <code>C19</code> in worksheet 1.a and worksheet 1.b. I'm trying to use a <code>for each loop</code> to subtract the cells in column <code>C</code> in worksheet 1.a from the cells in column <code>C</code> in worksheet 1.b, and populate the results in column <code>C</code> on worksheet 1.c. I'm trying to use loops for this process because I have 50 worksheets with an a and b version. The below vba code populates the first two worksheet #.c with results but fails on all of the other worksheet #.c. Any suggestions are greatly appreciated.</p>\n\n<p>Here is the structure of the code: </p>\n\n<pre><code>    Sub DataSubtract()\nApplication.ScreenUpdating = False\n    Dim sheet_name As Range\n    Dim sheet_name2 As Range\n    Dim sheet_name3 As Range\n    Set sheet_name2 = Sheets(\"WS_QA\").Range(\"B:B\")\n    Set sheet_name3 = Sheets(\"WS_QA\").Range(\"C:C\")\n\n    'Counter 1\n    Dim counter As Long\n    counter = 1\n    'Counter 2 for sheet_name3\n    Dim counter2 As Long\n    counter2 = 1\n\n    'Row\n    Dim r As Long\n\n    For Each sheet_name In Sheets(\"WS_QA\").Range(\"A:A\")\n        If sheet_name.Value = \"\" Then\n            Exit For\n        Else\n            With Sheets(sheet_name.Value)\n            'Column C\n                For r = 14 To 39\n                .Cells(r, 3).Value = Sheets(sheet_name2(counter, 1).Value).Cells(r, 3).Value - Sheets(sheet_name3(counter2, 1).Value).Cells(r, 3).Value\n                counter = counter + 1\n                counter2 = counter2 + 1\n                Next r\n            End With\n        End If\n    Next sheet_name\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Best regards,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1431540716, "post_id": 30222289, "comment_id": 48548447, "body": "There is no Loop in the sample code, but it looks like you should change the indices in <code>Cells</code> property. First is row, second column."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431541620, "post_id": 30222289, "comment_id": 48548970, "body": "Your 2 calls to <code>Cells</code> refer to the <code>ActiveSheet</code> and not the <code>Chart Help</code> worksheet like you intend.  You will need to prefix <code>Cells</code> with <code>Worksheets(&quot;Chart Help&quot;).Cells</code> for it to not error."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1431541880, "post_id": 30222289, "comment_id": 48549120, "body": "What is <code>i</code>? Where is defined or assigned a value?"}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 0, "last_activity_date": 1431541998, "last_edit_date": 1431541998, "creation_date": 1431541692, "answer_id": 30222614, "question_id": 30222289, "link": "https://stackoverflow.com/questions/30222289/how-to-loop-through-a-range-using-a-variable-in-vba/30222614#30222614", "title": "How to loop through a range using a variable in vba", "body": "<p>I assume your loop has the proper code and you simply didn't paste it all.</p>\n\n<p>Your 2 calls to <code>Cells</code> refer to the <code>ActiveSheet</code> and not the <code>Chart Help</code> worksheet like you intend.  You will need to prefix <code>Cells</code> with <code>Worksheets(\"Chart Help\").Cells</code> for it to not error.</p>\n\n<p>Something like this:</p>\n\n<pre><code>ActiveChart.SeriesCollection(i).Values = Worksheets(\"Chart Help\").Range(Worksheets(\"Chart Help\").Cells(10 + j, 5), Worksheets(\"Chart Help\").Cells(10 + j, 1006))\n</code></pre>\n\n<p>Ideally you would define a reference to that worksheet to clean up the code.  You also do not have to prefix the <code>Range</code> with the worksheet in this case.  Those two ideas combined give:</p>\n\n<pre><code>Dim sht_chart As Worksheet\nSet sht_chart = Worksheets(\"Chart Help\")\nActiveChart.SeriesCollection(i).Values = Range(sht_chart.Cells(10 + j, 5), sht_chart.Cells(10 + j, 1006))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431976406, "post_id": 30224413, "comment_id": 48717492, "body": "I agree in the general case, this the preferred way to go.  Using <code>Cells</code> really prompts index based ranges (<code>For i = 1 to 10... Cells(i,5)</code>) which is impossible to maintain."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 1, "last_activity_date": 1431548163, "creation_date": 1431548163, "answer_id": 30224413, "question_id": 30222289, "link": "https://stackoverflow.com/questions/30222289/how-to-loop-through-a-range-using-a-variable-in-vba/30224413#30224413", "title": "How to loop through a range using a variable in vba", "body": "<p>Replace </p>\n\n<pre><code>.Range(Cells(10 + j, 5), Cells(10 + j, 1006))\n</code></pre>\n\n<p>with</p>\n\n<pre><code>.Range(\"E10\").Offset(j,0).Resize(1, 1001)\n</code></pre>\n\n<p>In general avoid using the Cells to target cells, and instead start from a fixed address (like \"E10\" above) and using a combination of <code>.Offset()</code> and <code>.Resize()</code> to tweak the range of cells you want to act upon.</p>\n"}], "owner": {"reputation": 3, "user_id": 4896999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1985c6436a71afe1e3d1f71e6b78c1cb?s=128&d=identicon&r=PG&f=1", "display_name": "Norman", "link": "https://stackoverflow.com/users/4896999/norman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 30222614, "answer_count": 2, "score": 0, "last_activity_date": 1431548163, "creation_date": 1431540520, "last_edit_date": 1531161705, "question_id": 30222289, "link": "https://stackoverflow.com/questions/30222289/how-to-loop-through-a-range-using-a-variable-in-vba", "title": "How to loop through a range using a variable in vba", "body": "<p>I'm trying to loop through a range below and get runtime error 1004. The highlighted row is this one here:</p>\n\n<pre><code>ActiveChart.SeriesCollection(i).Values = Worksheets(\"Chart Help\").Range(Cells(10 + j, 5), Cells(10 + j, 1006))\n</code></pre>\n\n<p>Can anyone tell me what's wrong?  </p>\n\n<pre><code>If Worksheets(\"Chart Help\").Cells(4, 9 + j) &lt;&gt; \" \" Then\n    ActiveChart.SeriesCollection.NewSeries\n    ActiveChart.SeriesCollection(i).Name = Worksheets(\"Chart Help\").Cells(4, 9 + j)\n    ActiveChart.SeriesCollection(i).XValues = Worksheets(\"Chart Help\").Range(\"J5:J1006\")\n    ActiveChart.SeriesCollection(i).Values = Worksheets(\"Chart Help\").Range(Cells(10 + j, 5), Cells(10 + j, 1006))\n    ActiveChart.SeriesCollection(i).Select\n\n    With Selection.Format.Line\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorAccent6\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = 0\n        .Transparency = 0\n    End With\n\n    i = i + 1\nEnd If\n\nj = j + 1\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1431539122, "post_id": 30221808, "comment_id": 48547534, "body": "If im not mistaken it&#39;s doing exactly what your code says.  Within your main<code>With</code> you&#39;re changing the style three different times and the last one is the Italic.  Try separting out your <code>With</code> into the three sentences/styles."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4896215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96e62f38f4cf7bd1e50d58c9da9450c9?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4896215/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1431543019, "creation_date": 1431543019, "answer_id": 30223008, "question_id": 30221808, "link": "https://stackoverflow.com/questions/30221808/excel-vba-to-word-doc-changing-font-styles-within-a-sentence-paragraph/30223008#30223008", "title": "Excel VBA to Word Doc - Changing font styles within a sentence/paragraph", "body": "<p>I'm not 100% sure why you have to you .selection the word.application but this solves my problem. If anyone could answer this that would be great just for my basic understanding (new to this).</p>\n\n<pre><code>Dim appWord As Word.Application\nDim objDoc As Word.Document\nSet appWord = New Word.Application\nappWord.Visible = True\nSet objDoc = appWord.Documents.Add\n\nWith appWord.Selection\n.Font.Name = \"Arial Narrow\"\n.Font.Size = 11\n.TypeText Text:=\"Please see \"\n.Font.Bold = wdToggle\n.TypeText Text:=\"Table 1\"\n.Font.Bold = wdToggle\n.Font.Italic = wdToggle\n.TypeText Text:=\". Note Table 1 is assumed.\"\nEnd With\n\nobjDoc.Close savechanges:=wdSaveChanges\nappWord.Quit\nSet objDoc = Nothing\nSet objWord = Nothing\nEnd Sub\n</code></pre>\n\n<p>Hope this can help someone else in the future.</p>\n"}], "owner": {"reputation": 1, "user_id": 4896215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96e62f38f4cf7bd1e50d58c9da9450c9?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4896215/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2443, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1431543019, "creation_date": 1431538857, "last_edit_date": 1431541278, "question_id": 30221808, "link": "https://stackoverflow.com/questions/30221808/excel-vba-to-word-doc-changing-font-styles-within-a-sentence-paragraph", "title": "Excel VBA to Word Doc - Changing font styles within a sentence/paragraph", "body": "<p>My goal is to write a sentence/paragraph with the ability to change font styles within the same sentence/paragraph. This is being done in <strong>Excel VBA</strong> and outputs in a word document (I'm sure you can tell).</p>\n\n<p>Example: \"Please see <strong>Table 1</strong>. <em>Note Table 1 is assumed.</em>\"</p>\n\n<p>With the code below it seems to set the whole sentence to the last wdStyleTypeCharacter that was called out.</p>\n\n<pre><code>Dim appWord As Word.Application\nDim objDoc As Word.Document\nSet appWord = New Word.Application\nappWord.Visible = True\nSet objDoc = appWord.Documents.Add\n\nSet Normal = objDoc.Styles.Add(Name:=\"Normal\", Type:=wdStyleTypeCharacter)\nSet Bold = objDoc.Styles.Add(Name:=\"Bold\", Type:=wdStyleTypeCharacter)\nSet Italic = objDoc.Styles.Add(Name:=\"Italic\", Type:=wdStyleTypeCharacter)\n\nWith objDoc\n\nWith .Styles(Normal)\n.Font.Name = \"Arial Narrow\"\n.Font.Size = 11\n.Font.Italic = False\n.Font.Bold = False\nEnd With\n\nWith .Styles(Bold)\n.Font.Name = \"Arial Narrow\"\n.Font.Size = 11\n.Font.Italic = False\n.Font.Bold = True\nEnd With\n\nWith .Styles(Italic)\n.Font.Name = \"Arial Narrow\"\n.Font.Size = 11\n.Font.Italic = True\n.Font.Bold = False\nEnd With\n\n.Content.InsertParagraphAfter\n.Range.Style = .Styles(Normal)\n.Content.InsertAfter \"Please see \"\n.Range.Style = .Styles(Bold)\n.Content.InsertAfter \"Table 1\"\n.Range.Style = .Styles(Italic)\n.Content.InsertAfter \".  Note Table 1 is assumed.\"\n.Content.InsertParagraphAfter\n\nEnd with\n\nobjDoc.Close savechanges:=wdSaveChanges\nappWord.Quit\nSet objDoc = Nothing\nSet objWord = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "edited": false, "score": 1, "creation_date": 1431539192, "post_id": 30221783, "comment_id": 48625718, "body": "This is certainly possible but I would recommend you not saving the full name, which adds complication and creates data redundancy, which you always want to avoid in your database design. Just store first and last names and combine them when they are displayed or printed."}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1431539230, "post_id": 30221783, "comment_id": 48547584, "body": "So, 1 column that stores First name, last name, full name and you want to know if you can have a hidden input field for what purpose? VBA can handle this quite easily with 3 different fields"}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1431539439, "post_id": 30221783, "comment_id": 48547727, "body": "@Invent-Animate No, these are 3 separate columns. Technically one of them (full name) is being sent to a completely different database, but that is irrelevant for the sake of this question. The hidden input field would just easily pass data without the user having to input redundant information."}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1431539484, "post_id": 30221783, "comment_id": 48547752, "body": "<i>&quot;I am creating an access database that requires I have a column for the following three fields &quot;</i> - What is that saying then?"}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1431539581, "post_id": 30221783, "comment_id": 48547817, "body": "@Invent-Animate I apologize, that was very poorly worded. I altered my original statement to be &quot;I am creating an access database that requires I have a separate column for each of the following three fields&quot;"}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1431539611, "post_id": 30221783, "comment_id": 48547833, "body": "With VBA, you can fire that information off at any point, really. You just need to determine at what point are <i>you sure</i> that they have filled out the information and won&#39;t make any changes before you send it? VBA can concatenate the 2 strings together and send it, but when are you going to call this method?"}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1431539688, "post_id": 30221783, "comment_id": 48547887, "body": "@Invent-Animate I was going to make a macro that would combine the names when the user presses the submit button, then parse all data. If this isn&#39;t a very good way of doing it, could you point me in the right direction as to what I should do?"}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1431539818, "post_id": 30221783, "comment_id": 48547964, "body": "If you have a form with First Name (named firstName) &amp; Last Name(named lastName) text box controls, and a submit button on that form, in VBA you can reference the values in those fields and do with them what you please. If you need an example let me know, and I&#39;ll throw an answer together"}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1431539859, "post_id": 30221783, "comment_id": 48547995, "body": "@Invent-Animate If you could that would be great! I&#39;ll start working on it and use it as reference. I appreciate the help!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1431540271, "post_id": 30221783, "comment_id": 48548211, "body": "If your Access version is 2010 or later, you could use its calculated field type or data macro feature.  Either technique could maintain full name even for data changes made from outside your form."}], "answers": [{"comments": [{"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "edited": false, "score": 0, "creation_date": 1431541156, "post_id": 30222282, "comment_id": 48548702, "body": "This makes sense, but it isn&#39;t parsing to my database upon click of the submit button. Would you know why?"}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "reply_to_user": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "edited": false, "score": 0, "creation_date": 1431541247, "post_id": 30222282, "comment_id": 48548760, "body": "Well, there&#39;s a few possibilities. Did you create new text boxes to accommodate my answer? Were you using any VBA before? What changes did you make? What isn&#39;t it doing that you need it to?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1431541378, "post_id": 30222282, "comment_id": 48548828, "body": "Did you add <code>Option Explicit</code> to the module&#39;s Declarations section and then run Debug-&gt;Compile and fix any problems the compiler complained about?"}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "edited": false, "score": 0, "creation_date": 1431541503, "post_id": 30222282, "comment_id": 48548901, "body": "I figured it out. Instead of assigning the values to <code>FullName</code> (the title of the Column) I was supposed to assign them to the name of the textbox. Very new to VBA, so still learning. Thanks Invnet, everything is good now!"}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1431541536, "post_id": 30222282, "comment_id": 48548917, "body": "Oh, yeah - I didn&#39;t know that was the name of your column!"}], "tags": [], "owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "is_accepted": true, "score": 1, "last_activity_date": 1431540483, "creation_date": 1431540483, "answer_id": 30222282, "question_id": 30221783, "link": "https://stackoverflow.com/questions/30221783/access-form-input-auto-fill-as-user-passes-data/30222282#30222282", "title": "Access Form Input - Auto-Fill as User Passes Data", "body": "<p>In your form, if you have 2 inputs for <code>First Name</code> and <code>Last Name</code>, we can utilize VBA to simply concatenate our strings for us.</p>\n\n<p>For this example, I named my textboxes <code>txtFirstName</code> and <code>txtLastName</code>, respectively.</p>\n\n<p>I then created a button to simulate your Submit button click, and here's the code to create the full name. What you do with it is up to you.</p>\n\n<pre><code>Dim FirstName, LastName, FullName As String\n\nFirstName = Me.txtFirstName\nLastName = Me.txtLastName\n\nFullName = LastName &amp; \", \" &amp; FirstName\nDebug.Print FullName  'Optional; just to show you results\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/dii45.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 30222282, "answer_count": 1, "score": 0, "last_activity_date": 1431540509, "creation_date": 1431538764, "last_edit_date": 1431540509, "question_id": 30221783, "link": "https://stackoverflow.com/questions/30221783/access-form-input-auto-fill-as-user-passes-data", "title": "Access Form Input - Auto-Fill as User Passes Data", "body": "<p>I am creating an access database that requires I have a separate column for each of the following three fields (which are related to my question): First name, last name, full name (syntax: \"last, first\"). </p>\n\n<p>I was wondering if there was a way that I could have a hidden input field (which would be the \"full name\" field). This hidden field would be filled with the data the user types in for \"first name\" and \"last name\", and would parse to the database all the same. Is this possible using basic Forms in Microsoft Access? Could I code the value for the field to be the user's input.</p>\n\n<p>TIA!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1431539845, "post_id": 30221666, "comment_id": 48547984, "body": "One possible way is to check the decimal value returned by RGB function (for <code>RGB(200, 0, 0)</code> it&#39;s simply <code>200</code>)  and enter this value in properties window. It will be automatically converted to HEX BGR"}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1431546746, "post_id": 30222044, "comment_id": 48551910, "body": "How did you bring that window up? I am not able to find a button for that. The one with the colors"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1431546852, "post_id": 30222044, "comment_id": 48551962, "body": "Once in the VBA editor, hit <code>F4</code> or on the menu <code>View-&gt;Properties Window</code>"}, {"owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1431546927, "post_id": 30222044, "comment_id": 48552003, "body": "Figured it out thank you. I had mines in Dock mode. Thank you a lot"}, {"owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1431546982, "post_id": 30222044, "comment_id": 48552029, "body": "The F4 way is even better of what I found."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 0, "last_activity_date": 1431539657, "creation_date": 1431539657, "answer_id": 30222044, "question_id": 30221666, "link": "https://stackoverflow.com/questions/30221666/excel-vba-red-color-labeled/30222044#30222044", "title": "Excel-VBA Red color labeled", "body": "<p>You can use the <code>Initialize</code> event for the form instead of putting the event on a <code>Click</code> event.</p>\n\n<p>Here is an example with the form named <code>UserForm</code>.  Use the dropdowns to select the form and then the <code>Initialize</code> event.</p>\n\n<p><img src=\"https://i.stack.imgur.com/NY9fM.png\" alt=\"form events\"></p>\n\n<p>You can also just set the color in the properties if you know this is the color you want.</p>\n\n<p><img src=\"https://i.stack.imgur.com/JL8sr.png\" alt=\"label properties\"></p>\n"}], "owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2401, "favorite_count": 0, "accepted_answer_id": 30222044, "answer_count": 1, "score": 0, "last_activity_date": 1431539657, "creation_date": 1431538363, "question_id": 30221666, "link": "https://stackoverflow.com/questions/30221666/excel-vba-red-color-labeled", "title": "Excel-VBA Red color labeled", "body": "<p>I am trying to make a red label appear on my form and can not. I have tried changing the property to RGB and HEX and just get errors. Is there a way to get a property value to make my label RGB(200, 0, 0)? I am unaware of how the value in the property areas is developed. </p>\n\n<p>This is the only way I can make a red label:</p>\n\n<pre><code>Private Sub Label13_Click()\n Label13.BackColor = RGB(200, 0, 0)\nEnd Sub\n</code></pre>\n\n<p>I have to click the label to make it red. Is there a way to use code to make it red when the form starts? Or perhaps generate a value for the property? Thank you for your help in advance.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2003"], "answers": [{"tags": [], "owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "is_accepted": true, "score": 0, "last_activity_date": 1431613137, "creation_date": 1431613137, "answer_id": 30239733, "question_id": 30221299, "link": "https://stackoverflow.com/questions/30221299/running-a-macro-a-specific-day-at-a-specific-time-range-in-ms-access/30239733#30239733", "title": "Running a macro a specific day at a specific time range in Ms Access", "body": "<p>You need to check the current date for its weekday using the <code>Weekday()</code> function and the times, as @HansUP was suggesting. The critical part is making sure the procedure is run only once, not every time you open the app. So what you need to do is make sure the app knows if you have previously run it that day.</p>\n\n<p>My solution would look like this:</p>\n\n<ul>\n<li>I would have a table with one field, i.e. 'ExectureProcedure' of type <code>Boolean</code> and only one row, so the table would look like this:</li>\n</ul>\n\n<blockquote>\n<pre><code> ========================\n| ID | ProcedureExecuted |\n|====|===================| \n| 1  |      False        |\n ========================\n</code></pre>\n</blockquote>\n\n<ul>\n<li>Each time you run check the conditions and the time and weekday does <strong>NOT</strong> meet your criteria, you set the value in this table to <code>False</code>, otherwise you leave it.</li>\n<li>You set the value to <code>True</code> only after the procedure finishes.</li>\n</ul>\n\n<p>Pseudo code, merely for illustration:</p>\n\n<blockquote>\n<pre><code>If [ExecuteConditionsOK] = True AND [ProcedureExecuted] = False Then\n   Run your procedure\n   Set [ProcedureExecuted] to True\nElseif [ExecuteConditionsOK] = False Then\n   Set [ProcedureExecuted] to False\nEnd if\n</code></pre>\n</blockquote>\n\n<p>In short, the procedure will only run if the <code>ProcedureExecuted</code> flag is false, which can only be set when the date does not meet your conditions, so the app will run it the next time when it will.</p>\n\n<p>I hope this solution is clear as I didn't have time to write the actual VBA code, but from the top of my head, you will need to use these functions: <code>Weekday</code>, <code>DLookup</code>. If you'll struggle, post it in the comments.</p>\n"}], "owner": {"reputation": 3687, "user_id": 4331334, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/aewEH.jpg?s=128&g=1", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/4331334/coding-enthusiast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 0, "accepted_answer_id": 30239733, "answer_count": 1, "score": 1, "last_activity_date": 1431613137, "creation_date": 1431537206, "last_edit_date": 1431539114, "question_id": 30221299, "link": "https://stackoverflow.com/questions/30221299/running-a-macro-a-specific-day-at-a-specific-time-range-in-ms-access", "title": "Running a macro a specific day at a specific time range in Ms Access", "body": "<p>I have my VBA functions in a module. I call my function from a Macro. I have it in the <em>autoexec</em> macro. So everytime my database is opened, it runs the function. That works great so far. </p>\n\n<p>Now I am trying to make the function run <strong>only</strong> on Monday mornings at a specific time range, for example: Mondays between 8Am - 12:00PM, <em>not everyday</em> since the database needs to be updated <strong>only on Mondays</strong>.. I can't find a way to do it. My function code is below: </p>\n\n<pre><code>Public Function DownloadFromS()\n    On Error GoTo DownloadErrorHandler\n\n    Dim stDocName As String\n    stDocName = \"getThemFromS\"\n    DoCmd.RunMacro stDocName\nExit_DownloadS:\n    Exit Function\nDownloadErrorHandler:\n    MsgBox \"Sorry Sto is offline, re-establish our connection\"\n    Resume Exit_DownloadS\nEnd Function\n</code></pre>\n\n<p>I am fairly new to VBA so it is a bit hard to wrap my head around it...</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "excel-2007"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1431538178, "post_id": 30221142, "comment_id": 48546932, "body": "This is very simple to do, but we need the schema for the <i>UUID</i> column..........are there 8 sets of values 1-7 or are there 11 sets of values 1-23, etc.??"}, {"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1431539044, "post_id": 30221142, "comment_id": 48547503, "body": "There are 69 sets. The UUID values are not values, but randomly generated strings.  Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431539660, "post_id": 30221698, "comment_id": 48547871, "body": "Beautiful! Thank you so much S&#248;ren! This works perfectly (though it leaves out all headers except the first, it&#39;s trivial to input those manually).  I&#39;ll play with this and keep developing my understanding of macros!"}, {"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431556923, "post_id": 30221698, "comment_id": 48556702, "body": "Actually, I&#39;ve run up against an issue. When originally testing your code, I ran it on a small test dataset I&#39;d created so as not to eat up processing power while working on another project.  When running it on the full dataset, it returns a &quot;400&quot; error and only pastes the UUID Header and the first UUID into the new sheet.  When run on a set containing only the first 1377 rows (where there should be no repeats), it still returns the 400 error and only returns the first 571 rows.   Any advice? Thanks for your help so far!"}, {"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431557360, "post_id": 30221698, "comment_id": 48556839, "body": "After adding an error catch to return an error description, the 400 error becomes &quot;Application-defined or object-defined error&quot;."}], "tags": [], "owner": {"reputation": 4203, "user_id": 2119523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fkQjy.jpg?s=128&g=1", "display_name": "Netloh", "link": "https://stackoverflow.com/users/2119523/netloh"}, "is_accepted": false, "score": 1, "last_activity_date": 1431539053, "last_edit_date": 1431539053, "creation_date": 1431538468, "answer_id": 30221698, "question_id": 30221142, "link": "https://stackoverflow.com/questions/30221142/de-stacking-columns-in-excel-using-vba/30221698#30221698", "title": "De-Stacking columns in Excel using VBA", "body": "<p>One take on a VBA code that will achieve this is:</p>\n\n<pre><code>Sub DestackColumns()\n    Dim Source As Worksheet\n    Dim Output As Worksheet\n    Dim DistArr As Variant\n    Dim i As Integer\n    Dim j As Integer\n    Dim OutRow As Integer\n\n    Set Source = ActiveSheet\n    Sheets.Add After:=ActiveWorkbook.Sheets(ActiveSheet.Index)\n    Set Output = ActiveSheet\n\n    Output.Name = \"Destack\"\n    Output.Range(\"A1\").Value = \"UUID\"\n\n    'Find distinct UUID's\n    DistArr = ReturnDistinct(Source.Range(\"A2:\" &amp; Source.Cells(Rows.Count, 1).End(xlUp).Address))\n\n    'Loop through distinct UUID's\n    For i = LBound(DistArr) To UBound(DistArr)\n        OutRow = Output.Cells(Rows.Count, 1).End(xlUp).Row + 1\n        Output.Cells(OutRow, 1).Value = DistArr(i)\n\n        'Loop source sheet\n        For j = 2 To Source.Cells(Rows.Count, 1).End(xlUp).Row\n            'IF UUID match\n            If Source.Cells(j, 1).Value = DistArr(i) Then\n                'Insert values\n                Output.Cells(OutRow, Columns.Count).End(xlToLeft).Offset(0, 1).Value = Source.Cells(j, 2).Value\n                Output.Cells(OutRow, Columns.Count).End(xlToLeft).Offset(0, 1).Value = Source.Cells(j, 3).Value\n            End If\n        Next j\n    Next i\n\nEnd Sub\n\n\nPrivate Function ReturnDistinct(InpRng) As Variant\n    Dim Cell As Range\n    Dim i As Integer\n    Dim DistCol As New Collection\n    Dim DistArr()\n\n    If TypeName(InpRng) &lt;&gt; \"Range\" Then Exit Function\n\n    'Add all distinct values to collection\n    For Each Cell In InpRng\n        On Error Resume Next\n        DistCol.Add Cell.Value, CStr(Cell.Value)\n        On Error GoTo 0\n    Next Cell\n\n    'Write collection to array\n    ReDim DistArr(1 To DistCol.Count)\n    For i = 1 To DistCol.Count Step 1\n        DistArr(i) = DistCol.Item(i)\n    Next i\n\n    ReturnDistinct = DistArr\nEnd Function\n</code></pre>\n\n<p>This code will place the new data structure on a new sheet (i.e. not overwrite your original data) and with this code you do not need to worry about if the data is sorted properly.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431539734, "post_id": 30221745, "comment_id": 48547903, "body": "S&#248;ren&#39;s code gave me what I needed for now, but I&#39;ll play with this too!  Thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 1, "creation_date": 1431542131, "post_id": 30221745, "comment_id": 48549262, "body": "No worries. BTW, in your original code the use of cell references like <code>Cells(1, iCell)</code> should have been <code>Cells(iCell, 1)</code>. You had the rows and columns flipped. see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range . Cells Property ( Excel )</a> for more information."}, {"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431546065, "post_id": 30221745, "comment_id": 48551554, "body": "That explains so much.   Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1431538622, "creation_date": 1431538622, "answer_id": 30221745, "question_id": 30221142, "link": "https://stackoverflow.com/questions/30221142/de-stacking-columns-in-excel-using-vba/30221745#30221745", "title": "De-Stacking columns in Excel using VBA", "body": "<p>Your sample code indicates that you wish to remove the original values in favor of the new matrix. To that end, I would suggest running this on a copy of the data first.</p>\n\n<pre><code>Sub stack_horizontally()\n    Dim rw As Long, mrw As Long\n\n    With ActiveSheet   '&lt;-set this worksheet name properly!\n        For rw = .Cells(Rows.Count, 1).End(xlUp).Row To 3 Step -1\n            mrw = Application.Match(.Cells(rw, 1), .Columns(1), 0)\n            If mrw &lt; rw Then\n                .Cells(mrw, Columns.Count).End(xlToLeft).Offset(0, 1) = .Cells(rw, 2).Value\n                .Cells(mrw, Columns.Count).End(xlToLeft).Offset(0, 1) = .Cells(rw, 3).Value\n                .Rows(rw).Delete\n            End If\n        Next rw\n    End With\nEnd Sub\n</code></pre>\n\n<p>I haven't populated the headers into the new columns but that should be a minor manual operation.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431739077, "post_id": 30227213, "comment_id": 48641221, "body": "It only worked for the first 690 UUIDs, but I just cut the list and ran it twice, and it worked perfectly! Thanks so much!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431785892, "post_id": 30227213, "comment_id": 48652038, "body": "@AidanLambert Glad it worked.  But I am curious -- what happened after the first 690?  Did you get an error message?  Was there something different about the data?  Something else?  It&#39;s probably a simple fix."}, {"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431988875, "post_id": 30227213, "comment_id": 48723191, "body": "Hi Ron! Sorry, I should have been more specific. I have absolutely no idea what caused that behavior, but I suspect it has to do with the limits of the machine I work on (an old-ish MBP running excel for mac). I&#39;ve observed similar behavior when running macros on large datasets before on this machine."}, {"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431988880, "post_id": 30227213, "comment_id": 48723192, "body": "No error was returned, the results simply ended at the 554th entry the first time I ran it (iirc, the file&#39;s since been edited and I can&#39;t easily verify the exact number: this project is a bit out of my company&#39;s usual scope, and I admit we&#39;ve done a poor job of version control). The second iteration (without the data destacked in the first one) ran for 691. The final ran for 131, but that is because those were the only ones left."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1431996964, "post_id": 30227213, "comment_id": 48725584, "body": "@AidanLambert Thank you very much for that information.  Is there any chance of getting a copy of the original data, (with sensitive information redacted), so I can try running it on my machine?  I&#39;m surprised it would just stop without some kind of error message, unless there was some issue with the routine that selects the area to be processed."}, {"owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1432066461, "post_id": 30227213, "comment_id": 48765095, "body": "Unfortunately I wouldn&#39;t be comfortable sending along the file with the response data, even though the UUIDs are anonymized. That said, I definitely understand why you&#39;d want to troubleshoot it to see if there are any good learnings from it.  I can change all the response data to gibberish and see if that fixes it (maybe some funny characters are to blame). If it still behaves funny with gibberish, I&#39;d be happy to send that file along. I&#39;ll try and get to that in the next couple of days if possible."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "edited": false, "score": 0, "creation_date": 1432083937, "post_id": 30227213, "comment_id": 48771126, "body": "@AidanLambert  Thank you very much"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1431562426, "last_edit_date": 1431562426, "creation_date": 1431561998, "answer_id": 30227213, "question_id": 30221142, "link": "https://stackoverflow.com/questions/30221142/de-stacking-columns-in-excel-using-vba/30227213#30227213", "title": "De-Stacking columns in Excel using VBA", "body": "<p>Here is a somewhat different approach.  I have set up a user defined class called cUUID.  The class has the properties of the UUID, Response, ResponseCode and a Collection consisting of the paired Response and ResponseCode.</p>\n\n<p>We create a Collection of this class object, where each member of the collection is a specific UUID (since that's how you want to group them).</p>\n\n<p>The code iterates through your data source, creating these objects \"on the fly\".  We then create an array containing all the results, and write this array to a different worksheet.</p>\n\n<p>It should be obvious in the code how to change those worksheet names, and, if necessary, the locations of the source data and results.</p>\n\n<p>After you Insert the Class Module, you must select it, <code>F4</code> and rename it <strong>cUUID</strong></p>\n\n<h2>Class Module</h2>\n\n<pre><code>Option Explicit\nPrivate pUUID As String\nPrivate pResponse As String\nPrivate pRespCode As String\nPrivate pCol As Collection\n\nPublic Property Get UUID() As String\n    UUID = pUUID\nEnd Property\nPublic Property Let UUID(Value As String)\n    pUUID = Value\nEnd Property\n\nPublic Property Get Response() As String\n    Response = pResponse\nEnd Property\nPublic Property Let Response(Value As String)\n    pResponse = Value\nEnd Property\n\nPublic Property Get RespCode() As String\n    RespCode = pRespCode\nEnd Property\nPublic Property Let RespCode(Value As String)\n    pRespCode = Value\nEnd Property\n\nPublic Property Get Col() As Collection\n    Set Col = pCol\nEnd Property\n\nPublic Sub Add(Resp1 As String, RC As String)\n    Dim V(1 To 2) As Variant\n    V(1) = Resp1\n    V(2) = RC\n    Col.Add V\nEnd Sub\n\nPrivate Sub Class_Initialize()\n    Set pCol = New Collection\nEnd Sub\n\n\nPrivate Sub Class_Terminate()\n    Set pCol = Nothing\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Regular Module</h2>\n\n<pre><code>Option Explicit\nSub ConsolidateUUIDs()\n    Dim cU As cUUID, colU As Collection\n    Dim wsSrc As Worksheet, wsRes As Worksheet, rRes As Range\n    Dim vSrc As Variant, vRes() As Variant\n    Dim RespPairs As Long\n    Dim I As Long, J As Long\n\nSet wsSrc = Worksheets(\"Sheet1\")\nSet wsRes = Worksheets(\"Sheet2\")\nSet rRes = wsRes.Cells(1, 1)\n\nWith wsSrc\n    vSrc = .Range(.Cells(1, 1), .Cells(.Rows.Count, \"C\").End(xlUp))\nEnd With\n\n'Collect the data\nSet colU = New Collection\nRespPairs = 1\nOn Error Resume Next\nFor I = 2 To UBound(vSrc)\n    Set cU = New cUUID\n    With cU\n        .UUID = vSrc(I, 1)\n        .Response = vSrc(I, 2)\n        .RespCode = vSrc(I, 3)\n        .Add .Response, .RespCode\n        colU.Add cU, CStr(.UUID)\n        Select Case Err.Number\n            Case 457\n                Err.Clear\n                colU(CStr(.UUID)).Add .Response, .RespCode\n                J = colU(CStr(.UUID)).Col.Count\n                RespPairs = IIf(J &gt; RespPairs, J, RespPairs)\n            Case Is &lt;&gt; 0\n                Debug.Print Err.Number, Err.Description\n                Stop\n        End Select\n    End With\nNext I\nOn Error GoTo 0\n\n'Sort Collection by UUID\nCollectionBubbleSort colU, \"UUID\"\n\n'Create Results Array\nReDim vRes(0 To colU.Count, 0 To RespPairs * 2)\n\n'header row\nvRes(0, 0) = \"UUID\"\nFor J = 0 To RespPairs - 1\n    vRes(0, J * 2 + 1) = \"RESPONSE\"\n    vRes(0, J * 2 + 2) = \"Resp.Code\"\nNext J\n\n'Data rows\nFor I = 1 To colU.Count\n    With colU(I)\n        vRes(I, 0) = .UUID\n        For J = 1 To colU(I).Col.Count\n            vRes(I, (J - 1) * 2 + 1) = colU(I).Col(J)(1)\n            vRes(I, (J - 1) * 2 + 2) = colU(I).Col(J)(2)\n        Next J\n    End With\nNext I\n\n'Write the results array\nSet rRes = rRes.Resize(UBound(vRes, 1) + 1, UBound(vRes, 2) + 1)\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    With .Rows(1)\n        .Font.Bold = True\n        .HorizontalAlignment = xlCenter\n    End With\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n\n'-------------------------------------------------------\n'Could use faster sort routine if necessary\nSub CollectionBubbleSort(TempCol As Collection, Optional Prop As String = \"\")\n'Must manually insert element of collection to sort on in this version\n    Dim I As Long\n    Dim NoExchanges As Boolean\n\n    ' Loop until no more \"exchanges\" are made.\n    Do\n        NoExchanges = True\n\n        ' Loop through each element in the array.\n        For I = 1 To TempCol.Count - 1\n\nIf Prop = \"\" Then\n\n            ' If the element is greater than the element\n            ' following it, exchange the two elements.\n            If TempCol(I) &gt; TempCol(I + 1) Then\n                NoExchanges = False\n                TempCol.Add TempCol(I), after:=I + 1\n                TempCol.Remove I\n            End If\nElse\n        If CallByName(TempCol(I), Prop, VbGet) &gt; CallByName(TempCol(I + 1), Prop, VbGet) Then\n                NoExchanges = False\n                TempCol.Add TempCol(I), after:=I + 1\n                TempCol.Remove I\n            End If\nEnd If\n        Next I\n    Loop While Not (NoExchanges)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The UUID's will be sorted alphabetically.\nThe code should work with varying numbers of UUID's, and varying numbers of responses to each of the UUID's.</p>\n"}], "owner": {"reputation": 13, "user_id": 3897475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e069290cba15f51f163cd3bb240378?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Lambert", "link": "https://stackoverflow.com/users/3897475/aidan-lambert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 30227213, "answer_count": 3, "score": 1, "last_activity_date": 1431562426, "creation_date": 1431536661, "question_id": 30221142, "link": "https://stackoverflow.com/questions/30221142/de-stacking-columns-in-excel-using-vba", "title": "De-Stacking columns in Excel using VBA", "body": "<p>I have a dataset in three columns composed of a repeating set of UUIDs in the first column, string responses for each UUID in the second, and a code for each response in the third. I need to break this out into multiple sets of columns, one for each repeating set of UUIDs. See the below illustration:</p>\n\n<p>I Have: </p>\n\n<pre><code>UUID    RESPONSE    Resp. Code \nid1     String1     Code1\nid2     String2     Code7\nid3     String3     Code3\nid1     String4     Code3\nid2     String5     Code5\nid3     String6     Code1\n</code></pre>\n\n<p>I need:</p>\n\n<pre><code>UUID    RESPONSE    Resp. Code  RESPONSE    Resp. Code \nid1     String1     Code1       String4     Code3\nid2     String2     Code7       String5     Code5\nid3     String3     Code3       String6     Code1\n</code></pre>\n\n<p>Note that while there are 3 UUIDs illustrated here, I'm actually dealing with 1377.</p>\n\n<p>I've attempted to write a macro for this operation (pasted below), but I am a complete noob to VBA and Excel macros, so it is hacky and does not do even close what I want it to.</p>\n\n<pre><code>    Sub DestackColumns()\n    Dim rng As Range\n    Dim iCell As Integer\n    Dim lastCol As Integer\n    Dim iCol As Integer\n\n    Set rng = ActiveCell.CurrentRegion\n    lastCol = rng.Rows(1).Columns.Count\n\n    For iCell = 3 To rng.Rows.Count Step 3\n        Range(Cells(1, iCell), Cells(2, iCell)).Cut\n        ActiveSheet.Paste Destination:=Cells(lastCol, 1)\n    Next iCell\n    End Sub\n</code></pre>\n\n<p>All help appreciated!</p>\n"}, {"tags": ["c#", "vba", "dll", "activex"], "comments": [{"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1431537232, "post_id": 30220038, "comment_id": 48546423, "body": "The error message you are seeing is indicative of the ActiveX installer mechanism firing, and identifying a dependency that must be installed. The installer is being led to believe that the dependency is located within the CAB file at the specified URL; for some reason, it thinks that CAB is available on your local server. The bigger problem is that the dependence, MSCOREE, is the base/foundational DLL for the .NET Framework, so I don&#39;t think a single-file CAB install will fix your problem."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5100744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7fa2eb17d73f36cd01abdc6a44c58d3?s=128&d=identicon&r=PG&f=1", "display_name": "Glen Clark", "link": "https://stackoverflow.com/users/5100744/glen-clark"}, "is_accepted": false, "score": 1, "last_activity_date": 1436499023, "creation_date": 1436499023, "answer_id": 31331985, "question_id": 30220038, "link": "https://stackoverflow.com/questions/30220038/activex-in-net-mscoree-dll/31331985#31331985", "title": "ActiveX in .NET, mscoree.dll", "body": "<p>FT View SE (RSView SE) for some reason cannot find mscoree.dll which is registered as the InprocServer32 when we run regasm.\nPutting in the full path (\"C:\\Windows\\SysWow64\\mscoree.dll\") fixed this for me.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9247201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/befbb072c0cee8f28ce77db19be7fa72?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuele Manca", "link": "https://stackoverflow.com/users/9247201/emanuele-manca"}, "is_accepted": false, "score": 0, "last_activity_date": 1516537920, "last_edit_date": 1516537920, "creation_date": 1516537351, "answer_id": 48366695, "question_id": 30220038, "link": "https://stackoverflow.com/questions/30220038/activex-in-net-mscoree-dll/48366695#48366695", "title": "ActiveX in .NET, mscoree.dll", "body": "<p>you must change the key \"InprocServer32\" with the full path of mscorre.dll in the System register.\n<a href=\"https://i.stack.imgur.com/ZiaS1.png\" rel=\"nofollow noreferrer\">Image of System Register</a></p>\n\n<p>Or you change the ComRegisterFunction:</p>\n\n<pre><code>    [ComRegisterFunction()]\n    public static void RegisterFunction(Type _type)\n    {\n        // Check your class type here \n        if (_type != null )\n        {\n            string sCLSID = \"CLSID\\\\\" + _type.GUID.ToString(\"B\");\n            try\n            {\n                RegistryKey _key = Registry.ClassesRoot.OpenSubKey(sCLSID, true);\n                try\n                {\n                    Guid _libID = Marshal.GetTypeLibGuidForAssembly(_type.Assembly);\n                    int _major, _minor;\n                    Marshal.GetTypeLibVersionForAssembly(_type.Assembly, out _major, out _minor);\n                    using (RegistryKey _sub = _key.CreateSubKey(\"Control\")) { }\n                    using (RegistryKey _sub = _key.CreateSubKey(\"MiscStatus\")) { _sub.SetValue(\"\", \"0\", RegistryValueKind.String); }\n                    using (RegistryKey _sub = _key.CreateSubKey(\"TypeLib\")) { _sub.SetValue(\"\", _libID.ToString(\"B\"), RegistryValueKind.String); }\n                    using (RegistryKey _sub = _key.CreateSubKey(\"Version\")) { _sub.SetValue(\"\", String.Format(\"{0}.{1}\", _major, _minor), RegistryValueKind.String); }\n                    using (RegistryKey _sub = _key.CreateSubKey(\"Control\")) { }\n\n                    using (RegistryKey _sub = _key.CreateSubKey(\"InprocServer32\")) { _sub.SetValue(\"\", Environment.SystemDirectory + \"\\\\\" + _sub.GetValue(\"\", \"mscoree.dll\"), RegistryValueKind.String); }\n                }\n                finally\n                {\n                    _key.Close();\n                }\n            }\n            catch\n            {\n            }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4873693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjjA1.jpg?s=128&g=1", "display_name": "Lech Wilk", "link": "https://stackoverflow.com/users/4873693/lech-wilk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537560480, "creation_date": 1431533082, "question_id": 30220038, "link": "https://stackoverflow.com/questions/30220038/activex-in-net-mscoree-dll", "title": "ActiveX in .NET, mscoree.dll", "body": "<p>I made some activeX in c# VS2013 for reporting. I register (doring building, and also by regasm), I made a msi installer, and basically my plugin is working. I use it on VBA. I can make a refference to it and use a control wrapper, but problem is, than I can use it only when i place it on the display (or winForm). Later, when I save, close, open again, then i get the message:</p>\n\n<blockquote>\n  <p>Unable to load ActiveXcontrol for display . cause: ClassLibrary1.UserControl1: CAB file missing on server: <a href=\"http://localhost/RSViewActiveXControlSetup/mscoreedll.CAB\" rel=\"nofollow\">http://localhost/RSViewActiveXControlSetup/mscoreedll.CAB</a>.</p>\n</blockquote>\n\n<p>(RSView is a programming environment with possibility to use VBA code for displays)</p>\n\n<p>Then I have to delete and place again. No possible to use on runtime -only test.</p>\n\n<p>Registration part in my code:</p>\n\n<pre><code>[ComRegisterFunction]\n    static void ComRegister(Type t)\n    {\n        string keyName = @\"CLSID\\\" + t.GUID.ToString(\"B\");\n        using (RegistryKey key =\n        Registry.ClassesRoot.OpenSubKey(keyName, true))\n        {\n            key.CreateSubKey(\"Control\").Close();\n            using (RegistryKey subkey = key.CreateSubKey(\"MiscStatus\"))\n            {\n                subkey.SetValue(\"\", \"131457\");\n            }\n            using (RegistryKey subkey = key.CreateSubKey(\"TypeLib\"))\n            {\n                Guid libid =\n                Marshal.GetTypeLibGuidForAssembly(t.Assembly);\n                subkey.SetValue(\"\", libid.ToString(\"B\"));\n            }\n            using (RegistryKey subkey = key.CreateSubKey(\"Version\"))\n            {\n                Version ver = t.Assembly.GetName().Version;\n                string version =\n                string.Format(\"{0}.{1}\",\n                ver.Major,\n                ver.Minor);\n                if (version == \"0.0\") version = \"1.0\";\n                subkey.SetValue(\"\", version);\n            }\n        }\n    }\n</code></pre>\n\n<p>Registers are updated, i think correct. I've red there is some problem with mscoree.dll, but i havent found how to solve. I will be very thinkfull for any help, I am little bit nooby.\n.NET 4.5.51209</p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1431534161, "post_id": 30219994, "comment_id": 48544563, "body": "What column is your date column"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1431534524, "post_id": 30219994, "comment_id": 48544818, "body": "If your Date column is Column A then this will filter for dates &gt;= to Jan 1, 2000 <code>Columns(&quot;A:A&quot;).AutoFilter Field:=1, Criteria1:=&quot;&gt;=1&#47;01&#47;2000&quot;</code>"}, {"owner": {"reputation": 145, "user_id": 4615374, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/253b3775c756d1997c8ecfe4f58927d4?s=128&d=identicon&r=PG&f=1", "display_name": "sasuke", "link": "https://stackoverflow.com/users/4615374/sasuke"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1431535016, "post_id": 30219994, "comment_id": 48545122, "body": "@Davesexcel : First of all thank you for your prompt answer. Actually, I would like to find a way of how to use Month() and Year() functions within an AutoFilter command. It looks to be easy in the case above, but what if I wanted to filter using Year(ColumnA)=2000 and Month(ColumnA)=K (K is my months counter which I do loop from 1 up to 12) ?"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 4615374, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/253b3775c756d1997c8ecfe4f58927d4?s=128&d=identicon&r=PG&f=1", "display_name": "sasuke", "link": "https://stackoverflow.com/users/4615374/sasuke"}, "edited": false, "score": 0, "creation_date": 1431536526, "post_id": 30220943, "comment_id": 48546026, "body": "Thank you for your detailed answer. Nevertheless, I would like to find a way of how to use Month() and Year() functions wihtin the criteria of my AutoFilter command if there&#39;s any possibility to do so."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1431536028, "creation_date": 1431536028, "answer_id": 30220943, "question_id": 30219994, "link": "https://stackoverflow.com/questions/30219994/filter-rows-based-on-their-yearcriteriondate-in-vb/30220943#30220943", "title": "Filter rows based on their Year(CriterionDate) in VB", "body": "<p>Say <em>Sheet1</em> has data like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/pDJ19.png\" alt=\"enter image description here\"></p>\n\n<p>This macro:</p>\n\n<pre><code>Sub Macro4()\n    With Sheets(\"Sheet1\")\n        .Range(\"$C$1:$C$22\").AutoFilter Field:=1, Criteria1:= _\n            \"&gt;12/31/1999\", Operator:=xlAnd\n        .Rows(\"1:23\").Copy\n    End With\n\n    Sheets(\"Sheet2\").Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>will produce this in <em>Sheet2:</em></p>\n\n<p><img src=\"https://i.stack.imgur.com/gW8x5.png\" alt=\"enter image description here\"></p>\n\n<p><strong>NOTE:</strong></p>\n\n<p>Adjust the macro for your column of interest and the number of rows in your table.</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 4615374, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/253b3775c756d1997c8ecfe4f58927d4?s=128&d=identicon&r=PG&f=1", "display_name": "sasuke", "link": "https://stackoverflow.com/users/4615374/sasuke"}, "edited": false, "score": 0, "creation_date": 1431612590, "post_id": 30226793, "comment_id": 48580402, "body": "Many thanks, this is truly helpful. I would love to vote your answer up but I don&#39;t have yet reached 15 reputations :)"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 145, "user_id": 4615374, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/253b3775c756d1997c8ecfe4f58927d4?s=128&d=identicon&r=PG&f=1", "display_name": "sasuke", "link": "https://stackoverflow.com/users/4615374/sasuke"}, "edited": false, "score": 0, "creation_date": 1431614694, "post_id": 30226793, "comment_id": 48581971, "body": "You find it helpful, that&#39;s good enough. You are most welcome."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1431559380, "creation_date": 1431559380, "answer_id": 30226793, "question_id": 30219994, "link": "https://stackoverflow.com/questions/30219994/filter-rows-based-on-their-yearcriteriondate-in-vb/30226793#30226793", "title": "Filter rows based on their Year(CriterionDate) in VB", "body": "<p>I know that you would like to use Month() and Year() functions within the criteria to filter the data, however I would like to propose the following solution to filter the data although the Month() and Year functions are only used to call the procedure.</p>\n\n<p>This procedure requires the range to be filtered, the month and year.\nMont and Year are optional as it allows to filter the dates for:</p>\n\n<p>1.- An entire year (all months)</p>\n\n<p>2.- A Year\\Month</p>\n\n<p>3.- A Month (all years)</p>\n\n<p>Please note that the dates in the range should have the same format and that format should be used to generate the value for the variable \u201csCriteria2\u201d (see below details)</p>\n\n<p>I have not included copying the range anywhere it is already done.\nThe procedure can be called this way:</p>\n\n<pre><code>Call Rng_RangeFilterbyYearMonth(RngSrc, Year(dDate), Month(dDate))\n</code></pre>\n\n<p>Hope you find this useful   </p>\n\n<pre><code>Sub Rng_RangeFilterbyYearMonth(ByVal RngSrc As Range, Optional iYear As Integer, Optional iMonth As Byte)\nDim btyFltrType As Byte\nDim sCriteria2 As String\n\n    Rem Validate Year &amp; Month\n    If iYear + iMonth = 0 Then Exit Sub\n\n    Rem Filter Range\n    With ActiveSheet.Range(\"$B$6:$C$138\")\n        On Error Resume Next\n        ActiveSheet.ShowAllData\n        On Error GoTo 0\n\n        If iYear &lt;&gt; 0 And iMonth = 0 Then\n            Rem Filter by Year (all months)\n            Rem .AutoFilter Field:=1, Operator:=xlFilterValues, Criteria2:=Array(0, \"9/29/2009\", 0, \"1/15/2004\")\n            btyFltrType = 0\n            sCriteria2 = \"1/1/\" &amp; iYear\n            .AutoFilter Field:=1, Operator:=xlFilterValues, Criteria2:=Array(btyFltrType, sCriteria2)\n\n        ElseIf iYear &lt;&gt; 0 And iMonth &lt;&gt; 0 Then\n            Rem Filter by Year/Month\n            Rem Variable sCriteria2 must be generated using the date format of the data in the range\n            Rem The dates in the range should have the same format\n            Rem For [mm/dd/yyy] use sCriteria2 = iMonth &amp; \"/1/\" &amp; iYear\n            Rem For [dd/mm/yyy] use sCriteria2 = \"1/\" &amp; iMonth &amp; \"/\" &amp; iYear\n            btyFltrType = 1\n            sCriteria2 = \"1/\" &amp; iMonth &amp; \"/\" &amp; iYear\n            .AutoFilter Field:=1, Operator:=xlFilterValues, Criteria2:=Array(btyFltrType = 1, sCriteria2)\n\n        Else\n            Rem Filter by Month (All Years)\n            btyFltrType = 20 + iMonth\n            .AutoFilter Field:=1, Criteria1:=btyFltrType, Operator:=xlFilterDynamic\n\n    End If: End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4615374, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/253b3775c756d1997c8ecfe4f58927d4?s=128&d=identicon&r=PG&f=1", "display_name": "sasuke", "link": "https://stackoverflow.com/users/4615374/sasuke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 30226793, "answer_count": 2, "score": 0, "last_activity_date": 1431559380, "creation_date": 1431532949, "last_edit_date": 1431544816, "question_id": 30219994, "link": "https://stackoverflow.com/questions/30219994/filter-rows-based-on-their-yearcriteriondate-in-vb", "title": "Filter rows based on their Year(CriterionDate) in VB", "body": "<p>Let's suppose we have an Excel Sheet called \"Sheet1\" from which I would like to filter/copy/Paste rows to another \"Sheet2\" within the same workBook. Sheet1 has a column of Date type which name is \"DateColumn\". How can I use the AutoFilter command to filter only rows having their Year(DateColumn) >= 2000 and then Copy/Paste the filtered rows to the destination sheet \"Sheet2\". Many thanks in advance.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 2997400, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000299634672/picture?type=large", "display_name": "Carlos E. Guillen", "link": "https://stackoverflow.com/users/2997400/carlos-e-guillen"}, "edited": false, "score": 0, "creation_date": 1431628328, "post_id": 30221146, "comment_id": 48590399, "body": "Thanks buddy, thats correct thank you for the hint on the <code>AND</code> I get it working with <code>IF</code> like this it was a matter of having checked the STOP IF TRUE condition for the formatting rule.  This is the if i use <code>=IF(READY_TO_PRINT=&quot;NO&quot;,CELL(&quot;protect&quot;,A1)=0)</code>"}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1431536677, "creation_date": 1431536677, "answer_id": 30221146, "question_id": 30219126, "link": "https://stackoverflow.com/questions/30219126/formula-for-conditional-formmating-with-switch-for-print/30221146#30221146", "title": "formula for conditional formmating with switch for print", "body": "<p>If you want to apply the formatting with both conditions, you just need an <code>AND</code> around them.  Conditional formatting expects to get a <code>TRUE/FALSE</code> answer to apply the formatting.  <code>AND</code> does this properly while <code>IF</code> will not as you've written it.</p>\n\n<pre><code>=AND(READY_TO_PRINT=\"NO\",CELL(\"protect\",A1)=0)\n</code></pre>\n\n<p>I switched your <code>READY_TO_PRINT</code> to <code>\"NO\"</code> since it seems you want to apply the formatting when it is not ready to print (as I understand it).  If not, hopefully you can modify this formula as needed to get your solution.</p>\n"}], "owner": {"reputation": 35, "user_id": 2997400, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000299634672/picture?type=large", "display_name": "Carlos E. Guillen", "link": "https://stackoverflow.com/users/2997400/carlos-e-guillen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 30221146, "answer_count": 1, "score": 0, "last_activity_date": 1431536677, "creation_date": 1431530514, "last_edit_date": 1531161705, "question_id": 30219126, "link": "https://stackoverflow.com/questions/30219126/formula-for-conditional-formmating-with-switch-for-print", "title": "formula for conditional formmating with switch for print", "body": "<p>Please give a hand with this im trying to have a conditional formatting to apply to input cells in a spreadsheet but at the same time i want a switch to\nturn it off for printing purposes.</p>\n\n<p>Formula:</p>\n\n<pre><code>=IF(READY_TO_PRINT=\"YES\",CELL(\"protect\",A1)=0)\n</code></pre>\n\n<p>The ready to print is a name range to serve as a switch to turn the specify style i want to turn off before print.</p>\n\n<p>I would appreciate any solution including vba scenarios.\nThanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4896416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e8884405c17ca65b46be18b2053f32?s=128&d=identicon&r=PG&f=1", "display_name": "RosePetal17", "link": "https://stackoverflow.com/users/4896416/rosepetal17"}, "edited": false, "score": 0, "creation_date": 1431530956, "post_id": 30219124, "comment_id": 48542384, "body": "but I have removed it and get a debug error on the line above now"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 13, "user_id": 4896416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e8884405c17ca65b46be18b2053f32?s=128&d=identicon&r=PG&f=1", "display_name": "RosePetal17", "link": "https://stackoverflow.com/users/4896416/rosepetal17"}, "edited": false, "score": 0, "creation_date": 1431531378, "post_id": 30219124, "comment_id": 48542679, "body": "@RosePetal17 Date isn&#39;t an object, so just get rid of the <code>Set</code> too! ;)"}, {"owner": {"reputation": 13, "user_id": 4896416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e8884405c17ca65b46be18b2053f32?s=128&d=identicon&r=PG&f=1", "display_name": "RosePetal17", "link": "https://stackoverflow.com/users/4896416/rosepetal17"}, "edited": false, "score": 0, "creation_date": 1431531531, "post_id": 30219124, "comment_id": 48542775, "body": "thank you, but any ideas why now its bringing up the &#39;object required&#39; error again on the LastRow = Sheets line? Sorry I have been trying to get this to work for ages :/"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "reply_to_user": {"reputation": 13, "user_id": 4896416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e8884405c17ca65b46be18b2053f32?s=128&d=identicon&r=PG&f=1", "display_name": "RosePetal17", "link": "https://stackoverflow.com/users/4896416/rosepetal17"}, "edited": false, "score": 0, "creation_date": 1431531632, "post_id": 30219124, "comment_id": 48542846, "body": "@RosePetal17 You got rid of the <code>Set</code> before <code>CutOffDate</code> and you got rid of the <code>Set</code> before <code>LastRow</code> and it still gives you the error?"}, {"owner": {"reputation": 13, "user_id": 4896416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e8884405c17ca65b46be18b2053f32?s=128&d=identicon&r=PG&f=1", "display_name": "RosePetal17", "link": "https://stackoverflow.com/users/4896416/rosepetal17"}, "edited": false, "score": 0, "creation_date": 1431531724, "post_id": 30219124, "comment_id": 48542918, "body": "yeh the code is now;      Sub Button_Delete_Rows()    Dim CuttoffDate As Date  Dim LastRow As Long  Dim rng As Range    CutoffDate = Sheets(&quot;PL Refresh&quot;).Range(&quot;K3&quot;).Value    LastRow = Sheets(&quot;Data&quot;).Range(&quot;F&quot; &amp; ws.Rows.Count).End(xlUp).Row   Set rng = Sheets(&quot;Data&quot;).Range(&quot;F&quot;)  With rng         .AutoFilter Field:=1, Criteria1:=&quot;&gt;&quot; &amp; &quot;CutoffDate&quot;         .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete     End With          rng.AutoFilterMode = False       End Sub"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 1, "creation_date": 1431531911, "post_id": 30219124, "comment_id": 48543065, "body": "Ah, no wonder it fails. You have an object <code>ws</code> in the definition that does not exist. I alter my answer accordingly."}, {"owner": {"reputation": 13, "user_id": 4896416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e8884405c17ca65b46be18b2053f32?s=128&d=identicon&r=PG&f=1", "display_name": "RosePetal17", "link": "https://stackoverflow.com/users/4896416/rosepetal17"}, "edited": false, "score": 0, "creation_date": 1431532198, "post_id": 30219124, "comment_id": 48543266, "body": "thank you @EngJon I didn&#39;t spot this error! but in your amendment it doesn&#39;t specify the &quot;data&quot; sheet or range &quot;F&quot;.   would I put LastRow = Sheets(&quot;Data&quot;).Range(&quot;F&quot;).SpecialCells(xlCellTypeLastCell).R&zwnj;&#8203;ow??"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1431532405, "post_id": 30219124, "comment_id": 48543421, "body": "Not exactly. I just inserted my default solution for last rows. I will edit my answer once again to provide the last row on that sheet in column F."}, {"owner": {"reputation": 13, "user_id": 4896416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e8884405c17ca65b46be18b2053f32?s=128&d=identicon&r=PG&f=1", "display_name": "RosePetal17", "link": "https://stackoverflow.com/users/4896416/rosepetal17"}, "edited": false, "score": 0, "creation_date": 1431532585, "post_id": 30219124, "comment_id": 48543546, "body": "Brilliant thank you so much for your help @EngJon :)"}, {"owner": {"reputation": 13, "user_id": 4896416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e8884405c17ca65b46be18b2053f32?s=128&d=identicon&r=PG&f=1", "display_name": "RosePetal17", "link": "https://stackoverflow.com/users/4896416/rosepetal17"}, "edited": false, "score": 0, "creation_date": 1431536621, "post_id": 30219124, "comment_id": 48546083, "body": "@EngJon I am sorry to be a pain here and what you amended before works great however... now the line below it now run-time errors 1004 Set rng = Sheets(&quot;Data&quot;).Range(&quot;F&quot;)  I have tried with and without the &#39;set&#39;. any ideas?"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1431543966, "post_id": 30219124, "comment_id": 48550358, "body": "What is rng supposed to cover? If it should be the whole column F then in that row change <code>Range(&quot;F&quot;)</code> to <code>Range(&quot;F:F&quot;)</code>"}], "tags": [], "owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "is_accepted": true, "score": 1, "last_activity_date": 1431532439, "last_edit_date": 1431532439, "creation_date": 1431530512, "answer_id": 30219124, "question_id": 30219067, "link": "https://stackoverflow.com/questions/30219067/filtering-and-deleting-data-using-a-modifiable-date/30219124#30219124", "title": "Filtering and deleting data using a modifiable date", "body": "<p>You don't need the keyword <code>Set</code> on a simple type, it is only used for Objects (Workbook, Worksheet, Range, ...).</p>\n\n<p><code>CutoffDate = Sheets(\"PL Refresh\").Range(\"K3\").Value</code>\nand</p>\n\n<p><code>LastRow = Sheets(\"Data\").Cells(Sheets(\"Data\").Rows.Count, \"F\").End(xlUp).Row</code></p>\n\n<p>are sufficient.</p>\n\n<p>EDIT: I edited lastrow, because <code>ws</code> is an object undefined. Maybe something that stayed in your code although you don't have that object anymore.</p>\n"}], "owner": {"reputation": 13, "user_id": 4896416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e8884405c17ca65b46be18b2053f32?s=128&d=identicon&r=PG&f=1", "display_name": "RosePetal17", "link": "https://stackoverflow.com/users/4896416/rosepetal17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 30219124, "answer_count": 1, "score": 1, "last_activity_date": 1431532439, "creation_date": 1431530358, "last_edit_date": 1531164843, "question_id": 30219067, "link": "https://stackoverflow.com/questions/30219067/filtering-and-deleting-data-using-a-modifiable-date", "title": "Filtering and deleting data using a modifiable date", "body": "<p>I want to filter by a date specified in a cell (that a user can change) then delete the entire rows and unfilter. I get an <em>object required error</em> on the <strong><code>Set = LastRow</code></strong> section.</p>\n\n<pre><code> Sub Button_Delete_Rows()\n\n Dim CuttoffDate As Date\n Dim LastRow As Long\n Dim rng As Range\n\n Set CutoffDate = Sheets(\"PL Refresh\").Range(\"K3\").Value\n\n Set LastRow = Sheets(\"Data\").Range(\"F\" &amp; ws.Rows.Count).End(xlUp).Row\n\n Set rng = Sheets(\"Data\").Range(\"F\")\n With rng\n     .AutoFilter Field:=1, Criteria1:=\"&gt;\" &amp; \"CutoffDate\"\n     .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n End With\n\n rng.AutoFilterMode = False\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1431530748, "post_id": 30219176, "comment_id": 48542225, "body": "I second this. When you are in cell <code>D1</code> and hit <code>end-down</code>, where do you end up?"}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1431530935, "post_id": 30219176, "comment_id": 48542368, "body": "Matt, I go to R:10161."}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1431530965, "post_id": 30219176, "comment_id": 48542392, "body": "Rory, when I run the code with your change, I get a debug at this line: et rng = Worksheets(&quot;Master Sheet&quot;).Range(startingCell, startingCell.Offset(lastRow, 5))"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1431531080, "post_id": 30219176, "comment_id": 48542483, "body": "It appears as though perhaps you have a two dimensional array and you aren&#39;t looping through both dimensions. Maybe have a look <a href=\"http://www.techrepublic.com/forums/questions/vba-in-excel-help-looping-through-a-two-dimensional-array/\" rel=\"nofollow noreferrer\">here</a> for a start."}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1431531160, "post_id": 30219176, "comment_id": 48542528, "body": "The error is &quot;application-defined or object-defined error&quot; Any ideas?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431531199, "post_id": 30219176, "comment_id": 48542556, "body": "I&#39;ve just revised my answer to include the full code - can you test and see if you still get the error?"}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1431531457, "post_id": 30219176, "comment_id": 48542726, "body": "Sorry, Rory, I typed it wrong. Now, however, I&#39;m getting it to loop 4 times rather than 2. Any more ideas?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431532510, "post_id": 30219176, "comment_id": 48543500, "body": "What is the last populated cell in column D?"}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1431533228, "post_id": 30219176, "comment_id": 48543964, "body": "The last populated cell is Col D is 873."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1431533418, "post_id": 30219176, "comment_id": 48544077, "body": "My guess is that you are looping through only the first row of five columns and you need a second loop to get all of the rows. Something like that."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431533424, "post_id": 30219176, "comment_id": 48544080, "body": "What is the value of lastRow?"}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1431533665, "post_id": 30219176, "comment_id": 48544238, "body": "The value of D:873 is &quot;ETM - Manufacturing Request Report&quot; and the value of I:873 is &quot;None&quot; for due date. The last actual date is I:861 if that helps."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431533913, "post_id": 30219176, "comment_id": 48544406, "body": "I mean what is the value of the lastRow variable when you run the code?"}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1431534188, "post_id": 30219176, "comment_id": 48544578, "body": "Sorry; I wondered why you asked that. I&#39;m not a programmer at all. Well now it won&#39;t let me get past the first iteration. I&#39;m now getting a Run-time error &#39;9&#39; - Subscript out of range."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1431531158, "last_edit_date": 1431531158, "creation_date": 1431530669, "answer_id": 30219176, "question_id": 30219057, "link": "https://stackoverflow.com/questions/30219057/why-does-loop-stop-after-two-times-when-there-are-873-rows/30219176#30219176", "title": "Why does loop stop after two times when there are 873 rows?", "body": "<p>I suspect you will find that your lastRow variable is not what you think it should be. Change the calculation to:</p>\n\n<pre><code>Set wksht = wkbk.Worksheets(\"Master Sheet\")\nlastRow = wksht.Cells(wksht.rows.count, \"D\").End(xlUp).Row\nSet startingCell = wksht.Range(\"D4\")\nSet rng = wksht.Range(startingCell, wksht.Cells(lastRow, 5))\narrData = Application.Transpose(rng.Value)\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 30219176, "answer_count": 1, "score": 0, "last_activity_date": 1431531158, "creation_date": 1431530330, "last_edit_date": 1531164843, "question_id": 30219057, "link": "https://stackoverflow.com/questions/30219057/why-does-loop-stop-after-two-times-when-there-are-873-rows", "title": "Why does loop stop after two times when there are 873 rows?", "body": "<p>Does anyone know why the following code only loops twice and stops, rather than running through all 873 rows. Note, Col D is the task Subject column and Col I is the task due date column:</p>\n\n<p>'This project code creates tasks based on the Excel table in \"Master Sheet\" tab.</p>\n\n<pre><code>    Sub CreateTasks()\n\n    Dim cell As Excel.Range\n    Dim rng As Excel.Range\n    Dim wholeColumn As Excel.Range\n    Dim startingCell As Excel.Range\n    Dim oApp As Outlook.Application\n    Dim tsk As Outlook.TaskItem\n    Dim wkbk As Excel.Workbook\n    Dim wksht As Excel.Worksheet\n    Dim lastRow As Long\n    Dim arrData As Variant\n    Dim i As Long\n\n' Start Outlook\n    Set oApp = GetOutlookApp\n    If oApp Is Nothing Then\n      MsgBox \"Could not start Outlook.\", vbInformation\n      Exit Sub\n    End If\n\n' Read worksheet range into an array in one go\n    Set wkbk = ActiveWorkbook\n    Set wksht = wkbk.Worksheets(\"Master Sheet\")\n    Set wholeColumn = Worksheets(\"Master Sheet\").Range(\"D:D\")\n    lastRow = wholeColumn.End(xlDown).Row - 2\n    Set startingCell = Worksheets(\"Master Sheet\").Range(\"D4\")\n    Set rng = Worksheets(\"Master Sheet\").Range(startingCell, startingCell.Offset(lastRow, 5))\n    arrData = Application.Transpose(rng.Value)\n\n' loop through array and create tasks for each record\n    For i = LBound(arrData, 2) To UBound(arrData, 2)\n      Set tsk = oApp.CreateItem(olTaskItem)\n      With tsk\n        .Subject = arrData(1, i)\n        .DueDate = arrData(6, i)\n        .Save\n      End With\n    Next i\n\n    End Sub\n\n    Function GetOutlookApp() As Outlook.Application\n' return Outlook.Application object\n    On Error Resume Next\n    Set GetOutlookApp = CreateObject(\"Outlook.Application\")\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "formatting", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 0, "creation_date": 1431530291, "post_id": 30218992, "comment_id": 48541891, "body": "I have tried adding .PasetSpecial but couldn&#39;t figure out how to make it work."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1431530536, "post_id": 30218992, "comment_id": 48542062, "body": "Well if you manually did this, which paste special option works correctly for you?  Perhaps &quot;All except borders&quot;?  Or do you just want &quot;All&quot;?"}, {"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1431531269, "post_id": 30218992, "comment_id": 48542601, "body": "I don&#39;t really know anything about paste special. I tried looking up how to do this and the only thing that resembled any of my code that I could try and copy was simply .PasteSpecial. I&#39;m completely new to VBA but was able to arrive at the above code after much trial and error. I wouldn&#39;t know how to answer your question, sorry.."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1431533485, "post_id": 30218992, "comment_id": 48544121, "body": "So try replacing <code>Sheets(&quot;Terry&quot;).Paste</code> with <code>Sheets(&quot;Terry&quot;).Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteAll</code>"}, {"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1431534530, "post_id": 30218992, "comment_id": 48544823, "body": "Just gave that a shot and it didn&#39;t yield any different result. Still copied all cells but with no formatting, fill, or text color.."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1431535040, "post_id": 30218992, "comment_id": 48545140, "body": "Oh I see, it is because you are closing it before you finish pasting the data over.. I can put together an answer I think"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 0, "creation_date": 1431541730, "post_id": 30220931, "comment_id": 48549028, "body": "I&#39;m trying this, and when I read down it, it does make more sense than what I had before but I&#39;m still having trouble. When I run it, it opens my other document then says &quot;Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method&quot; it stops after that."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 0, "creation_date": 1431541967, "post_id": 30220931, "comment_id": 48549173, "body": "@KyleHinkebein Do you know which line is causing that?"}, {"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 0, "creation_date": 1431544212, "post_id": 30220931, "comment_id": 48550518, "body": "That&#39;s literally all the message says. It doesn&#39;t give a line, it doesn&#39;t give the option to debug and highlight in yellow, it just gives that message.. I tried slowly replacing the pieces of mine with yours and everything up to step 3 still worked."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 0, "creation_date": 1431544552, "post_id": 30220931, "comment_id": 48550714, "body": "@KyleHinkebein What version of excel do you have?"}, {"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 0, "creation_date": 1431545340, "post_id": 30220931, "comment_id": 48551149, "body": "It&#39;s 2013, I actually may of just gotten it to work blending the two of our codes together. Need to run it a few more times to make sure."}, {"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 0, "creation_date": 1431546934, "post_id": 30220931, "comment_id": 48552006, "body": "Never mind, it must of been a fluke. It opened up, copied everything perfectly, pasted it in the new sheet and shut down. It won&#39;t do it again though. I used the first part of yours up to step 3 then just took out the string that closes the active window on mine.."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 0, "creation_date": 1431547296, "post_id": 30220931, "comment_id": 48552224, "body": "@KyleHinkebein that is really bizarre... I can&#39;t think of why that would be happening.  It works each time I run it :("}, {"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 0, "creation_date": 1431607560, "post_id": 30220931, "comment_id": 48577056, "body": "I&#39;ll have to keep playing around with it until I can figure out which part is messing up. Thank you very much for your help, I&#39;m sure it&#39;s right there, just needs some tweaking.."}, {"owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "edited": false, "score": 1, "creation_date": 1431614200, "post_id": 30220931, "comment_id": 48581617, "body": "Got it working. Just had to read through it and follow each process. Changed one or two things and it works great now. Thanks again @Chancea."}], "tags": [], "owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "is_accepted": true, "score": 1, "last_activity_date": 1431535960, "creation_date": 1431535960, "answer_id": 30220931, "question_id": 30218992, "link": "https://stackoverflow.com/questions/30218992/trying-to-copy-formatting-in-all-cells-from-one-excell-sheet-into-another-specif/30220931#30220931", "title": "Trying to copy Formatting in all cells from one Excell sheet into another specifically keeping fill and text color using VBA", "body": "<p>The direct problem lies within the order of execution.  Currently you are:</p>\n\n<ol>\n<li>Opening the workbook with the macro</li>\n<li>Opening the workbook with the data</li>\n<li>Copying the data</li>\n<li>Closing the workbook with the data</li>\n<li>Pasting the data into the workbook with the macro</li>\n<li>Saving the workbook with the macro (and now also with data)</li>\n</ol>\n\n<p>The issue with this is that if you perform step 4 before step 5 the formatting is lost and only the text remains on the clipboard.  So that means we have to switch steps 4 and 5 in the execution process.</p>\n\n<p>In addition we should get rid of those <code>select</code> statements and work with the ranges directly.  This is best practice and easier to understand in the code.</p>\n\n<p>Here is the code with the steps marked in the order we want them to execute:</p>\n\n<pre><code>Private Sub Workbook_Open() 'step 1\nDim wb As Workbook\nDim wb2 As Workbook\nSet wb = ActiveWorkbook\n\nApplication.DisplayAlerts = False\nCells.ClearContents\nCells.UnMerge\nCells.ClearContents\n\n'step 2\nWorkbooks.Open Filename:= _\n    \"Photo\\Studio\\\\DAILY_REPORT_BACKUPS\\DIGI_Review_Terry.xlsm\"\nSet wb2 = ActiveWorkbook\n\n'step 3\nwb2.ActiveSheet.Range(\"A1:XFD70\").Copy\n\n'step 5 (switch with 4)\nwb.Sheets(\"Terry\").Range(\"A1\").PasteSpecial Paste:=xlPasteAll\n\n'step 4 (switch with 5)\nwb2.Close\n\n'step 6\nwb.Save\nEnd Sub\n</code></pre>\n\n<p>Here is the same code without the crazy step comments:</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim wb As Workbook\nDim wb2 As Workbook\nSet wb = ActiveWorkbook\n\nApplication.DisplayAlerts = False\nCells.ClearContents\nCells.UnMerge\nCells.ClearContents\n\nWorkbooks.Open Filename:= _\n    \"Photo\\Studio\\\\DAILY_REPORT_BACKUPS\\DIGI_Review_Terry.xlsm\"\nSet wb2 = ActiveWorkbook\n\nwb2.ActiveSheet.Range(\"A1:XFD70\").Copy\nwb.Sheets(\"Terry\").Range(\"A1\").PasteSpecial Paste:=xlPasteAll\nwb2.Close\nwb.Save\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 3938885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5048980de463d1648a35840611b9f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Hinkebein", "link": "https://stackoverflow.com/users/3938885/kyle-hinkebein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 2, "accepted_answer_id": 30220931, "answer_count": 1, "score": 1, "last_activity_date": 1431535960, "creation_date": 1431530196, "last_edit_date": 1531161705, "question_id": 30218992, "link": "https://stackoverflow.com/questions/30218992/trying-to-copy-formatting-in-all-cells-from-one-excell-sheet-into-another-specif", "title": "Trying to copy Formatting in all cells from one Excell sheet into another specifically keeping fill and text color using VBA", "body": "<p>I have a working VBA script that copies exactly what I need except formatting. I at least need it to copy Fill and Text color. </p>\n\n<p>Here is my current code.</p>\n\n<pre><code>Private Sub Workbook_Open()\nApplication.DisplayAlerts = False\nCells.Select\nRange(\"A1\").Activate\nSelection.ClearContents\nSelection.UnMerge\nSelection.ClearContents\nRange(\"A1\").Select\nWorkbooks.Open Filename:= _\n    \"Photo\\Studio\\\\DAILY_REPORT_BACKUPS\\DIGI_Review_Terry.xlsm\"\nRange(\"A1:XFD70\").Select\nRange(\"A1:XFD70\").Activate\nSelection.Copy\nActiveWindow.Close\nRange(\"A1\").Select\nSheets(\"Terry\").Paste\nActiveWorkbook.Save\n\nEnd Sub&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel", "distributed-computing", "memory-mapping"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 3, "creation_date": 1431530547, "post_id": 30218821, "comment_id": 48542074, "body": "Why does this have to be VBA? As much as I love VBA, it seems kind of like using a hammer when what you really need is a screwdriver."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1431531659, "post_id": 30218821, "comment_id": 48542862, "body": "@RubberDuck Might be client requirements (I got the same issue for a much more simple tool) that have someone who is able to maintain in VBA but not in other languages. Project way over my head, but interesting, I&#39;ll look into it, but can&#39;t make any promises! ;)"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1431531704, "post_id": 30218821, "comment_id": 48542897, "body": "@RubberDuck - Not my choice either."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1431531775, "post_id": 30218821, "comment_id": 48542961, "body": "I didn&#39;t say it was. Just saying that it could be relevant to a solution. Perhaps VBA isn&#39;t as big of a requirement as its thought to be. Knowing the reasoning could possibly help."}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1431532200, "post_id": 30218821, "comment_id": 48543269, "body": "@RubberDuck - R3uk is correct. Its a business operations decision. It hasn&#39;t stopped me from accomplishing what they want ...yet."}], "answers": [{"comments": [{"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 0, "creation_date": 1432353559, "post_id": 30249386, "comment_id": 48904769, "body": "Thanks, but what am I missing? I don&#39;t see how you would get data out with your MemoryMap class. Ex. mm.ReadData"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 0, "creation_date": 1432355469, "post_id": 30249386, "comment_id": 48905096, "body": "In addition, how do you write a test string like &quot;testing1&quot; in the original question?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 1, "creation_date": 1432391084, "post_id": 30249386, "comment_id": 48913761, "body": "@mountainclimber - The class implementation isn&#39;t complete.  The byte array within the class basically <i>is</i> the memory mapped file, so any access methods would read and write from <code>buffer</code>.  How you use it is impementation specific, but I editted the code in the answer to read and write strings."}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 0, "creation_date": 1432415406, "post_id": 30249386, "comment_id": 48921218, "body": "I am reading strings of unknown length so the &quot;length&quot; parameter in ReadData doesn&#39;t work well. I&#39;m thinking of prefixing the string that is saved in test.txt with the length of the string then a space then the desired string (so [string len][space][string]), then in ReadData doing string manipulation (Split(), Mid(), InStr(), etc.) to get the string length and desired string so i can avoid the ReadData length parameter. Or is there a better way? My way seems a little clunky. Thanks."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 1, "creation_date": 1432425082, "post_id": 30249386, "comment_id": 48923130, "body": "@mountainclimber - That should work.  That&#39;s essentially what a bstr is, length followed by the string itself.  Another advantage of using the VBA array to access the memory map is that it gives you bounds checking that RtlMoveMemory won&#39;t - to VBA it looks like any other array."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 7, "last_activity_date": 1432391190, "last_edit_date": 1432391190, "creation_date": 1431647827, "answer_id": 30249386, "question_id": 30218821, "link": "https://stackoverflow.com/questions/30218821/how-to-store-data-in-and-get-data-out-of-memory-mapping-files-using-copymemory-i/30249386#30249386", "title": "How to store data in and get data out of memory mapping files using CopyMemory in VBA?", "body": "<p>For your first issue (haven't explored it too much), this is related to how you are trying to pass your <code>buffer</code> to the RtlMoveMemory. It's expecting a pointer, but you're passing it a copy of a <a href=\"https://msdn.microsoft.com/en-us/library/1b2d7d2c-47af-4389-a6b6-b01b7e915228%28VS.85%29\" rel=\"noreferrer\">BSTR</a>. Also remember that a String in VBA is Unicode, so you'll get interwoven null chars.  I usually use either Byte arrays or Variants (they'll get marshalled down to a CSTR).</p>\n\n<p>For your second issue, the file is getting locked because you never release the handle to <code>hFile</code>.  In fact, as soon as you pass it to <code>CreateFileMappingA</code>, you can call <code>CloseHandle</code> on <code>hFile</code>.  </p>\n\n<p>For the third issue, you are over-writing your handle <code>hMMF</code> and the pointer <code>pMemFile</code> when you make the second call.  In theory, they should return the same handle and pointer as you're in the same process, but this doesn't really test whether you got the map view.</p>\n\n<p>As for the memory access, I would probably recommend wrapping the whole thing in a Class and mapping the pointer to something more useful than calls to <code>RtlMoveMemory</code>.  I adapted my code you linked in the question into a Class that should make it a bit safer and more reliable and convenient to use (although it still needs to be fleshed out with error checking):</p>\n\n<pre><code>'Class MemoryMap\nOption Explicit\n\nPrivate Type SafeBound\n    cElements As Long\n    lLbound As Long\nEnd Type\n\nPrivate Type SafeArray\n    cDim As Integer\n    fFeature As Integer\n    cbElements As Long\n    cLocks As Long\n    pvData As Long\n    rgsabound As SafeBound\nEnd Type\n\nPrivate Const VT_BY_REF = &amp;H4000&amp;\nPrivate Const FILE_ATTRIBUTE_NORMAL = &amp;H80\nPrivate Const OPEN_ALWAYS = &amp;H4\nPrivate Const GENERIC_READ = &amp;H80000000\nPrivate Const GENERIC_WRITE = &amp;H40000000\nPrivate Const PAGE_READWRITE = &amp;H4\nPrivate Const FILE_MAP_WRITE = &amp;H2\nPrivate Const FADF_FIXEDSIZE = &amp;H10\n\nPrivate cached As SafeArray\nPrivate buffer() As Byte\nPrivate hFileMap As Long\nPrivate hMM As Long\nPrivate mapped_file As String\nPrivate bound As Long\n\nPublic Property Get FileName() As String\n    FileName = mapped_file\nEnd Property\n\nPublic Property Get length() As Long\n    length = bound\nEnd Property\n\nPublic Sub WriteData(inVal As String, offset As Long)\n    Dim temp() As Byte\n    temp = StrConv(inVal, vbFromUnicode)\n\n    Dim index As Integer\n    For index = 0 To UBound(temp)\n        buffer(index + offset) = temp(index)\n    Next index\nEnd Sub\n\nPublic Function ReadData(offset, length) As String\n    Dim temp() As Byte\n    ReDim temp(length)\n\n    Dim index As Integer\n    For index = 0 To length - 1\n        temp(index) = buffer(index + offset)\n    Next index\n\n    ReadData = StrConv(temp, vbUnicode)\nEnd Function\n\nPublic Function OpenMapView(file_path As String, size As Long, mapName As String) As Boolean\n    bound = size\n    mapped_file = file_path\n\n    Dim hFile As Long\n    hFile = CreateFile(file_path, GENERIC_READ Or GENERIC_WRITE, 0, 0, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, 0)\n    hFileMap = CreateFileMapping(hFile, 0, PAGE_READWRITE, 0, size, mapName)\n    CloseHandle hFile\n    hMM = MapViewOfFile(hFileMap, FILE_MAP_WRITE, 0, 0, 0)\n\n    ReDim buffer(2)\n    'Cache the original SafeArray structure to allow re-mapping for garbage collection.\n    If Not ReadSafeArrayInfo(buffer, cached) Then\n        'Something's wrong, close our handles.\n        CloseOpenHandles\n        Exit Function\n    End If\n\n    Dim temp As SafeArray\n    If ReadSafeArrayInfo(buffer, temp) Then\n        temp.cbElements = 1\n        temp.rgsabound.cElements = size\n        temp.fFeature = temp.fFeature And FADF_FIXEDSIZE\n        temp.pvData = hMM\n        OpenMapView = SwapArrayInfo(buffer, temp)\n    End If    \nEnd Function\n\nPrivate Sub Class_Terminate()\n    'Point the member array back to its own data for garbage collection.\n    If UBound(buffer) = 2 Then\n        SwapArrayInfo buffer, cached\n    End If\n    SwapArrayInfo buffer, cached\n    CloseOpenHandles\nEnd Sub\n\nPrivate Sub CloseOpenHandles()\n    If hMM &gt; 0 Then UnmapViewOfFile hMM\n    If hFileMap &gt; 0 Then CloseHandle hFileMap\nEnd Sub\n\nPrivate Function GetBaseAddress(vb_array As Variant) As Long\n    Dim vtype As Integer\n    'First 2 bytes are the VARENUM.\n    CopyMemory vtype, vb_array, 2\n    Dim lp As Long\n    'Get the data pointer.\n    CopyMemory lp, ByVal VarPtr(vb_array) + 8, 4\n    'Make sure the VARENUM is a pointer.\n    If (vtype And VT_BY_REF) &lt;&gt; 0 Then\n        'Dereference it for the actual data address.\n        CopyMemory lp, ByVal lp, 4\n        GetBaseAddress = lp\n    End If\nEnd Function\n\nPrivate Function ReadSafeArrayInfo(vb_array As Variant, com_array As SafeArray) As Boolean\n    If Not IsArray(vb_array) Then Exit Function\n\n    Dim lp As Long\n    lp = GetBaseAddress(vb_array)\n    If lp &gt; 0 Then\n        With com_array\n            'Copy it over the passed structure\n            CopyMemory .cDim, ByVal lp, 16\n            'Currently doesn't support multi-dimensional arrays.\n            If .cDim = 1 Then\n                CopyMemory .rgsabound, ByVal lp + 16, LenB(.rgsabound)\n                ReadSafeArrayInfo = True\n            End If\n        End With\n    End If\nEnd Function\n\nPrivate Function SwapArrayInfo(vb_array As Variant, com_array As SafeArray) As Boolean\n    If Not IsArray(vb_array) Then Exit Function\n    Dim lp As Long\n    lp = GetBaseAddress(vb_array)\n\n    With com_array\n        'Overwrite the passed array with the SafeArray structure.\n        CopyMemory ByVal lp, .cDim, 16\n        If .cDim = 1 Then\n            CopyMemory ByVal lp + 16, .rgsabound, LenB(.rgsabound)\n            SwapArrayInfo = True\n        End If\n    End With    \nEnd Function\n</code></pre>\n\n<p>Usage is like this:</p>\n\n<pre><code>Private Sub MMTest()\n    Dim mm As MemoryMap\n\n    Set mm = New MemoryMap\n    If mm.OpenMapView(\"C:\\Dev\\test.txt\", 1000, \"TestMM\") Then\n        mm.WriteData \"testing1\", 0\n        Debug.Print mm.ReadData(0, 8)\n    End If\n\n    Set mm = Nothing\nEnd Sub\n</code></pre>\n\n<p>You'll also need the following declarations someplace:</p>\n\n<pre><code>Public Declare Function MapViewOfFile Lib \"kernel32.dll\" ( _\n    ByVal hFileMappingObject As Long, _\n    ByVal dwDesiredAccess As Long, _\n    ByVal dwFileOffsetHigh As Long, _\n    ByVal dwFileOffsetLow As Long, _\n    ByVal dwNumberOfBytesToMap As Long) As Long\n\nPublic Declare Sub CopyMemory Lib \"kernel32\" Alias _\n    \"RtlMoveMemory\" (Destination As Any, Source As Any, _\n    ByVal length As Long)\n\nPublic Declare Function CloseHandle Lib \"kernel32.dll\" ( _\n    ByVal hObject As Long) As Long\n\nPublic Declare Function UnmapViewOfFile Lib \"kernel32.dll\" ( _\n    ByVal lpBaseAddress As Any) As Long\n</code></pre>\n\n<p>One other thing to keep in mind - since you're using a network drive, you'll want to make sure that the caching mechanisms don't interfere with accesses to the file.  Specifically, you'll want to make sure that all of the clients have network file caching turned off.  You might also want to flush the memory map deterministically instead of relying on the OS (see <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366563%28v=vs.85%29.aspx\" rel=\"noreferrer\">FlushViewOfFile</a>).</p>\n"}], "owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5287, "favorite_count": 5, "accepted_answer_id": 30249386, "answer_count": 1, "score": 8, "last_activity_date": 1432391190, "creation_date": 1431529722, "last_edit_date": 1531164843, "question_id": 30218821, "link": "https://stackoverflow.com/questions/30218821/how-to-store-data-in-and-get-data-out-of-memory-mapping-files-using-copymemory-i", "title": "How to store data in and get data out of memory mapping files using CopyMemory in VBA?", "body": "<p>I am trying to build a distributive computing system that uses memory mapping files to coordinate work among several networked PCs all via VBA. Put another way, I want to get a group of networked computers to do work at the same time in a coordinated way on a single project that can be easily divided up into different parts. One PC takes 13+ hours to complete the project, which is not practical for my client.</p>\n\n<p>I want to store information in the memory mapping files that will help the PCs work on the project in a coordinated way (i.e. no duplication of work, avoid race issues, etc). I've tried using other types of files to accomplish this and it causes file race issues or it takes too long. So, as suggested on this forum, I am trying memory mapping files.</p>\n\n<p>I'm brand new to memory mapping files and distributive computing. Has to be done in VBA. As far as I know I have to specify that the file be saved on a directory on our network (drive Z here) that all PCs have access to. I have cobbled together some code from various places:</p>\n\n<pre><code>Option Explicit\n\nPrivate Const PAGE_READWRITE As Long = &amp;H4\nPrivate Const FILE_MAP_WRITE As Long = &amp;H2\nPrivate Const GENERIC_READ = &amp;H80000000\nPrivate Const GENERIC_WRITE = &amp;H40000000\nPrivate Const OPEN_ALWAYS = 4\nPrivate Const FILE_ATTRIBUTE_NORMAL = &amp;H80\n\nPrivate Declare Function CreateFile Lib \"kernel32\" Alias \"CreateFileA\" (ByVal lpFileName As String, _\n                                         ByVal dwDesiredAccess As Long, ByVal dwShareMode As Long, _\n                                         ByVal lpSecurityAttributes As Long, ByVal dwCreationDisposition As Long, _\n                                         ByVal dwFlagsAndAttributes As Long, ByVal hTemplateFile As Long) As Long\n\nPrivate Declare Function CreateFileMapping Lib \"kernel32.dll\" Alias \"CreateFileMappingA\" ( _\n     ByVal hFile As Long, _\n     ByVal lpFileMappigAttributes As Long, _\n     ByVal flProtect As Long, _\n     ByVal dwMaximumSizeHigh As Long, _\n     ByVal dwMaximumSizeLow As Long, _\n     ByVal lpName As String) As Long\n\nPrivate Declare Function MapViewOfFile Lib \"kernel32.dll\" ( _\n     ByVal hFileMappingObject As Long, _\n     ByVal dwDesiredAccess As Long, _\n     ByVal dwFileOffsetHigh As Long, _\n     ByVal dwFileOffsetLow As Long, _\n     ByVal dwNumberOfBytesToMap As Long) As Long\n\n#If VBA7 Then\nPublic Declare PtrSafe Sub CopyMemory Lib \"kernel32\" Alias _\n    \"RtlMoveMemory\" (destination As Any, source As Any, _\n    ByVal length As Long)\n#Else\nPublic Declare Sub CopyMemory Lib \"kernel32\" Alias _\n    \"RtlMoveMemory\" (destination As Any, source As Any, _\n    ByVal length As Long)\n    #End If\n\nPrivate Declare Function UnmapViewOfFile Lib \"kernel32.dll\" ( _\n     ByRef lpBaseAddress As Any) As Long\n\nPrivate Declare Function CloseHandle Lib \"kernel32.dll\" ( _\n     ByVal hObject As Long) As Long\n\nPrivate hMMF As Long\nPrivate pMemFile As Long\n\nSub IntoMemoryFileOutOfMemoryFile()\n\n    Dim sFile As String\n    Dim hFile As Long\n\n    sFile = \"Z:\\path\\test1.txt\"\n\n    hFile = CreateFile(sFile, GENERIC_READ Or GENERIC_WRITE, 0, 0, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, 0)\n    hMMF = CreateFileMapping(hFile, 0, PAGE_READWRITE, 0, 1000000, \"MyMemoryMappedFile\")\n\n    pMemFile = MapViewOfFile(hMMF, FILE_MAP_WRITE, 0, 0, 0)\n\n    Dim buffer As String\n\n    buffer = \"testing1\"\n    CopyMemory pMemFile, ByVal buffer, 128\n\n    hMMF = CreateFileMapping(-1, 0, PAGE_READWRITE, 0, 1000000, \"MyMemoryMappedFile\")\n    pMemFile = MapViewOfFile(hMMF, FILE_MAP_WRITE, 0, 0, 0)\n\n     Dim buffer2 As String\n\n    buffer2 = String$(128, vbNullChar)\n\n     CopyMemory ByVal buffer2, pMemFile, 128\n\n     MsgBox buffer2 &amp; \" &lt; - it worked?\"\n\n     UnmapViewOfFile pMemFile\n     CloseHandle hMMF\nEnd Sub\n</code></pre>\n\n<p>As a little example the code above tries to put the string \"testing1\" in the file test1.txt then retrieve that string and store it in variable buffer2 and finally display that string via a msgbox. Super simple. However, I have no idea what I am doing.</p>\n\n<p>All of our PCs are 64bit, Windows 7, Office/Excel 2013.</p>\n\n<p>Issues/questions:</p>\n\n<ol>\n<li>The msgbox is blank when I run IntoMemoryFileOutOfMemoryFile</li>\n<li>After the sub is complete I open the test1.txt and I get: \"The process cannot access the file because it is being used by another process.\" Which tells me I am not using UnmapViewOfFile and/or CloseHandle correctly. </li>\n<li>I'd like to make these memory files persistent so if all PCs are interrupted I can restart the process and pickup where I left off. </li>\n</ol>\n\n<p>Here are some of the links that I used to get where I am now:</p>\n\n<ul>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/library/dd997372%28v=vs.110%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/dd997372%28v=vs.110%29.aspx</a></p></li>\n<li><p><a href=\"http://www.vbforums.com/showthread.php?404085-VB6-Treat-a-file-like-an-array-without-reading-to-memory\" rel=\"nofollow\">http://www.vbforums.com/showthread.php?404085-VB6-Treat-a-file-like-an-array-without-reading-to-memory</a></p></li>\n<li><p><a href=\"http://vb.mvps.org/hardcore/html/sharedmemorythroughmemory-mappedfiles.htm\" rel=\"nofollow\">http://vb.mvps.org/hardcore/html/sharedmemorythroughmemory-mappedfiles.htm</a></p></li>\n<li><p><a href=\"http://www.tushar-mehta.com/publish_train/xl_vba_cases/1016%20Office%202010%20VBA.shtml\" rel=\"nofollow\">http://www.tushar-mehta.com/publish_train/xl_vba_cases/1016%20Office%202010%20VBA.shtml</a></p></li>\n</ul>\n\n<p>Interesting, but unimportant information: The \"project\" is for a hedge fund client. I am a finance guy gone fundamental quant. We are analyzing 2000+ plus stocks on a daily basis over 1250+ data fields to make macro economic signals/predictions to buy and sell stocks, futures, and options. </p>\n\n<p>UPDATE: If I change the two CopyMemory lines like this (pass pMemFile by value) respectively: </p>\n\n<pre><code>CopyMemory ByVal pMemFile, buffer, 128\n</code></pre>\n\n<p>and...</p>\n\n<pre><code>CopyMemory buffer2, ByVal pMemFile, 128\n</code></pre>\n\n<p>I get a bunch of crazy characters in file test1.txt and excel crashes.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1431529810, "post_id": 30218783, "comment_id": 48541529, "body": "Deleting rows in reverse order will certainly help."}, {"owner": {"reputation": 2383, "user_id": 2705382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6648343abb3b27a12cafef7ee1ede72?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/2705382/andrew"}, "edited": false, "score": 0, "creation_date": 1431535771, "post_id": 30218783, "comment_id": 48545560, "body": "If acceptable, You can also disable screen updating. This will greatly reduce execution time. at the beginning of your <code>clearalldemandzero</code>  sub put in this text <code>Application.ScreenUpdating = False</code> then at the end of the sub put <code>Application.ScreenUpdating=true</code> see if that makes a difference. Basically excel will do all the changes and when it is done it updates the screen. So all the rows look like they were deleted at once."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3297604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c6da9456e3fddd4b653141c837505a4?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfschmitt", "link": "https://stackoverflow.com/users/3297604/wolfschmitt"}, "edited": false, "score": 0, "creation_date": 1431530547, "post_id": 30218983, "comment_id": 48542073, "body": "Thanks! I will try to fix the selection part as well then."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1431530178, "last_edit_date": 1495542661, "creation_date": 1431530178, "answer_id": 30218983, "question_id": 30218783, "link": "https://stackoverflow.com/questions/30218783/delete-zero-and-n-a-rows-from-filter-vba/30218983#30218983", "title": "Delete &#39;zero&#39; and &#39;N/A&#39; rows from filter - VBA", "body": "<p>If your code to Select the filtered data is working, you can simply delete all the rows at that step in one shot.  The key is to use <code>SpecialCells</code> and only select visible cells.  Then you can get the <code>EntireRow</code> and <code>Delete</code> it.</p>\n\n<p>The relevant line of code to add would be this:</p>\n\n<pre><code>Selection.SpecialCells(xlCellTypeVisible).EntireRow.Delete\n</code></pre>\n\n<p>The modification to code 1 in its entirety should be:</p>\n\n<pre><code>Sub clearalldemandzero()\n\n    clearalldemandzero Macro\n\n\n\n    ActiveWindow.SmallScroll Down:=15\n    Range(\"A26:EU26\").Select\n    Selection.AutoFilter\n    ActiveWindow.SmallScroll ToRight:=3\n    ActiveSheet.Range(\"$A$26:$EU$5999\").AutoFilter Field:=9, Criteria1:=\"=0.00\" _\n        , Operator:=xlOr, Criteria2:=\"=#N/A\"\n    Rows(\"27:27\").Select\n    Range(\"D27\").Activate\n    Range(Selection, Selection.End(xlDown)).Select\n\n    Selection.SpecialCells(xlCellTypeVisible).EntireRow.Delete\n\n    ActiveSheet.ShowAllData\n\n\nEnd Sub\n</code></pre>\n\n<p>As a side note, you should generally work to avoid using <code>Select</code> <code>Selection</code> and other things that interface with the Excel UI like that.  I did not try to fix those issues here since it seems that your code is generally working.  Reference to that issue: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n"}], "owner": {"reputation": 33, "user_id": 3297604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c6da9456e3fddd4b653141c837505a4?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfschmitt", "link": "https://stackoverflow.com/users/3297604/wolfschmitt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7796, "favorite_count": 0, "accepted_answer_id": 30218983, "answer_count": 1, "score": 1, "last_activity_date": 1431776030, "creation_date": 1431529593, "last_edit_date": 1431776030, "question_id": 30218783, "link": "https://stackoverflow.com/questions/30218783/delete-zero-and-n-a-rows-from-filter-vba", "title": "Delete &#39;zero&#39; and &#39;N/A&#39; rows from filter - VBA", "body": "<p><strong><em>Required:</em></strong>\nI'm trying to create a macro that filters <strong>cell I22</strong> for all <em>zero</em> values, selects all those rows, deletes them and then unfilters again.</p>\n\n<p><strong><em>What I have:</em></strong>\nCurrently I'm doing this in two different steps, since doing this in one step takes a couple hours (as it deletes row per row)</p>\n\n<p><strong>Code (1)</strong>: Autofilters to 'zero' and 'N/A', selects all of them and clears all the content. Next it clears the filter and sorts from largest to smallest. This way excel doesn't have to delete each row separately making the process faster.</p>\n\n<p><strong>Code (2)</strong>: Deletes all the blank rows.</p>\n\n<p>I have the impression this code is not exactly efficient and too long given the task it needs to do. Is it possible to combine these into one code?</p>\n\n<p><strong><em>Code (1)</em></strong></p>\n\n<pre><code>Sub clearalldemandzero()\n\nclearalldemandzero Macro\n\nActiveWindow.SmallScroll Down:=15\nRange(\"A26:EU26\").Select\nSelection.AutoFilter\nActiveWindow.SmallScroll ToRight:=3\nActiveSheet.Range(\"$A$26:$EU$5999\").AutoFilter Field:=9, Criteria1:=\"=0.00\" _\n    , Operator:=xlOr, Criteria2:=\"=#N/A\"\nRows(\"27:27\").Select\nRange(\"D27\").Activate\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Clear\nActiveSheet.ShowAllData\nRange(\"H28\").Select\nActiveWorkbook.Worksheets(\"Solver 4\").AutoFilter.Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Solver 4\").AutoFilter.Sort.SortFields.Add Key:= _\n    Range(\"I26:I5999\"), SortOn:=xlSortOnValues, Order:=xlDescending, _\n    DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Solver 4\").AutoFilter.Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nEnd Sub\n</code></pre>\n\n<p><strong><em>Code (2)</em></strong></p>\n\n<pre><code>Sub DeleteBlankRows3()\n\n'Deletes the entire row within the selection if the ENTIRE row contains no data.'\n\nDim Rw As Range\n\nIf WorksheetFunction.CountA(Selection) = 0 Then\n\n    MsgBox \"No data found\", vbOKOnly, \"OzGrid.com\"\n    Exit Sub\nEnd If\n\nWith Application\n\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    Selection.SpecialCells(xlCellTypeBlanks).Select\n\n    For Each Rw In Selection.Rows\n\n        If WorksheetFunction.CountA(Selection.EntireRow) = 0 Then\n\n            Selection.EntireRow.Delete\n        End If\n    Next Rw\n\n    .Calculation = xlCalculationAutomatic\n    .ScreenUpdating = True\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1431534066, "creation_date": 1431534066, "answer_id": 30220344, "question_id": 30218587, "link": "https://stackoverflow.com/questions/30218587/parsing-xml-response-in-vba/30220344#30220344", "title": "Parsing XML response in VBA", "body": "<p>You can use <code>MSXML2</code> and <code>XPath</code>:</p>\n\n<pre><code>Dim xmldoc As Object\nDim xmlnode As Object\nSet xmldoc = CreateObject(\"MSXML2.DOMDocument\")\nxmldoc.setProperty \"SelectionLanguage\", \"XPath\"\nxmldoc.loadXML response '//The XML Response string \nFor Each xmlnode In xmldoc.SelectNodes(\"//*[contains(name(),'LogFileName')]\")\n    Debug.Print xmlnode.Text\nNext\n</code></pre>\n\n<p>For early binding reference Mictosoft XML v3.0 or v6.0.</p>\n"}], "owner": {"reputation": 1, "user_id": 4519037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b09ba844aac9889eae1e9c66fb6bbb05?s=128&d=identicon&r=PG&f=1", "display_name": "V. Shende", "link": "https://stackoverflow.com/users/4519037/v-shende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1594, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1431775902, "creation_date": 1431529075, "last_edit_date": 1431775902, "question_id": 30218587, "link": "https://stackoverflow.com/questions/30218587/parsing-xml-response-in-vba", "title": "Parsing XML response in VBA", "body": "<p>I am calling a webservice from Excel macro but not able to parse the response XML. The Structure of the Response is as follows - </p>\n\n<pre><code>&lt;env:Envelope xmlns:env=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:typ=\"http://xmlns.oracle.com/oracle/apps/marketing/commonMarketing/mktImport/model/types/\"&gt;\n   &lt;env:Header&gt;\n      &lt;wsa:Action&gt;http://xmlns.oracle.com/oracle/apps/marketing/commonMarketing/mktImport/model//ImportPublicService/getImportActivityLogsResponse&lt;/wsa:Action&gt;\n      &lt;wsa:MessageID&gt;urn:uuid:bffbffe9-a379-46bb-8205-7f6b5d15a0f5&lt;/wsa:MessageID&gt;\n   &lt;/env:Header&gt;\n   &lt;env:Body&gt;\n      &lt;ns0:getImportActivityLogsResponse xmlns:ns0=\"http://xmlns.oracle.com/oracle/apps/marketing/commonMarketing/mktImport/model/types/\"&gt;\n         &lt;ns2:result xsi:type=\"ns1:ImportServiceLogs\" xmlns:ns2=\"http://xmlns.oracle.com/oracle/apps/marketing/commonMarketing/mktImport/model/types/\" xmlns:ns1=\"http://xmlns.oracle.com/oracle/apps/marketing/commonMarketing/mktImport/model/\" xmlns:ns0=\"http://xmlns.oracle.com/adf/svc/types/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n            &lt;ns1:LogFileName&gt;log-test_contact_01-02_20150422171310_pverma Data File.csv&lt;/ns1:LogFileName&gt;\n            &lt;ns1:LogFileContent&gt;\n               &lt;xop:Include href=\"cid:ec277fd6-76e2-4ae3-9e8b-1b14c446adf8\" xmlns:xop=\"http://www.w3.org/2004/08/xop/include\"/&gt;\n            &lt;/ns1:LogFileContent&gt;\n            &lt;ns1:ErrorLogFileName&gt;error-test_contact_01-02_20150422171310_pverma Data File.csv&lt;/ns1:ErrorLogFileName&gt;\n            &lt;ns1:ErrorLogFileContent&gt;\n               &lt;xop:Include href=\"cid:d41bacf8-3134-4cd5-80b7-5a68c2b271ed\" xmlns:xop=\"http://www.w3.org/2004/08/xop/include\"/&gt;\n            &lt;/ns1:ErrorLogFileContent&gt;\n            &lt;ns1:ExceptionLogFileName&gt;exception-test_contact_01-02_20150422171310_pverma Data File.csv&lt;/ns1:ExceptionLogFileName&gt;\n            &lt;ns1:ExceptionLogFileContent&gt;\n               &lt;xop:Include href=\"cid:4aa55e1b-1d4d-48be-bdd0-66200de496ee\" xmlns:xop=\"http://www.w3.org/2004/08/xop/include\"/&gt;\n            &lt;/ns1:ExceptionLogFileContent&gt;\n            &lt;ns1:BatchId xsi:nil=\"true\"/&gt;\n         &lt;/ns2:result&gt;\n      &lt;/ns0:getImportActivityLogsResponse&gt;\n   &lt;/env:Body&gt;\n&lt;/env:Envelope&gt;\n</code></pre>\n\n<p>This response contains the flat files. I have to parse these files from above XML.\nPlease suggest any solution over it. Help will be much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3775919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09309e09d6824fed05d57c8f258e2628?s=128&d=identicon&r=PG&f=1", "display_name": "user3775919", "link": "https://stackoverflow.com/users/3775919/user3775919"}, "edited": false, "score": 0, "creation_date": 1431531176, "post_id": 30218816, "comment_id": 48542542, "body": "Thank you very much for your help"}], "tags": [], "owner": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "is_accepted": false, "score": 0, "last_activity_date": 1431529709, "creation_date": 1431529709, "answer_id": 30218816, "question_id": 30218436, "link": "https://stackoverflow.com/questions/30218436/excel-vba-only-add-vaiable-if-not-already-in-table/30218816#30218816", "title": "Excel VBA only add vaiable if not already in table", "body": "<p>Add a loop to go through all of the existing rows to check if the current file name is present. Something like the below:</p>\n\n<pre><code>Dim flg As Boolean\n'...\nDo While xFname$ &lt;&gt; \"\"\n  flg = False\n  For Each myRow In Tbl.ListRows\n    If myRow.Range(1, 1).Value = xFname$ Then flg = True\n  Next myRow\n  If flg = False Then\n    'your code to insert the row with xFname\n  End If\nLoop\n</code></pre>\n\n<p>I haven't tested this particular code block but the general principle is there.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 3775919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09309e09d6824fed05d57c8f258e2628?s=128&d=identicon&r=PG&f=1", "display_name": "user3775919", "link": "https://stackoverflow.com/users/3775919/user3775919"}, "edited": false, "score": 0, "creation_date": 1431531160, "post_id": 30218972, "comment_id": 48542529, "body": "This worked great! Thank you very much for your help"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1431530148, "creation_date": 1431530148, "answer_id": 30218972, "question_id": 30218436, "link": "https://stackoverflow.com/questions/30218436/excel-vba-only-add-vaiable-if-not-already-in-table/30218972#30218972", "title": "Excel VBA only add vaiable if not already in table", "body": "<p>I'd personally recommend against looping over the entire table as that could begin to take a long time, especially as the table grows. Try searching for the item using the <code>.Find</code> method. See example below and modify it to suit your needs.</p>\n\n<pre><code>Sub DoesExist()\n    Dim tbl As ListObject\n    Dim bFnd As Boolean\n    Dim itmToSearch As String\n\n    itmToSearch = InputBox(\"Search\")\n\n    Set tbl = Sheet1.ListObjects(\"Table1\")\n\n    On Error Resume Next\n        If tbl.Range.Find(itmToSearch) Is Nothing Then\n            bFnd = False\n            MsgBox (\"Not Found\")\n            'Do stuff here\n        Else\n            bFnd = True\n            MsgBox (\"Found\")\n        End If\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3775919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09309e09d6824fed05d57c8f258e2628?s=128&d=identicon&r=PG&f=1", "display_name": "user3775919", "link": "https://stackoverflow.com/users/3775919/user3775919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 30218972, "answer_count": 2, "score": 0, "last_activity_date": 1431530148, "creation_date": 1431528696, "last_edit_date": 1531164843, "question_id": 30218436, "link": "https://stackoverflow.com/questions/30218436/excel-vba-only-add-vaiable-if-not-already-in-table", "title": "Excel VBA only add vaiable if not already in table", "body": "<p>I think this should be easy but I can't find a way to do it. The VBA code currently adds all the file name in a folder to a table. I would like it to only add the values that are not already there, your help is greatly appreciated</p>\n\n<pre><code>Sub GetFileNames()\nDim xRow As Long\nDim xDirect$, xFname$, InitialFoldr$\nDim Tbl As ListObject\nDim NewRow As ListRow\nInitialFoldr$ = \"C:\\Users\\OfficeTech1\\Desktop\\GetFileNamesEx\\2015 PO#s\\\"\nSet Tbl = Range(\"Table2\").ListObject\nxDirect$ = InitialFoldr$\nxFname$ = Dir(xDirect$, 7)\nDo While xFname$ &lt;&gt; \"\"\nSet NewRow = Tbl.ListRows.Add(AlwaysInsert:=True)\nNewRow.Range(1, 1) = xFname$\nxFname$ = Dir\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1431528289, "post_id": 30218168, "comment_id": 48540313, "body": "what is the structure of your <code>PF_PC_TOTAL</code> table, maybe it has some fields that have to be set. Anyway: I would recommend buildung all queries inside the query design tool, that way they are kept up to date in regards to renaming..."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1431528471, "post_id": 30218168, "comment_id": 48540467, "body": "RunSQL is nearly always a bad idea <a href=\"http://stackoverflow.com/questions/11213892/whats-the-difference-between-docmd-setwarnings-and-currentdb-execute/11213943#11213943\" title=\"whats the difference between docmd setwarnings and currentdb execute\">stackoverflow.com/questions/11213892/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1431528535, "post_id": 30218338, "comment_id": 48540505, "body": "Except without RunSQL. CurrentDb.Execute is much better."}], "tags": [], "owner": {"reputation": 2651, "user_id": 4059942, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2bmaq.jpg?s=128&g=1", "display_name": "Saagar Elias Jacky", "link": "https://stackoverflow.com/users/4059942/saagar-elias-jacky"}, "is_accepted": false, "score": 2, "last_activity_date": 1431528474, "creation_date": 1431528474, "answer_id": 30218338, "question_id": 30218168, "link": "https://stackoverflow.com/questions/30218168/how-do-i-fix-the-424-runtime-error-object-required-in-ms-access-from-my-vba-co/30218338#30218338", "title": "How do I fix the 424 runtime error &quot;Object Required&quot; in MS-Access from my VBA code", "body": "<p>Try this</p>\n\n<pre><code>DmCmd.RunSQL \"INSERT INTO PF_PC_TOTAL (COL1, COL2, COL3) VALUES ('Andre', 5, 6 ) ;\"\n</code></pre>\n\n<p>and replace <code>COL1, COL2</code> and <code>COL3</code> with actual column names in the table</p>\n"}, {"comments": [{"owner": {"reputation": 316, "user_id": 4689766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24073c0a25135ce8ded98b78365c6684?s=128&d=identicon&r=PG&f=1", "display_name": "GuitarPicker", "link": "https://stackoverflow.com/users/4689766/guitarpicker"}, "edited": false, "score": 0, "creation_date": 1431529347, "post_id": 30218613, "comment_id": 48541176, "body": "As @Saagar Elias Jacky alluded to, it is a much better practice to specify the column names as well, although it is technically optional as long as the number and type of columns match.  Not specifying the names will come back to bit you if someone ever adds a column or rearranges the column order."}], "tags": [], "owner": {"reputation": 316, "user_id": 4689766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24073c0a25135ce8ded98b78365c6684?s=128&d=identicon&r=PG&f=1", "display_name": "GuitarPicker", "link": "https://stackoverflow.com/users/4689766/guitarpicker"}, "is_accepted": false, "score": 0, "last_activity_date": 1431529150, "last_edit_date": 1495541665, "creation_date": 1431529150, "answer_id": 30218613, "question_id": 30218168, "link": "https://stackoverflow.com/questions/30218168/how-do-i-fix-the-424-runtime-error-object-required-in-ms-access-from-my-vba-co/30218613#30218613", "title": "How do I fix the 424 runtime error &quot;Object Required&quot; in MS-Access from my VBA code", "body": "<p>Omit the \"Table!\" prefix from your table name.  The \"bang\" notation is only recognized by VBA code, not the SQL engine that your VBA code is using.</p>\n\n<p><code>DmCmd.RunSQL \"INSERT INTO [PF_PC_TOTAL] VALUES ('Andre', 5, 6 ) ;\"</code></p>\n\n<p>There is another question which explains that part in more detail and has some good links:\n<a href=\"https://stackoverflow.com/questions/2923957/bang-notation-and-dot-notation-in-vba-and-ms-access\">Bang Notation and Dot Notation in VBA and MS-Access</a></p>\n\n<p>You may also want to check the code samples in the documentation: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834799.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff834799.aspx</a></p>\n\n<p>They are using the <em>.Execute</em> method of the <em>Database</em> object, but the SQL syntax is the same for <em>DoCmd.RunSQL</em>.</p>\n"}], "owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1839, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432915160, "creation_date": 1431528082, "last_edit_date": 1432915160, "question_id": 30218168, "link": "https://stackoverflow.com/questions/30218168/how-do-i-fix-the-424-runtime-error-object-required-in-ms-access-from-my-vba-co", "title": "How do I fix the 424 runtime error &quot;Object Required&quot; in MS-Access from my VBA code", "body": "<p>When running my VBA code in access I get the runtime error 424, \"Object Required\". This Is the code causing the error (specifically line 2)</p>\n\n<pre><code> DoCmd.RunSQL \"DELETE * From PF_PC_TOTAL; \"\n DmCmd.RunSQL \"INSERT INTO Table![PF_PC_TOTAL] VALUES ('Andre', 5, 6 ) ;\"\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "ms-access-2010", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1431527782, "post_id": 30217897, "comment_id": 48539877, "body": "Comment out the <code>On Error Resume Next</code>, then run the code again and see what happens. (I&#39;m assuming you set <code>r</code> to a valid value at some point prior to this code?)"}, {"owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431528506, "post_id": 30217897, "comment_id": 48540488, "body": "Yes, <code>r</code> is defined as <code>r=2</code> at the beginning. This is still returning blank fields."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1431528520, "post_id": 30217897, "comment_id": 48540497, "body": "Once you&#39;ve figured out what the error is, take that commented-out <code>On Error Resume Next</code> line, and remove it. Then make a quick search on this site about error handling in VBA. The best way to never know what&#39;s going on is to use <code>On Error Resume Next</code>."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431529564, "post_id": 30217897, "comment_id": 48541355, "body": "If you&#39;re not getting any errors but getting blank fields in the database, there&#39;s a good chance you just need so specify the worksheet the code should be using - i.e. using <code>Worksheets(&quot;foo&quot;).Range(...).Value</code>, rather than just using <code>Range(...).Value</code>"}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1431529093, "last_edit_date": 1431529093, "creation_date": 1431528697, "answer_id": 30218437, "question_id": 30217897, "link": "https://stackoverflow.com/questions/30217897/excel-not-transferring-data-to-access-database/30218437#30218437", "title": "Excel Not Transferring Data to Access Database", "body": "<p>My guess is your code triggers a primary key violation when attempting to add a new row with a <em>LocationID</em> value which matches the <em>LocationID</em> value of another row.  This is where the new row is added:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>.AddNew\n.Fields(\"LocationID\") = Range(\"B\" &amp; r).Value\n</code></pre>\n\n<p>Since you have this earlier in the procedure ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>On Error Resume Next\n</code></pre>\n\n<p>... Access does not inform you about the problem which prevented that row from being added.  </p>\n\n<p>Test my guess by disabling that <code>On Error</code> line, as the other comments recommended:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'On Error Resume Next\n</code></pre>\n\n<p>I suspect you will need a strategy which first checks whether the current <em>LocationID</em> value is already stored in the table.  If it is present, update that existing row.  And if not present, add a new row ... something like this ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If DCount(\"*\", \"BCIImport\", \"LocationID=\" &amp; Range(\"B\" &amp; r).Value) = 0 Then\n    ' add new row\nElse\n    ' update existing row\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 30218437, "answer_count": 1, "score": 2, "last_activity_date": 1431529320, "creation_date": 1431527418, "last_edit_date": 1531161705, "question_id": 30217897, "link": "https://stackoverflow.com/questions/30217897/excel-not-transferring-data-to-access-database", "title": "Excel Not Transferring Data to Access Database", "body": "<p>I have a table in in Access 2010 that stores project information. The main columns - for this purpose - are <code>LocationID</code>, <code>Priority1</code>, and <code>Priority2</code> (which have proper names but for generalization...)</p>\n\n<p>I also have an Excel 2010 spreadsheet that has this information to be exported into Access. What it does is run through the <code>LocationID</code> columns in Excel and Access, and colours all the matching fields. Then it checks the <code>Priority1</code> and <code>Priority2</code> columns to see if any of the rows are already filled in, and colours the ones that aren't. This part works fine.</p>\n\n<p>What it's supposed to do <em>next</em> is copy the values from two <code>Priority</code> columns that are coloured from Excel into the Access table. This isn't happening, and I'm not sure why.</p>\n\n<p>The entire code is fairly long, so here's just the section concerning transferring values. I can add any other code that might be useful.</p>\n\n<pre><code>If (Not (IsNull(path))) Then\n    Set cn = New ADODB.Connection\n    cn.Open \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; path &amp; \";\"\n    Set rs = New ADODB.Recordset\n    rs.Open \"BCIImport\", cn, adOpenKeyset, adLockOptimistic, adCmdTable\nOn Error Resume Next\n    Do While Len(Range(\"B\" &amp; r).Formula) &gt; 0\n        With rs\n            If Not rs.BOF Then\n                rs.MoveFirst\n            End If\n\n            If (Range(\"B\" &amp; r).Interior.Color = RGB(0, 255, 255)) Then\n                .AddNew\n                .Fields(\"LocationID\") = Range(\"B\" &amp; r).Value\n                .Fields(\"Priority1\") = Range(\"C\" &amp; r).Value\n                .Fields(\"Priority2\") = Range(\"D\" &amp; r).Value\n                .Update\n            End If\n        End With\n        r = r + 1 'advances to next row\n    Loop\n    rs.Close\n    cn.Close\n    Set rs = Nothing\n    Set cn = Nothing\nEnd If\n</code></pre>\n\n<p>I'm not much of a VBA programmer, so any advice would be great.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1431527637, "post_id": 30217805, "comment_id": 48539735, "body": "I had something simular and did a <code>select case</code> function for this. There must be something easier but I didnt have time to work it out or search for it"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1431527803, "creation_date": 1431527803, "answer_id": 30218062, "question_id": 30217805, "link": "https://stackoverflow.com/questions/30217805/excel-vba-get-number-from-letter-equivalent-entry-in-a-textbox/30218062#30218062", "title": "Excel-VBA get number from letter equivalent entry in a textbox", "body": "<p>On way to get a <strong>column number</strong> from a <strong>character string:</strong></p>\n\n<pre><code>Sub ColumnNumber()\n  Dim s As String\n  Dim L As Long\n  s = \"AB\"\n  L = Cells(1, s).Column\n  MsgBox L\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1431529387, "post_id": 30218151, "comment_id": 48541204, "body": "How would  I incorpate the textbox value?"}, {"owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1431529477, "post_id": 30218151, "comment_id": 48541277, "body": "I tried the following: Cells(1,&quot;Textbox3.value&quot;) and Cells(1,&quot;Textbox&quot;) and neither were read correctly."}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "reply_to_user": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1431529915, "post_id": 30218151, "comment_id": 48541619, "body": "Get rid of the quotes.  <code>Cells(1, Textbox3.value)</code> or assign <code>Textbox3.value</code> to a variable to validate the entry.  The way you have it written you&#39;re looking for a column literally called &quot;Textbox3.value&quot;"}, {"owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "edited": false, "score": 0, "creation_date": 1431533551, "post_id": 30218151, "comment_id": 48544165, "body": "Thanks a bunch, this works. I could have sworn I tried that but apparently I didn&#39;t."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": true, "score": 0, "last_activity_date": 1431528038, "creation_date": 1431528038, "answer_id": 30218151, "question_id": 30217805, "link": "https://stackoverflow.com/questions/30217805/excel-vba-get-number-from-letter-equivalent-entry-in-a-textbox/30218151#30218151", "title": "Excel-VBA get number from letter equivalent entry in a textbox", "body": "<p>If you want to keep it uncomplicated, <code>.Cells</code> can use the column string instead of number</p>\n\n<pre><code>Sub test()\n    'From sheet module\n    Debug.Print Me.Cells(1, 1).Address 'prints $A$1\n    Debug.Print Me.Cells(1, \"A\").Address 'also prints $A$1 \nEnd Sub\n</code></pre>\n\n<p>You might have to validate that it's a valid column ID but you probably need to do that even converting it to a number.</p>\n"}], "owner": {"reputation": 325, "user_id": 4862651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-t2IgbMQjgAM/AAAAAAAAAAI/AAAAAAAAAAA/dHi-KVOppI4/photo.jpg?sz=128", "display_name": "Alexis Moreno", "link": "https://stackoverflow.com/users/4862651/alexis-moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 30218151, "answer_count": 2, "score": 1, "last_activity_date": 1431528038, "creation_date": 1431527209, "question_id": 30217805, "link": "https://stackoverflow.com/questions/30217805/excel-vba-get-number-from-letter-equivalent-entry-in-a-textbox", "title": "Excel-VBA get number from letter equivalent entry in a textbox", "body": "<p>I have a user form that asks for a column reference to be entered into a TextBox. I am trying to make it so that the number replaces the letter in the code. I am using the Cells(a,b) format to do this. Which is why I need the number to replace the letter. </p>\n\n<pre><code>Worksheets(\"AIO\").Cells(X, TextBox3).Value = Worksheets(\"FDSA\").Cells(Y, TextBox4).Value\n</code></pre>\n\n<p>Hence in the previous code when: x=2, TextBox3.Value=A, y=4, and TextBox4.Value=AA</p>\n\n<p>The code will work as </p>\n\n<pre><code>Worksheets(\"AIO\").Cells(2, 1).Value = Worksheets(\"FDSA\").Cells(4, 27).Value\n</code></pre>\n\n<p>The only thing I can think of making is a huge if statement were I code something similar like this:</p>\n\n<pre><code>If textbox3.value =\"A\" then\ntextbox3.value=1\nelseif textbox3.value=E then\ntextbox3.value=5\n.......\n.......\ntextbox3.value=AD then\ntextbox3.value=30\n\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1431527576, "post_id": 30217763, "comment_id": 48539678, "body": "Do you just want them in one sub?"}, {"owner": {"reputation": 31, "user_id": 2842252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db8df7fc8085a424b881f6d6e55a664c?s=128&d=identicon&r=PG&f=1", "display_name": "user2842252", "link": "https://stackoverflow.com/users/2842252/user2842252"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1431527662, "post_id": 30217763, "comment_id": 48539762, "body": "Paul, It doesn&#39;t seem that there is any changes made to the code. can you please let me know what the exact changes that are.."}, {"owner": {"reputation": 31, "user_id": 2842252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db8df7fc8085a424b881f6d6e55a664c?s=128&d=identicon&r=PG&f=1", "display_name": "user2842252", "link": "https://stackoverflow.com/users/2842252/user2842252"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1431527749, "post_id": 30217763, "comment_id": 48539845, "body": "Yes Paul I want it under one Sub."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2842252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db8df7fc8085a424b881f6d6e55a664c?s=128&d=identicon&r=PG&f=1", "display_name": "user2842252", "link": "https://stackoverflow.com/users/2842252/user2842252"}, "edited": false, "score": 0, "creation_date": 1431528157, "post_id": 30218094, "comment_id": 48540198, "body": "No Paul  It wans&#39;t working fine for me... the codes didn&#39;t get copied to the next cell most of the time. Thank you for the Quick Response."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 0, "last_activity_date": 1431527889, "creation_date": 1431527889, "answer_id": 30218094, "question_id": 30217763, "link": "https://stackoverflow.com/questions/30217763/codes-unable-to-execute-vba-excel/30218094#30218094", "title": "Codes unable to execute VBA Excel", "body": "<p>If the code just needs to be moved into one, you can just create different variables. Although I do not see any major advantage of this. </p>\n\n<pre><code>Sub oneSub()\n    Dim completeRow As Long, followRow As Long\n    Dim wsComplete As Worksheet, wsFollow As Worksheet\n\n    Set wsComplete = Worksheets(\"Completed\")\n    Set wsFollow = Worksheets(\"Follow-up\")\n\n    Dim strFormulas(1 To 3) As Variant\n\n    completeRow = wsComplete.Cells(Rows.Count, 1).End(xlUp).Row\n    followRow = wsFollow.Cells(Rows.Count, 1).End(xlUp).Row\n\n    wsComplete.Range(\"Y2:Z\" &amp; completeRow).FillDown\n    wsFollow.Range(\"Y2:Z\" &amp; followRow).FillDown\n\n    strFormulas(1) = \"=(N2-A2)+(R2-O2)+(V2-S2)\"\n    strFormulas(2) = \"=IFERROR(Y2/L2,Y2)\"\n\n    ThisWorkbook.Sheets(\"Completed\").Range(\"Y2:Z2\").Formula = strFormulas\n    ThisWorkbook.Sheets(\"Follow-up\").Range(\"Y2:Z2\").Formula = strFormulas\nEnd Sub\n</code></pre>\n\n<p>IMVHO Calling <code>Sub ABC</code> then <code>Sub BCD</code>, is same as <code>Sub oneSub</code>. Not much difference</p>\n"}], "owner": {"reputation": 31, "user_id": 2842252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db8df7fc8085a424b881f6d6e55a664c?s=128&d=identicon&r=PG&f=1", "display_name": "user2842252", "link": "https://stackoverflow.com/users/2842252/user2842252"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431775821, "creation_date": 1431527127, "last_edit_date": 1431775821, "question_id": 30217763, "link": "https://stackoverflow.com/questions/30217763/codes-unable-to-execute-vba-excel", "title": "Codes unable to execute VBA Excel", "body": "<pre><code>Sub abc()\n    Dim lrow As Long\n    Dim ws As Worksheet\n\n    Set ws = ActivsheetWorksheets(\"Completed\")\n\n    Dim strFormulas(1 To 3) As Variant\n\n    lrow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\n    With ws\n        .Range(\"Y2:Z\" &amp; lrow).FillDown\n    End With\n\n    With ThisWorkbook.Sheets(\"Completed\")\n        strFormulas(1) = \"=(N2-A2)+(R2-O2)+(V2-S2)\"\n        strFormulas(2) = \"=IFERROR(Y2/L2,Y2)\"\n        .Range(\"Y2:Z2\").Formula = strFormulas\n    End With\nEnd Sub\n\nSub bcd()\n    Dim lrow As Long\n    Dim ws As Worksheet\n\n    Set ws = Worksheets(\"Follow-up\")\n\n    Dim strFormulas(1 To 3) As Variant\n\n    lrow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\n    With ws\n        .Range(\"Y2:Z\" &amp; lrow).FillDown\n    End With\n\n    With ThisWorkbook.Sheets(\"Follow-up\")\n        strFormulas(1) = \"=(N2-A2)+(R2-O2)+(V2-S2)\"\n        strFormulas(2) = \"=IFERROR(Y2/L2,Y2)\"\n        .Range(\"Y2:Z2\").Formula = strFormulas\n    End With\nEnd Sub\n</code></pre>\n\n<p>Can the above code be simplified into one. It is working fine but the thing is I need to simplify the code since I have to call it in a UserForm. Thanks in Advance.</p>\n"}, {"tags": ["mysql", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1431527170, "creation_date": 1431527170, "answer_id": 30217784, "question_id": 30217222, "link": "https://stackoverflow.com/questions/30217222/keep-decimal-separator-in-vba/30217784#30217784", "title": "Keep decimal separator in VBA", "body": "<p>Use Cstr ou Replace before using value in Insert commande :</p>\n\n<pre><code>val1 = CStr(ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 1).Value)\nval2 = CStr(ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 2).Value)\nval3 = CStr(ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 3).Value)\nval4 = CStr(ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 4).Value)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>val1 = Replace(ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 1).Value,\",\",\".\")\nval2 = Replace(ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 2).Value,\",\",\".\")\nval3 = Replace(ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 3).Value,\",\",\".\")\nval4 = Replace(ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 4).Value,\",\",\".\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1431528633, "creation_date": 1431528633, "answer_id": 30218401, "question_id": 30217222, "link": "https://stackoverflow.com/questions/30217222/keep-decimal-separator-in-vba/30218401#30218401", "title": "Keep decimal separator in VBA", "body": "<p>You can use <code>.Text</code> instead of <code>.Value</code>. Value returns the system default decimal separator.</p>\n\n<pre><code>val1 = ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 1).Text\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4796619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f21346a963d6e1437a7df7527a3188?s=128&d=identicon&r=PG&f=1", "display_name": "lswei", "link": "https://stackoverflow.com/users/4796619/lswei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 30218401, "answer_count": 2, "score": 1, "last_activity_date": 1432914298, "creation_date": 1431525774, "last_edit_date": 1432914298, "question_id": 30217222, "link": "https://stackoverflow.com/questions/30217222/keep-decimal-separator-in-vba", "title": "Keep decimal separator in VBA", "body": "<p>I'm trying to upload a table in Excel to MySQL. I changed the decimal separator in my Excel to \".\" and all the numbers in my table is in point decimal.\nHowever when I upload this data to MySQL using the INSERT INTO function, the decimal separator becomes \",\" in MySQL. Can anybody help me?</p>\n\n<pre><code>trSQL = \"CREATE TABLE IF NOT EXISTS `\" &amp; table1 &amp; \"` (`\" _\n         &amp; field1 &amp; \"` \" &amp; \"varchar(12)\" &amp; \",`\" _\n         &amp; field2 &amp; \"` \" &amp; \"varchar(3)\" &amp; \",`\" _\n         &amp; field3 &amp; \"` \" &amp; \"varchar(4)\" &amp; \",`\" _\n         &amp; field4 &amp; \"` \" &amp; \"varchar(3)\" _\n         &amp; \")\"\n\nconn.Execute strSQL\n\nFor i = 1 To 31\nval1 = ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 1).Value\nval2 = ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 2).Value\nval3 = ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 3).Value\nval4 = ThisWorkbook.Worksheets(\"test\").Cells(i + 38, 4).Value\n\nstSQL = \"INSERT INTO testing (Date, test1 , test2 , test3)\"\nstSQL = stSQL &amp; \"VALUES ('\" &amp; val1 &amp; \" ',' \" &amp; val2 &amp; \"','\" &amp; val3 &amp; \"','\" &amp; val4 &amp; \"')\"\nThisWorkbook.Worksheets(\"test\").Cells(i + 38, 7).Value = edf\n\n                conn.Execute stSQL\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "loops", "excel"], "comments": [{"owner": {"reputation": 2863, "user_id": 3432434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1081e46b177e61481d4ff404c29d00c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jignesh Sutar", "link": "https://stackoverflow.com/users/3432434/jignesh-sutar"}, "edited": false, "score": 0, "creation_date": 1431525654, "post_id": 30216937, "comment_id": 48538075, "body": "The VBA code aside, could you share what some description of what you are trying to do with the SPSS output? Merge multiple excel output from SPSS into a single file? What&#39;s the purpose of the code you post and beyond that what is the over aim? As your approach could well be done somewhat easier some other-how..."}, {"owner": {"reputation": 79, "user_id": 3150260, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/be7def73c54e485b795d29e56f0c994c?s=128&d=identicon&r=PG&f=1", "display_name": "user3150260", "link": "https://stackoverflow.com/users/3150260/user3150260"}, "reply_to_user": {"reputation": 2863, "user_id": 3432434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1081e46b177e61481d4ff404c29d00c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jignesh Sutar", "link": "https://stackoverflow.com/users/3432434/jignesh-sutar"}, "edited": false, "score": 0, "creation_date": 1431526064, "post_id": 30216937, "comment_id": 48538394, "body": "Of course... I get a series of spreadsheets that contain SPSS output that is not organized, each sheet has multiple data tables with minimal headings to distinguish between them. I&#39;m trying to take these three sheets and combine them into a single sheet that is organized from top to bottom on the data that I need - the order that I need the data in is consistent each time the SPSS is run. My overall aim is to simplify the process of digging through 3 worksheets with 80 data tables to try to find what I want."}, {"owner": {"reputation": 2863, "user_id": 3432434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1081e46b177e61481d4ff404c29d00c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jignesh Sutar", "link": "https://stackoverflow.com/users/3432434/jignesh-sutar"}, "edited": false, "score": 1, "creation_date": 1431526699, "post_id": 30216937, "comment_id": 48538936, "body": "You may want to consider using the TITLE command in SPSS before any procedure that generates any output as a way of identifying (the start of) that particular output. If it is CTABLES output then it has an internal TITLE sub-command which would work equivalently also. This doesn&#39;t answer your question at hand, I understand, but may give you ideas how to setup your process perhaps a little better to then not have to use additional complicated code? I don&#39;t know...."}, {"owner": {"reputation": 79, "user_id": 3150260, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/be7def73c54e485b795d29e56f0c994c?s=128&d=identicon&r=PG&f=1", "display_name": "user3150260", "link": "https://stackoverflow.com/users/3150260/user3150260"}, "reply_to_user": {"reputation": 2863, "user_id": 3432434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1081e46b177e61481d4ff404c29d00c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jignesh Sutar", "link": "https://stackoverflow.com/users/3432434/jignesh-sutar"}, "edited": false, "score": 0, "creation_date": 1431527352, "post_id": 30216937, "comment_id": 48539487, "body": "I will look into that, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 3150260, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/be7def73c54e485b795d29e56f0c994c?s=128&d=identicon&r=PG&f=1", "display_name": "user3150260", "link": "https://stackoverflow.com/users/3150260/user3150260"}, "is_accepted": false, "score": 0, "last_activity_date": 1431531202, "creation_date": 1431531202, "answer_id": 30219369, "question_id": 30216937, "link": "https://stackoverflow.com/questions/30216937/vba-loop-with-arrays-duplicating-output/30219369#30219369", "title": "VBA loop with arrays duplicating output", "body": "<p>This works if anyone want to reuse this code... </p>\n\n<pre><code>  For x = 1 To 3 Step 1\n            For Each ws In Application.ThisWorkbook.Worksheets\n                'Starting row\n                i = 1\n                'Find LastRow\n                LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n                Do While i &lt;= LastRow\n                    If ws.Name &lt;&gt; \"Run Macros\" Or ws.Name &lt;&gt; \"Summary\" Then\n                    If ws.Range(\"A\" &amp; i).Value Like LocationA(x) And ws.Range(\"A\" &amp; i + 1).Value Like LocationB(x) And ws.Range(ColumnA(x) &amp; i + VariableA(x)).Value Like LocationC(x) And ws.Range(ColumnB(x) &amp; i + VariableB(x)).Value Like LocationD(x) Then\n                        CopiedRows = 0\n                        i2 = i\n                        Do While ws.Range(\"A\" &amp; i2 + 1).Borders(xlEdgeLeft).LineStyle = 1 And ws.Range(\"A\" &amp; i2 + 1).Borders(xlEdgeLeft).Weight = 4\n                        i2 = i2 + 1\n                    CopiedRows = CopiedRows + 1\n                    Loop\n                        n = Sheets(\"Summary\").Cells(Rows.Count, \"A\").End(xlUp).Row + 4\n                        ws.Rows(i &amp; \":\" &amp; i + CopiedRows).Copy Sheets(\"Summary\").Range(\"A\" &amp; n)\n                        Exit For\n                        On Error Resume Next\n                    End If\n                    End If\n                i = i + 1\n                Loop\n            Next\n        Next x\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 3150260, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/be7def73c54e485b795d29e56f0c994c?s=128&d=identicon&r=PG&f=1", "display_name": "user3150260", "link": "https://stackoverflow.com/users/3150260/user3150260"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431531202, "creation_date": 1431525128, "last_edit_date": 1531164843, "question_id": 30216937, "link": "https://stackoverflow.com/questions/30216937/vba-loop-with-arrays-duplicating-output", "title": "VBA loop with arrays duplicating output", "body": "<p>I'm new to using arrays (and VBA in general) and I'm trying to incorporate a series of arrays into a module that formats SPSS syntax output in worksheets in a single workbook. Below is my code, which works, but is duplicating the results that are found. I think it has something to do with the order of my loops but I can't seem to figure out how to fix it. Any thoughts would be greatly appreciated.</p>\n\n<pre><code>Sub FindValues()\n\nCall CreateSummary\n\n'This code will build the initial summary file\n\n    Dim ws As Excel.Worksheet\n\n    'Application.ScreenUpdating = False\n\n    MsgBox (\"It will take a moment for data to appear, please be patient if data does not immediately appear\")\n\n    Dim LastRow As Long\n    Dim i As Integer\n    Dim i2 As Integer\n    Dim x As Integer\n    Dim y As Integer\n    Dim CopiedRows As Integer\n    Dim LocationA(4) As String\n    Dim LocationB(4) As String\n    Dim LocationC(4) As String\n    Dim LocationD(4) As String\n    Dim VariableA(4) As Integer\n    Dim VariableB(4) As Integer\n    Dim ColumnA(4) As String\n    Dim ColumnB(4) As String\n    Dim n As Long\n\n    'Find DateTime Info\n    LocationA(1) = \"Date_Time\"\n    LocationB(1) = \"Quarter\"\n    LocationC(1) = \"N\"\n    LocationD(1) = \"Minimum\"\n    VariableA(1) = 1\n    VariableB(1) = 1\n    ColumnA(1) = \"B\"\n    ColumnB(1) = \"C\"\n\n    LocationA(2) = \"Dur*\"\n    LocationB(2) = \"Methodology_ID\"\n    LocationC(2) = \"Mean\"\n    LocationD(2) = \"N\"\n    VariableA(2) = 1\n    VariableB(2) = 1\n    ColumnA(2) = \"C\"\n    ColumnB(2) = \"D\"\n\n    LocationA(3) = \"WebTimeout\"\n    LocationB(3) = \"Methodology_ID\"\n    LocationC(3) = \"Mean\"\n    LocationD(3) = \"N\"\n    VariableA(3) = 1\n    VariableB(3) = 1\n    ColumnA(3) = \"C\"\n    ColumnB(3) = \"D\"\n\n    'LocationA(4) = \"Crosstabulation\"\n    'LocationB(4) = \"Quarter\"\n    'LocationC(4) = \"N\"\n    'LocationD(4) = \"Minimum\"\n    'VariableA(4) = 1\n\n    'Find OSAT Data\n    'LocationA(2) = \"*Report*\"\n    'LocationB(2) = \"*CallMonth*\"\n    'LocationC(2) = \"Mean*\"\n    'LocationD(2) = \"*Overall*\"\n    'VariableA(2) = 2\n\n    For Each ws In Application.ThisWorkbook.Worksheets\n    'Starting row\n    i = 1\n    'Find LastRow\n    LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\n    If ws.Name &lt;&gt; \"Run Macros\" Then\n\n        Do While i &lt;= LastRow\n            For x = 1 To 3\n\n            If ws.Range(\"A\" &amp; i).Value Like LocationA(x) And ws.Range(\"A\" &amp; i + 1).Value Like LocationB(x) And ws.Range(ColumnA(x) &amp; i + VariableA(x)).Value Like LocationC(x) And ws.Range(ColumnB(x) &amp; i + VariableB(x)).Value Like LocationD(x) Then\n            CopiedRows = 0\n            i2 = i\n\n                Do While ws.Range(\"A\" &amp; i2 + 1).Borders(xlEdgeLeft).LineStyle = 1 And ws.Range(\"A\" &amp; i2 + 1).Borders(xlEdgeLeft).Weight = 4\n                i2 = i2 + 1\n                CopiedRows = CopiedRows + 1\n                Loop\n                n = Sheets(\"Summary\").Cells(Rows.Count, \"A\").End(xlUp).Row + 4\n                ws.Rows(i &amp; \":\" &amp; i + CopiedRows).Copy Sheets(\"Summary\").Range(\"A\" &amp; n)\n            On Error Resume Next\n            End If\n            Next x\n            i = i + 1\n        Loop\n    End If\n    Next\n\n    'Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-addin"], "comments": [{"owner": {"reputation": 3413, "user_id": 4857255, "user_type": "registered", "profile_image": "https://graph.facebook.com/914125558644955/picture?type=large", "display_name": "Lance", "link": "https://stackoverflow.com/users/4857255/lance"}, "edited": false, "score": 0, "creation_date": 1431525324, "post_id": 30216838, "comment_id": 48537799, "body": "What version of Outlook?  I think you need to do it the other way around.  Create a custom meeting template that includes the desired signature.  Then create a new meeting based on your custom template."}, {"owner": {"reputation": 1506, "user_id": 438958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8a426f1382b6c746ac51ad7ddd1296af?s=128&d=identicon&r=PG", "display_name": "Gordon", "link": "https://stackoverflow.com/users/438958/gordon"}, "reply_to_user": {"reputation": 3413, "user_id": 4857255, "user_type": "registered", "profile_image": "https://graph.facebook.com/914125558644955/picture?type=large", "display_name": "Lance", "link": "https://stackoverflow.com/users/4857255/lance"}, "edited": false, "score": 0, "creation_date": 1431525967, "post_id": 30216838, "comment_id": 48538323, "body": "I got Microsoft Outlook 2010. But others in the company got 2013."}, {"owner": {"reputation": 3413, "user_id": 4857255, "user_type": "registered", "profile_image": "https://graph.facebook.com/914125558644955/picture?type=large", "display_name": "Lance", "link": "https://stackoverflow.com/users/4857255/lance"}, "edited": false, "score": 0, "creation_date": 1431526797, "post_id": 30216838, "comment_id": 48539027, "body": "Outlook 2010 on include the form designer so you&#39;re good.  File -&gt; Options -&gt; Customize Ribbon, then, in the Right Side pane, click to turn on the Developer Tab.  From there you can design Meeting Request template to your specification.  Then, to use it, you will select New -&gt; Meeting Request Using -&gt; (Your Custom Template) from the Outlook Home tab.  Let me know if this works for you and I&#39;ll make an answer out of it."}, {"owner": {"reputation": 1506, "user_id": 438958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8a426f1382b6c746ac51ad7ddd1296af?s=128&d=identicon&r=PG", "display_name": "Gordon", "link": "https://stackoverflow.com/users/438958/gordon"}, "reply_to_user": {"reputation": 3413, "user_id": 4857255, "user_type": "registered", "profile_image": "https://graph.facebook.com/914125558644955/picture?type=large", "display_name": "Lance", "link": "https://stackoverflow.com/users/4857255/lance"}, "edited": false, "score": 0, "creation_date": 1431543769, "post_id": 30216838, "comment_id": 48550248, "body": "this works too! you probably should submit this as an answer!"}, {"owner": {"reputation": 3413, "user_id": 4857255, "user_type": "registered", "profile_image": "https://graph.facebook.com/914125558644955/picture?type=large", "display_name": "Lance", "link": "https://stackoverflow.com/users/4857255/lance"}, "edited": false, "score": 0, "creation_date": 1431544043, "post_id": 30216838, "comment_id": 48550408, "body": "Thanks @Gordon!  I will."}], "answers": [{"comments": [{"owner": {"reputation": 1506, "user_id": 438958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8a426f1382b6c746ac51ad7ddd1296af?s=128&d=identicon&r=PG", "display_name": "Gordon", "link": "https://stackoverflow.com/users/438958/gordon"}, "edited": false, "score": 0, "creation_date": 1431553076, "post_id": 30217534, "comment_id": 48555162, "body": "Thank you! I will take a look at this helpful guide too!"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 2, "last_activity_date": 1431526539, "creation_date": 1431526539, "answer_id": 30217534, "question_id": 30216838, "link": "https://stackoverflow.com/questions/30216838/automatically-insert-email-signature-into-outlook-meeting-invite/30217534#30217534", "title": "Automatically insert email signature into Outlook Meeting Invite", "body": "<p>You can handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865076(v=office.15).aspx\" rel=\"nofollow\">ItemSend</a> event of the Application class where you can check out the message class of the outcoming Outlook item and change the message body if required. </p>\n\n<p>Think you will find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article helpful.</p>\n"}, {"comments": [{"owner": {"reputation": 29332, "user_id": 177416, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/F6rDx.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/177416/alex"}, "edited": false, "score": 2, "creation_date": 1460121791, "post_id": 30223337, "comment_id": 60608797, "body": "Here&#39;s what I had to: In Outlook 2013, go to Developer tab &gt; Design a Form &gt; select Meeting Request &lt;Hidden&gt;. Then pasted my signature from my emails into the meeting request. Clicking Save only saved it as an actual meeting request on the calendar. The trick was to Publish it with a name. Then I could select it from Calendar &gt; New Items &gt; Custom Forms &gt; &lt;my form&gt;"}], "tags": [], "owner": {"reputation": 3413, "user_id": 4857255, "user_type": "registered", "profile_image": "https://graph.facebook.com/914125558644955/picture?type=large", "display_name": "Lance", "link": "https://stackoverflow.com/users/4857255/lance"}, "is_accepted": true, "score": 5, "last_activity_date": 1431544147, "creation_date": 1431544147, "answer_id": 30223337, "question_id": 30216838, "link": "https://stackoverflow.com/questions/30216838/automatically-insert-email-signature-into-outlook-meeting-invite/30223337#30223337", "title": "Automatically insert email signature into Outlook Meeting Invite", "body": "<p>Outlook 2010 and newer include the form designer.</p>\n\n<p>File -> Options -> Customize Ribbon, then, in the Right Side pane, click to turn on the Developer Tab.</p>\n\n<p>From there you can design Meeting Request template to your specification.</p>\n\n<p>Then, to use it, you will select:</p>\n\n<p>New -> Meeting Request Using -> (Your Custom Template) from the Outlook Home tab.</p>\n"}], "owner": {"reputation": 1506, "user_id": 438958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8a426f1382b6c746ac51ad7ddd1296af?s=128&d=identicon&r=PG", "display_name": "Gordon", "link": "https://stackoverflow.com/users/438958/gordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12654, "favorite_count": 0, "accepted_answer_id": 30223337, "answer_count": 2, "score": 7, "last_activity_date": 1592873252, "creation_date": 1431524887, "last_edit_date": 1592873252, "question_id": 30216838, "link": "https://stackoverflow.com/questions/30216838/automatically-insert-email-signature-into-outlook-meeting-invite", "title": "Automatically insert email signature into Outlook Meeting Invite", "body": "<p>I have been searching the web for a way to do this but no such luck. My goal is to save a meeting agenda template into an email signature which would be inserted into every meeting invite created by me. </p>\n\n<p>Looking for some clues on how to do this? </p>\n"}, {"tags": ["vba", "excel", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4892951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6af547acc7694cd54aa8daf7b8f67bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Butterfly", "link": "https://stackoverflow.com/users/4892951/butterfly"}, "edited": false, "score": 0, "creation_date": 1431525922, "post_id": 30217045, "comment_id": 48538285, "body": "On Error Resume Next         Corp = Application.WorksheetFunction.VLookup(Str, ws2.Range(&quot;G2&quot;), 4, False)         result = Application.WorksheetFunction.VLookup(Str, ws2.Range(&quot;G2&quot;), 13, False)"}, {"owner": {"reputation": 5, "user_id": 4892951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6af547acc7694cd54aa8daf7b8f67bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Butterfly", "link": "https://stackoverflow.com/users/4892951/butterfly"}, "edited": false, "score": 0, "creation_date": 1431612163, "post_id": 30217045, "comment_id": 48580104, "body": "Would like to get an answer. Is there a way to look till end of the row in this code"}], "tags": [], "owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1431633385, "last_edit_date": 1431633385, "creation_date": 1431525376, "answer_id": 30217045, "question_id": 30216641, "link": "https://stackoverflow.com/questions/30216641/vlookup-without-a-range-in-vba/30217045#30217045", "title": "Vlookup without a range in VBA", "body": "<p>If you have one cell that is in the range you want to use (Like G2 in your example) You could use Range(\"G2\").CurrentRegion. This will give you the complete range that the cell belongs to.\nThis works for me:</p>\n\n<pre><code>Public Sub GetLookupValue()  \n  Dim rng As Range\n  Dim str As String\n  str = \"c\"\n  Set rng = Blad1.Range(\"G2\").CurrentRegion\n  Debug.Print Application.WorksheetFunction.VLookup(str, rng, 2, False)\n  Set rng = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4892951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6af547acc7694cd54aa8daf7b8f67bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Butterfly", "link": "https://stackoverflow.com/users/4892951/butterfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432915290, "creation_date": 1431524401, "last_edit_date": 1531164843, "question_id": 30216641, "link": "https://stackoverflow.com/questions/30216641/vlookup-without-a-range-in-vba", "title": "Vlookup without a range in VBA", "body": "<p>Looking for Vlookup till the last row. Is there a way to do without giving a range? Can it do till the last row.</p>\n\n<pre><code>    Do While IsEmpty(Cells(i, Name)) = False\n        Str = Cells(i, Name)\n\n        ws2.Select\n\n        On Error Resume Next\n        Corp = Application.WorksheetFunction.VLookup(Str, ws2.Range(\"G2:S3000\"), 4, False)\n        result = Application.WorksheetFunction.VLookup(Str, ws2.Range(\"G2:S3000\"), 13, False)\n        'Band = Application.WorksheetFunction.VLookup(Str, ws2.Range(\"G2:S2500\"), 7, False)\n\n        If (Err &lt;&gt; 0) Then\n        Else\n            ws1.Select\n            If (result &lt;&gt; 0) Then\n                Cells(i, 10) = result\n            End If\n            Cells(i, 9) = Corp\n        End If\n\n        i = i + 1\n        ws1.Select\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", ".net", "vba", "excel"], "comments": [{"owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "edited": false, "score": 3, "creation_date": 1431524375, "post_id": 30216525, "comment_id": 48536996, "body": "Look at this question <a href=\"http://stackoverflow.com/questions/15951837/excel-vba-wait-for-shell-command-to-complete\">excel-vba-wait-for-shell-command-to-complete</a>"}, {"owner": {"reputation": 1176, "user_id": 2356287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b1dffb36543d696b21ab62fc822aa1?s=128&d=identicon&r=PG", "display_name": "mageos", "link": "https://stackoverflow.com/users/2356287/mageos"}, "edited": false, "score": 2, "creation_date": 1431524621, "post_id": 30216525, "comment_id": 48537215, "body": "Take a look at this thread:    <a href=\"http://stackoverflow.com/questions/10279404/vbscript-how-to-make-program-wait-until-process-has-finished\" title=\"vbscript how to make program wait until process has finished\">stackoverflow.com/questions/10279404/&hellip;</a>"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "edited": false, "score": 0, "creation_date": 1431525436, "post_id": 30216525, "comment_id": 48537892, "body": "thanks guys - both work"}], "answers": [{"tags": [], "owner": {"reputation": 4767, "user_id": 4840746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e31f21104e0a15400e01027ad3dca9?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;bastien Sevrin", "link": "https://stackoverflow.com/users/4840746/s%c3%a9bastien-sevrin"}, "is_accepted": true, "score": 2, "last_activity_date": 1431525529, "last_edit_date": 1495542606, "creation_date": 1431525529, "answer_id": 30217113, "question_id": 30216525, "link": "https://stackoverflow.com/questions/30216525/running-c-console-application-from-excel-and-wait-for-app-to-finish/30217113#30217113", "title": "running c# console application from excel and wait for app to finish", "body": "<p>You could try this code (inspired from <a href=\"https://stackoverflow.com/questions/8902022/wait-for-shell-to-finish-then-format-cells\">this post</a>):</p>\n\n<pre><code>Dim id As Integer\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 1\n\nid = wsh.Run(\"\"\"C:\\MyFolder\\bin\\Debug\\MyApp.exe\"\" /PARA1 \" &amp; p1 &amp; \" /PARA2 \" &amp; p2, windowStyle, waitOnReturn)\n</code></pre>\n"}], "owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1320, "favorite_count": 0, "accepted_answer_id": 30217113, "answer_count": 1, "score": 0, "last_activity_date": 1432915184, "creation_date": 1431524146, "last_edit_date": 1432915184, "question_id": 30216525, "link": "https://stackoverflow.com/questions/30216525/running-c-console-application-from-excel-and-wait-for-app-to-finish", "title": "running c# console application from excel and wait for app to finish", "body": "<p>I am running a c# console application from within Excel using the line of code below. The code is working fine. The process takes about 20 seconds to run. I was wondering how I get my vba code to wait for the c# application to finish before continuing execution of the code following this line?</p>\n\n<p>I do not want to use a pause or similar function.</p>\n\n<pre><code> Dim id As Integer\n id=Shell(\"\"\"C:\\MyFolder\\bin\\Debug\\MyApp.exe\"\" /PARA1 \" &amp; p1 &amp; \" /PARA2 \" &amp; p2, vbNormalFocus)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1431522103, "post_id": 30215445, "comment_id": 48535094, "body": "That code doesn&#39;t create hyperlinks at all, so you can&#39;t use TextToDisplay. You could remove that field from the pivot altogether and use a lookup from the <code>Invoice Number</code> field to find the path to use as the address."}, {"owner": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431526199, "post_id": 30215445, "comment_id": 48538484, "body": "The challenge for is to keep the Pivot table. Cannot make any alterations here as it is the back end to a Report."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431527155, "post_id": 30215445, "comment_id": 48539347, "body": "You&#39;d have to apply a custom number format to each cell in the hyperlink field range that formats it to display the Invoice number to the left, probably using the PivotTableUpdate event."}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "edited": false, "score": 0, "creation_date": 1431582511, "post_id": 30217833, "comment_id": 48563393, "body": "I have no idea what the relevance of that comment is?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "edited": false, "score": 0, "creation_date": 1432805849, "post_id": 30217833, "comment_id": 49081168, "body": "It worked for me with a pivot table set up to resemble the picture you posted. I can&#39;t comment as to why it doesn&#39;t work for you without knowing what you actually did and what your pivot table looks like."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "edited": false, "score": 0, "creation_date": 1432817938, "post_id": 30217833, "comment_id": 49090105, "body": "I don&#39;t have it any more - it was just a temporary testing file. It would be simpler for you to post a file somewhere (e.g. OneDrive or Dropbox)."}, {"owner": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "edited": false, "score": 0, "creation_date": 1433081941, "post_id": 30217833, "comment_id": 49188432, "body": "The file is a simple version of the extended file that I have."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "edited": false, "score": 0, "creation_date": 1433329365, "post_id": 30217833, "comment_id": 49302494, "body": "The code in the Worksheet code module needs to refer to <code>PivotTables(1) not </code>PivotTables(2)` as there&#39;s only one pivot table."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1431527262, "creation_date": 1431527262, "answer_id": 30217833, "question_id": 30215445, "link": "https://stackoverflow.com/questions/30215445/pivot-table-hyperlinks-text-to-display/30217833#30217833", "title": "Pivot table hyperlinks &amp; Text to display", "body": "<p>Here is an example of the code to override the format of the Hyperlink column:</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n    Dim cell As Range\n    For Each cell In ActiveSheet.PivotTables(1).RowFields(\"Hyperlink\").DataRange.Cells\n        cell.NumberFormat = \";;;\"\"\" &amp; cell.PivotCell.PivotRowLine.PivotLineCells.Item(cell.PivotField.Position - 1).Range.Value &amp; \"\"\"\"\n    Next cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4398364, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0532d0d102d947dcf649ff139ddd23a5?s=128&d=identicon&r=PG&f=1", "display_name": "SKP", "link": "https://stackoverflow.com/users/4398364/skp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2806, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1431527262, "creation_date": 1431521728, "question_id": 30215445, "link": "https://stackoverflow.com/questions/30215445/pivot-table-hyperlinks-text-to-display", "title": "Pivot table hyperlinks &amp; Text to display", "body": "<p>I am using excel 2013. Need help in adding Text to display inside pivot table using Excel VBA. ?</p>\n\n<p><img src=\"https://i.stack.imgur.com/yzZAo.png\" alt=\"Pivot table screenshot\"></p>\n\n<p>So in the above pivot table the [HyperLink] should display [Invoice Num] but not the complete hyperlink address, maybe using \"text to display\"???</p>\n\n<p>I am using VBA to create hyperlinks in pivot tables using the following code :</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Cells.Count = 1 Then\n        On Error Resume Next\n        ActiveWorkbook.FollowHyperlink _\n            Address:=CStr(Target.Value), _\n            NewWindow:=True\n        On Error GoTo 0\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1431521786, "post_id": 30215382, "comment_id": 48534843, "body": "You can&#39;t use <code>L1</code> etc as both a field alias and a table alias..."}, {"owner": {"reputation": 59, "user_id": 4895773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d676a75497a8bd6532efe67c6911d4db?s=128&d=identicon&r=PG&f=1", "display_name": "MIREK", "link": "https://stackoverflow.com/users/4895773/mirek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431522317, "post_id": 30215382, "comment_id": 48535268, "body": "Hi, I have changed the column names like: SELECT L1.[DEU1$].[Supervisor ID] AS N0, L1.[DEU1$].[Emplid] AS N1 and so on but still the same error mesage"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431522409, "post_id": 30215382, "comment_id": 48535352, "body": "Please update the code in the question with what you now have."}, {"owner": {"reputation": 59, "user_id": 4895773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d676a75497a8bd6532efe67c6911d4db?s=128&d=identicon&r=PG&f=1", "display_name": "MIREK", "link": "https://stackoverflow.com/users/4895773/mirek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431522584, "post_id": 30215382, "comment_id": 48535504, "body": "I have updated the query"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 3, "creation_date": 1431524219, "post_id": 30215382, "comment_id": 48536844, "body": "<a href=\"http://stackoverflow.com/search?q=missing+operator+in+query+expression+vba\">Possible duplicate of 18 different questions</a>."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1431526012, "creation_date": 1431526012, "answer_id": 30217319, "question_id": 30215382, "link": "https://stackoverflow.com/questions/30215382/syntax-error-missing-operator-in-query-expression-vba/30217319#30217319", "title": "Syntax error (missing operator) in query expression VBA", "body": "<p>I think you just need to add some parentheses as well as not using both the alias name and the actual table name:</p>\n\n<pre><code>query = \"SELECT L1.[Supervisor ID] AS N0, L1.[Emplid] AS N1, L2.[Emplid] AS N2, L3.[Emplid] AS N3, \" &amp; _\n        \"L4.[Emplid] AS N4, L5.[Emplid] AS N5, L6.[Emplid] AS N6, L7.[Emplid] AS N7 FROM ((((([DEU1$] L1 \" &amp; _\n        \"LEFT JOIN [DEU1$] L2 ON L1.[Emplid] = L2.[Supervisor ID]) \" &amp; _\n        \"LEFT JOIN [DEU1$] L3 ON L2.[Emplid] = L3.[Supervisor ID]) \" &amp; _\n        \"LEFT JOIN [DEU1$] L4 ON L3.[Emplid] = L4.[Supervisor ID]) \" &amp; _\n        \"LEFT JOIN [DEU1$] L5 ON L4.[Emplid] = L5.[Supervisor ID]) \" &amp; _\n        \"LEFT JOIN [DEU1$] L6 ON L5.[Emplid] = L6.[Supervisor ID]) \" &amp; _\n        \"LEFT JOIN [DEU1$] L7 ON L6.[Emplid]=L7.[Supervisor ID];\"\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 4895773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d676a75497a8bd6532efe67c6911d4db?s=128&d=identicon&r=PG&f=1", "display_name": "MIREK", "link": "https://stackoverflow.com/users/4895773/mirek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 30217319, "answer_count": 1, "score": 0, "last_activity_date": 1488818816, "creation_date": 1431521569, "last_edit_date": 1488818816, "question_id": 30215382, "link": "https://stackoverflow.com/questions/30215382/syntax-error-missing-operator-in-query-expression-vba", "title": "Syntax error (missing operator) in query expression VBA", "body": "<p>I'm getting an error message when I want to run my query (syntax error (missing operator) in query expression). I don't know where the issue can be.</p>\n\n<p>I have created a macro (VBA) which should show all manager level in my company.</p>\n\n<p>The columns should be like this:</p>\n\n<blockquote>\n  <p>Top manager, directors, managers, team leaders, supervisors, employees.</p>\n</blockquote>\n\n<pre><code>Sub TEST()\n    Application.ScreenUpdating = False\n\n    Dim cnStr                 As String\n    Dim rs                    As ADODB.Recordset\n    Dim query                 As String\n    Dim fileName              As String\n    pom4 = \"';\"\n\n    fileName = \"C:\\sciezka\\DEU.xlsx\"\n\n    cnStr = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n            \"Data Source=\" &amp; fileName &amp; \";\" &amp; _\n            \"Extended Properties=Excel 12.0\"\n\n\n    query = \"SELECT L1.[DEU1$].[Supervisor ID] AS N0, L1.[DEU1$].[Emplid] AS N1, L2.[DEU1$].[Emplid] AS N2, L3.[DEU1$].[Emplid] AS N3, \" &amp; _\n            \"L4.[DEU1$].[Emplid] AS N4, L5.[DEU1$].[Emplid] AS N5, L6.[DEU1$].[Emplid] AS N6, L7.[DEU1$].[Emplid] AS N7 FROM [DEU1$] L1 \" &amp; _\n            \"LEFT JOIN [DEU1$] L2 ON (L1.[Emplid]=L2.[Supervisor ID]) LEFT JOIN [DEU1$] L3 ON (L2.[Emplid]=L3.[Supervisor ID]) \" &amp; _\n            \"LEFT JOIN [DEU1$] L4 ON (L3.[Emplid]=L4.[Supervisor ID]) LEFT JOIN [DEU1$] L5 ON (L4.[Emplid]=L5.[Supervisor ID]) \" &amp; _\n            \"LEFT JOIN [DEU1$] L6 ON (L5.[Emplid]=L6.[Supervisor ID]) LEFT JOIN [DEU1$] L7 ON (L6.[Emplid]=L7.[Supervisor ID]) WHERE L1.[Supervisor ID] LIKE '%15981%';\"\n\n    Set rs = New ADODB.Recordset\n\n    rs.Open query, cnStr, adOpenUnspecified, adLockUnspecified\n\n    Cells.Clear\n\n    Dim cell As Range, i      As Long\n\n    With Range(\"A16\").CurrentRegion\n        For i = 0 To rs.Fields.Count - 1\n            .Cells(1, i + 1).Value = rs.Fields(i).Name\n        Next i\n        Range(\"A17\").CopyFromRecordset rs\n        .Cells.Select\n        .EntireColumn.AutoFit\n    End With\n\n    rs.Close\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "textbox", "formatting", "ms-word"], "comments": [{"owner": {"reputation": 11, "user_id": 4443021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6fc45cbe4128ea814a5400264776e2?s=128&d=identicon&r=PG&f=1", "display_name": "user4443021", "link": "https://stackoverflow.com/users/4443021/user4443021"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1431552290, "post_id": 30214629, "comment_id": 48554771, "body": "In short, I&#39;ve tried other trial-and-error (i.e. binary search) strategies that instead of cutting and pasting involve resizing exisitng textboxes, but those methods proved to be WAY too slow.  I&#39;d like to try what I&#39;m describing above, but I do not know how to do these 3 steps: 1) iterate through the words of a textbox, 2) cut out the word out of the textbox, 3) append it to a different textbox."}], "owner": {"reputation": 11, "user_id": 4443021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd6fc45cbe4128ea814a5400264776e2?s=128&d=identicon&r=PG&f=1", "display_name": "user4443021", "link": "https://stackoverflow.com/users/4443021/user4443021"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1432915471, "creation_date": 1431519723, "last_edit_date": 1432915471, "question_id": 30214629, "link": "https://stackoverflow.com/questions/30214629/traversing-word-by-word-in-vba-through-the-contents-of-a-word-textbox", "title": "Traversing word-by-word in VBA through the contents of a Word textbox", "body": "<p>Given a Microsoft Word textbox filled with formatted text, how do I use VBA to:</p>\n\n<ol>\n<li>Iterate through the textbox content, word-by-word</li>\n<li>At each iteration, copy/cut out that one word (including its formatting) out of the text box</li>\n<li>Append (i.e. paste) that cut formatted word into the end of a second Microsoft Word textbox</li>\n</ol>\n\n<p><em>[My situation is as follows: I have multiple continuous related texts (i.e. text + footnotes + a second set of footnotes, etc.), and my goal is to programatically lay all of that out in Word text boxes on pages of a Microsoft Word document.</em></p>\n\n<p><em>I will set up the second box (that one that the words are being pasted into) to be auto-sizing, and I will then stop the \"cut-paste\" process once the second box gets to a certain size (which will be programatically determined based on page margins, other textboxes already occupying the page, etc.).]</em></p>\n\n<p>I'm breaking my head over this for weeks with no results! Thanks a LOT to anyone who can send me in the right direction...</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1431520715, "post_id": 30214823, "comment_id": 48534018, "body": "I saw some VBA code on other forms using <code>.Control.Name</code> and <code>.Controls.Name</code>. I didn&#39;t quite get the idea of how it works though. Could it be one of the solutions?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1431525710, "post_id": 30214823, "comment_id": 48538115, "body": "I guess not. But if you (temporarly) set Me!lstBox.ColumnHeads = True   you can retrieve the column heads from row zero:   ColumnHeadN = Me!lstBox.Column(N, 0)"}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1431526215, "post_id": 30214823, "comment_id": 48538507, "body": "That is very helpful indeed, didn&#39;t know about that, thanks! Got it sorted now =)."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1431520229, "creation_date": 1431520229, "answer_id": 30214823, "question_id": 30213168, "link": "https://stackoverflow.com/questions/30213168/selected-listbox-row-columns-referenced-by-listbox-column-head-name-instead-of-c/30214823#30214823", "title": "Selected listBox row columns referenced by listBox column head name instead of column index number", "body": "<p>You don't. Or rather, if you insist, you will first have to create a VBA Collection with the coloumn name as key and the index as value. Then you can do like this:</p>\n\n<pre><code>Me!txtBox1.Value = Me!lstBox.Column(CollectionOfColumns(\"Price\"))\n</code></pre>\n\n<p>Or, if the series of columns is fixed, you can create an Enum and use:</p>\n\n<pre><code>Me!txtBox1.Value = Me!lstBox.Column(EnumOfColumns.Price)\n</code></pre>\n"}], "owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432915344, "creation_date": 1431515603, "last_edit_date": 1432915344, "question_id": 30213168, "link": "https://stackoverflow.com/questions/30213168/selected-listbox-row-columns-referenced-by-listbox-column-head-name-instead-of-c", "title": "Selected listBox row columns referenced by listBox column head name instead of column index number", "body": "<p>How do I do this? I have a quite complex <code>listBox</code>, containing 12 columns in total and want to fill out some <code>textBox</code> fields in my form upon <code>listBox_Click()</code>.</p>\n\n<p>At the moment I do it such that:</p>\n\n<pre><code>With Me\n    .txtBox1 = Me.lstBox.Column(0)\n    .txtBox2 = Me.lstBox.Column(1)\n    .txtBox3 = Me.lstBox.Column(5)\n    .txtBox4 = Me.lstBox.Column(10)\nEnd With\n</code></pre>\n\n<p>However, this can be very confusing when I add/remove a specific column from the <code>listBox</code>. VBA would not let me reference the <code>Column</code> in this way:</p>\n\n<pre><code>Me.txtBox1 = Me.lstBox.Column(\"Price\")\n</code></pre>\n\n<p>Where <code>\"Price\"</code> is basically the <code>Column header</code> that displays in my <code>lstBox</code>.</p>\n"}, {"tags": ["vba", "footer", "ms-word"], "owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1431527007, "creation_date": 1431515557, "last_edit_date": 1431527007, "question_id": 30213151, "link": "https://stackoverflow.com/questions/30213151/vba-word-macro-with-footers-working-different-between-xp-and-windows-7", "title": "VBA Word, Macro with footers working different between XP and Windows 7", "body": "<p>I have some trouble porting a VBA macro Word 2010 from Windows 7 to XP. When I try to access Footers and add text/things, in XP works fine but in XP it does it on header instead.\nThe code doing the thing is </p>\n\n<pre><code>With ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary)\n    .Shapes.AddShape Type:=msoShapeOval, Left:=0, Top:=0, Width:=CentimetersToPoints(1), _\n    Height:=CentimetersToPoints(1), Anchor:=.Range\nEnd With\n</code></pre>\n\n<p>Windows 7 put the circle in the bottom corner, but in XP in the upper corner. Why?</p>\n"}, {"tags": ["vba", "excel", "copy"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1431516127, "post_id": 30213056, "comment_id": 48530658, "body": "Just do <code>sheets(&quot;SHEETNAME&quot;)</code> that will reference the sheet name and then just select the text you want to copy. Just replace <code>sheetname</code> with the name of the sheet"}, {"owner": {"reputation": 1, "user_id": 4895422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e2ca5698c4c0e59e1f24a65857f512?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4895422/andrew"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1431517339, "post_id": 30213056, "comment_id": 48531531, "body": "The sheet name changes, I am copying from Sheets(&quot;CREATE REPORT&quot;) but I am pasting to the active sheet."}, {"owner": {"reputation": 1, "user_id": 4895422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e2ca5698c4c0e59e1f24a65857f512?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4895422/andrew"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1431517720, "post_id": 30213056, "comment_id": 48531814, "body": "This falls over on the last line?  Range(&quot;b8&quot;).Select  Selection.Copy  ActiveWorkbook.Sheets(&quot;AUTHORITIES VISIT&quot;).Copy _        after:=ActiveWorkbook.Sheets(&quot;CREATE REPORT&quot;)          ActiveSheet.Range(&quot;C14&quot;).Select  ActiveSheet.Paste   End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": false, "score": 0, "last_activity_date": 1431518499, "creation_date": 1431518499, "answer_id": 30214202, "question_id": 30213056, "link": "https://stackoverflow.com/questions/30213056/vba-copying-text-from-one-worksheet-to-active-worksheet/30214202#30214202", "title": "VBA Copying text from one worksheet to active worksheet", "body": "<p>You can also have a look at the macro recorder and try it by your own.</p>\n\n<p>This code should work for you:</p>\n\n<pre><code>Sub test()\nSheets(\"AUTHORITIES VISIT\").Copy After:=Sheets(\"CREATE REPORT\")\nActiveSheet.Cells(14, 3).Value = Sheets(\"CREATE REPORT\").Cells(8, 2)\nEnd Sub\n</code></pre>\n\n<p>As I understand from your comments above it copies the sheet \"AUTHORITIES VISIT\" after the sheet \"CREATE REPORT\" and copy from \"CREATE REPORT\" cell \"B8\" into the new sheet cell \"C14\"</p>\n"}], "owner": {"reputation": 1, "user_id": 4895422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89e2ca5698c4c0e59e1f24a65857f512?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4895422/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 450, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432915150, "creation_date": 1431515332, "last_edit_date": 1531164843, "question_id": 30213056, "link": "https://stackoverflow.com/questions/30213056/vba-copying-text-from-one-worksheet-to-active-worksheet", "title": "VBA Copying text from one worksheet to active worksheet", "body": "<p>Sorry for the basic question, but much googling only gave me complicated answers. On the click of a button I am making a copy of another worksheet, I need to copy some text from the first worksheet to this newly created worksheet on the same button click (who's name may differ I.e. sheet1 (1), sheet1 (2). I'm sure it's very simple referencing the active sheet, help appreciated.</p>\n\n<pre><code> Private Sub CommandButton2_Click()\n ActiveWorkbook.Sheets(\"AUTHORITIES VISIT\").Copy _\n after:=ActiveWorkbook.Sheets(\"CREATE REPORT\")\n End Sub \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431515476, "post_id": 30213007, "comment_id": 48530190, "body": "Do you need VBA for This? You could copy the record from the lesser data to a new worksheet and then use Vlookup formula to find what is present in the other file. After that simply filter on <code>#N&#47;A</code> and delete them?"}, {"owner": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431515569, "post_id": 30213007, "comment_id": 48530238, "body": "I do need VBA as I will extend it later on."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431515635, "post_id": 30213007, "comment_id": 48530282, "body": "In that case do the above in VBA. No Need to loop :) THis method is faster. Record a macro and see what do you get."}], "answers": [{"tags": [], "owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "is_accepted": true, "score": 1, "last_activity_date": 1431515875, "last_edit_date": 1431515875, "creation_date": 1431515515, "answer_id": 30213133, "question_id": 30213007, "link": "https://stackoverflow.com/questions/30213007/copy-record-if-it-reoccures-in-another-workbook/30213133#30213133", "title": "Copy record if it reoccures in another workbook", "body": "<p>In an If-clause, to get a logical <code>and</code> you have to use <code>AND</code> in VBA. So replace</p>\n\n<p><code>If sourceSheet1.Cells(i, 1).Value = sourceSheet2.Cells(j, 1).Value &amp; sourceSheet1.Cells(i, 2).Value = sourceSheet2.Cells(j, 2).Value Then</code></p>\n\n<p>with</p>\n\n<p><code>If sourceSheet1.Cells(i, 1).Value = sourceSheet2.Cells(j, 1).Value AND sourceSheet1.Cells(i, 2).Value = sourceSheet2.Cells(j, 2).Value Then</code></p>\n\n<p>There are some operators that are handled differently from high-level languages. Instead of <code>!</code> you use <code>NOT</code>, instead of <code>== null</code> you use <code>Is Nothing</code> and, as you have experienced by now, no semicolons. To extend a line, use <code>_</code>.</p>\n\n<p>The <code>&amp;</code> operator stands for string concatenation by the way.</p>\n"}], "owner": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 30213133, "answer_count": 1, "score": 0, "last_activity_date": 1431515875, "creation_date": 1431515210, "question_id": 30213007, "link": "https://stackoverflow.com/questions/30213007/copy-record-if-it-reoccures-in-another-workbook", "title": "Copy record if it reoccures in another workbook", "body": "<p>I have two Excel workbooks where first has more records than a second one. There are multiple records that occur in both of them but not all of them. I am supposed to take out ones that reoccur in both of those workbooks. As I have never done any VBA much therefore I am writing in a C/C++ way which is not really accurate. Anyways, here is the code:</p>\n\n<pre><code>Sub roznica()\n\nDim sourceSheet1 As Worksheet\nDim sourceSheet2 As Worksheet\nDim destSheet As Worksheet\nDim LastLineSS1 As Integer\nDim LastLineSS2 As Integer\nDim LastLineDS As Integer\nDim i As Integer\nDim j As Integer\n\nSet sourceSheet1 = Workbooks(\"EU-Szczecin.xlsm\").Worksheets(\"Sheet1\")\nSet sourceSheet2 = Workbooks(\"Lista.xlsm\").Worksheets(\"Sheet1\")\nSet destSheet = Workbooks(\"Szczecin-lista.xlsm\").Worksheets(\"Sheet1\")\n\nLastLineSS1 = sourceSheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nLastLineSS2 = sourceSheet2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nLastLineDS = destSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To LastLineSS1\n    For j = 2 To LastLineSS2\n        If sourceSheet1.Cells(i, 1).Value = sourceSheet2.Cells(j, 1).Value &amp; sourceSheet1.Cells(i, 2).Value = sourceSheet2.Cells(j, 2).Value Then\n            destSheet.Cells(i, 1).Value = sourceSheet1.Cells(i, 1).Value\n            destSheet.Cells(i, 2).Value = sourceSheet1.Cells(i, 2).Value\n\n        End If\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>If values on A and B matches then macro should put those into third workbook. I checked if values reoccure and they do so logically program should pass if statement but it does not</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 6335, "user_id": 1261153, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/5KqGB.jpg?s=128&g=1", "display_name": "Adam Ryczkowski", "link": "https://stackoverflow.com/users/1261153/adam-ryczkowski"}, "edited": false, "score": 0, "creation_date": 1431514812, "post_id": 30212787, "comment_id": 48529728, "body": "Works great. Confirmed. I&#39;m so happy I don&#39;t have to play with VBIDE classes!"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 5, "last_activity_date": 1431514555, "creation_date": 1431514555, "answer_id": 30212787, "question_id": 30212679, "link": "https://stackoverflow.com/questions/30212679/get-the-name-of-workbook-that-hosts-the-currently-running-vba-code/30212787#30212787", "title": "Get the name of workbook that hosts the currently running VBA code?", "body": "<blockquote>\n  <p>I want to know the name of the workbook which hosts the currently executing VBA code. </p>\n</blockquote>\n\n<pre><code>Debug.Print ThisWorkbook.Name\n</code></pre>\n"}], "owner": {"reputation": 6335, "user_id": 1261153, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/5KqGB.jpg?s=128&g=1", "display_name": "Adam Ryczkowski", "link": "https://stackoverflow.com/users/1261153/adam-ryczkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2169, "favorite_count": 0, "accepted_answer_id": 30212787, "answer_count": 1, "score": 3, "last_activity_date": 1431514555, "creation_date": 1431514253, "last_edit_date": 1431514533, "question_id": 30212679, "link": "https://stackoverflow.com/questions/30212679/get-the-name-of-workbook-that-hosts-the-currently-running-vba-code", "title": "Get the name of workbook that hosts the currently running VBA code?", "body": "<p>I'll also note, that the <code>Application.Run(\"&lt;workbook name&gt;!&lt;public VBA function name&gt;\")</code> allows jumps of the execution to other workbooks without changing the <code>ActiveWorkbook</code> property.</p>\n\n<p>I want to know the name of the workbook which hosts the currently executing VBA code. </p>\n\n<p>In case if someone did understand me wrong:</p>\n\n<ul>\n<li>The trivial <code>ActiveWorkbook</code> wouldn't do, because the active workbook might be completely different then the one, where the running VBA macro is located.</li>\n<li>The <code>Me</code> object isn't the ticket either. It contains the reference to the class which method is currently executing, regardless of the hosting object (it would work only if my VBA code is in a method of the Worksheet or Workbook class).</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431515198, "post_id": 30212627, "comment_id": 48529993, "body": "This code works for me till the time all existing sheets have some data in it. The reason why I say some data because, <code>.Find</code> will fail if there is no data in the worksheet. I have explained that <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">Here</a> See the use of <code>Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0</code> in that link"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1431515651, "creation_date": 1431515651, "answer_id": 30213180, "question_id": 30212627, "link": "https://stackoverflow.com/questions/30212627/workbook-sheets-add-after-gives-subscript-out-of-range-error-vba/30213180#30213180", "title": "&quot;Workbook.Sheets.Add After&quot; gives &quot;Subscript out of range&quot; error (VBA)", "body": "<p>Change this:</p>\n\n<pre><code>NewBook.Sheets.Add After:=Worksheets(CurrSheet.Index)\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>NewBook.Sheets.Add After:=NewBook.Worksheets(CurrSheet.Index)\n</code></pre>\n\n<p>The only way I can see you getting that error is if the code is in a location (e.g. ThisWorkbook module) where <code>Worksheets(CurrSheet.Index)</code> on its own refers to the workbook with the code and not NewBook. (Aside: it's weird that it works at all really in such cases, but it does until the supplied Index is higher than the number of sheets in the workbook containing the code) In any event, it's better to specify the workbook anyway.</p>\n"}], "owner": {"reputation": 780, "user_id": 3725491, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Pijf2.jpg?s=128&g=1", "display_name": "Amber", "link": "https://stackoverflow.com/users/3725491/amber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1778, "favorite_count": 0, "accepted_answer_id": 30213180, "answer_count": 1, "score": 0, "last_activity_date": 1431515651, "creation_date": 1431514116, "last_edit_date": 1531164843, "question_id": 30212627, "link": "https://stackoverflow.com/questions/30212627/workbook-sheets-add-after-gives-subscript-out-of-range-error-vba", "title": "&quot;Workbook.Sheets.Add After&quot; gives &quot;Subscript out of range&quot; error (VBA)", "body": "<p>I have a workbook with four sheets- <em>First</em>, <em>Second</em>, <em>Third</em> and <em>Fourth</em>. I'm trying to add an extra sheet after each sheet for creating pivot tables. They would be named <em>First Pivot</em>, <em>Second Pivot</em>, <em>Third Pivot</em> and <em>Fourth Pivot</em>.</p>\n\n<p>I'm able to create the <em>First Pivot</em> sheet but I get a <strong><em>Subscript out of range</em></strong> error. The code I'm using is</p>\n\n<pre><code>Function Pivotizer(FilePathAndName As String)\n  On Error GoTo ErrorTeller\n  Dim NewBook As Workbook, CurrSheet, sht As Worksheet, i, FinalCol, ColIndex As Integer, FinalRow As Long\n  Dim pvtCache As PivotCache, pvt As PivotTable, StartPvt, SrcData, KountOf As String\n\n  Set NewBook = Workbooks.Open(FilePathAndName )\n\n\n  For Each CurrSheet In NewBook.Worksheets\n    FinalRow = CurrSheet.Cells.Find(What:=\"*\", After:=CurrSheet.Cells(1, 1), LookIn:=xlFormulas, LookAt:= _\n                xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\n    FinalCol = CurrSheet.Cells(1, CurrSheet.Columns.Count).End(xlToLeft).Column\n\nIf CurrSheet.Name = \"First\" Then\n\n  NewBook.Sheets.Add After:=Worksheets(CurrSheet.Index)\n  NewBook.Sheets(CurrSheet.Index + 1).Name = \"First Pivot\"\n\nElseIf CurrSheet.Name = \"Second\" Then\n  NewBook.Sheets.Add After:=Worksheets(CurrSheet.Index)'&lt;--- This is where I get the error\n  NewBook.Sheets(CurrSheet.Index + 1).Name = \"Second Pivot\"\nEnd If\n  Next\n  Exit Function\nErrorTeller:\n  MsgBox Err.Description\nEnd Function\n</code></pre>\n\n<p>For some reason, the <strong><em>CurrSheet.Index</em></strong> doesn't seem to be working the second time though it represents a valid number (I checked using a MsgBox).</p>\n\n<p>Could someone please tell me what I'm doing wrong?</p>\n"}, {"tags": ["vb.net", "vba", "import", "interop"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4894457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e3db7dbb20f30d9a12fca0e2e168a732?s=128&d=identicon&r=PG&f=1", "display_name": "Dystopic", "link": "https://stackoverflow.com/users/4894457/dystopic"}, "edited": false, "score": 0, "creation_date": 1431554463, "post_id": 30216188, "comment_id": 48555736, "body": "Thanks for the clear explanation! Worked perfectly :)  For some reason I could only access C:\\Windows\\assembly\\GAC from my Chrome browser; that&#39;s where I found my .dlls."}, {"owner": {"reputation": 524, "user_id": 3209268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NnGOh.png?s=128&g=1", "display_name": "metabuddy", "link": "https://stackoverflow.com/users/3209268/metabuddy"}, "edited": false, "score": 1, "creation_date": 1595316718, "post_id": 30216188, "comment_id": 111424432, "body": "Which SDK do I need to install to have this dll?"}, {"owner": {"reputation": 1984, "user_id": 481816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0d64813aef50eccbe84a3278b2270d51?s=128&d=identicon&r=PG", "display_name": "Dude0001", "link": "https://stackoverflow.com/users/481816/dude0001"}, "edited": false, "score": 1, "creation_date": 1614260856, "post_id": 30216188, "comment_id": 117335758, "body": "Microsoft.VisualStudio.Shell.Interop is part of the Visual Studio SDK"}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "reply_to_user": {"reputation": 1984, "user_id": 481816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0d64813aef50eccbe84a3278b2270d51?s=128&d=identicon&r=PG", "display_name": "Dude0001", "link": "https://stackoverflow.com/users/481816/dude0001"}, "edited": false, "score": 0, "creation_date": 1614261291, "post_id": 30216188, "comment_id": 117335993, "body": "@Dude0001 yes, but depends on what framework you&#39;re targeting and SDK version you&#39;re using/installed."}], "tags": [], "owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "is_accepted": true, "score": 0, "last_activity_date": 1614261398, "last_edit_date": 1614261398, "creation_date": 1431523398, "answer_id": 30216188, "question_id": 30212028, "link": "https://stackoverflow.com/questions/30212028/importing-microsoft-visualstudio-shell-interop/30216188#30216188", "title": "Importing Microsoft.VisualStudio.Shell.Interop", "body": "<p>Importing the namespace is just like importing any other namespace. The actuall <code>dll</code> name is: <code>Microsoft.VisualStudio.Shell.Interop</code> which is part of an SDK that you may not have. If you don't have the SDK you will have to get it to get the <code>dll</code> to add as a reference to your project and then import the namespace. Another note: it's also an interface which means you must implement it to get all the functions you need in your class. When you do this you are also required to add reference to <code>Microsoft.VisualStudio.OLE.Interop</code>, you can click on the down arrow in <code>VisualStudio</code> and import the reference.</p>\n<p><strong>Steps To Add the dll...</strong></p>\n<ol>\n<li>First locate the .dll and if you can't find it you need to install the SDK.</li>\n<li>Next AddReference to your project itself adding the .dll.</li>\n<li>You will need to <code>Import</code> the namespace into your class now. For example: <strong>Imports vi = Microsoft.VisualStudio.Shell.Interop</strong></li>\n<li>Inside your class you need to <code>Implement</code> it. For example: <strong>Implements vi.IVsUIShell</strong> and then press <code>Enter</code>. This will then put all functions required including the <code>FindToolWindow </code> and more...</li>\n</ol>\n<p><strong>Here's a quick screenshot of mine. This all worked just fine for me...</strong>\n<img src=\"https://i.stack.imgur.com/sqaks.png\" alt=\"enter image description here\" /></p>\n<p>Mine (the dll) was located under: <code>C:\\Windows\\assembly\\GAC\\</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 4894457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e3db7dbb20f30d9a12fca0e2e168a732?s=128&d=identicon&r=PG&f=1", "display_name": "Dystopic", "link": "https://stackoverflow.com/users/4894457/dystopic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 30216188, "answer_count": 1, "score": 0, "last_activity_date": 1614261398, "creation_date": 1431512539, "last_edit_date": 1431524439, "question_id": 30212028, "link": "https://stackoverflow.com/questions/30212028/importing-microsoft-visualstudio-shell-interop", "title": "Importing Microsoft.VisualStudio.Shell.Interop", "body": "<p>Just wondering how exactly to import this namespace, extensive searching yielded next to no information. The only VB snippet I found was this: <a href=\"http://www.getcodesamples.com/src/B1374D4/E6944922\" rel=\"nofollow\">http://www.getcodesamples.com/src/B1374D4/E6944922</a>\nand it doesn't provide any information on how to import.\nI want to use the iVsUIShell.FindToolWindow\nto get the IVsWindowFrame pointer in order to bring a toolwindow to the front of the z-order in my project.\nAny help would be greatly appreciated! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1431514533, "post_id": 30211843, "comment_id": 48529532, "body": "Create a simple Microsoft query like this: <a href=\"http://stackoverflow.com/questions/30119513/comparing-two-excel-sheets-using-vba/30119739#30119739\" title=\"comparing two excel sheets using vba\">stackoverflow.com/questions/30119513/&hellip;</a> - <code>Join both</code> section. Then simply refresh it when needed"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "edited": false, "score": 0, "creation_date": 1431515595, "post_id": 30212829, "comment_id": 48530255, "body": "I don&#39;t know much about SQL or Microsoft Query. My data has many row for header, is it possible to do that?"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "edited": false, "score": 0, "creation_date": 1431515778, "post_id": 30212829, "comment_id": 48530380, "body": "Just use the SQL above. Yes it is possible this is the most efficient way"}, {"owner": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "edited": false, "score": 0, "creation_date": 1431515875, "post_id": 30212829, "comment_id": 48530445, "body": "There will be many users on this file and I think their skills is not high enough to handle this task daily."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "edited": false, "score": 0, "creation_date": 1431516002, "post_id": 30212829, "comment_id": 48530548, "body": "The query is created once and updated just like a pivot table or you can make a simple refresh button. The users won&#39;t even know if its the macro or the query in the backend"}, {"owner": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "edited": false, "score": 0, "creation_date": 1431516432, "post_id": 30212829, "comment_id": 48530892, "body": "I see... So do you have any information that I can learn more about this. I already tried but can&#39;t figure out how to config it-- for example to set a condition where is the first row of data."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "edited": false, "score": 1, "creation_date": 1431517119, "post_id": 30212829, "comment_id": 48531361, "body": "Sure. Basically the first row is always the header so if you name your columns &quot;A&quot;, &quot;B&quot;, &quot;C&quot; you can reference them simply by the cell value. Here is a quick an easy tutorial <a href=\"http://www.excel-easy.com/examples/microsoft-query.html\" rel=\"nofollow noreferrer\">excel-easy.com/examples/microsoft-query.html</a> Here are the basics on SQL: <a href=\"https://technet.microsoft.com/en-us/library/bb264565%28v=sql.90%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">technet.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "edited": false, "score": 0, "creation_date": 1431525506, "post_id": 30212829, "comment_id": 48537949, "body": "Thank you for your suggestion. I still have a question. If I cannot set the first row to be the header, what should I do? or should I create a new column and add some text to use it for WHERE clause"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "edited": false, "score": 0, "creation_date": 1431527607, "post_id": 30212829, "comment_id": 48539704, "body": "Why can&#39;t you add a row as a header at the top like in your example? I think MS Query assumes the top row is the Header always."}, {"owner": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "edited": false, "score": 0, "creation_date": 1431571606, "post_id": 30212829, "comment_id": 48560438, "body": "OK, I tried to set only first row as header and it works fine on office 2013. But other users in my company still using office 2007 and it not working (no data update on refreshing)"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 2, "last_activity_date": 1431517396, "last_edit_date": 1431517396, "creation_date": 1431514639, "answer_id": 30212829, "question_id": 30211843, "link": "https://stackoverflow.com/questions/30211843/real-time-combine-data-from-multiple-worksheets-into-a-summary-worksheet/30212829#30212829", "title": "Real time combine data from multiple worksheets into a summary worksheet", "body": "<p><strong>Microsoft Query</strong> to the rescue:</p>\n\n<pre><code>SELECT A,B,C FROM [Sheet1$] \nUNION ALL\nSELECT A,B,C FROM [Sheet2$] \n</code></pre>\n\n<p><code>Data-&gt;From Other Sources-&gt;Microsoft Query</code> or feel free to use <a href=\"http://www.analystcave.com/excel-tools/excel-sql-add-in-free/\" rel=\"nofollow\">my Add-In</a>.</p>\n\n<p>Then simply refresh the Query when needed (via 1 line VBA or right-click on the table and click refresh).</p>\n\n<h2>Details</h2>\n\n<p>Assuming that the structure of <code>Sheet1</code> &amp; <code>Sheet2</code> are:</p>\n\n<p>(Input) Data worksheet1 (with row numbers)</p>\n\n<pre><code> 1    |   A   |    B   |   C   |\n 2       Cat      Red     Male\n 3       Dog     Green   Female\n</code></pre>\n\n<p>(Input) Data worksheet2 (with row numbers)</p>\n\n<pre><code> 1    |   A   |    B   |   C   |\n 2     Monkey   Brown    Male\n 3       Ant     Blue     Male\n 4      Bird     White   Female\n</code></pre>\n\n<p><strong>Then:</strong></p>\n\n<ol>\n<li><p>Create a new worksheet (Sheet3)</p></li>\n<li><p>Create the Query with the SQL above.</p></li>\n</ol>\n\n<p>If you want to add a condition add a <code>WHERE</code> clause to one or both of the <code>SELECTs</code></p>\n"}], "owner": {"reputation": 99, "user_id": 3740279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003176926016/picture?type=large", "display_name": "Krsnik195", "link": "https://stackoverflow.com/users/3740279/krsnik195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1058, "favorite_count": 0, "accepted_answer_id": 30212829, "answer_count": 1, "score": 0, "last_activity_date": 1431526925, "creation_date": 1431512080, "last_edit_date": 1431526925, "question_id": 30211843, "link": "https://stackoverflow.com/questions/30211843/real-time-combine-data-from-multiple-worksheets-into-a-summary-worksheet", "title": "Real time combine data from multiple worksheets into a summary worksheet", "body": "<p>I have data in multiple Data worksheets that want to combine into Summary worksheet.\nWhen user update data in any Data worksheet, it will copy information automatically to Summary worksheet.\n<p> For example <p> <b> (Input) Data worksheet1 </b></p>\n\n<pre><code> |   A   |    B   |   C   |\n    Cat      Red     Male\n    Dog     Green   Female\n</code></pre>\n\n<p><b> (Input) Data worksheet2 </b></p>\n\n<pre><code> |   A   |    B   |   C   |\n  Monkey   Brown    Male\n    Ant     Blue     Male\n   Bird     White   Female\n</code></pre>\n\n<p><b> (Output) Summary Worksheet </b></p>\n\n<pre><code> |   A   |    B   |   C   |\n    Cat      Red     Male\n    Dog     Green   Female\n  Monkey    Brown    Male\n    Ant     Blue     Male\n   Bird     White   Female\n</code></pre>\n\n<p>Right now my code running okay with one data worksheet. But when I try to switch to work on another data worksheet, the data on summary worksheet will not correct. It also has some errors when I delete all information or when I change the code (I need to reopen it).</p>\n\n<p>Here is my code <P>\nThisWorkBook</p>\n\n<pre><code>Public Sub Workbook_Open()\n\nSet WB = ThisWorkbook\nSet ActWS = WB.ActiveSheet\nSet MainWS = WB.Worksheets(\"Main\")\n\nActWSPreLastRow = ActWS.Cells(ActWS.Rows.Count, \"A\").End(xlUp).Row\nMainWSPreLastRow = MainWS.Cells(MainWS.Rows.Count, \"A\").End(xlUp).Row\n\nEnd Sub\n</code></pre>\n\n<p>Module</p>\n\n<pre><code>Public WB As Workbook\nPublic ActWS As Worksheet\nPublic MainWS As Worksheet\nPublic ActWSPreLastRow As Long\nPublic ActWSStoredLastRow As Long\nPublic MainWSPreLastRow As Long\nPublic MainWSStoredLastRow As Long\nPublic MainWSEndLastRow As Long\nPublic I As Long\n\nPublic Sub DoCopy()\n\nSet WB = ThisWorkbook\nSet ActWS = WB.ActiveSheet\nSet MainWS = WB.Worksheets(\"Main\")\n\nActWSPreLastRow = ActWS.Cells(ActWS.Rows.Count, \"A\").End(xlUp).Row\nMainWSPreLastRow = MainWS.Cells(MainWS.Rows.Count, \"A\").End(xlUp).Row\n\nI = MainWSStoredLastRow + (ActWSPreLastRow - ActWSStoredLastRow)\n\nMainWS.Range(\"A\" &amp; MainWSStoredLastRow + 1, \"AQ\" &amp; I).Value = _\nActWS.Range(\"A\" &amp; ActWSStoredLastRow + 1, \"AQ\" &amp; ActWSPreLastRow).Value\n\nMainWSPreLastRow = MainWS.Cells(MainWS.Rows.Count, \"A\").End(xlUp).Row\n\nEnd Sub\n\nPublic Sub StoreOld()\nActWSStoredLastRow = ActWSPreLastRow\nMainWSStoredLastRow = MainWSPreLastRow\n\nEnd Sub\n</code></pre>\n\n<p>Other worksheets</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Me.Range(\"A5:AQ1000\")) Is Nothing Then\n    Call StoreOld\n    Call DoCopy\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "combobox", "vba"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 4070471, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f4f63c06ce7dffb35a4ac69cc2003149?s=128&d=identicon&r=PG&f=1", "display_name": "Barkered", "link": "https://stackoverflow.com/users/4070471/barkered"}, "edited": false, "score": 0, "creation_date": 1431510142, "post_id": 30211012, "comment_id": 48526602, "body": "This is exactly what I was after. - Thank you so much."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1431509952, "creation_date": 1431509952, "answer_id": 30211012, "question_id": 30210908, "link": "https://stackoverflow.com/questions/30210908/vba-userform-combobox-select-workbook-sheet/30211012#30211012", "title": "VBA - Userform - Combobox - Select Workbook/Sheet", "body": "<p>That is an incorrect way of working with objects. Is this what you are trying?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   Dim ws As Worksheet\n\n   Set ws = Workbooks(Cb_Wb.Value).Sheets(Cb_Ws.Value)\n\n   ws.Range(\"X77:X84\").Copy\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4070471, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f4f63c06ce7dffb35a4ac69cc2003149?s=128&d=identicon&r=PG&f=1", "display_name": "Barkered", "link": "https://stackoverflow.com/users/4070471/barkered"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2382, "favorite_count": 0, "accepted_answer_id": 30211012, "answer_count": 1, "score": 1, "last_activity_date": 1431509952, "creation_date": 1431509703, "last_edit_date": 1531164843, "question_id": 30210908, "link": "https://stackoverflow.com/questions/30210908/vba-userform-combobox-select-workbook-sheet", "title": "VBA - Userform - Combobox - Select Workbook/Sheet", "body": "<p>I asked another question recently, which helped me get to a certain point with my 'combobox' userform but now need a little more help to get me over the line please.</p>\n\n<p>I've created a userform which has 2 comboboxes, 1 which displays all the open excel workbooks and 1 which displays the worksheets for the selected workbook.</p>\n\n<p>I've tried creating a button that uses the value selected under the worksheet box to copy data from the specified sheet.</p>\n\n<ul>\n<li>The issue I'm having is relating the worksheet combobox (Cb_Ws) value to a VBA command that will 'on click' of the button, select that worksheet and then copy a specific range e.g. Worksheets(\"Cb_Ws.Value\").Range(\"X77:X84\").Copy</li>\n</ul>\n\n<p>I'm afraid my knowledge isn't great as I'm starting out although I think I'm somewhere near the right lines.</p>\n\n<p>Here's the code I've got so far:</p>\n\n<pre><code>Option Explicit\n\nDim wb As Workbook\nDim ws As Worksheet\n\nPrivate Sub Cb_Wb_Change()\nMe.Cb_Ws.Clear\nOn Error Resume Next\nFor Each ws In Workbooks(Me.Cb_Wb.Value).Worksheets\nMe.Cb_Ws.AddItem ws.Name\nNext ws\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n\nDim Worksheets as (Cb_Ws.Value)\n\nWorksheets.Range(\"X77:X84\").Copy\n\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n\nFor Each wb In Application.Workbooks\nMe.Cb_Wb.AddItem wb.Name\nMe.Label2.Caption = \"Select WorkSheet:\"\nMe.Label1.Caption = \"Select Workbook:\"\nNext wb\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1431510714, "post_id": 30210716, "comment_id": 48526985, "body": "The recorded macro brings along several useless lines (such as the several scroll-up at the end). Would you mind cleaning a bit your code?"}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431515765, "post_id": 30212618, "comment_id": 48530372, "body": "You do want the autofill because it&#39;s not just column A that&#39;s being filled down."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431515864, "post_id": 30212618, "comment_id": 48530438, "body": "Can I borrow your Coffee? :P"}, {"owner": {"reputation": 33, "user_id": 3297604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c6da9456e3fddd4b653141c837505a4?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfschmitt", "link": "https://stackoverflow.com/users/3297604/wolfschmitt"}, "edited": false, "score": 0, "creation_date": 1431517438, "post_id": 30212618, "comment_id": 48531606, "body": "What happened now is that all my headers were pulled down until row 6000. It should instead search for header &#39;FCST_ID&#39; and then one cell beneath that header, fill in the formula &quot;=Demand!A2&quot;.   After, the row in which &quot;=Demand!A2&quot; was filled in must be pulled down until row 6000.  Thanks!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431520194, "post_id": 30212618, "comment_id": 48533630, "body": "Made a minor change. Please test it now"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1431520181, "last_edit_date": 1431520181, "creation_date": 1431514090, "answer_id": 30212618, "question_id": 30210716, "link": "https://stackoverflow.com/questions/30210716/restore-formulas-vba-code/30212618#30212618", "title": "Restore formulas VBA code", "body": "<p>Is this what you are trying (<strong>Untested</strong>)? I am assuming the <code>FCST_ID</code> is in Col A.</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim lRow As Long\n    Dim aCell As Range\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    With ws\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            lRow = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n\n            Set aCell = .Cells.Find(What:=\"FCST_ID\", LookIn:=xlValues, _\n                        Lookat:=xlWhole, SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\n            If Not aCell Is Nothing Then\n                aCell.Offset(1).Formula = \"=Demand!A2\"\n\n                .Range(\"A\" &amp; (aCell.Row+1) &amp; \":EU\" &amp; (aCell.Row+1)).AutoFill _\n                Destination:=.Range(\"A\" &amp; (aCell.Row+1) &amp; \":EU\" &amp; lRow), Type:=xlFillDefault\n            End If\n        End If\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3297604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c6da9456e3fddd4b653141c837505a4?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfschmitt", "link": "https://stackoverflow.com/users/3297604/wolfschmitt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "accepted_answer_id": 30212618, "answer_count": 1, "score": 1, "last_activity_date": 1431526809, "creation_date": 1431509188, "last_edit_date": 1531161705, "question_id": 30210716, "link": "https://stackoverflow.com/questions/30210716/restore-formulas-vba-code", "title": "Restore formulas VBA code", "body": "<p>So I have this Issue with making a button in Excel that restores all formulas. The formulas are all based on this one cell, currently <strong><code>A26 (=Demand!A2)</code></strong>. But since the row numbers will change in the future the code is currently not robust enough.</p>\n\n<p>What it needs to do is type into the cell <strong><em>below</em></strong> the 'header' named \"<code>FCST_ID</code>\" the following formula: <strong><code>=Demand!A2</code></strong>. (keep in mind it's not a table) After it should select this whole row, filled with many formulas based on that <strong><code>=Demand!A2</code></strong> cell and pull it completely down until row 6000.</p>\n\n<p>It works when I try to use a macro and select cell <code>A26</code>, however this doesn't make the model robust enough in case this cell would change to <code>A25</code> for example. So what I tried to do now is recording a macro that looks-up the 'header' <code>FCST_ID</code> and then goes one cell lower, fills in the formula and then pulls down all formulas from that row until row 6000.</p>\n\n<p>Would highly appreciate any help!</p>\n\n<pre><code>Cells.Find(What:=\"FCST_ID\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate .Offset(1, 0).Select\nActiveCell.FormulaR1C1 = \"=Demand!R[-24]C\"\nRange(\"A26\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(\"A26:EU26\").Select\nActiveWindow.SmallScroll ToRight:=2\nSelection.AutoFill Destination:=Range(\"A26:EU6000\"), Type:=xlFillDefault\nRange(\"A26:EU6000\").Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 4894959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8utVSn2SlHM/AAAAAAAAAAI/AAAAAAAAADQ/iGPaJbO5wVw/photo.jpg?sz=128", "display_name": "fguy", "link": "https://stackoverflow.com/users/4894959/fguy"}, "edited": false, "score": 0, "creation_date": 1431508656, "post_id": 30210435, "comment_id": 48525493, "body": "i am getting a subscript error... any suggestions??"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 3, "creation_date": 1431508666, "post_id": 30210435, "comment_id": 48525499, "body": "What is not working?"}, {"owner": {"reputation": 1, "user_id": 4894959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8utVSn2SlHM/AAAAAAAAAAI/AAAAAAAAADQ/iGPaJbO5wVw/photo.jpg?sz=128", "display_name": "fguy", "link": "https://stackoverflow.com/users/4894959/fguy"}, "reply_to_user": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1431508704, "post_id": 30210435, "comment_id": 48525533, "body": "i am getting an error msg in the first activate line itself"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1431508735, "post_id": 30210435, "comment_id": 48525569, "body": "So don&#39;t <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Activate</a> it :) Work with the objects"}, {"owner": {"reputation": 1, "user_id": 4894959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8utVSn2SlHM/AAAAAAAAAAI/AAAAAAAAADQ/iGPaJbO5wVw/photo.jpg?sz=128", "display_name": "fguy", "link": "https://stackoverflow.com/users/4894959/fguy"}, "edited": false, "score": 0, "creation_date": 1431508826, "post_id": 30210435, "comment_id": 48525655, "body": "tried using objects too but with no success ... :("}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1431508979, "post_id": 30210435, "comment_id": 48525778, "body": "You are probably referencing something that does not exist. What is <code>ActivateWB</code>? A sub you have written?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431509016, "post_id": 30210435, "comment_id": 48525803, "body": "<code>tried using objects too but with no success</code> Can I see how did you do that?"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1431509018, "post_id": 30210435, "comment_id": 48525806, "body": "I believe you need to open it first before you can use <code>.Activate</code>. Correct syntax is <code>Workbooks(&quot;Bhandup Plan 11.xls&quot;).Activate</code>. What does ActivateWB do?"}, {"owner": {"reputation": 1, "user_id": 4894959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8utVSn2SlHM/AAAAAAAAAAI/AAAAAAAAADQ/iGPaJbO5wVw/photo.jpg?sz=128", "display_name": "fguy", "link": "https://stackoverflow.com/users/4894959/fguy"}, "edited": false, "score": 0, "creation_date": 1431509120, "post_id": 30210435, "comment_id": 48525894, "body": "No, that was a referencing syntax i got while searching for answers... might be wrong ... can u please help me by editing the code ... my workbooks are &quot;Bhandup Plan 11&quot; and &quot;premium solver&quot; .... i need it desperately"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1431509286, "post_id": 30210435, "comment_id": 48526009, "body": "I will help you but you need to act upon my last comment :)"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1431509339, "post_id": 30210435, "comment_id": 48526053, "body": "Just open both Workbooks and delete the <code>ActivateWB</code> line. Run macro."}, {"owner": {"reputation": 1, "user_id": 4894959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8utVSn2SlHM/AAAAAAAAAAI/AAAAAAAAADQ/iGPaJbO5wVw/photo.jpg?sz=128", "display_name": "fguy", "link": "https://stackoverflow.com/users/4894959/fguy"}, "edited": false, "score": 0, "creation_date": 1431509395, "post_id": 30210435, "comment_id": 48526101, "body": "i will have to rewrite the code... :("}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1431509500, "post_id": 30210435, "comment_id": 48526180, "body": "In that case do what @MoritzSchmitzv.H&#252;lst mentioned in the last comment..."}, {"owner": {"reputation": 1, "user_id": 4894959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8utVSn2SlHM/AAAAAAAAAAI/AAAAAAAAADQ/iGPaJbO5wVw/photo.jpg?sz=128", "display_name": "fguy", "link": "https://stackoverflow.com/users/4894959/fguy"}, "edited": false, "score": 0, "creation_date": 1431509610, "post_id": 30210435, "comment_id": 48526253, "body": "how do i tackle with the run time error 9 ??"}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1431509624, "post_id": 30210435, "comment_id": 48526261, "body": "If you want to learn Excel VBA you are going to have to rewrite the code several times to improve it... :)"}, {"owner": {"reputation": 1, "user_id": 4894959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8utVSn2SlHM/AAAAAAAAAAI/AAAAAAAAADQ/iGPaJbO5wVw/photo.jpg?sz=128", "display_name": "fguy", "link": "https://stackoverflow.com/users/4894959/fguy"}, "reply_to_user": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1431509686, "post_id": 30210435, "comment_id": 48526296, "body": "@OlleSj&#246;gren: i know dude but time is what i dont have ... :("}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1431509813, "post_id": 30210435, "comment_id": 48526381, "body": "<code>ActivateWB (&quot;Bhandup Plan 11.xls&quot;)</code> does not belong in the code, the rest of the code appears to look okay, do your spellings for your workbooks and worksheets exactly match what is in your code and are both workbooks open?"}], "answers": [{"comments": [{"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1431510081, "post_id": 30211045, "comment_id": 48526549, "body": "Does it matter where the macro is run from?"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "reply_to_user": {"reputation": 1, "user_id": 4894959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8utVSn2SlHM/AAAAAAAAAAI/AAAAAAAAADQ/iGPaJbO5wVw/photo.jpg?sz=128", "display_name": "fguy", "link": "https://stackoverflow.com/users/4894959/fguy"}, "edited": false, "score": 0, "creation_date": 1431515906, "post_id": 30211045, "comment_id": 48530471, "body": "Glad I could help, you may now choose my answer as accepted answer."}], "tags": [], "owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "is_accepted": false, "score": 1, "last_activity_date": 1431510017, "creation_date": 1431510017, "answer_id": 30211045, "question_id": 30210435, "link": "https://stackoverflow.com/questions/30210435/vba-worksheet-switching/30211045#30211045", "title": "Vba Worksheet Switching", "body": "<p>Open both <code>Workbooks</code>. Edit sub code:</p>\n\n<pre><code>Sub plan()\n    Dim i As Integer\n\n    For i = 4 To 100\n\n        If Workbooks(\"Bhandup Plan 11.xls\").Sheets(\"Sheet1\").Cells(i, 11).Value &gt; 0 _\n        Or Workbooks(\"Bhandup Plan 11.xls\").Sheets(\"Sheet1\").Cells(i, 12).Value &gt; 0 Then\n\n            Workbooks(\"premium solver.xls\").Sheets(\"AHMD\").Cells(i, 1).Value = _\n            Workbooks(\"Bhandup Plan 11.xls\").Sheets(\"Sheet1\").Cells(i, 2).Value\n\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>If you receive this error: <strong>Subscript out of range (Error 9)</strong>, it means that either one of the names you provided is not right or that one of the workbooks isn't opened. So check for spelling, spaces etc. and make sure both workbooks are opened.</p>\n"}], "owner": {"reputation": 1, "user_id": 4894959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8utVSn2SlHM/AAAAAAAAAAI/AAAAAAAAADQ/iGPaJbO5wVw/photo.jpg?sz=128", "display_name": "fguy", "link": "https://stackoverflow.com/users/4894959/fguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431510017, "creation_date": 1431508490, "last_edit_date": 1531161705, "question_id": 30210435, "link": "https://stackoverflow.com/questions/30210435/vba-worksheet-switching", "title": "Vba Worksheet Switching", "body": "<p>I have two workbooks. I need to apply an if else condition on the 2nd workbook and the output of if else should be saved in the cell of 1st workbook using VBA. my code looks like :</p>\n\n<pre><code>Sub plan()\n    Dim i As Integer, wb As Workbook\n\n    For i = 4 To 100\n        ActivateWB (\"Bhandup Plan 11.xls\")\n\n        If Workbooks(\"Bhandup Plan 11.xls\").Sheets(\"Sheet1\").Cells(i, 11).Value &gt; 0 _\n        Or Workbooks(\"Bhandup Plan 11.xls\").Sheets(\"Sheet1\").Cells(i, 12).Value &gt; 0 Then\n\n            Workbooks(\"premium solver.xls\").Sheets(\"AHMD\").Cells(i, 1).Value = _\n            Workbooks(\"Bhandup Plan 11.xls\").Sheets(\"Sheet1\").Cells(i, 2).Value\n\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431508366, "post_id": 30210353, "comment_id": 48525316, "body": "Is your calculation set to Manual?"}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431508749, "post_id": 30210353, "comment_id": 48525588, "body": "I don&#39;t know, I&#39;m very new to vba programming actually, here is the code I use to add the formulas to the cells :        <code>newWorkBook.Worksheets(&quot;Feuil1&quot;).Range(Cells(26, i + 2).Address()).Formula = &quot;=MOYENNE(&quot; + Cells(16, i + 2).Address() + &quot;:&quot; + Cells(25, i + 2).Address() + &quot;)&quot;</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431508944, "post_id": 30210353, "comment_id": 48525747, "body": "Under <code>Formulas</code> tab, check in the <code>Calculation Options</code> drop down. Which one is  ticked? Alternatively, at the end of your code you can also use this <code>Application.Calculation = xlCalculationAutomatic</code>"}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431509743, "post_id": 30210353, "comment_id": 48526333, "body": "It is set to automatic"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431509763, "post_id": 30210353, "comment_id": 48526342, "body": "Then try and do what @Rory suggested in his post below."}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431510314, "post_id": 30210748, "comment_id": 48526700, "body": "++ Lol... Good Catch :P"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431510482, "post_id": 30210748, "comment_id": 48526820, "body": "@SiddharthRout Thanks - obviously the coffee has done its job this morning. :)"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1431509302, "creation_date": 1431509302, "answer_id": 30210748, "question_id": 30210353, "link": "https://stackoverflow.com/questions/30210353/average-value-is-not-displayed-automatically-when-values-added/30210748#30210748", "title": "Average value is not displayed automatically when values added", "body": "<p>Change <code>MOYENNE</code> to <code>AVERAGE</code> - the <code>.Formula</code> property expects US English formulas. You could also use <code>.FormulaLocal</code> if you prefer to use the function names as you would enter them.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4895119, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NzRGMuiqSA4/AAAAAAAAAAI/AAAAAAAAHSA/AM8REu8vIAg/photo.jpg?sz=128", "display_name": "Leons Jose", "link": "https://stackoverflow.com/users/4895119/leons-jose"}, "is_accepted": false, "score": 0, "last_activity_date": 1431511003, "creation_date": 1431511003, "answer_id": 30211406, "question_id": 30210353, "link": "https://stackoverflow.com/questions/30210353/average-value-is-not-displayed-automatically-when-values-added/30211406#30211406", "title": "Average value is not displayed automatically when values added", "body": "<p>Yea, what Siddharth Rout said is right\nmake calculation automatic by the code Application.Calculation = xlCalculationAutomatic</p>\n"}], "owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 30210748, "answer_count": 2, "score": 0, "last_activity_date": 1431511003, "creation_date": 1431508252, "question_id": 30210353, "link": "https://stackoverflow.com/questions/30210353/average-value-is-not-displayed-automatically-when-values-added", "title": "Average value is not displayed automatically when values added", "body": "<p>I programmatically create new Excel worksheet and add a formula calculating the average value of a certain range of values in a specific cell. However when I open this newly created worksheet, I don't automatically see the average value displayed when I type in my values on by one and I have to double click on the cell containing the average formula to display it's value, how can I solve this issue ?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "reply_to_user": {"reputation": 15, "user_id": 4891315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f186070bc71a3543e920474c0603bfe?s=128&d=identicon&r=PG&f=1", "display_name": "dantej", "link": "https://stackoverflow.com/users/4891315/dantej"}, "edited": false, "score": 0, "creation_date": 1431506097, "post_id": 30209575, "comment_id": 48523763, "body": "Pleased to help - If this answers your question, please mark my answer as such!"}], "tags": [], "owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "is_accepted": false, "score": 0, "last_activity_date": 1431505785, "creation_date": 1431505785, "answer_id": 30209575, "question_id": 30209450, "link": "https://stackoverflow.com/questions/30209450/what-does-the-to-operator-do-in-visual-basic-and-could-somebody-please-explain/30209575#30209575", "title": "What does the To operator do in Visual Basic and, could somebody please explain the following code to me?", "body": "<p>It sets the limit for your loop.\nThe code:</p>\n\n<pre><code>For dCtr = 2 To inVoer\n...\nnext\n</code></pre>\n\n<p>will count your variable <code>dCtr</code> from 2 (included) up to the value of <code>inVoer</code> (also included) in steps of <code>1</code>.\nFor more options and informations see: <a href=\"https://msdn.microsoft.com/en-us/library/5z06z1kb.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/5z06z1kb.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1431510433, "post_id": 30209601, "comment_id": 48526784, "body": "This answer was posted before the OP turned their question <a href=\"http://stackoverflow.com/posts/30209450/revisions\">into two</a>."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 7, "last_activity_date": 1431506568, "last_edit_date": 1431506568, "creation_date": 1431505858, "answer_id": 30209601, "question_id": 30209450, "link": "https://stackoverflow.com/questions/30209450/what-does-the-to-operator-do-in-visual-basic-and-could-somebody-please-explain/30209601#30209601", "title": "What does the To operator do in Visual Basic and, could somebody please explain the following code to me?", "body": "<p>There is no <code>To</code> operator in Visual Basic.</p>\n\n<p>There is <code>For</code> operator, where according to the syntax you separate the lower bound from the upper bound with <code>To</code>.</p>\n\n<p>While not an operator, <code>To</code> <em>is</em> a <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264568.aspx#sectionSection73\" rel=\"nofollow\">reserved word</a>. You cannot e.g. declare a variable named <code>To</code>.<br>\nThe other places where <code>To</code> is used are declaring arrays specifying both lower and upper bounds:</p>\n\n<pre><code>Dim arr(1 To 10) As Long\n</code></pre>\n\n<p>and specifying a range match in a <code>Select Case</code>:</p>\n\n<pre><code>Select Case i\n    Case 1 To 10\n    ...\n    Case Else\n    ...\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4891315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f186070bc71a3543e920474c0603bfe?s=128&d=identicon&r=PG&f=1", "display_name": "dantej", "link": "https://stackoverflow.com/users/4891315/dantej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 30209601, "answer_count": 2, "score": 0, "last_activity_date": 1432919138, "creation_date": 1431505433, "last_edit_date": 1432919138, "question_id": 30209450, "link": "https://stackoverflow.com/questions/30209450/what-does-the-to-operator-do-in-visual-basic-and-could-somebody-please-explain", "title": "What does the To operator do in Visual Basic and, could somebody please explain the following code to me?", "body": "<p>Just a quick question.</p>\n\n<p>What does the to operator do in Visual Basic?</p>\n\n<p>For example:</p>\n\n<pre><code>For dCtr = 2 To inVoer\n</code></pre>\n\n<p>also could someone explain the following code for me?</p>\n\n<pre><code>rCtr = 2\n    For dCtr = 2 To inVoer\n    If (dCtr - 1 &lt;= 6) And (inVoer - dCtr + 1) &lt;= 6 Then\n    Range(\"A\" &amp; rCtr + 1) = dCtr - 1\n    Range(\"B\" &amp; rCtr + 1) = inVoer - dCtr + 1\n    rCtr = rCtr + 1\n\n\nEnd If\n    Next\n</code></pre>\n"}, {"tags": ["xml", "excel", "onenote", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 4894443, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1TxY1t20MAM/AAAAAAAAAAI/AAAAAAAABbg/EC5VYpVY1bw/photo.jpg?sz=128", "display_name": "Ray", "link": "https://stackoverflow.com/users/4894443/ray"}, "edited": false, "score": 0, "creation_date": 1431527743, "post_id": 30209381, "comment_id": 48539837, "body": "Ok, finally i found a solution by using the split function with the delimiter &quot;{26}&quot;:         Debug.Print Split(Split(Split(Split(CreateObject(&quot;scripting.filesystemob&zwnj;&#8203;ject&quot;).opentextfile(&zwnj;&#8203;path).readall, _             &quot;{26}{B0}&quot;)(1), &quot;&lt;/one:Table&quot;)(0), &quot;[CDATA[&quot;)(1), &quot;]&quot;)(0)"}], "owner": {"reputation": 11, "user_id": 4894443, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1TxY1t20MAM/AAAAAAAAAAI/AAAAAAAABbg/EC5VYpVY1bw/photo.jpg?sz=128", "display_name": "Ray", "link": "https://stackoverflow.com/users/4894443/ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 817, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1431505242, "creation_date": 1431505242, "last_edit_date": 1531164843, "question_id": 30209381, "link": "https://stackoverflow.com/questions/30209381/extracting-special-content-from-a-onenote-page-to-an-excel-sheet", "title": "Extracting special content from a Onenote page to an excel sheet", "body": "<p>I please need some help regarding extraction of special infos of a OneNote 2010 page. My aim is to get the content of the tables in Onenote and put it into an excel sheet to get a quick and updated overview of different peoples' notes (by activating the macro).\nIn VBA i used nodes of 'IXMLDOMNodeList' to get its hierarchy:</p>\n\n<pre><code>Dim PageNodes As MSXML2.IXMLDOMNodeList\nDim PageNode As MSXML2.IXMLDOMNode\nSet PageNodes = doc.DocumentElement.SelectNodes(\"//one:Page\")\n</code></pre>\n\n<p>I than use a loop to get the content of every page </p>\n\n<pre><code>For Each PageNode In PageNodes\n    ...    \n    GetAttributeValueFromPageNode = PageNode.Attributes.getNamedItem(\"ID\").Text\n</code></pre>\n\n<p>So far so good, but how can i limit the output of the content to a specific cell of a table?</p>\n\n<p>The xml-block for one cell looks like:</p>\n\n<pre><code>&lt;one:Cell lastModifiedTime=\"2015-05-12T14:46:23.000Z\" objectID=\"{2C35AF52-393D-4E4E-8431-E7E189A2E6A1}{25}{B0}\" lastModifiedByInitials=\"xxxxxx\"&gt;&lt;one:OEChildren&gt;&lt;one:OE creationTime=\"2015-05-12T14:46:23.000Z\" lastModifiedTime=\"2015-05-12T14:46:23.000Z\" objectID=\"{2C35AF52-393D-4E4E-8431-E7E189A2E6A1}{26}{B0}\" alignment=\"right\" quickStyleIndex=\"1\" style=\"font-family:Calibri;font-size:14.0pt;text-align:right\"&gt;&lt;one:T&gt;&lt;![CDATA[Max Mustermann]]&gt;&lt;/one:T&gt;&lt;/one:OE&gt;&lt;/one:OEChildren&gt;&lt;/one:Cell&gt;\n</code></pre>\n\n<p>The specific info in this case (\"Max Mustermann\") is embraced by CDATA[].</p>\n\n<p>My ideas and trys have been:</p>\n\n<ul>\n<li>try to find and select \"childnodes\" of '//one:Page' (unfortunately page nodes have no childnodes)</li>\n<li>try to point to the 'object-ID' (but this changes everytime the onenote user creates a new site). I noticed that the last 2 brackets of the 'object-ID' remain constant.</li>\n<li>How can i parse this info out of the xml? (perhaps using wildcards for the object-iD?)</li>\n</ul>\n\n<p>Every hint will be appreciated.\nThank you very much in advance, Ray</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1431515372, "post_id": 30209182, "comment_id": 48530116, "body": "Don&#39;t forgot to check the <code>EOF</code> before <code>RecordSt.MoveFirst</code> And you can use <code>stringSQL = &quot;SELECT TOP(1) [Client_Data].[lastname] FROM Client_Data &quot; &amp; varWhere &amp; &quot; ORDER BY [Client_Data].[lastname];&quot;</code> to have only one effected row with your custom sort order ;)."}, {"owner": {"reputation": 52, "user_id": 4882134, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/353115f337f7370affdaf2067885db45?s=128&d=identicon&r=PG&f=1", "display_name": "endeavour", "link": "https://stackoverflow.com/users/4882134/endeavour"}, "reply_to_user": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1431519927, "post_id": 30209182, "comment_id": 48533420, "body": "@shA.t I think it is a good idea to use <code>TOP</code>. Made appropriate changes in the question.  I think it will be <code>TOP 1</code> and not <code>TOP(1)</code> However for the main problem, looping through each combobox could be a lot of work. I have 7 combo boxes and need to do this for each of them. Is there no other way."}, {"owner": {"reputation": 52, "user_id": 4882134, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/353115f337f7370affdaf2067885db45?s=128&d=identicon&r=PG&f=1", "display_name": "endeavour", "link": "https://stackoverflow.com/users/4882134/endeavour"}, "reply_to_user": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1431524644, "post_id": 30209182, "comment_id": 48537231, "body": "@shA.t I found the problem. This is the solution:My <code>RowSource</code> Query was selecting two fields - <code>[Client_Data].[clientid]</code>, <code>[Client_Data].[lastname]</code> So the values of each index in the <code>ComboBox</code> was not the <code>lastname</code> but <code>clientid</code> instead. Changed <code>Me.lastname_cmbo.Value = varLname</code> to <code>Me.lastname_cmbo.Value = varClientID</code> - Added this as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 52, "user_id": 4882134, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/353115f337f7370affdaf2067885db45?s=128&d=identicon&r=PG&f=1", "display_name": "endeavour", "link": "https://stackoverflow.com/users/4882134/endeavour"}, "is_accepted": true, "score": 0, "last_activity_date": 1431524453, "creation_date": 1431524453, "answer_id": 30216660, "question_id": 30209182, "link": "https://stackoverflow.com/questions/30209182/setting-showing-me-combox-value-and-me-combobox-rowsource-properties-in-vba/30216660#30216660", "title": "Setting showing Me.ComBox.Value and Me.ComboBox.RowSource properties in VBA", "body": "<p>Looks like I found the problem.<br />\nMy <code>RowSource</code> lines goes like this</p>\n\n<pre>\nMe.lastname_cmbo.RowSource = \"SELECT [Client_Data].[clientid], [Client_Data].[lastname] FROM Client_Data \" & strWhere & \";\"\n</pre>\n\n<p>Now that means access is using the <code>[Client_Data].[clientid]</code> field as the value for each element in the <code>ComboBox</code> <br /></p>\n\n<p>Replaced<pre>Me.lastname_cmbo.Value = varLname</pre>\nwith</p>\n\n<pre>Me.lastname_cmbo.Value = varClientID</pre>\n\n<p>Now it works as expected.</p>\n"}], "owner": {"reputation": 52, "user_id": 4882134, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/353115f337f7370affdaf2067885db45?s=128&d=identicon&r=PG&f=1", "display_name": "endeavour", "link": "https://stackoverflow.com/users/4882134/endeavour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1305, "favorite_count": 0, "accepted_answer_id": 30216660, "answer_count": 1, "score": 1, "last_activity_date": 1594644668, "creation_date": 1431504673, "last_edit_date": 1594644668, "question_id": 30209182, "link": "https://stackoverflow.com/questions/30209182/setting-showing-me-combox-value-and-me-combobox-rowsource-properties-in-vba", "title": "Setting showing Me.ComBox.Value and Me.ComboBox.RowSource properties in VBA", "body": "<p>I am trying to create a search form in Microsoft Access. The search form is going to lookup values from a client table.<br>\nI have the following code in <code>OnUpdate</code> event of a ComboBox and it is set to automatically update Form Data AfterUpdate.</p>\n\n<pre><code>Private Sub firstname_combo_Change()\nDim stringSQL As String\nDim RecordSt As Recordset\nDim dBase As Database\nDim strWhere As String\nDim varLname As Variant\nDim varClientID As Database\nIf Not IsNull(Me.firstname_combo.Column(1)) Then\n    strWhere = \"WHERE [Client_Data].[firstname]='\" &amp; Me.firstname_combo.Column(1) &amp; \"'\"\n    Me.lastname_cmbo.RowSource = \"SELECT [Client_Data].[clientid], [Client_Data].[lastname] FROM Client_Data \" &amp; strWhere &amp; \";\"\n    stringSQL = \"SELECT TOP 1 [Client_Data].[lastname] FROM Client_Data \" &amp; varWhere &amp; \" ORDER BY [Client_Data].[lastname];\"\n    Set RecordSt = CurrentDb.OpenRecordset(stringSQL)\n    RecordSt.MoveFirst\n        'PLease note there would be multiple rows in the recordset but I need to select only the first row. However, varLname is populated correctly\n    varClientID  = RecordSt.Fields(\"cleintid\").Value\n    varLname  = RecordSt.Fields(\"lastname\").Value\n    Me.lastname_cmbo.Value = varLname\n         'MsgBox (varLname)\nEnd If\nEnd Sub\n</code></pre>\n\n<p>What I am trying to do here is this:</p>\n\n<ol>\n<li><p><code>OnChange</code> of <code>firstname</code>, VBA will look for all <code>lastnames</code> matching the <code>firstname</code> and show that as available options in the <code>lastname</code> fields.</p></li>\n<li><p>Take the first row from the <code>RecordSet</code> and populate the <code>lastname_combo.value</code> to it.</p></li>\n</ol>\n\n<p>Access currently sets the <code>RowSource</code> property correctly but refuses to populate the control's <code>.Value</code> property. So I get a blank <code>lastname</code> in ComboBox (with the correct RowSource).\nDo note that each ComboBox has been set to \"Find a record on my From based on the value selected in my combo box\".</p>\n"}, {"tags": ["excel", "vba", "foreach", "split", "str-replace"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431503580, "post_id": 30208601, "comment_id": 48522197, "body": "Why not simply use <code>Text To Columns</code>? VBA is not required. And if you still want VBA then record a macro for  <code>Text To Columns</code>"}, {"owner": {"reputation": 97, "user_id": 3114375, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a02b7c44f8f68bfc2ff3bd9114153624?s=128&d=identicon&r=PG&f=1", "display_name": "user3114375", "link": "https://stackoverflow.com/users/3114375/user3114375"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431504437, "post_id": 30208601, "comment_id": 48522706, "body": "I would like to replace split values in the B column. For example in column A: &quot;a;b;c;&quot;\tcolumn B: &quot;text a text2 b text2   c&quot; , and in column B I would like replace values like a,b,c on empty values."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431504606, "post_id": 30208601, "comment_id": 48522804, "body": "so you want to remove the split values from col B?"}, {"owner": {"reputation": 97, "user_id": 3114375, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a02b7c44f8f68bfc2ff3bd9114153624?s=128&d=identicon&r=PG&f=1", "display_name": "user3114375", "link": "https://stackoverflow.com/users/3114375/user3114375"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431504806, "post_id": 30208601, "comment_id": 48522917, "body": "yes, I want remove te split values from column B and this split value are in column A separated by semicolon"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431505434, "post_id": 30208601, "comment_id": 48523316, "body": "Ok. I have posted an answer. You may have to refresh the page to see it. Hope this is what you want?"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1431505193, "creation_date": 1431505193, "answer_id": 30209364, "question_id": 30208601, "link": "https://stackoverflow.com/questions/30208601/loop-through-split-value-cells-and-replace/30209364#30209364", "title": "Loop through split value cells and replace", "body": "<p>Is this what you are trying? Note you do not need to select the complete column. Simply find the last row and work with that range only :)</p>\n\n<p>I have commented the code so you should not have a problem understanding it. But if you do then simply post back.</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim aCell As Range, rng As Range\n    Dim Lrow As Long, i As Long\n    Dim MyAr\n\n    '~~&gt; Change this to the relevant worksheet\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    With ws\n        '~~&gt; Find the last row in Col A\n        Lrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        '~~&gt; Set your range\n        Set rng = .Range(\"A1:A\" &amp; Lrow)\n\n        '~~&gt; Loop trhough your range\n        For Each aCell In rng\n            '~~&gt; Skip the row if value in cell A is blank\n            If Len(Trim(aCell.Value)) &lt;&gt; 0 Then\n                '~~&gt; Check if the cell has \";\"\n                '~~&gt; If it has \";\" then split and replace else\n                '~~&gt; Replace without splitting\n                If InStr(1, aCell.Value, \";\") Then\n                    MyAr = Split(aCell.Value, \";\")\n\n                    For i = LBound(MyAr) To UBound(MyAr)\n                        aCell.Offset(, 1).Value = Replace(aCell.Offset(, 1).Value, Trim(MyAr(i)), \"\")\n                    Next i\n                Else\n                    aCell.Offset(, 1).Value = Replace(aCell.Offset(, 1).Value, Trim(aCell.Value), \"\")\n                End If\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Screenshot:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/onB2y.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 97, "user_id": 3114375, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a02b7c44f8f68bfc2ff3bd9114153624?s=128&d=identicon&r=PG&f=1", "display_name": "user3114375", "link": "https://stackoverflow.com/users/3114375/user3114375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2198, "favorite_count": 0, "accepted_answer_id": 30209364, "answer_count": 1, "score": 2, "last_activity_date": 1545483958, "creation_date": 1431502903, "last_edit_date": 1545483958, "question_id": 30208601, "link": "https://stackoverflow.com/questions/30208601/loop-through-split-value-cells-and-replace", "title": "Loop through split value cells and replace", "body": "<p>I have created a macro in Excel. In column A values are separated by a semicolon.</p>\n\n<p>There is a loop through split values in column A replacing split values in column B. </p>\n\n<p>Looping through split values doesn't work. </p>\n\n<pre><code>Sub ReplaceAttachments3()\nDim cl As Range\nDim cell As Variant\nDim i As Long\nDim txt As String\nFor Each cl In Range(\"$B$1:$B\" &amp; Range(\"$B65536\").End(xlUp).Row)\n    txt = Cells(cl.Row, 1)\n    cell = split(txt, \";\")\n    For i = 0 To UBound(cell)\n        Cells(cl.Row, 2).replace What:=txt,   Replacement:=\"\",LookAt:=xlPart, SearchOrder:= _\n            xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n        Application.Goto Reference:=\"ReplaceAttachments\"\n    Next i\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1431502697, "post_id": 30208451, "comment_id": 48521689, "body": "What specific error do you get? I tested it and seemed to work for me..."}, {"owner": {"reputation": 137, "user_id": 3946737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Yk78w.png?s=128&g=1", "display_name": "ayasocool", "link": "https://stackoverflow.com/users/3946737/ayasocool"}, "reply_to_user": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1431502901, "post_id": 30208451, "comment_id": 48521803, "body": "@AlexP No error, its just it doesnt echo out the value of psize. If I trying using a string into it, it echos out though, like for example psize = &quot;Size 32&quot;"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1431503529, "post_id": 30208451, "comment_id": 48522173, "body": "you use sheet name and index mixed Sheets(&quot;Sheet2&quot;) vs Sheets(1), this can be the reason, note that excel may not index the sheets as one would think, try to use sheet names."}], "answers": [{"tags": [], "owner": {"reputation": 120, "user_id": 4235041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89424c7666e1a0afd162208579f58ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Read", "link": "https://stackoverflow.com/users/4235041/alex-read"}, "is_accepted": false, "score": 0, "last_activity_date": 1431507221, "creation_date": 1431507221, "answer_id": 30210015, "question_id": 30208451, "link": "https://stackoverflow.com/questions/30208451/vba-get-a-data-from-another-sheet-while-using-a-loop/30210015#30210015", "title": "VBA: Get a data from another sheet while using a loop", "body": "<p>You're not explicitly setting the context of the range object in this line. Is this referencing the range you're expecting? To make sure, try to use SHEET.RANGE instead here:</p>\n\n<pre><code>config = Split(Range(\"C\" &amp; MyCell.Row), \"-\")\n</code></pre>\n\n<p>Update - actually, also in this line too:</p>\n\n<pre><code>For Each MyCell In Range(\"D2:D\" &amp; LastRowC)\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 3946737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Yk78w.png?s=128&g=1", "display_name": "ayasocool", "link": "https://stackoverflow.com/users/3946737/ayasocool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431507221, "creation_date": 1431502403, "question_id": 30208451, "link": "https://stackoverflow.com/questions/30208451/vba-get-a-data-from-another-sheet-while-using-a-loop", "title": "VBA: Get a data from another sheet while using a loop", "body": "<p>I'm having a hard time figuring what could have done wrong with my codes as it's not working at the moment. The thing is, I'm trying to get a value from another sheet and concatenate if from a data on the second sheet.</p>\n\n<p>What I'm trying to say is like this:</p>\n\n<pre><code>Sub Test()\nDim config As Variant\nDim psize As String\n\n'im trying to get the last row\n\nWith Sheets(\"Sheet2\")\n    LastRowC = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n\n\nFor Each MyCell In Range(\"D2:D\" &amp; LastRowC)\n    'trying to get a data from another sheet (This is my problem so far as this code aint working.)\n    psize = Sheets(1).Range(\"P\" &amp; MyCell.Row).Value\n    config = Split(Range(\"C\" &amp; MyCell.Row), \"-\")\n    'as you can see, im trying to echo out psize but to no avail\n    MyCell.Value = config(0) &amp; \"-\" &amp; config(1) &amp; \"-\" &amp; psize\n\nNext MyCell\n\nEnd Sub\n</code></pre>\n\n<p>My Problem here is the psize variable as it doesnt get the value that I wanted in sheet 1. Hope you guys can help me. Thanks!</p>\n"}, {"tags": ["vba", "excel", "foreach", "set"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1431504148, "post_id": 30208257, "comment_id": 48522537, "body": "You never actually use the <code>Cell</code> variable. You should be using <code>Cells(Cell.Row, c).Activate  </code>"}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431504075, "post_id": 30208683, "comment_id": 48522496, "body": "That&#39;s not actually true. The <code>Selection</code> is not re-evaluated."}], "tags": [], "owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "is_accepted": false, "score": -2, "last_activity_date": 1431503128, "creation_date": 1431503128, "answer_id": 30208683, "question_id": 30208257, "link": "https://stackoverflow.com/questions/30208257/vba-excel-for-each-next-doesnt-go-through-the-selected-range/30208683#30208683", "title": "VBA excel: For Each..Next doesn&#39;t go through the selected Range?", "body": "<p>You change your selection within your loop. Each time excel reach <code>for each cell in selection</code> it evaluates selection again, so it runs only once.<br>\nInstead of  </p>\n\n<pre><code>...\nActiveSheet.Range(\"F11:F60\").Select\nFor Each cell In Selection\n...\n</code></pre>\n\n<p>try  </p>\n\n<pre><code>...\ndim r as range\n... \nset r = activesheet.range(\"F11:F60\")\nFor Each cell In Selection.cells\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 290, "user_id": 3111348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29e15f6033b998cbe721e04a4ec69a9c?s=128&d=identicon&r=PG&f=1", "display_name": "rusk", "link": "https://stackoverflow.com/users/3111348/rusk"}, "is_accepted": false, "score": 0, "last_activity_date": 1431504122, "creation_date": 1431504122, "answer_id": 30209014, "question_id": 30208257, "link": "https://stackoverflow.com/questions/30208257/vba-excel-for-each-next-doesnt-go-through-the-selected-range/30209014#30209014", "title": "VBA excel: For Each..Next doesn&#39;t go through the selected Range?", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/aa139976(v=office.10).aspx\" rel=\"nofollow\">This page</a> will explain how <code>ActiveCell.Row</code> refers to only a single row in a selection.</p>\n\n<p>In this case, you can replace:</p>\n\n<pre><code>ActiveSheet.Range(\"F11:F60\").Select\n    For Each cell In Selection\n        Cells(ActiveCell.Row, c).Activate\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>Set rng = ActiveSheet.Range(\"F11:F60\")\n    For Each cell In rng\n        Cells(cell.Row, c).Activate\n</code></pre>\n\n<p>Also, <code>rng</code> should be declared as <strong>Range</strong> beforehand.</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1431509753, "last_edit_date": 1431509753, "creation_date": 1431504642, "answer_id": 30209171, "question_id": 30208257, "link": "https://stackoverflow.com/questions/30208257/vba-excel-for-each-next-doesnt-go-through-the-selected-range/30209171#30209171", "title": "VBA excel: For Each..Next doesn&#39;t go through the selected Range?", "body": "<p>For nested If...End If statements, make sure there is a correctly matched If...End If structure inside each enclosing If...End If structure.</p>\n\n<pre><code>Sub Test()\n    Dim Vuosi As Integer\n    Dim KK As Integer\n    Dim CF As Range\n    Dim C As String\n    Dim cell As Range\n\n    Vuosi = Application.InputBox(Prompt:=\"Enter the year you wish to view.\")\n    KK = Application.InputBox(Prompt:=\"Enter the month (1-12) you wish to view.\")\n\n    If Vuosi = 2014 Then\n        C = \"BU\"\n    Else\n    If Vuosi = 2015 Then\n        C = \"CG\"\n    Else\n    If Vuosi = 2016 Then\n        C = \"CS\"\n    End If\n\n    ActiveSheet.Range(\"F11:F60\").Select\n        For Each cell In Selection\n            Cells(ActiveCell.Row, C).Activate\n            Set CF = Range(ActiveCell.Offset(0, KK - 12), _\n            ActiveCell.Offset(0, KK)).Find(What:=1, _\n            LookIn:=xlFormulas, LookAT:=xlPart, _\n            SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False)\n            If Not CF Is Nothing Then\n                Cells(ActiveCell.Row, \"F\").Interior.ColorIndex = 6\n            End If\n        Next cell\n    End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1431506946, "last_edit_date": 1495540852, "creation_date": 1431506586, "answer_id": 30209817, "question_id": 30208257, "link": "https://stackoverflow.com/questions/30208257/vba-excel-for-each-next-doesnt-go-through-the-selected-range/30209817#30209817", "title": "VBA excel: For Each..Next doesn&#39;t go through the selected Range?", "body": "<p>I have some observations with regards to your code. Let me try and cover what all I noticed.</p>\n\n<p><strong>A</strong>) When working with Excel rows, avoid declaring them as <code>Integers</code>. Post Excel 2007, the rows have gone upto 1048576 which is too big a number for an <code>Integer</code>. You can get away when working with columns but may have problems with rows. It is a good habit to declare them as <code>Long</code></p>\n\n<p><strong>B</strong>) You are assuming that the user will always enter values in the Input boxes. What if the user enters a blank or presses <KBD>Cancel</KBD>? Trap those instances. If you want only numbers to be entered in the Inputboxes then use <code>Type:=1</code> with it. For more details read up on the <code>Application.InputBox Method</code> in the Excel Help.</p>\n\n<p><strong>C</strong>) Avoid the use of <code>.Select/.Activate</code> Your code can easily run with out selecting anything. You may want to see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">THIS</a> </p>\n\n<p>Is this what you are trying? (<strong>Untested</strong>)</p>\n\n<pre><code>Sub Test()\n    Dim vuosi As Integer, kk As Long\n    Dim rng As Range, aCell As Range, rngToFind As Range, cF As Range\n    Dim c As String\n    Dim ws As Worksheet\n\n    vuosi = Application.InputBox(Prompt:=\"Sy\u00f6t\u00e4 vuosi, jota haluat tarkastella.\", Type:=1)\n\n    If vuosi &lt; 1 Then Exit Sub\n\n    kk = Application.InputBox(Prompt:=\"Sy\u00f6t\u00e4 kuukausi(1-12), jota haluat tarkastella.\", Type:=1)\n\n    If kk &lt; 1 Then Exit Sub\n\n    If vuosi = 2014 Then c = \"BU\"\n    If vuosi = 2015 Then c = \"CG\"\n    If vuosi = 2016 Then c = \"CS\"\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    With ws\n        Set rng = ws.Range(\"F11:F60\")\n\n        For Each aCell In rng\n            Set rngToFind = .Range(aCell.Offset(0, kk - 12), aCell.Offset(0, kk))\n\n            Set cF = rngToFind.Find(What:=1, LookIn:=xlFormulas, LookAT:=xlPart, _\n                                    SearchOrder:=xlByColumns, MatchCase:=False, _\n                                    SearchFormat:=False)\n\n            If Not cF Is Nothing Then .Range(\"F\" &amp; aCell.Row).Interior.ColorIndex = 6\n        Next cell\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4886160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10cb3b45663efeb5778bf67b96b7cb7?s=128&d=identicon&r=PG&f=1", "display_name": "IngaB", "link": "https://stackoverflow.com/users/4886160/ingab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2561, "favorite_count": 0, "accepted_answer_id": 30209817, "answer_count": 4, "score": 2, "last_activity_date": 1431509753, "creation_date": 1431501810, "last_edit_date": 1431507338, "question_id": 30208257, "link": "https://stackoverflow.com/questions/30208257/vba-excel-for-each-next-doesnt-go-through-the-selected-range", "title": "VBA excel: For Each..Next doesn&#39;t go through the selected Range?", "body": "<p>I am trying to run my code:</p>\n\n<pre><code>Sub Test()\n    Dim vuosi As Integer\n    Dim kk As Integer\n    Dim cF As Range\n    Dim c As String\n    Dim cell As Range\n    vuosi = Application.InputBox(Prompt:=\"Sy\u00f6t\u00e4 vuosi, jota haluat tarkastella.\")\n    kk = Application.InputBox(Prompt:=\"Sy\u00f6t\u00e4 kuukausi(1-12), jota haluat tarkastella.\")\n    If vuosi = 2014 Then\n        c = \"BU\"\n    ElseIf vuosi = 2015 Then\n        c = \"CG\"\n    ElseIf vuosi = 2016 Then\n        c = \"CS\"\n    End If\n    ActiveSheet.Range(\"F11:F60\").Select\n    For Each cell In Selection\n        Cells(ActiveCell.Row, c).Activate  \n        Set cF = Range(ActiveCell.Offset(0, kk - 12), ActiveCell.Offset(0, kk)).Find(What:=1, LookIn:=xlFormulas, LookAT:=xlPart, SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False)\n        If Not cF Is Nothing Then\n            Cells(ActiveCell.Row, \"F\").Interior.ColorIndex = 6\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>It doesn't work properly. It seems the For Each loop goes through only the first line. Can anyone tell me why? </p>\n\n<p>The program should go through all the cells in column F. For each row it checks if there is value 1 found in specific cells. If yes, the cell in F column should be painted yellow. \nElse the program continues till the last value found in column F. (in my Test I used just Range(\"F11:F60\")</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1431503995, "post_id": 30208855, "comment_id": 48522435, "body": "Ok, this seems to be fine, but apparently the macros are disabled in the worksheet I generate and the code inside the Button_Click sub doesn&#39;t execute when I click on the button, how can I programmatically enable the macros for each worksheet I create ?"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1431504064, "post_id": 30208855, "comment_id": 48522483, "body": "You can&#39;t programmatically enable macros. What would be the point in this as a security feature :). You need to go to options and lower your level of security to enable macros by default."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1431504285, "post_id": 30208855, "comment_id": 48522617, "body": "@otus what&#39;s the error message and in which module is the <code>button_click</code> code located?"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431504318, "post_id": 30208855, "comment_id": 48522631, "body": "@Rory my bad then. Strange though."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1431504387, "post_id": 30208855, "comment_id": 48522674, "body": "@AnalystCave.com Not really - you have to have already enabled macros to run the code that then enables code in the relevant workbook, so it&#39;s not really a security flaw. ;)"}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431504585, "post_id": 30208855, "comment_id": 48522792, "body": "@Rory the error message is :&quot;It&#39;s impossible to run this macro. It is possible that it is not available in this workbook or that all macros are disabled&quot;. Actually I want to create a new Excel worksheet with this macro in it from another Excel macro, the code of <code>button_click</code> is located in a sub of a userform that I use to create new worksheets (PS: I translated the error message from french)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431504650, "post_id": 30208855, "comment_id": 48522827, "body": "You can&#39;t assign a routine in a userform module to a button in a worksheet. It just won&#39;t work."}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431504797, "post_id": 30208855, "comment_id": 48522907, "body": "@Rory how can I do then ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1431504960, "post_id": 30208855, "comment_id": 48523014, "body": "You need the macro to be in a normal module. Then you can use <code>.Onaction = &quot;&#39;workbook name.xlsm&#39;!macro_name&quot;</code> to call it."}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 3, "last_activity_date": 1431503684, "creation_date": 1431503684, "answer_id": 30208855, "question_id": 30208179, "link": "https://stackoverflow.com/questions/30208179/programmatically-add-a-button-with-a-macro-to-an-excel-file/30208855#30208855", "title": "Programmatically add a button with a macro to an Excel file", "body": "<p>You can add the Button like this or example:</p>\n\n<pre><code>ActiveSheet.Buttons.Add(52.5, 7.5, 173.25, 41.25).Select 'Arguments are coordinates\nSelection.OnAction = \"Button_Click\"\n</code></pre>\n\n<p>Now make sure the <code>Button_Click</code> sub has the logic you want.</p>\n"}], "owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8011, "favorite_count": 0, "accepted_answer_id": 30208855, "answer_count": 1, "score": 2, "last_activity_date": 1431503684, "creation_date": 1431501544, "question_id": 30208179, "link": "https://stackoverflow.com/questions/30208179/programmatically-add-a-button-with-a-macro-to-an-excel-file", "title": "Programmatically add a button with a macro to an Excel file", "body": "<p>I'm creating formated worksheets with an Excel VBA application and I would like to add programmatically add a button to each worksheet when created. This button must have a macro attached to it, which display the average of the values in a certain range in a special cell, and change the background color of this cell depending on the value of the average. Is it possible to this, and if yes, how can I do it ?</p>\n"}, {"tags": ["excel", "vbscript", "ms-office", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4894459"}, "is_accepted": false, "score": 0, "last_activity_date": 1431500258, "creation_date": 1431500258, "answer_id": 30207733, "question_id": 30206871, "link": "https://stackoverflow.com/questions/30206871/running-microsoft-office-vba-macro-with-vb-script/30207733#30207733", "title": "Running Microsoft Office VBA macro with VB script", "body": "<p>This applies to Excel - but the steps and procedures are identical in Word. I would search and replace Word for Excel but the code samples wouldn't make sense.</p>\n\n<p>Record the steps in excel macro recorder. You have to rewrite it a bit because it uses a type of syntax that vbs doesn't.</p>\n\n<p>This applies (I don't have a medium9) xlRangeAutoFormatAccounting4 in vba.</p>\n\n<pre><code>Selection.AutoFormat Format:=xlRangeAutoFormatAccounting4, Number:=True, _\n    Font:=True, Alignment:=True, Border:=True, Pattern:=True, Width:=True\n</code></pre>\n\n<p>So first look up constants in vba's object browser. xlRangeAutoFormatAccounting4 = 17</p>\n\n<p>Then look the function up in object browser and look at the bottom for the function definition,.</p>\n\n<pre><code>Function AutoFormat([Format As XlRangeAutoFormat = xlRangeAutoFormatClassic1], [Number], [Font], [Alignment], [Border], [Pattern], [Width])\n</code></pre>\n\n<p>So the vba becomes in vbs (and vbs works in vba) (and as you can see you can work out the correct way without needing to look the function up usually)</p>\n\n<pre><code>Selection.AutoFormat 17, True, True, True,True, True, True\n</code></pre>\n\n<p>So your code becomes</p>\n\n<pre><code>objXLWs.Range(\"A3\").CurrentRegion.Select.AutoFormat 17, True, True, True,True, True, True\n</code></pre>\n\n<p>You are using Excel and you can record it in Excel and have Excel write your code.</p>\n\n<p>Alt + T, M, R</p>\n\n<p>then Home key then Up Arrow. Stop recording.</p>\n\n<p>Look what Excel wrote</p>\n\n<pre><code>Selection.End(xlUp).Select\n</code></pre>\n\n<p>or if you had of recorded Go To dialog</p>\n\n<pre><code>Application.Goto Reference:=\"R1C1\"\n</code></pre>\n\n<p>or if you had of recorded Ctrl + Home</p>\n\n<pre><code>Range(\"A1\").Select\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4894267, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002934695900/picture?type=large", "display_name": "Beathoven", "link": "https://stackoverflow.com/users/4894267/beathoven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1433140164, "creation_date": 1431497153, "last_edit_date": 1531164843, "question_id": 30206871, "link": "https://stackoverflow.com/questions/30206871/running-microsoft-office-vba-macro-with-vb-script", "title": "Running Microsoft Office VBA macro with VB script", "body": "<p>I am working on a project aimed at showing how to run a macro in Microsoft Office using an external vbscript file. I have tried severally and failed at it also found a couple of posts here, all leaned towards Excel than Office. Having difficulties getting those examples to work on Office.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1431497687, "post_id": 30205900, "comment_id": 48518782, "body": "thanks for the edit &quot;jherran&quot;! Sorry for initial ugliness of post! :)"}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1431498588, "post_id": 30205900, "comment_id": 48519173, "body": "This condition will never happen <code>Left(CellValue, 2) = &quot;1355</code>, because <code>Len(Left(CellValue, 2))</code> is always 2"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1431499394, "post_id": 30207376, "comment_id": 48519575, "body": "Thanks for your help Uri,  I&#39;m getting a Compile error, Invalid or unqualified reference on &quot;.Cells(Row, ) ?  Should I define &quot;Cells&quot;?  Also, looks like you pretty much understood my question, I should have been clearer; So yes, every where there is a &quot;2&quot; The number in Cell B will need to be copied to all the 3&#39;s below (As in example above) until the next &quot;2&quot; etc etc."}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "reply_to_user": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1431499523, "post_id": 30207376, "comment_id": 48519640, "body": "of-course you are, it&#39;s a snippet out of your code. you&#39;ll need to use the surrounding <code>With</code>  statement"}, {"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1431499705, "post_id": 30207376, "comment_id": 48519735, "body": "I&#39;ve run this and Am getting the following in Col A: 2 11111111111111100000000000000 11111111111111100000000000000 11111111111111100000000000000 2 11111111111111100000000000000 11111111111111100000000000000 11111111111111100000000000000 11111111111111100000000000000 11111111111111100000000000000 11111111111111100000000000000 11111111111111100000000000000 2 11111111111111100000000000000 11111111111111100000000000000"}, {"owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "edited": false, "score": 0, "creation_date": 1431569827, "post_id": 30207376, "comment_id": 48560047, "body": "Not working I&#39;m afraid :( So I&#39;ve tried to run this, but instead of replacing the 3&#39;s with the previous value in ColB where there was a &quot;2&quot; in ColA, its just replacing All 3&#39;s with a scientific formatted number? (1.11E+28)....Can anyone help with this?  Format should read as above example where number is 13553400, 13555300 etc etc.  Thanks"}], "tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": false, "score": 0, "last_activity_date": 1431499467, "last_edit_date": 1431499467, "creation_date": 1431499130, "answer_id": 30207376, "question_id": 30205900, "link": "https://stackoverflow.com/questions/30205900/search-col-copy-serial-number-and-paste-into-repeating-cols-vba/30207376#30207376", "title": "Search col, copy serial number and paste into repeating cols vba", "body": "<p>I hope I understood what you wanted to do correctly,</p>\n\n<p>This code replaces every <code>3</code> in <code>A</code> with the first value of <code>B</code> where <code>A=2</code></p>\n\n<pre><code>Dim CellValue As String\nDim RowCrnt As Integer\nDim RowMax As Integer\n\nWith Sheets(\"Sheet2\")   ' Replace Sheet1 by the name of your sheet\nRowMax = .Cells(Rows.Count, \"B\").End(xlUp).Row\nFor RowCrnt = 1 To RowMax\nIf .Cells(RowCrnt,1) = \"2\" Then\n    .Range(\"A:A\").Replace What:=\"3\", Replacement:=.Cells(RowCrnt,2), LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\nEnd If\nNext\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4894069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f362e0bc7a236c4618234a66d4ab79e?s=128&d=identicon&r=PG&f=1", "display_name": "folio", "link": "https://stackoverflow.com/users/4894069/folio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1431499467, "creation_date": 1431492448, "last_edit_date": 1531164843, "question_id": 30205900, "link": "https://stackoverflow.com/questions/30205900/search-col-copy-serial-number-and-paste-into-repeating-cols-vba", "title": "Search col, copy serial number and paste into repeating cols vba", "body": "<p>Was hoping someone could help me with a little piece of vba code?\nMy raw data looks like this:</p>\n\n<pre><code>1   A   B   C   D   E   F   G   H   I   J   K   L   M   N\n2   1   311000063552511.00  9/07/2013                                           \n3   2   13552500    135525                                          \n4   3   871 535316-613  30/03/2015  12:39:20    0   CRD PURCHASE    22900   0   22900       EFTPOS  \n5   3   872 407220-029  30/03/2015  15:28:39    0   CRD PURCHASE    22900   0   22900       EFTPOS  \n6   3   873 456472-840  30/03/2015  16:41:04    0   CRD PURCHASE    22900   0   22900       EFTPOS  \n7   2   13553400    135534                                          \n8   3   2077    494053-070  30/03/2015  8:56:31 0   CRD PURCHASE    37763   0   37763       EFTPOS  \n9   3   2078    456443-621  30/03/2015  9:55:40 0   CRD PURCHASE    17647   0   17647       EFTPOS  \n10  3   2079    455701-331  30/03/2015  11:35:44    1   CHQ PURCHASE    40546   0   0       EFTPOS  \n11  3   2080    455701-331  30/03/2015  11:36:27    55  CRD PURCHASE    40546   0   0       EFTPOS  \n12  3   2086    552350-690  30/03/2015  14:21:51    0   CRD PURCHASE    22166   0   22166       EFTPOS  \n13  3   2087    455702-239  30/03/2015  15:24:34    0   CHQ PURCHASE    23647   0   23647       EFTPOS  \n14  3   2088    455701-685  30/03/2015  16:21:31    0   CRD PURCHASE    22166   0   22166       EFTPOS  \n15  2   13555200    135552                                          \n16  3   1544    516361-514  30/03/2015  11:55:06    0   CHQ PURCHASE    22900   0   22900       EFTPOS  \n17  3   1545    407220-745  30/03/2015  14:00:36    0   CRD PURCHASE    24153   0   24153       EFTPOS  \n</code></pre>\n\n<p>What I hope to do is: Col A determines what I want to do. So a \"2\" in Col A means I want to copy the number in Col B1, B5 etc. And replace all the \"3's\" in Col A with this number.</p>\n\n<p>I want the sheet to look like this once finished:</p>\n\n<pre><code>1   1   A   B   C   D   E   F   G   H   I   J   K   L   M   N\n2   1   311000063546919 28/03/2015                                              \n3   13552500    871 535316-613  30/03/15    0.527314815 0   CRD PURCHASE    22900   0   22900       EFTPOS      \n4   13552500    872 407220-029  30/03/15    0.644895833 0   CRD PURCHASE    22900   0   22900       EFTPOS      \n5   13552500    873 456472-840  30/03/15    0.695185185 0   CRD PURCHASE    22900   0   22900       EFTPOS      \n6   13553400    2077    494053-070  30/03/15    0.372581019 0   CRD PURCHASE    37763   0   37763       EFTPOS      \n7   13553400    2078    456443-621  30/03/15    0.413657407 0   CRD PURCHASE    17647   0   17647       EFTPOS      \n8   13553400    2079    455701-331  30/03/15    0.483148148 1   CHQ PURCHASE    40546   0   0       EFTPOS      \n9   13553400    2080    455701-331  30/03/15    0.483645833 55  CRD PURCHASE    40546   0   0       EFTPOS      \n10  13553400    2086    552350-690  30/03/15    0.598506944 0   CRD PURCHASE    22166   0   22166       EFTPOS      \n11  13553400    2087    455702-239  30/03/15    15:24:34    0   CHQ PURCHASE    23647   0   23647       EFTPOS      \n12  13553400    2088    455701-685  30/03/15    16:21:31    0   CRD PURCHASE    22166   0   22166       EFTPOS      \n13  13555200    1544    516361-514  30/03/15    11:55:06    0   CHQ PURCHASE    22900   0   22900       EFTPOS      \n14  13555200    1545    407220-745  30/03/15    14:00:36    0   CRD PURCHASE    24153   0   24153       EFTPOS      \n15  13555300    2730    450949-935  30/03/15    0.369259259 0   CRD PURCHASE    22900   0   22900       EFTPOS      \n16  13555300    2731    456463-730  30/03/15    0.553101852 0   CRD PURCHASE    34966   0   34966       EFTPOS      \n17  13555300    2732    552033-957  30/03/15    0.628530093 0   CRD PURCHASE    27147   0   27147       EFTPOS      \n</code></pre>\n\n<p>Hope this doesn't prove too difficult for the great minds on here!\nCode I'm currently using isn't right!</p>\n\n<pre><code>Dim CellValue As String\nDim RowCrnt As Integer\nDim RowMax As Integer\n\nWith Sheets(\"Sheet2\")   ' Replace Sheet1 by the name of your sheet\nRowMax = .Cells(Rows.Count, \"B\").End(xlUp).Row\n\nFor RowCrnt = 1 To RowMax\nCellValue = .Cells(RowCrnt, 1).Value\nIf Left(CellValue, 2) = \"1355\" And CellValue = \"3\" Then\n  .Cells(RowCrnt, 1).Value = CellValue\n\nEnd If\nNext\nEnd With\n</code></pre>\n\n<p>Any help is greatly appreciated!</p>\n\n<p>Thanks! :)</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 193, "user_id": 4053498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiWT6.jpg?s=128&g=1", "display_name": "EdHunter", "link": "https://stackoverflow.com/users/4053498/edhunter"}, "edited": false, "score": 0, "creation_date": 1431500086, "post_id": 30205843, "comment_id": 48519987, "body": "Taking a quick look at this it appears that you are trying to call either a sub or function which does not exist <code>If FileAlreadyOpen(FilePath) = True Then</code>  Do you have code somewhere else for the <code>FileAlreadyOpen</code> call?"}, {"owner": {"reputation": 11, "user_id": 4892783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfb712a09d196eae6cfa34b2c19eb49f?s=128&d=identicon&r=PG&f=1", "display_name": "AHern", "link": "https://stackoverflow.com/users/4892783/ahern"}, "reply_to_user": {"reputation": 193, "user_id": 4053498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiWT6.jpg?s=128&g=1", "display_name": "EdHunter", "link": "https://stackoverflow.com/users/4053498/edhunter"}, "edited": false, "score": 0, "creation_date": 1431533199, "post_id": 30205843, "comment_id": 48543942, "body": "#EdHunter - No, this is all the code I have as of now. I have tried messing with it and removing and renaming but I run into the same issue..."}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 4053498, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiWT6.jpg?s=128&g=1", "display_name": "EdHunter", "link": "https://stackoverflow.com/users/4053498/edhunter"}, "edited": false, "score": 1, "creation_date": 1431499840, "post_id": 30206768, "comment_id": 48519821, "body": "Unless .Display does something other than just display the email to allow you to make edits prior to it being sent then there is no need to use .Display if you are using .Send"}, {"owner": {"reputation": 11, "user_id": 4892783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfb712a09d196eae6cfa34b2c19eb49f?s=128&d=identicon&r=PG&f=1", "display_name": "AHern", "link": "https://stackoverflow.com/users/4892783/ahern"}, "edited": false, "score": 0, "creation_date": 1431620820, "post_id": 30206768, "comment_id": 48585963, "body": "@Omar I did test it. It doesn&#39;t automatically send but it does pop up the screen to have it emailed and that is successful. It does give an error about what I&#39;m assuming is the automated .Send part. On #2 o haven&#39;t received feedback yet so I am still stuck on the FilePath part"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1431628851, "post_id": 30206768, "comment_id": 48590708, "body": "Remove the <code>.Display </code> &amp; change the - <code>&#39;.Send</code>   To  <code>.Send</code>  that should fix the automate the send with out the pop up. on #2 if you don&#39;t have access to `\\\\profiler` then you will get Error"}, {"owner": {"reputation": 11, "user_id": 4892783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfb712a09d196eae6cfa34b2c19eb49f?s=128&d=identicon&r=PG&f=1", "display_name": "AHern", "link": "https://stackoverflow.com/users/4892783/ahern"}, "edited": false, "score": 0, "creation_date": 1431629584, "post_id": 30206768, "comment_id": 48591113, "body": "@Omar. I&#39;ll go ahead and remove display and leave the send. Could it be a macro security with work to run to the profiler file? I do have access but I ran into the same problem at home when testing it on a file in a separate drive"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1431629143, "last_edit_date": 1431629143, "creation_date": 1431496663, "answer_id": 30206768, "question_id": 30205843, "link": "https://stackoverflow.com/questions/30205843/macro-to-attach-a-worksheet-with-vba-code-and-have-the-worksheet-edited-to-uploa/30206768#30206768", "title": "macro to attach a worksheet with vba code and have the worksheet edited to upload to a shared excel sheet", "body": "<p>that should fix the attachment part </p>\n\n<p><strong>1</strong> </p>\n\n<pre><code>Option Explicit\n\nSub SendReferral()\n    Dim OutlookApp As Object\n    Dim OutlookMail As Object\n\n\n    Set OutlookApp = CreateObject(\"Outlook.Application\")\n    Set OutlookMail = OutlookApp.CreateItem(0)\n\n    With OutlookMail\n        .To = \"Services@gmail.com \" &amp; Range(\"b2\").Value &amp; \" Services@gmail.com\"\n        .CC = \"Services@gmail.com \"\n        .BCC = \"\"\n        .Subject = \"Referral for \" &amp; Range(\"d2\").Value &amp; \" - \" &amp; Range(\"f2\").Value\n        .Body = \"Hello, please follow up with the member within 2 business days, thank you.\"\n         ActiveWorkbook.Save\n        .Attachments.Add ActiveWorkbook.FullName\n        '.Display '&lt;&lt;&lt;---- use it for editing \n        .Send\n    End With\n\n    Set OutlookMail = Nothing\n    Set OutlookApp = Nothing\n    End Sub\n</code></pre>\n\n<p><strong>2</strong>      </p>\n\n<pre><code>Option Explicit\n\nPublic Sub UploadReferral()\n    Dim FilePath As String\n    Dim NewRow As Long, LastRow As Long\n    Dim I As Integer, J As Integer\n\n    FilePath = \"\\\\profiler\\docs$\\Manager Docs\\Global Referrals\\Testing.xlsx\"\n\n    If FileAlreadyOpen(FilePath) = True Then\n        Application.OnTime Now + TimeValue(\"00:0:30\"), \"TransferData\"\n        Worksheets(\"Flat File\").CommandButton1.Enabled = False\n        Worksheets(\"Flat File\").CommandButton1.Caption = \"Saving... Please wait\"\n    Else:\n        Workbooks.Open (FilePath)\n        With Workbooks(\"Global Referrals.xlsx\").Worksheets(\"Referrals\")\n        NewRow = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n        Workbooks(\"ReferralForm1.xlsm\").Activate\n        LastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n            For I = 2 To LastRow\n                For J = 1 To 14\n                    .Cells(NewRow, J) = Cells(I, J)\n                Next J\n                .Cells(NewRow, 15) = Environ(\"UserName\")\n                NewRow = NewRow + 1\n            Next I\n        End With\n        Worksheets(\"ReferralForm1\").CommandButton1.Enabled = True\n        Worksheets(\"ReferralForm1\").CommandButton1.Caption = \"Transfer Data\"\n        Workbooks(\"Global referrals.xlsx\").Close SaveChanges:=True\n            MsgBox \"Global Referrals updated\"\n    End If\nEnd Sub\n\nFunction FileAlreadyOpen(FileName As String)\n    Dim iFilenum As Long\n    Dim iErr As Long\n\n    On Error Resume Next\n    iFilenum = FreeFile()\n    Open FileName For Input Lock Read As #iFilenum\n    Close iFilenum\n    iErr = Err\n    On Error GoTo 0\n\n    Select Case iErr\n    Case 0:    FileAlreadyOpen = False\n    Case 70:   FileAlreadyOpen = True\n    Case Else: Error iErr\n    End Select\n\nEnd Function  \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4892783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfb712a09d196eae6cfa34b2c19eb49f?s=128&d=identicon&r=PG&f=1", "display_name": "AHern", "link": "https://stackoverflow.com/users/4892783/ahern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1372, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593513802, "creation_date": 1431492149, "last_edit_date": 1593513802, "question_id": 30205843, "link": "https://stackoverflow.com/questions/30205843/macro-to-attach-a-worksheet-with-vba-code-and-have-the-worksheet-edited-to-uploa", "title": "macro to attach a worksheet with vba code and have the worksheet edited to upload to a shared excel sheet", "body": "<p>I've used this for many of my projects that I have been creating for work. I have learned a lot but I am hitting a wall.</p>\n<p>As my staff uses the save and send as attachment manually  notify me and the other department, I want to have to macro buttons installed. If I install the macro buttons to the worksheet it will need to be emailed as a macro-enabled worksheet correct?</p>\n<p>Also, everything appears to work in this sub except for the Attachments part...I would like it to continue to be generic so anyone can upload using the 2nd VBA code</p>\n<h1>1</h1>\n<pre><code>    Sub SendReferral()\n    Dim OutlookApp As Object\n    Dim OutlookMail As Object\n    Set OutlookApp = CreateObject(&quot;Outlook.Application&quot;)\n    Set OutlookMail = OutlookApp.CreateItem(0)\n    With OutlookMail\n        .To = &quot;_&quot; &amp; Range(&quot;b2&quot;).Value &amp; &quot;Services@gmail.com&quot;\n        .CC = &quot;myself&quot;\n        .BCC = &quot;&quot;\n        .Subject = &quot;Referral for &quot; &amp; Range(&quot;d2&quot;).Value &amp; &quot; - &quot; &amp; Range(&quot;f2&quot;).Value\n        .Body = &quot;Hello, please follow up with the member within 2 business days, thank you.&quot;\n        .Attachments.Add Application.ActiveWorkbook.FullName\n        .Send\n    End With\n    Set OutlookMail = Nothing\n    Set OutlookApp = Nothing\n    End Sub\n</code></pre>\n<p>I have been trying to modify this one but presently cannot get past the FilePath line so I cannot check if the rest of the Sub will work.</p>\n<h1>2</h1>\n<pre><code>    Sub UploadReferral()\n    Dim FilePath As String\n    Dim I As Integer, J As Integer\n    FilePath = &quot;\\\\profiler\\docs$\\Manager Docs\\Global Referrals -                 Testing.xlsx&quot;\n        If FileAlreadyOpen(FilePath) = True Then\n            Application.OnTime Now + TimeValue(&quot;00:0:30&quot;), &quot;TransferData&quot;\n            Worksheets(&quot;Flat File&quot;).CommandButton1.Enabled = False\n            Worksheets(&quot;Flat File&quot;).CommandButton1.Caption = &quot;Saving... Please wait&quot;\n        Else:\n            Workbooks.Open (FilePath)\n            With Workbooks(&quot;Global Referrals.xlsx&quot;).Worksheets(&quot;Referrals&quot;)\n            NewRow = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n            Workbooks(&quot;ReferralForm1.xlsm&quot;).Activate\n            LastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n            For I = 2 To LastRow\n                For J = 1 To 14\n                    .Cells(NewRow, J) = Cells(I, J)\n                Next J\n                .Cells(NewRow, 15) = Environ(&quot;UserName&quot;)\n                NewRow = NewRow + 1\n            Next I\n            End With\n            Worksheets(&quot;ReferralForm1&quot;).CommandButton1.Enabled = True\n            Worksheets(&quot;ReferralForm1&quot;).CommandButton1.Caption = &quot;Transfer Data&quot;\n            Workbooks(&quot;Global referrals.xlsx&quot;).Close SaveChanges:=True\n            MsgBox &quot;Global Referrals updated&quot;\n    End If\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431503934, "post_id": 30205518, "comment_id": 48522398, "body": "<a href=\"http://stackoverflow.com/questions/13860894/ms-excel-crashes-when-vba-code-runs/13861640#13861640\">Worth A Read</a>"}, {"owner": {"reputation": 29, "user_id": 2291480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634c15fd4fa5c05dd57a79308e18f921?s=128&d=identicon&r=PG", "display_name": "djEthen", "link": "https://stackoverflow.com/users/2291480/djethen"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431565141, "post_id": 30205518, "comment_id": 48558937, "body": "Thanks for that Siddharth, That helped allot"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 2291480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634c15fd4fa5c05dd57a79308e18f921?s=128&d=identicon&r=PG", "display_name": "djEthen", "link": "https://stackoverflow.com/users/2291480/djethen"}, "edited": false, "score": 0, "creation_date": 1431490940, "post_id": 30205614, "comment_id": 48516281, "body": "Hi, changed them to <code>target</code>, but i still get the same error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1431492878, "post_id": 30205614, "comment_id": 48516855, "body": "Did you change all <i>6</i> ActiveCell to Target?"}, {"owner": {"reputation": 29, "user_id": 2291480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634c15fd4fa5c05dd57a79308e18f921?s=128&d=identicon&r=PG", "display_name": "djEthen", "link": "https://stackoverflow.com/users/2291480/djethen"}, "edited": false, "score": 0, "creation_date": 1431565234, "post_id": 30205614, "comment_id": 48558959, "body": "Changed all of them, found the issue though, it was using conditional highlighting so that&#39;s what was conflicting with the macro"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1431490708, "creation_date": 1431490708, "answer_id": 30205614, "question_id": 30205518, "link": "https://stackoverflow.com/questions/30205518/excel-error-1004-highlight-adjecent-cells-gray-when-yes/30205614#30205614", "title": "Excel error 1004, Highlight adjecent cells gray when yes", "body": "<p><code>ActiveCell</code> is not the cell that changed.  <code>Target</code> is.  You need to replace all of the references to <code>ActiveCell</code> to <code>Target</code> and adjust the offsets accordingly.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 2291480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634c15fd4fa5c05dd57a79308e18f921?s=128&d=identicon&r=PG", "display_name": "djEthen", "link": "https://stackoverflow.com/users/2291480/djethen"}, "edited": false, "score": 0, "creation_date": 1431565276, "post_id": 30205946, "comment_id": 48558978, "body": "Thanks for the code, and i didn&#39;t know about the error exit so now i know"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1431492691, "creation_date": 1431492691, "answer_id": 30205946, "question_id": 30205518, "link": "https://stackoverflow.com/questions/30205518/excel-error-1004-highlight-adjecent-cells-gray-when-yes/30205946#30205946", "title": "Excel error 1004, Highlight adjecent cells gray when yes", "body": "<p>Changing <em>ActiveCell</em> to <em>Target</em> is a good start. You should also compensate for more than a single target cell in case a block of values is pasted into a range overlapping columns E and/or G.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Union(Columns(5), Columns(7))) Is Nothing Then\n        On Error GoTo F\u00ecn\n        Application.EnableEvents = False\n        Dim o As Range, t As Range\n        For Each t In Intersect(Target, Union(Columns(5), Columns(7)))\n            Select Case t.Column\n                Case 5\n                    Set o = t.Offset(0, 1).Resize(1, 7)\n                Case 7\n                    Set o = t.Offset(0, 1).Resize(1, 3)\n            End Select\n            If LCase(t.Value) = \"yes\" Then\n                o.Interior.Color = RGB(192, 192, 192)\n            Else\n                o.Interior.Pattern = xlNone\n            End If\n        Next t\n    End If\n\nF\u00ecn:\n    Set o = Nothing\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>I've only set the range of the cells to receive the fill color first. Note that there does seem to be a crossover logic issue where if E5 receives a <em>Yes</em> and G5 receives a <em>No</em> then only K5:L5 will be grey. I made the comparison to <em>yes</em> non-case-sensitive.</p>\n\n<p>Errors are covered by a safe exit.</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 2291480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634c15fd4fa5c05dd57a79308e18f921?s=128&d=identicon&r=PG", "display_name": "djEthen", "link": "https://stackoverflow.com/users/2291480/djethen"}, "is_accepted": false, "score": 0, "last_activity_date": 1432085994, "creation_date": 1432085994, "answer_id": 30338891, "question_id": 30205518, "link": "https://stackoverflow.com/questions/30205518/excel-error-1004-highlight-adjecent-cells-gray-when-yes/30338891#30338891", "title": "Excel error 1004, Highlight adjecent cells gray when yes", "body": "<p>Found the issue though, it was using conditional highlighting so that's what was conflicting with the macro</p>\n"}], "owner": {"reputation": 29, "user_id": 2291480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634c15fd4fa5c05dd57a79308e18f921?s=128&d=identicon&r=PG", "display_name": "djEthen", "link": "https://stackoverflow.com/users/2291480/djethen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 30205946, "answer_count": 3, "score": 1, "last_activity_date": 1432085994, "creation_date": 1431490089, "last_edit_date": 1431526615, "question_id": 30205518, "link": "https://stackoverflow.com/questions/30205518/excel-error-1004-highlight-adjecent-cells-gray-when-yes", "title": "Excel error 1004, Highlight adjecent cells gray when yes", "body": "<p>I'm trying to put a macro where I select <code>Yes</code> in a row, the next cells are grayed out. So I have got couple of yes columns, but for the life of me can't figure/fix out the error</p>\n\n<blockquote>\n  <p><strong>Error</strong><br>\n   Runtime Error 1004<br>\n   Application-defined or object-defied error</p>\n</blockquote>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf ActiveCell.Column = 5 Then\n\n    Set r = Range(ActiveCell.Offset(0, 1), ActiveCell.Offset(0, 7))\n\n    If Target.Value = \"Yes\" Or Target.Value = \"YES\" Then\n        r.Interior.Color = RGB(192, 192, 192)\n    Else\n        r.Interior.Color = xlNone\n    End If\nEnd If\n\n If ActiveCell.Column = 7 Then\n\n    Set s = Range(ActiveCell.Offset(0, 1), ActiveCell.Offset(0, 3))\n\n    If Target.Value = \"Yes\" Or Target.Value = \"YES\" Then\n        s.Interior.Color = RGB(192, 192, 192)\n    Else\n        s.Interior.Color = xlNone\n    End If\n End If\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/P5rLI.png\" alt=\"1\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 4378304, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b3bfeea1a17c8928bc753b81ea80814f?s=128&d=identicon&r=PG&f=1", "display_name": "phani", "link": "https://stackoverflow.com/users/4378304/phani"}, "edited": false, "score": 0, "creation_date": 1431489238, "post_id": 30205306, "comment_id": 48515801, "body": "Thanks for your reply. I want to disable &#39;insert&#39; also"}, {"owner": {"reputation": 10110, "user_id": 1715829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0yet.jpg?s=128&g=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/1715829/buddy"}, "reply_to_user": {"reputation": 325, "user_id": 4378304, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b3bfeea1a17c8928bc753b81ea80814f?s=128&d=identicon&r=PG&f=1", "display_name": "phani", "link": "https://stackoverflow.com/users/4378304/phani"}, "edited": false, "score": 0, "creation_date": 1431489353, "post_id": 30205306, "comment_id": 48515833, "body": "<a href=\"http://www.experts-exchange.com/Software/Office_Productivity/Office_Suites/MS_Office/Excel/Q_28185598.html\" rel=\"nofollow noreferrer\">experts-exchange.com/Software/Office_Productivity/Office_Sui&zwnj;&#8203;tes/&hellip;</a>"}], "tags": [], "owner": {"reputation": 10110, "user_id": 1715829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0yet.jpg?s=128&g=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/1715829/buddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1431488741, "creation_date": 1431488741, "answer_id": 30205306, "question_id": 30205290, "link": "https://stackoverflow.com/questions/30205290/prevent-delete-and-allow-update/30205306#30205306", "title": "Prevent delete and allow update", "body": "<p>Try this to disable the \"delete row/col\": <a href=\"http://www.extendoffice.com/documents/excel/1821-excel-prevent-deleting-rows.html\" rel=\"nofollow\">http://www.extendoffice.com/documents/excel/1821-excel-prevent-deleting-rows.html</a></p>\n"}], "owner": {"reputation": 325, "user_id": 4378304, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b3bfeea1a17c8928bc753b81ea80814f?s=128&d=identicon&r=PG&f=1", "display_name": "phani", "link": "https://stackoverflow.com/users/4378304/phani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 639, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431488741, "creation_date": 1431488601, "last_edit_date": 1531164843, "question_id": 30205290, "link": "https://stackoverflow.com/questions/30205290/prevent-delete-and-allow-update", "title": "Prevent delete and allow update", "body": "<p>In my excel worksheet I don't want to delete and insert row or columns and it allows edit.</p>\n\n<p>i am using this line of code</p>\n\n<pre><code>Application.CommandBars(\"Cell\").Enabled = False\n</code></pre>\n\n<p>but it's allowed to delete a row</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "vba", "office-interop", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "edited": false, "score": 0, "creation_date": 1431487928, "post_id": 30205070, "comment_id": 48515461, "body": "I need to find the color of highlighted text (not to set it). <code>objSelection.ParagraphFormat.Shading.BackgroundPatternColor</code> returns  9999999 for all highlighted text regardless of what color the text is highlighted with."}, {"owner": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "edited": false, "score": 0, "creation_date": 1431490391, "post_id": 30205070, "comment_id": 48516138, "body": "the <code>Find</code> object does not have <code>FormattedText</code> property. How do you find the background color of a highlighted text that you find using the <code>Find</code> object (shown in the code of my original post)."}, {"owner": {"reputation": 858, "user_id": 2527577, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qqc9c.png?s=128&g=1", "display_name": "S.Krishna", "link": "https://stackoverflow.com/users/2527577/s-krishna"}, "reply_to_user": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "edited": false, "score": 0, "creation_date": 1431492862, "post_id": 30205070, "comment_id": 48516848, "body": "Please see my Update#1"}], "tags": [], "owner": {"reputation": 858, "user_id": 2527577, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qqc9c.png?s=128&g=1", "display_name": "S.Krishna", "link": "https://stackoverflow.com/users/2527577/s-krishna"}, "is_accepted": true, "score": 0, "last_activity_date": 1431492845, "last_edit_date": 1431492845, "creation_date": 1431487177, "answer_id": 30205070, "question_id": 30205044, "link": "https://stackoverflow.com/questions/30205044/find-out-background-color-of-highlighted-text-in-ms-word-document-using-c-or-vb/30205070#30205070", "title": "Find out background color of highlighted text in MS Word document using C# or VBA", "body": "<p>The below statement would get you the color index of selected text in MS Word</p>\n\n<pre><code>Dim objSelection As Selection\nSet objSelection = Application.Selection\nMsgbox objSelection.FormattedText.HighlightColorIndex\n</code></pre>\n\n<p>The value returned is one of wdColorIndex enumeration. List of values in enumeration can be seen here <a href=\"https://msdn.microsoft.com/en-us/library/bb237561(v=office.12).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/bb237561(v=office.12).aspx</a></p>\n\n<p><strong>Update#1</strong></p>\n\n<p>Below code is using ActiveDocument.Range.Find as requested</p>\n\n<pre><code>Dim objSelection As Selection\nDim temp As String\n\nWith ActiveDocument.Range.Find\n  .Highlight = True\n  While .Execute\n    'Store the text for searching later\n    temp = .Parent.Text\n\n    'Select all the text\n    ActiveDocument.Content.Select\n\n    'Find and select the text\n    With Selection.Find\n        .Text = temp\n    End With\n\n    If Selection.Find.Execute Then\n        Selection.Select\n    End If\n\n    'Now that we've selected it, get the HighlightedColorIndex\n    Set objSelection = .Application.Selection\n    MsgBox .Parent.Text &amp; vbNewLine &amp; \"Index: \" &amp; objSelection.FormattedText.HighlightColorIndex\n  Wend\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1957, "favorite_count": 0, "accepted_answer_id": 30205070, "answer_count": 1, "score": 0, "last_activity_date": 1431492845, "creation_date": 1431486951, "question_id": 30205044, "link": "https://stackoverflow.com/questions/30205044/find-out-background-color-of-highlighted-text-in-ms-word-document-using-c-or-vb", "title": "Find out background color of highlighted text in MS Word document using C# or VBA", "body": "<p>Following finds the highlighted text in a Word document (even if the different text at different places is highlighted with different colors). How can we find out the background color of each highlighted text. I'm using C# but VBA will also be ok:</p>\n\n<pre><code>With ActiveDocument.Range.Find\n  .Highlight = True\n  While .Execute\n    Debug.Print .Parent.Text\n  Wend\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "word-2010"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4893687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqKKY.jpg?s=128&g=1", "display_name": "Mel Onary", "link": "https://stackoverflow.com/users/4893687/mel-onary"}, "edited": false, "score": 0, "creation_date": 1431738317, "post_id": 30207215, "comment_id": 48641087, "body": "Yes, this worked, thanks!  I had tried this line of code in the same spot:          .ForeColor.RGB = RGB(0, 0, 0) but without Dim within the sub. Searching original code, I found the shapes, text, etc., called at the beginning of the"}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 1, "last_activity_date": 1431498524, "creation_date": 1431498524, "answer_id": 30207215, "question_id": 30204494, "link": "https://stackoverflow.com/questions/30204494/change-insert-line-color-with-vba-macro/30207215#30207215", "title": "Change insert line color with VBA macro", "body": "<p>It's quite simple... You need to define <code>oFFline</code> object as a <code>Shape</code> and then to set its properties as follow:</p>\n\n<pre><code>Sub SignoffLine()\n    Dim oFFline As Shape\n    Dim i As Integer\n\n    On Error GoTo endthis\n\n    i = Selection.Information(wdVerticalPositionRelativeToPage)\n    Set oFFline = ActiveDocument.Shapes.AddLine(554, i + 12, 524, i + 12)\n\n    With oFFline.Line\n        .Weight = 0.75\n        'set black color \n        .ForeColor.RGB = RGB(0, 0, 0)\n    End With\n    oFFline.Name = \"hline\" &amp; idi\n    idi = idi + 1\n\n    endthis:\n    Set oFFline = Nothing\nEnd Sub\n</code></pre>\n\n<p>For further information, please see: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196943.aspx\" rel=\"nofollow\">Shape Object (Word)</a> and <a href=\"https://msdn.microsoft.com/en-us/library/zc1dyw8b%28v=vs.90%29.aspx\" rel=\"nofollow\">RGB</a></p>\n"}], "owner": {"reputation": 23, "user_id": 4893687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqKKY.jpg?s=128&g=1", "display_name": "Mel Onary", "link": "https://stackoverflow.com/users/4893687/mel-onary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 0, "accepted_answer_id": 30207215, "answer_count": 1, "score": 2, "last_activity_date": 1431498524, "creation_date": 1431483199, "last_edit_date": 1431493373, "question_id": 30204494, "link": "https://stackoverflow.com/questions/30204494/change-insert-line-color-with-vba-macro", "title": "Change insert line color with VBA macro", "body": "<p>Code below was created (not by me, and saved as *.dotm) in Microsoft Word 97-2003, when default \"insert shape/line\" was black. Used as procedure template with specific cover page, header, outline style, etc. When the *.doc files are saved to *.docx, and the \"<code>SignoffLine</code>\" macro is activated, the inserted line's color is blue (MS Word 2010 default for Insert Shape/Line?).</p>\n\n<p>I can change the default color per document, and I can change it via <code>Normal.dotm</code>, but want to edit the macro below so inserted line is always black. </p>\n\n<pre><code>Sub SignoffLine()\n    On Error GoTo endthis\n    i = Selection.Information(wdVerticalPositionRelativeToPage)\n    Set oFFline = ActiveDocument.Shapes.AddLine(554, i + 12, 524, i + 12).Line\n\n    With oFFline.Line\n        .Weight = 0.75\n    End With\n        oFFline.Name = \"hline\" &amp; idi\n        idi = idi + 1\n    endthis:\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 3946737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Yk78w.png?s=128&g=1", "display_name": "ayasocool", "link": "https://stackoverflow.com/users/3946737/ayasocool"}, "edited": false, "score": 0, "creation_date": 1431484345, "post_id": 30204586, "comment_id": 48514487, "body": "It Worked! Thanks buddy!"}], "tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": true, "score": 0, "last_activity_date": 1431483823, "creation_date": 1431483823, "answer_id": 30204586, "question_id": 30204388, "link": "https://stackoverflow.com/questions/30204388/vba-get-list-of-data-from-another-column-and-transfer-them-to-another-column-us/30204586#30204586", "title": "VBA: Get List Of Data From Another Column and Transfer them to another Column using loop", "body": "<p>Please go ahead and try the code below. You may adapt the code to your situation.</p>\n\n<p><strong>Data before</strong></p>\n\n<pre><code>   A           B    C    D    E\n1  hello 19\n2  hello 20\n3  hello 40\n4  hello rr\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub test()\n\n    ' find the last row assuming data starts from A1\n    Dim LastRow As Integer\n    LastRow = Range(\"A1\").End(xlDown).Row\n\n    ' loop through E1..E&lt;n&gt;\n    ' take value of corresponding row of column A and\n    ' do MID on it. Put the result in A's row\n    Dim MyCell As Range\n    For Each MyCell In Range(\"E1:E\" &amp; LastRow)\n        MyCell.Value = Mid(Range(\"A\" &amp; MyCell.Row), 7, 2)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><strong>After running the code</strong></p>\n\n<pre><code>   A           B    C    D    E\n1  hello 19                   19\n2  hello 20                   20\n3  hello 40                   40\n4  hello rr                   rr\n</code></pre>\n\n<p>Hope this information helps.</p>\n"}], "owner": {"reputation": 137, "user_id": 3946737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Yk78w.png?s=128&g=1", "display_name": "ayasocool", "link": "https://stackoverflow.com/users/3946737/ayasocool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 30204586, "answer_count": 1, "score": 1, "last_activity_date": 1431483823, "creation_date": 1431482520, "last_edit_date": 1431482911, "question_id": 30204388, "link": "https://stackoverflow.com/questions/30204388/vba-get-list-of-data-from-another-column-and-transfer-them-to-another-column-us", "title": "VBA: Get List Of Data From Another Column and Transfer them to another Column using loop", "body": "<p>suppose I want to get a list of data and only want to get a certain string on each of every list and I want to transfer them to a different column.</p>\n\n<p>For example I want to get a certain strings on every data in Column A, and I want to transfer those certain string to another column which is Column E. What I got so far is this, but its not working. Im fairly new to VBA and I hope you guys can help me. Thanks.</p>\n\n<p>PS: What I mean for certain string is using mid function on every strings on that column.</p>\n\n<pre><code>Sub test()\n\nWith Sheets(\"Sheet1\")\n    LastRowE = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n\nFor Each MyCell In Range(\"E2:E\" &amp; LastRowE)\n\n    MyCell.Value = Mid(Range(\"A2:A6\"), 7, 2)\n\nNext MyCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "edited": false, "score": 0, "creation_date": 1431486821, "post_id": 30204798, "comment_id": 48515143, "body": "Thanks for the help. This works wonderfully with a little tweaking to get just the cell values."}], "tags": [], "owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "is_accepted": true, "score": 1, "last_activity_date": 1431485372, "creation_date": 1431485372, "answer_id": 30204798, "question_id": 30204380, "link": "https://stackoverflow.com/questions/30204380/how-to-check-for-a-value-across-columns-and-then-copy-the-the-contents-of-one-ce/30204798#30204798", "title": "How to check for a value across columns and then copy the the contents of one cell below it?", "body": "<p>To get the last, that is rightmost, column in a row, first set MyRow to the row you want to use:</p>\n\n<pre><code>lastcol= ActiveSheet.Cells(MyRow, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>For the last row, after setting MyColumn to the appropriate value:</p>\n\n<pre><code>lastrow = ActiveSheet.Cells(Rows.Count, MyColumn).End(xlUp).Row\n</code></pre>\n\n<p>But your range reference isn't quite right either.  Personally, I don't see the value of using a range variable in the loop.  You could try this.  (note that a negative offset reads the row above, not below)</p>\n\n<pre><code>Sub Copy()\nDim lastRow As Long, i As Long, LocX as long\nDim source As Worksheet, dest As Worksheet\nSet source = Sheets(1)\nSet dest = Sheets(2)\nlastcol = source.Cells(7, Columns.Count).End(xlToLeft).Column\ni = 4\nFor locX = 4 To lastcol\n    If source.Cells(7, locX).Value = \"mon\" Then\n        source.Cells(7, locX).Offset(1, 0).Copy dest.Cells(1, i)\n        i = i + 1\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "edited": false, "score": 0, "creation_date": 1431487006, "post_id": 30204801, "comment_id": 48515198, "body": "Just what exactly is the difference between .columns and .column?  MSDN wasn&#39;t exactly clear on that, and I didn&#39;t notice that in their examples that .column was used only at the end of lines."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "edited": false, "score": 0, "creation_date": 1431487466, "post_id": 30204801, "comment_id": 48515331, "body": "Try <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198200.aspx\" rel=\"nofollow noreferrer\">Range.Column Property (Excel)</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837125.aspx\" rel=\"nofollow noreferrer\">Range.Columns Property (Excel)</a>.  On a worksheet it is like the difference between <code>=COLUMN(A&quot;A)</code> which returns an integer and <code>=COLUMNS(A&quot;A)</code> which returns a cell range amounting to the cells in column A. You do not use <code>COUNTIF(COLUMN(A:A), &quot;abc&quot;)</code> that is like saying <code>COUNTIF(1, &quot;abc&quot;)</code> but you do use <code>COUNTIF(COLUMNS(A:A), &quot;abc&quot;)</code> to find out how many cells contain <i>abc</i> in column A."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1431485380, "creation_date": 1431485380, "answer_id": 30204801, "question_id": 30204380, "link": "https://stackoverflow.com/questions/30204380/how-to-check-for-a-value-across-columns-and-then-copy-the-the-contents-of-one-ce/30204801#30204801", "title": "How to check for a value across columns and then copy the the contents of one cell below it?", "body": "<p>The name you've assigned to <em>LastCol</em> seems to indicate that you want to get the column number yet you are using <code>xlUp</code> instead of <code>xlToLeft</code>. Additionally, you are asking for the <code>.Columns</code>, not the <code>Column</code>.</p>\n\n<pre><code>LastCol = Cells(7, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>This returns the column number (e.g. column F = 6, column AA = 27, etc) of the last used column in row 7.</p>\n\n<pre><code>with Sheets(1)\n    LastCol = .Cells(7, Columns.Count).End(xlToLeft).Column\n    For Each cell In .cells(7, \"D\").resize(1, LastCol - 3)\n        If ucase(cell.Value) = \"MON\" Then\n            cell.Offset(1, 0).Copy destination:=Sheets(2).Cells(1, i)\n            i = i + 1\n        End If\n    Next\nend with\n</code></pre>\n\n<ol>\n<li>Are you using an actual date in row 7 with a custom number format of <em>ddd</em>? If this is the case, then you should be using <code>If weekday(cell.Value) = 2 Then</code> instead of checking for <em>MON</em>.</li>\n<li>If you want to <em>copy the contents of the cell directly below them</em> then your offset should be 1 row not -1 row; e.g. <code>cell.Offset(1, 0).Copy</code></li>\n</ol>\n"}], "owner": {"reputation": 108, "user_id": 4890139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10a2c9c114a5f2f21674b8d4fbe5af2?s=128&d=identicon&r=PG", "display_name": "iMan7", "link": "https://stackoverflow.com/users/4890139/iman7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 30204798, "answer_count": 2, "score": 0, "last_activity_date": 1431485380, "creation_date": 1431482476, "last_edit_date": 1531161705, "question_id": 30204380, "link": "https://stackoverflow.com/questions/30204380/how-to-check-for-a-value-across-columns-and-then-copy-the-the-contents-of-one-ce", "title": "How to check for a value across columns and then copy the the contents of one cell below it?", "body": "<p>So I have an excel sheet with the days of the week starting at D7 and extending to AF7 for 15 days of the month. I want to look through each of them and then copy the contents of the cell directly below them in row 8 to another sheet. </p>\n\n<p>Im getting runtime error 1004 Method Range of Object _Global failed on this line. Im pretty new to VBA so I'm not exactly sure what went wrong. </p>\n\n<pre><code>LastCol = Range(Cells(7, Columns.Count)).End(xlUp).Columns\n</code></pre>\n\n<p>Full code:</p>\n\n<pre><code>Sub Copy()\n    Dim cell As Range\n    Dim lastRow As Long, i As Long\n\n    LastCol = Range(Cells(7, Columns.Count)).End(xlUp).Columns\n    i = 4\n\n    For Each cell In Sheets(1).Range(LastCol &amp; \"D7:7\")\n        If cell.Value = \"MON\" Then\n            cell.Offset(-1, 0).Copy Sheets(2).Cells(1, i)\n            i = i + 1\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431475256, "post_id": 30203214, "comment_id": 48512177, "body": "If it works in Debug but not when run straight through, then you likely have a timing issue.  You might need to wait for some event on the page to complete.  For example you don&#39;t wait after clicking the button just before stage 2.  You need to wait <i>every time</i> you navigate."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4892831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e18de57511408dc53073047929aef1?s=128&d=identicon&r=PG&f=1", "display_name": "Ochimus", "link": "https://stackoverflow.com/users/4892831/ochimus"}, "edited": false, "score": 0, "creation_date": 1431525490, "post_id": 30203413, "comment_id": 48537931, "body": "@tim, Many thanks for seeing the issue, Now works smoothly, but doubtless there will be other challenges further down the process!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1431475302, "creation_date": 1431475302, "answer_id": 30203413, "question_id": 30203214, "link": "https://stackoverflow.com/questions/30203214/manually-cycling-through-vba-code-enters-data-into-web-but-clicking-button-does/30203413#30203413", "title": "Manually cycling through VBA Code enters data into web, but clicking button does not", "body": "<p>Extend the wait period to include the <code>.readtState</code> and allow processing through the message queue pump rather than locking it up.</p>\n\n<pre><code>Do While IE.Busy or ie.readystate &lt;&gt; 4  'READYSTATE_COMPLETE = 4\n  doevents\nLoop\n</code></pre>\n\n<p>You also aren't waiting after you 'click'. Put another of these after the <code>.Click</code> and before you start trying to <code>Set</code> objects.</p>\n\n<p>That should ensure that you receive the standard page. If dynamic content is being delivered that has not arrived by the time both of those conditions are met, there are other methods to implement.</p>\n"}], "owner": {"reputation": 11, "user_id": 4892831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e18de57511408dc53073047929aef1?s=128&d=identicon&r=PG&f=1", "display_name": "Ochimus", "link": "https://stackoverflow.com/users/4892831/ochimus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1431475302, "creation_date": 1431473769, "last_edit_date": 1531161705, "question_id": 30203214, "link": "https://stackoverflow.com/questions/30203214/manually-cycling-through-vba-code-enters-data-into-web-but-clicking-button-does", "title": "Manually cycling through VBA Code enters data into web, but clicking button does not", "body": "<p>Using Excel 2013 to log into a website and change data automatically.</p>\n\n<p>Following Code works perfectly to open the website, enter the User Name and Password, \"sign in\", and open the next screen.</p>\n\n<p>It should then populate two more boxes on the new screen, but it does not. It generates a RunTime Error saying an \"Object is required\".</p>\n\n<p>But if I press \"Debug\" and \"step through\" from the error line, the Code runs perfectly!</p>\n\n<pre><code>Option Explicit\n\nSub EnterWeb()\n\nDim IE As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nDim uRl As String\nDim UserN As Object 'MSHTML.IHTMLElement\nDim PW As Object 'MSHTML.IHTMLElement\nDim CoNum As Object 'MSHTML.IHTMLElement\nDim AuthCode As Object 'MSHTML.IHTMLElement\n\nDim SUBMIT As Object 'MSHTML.IHTMLElement\n\n'STAGE 1 - LOG INTO THE WEBSITE\n\n'Set the website\n    uRl = \"WEBSITE NAME GOES HERE\"\n\n    With IE\n    .navigate uRl\n    .Visible = True\n    End With\n\n' loop until the page finishes loading\n    Do While IE.Busy\n    Loop\n\n'Enter User name in \"e-mail\" textbox\n    Set UserN = IE.document.getElementByID(\"email\")\n    If Not UserN Is Nothing Then\n    UserN.Value = \"TEXT GOES HERE\"\n    End If\n\n'Enter Password in \"Password\" textbox\n    Set PW = IE.document.getElementByID(\"seccode\")\n    If Not PW Is Nothing Then\n    PW.Value = \"TEXT GOES HERE\"\n    End If\n\n'Sign in to site\n\nDim Item As Object\n\nSet Item = IE.document.getElementsByClassName(\"button positive regular\")\n    Item.Item(0).Click\n\n'STAGE 2 -ENTER DETAILS ON NEXT PAGE\n\n'Enter in First textbox\n'THIS IS WHERE THE PROBLEM STARTS.\n'RUNNING MACRO AUTOMATICALLY GENERATES A RUNTIME ERROR 424 - \"OBJECT REQUIRED\"\n'BUT STEPPING THROUGH USING F8 IT RUNS PERFECTLY\n    Set CoNum = IE.document.getElementByID(\"PUTS ID HERE\") \n    If Not CoNum Is Nothing Then\n    CoNum.Value = \"PUTS VALUE HERE\"\n    End If\n\n'Enter Code in textbox\n    Set AuthCode = IE.document.getElementByID(\"PUTS CODE HERE\")\n    If Not AuthCode Is Nothing Then\n    AuthCode.Value = \"PUTS TEXT HERE\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>All suggestions received gratefully</p>\n\n<p>Ochimus</p>\n"}, {"tags": ["forms", "vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1431474284, "post_id": 30203192, "comment_id": 48511915, "body": "Have you tried using <code>theRanker.Name</code> ?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1431474398, "post_id": 30203192, "comment_id": 48511938, "body": "You grab a reference in the code above, why don&#39;t you just name them to whatever is convenient?"}, {"owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431474670, "post_id": 30203192, "comment_id": 48512017, "body": "Tim, that returned &quot;Rating3,&quot; but then when I tried to refer to its value by using Rating3.Value, it said the variable was not defined."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431475070, "post_id": 30203192, "comment_id": 48512127, "body": "<code>theRanker.Value</code> would do that.  If you really wanted to refer to it by name then you <i>could</i> do <code>CriteriaPairwiseForm.Controls(theRanker.Name).Value</code> but that&#39;s kind of circular"}, {"owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431475110, "post_id": 30203192, "comment_id": 48512136, "body": "Comintern, it&#39;s a loop creating a different amount of comboboxes based on how many variables a user inputs, so I don&#39;t think I can name each one."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1431475486, "post_id": 30203192, "comment_id": 48512239, "body": "Do you need to interact with these controls after you exit the <code>addLabel</code> sub?"}, {"owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431475616, "post_id": 30203192, "comment_id": 48512266, "body": "Tim, that works in that it returns the value selected in the combobox, but for some reason, it only returns the value of the item in the last combobox. For example, when the user inputs three items, there are three comboboxes that appear. Only the value of the third combobox appears to be saved in theRanker. I need these values of the combobox selections to appear elsewhere."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1431476327, "post_id": 30203192, "comment_id": 48512451, "body": "They don&#39;t need to all be named ahead of time - I would think something like <code>&quot;Ranker&quot; &amp; labelCounter</code> would be appropriate\\useful."}, {"owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1431476584, "post_id": 30203192, "comment_id": 48512518, "body": "@Comintern, how can I name each combobox that is create in the code?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431478271, "post_id": 30203782, "comment_id": 48512949, "body": "I am unable to see any values from the second code."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431478383, "post_id": 30203782, "comment_id": 48512975, "body": "@Lillian - Worked fine when I tested it.  Is the form still open when you&#39;re trying to read the values?"}, {"owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431478702, "post_id": 30203782, "comment_id": 48513043, "body": "Yes, the form is still open. I do not see any values appear in the immediate window when I change the combobox values."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431479322, "post_id": 30203782, "comment_id": 48513207, "body": "@Lillian - I can&#39;t replicate that at all, I&#39;d probably need to see the rest of the code."}, {"owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431480059, "post_id": 30203782, "comment_id": 48513388, "body": "the only part of the code I didn&#39;t include above is  <code>Sub UserForm_Initialize()                Sheets(&quot;Overview&quot;).Range(&quot;A1&quot;).Select       &#39; Set Do loop to stop when an empty cell is reached.       Do Until IsEmpty(ActiveCell)          addLabel          &#39; Step down 1 row from present location.          ActiveCell.Offset(1, 0).Select       Loop          End Sub</code> So when I run the code, the comboboxes show up, and the selection is made, but the code you provided <code>CriteriaPairwiseForm.Controls(&quot;Ranker&quot; &amp; labelCounter).Text</code> does not return the selection from the comboboxes like I need-it&#39;s blank."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431480400, "post_id": 30203782, "comment_id": 48513459, "body": "Where are you calling the test Sub from above? I put a call to <code>GetValues</code> in the <code>UserForm_DblClick</code> handler and double-clicked the form to test it."}, {"owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431480598, "post_id": 30203782, "comment_id": 48513505, "body": "Even when I do the <code>UserForm_DblClick</code> handler, nothing appears. Where am I supposed to be looking for these values?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431480690, "post_id": 30203782, "comment_id": 48513529, "body": "They should appear in the immediate window.  Where do you need to use them? After you assign names to them they should be accessible anywhere the form is in scope."}, {"owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431480893, "post_id": 30203782, "comment_id": 48513580, "body": "Nothing appears in the immediate window?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "edited": false, "score": 0, "creation_date": 1431481569, "post_id": 30203782, "comment_id": 48513734, "body": "@Lilian - See the edit.  Run the form, change some of the values, then double-click somewhere else on the form (not on a control)."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1431481435, "last_edit_date": 1431481435, "creation_date": 1431477718, "answer_id": 30203782, "question_id": 30203192, "link": "https://stackoverflow.com/questions/30203192/how-to-retrieve-name-of-dynamically-created-combobox-in-vba/30203782#30203782", "title": "How to retrieve name of dynamically created ComboBox in VBA?", "body": "<p>The easiest way to do this is to use the reference you get from the <code>.Add</code> method to name them.  You're already looping through a range of values, so use the loop counter to build object names.  This has the advantage of also having the names corresponding to row that the label originates from:</p>\n\n<pre><code>Sub addLabel()\n    Dim theLabel As Object\n    Dim theRanker As Object\n    Dim labelCounter As Long\n    Dim RowCount As Integer\n\n    RowCount = Sheets(\"Overview\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For labelCounter = 1 To RowCount\n        Set theRanker = CriteriaPairwiseForm.Controls.Add(\"Forms.ComboBox.1\", _\n                        \"Rating\" &amp; labelCounter, True)\n        With theRanker\n            .Left = 20\n            .Width = 150\n            .Top = 30 * labelCounter\n            .AddItem \"Equal Importance\"\n            .AddItem \"Moderate Importance\"\n            .AddItem \"Strong Importance\"\n            .AddItem \"Very Strong Importance\"\n            .AddItem \"Extreme Importance\"\n            .Name = \"Ranker\" &amp; labelCounter\n        End With\n        Set theLabel = CriteriaPairwiseForm.Controls.Add(\"Forms.Label.1\", _\n                       \"CriteriaRank\" &amp; labelCounter, True)\n        With theLabel\n            .Caption = Cells(labelCounter, 1).Value\n            .Left = 200\n            .Width = 150\n            .Top = 30 * labelCounter\n\n        End With\n    Next labelCounter\nEnd Sub\n</code></pre>\n\n<p>You can use the same method to get the values from them later (or address them by row index by concatenating the name).  You can verify this by creating a UserForm named \"CriteriaPairwiseForm\", and putting the following code in the form in addition to <code>Sub addLabel</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub UserForm_Initialize()\n    addLabel\nEnd Sub\n\nPrivate Sub UserForm_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    GetValues\nEnd Sub\n\nPrivate Sub GetValues()\n\n    Dim labelCounter As Long\n    Dim RowCount As Integer\n    Dim message As String\n\n    RowCount = Sheets(\"Overview\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For labelCounter = 1 To RowCount\n        message = \"Ranker\" &amp; labelCounter &amp; \" contains:\" &amp; vbCrLf &amp; _\n                  CriteriaPairwiseForm.Controls(\"Ranker\" &amp; labelCounter).Text\n        MsgBox message\n    Next labelCounter\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4893512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba889d29f9fa5240fbcc585d455442?s=128&d=identicon&r=PG&f=1", "display_name": "Lilian", "link": "https://stackoverflow.com/users/4893512/lilian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1019, "favorite_count": 0, "accepted_answer_id": 30203782, "answer_count": 1, "score": 0, "last_activity_date": 1431481435, "creation_date": 1431473560, "question_id": 30203192, "link": "https://stackoverflow.com/questions/30203192/how-to-retrieve-name-of-dynamically-created-combobox-in-vba", "title": "How to retrieve name of dynamically created ComboBox in VBA?", "body": "<p>I would like to reference the value of ComboBoxes I created using a loop, but I do not know what their name is. How can I find their name?</p>\n\n<pre><code>Sub addLabel()\nDim theLabel As Object\nDim theRanker As Object\nDim labelCounter As Long\nDim RowCount As Integer\n\nRowCount = Sheets(\"Overview\").Range(\"A\" &amp; Rows.count).End(xlUp).Row\n\nFor labelCounter = 1 To RowCount\n    Set theRanker = CriteriaPairwiseForm.Controls.Add(\"Forms.ComboBox.1\", \"Rating\" &amp; labelCounter, True)\n    With theRanker\n        .Left = 20\n        .Width = 150\n        .Top = 30 * labelCounter\n        .AddItem \"Equal Importance\"\n        .AddItem \"Moderate Importance\"\n        .AddItem \"Strong Importance\"\n        .AddItem \"Very Strong Importance\"\n        .AddItem \"Extreme Importance\"\n\n    End With\n    Set theLabel = CriteriaPairwiseForm.Controls.Add(\"Forms.Label.1\", \"CriteriaRank\" &amp; labelCounter, True)\n    With theLabel\n        .caption = Cells(labelCounter, 1).Value\n        .Left = 200\n        .Width = 150\n        .Top = 30 * labelCounter\n\n    End With\nNext labelCounter\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1431471589, "post_id": 30202738, "comment_id": 48511148, "body": "If it is just to identify the existance I would sooner use a countif rather than a cpu intensive VLookup. If the countif returns zero you know it doesn&#39;t exist, anything above zero it exists"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431472335, "post_id": 30202738, "comment_id": 48511361, "body": "Depending on the type of data, you might be able to use <code>Data-&gt;Remove Duplicates</code> to reduce the size of it.  This works if you&#39;re just testing for an item being in both lists.  You could also call the VBA version of the functions <code>Application.Match</code> and process the results in VBA without putting the formula in the worksheet.  <code>Application.Match</code> is ideal here since you just want to test existence."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1431556583, "post_id": 30202738, "comment_id": 48556598, "body": "The <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH function</a>&#39;s <a href=\"https://support.office.com/en-us/article/IFERROR-function-F59BACDC-78BD-4924-91DF-A869D0B08CD5\" rel=\"nofollow noreferrer\">IFERROR function</a> will return a <i>zero-length string</i> which while not truly blank can be counted with the <a href=\"https://support.office.com/en-au/article/countblank-function-c72134a2-695e-43ab-a3f3-714aa770f385\" rel=\"nofollow noreferrer\">COUNTBLANK function</a>. Remove the IFERROR wrapper if you want to count #N/A with VLOOKUP&#39;s #N/A."}], "answers": [{"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1431472805, "post_id": 30202992, "comment_id": 48511484, "body": "Good point about the vlookup looking off Harvey, @RosenkranzC your formula is actually saying if the result of the vlookup is the cell to the left then return the result of the vlookup........ otherwise also return the result of the vlookup, whilst it is going to give you some semblance of what you want (ultimately a #N/A where none existent) you are running the vlookup for the test then again regardless of the outcome, just the vlookup on its own without the if is the same result with less calculations."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 2, "last_activity_date": 1431472320, "creation_date": 1431472320, "answer_id": 30202992, "question_id": 30202738, "link": "https://stackoverflow.com/questions/30202738/excel-vlookup-returning-0/30202992#30202992", "title": "Excel vLookup Returning 0", "body": "<p>Here is yoru formula, it looks dodgy!</p>\n\n<pre><code>'=IF(VLOOKUP(RC[-1],2_4!R1C1:R79145C1,1)=RC[-1]\n    ,VLOOKUP(RC[-1],2_4!R1C1:R79145C2,1,FALSE)\n    ,VLOOKUP(RC[-1],2_4!R1C1:R79145C2,1,FALSE))\n</code></pre>\n\n<p>In the cells in the column to the right of the lookup column with values (which I will assume is column A and start in row 2.  Try this formula in cell B2 then copy and paste it down:</p>\n\n<pre><code>=NOT(  ISNA(   VLOOKUP($A2,'2_4'!$A$1:$A$79145,1, FALSE)   )   )\n</code></pre>\n\n<p>This will return true when a value is found or false when it isn't.</p>\n\n<p>I think you need to re-read the manual pages on VLOOKUP as  you not using it right.</p>\n\n<p>You might like to use the ribbon>>formula tab>>calculation options to turn of auto calcualtion whilst you are editing, but I don;t think it will be necessary.</p>\n\n<p>Harvey</p>\n"}, {"comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1431473255, "post_id": 30203084, "comment_id": 48511623, "body": "Although match is better, your example won&#39;t work as the cell a3 is hard coded in the text string....  I wouldn&#39;t bother using VBA to set the formula, and I would use match which does less than vlookup and will be a bit quicker.  vlookup is worth learning though as it is very handy."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 1, "creation_date": 1431473352, "post_id": 30203084, "comment_id": 48511660, "body": "@HarveyFrench - leaving A3 relative and filling a column of cells at once has hte same effect as a Fill Down; e.g. the A3 will adjust per row."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1431474512, "post_id": 30203084, "comment_id": 48511967, "body": "Glad I am not the only one to have questioned you on this now Jeeped :)."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1431502394, "post_id": 30203084, "comment_id": 48521489, "body": "Oooo.  I didn&#39;t know that.  A good tip, although I suspect obmitting the line &quot;.cells = .value2&quot; and leaving the formulas in place would be how RosenkranzC might ue it."}, {"owner": {"reputation": 45, "user_id": 2096361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821e7ccde619a0459efb40853566e830?s=128&d=identicon&r=PG", "display_name": "RosenkranzC", "link": "https://stackoverflow.com/users/2096361/rosenkranzc"}, "edited": false, "score": 0, "creation_date": 1431554709, "post_id": 30203084, "comment_id": 48555848, "body": "After a little bit of fiddling, this was the solution with the least amount of processing time. Thank you everyone for your help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1431472851, "creation_date": 1431472851, "answer_id": 30203084, "question_id": 30202738, "link": "https://stackoverflow.com/questions/30202738/excel-vlookup-returning-0/30203084#30203084", "title": "Excel vLookup Returning 0", "body": "<p>A <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow\">MATCH function</a> is more efficient than a <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow\">VLOOKUP function</a> or even a <a href=\"https://support.office.com/en-US/article/COUNTIF-function-E0DE10C6-F885-4E71-ABB4-1F464816DF34\" rel=\"nofollow\">COUNTIF function</a> if all you want to do is prove existence.</p>\n\n<pre><code>With Sheets(\"Lookup).Range(\"B3:B133780\")\n    .Formula = \"=iferror(match(a3, '2_4'!A:A, 0), \"\"\"\")\"\n    .cells = .value2\nEnd With \n</code></pre>\n\n<p>You will be left with blank cells and cells containing the row numbers of the match on worksheet '2_4' in column B.</p>\n"}, {"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 1, "last_activity_date": 1431479437, "last_edit_date": 1495540691, "creation_date": 1431479437, "answer_id": 30203976, "question_id": 30202738, "link": "https://stackoverflow.com/questions/30202738/excel-vlookup-returning-0/30203976#30203976", "title": "Excel vLookup Returning 0", "body": "<p>Here's a different approach using ADO (adapted from <a href=\"https://stackoverflow.com/a/15192969/2127508\">this answer</a> but modified to use the Excel 2007 onwards connection string and to identify only the items which are unique to the lookup sheet.) I've assumed that the lookup sheet is called \"Lookup\", the reference sheet is called \"Reference\" and the list of items we identify will be output to a sheet called \"Data\" - replace with the correct names if these are wrong.</p>\n\n<p>In the VBA editor, go to Tools > References and add a reference to \"Microsoft ActiveX Data Objects 2.8 Library\". Now add this to a standard code module then run it:</p>\n\n<pre><code>Option Explicit\n\nSub get_employees()\n\nDim cn As ADODB.Connection\nSet cn = New ADODB.Connection\n\n' Connection string for .xlsm files\nWith cn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0 Macro;IMEX=1;HDR=Yes\"\";\"\n    .Open\nEnd With\n\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\nrs.Open \"SELECT [Lookup$].[ID_Lookup] FROM [Lookup$] LEFT JOIN [Reference$] ON [Lookup$].[ID_Lookup] = \" &amp; _\n    \"[Reference$].[ID_Ref] WHERE [Reference$].[ID_Ref] IS NULL\", cn\n\nWith Worksheets(\"Data\")\n    .Cells(2, 1).CopyFromRecordset rs\nEnd With\n\nrs.Close\ncn.Close\n\nEnd Sub\n</code></pre>\n\n<p>This tries to match every entry in the lookup sheet with one or more corresponding entries in the reference sheet. It then eliminates all of the matches and just keeps the lookup entries which didn't match.</p>\n"}], "owner": {"reputation": 45, "user_id": 2096361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821e7ccde619a0459efb40853566e830?s=128&d=identicon&r=PG", "display_name": "RosenkranzC", "link": "https://stackoverflow.com/users/2096361/rosenkranzc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1739, "favorite_count": 0, "accepted_answer_id": 30203084, "answer_count": 3, "score": 2, "last_activity_date": 1431540392, "creation_date": 1431470898, "last_edit_date": 1431540392, "question_id": 30202738, "link": "https://stackoverflow.com/questions/30202738/excel-vlookup-returning-0", "title": "Excel vLookup Returning 0", "body": "<p>I'm working with a two very large tables and I'm trying to use vba and vlookups to match the data in one with the other.</p>\n\n<p>The worksheets are each one column and are structured like below:</p>\n\n<p>Reference Sheet:<br>\n<strong>ID_Ref (2/4)</strong><br> \nQ1234<br>\nW1234<br>\nR1234<br>\n... <p>\nLookup Sheet   <br>\n<strong>ID_Lookup</strong><br>\nQ1234<br>\nP1234<br>\nX1234<br>\n...<p></p>\n\n<p>I'm interested in identifying the rows that are in the Lookup SHeet but not in the Reference Sheet. I have a huge quantity of rows in each sheet (~130k in the Lookup and 90k in the Reference) and and excel kept crashing when I tried to enter the formulas manually.</p>\n\n<p>As a result I'm trying to work with VBA to automate the process. The issue is that the below function returns 0 for most of the rows and I can't figure out why. </p>\n\n<pre><code>    Sub Vlookup()\n\n    With Sheets(\"Lookup).Range(\"B3:B133780\")\n        .FormulaR1C1 = _\n        \"=IF(VLOOKUP(RC[-1],2_4!R1C1:R79145C1,1)=RC[-1],VLOOKUP(RC[-1],2_4!R1C1:R79145C2,1,FALSE),VLOOKUP(RC[-1],2_4!R1C1:R79145C2,1,FALSE))\"\n        .Value = .Value\n    End With \n    End Sub\n</code></pre>\n\n<p>Any help is appreciated!</p>\n\n<p><strong>EDIT 5/13:</strong></p>\n\n<p>I tried the methods mentioned by @HarveyFrench and @Jeeped and got two different results.</p>\n\n<p>Copying down: </p>\n\n<pre><code>=NOT(ISNA(VLOOKUP($A2,'2_4'!$A$1:$A$79145,1, FALSE)))\n</code></pre>\n\n<p>yields a different number of non-matching records than copying down </p>\n\n<pre><code>=IFERROR(MATCH(A2,'2_4'!$A$1:$A$79145,0),\"\")\n</code></pre>\n\n<p>Am I doing something wrong here?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 4495181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UtENP.jpg?s=128&g=1", "display_name": "Freeman Helmuth", "link": "https://stackoverflow.com/users/4495181/freeman-helmuth"}, "edited": false, "score": 0, "creation_date": 1431472594, "post_id": 30202621, "comment_id": 48511431, "body": "Duh! Why did I not see that property? I thought I Searched every single property."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 172, "user_id": 4495181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UtENP.jpg?s=128&g=1", "display_name": "Freeman Helmuth", "link": "https://stackoverflow.com/users/4495181/freeman-helmuth"}, "edited": false, "score": 0, "creation_date": 1431472916, "post_id": 30202621, "comment_id": 48511512, "body": "Well, there may be more to it than I described.  Apparently you can set the <code>Source</code> to a <code>Command</code> object.  But I don&#39;t generally use ADO, so wasn&#39;t motivated enough to investigate that one.  ;-)"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 0, "last_activity_date": 1431470157, "creation_date": 1431470157, "answer_id": 30202621, "question_id": 30202270, "link": "https://stackoverflow.com/questions/30202270/how-to-get-name-property-of-adodb-recordset/30202621#30202621", "title": "How to Get Name Property of ADODB Recordset?", "body": "<p>The <code>ADODB.Recordset.Source</code> property is the counterpart to the <code>DAO.Recordset.Name</code> property.</p>\n\n<p>If the recordset's data source is a table or saved query, those properties will give you its name.  If the data source is a <code>SELECT</code> statement, those properties will show you the statement text.</p>\n"}], "owner": {"reputation": 172, "user_id": 4495181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UtENP.jpg?s=128&g=1", "display_name": "Freeman Helmuth", "link": "https://stackoverflow.com/users/4495181/freeman-helmuth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "accepted_answer_id": 30202621, "answer_count": 1, "score": 1, "last_activity_date": 1431470188, "creation_date": 1431468478, "last_edit_date": 1431470188, "question_id": 30202270, "link": "https://stackoverflow.com/questions/30202270/how-to-get-name-property-of-adodb-recordset", "title": "How to Get Name Property of ADODB Recordset?", "body": "<p>How do I get the name of an ADODB recordset in VBA?\nDAO has a .Name property but ADODB does not seem to have that.</p>\n\n<p>At first I assumed there is no such property but now, I think there has to be.</p>\n\n<p>If you set the recordset of a form programmatically, and then close and save the form WITHOUT setting the recordset property to nothing, the forms recordsource property will be filled out with the name of the recordset that you opened.</p>\n\n<p>Example:</p>\n\n<p>I set the recordset like this</p>\n\n<pre><code>Set Me.Recordset = oDal.OpenRecordset(\"tblOptionList\")\n</code></pre>\n\n<p>If I do not do </p>\n\n<pre><code>Set Me.Recordset = Nothing\n</code></pre>\n\n<p>tblOptionList will be in the forms recordsource property</p>\n\n<p>Here is my function that opens Recordsets</p>\n\n<pre><code>Public Function OpenRecordset(ByVal Tablename As String) As         ADODB.Recordset\n    Dim FilePath As String\n    Dim rs As ADODB.Recordset\n\n    Set rs = New ADODB.Recordset\n\n    rs.CursorLocation = adUseClient\n\n    FilePath = GetFilePath(Tablename)\n\n    'Try to get a connection\n    Connection\n\n    If ConnOpen Then\n        Set rs.ActiveConnection = pDbConn\n        rs.CursorType = adOpenKeyset\n        rs.LockType = adLockOptimistic\n        rs.Open Tablename\n\n        If pEnableOffline Then\n            SaveOffline rs, Tablename\n        End If\n    Else\n        'No connection, check for offline availablility\n\n        If Dir(FilePath) &lt;&gt; \"\" And pEnableOffline Then\n            rs.Open FilePath\n        Else\n            MsgBox \"No Offline data and Server is Unavailable\"\n            Exit Function\n        End If\n    End If\n\n    Set OpenRecordset = rs\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1431545069, "post_id": 30202281, "comment_id": 48551008, "body": "Thanks Dan;I have seen that solution, and I think it may be what I will do. I was hoping for something in VBA, but I know the Max formula will do the trick. My issue was this chart is part of a dashboard and I want it to look as clean as possible. There are of course ways to hide anything extraneous though."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1431468532, "creation_date": 1431468532, "answer_id": 30202281, "question_id": 30202055, "link": "https://stackoverflow.com/questions/30202055/vba-to-find-maximum-value-in-a-chart/30202281#30202281", "title": "VBA to find maximum value in a chart", "body": "<p>In the past I have done something similar, use a formula in column D to identify the largest number in Column C and B and make it a value high on your chart if the result is true.</p>\n\n<p>Add Column D as a series to the chart.</p>\n\n<p>Change the chart type on that series only to a scatter chart or something that puts points up there.</p>\n\n<p>You can put a label on or simply put the amount showing above the plotted point.</p>\n\n<p>You don't need VBA for this.</p>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1431652451, "post_id": 30241957, "comment_id": 48600419, "body": "Thanks for reporting back @Matthew Ingle, it&#39;s always good to get the final solution in here for anyone who is searching for similar problems down the track. Glad you got it all worked out :)."}], "tags": [], "owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "is_accepted": false, "score": 1, "last_activity_date": 1431619465, "creation_date": 1431619465, "answer_id": 30241957, "question_id": 30202055, "link": "https://stackoverflow.com/questions/30202055/vba-to-find-maximum-value-in-a-chart/30241957#30241957", "title": "VBA to find maximum value in a chart", "body": "<p>You might be interested to know I found a solution that works for me. First, I added columns D and E using the formula =IF(C2=MAX(C$2:C$62),C2,NA()) and =IF(C2=MAX(C$2:C$62),B2,NA()), this gave me the point on the graph for both lines B and C where B was maximum. I then formatted the graph so that these points had data callouts (a request from the client). Finally, I set columns D and E to have white font, to match the background so the appear invisible. I don't love this step, but I don't want the client to see the extra rows of #NA, etc.</p>\n\n<p>The basic VBA for data callout is     ActiveChart.FullSeriesCollection(5).Select\nActiveChart.SetElement (msoElementDataLabelCallout) </p>\n\n<p>Where the series is 5 (column E) and I'm putting a data callout on the graphed point, which happens to be the maximum of column 3.</p>\n"}], "owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1431619465, "creation_date": 1431467444, "question_id": 30202055, "link": "https://stackoverflow.com/questions/30202055/vba-to-find-maximum-value-in-a-chart", "title": "VBA to find maximum value in a chart", "body": "<p>I have a range of data columns A, B, and C. I have displayed as a line graph with B as the primary axis and C as the secondary axis. Column A is the category axis. I want to find the maximum value of column C and put a data callout on the point that is the maximum of column C and where column B occurs. </p>\n\n<p>I know this sounds confusing. In this example, the maximum of Column C occurs at Point 27 (or 1.50% on the category axis). I would like a dot at point 27 for both Column B and C.</p>\n\n<p>Column A is percentage from -5.00 to 10.00 incremented at .25%. Columns B and C are plotted against the change.</p>\n"}, {"tags": ["excel", "ms-access", "copy-paste", "data-objects", "vba"], "answers": [{"comments": [{"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1431467793, "post_id": 30202068, "comment_id": 48509801, "body": "1. Did not work. I tried it with sleep(milliseconds) and it doesn&#39;t work. Doing CTRL+C manually works."}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1431467826, "post_id": 30202068, "comment_id": 48509812, "body": "2. I mean &quot;don&#39;t ask&quot; with the copy/pasting Access form data. If you have a better solution to SendKeys, I&#39;d like to hear it!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1431467920, "post_id": 30202068, "comment_id": 48509842, "body": "BTW did you try <code>SendKeys &quot;^{C}&quot;</code> instead of <code>.SendKeys &quot;^C&quot;</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1431467956, "post_id": 30202068, "comment_id": 48509864, "body": "Already posted it :) You may have to refresh the page to see it :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1431468084, "post_id": 30202068, "comment_id": 48509923, "body": "Using API&#39;s is a more complex but reliable thing unlike <code>Sendkeys</code>. I would recommend reading about it :)"}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1431468132, "post_id": 30202068, "comment_id": 48509941, "body": "APIs get long and confusing. Do you have an example for copy and pasting without me searching for a solution taking as long as I have searched for this SendKeys solution?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1431468320, "post_id": 30202068, "comment_id": 48510016, "body": "Once you have the <code>Hwnd</code>, using the code that I gave, you will have to then use <code>FindWindowEx</code> API to find the <code>Hwnd</code> of the control from where you want to copy and then use <a href=\"http://www.devx.com/vb2themax/Tip/18632\" rel=\"nofollow noreferrer\">This</a>. I am afraid, I don&#39;t have a ready code for you"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "edited": false, "score": 0, "creation_date": 1431469442, "post_id": 30202068, "comment_id": 48510441, "body": "@icebird76 really, spend some more time and use the API. What you ask is possible by API. Sure the SendKeys is quicker, but there are plenty of reasons why your send keys is dangerous. I highly suggest you to follow Siddarth&#39;s suggestion, longer but once for life."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1431469663, "post_id": 30202068, "comment_id": 48510511, "body": "P.s. What is &quot;mydata&quot;? Are you sure the failure is on the SendKeys and not rather on where you try to get the clipboard content from?"}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1431470304, "post_id": 30202068, "comment_id": 48510745, "body": "@Matteo NNZ I use a Dim mydata As New msForms.DataObject"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1431469093, "last_edit_date": 1495540269, "creation_date": 1431467509, "answer_id": 30202068, "question_id": 30202031, "link": "https://stackoverflow.com/questions/30202031/excel-vba-application-sendkeys-c-true-not-working/30202068#30202068", "title": "Excel VBA application.sendkeys &quot;^C&quot;, True not working", "body": "<p>Though I hate <code>Sendkeys</code> and was wondering whether I should ask you about it but since you said not to ask why, I will keep my trap shut. :P</p>\n\n<p>Try this small fix... If this works then that means, you need to give it some time before issuing the next sendkeys command.</p>\n\n<pre><code>Sub Sample()\n    '\n    '~~&gt; Rest of your code\n    '\n\n    Application.SendKeys \"{TAB}\", True\n\n    Wait 2\n\n    Application.SendKeys \"^{C}\", True\n\n    '\n    '~~&gt; Rest of your code\n    '\nEnd Sub\n\nPrivate Sub Wait(ByVal nSec As Long)\n    nSec = nSec + Timer\n    While nSec &gt; Timer\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>what would be a better solution?</p>\n</blockquote>\n\n<p>Use APIs as shown <a href=\"http://www.siddharthrout.com/2011/10/23/vbavb-netvb6click-opensavecancel-button-on-ie-download-window/\" rel=\"nofollow noreferrer\">Here</a>. This doesn't directly answer your question but it explains how the concept works.</p>\n\n<p>So applying that would be something like this</p>\n\n<pre><code>Private Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n(ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nDim Ret As Long\n\nSub Sample()\n    Ret = FindWindow(vbNullString, \"Microsoft Access - Filename that is constant\")\n\n    If Ret &lt;&gt; 0 Then\n        MsgBox \"Window Found\"\n    Else\n        MsgBox \"Window Not Found\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>If you wish to become good at API\u2019s like <code>FindWindow</code>, <code>FindWindowEx</code> and <code>SendMessage</code> then get a tool that gives you a graphical view of the system\u2019s processes, threads, windows, and window messages. For Ex: <code>uuSpy</code> or <code>Spy++</code>. Another <a href=\"https://stackoverflow.com/questions/16174469/unprotect-vbproject-from-vb-code/16176557#16176557\">example</a> which demonstrates how this API is used.</p>\n"}, {"tags": [], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "is_accepted": true, "score": 0, "last_activity_date": 1431553101, "creation_date": 1431553101, "answer_id": 30225617, "question_id": 30202031, "link": "https://stackoverflow.com/questions/30202031/excel-vba-application-sendkeys-c-true-not-working/30225617#30225617", "title": "Excel VBA application.sendkeys &quot;^C&quot;, True not working", "body": "<p>I figured it out. I copied the code from here: <a href=\"http://www.vbaexpress.com/forum/showthread.php?38826-SendInput()-in-Excel-64Bit\" rel=\"nofollow\">http://www.vbaexpress.com/forum/showthread.php?38826-SendInput()-in-Excel-64Bit</a>\nI changed VkkeyMenu to VbKeyControl and the \"f\" key to \"C\". I know it could be simplified to take up less lines, but I'd rather not mess with it if it works like the saying \"If it ain't broke, don't fix it.\" Code:</p>\n\n<pre><code>Private Declare PtrSafe Function SendInput Lib \"user32\" (ByVal nInputs As LongPtr, pInputs As Any, ByVal cbSize As LongPtr) As LongPtr\nPrivate Declare PtrSafe Function VkKeyScan Lib \"user32\" Alias \"VkKeyScanA\" (ByVal cChar As Byte) As Integer\nPrivate Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nPrivate Type KeyboardInput '   creating variable type\ndwType As Long '   input type (keyboard or mouse)\nwVk As Integer '   the key to press/release as ASCSI scan code\nwScan As Integer '   not required\ndwFlags As Long '   specify if key is pressed or released\ndwTime As Long '   not required\ndwExtraInfo As Long '   not required\ndwPadding As Currency '   only required for mouse inputs\nEnd Type\n\n\n\n' SendInput constants\nPrivate Const INPUT_KEYBOARD As Long = 1\n\n\nPrivate Const KEYEVENTF_EXTENDEDKEY As Long = 1\nPrivate Const KEYEVENTF_KEYUP As Long = 2\n\n\n' Member variables\n\n\nPrivate TheKeys() As KeyboardInput\nPrivate NEvents As Long\n\n\n\n\nSub testage()\n\n\nReDim TheKeys(0 To 3)\n\n\nWith TheKeys(0)\n\n    .dwType = INPUT_KEYBOARD 'operation type\n    .wVk = vbKeyControl 'press CTRL key\n\nEnd With\n\n\nWith TheKeys(1)\n\n\n    .dwType = INPUT_KEYBOARD ' operation\n    .wVk = VkKeyScan(Asc(\"C\")) 'press chr key\n\nEnd With\n\n\nWith TheKeys(2)\n\n    .dwType = INPUT_KEYBOARD 'operation type\n    .wVk = VkKeyScan(Asc(\"C\"))\n    .dwFlags = KEYEVENTF_KEYUP 'release chr key\n\nEnd With\n\n\nWith TheKeys(3)\n\n\n    .dwType = INPUT_KEYBOARD ' operation type\n    .wVk = vbKeyControl\n    .dwFlags = KEYEVENTF_KEYUP 'release CTRL Key\n\n\nEnd With\nCall SendInput(4, TheKeys(0), Len(TheKeys(0)))\n\n\nErase TheKeys\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10833, "favorite_count": 2, "accepted_answer_id": 30225617, "answer_count": 2, "score": 1, "last_activity_date": 1431553101, "creation_date": 1431467307, "last_edit_date": 1531161705, "question_id": 30202031, "link": "https://stackoverflow.com/questions/30202031/excel-vba-application-sendkeys-c-true-not-working", "title": "Excel VBA application.sendkeys &quot;^C&quot;, True not working", "body": "<p>I am using Excel VBA to copy text selection from an Access file (I'd prefer not to get into details as to why). I have it in a Do While loop that SHOULD press the tab key (works), then copies the data (fails), puts it into the clipboard (works), and sets the clipboard information to a variable (works), which then, for debugging purposes, does a debug.print of the variable (works). This is to cycle through a form to get to a \"base point\" where I can 100% use tabs and such to navigate to other parts of the form. See code please:</p>\n\n<pre><code>AppActivate (\"Microsoft Access - Filename that is constant\")\n\nX = 0\nDo While X &lt; 14\nApplication.SendKeys \"{TAB}\", True\nApplication.SendKeys \"^C\", True\n\nSleep (500)\n\nmydata.GetFromClipboard\ncb = mydata.GetText\n\nDebug.Print (cb)\nIf Len(cb) = 5 Then\nX = 14\nEnd If\nX = X + 1\nLoop\nSet mydata = Nothing\n</code></pre>\n\n<p>I've tried getting this to work, but to no avail. What am I doing wrong or perhaps what would be a better solution?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 528, "user_id": 3657197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trSj0.jpg?s=128&g=1", "display_name": "Pupa Rebbe", "link": "https://stackoverflow.com/users/3657197/pupa-rebbe"}, "edited": false, "score": 1, "creation_date": 1431467660, "post_id": 30202007, "comment_id": 48509757, "body": "try adding <code>Application.ScreenUpdating = False</code> before the <code>For</code> loop"}], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "is_accepted": true, "score": 0, "last_activity_date": 1431470015, "creation_date": 1431470015, "answer_id": 30202592, "question_id": 30202007, "link": "https://stackoverflow.com/questions/30202007/how-to-construct-a-new-word-doc-in-vba-line-by-line-without-screen-flashes/30202592#30202592", "title": "How to construct a new Word Doc in VBA line by line without screen flashes", "body": "<p>Pupa Rebbe's solution of adding</p>\n\n<pre><code>Application.ScreenUpdating = False \n</code></pre>\n\n<p>before the \"For\" loop works, thanks!  A cursor flashes a little bit as it is working, but it's nothing like the annoying strobe effect I was getting.  </p>\n"}], "owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 30202592, "answer_count": 1, "score": 0, "last_activity_date": 1432923259, "creation_date": 1431467199, "last_edit_date": 1432923259, "question_id": 30202007, "link": "https://stackoverflow.com/questions/30202007/how-to-construct-a-new-word-doc-in-vba-line-by-line-without-screen-flashes", "title": "How to construct a new Word Doc in VBA line by line without screen flashes", "body": "<p>The following code works to build a new Word doc line by line, but the screen flashes each time a line is inserted.  I am basically generating a new document mostly comprised of a sorted list of snippets of text that I extract from an active document.  I have a program (more complicated than the below, but with the same flashing problem) that produces a fine result, but I do not want to suffer a seizure or induce seizures in others.  Is there a way to automate insertions into a document that is not the active window, or to display only the final result and not each step as it is completed?  </p>\n\n<p>Inserting the whole list as one long string variable, even if I can use newline characters to insert paragraphs, will not quite do the trick as the actual document I am building has various formatting changes for which automating Word seems like the most convenient option.  </p>\n\n<pre><code>Sub HelloWorlds()\n\ndim i As Long\n\nDocuments.Add DocumentType:=wdNewBlankDocument ' opens and puts cursor in a new doc\n\nFor i = 1 to 8\n\nSelection.InsertAfter (\"Hello World\" &amp; i)\nSelection.InsertParagraphAfter\n\nNext i\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["ms-access", "error-handling", "vba"], "comments": [{"owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1431471604, "post_id": 30201932, "comment_id": 48511154, "body": "@hansup The Docmd.runCommand... is located on many different controls and they all surrounded with a    if(Me.Dirty) then...end if. Also doing the Option Explicit still produced the same results"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1431477162, "post_id": 30203405, "comment_id": 48512673, "body": "This sounds good i&#39;ll try it. Just one more question. Sometimes it throws an error in other cases not only DoCmd.RunCommand acCmdSaveRecord. How can I determine the Err.Number for other errs to put in the Select Case  to ignore?"}, {"owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1431478320, "post_id": 30203405, "comment_id": 48512958, "body": "wow that feels like a duh moment ;) Thanks you have been lots of help!"}, {"owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1431534565, "post_id": 30203405, "comment_id": 48544844, "body": "So I just finally got around to implement this and it work great, the error was ignored. Seemly the Cancel = True was ignored as well. Everything I may have placed after the SaveRecord call in the cmdSave_Click() was still executed. This wasn&#39;t a behavior I wanted.  So instead of putting the error handler in the SaveRecord() sub, I tried putting it at the end of cmdSave_Click() sub and it worked perfect."}, {"owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1431535440, "post_id": 30203405, "comment_id": 48545375, "body": "I believe this is what is happening. Please correct me if I am wrong. I start the process by clicking on a button attached to cmdSave_click(). The form stops the procedure before it saves, cancels the save process if it needs to, not the entire cmdSave_click(). Since the error handling is processed and resumed in a different sub (no error passes through, right?) any Open form actions continue on. These action are not updates so they will not be canceled by the Cancel = true of the form_beforeupdate."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "edited": false, "score": 0, "creation_date": 1431535617, "post_id": 30203405, "comment_id": 48545478, "body": "Ah, you have other stuff going on in <code>cmdSave_click()</code> ... more than just <code>SaveRecord()</code>.  Then, yes, those other things would still happen."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1431475574, "last_edit_date": 1431475574, "creation_date": 1431475253, "answer_id": 30203405, "question_id": 30201932, "link": "https://stackoverflow.com/questions/30201932/how-can-i-remove-the-pesky-the-runcommand-action-was-canceled-dialog-box-after/30203405#30203405", "title": "How can I remove the pesky &quot;The runCommand action was canceled&quot; dialog box after a &quot;cancel = true&quot; statement", "body": "<p>You can add an error handler to trap and ignore error 2501, which is triggered when the form's <em>Before Update</em> event cancels <code>DoCmd.RunCommand acCmdSaveRecord</code> </p>\n\n<p>The following example is from my form which has a command button to save the current record.  It suppresses that <em>\"RunCommand action was canceled\"</em> message as I think you wish.  </p>\n\n<p>Since your form's code apparently calls <code>DoCmd.RunCommand acCmdSaveRecord</code> from multiple locations, replace each of those calls with <code>SaveRecord</code> as I did in <em>cmdSave_Click()</em>.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Compare Database\nOption Explicit ' &lt;-- NEVER troubleshoot VBA code without this!!!\n\nPrivate Sub cmdSave_Click()\n    'DoCmd.RunCommand acCmdSaveRecord\n    SaveRecord\nEnd Sub\n\nPrivate Sub SaveRecord()\n    Dim strMsg As String\n\nOn Error GoTo ErrorHandler\n\n    DoCmd.RunCommand acCmdSaveRecord\n\nExitHere:\n    Exit Sub\n\nErrorHandler:\n    Select Case Err.Number\n    Case 2501 ' The RunCommand action was canceled.\n        ' do nothing --&gt; just ignore the error\n    Case Else\n        ' notify user about any other error\n        strMsg = \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description _\n            &amp; \") in procedure SaveRecord\"\n        MsgBox strMsg\n    End Select\n    Resume ExitHere\nEnd Sub\n\nPrivate Sub Form_BeforeUpdate(Cancel As Integer)\n    If IsNull(Me.txtBlock_start.Value) Then\n        MsgBox \"You must enter a start time!\", vbOKOnly, \"Start Time\"\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "is_accepted": false, "score": 1, "last_activity_date": 1431538433, "creation_date": 1431538433, "answer_id": 30221682, "question_id": 30201932, "link": "https://stackoverflow.com/questions/30201932/how-can-i-remove-the-pesky-the-runcommand-action-was-canceled-dialog-box-after/30221682#30221682", "title": "How can I remove the pesky &quot;The runCommand action was canceled&quot; dialog box after a &quot;cancel = true&quot; statement", "body": "<p>I ended up doing this on a 'Save and Open the Receipts form' button.</p>\n\n<pre><code>Private Sub btnSaveOpenReceipts_Click()\n\n'''''SaveRecord'''''\nIf (Me.Dirty) Then\n    SaveRecord\nEnd If\n\n'''''OpenReciepts'''''\nIf (Me.Dirty) Then 'unsure it saved\nExit Sub\nElse\n'blah blah blah\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4893247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cafb3707b3d1eccbdd4ecf22418b130b?s=128&d=identicon&r=PG&f=1", "display_name": "adanthuis", "link": "https://stackoverflow.com/users/4893247/adanthuis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3424, "favorite_count": 0, "accepted_answer_id": 30203405, "answer_count": 2, "score": 2, "last_activity_date": 1431538433, "creation_date": 1431466944, "last_edit_date": 1431475350, "question_id": 30201932, "link": "https://stackoverflow.com/questions/30201932/how-can-i-remove-the-pesky-the-runcommand-action-was-canceled-dialog-box-after", "title": "How can I remove the pesky &quot;The runCommand action was canceled&quot; dialog box after a &quot;cancel = true&quot; statement", "body": "<p>On the Form_beforeupdate() event of my form \"Alias\" I have this...</p>\n\n<pre><code>If IsNull(Me.txtFName) And IsNull(Me.txtLName) Then\nMsgBox \"You must enter a contact!\", vbokayonly, \"Contact\"\nCancel = True\nEnd If\n</code></pre>\n\n<p>Anytime this cancels a runCommand code such as...</p>\n\n<pre><code>DoCmd.RunCommand acCmdSaveRecord \n</code></pre>\n\n<p>a dialog appears telling me that it was canceled. Is there a way to suppress those dialogs?</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 211, "user_id": 4893273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/723e3e317fcf70df3388481f9a55018e?s=128&d=identicon&r=PG&f=1", "display_name": "nwpulele", "link": "https://stackoverflow.com/users/4893273/nwpulele"}, "edited": false, "score": 0, "creation_date": 1431467589, "post_id": 30201904, "comment_id": 48509728, "body": "Glad to be of help :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1431466846, "creation_date": 1431466846, "answer_id": 30201904, "question_id": 30201767, "link": "https://stackoverflow.com/questions/30201767/how-to-deal-with-excel-popup-when-using-workbooks-openxml/30201904#30201904", "title": "How to deal with Excel popup when using Workbooks.OpenXML", "body": "<p>The problem is <code>xlXmlLoadImportToList</code>. It is an Excel Constant and not a VBScript Constant. It has a value <code>2</code>. You can check that in the <code>Immediate</code> window of Excel as shown below.</p>\n\n<p><img src=\"https://i.stack.imgur.com/pv6xA.jpg\" alt=\"enter image description here\"></p>\n\n<p>Try this :)</p>\n\n<pre><code>Const xlXmlLoadImportToList = 2\nSet myxl = createobject(\"excel.application\")\nmyxl.DisplayAlerts = False\nmyxl.Application.Visible = true\nmyxl.Workbooks.OpenXML \"C:\\Test.XML\",1,xlXmlLoadImportToList\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 4893273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/723e3e317fcf70df3388481f9a55018e?s=128&d=identicon&r=PG&f=1", "display_name": "nwpulele", "link": "https://stackoverflow.com/users/4893273/nwpulele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 30201904, "answer_count": 1, "score": 1, "last_activity_date": 1431468616, "creation_date": 1431466246, "last_edit_date": 1431468616, "question_id": 30201767, "link": "https://stackoverflow.com/questions/30201767/how-to-deal-with-excel-popup-when-using-workbooks-openxml", "title": "How to deal with Excel popup when using Workbooks.OpenXML", "body": "<p>I'm trying to use vbs to open XML via Excel.</p>\n\n<p>Below is my code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set myxl = createobject(\"excel.application\")\nmyxl.DisplayAlerts = False\nmyxl.Application.Visible = true\nmyxl.Workbooks.OpenXML \"SampleXML.XML\",1,xlXmlLoadImportToList\n</code></pre>\n\n<p>But when code runs, Excel will pop up an option to ask how to open this file.\nI'm sorry that I don't have enough reputation to post images. This popup will ask you whether open XML as \"As an XML table\" (which I want, but I don't want popup), \"As a read-only workbook\", \"Use the XML Source task pane\".</p>\n\n<p>How do I aviod this pop up?</p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 1, "user_id": 4893272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a60395eb25853fcf718a586fd32230?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Reiter", "link": "https://stackoverflow.com/users/4893272/justin-reiter"}, "edited": false, "score": 0, "creation_date": 1431466330, "post_id": 30201740, "comment_id": 48509163, "body": "Forgot my declarations:     Dim FindString As String     Dim Rng As Range     Dim r As Long, c As Long     Dim MandatoryValues As Variant     Dim MandatoryCount As Integer     Dim Check_Value As Variant"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1431466440, "post_id": 30201740, "comment_id": 48509210, "body": "You should <a href=\"https://stackoverflow.com/posts/30201740/edit\">edit</a> your post instead of adding valuable information in the comments."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1431466565, "post_id": 30201740, "comment_id": 48509264, "body": "<code>Check_Value</code> seems to rely on the <code>ActiveSheet</code> - are you sure the expected worksheet is active when this code runs?"}, {"owner": {"reputation": 916, "user_id": 4887664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZDjRP.jpg?s=128&g=1", "display_name": "Jonathan Larouche", "link": "https://stackoverflow.com/users/4887664/jonathan-larouche"}, "edited": false, "score": 0, "creation_date": 1431466832, "post_id": 30201740, "comment_id": 48509378, "body": "Why using ActiveSheet.Cells when you already have a reference to the cell that match your search (Rng). You can use Rng.offset(1,0).Value"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1431467006, "post_id": 30201740, "comment_id": 48509458, "body": "Your method of getting the value of the cell below the one found is sound,<b>as long as you don&#39;t have merged cells</b>. FWIW: you can skip the r and c variables and use this to get the value of the cell below: <code>Check_Value = Rng.Offset(1)</code>. Note: kudos for using the TypeName function and for reading the cell value into a variant. FYI, you might consider using some <code>And</code> and <code>Or</code> statements in your If blocks to reduce redundant code."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1431567149, "post_id": 30201740, "comment_id": 48559423, "body": "Are there any hidden rows between the Found cells and the supposed check value?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4893272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a60395eb25853fcf718a586fd32230?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Reiter", "link": "https://stackoverflow.com/users/4893272/justin-reiter"}, "edited": false, "score": 0, "creation_date": 1431561937, "post_id": 30204607, "comment_id": 48558089, "body": "Thank you for this improved code, it is much cleaner. It seems to be functioning, except my problem remains. It is able to find the string in the sheet and return the range, but the Check_Value variable is always empty. I can&#39;t for the life of me figure out why."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 1, "user_id": 4893272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a60395eb25853fcf718a586fd32230?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Reiter", "link": "https://stackoverflow.com/users/4893272/justin-reiter"}, "edited": false, "score": 0, "creation_date": 1431566517, "post_id": 30204607, "comment_id": 48559257, "body": "You may want to use a Range object instead of using it&#39;s <code>.Value</code> or <code>.Text</code>. Can you put a Breakpoint [F9] on the line <code>Check_Value = ...</code> and do a manual check in Immediate window?"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "reply_to_user": {"reputation": 1, "user_id": 4893272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a60395eb25853fcf718a586fd32230?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Reiter", "link": "https://stackoverflow.com/users/4893272/justin-reiter"}, "edited": false, "score": 0, "creation_date": 1431640040, "post_id": 30204607, "comment_id": 48596744, "body": "@JustinReiter Try running your code on a new, completely unformatted sheet with just one mandatory value."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1431483966, "creation_date": 1431483966, "answer_id": 30204607, "question_id": 30201740, "link": "https://stackoverflow.com/questions/30201740/excel-vba-error-handling-and-string-searching/30204607#30204607", "title": "Excel VBA - error handling and string searching", "body": "<p>Assuming the the cell below the <strong>MandatoryValues</strong> (array of String) is the <code>Check_Value</code>, you should consider simplifying your code like below (with some tweaks):</p>\n\n<pre><code>With ActiveSheet.UsedRange\n    'For i = 1 To MandatoryCount\n    For Each FindString In MandatoryValues\n        'FindString = MandatoryValues(i - 1)\n        Set Rng = .Find(What:=FindString, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        ' If error occurs you may use: What:=CStr(FindString)\n        If Not Rng Is Nothing Then\n            'r = Rng.Row\n            'c = Rng.Column\n            'Check_Value = ActiveSheet.Cells(r + 1, c).Value\n            Check_Value = Rng.Offset(1, 0).Value ' &lt;-- Remove .Offset() if not checking the cell below it\n            'data_type = TypeName(Check_Value)\n            Select Case TypeName(Check_Value)\n                Case \"String\", \"Double\", \"Date\"\n                    If Check_Value = \"\" Or Check_Value = 0 Then\n                        If MsgBox(FindString &amp; \" Not Specified\", vbOKOnly + vbExclamation, \"ERROR\") = vbOK Then Exit Sub\n                    End If\n                Case Else\n                    Debug.Print \"\"\"\" &amp; FindString &amp; \"\"\" at \" &amp; Rng.Address &amp; \" is of type \" &amp; TypeName(Check_Value)\n            End Select\n        End If\n    'Next i\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4893272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a60395eb25853fcf718a586fd32230?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Reiter", "link": "https://stackoverflow.com/users/4893272/justin-reiter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 949, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431563257, "creation_date": 1431466140, "last_edit_date": 1431563257, "question_id": 30201740, "link": "https://stackoverflow.com/questions/30201740/excel-vba-error-handling-and-string-searching", "title": "Excel VBA - error handling and string searching", "body": "<p>Background:</p>\n\n<p>I have a spreadsheet which is acting as an entry form. There are numerous entry fields, with a string in one cell denoting the title of the quantity and a value of the quantity of the cell below it. </p>\n\n<p>Only some of these fields are mandatory. I am trying to write a macro to cycle through all mandatory fields and ensure there is a value present. </p>\n\n<p>Important Variables:</p>\n\n<p>MandatoryValues = array of strings containing the mandatory field titles</p>\n\n<p>MandatoryCount = the number of mandatory fields</p>\n\n<p>FindString = the field title as a string</p>\n\n<p>r = the row of the field title</p>\n\n<p>c = the column of the field title</p>\n\n<p>Check_Value = the value of the cell beneath the field title which contains the desired value</p>\n\n<p>Below is my code:</p>\n\n<pre><code>For i = 1 To MandatoryCount\n    FindString = MandatoryValues(i - 1)\n        With ActiveSheet.UsedRange\n            Set Rng = .Find(What:=FindString, _\n                            After:=.Cells(.Cells.Count), _\n                            LookIn:=xlValues, _\n                            LookAt:=xlWhole, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n            If Not Rng Is Nothing Then\n                r = Rng.Row\n                c = Rng.Column\n                Check_Value = ActiveSheet.Cells(r + 1, c).Value\n                data_type = TypeName(Check_Value)\n\n                If data_type = \"String\" Then\n                    If Check_Value = \"\" Then\n                        If MsgBox(FindString &amp; \" Not Specified\", vbOKOnly, \"ERROR\") = vbOK Then\n                            Exit Sub\n                        End If\n                    End If\n                End If\n\n                If data_type = \"Double\" Then\n                    If Check_Value = \"\" Then\n                        If MsgBox(FindString &amp; \" Not Specified\", vbOKOnly, \"ERROR\") = vbOK Then\n                            Exit Sub\n                        End If\n                    End If\n                End If\n\n                If data_type = \"Date\" Then\n                    If Check_Value = 0 Then\n                        If MsgBox(FindString &amp; \" Not Specified\", vbOKOnly, \"ERROR\") = vbOK Then\n                            Exit Sub\n                        End If\n                    End If\n                End If\n\n                Else\n            End If\n        End With\nNext i\n</code></pre>\n\n<p>For each loop, I search the UsedRange in the sheet for the title, and locate its position with .Find. This works fine. My problem is that as I am stepping through the code, I can see FindString, r and c changing with each iteration, but Check_Value is always empty. I feel like it's something dumb but I can't see it. Any suggestions? </p>\n\n<p>Edit: I have added the code snippet</p>\n\n<pre><code>If Not Rng Is Nothing Then\n            Address = Rng.Address\n            Address_Below = Rng.Offset(1, 0)\n</code></pre>\n\n<p>The Address value updates for every iteration, and it is correctly finding the string in the sheet and retrieving the range. However, the Address_Below variable is always empty. I have no idea why this would be. Any ideas?</p>\n"}, {"tags": ["xml", "vba", "vbscript", "apostrophe"], "comments": [{"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1431466201, "post_id": 30201704, "comment_id": 48509097, "body": "What error are you getting?"}, {"owner": {"reputation": 403, "user_id": 770344, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0583f27e36d34a74a7428d6f375bde79?s=128&d=identicon&r=PG", "display_name": "user770344", "link": "https://stackoverflow.com/users/770344/user770344"}, "reply_to_user": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1431468245, "post_id": 30201704, "comment_id": 48509982, "body": "Updated with error above"}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 770344, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0583f27e36d34a74a7428d6f375bde79?s=128&d=identicon&r=PG", "display_name": "user770344", "link": "https://stackoverflow.com/users/770344/user770344"}, "edited": false, "score": 0, "creation_date": 1431468643, "post_id": 30202227, "comment_id": 48510148, "body": "That worked! I figured I needed the double quotes but thought I still needed to include the apostrophe for the node value name. The reason the format is like that is because of other things the program is doing that requires it. Trust me I would rather have it the other way."}], "tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": true, "score": 2, "last_activity_date": 1431468251, "creation_date": 1431468251, "answer_id": 30202227, "question_id": 30201704, "link": "https://stackoverflow.com/questions/30201704/checking-a-node-with-an-apostrophe-in-the-value/30202227#30202227", "title": "Checking a node with an apostrophe in the value", "body": "<p>Use double quotes around the string that may contain single quotes. In VBScript nested double quotes in strings are escaped by doubling them:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set CheckHeight = objDom.SelectSingleNode(\"//IDNum/LastName[@LName = '\" &amp; _\n  LastName.Text &amp; \"']/FirstName[@FName='\" &amp; FirstName.Text &amp; _\n  \"']/DateOfBirth[@DOB='\" &amp; Dob.Text &amp; _\n  \"']/Height[.=\"\"\" &amp; ComboBox5.Value &amp; \"\"\"]\")\n               ^^                       ^^\n</code></pre>\n\n<p>As a side note, your data format is seriously messed up. Your entire hierarchy should rather be attributes of the same node:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Person LastName=\"Rodriguez Jesus Luis\"\n    FirstName=\"Armondo\"\n    DateOfBirth=\"7/10/1975\"\n    Hair=\"Black\"\n    Eyes=\"Brown\"\n    Weight=\"150 - 175 lbs\"\n    Height=\"5'6 - 5'9\"\n/&gt;\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 770344, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0583f27e36d34a74a7428d6f375bde79?s=128&d=identicon&r=PG", "display_name": "user770344", "link": "https://stackoverflow.com/users/770344/user770344"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 30202227, "answer_count": 1, "score": 0, "last_activity_date": 1431468426, "creation_date": 1431465956, "last_edit_date": 1431468426, "question_id": 30201704, "link": "https://stackoverflow.com/questions/30201704/checking-a-node-with-an-apostrophe-in-the-value", "title": "Checking a node with an apostrophe in the value", "body": "<p>I have a set of code that searches for a person of a particular height that the user selects in a combo box, after which removes all the subjects that don't match in a list. The values for the combo box are like this: <code>5'0-5'5</code>. My problem is the apostrophes in the <code>5'0-5'5</code> are throwing up errors. Here is my code</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If ComboBox5.Value &lt;&gt; \"\" Then\n    i = 0  \n\n    Do While i &lt;= ListBox26.ListCount - 1\n        Set CheckHeight = objDom.SelectSingleNode(\"//IDNum/LastName[@LName = '\" _\n            &amp; LastName.Text &amp; \"']/FirstName[@FName='\" &amp; FirstName.Text _\n            &amp; \"']/DateOfBirth[@DOB='\" &amp; Dob.Text &amp; \"']/Height[.='\" _\n            &amp; ComboBox5.Value &amp; \"']\")\n\n        If CheckHeight Is Nothing Then\n            ListBox26.RemoveItem (i)\n        Else\n            i = i + 1\n        End If\n    Loop\n</code></pre>\n\n<p>The XML looks like this:</p>\n\n<pre><code>&lt;LastName LName=\"Rodriguez Jesus Luis\"&gt;\n  &lt;FirstName FName=\"Armondo\"&gt;\n    &lt;DateOfBirth DOB=\"7/10/1975\"&gt;\n       &lt;Hair&gt;Black&lt;/Hair&gt; \n       &lt;Eyes&gt;Brown&lt;/Eyes&gt; \n       &lt;Weight&gt;150 - 175 lbs&lt;/Weight&gt; \n       &lt;Height&gt;5'6 - 5'9&lt;/Height&gt; \n    &lt;/DateOfBirth&gt;\n  &lt;/FirstName&gt;\n&lt;/LastName&gt;\n</code></pre>\n\n<p>I have tried replacing one apostrophe \"'\" with two \"''\", tried Chr(39), tried <code>&amp;apos;</code> but still errors. </p>\n\n<p>I can get it to work if I use <code>getElementsByTagName</code> and write a bunch more code to compare and remove, but I was hopping to use the above code as it works with other all the other fields I am using.</p>\n\n<p>The error I am getting is:</p>\n\n<blockquote>\n  <p>Expected token ']' found 'NUMBER'.</p>\n  \n  <p>//IDNum/LastName[@LName = 'Rodriguez Jesus Luis']/FirstName[@FName='Armondo']/DateOfBirth[@DOB='7/10/1975']/Height[.='5'-->0&lt;-- - 5'3']</p>\n</blockquote>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 4214904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avbwl.png?s=128&g=1", "display_name": "cherdarchuk", "link": "https://stackoverflow.com/users/4214904/cherdarchuk"}, "is_accepted": false, "score": 2, "last_activity_date": 1431629576, "last_edit_date": 1431629576, "creation_date": 1431470041, "answer_id": 30202598, "question_id": 30201597, "link": "https://stackoverflow.com/questions/30201597/how-to-iteratively-apply-a-function-to-groups-of-data-in-excel/30202598#30202598", "title": "How to iteratively apply a function to groups of data in Excel", "body": "<p>Well as a new excel user you've jumped straight into the wonderful and perplexing world of array formula's.</p>\n\n<p>First you need to prep your data a bit. All those 1s, 2s, 3s and 4s need to be in a column of their own, all those in group 1 need a number, and everything needs to be named consistently ('Green' vs 'Green Selection'). We could make the formula even more complex to account for these idiosyncracies in your data, but cleaning it will make understanding it and the formulas easier.</p>\n\n<p><img src=\"https://i.stack.imgur.com/n75Q6.png\" alt=\"\"></p>\n\n<p>Now we put the \"Surpass Object\" we want to calculate the distance from in Cell <code>I1</code> (in this case 'Blue Selection') and the following formula into cell <code>I2</code> being sure to hold <code>ctrl+shift+enter</code> when we enter it.</p>\n\n<pre><code>=SQRT((INDEX($A$2:$A$33,MATCH(1,($G$2:$G$33=I$1)*($H$2:$H$33=$H2),0))-$A2)^2+(INDEX($B$2:$B$33,MATCH(1,($G$2:$G$33=I$1)*($H$2:$H$33=$H2),0))-$B2)^2)\n</code></pre>\n\n<p>This will get us the  distance between the x and y co-ordinates for each. You'll need to adjust the formula to add the z-coordinate to the calculation if you need it.</p>\n\n<p>So what is the fancy index-match formula doing? In the first instance it grabs the cell in column a, that matches both the 'Surpass Object' in the column header (cell <code>J$1</code>) and the group of the current row (cell <code>$H2</code>)</p>\n\n<p>Now you can just fill in the remaining headers and fill the formula right and down to get your matrices of differences\n<img src=\"https://i.stack.imgur.com/eSozw.png\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 4687872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e53cb09a9e3834645cc6bdb30f0a4ff6?s=128&d=identicon&r=PG&f=1", "display_name": "Harry B", "link": "https://stackoverflow.com/users/4687872/harry-b"}, "edited": false, "score": 0, "creation_date": 1431534298, "post_id": 30202637, "comment_id": 48544664, "body": "Thanks! I think this is the way to go but one thing is in your formula, I believe the distance in the Y axis is measured twice, the should be (C$x-Cx)^2 instead of B again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1431534439, "post_id": 30202637, "comment_id": 48544758, "body": "This is the formula from your description in the question. You can certainly change it. The &#215; (times symbol or Chr(215)) will be replaced with the value in <i>rw</i>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1431470262, "creation_date": 1431470262, "answer_id": 30202637, "question_id": 30201597, "link": "https://stackoverflow.com/questions/30201597/how-to-iteratively-apply-a-function-to-groups-of-data-in-excel/30202637#30202637", "title": "How to iteratively apply a function to groups of data in Excel", "body": "<p>Applying some VBA to loop through the matches to <em>Full</em> with a wildcard and reset the formula's starting row for each iteration should be the best way to go with this.</p>\n\n<pre><code>Sub Group_Formula()\n    Dim frmla As String, rw As Long, rws As Long, n As Long, cnt As Long\n\n    frmla = \"=SQRT((A$\u00d7-A\u00d7)^2+(B$\u00d7-B\u00d7)^2+(B$\u00d7-B\u00d7)^2)\"\n\n    With ActiveSheet '&lt;-set to worksheet name properly!\n        For cnt = 1 To Application.CountIf(.Columns(\"G\"), \"Full*\")\n            rw = Application.Max(2, rw)\n            rws = Application.Match(\"Full*\", .Cells(rw, \"G\").Resize(Rows.Count - rw, 1), 0)\n            .Cells(rw, \"H\").Resize(rws, 1).Formula = Replace(frmla, Chr(215), rw)\n            rw = rw + rws\n        Next cnt\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The results should resemble the following.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/HT3ay.png\" alt=\"Group Formulas and fill column\"></p>\n"}, {"tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1431471343, "last_edit_date": 1431471343, "creation_date": 1431471037, "answer_id": 30202757, "question_id": 30201597, "link": "https://stackoverflow.com/questions/30201597/how-to-iteratively-apply-a-function-to-groups-of-data-in-excel/30202757#30202757", "title": "How to iteratively apply a function to groups of data in Excel", "body": "<p>You need to handle the <code>A$2</code>, <code>B$2</code> references with a function that will calculate the row. You can use reference functions like <code>INDEX</code>, <code>INDIRECT</code>or <code>OFFSET</code> to accomplish what you need. The last two are volatile, so keep in mind they recalculate every time a value changes in your sheet. <code>INDEX</code> is more efficient.</p>\n\n<p>It isn't clear if your data includes the group number because the numbers at the end of the row are inconsistent. If they are consistent in your data you can use them. Supposing the group number is in column <code>I</code>, This <code>INDEX</code> formula will return the correct <code>A$2</code> reference:</p>\n\n<pre><code>INDEX($A$2:$A$33,1+((I2-1)*8))\n</code></pre>\n\n<p>Or with the <code>OFFSET</code> function:</p>\n\n<pre><code>OFFSET($A$2,(I2-1)*8,0)\n</code></pre>\n\n<p>Otherwise, (without using the group number) you can use the <code>ROWS</code> function to produce a similar result:</p>\n\n<pre><code>INDEX($A$2:$A$33,1+QUOTIENT(ROWS(A$2:A2)-1,8)*8)\n</code></pre>\n\n<p>The <code>8</code> in all the formulas represent the number of items in a group.</p>\n\n<p>And the full formula would be:</p>\n\n<pre><code>=SQRT((INDEX($A$2:$A$33,1+QUOTIENT(ROWS(A$2:A2)-1,8)*8)-A2)^2+(INDEX($B$2:$B$33,1+QUOTIENT(ROWS(B$2:B2)-1,8)*8)-B2)^2+(INDEX($C$2:$C$33,1+QUOTIENT(ROWS(C$2:C2)-1,8)*8)-C2)^2)\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 4687872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e53cb09a9e3834645cc6bdb30f0a4ff6?s=128&d=identicon&r=PG&f=1", "display_name": "Harry B", "link": "https://stackoverflow.com/users/4687872/harry-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 2, "accepted_answer_id": 30202637, "answer_count": 3, "score": 2, "last_activity_date": 1431629576, "creation_date": 1431465464, "last_edit_date": 1531161705, "question_id": 30201597, "link": "https://stackoverflow.com/questions/30201597/how-to-iteratively-apply-a-function-to-groups-of-data-in-excel", "title": "How to iteratively apply a function to groups of data in Excel", "body": "<p>So I'm quite new to using excel and it's possible I missed over a question like this that was already answered, but what I am trying to do is measure the distances between groups of points in a large excel sheet. </p>\n\n<p>I've tried the standard way of writing a function and dragging it down but the way the function changes when I move it down is not what I need and I can't seem to figure how how I might fix this so I think a macro might be the solution.</p>\n\n<p>The data is groups of 8 measurements with every group having one Blue, Red, Yellow, Csome, Overlap, Green, Cyan, and Full object. The XYZ coordinate of each object is listed in the first three columns and using a simple distance formula I am trying to measure the distance between each object and all the other objects in it's same group. Eg. Blue to Red, Yellow, Csome... etc. Then again for Blue2 to Red2, Yellow2, Csome2... and Blue3 to Red3, Yellow3, Csome3... and so fourth.</p>\n\n<p>However, when I put the following formula in where my desired output should be and try to drag it down, obviously I run into some problems. For the first Blue against it's whole group, I begin with     =SQRT((A$2-A2)^2+(B$2-B2)^2+(B$2-B2)^2)  and drag it down so it cycles through row 2 versus rows 3,4,5,6,7,8,and 9. The issue arises when I get to row 10 which contains Blue2. This should not be compared with Blue1 but rather begins a new group. How then can I get the cycle to restart at row 10 so that the new group beginning with Blue 2 is compared within that group, eg the XYZ in row 10 to XYZ in 11, 12, 13...\n:</p>\n\n<pre><code>Position X  Position Y  Position Z  Unit    Category    Collection    Surpass Object\n\n16.38   41.20   4436.18 um  Surface Position    Blue Selection\n17.35   40.83   4436.17 um  Surface Position    Red Selection \n15.93   40.62   4435.93 um  Surface Position    Yellow Selection\n16.22   40.80   4436.03 um  Surface Position    Csome1\n17.97   42.23   4435.46 um  Surface Position    Overlap\n15.37   40.87   4436.03 um  Surface Position    Green Selection \n15.44   40.04   4436.39 um  Surface Position    Cyan Selection \n17.97   42.23   4435.46 um  Surface Position    Full 1\n15.57   36.20   4435.75 um  Surface Position    Blue Selection 2\n12.83   35.19   4435.33 um  Surface Position    Red Selection 2\n15.76   37.25   4435.74 um  Surface Position    Yellow Selection 2\n14.94   36.17   4435.65 um  Surface Position    Csome2\n15.99   36.78   4436.34 um  Surface Position    Overlap 2\n14.23   36.26   4435.57 um  Surface Position    Green Selection 2\n13.61   36.96   4436.09 um  Surface Position    Cyan Selection 2\n14.64   36.42   4435.80 um  Surface Position    Full 2\n42.83   36.04   4435.47 um  Surface Position    Blue Selection 3\n42.34   36.56   4435.63 um  Surface Position    Red Selection 3\n42.25   36.87   4435.75 um  Surface Position    Yellow Selection 3\n42.48   36.50   4435.62 um  Surface Position    Csome3\n41.77   36.02   4435.67 um  Surface Position    Overlap 3\n42.64   36.89   4435.73 um  Surface Position    Green 3\n42.05   36.90   4436.21 um  Surface Position    Cyan Selection 3\n42.34   36.53   4435.71 um  Surface Position    Full 3\n33.75   33.13   4436.32 um  Surface Position    Blue Selection 4\n34.99   33.12   4436.38 um  Surface Position    Red Selection 4\n35.40   31.97   4436.38 um  Surface Position    Yellow Selection 4\n34.75   32.58   4436.36 um  Surface Position    Csome4\n39.03   35.24   4436.04 um  Surface Position    Overlap Selection 4\n35.49   32.19   4436.49 um  Surface Position    Green Selection 4\n36.14   32.35   4436.42 um  Surface Position    Cyan Selection 4\n36.16   33.20   4436.30 um  Surface Position    Full 4\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 2952, "user_id": 1653305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fNoJ9.jpg?s=128&g=1", "display_name": "dbf", "link": "https://stackoverflow.com/users/1653305/dbf"}, "edited": false, "score": 0, "creation_date": 1431465567, "post_id": 30201407, "comment_id": 48508771, "body": "Anything you have tried?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1431484441, "post_id": 30201407, "comment_id": 48514511, "body": "If this is VBA in Outlook, you don&#39;t need <code>olApp</code> at all. Replace it with <code>Application</code>. Why display it when you can make another loop to auto save any attachments within the mail item. Please note items in Inbox may not be mail item."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1431497325, "creation_date": 1431497325, "answer_id": 30206914, "question_id": 30201407, "link": "https://stackoverflow.com/questions/30201407/searching-for-newest-email-with-a-certain-subject/30206914#30206914", "title": "Searching for newest email with a certain subject", "body": "<p>I'd suggest starting from the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article in MSDN.</p>\n\n<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/ff869662.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Find</a>/<a href=\"https://msdn.microsoft.com/en-us/library/ff862482.aspx\" rel=\"nofollow\">FindNext</a> or <a href=\"http://msdn.microsoft.com/en-us/library/ff869597.aspx\" rel=\"nofollow\">Restrict</a> methods of the Items class to find the emails with a particular subject line instead of iterating through each email and checking the subject line. </p>\n\n<pre><code>Sub DemoFindNext() \n Dim myNameSpace As Outlook.NameSpace \n Dim tdystart As Date \n Dim tdyend As Date \n Dim myAppointments As Outlook.Items \n Dim currentAppointment As Outlook.AppointmentItem \n\n Set myNameSpace = Application.GetNamespace(\"MAPI\") \n tdystart = VBA.Format(Now, \"Short Date\") \n tdyend = VBA.Format(Now + 1, \"Short Date\") \n Set myAppointments = myNameSpace.GetDefaultFolder(olFolderCalendar).Items \n Set currentAppointment = myAppointments.Find(\"[Start] &gt;= \"\"\" &amp; tdystart &amp; \"\"\" and [Start] &lt;= \"\"\" &amp; tdyend &amp; \"\"\"\") \n While TypeName(currentAppointment) &lt;&gt; \"Nothing\" \n  MsgBox currentAppointment.Subject \n  Set currentAppointment = myAppointments.FindNext \n Wend \nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4893217"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1247, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593156767, "creation_date": 1431464797, "last_edit_date": 1593156767, "question_id": 30201407, "link": "https://stackoverflow.com/questions/30201407/searching-for-newest-email-with-a-certain-subject", "title": "Searching for newest email with a certain subject", "body": "<p>I have the below code which works.</p>\n\n<p>I now need to find the newest email with that subject line and open it.</p>\n\n<p>Once the email is opened, I'd like to save the attachment to my desktop and close out of the opened email. </p>\n\n<pre><code> Sub SearchOL()\n\n Dim olApp As Outlook.Application\n Dim olNs As NameSpace\n Dim Fldr As MAPIFolder\n Dim olMail As Variant\n Dim i As Integer\n\n Set olApp = New Outlook.Application\n Set olNs = olApp.GetNamespace(\"MAPI\")\n Set Fldr = olNs.GetDefaultFolder(olFolderInbox)\n i = 1\n For Each olMail In Fldr.Items\n     If InStr(olMail.Subject, \"DNP Warn and Pend Event\") &lt;&gt; 0 Then\n     olMail.Display\n     i = i + 1\n     End If\n Next olMail\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1431470037, "post_id": 30201328, "comment_id": 48510639, "body": "can you still open the emails that are being save as dot files?"}, {"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1431530874, "post_id": 30201328, "comment_id": 48542322, "body": "I can not open those emails. I have also tried renaming the files to .msg, but when i do that, it is saying that I do not have the permissions to view the file, even when I have full control permissions set on the folder for myself."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1431571407, "post_id": 30201328, "comment_id": 48560397, "body": "okay try again and let me know, make sure you copy all the code exactly and <b>do not edit</b> , all the email should be saved as <code>&quot;.msg&quot;</code>"}, {"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1431706712, "post_id": 30201328, "comment_id": 48628455, "body": "I just tried this, copied everything the way that it is, have the right references, but still every response and forwarded message still get saved as a .file rather than .msg"}], "answers": [{"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1431468908, "post_id": 30202313, "comment_id": 48510251, "body": "That would never work - * is no a valid character in a file name"}, {"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1431529955, "post_id": 30202313, "comment_id": 48541644, "body": "@Omar Ok, I will give this a shot and see how it works out for me. Quick question though, howcome it would matter if I created a module rather than adding the code to the <b>ThisOutlookSession module</b>? Essentially, could I just add this code to the module which I already have created or no?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1431531086, "post_id": 30202313, "comment_id": 48542487, "body": "You do not have to use ThisOutlookSession is just an example if you want to."}, {"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1431544871, "post_id": 30202313, "comment_id": 48550902, "body": "Unfortunately, the problem is still there. The email is being saved as a .file, rather than .msg"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1431580698, "last_edit_date": 1431580698, "creation_date": 1431468663, "answer_id": 30202313, "question_id": 30201328, "link": "https://stackoverflow.com/questions/30201328/response-emails-being-save-as-file-file-type/30202313#30202313", "title": "Response emails being save as &quot;file&quot; file-type", "body": "<p>make sure you reference </p>\n\n<pre><code>Microsoft Scripting Runtime\nMicrosoft outlook Object Library\nMicrosoft Word Object Library\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/yxEgC.png\" alt=\"enter image description here\"></p>\n\n<p>the following code has been tested on <kbd><strong>Outlook 2010</strong></kbd> </p>\n\n<pre><code>Option Explicit\n'// Save the message as a native .msg\nPublic Sub SaveMsg(Item As Outlook.MailItem)\n    Dim fso As FileSystemObject\n    Dim olNS As Outlook.NameSpace\n    Dim SavePath As String\n    Dim TimeDate As Date\n    Dim SaveName As String\n    Dim Enviro As String\n    Dim NewFolder As String\n    Dim EmailSubject As String\n\n    '// enviro gets the user account part of the path\n    '// so you can use the same code on different computers\n    Set olNS = Application.GetNamespace(\"MAPI\")\n\n    ReplaceCharsForFileName SaveName, \"_\"\n\n    '// Use My Documents for older Windows.\n    NewFolder = \"C:\\IT Documents\\\" &amp; Format(Now, \"YYYY-MM-DD\") &amp; \"\\\"\n\n    '// Test if directory or file exists\n    If FileOrDirExists(NewFolder) Then\n        MsgBox NewFolder &amp; \" exists!\"\n    Else\n        MkDir NewFolder\n    End If\n\n    EmailSubject = FileName(Item.Subject)\n\n    '// Determine if there is subject\n    If Item.Subject &lt;&gt; vbNullString Then\n        EmailSubject = Item.Subject\n    Else\n        EmailSubject = \"No Subject\"\n    End If\n\n\n    '// Get Email subject &amp; set name to be saved as\n    TimeDate = Item.ReceivedTime\n    SaveName = Format(TimeDate, \"YYYYMMDD\", vbUseSystemDayOfWeek, _\n    vbUseSystem) &amp; Format(TimeDate, \"-HHNNSS\", _\n    vbUseSystemDayOfWeek, vbUseSystem) &amp; \"-\" &amp; EmailSubject &amp; SaveName &amp; \".msg\"\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n\n\n    '// Save .msg File\n    SavePath = \"C:\\IT Documents\\\" &amp; NewFolder &amp; \"\\\"\n    Debug.Print NewFolder &amp; SaveName\n    Item.SaveAs NewFolder &amp; SaveName, olMsg\n\nEnd Sub\n\n'// This function removes invalid and other characters from file names\nPrivate Sub ReplaceCharsForFileName(SaveName As String, _\n  sChr As String _\n)\n  SaveName = Replace(SaveName, \"/\", sChr)\n  SaveName = Replace(SaveName, \"\\\", sChr)\n  SaveName = Replace(SaveName, \":\", sChr)\n  SaveName = Replace(SaveName, \"?\", sChr)\n  SaveName = Replace(SaveName, Chr(34), sChr)\n  SaveName = Replace(SaveName, \"&lt;\", sChr)\n  SaveName = Replace(SaveName, \"&gt;\", sChr)\n  SaveName = Replace(SaveName, \"|\", sChr)\n  SaveName = Replace(SaveName, \"&amp;\", sChr)\n  SaveName = Replace(SaveName, \"%\", sChr)\n  SaveName = Replace(SaveName, \"*\", sChr)\n  SaveName = Replace(SaveName, \" \", sChr)\n  SaveName = Replace(SaveName, \"{\", sChr)\n  SaveName = Replace(SaveName, \"[\", sChr)\n  SaveName = Replace(SaveName, \"]\", sChr)\n  SaveName = Replace(SaveName, \"}\", sChr)\n  SaveName = Replace(SaveName, \"!\", sChr)\n\nEnd Sub\n\n'// Good practice suggests that it is wise to check before taking certain actions\n'// This function checks if File or Dir Exists\nFunction FileOrDirExists(PathName As String) As Boolean\n    Dim iTemp As Integer\n\n     '// Ignore errors to allow for error evaluation\n    On Error Resume Next\n    iTemp = GetAttr(PathName)\n\n     '// Check if error exists and set response appropriately\n    Select Case Err.Number\n    Case Is = 0\n        FileOrDirExists = True\n    Case Else\n        FileOrDirExists = False\n    End Select\n\n     '// Resume error checking\n    On Error GoTo 0\nEnd Function\n\nFunction FileName(strText As String) As String\n    Dim strStripChars As String\n    Dim intLen As Integer\n    Dim i As Integer\n    strStripChars = \"/\\[]:=,\" &amp; Chr(34)\n        intLen = Len(strStripChars)\n    strText = Trim(strText)\n        For i = 1 To intLen\n    strText = Replace(strText, Mid(strStripChars, i, 1), \"\")\n\n    Next\n    FileName = strText\nEnd Function\n</code></pre>\n\n<p>good luck.</p>\n"}], "owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593248140, "creation_date": 1431464495, "last_edit_date": 1593248140, "question_id": 30201328, "link": "https://stackoverflow.com/questions/30201328/response-emails-being-save-as-file-file-type", "title": "Response emails being save as &quot;file&quot; file-type", "body": "<p>I am curious to know as to why every response email and forwarded emails are not being saved with the .msg file extension. Instead, they are being saved as .file extension. Any reason as to why this is happening and how to fix the problem? This is the code that I am working on right now.  </p>\n\n<pre><code>Public Sub SaveMsgs(Item As Outlook.MailItem)\n\n 'Declare Variables\n Dim sPath As String\n Dim dtDate As Date\n Dim sName As String\n Dim sSubject As String\n Dim enviro As String\n Dim sSender As String\n Dim strFolder As String\n Dim strNewFolder As String\n Dim save_to_folder As String\n\n 'enviro = CStr(Environ(\"USERPROFILE\"))\n\n ReplaceCharsForFileName sName, \"_\"\n\n sSender = Item.Sender\n\n dtDate = Item.ReceivedTime\n 'sName = sSender &amp; \" - \" &amp; sSubject &amp; \".msg\"\n\n 'Set Folder path\n strNewFolder = Format(dtDate, \"mm-dd-yyyy\")\n strFolder = \"C:\\IT Documents\\\" &amp; strNewFolder &amp; \"\\\"\n\n 'Determine if there is subject\n If Len(Item.Subject) &gt; 0 Then\n   sSubject = Item.Subject\n Else\n   sSubject = \"No Subject \"\n End If\n\n 'Determine if folder is in the directory\n If Len(Dir(strFolder, vbDirectory)) = 0 Then\n   MkDir (strFolder)\n End If\n\n sName = sSender &amp; \" - \" &amp; sSubject\n save_to_folder = strFolder\n\n Item.SaveAs save_to_folder &amp; sName &amp; \".msg\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 11, "user_id": 4893002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853f63e9848e70d204e5b0fe2fba724b?s=128&d=identicon&r=PG&f=1", "display_name": "luisa", "link": "https://stackoverflow.com/users/4893002/luisa"}, "edited": false, "score": 0, "creation_date": 1431464398, "post_id": 30201260, "comment_id": 48508183, "body": "Macros.Cells(4, 2) being equal to C:\\LPO Solutions\\Commandes OGY\\,  Macros.Cells(1, 2) being equal to CDE.xlsm,  Macros.Cells(2, 2) being equal to xxxx@yyyy.fr,  Macros.Cells(3, 2) being equal to Commandes"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431464414, "post_id": 30201260, "comment_id": 48508191, "body": "You may want to see <a href=\"http://www.rondebruin.nl/mac/mail.htm\" rel=\"nofollow noreferrer\">This</a>"}, {"owner": {"reputation": 11, "user_id": 4893002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853f63e9848e70d204e5b0fe2fba724b?s=128&d=identicon&r=PG&f=1", "display_name": "luisa", "link": "https://stackoverflow.com/users/4893002/luisa"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549363, "post_id": 30201260, "comment_id": 48553247, "body": "Thanks Siddharth, this link is great for sending email from MAC what about saving files? Thanks"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549441, "post_id": 30201260, "comment_id": 48553284, "body": "Saving files? Which files and where?"}, {"owner": {"reputation": 11, "user_id": 4893002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853f63e9848e70d204e5b0fe2fba724b?s=128&d=identicon&r=PG&f=1", "display_name": "luisa", "link": "https://stackoverflow.com/users/4893002/luisa"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549627, "post_id": 30201260, "comment_id": 48553370, "body": "file = Macros.Cells(4, 2).Value &amp; Macros.Cells(1, 2).Value   ActiveWorkbook.SaveAs file"}, {"owner": {"reputation": 11, "user_id": 4893002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853f63e9848e70d204e5b0fe2fba724b?s=128&d=identicon&r=PG&f=1", "display_name": "luisa", "link": "https://stackoverflow.com/users/4893002/luisa"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549688, "post_id": 30201260, "comment_id": 48553403, "body": "I understood that the path &quot;C:\\Luisa\\&quot; for instance, doesn&#39;t work under MAC? Thanks"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549703, "post_id": 30201260, "comment_id": 48553411, "body": "Sorry I got confused as you said files and not file. So you want to save the <code>Activeworkbook</code> first. right?"}, {"owner": {"reputation": 11, "user_id": 4893002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853f63e9848e70d204e5b0fe2fba724b?s=128&d=identicon&r=PG&f=1", "display_name": "luisa", "link": "https://stackoverflow.com/users/4893002/luisa"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549830, "post_id": 30201260, "comment_id": 48553471, "body": "Indeed, thanks. Sorry but it is the first time I&#39;m on this forum so not veru used with it :-)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549845, "post_id": 30201260, "comment_id": 48553481, "body": "correct in Mac the path separator is &quot;:&quot; and not &quot;\\&quot;. You can get that by using <code>Application.Pathseparator</code> Also it doesn&#39;t have &quot;C:&quot;  I don&#39;t have access to MAC. If you type <code>?thisworkbook.Path</code> in Immediate window, you can see what the root directory is. It would be of the format <code>Mac HD:Documents:myfile</code> Provided the file has been saved once..."}, {"owner": {"reputation": 11, "user_id": 4893002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853f63e9848e70d204e5b0fe2fba724b?s=128&d=identicon&r=PG&f=1", "display_name": "luisa", "link": "https://stackoverflow.com/users/4893002/luisa"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431549971, "post_id": 30201260, "comment_id": 48553552, "body": "Thank you very much for your help!"}], "owner": {"reputation": 11, "user_id": 4893002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853f63e9848e70d204e5b0fe2fba724b?s=128&d=identicon&r=PG&f=1", "display_name": "luisa", "link": "https://stackoverflow.com/users/4893002/luisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1448, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1593759031, "creation_date": 1431464244, "last_edit_date": 1593759031, "question_id": 30201260, "link": "https://stackoverflow.com/questions/30201260/how-to-convert-excel-vba-from-windows-to-mac", "title": "How to convert Excel-VBA from Windows to MAC?", "body": "<p>I'd like to run the below macro, which runs fine on Windows, in Excel for Mac. The macro saves the <code>ActiveWorkBook</code> (in a specific directory) and sends it via email. </p>\n\n<pre><code>Sub SauveEnvoi()\n\n  Dim file As String\n  Application.DisplayAlerts = False\n  file = Macros.Cells(4, 2).Value &amp; Macros.Cells(1, 2).Value\n  ActiveWorkbook.SaveAs file\n  Application.DisplayAlerts = True\n  Application.Dialogs(xlDialogSendMail).Show Macros.Cells(2, 2).Value, Macros.Cells(3, 2).Value\n  SetAttr file, vbReadOnly\n  Application.Quit\nEnd Sub\n</code></pre>\n\n<p><strong>From Comments below</strong></p>\n\n<p><code>Macros.Cells(4, 2)</code> being equal to <code>C:\\LPO Solutions\\Commandes OGY\\</code>,<br>\n<code>Macros.Cells(1, 2)</code> being equal to <code>CDE.xlsm</code>,<br>\n<code>Macros.Cells(2, 2)</code> being equal to <code>xxxx@yyyy.fr</code>,<br>\n<code>Macros.Cells(3, 2)</code> being equal to <code>Commandes</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2119, "user_id": 592351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zpOlU.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/592351/mike"}, "edited": false, "score": 0, "creation_date": 1431464129, "post_id": 30201211, "comment_id": 48508053, "body": "Do you have a question?"}, {"owner": {"reputation": 1276, "user_id": 2752265, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BdK4g.jpg?s=128&g=1", "display_name": "Jaken Herman", "link": "https://stackoverflow.com/users/2752265/jaken-herman"}, "edited": false, "score": 0, "creation_date": 1431464135, "post_id": 30201211, "comment_id": 48508055, "body": "Need to know what is wrong with your code, what the desired output is, etc."}, {"owner": {"reputation": 29, "user_id": 2195198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/091245f734f6f005a9825eacccf644dc?s=128&d=identicon&r=PG", "display_name": "user2195198", "link": "https://stackoverflow.com/users/2195198/user2195198"}, "edited": false, "score": 0, "creation_date": 1431464182, "post_id": 30201211, "comment_id": 48508075, "body": "I am trying this code but it&#39;s not working"}, {"owner": {"reputation": 29, "user_id": 2195198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/091245f734f6f005a9825eacccf644dc?s=128&d=identicon&r=PG", "display_name": "user2195198", "link": "https://stackoverflow.com/users/2195198/user2195198"}, "edited": false, "score": 0, "creation_date": 1431464280, "post_id": 30201211, "comment_id": 48508119, "body": "it gives &quot;run time error 1004&quot; xyz.xls could not found, but I do have approx. 10 workbooks there in the folder"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1431464829, "post_id": 30201211, "comment_id": 48508397, "body": "Where does <code>xyz.xls</code> come from?"}, {"owner": {"reputation": 29, "user_id": 2195198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/091245f734f6f005a9825eacccf644dc?s=128&d=identicon&r=PG", "display_name": "user2195198", "link": "https://stackoverflow.com/users/2195198/user2195198"}, "edited": false, "score": 0, "creation_date": 1431465045, "post_id": 30201211, "comment_id": 48508496, "body": "C:\\Users\\New folder\\    in this path I do have 10 workbooks and each has budget tab...I want to move this tab to &quot;code2.xlsm&quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431465744, "post_id": 30201211, "comment_id": 48508867, "body": "The title of your post is not for asking questions. Please give an appropriate title to your post and then ask the question in the body of the post. Also please be clear so that we can help you :)"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 29, "user_id": 2195198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/091245f734f6f005a9825eacccf644dc?s=128&d=identicon&r=PG", "display_name": "user2195198", "link": "https://stackoverflow.com/users/2195198/user2195198"}, "edited": false, "score": 0, "creation_date": 1431467165, "post_id": 30201715, "comment_id": 48509538, "body": "Now that I have helped you, could you help me with what I requested in the comment below your post ;)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1431465997, "creation_date": 1431465997, "answer_id": 30201715, "question_id": 30201211, "link": "https://stackoverflow.com/questions/30201211/how-to-move-excel-sheets-saved-in-a-folder-to-a-new-workbook/30201715#30201715", "title": "How to move excel sheets saved in a folder to a new workbook?", "body": "<p>The problem is with the line</p>\n\n<pre><code>Workbooks.Open (Myfile)\n</code></pre>\n\n<p><code>Myfile</code> only contains the name of the file and not the full path. Try this</p>\n\n<pre><code>Workbooks.Open (\"C:\\Users\\New folder\\\" &amp; Myfile)\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 2195198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/091245f734f6f005a9825eacccf644dc?s=128&d=identicon&r=PG", "display_name": "user2195198", "link": "https://stackoverflow.com/users/2195198/user2195198"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 1, "accepted_answer_id": 30201715, "answer_count": 1, "score": 0, "last_activity_date": 1431467849, "creation_date": 1431464003, "last_edit_date": 1431467849, "question_id": 30201211, "link": "https://stackoverflow.com/questions/30201211/how-to-move-excel-sheets-saved-in-a-folder-to-a-new-workbook", "title": "How to move excel sheets saved in a folder to a new workbook?", "body": "<p>\"C:\\Users\\New folder\\\"  in this path I do have 10 workbooks and each has budget tab...I want to move this tab to \"code2.xlsm   </p>\n\n<p>My code is this:</p>\n\n<pre><code>Option Explicit\nSub move_filesinto_masterWB()\n\n\nDim Myfile As String\nMyfile = Dir(\"C:\\Users\\New folder\\\")\nDim Masterwb As Workbook\nSet Masterwb = Workbooks(\"code2.xlsm\")\n\n\nDo While Len(Myfile) &gt; 0\n\nWorkbooks.Open (Myfile)\n\nSheets(\"budget\").Select\nSheets(\"budget\").Copy After:=Workbooks(\"Code2.xlsm\").Sheets(sheets.count)\n\nMyfile = Dir\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1431464177, "post_id": 30201161, "comment_id": 48508071, "body": "Move the <code>=</code> outside the <code>]</code>. As it is now, if <code>Me.ProjNo</code> is 5, your expression is <code>[ProjNo =] 5</code>, which clearly isn&#39;t what you want. I&#39;m suspecting it should be <code>&quot;[ProjNo] = &#39;&quot; &amp; Me.ProjNo &amp; &quot;&#39;&quot;</code>."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1431464592, "post_id": 30201161, "comment_id": 48508294, "body": "Set a break point on that line and run the code.  When it goes into break mode, test the <code>DLookup</code> expression with Ken&#39;s suggested changes in the Immediate window: <code>? DLookup(&quot;Expr1&quot;, &quot;qryCountUntoggled&quot;, &quot;[ProjNo] = &#39;&quot; &amp; Me.ProjNo &amp; &quot;&#39;&quot;)</code>  That looks correct to me, but you&#39;ll know for sure if Access gives you what you want."}], "answers": [{"tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": true, "score": 0, "last_activity_date": 1431466422, "creation_date": 1431466422, "answer_id": 30201806, "question_id": 30201161, "link": "https://stackoverflow.com/questions/30201161/syntax-error-missing-operator-vba/30201806#30201806", "title": "Syntax Error Missing Operator VBA", "body": "<p>If ProjNo is numeric, the correct code is: </p>\n\n<pre><code>Countboxes = DLookup(\"Expr1\", \"qryCountUntoggled\", \"[ProjNo] =\" &amp; Me.ProjNo )\n</code></pre>\n\n<p>If ProjNo is text, the code should be:</p>\n\n<pre><code>Countboxes = DLookup(\"Expr1\", \"qryCountUntoggled\", \"[ProjNo] ='\" &amp; Me.ProjNo &amp; \"'\")\n</code></pre>\n"}], "owner": {"reputation": 614, "user_id": 3858321, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9a939e1e2e8c2083dc77ed991ab87b57?s=128&d=identicon&r=PG&f=1", "display_name": "AxxieD", "link": "https://stackoverflow.com/users/3858321/axxied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 30201806, "answer_count": 1, "score": 1, "last_activity_date": 1594654582, "creation_date": 1431463810, "last_edit_date": 1594654582, "question_id": 30201161, "link": "https://stackoverflow.com/questions/30201161/syntax-error-missing-operator-vba", "title": "Syntax Error Missing Operator VBA", "body": "<p>I have a <code>Dlookup</code> in Access 2010 that's supposed to pull a value from a query table that counts the number of checkboxes untoggled. When I run it, it gives me a 'Missing operator in query expression' here.</p>\n\n<pre><code>Countboxes = DLookup(\"Expr1\", \"qryCountUntoggled\", \"[ProjNo =]\" &amp; Me.ProjNo &amp; \"'\")\n</code></pre>\n\n<p>I can't quite figure out what's wrong. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1431473059, "creation_date": 1431473059, "answer_id": 30203123, "question_id": 30200834, "link": "https://stackoverflow.com/questions/30200834/excel-split-and-save-workbook-sheets-to-multiple-books-based-on-single-cell-va/30203123#30203123", "title": "Excel - Split and save workbook sheets to multiple books based on Single Cell value", "body": "<p>I would do it this way:</p>\n\n<ol>\n<li><p>Loop through all sheets and add every unique cell b10 name to an array</p></li>\n<li><p>For each unique name in the array ..</p></li>\n</ol>\n\n<p>2.1 create a new workbook \neg\nDim newwb as Workbook\nset newwb = workbooks.add</p>\n\n<p>2.2 loop through all   the sheets moving each sheet that has the same B10 name to the new workbook.</p>\n\n<p>for each sht in Thisworkbook</p>\n\n<p>if sht.range('B10').value = </p>\n\n<p>.. use macro record to find out the copy to move a sheet to another workbook.\n  .. you need to right click on the sheet and choose \"move or copy\"</p>\n\n<p>next sht</p>\n\n<p>2.3 save the new workbook.</p>\n\n<p>PS. Sorry there's not more code here, but I think this will help a bit</p>\n"}], "owner": {"reputation": 1, "user_id": 4893048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fb9d6841407008d79e6a1aec13285c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dinogal", "link": "https://stackoverflow.com/users/4893048/dinogal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1431473059, "creation_date": 1431462608, "question_id": 30200834, "link": "https://stackoverflow.com/questions/30200834/excel-split-and-save-workbook-sheets-to-multiple-books-based-on-single-cell-va", "title": "Excel - Split and save workbook sheets to multiple books based on Single Cell value", "body": "<p>This is my first post as previously I have been able to search this, and other forums to help get answers and write the macro's I need but I have not been able to find an answer that helps solve my current need. Any help/suggestion is much appreciated.</p>\n\n<p>I have a workbook with a over 100 sheets. Each sheet has the same format, and  cell B10 in each sheet contains a name. Using VBA, I need to be able to move all sheets with the same name in cell B10 to their own new workbook and save based on the name. I should end up with 12 workbooks each with a differing number of sheets. </p>\n\n<p>So far I can extract all sheets to their own files but have not been able to figure out how  to group them and save. I think I should be be able to do this with some combination of a Loop and/or Array I just can't quite make it work. Below is what I have so far:</p>\n\n<pre><code>Sub Deaggregate()\nDim wb As Workbook\nDim ws As Worksheet\n\nApplication.ScreenUpdating = False\n\nFor Each ws In ThisWorkbook.Worksheets\nws.Copy\nSet wb = ActiveWorkbook\nwb.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; ws.Range(\"B3\").Value &amp; \" \" &amp; ws.Name &amp; \"      \" &amp; ws.Range(\"B4\").Value &amp; \" \" &amp; Format(Date, \"yyyymmdd\") &amp; \".xlsx\"\nwb.Close False\nNext ws\n\nApplication.ScreenUpdating = False\nEnd Sub\n</code></pre>\n\n<p>Thanks again for any help/suggestions!</p>\n"}, {"tags": ["vba", "ms-access-2010", "export-to-csv"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1431462537, "post_id": 30200663, "comment_id": 48507211, "body": "That error suggests you named the module <i>CreateSchemaFile</i>, the same as the procedure name.  In that case, rename the module to something else ... eg <i>modCreateSchemaFile</i> ... and that particular error should go away.  Unfortunately, after that I can&#39;t help you."}, {"owner": {"reputation": 532, "user_id": 4892926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca4ce25c1a923a85dd6048c076dff657?s=128&d=identicon&r=PG&f=1", "display_name": "bcarothers", "link": "https://stackoverflow.com/users/4892926/bcarothers"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1431465481, "post_id": 30200663, "comment_id": 48508726, "body": "@HansUp - Tried that and got &quot;Error#: 3265 Item not found in this collection.&quot;  After clicking OK on that, &quot;False&quot; appears in the Immediate window.  I don&#39;t see any new files in the specified directory."}], "answers": [{"tags": [], "owner": {"reputation": 532, "user_id": 4892926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca4ce25c1a923a85dd6048c076dff657?s=128&d=identicon&r=PG&f=1", "display_name": "bcarothers", "link": "https://stackoverflow.com/users/4892926/bcarothers"}, "is_accepted": true, "score": 1, "last_activity_date": 1431532304, "last_edit_date": 1431532304, "creation_date": 1431529019, "answer_id": 30218561, "question_id": 30200663, "link": "https://stackoverflow.com/questions/30200663/export-dynamic-fields-from-access-to-csv-schema-ini/30218561#30218561", "title": "Export dynamic fields from Access to csv (schema.ini?)", "body": "<p>Ah, ok, I figured it out.  I thought I had to specify the columns in Schema.ini, but I was mistaken.  I just needed to set the header to true; that way it'll read whatever happens to end up in the query.  Setting the text delimiter to none was also a key piece.</p>\n\n<p>Here's all I needed in Schema.ini (just needs to be in the same directory as the exported file):</p>\n\n<pre><code>[ExportFileName.txt]\nFormat=CSVDelimited\nColNameHeader=True\nTextDelimiter=\"none\"\n</code></pre>\n\n<p>And the code:</p>\n\n<pre><code>Private Sub cmdExport_Click()\n    Dim dbs As DAO.Database\n    Set dbs = CurrentDb\n    dbs.Execute \"SELECT * INTO [text;database=C:\\filepath].[ExportFileName.txt] FROM qryCrosstabs\"\n</code></pre>\n\n<p>While this ultimately works, having an external Schema.ini file is clunkier than I'd like.  I've seen a few places where adding extended properties to the dbs.Execute line will indicate csv (FMT=Delimited) and column headers (HDR=Yes).  Having one for text delimiters would be the most parsimonious solution, but from what I can tell, that doesn't exist.  I'm happy to be corrected on that if it does, though!</p>\n"}], "owner": {"reputation": 532, "user_id": 4892926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca4ce25c1a923a85dd6048c076dff657?s=128&d=identicon&r=PG&f=1", "display_name": "bcarothers", "link": "https://stackoverflow.com/users/4892926/bcarothers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 0, "accepted_answer_id": 30218561, "answer_count": 1, "score": -1, "last_activity_date": 1432920706, "creation_date": 1431461933, "last_edit_date": 1432920706, "question_id": 30200663, "link": "https://stackoverflow.com/questions/30200663/export-dynamic-fields-from-access-to-csv-schema-ini", "title": "Export dynamic fields from Access to csv (schema.ini?)", "body": "<p>I'm trying to export a crosstab query from Access 2010 to a csv without a text qualifier.  I'm able to use the <code>Transfer Text</code> method with my other exports; the trick with this one is that the number of fields (and their names) change depending on what the user selects on the form, but the setup in the SpecificationName is static.  If I don't indicate a SpecificationName, I can get whatever fields are run in the query as appropriate, but I get quotes around my text fields, which I don't want.  If I set up a specification to set the text qualifier as None, I'm stuck with a set list of fields.  I tried sticking an asterisk in the FieldName area when setting up the specification, but got </p>\n\n<blockquote>\n  <p>The number of fields in your export specification does not match the number in the table you have chosen to export. </p>\n</blockquote>\n\n<p>I'd really like some kind of \"SELECT *\" in there, but it doesn't look like it's possible?</p>\n\n<p>Poking around, it looks like I might need to set up a schema.ini?  Of course, this would need to be dynamic as well.  I found a resource that was written for Access 97: <a href=\"https://support2.microsoft.com/default.aspx?scid=kb;en-us;155512\" rel=\"nofollow\">https://support2.microsoft.com/default.aspx?scid=kb;en-us;155512</a>, but it doesn't seem to work in Access 2010.  Even after updating <code>db As Database</code> to <code>db As DAO.Database</code>, I get </p>\n\n<blockquote>\n  <p>Expected variable or procedure, not module</p>\n</blockquote>\n\n<p>When running the following in the Immediate window (with appropriate text subbed in):</p>\n\n<pre><code>?CreateSchemaFile(True,\"C:\\MyFilepath\",\"ExportFileName.txt\",\"qryCrosstabs\")\n</code></pre>\n\n<p>I've reached the limits of my (limited) VBA chops to figure this out.  Writing a script for a dynamic schema.ini seems like overkill for just wanting to get rid of quotes, but if that's what has to happen, any pointers in the right direction would be excellent.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1431462411, "post_id": 30200578, "comment_id": 48507141, "body": "A1:A50 contains 50 cells to check against J1:J52 which contains 52 cells. Are you looking to see if the text in A1 is contained anywhere in J1:J52, or are you wanting to check if A1 text is equal to J1 text?"}, {"owner": {"reputation": 45, "user_id": 4893045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c4e507a0cc14390edae3549dfffd49?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelQuestions", "link": "https://stackoverflow.com/users/4893045/excelquestions"}, "edited": false, "score": 0, "creation_date": 1431462665, "post_id": 30200578, "comment_id": 48507286, "body": "if present, then return count."}, {"owner": {"reputation": 45, "user_id": 4893045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c4e507a0cc14390edae3549dfffd49?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelQuestions", "link": "https://stackoverflow.com/users/4893045/excelquestions"}, "reply_to_user": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1431463081, "post_id": 30200578, "comment_id": 48507516, "body": "mix of both, only because I could not come up with any other way to count a colored cell other than using VBA.  If there is a way to do what I need (match name and count colored cell) and not use VBA then I will certainly give it a try."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1431464006, "post_id": 30200578, "comment_id": 48507982, "body": "Honestly, I haven&#39;t tried <code>Names</code> with the <code>backcolor</code> but only with the <code>font color</code> as shown <a href=\"http://stackoverflow.com/questions/15887257/how-to-count-up-text-of-a-different-font-colour-in-excel\">Here</a> If you want, you can try and use it with <a href=\"http://stackoverflow.com/questions/20489472/how-to-count-cells-in-a-range-with-a-value-less-than-another-cell-in-excel/20491479#20491479\">This</a> and see if it works?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4893045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c4e507a0cc14390edae3549dfffd49?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelQuestions", "link": "https://stackoverflow.com/users/4893045/excelquestions"}, "edited": false, "score": 0, "creation_date": 1431464226, "post_id": 30200926, "comment_id": 48508091, "body": "Thank you. I will attempt both solutions.  You were right in catching my error of description on Column J; J4:J1847 is correct."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1431463253, "last_edit_date": 1431463253, "creation_date": 1431462953, "answer_id": 30200926, "question_id": 30200578, "link": "https://stackoverflow.com/questions/30200578/excel-formula-with-vba/30200926#30200926", "title": "Excel Formula with VBA", "body": "<p>Adding a parameter for the criteria range and implementing <code>Application.Countif</code> should be sufficient.</p>\n\n<pre><code>Function CountByColorAndName(InputRange As Range, NameRange As Range, ColorRange As Range) As Long\n    Dim cl As Range, TmpCount As Long, ColorIndex As Integer\n    Application.Volatile\n    ColorIndex = ColorRange.Interior.ColorIndex\n    TmpCount = 0\n    On Error Resume Next\n    For Each cl In InputRange.Cells\n        If cl.Interior.ColorIndex = ColorIndex and _\n          cbool(application.countif(NameRange , cl.value)) then _\n            TmpCount = TmpCount + 1\n    Next cl\n    CountByColor = TmpCount\nEnd Function\n</code></pre>\n\n<p>Sample syntax:</p>\n\n<pre><code>=CountByColorAndName('sheet2'!J4:J1847, A1:A50, A52)\n</code></pre>\n\n<p>There is a little confusion as your description of the situation refers to both <em>Sheet2 Column J1:J52</em> and <em>'sheet2'!J4:J1847</em>. If this isn't appropriate, please clarify.</p>\n\n<p>The <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow\">MATCH function</a> is actually more efficient than the <a href=\"https://support.office.com/en-US/article/COUNTIF-function-E0DE10C6-F885-4E71-ABB4-1F464816DF34\" rel=\"nofollow\">COUNTIF function</a>, both on the worksheet and within VBA. This should reduce calculation load some.</p>\n\n<pre><code>    For Each cl In InputRange.Cells\n        If cl.Interior.ColorIndex = ColorIndex then _\n          if not iserror(application.match(cl.value, NameRange , 0)) then _\n            TmpCount = TmpCount + 1\n    Next cl\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4893045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c4e507a0cc14390edae3549dfffd49?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelQuestions", "link": "https://stackoverflow.com/users/4893045/excelquestions"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1431463253, "creation_date": 1431461624, "last_edit_date": 1431462499, "question_id": 30200578, "link": "https://stackoverflow.com/questions/30200578/excel-formula-with-vba", "title": "Excel Formula with VBA", "body": "<p>Need formula to match text from one column to text in different worksheet and count the highlighted cells. This is similar to doing a sumif, but instead of returning a numerical value in a static column, I will return the count of highlighted cells. </p>\n\n<p>I have successfully written the VBA to count the highlighted cells in a given column, but now must do a match of names.  Meaning, if name in column A1:A50 matches name in Sheet2 Column J1:J52, then return a count of highlighted cells in sheet 2 column X.</p>\n\n<p>Formula to count highlighted cells:  <code>countbycolor('sheet2'!J4:J1847,A52)</code></p>\n\n<p>VBA: </p>\n\n<pre><code>Function CountByColor(InputRange As Range, ColorRange As Range) As Long\n    Dim cl As Range, TmpCount As Long, ColorIndex As Integer\n    Application.Volatile\n    ColorIndex = ColorRange.Interior.ColorIndex\n    TmpCount = 0\n    On Error Resume Next\n    For Each cl In InputRange.Cells\n    If cl.Interior.ColorIndex = ColorIndex _\n        Then TmpCount = TmpCount + 1\n    Next cl\n    CountByColor = TmpCount\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "hyperlink", "powerpoint", "powerpoint-2013"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1431525904, "creation_date": 1431525904, "answer_id": 30217276, "question_id": 30200560, "link": "https://stackoverflow.com/questions/30200560/add-hyperlink-to-picture-using-vba-macro-in-powerpoint/30217276#30217276", "title": "Add hyperlink to picture using VBA Macro in PowerPoint", "body": "<p>Assuming you have a reference to the image (or any other shape) in the variable oSh:</p>\n\n<pre><code>With oSh\n    .ActionSettings(ppMouseClick).Hyperlink.Address = \"http://www.pptfaq.com\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 3722976, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/118c37fdb598f16d9bfc1db8182894dc?s=128&d=identicon&r=PG&f=1", "display_name": "dHumphrey", "link": "https://stackoverflow.com/users/3722976/dhumphrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1788, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1431526375, "creation_date": 1431461534, "last_edit_date": 1431526375, "question_id": 30200560, "link": "https://stackoverflow.com/questions/30200560/add-hyperlink-to-picture-using-vba-macro-in-powerpoint", "title": "Add hyperlink to picture using VBA Macro in PowerPoint", "body": "<p>I am trying append a hyperlink to an image, on Click, to the Master Slide page of a PowerPoint using VBA/Macros. I have added the photo and am now  looking for a function that will add <strong>'www.comment.com/connect'</strong> </p>\n\n<pre><code>Private Sub commentConnect_Click()\n    ...\nEnd Sub\n</code></pre>\n\n<p>Should I use the  <strong><code>.Hyperlink.Address = \"www.comment.com/connect\"</code></strong> function? </p>\n"}]